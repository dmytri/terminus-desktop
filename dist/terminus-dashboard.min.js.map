{"version":3,"sources":["webpack://TerminusDashboard/webpack/bootstrap","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/index.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/node_modules/axios/lib/utils.js","webpack://TerminusDashboard/./src/Utils.js","webpack://TerminusDashboard/./src/html/HTMLFrameHelper.js","webpack://TerminusDashboard/./src/html/query/TerminusCodeSnippet.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/errorMessage.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/frameHelper.js","webpack://TerminusDashboard/./src/viewer/TerminusFrame.js","webpack://TerminusDashboard/./src/plugins/TerminusPlugin.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/const.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/utils.js","webpack://TerminusDashboard/./src/html/Datatypes.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/node_modules/axios/lib/helpers/bind.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/node_modules/axios/lib/helpers/buildURL.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/node_modules/axios/lib/cancel/isCancel.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/node_modules/axios/lib/defaults.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/node_modules/axios/lib/adapters/xhr.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/node_modules/axios/lib/core/createError.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/node_modules/axios/lib/core/mergeConfig.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/node_modules/axios/lib/cancel/Cancel.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/connectionCapabilities.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/connectionConfig.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/terminusIDParser.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/framePattern.js","webpack://TerminusDashboard/./src/viewer/WOQLRule.js","webpack://TerminusDashboard/./src/viewer/WOQLChooser.js","webpack://TerminusDashboard/./src/viewer/WOQLTable.js","webpack://TerminusDashboard/./src/viewer/DatatypeRenderers.js","webpack://TerminusDashboard/./src/viewer/WOQLGraph.js","webpack://TerminusDashboard/./src/viewer/WOQLStream.js","webpack://TerminusDashboard/./src/html/QueryPane.js","webpack://TerminusDashboard/./src/html/datatypes/String.js","webpack://TerminusDashboard/./src/html/datatypes/DateHelper.js","webpack://TerminusDashboard/./src/html/datatypes/GoogleMapHelper.js","webpack://TerminusDashboard/./src/html/table/SimpleTable.js","webpack://TerminusDashboard/./src/html/graph/SimpleGraph.js","webpack://TerminusDashboard/./src/html/stream/SimpleStream.js","webpack://TerminusDashboard/./src/html/chooser/SimpleChooser.js","webpack://TerminusDashboard/./src/html/DocumentPane.js","webpack://TerminusDashboard/./src/html/document/SimpleFrameViewer.js","webpack://TerminusDashboard/./src/index.js","webpack://TerminusDashboard/./src/TerminusUI.js","webpack://TerminusDashboard/./src/ApiExplorer.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/woqlClient.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/dispatchRequest.js","webpack://TerminusDashboard/./node_modules/buffer/index.js","webpack://TerminusDashboard/(webpack)/buildin/global.js","webpack://TerminusDashboard/./node_modules/base64-js/index.js","webpack://TerminusDashboard/./node_modules/ieee754/index.js","webpack://TerminusDashboard/./node_modules/isarray/index.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/node_modules/axios/index.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/node_modules/axios/lib/axios.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/node_modules/is-buffer/index.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/node_modules/axios/lib/core/Axios.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/node_modules/axios/lib/core/InterceptorManager.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/node_modules/axios/lib/core/dispatchRequest.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/node_modules/axios/lib/core/transformData.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/node_modules/axios/lib/helpers/normalizeHeaderName.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/node_modules/axios/lib/core/settle.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/node_modules/axios/lib/core/enhanceError.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/node_modules/axios/lib/helpers/parseHeaders.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/node_modules/axios/lib/helpers/isURLSameOrigin.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/node_modules/axios/lib/helpers/cookies.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/node_modules/axios/lib/helpers/isAbsoluteURL.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/node_modules/axios/lib/helpers/combineURLs.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/node_modules/axios/lib/cancel/CancelToken.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/node_modules/axios/lib/helpers/spread.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/objectFrame.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/woqlResult.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/woql.js","webpack://TerminusDashboard/./src/plugins/codemirror.terminus.js","webpack://TerminusDashboard/./src/TerminusDB.js","webpack://TerminusDashboard/./src/viewer/WOQLQueryView.js","webpack://TerminusDashboard/./src/html/ResultPane.js","webpack://TerminusDashboard/./src/html/datatypes/StringEditor.js","webpack://TerminusDashboard/./src/html/datatypes/Boolean.js","webpack://TerminusDashboard/./src/html/datatypes/BooleanEditor.js","webpack://TerminusDashboard/./src/html/datatypes/Choice.js","webpack://TerminusDashboard/./src/html/datatypes/ChoiceEditor.js","webpack://TerminusDashboard/./src/html/datatypes/Coordinate.js","webpack://TerminusDashboard/./src/html/datatypes/CoordinateEditor.js","webpack://TerminusDashboard/./src/html/datatypes/Date.js","webpack://TerminusDashboard/./src/html/datatypes/DateEditor.js","webpack://TerminusDashboard/./src/html/datatypes/Entity.js","webpack://TerminusDashboard/./src/html/datatypes/EntityEditor.js","webpack://TerminusDashboard/./src/html/datatypes/Image.js","webpack://TerminusDashboard/./src/html/datatypes/ImageEditor.js","webpack://TerminusDashboard/./src/html/datatypes/Link.js","webpack://TerminusDashboard/./src/html/datatypes/Number.js","webpack://TerminusDashboard/./src/html/datatypes/Range.js","webpack://TerminusDashboard/./src/html/datatypes/RangeEditor.js","webpack://TerminusDashboard/./src/html/datatypes/GoogleMapEditor.js","webpack://TerminusDashboard/./src/html/datatypes/GoogleMapViewer.js","webpack://TerminusDashboard/./src/html/datatypes/HTMLMarkupEditor.js","webpack://TerminusDashboard/./src/html/datatypes/S2EntityEditor.js","webpack://TerminusDashboard/./src/html/graph/GraphResultsViewer.js","webpack://TerminusDashboard/./src/html/TerminusViolation.js","webpack://TerminusDashboard/./src/TerminusQuery.js","webpack://TerminusDashboard/./src/html/ScriptPane.js","webpack://TerminusDashboard/./src/TerminusSchema.js","webpack://TerminusDashboard/./src/html/TerminusHTMLViewer.js","webpack://TerminusDashboard/./src/html/document/SimpleDocument.js","webpack://TerminusDashboard/./src/html/document/DocumentTable.js","webpack://TerminusDashboard/./src/html/document/ObjectViewer.js","webpack://TerminusDashboard/./src/html/document/PropertyViewer.js","webpack://TerminusDashboard/./src/html/document/DataViewer.js","webpack://TerminusDashboard/./src/TerminusServer.js","webpack://TerminusDashboard/./src/plugins/datatables.terminus.js","webpack://TerminusDashboard/./src/TerminusURL.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","WOQLClient","ConnectionCapabilities","ConnectionConfig","IDParser","ErrorMessage","FrameHelper","ObjectFrame","WOQLResult","WOQL","isBuffer","toString","isArray","val","isObject","isFunction","forEach","obj","fn","length","isArrayBuffer","isFormData","FormData","isArrayBufferView","ArrayBuffer","isView","buffer","isString","isNumber","isUndefined","isDate","isFile","isBlob","isStream","pipe","isURLSearchParams","URLSearchParams","isStandardBrowserEnv","navigator","product","window","document","merge","result","assignValue","arguments","deepMerge","extend","a","b","thisArg","trim","str","replace","Codemirror","require","TerminusClient","readFile","file","XMLHttpRequest","xmlhttp","ActiveXObject","open","send","xmlDoc","responseText","getFunctionSignature","which","sigs","spec","descr","args","server_url","options","title","description","database_url","details","format","editmode","document_url","fail_on_id_denied","woql","class","term","source","target","getHeaderDom","text","hd","createElement","setAttribute","h","innerHTML","appendChild","getButton","button","createTextNode","getInfoAlertDom","type","label","msg","ald","txt","getResponse","currForm","action","response","terminator","rd","br","data","JSON","stringify","pre","stylizeCodeDisplay","showHttpResult","retHttpHeaders","headers","hdres","json","then","deleteStylizedEditor","ui","qip","pluginAvailable","cm","nextElementSibling","removeChildren","stylizeEditor","view","cmConfig","ar","colorizeTextArea","updateTextArea","dom","pr","colorizePre","removeSelectedNavClass","el","getElementsByClassName","classList","remove","setSelectedSubMenu","add","setSelected","className","par","parentElement","childNodes","contains","tolggleContent","icon","content","style","display","activateSelectedNav","nav","hideDocumentSubMenus","checkDocumentSubMenus","showControl","toggleVisibility","extractValueFromCell","cellValue","DOMParser","parseFromString","firstChild","displayDocumentSubMenus","showSubMenus","checkForMandatoryId","objId","background","getCurrentWoqlQueryObject","query","settings","qval","limit","pageLength","start","elementMetadata","classMetadata","getEverything","getAllDocuments","documentMetadata","and","quad","sub","opt","propertyMetadata","console","log","trimValue","getqObjFromInput","q","qObj","eval","this","e","TerminusPluginManager","HTMLFrameHelper","control","callback","disabled","dpropDOM","addEventListener","selected","sel","labelFromURL","renderer","viewsDOM","setMode","getActionControl","isNew","cancel","url","location","href","loc","split","sh","getShorthand","bits","htmlid","prop","wrap","max_cell_size","max_word_size","substring","replacements","words","word","newstr","k","varname","lastIndexOf","help","input","infoDOM","linfo","lspacer","lval","scope","frame","orientation","hfeatures","features","display_options","hidden","framedom","getFrameHolderDOM","header","header_features","getFrameHeaderDOM","getFrameBodyDOM","pcls","sp","css","parent","subjectClass","subject","hid","hash","index","idm","objDOM","vholder","charCodeAt","feature","getInfoboxDOM","sum","getSummary","status","lab","getLabel","getComment","isClassChoice","getClassChoiceTypeSelector","range","getType","cardControlAllows","show_disabled_buttons","clone","reset","isUpdated","hide","show","save","getViewerSelectorDOM","getViewEntryDOM","getCardinalityDOM","getAddDOM","viewers","terminus","datatypes","getAvailableViewers","getRenderer","mpropDOM","currentViewer","getSelectionControl","viewer","setViewer","viewables","getFilledPropertyList","unshift","goToEntry","restriction","getRestriction","min","max","cs","getAvailableClassChoices","mlabDOM","cls","changeClass","addClass","addables","getMissingPropertyList","addNewProperty","addNewValue","UTILS","TerminusCodeSnippet","language","width","height","placeholder","formats","snippet","setQuery","refreshContents","serialise","prettyPrint","undefined","parseText","nw","parse","loadConfig","error","getInputElement","readInput","getAsDOM","with_buttons","scont","snpc","getFormatButtons","serial","actbtn","getSubmitButton","changeRuleView","nview","submit","getIconsDOM","bsp","view_types","isp","id","self","cursor","f","btn","qobj","alert","removeCodeMirror","nextSibling","removeElement","stylizeSnippet","dimensions","getErrorAsMessage","api","err","formatErrorMessage","body","method","nmsg","keys","getAPIErrorMessage","getAccessDeniedMessage","accessDenied","db","server","getInvalidURIMessage","parseAPIError","redirected","standard_urls","rdf","rdfs","xsd","owl","tcs","tbs","xdd","v","vio","docs","prefix","node","hasChildNodes","removeChild","parentNode","Math","random","Date","getTime","link","pref","full","ida","idb","unshorten","sha","shb","prefixes","validURL","nurl","urlFragment","charAt","toUpperCase","slice","urlStr","baseUrl","stype","urlFirst","urlTmp","ext","viewIncludesProperties","parts","join","ty","parsed","parseXsdDate","parseXsdTime","parseXsdDateTime","year","month","day","push","tz","extractXsdTimezone","abs","parseInt","timezone","nparsed","hour","minute","second","xparsed","addXsdPadding","ret","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","convertTimestampToXsd","datetime","ptime","indexOf","dividor","vals","scriptid","src","existingScript","getElementById","script","onload","cssid","rel","DatatypeRenderers","TerminusFrame","client","load_schema","opts","config","setDatatypes","func","loadDocument","getDocument","loadDataFrames","loadDocumentSchema","ncls","getClassFrame","loadSchemaFrames","dataframes","domain","classframes","loadClassFrames","subjid","newDoc","fillFromSchema","render","applyRulesToDocument","doc","filter","rules","rule","loadRenderer","compare","setFrameDisplayOptions","rendname","owner","preloaded","loaded","loading","precluded","plugins","js","requires","setPluginOptions","init","calculatePreloaded","toload","calculateRequiredInitPlugins","loadPlugins","pins","pid","getDefaultPlugins","needed_pins","loading_order","getAvailablePlugins","pl","plugin","version_check","pluginmeta","version","jQuery","slider","Quill","JSONEditor","CodeMirror","fontAwesomeCheck","dataTable","select2","google","maps","ol","Map","d3","Error","element","span","insertBefore","getComputedStyle","getPropertyValue","ticker","cback","loadPlugin","pug","loadDynamicCSS","scripts","sid","splice","loadDynamicScript","loadPluginScripts","loadPageCSS","cssfid","cssdom","cssurl","pluginLoadable","pluginLoadedOrLoading","getPluginDOM","plugid","cl","cbox","checked","clab","togglePlugin","redraw","unloadPlugin","drawPlugins","num","dm","clh","showPlugins","freeze","CONNECT","GET_SCHEMA","UPDATE_SCHEMA","UPDATE_DOCUMENT","CLASS_FRAME","WOQL_SELECT","GET_DOCUMENT","DELETE_DATABASE","DELETE_DOCUMENT","CREATE_DATABASE","CREATE_DOCUMENT","WOQL_UPDATE","authorityActionsToArr","Array","map","item","URIEncodePayload","payload","encodeURIComponent","payloadArr","keyElement","valueElement","HTMLStringViewer","HTMLStringEditor","HTMLBooleanViewer","HTMLBooleanEditor","HTMLChoiceViewer","HTMLChoiceEditor","HTMLCoordinateViewer","HTMLCoordinateEditor","HTMLDateViewer","HTMLDateEditor","HTMLEntityViewer","HTMLEntityEditor","HTMLImageViewer","HTMLImageEditor","HTMLLinkViewer","HTMLNumberViewer","HTMLRangeViewer","HTMLRangeEditor","GoogleMapEditor","GoogleMapViewer","HTMLMarkupEditor","S2EntityEditor","initialiseDataRenderers","RenderingMap","registerViewerForTypes","registerEditorForTypes","universalEditor","universalViewer","addPlugins","createRenderer","createDataRenderer","registerEditorForFrameType","apply","utils","encode","params","paramsSerializer","serializedParams","toISOString","hashmarkIndex","__CANCEL__","normalizeHeaderName","DEFAULT_CONTENT_TYPE","setContentTypeIfUnset","adapter","defaults","process","transformRequest","transformResponse","timeout","xsrfCookieName","xsrfHeaderName","maxContentLength","validateStatus","common","settle","buildURL","parseHeaders","isURLSameOrigin","createError","Promise","resolve","reject","requestData","requestHeaders","request","auth","username","password","Authorization","btoa","onreadystatechange","readyState","responseURL","responseHeaders","getAllResponseHeaders","responseType","statusText","onabort","onerror","ontimeout","cookies","xsrfValue","withCredentials","read","toLowerCase","setRequestHeader","onDownloadProgress","onUploadProgress","upload","cancelToken","promise","abort","enhanceError","message","code","config1","config2","Cancel","CONST","connectionConfig","connection","setClientKey","getClientKey","serverURL","curl","addConnection","capabilities","capabilitiesKeys","pred","auths","actions","actionsArr","j","nrec","serverConnected","capabilitiesPermit","dbid","connectionMode","client_checks_capabilities","rec","getServerRecord","getDBRecord","srvr","connectionObj","okeys","oid","dbCapabilityID","getServerDBRecords","dbrecs","removeDB","dbidCap","newParams","docid","setServer","setDB","setDocument","connected_mode","include_key","includeKey","schemaURL","dbURL","queryURL","frameURL","docURL","platformEndpoint","baseURL","inputStr","context","parser","parseServerURL","parseDBID","setSchemaURL","parseSchemaURL","parseDocumentURL","setQueryURL","parseQueryURL","setClassFrameURL","parseClassFrameURL","setContext","validPrefixedURL","expandPrefixed","validIDString","stripOptionalPath","bit","FramePattern","pattern","setPattern","frame_type","children","depth","checkFrame","rtype","getRendererType","illegalRuleType","checkFrameType","checkLabel","checkSubject","checkSubjectClass","checkProperty","checkDepth","checkRange","checkValue","checkParent","checkChildren","checkIndex","checkStatus","rsubj","IDsMatch","found","properties","values","numberMatch","propertyIDsMatch","valuesMatch","rangeIDsMatch","rcls","classIDsMatch","ftype","stringMatch","compareIDs","vala","valb","RegExp","test","isProperty","isData","renderer_type","constructor","FramePatternMatcher","FrameRule","testRules","onmatch","matched_rules","patternMatchesFrame","unpack","arr","nonstring","frameType","kids","collapse","showDisabledButtons","headerFeatures","showEmpty","show_empty","dataviewer","featureRenderers","feature_renderers","frametype","rend","WOQLChooser","WOQLTable","WOQLGraph","WOQLStream","FrameConfig","WOQLStreamConfig","WOQLChooserConfig","WOQLTableConfig","WOQLRule","addNamespacesToVariables","vars","nvars","nvar","removeNamespaceFromVariable","mvar","getMatchingRules","row","matches","match","table","graph","WOQLGraphConfig","chooser","stream","loadJSON","jr","conf","nr","renderers","tf","trenderer","setRenderer","json_rules","get_schema","show_all","all","show_parts","fp","wqt","change","labels","titles","sort","direction","onChange","value_variable","label_variable","title_variable","sort_variable","sort_direction","dtypes","column_order","pagesize","pager","page","order","show_pager","editable","show_pagesize","change_pagesize","show_pagenumber","column","cols","setVariables","literals","show_literals","source_variable","fontfamily","fontfam","show_force","force","fix_nodes","fixed","explode_out","explode","selected_grows","bigsel","gwidth","gheight","edges","nedges","show_edges","edge","getConfigAsJSON","showfix_nodes_force","estrs","variables","literal","removeNamespacesFromVariables","size","color","charge","distance","weight","symmetric","collisionRadius","arrow","border","click","hover","constraints","mjson","w","hdr","onClick","onHover","list","current_variable","tester","constraint","vundertest","set","ch","setResult","choices","getVariableList","next","includeRow","rowToChoice","binding","rownum","choice","getRowID","getLabelFromBinding","getTitleFromBinding","getSelectedFromBinding","rval","getSpecialRenderer","renderSpecial","count","first","prev","DataValue","datavalue","datatype","res","onChangeQuery","canAdvancePage","getLimit","canChangePage","canRetreatPage","getPage","getPageSize","setPage","setPageSize","update","nextPage","firstPage","previousPage","getColumnsToRender","hasColumnOrder","getColumnOrder","hasSelect","getSelectVariables","col","getColumnHeaderContents","colid","hr","nquery","execute","results","nresult","notify","hasDefinedEvent","getDefinedEvent","getRowClick","getCellClick","getRowHover","getCellHover","hasCellClick","hasRowClick","hasCellHover","hasRowHover","getSpecificRender","getRendererForDatatype","renderValue","dv","nvalue","registeredDataViewers","registeredDataEditors","defaultViewers","defaultEditors","specials","editor","getValidDataViewerList","valids","concat","getValidDataEditorList","nftypes","getEditorForDataFrame","getViewerForDataFrame","record","types","getEditor","nodes","node_ids","calculateVariableTypes","getEdges","bindings","getBindings","rowIncludesEdge","makeEdgesFromRow","getNodes","source_variables","makeNodeFromSource","target_variables","makeNodeFromTarget","adornNode","adornEdge","makeEdgeFromRow","eid","extractFromBinding","lits","includeNode","includeLiteralNode","nid","genBNID","getLiteralOwner","addAdornedNode","addAdornedEdge","createEdgesFromIDs","ndid","ks","kt","nodetype","rad","radius","es","page_size","wqrs","ResultPane","QueryPane","views","container","fireDefaultQueries","qcres","classMetaDataRes","qpres","propertyMetaDataRes","showQuery","editQuery","showHeader","addViews","intro","defaultResultView","showConfig","editConfig","getSection","sName","clearSubMenus","smenus","getResults","sampleQueryDOM","AddEvents","choosen","innerText","getDataOfClass","getDataOfProperty","getQueryMenu","qName","getSubDataMenu","getSchemaSection","section","checkIfDataMenuOpen","isOpen","child","showDataOfTypeEvent","subPar","hasBindings","showPropertyOfTypeEvent","addCheveronIcon","getDataSection","bd","fireDocumentEvent","documentProperties","getEnterDocumentIdDOM","inp","getDocumentSection","getQueryMenuBlock","getSampleQueriesDOM","showQueryConfig","configspan","ic","qicon","ipdom","hideQueryConfig","createInput","showingQuery","resultDOM","addView","vdom","getAddViewControl","getResultPaneHeader","closable","savePaneButton","closePaneButton","collapsePaneButton","submitQuery","updateQuery","updateResult","refreshViews","nrp","empty","clearMessages","showError","vd","newView","selector","nv","show_types","renderFrame","wrapShortenedText","HTMLDateHelper","months","getMonthName","GoogleMapHelper","polygon","polyline","markers","mapLat","mapLong","zoom","stroke","opacity","fill","line","destroy","clear","translatePolygonToArray","vertices","getPath","seenValue","getLength","xy","getAt","lat","lng","translateArrayToPolygon","array","jsonified","output","latlong","createPolygon","coords","Polygon","paths","strokeColor","strokeOpacity","strokeWeight","fillColor","fillOpacity","setMap","createPolyline","Polyline","clearMarkers","addMarker","position","marker","Marker","addListener","getCoordsFromMarkers","x","initMap","mapContainer","center","parseFloat","setPath","event","trigger","SimpleTable","holder","woqltable","ctls","getControlsDOM","tab","getTableDOM","ctrls","paging","getPaging","columns","thead","getTableHeader","tbody","getTableBody","thr","th","getColumnHeader","tr","getHTMLRow","td","getCell","rc","getCellData","isPaged","pdom","pn","getFirst","getPrev","getPageNumber","getNext","chunk","clabel","ctl","pval","GraphResultsViewer","SimpleGraph","wgraph","getGraphDOM","gviz","gdom","setData","initDOM","SimpleStream","SimpleChooser","ccdom","ccsel","getEmptyOption","createOptionFromChoice","Datatypes","SimpleFrameViewer","DocumentPane","clsid","loadClass","setClassLoader","cloader","classLoader","queryPane","documentLoader","getQueryPane","pane","ispan","showDocConfig","nspan","nc","ndom","hideDocConfig","showingConfig","renderResult","fpt","termframe","evalstr","updateView","docview","tdv","getScope","getDatatypeViewer","isChoice","isDocument","getFeaturesDOM","orient","getFrameDOM","replaceWith","flist","featuresToCSS","renderProperties","renderValues","getFeatureDOM","TerminusUI","ApiExplorer","TerminusDBsdk","TerminusViolations","TerminusQueryViewer","TerminusSchemaViewer","TerminusServersdk","TerminusURLLoader","controls","setOptions","connect","showBusy","clearBusy","connectToDB","showView","showDocument","schema","showSchemaPage","showQueryPage","explorer","showExplorer","showDBMainPage","showServerMainPage","createDatabase","dbdets","getBadArguments","myserver","dbdoc","generateNewDatabaseDocument","getSchema","updateSchema","refreshDBList","crec","getCrashString","showMessage","deleteDatabase","delrec","lid","dbn","dets","fname","load","getConnectionEndpoint","clearServer","clearDB","TerminusServerViewer","redrawMainPage","showCollaboratePage","showLoadURLPage","TerminusDBViewer","showCreateDBPage","TerminusDBCreator","durl","showDocumentPage","TerminusDocumentViewer","getDocViewerOptions","showCreateDocument","getDocCreatorOptions","loadCreateDocument","mainDOM","deleteDBPermitted","getDeleteDBButton","delbut","confirm","showResult","messages","clearMainPage","main","setMessageDOM","setbuttonControls","buttons","setControllerDOM","controller","setExplorerDOM","setPluginsDOM","setViewerDOM","draw","comps","slocation","redrawControls","toggleDashboardWidget","widget","toggleControl","drawControls","loadControls","ncontrol","nd","drawExplorer","exp","ae","sc","TerminusServerController","TerminusDBController","show_controls","pseudoCapability","show_views","busy","getBusyLoader","bsyDom","pd","pbc","pbsa","pbia","md","msgHolder","showViolations","vios","nvios","cmsg","document_options","schema_options","piman","getClassFrameOptions","viewdoc_options","apiNavConfig","mainNav","navText","defaultSelected","database","subNav","getClassFrames","viewDocument","createDocument","updateDocument","deleteDocument","select","use_fetch","return_full_response","pman","aec","getApiNav","getApiExplorerDom","setSelectedNavMenu","navOnSelect","createNavs","navConfig","ul","navDom","cont","apiCont","getConnectExplorer","getDatabaseExplorer","getSchemaApi","getDocumentApi","getQueryApi","changeSubApiDom","curSubMenu","getDatabaseDom","getShowApiDom","getQueryApiDom","subNavOnSelect","subMenuConfig","createSubNavs","getSignature","getForm","getServerForm","form","fd","inpLabel","cd","inpId","keyLabel","resd","gatherips","curApi","urlPlaceholder","formDoc","urlLabel","inpUrl","docUrlLabel","inpDocUrl","inpKey","docLabel","inpDoc","docUrl","getApiSendButton","getApiForm","enc","schurl","buttonSelf","gtxtar","txtar","dcurl","schemaUrlDom","htmlEditor","getValue","sg","sig","DispatchRequest","URIError","dispatch","dburl","makeDocumentConsistentWithURL","addOptionsToDocument","docurl","qurl","addOptionsToWOQL","cfurl","pdoc","_","addKeyToPayload","dispatchFetch","redirect","referrer","hdrs","credentials","cache","Headers","fetch","ok","btoaImplementation","Buffer","from","axios","delete","catch","post","base64","ieee754","kMaxLength","TYPED_ARRAY_SUPPORT","createBuffer","that","RangeError","Uint8Array","__proto__","arg","encodingOrOffset","allocUnsafe","TypeError","byteOffset","byteLength","fromArrayLike","fromArrayBuffer","string","encoding","isEncoding","actual","write","fromString","len","copy","fromObject","assertSize","loweredCase","utf8ToBytes","base64ToBytes","slowToString","end","hexSlice","utf8Slice","asciiSlice","latin1Slice","base64Slice","utf16leSlice","swap","bidirectionalIndexOf","dir","isNaN","arrayIndexOf","indexSize","arrLength","valLength","String","buf","readUInt16BE","foundIndex","hexWrite","offset","Number","remaining","strLen","substr","utf8Write","blitBuffer","asciiWrite","byteArray","asciiToBytes","latin1Write","base64Write","ucs2Write","units","hi","lo","utf16leToBytes","fromByteArray","secondByte","thirdByte","fourthByte","tempCodePoint","firstByte","codePoint","bytesPerSequence","codePoints","MAX_ARGUMENTS_LENGTH","fromCharCode","decodeCodePointsArray","SlowBuffer","alloc","INSPECT_MAX_BYTES","global","foo","subarray","typedArraySupport","poolSize","_augment","species","configurable","allocUnsafeSlow","_isBuffer","y","pos","swap16","swap32","swap64","equals","inspect","thisStart","thisEnd","thisCopy","targetCopy","includes","isFinite","toJSON","_arr","out","toHex","bytes","checkOffset","checkInt","objectWriteUInt16","littleEndian","objectWriteUInt32","checkIEEE754","writeFloat","noAssert","writeDouble","newBuf","sliceLen","readUIntLE","mul","readUIntBE","readUInt8","readUInt16LE","readUInt32LE","readUInt32BE","readIntLE","pow","readIntBE","readInt8","readInt16LE","readInt16BE","readInt32LE","readInt32BE","readFloatLE","readFloatBE","readDoubleLE","readDoubleBE","writeUIntLE","writeUIntBE","writeUInt8","floor","writeUInt16LE","writeUInt16BE","writeUInt32LE","writeUInt32BE","writeIntLE","writeIntBE","writeInt8","writeInt16LE","writeInt16BE","writeInt32LE","writeInt32BE","writeFloatLE","writeFloatBE","writeDoubleLE","writeDoubleBE","targetStart","INVALID_BASE64_RE","Infinity","leadSurrogate","toByteArray","stringtrim","base64clean","dst","g","Function","b64","lens","getLens","validLen","placeHoldersLen","tmp","Arr","_byteLength","curByte","revLookup","uint8","extraBytes","len2","encodeChunk","lookup","isLE","mLen","nBytes","eLen","eMax","eBias","nBits","NaN","rt","LN2","Axios","mergeConfig","createInstance","defaultConfig","instance","instanceConfig","CancelToken","isCancel","promises","spread","default","InterceptorManager","dispatchRequest","interceptors","chain","interceptor","fulfilled","rejected","shift","getUri","handlers","use","eject","transformData","isAbsoluteURL","combineURLs","throwIfCancellationRequested","throwIfRequested","reason","fns","normalizedName","isAxiosError","number","fileName","lineNumber","columnNumber","stack","ignoreDuplicateOf","originURL","msie","userAgent","urlParsingNode","resolveURL","protocol","host","search","hostname","port","pathname","requestURL","expires","path","secure","cookie","toGMTString","decodeURIComponent","now","relativeURL","executor","resolvePromise","token","parentframe","originalFrames","PropertyFrame","cframe","predicate","DataFrame","ClassFrame","Restriction","loadRestriction","jsonld_context","cf","isValid","hasSchema","frames","domainValue","getPropertyClassFrame","getChosenClassFrame","isLogic","getChosenFrame","addFrame","getAsFrame","ff","getAsFrames","isnew","restrictions","props","ignore_failure","getProperties","filled","missing","nmissing","newb","newid","pf","cloned","getChild","childid","pframe","getProperty","addProperty","createEmpty","createEmptyChoice","clss","getClassChoices","df","addPropertyValue","addValue","removeProperty","removePropertyValue","removeValue","parentObject","root","sortProperties","nprops","unsorted","standardCompare","hasRestriction","rest","currentnum","propcount","long","kid","extract","extracts","updated","childUpdated","hasCardinalityRestriction","deletePropertyValue","gets","cvalues","fs","sortedVals","sortValues","rangeValue","comment","originalValue","nrend","setNew","isValidType","dt","hasCardRestriction","isObjectProperty","isDatatypeProperty","isRestriction","getStdURL","getChoiceOptions","elements","option","lang","getTypeShorthand","contents","normalizer","loadFromObjectFrame","getChosenClassFrames","objframe","chosen","operands","dataframe","cloneDataFrame","other","domcls","operand","cardinality","maxCardinality","minCardinality","nrest","no_compress","compress","getContext","nprop","shorten","nval","last","compareValues","asc_or_desc","Pattern","WOQLQuery","chain_ended","contains_update","paging_transitive_properties","vocab","loadDefaultVocabulary","tripleBuilder","nspaces","spaces","TripleBuilder","when","Query","Update","into","or","queries","not","triple","isa","eq","JSON_or_IRI","delete_triple","S","P","O","delete_quad","G","add_triple","add_quad","as","vari","remote","group_by","gvarlist","groupedvar","groupquery","Q","lower","u","pad","unique","idgen","typecast","vara","varb","arith","plus","minus","times","divide","div","star","classid","propid","deleteClass","deleteProperty","nodeid","isLiteralType","arr1","arr2","buildAsClauses","clauses","va","vb","sq","nlist","upd","advanceCursor","cleanSubject","cleanPredicate","cleanObject","cleanGraph","cleanClass","abstract","lastUpdate","Subject","Predicate","Object_or_Literal","Graph","cleanType","asArray","card","addPO","entity","relationship","GraphIRI","Subj","Pred","Obj","concreteDocumentClasses","getDocumentConnections","getInstanceMeta","simpleGraphQuery","loadVocabulary","spl","setVocabulary","getVocabulary","getPagingProperty","setLimit","setPagingProperty","psize","hasStart","getStart","pagenum","pstart","setStart","addStart","npage","nq","defaultContext","DB_IRI","def","scm","subj","pageprop","indent","show_context","fluent","newlining_operators","operator","getWOQLPrelude","chainable","uncleanArguments","inline","lastArg","hasShortcut","getShortcut","argIsSubQuery","myas","lhs","rhs","uncleanArgument","allArgs","unclean","cstr","oval","uncleanObjectArgument","nstr","part","suff","printLine","ttype","evstr","unit","addEntry","getO","clause","os","od","tb","textdom","objectIsEmpty","darkMode","jsonldCheck","fromTextArea","firstLineNumber","lineNumbers","styleActiveLine","lineWrapping","smartIndent","indentWithTabs","newlineAndIndent","autoCloseBrackets","matchBrackets","afterCursor","extraKeys","foldCode","getCursor","refresh","foldGutter","gutters","Pos","setCodemirrorSize","setSize","defaultCharWidth","setOption","setTimeout","on","runMode","theme","pages","dbc","dbrec","nm","getControlHTML","q2","result2","docClasses","bdom","getBodyAsDOM","getRulesForListOfDocuments","getRulesForGraphOfDocuments","getDocumentsDOM","getHomeDOM","showHappyBox","delw","getDeleteDatabaseWidget","mydb","insertDocument","dchooser","getCreateDataChooser","page_actions","loadCreateDocumentPage","show_doc_action","getShowDocumentControl","prepend","dp","ddp","g2","del","di","dbdel","styleCreateDocumentChooser","qopts","ropts","pholder","happy","hbox","sets","htit","getNavigationDOM","pp","pop","insertDOM","scd","dcip","nbut","is","preventDefault","keyCode","getDocumentTableConfig","rowClick","annotateValue","ID","Class","Description","getExplanation","explaination","getClassesDOM","TerminusHTMLViewer","qres","nt","lg","unicode","ng","sct","mfd","dht","sci","slab","idip","titip","descip","schem","kip","datip","butfield","cancbut","loadbut","WOQLQueryView","querypane","qp","changeViewType","getResultDOM","getViewConfigIconClass","cvicons","getViewTypeIconDOM","getDefaultViewerIcon","getIconForViewer","changeViewerType","wres","big","isBigType","getTypeSize","vallab","elt","foptions","inputs","parseValue","lldom","getInputDOMs","latdom","longdom","getLatLongDOM","firstcol","updateValueFromForm","op","lldoms","butspan","addbut","ipdoms","DateHelper","allowbce","date_spacer","time_spacer","datetime_separator","helper","parseDate","datepart","getDateComponentDOM","timepart","getTimeComponentDOM","hdom","mdom","mlab","sdom","dadom","ydom","ddom","xsdFromParsed","tdom","opdom","onclick","showValue","getEntityViewHTML","internalLink","getController","getEntityLabel","il","getVariableValueFromBinding","tit","img","commas","numberWithCommas","delimiter","parseRangeValue","rvals","svals","useCommas","tnode","getRangeSymbolDOM","x2","t2node","data1","data2","firstip","secondip","showing_range","but","changeHandler","mapcontainer","ghelper","latLng","coo","inner","quill","getClient","d2ch","TerminusDocumentChooser","svg","visid","chars","randomString","currentDate","link_elements","node_elements","loadedNodes","focusNodes","links","selected_id","setConfigOptions","initD3","d3DOM","loadNewData","updateGraph","updateSimulation","dqr","updateData","setFocusNodeFromResult","reload","getFocusNode","setFilter","simulation","stop","wake","hibernate","no_animate","nnodes","getNodesAndFringes","snode","nnode","fx","fy","getLinks","scale_factor","setWidth","setHeight","clientWidth","clientHeight","jqid","append","attr","forceSimulation","forceLink","getLinkDistance","forceManyBody","strength","getCharge","forceCollide","getCollisionRadius","forceCenter","drag_drop","drag","restart","zoomed","link_group","classed","node_group","current_transform","transform","follow_node_wrapper","graph_node","nodeSelected","selectAll","exit","node_enter","enter","getRadius","isFringe","getNodeIconUnicode","styleNodeElements","link_enter","styleLinkElements","alpha","each","getNodeColour","getNodeText","getNodeIconWeight","getNodeIconSize","getNodeIconColour","getLineWidth","getEdgeArrow","getEdgeColour","getLinkText","getEdgeDirection","reference","getArrowWidth","getArrowHeight","selected_node","selection_grows","getScaleTransform","scale","min_ratio","new_mol_width","new_mol_height","y_trans","x_trans","transition","duration","scaleToFit","min_x","min_y","max_x","max_y","mol_width","mol_height","width_ratio","height_ratio","recentre","translated","dcx","dcy","text_elements","faclass","getMultiplier","mult","colrad","linkDistance","getNodeIcon","isNeighbourLink","added","upgraded","TerminusViolation","context_msg","vioHeading","getPropertyAsDOM","ldom","ScriptPane","panes","new_pane","new_pane_type","meta","newPaneOptions","defaultResultOptions","getNewQueryPane","qpane","addQueryPane","addScriptPane","addScriptPaneDOM","addNewPaneDOM","addQueryPaneDOM","setNewDocumentPaneDOM","addDocumentPaneDOM","qdom","qhdr","getPaneHeader","paneDOM","getPanesDOM","controlDOM","newPaneButton","panesDOM","npd","nqhdr","getNewPaneHeader","headerDOM","removePane","showPane","hidePane","newScriptButton","newDocButton","executeScript","showOKMessage","confirm_before_update","thv","changeHeaders","setGraphSize","getOWLView","loadSchema","appendRuleViews","appendClassViews","appendPropertyViews","qprops","qclasses","getAllProperties","getAllClasses","defineViewAction","getTabs","getSchemaViews","tview","controldom","pagedom","msgtype","refreshPage","resetControlDOM","getSchemaSaveButtons","getSchemaImportActionButtons","getShowSchemaButton","getClassFrameChooser","getSchemaEditButton","getImportButton","getNewLibaryButton","refreshMainPage","getSchemaViewDOM","getSchemaEditDOM","getSchemaImportDOM","ssb","getCancelButton","getSaveButton","getImportSaveButton","getSchemaButton","getImportPreviewButton","is_import","doImport","schema_edit_dom","schema_edit_dom_name","origurl","newschema","appendSchema","showConfirmPage","s2","nschema","getSchemaNameInputDOM","np","ipval","klab","modes","overwrite","SimpleDocument","DocumentTable","HTMLObjectViewer","HTMLPropertyViewer","HTMLDataViewer","setRenderers","snippetText","showConfigEditor","cSnippet","actionButton","cObj","submitConfig","cdom","cbtn","cDisplay","displayResults","loadResults","last_result","WOQLQueryViewer","ruleEditor","getAddRuleButton","rbtn","getConfigButton","wqv","queryViewer","WOQLChoice","renderProperty","td2","HTMLObjectHeaderViewer","headerViewer","renderedDOM","getObjectBodyDOM","getObjectDOM","getContentOrientation","hasFeatureViewer","featureViewer","redrawHeader","nheader","redrawBody","nbody","addRenderedProperty","renderedprop","goTo","goToName","getObjectIDMarker","sumDOM","controlsDOM","showFeature","facetDOM","getObjectFacetDOM","getObjectLabelDOM","idDOM","getObjectIDDOM","typeDOM","getObjectTypeDOM","getObjectStatusDOM","viewDOM","getViewPropertyDOM","hideDOM","getObjectControlsDOM","getObjectSummaryDOM","addDOM","getAddPropertyDOM","getModeSelectorDOM","getObjectDeleteDOM","cpropDOM","getObjectCloneDOM","rpropDOM","getObjectResetDOM","upropDOM","getObjectUpdateDOM","showDOM","getObjectShowDOM","getObjectHideDOM","getAvailableFacets","currentFacet","setFacet","isNewDocument","required","getClassMeta","cmt","getAddableProperties","getViewableProperties","goToProperty","HTMLPropertyHeaderViewer","propDOM","npropDOM","getPropertyDOM","getPropertyIDMarker","getPropertyBodyDOM","addRenderedValue","renderedval","wrapper","expModeMenu","getPropertyControlsDOM","getPropertyLabelDOM","statDOM","getPropertyStatusDOM","getPropertySummaryDOM","prelude","getPropertyFacetDOM","getViewValueDOM","getPropertyIDDOM","getPropertyRangeDOM","getPropertyCardinalityDOM","getPropertyCommentDOM","getActionControlDOM","settingsDOM","getPropertyDeleteDOM","getAddValueDOM","getPropertyResetDOM","getPropertyUpdateDOM","getPropertyShowDOM","getPropertyHideDOM","getSettingsControlDOM","getViewableValues","goToValue","HTMLDataHeaderViewer","valDOM","nvalDOM","getValueDOM","getValueIDMarker","getValueBodyDOM","facet","getDataValueViewer","getDOM","getSummaryDOM","HTMLTerminusClient","fireInternalLink","getValueFacetDOM","getValueTypeDOM","getValueStatusDOM","getValueControlsDOM","getValueDeleteDOM","getValueCloneDOM","getValueResetDOM","getValueUpdateDOM","getValueShowDOM","getValueHideDOM","Datatables","rsc","getServerLabelDOM","srec","desc","csbut","crbut","getDBListDOM","getServerDetailsDOM","scl","scs","wrapTableLinkCell","tdElement","getNDBListDOM","sec","th1","th2","th3","th4","th5","th6","fullid","td1","td3","td4","td5","td6","CspDatatables","wResViewer","qPage","wrViewer","wQuery","currDTSettings","convertToDatatable","DataTable","searching","lengthMenu","initComplete","oInstance","$","html","columnDefs","targets","createdRow","find","cell","dbInfo","parents","dbId","dtResult","executeQuery","pageInfo","formatResultsForDatatableDisplay","generateNewQueryOnPageChange","qTextDom","queryMode","getCallbackSettings","dtAPIChangeSettings","_iDisplayLength","_iDisplayStart","iDraw","chosenValue","setUp","dtdom","updateCurrDTSettings","getNewDataOnChange","drawnTab","aSettings","getDataFromServer","serverSide","processing","autoWidth","ajax","entries","scrollX","selectDocumentNavBar","url_input","key_input","getLabelDOM","getFormFieldDOM","ip","ltxt","loadbuts"],"mappings":"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","file":"terminus-dashboard.min.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 40);\n","'use strict';\r\nmodule.exports = {\r\n\t\t\t\t WOQLClient:require('./lib/woqlClient'),\r\n                  ConnectionCapabilities:require('./lib/connectionCapabilities'),\r\n                  ConnectionConfig:require('./lib/connectionConfig'),\r\n                  IDParser:require('./lib/terminusIDParser'),\r\n                  ErrorMessage:require('./lib/errorMessage'),\r\n                  FrameHelper:require('./lib/frameHelper'),\r\n                  ObjectFrame:require('./lib/objectFrame'),\r\n                  WOQLResult:require('./lib/woqlResult'),\r\n                  WOQL:require('./lib/woql')};","'use strict';\n\nvar bind = require('./helpers/bind');\nvar isBuffer = require('is-buffer');\n\n/*global toString:true*/\n\n// utils is a library of generic helper functions non-specific to axios\n\nvar toString = Object.prototype.toString;\n\n/**\n * Determine if a value is an Array\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is an Array, otherwise false\n */\nfunction isArray(val) {\n  return toString.call(val) === '[object Array]';\n}\n\n/**\n * Determine if a value is an ArrayBuffer\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is an ArrayBuffer, otherwise false\n */\nfunction isArrayBuffer(val) {\n  return toString.call(val) === '[object ArrayBuffer]';\n}\n\n/**\n * Determine if a value is a FormData\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is an FormData, otherwise false\n */\nfunction isFormData(val) {\n  return (typeof FormData !== 'undefined') && (val instanceof FormData);\n}\n\n/**\n * Determine if a value is a view on an ArrayBuffer\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a view on an ArrayBuffer, otherwise false\n */\nfunction isArrayBufferView(val) {\n  var result;\n  if ((typeof ArrayBuffer !== 'undefined') && (ArrayBuffer.isView)) {\n    result = ArrayBuffer.isView(val);\n  } else {\n    result = (val) && (val.buffer) && (val.buffer instanceof ArrayBuffer);\n  }\n  return result;\n}\n\n/**\n * Determine if a value is a String\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a String, otherwise false\n */\nfunction isString(val) {\n  return typeof val === 'string';\n}\n\n/**\n * Determine if a value is a Number\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a Number, otherwise false\n */\nfunction isNumber(val) {\n  return typeof val === 'number';\n}\n\n/**\n * Determine if a value is undefined\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if the value is undefined, otherwise false\n */\nfunction isUndefined(val) {\n  return typeof val === 'undefined';\n}\n\n/**\n * Determine if a value is an Object\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is an Object, otherwise false\n */\nfunction isObject(val) {\n  return val !== null && typeof val === 'object';\n}\n\n/**\n * Determine if a value is a Date\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a Date, otherwise false\n */\nfunction isDate(val) {\n  return toString.call(val) === '[object Date]';\n}\n\n/**\n * Determine if a value is a File\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a File, otherwise false\n */\nfunction isFile(val) {\n  return toString.call(val) === '[object File]';\n}\n\n/**\n * Determine if a value is a Blob\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a Blob, otherwise false\n */\nfunction isBlob(val) {\n  return toString.call(val) === '[object Blob]';\n}\n\n/**\n * Determine if a value is a Function\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a Function, otherwise false\n */\nfunction isFunction(val) {\n  return toString.call(val) === '[object Function]';\n}\n\n/**\n * Determine if a value is a Stream\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a Stream, otherwise false\n */\nfunction isStream(val) {\n  return isObject(val) && isFunction(val.pipe);\n}\n\n/**\n * Determine if a value is a URLSearchParams object\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a URLSearchParams object, otherwise false\n */\nfunction isURLSearchParams(val) {\n  return typeof URLSearchParams !== 'undefined' && val instanceof URLSearchParams;\n}\n\n/**\n * Trim excess whitespace off the beginning and end of a string\n *\n * @param {String} str The String to trim\n * @returns {String} The String freed of excess whitespace\n */\nfunction trim(str) {\n  return str.replace(/^\\s*/, '').replace(/\\s*$/, '');\n}\n\n/**\n * Determine if we're running in a standard browser environment\n *\n * This allows axios to run in a web worker, and react-native.\n * Both environments support XMLHttpRequest, but not fully standard globals.\n *\n * web workers:\n *  typeof window -> undefined\n *  typeof document -> undefined\n *\n * react-native:\n *  navigator.product -> 'ReactNative'\n * nativescript\n *  navigator.product -> 'NativeScript' or 'NS'\n */\nfunction isStandardBrowserEnv() {\n  if (typeof navigator !== 'undefined' && (navigator.product === 'ReactNative' ||\n                                           navigator.product === 'NativeScript' ||\n                                           navigator.product === 'NS')) {\n    return false;\n  }\n  return (\n    typeof window !== 'undefined' &&\n    typeof document !== 'undefined'\n  );\n}\n\n/**\n * Iterate over an Array or an Object invoking a function for each item.\n *\n * If `obj` is an Array callback will be called passing\n * the value, index, and complete array for each item.\n *\n * If 'obj' is an Object callback will be called passing\n * the value, key, and complete object for each property.\n *\n * @param {Object|Array} obj The object to iterate\n * @param {Function} fn The callback to invoke for each item\n */\nfunction forEach(obj, fn) {\n  // Don't bother if no value provided\n  if (obj === null || typeof obj === 'undefined') {\n    return;\n  }\n\n  // Force an array if not already something iterable\n  if (typeof obj !== 'object') {\n    /*eslint no-param-reassign:0*/\n    obj = [obj];\n  }\n\n  if (isArray(obj)) {\n    // Iterate over array values\n    for (var i = 0, l = obj.length; i < l; i++) {\n      fn.call(null, obj[i], i, obj);\n    }\n  } else {\n    // Iterate over object keys\n    for (var key in obj) {\n      if (Object.prototype.hasOwnProperty.call(obj, key)) {\n        fn.call(null, obj[key], key, obj);\n      }\n    }\n  }\n}\n\n/**\n * Accepts varargs expecting each argument to be an object, then\n * immutably merges the properties of each object and returns result.\n *\n * When multiple objects contain the same key the later object in\n * the arguments list will take precedence.\n *\n * Example:\n *\n * ```js\n * var result = merge({foo: 123}, {foo: 456});\n * console.log(result.foo); // outputs 456\n * ```\n *\n * @param {Object} obj1 Object to merge\n * @returns {Object} Result of all merge properties\n */\nfunction merge(/* obj1, obj2, obj3, ... */) {\n  var result = {};\n  function assignValue(val, key) {\n    if (typeof result[key] === 'object' && typeof val === 'object') {\n      result[key] = merge(result[key], val);\n    } else {\n      result[key] = val;\n    }\n  }\n\n  for (var i = 0, l = arguments.length; i < l; i++) {\n    forEach(arguments[i], assignValue);\n  }\n  return result;\n}\n\n/**\n * Function equal to merge with the difference being that no reference\n * to original objects is kept.\n *\n * @see merge\n * @param {Object} obj1 Object to merge\n * @returns {Object} Result of all merge properties\n */\nfunction deepMerge(/* obj1, obj2, obj3, ... */) {\n  var result = {};\n  function assignValue(val, key) {\n    if (typeof result[key] === 'object' && typeof val === 'object') {\n      result[key] = deepMerge(result[key], val);\n    } else if (typeof val === 'object') {\n      result[key] = deepMerge({}, val);\n    } else {\n      result[key] = val;\n    }\n  }\n\n  for (var i = 0, l = arguments.length; i < l; i++) {\n    forEach(arguments[i], assignValue);\n  }\n  return result;\n}\n\n/**\n * Extends object a by mutably adding to it the properties of object b.\n *\n * @param {Object} a The object to be extended\n * @param {Object} b The object to copy properties from\n * @param {Object} thisArg The object to bind function to\n * @return {Object} The resulting value of object a\n */\nfunction extend(a, b, thisArg) {\n  forEach(b, function assignValue(val, key) {\n    if (thisArg && typeof val === 'function') {\n      a[key] = bind(val, thisArg);\n    } else {\n      a[key] = val;\n    }\n  });\n  return a;\n}\n\nmodule.exports = {\n  isArray: isArray,\n  isArrayBuffer: isArrayBuffer,\n  isBuffer: isBuffer,\n  isFormData: isFormData,\n  isArrayBufferView: isArrayBufferView,\n  isString: isString,\n  isNumber: isNumber,\n  isObject: isObject,\n  isUndefined: isUndefined,\n  isDate: isDate,\n  isFile: isFile,\n  isBlob: isBlob,\n  isFunction: isFunction,\n  isStream: isStream,\n  isURLSearchParams: isURLSearchParams,\n  isStandardBrowserEnv: isStandardBrowserEnv,\n  forEach: forEach,\n  merge: merge,\n  deepMerge: deepMerge,\n  extend: extend,\n  trim: trim\n};\n","/**\r\n * @file Javascript Api explorer tool\r\n * @author Kitty Jose\r\n * @license Copyright 2018-2019 Data Chemist Limited, All Rights Reserved. See LICENSE file for more\r\n *\r\n * @summary Set of functions used across scripts\r\n */\r\nconst Codemirror= require('./plugins/codemirror.terminus');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\n// function to read Files\r\nfunction readFile(file){\r\n    if (window.XMLHttpRequest){\r\n        // code for IE7+, Firefox, Chrome, Opera, Safari\r\n        xmlhttp=new XMLHttpRequest();\r\n    }\r\n    else{\r\n        // code for IE6, IE5\r\n        xmlhttp=new ActiveXObject(\"Microsoft.XMLHTTP\");\r\n    }\r\n    xmlhttp.open(\"GET\",file,false);\r\n    xmlhttp.send();\r\n    xmlDoc=xmlhttp.responseText;\r\n    return xmlDoc;\r\n} // readFile()\r\n\r\n// function to write api call signatures from woql client\r\nfunction getFunctionSignature(which){\r\n  var sigs = {};\r\n  sigs.connect = {\r\n    spec   : \"WOQLClient.connect(surl, key)\",\r\n    descr  : \"\\n\\nConnect to a Terminus server at the given URI with an API key\"\r\n                + \"Stores the terminus:ServerCapability document returned in the connection register\"\r\n                + \"which stores, the url, key, capabilities, and database meta-data for the connected server\"\r\n                + \"If the curl argument is false or null, the this.server will be used if present,\"\r\n                + \" or the promise will be rejected.\"\r\n                + \"\\n1)The first (surl) argument: {string} argument it is the Server Url\"\r\n                + \"\\n2)The second(key) argument: {string} argument contains an API key\",\r\n    result : \"HTTP 200 on success, 409 for already existing database, otherwise error code\",\r\n    args   : {server_url : 'url', key: 'Api key'},\r\n    options: { title: \"\", description: \"\" }\r\n  };\r\n  sigs.create = {\r\n    spec    : \"WOQLClient.createDatabase(dburl, details, key)\",\r\n    descr   : \"\\n\\nCreate a Terminus Database\"\r\n                + \"\\n1)The first (dburl) argument:{string}, it is a terminusDB Url or a terminusDB Id \"\r\n                + \"\\n2)The second(details) argument:{object}, details which is the payload\"\r\n                + \"\\n which included information of the new database to be created\"\r\n                +  \"\\n3)The third (key) argument:{string}, contains an API key \",\r\n    result : \"HTTP 200 on success, 409 for already existing database, otherwise error code\",\r\n    args   : {database_url : 'url', details: '', key: ' Api key'},\r\n    options: { title: \"\", description: \"\" }\r\n  };\r\n  sigs.delete = {\r\n      spec  : \"WOQLClient.deleteDatabase(dburl, key)\",\r\n      descr : \"\\n\\nDeletes a Database\"\r\n                + \"\\n1)The first (dburl) argument: {string}, it is a terminusDB Url or a terminusDB Id \"\r\n                + \"\\n2)The second(key) argument: {string}, contains an API key\",\r\n      result: \"HTTP 200 on success, otherwise error code\",\r\n  };\r\n  sigs.getSchema = {\r\n    spec   : \"WOQLClient.getSchema(surl, options)\",\r\n    descr  : \"\\n\\nGets the schema of a database.\"\r\n             +\"\\n1)The first (surl) argument: {string}, it is a dbUrl/schema\"\r\n             + \"\\n2)The second(key) argument: {string}, contains an API key\",\r\n    result : \"Ontology Document on success (HTTP 200), 409 for already existing database, otherwise error code\",\r\n    options: { format: \"turtle\" }\r\n  };\r\n  sigs.getClassFrames = {\r\n    spec   : \"WOQLClient.getClassFrame = function(cfurl, cls, opts)\",\r\n    descr  : \"\\n\\nRetrieves a WOQL query on the specified database which updates the state and returns the results\"\r\n              +  \"\\nThe first (cfurl) argument can be\"\r\n              + \"\\n1) a valid URL of a terminus database or\"\r\n              +  \"\\n2) omitted - the current database will be used\"\r\n              +  \"\\nthe second argument (cls) is the URL / ID of a document class that exists in the database schema\"\r\n              +  \"\\nthe third argument (opts) is an options json - opts.key is an optional API key\",\r\n    result : \"Ontology Document on success (HTTP 200), 409 for already existing database, otherwise error code\",\r\n    options: { format: \"turtle\" }\r\n  };\r\n  sigs.updateSchema = {\r\n    spec    : \"WOQLClient.updateSchema(schurl, docs, options)\",\r\n    descr   : \"\\n\\nUpdates the Schema of the specified database\"\r\n                +\"\\n1)The first (surl) argument :{string}, is a dbUrl/schema\"\r\n                + \"\\n2)The second(docs) argument:{object}, is a valid owl ontology (new schema to be updated) in turtle format\"\r\n                + \"\\n3)The third (key) argument:{string}, contains an API key\",\r\n    result : \"Ontology Document on success (HTTP 200), 409 for already existing database, otherwise error code\",\r\n    args   : {document : 'doc'},\r\n    options: { format: \"turtle\", editmode: \"replace\"}\r\n  };\r\n  sigs.createDocument = {\r\n    spec   : \"WOQLClient.createDocument(docurl, document, options)\",\r\n    descr  : \"\\n\\nCreates a new document in the specified database\"\r\n              + \"\\n1)The first (docurl) argument: {string}, is a dbUrl/document/document_id\"\r\n              + \"\\n2)The second(document) argument: {object}, is a valid document in json-ld\"\r\n              + \"\\n3)The third (key) argument:{string}, contains an API key\",\r\n    result : \"Created Document on success (HTTP 200), Violation Report Otherwise (HTTP 400+)\",\r\n    args   : {document_url : 'url', document: \"doc\"},\r\n    options: { format: \"turtle\", fail_on_id_denied: false}\r\n  };\r\n  sigs.viewDocument = {\r\n    spec    : \"WOQLClient.getDocument(docurl, options)\",\r\n    descr   : \"\\n\\nRetrieves a document from the specified database\"\r\n              + \"\\n1)The first (docurl) argument: {string}, is a dbUrl/document/document_id\"\r\n              + \"\\n2)The second (key) argument: {string}, contains an API key\",\r\n    result : \"Document (HTTP 200), Violation Report Otherwise (HTTP 400+)\",\r\n    args   : {document_url : 'url'},\r\n    options: { format: \"turtle\"}\r\n  };\r\n  sigs.updateDocument = {\r\n    spec   : \"WOQLClient.updateDocument(docurl, document, options)\",\r\n    descr  : \"\\n\\nUpdates a document in the specified database with a new version\"\r\n                + \"\\n1)The first (docurl) argument: {string}, is a dbUrl/document/document_id\"\r\n                + \"\\n2)The second(document) argument: {object}, is a valid document in json-ld\"\r\n                + \"\\n3)The third (key) argument:{string} argument contains an API key\",\r\n    result : \"Ontology Document on success (HTTP 200), 409 for already existing database, otherwise error code\",\r\n    args   : {document_url : 'url', document: \"doc\"},\r\n    options: { format: \"turtle\", editmode: \"replace\"}\r\n  };\r\n  sigs.deleteDocument = {\r\n    spec  : \"WOQLClient.deleteDocument(docurl, key)\",\r\n    descr : \"\\n\\nDeletes a document from the specified database\"\r\n            + \"\\n1)The first (docurl) argument: {string},is a dbUrl/document/document_id\"\r\n            + \"\\n2)The second (key) argument: {string}, contains an API key\",\r\n    result: \"Ontology Document on success (HTTP 200), 409 for already existing database, otherwise error code\",\r\n    args  : {document_url : 'url'},\r\n  };\r\n  sigs.select = {\r\n    spec: \"WOQLClient.select(dburl, query, options)\",\r\n    descr: \"\\n\\nExecutes a read-only WOQL query on the specified database and returns the results\"\r\n              + \"\\n1)The first (docurl) argument: {string}, is a terminusDB Url or a terminusDB Id\"\r\n              + \"\\n2)The second (query) argument: {object}, a valid query in json-ld format \"\r\n              + \"\\n3)The third (key) argument:{string}, contains an API key\",\r\n    result: \"WOQL Result (HTTP 200), otherwise error code\",\r\n    args: {woql: 'woql'},\r\n  };\r\n  sigs.update = {\r\n    spec  : \"WOQLClient.update(dburl, query, options)\",\r\n    descr : \"\\n\\nExecutes a WOQL query on the specified database which updates the state and returns the results\"\r\n              + \"\\n1)The first (dburl) argument: {string}, is a terminusDB Url or a terminusDB Id\"\r\n              + \"\\n2)The second (query) argument: {object}, a valid query in json-ld format \"\r\n              + \"\\n3)The third (key) argument:{string}, contains an API key\",\r\n    result: \"WOQL Result (HTTP 200), otherwise error code\",\r\n    args  : {woql: 'woql'},\r\n  };\r\n  sigs.lookup = {\r\n    spec: \"WOQLClient.lookup(database_url, woql, options)\",\r\n    result: \"WOQL Result (HTTP 200), otherwise error code\",\r\n    args: {class: 'url', term: 'string'},\r\n  };\r\n  sigs.map = {\r\n    spec: \"WOQLClient.lookup(source, target, woql, options)\",\r\n    result: \"WOQL Result (HTTP 200), otherwise error code\",\r\n    args: {source: 'json', target: \"json\", woql: 'json'},\r\n  };\r\n  sigs.getClassFrame = {\r\n    spec: \"WOQLClient.getClassFrame(class, options)\",\r\n    result: \"WOQL Result (HTTP 200), otherwise error code\",\r\n    args: {class: 'url'},\r\n  };\r\n  sigs.getPropertyFrame = {\r\n    spec: \"WOQLClient.getPropertyFrame(class, property, options)\",\r\n    result: \"WOQL Result (HTTP 200), otherwise error code\",\r\n    args: {class: 'url', property: 'url'},\r\n  };\r\n  sigs.getFilledPropertyFrame = {\r\n    spec: \"WOQLClient.getPropertyFrame(document_url, property, options)\",\r\n    result: \"WOQL Result (HTTP 200), otherwise error code\",\r\n    args: {document_url: 'url', property: 'url'},\r\n  };\r\n  sigs.getSubClasses = {\r\n    spec: \"WOQLClient.getSubClasses(class, options)\",\r\n    result: \"WOQL Result (HTTP 200), otherwise error code\",\r\n    args: {class: 'url'},\r\n  };\r\n  return sigs[which];\r\n}//getFunctionSignature\r\n\r\n// returns dom element for header text\r\nfunction getHeaderDom(text){\r\n  var hd = document.createElement('div');\r\n  hd.setAttribute('class', 'terminus-module-head');\r\n  var h = document.createElement('h3');\r\n  h.innerHTML = text;\r\n  hd.appendChild(h);\r\n  return hd;\r\n} // getHeaderTextDom\r\n\r\nfunction getButton(text){\r\n  var button = document.createElement('button');\r\n  button.setAttribute('class', 'terminus-btn');\r\n  button.setAttribute('value', text);\r\n  button.appendChild(document.createTextNode(text));\r\n  return button;\r\n}\r\n\r\n// returns dom for alert banner\r\nfunction getInfoAlertDom(type, label, msg){\r\n  var ald = document.createElement('div');\r\n  if(type == 'info') ald.setAttribute('class', 'terminus-alert terminus-alert-success');\r\n  else ald.setAttribute('class', 'alert');\r\n  var str = document.createElement('STRONG');\r\n  str.innerHTML = label;\r\n  ald.appendChild(str);\r\n  var txt = document.createTextNode(msg);\r\n  ald.appendChild(txt);\r\n  return ald;\r\n} // getInfoAlertDom()\r\n\r\n// formats response results from platform\r\nfunction getResponse(currForm, action, response, terminator){\r\n\r\n  var rd = document.createElement('div');\r\n\r\n  // get header result\r\n  rd.appendChild(getHeaderDom('Result'));\r\n  var br = document.createElement('BR');\r\n  rd.appendChild(br);\r\n\r\n  var data = JSON.stringify(response, 0, 4);\r\n\r\n  var pre = document.createElement('pre');\r\n  pre.setAttribute('class', 'terminus-api-view terminus-scheme-pre');\r\n  pre.innerHTML = data;\r\n\r\n  var cm = stylizeCodeDisplay(terminator, pre, rd, 'javascript');\r\n  if(!cm) rd.appendChild(pre);\r\n\r\n  var br = document.createElement('BR');\r\n  rd.appendChild(br);\r\n\r\n  currForm.appendChild(rd);\r\n\r\n  return currForm;\r\n}\r\n\r\n// formats the response from fetch call and spits out Http header and result\r\nfunction showHttpResult(response, action, currForm, terminator){\r\n    //var currForm = document.createElement('div');\r\n\r\n    var br = document.createElement('BR');\r\n    currForm.appendChild(br);\r\n    var br = document.createElement('BR');\r\n    currForm.appendChild(br);\r\n\r\n    // get header result\r\n    currForm.appendChild(getHeaderDom('HTTP Header'));\r\n\r\n    var br = document.createElement('BR');\r\n    currForm.appendChild(br);\r\n\r\n     var retHttpHeaders  = '';\r\n\r\n     // iterate over all headers\r\n     for (let [key, value] of response.headers) {\r\n       retHttpHeaders = retHttpHeaders +  `${key} = ${value}` + '\\n';\r\n     }\r\n\r\n    // http header result\r\n    var hdres = document.createElement('pre');\r\n    hdres.setAttribute('class', 'terminus-api-signature-pre');\r\n    var txt = document.createTextNode(retHttpHeaders);\r\n    hdres.appendChild(txt);\r\n\r\n    var cm = stylizeCodeDisplay(terminator, hdres, currForm, 'message/http');\r\n    if(!cm) currForm.appendChild(hdres);\r\n\r\n    return response.json()\r\n    .then(function(response){\r\n      getResponse(currForm, action, response, terminator); // get return response\r\n    })\r\n\r\n} // UTILS.showHttpResult()\r\n\r\n\r\nfunction deleteStylizedEditor(ui, qip){\r\n    if(ui.pluginAvailable(\"codemirror\")){\r\n\t\tvar cm = qip.nextElementSibling;\r\n\t\tcm.setAttribute('class', 'terminus-hide');\r\n\t\tTerminusClient.FrameHelper.removeChildren(cm);\r\n\t}\r\n}\r\n\r\n/* ui: terminus ui reference\r\n   txt: text area to be stylized\r\n   view: defines the size of editor to appear in pages (schema/ query)\r\n   mode: format to be displayed in\r\n*/\r\nfunction stylizeEditor(ui, txt, view, mode){\r\n    if(ui){\r\n        var cmConfig = ui.pluginAvailable(\"codemirror\");\r\n        if(!(cmConfig)) return;\r\n        var cm = new Codemirror(txt, mode, cmConfig);\r\n    }\r\n\telse{\r\n        var cm = new Codemirror(txt, mode, {});\r\n    }\r\n\tvar ar = cm.colorizeTextArea(view);\r\n\tcm.updateTextArea(ar);\r\n}\r\n\r\n/* ui: terminus ui reference\r\n   txt: text area to be stylized\r\n   dom: stylized pre area is appended to dom\r\n   mode: format to be displayed in\r\n*/\r\nfunction stylizeCodeDisplay(ui, txt, dom, mode){\r\n    if(ui){\r\n        var cmConfig = ui.pluginAvailable(\"codemirror\");\r\n        if(!(cmConfig)) return false;\r\n        var cm = new Codemirror(txt, mode, cmConfig);\r\n    }\r\n    else var cm = new Codemirror(txt, mode, {});\r\n    var pr = cm.colorizePre();\r\n    if(dom) dom.appendChild(pr);\r\n    return true;\r\n}\r\n\r\n/* name: classname to find and remove classes from elements\r\n*/\r\nfunction removeSelectedNavClass(name){\r\n    var el = document.getElementsByClassName(name);\r\n    if (el.length < 1) return;\r\n    for(var i=0; i<(el.length + 1); i++){\r\n        el[i].classList.remove(name);\r\n    }\r\n}\r\n\r\nfunction setSelectedSubMenu(a){\r\n    removeSelectedNavClass(\"terminus-submenu-selected\");\r\n    a.classList.add(\"terminus-submenu-selected\");\r\n}\r\n\r\nfunction setSelected(el, className){\r\n    var par = el.parentElement;\r\n    for(var i=0; i<par.childNodes.length; i++){\r\n        if(par.childNodes[i].classList.contains(className))\r\n            par.childNodes[i].classList.remove(className);\r\n    }\r\n    el.classList.add(className);\r\n}\r\n\r\n// toggles between contents\r\nfunction tolggleContent(icon, content){\r\n    if (content.style.display === \"block\"){\r\n        removeSelectedNavClass(\"fa-chevron-up\");\r\n        icon.classList.add(\"fa-chevron-down\");\r\n        content.style.display = \"none\";\r\n    }\r\n    else{\r\n        removeSelectedNavClass(\"fa-chevron-down\");\r\n        icon.classList.add(\"fa-chevron-up\");\r\n        content.style.display = \"block\";\r\n    }\r\n}\r\n\r\n// controls current selected nav bar\r\nfunction activateSelectedNav(nav, terminator){\r\n    removeSelectedNavClass(\"terminus-selected\");\r\n\t//checkDocumentSubMenus(terminator);\r\n\tnav.classList.add(\"terminus-selected\");\r\n}\r\n\r\nfunction hideDocumentSubMenus(el){\r\n\tif(el.classList.contains('terminus-display')){\r\n\t\tel.classList.remove('terminus-display');\r\n\t\tel.classList.add('terminus-hide');\r\n\t}\r\n}\r\n\r\nfunction checkDocumentSubMenus(terminator){\r\n\tif(terminator.ui.showControl(\"get_document\")) {\r\n\t\tvar gd = document.getElementsByClassName('terminus-get-doc');\r\n\t\thideDocumentSubMenus(gd[0]);\r\n\t}\r\n\tif(terminator.ui.showControl(\"create_document\")) {\r\n\t\tvar cd = document.getElementsByClassName('terminus-create-doc');\r\n\t\thideDocumentSubMenus(cd[0]);\r\n\t}\r\n}\r\n\r\nfunction toggleVisibility(el){\r\n\tif(el.classList.contains('terminus-display')){\r\n\t\tel.classList.remove('terminus-display');\r\n\t\tel.classList.add('terminus-hide');\r\n\t}\r\n    else if(el.classList.contains('terminus-hide')){\r\n        el.classList.remove('terminus-hide');\r\n\t\tel.classList.add('terminus-display');\r\n\t}\r\n}\r\n\r\nfunction extractValueFromCell(cellValue){\r\n    var ihtml = new DOMParser().parseFromString(cellValue, \"text/xml\");\r\n    return ihtml.firstChild.innerHTML;\r\n}\r\n\r\nfunction displayDocumentSubMenus(ui) {\r\n\t//display submenus on click of documents\r\n\tif(ui.showControl(\"get_document\")) {\r\n\t\tvar gd = document.getElementsByClassName('terminus-get-doc');\r\n\t\tshowSubMenus(gd[0]);\r\n\t}\r\n\tif(ui.showControl(\"create_document\")) {\r\n\t\tvar cd = document.getElementsByClassName('terminus-create-doc');\r\n\t\tshowSubMenus(cd[0]);\r\n\t}\r\n}\r\n\r\nfunction checkForMandatoryId(){\r\n    var objId = document.getElementsByClassName('terminus-object-id-input');\r\n    if(objId.length>0){\r\n        if(!objId[0].value){\r\n            objId[0].setAttribute('placeholder', 'Required field');\r\n            objId[0].style.background = '#f8d7da';\r\n            return false;\r\n        }\r\n        else return true;\r\n    }\r\n}\r\n\r\nfunction showSubMenus (el){\r\n\tel.classList.remove('terminus-hide');\r\n\tel.classList.add('terminus-display');\r\n}\r\n\r\n// function which generates query based on current settings from different screens of dashboard\r\nfunction getCurrentWoqlQueryObject(query, settings){\r\n\tvar qval;\r\n    if(!query) query = settings.query;\r\n\tswitch(query){\r\n\t\tcase 'Show_All_Schema_Elements':\r\n\t\t\tqval = TerminusClient.WOQL.limit(settings.pageLength)\r\n                        .start(settings.start)\r\n                        .elementMetadata();\r\n\t\tbreak;\r\n\t\tcase 'Show_All_Classes':\r\n\t\t\tqval = TerminusClient.WOQL.limit(settings.pageLength)\r\n                        .start(settings.start)\r\n                        .classMetadata();\r\n\t\tbreak;\r\n\t\tcase 'Show_All_Data':\r\n\t\t\tqval = TerminusClient.WOQL.limit(settings.pageLength)\r\n                        .start(settings.start)\r\n                        .getEverything();\r\n\t\tbreak;\r\n\t\tcase 'Show_All_Documents':\r\n\t\t\tqval = TerminusClient.WOQL.limit(settings.pageLength)\r\n                        .start(settings.start)\r\n                        .getAllDocuments();\r\n\t\tbreak;\r\n        case 'Show_All_Document_classes':\r\n            qval = TerminusClient.WOQL.limit(settings.pageLength)\r\n                        .start(settings.start)\r\n                        .documentMetadata();\r\n        break;\r\n        case 'Show_Document_Classes':\r\n            qval = TerminusClient.WOQL.limit(settings.pageLength)\r\n                        .start(settings.start).and(\r\n                        TerminusClient.WOQL.quad(\"v:Element\", \"rdf:type\", \"owl:Class\", \"db:schema\"),\r\n                        TerminusClient.WOQL.abstract(\"v:Element\"),\r\n                        TerminusClient.WOQL.sub(\"v:Element\", \"tcs:Document\"),\r\n                        TerminusClient.WOQL.opt().quad(\"v:Element\", \"rdfs:label\", \"v:Label\", \"db:schema\"),\r\n                        TerminusClient.WOQL.opt().quad(\"v:Element\", \"rdfs:comment\", \"v:Comment\", \"db:schema\"));\r\n        break;\r\n        case 'Show_All_Properties':\r\n            qval = TerminusClient.WOQL.limit(settings.pageLength)\r\n                        .start(settings.start)\r\n                        .propertyMetadata();\r\n        break;\r\n\t\tdefault:\r\n\t\t\tconsole.log('Invalid query ' + query + ' passed in WOQLTextboxGenerator');\r\n\t\tbreak;\r\n\t}\r\n\treturn qval;\r\n}\r\n\r\n// removes spaces\r\nfunction trimValue(text){\r\n    (text).replace(/[\\s\\t\\r\\n\\f]/g,'');\r\n    return text;\r\n}\r\n\r\n// query string\r\nfunction getqObjFromInput(q){\r\n    const WOQL = TerminusClient.WOQL ;\r\n    //var query = 'WOQL.' + q;\r\n    var query = q;\r\n    try {\r\n        var qObj = eval(query);\r\n        this.qObj = qObj;\r\n        return qObj;\r\n    }\r\n    catch(e){\r\n        console.log('Error in getting woql object ',e.toString());\r\n    }\r\n}\r\n\r\nmodule.exports={tolggleContent,\r\n               removeSelectedNavClass,\r\n               stylizeCodeDisplay,\r\n               stylizeEditor,\r\n               deleteStylizedEditor,\r\n               showHttpResult,\r\n               getHeaderDom,\r\n               getInfoAlertDom,\r\n               getFunctionSignature,\r\n               toggleVisibility,\r\n               extractValueFromCell,\r\n               displayDocumentSubMenus,\r\n               setSelectedSubMenu,\r\n               checkForMandatoryId,\r\n               activateSelectedNav,\r\n               getCurrentWoqlQueryObject,\r\n               getButton,\r\n               trimValue,\r\n               setSelected,\r\n               getqObjFromInput}\r\n","const TerminusPluginManager = require('../plugins/TerminusPlugin');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\nlet HTMLFrameHelper = {};\r\n\r\nHTMLFrameHelper.getActionControl = function(type, control, label, callback, disabled){\r\n\tvar pman = new TerminusPluginManager();\r\n\tvar dpropDOM = document.createElement(\"span\");\r\n\tdpropDOM.setAttribute(\"class\", \"terminus-action-control terminus-save-btn \" + type + \"-\" + control);\r\n\tvar pman = new TerminusPluginManager();\r\n    /*if(pman.pluginAvailable(\"font-awesome\")){\r\n\t\tvar icon = document.createElement('icon');\r\n\t\tvar faic = this.getControlIcon(control);\r\n\t\tif(disabled){\r\n\t\t\ticon.setAttribute(\"class\", \"terminus-frame-control frame-control-action action-disabled fa fa\" + faic + \" \" + type + \"-\" + control + \"-disabled terminus-font-align\");\r\n\t\t\ticon.setAttribute(\"title\", disabled);\r\n\t\t}\r\n\t\telse {\r\n\t\t\ticon.setAttribute(\"class\", \"terminus-frame-control frame-control-action frame-control-action fa fa\" + faic + \" \" + type + \"-\" + control + \" terminus-font-align\");\r\n\t\t\ticon.addEventListener(\"click\", function(){\r\n\t\t\t\tcallback(control);\r\n\t\t\t});\r\n\t\t}\r\n\t\tdpropDOM.appendChild(icon);\r\n\t}\r\n\telse{*/\r\n\t\tvar button = document.createElement(\"button\");\r\n\t\tbutton.appendChild(document.createTextNode(label));\r\n\t\tif(disabled){\r\n\t\t\tbutton.setAttribute(\"class\", \"terminus-frame-control terminus-frame-btn frame-control-action action-disabled \" + type + \"-\" + control + \"-disabled\");\r\n\t\t\tbutton.setAttribute(\"title\", disabled);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tbutton.setAttribute(\"class\", \"terminus-frame-control terminus-frame-btn frame-control-action \" + type + \"-\" + control);\r\n\t\t\tbutton.addEventListener(\"click\", function(){\r\n\t\t\t\tif(this.innerHTML == 'Save'){\r\n\t\t\t\t\tvar objId = document.getElementsByClassName('terminus-object-id-input');\r\n\t\t\t\t\tif(objId.length>0){\r\n\t\t\t\t\t\tif(!objId[0].value){\r\n\t\t\t\t\t\t\tobjId[0].setAttribute('placeholder', 'Required field');\r\n\t\t\t\t\t\t\tobjId[0].style.background = '#f8d7da';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse callback(control);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse callback(control);\r\n\t\t\t\t}\r\n\t\t\t\telse callback(control);\r\n\t\t\t\t//(control);\r\n\t\t\t});\r\n\t\t}\r\n\t\tdpropDOM.appendChild(button);\r\n\t//}\r\n\treturn dpropDOM;\r\n}\r\n\r\nHTMLFrameHelper.getSettingsControl = function(view){\r\n\tvar pman = new TerminusPluginManager();\r\n\tif(pman.pluginAvailable(\"font-awesome\")){\r\n\t\tvar icon = document.createElement('icon');\r\n\t\tif(view == 'property') icon.setAttribute('class', 'fa fa-cog terminus-pointer');\r\n\t\telse if(view == 'data') icon.setAttribute('class', 'fa fa-edit terminus-pointer');\r\n\t\ticon.setAttribute('style', 'margin: 10px;')\r\n\t\treturn icon;\r\n\t}\r\n\telse{\r\n\t\tvar button = document.createElement(\"button\");\r\n\t\tbutton.setAttribute('class', 'terminus-btn');\r\n\t\tbutton.appendChild(document.createTextNode('Settings'));\r\n\t\treturn button;\r\n\t}\r\n}\r\n\r\nHTMLFrameHelper.getControlIcon = function(control){\r\n\tvar icon;\r\n\tswitch(control){\r\n\t\tcase 'delete':\r\n\t\t\ticon = '-alt-delete';\r\n\t\tbreak;\r\n\t\tcase 'add':\r\n\t\t\ticon = '-plus';\r\n\t\tbreak;\r\n\t\tcase 'reset':\r\n\t\t\ticon = '-undo';\r\n\t\tbreak;\r\n\t\tcase 'save':\r\n\t\t\ticon = '-save';\r\n\t\tbreak;\r\n\t\tcase 'hide':\r\n\t\t\ticon = '-eye-slash';\r\n\t\tbreak;\r\n\t}\r\n\treturn icon;\r\n}\r\n\r\nHTMLFrameHelper.getSelectionControl = function(type, options, selected, callback){\r\n\tvar sel = document.createElement(\"select\");\r\n\tsel.setAttribute(\"class\", \"terminus-frame-selector frame-control-selection \" + type);\r\n\tfor(var i = 0; i < options.length; i++){\r\n\t\tvar opt = document.createElement(\"option\");\r\n\t\tif(typeof options[i] == \"object\"){\r\n\t\t\topt.value = options[i].value;\r\n\t\t\tvar label = (options[i].label ?  document.createTextNode(options[i].label) : document.createTextNode(TerminusClient.FrameHelper.labelFromURL(options[i].value)));\r\n\t\t\topt.appendChild(label);\r\n\t\t}\r\n\t\telse {\r\n\t\t\topt.value = options[i];\r\n\t\t\tlabel = TerminusClient.FrameHelper.labelFromURL(opt.value);\r\n\t\t\topt.appendChild(document.createTextNode(label));\r\n\t\t}\r\n\t\tif(selected == opt.value){\r\n\t\t\topt.setAttribute(\"selected\", \"selected\");\r\n\t\t}\r\n\t\tsel.appendChild(opt);\r\n\t}\r\n\tsel.addEventListener(\"change\", function(){\r\n\t\tcallback(this.value);\r\n\t});\r\n\treturn sel;\r\n}\r\n\r\nHTMLFrameHelper.getModeSelectorDOM = function(which, renderer){\r\n\tvar viewsDOM = document.createElement(\"span\");\r\n\tviewsDOM.setAttribute(\"class\", \"terminus-mode terminus-\"+which+\"-mode\");\r\n\tif(renderer.mode == \"view\"){\r\n\t\tvar callback = function(){ renderer.setMode(\"edit\");}\r\n\t\tviewsDOM.appendChild(HTMLFrameHelper.getActionControl(\"terminus-mode terminus-\"+which+\"-mode\", \"edit\", \" Edit \", callback));\r\n\t}\r\n\telse if(renderer.isNew()){\r\n\t\treturn false;\r\n\t}\r\n\telse {\r\n\t\tvar callback = function(){ renderer.cancel();}\r\n\t\tviewsDOM.appendChild(HTMLFrameHelper.getActionControl(which, \"cancel\", \"Cancel\", callback));\r\n\t}\r\n\treturn viewsDOM;\r\n}\r\n\r\nHTMLFrameHelper.goToName = function(s, p, i){\r\n\tvar url = window.location.href;\r\n\tif(url){\r\n\t\tvar wbits = url.split(\"#\");\r\n\t\tvar loc = wbits[0];\r\n\t\tvar sh = TerminusClient.FrameHelper.getShorthand(s);\r\n\t    if(!sh) sh = s;\r\n\t\tvar bits = sh.split(\":\");\r\n\t\tif(bits.length > 1) sh = bits[1];\r\n\t\tvar htmlid = sh;\r\n\t\tif(p){\r\n\t\t\tvar prop = TerminusClient.FrameHelper.getShorthand(p);\r\n\t\t\tif(!prop ) prop = p;\r\n\t\t\tvar bits = prop.split(\":\");\r\n\t\t\tif(bits.length > 1) prop = bits[1];\r\n\t\t\thtmlid += \"_\" + prop;\r\n\t\t\tif(i){\r\n\t\t\t\thtmlid += \"_\" + i;\r\n\t\t\t}\r\n\t\t}\r\n\t\twindow.location = loc + \"#\" + htmlid;\r\n\t}\r\n}\r\n\r\nHTMLFrameHelper.wrapShortenedText = function(wrap, text, max_cell_size, max_word_size){\r\n\tif(max_cell_size && (text.length > max_cell_size)){\r\n\t\twrap.setAttribute(\"title\", text);\r\n\t\ttext = text.substring(0, max_cell_size) + \"...\";\r\n\t}\r\n\tif(text && text.length > max_word_size){\r\n\t\tconst replacements = {}\r\n\t\tconst words = text.split(\" \");\r\n\t\tfor(var i = 0; i < words.length; i++){\r\n\t\t\tvar word = words[i];\r\n\t\t\tif(word.length > max_word_size){\r\n\t\t\t\twrap.setAttribute(\"title\", text);\r\n\t\t\t\tvar newstr = word.substring(0, max_word_size) + \"...\";\r\n\t\t\t\treplacements[word] = newstr;\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor(var k in replacements){\r\n\t\t\ttext = text.replace(k, replacements[k]);\r\n\t\t}\r\n\t}\r\n\twrap.appendChild(document.createTextNode(text));\r\n}\r\n\r\nHTMLFrameHelper.getVariableValueFromBinding = function(varname, bind){\r\n\tfor(var key in bind){\r\n\t\tvar skey = key.substring(key.lastIndexOf(\"/\")+1);\r\n\t\tif(skey == varname){\r\n\t\t\tconst obj = bind[key];\r\n\t\t\tif(typeof obj == \"object\" && obj['@value']) return obj['@value'];\r\n\t\t\treturn obj;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\n\r\nHTMLFrameHelper.getInfoboxDOM = function(type, label, value, help, input){\r\n\t/*var frow = this.getFrameRow();\r\n\tvar fgroup = this.getFrameGroup(frow);*/\r\n\tvar infoDOM = document.createElement(\"span\");\r\n\tinfoDOM.setAttribute(\"class\", \"terminus-frame-infobox-box \" + \"terminus-\" +type );\r\n\t//fgroup.appendChild(infoDOM);\r\n\tif(help){\r\n\t\tinfoDOM.setAttribute(\"title\", help);\r\n\t}\r\n\tif(label){\r\n\t\tvar linfo = document.createElement(\"span\");\r\n\t\tlinfo.setAttribute(\"class\", \"terminus-frame-infobox-label \" + \"terminus-\" +type + \"-label\");\r\n\t\tlinfo.appendChild(document.createTextNode(label));\r\n\t\tinfoDOM.appendChild(linfo);\r\n\t}\r\n\tvar lspacer = document.createElement(\"span\");\r\n\tlspacer.setAttribute(\"class\", \"terminus-frame-infobox-spacer \" + \"terminus-\" +type + \"-spacer\");\r\n\tlspacer.appendChild(document.createTextNode(\" \"));\r\n\tinfoDOM.appendChild(lspacer);\r\n\tvar lval = document.createElement(\"span\");\r\n\tlval.setAttribute(\"class\", \"terminus-frame-infobox-value \" + \"terminus-\" +type + \"-value\");\r\n\tif(input){\r\n\t\tinput.value = value;\r\n\t\tlval.appendChild(input);\r\n\t}\r\n\telse if(value) {\r\n\t\tvar sh = TerminusClient.FrameHelper.getShorthand(value);\r\n        if(sh){\r\n    \t   \tvar bits = sh.split(\":\");\r\n            sh = bits[1];\r\n   \t\t\tlval.setAttribute(\"title\", value);\r\n\t\t\tlval.appendChild(document.createTextNode(sh));\r\n\t\t}\r\n\t\telse {\r\n\t\t\tlval.appendChild(document.createTextNode(value));\r\n\t\t}\r\n\t}\r\n\tinfoDOM.appendChild(lval);\r\n\treturn infoDOM;\r\n}\r\n\r\n/*\r\n * HTML drawing function for document rendering \r\n */\r\n\r\nHTMLFrameHelper.getFrameDOM = function(scope, frame, orientation, hfeatures, features){\r\n\tif(frame.display_options.hidden) return false;\r\n\tvar framedom = HTMLFrameHelper.getFrameHolderDOM(scope, frame, orientation);\r\n\tif(typeof frame.display_options.header != \"undefined\"){\r\n\t\tif(typeof frame.display_options.header == \"function\"){\r\n\t\t\tvar hd = frame.display_options.header(frame.display_options.header_features, hfeatures);\r\n\t\t\tframedom.appendChild(hd);\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tvar hd = HTMLFrameHelper.getFrameHeaderDOM(scope, frame, orientation, hfeatures);\r\n\t\tif(hfeatures) hd.appendChild(hfeatures);\r\n\t\tframedom.appendChild(hd);\r\n\t}\r\n\treturn framedom.appendChild(HTMLFrameHelper.getFrameBodyDOM(scope, frame, orientation, features));\r\n}\r\n\r\nHTMLFrameHelper.getFrameHolderDOM = function(scope, frame, orientation){\r\n\tvar pcls = \"terminus-\" + scope + \"-frame\";\r\n\tif(orientation == \"page\"){\r\n\t\tvar sp = document.createElement(\"div\");\r\n\t}\r\n\telse {\r\n\t\tvar sp = document.createElement(\"span\");\r\n\t}\r\n\tvar css = pcls + \" \" + pcls + \"-\" + orientation + \r\n\t\t(scope == \"object\" && frame.parent ? \"\" : \" terminus-root-frame\") \r\n\t\t+ \" \" + pcls + \"-\" + frame.display_options.mode;\r\n\tsp.setAttribute(\"class\", css);\r\n\tif(scope == \"object\"){\r\n\t\tsp.setAttribute(\"data-class\", frame.subjectClass());\r\n\t\tsp.setAttribute(\"data-id\", frame.subject());\t\t\r\n\t\tvar hid = this.hash(frame.subject());\r\n\t}\r\n\telse if(scope == \"property\"){\r\n\t\tsp.setAttribute('data-property', frame.property());\t\r\n\t\tvar hid = this.hash(frame.subject()+frame.property());\r\n\t}\r\n\telse if(scope == \"data\"){\r\n\t\tsp.setAttribute('data-value', frame.get());\r\n\t\tvar hid = this.hash(frame.subject() + frame.property() + frame.index);\r\n\t}\r\n\tvar idm = document.createElement(\"a\");\r\n\tidm.setAttribute(\"class\", \"terminus-\" + scope + \"-idmarker\");\r\n\tidm.setAttribute(\"name\", hid);\t\t\t\t\r\n    sp.appendChild(idm);\r\n\treturn sp;\r\n}\r\n\r\nHTMLFrameHelper.getFrameHeaderDOM = function(scope, frame, orientation, features){\r\n\tvar css = \"terminus-\" + scope + \"-header\";\r\n\tif(orientation == \"page\"){\r\n\t\tvar objDOM = document.createElement(\"div\");\r\n\t}\r\n\telse {\r\n\t\tvar objDOM = document.createElement(\"span\");\r\n\t}\r\n\tobjDOM.setAttribute(\"class\", css + \" \" + css + \"-\" + orientation);\r\n    if(features) objDOM.appendChild(features);\r\n\treturn objDOM;\r\n}\r\n\r\nHTMLFrameHelper.getFrameBodyDOM = function(scope, frame, orientation, features){\r\n\tvar css = \"terminus-\" + scope + \"-properties\";\r\n\tif(orientation == \"page\"){\r\n\t\tvar vholder = document.createElement(\"div\");\r\n\t}\r\n\telse {\r\n\t\tvar vholder = document.createElement(\"span\");\r\n\t}\r\n    vholder.setAttribute('class', css + \" \" + css + \"-\" + orientation);\r\n    if(features) vholder.appendChild(features);\r\n    return vholder;\r\n}\r\n\r\nHTMLFrameHelper.hash = function(s) {\r\n\tvar hash = 0, i, chr;\r\n\tif (s.length === 0) return hash;\r\n\tfor (i = 0; i < s.length; i++) {\r\n\t    chr   = s.charCodeAt(i);\r\n\t    hash  = ((hash << 5) - hash) + chr;\r\n\t    hash |= 0; // Convert to 32bit integer\r\n\t}\r\n\treturn hash;\r\n};\r\n\r\nHTMLFrameHelper.getFeatureDOM = function(feature, scope, frame){\r\n\tif(feature == \"id\"){\t\r\n\t\tif(scope == \"object\") var val = frame.subject();\r\n\t\telse if(scope == \"property\") var val = frame.property();\r\n\t\tif(val == \"_:\") var val = \"New Document\";\r\n\t\treturn HTMLFrameHelper.getInfoboxDOM(\"object-id\", \"ID\", val, \"The URL that identifies this data object\");\r\n\t}\r\n\telse if(feature == \"summary\"){\r\n\t\tvar sum = frame.getSummary();\r\n\t\treturn HTMLFrameHelper.getInfoboxDOM(scope + \"-summary\", false, sum.long, sum.status);\r\n\t}\r\n\telse if(feature == \"label\"){\r\n\t\tvar lab = frame.getLabel();\r\n\t\tif(lab){\r\n\t\t\treturn HTMLFrameHelper.getInfoboxDOM(scope + \"-type\", false, lab);\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\telse if(feature == \"status\"){\r\n\t\tvar sum = frame.getSummary();\r\n\t\treturn HTMLFrameHelper.getInfoboxDOM(scope + \"-status-\"+sum.status, false, sum.status, sum.status);\r\n\t}\r\n\telse if(feature == \"comment\"){\r\n\t\tvar lab = frame.getComment();\r\n\t\treturn HTMLFrameHelper.getInfoboxDOM(\"property-comment\", false, lab);\r\n\t}\r\n\telse if(feature == \"type\"){\r\n\t\tif(scope == \"property\" && frame.display_options.mode == \"edit\" && frame.parent && frame.parent.isClassChoice() && frame.isNew()){\r\n\t\t\treturn this.getClassChoiceTypeSelector(frame);\r\n\t\t}\r\n\t\tif(scope == \"object\") var lab = frame.subjectClass();\r\n\t\telse if(scope == \"property\") var lab = frame.range();\r\n\t\telse if(scope == \"data\") var lab = frame.getType();\r\n\t\tif(lab){\r\n\t\t\treturn HTMLFrameHelper.getInfoboxDOM(scope + \"-type\", \"Type\", lab);\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\telse if(feature == \"delete\"){\r\n\t\tvar callback = function(){frame.delete()};\r\n\t\tvar disabled = false;\r\n\t\tif(!frame.cardControlAllows(\"delete\", scope)){\r\n\t\t\tif(!frame.display_options.show_disabled_buttons){\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tdisabled = \"Cardinality rules prevent deleting this element\";\r\n\t\t}\r\n\t\treturn HTMLFrameHelper.getActionControl(scope, \"delete\", \"Delete\", callback, disabled);\r\n\t}\r\n\telse if(feature == \"clone\"){\r\n\t\tvar callback = function(){frame.clone()};\r\n\t\tvar disabled = false;\r\n\t\tif(!frame.cardControlAllows(\"clone\", scope)){\r\n\t\t\tif(!frame.display_options.show_disabled_buttons){\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tdisabled = \"Cardinality rules prevent cloning this element\";\r\n\t\t}\r\n\t\treturn HTMLFrameHelper.getActionControl(scope, \"clone\", \"Clone\", callback, disabled);\r\n\t}\r\n\telse if(feature == \"reset\"){\r\n\t\tvar callback = function(){frame.reset()};\r\n\t\tvar disabled = false;\r\n\t\tif(!frame.isUpdated()){\r\n\t\t\tif(!frame.display_options.show_disabled_buttons){\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tdisabled = \"No changes have been made to this element\";\r\n\t\t}\r\n\t\treturn HTMLFrameHelper.getActionControl(scope, \"reset\", \"Reset\", callback, disabled);\r\n\t}\r\n\telse if(feature == \"hide\"){\r\n\t\tvar callback = function(){frame.hide()};\r\n\t\treturn HTMLFrameHelper.getActionControl(scope, \"hide\", \"Hide\", callback);\r\n\t}\r\n\telse if(feature == \"show\"){\r\n\t\tvar callback = function(){frame.show()};\r\n\t\treturn HTMLFrameHelper.getActionControl(scope, \"show\", \"Show\", callback);\r\n\t}\r\n\telse if(feature == \"update\"){\r\n\t\tvar callback = function(){frame.save()};\r\n\t\tif(!frame.isUpdated() && !frame.display_options.show_disabled_buttons){\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tvar disabled = frame.isUpdated() ? false : \"No changes have been made to this element\";\r\n\t\treturn HTMLFrameHelper.getActionControl(scope, \"save\", \"Save\", callback, disabled);\r\n\t}\r\n\telse if(feature == \"viewer\"){\r\n\t\treturn this.getViewerSelectorDOM(scope, frame);\r\n\t}\r\n\telse if(feature == \"view\"){\r\n\t\treturn this.getViewEntryDOM(scope, frame);\r\n\t}\r\n\telse if(feature == \"cardinality\"){\r\n\t\treturn this.getCardinalityDOM(scope, frame);\r\n\t}\r\n\telse if(feature == \"add\"){\r\n\t\treturn this.getAddDOM(scope, frame);\r\n\t}\r\n}\r\n\r\nHTMLFrameHelper.getViewerSelectorDOM = function(scope, frame){\r\n\tvar viewers = frame.terminus.datatypes.getAvailableViewers();\r\n\tvar r = this.terminus.datatypes.getRenderer(t);\r\n\r\n\tif(viewers && viewers.length){\r\n\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-\" + scope + \"-viewer\");\r\n\t\tvar callback = function(viewer){\r\n\t\t\tif(viewer){\r\n\t\t\t\tframe.setViewer(viewer);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar selected = frame.currentViewer();\r\n\t\tvar sel = HTMLFrameHelper.getSelectionControl(scope + '-viewer', viewers, selected, callback);\r\n\t\tmpropDOM.appendChild(sel);\r\n\t\treturn mpropDOM;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\n\r\n/* needs html viewer context for goto */\r\nHTMLFrameHelper.getViewEntryDOM = function(scope, frame){\r\n\tif(scope == \"object\"){\r\n\t\tvar viewables = frame.getFilledPropertyList();\r\n\t}\r\n\telse if(scope == \"property\"){\r\n\t\t\r\n\t}\r\n\tvar self = this;\r\n\tif(viewables && viewables.length){\r\n\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-\"+scope + \"-view-entry\");\r\n\t\tviewables.unshift({ value: \"\", label: \"View \" + scope});\r\n\t\tvar callback = function(add){\r\n\t\t\tif(add){\r\n\t\t\t\tframe.goToEntry(add);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar sel = HTMLFrameHelper.getSelectionControl(scope + \"-view-entry\", viewables, \"\", callback);\r\n\t\tmpropDOM.appendChild(sel);\r\n\t\treturn mpropDOM;\r\n\t}\r\n\treturn false;\r\n\t\r\n}\r\n\r\nHTMLFrameHelper.getCardinalityDOM = function(scope, frame){\r\n\tvar restriction = frame.getRestriction();\r\n\tif(restriction.min && restriction.max){\r\n\t\tif(restriction.min == restriction.max){\r\n\t\t\tvar lab = restriction.min;\r\n\t\t\tvar help = \"Cardinality: \" + restriction.min;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tvar lab = restriction.min + \"-\" + restriction.max;\r\n\t\t\tvar help = \"Minimum Cardinality: \" + restriction.min;\r\n\t\t\thelp += \", Maximum Cardinality: \" + restriction.max;\r\n\t\t}\r\n\t}\r\n\telse if(restriction.min){\r\n\t\tvar lab = \">\"+(restriction.min-1);\r\n\t\tvar help = \"Minimum Cardinality: \" + restriction.min;\r\n\t}\r\n\telse if(restriction.max){\r\n\t\tvar lab = \"<\"+(restriction.max+1);\r\n\t\tvar help = \"Maximum Cardinality: \" + restriction.max;\r\n\t}\r\n\telse {\r\n\t\treturn false;\r\n\t}\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"property-cardinality\", \"Cardinality\", lab, help);\r\n}\r\n\r\nHTMLFrameHelper.getClassChoiceTypeSelector = function(frame){\r\n\tvar cs = frame.parent.getAvailableClassChoices();\r\n\tif(cs && cs.length){\r\n\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-property-change-class\");\r\n\t\tvar mlabDOM = document.createElement(\"span\");\r\n\t\tmlabDOM.setAttribute(\"class\", \"terminus-property-change-label\");\r\n\t\tmlabDOM.appendChild(document.createTextNode(\"Type\"));\r\n\t\tmpropDOM.appendChild(mlabDOM);\r\n\t\tvar callback = function(cls){\r\n\t\t\tif(cls){\r\n\t\t\t\tframe.changeClass(cls);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"change-class\", cs, frame.subjectClass(), callback);\r\n\t\tmpropDOM.appendChild(sel);\r\n\t\treturn mpropDOM;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLFrameHelper.getAddDOM = function(scope, frame){\r\n\tif(scope == \"property\"){\r\n\t\tif(frame.isClassChoice()){\r\n\t\t\tvar cs = frame.getAvailableClassChoices();\r\n\t\t\tif(cs && cs.length){\r\n\t\t\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\t\t\tmpropDOM.setAttribute(\"class\", \"terminus-property-add-class\");\r\n\t\t\t\tcs.unshift({ value: \"\", label: \"Add Type\"});\r\n\t\t\t\tvar callback = function(cls){\r\n\t\t\t\t\tif(cls){\r\n\t\t\t\t\t\tframe.addClass(cls);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"add-property\", cs, \"\", callback);\r\n\t\t\t\tmpropDOM.appendChild(sel);\r\n\t\t\t\treturn mpropDOM;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(frame.cardControlAllows(\"add\") || frame.display_options.show_disabled_buttons){\r\n\t\t\tvar callback = function(){frame.add(\"edit\")};\r\n\t\t\tvar disabled = (frame.cardControlAllows(\"add\") ? false : \"Cardinality Rules Forbid Add\");\r\n\t\t\treturn HTMLFrameHelper.getActionControl(scope + \"-add-entry\", \"add\", \"Add\", callback, disabled);\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tvar addables = frame.getMissingPropertyList();\r\n\t\tif(addables && addables.length){\r\n\t\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\t\tmpropDOM.setAttribute(\"class\", \"terminus-\" + scope + \"-add-entry\");\r\n\t\t\taddables.unshift({ value: \"\", label: \"Add new \" + scope});\r\n\t\t\tvar callback = function(add){\r\n\t\t\t\tif(add){\r\n\t\t\t\t\tif(scope == \"object\") frame.addNewProperty(add);\r\n\t\t\t\t\telse if(scope == \"property\") frame.addNewValue(add);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif(frame.cardControlAllows(\"add\") || frame.display_options.show_disabled_buttons){\r\n\t\t\t\tvar disabled = (frame.cardControlAllows(\"add\") ? false : \"Cardinality rules forbid adding element\");\r\n\t\t\t\tvar sel = HTMLFrameHelper.getSelectionControl(scope + \"-add-entry\", addables, \"\", callback, disabled);\r\n\t\t\t\tmpropDOM.appendChild(sel);\r\n\t\t\t\treturn mpropDOM;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nmodule.exports=HTMLFrameHelper\r\n","const TerminusClient = require('@terminusdb/terminus-client');\r\nconst UTILS = require('../../Utils');\r\n/*\r\nqObj: WOQL object\r\nwidth: width of snippet in px\r\nheight: height of snippet in px\r\n*/\r\nfunction TerminusCodeSnippet(language, mode, format, width, height, placeholder){\r\n\tthis.language = (language ? language : \"woql\");//woql / rule\r\n\tthis.mode = (mode ? mode : \"view\");\r\n    this.width = (width ? width : 1200);\r\n\tthis.height = (height ? height : 300);\r\n\tthis.placeholder = (placeholder ? placeholder : \"\");\r\n    this.format = (format ? format : \"js\");\r\n    this.formats = {'js': \"WOQL.js\", 'jsonld': \"JSON-LD\"};\r\n    if(this.mode == 'view')\r\n        this.snippet = document.createElement('pre');\r\n    else {\r\n    \tthis.snippet = document.createElement('textarea');\r\n    \tthis.snippet.setAttribute(\"spellcheck\", \"false\");\r\n\t\tthis.snippet.setAttribute(\"class\", \"terminus-code-snippet\");\r\n    }\r\n}\r\n\r\nTerminusCodeSnippet.prototype.setQuery = function(q){\r\n\tthis.qObj = q;\r\n\tthis.refreshContents();\r\n}\r\n\r\nTerminusCodeSnippet.prototype.serialise = function(query, format){\r\n\tif(format == \"js\"){\r\n\t\treturn query.prettyPrint(4);\r\n\t}\r\n\telse {\r\n\t\treturn JSON.stringify(query.json(), undefined, 2);\r\n\t}\r\n}\r\n\r\n//parses a string encoding a woql in either json or js notation\r\nTerminusCodeSnippet.prototype.parseText = function(text, format){\r\n\ttry {\r\n\t\tvar WOQL = TerminusClient.WOQL;\r\n\t\tif(format == \"js\"){\r\n\t\t\tvar nw = eval(text);\r\n\t\t\tif(this.language == \"rule\"){\r\n\t\t\t\tthis.view = view;\r\n\t\t\t\treturn view;\r\n\t\t\t}\r\n\t\t\treturn nw;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tvar qval = JSON.parse(text);\r\n\t\t\tif(this.language == \"woql\"){\r\n\t\t\t\treturn WOQL.json(qval);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\treturn WOQL.loadConfig(qval);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tcatch(e){\r\n\t\tthis.error = \"Failed to parse Query \" + e.toString() + \" \" + text;\r\n\t\tconsole.error(this.error);\r\n\t\treturn false;\r\n\t}\r\n}\r\n\r\nTerminusCodeSnippet.prototype.getInputElement = function(){\r\n\treturn this.snippet;\r\n}\r\n\r\nTerminusCodeSnippet.prototype.readInput = function(){\r\n\tif(this.mode == \"edit\") {\r\n\t\tthis.qObj = this.parseText(this.snippet.value, this.format);\r\n\t\treturn this.qObj;\r\n\t}\r\n\treturn this.qObj;\r\n}\r\n\r\nTerminusCodeSnippet.prototype.get = function(){\r\n\treturn this.readInput();\r\n}\r\n\r\nTerminusCodeSnippet.prototype.getAsDOM = function(with_buttons){\r\n    var scont = document.createElement('div');\r\n\tscont.setAttribute('class', 'terminus-snippet-container terminus-display-flex')\r\n    // query\r\n    var snpc = document.createElement('div');\r\n    snpc.setAttribute('style', 'display:table-caption; margin: 20px');\r\n    if(this.placeholder)\r\n\t\tthis.snippet.setAttribute(\"placeholder\", this.placeholder);\r\n    if(this.width && this.height)\r\n\t\tthis.snippet.setAttribute(\"style\", \"width: \"+ this.width +\"px; height: \"+ this.height + \"px;\");\r\n    //if(this.language == \"woql\"){\r\n    \tsnpc.appendChild(this.getFormatButtons());\r\n    //}\r\n    //else {\r\n    //\tif(with_buttons) snpc.appendChild(this.getViewTypeButtons());\r\n    //}\r\n    if(this.qObj){\r\n    \tvar serial = this.serialise(this.qObj, this.format);\r\n\t\t//console.log('serial', serial);\r\n    \tif(this.mode == \"edit\"){\r\n    \t\tthis.snippet.value = serial;\r\n    \t}\r\n    \telse {\r\n    \t\tthis.snippet.appendChild(document.createTextNode(serial));\r\n    \t}\r\n\t}\r\n\telse {\r\n\t\tthis.snippet.value = \"\";\r\n\t}\r\n    snpc.appendChild(this.snippet);\r\n    if(this.mode == \"edit\"){\r\n    \tvar actbtn = this.getSubmitButton();\r\n    \tsnpc.appendChild(actbtn);\r\n    }\r\n    scont.appendChild(snpc);\r\n    return scont;\r\n}\r\n\r\nTerminusCodeSnippet.prototype.changeRuleView = function(nview){\r\n\tthis.snippet.value = \"view = WOQL.\"+ nview + \"()\";\r\n\tthis.readInput();\r\n\tthis.submit(this.qObj);\r\n}\r\n\r\n\r\nTerminusCodeSnippet.prototype.getIconsDOM = function(){\r\n    var bsp = document.createElement('span');\r\n    bsp.setAttribute('class', 'terminus-snippet-icons');\r\n    for(var i = 0; i<this.view_types.length; i++){\r\n\t\tvar isp = document.createElement('span');\r\n\t\tvar icon = document.createElement(\"i\");\r\n\t\ticon.title = this.view_types[i].label;\r\n\t\ticon.setAttribute(\"class\", this.view_types[i].icon);\r\n\t\tisp.appendChild(icon);\r\n\t\tisp.name = this.view_types[i].id;\r\n\t\tvar self = this;\r\n\t\tisp.addEventListener('click', function(){\r\n\t\t\tif(!(self.view && self.view.type == this.name)){\r\n\t\t\t\tself.changeRuleView(this.name);\r\n\t\t\t}\r\n\t\t});\r\n\t\tisp.addEventListener('mouseover', function(){\r\n\t\t\tif(!(self.view && self.view.type == this.name)){\r\n\t\t\t\tthis.style.cursor = \"pointer\";\r\n\t\t\t}\r\n\t\t});\r\n\t\tbsp.appendChild(isp);\r\n    }\r\n    return bsp;\r\n}\r\n\r\nTerminusCodeSnippet.prototype.getFormatButtons = function(){\r\n    var bsp = document.createElement('span');\r\n    bsp.setAttribute('class', 'terminus-snippet-panel');\r\n    //if(this.width) bsp.setAttribute(\"style\", \"width: \"+ this.width +\"px;\");\r\n    for(f in this.formats){\r\n        var btn = document.createElement('button');\r\n        btn.setAttribute('value', f);\r\n        btn.setAttribute('class', 'terminus-snippet-button');\r\n\t\tif(f == 'js') btn.classList.add('terminus-snippet-format-selected');\r\n        btn.appendChild(document.createTextNode(this.formats[f]));\r\n        var self = this;\r\n        btn.addEventListener('click', function(){\r\n\t\t\tUTILS.setSelected(this, 'terminus-snippet-format-selected');\r\n\t\t\tvar qobj = self.parseText(self.snippet.value, self.format);\r\n\t\t\tself.format = this.value;\r\n\t\t\tif(qobj) self.qObj = qobj;\r\n\t\t\tself.refreshContents();\r\n        })\r\n        bsp.appendChild(btn);\r\n    }\r\n    return bsp;\r\n}\r\n\r\nTerminusCodeSnippet.prototype.getSubmitButton = function(){\r\n    var actbtn = document.createElement('button');\r\n    actbtn.setAttribute('class', 'terminus-btn');\r\n\tactbtn.setAttribute('type', 'submit');\r\n\tvar txt = \"Submit\";\r\n\tif(this.language == \"WOQL\"){\r\n\t\ttxt = \"Submit Query\";\r\n\t}\r\n\telse if(this.language == \"rule\") {\r\n\t\ttxt = \"Update View\";\r\n\t}\r\n\telse if(this.language == \"code\"){\r\n\t\ttxt = \"Run Script\";\r\n\t}\r\n    actbtn.appendChild(document.createTextNode(txt));\r\n    actbtn.addEventListener('click', () => {\r\n\t\tthis.readInput();\r\n\t\tthis.submit(this.qObj);\r\n    });\r\n    return actbtn;\r\n}\r\n\r\nTerminusCodeSnippet.prototype.submit = function(){\r\n\talert(\"Submitted \" + JSON.stringify(this.qObj));\r\n}\r\n\r\nTerminusCodeSnippet.prototype.removeCodeMirror = function(){\r\n\tvar cm = this.snippet.nextSibling;\r\n\tif(!cm) return;\r\n\tif(cm.classList.contains('CodeMirror')) // remove code mirror\r\n\t\tTerminusClient.FrameHelper.removeElement(cm);\r\n}\r\n\r\nTerminusCodeSnippet.prototype.stylizeSnippet = function(){\r\n\tvar dimensions = {};\r\n\tdimensions.width = this.width;\r\n\tdimensions.height = this.height;\r\n\tthis.removeCodeMirror();\r\n\tif(this.mode == 'view')\r\n\t\tUTILS.stylizeCodeDisplay(null, this.snippet, null, 'javascript');\r\n\telse UTILS.stylizeEditor(null, this.snippet, dimensions, 'javascript'); // default view is js\r\n}\r\n\r\nTerminusCodeSnippet.prototype.refreshContents = function(qObj){\r\n\tqObj = qObj ? qObj : this.qObj;\r\n\tTerminusClient.FrameHelper.removeChildren(this.snippet);\r\n\tif(this.mode == \"edit\") this.snippet.value == \"\";\r\n\tif(!qObj) return;\r\n\tvar serial = this.serialise(this.qObj, this.format);\r\n\tif(this.mode == \"edit\"){\r\n\t\tthis.snippet.value = serial;\r\n\t\tif(this.snippet.nextSibling){\r\n\t\t\tthis.removeCodeMirror();\r\n\t\t\tif(this.format == 'js') var mode = 'javascript';\r\n\t\t\telse var mode = 'application/ld+json';\r\n\t\t\tUTILS.stylizeEditor(null,\r\n\t\t\t\t\t\t\t\tthis.snippet,\r\n\t\t\t\t\t\t\t\t{width: this.width, height: this.height},\r\n\t\t\t\t\t\t\t\tmode);\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tthis.snippet.appendChild(document.createTextNode(serial));\r\n\t\tUTILS.stylizeCodeDisplay(null, this.snippet, null, mode);\r\n\t}\r\n}\r\n\r\nmodule.exports = TerminusCodeSnippet;\r\n","function getErrorAsMessage(url, api, err) {\n\t// console.log('getErrorAsMessage');\n\tlet str = '';\n\tif (err.response) {\n\t\terr = err.response;\n\t\tif (err.data) str += `${formatErrorMessage(err.data)}`;\n\t} else if (err.body) str += `${formatErrorMessage(err.data)}`;\n\n\tif (err.status) str += `Code: ${err.status}`;\n\tif (err.action) str += `, Action: ${err.action}`;\n\tif (err.type) str += `, Type: ${err.type}`;\n\tif (url) str += `, url: ${url}`;\n\tif (api && api.method) str += `, method: ${api.method}`;\n\treturn str;\n}\n\nfunction formatErrorMessage(msg) {\n\tif (typeof msg === 'object') {\n\t\tlet nmsg = '';\n\t\tfor (const key of Object.keys(msg)) {\n\t\t\tnmsg += `${key} ${msg[key]} `;\n\t\t}\n\t\treturn nmsg;\n\t}\n\treturn msg;\n}\n\nfunction accessDenied(action, db, server) {\n\tconst err = {};\n\terr.status = 403;\n\terr.url = (server || '') + (db || '');\n\terr.type = 'client';\n\terr.action = action;\n\terr.body = `${err.action} not permitted for ${err.url}`;\n\treturn err;\n}\n\nfunction getAPIErrorMessage(url, api, err) {\n\treturn `API Error ${getErrorAsMessage(url, api, err)}`;\n}\n\nfunction getAccessDeniedMessage(url, api, err) {\n\treturn `Access Denied ${getErrorAsMessage(url, api, err)}`;\n}\n\nfunction getInvalidURIMessage(url, call) {\n\tconst str = `Invalid argument to\n            ${call}. \n            ${url}\n            is not a valid Terminus DB API endpoint`;\n\treturn str;\n}\n\n/**\n * Utility functions for generating and retrieving error messages\n * and storing error state\n */\n\nfunction parseAPIError(response) {\n\tconst err = {};\n\terr.status = response.status;\n\terr.type = response.type;\n\tif (response.data && typeof response.data === 'object') {\n\t\tlet msg;\n\t\ttry {\n\t\t\tmsg = response.text();\n\t\t} catch (e) {\n\t\t\ttry {\n\t\t\t\tmsg = response.json();\n\t\t\t} catch (error) {\n\t\t\t\tmsg = response.toString();\n\t\t\t}\n\t\t}\n\t\terr.body = msg;\n\t} else if (response.data) err.body = response.data;\n\terr.url = response.url;\n\terr.headers = response.headers;\n\terr.redirected = response.redirected;\n\treturn err;\n}\n\n\nmodule.exports = {\n\tgetErrorAsMessage,\n\tgetAPIErrorMessage,\n\tgetAccessDeniedMessage,\n\taccessDenied,\n\tgetInvalidURIMessage,\n\tparseAPIError\n};\n","/**\r\n * Helper functions for dealing with frames and linked data documents\r\n */\r\nconst FrameHelper = {\r\n\tstandard_urls: {\r\n\t\trdf: 'http://www.w3.org/1999/02/22-rdf-syntax-ns#',\r\n\t\trdfs: 'http://www.w3.org/2000/01/rdf-schema#',\r\n\t\txsd: 'http://www.w3.org/2001/XMLSchema#',\r\n\t\towl: 'http://www.w3.org/2002/07/owl#',\r\n\t\ttcs: 'http://terminusdb.com/schema/tcs#',\r\n\t\ttbs: 'http://terminusdb.com/schema/tbs#',\r\n\t\txdd: 'http://terminusdb.com/schema/xdd#',\r\n\t\tv: 'http://terminusdb.com/woql/variable/',\r\n\t\tterminus: 'http://terminusdb.com/schema/terminus#',\r\n\t\tvio: 'http://terminusdb.com/schema/vio#',\r\n\t\tdocs: 'http://terminusdb.com/schema/documentation#'\r\n\t}\r\n};\r\n\r\nFrameHelper.addURLPrefix = function (prefix, url) {\r\n\tthis.standard_urls[prefix] = url;\r\n};\r\n\r\n\r\nFrameHelper.removeChildren = function (node) {\r\n\tif (node) {\r\n\t\twhile (node.hasChildNodes()) {\r\n\t\t\tnode.removeChild(node.childNodes[0]);\r\n\t\t}\r\n\t}\r\n};\r\n\r\nFrameHelper.removeElement = function (node) {\r\n\tif (node) {\r\n\t\t\tnode.parentNode.removeChild(node);\r\n\t}\r\n}\r\n\r\nFrameHelper.empty = function (obj) {\r\n\t   // null and undefined are \"empty\"\r\n\tif (!obj) return true;\r\n\t// Assume if it has a length property with a non-zero value\r\n\t// that that property is correct.\r\n\tif (obj.length > 0) return false;\r\n\tif (obj.length === 0) return true;\r\n\t// Otherwise, does it have any properties of its own?\r\n\t// Note that this doesn't handle\r\n\t// toString and valueOf enumeration bugs in IE < 9\r\n\t// for (const key in obj) {\r\n\tif (typeof obj === 'object') {\r\n\t\tfor (const key of Object.keys(obj)) {\r\n\t\t\tif (Object.prototype.hasOwnProperty.call(obj, key)) return false;\r\n\t\t}\r\n\t}\r\n\treturn true;\r\n};\r\n\r\nFrameHelper.genBNID = function () {\r\n\tconst r = Math.random().toString(36).substring(7);\r\n\tconst d = new Date();\r\n\tconst bnid = `_:${r}${d.getTime()}`;\r\n\treturn bnid;\r\n};\r\n\r\nFrameHelper.getShorthand = function (link) {\r\n\tif (typeof link === 'object' && link.length) link = link[0];\r\n\tif (link && typeof link === 'string') {\r\n\t\tfor (const pref of Object.keys(this.standard_urls)) {\r\n\t\t\tconst full = this.standard_urls[pref];\r\n\t\t\tif (link.substring(0, full.length) === full) {\r\n\t\t\t\tconst sh = `${pref}:${link.substring(full.length)}`;\r\n\t\t\t\treturn sh;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nFrameHelper.compareIDs = function (ida, idb) {\r\n\tif (ida === idb) return true;\r\n\tif (this.unshorten(ida) === idb) return true;\r\n\tif (this.unshorten(ida) === this.unshorten(idb)) return true;\r\n\tconst sha = this.getShorthand(ida);\r\n\tconst shb = this.getShorthand(idb);\r\n\tif (sha && ((sha === idb) || (sha === shb))) return true;\r\n\tif (shb && shb === ida) return true;\r\n\treturn false;\r\n};\r\n\r\n\r\nFrameHelper.shorten = function (url, prefixes) {\r\n\tfor (const pref in prefixes) {\r\n\t\tif (prefixes[pref] == url.substring(0, prefixes[pref].length)) {\r\n\t\t\treturn (`${pref}:${url.substring(prefixes[pref].length)}`);\r\n\t\t}\r\n\t}\r\n\treturn url;\r\n};\r\n\r\nFrameHelper.unshorten = function (url) {\r\n\tif (this.validURL(url)) return url;\r\n\tif (!url) return url;\r\n\tconst bits = url.split(':');\r\n\tif (bits[1]) {\r\n\t\tif (this.standard_urls[bits[0]]) {\r\n\t\t\treturn this.standard_urls[bits[0]] + bits[1];\r\n\t\t}\r\n\t}\r\n\treturn url;\r\n};\r\n\r\n// Valid URLs are those that start with http:// or https://\r\nFrameHelper.validURL = function (str) {\r\n\tif (str && (str.substring(0, 7) === 'http://' || str.substring(0, 8) === 'https://')) return true;\r\n\treturn false;\r\n};\r\n\r\n\r\nFrameHelper.labelFromURL = function (url) {\r\n\tlet nurl = this.urlFragment(url);\r\n\tnurl = (nurl || url);\r\n\tif (nurl.lastIndexOf('/') < nurl.length - 1) {\r\n\t\tnurl = nurl.substring(nurl.lastIndexOf('/') + 1);\r\n\t}\r\n\tnurl = nurl.replace('_', ' ');\r\n\treturn nurl.charAt(0).toUpperCase() + nurl.slice(1);\r\n};\r\n\r\nFrameHelper.urlFragment = function (url) {\r\n\turl = (typeof url !== 'string') ? window.location.href : url;\r\n\tlet bits = url.split('#');\r\n\tif (bits.length <= 1) {\r\n\t\tif (!this.validURL(url)) {\r\n\t\t\tbits = url.split(':');\r\n\t\t}\r\n\t}\r\n\tif (bits.length >= 1) {\r\n\t\tconst [, urlStr] = bits;\r\n\r\n\t\tif (urlStr) {\r\n\t\t\tconst [baseUrl] = urlStr.split('?');\r\n\t\t\turl = baseUrl;\r\n\t\t}\r\n\t}\r\n\treturn url;\r\n};\r\n\r\nFrameHelper.isStringType = function (stype) {\r\n\tif (stype === 'http://www.w3.org/2001/XMLSchema#string') return true;\r\n\tif (stype === 'xsd:string') return true;\r\n\treturn false;\r\n};\r\n\r\nFrameHelper.lastURLBit = function (url) {\r\n\turl = (typeof url === 'undefined') ? window.location.href : url;\r\n\tconst [urlFirst] = url.split('#');\r\n\tconst [urlTmp] = urlFirst.split('?');\r\n\turl = urlTmp.substring(url.lastIndexOf('/') + 1);\r\n\treturn url;\r\n};\r\n\r\n\r\nFrameHelper.getStdURL = function (pref, ext, url) {\r\n\tif (this.standard_urls[pref]) {\r\n\t\tif (url) {\r\n\t\t\tif (url === this.standard_urls[pref] + ext) return url;\r\n\t\t} else {\r\n\t\t\treturn this.standard_urls[pref] + ext;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nFrameHelper.viewIncludesProperties = function (view) {\r\n\tif (view === 'full' || view === 'production' || view === 'terse') {\r\n\t\treturn true;\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nFrameHelper.viewIncludesChildren = function (view, type) {\r\n\treturn this.viewIncludesProperties(view, type);\r\n};\r\n\r\nFrameHelper.viewIncludesValue = function (view, type) {\r\n\treturn this.viewIncludesProperties(view, type);\r\n};\r\n\r\nFrameHelper.numberWithCommas = function (value) {\r\n\tif (value >= 1000 || value <= -1000) {\r\n\t    const parts = value.toString().split('.');\r\n\t    if (value <= -1000) parts[0] = parts[0].substring(1);\r\n\t    parts[0] = parts[0].replace(/\\B(?=(\\d{3})+(?!\\d))/g, ',');\r\n\t    if (value <= -1000) value = `-${parts.join('.')}`;\r\n\t    else value = parts.join('.');\r\n\t}\r\n\treturn value;\r\n};\r\n\r\nFrameHelper.datatypes = [\r\n\t'xdd:coordinate', 'xdd:coordinatePolyline',\r\n\t'xdd:coordinatePolygon', 'xdd:dateRange', 'xdd:gYearRange', 'xdd:integerRange',\r\n\t'xdd:decimalRange', 'xdd:cc', 'xdd:email', 'xdd:html', 'xdd:url', 'xsd:anySimpleType',\r\n\t'xsd:string', 'xsd:boolean', 'xsd:decimal', 'xsd:double', 'xsd:float', 'xsd:time', 'xsd:date',\r\n\t'xsd:dateTime', 'xsd:dateTimeStamp', 'xsd:gYear', 'xsd:gMonth', 'xsd:gDay', 'xsd:gYearMonth',\r\n\t'xsd:gMonthDay', 'xsd:duration', 'xsd:yearMonthDuration', 'xsd:dayTimeDuration',\r\n\t'xsd:byte', 'xsd:short', 'xsd:integer', 'xsd:long', 'xsd:unsignedByte',\t'xsd:unsignedInt',\r\n\t'xsd:unsignedLong',\t'xsd:nonNegativeInteger', 'xsd:positiveInteger', 'xsd:negativeInteger',\r\n\t'xsd:nonPositiveInteger', 'xsd:base64Binary', 'xsd:anyURI', 'xsd:language', 'xsd:normalizedString',\r\n\t'xsd:token', 'xsd:NMTOKEN',\t'xsd:Name',\t'xsd:NCName', 'xsd:NOTATION', 'xsd:QName', 'xsd:ID',\r\n\t'xsd:IDREF', 'xsd:ENTITY', 'rdf:XMLLiteral', 'rdf:PlainLiteral', 'rdfs:Literal', 'xdd:json'\r\n];\r\n\r\nFrameHelper.parseDate = function (ty, value) {\r\n\tlet parsed;\r\n\tif (ty === 'xsd:date') {\r\n\t\tparsed = this.parseXsdDate(value);\r\n\t} else if (ty === 'xsd:time') {\r\n\t\tparsed = this.parseXsdTime(value);\r\n\t} else if (ty === 'xsd:dateTime') {\r\n\t\tparsed = this.parseXsdDateTime(value);\r\n\t} else if (ty === 'xsd:gYear') {\r\n\t\tparsed = { year: value };\r\n\t} else if (ty === 'xsd:gYearRange') {\r\n\t\tparsed = { year: value };\r\n\t} else if (ty === 'xsd:gMonth') {\r\n\t\tparsed = { month: value.substring(2) };\r\n\t} else if (ty === 'xsd:gDay') {\r\n\t\tparsed = { day: value };\r\n\t} else if (ty === 'xsd:gYearMonth') {\r\n\t\tconst bits = value.split('-');\r\n\t\twhile (bits.length < 2) bits.push('');\r\n\t\tparsed = { year: bits[0], month: bits[1] };\r\n\t} else if (ty === 'xsd:gMonthDay') {\r\n\t\tconst bits = value.split('-');\r\n\t\twhile (bits.length < 2) bits.push('');\r\n\t\tparsed = { month: bits[0], day: bits[1] };\r\n\t} else if (ty === 'xsd:dateTimeStamp') {\r\n\t\tparsed = this.parseXsdDateTime(value);\r\n\t}\r\n\treturn parsed;\r\n};\r\n\r\nFrameHelper.parseXsdDate = function (val) {\r\n\tconst tz = this.extractXsdTimezone(val);\r\n\tif (tz) {\r\n\t\tval = val.substring(0, val.length - tz.length);\r\n\t}\r\n\tlet year;\r\n\tif (val.substring(0, 1) === '-') {\r\n\t\tyear = val.substring(0, 5);\r\n\t} else {\r\n\t\tyear = val.substring(0, 4);\r\n\t}\r\n\tlet parsed;\r\n\tif (year && Math.abs(year) < 10000) {\r\n\t\tlet month = val.substring(year.length + 1, year.length + 3);\r\n\t\tif (month) { month = parseInt(month, 10); } else return false;\r\n\t\tlet day = val.substring(year.length + 4);\r\n\t\tif (day) day = parseInt(day, 10);\r\n\t\telse return false;\r\n\t\tparsed = {\r\n\t\t\tyear,\r\n\t\t\t   month,\r\n\t\t\t   day,\r\n\t\t\t   timezone: tz\r\n\t\t};\r\n\t}\r\n\treturn parsed;\r\n};\r\n\r\nFrameHelper.addXsdPadding = function (parsed) {\r\n\tconst nparsed = {};\r\n\tif (typeof parsed.year !== 'undefined' && parsed.year !== false && parsed.year < 1000) {\r\n\t\tif (Math.abs(parsed.year) < 10) nparsed.year = (parsed.year < 0 ? `-000${Math.abs(parsed.year)}` : `000${parsed.year}`);\r\n\t\telse if (Math.abs(parsed.year) < 100) nparsed.year = (parsed.year < 0 ? `-00${Math.abs(parsed.year)}` : `00${parsed.year}`);\r\n\t\telse nparsed.year = (parsed.year < 0 ? `-0${Math.abs(parsed.year)}` : `0${parsed.year}`);\r\n\t} else if (parsed.year) {\r\n\t\tnparsed.year = parsed.year;\r\n\t}\r\n\tif (typeof parsed.month !== 'undefined' && parsed.month !== false && parsed.month < 10) {\r\n\t\tnparsed.month = `0${parsed.month}`;\r\n\t} else if (parsed.month) {\r\n\t\tnparsed.month = parsed.month;\r\n\t}\r\n\tif (typeof parsed.day !== 'undefined' && parsed.day !== false && parsed.day < 10) {\r\n\t\tnparsed.day = `0${parsed.day}`;\r\n\t} else if (parsed.day) {\r\n\t\tnparsed.day = parsed.day;\r\n\t}\r\n\tif (typeof parsed.hour !== 'undefined' && parsed.hour !== false && parsed.hour < 10) {\r\n\t\tnparsed.hour = `0${parsed.hour}`;\r\n\t} else if (parsed.hour) {\r\n\t\tnparsed.hour = parsed.hour;\r\n\t}\r\n\tif (typeof parsed.minute !== 'undefined' && parsed.minute !== false && parsed.minute < 10) {\r\n\t\tnparsed.minute = `0${parsed.minute}`;\r\n\t} else if (parsed.minute) {\r\n\t\tnparsed.minute = parsed.minute;\r\n\t}\r\n\tif (typeof parsed.second !== 'undefined' && parsed.second !== false && parsed.second < 10) {\r\n\t\tnparsed.second = `0${parsed.second}`;\r\n\t} else if (parsed.second) {\r\n\t\tnparsed.second = parsed.second;\r\n\t}\r\n\treturn nparsed;\r\n};\r\n\r\n\r\nFrameHelper.xsdFromParsed = function (parsed, ty) {\r\n\tconst xparsed = this.addXsdPadding(parsed);\r\n\tlet ret;\r\n\tif (ty === 'xsd:gYear') {\r\n\t\tret = (xparsed.year ? xparsed.year : false);\r\n\t} else if (ty === 'xsd:time') {\r\n\t\treturn (xparsed.hour && xparsed.minute && xparsed.second) ? `${xparsed.hour}:${xparsed.minute}:${xparsed.second}` : false;\r\n\t} else if (ty === 'xsd:date') {\r\n\t\treturn (xparsed.year && xparsed.month && xparsed.day) ? `${xparsed.year}-${xparsed.month}-${xparsed.day}` : false;\r\n\t} else if (ty === 'xsd:dateTime' || ty === 'xsd:dateTimeStamp') {\r\n\t\tret = (xparsed.year && xparsed.month && xparsed.day) ? `${xparsed.year}-${xparsed.month}-${xparsed.day}T` : false;\r\n\t\tif (ret) ret += `${xparsed.hour ? xparsed.hour : '12'}:${xparsed.minute ? xparsed.minute : '00'}:${xparsed.second ? xparsed.second : '00'}`;\r\n\t} else if (ty === 'xsd:gMonth') {\r\n\t\tret = (xparsed.month ? `--${xparsed.month}` : false);\r\n\t} else if (ty === 'xsd:gDay') {\r\n\t\tret = (xparsed.day ? `---${xparsed.day}` : false);\r\n\t} else if (ty === 'xsd:gYearMonth') {\r\n\t\tret = (xparsed.year && xparsed.month) ? `${xparsed.year}-${xparsed.month}` : false;\r\n\t} else if (ty === 'xsd:gMonthDay') {\r\n\t\tret = (xparsed.day && xparsed.month) ? `--${xparsed.month}-${xparsed.day}` : false;\r\n\t}\r\n\tif (xparsed.timezone) {\r\n\t\tret += xparsed.timezone;\r\n\t}\r\n\treturn ret;\r\n};\r\n\r\n\r\nFrameHelper.parseXsdTime = function (val) {\r\n\tif (!val) return {};\r\n\tconst tz = this.extractXsdTimezone(val);\r\n\tif (tz) {\r\n\t\tval = val.substring(0, val.length - tz.length);\r\n\t}\r\n\tconst parsed = {\r\n\t\thour: val.substring(0, 2),\r\n\t\tminute: val.substring(3, 5),\r\n\t\tsecond: val.substring(6),\r\n\t\ttimezone: tz\r\n\t};\r\n\treturn parsed;\r\n};\r\n\r\nFrameHelper.convertTimestampToXsd = function (val) {\r\n\t  const a = new Date(val * 1000);\r\n\t  const parsed = {\r\n\t\tyear: a.getFullYear(),\r\n\t\tmonth: a.getMonth() + 1,\r\n\t\tday: a.getDate(),\r\n\t\thour: a.getHours(),\r\n\t\tminute: a.getMinutes(),\r\n\t\tsecond: a.getSeconds()\r\n\t  };\r\n\t  return parsed;\r\n};\r\n\r\nFrameHelper.parseXsdDateTime = function (val) {\r\n\tif (!val) return {};\r\n\tif (typeof val === 'number') {\r\n\t\treturn this.convertTimestampToXsd(val);\r\n\t}\r\n\tconst tz = this.extractXsdTimezone(val);\r\n\tif (tz) {\r\n\t\tval = val.substring(0, val.length - tz.length);\r\n\t}\r\n\tconst datetime = this.parseXsdDate(val);\r\n\tconst ptime = this.parseXsdTime(val.substring(val.indexOf('T') + 1));\r\n\r\n\tfor (const i of Object.keys(ptime)) {\r\n\t\tdatetime[i] = ptime[i];\r\n\t}\r\n\tdatetime.timezone = tz;\r\n\treturn datetime;\r\n};\r\n\r\nFrameHelper.extractXsdTimezone = function (val) {\r\n\tif (val && val.charAt(val.length - 1) === 'Z') {\r\n\t\treturn 'Z';\r\n\t}\r\n\tif (val && (val.charAt(val.length - 6) === '+' || val.charAt(val.length - 6) === '-')) {\r\n\t\tval.substring(val.length - 6);\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nFrameHelper.parseRangeValue = function (val, dividor) {\r\n\tdividor = (dividor || ',');\r\n\tlet vals = [];\r\n\tif (typeof val === 'object' && val.length) {\r\n\t\tvals = val;\r\n\t} else if (val) {\r\n\t\tif (typeof val !== 'string') {\r\n\t\t\tval = `${val}`;\r\n\t\t}\r\n\t\tif (val.length && (val.charAt(0) === '[') && val.charAt(val.length - 1) === ']') {\r\n\t\t\tvals.push(val.substring(1, val.indexOf(dividor)));\r\n\t\t\tvals.push(val.substring(val.indexOf(dividor) + 1, val.length - 1));\r\n\t\t} else {\r\n\t\t\tvals.push(val);\r\n\t\t}\r\n\t}\r\n\treturn vals;\r\n};\r\n\r\nFrameHelper.loadDynamicScript = function (scriptid, src, callback) {\r\n\tconst existingScript = document.getElementById(scriptid);\r\n\tif (!existingScript) {\r\n\t\tconst script = document.createElement('script');\r\n\t\tscript.src = src; // URL for the third-party library being loaded.\r\n\t\tdocument.body.appendChild(script);\r\n\t\tscript.onload = function () {\r\n\t\t\tscript.id = scriptid; // do it here so it doesn't trigger the callback below on multiple calls\r\n\t\t\tif (callback) callback(scriptid);\r\n\t\t};\r\n\t}\r\n\tif (existingScript && callback) {\r\n\t\tcallback(scriptid);\r\n\t}\r\n};\r\n\r\nFrameHelper.loadDynamicCSS = function (cssid, src, callback) {\r\n\tconst existingScript = document.getElementById(cssid);\r\n\tif (!existingScript) {\r\n\t\tconst link = document.createElement('link');\r\n\t\tlink.href = src; // URL for the third-party library being loaded.\r\n\t\tlink.id = cssid; // e.g., googleMaps or stripe\r\n\t\tlink.rel = 'stylesheet';\r\n\t\tdocument.body.appendChild(link);\r\n\t\tlink.onload = function () {\r\n\t\t\tif (callback) callback(cssid);\r\n\t\t};\r\n\t}\r\n\tif (existingScript && callback) callback(cssid);\r\n};\r\n\r\nmodule.exports = FrameHelper;\r\n","const DatatypeRenderers = require(\"./DatatypeRenderers\");\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction TerminusFrame(client){\r\n\tthis.client = client;\r\n\tthis.load_schema = false;\r\n}\r\n\r\nTerminusFrame.prototype.options = function(opts){\r\n\tthis.config = opts || TerminusClient.WOQL.document();\r\n\treturn this;\r\n}\r\n\r\nTerminusFrame.prototype.setDatatypes = function(func){\r\n\tthis.datatypes = new DatatypeRenderers();\r\n\tif(this.config.datatypes) this.datatypes.options(this.config.datatypes);\r\n\tif(func) func(this.datatypes);\r\n\treturn this;\r\n}\r\n\r\nTerminusFrame.prototype.loadDocument = function(url, cls){\r\n\tif(!url) return false;\r\n\tvar self = this;\r\n\tif(url.substring(0,4) == \"doc:\"){\r\n\t\turl = url.substring(4);\r\n\t}\r\n\treturn this.client.getDocument(url, {\"terminus:encoding\": \"terminus:frame\"})\r\n\t.then(function(response){\r\n\t\tself.loadDataFrames(response);\r\n\t\tif(self.config.load_schema()){\r\n\t\t\tself.loadDocumentSchema(self.document.cls);\r\n\t\t}\r\n\t\treturn response;\r\n\t});\r\n}\r\n\r\nTerminusFrame.prototype.loadDocumentSchema = function(cls){\r\n\tvar self = this;\r\n\tvar ncls = TerminusClient.FrameHelper.unshorten(cls);\r\n\treturn this.client.getClassFrame(false, ncls)\r\n\t.then(function(response){\r\n\t\treturn self.loadSchemaFrames(response, cls);\r\n\t});\r\n}\r\n\r\nTerminusFrame.prototype.loadDataFrames = function(dataframes, cls){\r\n\tif(!cls){\r\n\t\tif(this.document) cls = this.document.cls;\r\n\t\telse {\r\n\t\t\tif(dataframes && dataframes.length && dataframes[0] && dataframes[0].domain){\r\n\t\t\t\tcls = dataframes[0].domain;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tif(cls){\r\n\t\tif(!this.document){\r\n\t\t\tthis.document = new TerminusClient.ObjectFrame(cls, dataframes);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.document.loadDataFrames(dataframes);\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tconsole.log(\"Missing Class\" + \" \" + \"Failed to add dataframes due to missing class\");\r\n\t}\r\n}\r\n\r\nTerminusFrame.prototype.loadSchemaFrames = function(classframes, cls){\r\n\tif(!cls){\r\n\t\tif(classframes && classframes.length && classframes[0] && classframes[0].domain){\r\n\t\t\tcls = classframes[0].domain;\r\n\t\t}\r\n\t}\r\n\tif(cls){\r\n\t\tif(!this.document){\r\n\t\t\tthis.document = new TerminusClient.ObjectFrame(cls);\r\n\t\t}\r\n\t\tif(classframes){\r\n\t\t\tthis.document.loadClassFrames(classframes);\r\n\t\t\tif(!this.document.subjid){\r\n\t\t\t\tthis.document.newDoc = true;\r\n\t\t\t\tthis.document.fillFromSchema(\"_:\");\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tconsole.log(\"Missing Class\", \"Failed to add class frames due to missing class\");\r\n\t}\r\n}\r\n\r\nTerminusFrame.prototype.render = function(){\r\n\tif(!this.renderer && this.document){\r\n\t\tif(this.config.renderer()){\r\n\t\t\tthis.renderer = this.config.renderer();\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.applyRulesToDocument(this.document, this.config);\r\n\t\t\tthis.renderer = this.document;\r\n\t\t}\r\n\t}\r\n\tif(this.renderer && this.renderer.render){\r\n\t\t//this.renderer.world();\r\n\t\treturn this.renderer.render(this.document);\r\n\t}\r\n\telse if(typeof this.renderer == \"function\"){\r\n\t\tvar x = this.renderer(this.document);\r\n\t\treturn x;\r\n\t}\r\n\telse {\r\n\t\tconsole.log(\"didna make it \");\r\n\t}\r\n}\r\n\r\n/*\r\n * adds render and compare functions to object frames\r\n */\r\nTerminusFrame.prototype.applyRulesToDocument = function(doc, config){\r\n\tvar self = this;\r\n\tfunction onmatch(frame, rule){\r\n\t\tif(typeof rule.render() != \"undefined\"){\r\n\t\t\tframe.render = rule.render();\r\n\t\t}\r\n\t\telse {\r\n\t\t\tif(rule.renderer()){\r\n\t\t\t\tvar renderer = self.loadRenderer(rule.renderer(), frame, rule.args);\t\t\r\n\t\t\t}\r\n\t\t\tif(renderer && renderer.render){\r\n\t\t\t\tframe.render = function(frame){\r\n\t\t\t\t\treturn renderer.render(frame);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(rule.compare()){\r\n\t\t\tframe.compare = rule.compare();\r\n\t\t}\r\n\t\tconfig.setFrameDisplayOptions(frame, rule);\r\n\t}\r\n\tthis.document.filter(config.rules, onmatch);\r\n}\r\n\r\nTerminusFrame.prototype.loadRenderer = function(rendname, frame, args){\r\n\tif(this.owner){\r\n\t\treturn this.owner.loadRenderer(rendname, frame, args, this);\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nmodule.exports = TerminusFrame ;\r\n","const TerminusClient = require('@terminusdb/terminus-client');\r\nfunction TerminusPluginManager(){\r\n\tthis.preloaded = [];\r\n\tthis.loaded = [];\r\n\tthis.loading = [];\r\n\tthis.precluded = [];\r\n\tthis.plugins = {};\r\n\tthis.plugins[\"font-awesome\"] = {\r\n\t\tlabel: \"Font Awesome\",\r\n\t\tcss: [\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0-11/css/all.css\"]\r\n\t};\r\n\tthis.plugins[\"quill\"] = {\r\n\t\tlabel: \"Quill\",\r\n\t\tjs: [\"https://cdn.quilljs.com/1.3.6/quill.min.js\"],\r\n\t\tcss: [\"https://cdn.quilljs.com/1.3.6/quill.snow.css\"],\r\n\t};\r\n\tthis.plugins[\"codemirror\"] = {\r\n\t\tlabel : \"Code Mirror\",\r\n\t\tjs: [\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/codemirror.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/mode/xml/xml.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/mode/css/css.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/mode/turtle/turtle.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/mode/javascript/javascript.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/addon/hint/anyword-hint.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/addon/hint/show-hint.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/addon/runmode/runmode.js\",\r\n\t\t  \t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/mode/http/http.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/addon/edit/closebrackets.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/addon/edit/matchbrackets.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/addon/display/placeholder.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/addon/fold/foldgutter.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/addon/fold/foldcode.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/addon/fold/indent-fold.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/addon/fold/markdown-fold.js\"\r\n\r\n\r\n\r\n\t  ],\r\n\t\tcss: [\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/codemirror.css\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/addon/hint/show-hint.css\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/theme/neo.css\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/theme/erlang-dark.css\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/addon/fold/foldgutter.css\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/theme/eclipse.css\"\r\n\t\t]\r\n\t};\r\n\tthis.plugins[\"jquery\"] = {\r\n\t\tlabel: \"jQuery\",\r\n\t\tjs: [\"https://code.jquery.com/jquery-2.2.4.min.js\"]\r\n\t};\r\n\tthis.plugins[\"jqueryui\"] = {\r\n\t\tlabel: \"jQuery UI\",\r\n\t\tcss: [\"https://code.jquery.com/ui/1.12.0/themes/smoothness/jquery-ui.css\"],\r\n\t\tjs: [\"https://code.jquery.com/ui/1.12.0/jquery-ui.js\"],\r\n\t\trequires: ['jquery']\r\n\t};\r\n\tthis.plugins[\"datatables\"] = {\r\n\t\tlabel: \"Data Tables\",\r\n\t\tjs: [\"https://cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js\",\r\n\t\t\t \"https://cdn.datatables.net/v/dt/jszip-2.5.0/dt-1.10.16/b-1.5.1/b-html5-1.5.1/datatables.min.js\"],\r\n\t\tcss: [\"https://cdn.datatables.net/1.10.19/css/jquery.dataTables.min.css\"],\r\n\t\trequires: ['jquery']\r\n\t};\r\n\t/*this.plugins[\"prettify\"] = {\r\n\t\tlabel: \"Prettify\",\r\n\t\tjs: [\"https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.js\"],\r\n\t\tcss: [\"https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.css\"],\r\n\t\trequires: ['jquery']\r\n\t};*/\r\n\tthis.plugins[\"gmaps\"] = {\r\n\t\tlabel: \"Google Maps\",\r\n\t\tjs: [\"https://maps.googleapis.com/maps/api/js\"],\r\n\t\t//plugin: \"gmaps.terminus.js\"\r\n\t};\r\n\tthis.plugins[\"d3\"] = {\r\n\t\tlabel: \"d3\",\r\n\t\tjs: [\"https://code.jquery.com/jquery-2.2.4.min.js\"],\r\n\t\trequires: ['jquery']\r\n\t};\r\n\tthis.plugins[\"select2\"] = {\r\n\t\tlabel: \"Select 2\",\r\n\t\tjs: [\"https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.7/js/select2.min.js\"],\r\n\t\tcss: [\"https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.7/css/select2.min.css\"],\r\n\t\trequires: ['jquery']\r\n\t};\r\n\t/*this.plugins[\"jsoneditor\"] = {\r\n\t\tlabel: \"JSON Editor\",\r\n\t\tjs: [\"https://cdnjs.cloudflare.com/ajax/libs/jsoneditor/7.0.4/jsoneditor.min.js\"],\r\n\t\tcss: [\"https://cdnjs.cloudflare.com/ajax/libs/jsoneditor/7.0.4/jsoneditor.min.css\"],\r\n\t\t//plugin: \"jsoneditor.terminus.js\"\r\n\t};\r\n\tthis.plugins[\"bootstrap\"] = {\r\n\t\tlabel: \"Bootstrap\",\r\n\t\tjs: [\"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js\"],\r\n\t\tcss: [\"https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/2.2.2/css/bootstrap.min.css\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/2.2.2/css/bootstrap-responsive.min.css\"]\r\n\t};\r\n\tthis.plugins[\"flot\"] = {\r\n\t\tlabel: \"Flot\",\r\n\t\tjs: [\"https://cdnjs.cloudflare.com/ajax/libs/flot/0.8.3/jquery.flot.min.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/flot/0.8.3/jquery.flot.resize.min.js\"],\r\n\t\trequires: [\"jquery\"]\r\n\t};*/\r\n}\r\n\r\nTerminusPluginManager.prototype.setPluginOptions = function(opts){\r\n\tfor(var p in opts){\r\n\t\tif(!this.plugins[p]) continue;\r\n\t\tfor(var k in opts[p]){\r\n\t\t\tthis.plugins[p][k] = opts[p][k];\r\n\t\t}\r\n\t}\r\n}\r\n\r\nTerminusPluginManager.prototype.init = function(opts, then){\r\n\tif(opts) this.setPluginOptions(opts);\r\n\tthis.calculatePreloaded();\r\n\tvar toload = this.calculateRequiredInitPlugins(opts);\r\n\tif(toload && toload[0].length) {\r\n\t\tif(toload[1].length){\r\n\t\t\tvar self = this;\r\n\t\t\tvar nthen = function(){\r\n\t\t\t\tself.loadPlugins(toload[1], then);\r\n\t\t\t}\r\n\t\t\tthis.loadPlugins(toload[0], nthen);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.loadPlugins(toload[0], then);\r\n\t\t}\r\n\t}\r\n\telse if(then){\r\n\t\tthen();\r\n\t}\r\n}\r\n\r\nTerminusPluginManager.prototype.calculateRequiredInitPlugins = function(opts){\r\n\tif(opts){\r\n\t\tvar pins = [];\r\n\t\tfor(var pid in opts){\r\n\t\t\tif(opts[pid] && pins.indexOf(pid) == -1){\r\n\t\t\t\tif(typeof opts[pid] != \"object\" && opts[pid]){\r\n\t\t\t\t\tpins.push(pid);\r\n\t\t\t\t}\r\n\t\t\t\telse if(typeof opts[pid] == \"object\"){\r\n\t\t\t\t\tif(!(typeof opts[pid].loaded != \"undefined\" && !opts[pid].loaded)){\r\n\t\t\t\t\t\tpins.push(pid);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tvar pins = this.getDefaultPlugins();\r\n\t}\r\n\tvar needed_pins = [];\r\n\tfor(var i = 0; i<pins.length; i++){\r\n\t\tif(this.loaded.indexOf(pins[i]) == -1 && this.preloaded.indexOf(pins[i]) == -1 ){\r\n\t\t\tneeded_pins.push(pins[i])\r\n\t\t}\r\n\t}\r\n\tvar loading_order = [[], []];\r\n\tfor(var i = 0; i<needed_pins.length; i++){\r\n\t\tif(this.plugins[needed_pins[i]]){\r\n\t\t\tif(this.plugins[needed_pins[i]].requires && this.plugins[needed_pins[i]].requires.length){\r\n\t\t\t\tloading_order[1].push(needed_pins[i]);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tloading_order[0].push(needed_pins[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn loading_order;\r\n}\r\n\r\nTerminusPluginManager.prototype.getAvailablePlugins = function(){\r\n\treturn this.plugins;\r\n}\r\n\r\nTerminusPluginManager.prototype.calculatePreloaded = function(){\r\n\tfor(var pl in this.plugins){\r\n\t\tif(this.pluginAvailable(pl)){\r\n\t\t\tthis.preloaded.push(pl);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nTerminusPluginManager.prototype.pluginAvailable = function(plugin, version_check){\r\n\tif(typeof this.plugins[plugin] == \"object\"){\r\n\t\tvar pluginmeta = this.plugins[plugin];\r\n\t\tif(pluginmeta.requires && pluginmeta.requires.length){\r\n\t\t\tfor(var i =0 ; i < pluginmeta.requires.length; i++){\r\n\t\t\t\tif(!this.pluginAvailable(pluginmeta.requires[i], version_check)) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar required_version = (pluginmeta.version ? pluginmeta.version : false);\r\n\t\tswitch(plugin){\r\n\t\t\tcase \"jquery\": {\r\n\t\t\t\tif(typeof jQuery == \"undefined\") return false;\r\n\t\t\t\tif(version_check && required_version){}\r\n\t\t\t\treturn true;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tcase \"jqueryui\": {\r\n\t\t\t\ttry{\r\n\t\t\t\t\tif(typeof jQuery != \"undefined\" && jQuery.isFunction( jQuery.fn.slider )) return true;\r\n\t\t\t\t}\r\n\t\t\t\tcatch(e){}\r\n\t\t\t\treturn false;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tcase \"quill\": {\r\n\t\t\t\tif(typeof Quill == \"undefined\") return false;\r\n\t\t\t\treturn true;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tcase \"jsoneditor\": {\r\n\t\t\t\tif(typeof JSONEditor == \"undefined\") return false;\r\n\t\t\t\treturn true;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tcase \"codemirror\": {\r\n\t\t\t\tif(typeof CodeMirror == \"undefined\") return false;\r\n\t\t\t\treturn this.plugins[plugin];  // sent plugin config with darkmode true/ false\r\n\t\t\t}\r\n\t\t\tcase \"font-awesome\": {\r\n\t\t\t\t//if(typeof CodeMirror != \"undefined\") return true;\r\n\t\t\t\treturn this.fontAwesomeCheck();\r\n\t\t\t}\r\n\t\t\tcase \"datatables\": {\r\n\t\t\t\t if(typeof jQuery != \"undefined\" && jQuery.isFunction( jQuery.fn.dataTable)) return true;\r\n\t\t\t\t return false;\r\n\t\t\t}\r\n\t\t\tcase \"select2\": {\r\n\t\t\t\t if(typeof jQuery != \"undefined\" && jQuery.isFunction( jQuery.fn.select2 )) return true;\r\n\t\t\t\t return false;\r\n\t\t\t}\r\n\t\t\tcase \"gmaps\": {\r\n\t\t\t\tif(typeof google == \"undefined\" || typeof google.maps == \"undefined\") return false;\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\tcase \"openlayers\": {\r\n\t\t\t\tif(typeof ol == \"undefined\" || typeof ol.Map == \"undefined\") return false;\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\tcase \"d3\": {\r\n\t\t\t\tif(typeof d3 == \"undefined\") return false;\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tconsole.log(new Error(plugin + \" is not a supported plugin ID\"));\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nTerminusPluginManager.prototype.fontAwesomeCheck = function(){\r\n\tvar span = document.createElement('span');\r\n\tspan.className = 'fa';\r\n\tspan.style.display = 'none';\r\n\tif(document.body){\r\n\t\tdocument.body.insertBefore(span, document.body.firstChild);\r\n\t\tfunction css(element, property) {\r\n\t\t  return window.getComputedStyle(element, null).getPropertyValue(property);\r\n\t\t}\r\n\t\tvar loaded = false;\r\n\t\tvar fontAwsm = css(span, 'font-family');\r\n\t\tif (fontAwsm.replace(/\"/g, \"\") == 'Font Awesome 5 Free') { // remove double quotes\r\n\t\t\tloaded = true;\r\n\t\t}\r\n\t\tdocument.body.removeChild(span);\r\n\t\treturn loaded;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nTerminusPluginManager.prototype.getDefaultPlugins = function(){\r\n\tvar defplugs = [\"font-awesome\"];\r\n\treturn defplugs;\r\n}\r\n\r\nTerminusPluginManager.prototype.loadPlugins = function(plugins, then){\r\n\tvar ticker = plugins.length;\r\n\tvar cback = function(){\r\n\t\tif(--ticker <= 1 && then){\r\n\t\t\tthen();\r\n\t\t}\r\n\t};\r\n\tfor(var i = 0; i < plugins.length; i++){\r\n\t\tthis.loadPlugin(plugins[i], cback);\r\n\t}\r\n}\r\n\r\nTerminusPluginManager.prototype.loadPlugin = function(plugin, then){\r\n\tvar pug = this.plugins[plugin];\r\n\tif(pug.css){\r\n\t\tfor(var i=0; i<pug.css.length; i++){\r\n\t\t\tvar cssid = plugin + \"_css_\" + i;\r\n\t\t\tTerminusClient.FrameHelper.loadDynamicCSS(cssid, pug.css[i]);\r\n\t\t}\r\n\t}\r\n\tvar scripts = (pug.js ? pug.js : []);\r\n\tif(plugin == \"gmaps\" && pug.key){\r\n\t\tscripts[0] += \"?key=\" + pug.key;\r\n\t}\r\n\tif(pug.plugin){\r\n\t\t//scripts.push(\"plugins/\" + pug.plugin);\r\n\t}\r\n\tif(plugin == \"codemirror\"){\r\n\t\tvar cm = scripts[0];\r\n\t\tvar sid = plugin + \"_js_\" + (scripts.length -1);\r\n\t\tscripts.splice(0, 1);\r\n\t\tvar self = this;\r\n\t\tvar cback = function(){\r\n\t\t\tself.loadPluginScripts(plugin, scripts, then);\r\n\t\t}\r\n\t\tTerminusClient.FrameHelper.loadDynamicScript(sid, cm, cback);\r\n\t}\r\n\telse {\r\n\t\tthis.loadPluginScripts(plugin, scripts, then);\r\n\t}\r\n}\r\n\r\nTerminusPluginManager.prototype.loadPluginScripts = function(plugin, scripts, then){\r\n\tvar ticker = scripts.length - 1;\r\n\tvar self = this;\r\n\tvar cback = function(){\r\n\t\tif(ticker == 0) {\r\n\t\t\tif(self.loaded.indexOf(plugin) == -1){\r\n\t\t\t\tself.loaded.push(plugin);\r\n\t\t\t}\r\n\t\t\tif(self.loading.indexOf(plugin) != -1){\r\n\t\t\t\tself.loading.splice(self.loading.indexOf(plugin), 1);\r\n\t\t\t}\r\n\t\t\tthen();\r\n\t\t}\r\n\t\tticker--;\r\n\t};\r\n\tif(scripts.length == 0){\r\n\t\tthis.loaded.push(plugin);\r\n\t}\r\n\telse {\r\n\t\tthis.loading.push(plugin);\r\n\t}\r\n\tfor(var i = 0; i<scripts.length; i++){\r\n\t\tvar sid = plugin + \"_js_\" + i;\r\n\t\tTerminusClient.FrameHelper.loadDynamicScript(sid, scripts[i], cback);\r\n\t}\r\n}\r\n\r\nTerminusPluginManager.prototype.loadPageCSS = function(css){\r\n\tcssfid = \"terminus_client_css\";\r\n\tvar cssdom = document.getElementById(cssfid);\r\n\tif(cssdom){\r\n\t\tcssdom.parentNode.removeChild(cssdom);\r\n\t}\r\n\tif(css){\r\n\t\tcssurl = \"css/\" + css + \".css\";\r\n\t\tTerminusClient.FrameHelper.loadDynamicCSS(cssfid, cssurl);\r\n\t}\r\n}\r\n\r\nTerminusPluginManager.prototype.pluginLoadable = function(pid){\r\n\treturn (this.precluded.indexOf(pid) !== -1 || this.pluginLoadedOrLoading(pid));\r\n}\r\n\r\nTerminusPluginManager.prototype.pluginLoadedOrLoading = function(pid){\r\n\tif(this.loaded.indexOf(pid) != -1) return true;\r\n\tif(this.preloaded.indexOf(pid) != -1) return true;\r\n\tif(this.loading.indexOf(pid) != -1) return true;\r\n\treturn false;\r\n}\r\n\r\nTerminusPluginManager.prototype.disabled = function(pid, obj){\r\n\tif(this.precluded.indexOf(pid) != -1) return true;\r\n\tif(obj.requires){\r\n\t\tfor(var i = 0; i<obj.requires.length; i++){\r\n\t\t\tif(!this.pluginLoadedOrLoading(obj.requires[i])) return true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nTerminusPluginManager.prototype.getPluginDOM = function(plugid, obj, ui){\r\n\tvar a = document.createElement(\"a\");\r\n\tvar cl = document.createElement(\"span\");\r\n\ta.appendChild(cl);\r\n\tcl.setAttribute(\"class\", \"terminus-plugin-control\");\r\n\tvar cbox = document.createElement(\"input\");\r\n\tcbox.id = \"terminus-plugin-control-\" + plugid;\r\n\tcbox.type = \"checkbox\";\r\n\tif(this.preloaded.indexOf(plugid) != -1){\r\n\t\tcbox.checked = true;\r\n\t\tcbox.disabled = true;\r\n\t}\r\n\telse if(this.loaded.indexOf(plugid) != -1){\r\n\t\tcbox.checked = true;\r\n\t}\r\n\telse if(this.loading.indexOf(plugid) != -1){\r\n\t\tcbox.checked = true;\r\n\t}\r\n\telse if(this.disabled(plugid, obj)){\r\n\t\tcbox.disabled = true;\r\n\t}\r\n\tvar clab = document.createElement(\"label\");\r\n\tclab.setAttribute(\"class\", \"terminus-plugin-label terminus-pointer\");\r\n\tclab.setAttribute(\"for\", cbox.id);\r\n\tclab.appendChild(document.createTextNode(obj.label));\r\n\tcl.appendChild(clab);\r\n\tcl.appendChild(cbox);\r\n\tvar self = this;\r\n\tcbox.addEventListener(\"change\", function(){\r\n\t\tself.togglePlugin(plugid, ui);\r\n\t});\r\n\treturn a;\r\n}\r\n\r\nTerminusPluginManager.prototype.togglePlugin = function(plugid, ui){\r\n\tif(this.loaded.indexOf(plugid) == -1){\r\n\t\tvar then = function(){\r\n\t\t\tui.redraw();\r\n\t\t}\r\n\t\tthis.loadPlugin(plugid, then);\r\n\t}\r\n\telse {\r\n\t\tthis.unloadPlugin(plugid);\r\n\t}\r\n\tTerminusClient.FrameHelper.removeChildren(ui.plugins);\r\n\tui.drawPlugins();\r\n}\r\n\r\nTerminusPluginManager.prototype.unloadPlugin = function(plugid){\r\n\tif(!this.plugins[plugid] || this.loaded.indexOf(plugid) == -1) {\r\n\t\tconsole.log(new Error(plugid + \" plugin unload request when it is not loaded\"));\r\n\t\treturn false;\r\n\t}\r\n\tvar pug = this.plugins[plugid];\r\n\tvar num = (pug.js) ? pug.js.length : 0;\r\n\tif(pug.plugin) num++;\r\n\tfor(var i=0; i< num; i++){\r\n\t\tvar cssfid = plugid + \"_js_\" + i;\r\n\t\tvar cssdom = document.getElementById(cssfid);\r\n\t\tif(cssdom){\r\n\t\t\tcssdom.parentNode.removeChild(cssdom);\r\n\t\t}\r\n\t}\r\n\tnum = (pug.css ? pug.css.length : 0);\r\n\tfor(var i=0; i< num; i++){\r\n\t\tvar cssfid = plugid + \"_css_\" + i;\r\n\t\tvar cssdom = document.getElementById(cssfid);\r\n\t\tif(cssdom){\r\n\t\t\tcssdom.parentNode.removeChild(cssdom);\r\n\t\t}\r\n\t}\r\n\tthis.loaded.splice(this.loaded.indexOf(plugid), 1);\r\n}\r\n\r\nTerminusPluginManager.prototype.getAsDOM = function(ui){\r\n\tvar dm = document.createElement(\"span\");\r\n\tdm.setAttribute(\"class\", \"terminus-plugin-manager\");\r\n\tvar clh = document.createElement(\"span\");\r\n\tclh.setAttribute(\"class\", \"terminus-plugin-control-header terminus-plugin-nav terminus-pointer\");\r\n\tclh.appendChild(document.createTextNode(\"Plugins\"));\r\n\tdm.appendChild(clh);\r\n\tvar a = document.createElement('a');\r\n\tthis.showPlugins(a, ui);\r\n\tclh.appendChild(a);\r\n\ta.style.display = 'none';\r\n\tclh.addEventListener('click', function(){\r\n\t\tif(a.style.display == 'none')\r\n\t\t\ta.style.display = 'block';\r\n\t\telse a.style.display = 'none';\r\n\t})\r\n\treturn dm;\r\n}\r\n\r\nTerminusPluginManager.prototype.showPlugins = function(a, ui){\r\n\ta.setAttribute('style', 'background-color: #111;');\r\n\tfor(var pid in this.plugins){\r\n\t\ta.appendChild(this.getPluginDOM(pid, this.plugins[pid], ui));\r\n\t}\r\n}\r\n\r\nmodule.exports=TerminusPluginManager\r\n","\nmodule.exports = Object.freeze({\n\tCONNECT: 'connect',\n\tGET_SCHEMA: 'get_schema',\n\tUPDATE_SCHEMA: 'update_schema',\n\tUPDATE_DOCUMENT: 'update_document',\n\tCLASS_FRAME: 'class_frame',\n\tWOQL_SELECT: 'woql_select',\n\tGET_DOCUMENT: 'get_document',\n\tDELETE_DATABASE: 'delete_database',\n\tDELETE_DOCUMENT: 'delete_document',\n\tCREATE_DATABASE: 'create_database',\n\tCREATE_DOCUMENT: 'create_document',\n\tWOQL_UPDATE: 'woql_update'\n});\n\n/*\n{\"extends\": \"strongloop\",\n  \"env\": {\n\t\t\"browser\": true,\n\t\t\"node\": true,\n\t\t\"es6\": true\n  },\n  \"rules\":{\"max-len\": [\"error\", { \"code\": 100 }]},\n \"parserOptions\": { \"ecmaVersion\": 6 }}\n*/\n","function authorityActionsToArr(action) {\n\tif (Array.isArray(action) === false) return [];\n\n\treturn action.map(item => item['@id']);\n}\n\nfunction URIEncodePayload(payload) {\n\tif (typeof payload === 'string') return encodeURIComponent(payload);\n\tconst payloadArr = [];\n\tfor (const key of Object.keys(payload)) {\n\t\tif (typeof payload[key] === 'object') {\n\t\t\tfor (const keyElement of Object.keys(payload[key])) {\n\t\t\t\t const valueElement = payload[key][keyElement];\n\t\t\t\t payloadArr.push(`${encodeURIComponent(keyElement)}=${encodeURIComponent(valueElement)}`);\n\t\t\t}\n\t\t} else {\n\t\t\tpayloadArr.push(`${encodeURIComponent(key)}=${encodeURIComponent(payload[key])}`);\n\t\t}\n\t}\n\treturn payloadArr.join('&');\n}\n\nmodule.exports = { authorityActionsToArr, URIEncodePayload };\n","const HTMLStringViewer = require('./datatypes/String');\r\nconst HTMLStringEditor = require('./datatypes/StringEditor');\r\nconst HTMLBooleanViewer = require('./datatypes/Boolean');\r\nconst HTMLBooleanEditor = require('./datatypes/BooleanEditor');\r\nconst HTMLChoiceViewer = require('./datatypes/Choice');\r\nconst HTMLChoiceEditor = require('./datatypes/ChoiceEditor');\r\nconst HTMLCoordinateViewer = require('./datatypes/Coordinate');\r\nconst HTMLCoordinateEditor = require('./datatypes/CoordinateEditor');\r\nconst HTMLDateViewer = require('./datatypes/Date');\r\nconst HTMLDateEditor = require('./datatypes/DateEditor');\r\nconst HTMLEntityViewer = require('./datatypes/Entity');\r\nconst HTMLEntityEditor = require('./datatypes/EntityEditor');\r\nconst HTMLImageViewer = require('./datatypes/Image');\r\nconst HTMLImageEditor = require('./datatypes/ImageEditor');\r\nconst HTMLLinkViewer = require('./datatypes/Link');\r\nconst HTMLNumberViewer = require('./datatypes/Number');\r\nconst HTMLRangeViewer = require('./datatypes/Range');\r\nconst HTMLRangeEditor = require('./datatypes/RangeEditor');\r\nconst GoogleMapEditor = require('./datatypes/GoogleMapEditor');\r\nconst GoogleMapViewer = require('./datatypes/GoogleMapViewer');\r\nconst HTMLMarkupEditor = require('./datatypes/HTMLMarkupEditor');\r\nconst S2EntityEditor = require('./datatypes/S2EntityEditor');\r\n\r\n\r\nfunction initialiseDataRenderers(RenderingMap, plugins){\r\n\tRenderingMap.registerViewerForTypes(\"HTMLBooleanViewer\", {label: \"Checkbox Viewer\"}, [\"xsd:boolean\"]);\r\n\tRenderingMap.registerEditorForTypes(\"HTMLBooleanEditor\", {label: \"Checkbox Editor\"}, [\"xsd:boolean\"]);\r\n\tRenderingMap.registerViewerForTypes(\"HTMLChoiceViewer\", {label: \"Choice Viewer\"}, [\"oneOf\"]);\r\n\tRenderingMap.registerEditorForTypes(\"HTMLChoiceEditor\", {label: \"Choice Selector\"}, [\"oneOf\"]);\r\n\tRenderingMap.registerViewerForTypes(\"HTMLCoordinateViewer\", {label: \"Coordinate Viewer\"}, [\"xdd:coordinate\", \"xdd:coordinatePolyline\", \"xdd:coordinatePolygon\"]);\r\n\tRenderingMap.registerEditorForTypes(\"HTMLCoordinateEditor\", {label: \"Coordinate Editor\"}, [\"xdd:coordinate\", \"xdd:coordinatePolyline\", \"xdd:coordinatePolygon\"]);\r\n\tRenderingMap.registerViewerForTypes(\"HTMLDateViewer\", {label: \"Date Viewer\"}, [\"xsd:time\", \"xsd:date\", \"xsd:dateTime\", \"xsd:gYear\", \r\n\t\t\"xsd:gYearRange\", \"xsd:gMonth\", \"xsd:gDay\", \"xsd:gYearMonth\", \"xsd:gMonthDay\", \"xsd:dateTimeStamp\"]);\r\n\tRenderingMap.registerEditorForTypes(\"HTMLDateEditor\", {label: \"Date Editor\"}, [\"xsd:time\", \"xsd:date\", \"xsd:dateRange\" ,\"xsd:dateTime\", \"xsd:gYear\", \r\n\t\t\"xsd:gYearRange\", \"xsd:gMonth\", \"xsd:gDay\", \"xsd:gYearMonth\", \"xsd:gMonthDay\", \"xsd:dateTimeStamp\"]);\r\n\tRenderingMap.registerViewerForTypes(\"HTMLEntityViewer\", {label: \"Document Viewer\"}, [\"document\"]);\r\n\tRenderingMap.registerEditorForTypes(\"HTMLEntityEditor\", {label: \"Document Selector\"}, [\"document\"]);\r\n\tRenderingMap.registerViewerForTypes(\"HTMLImageViewer\", {label: \"Image Viewer\"}, [\"xdd:url\", \"xsd:anyURI\", \"xsd:base64Binary\"]);\r\n\tRenderingMap.registerEditorForTypes(\"HTMLImageEditor\", {label: \"Image Editor\"}, [\"xsd:base64Binary\"]);\r\n\tRenderingMap.registerViewerForTypes(\"HTMLImageViewer\", {label: \"Image Viewer\"}, [\"xdd:url\", \"xsd:anyURI\", \"xsd:base64Binary\"]);\r\n\tRenderingMap.registerEditorForTypes(\"HTMLImageEditor\", {label: \"Image Editor\"}, [\"xsd:base64Binary\"]);\r\n\tRenderingMap.registerViewerForTypes(\"HTMLLinkViewer\", {label: \"Link Viewer\"}, [\"xdd:url\", \"xsd:anyURI\"]);\r\n\tRenderingMap.registerViewerForTypes(\"HTMLNumberViewer\", {label: \"Number with commas\"}, \r\n\t\t\t[\"xsd:decimal\", \"xsd:double\", \"xsd:float\", \"xsd:short\", \"xsd:integer\", \"xsd:long\", \r\n\t\t\t\t\"xsd:nonNegativeInteger\", \"xsd:positiveInteger\", \"xsd:negativeInteger\", \"xsd:nonPositiveInteger\"]);\r\n\tRenderingMap.registerViewerForTypes(\"HTMLRangeViewer\", {label: \"Range Viewer\"}, [\"xdd:gYearRange\", \"xdd:dateRange\", \"xdd:integerRange\", \"xdd:decimalRange\"]);\r\n\tRenderingMap.registerEditorForTypes(\"HTMLRangeEditor\", {label: \"Range Editor\"}, [\"xdd:gYearRange\", \"xdd:dateRange\", \"xdd:integerRange\", \"xdd:decimalRange\"]);\r\n\tRenderingMap.universalEditor = \"HTMLStringEditor\";\r\n\tRenderingMap.universalViewer = \"HTMLStringViewer\";\r\n\taddPlugins(RenderingMap, plugins);\r\n\tRenderingMap.createRenderer = function(type, args){\r\n\t\tlet r = createDataRenderer(type, args);\r\n\t\treturn r;\r\n\t}\r\n}\r\n\r\nfunction createDataRenderer(type, options){\r\n\ttry {\r\n\t\tvar viewer = eval(\"new \" + type + \".\" + type + \"(\" + JSON.stringify(options) + \")\");\r\n\t}\r\n\tcatch(e){\r\n\t\treturn false;\r\n\t}\r\n\treturn viewer;\r\n}\r\n\r\nfunction addPlugins(RenderingMap, plugins){\r\n\tif(plugins && plugins.indexOf(\"gmaps\") != -1){\r\n\t\tRenderingMap.registerEditorForTypes(\"GoogleMapEditor\", {label: \"Google Map Editor\"}, [\"xdd:coordinate\", \"xdd:coordinatePolyline\", \"xdd:coordinatePolygon\"]);\r\n\t\tRenderingMap.registerViewerForTypes(\"GoogleMapViewer\", {label: \"Google Map Editor\"}, [\"xdd:coordinate\", \"xdd:coordinatePolyline\", \"xdd:coordinatePolygon\"]);\r\n\t}\r\n\tif(plugins && plugins.indexOf(\"quill\") != -1){\r\n\t\tRenderingMap.registerEditorForTypes(\"HTMLMarkupEditor\", {label: \"Quill WYSIWIG HTML Editor\"}, [\"xdd:html\"]);\r\n\t}\r\n\tif(plugins && plugins.indexOf(\"select2\") != -1){\r\n\t\tRenderingMap.registerEditorForFrameType(\"S2EntityEditor\", {label: \"S2 Autocomplete Selector\"}, \"document\");\r\n\t}\r\n}\r\n\r\nmodule.exports = {createDataRenderer, initialiseDataRenderers};","'use strict';\n\nmodule.exports = function bind(fn, thisArg) {\n  return function wrap() {\n    var args = new Array(arguments.length);\n    for (var i = 0; i < args.length; i++) {\n      args[i] = arguments[i];\n    }\n    return fn.apply(thisArg, args);\n  };\n};\n","'use strict';\n\nvar utils = require('./../utils');\n\nfunction encode(val) {\n  return encodeURIComponent(val).\n    replace(/%40/gi, '@').\n    replace(/%3A/gi, ':').\n    replace(/%24/g, '$').\n    replace(/%2C/gi, ',').\n    replace(/%20/g, '+').\n    replace(/%5B/gi, '[').\n    replace(/%5D/gi, ']');\n}\n\n/**\n * Build a URL by appending params to the end\n *\n * @param {string} url The base of the url (e.g., http://www.google.com)\n * @param {object} [params] The params to be appended\n * @returns {string} The formatted url\n */\nmodule.exports = function buildURL(url, params, paramsSerializer) {\n  /*eslint no-param-reassign:0*/\n  if (!params) {\n    return url;\n  }\n\n  var serializedParams;\n  if (paramsSerializer) {\n    serializedParams = paramsSerializer(params);\n  } else if (utils.isURLSearchParams(params)) {\n    serializedParams = params.toString();\n  } else {\n    var parts = [];\n\n    utils.forEach(params, function serialize(val, key) {\n      if (val === null || typeof val === 'undefined') {\n        return;\n      }\n\n      if (utils.isArray(val)) {\n        key = key + '[]';\n      } else {\n        val = [val];\n      }\n\n      utils.forEach(val, function parseValue(v) {\n        if (utils.isDate(v)) {\n          v = v.toISOString();\n        } else if (utils.isObject(v)) {\n          v = JSON.stringify(v);\n        }\n        parts.push(encode(key) + '=' + encode(v));\n      });\n    });\n\n    serializedParams = parts.join('&');\n  }\n\n  if (serializedParams) {\n    var hashmarkIndex = url.indexOf('#');\n    if (hashmarkIndex !== -1) {\n      url = url.slice(0, hashmarkIndex);\n    }\n\n    url += (url.indexOf('?') === -1 ? '?' : '&') + serializedParams;\n  }\n\n  return url;\n};\n","'use strict';\n\nmodule.exports = function isCancel(value) {\n  return !!(value && value.__CANCEL__);\n};\n","'use strict';\n\nvar utils = require('./utils');\nvar normalizeHeaderName = require('./helpers/normalizeHeaderName');\n\nvar DEFAULT_CONTENT_TYPE = {\n  'Content-Type': 'application/x-www-form-urlencoded'\n};\n\nfunction setContentTypeIfUnset(headers, value) {\n  if (!utils.isUndefined(headers) && utils.isUndefined(headers['Content-Type'])) {\n    headers['Content-Type'] = value;\n  }\n}\n\nfunction getDefaultAdapter() {\n  var adapter;\n  // Only Node.JS has a process variable that is of [[Class]] process\n  if (typeof process !== 'undefined' && Object.prototype.toString.call(process) === '[object process]') {\n    // For node use HTTP adapter\n    adapter = require('./adapters/http');\n  } else if (typeof XMLHttpRequest !== 'undefined') {\n    // For browsers use XHR adapter\n    adapter = require('./adapters/xhr');\n  }\n  return adapter;\n}\n\nvar defaults = {\n  adapter: getDefaultAdapter(),\n\n  transformRequest: [function transformRequest(data, headers) {\n    normalizeHeaderName(headers, 'Accept');\n    normalizeHeaderName(headers, 'Content-Type');\n    if (utils.isFormData(data) ||\n      utils.isArrayBuffer(data) ||\n      utils.isBuffer(data) ||\n      utils.isStream(data) ||\n      utils.isFile(data) ||\n      utils.isBlob(data)\n    ) {\n      return data;\n    }\n    if (utils.isArrayBufferView(data)) {\n      return data.buffer;\n    }\n    if (utils.isURLSearchParams(data)) {\n      setContentTypeIfUnset(headers, 'application/x-www-form-urlencoded;charset=utf-8');\n      return data.toString();\n    }\n    if (utils.isObject(data)) {\n      setContentTypeIfUnset(headers, 'application/json;charset=utf-8');\n      return JSON.stringify(data);\n    }\n    return data;\n  }],\n\n  transformResponse: [function transformResponse(data) {\n    /*eslint no-param-reassign:0*/\n    if (typeof data === 'string') {\n      try {\n        data = JSON.parse(data);\n      } catch (e) { /* Ignore */ }\n    }\n    return data;\n  }],\n\n  /**\n   * A timeout in milliseconds to abort a request. If set to 0 (default) a\n   * timeout is not created.\n   */\n  timeout: 0,\n\n  xsrfCookieName: 'XSRF-TOKEN',\n  xsrfHeaderName: 'X-XSRF-TOKEN',\n\n  maxContentLength: -1,\n\n  validateStatus: function validateStatus(status) {\n    return status >= 200 && status < 300;\n  }\n};\n\ndefaults.headers = {\n  common: {\n    'Accept': 'application/json, text/plain, */*'\n  }\n};\n\nutils.forEach(['delete', 'get', 'head'], function forEachMethodNoData(method) {\n  defaults.headers[method] = {};\n});\n\nutils.forEach(['post', 'put', 'patch'], function forEachMethodWithData(method) {\n  defaults.headers[method] = utils.merge(DEFAULT_CONTENT_TYPE);\n});\n\nmodule.exports = defaults;\n","'use strict';\n\nvar utils = require('./../utils');\nvar settle = require('./../core/settle');\nvar buildURL = require('./../helpers/buildURL');\nvar parseHeaders = require('./../helpers/parseHeaders');\nvar isURLSameOrigin = require('./../helpers/isURLSameOrigin');\nvar createError = require('../core/createError');\n\nmodule.exports = function xhrAdapter(config) {\n  return new Promise(function dispatchXhrRequest(resolve, reject) {\n    var requestData = config.data;\n    var requestHeaders = config.headers;\n\n    if (utils.isFormData(requestData)) {\n      delete requestHeaders['Content-Type']; // Let the browser set it\n    }\n\n    var request = new XMLHttpRequest();\n\n    // HTTP basic authentication\n    if (config.auth) {\n      var username = config.auth.username || '';\n      var password = config.auth.password || '';\n      requestHeaders.Authorization = 'Basic ' + btoa(username + ':' + password);\n    }\n\n    request.open(config.method.toUpperCase(), buildURL(config.url, config.params, config.paramsSerializer), true);\n\n    // Set the request timeout in MS\n    request.timeout = config.timeout;\n\n    // Listen for ready state\n    request.onreadystatechange = function handleLoad() {\n      if (!request || request.readyState !== 4) {\n        return;\n      }\n\n      // The request errored out and we didn't get a response, this will be\n      // handled by onerror instead\n      // With one exception: request that using file: protocol, most browsers\n      // will return status as 0 even though it's a successful request\n      if (request.status === 0 && !(request.responseURL && request.responseURL.indexOf('file:') === 0)) {\n        return;\n      }\n\n      // Prepare the response\n      var responseHeaders = 'getAllResponseHeaders' in request ? parseHeaders(request.getAllResponseHeaders()) : null;\n      var responseData = !config.responseType || config.responseType === 'text' ? request.responseText : request.response;\n      var response = {\n        data: responseData,\n        status: request.status,\n        statusText: request.statusText,\n        headers: responseHeaders,\n        config: config,\n        request: request\n      };\n\n      settle(resolve, reject, response);\n\n      // Clean up request\n      request = null;\n    };\n\n    // Handle browser request cancellation (as opposed to a manual cancellation)\n    request.onabort = function handleAbort() {\n      if (!request) {\n        return;\n      }\n\n      reject(createError('Request aborted', config, 'ECONNABORTED', request));\n\n      // Clean up request\n      request = null;\n    };\n\n    // Handle low level network errors\n    request.onerror = function handleError() {\n      // Real errors are hidden from us by the browser\n      // onerror should only fire if it's a network error\n      reject(createError('Network Error', config, null, request));\n\n      // Clean up request\n      request = null;\n    };\n\n    // Handle timeout\n    request.ontimeout = function handleTimeout() {\n      reject(createError('timeout of ' + config.timeout + 'ms exceeded', config, 'ECONNABORTED',\n        request));\n\n      // Clean up request\n      request = null;\n    };\n\n    // Add xsrf header\n    // This is only done if running in a standard browser environment.\n    // Specifically not if we're in a web worker, or react-native.\n    if (utils.isStandardBrowserEnv()) {\n      var cookies = require('./../helpers/cookies');\n\n      // Add xsrf header\n      var xsrfValue = (config.withCredentials || isURLSameOrigin(config.url)) && config.xsrfCookieName ?\n        cookies.read(config.xsrfCookieName) :\n        undefined;\n\n      if (xsrfValue) {\n        requestHeaders[config.xsrfHeaderName] = xsrfValue;\n      }\n    }\n\n    // Add headers to the request\n    if ('setRequestHeader' in request) {\n      utils.forEach(requestHeaders, function setRequestHeader(val, key) {\n        if (typeof requestData === 'undefined' && key.toLowerCase() === 'content-type') {\n          // Remove Content-Type if data is undefined\n          delete requestHeaders[key];\n        } else {\n          // Otherwise add header to the request\n          request.setRequestHeader(key, val);\n        }\n      });\n    }\n\n    // Add withCredentials to request if needed\n    if (config.withCredentials) {\n      request.withCredentials = true;\n    }\n\n    // Add responseType to request if needed\n    if (config.responseType) {\n      try {\n        request.responseType = config.responseType;\n      } catch (e) {\n        // Expected DOMException thrown by browsers not compatible XMLHttpRequest Level 2.\n        // But, this can be suppressed for 'json' type as it can be parsed by default 'transformResponse' function.\n        if (config.responseType !== 'json') {\n          throw e;\n        }\n      }\n    }\n\n    // Handle progress if needed\n    if (typeof config.onDownloadProgress === 'function') {\n      request.addEventListener('progress', config.onDownloadProgress);\n    }\n\n    // Not all browsers support upload events\n    if (typeof config.onUploadProgress === 'function' && request.upload) {\n      request.upload.addEventListener('progress', config.onUploadProgress);\n    }\n\n    if (config.cancelToken) {\n      // Handle cancellation\n      config.cancelToken.promise.then(function onCanceled(cancel) {\n        if (!request) {\n          return;\n        }\n\n        request.abort();\n        reject(cancel);\n        // Clean up request\n        request = null;\n      });\n    }\n\n    if (requestData === undefined) {\n      requestData = null;\n    }\n\n    // Send the request\n    request.send(requestData);\n  });\n};\n","'use strict';\n\nvar enhanceError = require('./enhanceError');\n\n/**\n * Create an Error with the specified message, config, error code, request and response.\n *\n * @param {string} message The error message.\n * @param {Object} config The config.\n * @param {string} [code] The error code (for example, 'ECONNABORTED').\n * @param {Object} [request] The request.\n * @param {Object} [response] The response.\n * @returns {Error} The created error.\n */\nmodule.exports = function createError(message, config, code, request, response) {\n  var error = new Error(message);\n  return enhanceError(error, config, code, request, response);\n};\n","'use strict';\n\nvar utils = require('../utils');\n\n/**\n * Config-specific merge-function which creates a new config-object\n * by merging two configuration objects together.\n *\n * @param {Object} config1\n * @param {Object} config2\n * @returns {Object} New object resulting from merging config2 to config1\n */\nmodule.exports = function mergeConfig(config1, config2) {\n  // eslint-disable-next-line no-param-reassign\n  config2 = config2 || {};\n  var config = {};\n\n  utils.forEach(['url', 'method', 'params', 'data'], function valueFromConfig2(prop) {\n    if (typeof config2[prop] !== 'undefined') {\n      config[prop] = config2[prop];\n    }\n  });\n\n  utils.forEach(['headers', 'auth', 'proxy'], function mergeDeepProperties(prop) {\n    if (utils.isObject(config2[prop])) {\n      config[prop] = utils.deepMerge(config1[prop], config2[prop]);\n    } else if (typeof config2[prop] !== 'undefined') {\n      config[prop] = config2[prop];\n    } else if (utils.isObject(config1[prop])) {\n      config[prop] = utils.deepMerge(config1[prop]);\n    } else if (typeof config1[prop] !== 'undefined') {\n      config[prop] = config1[prop];\n    }\n  });\n\n  utils.forEach([\n    'baseURL', 'transformRequest', 'transformResponse', 'paramsSerializer',\n    'timeout', 'withCredentials', 'adapter', 'responseType', 'xsrfCookieName',\n    'xsrfHeaderName', 'onUploadProgress', 'onDownloadProgress', 'maxContentLength',\n    'validateStatus', 'maxRedirects', 'httpAgent', 'httpsAgent', 'cancelToken',\n    'socketPath'\n  ], function defaultToConfig2(prop) {\n    if (typeof config2[prop] !== 'undefined') {\n      config[prop] = config2[prop];\n    } else if (typeof config1[prop] !== 'undefined') {\n      config[prop] = config1[prop];\n    }\n  });\n\n  return config;\n};\n","'use strict';\n\n/**\n * A `Cancel` is an object that is thrown when an operation is canceled.\n *\n * @class\n * @param {string=} message The message.\n */\nfunction Cancel(message) {\n  this.message = message;\n}\n\nCancel.prototype.toString = function toString() {\n  return 'Cancel' + (this.message ? ': ' + this.message : '');\n};\n\nCancel.prototype.__CANCEL__ = true;\n\nmodule.exports = Cancel;\n","const UTILS = require('./utils.js');\nconst CONST = require('./const.js');\nconst ErrorMessage = require('./errorMessage');\n/*\n * Creates an entry in the connection registry for the server\n * and all the databases that the client has access to\n * maps the input authorties to a per-db array for internal storage and easy\n * access control checks\n * {doc:dbid => {terminus:authority =>\n * [terminus:woql_select, terminus:create_document, auth3, ...]}}\n *\n */\n\nfunction ConnectionCapabilities(connectionConfig, key) {\n\tthis.connection = {};\n\tthis.connectionConfig = connectionConfig;\n\tif (this.connectionConfig.server && key) {\n\t\tthis.setClientKey(this.connectionConfig.server, key);\n\t}\n}\n\nConnectionCapabilities.prototype.getClientKey = function (serverURL) {\n\tif (!serverURL) serverURL = this.connectionConfig.serverURL();\n\tif (serverURL && this.connection[serverURL]) return this.connection[serverURL].key;\n\treturn false;\n};\n\n\n/*\n * Utility functions for changing the state of connections with Terminus servers\n */\nConnectionCapabilities.prototype.setClientKey = function (curl, key) {\n\tif (typeof key === 'string' && key.trim()) {\n\t\tif (typeof this.connection[curl] === 'undefined') {\n\t\t\tthis.connection[curl] = {};\n\t\t}\n\t\tthis.connection[curl].key = key.trim();\n\t}\n};\n\n\n/**\n * @params {string} curl a valid terminusDB server URL\n * @params {object} capabilities it is the connect call response\n */\nConnectionCapabilities.prototype.addConnection = function (curl, capabilities) {\n\tif (typeof this.connection[curl] === 'undefined') {\n\t\tthis.connection[curl] = {};\n\t}\n\tconst capabilitiesKeys = capabilities ? Object.keys(capabilities) : [];\n\n\tfor (const pred of capabilitiesKeys) {\n\t    if (pred === 'terminus:authority' && capabilities[pred]) {\n\t      const auths = Array.isArray(capabilities[pred]) === true\n\t        ? capabilities[pred]\n\t        : [capabilities[pred]];\n\n\t      for (let i = 0; i < auths.length; i += 1) {\n\t        let scope = auths[i]['terminus:authority_scope'];\n\t        const actions = auths[i]['terminus:action'];\n\n\t        if (Array.isArray(scope) === false) scope = [scope];\n\t        const actionsArr = UTILS.authorityActionsToArr(actions);\n\n\t        for (let j = 0; j < scope.length; j += 1) {\n\t          const nrec = scope[j];\n\t          if (typeof this.connection[curl][nrec['@id']] === 'undefined') {\n\t            this.connection[curl][nrec['@id']] = nrec;\n\t          }\n\t          this.connection[curl][nrec['@id']]['terminus:authority'] = actionsArr;\n\t        }\n\t      }\n\t    } else {\n\t      this.connection[curl][pred] = capabilities[pred];\n\t    }\n\t}\n};\n\nConnectionCapabilities.prototype.serverConnected = function () {\n\treturn typeof this.connection[this.connectionConfig.server] !== 'undefined';\n};\n\nConnectionCapabilities.prototype.capabilitiesPermit = function (action, dbid, server) {\n\tif (!this.connectionConfig.connectionMode()\n         || this.connectionConfig.client_checks_capabilities !== true\n         || action === CONST.CONNECT) { return true; }\n\n\tserver = server || this.connectionConfig.server;\n\tdbid = dbid || this.connectionConfig.dbid;\n\n\tlet rec;\n\n\tif (action === CONST.CREATE_DATABASE) {\n\t\trec = this.getServerRecord(server);\n\t} else if (dbid) rec = this.getDBRecord(dbid);\n\telse console.log('no dbid', server, dbid);\n\tif (rec) {\n\t\tconst auths = rec['terminus:authority'];\n\t\tif (auths && auths.indexOf(`terminus:${action}`) !== -1) return true;\n\t} else {\n\t\tconsole.log('problem with ', this.connection, action, server, dbid);\n\t}\n\tthis.error = ErrorMessage.accessDenied(action, dbid, server);\n\treturn false;\n};\n\nConnectionCapabilities.prototype.getServerRecord = function (srvr) {\n\tconst url = (srvr || this.connectionConfig.server);\n\tconst connectionObj = this.connection[url] || {};\n\tconst okeys = Object.keys(connectionObj);\n\n\tfor (const oid of okeys) {\n\t\tif (this.connection[url][oid]['@type'] === 'terminus:Server') {\n\t\t\treturn this.connection[url][oid];\n\t\t}\n\t}\n\treturn false;\n};\n\nConnectionCapabilities.prototype.getDBRecord = function (dbid, srvr) {\n\tconst url = (srvr || this.connectionConfig.server);\n\tdbid = (dbid || this.connectionConfig.dbid);\n\tif (typeof this.connection[url] !== 'object') {\n\t\treturn false;\n\t}\n\tif (typeof this.connection[url][dbid] !== 'undefined') { return this.connection[url][dbid]; }\n\n\tdbid = this.dbCapabilityID(dbid);\n\n\tif (typeof this.connection[url][dbid] !== 'undefined') { return this.connection[url][dbid]; }\n\n\treturn undefined;\n};\n\nConnectionCapabilities.prototype.getServerDBRecords = function (srvr) {\n\tconst url = (srvr || this.connectionConfig.server);\n\tconst dbrecs = {};\n\tconst connectionObj = this.connection[url] || {};\n\n\tfor (const oid of Object.keys(connectionObj)) {\n\t\tif (this.connection[url][oid]['@type'] === 'terminus:Database') {\n\t\t\tdbrecs[oid] = this.connection[url][oid];\n\t\t}\n\t}\n\treturn dbrecs;\n};\n\n/*\n * removes a database record from the connection registry (after deletion, for example)\n */\nConnectionCapabilities.prototype.removeDB = function (dbid, srvr) {\n\tdbid = dbid || this.connectionConfig.dbid;\n\n\tif (dbid && this.connectionConfig.dbid && this.connectionConfig.dbid === dbid) {\n\t\tthis.connectionConfig.dbid = false;\n\t}\n\n\tconst url = srvr || this.connectionConfig.server;\n\tconst dbidCap = this.dbCapabilityID(dbid);\n\tif (dbidCap && this.connection[url] && this.connection[url][dbidCap]) {\n\t\tdelete this.connection[url][dbidCap];\n\t}\n};\n\n\nConnectionCapabilities.prototype.dbCapabilityID = function (dbid) {\n\treturn `doc:${dbid}`;\n};\n\nConnectionCapabilities.prototype.getDBRecord = function (dbid, srvr) {\n\tconst url = srvr || this.connectionConfig.server;\n\tdbid = dbid || this.connectionConfig.dbid;\n\tif (typeof this.connection[url] !== 'object') {\n\t\treturn false;\n\t}\n\tif (typeof this.connection[url][dbid] !== 'undefined') { return this.connection[url][dbid]; }\n\n\tdbid = this.dbCapabilityID(dbid);\n\n\tif (typeof this.connection[url][dbid] !== 'undefined') { return this.connection[url][dbid]; }\n\n\treturn undefined;\n};\n\nmodule.exports = ConnectionCapabilities;\n","\nconst IDParser = require('./terminusIDParser');\n\nfunction ConnectionConfig(params) {\n\tconst newParams = params || {};\n\tthis.server = false;\n\tthis.dbid = false;\n\tthis.docid = false;\n\tif (newParams.server) this.setServer(newParams.server);\n\tif (newParams.db) this.setDB(newParams.db);\n\tif (newParams.doc) this.setDocument(newParams.doc);\n\t/*\n     * client configuration options - connected_mode = connected\n     * tells the client to first connect to the server before invoking other services\n     */\n\n\tthis.connected_mode = newParams.connected_mode || 'connected';\n\t// include a terminus:user_key API key in the calls\n\tthis.include_key = newParams.include_key || true;\n\t// client side checking of access control (in addition to server-side access control)\n\tthis.client_checks_capabilities = newParams.client_checks_capabilities || true;\n}\n\nConnectionConfig.prototype.serverURL = function () {\n\treturn this.server;\n};\n\n\nConnectionConfig.prototype.connectionMode = function () {\n\treturn this.connected_mode === 'connected';\n};\n\nConnectionConfig.prototype.includeKey = function () {\n\treturn this.include_key === true;\n};\n\nConnectionConfig.prototype.schemaURL = function () {\n\treturn `${this.dbURL()}/schema`;\n};\nConnectionConfig.prototype.queryURL = function () {\n\treturn `${this.dbURL()}/woql`;\n};\nConnectionConfig.prototype.frameURL = function () {\n\treturn `${this.dbURL()}/frame`;\n};\nConnectionConfig.prototype.docURL = function () {\n\treturn `${this.dbURL()}/document/${this.docid ? this.docid : ''}`;\n};\n\nConnectionConfig.prototype.dbURL = function (call) {\n\t// url swizzling to talk to platform using server/dbid/platform/ pattern..\n\tif (this.platformEndpoint()) {\n\t\tconst baseURL = this.server.substring(0, this.server.lastIndexOf('/platform/'));\n\n\t\tif (!call || call !== 'create') {\n\t\t\treturn `${baseURL}/${this.dbid}/platform`;\n\t\t} if (call === 'platform') {\n\t\t\treturn `${baseURL}/${this.dbid}`;\n\t\t}\n\t}\n\treturn this.server + this.dbid;\n};\n\nConnectionConfig.prototype.platformEndpoint = function () {\n\tif (this.server && this.server.lastIndexOf('/platform/') === this.server.length - 10) {\n\t\treturn true;\n\t}\n\treturn false;\n};\n\n/**\n * Utility functions for setting and parsing urls and determining\n * the current server, database and document\n */\nConnectionConfig.prototype.setServer = function (inputStr, context) {\n\tconst parser = new IDParser(context);\n\tif (parser.parseServerURL(inputStr)) {\n\t\tthis.server = parser.server();\n\t\tthis.dbid = false;\n\t\tthis.docid = false;\n\t\treturn true;\n\t}\n\treturn false;\n};\n\nConnectionConfig.prototype.setDB = function (inputStr, context) {\n\tconst parser = new IDParser(context);\n\tif (parser.parseDBID(inputStr)) {\n\t\tif (parser.server()) this.server = parser.server();\n\t\tthis.dbid = parser.dbid();\n\t\tthis.docid = false;\n\t\treturn true;\n\t}\n\treturn false;\n};\n\n// @param {string} inputStr TerminusDB server URL or a valid TerminusDB Id or omitted\n\nConnectionConfig.prototype.setSchemaURL = function (inputStr, context) {\n\tconst parser = new IDParser(context);\n\tif (parser.parseSchemaURL(inputStr)) {\n\t\tif (parser.server()) this.server = parser.server();\n\t\tthis.dbid = parser.dbid();\n\t\tthis.docid = false;\n\t\treturn true;\n\t}\n\treturn false;\n};\n\nConnectionConfig.prototype.setDocument = function (inputStr, context) {\n\tconst parser = new IDParser(context);\n\tif (parser.parseDocumentURL(inputStr)) {\n\t\tif (parser.server()) this.server = parser.server();\n\t\tif (parser.dbid()) this.dbid = parser.dbid();\n\t\tif (parser.docid()) this.docid = parser.docid();\n\t\treturn true;\n\t}\n\treturn false;\n};\n\nConnectionConfig.prototype.setQueryURL = function (inputStr, context) {\n\tconst parser = new IDParser(context);\n\tif (parser.parseQueryURL(inputStr)) {\n\t\tif (parser.server()) this.server = parser.server();\n\t\tthis.dbid = parser.dbid();\n\t\tthis.docid = false;\n\t\treturn true;\n\t}\n\treturn false;\n};\n\nConnectionConfig.prototype.setClassFrameURL = function (inputStr, context) {\n\tconst parser = new IDParser(context);\n\tif (parser.parseClassFrameURL(inputStr)) {\n\t\tif (parser.server()) this.server = parser.server();\n\t\tthis.dbid = parser.dbid();\n\t\tthis.docid = false;\n\t\treturn true;\n\t}\n\treturn false;\n};\n\nmodule.exports = ConnectionConfig;\n","/*\n11.75s$ npm install\n6.39s$ npm test\n*/\n/*\n * Helper class for parsing and decomposing Terminus URLs /\n * and dealing with namespace prefixed URLs\n */\n// const URL = require('url').URL;\n\n/*\n\"@context\": {\n    \"owl\":\"http://www.w3.org/2002/07/owl#\",\n    \"rdf\":\"http://www.w3.org/1999/02/22-rdf-syntax-ns#\",\n    \"xsd\":\"http://www.w3.org/2001/XMLSchema#\"\n  } */\n\n\nfunction IDParser(context) {\n\tthis.context = context;\n\tthis.server_url = false;\n\tthis.db = false;\n\tthis.doc = false;\n}\n\nIDParser.prototype.server = function () {\n\treturn this.server_url;\n};\n\nIDParser.prototype.dbid = function () {\n\treturn this.db;\n};\n\nIDParser.prototype.docid = function () {\n\treturn this.doc;\n};\n\nIDParser.prototype.setContext = function (context) {\n\tthis.context = context;\n};\n\nIDParser.prototype.parseServerURL = function (str) {\n\tthis.server_url = false;\n\n\tif (this.validURL(str)) {\n\t\tthis.server_url = str;\n\t} else if (this.context && this.validPrefixedURL(str, this.context)) {\n\t\tthis.server_url = this.expandPrefixed(str, this.context);\n\t}\n\n\tif (this.server_url && this.server_url.lastIndexOf('/') !== this.server_url.length - 1\n\t) {\n\t\tthis.server_url += '/';\n\t}\n\treturn this.server_url;\n};\n\nIDParser.prototype.parseDBID = function (str) {\n\tthis.db = false;\n\tif (this.context && this.validPrefixedURL(str, this.context)) {\n\t\tstr = this.expandPrefixed(str, this.context);\n\t}\n\tif (this.validURL(str)) {\n\t\tif (str.lastIndexOf('/') === str.length - 1) {\n\t\t\t// trim trailing slash\n\t\t\tstr = str.substring(0, str.length - 1);\n\t\t}\n\t\tconst index = str.lastIndexOf('/');\n\n\t\tconst serverURL = str.substring(0, index);\n\t\t// only dbNamer\n\t\tstr = str.substring(index + 1);\n\n\t\tif (this.parseServerURL(serverURL) === false) return false;\n\t}\n\n\tif (this.validIDString(str)) {\n\t\tthis.db = str;\n\t}\n\treturn this.db;\n};\n\nIDParser.prototype.parseDocumentURL = function (str) {\n\tthis.doc = false;\n\tif (this.context && this.validPrefixedURL(str, this.context)) {\n\t\tstr = this.expandPrefixed(str, this.context);\n\t}\n\n\tif (this.validURL(str)) {\n\t\tlet dbURL = str;\n\t\tif (str.lastIndexOf('/document/') !== -1) {\n\t\t\t// get dbURL\n\t\t\tdbURL = str.substring(0, str.lastIndexOf('/document/'));\n\t\t\tstr = str.substring(str.lastIndexOf('/document/') + 10);\n\t\t}\n\t\tif (this.parseDBID(dbURL) === false) return false;\n\t}\n\tif (str.substring(0, 4) === 'doc:') str = str.substring(4);\n\t// check if the document's name hasn't space or '/'\n\tif (this.validIDString(str)) {\n\t\tthis.doc = str;\n\t}\n\treturn this.doc;\n};\n\nIDParser.prototype.parseSchemaURL = function (str) {\n\tif (this.context && this.validPrefixedURL(str, this.context)) {\n\t\tstr = this.expandPrefixed(str, this.context);\n\t}\n\tif (this.validURL(str)) {\n\t\tstr = this.stripOptionalPath(str, 'schema');\n\t}\n\treturn this.parseDBID(str);\n};\n\nIDParser.prototype.parseQueryURL = function (str) {\n\tif (this.context && this.validPrefixedURL(str, this.context)) {\n\t\tstr = this.expandPrefixed(str, this.context);\n\t}\n\tif (this.validURL(str)) {\n\t\tstr = this.stripOptionalPath(str, 'woql');\n\t\tstr = this.stripOptionalPath(str, 'query');\n\t}\n\treturn this.parseDBID(str);\n};\n\nIDParser.prototype.stripOptionalPath = function (str, bit) {\n\tif (str.indexOf(`/${bit}`) !== -1) str = str.substring(0, str.indexOf(`/${bit}`));\n\treturn str;\n};\n\nIDParser.prototype.parseClassFrameURL = function (str) {\n\tif (this.context && this.validPrefixedURL(str, this.context)) {\n\t\tstr = this.expandPrefixed(str, this.context);\n\t}\n\tif (this.validURL(str)) {\n\t\tstr = this.stripOptionalPath(str, 'frame');\n\t}\n\treturn this.parseDBID(str);\n};\n\n// Valid URLs are those that start with http:// or https://\nIDParser.prototype.validURL = function (str) {\n\tif (str.substring(0, 7) === 'http://' || str.substring(0, 8) === 'https://') return true;\n\treturn false;\n};\n\nIDParser.prototype.validPrefixedURL = function (str, context) {\n\tif (typeof str !== 'string' || typeof context !== 'object') return false;\n\tconst parts = str.split(':');\n\tif (parts.length !== 2) return false;\n\tif (parts[0].length < 1 || parts[1].length < 1) return false;\n\tif (context && context[parts[0]] && this.validIDString(parts[1])) return true;\n\treturn false;\n};\n\nIDParser.prototype.validIDString = function (str) {\n\tif (typeof str !== 'string') return false;\n\tif (str.indexOf(':') !== -1 || str.indexOf(' ') !== -1 || str.indexOf('/') !== -1) return false;\n\treturn true;\n};\n\nIDParser.prototype.expandPrefixed = function (str, context) {\n\tconst parts = str.split(':');\n\treturn context[parts[0]] + parts[1];\n};\n\nmodule.exports = IDParser;\n","/**\r\n * A frame pattern can have the following variables\r\n * renderer : object, property, data, * - matches a specific part of the frame\r\n * label : matches the label of a property\r\n * frame_type: object, data, document, oneOf\r\n * subject: id of the subject\r\n * subjectClass: class of the subject\r\n * range: type of a property (applies to property and data)\r\n * property: property id or list of property ids (parent property if it is an object or data)\r\n * value: value of the property\r\n * parent: a pattern relating to the parent of this frame\r\n * children: patterns for matching on the children of a frame\r\n * depth: how deep are we in the document? starts from 0\r\n * index: the index of a value in an array\r\n * status: updated, error, new, ok,\r\n */\r\n\r\nfunction FramePattern(pattern){\r\n\tif(pattern){\r\n\t\tthis.setPattern(pattern);\r\n\t}\r\n};\r\n\r\nFramePattern.prototype.setPattern = function(pattern){\r\n\tthis.scope = (pattern.scope ? pattern.scope: false);\r\n\tthis.label = (pattern.label ? pattern.label : false);\r\n\tthis.frame_type = (pattern.frame_type ? pattern.frame_type : false);\r\n\tthis.subject = (pattern.subject ? pattern.subject : false);\r\n\tthis.subjectClass = (pattern.subjectClass ? pattern.subjectClass : false);\r\n\tthis.range = (pattern.range ? pattern.range : false);\r\n\tthis.property = (pattern.property ? pattern.property : false);\r\n\tthis.value = (pattern.value ? pattern.value : false);\r\n\tthis.parent = (pattern.parent ? new FramePattern(pattern.parent) : false);\r\n\tthis.children = [];\r\n\tif (pattern.children) {\r\n\t\tfor (let i = 0; i < pattern.children.length; i++) {\r\n\t\t\tthis.children.push(new FramePattern(pattern.children[i]));\r\n\t\t}\r\n\t}\r\n\tthis.depth = (typeof pattern.depth !== 'undefined' ? pattern.depth : false);\r\n\tthis.index = (pattern.index ? pattern.index : false);\r\n\tthis.status = (pattern.status ? pattern.status : false);\r\n}\r\n\r\nFramePattern.prototype.checkFrame = function(frame){\r\n\tvar rtype = this.getRendererType(frame);\r\n\tif(!rtype) return false;\r\n\tif(this.scope && (this.scope != rtype) && (this.scope != \"*\" )) return false;\r\n\tif(this.illegalRuleType(rtype)) return false;\r\n\tif(this.frame_type && !this.checkFrameType(rtype, frame)) return false;\r\n\tif(this.label && !this.checkLabel(rtype, frame)) return false;\r\n\tif(this.subject && !this.checkSubject(rtype, frame)) return false;\r\n\tif(this.subjectClass && !this.checkSubjectClass(rtype, frame)) return false;\r\n\tif(this.property && !this.checkProperty(rtype, frame)) return false;\r\n\tif(this.depth !== false && !this.checkDepth(rtype, frame)) return false;\r\n\tif(this.range && !this.checkRange(rtype, frame)) return false;\r\n\tif(this.value && !this.checkValue(rtype, frame)) return false;\r\n\tif(this.parent && !this.checkParent(rtype, frame)) return false;\r\n\tif(this.children && this.children.length && !this.checkChildren(rtype, frame)) return false;\r\n\tif(this.index && !this.checkIndex(rtype, frame)) return false;\r\n\tif(this.status && !this.checkStatus(rtype, frame)) return false;\r\n\treturn true;\r\n};\r\n\r\nFramePattern.prototype.illegalRuleType = function (rtype) {\r\n\t// data frames have no children\r\n\tif (rtype == 'data' && this.children.length) return true;\r\n\t// object frames have no range\r\n\tif (rtype == 'object' && this.range) return true;\r\n\treturn false;\r\n};\r\n\r\n/* subject is an id or an array of ids,\r\n/* match is positive if the renderer's subject appears in the array or is the id\r\n */\r\nFramePattern.prototype.checkSubject = function (subject, frame) {\r\n\tif (typeof this.subject !== 'object' || !this.subject.length) this.subject = [this.subject];\r\n\tconst rsubj = frame.subject();\r\n\tfor (let i = 0; i < this.subject.length; i++) {\r\n\t\tif (this.IDsMatch(subject[i], rsubj)) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n};\r\n\r\n// at least one child must match all child rules\r\nFramePattern.prototype.checkChildren = function (rtype, frame) {\r\n\tfor (let i = 0; i < this.children.length; i++) {\r\n\t\tlet found = false;\r\n\t\tif (rtype == 'object') {\r\n\t\t\tfor (const prop in frame.properties) {\r\n\t\t\t\tif (this.children[i].checkFrame(frame.properties[prop])) {\r\n\t\t\t\t\tfound = true;\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else if (rtype == 'property') {\r\n\t\t\tfor (let j = 0; j <= renderer.values.length; j++) {\r\n\t\t\t\tif (this.children[j].checkFrame(frame.values[j])) {\r\n\t\t\t\t\tfound = true;\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (!found) return false;\r\n\t}\r\n\treturn true;\r\n};\r\n\r\nFramePattern.prototype.checkStatus = function (rtype, frame) {\r\n\tif (typeof this.status !== 'object' || this.status.length == 0) this.status = [this.status];\r\n\tfor (let i = 0; i < this.status.length; i++) {\r\n\t\tif (this.status[i] == 'updated' && !frame.isUpdated()) return false;\r\n\t\tif (this.status[i] == 'new' && !frame.isNew()) return false;\r\n\t\tif (this.status[i] == 'unchanged' && frame.isUpdated()) return false;\r\n\t}\r\n\treturn true;\r\n};\r\n\r\nFramePattern.prototype.checkDepth = function (rtype, frame) {\r\n\treturn this.numberMatch(this.depth, frame.depth());\r\n};\r\n\r\nFramePattern.prototype.checkParent = function (rtype, frame) {\r\n\treturn this.parent.checkFrame(frame.parent);\r\n};\r\n\r\nFramePattern.prototype.checkIndex = function (rtype, frame) {\r\n\tif (rtype == 'data') {\r\n\t\treturn this.index == frame.index;\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nFramePattern.prototype.checkProperty = function (rtype, frame) {\r\n\tif (typeof this.property !== 'object' || !this.property.length) this.property = [this.property];\r\n\tfor (let i = 0; i < this.property.length; i++) {\r\n\t\tif (this.propertyIDsMatch(frame.property(), this.property[i])) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n};\r\n\r\n// returns true if any of the values are found\r\nFramePattern.prototype.checkValue = function (rtype, frame) {\r\n\tif (typeof this.value !== 'object' || !this.value.length) this.value = [this.value];\r\n\tfor (let i = 0; i < this.value.length; i++) {\r\n\t\tif (rtype == 'data') {\r\n\t\t\tif (this.valuesMatch(frame.value(), this.value[i])) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t} else if (rtype == 'property') {\r\n\t\t\tfor (let j = 0; j <= frame.values.length; j++) {\r\n\t\t\t\tif (this.getRendererType(frame.values[i]) == 'data'\r\n\t\t\t\t\t\t&& this.valuesMatch(frame.values[i].get(), this.value[i])) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else if (rtype == 'object') {\r\n\t\t\tfor (const prop in frame.properties) {\r\n\t\t\t\tif (this.checkValue(this.getRendererType(frame.properties[prop]), frame.properties[prop])) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nFramePattern.prototype.checkRange = function (rtype, frame) {\r\n\tif (typeof this.range !== 'object' || !this.range.length) this.range = [this.range];\r\n\tfor (let i = 0; i < this.range.length; i++) {\r\n\t\tif (this.rangeIDsMatch(frame.range(), this.range[i])) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nFramePattern.prototype.checkSubjectClass = function (rtype, frame) {\r\n\tif (typeof this.subjectClass !== 'object' || !this.subjectClass.length) this.subjectClass = [this.subjectClass];\r\n\tconst rcls = frame.subjectClass();\r\n\tfor (let i = 0; i < this.subjectClass.length; i++) {\r\n\t\tif (this.classIDsMatch(this.subjectClass[i], rcls)) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nFramePattern.prototype.checkFrameType = function (rtype, frame) {\r\n\tif (rtype == 'object') return this.frame_type == 'object';\r\n\tif (rtype == 'data') {\r\n\t\tif (frame.frame) {\r\n\t\t\treturn this.frame_type == frame.frame.ftype();\r\n\t\t}\r\n\t}\r\n\tif (rtype == 'property') return false;\r\n};\r\n\r\nFramePattern.prototype.checkLabel = function (rtype, frame) {\r\n\tif (typeof frame.getLabel !== 'function') {\r\n\t\tconsole.log(new Error('Rule passed to check label with broken renderer object - no getLabel'));\r\n\t\treturn false;\r\n\t}\r\n\treturn this.stringMatch(this.label, frame.getLabel());\r\n};\r\n\r\nFramePattern.prototype.IDsMatch = function (ida, idb) {\r\n\treturn TerminusClient.FrameHelper.compareIDs(ida, idb);\r\n};\r\n\r\nFramePattern.prototype.classIDsMatch = function (ida, idb) {\r\n\treturn this.IDsMatch(ida, idb);\r\n};\r\nFramePattern.prototype.propertyIDsMatch = function (ida, idb) {\r\n\tconst match = this.IDsMatch(ida, idb);\r\n\treturn match;\r\n};\r\nFramePattern.prototype.rangeIDsMatch = function (ida, idb) {\r\n\treturn this.IDsMatch(ida, idb);\r\n};\r\nFramePattern.prototype.valuesMatch = function (vala, valb) {\r\n\treturn vala == valb;\r\n};\r\nFramePattern.prototype.numberMatch = function (vala, valb) {\r\n\tif (typeof vala === 'string') {\r\n\t\ttry {\r\n\t\t\treturn eval(valb + vala);\r\n\t\t} catch (e) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\treturn vala === valb;\r\n};\r\n\r\nFramePattern.prototype.stringMatch = function (vala, valb) {\r\n\tconst pat = new RegExp(vala);\r\n\treturn pat.test(valb);\r\n};\r\n\r\nFramePattern.prototype.getRendererType = function (frame) {\r\n\tif (frame.isProperty()) return 'property';\r\n\tif (frame.isObject()) return 'object';\r\n\tif (frame.isData()) return 'data';\r\n\tif (frame.renderer_type) return frame.renderer_type;\r\n\tconsole.log(new Error(`frame configuration passed non-renderer type ${frame.constructor.name}`));\r\n\tconsole.log(renderer);\r\n\treturn false;\r\n};\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * FramePatternMatcher does pattern matching on frames\r\n * Does a given pattern match a given frame?\r\n */\r\nconst FramePatternMatcher = {}\r\n\r\n/**\r\n * Runs an array of matching rules across a frame and calls the passed onmatch function on each match\r\n * The optional onmatch function is called with each hit and is passed the frame and the rule that hit it.\r\n * A list of the matched rules is returned.\r\n *\r\n */\r\nFramePatternMatcher.testRules = function(rules, frame, onmatch){\r\n\tvar matched_rules = [];\r\n\tif(rules && rules.length){\r\n\t\tfor(var i = 0; i<rules.length; i++){\r\n\t\t\tvar match = (!rules[i].rule.pattern || FramePatternMatcher.patternMatchesFrame(rules[i].rule.pattern, frame));\r\n\t\t\tif(match){\r\n\t\t\t\tmatched_rules.push(rules[i]);\r\n\t\t\t\tif(onmatch && typeof onmatch == \"function\"){\r\n\t\t\t\t\tonmatch(frame, rules[i]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn matched_rules;\r\n}\r\n\r\n/**\r\n * Determines whether a given pattern matches a given frame\r\n */\r\nFramePatternMatcher.patternMatchesFrame = function(pattern, frame){\r\n\tif(typeof pattern == \"object\" && pattern.length){ //multiple patterns are ANDed\r\n\t\tfor(var i = 0 ; i<pattern.length; i++){\r\n\t\t\tvar fp = new FramePattern(pattern[i]);\r\n\t\t\tif(!fp.checkFrame(frame)) return false;\r\n\t\t}\r\n\t\treturn true;\r\n\t}\r\n\telse {\r\n\t\tvar fp = new FramePattern(pattern);\r\n\t\treturn fp.checkFrame(frame);\r\n\t}\r\n}\r\n\r\n\r\n\r\nfunction FrameRule(){\r\n\tthis.rule = { pattern: {} };\r\n\treturn this;\r\n};\r\n\r\n\r\nFrameRule.prototype.unpack = function(arr, nonstring){\r\n\tif(nonstring) var str = arr.join(\",\");\r\n\tvar str = \"'\" + arr.join(\"','\") + \"'\";\r\n\treturn str;\r\n}\r\n\r\nFrameRule.prototype.prettyPrint = function(type){\r\n\t//starts with obj. ...\r\n\tif(this.scope() == \"*\"){\r\n\t\tvar str = \"all()\";\r\n\t}\r\n\telse {\r\n\t\tvar str = this.scope() + \"()\";\r\n\t}\r\n\tif(typeof this.frameType() != \"undefined\"){\r\n\t\tstr += \".frame_type(\" + this.unpack(this.frameType()) + \")\";\r\n\t}\r\n\tif(typeof this.label() != \"undefined\"){\r\n\t\tstr += \".label(\" + this.unpack(this.label()) + \")\";\r\n\t}\r\n\tif(typeof this.subject() != \"undefined\"){\r\n\t\tstr += \".subject(\" + this.unpack(this.subject()) + \")\";\r\n\t}\r\n\tif(typeof this.subjectClass() != \"undefined\"){\r\n\t\tstr += \".subjectClass(\" + this.unpack(this.subjectClass()) + \")\";\r\n\t}\r\n\tif(typeof this.property() != \"undefined\"){\r\n\t\tstr += \".property(\" + this.unpack(this.property()) + \")\";\r\n\t}\r\n\tif(typeof this.range() != \"undefined\"){\r\n\t\tstr += \".range(\" + this.unpack(this.range()) + \")\";\r\n\t}\r\n\tif(typeof this.value() != \"undefined\"){\r\n\t\tstr += \".value(\" + this.unpack(this.value()) + \")\";\r\n\t}\r\n\tif(typeof this.children() != \"undefined\" && this.children.length > 0){\r\n\t\tstr += \".children(\\n\";\r\n\t\tvar kids = this.children();\r\n\t\tfor(var i = 0; i< kids.length; i++){\r\n\t\t\tstr += kids.prettyPrint() + \"\\n\";\r\n\t\t}\r\n\t\tstr += \")\";\r\n\t}\r\n\tif(typeof this.parent() != \"undefined\"){\r\n\t\tstr += \".parent(\" + this.parent.prettyPrint() + \")\";\r\n\t}\r\n\tif(typeof this.depth() != \"undefined\"){\r\n\t\tstr += \".depth('\" + this.depth() + \"')\";\r\n\t}\r\n\tif(typeof this.index() != \"undefined\"){\r\n\t\tstr += \".index(\" + this.unpack(this.index(), true) + \")\";\r\n\t}\r\n\tif(typeof this.status() != \"undefined\"){\r\n\t\tstr += \".status(\" + this.unpack(this.status()) + \")\";\r\n\t}\r\n\tif(typeof this.renderer() != \"undefined\"){\r\n\t\tstr += \".renderer('\" + this.renderer() + \"')\";\r\n\t}\r\n\tif(typeof this.render() != \"undefined\"){\r\n\t\tstr += \".render(\" + this.render() + \")\";\r\n\t}\r\n\tif(typeof this.compare() != \"undefined\"){\r\n\t\tstr += \".compare(\" + this.compare() + \")\";\r\n\t}\r\n\tif(typeof this.mode() != \"undefined\"){\r\n\t\tstr += \".mode('\" + this.mode() + \"')\";\r\n\t}\r\n\tif(typeof this.collapse() != \"undefined\"){\r\n\t\tstr += \".collapse(\" + this.collapse() + \")\";\r\n\t}\r\n\tif(typeof this.hidden() != \"undefined\"){\r\n\t\tstr += \".hidden(\" + this.hidden() + \")\";\r\n\t}\r\n\tif(typeof this.view() != \"undefined\"){\r\n\t\tstr += \".view('\" + this.view() + \"')\";\r\n\t}\r\n\tif(typeof this.showDisabledButtons() != \"undefined\"){\r\n\t\tstr += \".showDisabledButtons(\" + this.showDisabledButtons() + \")\";\r\n\t}\r\n\tif(typeof this.header() != \"undefined\"){\r\n\t\tstr += \".header(\" + this.header() + \")\";\r\n\t}\r\n\tif(typeof this.features() != \"undefined\"){\r\n\t\tstr += \".features(\" + this.unpack(this.features()) + \")\";\r\n\t}\r\n\tif(typeof this.headerFeatures() != \"undefined\"){\r\n\t\tstr += \".headerFeatures(\" + this.unpack(this.headerFeatures()) + \")\";\r\n\t}\r\n\tif(typeof this.showEmpty() != \"undefined\"){\r\n\t\tstr += \".showEmpty(\" + this.show_empty() + \")\";\r\n\t}\r\n\tif(typeof this.dataviewer() != \"undefined\"){\r\n\t\tstr += \".dataviewer('\" + this.dataviewer() + \"')\";\r\n\t}\r\n\tif(typeof this.args() != \"undefined\"){\r\n\t\tstr += \".args(\" + JSON.stringify(this.args()) + \")\";\r\n\t}\r\n\tif(typeof this.featureRenderers() != \"undefined\"){\r\n\t\tstr += \".featureRenderers({\";\r\n\t\tfor(var f in this.featureRenderers()){\r\n\t\t\tstr += JSON.stringify(f) + \":\" + this.rule.feature_renderers[f] + \",\";\r\n\t\t}\r\n\t\tstr = str.substring(0, str.length-1);\r\n\t\tstr += \"})\";\r\n\t}\r\n\treturn str;\r\n}\r\n\r\nFrameRule.prototype.scope = function(scope){\r\n\tif(typeof scope == \"undefined\") return this.rule.pattern.scope;\r\n\tthis.rule.pattern.scope = scope;\r\n\treturn this;\r\n};\r\n\r\nFrameRule.prototype.frameType = function(...frametype){\r\n\tif(typeof frametype == \"undefined\" || frametype.length == 0) return this.rule.pattern.frametype;\r\n\tthis.rule.pattern.frametype = frame_type;\r\n\treturn this;\r\n};\r\n\r\nFrameRule.prototype.label = function(...label){\r\n\tif(typeof label == \"undefined\" || label.length == 0) return this.rule.pattern.label;\r\n\tthis.rule.pattern.label = label;\r\n\treturn this;\r\n};\r\n\r\nFrameRule.prototype.subject = function(...subject){\r\n\tif(typeof subject == \"undefined\" || subject.length == 0) return this.rule.pattern.subject;\r\n\tthis.rule.pattern.subject = subject;\r\n\treturn this;\r\n};\r\n\r\nFrameRule.prototype.subjectClass = function(...subjectClass){\r\n\tif(typeof subjectClass == \"undefined\" || subjectClass.length == 0) return this.rule.pattern.subjectClass;\r\n\tthis.rule.pattern.subjectClass = subjectClass;\r\n\treturn this;\r\n};\r\n\r\nFrameRule.prototype.property = function(...property){\r\n\tif(typeof property == \"undefined\" || property.length == 0) return this.rule.pattern.property;\r\n\tthis.rule.pattern.property = property;\r\n\treturn this;\r\n};\r\n\r\nFrameRule.prototype.depth = function(depth){\r\n\tif(typeof depth == \"undefined\") return this.rule.pattern.depth;\r\n\tthis.rule.pattern.depth = depth;\r\n\treturn this;\r\n};\r\n\r\nFrameRule.prototype.range = function(...range){\r\n\tif(typeof range == \"undefined\" || range.length == 0) return this.rule.pattern.range;\r\n\tthis.rule.pattern.range = range;\r\n\treturn this;\r\n};\r\n\r\nFrameRule.prototype.value = function(...value){\r\n\tif(typeof value == \"undefined\" || value.length == 0) return this.rule.pattern.value;\r\n\tthis.rule.pattern.value = value;\r\n\treturn this;\r\n};\r\n\r\nFrameRule.prototype.pattern = function () {\r\n\treturn this.rule.pattern;\r\n};\r\n\r\nFrameRule.prototype.json = function(json){\r\n\tif(!json) return this.rule;\r\n\tthis.rule = json;\r\n\treturn this;\r\n}\r\n\r\nFrameRule.prototype.parent = function(parent){\r\n\tif(typeof parent == \"undefined\") return this.rule.pattern.parent;\r\n\tthis.rule.pattern.parent = parent.pattern();\r\n\treturn this;\r\n};\r\n\r\nFrameRule.prototype.children = function(...children){\r\n\tif(typeof children == \"undefined\") return this.rule.pattern.children;\r\n\tif(typeof this.rule.pattern.children == \"undefined\"){\r\n\t\tthis.rule.pattern.children = [];\r\n\t}\r\n\tfor (let i = 0; i < children.length; i++) {\r\n\t\tthis.rule.pattern.children.push(children[i].pattern());\r\n\t}\r\n\treturn this;\r\n};\r\n\r\nFrameRule.prototype.index = function(...index){\r\n\tif(typeof index == \"undefined\" || index.length == 0) return this.rule.pattern.index;\r\n\tthis.rule.pattern.index = index;\r\n\treturn this;\r\n};\r\n\r\nFrameRule.prototype.status = function(...status){\r\n\tif(typeof status == \"undefined\" || status.length == 0) return this.rule.pattern.status;\r\n\tthis.rule.pattern.status = status;\r\n\treturn this;\r\n};\r\n\r\nFrameRule.prototype.renderer = function(rend){\r\n\tif(!rend) return this.rule.renderer;\r\n\tthis.rule.renderer = rend;\r\n\treturn this;\r\n}\r\n\r\nFrameRule.prototype.render = function(func){\r\n\tif(func){\r\n\t\tthis.rule.render = func;\r\n\t\treturn this;\r\n\t}\r\n\treturn func;\r\n}\r\n\r\nFrameRule.prototype.args = function(json){\r\n\tif(!json) return this.rule.args;\r\n\tthis.rule.args = json;\r\n\treturn this;\r\n}\r\n\r\nFrameRule.prototype.compare = function(func){\r\n\tif(!func) return this.rule.compare;\r\n\tthis.rule.compare = func;\r\n\treturn this;\r\n}\r\n\r\nFrameRule.prototype.mode = function(m){\r\n\tif(!m) return this.rule.mode;\r\n\tthis.rule.mode = m;\r\n\treturn this;\r\n}\r\n\r\nFrameRule.prototype.collapse = function(m){\r\n\tif(!m) return this.rule.collapse;\r\n\tthis.rule.collapse = m;\r\n\treturn this;\r\n}\r\n\r\n\r\nFrameRule.prototype.hidden = function(m){\r\n\tif(!m) return this.rule.hidden;\r\n\tthis.rule.hidden = m;\r\n\treturn this;\r\n}\r\n\r\nFrameRule.prototype.view = function(m){\r\n\tif(!m) return this.rule.view;\r\n\tthis.rule.view = m;\r\n\treturn this;\r\n}\r\n\r\nFrameRule.prototype.showDisabledButtons = function(m){\r\n\tif(!m) return this.rule.show_disabled_buttons;\r\n\tthis.rule.show_disabled_buttons = m;\r\n\treturn this;\r\n}\r\n\r\nFrameRule.prototype.features = function(...m){\r\n\tif(typeof m == \"undefined\" || m.length == 0) return this.rule.features;\r\n\tthis.rule.features = m;\r\n\treturn this;\r\n}\r\n\r\nFrameRule.prototype.headerFeatures = function(...m){\r\n\tif(typeof m == \"undefined\" || m.length == 0) return this.rule.header_features;\r\n\tthis.rule.header_features = m;\r\n\treturn this;\r\n}\r\n\r\nFrameRule.prototype.header = function(m){\r\n\tif(!m) return this.rule.header;\r\n\tthis.rule.header = m;\r\n\treturn this;\r\n}\r\n\r\nFrameRule.prototype.featureRenderers = function(m){\r\n\tif(!m) return this.rule.feature_renderers;\r\n\tthis.rule.feature_renderers = m;\r\n\treturn this;\r\n}\r\n\r\nFrameRule.prototype.showEmpty = function(m){\r\n\tif(!m) return this.rule.show_empty;\r\n\tthis.rule.show_empty = m;\r\n\treturn this;\r\n}\r\n\r\nFrameRule.prototype.dataviewer = function(m){\r\n\tif(!m) return this.rule.dataviewer;\r\n\tthis.rule.dataviewer = m;\r\n\treturn this;\r\n}\r\n\r\nmodule.exports = {FramePatternMatcher, FramePattern, FrameRule } ;\r\n","const TerminusClient = require('@terminusdb/terminus-client');\r\nconst WOQLChooser = require(\"./WOQLChooser\");\r\nconst WOQLTable = require(\"./WOQLTable\");\r\nconst WOQLQueryViewer = require(\"./WOQLQueryView\");\r\nconst WOQLGraph = require(\"./WOQLGraph\");\r\nconst WOQLStream = require(\"./WOQLStream\");\r\nconst TerminusFrame = require(\"./TerminusFrame\");\r\n\r\nTerminusClient.WOQL.table = function(){ return new WOQLTableConfig(); }\r\nTerminusClient.WOQL.graph = function(){ return new WOQLGraphConfig(); }\r\nTerminusClient.WOQL.chooser = function(){ return new WOQLChooserConfig(); }\r\nTerminusClient.WOQL.stream = function(){ return new WOQLStreamConfig(); }\r\nTerminusClient.WOQL.document = function(){ return new FrameConfig(); }\r\nTerminusClient.WOQL.loadConfig = function(config){\r\n\tif(config.table){\r\n\t\tvar view = new WOQLTableConfig();\r\n\t\tview.loadJSON(config.table, config.rules);\r\n\t}\r\n\telse if(config.chooser){\r\n\t\tvar view = new WOQLChooserConfig();\r\n\t\tview.loadJSON(config.chooser, config.rules);\r\n\t}\r\n\telse if(config.graph){\r\n\t\tvar view = new WOQLGraphConfig();\r\n\t\tview.loadJSON(config.graph, config.rules);\r\n\t}\r\n\telse if(config.stream){\r\n\t\tvar view = new WOQLStreamConfig();\r\n\t\tview.loadJSON(config.stream, config.rules);\r\n\t}\r\n\telse if(config.frame){\r\n\t\tvar view = new FrameConfig();\r\n\t\tview.loadJSON(config.frame, config.rules);\r\n\t}\r\n\treturn view;\r\n}\r\n//the below are aspirational...\r\n//TerminusClient.WOQL.map = function(){ return new WOQLMapConfig(); }\r\n//TerminusClient.WOQL.chart = function(){ return new WOQLChartConfig(); }\r\n\r\n//Class for expressing and matching rules about WOQL results\r\n//especially for efficiently expressing rules about how they should be rendered\r\n//const TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction FrameConfig(){\r\n\tthis.rules = [];\r\n\tthis.type = \"document\";\r\n}\r\n\r\nFrameConfig.prototype.prettyPrint = function(){\r\n\tvar str = \"view = WOQL.document();\\n\";\r\n\tif(this.renderer()){\r\n\t\tstr += \"view.renderer('\" + this.renderer() + \"')\\n\";\r\n\t}\r\n\tif(typeof this.load_schema() != \"undefined\"){\r\n\t\tstr += \"view.load_schema(\" + this.load_schema() + \")\\n\";\r\n\t}\r\n\tfor(var i = 0; i<this.rules.length ; i++){\r\n\t\tstr += \"view.\" + this.rules[i].prettyPrint(\"frame\") + \"\\n\";\r\n\t}\r\n\treturn str;\r\n}\r\n\r\nFrameConfig.prototype.json = function(){\r\n\tlet jr = [];\r\n\tfor(var i = 0; i<this.rules.length; i++){\r\n\t\tjr.push(this.rules[i].json());\r\n\t}\r\n\tvar conf = {};\r\n\tif(typeof this.renderer() != \"undefined\"){\r\n\t\tconf['renderer'] = this.renderer();\r\n\t}\r\n\tif(typeof this.load_schema() != \"undefined\"){\r\n\t\tconf['load_schema'] = this.load_schema();\r\n\t}\r\n\tlet mj = {\"frame\" :conf, \"rules\": jr};\r\n\treturn mj;\r\n}\r\n\r\nFrameConfig.prototype.loadJSON = function(config, rules){\r\n\tvar jr = [];\r\n\tfor(var i = 0; i<rules.length; i++){\r\n\t\tvar nr = new TerminusClient.WOQL.rule();\r\n\t\tnr.json(rules[i]);\r\n\t\tjr.push(nr);\r\n\t}\r\n\tthis.rules = jr;\r\n\tif(typeof config.renderer != \"undefined\"){\r\n\t\tthis.renderer(config.renderer);\r\n\t}\r\n\tif(typeof config.load_schema != \"undefined\"){\r\n\t\tthis.load_schema(config.load_schema);\r\n\t}\r\n}\r\n\r\nFrameConfig.prototype.create = function(client, renderers){\r\n\tvar tf = new TerminusFrame(client, this);\r\n\tif(this.trenderer) tf.setRenderer(this.trenderer);\r\n\telse if(renderers && renderers['frame']){\r\n\t\ttf.setRenderer(renderers['frame']);\r\n\t}\r\n\treturn tf;\r\n}\r\n\r\nFrameConfig.prototype.renderer = function(rend){\r\n\tif(typeof rend == \"undefined\") return this.trenderer;\r\n\tthis.trenderer = rend;\r\n\treturn this;\r\n}\r\n\r\nFrameConfig.prototype.json_rules = function(){\r\n\tlet jr = [];\r\n\tfor(var i = 0; i<this.rules.length; i++){\r\n\t\tjr.push(this.rules[i].json());\r\n\t}\r\n\treturn jr;\r\n}\r\n\r\nFrameConfig.prototype.load_schema = function(tf){\r\n\tif(typeof tf == \"undefined\") return this.get_schema;\r\n\tthis.get_schema = tf;\r\n\treturn this;\r\n}\r\n\r\nFrameConfig.prototype.show_all = function(r){\r\n\tthis.all().renderer(r);\r\n\treturn this;\r\n}\r\n\r\nFrameConfig.prototype.show_parts = function(o, p, d){\r\n\tthis.object().renderer(o);\r\n\tthis.property().renderer(p);\r\n\tthis.data().renderer(d);\r\n\treturn this;\r\n}\r\n\r\nFrameConfig.prototype.object = function(){\r\n\tlet fp = TerminusClient.WOQL.rule();\r\n\tfp.scope(\"object\")\r\n\tthis.rules.push(fp);\r\n\treturn fp;\r\n}\r\n\r\nFrameConfig.prototype.property = function(){\r\n\tlet fp = TerminusClient.WOQL.rule();\r\n\tfp.scope(\"property\");\r\n\tthis.rules.push(fp);\r\n\treturn fp;\r\n}\r\n\r\nFrameConfig.prototype.data = function(){\r\n\tlet fp = TerminusClient.WOQL.rule();\r\n\tfp.scope(\"data\")\r\n\tthis.rules.push(fp);\r\n\treturn fp;\r\n}\r\n\r\nFrameConfig.prototype.all = function(){\r\n\tlet fp = TerminusClient.WOQL.rule();\r\n\tfp.scope(\"*\")\r\n\tthis.rules.push(fp);\r\n\treturn fp;\r\n}\r\n\r\n\r\nFrameConfig.prototype.setFrameDisplayOptions = function(frame, rule){\r\n\tif(typeof frame.display_options == \"undefined\") frame.display_options = {};\r\n\tif(typeof rule.mode() != \"undefined\") {\tframe.display_options.mode = rule.mode();}\r\n\tif(typeof rule.view() != \"undefined\") frame.display_options.view = rule.view();\r\n\t//if(typeof rule.facets() != \"undefined\") frame.display_options.facets = rule.facets();\r\n\t//if(typeof rule.facet() != \"undefined\") frame.display_options.facet = rule.facet();\r\n\tif(typeof rule.showDisabledButtons() != \"undefined\") frame.display_options.show_disabled_buttons = rule.showDisabledButtons();\r\n\tif(typeof rule.features() != \"undefined\") {\r\n\t\tframe.display_options.features = rule.features();\r\n\t}\r\n\tif(typeof rule.header() != \"undefined\") frame.display_options.header = rule.header();\r\n\tif(typeof rule.hidden() != \"undefined\") frame.display_options.hidden = rule.hidden();\r\n\tif(typeof rule.collapse() != \"undefined\") frame.display_options.collapse = rule.collapse();\r\n\tif(typeof rule.headerFeatures() != \"undefined\") frame.display_options.header_features = rule.headerFeatures();\r\n\tif(typeof rule.showEmpty() != \"undefined\") frame.display_options.show_empty = rule.showEmpty();\r\n\tif(typeof rule.featureRenderers() != \"undefined\") frame.display_options.feature_renderers = rule.featureRenderers();\r\n\tif(typeof rule.dataviewer() != \"undefined\") {\r\n\t\tframe.display_options.dataviewer = rule.dataviewer();\r\n\t\tif(typeof rule.args() != \"undefined\")\r\n\t\t\tframe.display_options.args = rule.args();\r\n\t}\r\n}\r\n\r\n\r\n\r\n//WOQL.rule().renderer(\"object\").json(),\r\n//WOQL.rule().renderer(\"property\").json(),\r\n//WOQL.rule().renderer(\"data\").json(),\r\n//WOQL.rule().renderer(\"data\").property(\"rdfs:comment\").render(false).json()\r\n\r\n\r\nfunction WOQLStreamConfig(){\r\n\tthis.rules = [];\r\n\tthis.type = \"stream\";\r\n}\r\n\r\nWOQLStreamConfig.prototype.prettyPrint = function(){\r\n\tvar str = \"view = WOQL.stream();\\n\";\r\n\tfor(var i = 0; i<this.rules.length ; i++){\r\n\t\tstr += \"view.\" + this.rules[i].prettyPrint(\"stream\") + \"\\n\";\r\n\t}\r\n\treturn str;\r\n}\r\n\r\nWOQLStreamConfig.prototype.loadJSON = function(config, rules){\r\n\tvar jr = [];\r\n\tfor(var i = 0; i<rules.length; i++){\r\n\t\tvar nr = new WOQLRule();\r\n\t\tnr.json(rules[i]);\r\n\t\tjr.push(nr);\r\n\t}\r\n\tthis.rules = jr;\r\n}\r\n\r\n\r\nWOQLStreamConfig.prototype.json = function(){\r\n\tlet jr = [];\r\n\tfor(var i = 0; i<this.rules.length; i++){\r\n\t\tjr.push(this.rules[i].json());\r\n\t}\r\n\tvar conf = {};\r\n\tlet mj = {\"stream\" :conf, \"rules\": jr};\r\n\treturn mj;\r\n}\r\n\r\nWOQLStreamConfig.prototype.getMatchingRules = function(row, key, context, action){\r\n\treturn getMatchingRules(this.rules, row, key, context, action);\r\n}\r\n\r\nWOQLStreamConfig.prototype.create = function(client, renderers){\r\n\tvar wqt = new WOQLStream(client, this);\r\n\tif(this.trenderer) wqt.setRenderer(this.trenderer);\r\n\telse if(renderers && renderers['stream']){\r\n\t\twqt.setRenderer(renderers['stream']);\r\n\t}\r\n\treturn wqt;\r\n}\r\n\r\n\r\nfunction WOQLChooserConfig(){\r\n\tthis.rules = [];\r\n\tthis.type = \"chooser\";\r\n}\r\n\r\nWOQLChooserConfig.prototype.getMatchingRules = function(row, key, context, action){\r\n\treturn getMatchingRules(this.rules, row, key, context, action);\r\n}\r\n\r\nWOQLChooserConfig.prototype.create = function(client, renderers){\r\n\tvar wqt = new WOQLChooser(client, this);\r\n\tif(this.trenderer) wqt.setRenderer(this.trenderer);\r\n\telse if(renderers && renderers['chooser']){\r\n\t\twqt.setRenderer(renderers['chooser']);\r\n\t}\r\n\treturn wqt;\r\n}\r\n\r\nWOQLChooserConfig.prototype.prettyPrint = function(){\r\n\tvar str = \"view = WOQL.chooser();\\n\";\r\n\tif(typeof this.change() != \"undefined\"){\r\n\t\tstr += \"view.change(\" + this.change() + \")\\n\";\r\n\t}\r\n\tif(typeof this.show_empty() != \"undefined\"){\r\n\t\tstr += \"view.show_empty('\" + this.show_empty() + \"')\\n\";\r\n\t}\r\n\tif(typeof this.values() != \"undefined\"){\r\n\t\tstr += \"view.values('\" + removeNamespaceFromVariable(this.values()) + \"')\\n\";\r\n\t}\r\n\tif(typeof this.labels() != \"undefined\"){\r\n\t\tstr += \"view.labels('\" + removeNamespaceFromVariable(this.labels()) + \"')\\n\";\r\n\t}\r\n\tif(typeof this.titles() != \"undefined\"){\r\n\t\tstr += \"view.titles('\" + removeNamespaceFromVariable(this.titles()) + \"')\\n\";\r\n\t}\r\n\tif(typeof this.sort() != \"undefined\"){\r\n\t\tstr += \"view.sort(\" + this.sort() + \")\\n\";\r\n\t}\r\n\tif(typeof this.direction() != \"undefined\"){\r\n\t\tstr += \"view.direction('\" + this.direction() + \"')\\n\";\r\n\t}\r\n\tfor(var i = 0; i<this.rules.length ; i++){\r\n\t\tstr += \"view.\" + this.rules[i].prettyPrint(\"chooser\") + \"\\n\";\r\n\t}\r\n\treturn str;\r\n}\r\n\r\nWOQLChooserConfig.prototype.json = function(){\r\n\tlet jr = [];\r\n\tfor(var i = 0; i<this.rules.length; i++){\r\n\t\tjr.push(this.rules[i].json());\r\n\t}\r\n\tvar conf = {};\r\n\tif(typeof this.change() != \"undefined\"){\r\n\t\tconf['change'] = this.change();\r\n\t}\r\n\tif(typeof this.show_empty() != \"undefined\"){\r\n\t\tconf['show_empty'] = this.show_empty();\r\n\t}\r\n\tif(typeof this.values() != \"undefined\"){\r\n\t\tconf['values'] = this.values();\r\n\t}\r\n\tif(typeof this.labels() != \"undefined\"){\r\n\t\tconf['labels'] = this.labels();\r\n\t}\r\n\tif(typeof this.titles() != \"undefined\"){\r\n\t\tconf['titles'] = this.titles();\r\n\t}\r\n\tif(typeof this.sort() != \"undefined\"){\r\n\t\tconf['sort'] = this.sort();\r\n\t}\r\n\tif(typeof this.direction() != \"undefined\"){\r\n\t\tconf['direction'] = this.direction();\r\n\t}\r\n\tlet mj = {\"chooser\" :conf, \"rules\": jr};\r\n\treturn mj;\r\n}\r\n\r\nWOQLChooserConfig.prototype.loadJSON = function(config, rules){\r\n\tvar jr = [];\r\n\tfor(var i = 0; i<rules.length; i++){\r\n\t\tvar nr = new WOQLRule();\r\n\t\tnr.json(rules[i]);\r\n\t\tjr.push(nr);\r\n\t}\r\n\tthis.rules = jr;\r\n\tif(typeof config.change != \"undefined\"){\r\n\t\tthis.change(config.change);\r\n\t}\r\n\tif(typeof config.show_empty != \"undefined\"){\r\n\t\tthis.show_empty(config.show_empty);\r\n\t}\r\n\tif(typeof config.values != \"undefined\"){\r\n\t\tthis.values(config.values);\r\n\t}\r\n\tif(typeof config.labels != \"undefined\"){\r\n\t\tthis.labels(config.labels);\r\n\t}\r\n\tif(typeof config.titles != \"undefined\"){\r\n\t\tthis.titles(config.titles);\r\n\t}\r\n\tif(typeof config.sort != \"undefined\"){\r\n\t\tthis.sort(config.sort);\r\n\t}\r\n\tif(typeof config.direction != \"undefined\"){\r\n\t\tthis.direction(config.direction);\r\n\t}\r\n}\r\n\r\nWOQLChooserConfig.prototype.change = function(v){\r\n\tif(typeof v != \"undefined\"){\r\n\t\tthis.onChange = v;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.onChange;\r\n}\r\n\r\nWOQLChooserConfig.prototype.show_empty = function(p){\r\n\tif(typeof p != \"undefined\"){\r\n\t\tthis.placeholder = p;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.placeholder;\r\n}\r\n\r\nWOQLChooserConfig.prototype.rule = function(v){\r\n\tlet nr = new WOQLRule(\"row\");\r\n\tthis.rules.push(nr);\r\n\treturn nr.v(v);\r\n}\r\n\r\nWOQLChooserConfig.prototype.values = function(v){\r\n\tif(typeof v != \"undefined\"){\r\n\t\tif(v.substring(0, 2) != \"v:\") v = \"v:\" + v;\r\n\t\tthis.value_variable = v;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.value_variable;\r\n}\r\n\r\nWOQLChooserConfig.prototype.labels = function(v){\r\n\tif(v){\r\n\t\tif(v.substring(0, 2) != \"v:\") v = \"v:\" + v;\r\n\t\tthis.label_variable = v;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.label_variable;\r\n}\r\n\r\nWOQLChooserConfig.prototype.titles = function(v){\r\n\tif(v){\r\n\t\tif(v.substring(0, 2) != \"v:\") v = \"v:\" + v;\r\n\t\tthis.title_variable = v;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.title_variable;\r\n}\r\n\r\nWOQLChooserConfig.prototype.sort = function(v){\r\n\tif(v){\r\n\t\tif(v.substring(0, 2) != \"v:\") v = \"v:\" + v;\r\n\t\tthis.sort_variable = v;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.sort_variable;\r\n}\r\n\r\nWOQLChooserConfig.prototype.direction = function(v){\r\n\tif(v){\r\n\t\tthis.sort_direction = v;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.sort_direction;\r\n}\r\n\r\n\r\n//this.choice = (config && config.choice ? config.choice : false);\r\n\r\n\r\nfunction WOQLTableConfig(){\r\n\tthis.rules = [];\r\n\tthis.type = \"table\";\r\n}\r\n\r\nWOQLTableConfig.prototype.getMatchingRules = function(row, key, context, action){\r\n\treturn getMatchingRules(this.rules, row, key, context, action);\r\n}\r\n\r\nWOQLTableConfig.prototype.create = function(client, renderers, dtypes){\r\n\tvar wqt = new WOQLTable(client, this);\r\n\twqt.setDatatypes(dtypes);\r\n\tif(this.trenderer) wqt.setRenderer(this.trenderer);\r\n\telse if(renderers && renderers['table']){\r\n\t\twqt.setRenderer(renderers['table']);\r\n\t}\r\n\treturn wqt;\r\n}\r\n\r\nWOQLTableConfig.prototype.json = function(){\r\n\tlet jr = [];\r\n\tfor(var i = 0; i<this.rules.length; i++){\r\n\t\tjr.push(this.rules[i].json());\r\n\t}\r\n\tvar conf = {};\r\n\tif(typeof this.column_order() != \"undefined\"){\r\n\t\tconf['column_order'] = this.column_order();\r\n\t}\r\n\tif(typeof this.pagesize() != \"undefined\"){\r\n\t\tconf['pagesize'] = this.pagesize();\r\n\t}\r\n\tif(typeof this.renderer() != \"undefined\"){\r\n\t\tconf['renderer'] = this.renderer();\r\n\t}\r\n\tif(typeof this.pager() != \"undefined\"){\r\n\t\tconf['pager'] = this.pager();\r\n\t}\r\n\tif(typeof this.page() != \"undefined\"){\r\n\t\tconf['page'] = this.page();\r\n\t}\r\n\tlet mj = {\"table\" :conf, \"rules\": jr};\r\n\treturn mj;\r\n}\r\n\r\nWOQLTableConfig.prototype.loadJSON = function(config, rules){\r\n\tvar jr = [];\r\n\tfor(var i = 0; i<rules.length; i++){\r\n\t\tvar nr = new WOQLRule();\r\n\t\tnr.json(rules[i]);\r\n\t\tjr.push(nr);\r\n\t}\r\n\tthis.rules = jr;\r\n\tif(typeof config.column_order != \"undefined\"){\r\n\t\tthis.column_order(config.column_order);\r\n\t}\r\n\tif(typeof config.pagesize != \"undefined\"){\r\n\t\tthis.pagesize(config.pagesize);\r\n\t}\r\n\tif(typeof config.renderer != \"undefined\"){\r\n\t\tthis.renderer(config.renderer);\r\n\t}\r\n\tif(typeof config.pager != \"undefined\"){\r\n\t\tthis.pager(config.pager);\r\n\t}\r\n\tif(typeof config.page != \"undefined\"){\r\n\t\tthis.titles(config.page);\r\n\t}\r\n}\r\n\r\nWOQLTableConfig.prototype.prettyPrint = function(){\r\n\tvar str = \"view = WOQL.table();\\n\";\r\n\tif(typeof this.column_order() != \"undefined\"){\r\n\t\tstr += \"view.column_order('\" + this.column_order() + \"')\\n\";\r\n\t}\r\n\tif(typeof this.pagesize() != \"undefined\"){\r\n\t\tstr += \"view.pagesize(\" + this.pagesize() + \")\\n\";\r\n\t}\r\n\tif(typeof this.renderer() != \"undefined\"){\r\n\t\tstr += \"view.renderer('\" + this.renderer() + \"')\\n\";\r\n\t}\r\n\tif(typeof this.pager() != \"undefined\"){\r\n\t\tstr += \"view.pager(\" + this.pager() + \")\\n\";\r\n\t}\r\n\tif(typeof this.page() != \"undefined\"){\r\n\t\tstr += \"view.page(\" + this.page() + \")\\n\";\r\n\t}\r\n\tfor(var i = 0; i<this.rules.length ; i++){\r\n\t\tstr += \"view.\" + this.rules[i].prettyPrint(\"table\") + \"\\n\";\r\n\t}\r\n\treturn str;\r\n}\r\n\r\nWOQLTableConfig.prototype.renderer = function(rend){\r\n\tif(!rend) return this.trenderer;\r\n\tthis.trenderer = rend;\r\n\treturn this;\r\n}\r\n\r\nWOQLTableConfig.prototype.column_order = function(...val){\r\n\tif(typeof val == \"undefined\" || val.length == 0){\r\n\t\treturn this.order;\r\n\t}\r\n\tthis.order = addNamespacesToVariables(val);\r\n\treturn this;\r\n}\r\n\r\nWOQLTableConfig.prototype.pager = function(val){\r\n\tif(typeof val == \"undefined\"){\r\n\t\treturn this.show_pager;\r\n\t}\r\n\tthis.show_pager = val;\r\n\treturn this;\r\n}\r\n\r\nWOQLTableConfig.prototype.pagesize = function(val, editable){\r\n\tif(typeof val == \"undefined\"){\r\n\t\treturn this.show_pagesize;\r\n\t}\r\n\tthis.show_pagesize = val;\r\n\tthis.change_pagesize = editable;\r\n\treturn this;\r\n}\r\n\r\nWOQLTableConfig.prototype.page = function(val){\r\n\tif(typeof val == \"undefined\"){\r\n\t\treturn this.show_pagenumber;\r\n\t}\r\n\tthis.show_pagenumber = val;\r\n\treturn this;\r\n}\r\n\r\nWOQLTableConfig.prototype.column = function(...cols){\r\n\tlet nr = new WOQLRule(\"column\");\r\n\tnr.setVariables(cols);\r\n\tthis.rules.push(nr);\r\n\treturn nr;\r\n}\r\n\r\nWOQLTableConfig.prototype.row = function(){\r\n\tlet nr = new WOQLRule(\"row\");\r\n\tthis.rules.push(nr);\r\n\treturn nr;\r\n}\r\n\r\nWOQLGraphConfig = function(){\r\n\tthis.rules = [];\r\n\tthis.type = \"graph\";\r\n}\r\n\r\nWOQLGraphConfig.prototype.create = function(client, renderers){\r\n\tvar wqt = new WOQLGraph(client, this);\r\n\tif(this.trenderer) wqt.setRenderer(this.trenderer);\r\n\telse if(renderers && renderers['graph']){\r\n\t\twqt.setRenderer(renderers['graph']);\r\n\t}\r\n\treturn wqt;\r\n}\r\n\r\nWOQLGraphConfig.prototype.getMatchingRules = function(row, key, context, action){\r\n\treturn getMatchingRules(this.rules, row, key, context, action);\r\n}\r\n\r\nWOQLGraphConfig.prototype.literals = function(v){\r\n\tif(typeof v != \"undefined\"){\r\n\t\tthis.show_literals = v;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.show_literals;\r\n}\r\n\r\nWOQLGraphConfig.prototype.source = function(v){\r\n\tif(v){\r\n\t\tif(v.substring(0, 2) != \"v:\") v = \"v:\" + v;\r\n\t\tthis.source_variable = v;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.source_variable;\r\n}\r\n\r\nWOQLGraphConfig.prototype.fontfamily = function(v){\r\n\tif(typeof v != \"undefined\"){\r\n\t\tthis.fontfam = v;\r\n\t\treturn this;\r\n\t}\r\n\t//return 'Font Awesome 5 Free';\r\n\treturn this.fontfam;\r\n}\r\n\r\nWOQLGraphConfig.prototype.show_force = function(v){\r\n\tif(typeof v != \"undefined\"){\r\n\t\tthis.force = v;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.force;\r\n}\r\n\r\nWOQLGraphConfig.prototype.fix_nodes = function(v){\r\n\tif(typeof v != \"undefined\"){\r\n\t\tthis.fixed = v;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.fixed;\r\n}\r\n\r\nWOQLGraphConfig.prototype.explode_out = function(v){\r\n\tif(typeof v != \"undefined\"){\r\n\t\tthis.explode = v;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.explode;\r\n}\r\n\r\nWOQLGraphConfig.prototype.selected_grows = function(v){\r\n\tif(typeof v != \"undefined\"){\r\n\t\tthis.bigsel = v;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.bigsel;\r\n}\r\n\r\nWOQLGraphConfig.prototype.width = function(v){\r\n\tif(typeof v != \"undefined\"){\r\n\t\tthis.gwidth = v;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.gwidth;\r\n}\r\n\r\nWOQLGraphConfig.prototype.height = function(v){\r\n\tif(typeof v != \"undefined\"){\r\n\t\tthis.gheight = v;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.gheight;\r\n}\r\n\r\nWOQLGraphConfig.prototype.edges = function(...edges){\r\n\tif(edges && edges.length){\r\n\t\tvar nedges = [];\r\n\t\tfor(var i = 0; i<edges.length; i++){\r\n\t\t\tnedges.push(addNamespacesToVariables(edges[i]));\r\n\t\t}\r\n\t\tthis.show_edges = nedges;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.show_edges;\r\n}\r\n\r\nWOQLGraphConfig.prototype.edge = function(source, target){\r\n\tlet nr = new WOQLRule(\"edge\");\r\n\tif(source && target) nr.setVariables([source, target]);\r\n\telse if(source) nr.setVariables([source]);\r\n\telse if(target) nr.setVariables([target]);\r\n\tif(source) nr.source = source;\r\n\tif(target) nr.target = target;\r\n\tthis.rules.push(nr);\r\n\treturn nr;\r\n}\r\n\r\nWOQLGraphConfig.prototype.node = function(...cols){\r\n\tlet nr = new WOQLRule(\"node\");\r\n\tnr.setVariables(cols);\r\n\tthis.rules.push(nr);\r\n\treturn nr;\r\n}\r\n\r\nWOQLGraphConfig.prototype.getConfigAsJSON = function(){\r\n\tvar json = {};\r\n\tif(typeof this.literals() != \"undefined\"){\r\n\t\tjson['literals'] = this.literals();\r\n\t}\r\n\tif(typeof this.source() != \"undefined\"){\r\n\t\tjson['source'] = this.source();\r\n\t}\r\n\tif(typeof this.fontfamily() != \"undefined\"){\r\n\t\tjson['fontfamily'] = this.fontfamily();\r\n\t}\r\n\tif(typeof this.show_force() != \"undefined\"){\r\n\t\tjson['show_force'] = this.show_force();\r\n\t}\r\n\tif(typeof this.fix_nodes() != \"undefined\"){\r\n\t\tjson['fix_nodes'] = this.fix_nodes();\r\n\t}\r\n\tif(typeof this.explode_out() != \"undefined\"){\r\n\t\tjson['explode_out'] = this.explode_out();\r\n\t}\r\n\tif(typeof this.selected_grows() != \"undefined\"){\r\n\t\tjson['selected_grows'] = this.selected_grows();\r\n\t}\r\n\tif(typeof this.width() != \"undefined\"){\r\n\t\tjson['width'] = this.width();\r\n\t}\r\n\tif(typeof this.height() != \"undefined\"){\r\n\t\tjson['height'] = this.height();\r\n\t}\r\n\tif(typeof this.edges() != \"undefined\"){\r\n\t\tjson['edges'] = this.edges();\r\n\t}\r\n\treturn json;\r\n}\r\n\r\nWOQLGraphConfig.prototype.loadJSON = function(config, rules){\r\n\tvar jr = [];\r\n\tfor(var i = 0; i<rules.length; i++){\r\n\t\tvar nr = new WOQLRule();\r\n\t\tnr.json(rules[i]);\r\n\t\tjr.push(nr);\r\n\t}\r\n\tthis.rules = jr;\r\n\tif(typeof config.literals != \"undefined\"){\r\n\t\tthis.literals(config.literals);\r\n\t}\r\n\tif(typeof config.source != \"undefined\"){\r\n\t\tthis.source(config.source);\r\n\t}\r\n\tif(typeof config.fontfamily != \"undefined\"){\r\n\t\tthis.fontfamily(config.fontfamily);\r\n\t}\r\n\tif(typeof config.show_force != \"undefined\"){\r\n\t\tthis.show_force(config.show_force);\r\n\t}\r\n\tif(typeof config.fix_nodes != \"undefined\"){\r\n\t\tthis.fix_nodes(config.showfix_nodes_force);\r\n\t}\r\n\tif(typeof config.explode_out != \"undefined\"){\r\n\t\tthis.explode_out(config.explode_out);\r\n\t}\r\n\tif(typeof config.selected_grows != \"undefined\"){\r\n\t\tthis.selected_grows(config.selected_grows);\r\n\t}\r\n\tif(typeof config.width != \"undefined\"){\r\n\t\tthis.width(config.width);\r\n\t}\r\n\tif(typeof config.height != \"undefined\"){\r\n\t\tthis.height(config.height);\r\n\t}\r\n\tif(typeof config.edges != \"undefined\"){\r\n\t\tthis.edges(config.edges);\r\n\t}\r\n}\r\n\r\n\r\nWOQLGraphConfig.prototype.prettyPrint = function(){\r\n\tvar str = \"view = WOQL.graph();\\n\";\r\n\tif(typeof this.literals() != \"undefined\"){\r\n\t\tstr += \"view.literals('\" + this.literals() + \"')\\n\";\r\n\t}\r\n\tif(typeof this.source() != \"undefined\"){\r\n\t\tstr += \"view.source('\" + removeNamespaceFromVariable(this.source()) + \"')\\n\";\r\n\t}\r\n\tif(typeof this.fontfamily() != \"undefined\"){\r\n\t\tstr += \"view.fontfamily('\" + this.fontfamily() + \"')\\n\";\r\n\t}\r\n\tif(typeof this.show_force() != \"undefined\"){\r\n\t\tstr += \"view.show_force('\" + this.show_force() + \"')\\n\";\r\n\t}\r\n\tif(typeof this.fix_nodes() != \"undefined\"){\r\n\t\tstr += \"view.fix_nodes('\" + this.fix_nodes() + \"')\\n\";\r\n\t}\r\n\tif(typeof this.explode_out() != \"undefined\"){\r\n\t\tstr += \"view.explode_out('\" + this.explode_out() + \"')\\n\";\r\n\t}\r\n\tif(typeof this.selected_grows() != \"undefined\"){\r\n\t\tstr += \"view.selected_grows('\" + this.selected_grows() + \"')\\n\";\r\n\t}\r\n\tif(typeof this.width() != \"undefined\"){\r\n\t\tstr += \"view.width('\" + this.width() + \"')\\n\";\r\n\t}\r\n\tif(typeof this.height() != \"undefined\"){\r\n\t\tstr += \"view.height('\" + this.height() + \"')\\n\";\r\n\t}\r\n\tif(typeof this.edges() != \"undefined\"){\r\n\t\tvar nedges = this.edges();\r\n\t\tvar estrs = [];\r\n\t\tfor(var i = 0; i<nedges.length; i++){\r\n\t\t\testrs.push(\"['\" + nedges[i][0] + \", \" + nedges[i][1] + \"']\");\r\n\t\t}\r\n\t\tstr += \"view.edges('\" + estrs.join(\", \") + \"')\\n\";\r\n\t}\r\n\tfor(var i = 0; i<this.rules.length ; i++){\r\n\t\tstr += \"view.\" + this.rules[i].prettyPrint(\"graph\") + \"\\n\";\r\n\t}\r\n\treturn str;\r\n}\r\n\r\nWOQLGraphConfig.prototype.json = function(){\r\n\tlet jr = [];\r\n\tfor(var i = 0; i<this.rules.length; i++){\r\n\t\tjr.push(this.rules[i].json());\r\n\t}\r\n\tlet mj = {\"graph\" : this.getConfigAsJSON(), \"rules\": jr};\r\n\treturn mj;\r\n}\r\n\r\n\r\nfunction WOQLRule(s){\r\n\tthis.rule = { scope: s };\r\n}\r\n\r\nWOQLRule.prototype.prettyPrint = function(type){\r\n\t//starts with obj. ...\r\n\tvar str = this.rule.scope + \"('\";\r\n\tif(this.rule.variables){\r\n\t\tstr += this.rule.variables.join(\"', '\");\r\n\t }\r\n\t str += \"')\";\r\n\tif(typeof this.literal() != \"undefined\"){\r\n\t\tstr += \".literal(\" + this.literal() + \")\";\r\n\t}\r\n\tif(typeof this.type() != \"undefined\"){\r\n\t\tstr += \".type(\" + JSON.stringify(removeNamespacesFromVariables(this.type())) + \")\";\r\n\t}\r\n\tif(typeof this.selected() != \"undefined\"){\r\n\t\tstr += \".selected(\" + this.selected() + \")\";\r\n\t}\r\n\tif(typeof this.label() != \"undefined\"){\r\n\t\tstr += \".label(\" + this.label() + \")\";\r\n\t}\r\n\tif(typeof this.size() != \"undefined\"){\r\n\t\tstr += \".size('\" + this.size() + \"')\";\r\n\t}\r\n\tif(typeof this.color() != \"undefined\"){\r\n\t\tstr += \".color([\" + this.color().join(\",\") + \"])\";\r\n\t}\r\n\tif(typeof this.charge() != \"undefined\"){\r\n\t\tstr += \".charge('\" + this.charge() + \"')\";\r\n\t}\r\n\tif(typeof this.distance() != \"undefined\"){\r\n\t\tstr += \".distance('\" + this.distance() + \"')\";\r\n\t}\r\n\tif(typeof this.weight() != \"undefined\"){\r\n\t\tstr += \".distance('\" + this.weight() + \"')\";\r\n\t}\r\n\tif(typeof this.symmetric() != \"undefined\"){\r\n\t\tstr += \".symmetric(\" + this.symmetric() + \")\";\r\n\t}\r\n\tif(typeof this.collisionRadius() != \"undefined\"){\r\n\t\tstr += \".collisionRadius(\" + this.collisionRadius() + \")\";\r\n\t}\r\n\tif(typeof this.icon() != \"undefined\"){\r\n\t\tstr += \".icon(\" + JSON.stringify(this.icon()) + \")\";\r\n\t}\r\n\tif(typeof this.text() != \"undefined\"){\r\n\t\tstr += \".text(\" + JSON.stringify(this.text()) + \")\";\r\n\t}\r\n\tif(typeof this.arrow() != \"undefined\"){\r\n\t\tstr += \".arrow(\" + JSON.stringify(this.arrow()) + \")\";\r\n\t}\r\n\tif(typeof this.border() != \"undefined\"){\r\n\t\tstr += \".border(\" + JSON.stringify(this.border()) + \")\";\r\n\t}\r\n\tif(typeof this.args() != \"undefined\"){\r\n\t\tstr += \".args(\" + JSON.stringify(this.args()) + \")\";\r\n\t}\r\n\tif(typeof this.renderer() != \"undefined\"){\r\n\t\tstr += \".renderer('\" + this.renderer() + \"')\";\r\n\t}\r\n\tif(typeof this.render() != \"undefined\"){\r\n\t\tstr += \".render(\" + this.render() + \")\";\r\n\t}\r\n\tif(typeof this.header() != \"undefined\"){\r\n\t\tstr += \".header('\" + this.header() + \"')\";\r\n\t}\r\n\tif(typeof this.click() != \"undefined\"){\r\n\t\tstr += \".click(\" + this.click() + \")\";\r\n\t}\r\n\tif(typeof this.hover() != \"undefined\"){\r\n\t\tstr += \".hover(\" + this.hover() + \")\";\r\n\t}\r\n\tfor(var v in this.rule.constraints){\r\n\t\tstr += \".v('\" + v + \"')\";\r\n\t\tfor(var i = 0; i<this.rule.constraints[v].length; i++){\r\n\t\t\tif(typeof(this.rule.constraints[v][i]) == \"function\"){\r\n\t\t\t\tstr += \".filter(\" + this.rule.constraints[v][i] + \")\";\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tstr += \".in(\" + JSON.stringify(this.rule.constraints[v][i]) + \")\";\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn str;\r\n}\r\n\r\n/*\r\n * Graph\r\n */\r\n\r\nWOQLRule.prototype.json = function(mjson){\r\n\tif(!mjson) return this.rule;\r\n\tthis.rule = mjson;\r\n\treturn this;\r\n}\r\n\r\n\r\nWOQLRule.prototype.size = function(size){\r\n\tif(typeof size == \"undefined\"){\r\n\t\treturn this.rule.size;\r\n\t}\r\n\tthis.rule.size = size;\r\n\treturn this;\r\n}\r\n\r\nWOQLRule.prototype.color = function(color){\r\n\tif(typeof color == \"undefined\"){\r\n\t\treturn this.rule.color;\r\n\t}\r\n\tthis.rule.color = color;\r\n\treturn this;\r\n}\r\n\r\nWOQLRule.prototype.charge = function(v){\r\n\tif(typeof v == \"undefined\"){\r\n\t\treturn this.rule.charge;\r\n\t}\r\n\tthis.rule.charge = v;\r\n\treturn this;\r\n}\r\n\r\nWOQLRule.prototype.collisionRadius = function(v){\r\n\tif(typeof v == \"undefined\"){\r\n\t\treturn this.rule.collisionRadius;\r\n\t}\r\n\tthis.rule.collisionRadius = v;\r\n\treturn this;\r\n}\r\n\r\nWOQLRule.prototype.icon = function(json){\r\n\tif(json){\r\n\t\tthis.rule.icon = json;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.rule.icon;\r\n}\r\n\r\nWOQLRule.prototype.text = function(json){\r\n\tif(json){\r\n\t\tthis.rule.text = json;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.rule.text;\r\n}\r\n\r\nWOQLRule.prototype.border = function(json){\r\n\tif(json){\r\n\t\tthis.rule.border = json;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.rule.border;\r\n}\r\n\r\nWOQLRule.prototype.arrow = function(json){\r\n\tif(json){\r\n\t\tthis.rule.arrow = json;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.rule.arrow;\r\n}\r\n\r\nWOQLRule.prototype.distance = function(d){\r\n\tif(typeof d != \"undefined\"){\r\n\t\tthis.rule.distance = d;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.rule.distance;\r\n}\r\n\r\nWOQLRule.prototype.symmetric = function(d){\r\n\tif(typeof d != \"undefined\"){\r\n\t\tthis.rule.symmetric = d;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.rule.symmetric ;\r\n}\r\n\r\n\r\nWOQLRule.prototype.weight = function(w){\r\n\tif(typeof w != \"undefined\"){\r\n\t\tthis.rule.weight = w;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.rule.weight;\r\n}\r\n\r\n/*\r\n * Table\r\n */\r\n\r\nWOQLRule.prototype.renderer = function(rend){\r\n\tif(typeof rend == \"undefined\"){\r\n\t\treturn this.rule.renderer;\r\n\t}\r\n\tthis.rule.renderer = rend;\r\n\treturn this;\r\n}\r\n\r\nWOQLRule.prototype.header = function(hdr){\r\n\tif(typeof hdr == \"undefined\"){\r\n\t\treturn this.rule.header;\r\n\t}\r\n\tthis.rule.header = hdr;\r\n\treturn this;\r\n}\r\n\r\n\r\nWOQLRule.prototype.render = function(func){\r\n\tif(typeof func == \"undefined\"){\r\n\t\treturn this.rule.render;\r\n\t}\r\n\tthis.rule.render = func;\r\n\treturn this;\r\n}\r\n\r\nWOQLRule.prototype.click = function(onClick){\r\n\tif(onClick){\r\n\t\tthis.rule.click = onClick;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.rule.click;\r\n}\r\n\r\nWOQLRule.prototype.hover = function(onHover){\r\n\tif(onHover){\r\n\t\tthis.rule.hover = onHover;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.rule.hover;\r\n}\r\n\r\n/*\r\n * All\r\n */\r\n\r\n\r\nWOQLRule.prototype.hidden = function(hidden){\r\n\tif(typeof hidden == \"undefined\"){\r\n\t\treturn this.rule.hidden;\r\n\t}\r\n\tthis.rule.hidden = hidden;\r\n\treturn this;\r\n}\r\n\r\nWOQLRule.prototype.args = function(args){\r\n\tif(typeof args == \"undefined\"){\r\n\t\treturn this.rule.args;\r\n\t}\r\n\tthis.rule.args = args;\r\n\treturn this;\r\n}\r\n\r\n/*\r\n * The below are conditions\r\n */\r\nWOQLRule.prototype.literal = function(tf){\r\n\tif(typeof tf == \"undefined\"){\r\n\t\treturn this.rule.literal;\r\n\t}\r\n\tthis.rule.literal = tf;\r\n\treturn this;\r\n}\r\n\r\nWOQLRule.prototype.type = function(...list){\r\n\tif(typeof list == \"undefined\" || list.length == 0){\r\n\t\treturn this.rule.type;\r\n\t}\r\n\tthis.rule.type = list;\r\n\treturn this;\r\n}\r\n\r\nWOQLRule.prototype.setVariables = function(vars){\r\n\tif(vars && vars.length){\r\n\t\tthis.rule.variables = addNamespacesToVariables(vars);\r\n\t\tthis.current_variable = this.rule.variables[this.rule.variables.length - 1];\r\n\t}\r\n\treturn this;\r\n}\r\n\r\nWOQLRule.prototype.v = function(v){\r\n\tif(v){\r\n\t\tif(v.substring(0, 2) != \"v:\") v = \"v:\" + v;\r\n\t\tthis.current_variable = v;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.current_variable;\r\n}\r\n\r\nWOQLRule.prototype.in = function(...list){\r\n\tif(this.current_variable){\r\n\t\tif(!this.rule.constraints) this.rule.constraints = {};\r\n\t\tif(!this.rule.constraints[this.current_variable]) this.rule.constraints[this.current_variable] = [];\r\n\t\tthis.rule.constraints[this.current_variable].push(list);\r\n\t}\r\n\treturn this;\r\n}\r\n\r\nWOQLRule.prototype.filter = function(tester){\r\n\tif(this.current_variable){\r\n\t\tif(!this.rule.constraints) this.rule.constraints = {};\r\n\t\tif(!this.rule.constraints[this.current_variable]) this.rule.constraints[this.current_variable] = [];\r\n\t\tthis.rule.constraints[this.current_variable].push(tester);\r\n\t}\r\n\treturn this;\r\n}\r\n\r\nWOQLRule.prototype.label = function(l){\r\n\tif(l){\r\n\t\tthis.rule.label = l;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.rule.label;\r\n}\r\n\r\nWOQLRule.prototype.title = function(l){\r\n\tif(l){\r\n\t\tthis.rule.title = l;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.rule.title;\r\n}\r\n\r\n/*\r\n * This is for chooser\r\n */\r\n\r\nWOQLRule.prototype.selected = function(s){\r\n\tif(typeof s != \"undefined\"){\r\n\t\tthis.rule.selected = s;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.rule.selected;\r\n}\r\n\r\n\r\n/*\r\n * Matches on\r\n * 1. scope (row, cell, column)\r\n * 2. variables - only match certain ones\r\n * 3. type - only match datatype\r\n * 4. constraints - on values of variables\r\n */\r\n\r\nWOQLRule.prototype.match = function(data, key, context, action){\r\n\tif(context && this.rule.scope != context) return false;\r\n\tif(key){\r\n\t\tif(this.rule.variables && this.rule.variables.length){\r\n\t\t\tif(typeof key == \"object\"){\r\n\t\t\t\tif(this.rule.variables.indexOf(key[0]) == -1) return false;\r\n\t\t\t\tif(this.rule.variables.indexOf(key[1]) == -1) return false;\r\n\t\t\t}\r\n\t\t\telse if(this.rule.variables.indexOf(key) == -1) return false;\r\n\t\t}\r\n\t\tif(this.rule && this.rule.type){\r\n\t\t\tif(typeof key == \"object\"){\r\n\t\t\t\tif(!(data[key][0][\"@type\"] && this.rule.type.indexOf(data[key][0][\"@type\"]) != -1)){\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse if(!(data[key][\"@type\"] && this.rule.type.indexOf(data[key][\"@type\"]) != -1)){\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(this.rule && typeof this.rule.literal != \"undefined\"){\r\n\t\t\tif(typeof key == \"object\"){\r\n\t\t\t\tif(data[key[0]]['@value']) {\r\n\t\t\t\t\tif(!this.rule.literal) return false;\r\n\t\t\t\t}\r\n\t\t\t\telse if(this.rule.literal) return false;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tif(data[key]['@value']) {\r\n\t\t\t\t\tif(!this.rule.literal) return false;\r\n\t\t\t\t}\r\n\t\t\t\telse if(this.rule.literal) return false;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(typeof key == \"object\"){\r\n\t\t\tif(this.rule.constraints && this.rule.constraints[key[0]]){\r\n\t\t\t\tif(!data) return false;\r\n\t\t\t\tfor(var i = 0; i<this.rule.constraints[key[0]].length; i++){\r\n\t\t\t\t\tif(!this.test(data[key[0]], this.rule.constraints[key][0])){\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif(this.rule.constraints && this.rule.constraints[key[1]]){\r\n\t\t\t\tif(!data) return false;\r\n\t\t\t\tfor(var i = 0; i<this.rule.constraints[key[1]].length; i++){\r\n\t\t\t\t\tif(!this.test(data[key[1]], this.rule.constraints[key][1])){\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if(this.rule.constraints && this.rule.constraints[key]){\r\n\t\t\tif(!data) return false;\r\n\t\t\tfor(var i = 0; i<this.rule.constraints[key].length; i++){\r\n\t\t\t\tif(!this.test(data[key], this.rule.constraints[key])){\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(context == \"edge\"){\r\n\t\t\tif(this.rule.source && this.rule.source != key[0]) return false;\r\n\t\t\tif(this.rule.target && this.rule.target != key[1]) return false;\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tfor(var k in this.rule.constraints){\r\n\t\t\tif(!data) return false;\r\n\t\t\tfor(var i = 0; i<this.rule.constraints[k].length; i++){\r\n\t\t\t\tif(!this.test(data[k], this.rule.constraints[k])){\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tif(action && typeof this.rule[action] == \"undefined\") return false;\r\n\treturn true;\r\n}\r\n\r\nWOQLRule.prototype.test = function(value, constraint){\r\n\tif(typeof constraint == \"object\" && constraint.length){\r\n\t\tvar vundertest = (value['@value'] ? value['@value'] : value);\r\n\t\treturn (constraint.indexOf(vundertest) != -1);\r\n\t}\r\n\tif(typeof constraint == \"function\"){\r\n\t\treturn constraint(value);\r\n\t}\r\n}\r\n\r\n\r\n/*\r\n * Utility function adds v: to variables...\r\n */\r\nfunction addNamespacesToVariables(vars){\r\n\tvar nvars = [];\r\n\tfor(var i = 0; i<vars.length; i++){\r\n\t\tvar nvar = (vars[i].substring(0, 2) == \"v:\") ? vars[i] : \"v:\" + vars[i];\r\n\t\tnvars.push(nvar);\r\n\t}\r\n\treturn nvars;\r\n}\r\n\r\nfunction removeNamespaceFromVariable(mvar){\r\n\tif(mvar.substring(0, 2) == \"v:\") return mvar.substring(2)\r\n\treturn mvar;\r\n}\r\n\r\n\r\nfunction removeNamespacesFromVariables(vars){\r\n\tvar nvars = [];\r\n\tfor(var i = 0; i<vars.length; i++){\r\n\t\tnvars.push(removeNamespaceFromVariable(vars[i]));\r\n\t}\r\n\treturn nvars;\r\n}\r\n\r\n\r\nfunction getMatchingRules(rules, row, key, context, action){\r\n\tvar matches = [];\r\n\tfor(var i = 0; i<rules.length; i++){\r\n\t\tif(rules[i].match(row, key, context, action)){\r\n\t\t\tmatches.push(rules[i].rule);\r\n\t\t}\r\n\t}\r\n\treturn matches;\r\n}\r\n\r\n\r\n/*\r\n *\r\nvar x = WOQL.schema();\r\nx.addClass(\"my:Class\").label(\"A class\").comment(\"A comment\").abstract().relationship();\r\nx.addProperty(\"my:prop\", \"xsd:string\").domain(\"my:Class\").label(\"x\").comment(\"x\").max(2).min(1);\r\nx.execute(client).then ...\r\n */\r\n","const TerminusClient = require('@terminusdb/terminus-client');\r\n\r\n/*\r\n * Very simple implementation of a WOQL backed chooser\r\n * Makes a drop down from a WOQL query - configuration tells it which columns to use...\r\n */\r\n\r\nfunction WOQLChooser(client, options){\r\n\tthis.client = client;\r\n\tthis.selected = false;\r\n\treturn this.options(options);\r\n}\r\n\r\nWOQLChooser.prototype.options = function(config){\r\n\tthis.config = config || TerminusClient.WOQL.chooser();\t\r\n\treturn this;\r\n}\r\n\r\nWOQLChooser.prototype.set = function(id){\r\n\tif(this.selected != id){\r\n\t\tthis.selected = id;\r\n\t\tlet ch = this.config.change;\r\n\t\tif(ch) ch(id);\r\n\t}\r\n}\r\n\r\nWOQLChooser.prototype.render = function(){\r\n\tif(this.renderer) return this.renderer.render(this);\r\n}\r\n\r\nWOQLChooser.prototype.setRenderer = function(rend){\r\n\tthis.renderer = rend;\r\n\treturn this;\r\n}\r\n\r\n/*\r\n * Sets up the required variables from the result / config\r\n */\r\nWOQLChooser.prototype.setResult = function(result){\r\n\tthis.result = result;\r\n\tthis.choices = [];\r\n\tthis.cursor = 0;\r\n\tconst variables = result.getVariableList();\r\n\tif(!this.config.values() && variables.length){\r\n\t\tthis.config.values(variables[0]);\r\n\t}\r\n\t//sort it \r\n\tif(this.config.sort()){\r\n\t\tthis.result.sort(this.config.sort(), this.config.direction());\r\n\t}\r\n\twhile(row = this.result.next()){\r\n\t\tif(row && this.includeRow(row)){\r\n\t\t\tthis.choices.push(this.rowToChoice(row, this.result.cursor));\r\n\t\t}\r\n\t}\r\n\treturn this;\r\n}\r\n\r\nWOQLChooser.prototype.includeRow = function(row){\r\n\tconst matched_rules = this.config.getMatchingRules(row, false, \"row\", \"hidden\");\r\n\tfor(var i = 0; i<matched_rules.length; i++){\r\n\t\tif(matched_rules[i].hidden) return false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nWOQLChooser.prototype.rowToChoice = function(binding, rownum){\r\n\tvar choice = { \r\n\t\tid: this.getRowID(binding) \r\n\t};\r\n\tchoice.label = this.getLabelFromBinding(binding, rownum);\r\n\tchoice.title = this.getTitleFromBinding(binding, rownum);\r\n\tchoice.selected = this.getSelectedFromBinding(binding, rownum);\r\n\treturn choice;\r\n}\r\n\r\nWOQLChooser.prototype.getRowID = function(binding){\r\n\tvar rval = binding[this.config.values()];\r\n\tif(rval['@value']) return rval['@value'];\r\n\treturn rval;\r\n}\r\n\r\nWOQLChooser.prototype.getLabelFromBinding = function(binding, rownum){\r\n\tlet sp = this.getSpecialRenderer(binding, \"label\");\r\n\tif(sp) return this.renderSpecial(sp, binding, rownum);\r\n\tif(this.config.labels()){\r\n\t\tif(binding[this.config.labels()]){\r\n\t\t\tvar lab = binding[this.config.labels()];\r\n\t\t\tif(lab[\"@value\"]) lab = lab[\"@value\"];\r\n\t\t\tif(lab != \"unknown\") return lab;\r\n\t\t}\r\n\t}\r\n\treturn TerminusClient.FrameHelper.labelFromURL(this.getRowID(binding));\r\n}\r\n\r\nWOQLChooser.prototype.getTitleFromBinding = function(binding, rownum){\r\n\tlet sp = this.getSpecialRenderer(binding, \"title\");\r\n\tif(sp) return this.renderSpecial(sp, binding, rownum);\r\n\tif(this.config.titles()){\r\n\t\tif(binding[this.config.titles()]){\r\n\t\t\tvar lab = binding[this.config.titles()];\r\n\t\t\tif(lab[\"@value\"]) lab = lab[\"@value\"];\r\n\t\t\tif(lab != \"unknown\") return lab;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nWOQLChooser.prototype.getSelectedFromBinding = function(binding){\r\n\tconst matched_rules = this.config.getMatchingRules(row, false, \"row\", \"selected\");\r\n\tif(matched_rules && matched_rules.length){\r\n\t\treturn matched_rules[matched_rules.length - 1].selected;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nWOQLChooser.prototype.getSpecialRenderer = function(row, type){\r\n\tconst matched_rules = this.config.getMatchingRules(row, false, \"row\", type);\r\n\tfor(var i = 0; i<matched_rules.length; i++){\r\n\t\tif(matched_rules[i][type]) return matched_rules[i][type];\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nWOQLChooser.prototype.renderSpecial = function(rule, row, rownum){\r\n\tif(rule && typeof rule == \"function\"){\r\n\t\treturn render(row);\r\n\t}\r\n\tif(rule && typeof rule == \"string\"){\r\n\t\treturn rule;\r\n\t}\r\n}\r\n\r\nWOQLChooser.prototype.count = function(){\r\n\treturn this.result.count();\r\n}\r\n\r\nWOQLChooser.prototype.first = function(){\r\n\tthis.cursor = 0;\r\n\treturn this.choices[this.cursor];\r\n}\r\n\r\nWOQLChooser.prototype.prev = function(){\r\n\tif(this.cursor > 0) {\r\n\t\treturn this.choices[--this.cursor];\r\n\t}\r\n}\r\n\r\nWOQLChooser.prototype.next = function(){\r\n\treturn this.choices[this.cursor++];\r\n}\r\n\r\n\r\nmodule.exports = WOQLChooser;","const TerminusClient = require('@terminusdb/terminus-client');\r\nconst DatatypeRenderers = require(\"./DatatypeRenderers\");\r\n\r\nfunction WOQLTable(client, config){\r\n\tthis.client = client;\r\n\tif(config) this.options(config);\r\n\treturn this;\r\n}\r\n\r\nWOQLTable.prototype.setResult = function(res){\r\n\tthis.result = res;\r\n\treturn this;\r\n}\r\n\r\nWOQLTable.prototype.setRenderer = function(rend){\r\n\tthis.renderer = rend;\r\n\treturn this;\r\n}\r\n\r\nWOQLTable.prototype.render = function(onChangeQuery){\r\n\tif(this.renderer) return this.renderer.render(this, onChangeQuery);\r\n}\r\n\r\nWOQLTable.prototype.count = function(){\r\n\treturn this.result.count();\r\n}\r\n\r\nWOQLTable.prototype.first = function(){\r\n\treturn this.result.first();\r\n}\r\n\r\nWOQLTable.prototype.prev = function(){\r\n\treturn this.result.prev();\r\n}\r\n\r\nWOQLTable.prototype.next = function(){\r\n\treturn this.result.next();\r\n}\r\n\r\n\r\nWOQLTable.prototype.options = function(config){\r\n\tthis.config = config || TerminusClient.WOQL.table();\t\r\n\treturn this;\r\n}\r\n\r\nWOQLTable.prototype.setDatatypes = function(func){\r\n\tthis.datatypes = new DatatypeRenderers();\r\n\tif(this.config.datatypes) this.datatypes.options(this.config.datatypes);\r\n\tif(func) func(this.datatypes);\r\n\treturn this;\r\n}\r\n\r\nWOQLTable.prototype.canAdvancePage = function(){\r\n\treturn (this.result.count() == this.result.query.getLimit()); \r\n}\r\n\r\nWOQLTable.prototype.canChangePage = function(){\r\n\treturn this.canAdvancePage() || this.canRetreatPage();\r\n}\r\n\r\nWOQLTable.prototype.canRetreatPage = function(){\r\n\treturn (this.result.query.getPage() > 1);\r\n}\r\n\r\nWOQLTable.prototype.getPageSize = function(){\r\n\treturn this.result.query.getLimit() ;\t\r\n}\r\n\r\nWOQLTable.prototype.setPage = function(l){\r\n\treturn this.result.query.setPage(l);\t\r\n}\r\n\r\n\r\nWOQLTable.prototype.getPage = function(){\r\n\treturn this.result.query.getPage();\t\r\n}\r\n\r\nWOQLTable.prototype.setPageSize = function(l){\r\n\treturn this.update(this.result.query.setPageSize(l));\r\n}\r\n\r\nWOQLTable.prototype.nextPage = function(){\r\n\treturn this.update(this.result.query.nextPage());\r\n}\r\n\r\nWOQLTable.prototype.firstPage = function(){\r\n\treturn this.update(this.result.query.firstPage());\r\n}\r\n\r\nWOQLTable.prototype.previousPage = function(){\r\n\treturn this.update(this.result.query.previousPage());\r\n}\r\n\r\nWOQLTable.prototype.getColumnsToRender = function(){\r\n\tif(this.hasColumnOrder()){\r\n\t\tvar cols = this.getColumnOrder();\r\n\t}\r\n\telse if(this.result.query.hasSelect()){\r\n\t\tvar cols = this.result.query.getSelectVariables();\r\n\t}\r\n\telse {\r\n\t\tvar cols = this.result.getVariableList();\r\n\t}\r\n\tvar self = this;\r\n\treturn (cols ? cols.filter(col => !self.hidden(col)) : []);\r\n}\r\n\r\nWOQLTable.prototype.getColumnHeaderContents = function(colid){\r\n\tlet hr = this.config.getMatchingRules(false, colid, \"column\", \"header\");\r\n\tif(hr && hr.length){\r\n\t\tlet h = hr[hr.length-1].header;\r\n\t\tif(typeof h == \"string\"){\r\n\t\t\treturn document.createTextNode(h);\t\t\t\r\n\t\t}\r\n\t\telse if(typeof h == \"function\"){\r\n\t\t\treturn h(colid);\r\n\t\t}\r\n\t\telse return h;\r\n\t}\r\n\tif(colid.indexOf(\"v:\") === 0) colid = colid.substring(2);\r\n\tvar clab = (colid.indexOf(\"http\") != -1) ? TerminusClient.FrameHelper.labelFromURL(colid) : colid;\r\n\tclab = clab.replace(\"_\", \" \");\r\n\treturn document.createTextNode(clab);\r\n}\r\n\r\n\r\nWOQLTable.prototype.hidden = function(col){\r\n\tconst matched_rules = this.config.getMatchingRules(false, col, \"column\", \"hidden\");\r\n\tif(matched_rules.length){\r\n\t\treturn matched_rules[matched_rules.length-1].hidden;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\n/**\r\n * Called when you want to change the query associated with the table. \r\n */\r\nWOQLTable.prototype.update = function(nquery){\r\n\treturn nquery.execute(this.client).then((results) => {\r\n\t\tvar nresult = new TerminusClient.WOQLResult(results, nquery);\r\n\t\tthis.setResult(nresult);\r\n\t\tif(this.notify) this.notify(nresult);\r\n\t\treturn nresult;\r\n\t});\t\r\n}\r\n\r\nWOQLTable.prototype.hasDefinedEvent = function(row, key, context, action){\r\n\tconst matched_rules = this.config.getMatchingRules(row, key, context, action);\r\n\tif(matched_rules && matched_rules.length) return true;\r\n\treturn false;\r\n}\r\n\r\nWOQLTable.prototype.getDefinedEvent = function(row, key, context, action){\r\n\tconst matched_rules = this.config.getMatchingRules(row, key, context, action);\r\n\tif(matched_rules && matched_rules.length) {\r\n\t\tvar l = (matched_rules.length - 1);\r\n\t\treturn matched_rules[l][action];\r\n\t}\r\n}\r\n\r\n\r\nWOQLTable.prototype.getRowClick = function(row){\r\n\tlet re = this.getDefinedEvent(row, false, \"row\", \"click\");\r\n\treturn re;\r\n}\r\n\r\nWOQLTable.prototype.getCellClick = function(row, col){\r\n\tlet cc = this.getDefinedEvent(row, col, \"column\", \"click\");\r\n\treturn cc;\r\n}\r\n\r\nWOQLTable.prototype.getRowHover = function(row){\r\n\treturn this.getDefinedEvent(row, false, \"row\", \"hover\");\r\n}\r\n\r\nWOQLTable.prototype.getCellHover = function(row, key){\r\n\treturn this.getDefinedEvent(row, key, \"column\", \"hover\");\r\n}\r\n\r\nWOQLTable.prototype.getColumnOrder = function(){\r\n\treturn this.config.column_order();\r\n}\r\n\r\nWOQLTable.prototype.hasColumnOrder = WOQLTable.prototype.getColumnOrder;\r\nWOQLTable.prototype.hasCellClick = WOQLTable.prototype.getCellClick;\r\nWOQLTable.prototype.hasRowClick = WOQLTable.prototype.getRowClick;\r\nWOQLTable.prototype.hasCellHover = WOQLTable.prototype.getCellHover;\r\nWOQLTable.prototype.hasRowHover = WOQLTable.prototype.getRowHover;\r\n\r\nWOQLTable.prototype.getRenderer = function(key, row){\r\n\tvar rend = this.getSpecificRender(key, row);\r\n\tif(rend) return rend;\r\n\tlet renderer = this.getDefinedEvent(row, key, \"column\", \"renderer\");\r\n\tlet args =  this.getDefinedEvent(row, key, \"column\", \"args\");\r\n\tif(!renderer){\r\n\t\tlet r = this.getRendererForDatatype(row[key]);\r\n\t\trenderer = r.name;\r\n\t\tif(!args) args = r.args;\r\n\t}\r\n\tif(renderer){\r\n\t\treturn this.datatypes.createRenderer(renderer, args);\t\t\r\n\t}\r\n}\r\n\r\nWOQLTable.prototype.renderValue = function(renderer, val, key, row){\r\n\tif(val && val['@type']){\r\n\t\trenderer.type = val['@type'];\r\n\t\tvar dv = new DataValue(val['@value'], val['@type'], key, row);\r\n\t}\t\r\n\telse if(val && val['@language']){\r\n\t\trenderer.type = \"xsd:string\";\r\n\t\tvar dv = new DataValue(val['@value'], renderer.type, key, row);\r\n\t}\r\n\telse if(val && typeof val == \"string\"){\r\n\t\trenderer.type = \"id\";\r\n\t\tvar dv = new DataValue(val, \"id\", key, row);\r\n\t}\r\n\tif(dv) return renderer.renderValue(dv);\r\n\treturn \"\";\r\n}\r\n\r\nfunction DataValue(val, type){\r\n\tthis.datavalue = (val == \"unknown\" ? \"\" : val);\r\n\tthis.datatype = type;\r\n}\r\n\r\nDataValue.prototype.value = function(nvalue){\r\n\tif(nvalue) {\r\n\t\tthis.datavalue = nvalue; \r\n\t\treturn this;\r\n\t}\r\n\treturn this.datavalue;\r\n}\r\n\r\n\r\nWOQLTable.prototype.getRendererForDatatype = function(val){\r\n\tif(val && val['@type']){\r\n\t\treturn this.datatypes.getRenderer(val['@type'], val['@value']);\r\n\t}\r\n\telse if(val && val['@language']){\r\n\t\treturn this.datatypes.getRenderer(\"xsd:string\", val['@value']);\r\n\t}\r\n\telse if(val && typeof val == \"string\"){\r\n\t\treturn this.datatypes.getRenderer(\"id\", val);\t\t\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nWOQLTable.prototype.getSpecificRender = function(key, row){\r\n\tlet rend = this.getDefinedEvent(row, key, \"column\", \"render\");\r\n\treturn rend;\r\n}\r\n\r\nmodule.exports = WOQLTable;","/*\r\n * Maintains a list of renderers that are available for rendering \r\n * datatype values - also covers choice values and id values\r\n */\r\n\r\nfunction DatatypeRenderers(options){\r\n\tthis.registeredDataViewers = {},\r\n\tthis.registeredDataEditors = {},\r\n\tthis.defaultViewers = {};\r\n\tthis.defaultEditors = {};\r\n\tthis.universalViewer = false;\r\n\tthis.universalEditor = false;\r\n\tif(options) this.options(options);\r\n\t//links to other documents, choices, id field, id fields of contained objects, ids of structural elements: properties, etc\r\n\tthis.specials = ['document', 'oneOf', 'id', 'contained', 'structural'];\r\n}\r\n\r\nDatatypeRenderers.prototype.options = function (options){\r\n\tthis.universalViewer = (options && options.universalViewer ? options.universalViewer : false);\r\n\tthis.universalEditor = (options && options.universalEditor ? options.universalEditor : false);\r\n\tthis.editor = (options && options.editor ? options.editor : false);\r\n}\r\n\r\nDatatypeRenderers.prototype.getValidDataViewerList = function(datatype){\r\n\tlet valids = [];\r\n\tif(datatype && typeof this.registeredDataViewers[datatype] != \"undefined\"){\r\n\t\tvalids = valids.concat(this.registeredDataViewers[datatype]);\r\n\t}\r\n\tif(this.universalViewer && valids.indexOf(this.universalViewer) == -1){\r\n\t\tvalids.push(this.universalViewer);\r\n\t}\r\n\treturn valids;\r\n};\r\n\r\nDatatypeRenderers.prototype.getValidDataEditorList = function(datatype){\r\n\tlet valids = [];\r\n\tif(datatype && typeof this.registeredDataEditors[datatype] != \"undefined\"){\r\n\t\tvar nftypes = this.registeredDataEditors[datatype];\r\n\t\tif(nftypes){\r\n\t\t\tfor(var i = 0; i<nftypes.length; i++){\r\n\t\t\t\tif(valids.indexOf(nftypes[i]) == -1) valids.push(nftypes[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tif(typeof this.registeredDataEditors[datatype] != \"undefined\"){\r\n\t\tvalids = valids.concat(this.registeredDataEditors[datatype]);\r\n\t}\r\n\tif(this.universalEditor && valids.indexOf(this.universalEditor) == -1){\r\n\t\tvalids.push(this.universalEditor);\r\n\t}\r\n\treturn valids;\r\n}\r\n\r\nDatatypeRenderers.prototype.getEditorForDataFrame = function(datatype){\r\n\tvar vals = this.getValidDataEditorList(datatype);\r\n\tif(this.defaultEditors[datatype] && vals[this.defaultEditors[datatype]]){\r\n\t\treturn vals[this.defaultEditors[datatype]];\r\n\t}\r\n\t//last added is default if no explicit default is set\r\n\tif(vals){\r\n\t\treturn vals[Object.keys(vals)[0]];\r\n\t}\r\n\telse {\r\n\t\tif(this.universalEditor) return this.universalEditor;\r\n\t}\r\n}\r\n\r\nDatatypeRenderers.prototype.getViewerForDataFrame = function(datatype){\r\n\tvar vals = this.getValidDataViewerList(datatype);\r\n\tif(this.defaultViewers[datatype] && vals[this.defaultViewers[datatype]]){\r\n\t\treturn vals[this.defaultViewers[datatype]];\r\n\t}\r\n\tif(vals){\r\n\t\treturn vals[Object.keys(vals)[0]];\r\n\t}\r\n\telse {\r\n\t\tif(this.universalViewer) return this.universalViewer;\r\n\t}\r\n\r\n}\r\n\r\nDatatypeRenderers.prototype.registerViewerForTypes = function(viewer, record, types){\r\n\tfor(var i = 0; i < types.length; i++){\r\n\t\tif(typeof this.registeredDataViewers[types[i]] == \"undefined\"){\r\n\t\t\tthis.registeredDataViewers[types[i]] = {};\r\n\t\t}\r\n\t\tif(!this.registeredDataViewers[types[i]][viewer]){\r\n\t\t\tthis.registeredDataViewers[types[i]][viewer] = record;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nDatatypeRenderers.prototype.registerEditorForTypes = function(viewer, record, types){\r\n\tfor(var i = 0; i < types.length; i++){\r\n\t\tif(typeof this.registeredDataEditors[types[i]] == \"undefined\"){\r\n\t\t\tthis.registeredDataEditors[types[i]] = {};\r\n\t\t}\r\n\t\tif(!this.registeredDataEditors[types[i]][viewer]){\r\n\t\t\tthis.registeredDataEditors[types[i]][viewer] = record;\r\n\t\t}\t\t\t\r\n\t}\r\n}\r\n\r\nDatatypeRenderers.prototype.getRenderer = function(type, value){\r\n\tvar r = {};\r\n\tlet v = this.getViewerForDataFrame(type);\r\n\tif(v){\r\n\t\tif(typeof v == \"object\"){\r\n\t\t\tr.name = Object.keys(v)[0];\r\n\t\t\tif(v[r.name].label){\r\n\t\t\t\tr.label = v[r.name].label;\r\n\t\t\t}\r\n\t\t\tif(v[r.name].args){\r\n\t\t\t\tr.args = v[r.name].args;\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tr.name = v;\r\n\t\t}\r\n\t\treturn r;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nDatatypeRenderers.prototype.getEditor = function(type, value){\r\n\tvar r = {};\r\n\tlet v = this.getEditorForDataFrame(type);\r\n\tif(v){\r\n\t\tif(typeof v == \"object\"){\r\n\t\t\tr.name = Object.keys(v)[0];\r\n\t\t\tif(v[r.name].label){\r\n\t\t\t\tr.label = v[r.name].label;\r\n\t\t\t}\r\n\t\t\tif(v[r.name].args){\r\n\t\t\t\tr.args = v[r.name].args;\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tr.name = v;\r\n\t\t}\r\n\t\treturn r;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\n\r\nmodule.exports=DatatypeRenderers;\r\n\r\n\r\n","const TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction WOQLGraph(client, options){\r\n\tthis.client = client;\r\n\tthis.options(options);\r\n\tthis.nodes = [];\r\n\tthis.node_ids = [];\r\n\tthis.edges = [];\r\n\treturn this;\r\n}\r\n\r\nWOQLGraph.prototype.setResult = function(result){\r\n\tthis.result = result;\r\n\tthis.calculateVariableTypes(result);\r\n}\r\n\r\nWOQLGraph.prototype.setRenderer = function(rend){\r\n\tthis.renderer = rend;\r\n\treturn this;\r\n}\r\n\r\nWOQLGraph.prototype.render = function(){\r\n\tif(this.renderer) return this.renderer.render(this);\r\n}\r\n\r\nWOQLGraph.prototype.options = function(config){\r\n\tthis.config = config || TerminusClient.WOQL.graph();\t\r\n\treturn this;\r\n}\r\n\r\nWOQLGraph.prototype.getEdges = function(){\r\n\tif(this.edges) return this.edges;\r\n\tthis.edges = [];\r\n\tvar bindings = this.result.getBindings();\r\n\tfor(var i = 0; i<bindings.length; i++){\r\n\t\tif(this.rowIncludesEdge(bindings[i])){\r\n\t\t\tthis.edges = this.edges.concat(this.makeEdgesFromRow(bindings[i]))\r\n\t\t}\r\n\t}\r\n\treturn this.edges;\r\n}\r\n\r\nWOQLGraph.prototype.getNodes = function(){\r\n\tif(this.nodes) return this.nodes;\r\n\tthis.nodes = [];\r\n\t//get column names first...\r\n\tvar bindings = this.result.getBindings();\r\n\tvar nodes = [];\r\n\tfor(var i = 0; i<bindings.length; i++){\r\n\t\tfor(var k in bindings[i]){\r\n\t\t\tif(this.source_variables.indexOf(k) != -1 && nodes.indexOf(bindings[i][k]) == -1){\r\n\t\t\t\tnodes.push(bindings[i][k]);\r\n\t\t\t\tthis.nodes.push(this.makeNodeFromSource(bindings[i][k], k, bindings[i]));\r\n\t\t\t}\r\n\t\t\tif(this.target_variables.indexOf(k) != -1 && nodes.indexOf(bindings[i][k]) == -1){\r\n\t\t\t\tnodes.push(bindings[i][k]);\r\n\t\t\t\tthis.nodes.push(this.makeNodeFromTarget(bindings[i][k], k, bindings[i]));\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn this.nodes;\r\n}\r\n\r\nWOQLGraph.prototype.makeNodeFromSource = function(sid, k, row) {\r\n\tvar node = {type: \"node\", id: sid};\r\n\treturn this.adornNode(node, row);\r\n}\r\n\r\nWOQLGraph.prototype.makeNodeFromTarget = WOQLGraph.prototype.makeNodeFromSource ;\r\n\r\nWOQLGraph.prototype.adornNode = function(node){\r\n\treturn node;\r\n}\r\n\r\nWOQLGraph.prototype.adornEdge = function(edge){\r\n\treturn edge;\r\n}\r\n\r\nWOQLGraph.prototype.makeEdgeFromRow = function(eid, k, row){\r\n\tvar target = false;\r\n\tvar source = false;\r\n\tfor(var i = 0; i<this.target_variables.length; i++){\r\n\t\tif(row[this.target_variables[i]]){\r\n\t\t\ttarget = row[this.target_variables[i]];\r\n\t\t\tcontinue;\r\n\t\t}\r\n\t}\r\n\tif(target){\r\n\t\tfor(var i = 0; i<this.source_variables.length; i++){\r\n\t\t\tif(row[this.source_variables[i]]){\r\n\t\t\t\tsource = row[this.source_variables[i]];\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t}\t\t\r\n\t}\r\n\tif(source && target){\r\n\t\tvar edge = { type: \"link\", id: eid, target: target, source: source };\r\n\t\treturn this.adornEdge(edge, row);\r\n\t}\r\n}\r\n\r\nWOQLGraph.prototype.calculateVariableTypes = function(){\r\n\tvar bindings = this.result.getBindings();\r\n\tif(bindings && bindings.length){\r\n\t\tfor(var i = 0; i<bindings.length; i++){\r\n\t\t\tthis.extractFromBinding(bindings[i]);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nWOQLGraph.prototype.extractFromBinding = function(row){\r\n\t//\r\n\tif(this.includeRow(row)){\r\n\t\t//get all the nodes (ids - non literals) //\r\n\t\t//see which nodes are excluded ...\r\n\t\tvar nodes = [];\r\n\t\tvar lits = [];\r\n\t\tfor(var k in row){\r\n\t\t\tif(typeof row[k] == \"string\"){\r\n\t\t\t\tif(row[k] && row[k] != \"unknown\" && this.includeNode(k, row)) nodes.push(k);\r\n\t\t\t}\r\n\t\t\telse if(typeof row[k][\"@value\"] == \"string\" && this.includeLiteralNode(k, row)){\r\n\t\t\t\tlits.push(k);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(nodes.length == 0) return;\r\n\t\t//first of all we need to make the literal nodes targets of \r\n\t\tfor(var i = 0; i<lits.length; i++){\r\n\t\t\t//make an edge and put the lit in as a node...\r\n\t\t\tvar nid = TerminusClient.FrameHelper.genBNID().substring(2);\r\n\t\t\tlet source = this.getLiteralOwner(nodes, lits[i], row);\r\n\t\t\tif(source) {\r\n\t\t\t\tthis.addAdornedNode(nid, lits[i], row);\r\n\t\t\t\tthis.addAdornedEdge(row[source], nid, source, lits[i], row);\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.createEdgesFromIDs(nodes, row);\r\n\t\tfor(var i = 0; i<nodes.length; i++){\r\n\t\t\tvar ndid = row[nodes[i]];\r\n\t\t\tthis.addAdornedNode(ndid, nodes[i], row);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nWOQLGraph.prototype.addAdornedEdge = function(source, target, ks, kt, row){\r\n\tvar edge = { type: \"link\", target: target, source: source, text: kt};\r\n\tconst matched_rules = this.config.getMatchingRules(row, [ks, kt], \"edge\");\r\n\tfor(var i = 0; i<matched_rules.length; i++){\r\n\t\tif(matched_rules[i].size){\r\n\t\t\tif(typeof matched_rules[i].size == \"string\" && matched_rules[i].size.substring(0, 2) == \"v:\"){\r\n\t\t\t\tvar w = row[matched_rules[i].size];\r\n\t\t\t\tif(w && w['@value']) edge.size = w['@value'];\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tedge.size = matched_rules[i].size;\r\n\t\t\t}\t\t\t\r\n\t\t}\r\n\t\tif(matched_rules[i].color){\r\n\t\t\tedge.color = matched_rules[i].color;\t\t\t\r\n\t\t}\r\n\t\tif(matched_rules[i].distance){\r\n\t\t\tif(typeof matched_rules[i].distance == \"string\" && matched_rules[i].distance.substring(0, 2) == \"v:\"){\r\n\t\t\t\tvar w = row[matched_rules[i].distance];\r\n\t\t\t\tif(w && w['@value']) edge.distance = w['@value'];\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tedge.distance = matched_rules[i].distance;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(matched_rules[i].arrow){\r\n\t\t\tedge.arrow = matched_rules[i].arrow;\r\n\t\t}\r\n\t\tif(typeof matched_rules[i].symmetric != \"undefined\"){\r\n\t\t\tedge.symmetric = matched_rules[i].symmetric;\r\n\t\t}\r\n\t\tif(matched_rules[i].weight){\r\n\t\t\tif(typeof matched_rules[i].weight == \"string\" && matched_rules[i].weight.substring(0, 2) == \"v:\"){\r\n\t\t\t\tvar w = row[matched_rules[i].weight];\r\n\t\t\t\tif(w && w['@value']) edge.weight = w['@value'];\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tedge.weight = matched_rules[i].weight;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tthis.edges.push(edge);\t\r\n}\r\n\r\nWOQLGraph.prototype.addAdornedNode = function(nid, k, row){\r\n\tvar node = { type: \"node\", id: nid, nodetype: k };\r\n\tconst matched_rules = this.config.getMatchingRules(row, k, \"node\");\r\n\tfor(var i = 0; i<matched_rules.length; i++){\r\n\t\tif(matched_rules[i].size){\r\n\t\t\tif(typeof matched_rules[i].size == \"string\" && matched_rules[i].size.substring(0, 2) == \"v:\"){\r\n\t\t\t\tvar rad = row[matched_rules[i].size];\r\n\t\t\t\tif(rad && rad['@value']) node.radius = rad['@value'];\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tnode.radius = matched_rules[i].size;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(matched_rules[i].color){\r\n\t\t\tnode.color = matched_rules[i].color;\r\n\t\t}\r\n\t\tif(matched_rules[i].charge){\r\n\t\t\tif(typeof matched_rules[i].charge == \"string\" && matched_rules[i].charge.substring(0, 2) == \"v:\"){\r\n\t\t\t\tvar rad = row[matched_rules[i].charge];\r\n\t\t\t\tif(rad && rad['@value']) node.charge = rad['@value'];\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tnode.charge = matched_rules[i].charge;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(matched_rules[i].collisionRadius ){\r\n\t\t\tif(typeof matched_rules[i].collisionRadius == \"string\" && matched_rules[i].collisionRadius.substring(0, 2) == \"v:\"){\r\n\t\t\t\tvar rad = row[matched_rules[i].collisionRadius];\r\n\t\t\t\tif(rad && rad['@value']) node.collisionRadius = rad['@value'];\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tnode.collisionRadius= matched_rules[i].collisionRadius;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(matched_rules[i].icon ){\r\n\t\t\tnode.icon = matched_rules[i].icon;\r\n\t\t}\r\n\t\tif(matched_rules[i].text){\r\n\t\t\tnode.text = matched_rules[i].text;\r\n\t\t}\r\n\t\tif(matched_rules[i].border){\r\n\t\t\tnode.border = matched_rules[i].border;\r\n\t\t}\r\n\t}\r\n\tif(!node.text){\r\n\t\tif(typeof row[k] == \"string\") node.text = row[k];\r\n\t\telse if(row[k]['@value']) node.text = row[k]['@value'];\r\n\t}\r\n\tthis.nodes.push(node);\r\n}\r\n\r\nWOQLGraph.prototype.getLiteralOwner = function(nodes, v, row){\r\n\tvar cs = this.config.source();\r\n\tif(cs && row[cs]){\r\n\t\treturn cs;\r\n\t}\r\n\tvar edges = this.config.edges();\r\n\tif(edges){\r\n\t\tfor(var i = 0; i < edges.length; i++){\r\n\t\t\tif(edges[i][1] == v){\r\n\t\t\t\treturn edges[i][0];\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\treturn nodes[0];\r\n}\r\n\r\nWOQLGraph.prototype.createEdgesFromIDs = function(nodes, row){\r\n\tif(nodes.length < 2) return;\r\n\tvar cs = this.config.source();\r\n\tlet es = this.config.edges();\r\n\tif(!cs && es && es.length){\r\n\t\tfor(var i = 0; i< es.length; i++){\r\n\t\t\tif(nodes.indexOf(es[i][0]) != -1 && nodes.indexOf(es[i][1]) != -1 ){\r\n\t\t\t\tthis.addAdornedEdge(row[es[i][0]], row[es[i][1]], es[i][0], es[i][1], row);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn;\r\n\t}\r\n\tvar s = (cs && nodes.indexOf(cs) != -1) ? cs : nodes[0];\r\n\tfor(var i = 0; i<nodes.length; i++){\r\n\t\tif(nodes[i] == s) continue;\r\n\t\tthis.addAdornedEdge(row[s], row[nodes[i]], s, nodes[i], row);\r\n\t}\r\n}\r\n\r\nWOQLGraph.prototype.includeNode = function(v, row){\r\n\tconst matched_rules = this.config.getMatchingRules(row, v, \"node\", \"hidden\");\r\n\tfor(var i = 0; i<matched_rules.length; i++){\r\n\t\tif(matched_rules[i].hidden) return false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nWOQLGraph.prototype.includeLiteralNode = function(v, row){\r\n\tlet l = this.config.literals();\r\n\tif(typeof l != \"undefined\" && !l) return false;\r\n\tconst matched_rules = this.config.getMatchingRules(row, v, \"node\", \"hidden\");\r\n\tfor(var i = 0; i<matched_rules.length; i++){\r\n\t\tif(matched_rules[i].hidden) return false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\n\r\nWOQLGraph.prototype.includeRow = function(row){\r\n\tconst matched_rules = this.config.getMatchingRules(row, false, \"row\", \"hidden\");\r\n\tfor(var i = 0; i<matched_rules.length; i++){\r\n\t\tif(matched_rules[i].hidden) return false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\n\r\n\r\nmodule.exports = WOQLGraph;","/*\r\n * Maps a woql query to a stream of results...\r\n */\r\n\r\nfunction WOQLStream(client){\r\n\tthis.client = client;\r\n}\r\n\r\nWOQLStream.prototype.options = function(opts){\r\n\tthis.page_size = 10;\r\n\treturn this;\r\n}\r\n\r\nWOQLStream.prototype.setResult = function(wqrs){\r\n\tthis.result = wqrs;\r\n}\r\n\r\nWOQLStream.prototype.setRenderer = function(rend){\r\n\tthis.renderer = rend;\r\n\treturn this;\r\n}\r\n\r\nWOQLStream.prototype.render = function(){\r\n\tif(this.renderer) return this.renderer.render(this);\r\n}\r\n\r\nmodule.exports = WOQLStream;","const TerminusClient = require('@terminusdb/terminus-client');\r\nconst TerminusCodeSnippet = require('./query/TerminusCodeSnippet');\r\nconst ResultPane = require(\"./ResultPane\");\r\nconst UTILS = require('../Utils');\r\nconst HTMLFrameHelper = require('./HTMLFrameHelper');\r\n\r\nfunction QueryPane(client, query, result){\r\n\tthis.client = client;\r\n\tthis.query = query;\r\n\tthis.result = result;\r\n\tthis.views = [];\r\n\tthis.container = document.createElement('span');\r\n    this.container.setAttribute('class', 'terminus-query-pane-cont');\r\n\tthis.fireDefaultQueries();\r\n}\r\n\r\nQueryPane.prototype.fireDefaultQueries = function(){\r\n\tlet WOQL = TerminusClient.WOQL;\r\n\tvar query = WOQL.query().classMetadata();\r\n\tquery.execute(this.client).then((results) => {\r\n\t\tlet qcres = new TerminusClient.WOQLResult(results, query);\r\n\t\tthis.classMetaDataRes = qcres;\r\n\t})\r\n\tvar query = WOQL.query().propertyMetadata();\r\n\tquery.execute(this.client).then((results) => {\r\n\t\tlet qpres = new TerminusClient.WOQLResult(results, query);\r\n\t\tthis.propertyMetaDataRes = qpres;\r\n\t})\r\n}\r\n\r\nQueryPane.prototype.options = function(opts){\r\n\tthis.showQuery = (opts && typeof opts.showQuery != \"undefined\" ? opts.showQuery : true);\r\n\tthis.editQuery = (opts && typeof opts.editQuery != \"undefined\" ? opts.editQuery : true);\r\n\tthis.showHeader = (opts && typeof opts.showHeader != \"undefined\" ? opts.showHeader : false);\r\n\tthis.addViews = (opts && typeof opts.addViews != \"undefined\" ? opts.addViews : false);\r\n\tthis.intro = (opts && typeof opts.intro != \"undefined\" ? opts.intro : false);\r\n\tthis.defaultResultView = { showConfig: \"icon\", editConfig: \"true\" };\r\n    return this;\r\n}\r\n\r\nQueryPane.prototype.getSection = function(sName){\r\n\tvar btn = document.createElement('button');\r\n\tbtn.setAttribute('class', 'terminus-query-section');\r\n\tbtn.appendChild(document.createTextNode(sName));\r\n\treturn btn;\r\n}\r\n\r\nQueryPane.prototype.clearSubMenus = function(btn){\r\n\tvar par = btn.parentElement.parentElement;\r\n\tvar smenus = par.getElementsByClassName('terminus-queries-submenu');\r\n\tfor(var i=0; i<smenus.length; i++){\r\n\t\tTerminusClient.FrameHelper.removeChildren(smenus[i]);\r\n\t}\r\n}\r\n\r\nQueryPane.prototype.getResults = function(query){\r\n\tif(query)\r\n\t\tthis.input.setQuery(query);\r\n\tTerminusClient.FrameHelper.removeChildren(this.sampleQueryDOM);\r\n\tthis.input.refreshContents();\r\n}\r\n\r\nQueryPane.prototype.AddEvents = function(btn){\r\n\tvar self = this;\r\n\tbtn.addEventListener('click', function(){\r\n\t\tlet WOQL = TerminusClient.WOQL;\r\n\t\tself.clearSubMenus(this);\r\n\t\tvar query;\r\n\t\tswitch(this.value){\r\n\t\t\tcase 'Show All Schema Elements':\r\n\t\t\t\tquery = WOQL.query().elementMetadata();\r\n\t\t\tbreak;\r\n\t\t\tcase 'Show All Classes':\r\n\t\t\t\tquery = WOQL.query().classMetadata();\r\n\t\t\tbreak;\r\n\t\t\tcase 'Show Document Classes':\r\n\t\t\t\tquery = WOQL.query().documentMetadata();\r\n\t\t\tbreak;\r\n\t\t\tcase 'Show All Properties':\r\n\t\t\t\tquery = WOQL.query().propertyMetadata();\r\n\t\t\tbreak;\r\n\t\t\tcase 'Show All Data':\r\n\t\t\t\tquery = WOQL.query().getEverything();\r\n\t\t\tbreak;\r\n\t\t\tcase 'Show data of chosen type':\r\n\t\t\t\tvar choosen = 'scm:' + this.innerText;\r\n\t\t\t\tquery = WOQL.query().getDataOfClass(choosen);\r\n\t\t\tbreak;\r\n\t\t\tcase 'Show property of chosen type':\r\n\t\t\t\tvar choosen = 'scm:' + this.innerText;\r\n\t\t\t\tquery = WOQL.query().getDataOfProperty(choosen);\r\n\t\t\tbreak;\r\n\t\t\tcase 'Show data of type':\r\n\t\t\t\treturn;\r\n\t\t\tcase 'Show property of type':\r\n\t\t\t\treturn;\r\n\t\t\tdefault:\r\n\t\t\t\tconsole.log('Invalid Type of query');\r\n\t\t\tbreak;\r\n\t\t}\r\n\t\tself.getResults(query);\r\n\t})\r\n}\r\n\r\nQueryPane.prototype.getQueryMenu = function(qName){\r\n\tvar btn = document.createElement('button');\r\n\tbtn.setAttribute('class', 'terminus-load-queries');\r\n\tbtn.setAttribute('value', qName);\r\n\tbtn.appendChild(document.createTextNode(qName));\r\n\tthis.AddEvents(btn);\r\n\treturn btn;\r\n}\r\n\r\nQueryPane.prototype.getSubDataMenu = function(qName, val){\r\n\tvar btn = document.createElement('button');\r\n\tbtn.setAttribute('class', 'terminus-load-queries');\r\n\tbtn.setAttribute('value', qName);\r\n\tbtn.appendChild(document.createTextNode(val));\r\n\tthis.AddEvents(btn);\r\n\treturn btn;\r\n}\r\n\r\n// schema queries\r\nQueryPane.prototype.getSchemaSection = function(d){\r\n\tvar section = this.getSection('Schema Queries');\r\n\td.appendChild(section);\r\n\tvar btn = this.getQueryMenu('Show All Schema Elements');\r\n\td.appendChild(btn);\r\n\tvar btn = this.getQueryMenu('Show All Classes');\r\n\td.appendChild(btn);\r\n\tvar btn = this.getQueryMenu('Show Document Classes');\r\n\td.appendChild(btn);\r\n\tvar btn = this.getQueryMenu('Show All Properties');\r\n\td.appendChild(btn);\r\n}\r\n\r\nQueryPane.prototype.checkIfDataMenuOpen = function(btn){\r\n\tvar isOpen = false;\r\n\tif(btn.children.length){\r\n\t\tfor(var i=0; i<btn.children.length; i++){\r\n\t\t\t//var child = btn.children[i].getElementsByClassName('terminus-queries-submenu');\r\n\t\t\tvar child = btn.getElementsByClassName('terminus-queries-submenu');\r\n\t\t\tif(child.length){\r\n\t\t\t\tfor(var j=0; j<child.length; j++){\r\n\t\t\t\t\tTerminusClient.FrameHelper.removeElement(child[j]);\r\n\t\t\t\t\tisOpen = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn isOpen;\r\n}\r\n\r\nQueryPane.prototype.showDataOfTypeEvent = function(btn){\r\n\tvar self = this;\r\n\tbtn.addEventListener('click', function(){\r\n\t\tvar isMenuOpen = self.checkIfDataMenuOpen(this);\r\n\t\tif(!isMenuOpen){\r\n\t\t\tvar subPar = document.createElement('div');\r\n\t\t\tsubPar.setAttribute('class', 'terminus-queries-submenu');\r\n\t\t\tif(self.classMetaDataRes && self.classMetaDataRes.hasBindings()){\r\n\t\t\t\tfor(var i = 0; i<self.classMetaDataRes.bindings.length; i++){\r\n\t\t\t\t\tvar text = self.classMetaDataRes.bindings[i]['v:Label']['@value'];\r\n\t\t\t\t\tsubPar.appendChild(self.getSubDataMenu('Show data of chosen type', text));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tbtn.appendChild(subPar);\r\n\t\t}\r\n\t})\r\n}\r\n\r\nQueryPane.prototype.showPropertyOfTypeEvent = function(btn){\r\n\tvar self = this;\r\n\tbtn.addEventListener('click', function(){\r\n\t\tvar isMenuOpen = self.checkIfDataMenuOpen(this);\r\n\t\tif(!isMenuOpen){\r\n\t\t\tvar subPar = document.createElement('div');\r\n\t\t\tsubPar.setAttribute('class', 'terminus-queries-submenu');\r\n\t\t\tif(self.propertyMetaDataRes && self.propertyMetaDataRes.hasBindings()){\r\n\t\t\t\tfor(var i = 0; i<self.propertyMetaDataRes.bindings.length; i++){\r\n\t\t\t\t\tvar text = self.propertyMetaDataRes.bindings[i]['v:Label']['@value'];\r\n\t\t\t\t\tsubPar.appendChild(self.getSubDataMenu('Show property of chosen type', text));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tbtn.appendChild(subPar);\r\n\t\t}\r\n\t})\r\n}\r\n\r\nQueryPane.prototype.addCheveronIcon = function(btn){\r\n\tvar i = document.createElement('i');\r\n\ti.setAttribute('class', 'fa fa-chevron-right terminus-query-section');\r\n\tbtn.appendChild(i);\r\n}\r\n\r\n// data queries\r\nQueryPane.prototype.getDataSection = function(d){\r\n\tvar section = this.getSection('Data Queries');\r\n\td.appendChild(section);\r\n\t// div to populate submenu on data of type\r\n\tvar bd = document.createElement('div');\r\n\tbd.setAttribute('class', 'terminus-query-submenu');\r\n\td.appendChild(bd);\r\n\tvar btn = this.getQueryMenu('Show data of type');\r\n\tbd.appendChild(btn);\r\n\tthis.addCheveronIcon(btn);\r\n\tthis.showDataOfTypeEvent(btn);\r\n\t// div to populate submenu on property of type\r\n\tvar bd = document.createElement('div');\r\n\tbd.setAttribute('class', 'terminus-query-submenu');\r\n\td.appendChild(bd);\r\n\tvar btn = this.getQueryMenu('Show property of type');\r\n\tbd.appendChild(btn);\r\n\tthis.showPropertyOfTypeEvent(btn);\r\n\tthis.addCheveronIcon(btn);\r\n\tvar btn = this.getQueryMenu('Show All Data');\r\n\td.appendChild(btn);\r\n}\r\n\r\nQueryPane.prototype.fireDocumentEvent = function(document){\r\n\tlet WOQL = TerminusClient.WOQL;\r\n\tvar query = WOQL.query().documentProperties(document);\r\n\tthis.getResults(query);\r\n}\r\n\r\nQueryPane.prototype.getEnterDocumentIdDOM = function(){\r\n\tvar sp = document.createElement('span');\r\n\tsp.setAttribute('class', 'terminus-display-flex');\r\n\tvar inp = document.createElement('input');\r\n\tinp.setAttribute('class', 'terminus-doc-id-input');\r\n\tinp.setAttribute('placeholder', 'doc:myDocId');\r\n\tvar sub = document.createElement('button');\r\n\tsub.setAttribute('class', 'terminus-btn terminus-doc-id-input-submit');\r\n\tsub.appendChild(document.createTextNode('Submit'));\r\n\tvar self = this;\r\n\tsub.addEventListener('click', function(){\r\n\t\tself.fireDocumentEvent(inp.value);\r\n\t})\r\n\tsp.appendChild(inp);\r\n\tsp.appendChild(sub);\r\n\treturn sp;\r\n}\r\n\r\n// document queries\r\nQueryPane.prototype.getDocumentSection = function(d){\r\n\tvar section = this.getSection('Document Queries');\r\n\td.appendChild(section);\r\n\tvar btn = this.getQueryMenu('Show All Documents');\r\n\td.appendChild(btn);\r\n\td.appendChild(this.getEnterDocumentIdDOM());\r\n}\r\n\r\n// bottom color transaprent\r\nQueryPane.prototype.getQueryMenuBlock = function(){\r\n\tvar d = document.createElement('div');\r\n\td.setAttribute('class', 'terminus-load-queries');\r\n\tthis.getSchemaSection(d);\r\n\tthis.getDataSection(d);\r\n\tthis.getDocumentSection(d);\r\n\treturn d;\r\n}\r\n\r\nQueryPane.prototype.getSampleQueriesDOM = function(){\r\n\tvar i = document.createElement('icon');\r\n\ti.setAttribute('class', 'fa fa-ellipsis-v terminus-ellipsis-icon');\r\n\ti.setAttribute('title', 'Click to load sample Queries');\r\n\ti.setAttribute('value', false);\r\n\tthis.sampleQueryDOM = i;\r\n\tvar self = this;\r\n\ti.addEventListener('click', function(e){\r\n\t\tif(e.target !== this) return;\r\n\t\tif(this.children.length)\r\n\t\t\tTerminusClient.FrameHelper.removeChildren(this);\r\n\t\telse{\r\n\t\t\tvar d = self.getQueryMenuBlock();\r\n\t\t\tthis.appendChild(d);\r\n\t\t}\r\n\t})\r\n\treturn i;\r\n}\r\n\r\nQueryPane.prototype.getAsDOM = function(){\r\n\tif(this.intro){\r\n\t\tthis.container.appendChild(UTILS.getHeaderDom(this.intro));\r\n\t}\r\n\tif(this.showQuery) {\r\n\t\tvar configspan = document.createElement(\"span\");\r\n\t\tconfigspan.setAttribute(\"class\", \"pane-config-icons\");\r\n\t\tthis.container.appendChild(configspan);\r\n\t\tvar mode = (this.editQuery ? \"edit\" : \"view\");\r\n\t\tthis.input = this.createInput(mode);\r\n\t\tvar ipdom = this.input.getAsDOM(true);\r\n\t\tvar ispan = document.createElement(\"span\");\r\n\t\tispan.setAttribute(\"class\", \"query-pane-config\");\r\n\t\tvar ic = document.createElement(\"i\");\r\n\t\t//ic.setAttribute('style', 'margin:10px;')\r\n\t\tconfigspan.appendChild(ic);\r\n\t\tvar self = this;\r\n\t\tfunction showQueryConfig(){\r\n\t\t\tconfigspan.title=\"Click to Hide Query\";\r\n\t\t\tic.setAttribute(\"class\", \"fas fa fa-times-circle\");\r\n\t\t\tconfigspan.classList.remove('terminus-click-to-view-query');\r\n\t\t\tvar qicon = self.getSampleQueriesDOM();\r\n\t\t\tif(configspan.nextSibling){\r\n\t\t\t\tself.container.insertBefore(ipdom, configspan.nextSibling);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tself.container.appendChild(ipdom);\r\n\t\t\t\tipdom.appendChild(qicon);\r\n\t\t\t}\r\n\t\t\tself.input.stylizeSnippet();\r\n\t\t}\r\n\t\tfunction hideQueryConfig(){\r\n\t\t\tconfigspan.title=\"Click to View Query\";\r\n            ic.setAttribute(\"class\", \"fas fa fa-search terminus-query-view-icon\");\r\n\t\t\tconfigspan.classList.add('terminus-click-to-view-query');\r\n\t\t\tself.container.removeChild(ipdom);\r\n\t\t}\r\n\t\tconfigspan.addEventListener(\"click\", () => {\r\n\t\t\tif(this.showingQuery) hideQueryConfig();\r\n\t\t\telse showQueryConfig();\r\n\t\t\tthis.showingQuery = !this.showingQuery;\r\n\t\t});\r\n\t\tshowQueryConfig();\r\n\t\tif(this.showQuery == \"icon\") hideQueryConfig();\r\n    }\r\n\tthis.resultDOM = document.createElement(\"span\");\r\n\tthis.resultDOM.setAttribute(\"class\", \"terminus-query-results\");\r\n\tif(this.views.length == 0){\r\n\t\tthis.addView(TerminusClient.WOQL.table(), this.defaultResultView);\r\n\t}\r\n\t//this is where we want to put in the view headers in the case of the query page\r\n\tfor(var i = 0; i<this.views.length; i++){\r\n\t\tvar vdom = this.views[i].getAsDOM();\r\n\t\tif(vdom){\r\n\t\t\tif(this.showHeader){\r\n\t\t\t\tvar closable = (this.views.length != 1);\r\n\t\t\t\t//var qhdr = this.getResultPaneHeader(closable);\r\n\t\t\t\t//vdom.prepend(qhdr);\r\n\t\t\t}\r\n\t\t\tthis.resultDOM.appendChild(vdom);\r\n\t\t}\r\n\t}\r\n\tthis.container.appendChild(this.resultDOM);\r\n\tif(this.addViews) this.container.appendChild(this.getAddViewControl());\r\n\treturn this.container;\r\n}\r\n\r\n\r\nQueryPane.prototype.getResultPaneHeader = function(closable){\r\n\tvar c = document.createElement('div');\r\n\tvar savePaneButton = document.createElement('button');\r\n\tsavePaneButton.setAttribute('class', 'terminus-btn terminus-query-btn');\r\n\tsavePaneButton.appendChild(document.createTextNode('Save'));\r\n\tc.appendChild(savePaneButton);\r\n\tif(closable){\r\n\t\tvar closePaneButton = document.createElement('button');\r\n\t\tclosePaneButton.setAttribute('class', 'terminus-btn terminus-query-btn');\r\n\t\tclosePaneButton.appendChild(document.createTextNode('Close'));\r\n\t\tc.appendChild(closePaneButton);\r\n\t}\r\n\tvar collapsePaneButton = document.createElement('button');\r\n\tcollapsePaneButton.setAttribute('class', 'terminus-btn terminus-query-btn');\r\n\tcollapsePaneButton.appendChild(document.createTextNode('Collapse'));\r\n\tc.appendChild(collapsePaneButton);\r\n\treturn c;\r\n}\r\n\r\nQueryPane.prototype.createInput = function(mode){\r\n    let input = new TerminusCodeSnippet(\"woql\", mode, null, 800);\r\n    if(this.query){\r\n    \tinput.setQuery(this.query);\r\n\t}\r\n\tvar self = this;\r\n\tinput.submit = function(qObj){\r\n\t\tself.submitQuery(qObj);\r\n\t};\r\n\treturn input;\r\n}\r\n\r\nQueryPane.prototype.updateQuery = function(qObj){\r\n\tthis.query = qObj;\r\n\tif(this.input) this.input.setQuery(this.query);\r\n}\r\n\r\nQueryPane.prototype.updateResult = function(result){\r\n\tthis.result = result;\r\n\tthis.updateQuery(result.query);\r\n\tthis.refreshViews();\r\n}\r\n\r\nQueryPane.prototype.addView = function(config, options){\r\n\tvar nrp = new ResultPane(this.client, this, config).options(options);\r\n\tif(this.result){\r\n\t\tnrp.setResult(this.result);\r\n\t}\r\n\tthis.views.push(nrp);\r\n\treturn nrp;\r\n}\r\n\r\nQueryPane.prototype.empty = function(){\r\n\treturn (typeof this.query == \"undefined\");\r\n}\r\n\r\nQueryPane.prototype.clearMessages = function(){}\r\nQueryPane.prototype.showError = function(){}\r\n\r\nQueryPane.prototype.submitQuery = function(qObj){\r\n\tthis.clearMessages();\r\n    this.query = qObj;\r\n    qObj.execute(this.client).then((results) => {\r\n\t\tvar r = new TerminusClient.WOQLResult(results, qObj);\r\n\t\tthis.result = r;\r\n\t\tthis.refreshViews();\r\n\t})\r\n}\r\n\r\nQueryPane.prototype.refreshViews = function(){\r\n\tfor(var i = 0; i<this.views.length; i++){\r\n\t\tthis.views[i].updateResult(this.result);\r\n\t}\r\n}\r\n\r\n\r\nQueryPane.prototype.getAddViewControl = function(){\r\n\tvar vd = document.createElement('div');\r\n\tvd.setAttribute('class', 'terminus-add-view-selector');\r\n\tvar self = this;\r\n\tvar WOQL = TerminusClient.WOQL;\r\n\tvar newView = function(val){\r\n\t\tself.selector.value = \"\";\r\n\t\tvar c= eval('WOQL.' + val + \"()\");\r\n\t\tvar nv = self.addView(c, self.defaultResultView);\r\n\t\tif(self.result){\r\n\t\t\tnv.setResult(self.result);\r\n\t\t}\r\n\t\tvar vdom = nv.getAsDOM();\r\n\t\tif(vdom){\r\n\t\t\tself.resultDOM.appendChild(vdom);\r\n\t\t}\r\n\t}\r\n\tvar opts = [\r\n\t\t{ value: \"\", label: \"Add another view of results\"},\r\n\t\t{ value: \"table\", label: \"Add Table View\"},\r\n\t\t{ value: \"stream\", label: \"Add Stream View\"},\r\n\t\t{ value: \"graph\", label: \"Add Graph View\"},\r\n\t\t{ value: \"chooser\", label: \"Add Drop-down View\"},\r\n\t\t{ value: \"map\", label: \"Add Map View\"}\r\n\t];\r\n\tvar sel = HTMLFrameHelper.getSelectionControl(\"view\", opts, false,newView);\r\n\tthis.selector = sel;\r\n\tvd.appendChild(sel);\r\n\treturn vd;\r\n}\r\n\r\n\r\n\r\n\r\n/*\r\ndescr: Show results editor on click of Add View\r\nparams: query object, query snippet\r\nQueryPane.prototype.showRuleEditor = function(woql, vd, qSnippet){\r\nvar cancel = document.createElement('icon');\r\n//cancel.appendChild(document.createTextNode('cancel'));\r\ncancel.setAttribute('class', 'fa fa-times terminus-pointer terminus-cancel-rule-editor');\r\nvd.appendChild(cancel);\r\nvar rSnippet = this.thv.getEditor(1350, 250, 'Enter Rules ...');\r\n//var rEditor = document.createElement('div');\r\nvd.setAttribute('class', 'terminus-rule-editor');\r\n//vd.setAttribute('style', 'border: 1px solid orange');\r\nthis.qpane.addRuleDom = rSnippet.actionButton;\r\nvd.appendChild(UTILS.getHeaderDom('Rule Editor:'));\r\nvd.appendChild(rSnippet.dom);\r\nqSnippet.dom.appendChild(vd);\r\nvar self = this;\r\ncancel.addEventListener('click', function(){\r\n    TerminusClient.FrameHelper.removeChildren(vd);\r\n    self.addView(woql, qSnippet);\r\n})\r\nthis.qpane.addRuleDom.addEventListener('click', function(){\r\n    try{\r\n        self.submitView(woql, qSnippet, rSnippet);\r\n        self.hideAddViewEditor(vd);\r\n    }\r\n    catch(e){\r\n        self.ui.showError('Error in rule editor: ' + e);\r\n    }\r\n})\r\nreturn rSnippet;\r\n}\r\n*/\r\n\r\n\r\n/*\r\n\r\nQueryPane.prototype.getWOQLEditor = function(){\r\n    var tcs = new TerminusCodeSnippet(\"woql\", \"edit\");\r\n\tvar snippet = tcs.getAsDOM();\r\n\tvar dimensions = {};\r\n\tdimensions.width = width;\r\n\tdimensions.height = height;\r\n\tUTILS.stylizeEditor(this.ui, snippet.snippetText, dimensions, 'javascript');\r\n\treturn snippet;\r\n}\r\n\r\nQueryPane.prototype.showConfigEditor = function(result, config, span){\r\n    var cSnippet = this.getEditor(300, 250,\r\n                        JSON.stringify(config, undefined, 2));\r\n    var self = this;\r\n    cSnippet.actionButton.addEventListener('click', function(){\r\n        try{\r\n            //self.submitConfigRules(woql, cSnippet, qSnippet, rSnippet);\r\n\t\t\tvar cObj = UTILS.getqObjFromInput(cSnippet.snippetText.value);\r\n\t\t\tTerminusClient.FrameHelper.removeChildren(span);\r\n\t\t\tspan.appendChild(self.showResult(result, cObj));\r\n        }\r\n        catch(e){\r\n            //self.ui.showError('Error in config editor: ' + e);\r\n\t\t\tconsole.log('Error in config editor: ' + e);\r\n        }\r\n    })\r\n    return cSnippet;\r\n}\r\n\r\nQueryPane.prototype.submitConfig = function(result, config, span, cdom){\r\n\tvar cSnippet = this.showConfigEditor(result, config, span);\r\n\tcdom.appendChild(cSnippet.dom);\r\n}\r\n\r\nQueryPane.prototype.showConfig = function(result, config, span, cdom){\r\n\tvar cbtn = document.createElement('button');\r\n    //cbtn.setAttribute('style', 'margin-top: 10px;');\r\n    cbtn.setAttribute('class', 'terminus-btn terminus-query-config-btn');\r\n    cbtn.appendChild(document.createTextNode('Config'));\r\n    //rSnippet.dom.appendChild(cbtn);\r\n    //qSnippet.dom.appendChild(cbtn);\r\n    var self = this;\r\n    cbtn.addEventListener('click', function(){\r\n\t\tTerminusClient.FrameHelper.removeChildren(cdom);\r\n        self.submitConfig(result, config, span, cdom);\r\n    })\r\n    return cbtn;\r\n}\r\n\r\n\r\n/*QueryPane.prototype.addResultViewerOLD = function(label, rule, ruleviewer){\r\n\tlet rv = new ResultViewer(rule);\r\n\tif(ruleviewer) rv.setRuleViewer(ruleviewer);\r\n\tthis.result_viewers[label] = rv;\r\n\treturn this;\r\n}\r\n\r\nQueryPane.prototype.addResultViewer = function(rule){\r\n\talert(\"rule \" + JSON.stringify(rule));\r\n\tthis.result_viewers.push(rule);\r\n\treturn this;\r\n}\r\n\r\n\r\n\r\nQueryPane.prototype.addLibrary = function(lib){\r\n\tthis.libraries.push(lib);\r\n\treturn this;\r\n}\r\n\r\nQueryPane.prototype.render = function(lib){\r\n\tvar qps = document.createElement(\"span\");\r\n\tfor(var i = 0; i<this.query_viewers.length; i++){\r\n\t\tvar qv = this.query_viewers[i];\r\n\t\tif(qv){\r\n\t\t\tlet v = qv.render();\r\n\t\t\tif(v) qps.appendChild(v);\r\n\t\t}\r\n\t}\r\n\r\n\tfor(var k in this.result_viewers){\r\n\t\tvar rv = this.result_viewers[k];\r\n\t\tif(rv){\r\n\t\t\tvar x = rv.render();\r\n\t\t\tif(x) qps.appendChild(x);\r\n\t\t}\r\n\t}\r\n\treturn qps;\r\n}\r\n\r\nfunction ResultViewer(rule){\r\n\tthis.rules = [];\r\n\tif(rule) this.rules.push(rule);\r\n}\r\n\r\nResultViewer.prototype.render = function(){\r\n\talert(\"rv\");\r\n\tvar span = document.createElement(\"span\");\r\n\tif(this.ruleviewer){\r\n\t\tlet r = this.ruleviewer.render();\r\n\t\tif(r) span.appendChild(r);\r\n\t}\r\n\treturn span;\r\n}\r\n\r\nResultViewer.prototype.setRuleViewer = function(rv){\r\n\tthis.ruleviewer = rv;\r\n}\r\n\r\n*/\r\n\r\nmodule.exports = QueryPane;\r\n","const HTMLFrameHelper = require('../HTMLFrameHelper');\r\n\r\nfunction HTMLStringViewer(options){\r\n\tthis.size = ((options && options.size) ? options.size : false);\r\n\tthis.css = ((options && options.css) ? \"terminus-literal-value \" + options.css : \"terminus-literal-value\");\r\n\tthis.max_word_size = (options && options.max_word_size ? options.max_word_size : false);\r\n\tthis.max_cell_size = (options && options.max_cell_size ? options.max_cell_size : false);\r\n\tthis.show_types = (options && options.show_types ? options.show_types : false);\r\n}\r\n\r\nHTMLStringViewer.prototype.renderFrame = function(frame, dataviewer){\r\n\tvar value = frame.get();\r\n\treturn this.render(value);\r\n}\r\n\r\nHTMLStringViewer.prototype.renderValue = function(dataviewer){\r\n\treturn this.render(dataviewer.value());\r\n}\r\n\r\nHTMLStringViewer.prototype.render = function(value){\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', this.css);\r\n\tinput.setAttribute('data-value', value);\r\n\tif(this.show_types && this.type != \"id\"){\r\n\t\tvalue += \" (\" + this.type + \")\";\r\n\t}\r\n\tif(this.max_word_size || this.max_cell_size){\r\n\t\tHTMLFrameHelper.wrapShortenedText(input, value, this.max_cell_size, this.max_word_size);\r\n\t}\r\n\telse {\r\n\t\tvalue = document.createTextNode(value);\r\n\t\tinput.appendChild(value);\r\n\t}\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={HTMLStringViewer}\r\n\r\n\r\n","function HTMLDateHelper(){\r\n\tthis.months = [\"January\", \"Februrary\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"];\r\n}\r\n\r\nHTMLDateHelper.prototype.getMonthName = function(num){\r\n\treturn this.months[num-1];\r\n}\r\n\r\nmodule.exports={HTMLDateHelper}","function GoogleMapHelper(options){\r\n\tthis.polygon = false;\r\n\tthis.polyline = false;\r\n\tthis.markers = [];\r\n\tthis.init(options);\r\n}\r\n\r\nGoogleMapHelper.prototype.init = function(config){\r\n\tthis.type = ((config && config.type) ? config.type: 'Shape'); \r\n\tthis.width = ((config && config.width) ? config.width : '400px'); \r\n\tthis.height = ((config && config.height ) ? config.height : '400px'); \r\n\tthis.mapLat = ((config && config.mapLat) ? config.mapLat : '41.9010004'); \r\n\tthis.mapLong = ((config && config.mapLong ) ? config.mapLong : '12.500061500000015');\r\n\tthis.zoom = ((config && config.zoom) ? config.zoom : 3);\r\n\tthis.stroke = ((config && config.stroke) ? config.stroke : { color: '#FF0000', opacity: 0.3, weight: 3});\r\n\tthis.fill = ((config && config.fill) ? config.fill : { color: '#FF0000', opacity: 0.1});\r\n\tthis.line = ((config && config.line) ? config.line : { color: '#000000', opacity: 0.9, weight: 3});\r\n}\r\n\r\nGoogleMapHelper.prototype.destroy = function(){\r\n    this.clear();\r\n} \r\n\r\nGoogleMapHelper.prototype.translatePolygonToArray = function(polygon){\r\n   var data = \"[\";\r\n   var vertices = polygon.getPath();\r\n   var seenValue = false;\r\n   for (var j=0; j<vertices.getLength(); j++){\r\n       if(seenValue){\r\n           data = data + \",\";\r\n       }\r\n       var xy = vertices.getAt(j);\r\n       data = data + \"[\" + xy.lat() + \",\" + xy.lng() + \"]\"\r\n       seenValue = true;\r\n   }\r\n   data = data + \"]\";\r\n   return data;\r\n};\r\n\r\nGoogleMapHelper.prototype.translateArrayToPolygon = function(array){\r\n   var jsonified = JSON.parse(array);\r\n   var output = [];\r\n   for(var i=0;i<jsonified.length;i++){\r\n       var latlong = {}\r\n       latlong.lat = jsonified[i][0];\r\n       latlong.lng = jsonified[i][1];\r\n       output.push(latlong);\r\n   }\r\n   return output;\r\n}\r\n\r\nGoogleMapHelper.prototype.createPolygon = function(coords, map) {\r\n\tvar polygon = new google.maps.Polygon({\r\n        paths: coords,\r\n        strokeColor: this.stroke.color,\r\n        strokeOpacity: this.stroke.opacity,\r\n        strokeWeight: this.stroke.weight,\r\n        fillColor: this.fill.color,\r\n        fillOpacity: this.fill.opacity\r\n\t});\r\n    polygon.setMap(map);\r\n\treturn polygon;\r\n}\r\n\r\nGoogleMapHelper.prototype.createPolyline = function(coords){\r\n\tvar init = {\r\n\t      strokeColor: this.line.color,\r\n\t      strokeOpacity: this.line.opacity,\r\n\t      strokeWeight: this.line.weight\r\n\t};\r\n\tif(coords){\r\n\t\tinit.paths = coords;\r\n\t}\r\n\tvar poly = new google.maps.Polyline(init);\r\n\treturn poly;\r\n}\r\n\r\nGoogleMapHelper.prototype.clearMarkers = function() {\r\n\tfor (var i = 0; i < this.markers.length; i++ ) {\r\n\t\tthis.markers[i].setMap(null);\r\n\t}\r\n\tthis.markers.length = 0;\r\n}\r\n\r\n\r\nGoogleMapHelper.prototype.addMarker = function(position, map, frame, title, ty) {\r\n\tvar init = {\r\n\t\tposition: position, \r\n\t\tmap: map\r\n\t}\r\n\tif(title){\r\n\t\tinit.title = title;\r\n\t}\r\n\tvar marker = new google.maps.Marker(init);\r\n\tvar self = this;\r\n\tif(this.markers.length == 0 && ty == \"xdd:coordinatePolygon\"){\r\n     \tmarker.addListener('click', function() {\r\n\t\t\tvar coords = self.getCoordsFromMarkers();\r\n    \t\tself.polygon = self.createPolygon(coords, map);\r\n            self.clearMarkers();\r\n            self.polyline.setMap(null);\r\n            frame.set(self.translatePolygonToArray(self.polygon));\r\n        });                \t\r\n    }\r\n\tthis.markers.push(marker);\r\n\tif(ty == \"xdd:coordinatePolyline\"){\r\n\t\tvar x = this.translatePolygonToArray(this.polyline);\r\n\t\tframe.set(x);\r\n\t}\r\n\treturn marker;\r\n}\r\n\r\nGoogleMapHelper.prototype.getCoordsFromMarkers = function(){\r\n\treturn this.polyline.getPath();\r\n}\r\n\r\nGoogleMapHelper.prototype.clear = function(){\r\n\tif(this.polygon) {\r\n\t\tthis.polygon.setMap(null);\r\n\t\tthis.polygon = false;\r\n\t}\r\n\tif(this.polyline) {\r\n\t\tthis.clearMarkers();\r\n\t\tthis.polyline.setMap(null);\r\n\t}\r\n}\r\n\r\nGoogleMapHelper.prototype.initMap = function(mapContainer, value, type){\r\n\tmapContainer.style.width = this.width;\r\n\tmapContainer.style.height = this.height;\r\n\tif(typeof google == \"undefined\"){\r\n\t\talert(\"google is not effing loaded\");\r\n\t\treturn false;\r\n\t}\r\n\tvar map = new google.maps.Map(mapContainer, {\r\n\t    zoom: this.zoom,\r\n\t\tcenter: {lat: parseFloat(this.mapLat), lng: parseFloat(this.mapLong)}  \r\n\t});\r\n\tif(type == \"xdd:coordinatePolygon\"){\r\n\t    this.polyline = this.createPolyline();\r\n\t\tthis.polyline.setMap(map);\r\n\t\tvar coords = (value ? this.translateArrayToPolygon(value) : []);\r\n\t\tif(value){\r\n\t    \tthis.polygon = this.createPolygon(coords, map);\r\n\t    }\r\n\t}\r\n\telse if(type == \"xdd:coordinatePolyline\"){\r\n\t\tvar coords = (value ? this.translateArrayToPolygon(value) : []);\r\n\t    this.polyline = this.createPolyline();\r\n\t\tthis.polyline.setMap(map);\t\t\r\n\t\tif(value){\r\n\t    \tthis.polyline.setPath(coords);\r\n\t    }\r\n\t}\t\r\n\telse if(type == \"xdd:coordinate\"){\r\n\t\tif(value){\r\n\t\t\tthis.clearMarkers();\r\n            var lat = parseFloat(value.substring(1, value.indexOf(\",\")));\r\n\t\t\tvar long = parseFloat(value.substring(value.indexOf(\",\")+1, value.length-1));\r\n            var init = {\r\n            \tposition: {lat: lat, lng: long},\r\n        \t\tmap: map\r\n\t        }\r\n\t        var marker = new google.maps.Marker(init);\r\n\t        this.markers.push(marker);\r\n\t\t}\r\n\t}\r\n    google.maps.event.trigger(map, 'resize');\r\n    return map;\r\n}\r\n\r\nmodule.exports=GoogleMapHelper;","const TerminusClient = require('@terminusdb/terminus-client');\r\n\r\n\r\nfunction SimpleTable(){\r\n\tthis.holder = document.createElement(\"div\");\r\n}\r\n\r\nSimpleTable.prototype.options = function(options){\r\n\tfor(var k in options){\r\n\t\tthis[k] = options[k];\r\n\t}\r\n\treturn this;\r\n}\r\n\r\n\r\nSimpleTable.prototype.render = function(woqltable){\r\n\tif(woqltable) this.woqltable = woqltable;\r\n\tTerminusClient.FrameHelper.removeChildren(this.holder);\r\n\tvar ctls = this.getControlsDOM();\r\n\tvar tab = this.getTableDOM();\r\n\tif(ctls) this.holder.appendChild(ctls)\r\n\tthis.holder.appendChild(tab);\r\n\treturn this.holder;\r\n}\r\n\r\nSimpleTable.prototype.getControlsDOM = function(result){\r\n\tvar ctrls = document.createElement(\"span\");\r\n\tif(this.woqltable.config.pager()){\r\n\t\tvar paging = this.getPaging(result);\r\n\t\tif(paging) ctrls.appendChild(paging);\r\n\t}\r\n\treturn ctrls;\r\n}\r\n\r\nSimpleTable.prototype.getTableDOM = function(){\r\n\tconst columns = this.woqltable.getColumnsToRender();\r\n\tvar tab = document.createElement(\"table\");\r\n\ttab.setAttribute(\"class\", \"terminus-hover-table terminus-simple-table\");\r\n\tvar thead = this.getTableHeader(columns);\r\n\ttab.appendChild(thead);\r\n\tvar tbody = this.getTableBody(columns);\r\n\ttab.appendChild(tbody);\r\n\treturn tab;\r\n}\r\n\r\nSimpleTable.prototype.getTableHeader = function(cols){\r\n\tvar thead = document.createElement(\"thead\");\r\n\tvar thr = document.createElement(\"tr\");\r\n\tfor(var i = 0; i<cols.length; i++){\r\n\t\tvar th = this.getColumnHeader(cols[i]);\r\n\t\tthr.appendChild(th);\r\n\t}\r\n\tthead.appendChild(thr);\r\n\treturn thead;\r\n}\r\n\r\nSimpleTable.prototype.getColumnHeader = function(colid){\r\n\tvar th = document.createElement(\"th\");\r\n\tth.setAttribute('class', 'terminus-table-header-full-css');\r\n\tvar clab = this.woqltable.getColumnHeaderContents(colid);\r\n\tth.appendChild(clab);\r\n\treturn th;\r\n}\r\n\r\nSimpleTable.prototype.getTableBody = function(cols){\r\n\tvar tbody = document.createElement(\"tbody\");\r\n\twhile(row = this.woqltable.next()){\r\n\t\tvar tr = this.getHTMLRow(row, cols);\r\n\t\tif(tr) tbody.appendChild(tr);\r\n\t}\r\n\treturn tbody;\r\n}\r\n\r\nSimpleTable.prototype.getHTMLRow = function(row, cols){\r\n\tvar tr = document.createElement(\"tr\");\r\n\tfor(var i = 0; i<cols.length; i++){\r\n\t\tvar td = this.getCell(cols[i], row);\r\n\t\ttr.appendChild(td);\r\n\t}\r\n\tvar self = this;\r\n\tif(this.woqltable.hasRowClick(row)){\r\n\t\tvar rc = this.woqltable.getRowClick(row);\r\n\t\ttr.addEventListener(\"click\", function(){\r\n\t\t\trc(row);\r\n\t\t});\r\n\t\ttr.addEventListener(\"mouseover\", function(){\r\n\t\t\tthis.style.cursor = \"pointer\";\r\n\t\t});\r\n\t}\r\n\tif(this.woqltable.hasRowHover(row)){\r\n\t\tvar rc = this.woqltable.getRowHover(row);\r\n\t\ttr.addEventListener(\"mouseover\", function(){\r\n\t\t\trc(row);\r\n\t\t});\r\n\t}\r\n\treturn tr;\r\n}\r\n\r\nSimpleTable.prototype.getCell = function(key, row){\r\n\tvar td = document.createElement(\"td\");\r\n\tif(this.woqltable.hasCellClick(row, key)){\r\n\t\tvar rc = this.woqltable.getCellClick(row, key);\r\n\t\ttd.addEventListener(\"click\", function(){\r\n\t\t\trc(row);\r\n\t\t});\r\n\t\ttd.addEventListener(\"mouseover\", function(){\r\n\t\t\tthis.style.cursor = \"pointer\";\r\n\t\t});\r\n\t}\r\n\tif(this.woqltable.hasCellHover(row, key)){\r\n\t\tvar rc = this.woqltable.getCellHover(row, key);\r\n\t\ttr.addEventListener(\"mouseover\", function(){\r\n\t\t\trc(row);\r\n\t\t});\r\n\t}\r\n\tvar c = this.getCellData(key, row);\r\n\tif(c) td.appendChild(c);\r\n\treturn td;\r\n}\r\n\r\nSimpleTable.prototype.getCellData = function(key, row){\r\n\tvar renderer = this.woqltable.getRenderer(key, row);\r\n\tif(renderer && typeof renderer == \"function\"){\r\n\t\treturn renderer(row[key], key, row);\r\n\t}\r\n\telse if(renderer && typeof renderer == \"object\"){\r\n\t\treturn this.woqltable.renderValue(renderer, row[key], key, row);\r\n\t}\r\n\tvar val = row[key]\r\n\tif(val && val['@value']) val = val['@value'];\r\n\treturn document.createTextNode(val);\r\n}\r\n\r\nSimpleTable.prototype.getPaging = function(){\r\n\tif(this.woqltable.result.query.isPaged()){\r\n\t\tvar pdom = document.createElement(\"div\");\r\n\t\tpdom.setAttribute(\"class\", \"table-page-size\");\r\n\t\tif(this.woqltable.config.pagesize()) pdom.appendChild(this.getPageSize());\r\n\t\tif(this.woqltable.canChangePage()){\r\n\t\t\tvar pn = this.woqltable.result.query.getPage();\r\n\t\t\tif(pn > 2){\r\n\t\t\t\tpdom.appendChild(this.getFirst());\r\n\t\t\t}\r\n\t\t\tif(pn > 1){\r\n\t\t\t\tpdom.appendChild(this.getPrev(pn));\r\n\t\t\t}\r\n\t\t\tif(this.woqltable.config.page()) pdom.appendChild(this.getPageNumber(pn));\r\n\t\t\tpdom.appendChild(this.getNext(this.woqltable.result));\r\n\t\t}\r\n\t\treturn pdom;\r\n\t}\r\n}\r\n\r\nSimpleTable.prototype.getPageSize = function(){\r\n\tvar chunk = document.createElement(\"span\");\r\n\tchunk.setAttribute(\"class\", \"woql-table-pagesize\");\r\n\tclabel = document.createElement(\"span\");\r\n\tclabel.appendChild(document.createTextNode(\"Page Size\"));\r\n\tchunk.appendChild(clabel);\r\n\tif(this.woqltable.config.change_pagesize){\r\n\t\tvar ctl = document.createElement(\"input\");\r\n\t\tctl.setAttribute(\"size\", 6);\r\n\t\tvar self = this;\r\n\t\tctl.value = this.woqltable.getPageSize();\r\n\t\tctl.addEventListener(\"blur\", function(){\r\n\t\t\tvar pval = (this.value ? parseInt(this.value) : false);\r\n\t\t\tself.woqltable.setPageSize(pval);\r\n\t\t});\r\n\t\tchunk.appendChild(ctl);\r\n\t}\r\n\telse {\r\n\t\tchunk.appendChild(document.createTextNode(this.woqltable.getPageSize()));\r\n\t}\r\n\treturn chunk;\r\n}\r\n\r\nSimpleTable.prototype.getPageNumber = function(){\r\n\tvar ctl = document.createElement(\"input\");\r\n\tctl.setAttribute(\"size\", 4);\r\n\tctl.value = this.woqltable.result.query.getPage();\r\n\tvar self = this;\r\n\tctl.addEventListener(\"blur\", function(){\r\n\t\tvar pval = (this.value ? parseInt(this.value) : false);\r\n\t\tself.woqltable.setPage(pval);\r\n\t});\r\n\treturn ctl;\r\n}\r\n\r\nSimpleTable.prototype.getNext = function(result){\r\n\tvar ctl = document.createElement(\"button\");\r\n\tvar self = this;\r\n\tctl.appendChild(document.createTextNode(\"next\"));\r\n\tif(!this.woqltable.canAdvancePage(result)){\r\n\t\tctl.setAttribute(\"disabled\", \"disabled\");\r\n\t}\r\n\telse {\r\n\t\tctl.addEventListener(\"click\", function(){\r\n\t\t\tself.woqltable.nextPage();\r\n\t\t});\r\n\t}\r\n\treturn ctl;\r\n}\r\n\r\nSimpleTable.prototype.getPrev = function(result){\r\n\tvar ctl = document.createElement(\"button\");\r\n\tctl.appendChild(document.createTextNode(\"previous\"));\r\n\tvar self = this;\r\n\tif(!this.woqltable.canRetreatPage(result)){\r\n\t\tctl.setAttribute(\"disabled\", \"disabled\");\r\n\t}\r\n\telse {\r\n\t\tctl.addEventListener(\"click\", function(){\r\n\t\t\tself.woqltable.previousPage();\r\n\t\t});\r\n\t}\r\n\treturn ctl;\r\n}\r\n\r\nSimpleTable.prototype.getFirst = function(result){\r\n\tvar ctl = document.createElement(\"button\");\r\n\tctl.appendChild(document.createTextNode(\"first\"));\r\n\tvar self = this;\r\n\tif(!this.woqltable.canRetreatPage(result) || this.woqltable.getPage() <= 2){\r\n\t\tctl.setAttribute(\"disabled\", \"disabled\");\r\n\t}\r\n\telse {\r\n\t\tctl.addEventListener(\"click\", function(){\r\n\t\t\tself.woqltable.firstPage();\r\n\t\t});\r\n\t}\r\n\treturn ctl;\r\n}\r\n\r\nmodule.exports = SimpleTable;\r\n","const TerminusClient = require('@terminusdb/terminus-client');\r\nconst GraphResultsViewer = require('./GraphResultsViewer');\r\n\r\n\r\nfunction SimpleGraph(){\r\n\tthis.holder = document.createElement(\"div\");\r\n}\r\n\r\nSimpleGraph.prototype.setResult = function(result){\r\n\tthis.result = result;\r\n}\r\n\r\nSimpleGraph.prototype.render = function(wgraph){\r\n\tthis.graph = wgraph;\r\n\tTerminusClient.FrameHelper.removeChildren(this.holder);\r\n\t//var ctls = this.getControlsDOM(result);\r\n\tvar tab = this.getGraphDOM(this.result);\r\n\t//if(ctls) this.holder.appendChild(ctls)\r\n\tthis.holder.appendChild(tab);\r\n\treturn this.holder;\r\n}\r\n\r\n\r\nSimpleGraph.prototype.getGraphDOM = function(){\r\n\tthis.gviz = new GraphResultsViewer(this.graph.config);\r\n\tvar gdom = this.gviz.getAsDOM();\r\n\tvar h = this.graph.config.height() ? this.graph.config.height() : 800;\r\n\tvar w = this.graph.config.width() ? this.graph.config.width() : 800;\r\n\tgdom.setAttribute(\"style\", \"border: 1px solid #aaa; width: \" + w + \"px; height: \" + h + \"px; \" + this.graph.config.width() + \"px\");\r\n\tthis.gviz.setData(this.graph);\r\n\tthis.gviz.initDOM(gdom);\r\n\treturn gdom;\r\n}\r\n\r\nmodule.exports = SimpleGraph;\r\n","const TerminusClient = require('@terminusdb/terminus-client');\r\n\r\n\r\nfunction SimpleStream(){\t\r\n\tthis.holder = document.createElement(\"div\");\r\n}\r\n\r\nSimpleStream.prototype.options = function(options){\r\n\tfor(var k in options){\r\n\t\tthis[k] = options[k];\r\n\t}\r\n\treturn this;\r\n}\r\n\r\n\r\nSimpleStream.prototype.render = function(stream){\r\n\tif(stream) this.stream = stream;\r\n\tTerminusClient.FrameHelper.removeChildren(this.holder);\r\n\t//var ctls = this.getControlsDOM();\r\n\t//var tab = this.getTableDOM();\r\n\t//if(ctls) this.holder.appendChild(ctls)\r\n\t//this.holder.appendChild(tab);\r\n\treturn this.holder;\r\n}\r\n\r\nmodule.exports = SimpleStream;","function SimpleChooser(){}\r\n\r\nSimpleChooser.prototype.options = function(options){\r\n\tthis.options = options;\r\n\treturn this;\r\n}\r\n\r\nSimpleChooser.prototype.render = function(chooser){\r\n\tif(chooser) this.chooser = chooser;\r\n\tif(this.chooser.config.show_empty() == false && this.chooser.count() < 1) return false;\r\n\tvar ccdom = document.createElement(\"span\");\r\n\tccdom.setAttribute(\"class\", \"woql-chooser\");\r\n\tvar ccsel = document.createElement(\"select\");\r\n\tccsel.setAttribute(\"class\", \" woql-chooser\");\r\n\tvar self = this;\r\n\tccsel.addEventListener(\"change\", function(){\r\n\t\tself.chooser.set(this.value);\r\n\t});\r\n\tvar opts = [];\r\n\tif(this.chooser.config.show_empty()){\r\n\t\topts.push(this.getEmptyOption())\r\n\t}\r\n\twhile(choice = this.chooser.next()){\r\n\t\tvar opt = this.createOptionFromChoice(choice);\r\n\t\topts.push(opt);\r\n\t}\r\n\tfor(var i = 0; i<opts.length; i++){\r\n\t\tccsel.appendChild(opts[i]);\r\n\t}\r\n\tccdom.appendChild(ccsel);\r\n\treturn ccdom;\r\n}\r\n\r\nSimpleChooser.prototype.getEmptyOption = function(){\r\n\tvar choice = { id: \"\", label: this.chooser.config.show_empty()};\r\n\treturn this.createOptionFromChoice(choice);\r\n}\r\n\r\nSimpleChooser.prototype.createOptionFromChoice = function(choice){\r\n\tvar opt = document.createElement(\"option\");\r\n\topt.setAttribute(\"class\", \"terminus-woql-chooser-choice\");\r\n\topt.value = choice.id;\r\n\tif(choice.selected) opt.selected = true;\r\n\tif(typeof choice.label == \"string\"){\r\n\t\topt.appendChild(document.createTextNode(choice.label));\r\n\t}\r\n\telse if(choice.label){\r\n\t\topt.appendChild(choice.label);\r\n\t}\r\n\tif(choice.title){\r\n\t\topt.setAttribute(\"title\", choice.title);\r\n\t}\r\n\treturn opt;\r\n}\r\n\r\nmodule.exports = SimpleChooser;","const TerminusClient = require('@terminusdb/terminus-client');\r\nconst TerminusCodeSnippet = require('./query/TerminusCodeSnippet');\r\nconst UTILS = require('../Utils');\r\nconst HTMLFrameHelper = require('./HTMLFrameHelper');\r\nconst TerminusFrame = require(\"../viewer/TerminusFrame\");\r\nconst Datatypes = require(\"./Datatypes\");\r\nconst SimpleFrameViewer = require(\"./document/SimpleFrameViewer\");\r\n\r\n\r\nfunction DocumentPane(client){\r\n\tthis.client = client;\r\n\tthis.container = document.createElement('span');\r\n    this.container.setAttribute('class', 'terminus-document-cont');\r\n}\r\n\r\nDocumentPane.prototype.loadDocument = function(docid, config){\r\n\tthis.docid = docid;\r\n\tthis.clsid = false;\r\n\tthis.view = config;\r\n\tthis.frame = new TerminusFrame(this.client).options(this.view);\r\n\tthis.frame.owner = this;\r\n\tthis.frame.setDatatypes(Datatypes.initialiseDataRenderers);\r\n\treturn this.frame.loadDocument(docid);\r\n}\r\n\r\nDocumentPane.prototype.loadClass = function(cls, config){\r\n\tthis.clsid = cls;\r\n\tthis.docid = false;\r\n\tthis.view = config;\r\n\tthis.frame = new TerminusFrame(this.client).options(this.view);\r\n\tthis.frame.owner = this;\r\n\tthis.frame.setDatatypes(Datatypes.initialiseDataRenderers);\r\n\treturn this.frame.loadDocumentSchema(cls).then(() => this.frame.document.fillFromSchema(\"_:\"));\r\n}\r\n\r\n\r\n\r\nDocumentPane.prototype.setClassLoader = function(cloader){\r\n\tthis.classLoader = cloader;\r\n\tif(this.queryPane){\r\n\t\tthis.queryPane.appendChild(this.classLoader);\r\n\t}\r\n\treturn this;\r\n}\r\n\r\nDocumentPane.prototype.options = function(opts){\r\n\tthis.showQuery = (opts && typeof opts.showQuery != \"undefined\" ? opts.showQuery : false);\r\n\tthis.showConfig = (opts && typeof opts.showConfig != \"undefined\" ? opts.showConfig : false);\r\n\tthis.editConfig = (opts && typeof opts.editConfig != \"undefined\" ? opts.editConfig : false);\r\n\tthis.intro = (opts && typeof opts.intro != \"undefined\" ? opts.intro : false);\r\n\tthis.defaultResultView = { showConfig: false, editConfig: false };\r\n\tthis.documentLoader = (opts && typeof opts.loadDocument != \"undefined\" ? opts.loadDocument : false);\r\n    return this;\r\n}\r\n\r\nDocumentPane.prototype.getQueryPane = function(){\r\n\tvar pane = document.createElement(\"div\");\r\n\tpane.setAttribute(\"class\", \"terminus-document-query\");\r\n\tif(this.documentLoader){\r\n\t\tpane.appendChild(this.documentLoader);\r\n\t}\r\n\tif(this.classLoader){\r\n\t\tpane.appendChild(this.classLoader);\r\n\t}\r\n\treturn pane;\r\n}\r\n\r\nDocumentPane.prototype.getAsDOM = function(){\r\n\tif(this.intro){\r\n\t\tthis.container.appendChild(UTILS.getHeaderDom(this.intro));\r\n\t}\r\n\tvar configspan = document.createElement(\"span\");\r\n\tconfigspan.setAttribute(\"class\", \"pane-config-icons\");\r\n\tthis.container.appendChild(configspan);\r\n\tif(this.showQuery && (this.documentLoader || this.classLoader)){\r\n\t\tvar ipdom = this.getQueryPane();\r\n\t\tvar ispan = document.createElement(\"span\");\r\n\t\tispan.setAttribute(\"class\", \"document-pane-config\");\r\n\t\tvar ic = document.createElement(\"i\");\r\n\t\tispan.appendChild(ic);\r\n\t\tconfigspan.appendChild(ispan);\r\n\t\tvar self = this;\r\n\t\tfunction showQueryConfig(){\r\n\t\t\tispan.title=\"Click to Hide Query\";\r\n\t\t\tic.setAttribute(\"class\", \"fas fa fa-times-circle\");\r\n\t\t\tif(configspan.nextSibling) self.container.insertBefore(ipdom, configspan.nextSibling);\r\n\t\t\telse self.container.appendChild(ipdom);\r\n\t\t}\r\n\t\tfunction hideQueryConfig(){\r\n\t\t\tispan.title=\"Click to View Query\";\r\n            ic.setAttribute(\"class\", \"fas fa fa-search\");\r\n\t\t\tself.container.removeChild(ipdom);\r\n\t\t}\r\n\t\tispan.addEventListener(\"click\", () => {\r\n\t\t\tif(this.showingQuery) hideQueryConfig();\r\n\t\t\telse showQueryConfig();\r\n\t\t\tthis.showingQuery = !this.showingQuery;\r\n\t\t});\r\n\t\tshowQueryConfig();\r\n\t\tif(this.showQuery == \"icon\") hideQueryConfig();\r\n\t\tthis.queryPane = ipdom;\r\n\t}\r\n\tif(this.showConfig){\r\n        this.showingConfig = (this.showConfig != \"icon\");\r\n\t\tvar mode = (this.editConfig ? \"edit\" : \"view\");\r\n\t\tthis.input = this.createInput(mode);\r\n\t\tvar ndom = this.input.getAsDOM();\r\n        var nspan = document.createElement(\"span\");\r\n        nspan.addEventListener('mouseover', function(){\r\n            this.style.cursor = \"pointer\";\r\n\t\t});\r\n\t\tnspan.setAttribute(\"class\", \"result-pane-config\");\r\n\t\tvar nc = document.createElement(\"i\");\r\n\t\tnspan.appendChild(nc);\r\n\t\tconfigspan.appendChild(nspan);\r\n\t\tvar self = this;\r\n\t\tfunction showDocConfig(){\r\n\t\t\tnspan.title=\"Click to Hide View Configuration\";\r\n\t\t\tnc.setAttribute(\"class\", \"fas fa fa-times-circle\");\r\n\t\t\tif(configspan.nextSibling) self.container.insertBefore(ndom, configspan.nextSibling);\r\n\t\t\telse self.container.appendChild(ndom);\r\n\t\t\t//stylize only after ta or pre have been appended\r\n\t\t\tif((self.input.snippet.value) || (self.input.snippet.innerHTML))\r\n\t\t\t\tself.input.stylizeSnippet();\r\n\t\t}\r\n\t\tfunction hideDocConfig(){\r\n\t\t\tnspan.title=\"Click to View Configuration\";\r\n            nc.setAttribute(\"class\", \"fas fa fa-vial\");\r\n\t\t\tself.container.removeChild(ndom);\r\n\t\t}\r\n\t\tnspan.addEventListener(\"click\", () => {\r\n\t\t\tif(this.showingConfig) hideDocConfig();\r\n\t\t\telse showDocConfig();\r\n\t\t\tthis.showingConfig = !this.showingConfig;\r\n        });\r\n        showDocConfig();\r\n\t\tif(this.showConfig == \"icon\") hideDocConfig();\r\n    }\r\n\tthis.resultDOM = document.createElement(\"span\");\r\n\tthis.resultDOM.setAttribute(\"class\", \"terminus-document-results\");\r\n\t//var form = (this.input.format == \"js\" ? \"javascript\" : \"json\");\r\n\t//UTILS.stylizeEditor(ui, this.input.snippet, {width: this.input.width, height: this.input.height}, form);\r\n\tthis.container.appendChild(this.resultDOM);\r\n\tthis.renderResult();\r\n\treturn this.container;\r\n}\r\n\r\nDocumentPane.prototype.renderResult = function(){\r\n\tTerminusClient.FrameHelper.removeChildren(this.resultDOM);\r\n\tif(this.frame && this.frame.render){\r\n\t\tvar fpt = this.frame.render();\r\n\t\tif(fpt){\r\n\t\t\tthis.resultDOM.appendChild(fpt);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nDocumentPane.prototype.loadRenderer = function(rendname, frame, args, termframe){\r\n\tvar evalstr = \"new \" + rendname + \"(\";\r\n\tif(args) evalstr += JSON.stringify(args);\r\n\tevalstr += \");\";\r\n\ttry {\r\n\t\tvar nr = eval(evalstr);\r\n\t\tnr.terminus = termframe;\r\n\t\treturn nr;\r\n\t}\r\n\tcatch(e){\r\n\t\tconsole.log(\"Failed to load \" + rendname + e.toString());\r\n\t\treturn false;\r\n\t}\r\n}\r\n\r\n\r\nDocumentPane.prototype.createInput = function(mode){\r\n    let input = new TerminusCodeSnippet(\"rule\", mode);\r\n    if(this.view){\r\n    \tinput.setQuery(this.view);\r\n\t}\r\n\tvar self = this;\r\n\tinput.submit = function(qObj){\r\n\t\tself.updateView(qObj);\r\n\t};\r\n\treturn input;\r\n}\r\n\r\nDocumentPane.prototype.updateView = function(docview){\r\n\tthis.view = docview;\r\n\tthis.frame.options(this.view);\r\n\tif(this.input) this.input.setQuery(this.view);\r\n\tthis.frame.applyRulesToDocument(this.frame.document, this.frame.config);\r\n\tthis.frame.renderer = this.frame.document;\r\n\tthis.renderResult();\r\n}\r\n\r\nDocumentPane.prototype.updateResult = function(result){\r\n\tthis.result = result;\r\n\tthis.updateQuery(result.query);\r\n\tthis.refreshViews();\r\n}\r\n\r\nDocumentPane.prototype.empty = function(){\r\n\treturn (typeof this.view == \"undefined\");\r\n}\r\n\r\nDocumentPane.prototype.clearMessages = function(){}\r\nDocumentPane.prototype.showError = function(){}\r\n\r\nDocumentPane.prototype.submitQuery = function(qObj){\r\n\tthis.clearMessages();\r\n\ttdv.owner = this;\r\n\ttdv.setDatatypes(Datatypes.initialiseDataRenderers);\r\n\ttdv.loadDocument(id).then(() => {\r\n\t\tlet dom = tdv.render();\r\n\t\tif(dom) holder.appendChild(dom);\r\n\t});\r\n\treturn holder;\r\n    this.query = qObj;\r\n    qObj.execute(this.client).then((results) => {\r\n\t\tvar r = new TerminusClient.WOQLResult(results, qObj);\r\n\t\tthis.result = r;\r\n\t\tthis.refreshViews();\r\n\t})\r\n}\r\n\r\nmodule.exports = DocumentPane;\r\n","const HTMLFrameHelper = require(\"../HTMLFrameHelper\");\r\n\r\nfunction SimpleFrameViewer(){\r\n}\r\n\r\nSimpleFrameViewer.prototype.getScope = function(frame){\r\n\tif(frame.isProperty()) return \"property\";\r\n\tif(frame.isObject()) return \"object\";\r\n\tif(frame.isData()) return \"data\";\r\n}\r\n\r\nSimpleFrameViewer.prototype.getDatatypeViewer = function(frame, mode){\r\n\tvar dv = frame.display_options.dataviewer;\r\n\tif(!dv){\r\n\t\tif(frame.isChoice()) var t = \"oneOf\";\r\n\t\telse if(frame.isDocument()) var t = \"document\";\r\n\t\telse t = frame.getType();\r\n\t\tif(mode && mode == \"edit\"){\r\n\t\t\tvar r = this.terminus.datatypes.getEditor(t);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tvar r = this.terminus.datatypes.getRenderer(t);\r\n\t\t}\r\n\t\tdv = r.name;\r\n\t}\r\n\tif(frame.display_options.args){\r\n\t\tvar args = frame.display_options.args ;\r\n\t}\r\n\telse {\r\n\t\tif(r && r.args) args = r.args;\r\n\t\telse args = false;\r\n\t}\r\n\treturn this.terminus.datatypes.createRenderer(dv, args);\r\n}\r\n\r\nSimpleFrameViewer.prototype.render = function(frame){\r\n\tvar scope = this.getScope(frame);\r\n\tif(frame.display_options.header_features){\r\n\t\tvar hfeatures = this.getFeaturesDOM(frame.display_options.header_features, frame.display_options.feature_renderers, scope, frame, frame.display_options.mode)\r\n\t}\r\n\telse var hfeatures = false;\r\n\tif(frame.display_options.features){\r\n\t\tvar features = this.getFeaturesDOM(frame.display_options.features, frame.display_options.feature_renderers, scope, frame, frame.display_options.mode);\r\n\t}\r\n\telse var features = false;\r\n\tvar orient = (scope == \"object\" || scope == \"property\") ? \"page\" : \"line\";\r\n\tvar ndom = HTMLFrameHelper.getFrameDOM(scope, frame, orient, hfeatures, features);\r\n\tif(!ndom) return false;\r\n\tif(this.framedom){\r\n\t\tthis.framedom.replaceWith(ndom);\r\n\t}\r\n\tthis.framedom = ndom;\r\n\treturn this.framedom;\r\n}\t\r\n\r\nSimpleFrameViewer.prototype.getFeaturesDOM = function(flist, renderers, scope, frame, mode){\r\n\tvar features = document.createElement(\"span\");\r\n\tfeatures.setAttribute(\"class\", featuresToCSS(flist));\r\n\tfor(var i = 0; i<flist.length; i++){\r\n\t\tif(typeof flist[i] == \"object\"){\r\n\t\t\tfeatures.appendChild(this.getFeaturesDOM(flist[i], renderers, scope, frame));\r\n\t\t}\r\n\t\telse {\r\n\t\t\tif(renderers && renderers[flist[i]]){\r\n\t\t\t\tvar dom = renderers[flist[i]](frame, flist[i]);\r\n\t\t\t\tif(dom)\tfeatures.appendChild(dom);\r\n\t\t\t}\t\t\t\t\r\n\t\t\telse {\r\n\t\t\t\tif(flist[i] == \"value\" && scope == \"data\"){\r\n\t\t\t\t\tvar dv = this.getDatatypeViewer(frame, mode);\r\n\t\t\t\t\tif(dv) {\r\n\t\t\t\t\t\tvar dom = dv.renderFrame(frame, this);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tvar dom = document.createTextNode(frame.get());\t\t\t\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(dom)\tfeatures.appendChild(dom);\r\n\t\t\t\t}\r\n\t\t\t\telse if(flist[i] == \"value\"){\r\n\t\t\t\t\tif(scope == 'object'){\r\n\t\t\t\t\t\tvar vals = frame.renderProperties();\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tvar vals = frame.renderValues();\t\t    \r\n\t\t\t\t\t}\r\n\t\t\t\t    for(var j = 0; j<vals.length; j++){\r\n\t\t\t\t\t\tfeatures.appendChild(vals[j]);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tvar dom = HTMLFrameHelper.getFeatureDOM(flist[i], scope, frame);\r\n\t\t\t\t\tif(dom)\tfeatures.appendChild(dom);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn features;\r\n}\r\n\r\nfunction featuresToCSS(flist){\r\n\tvar s = \"\";\r\n\tfor(var i = 0; i<flist.length; i++){\r\n\t\tif(typeof flist[i] == \"object\"){\r\n\t\t\ts += featuresToCSS(flist[i]) + \"-\";\r\n\t\t}\r\n\t\telse {\r\n\t\t\ts += flist[i] + \"-\";\r\n\t\t}\r\n\t}\r\n\treturn s.substring(0, s.length-1);\r\n}\r\n\r\n\r\n\r\nmodule.exports = SimpleFrameViewer;","const TerminusUI = require('./TerminusUI');\r\nmodule.exports={TerminusUI:TerminusUI}\r\n","/**\r\n * Terminus UI object\r\n *\r\n * Traffic control of messages going between different Terminus UI pages and features\r\n *\r\n * @param opts - options array\r\n */\r\nconst ApiExplorer = require('./ApiExplorer');\r\nconst TerminusDBsdk = require('./TerminusDB');\r\nconst TerminusViolations = require('./html/TerminusViolation');\r\nconst TerminusQueryViewer = require('./TerminusQuery');\r\nconst TerminusSchemaViewer = require('./TerminusSchema');\r\nconst TerminusServersdk = require('./TerminusServer');\r\nconst TerminusURLLoader = require('./TerminusURL');\r\nconst TerminusPluginManager = require('./plugins/TerminusPlugin');\r\nconst UTILS = require('./Utils');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction TerminusUI(opts){\r\n\tthis.client = new TerminusClient.WOQLClient();\r\n\tthis.controls = [];\r\n\tthis.setOptions(opts);\r\n}\r\n\r\n/*\r\n * Client connects to specified server and specified part\r\n * opts is a json with the following fields:\r\n * server: mandatory URL of the server to connect to\r\n * key: optional client API key\r\n * dbid: id of the database to connect to\r\n * schema: if set, the UI will load the schema page after connecting\r\n * query: if set, the query will be sent to the server and the results will be loaded on the query page\r\n * document: if set, the document page corresponding to this document will be loaded after connecting\r\n *\r\n * (note: schema, query, document are mutually exclusive and must also have a dbid set)\r\n */\r\nTerminusUI.prototype.connect = function(opts){\r\n\tvar self = this;\r\n\tthis.client.connectionConfig.server = false;\r\n\tvar key = ((opts && opts.key) ? opts.key : false);\r\n\tthis.showBusy(\"Connecting to server at \" + opts.server);\r\n\treturn this.client.connect(opts.server, key)\r\n\t.then( function(response) {\r\n\t\tself.clearBusy();\r\n\t\tif(opts && opts.db && self.getDBRecord(opts.db)){\r\n\t\t\tself.connectToDB(opts.db);\r\n\t\t\tif(opts.document && self.showView(\"get_document\")){\r\n\t\t\t\tresponse = self.showDocument(opts.document);\r\n\t\t\t}\r\n\t\t\telse if(opts.schema && self.showView(\"get_schema\")){\r\n\t\t\t\tresponse = self.showSchemaPage(opts.schema);\r\n\t\t\t}\r\n\t\t\telse if(opts.query && self.showView(\"woql_select\")){\r\n\t\t\t\tself.showQueryPage(opts.query);\r\n\t\t\t}\r\n\t\t\telse if(opts.explorer && self.showView(\"api_explorer\")){\r\n\t\t\t\tself.showExplorer(opts.explorer);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tself.showDBMainPage();\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tself.showServerMainPage();\r\n\t\t}\r\n\t\tself.redraw();\r\n\t\treturn response;\r\n\t})\r\n\t.catch(function(err) {\r\n\t\tself.clearBusy();\r\n\t\tself.showError(err);\r\n\t\tthrow(err);\r\n\t});\r\n}\r\n\r\n/**\r\n * Sends a request to create a new database to the server and interprets the response\r\n *\r\n * dbdets is a json object with the following fields:\r\n * id: the id of the new database (alphanumeric, no spaces, url friendly) mandatory\r\n * title: the text name of the new database for tables, etc. mandatory\r\n * description: text description of the database (optional)\r\n * key: a API client key for server auth\r\n * schema: the url of another Terminus DB from which to import schema\r\n * instance: the url of another Terminus DB from which to import data\r\n *\r\n */\r\nTerminusUI.prototype.createDatabase = function(dbdets){\r\n\tvar self = this;\r\n\tif(!dbdets.id || !dbdets.title){\r\n        return Promise.reject(new Error(self.getBadArguments(\"createDatabase\", \"ID and title are mandatory fields\")));\r\n\t}\r\n\tvar dbid = dbdets.id;\r\n\tvar myserver = this.client.connectionConfig.server;\r\n\tself.showBusy(\"Creating Database \" + dbdets.title + \" with id \" + dbid);\r\n\tvar dbdoc = this.generateNewDatabaseDocument(dbdets);\r\n\treturn this.client.createDatabase(dbid, dbdoc)\r\n\t.then(function(response){ //import schema into newly created DB\r\n\t\tif(dbdets.schema){\r\n\t\t\tself.showBusy(\"Fetching imported schema from \" + dbdets.schema);\r\n\t\t\tvar opts = (dbdets.key ?  {\"terminus:user_key\": dbdets.key } : {});\r\n\t\t\topts['terminus:encoding'] = \"terminus:turtle\";\r\n\t\t\treturn self.client.getSchema(dbdets.schema, opts)\r\n\t\t\t.then(function(response){\r\n\t\t\t\tself.showBusy(\"Updating database with new schema\");\r\n\t\t\t\tself.client.connectionConfig.server = myserver;\r\n\t\t\t\tself.client.connectionConfig.dbid = dbid;\r\n\t\t\t\tvar nopts = {'terminus:encoding':  \"terminus:turtle\"};\r\n\t\t\t\treturn self.client.updateSchema(false, response, nopts);\r\n\t\t\t})\r\n\t\t\t.then(function(response){\r\n\t\t\t\tself.clearBusy();\r\n\t\t\t\tself.redraw();\r\n\t\t\t\treturn response;\r\n\t\t\t});\r\n\t\t}\r\n\t\telse {\r\n\t\t\tself.clearBusy();\r\n\t\t}\r\n\t\treturn response;\r\n\t})\r\n\t.then(function(response){ //reload list of databases in background..\r\n\t\treturn self.refreshDBList()\r\n\t\t.then(function(response){\r\n\t\t\tif(crec = self.client.connection.getDBRecord(dbid)){\r\n\t\t\t\tself.client.connectionConfig.dbid = dbid;\r\n\t\t\t\tself.showDBMainPage();\r\n\t\t\t\tself.showMessage(\"Successfully Created Database \" + dbid, \"success\");\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t        return Promise.reject(new Error(self.getCrashString(\"createDatabase\", \"Failed to retrieve record of created database \" + dbid)));\r\n\t\t\t}\r\n\t\t})\r\n\t})\r\n\t.catch(function(error){\r\n\t\tself.clearBusy();\r\n\t\tself.showError(error);\r\n\t});\r\n}\r\n\r\n/**\r\n * Deletes the database with the passed id from the currently connected server\r\n */\r\nTerminusUI.prototype.deleteDatabase = function(dbid){\r\n\tvar self = this;\r\n\tvar delrec = this.client.connection.getDBRecord();\r\n\tvar lid = (dbid ? dbid : this.db());\r\n\tvar dbn = (delrec && delrec['rdfs:label'] && delrec['rdfs:label'][\"@value\"] ? delrec['rdfs:label'][\"@value\"] + \" (id: \" + lid + \")\" : lid);\r\n\tthis.showBusy(\"Deleting database \" + dbn);\r\n\treturn this.client.deleteDatabase(dbid)\r\n\t.then(function(response){\r\n\t\tself.clearBusy();\r\n\t\tself.client.connectionConfig.dbid = false;\r\n\t\tself.removeDB(dbid);\r\n\t\tself.showServerMainPage();\r\n\t\tself.showMessage(\"Successfully Deleted Database \" + dbn, \"success\");\r\n\t\tself.refreshDBList();\r\n\t\treturn response;\r\n\t})\r\n\t.catch(function(error){\r\n\t\tself.clearBusy();\r\n\t\tself.showError(error);\r\n\t});\r\n}\r\n\r\n/*\r\n * Transforms a details (id, title, description) array into  json-ld document\r\n */\r\nTerminusUI.prototype.generateNewDatabaseDocument = function(dets){\r\n\tvar doc = {\r\n\t\t\"@context\" : {\r\n\t\t\trdfs: \"http://www.w3.org/2000/01/rdf-schema#\",\r\n\t\t\tterminus: \"http://terminusdb.com/schema/terminus#\"\r\n\t\t},\r\n\t\t\"@type\": \"terminus:Database\"\r\n\t}\r\n\tif(dets.title){\r\n\t\tdoc['rdfs:label'] = {\r\n\t\t\t\"@language\":  \"en\",\r\n\t\t\t\"@value\": dets.title\r\n\t\t};\r\n\t}\r\n\tif(dets.description){\r\n\t\tdoc['rdfs:comment'] = {\r\n\t\t\t\"@language\":  \"en\",\r\n\t\t\t\"@value\": dets.description\r\n\t\t};\r\n\t}\r\n\tdoc['terminus:allow_origin'] = { \"@type\" : \"xsd:string\", \"@value\" : \"*\" };\r\n\treturn doc;\r\n}\r\n\r\nTerminusUI.prototype.getBadArguments = function(fname, str){\r\n\treturn \"Bad arguments to \" + fname + \": \" + str;\r\n}\r\n\r\nTerminusUI.prototype.getCrashString = function(fname, str){\r\n\treturn \"Results from \" + fname + \" indicate the possibility of a system failure \" + str;\r\n}\r\n\r\n/*\r\n * Parses the passed URL and turns it into a call to the connect function - loads the appropriate endpoing\r\n */\r\nTerminusUI.prototype.load = function(url, key){\r\n\tvar args = {};\r\n\tif(url && url.indexOf(\"/document/\") != -1){\r\n\t\turl = url.substring(0, url.indexOf(\"/document/\"));\r\n\t\targs.document = url.substring(url.indexOf(\"/document/\")+10);\r\n\t}\r\n\telse if(url && url.indexOf(\"/schema\") != -1){\r\n\t\turl = url.substring(0, url.indexOf(\"/schema\"));\r\n\t\targs.schema = {};\r\n\t}\r\n\telse if(url && url.indexOf(\"/woql\") != -1){\r\n\t\turl = url.substring(0, url.indexOf(\"/query\"));\r\n\t\targs.query = url.substring(url.indexOf(\"/query\")+7);\r\n\t}\r\n\targs.server = url;\r\n\tif(key) args.key = key;\r\n\treturn this.connect(args);\r\n}\r\n\r\n/**\r\n * Fetches the DB URL from the url by chopping off the extra bits\r\n */\r\nTerminusUI.prototype.getConnectionEndpoint = function(url){\r\n\tif(url && url.lastIndexOf(\"/schema\") != -1){\r\n\t\treturn url.substring(0, url.lastIndexOf(\"/schema\"));\r\n\t}\r\n\tif(url && url.lastIndexOf(\"/document\") != -1){\r\n\t\treturn url.substring(0, url.lastIndexOf(\"/document\"));\r\n\t}\r\n\tif(url && url.lastIndexOf(\"/frame\") != -1){\r\n\t\treturn url.substring(0, url.lastIndexOf(\"/frame\"));\r\n\t}\r\n\tif(url && url.lastIndexOf(\"/woql\") != -1){\r\n\t\treturn url.substring(0, url.lastIndexOf(\"/woql\"));\r\n\t}\r\n\treturn url;\r\n}\r\n\r\nTerminusUI.prototype.server = function(){\r\n\treturn this.client.connectionConfig.server;\r\n}\r\n\r\nTerminusUI.prototype.db = function(){\r\n\treturn this.client.connectionConfig.dbid;\r\n}\r\n\r\nTerminusUI.prototype.clearServer = function(){\r\n\tthis.client.connectionConfig.server = false;\r\n}\r\n\r\nTerminusUI.prototype.connectToDB = function(dbid){\r\n\tthis.client.connectionConfig.dbid = dbid;\r\n\tTerminusClient.FrameHelper.standard_urls['doc'] = this.client.connectionConfig.dbURL() + \"/document/\";\r\n\tTerminusClient.FrameHelper.standard_urls['scm'] = this.client.connectionConfig.dbURL() + \"/schema#\";\r\n}\r\n\r\nTerminusUI.prototype.clearDB = function(){\r\n\tthis.client.connectionConfig.dbid = false;\r\n}\r\n\r\nTerminusUI.prototype.removeDB = function(db, url){\r\n\tthis.client.connection.removeDB(db, url);\r\n}\r\n\r\nTerminusUI.prototype.getDBRecord = function(db, url){\r\n\treturn this.client.connection.getDBRecord(db, url);\r\n}\r\n\r\nTerminusUI.prototype.refreshDBList = function(){\r\n\tvar self = this;\r\n\treturn this.client.connect();\r\n}\r\n\r\nTerminusUI.prototype.showServerMainPage = function(){\r\n\tthis.viewer = new TerminusServersdk.TerminusServerViewer(this);\r\n\tthis.redrawMainPage();\r\n}\r\n\r\nTerminusUI.prototype.showCollaboratePage = function(){\r\n\tthis.viewer = new TerminusURLLoader(this);\r\n\tthis.redrawMainPage();\r\n}\r\n\r\n\r\nTerminusUI.prototype.showLoadURLPage = function(val){\r\n\tthis.viewer = new TerminusURLLoader(this, val);\r\n\tthis.redrawMainPage();\r\n}\r\n\r\nTerminusUI.prototype.showDBMainPage = function(){\r\n\tthis.viewer = new TerminusDBsdk.TerminusDBViewer(this);\r\n\tthis.viewer.page = \"db\";\r\n\tthis.redraw();\r\n}\r\n\r\nTerminusUI.prototype.showCreateDBPage = function(){\r\n\tthis.viewer = new TerminusDBsdk.TerminusDBCreator(this);\r\n\tthis.redrawMainPage();\r\n}\r\n\r\nTerminusUI.prototype.showSchemaPage = function(durl){\r\n\tthis.viewer = new TerminusSchemaViewer(this);\r\n\tthis.redrawMainPage();\r\n}\r\n\r\nTerminusUI.prototype.showQueryPage = function(query){\r\n\tthis.viewer = new TerminusQueryViewer(this, query, this.options);\r\n\tthis.redrawMainPage();\r\n}\r\n\r\nTerminusUI.prototype.showDocumentPage = function(){\r\n\tthis.viewer = new TerminusDBsdk.TerminusDBViewer(this);\r\n\tthis.viewer.page = \"docs\";\r\n\tthis.redraw();\r\n}\r\n\r\nTerminusUI.prototype.showDocument = function(durl){\r\n\tthis.viewer = new TerminusDocumentViewer(this, \"view\", this.getDocViewerOptions());\r\n\tconst promise = this.viewer.loadDocument(durl);\r\n\tthis.redrawMainPage();\r\n\treturn promise;\r\n}\r\n\r\nTerminusUI.prototype.showCreateDocument = function(durl){\r\n\tthis.viewer = new TerminusDocumentViewer(this, \"create\", this.getDocCreatorOptions());\r\n\tconst promise = this.viewer.loadCreateDocument(durl);\r\n\tthis.redrawMainPage();\r\n\treturn promise;\r\n}\r\n\r\nTerminusUI.prototype.redrawMainPage = function(){\r\n\tTerminusClient.FrameHelper.removeChildren(this.mainDOM);\r\n\tif(this.viewer && this.mainDOM){\r\n\t\tvar x = this.viewer.getAsDOM();\r\n\t\tthis.mainDOM.appendChild(x);\r\n\t}\r\n}\r\n\r\nTerminusUI.prototype.deleteDBPermitted = function(dbid){\r\n\tif(dbid == \"terminus\") return false;\r\n\tif(this.client.connection.capabilitiesPermit(\"delete_database\", dbid)){\r\n\t\treturn true;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nTerminusUI.prototype.getDeleteDBButton = function(dbid){\r\n\tif(!this.deleteDBPermitted(dbid)) return false;\r\n\tvar delbut = document.createElement('button');\r\n\tvar icon = document.createElement('i');\r\n\ticon.setAttribute(\"class\", \"terminus-db-list-del-icon fa fa-trash\");\r\n\tdelbut.appendChild(icon);\r\n\tdelbut.appendChild(document.createTextNode(\"Delete Database\"));\r\n\tdelbut.setAttribute(\"class\", \"terminus-control-button terminus-delete-db-button\");\r\n\t\t// function to fix db in a closure\r\n\tvar self = this;\r\n\tvar delDB = function(db){\r\n\t\treturn function(){\r\n\t\t\tlet deleteConfirm = confirm(`This action is irreversible, it will remove the database from the system permanently. Are you sure you want to delete ${db} Database?`);\r\n\t\t\tif (deleteConfirm == true) {\r\n\t\t\t\tself.deleteDatabase(db);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\tdelbut.addEventListener(\"click\", delDB(dbid));\r\n\treturn delbut;\r\n}\r\n\r\nTerminusUI.prototype.showResult = function(response){\r\n\tthis.showMessage(response, \"success\");\r\n};\r\n\r\nTerminusUI.prototype.showError = function(response){\r\n\tthis.showMessage(response, \"error\");\r\n};\r\n\r\nTerminusUI.prototype.clearMessages = function(response){\r\n\tif(this.messages) TerminusClient.FrameHelper.removeChildren(this.messages);\r\n};\r\n\r\nTerminusUI.prototype.clearMainPage = function(){\r\n\tif(this.main) TerminusClient.FrameHelper.removeChildren(this.main);\r\n}\r\n\r\nTerminusUI.prototype.setMessageDOM = function(dom){\r\n\tthis.messages = dom;\r\n}\r\n\r\nTerminusUI.prototype.setbuttonControls = function(dom){\r\n\tthis.buttons = dom;\r\n}\r\n\r\nTerminusUI.prototype.setControllerDOM = function(dom){\r\n\tthis.controller = dom;\r\n}\r\n\r\nTerminusUI.prototype.setExplorerDOM = function(dom){\r\n\tthis.explorer = dom;\r\n}\r\n\r\nTerminusUI.prototype.setPluginsDOM = function(dom){\r\n\tthis.plugins = dom;\r\n}\r\n\r\nTerminusUI.prototype.setViewerDOM = function(dom){\r\n\tthis.mainDOM = dom;\r\n}\r\n\r\nTerminusUI.prototype.draw = function(comps, slocation){\r\n\tif(comps && comps.viewer) this.setViewerDOM(comps.viewer);\r\n\tif(comps && comps.buttons) this.setbuttonControls(comps.buttons);\r\n\tif(comps && comps.messages) this.setMessageDOM(comps.messages);\r\n\tif(comps && comps.controller) this.setControllerDOM(comps.controller);\r\n\t//if(comps && comps.explorer) this.setExplorerDOM(comps.explorer);\r\n\tif(comps && comps.plugins) this.setPluginsDOM(comps.plugins);\r\n\tif(this.plugins){\r\n\t\tthis.drawPlugins();\r\n\t}\r\n\tif(this.buttons){\r\n\t\t//this.toggleControl();\r\n\t}\r\n\tvar self = this;\r\n\tvar cdrawn = false;\r\n\tif(slocation && slocation.server){\r\n\t\tif(typeof this.client.connection.connection[slocation.server] == \"undefined\") {\r\n\t\t\treturn this.connect(slocation)\r\n\t\t\t.catch(function(error){\r\n\t\t\t\tself.showLoadURLPage();\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tthis.showLoadURLPage();\r\n\t};\r\n}\r\n\r\nTerminusUI.prototype.redraw = function(msg){\r\n\tthis.clearMessages();\r\n\tthis.redrawControls();\r\n\tif(this.explorer){\r\n\t\tTerminusClient.FrameHelper.removeChildren(this.explorer);\r\n\t\t//this.drawExplorer();\r\n\t}\r\n\tif(this.viewer){\r\n\t\tthis.redrawMainPage();\r\n\t}\r\n\tif(msg) this.showMessage(msg);\r\n};\r\n\r\n\r\nTerminusUI.prototype.toggleDashboardWidget = function(widget){\r\n    TerminusClient.FrameHelper.removeChildren(this.controller);\r\n    TerminusClient.FrameHelper.removeChildren(this.explorer);\r\n    UTILS.removeSelectedNavClass('terminus-dashboard-selected');\r\n    widget.classList.add('terminus-dashboard-selected');\r\n}\r\n\r\nTerminusUI.prototype.toggleControl = function(){\r\n /* var self = this;\r\n  this.buttons.client.addEventListener('click', function(){\r\n    self.toggleDashboardWidget(this);\r\n    self.drawControls();\r\n    self.showServerMainPage();\r\n  })\r\n  this.buttons.explorer.addEventListener('click', function(){\r\n    self.toggleDashboardWidget(this);\r\n    self.drawExplorer();\r\n  })*/\r\n}\r\n\r\nTerminusUI.prototype.redrawControls = function(){\r\n\tif(this.controller){\r\n\t\tTerminusClient.FrameHelper.removeChildren(this.controller);\r\n\t\tthis.drawControls();\r\n\t}\r\n}\r\n\r\nTerminusUI.prototype.drawControls = function(){\r\n\tthis.controls = [];\r\n\tthis.loadControls();\r\n\tfor(var i = 0; i<this.controls.length; i++){\r\n\t\tvar ncontrol = this.controls[i];\r\n\t\tif(ncontrol && (nd = ncontrol.getAsDOM())){\r\n\t\t\tthis.controller.appendChild(nd);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nTerminusUI.prototype.drawExplorer = function(){\r\n\tif(this.explorer){\r\n\t\tif(this.showControl(\"api_explorer\")){\r\n\t\t\tvar exp = new ApiExplorer(this);\r\n\t\t\tae = exp.getAsDOM();\r\n\t\t\tthis.explorer.appendChild(ae);\r\n\t\t\tthis.explorer.style.display = 'block';\r\n\t\t}\r\n\t}\r\n}\r\n\r\nTerminusUI.prototype.loadControls = function(){\r\n\tif(this.showControl('server')){\r\n\t\tvar sc = new TerminusServersdk.TerminusServerController(this);\r\n\t\tif(sc) {\r\n\t\t\tthis.controls.push(sc);\r\n\t\t}\r\n\t\tif(this.db() && this.showControl(\"db\")){\r\n\t\t\tvar sc = new TerminusDBsdk.TerminusDBController(this);\r\n\t\t\tif(sc) this.controls.push(sc);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nTerminusUI.prototype.showControl = function(el){\r\n\tif(this.show_controls.indexOf(el) == -1) return false;\r\n\tif(this.pseudoCapability(el)) return true;\r\n\tif(this.client.connection.capabilitiesPermit(el)) {\r\n\t\treturn true;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nTerminusUI.prototype.showView = function(el){\r\n\tif(this.show_views.indexOf(el) == -1) return false;\r\n\tif(this.pseudoCapability(el)) return true;\r\n\tif(this.client.connection.capabilitiesPermit(el)) {\r\n\t\treturn true;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nTerminusUI.prototype.clearBusy = function(response){\r\n\tthis.clearMessages();\r\n\tif(this.viewer && typeof this.viewer.busy == \"function\") this.viewer.busy(false);\r\n}\r\n\r\nTerminusUI.prototype.getBusyLoader = function(bsyDom){\r\n     var pd = document.createElement('div');\r\n     var pbc = document.createElement('div');\r\n     pbc.setAttribute('class', 'term-progress-bar-container');\r\n     pd.appendChild(pbc);\r\n\r\n     var pbsa = document.createElement('div');\r\n     pbsa.setAttribute('class', 'term-progress-bar term-stripes animated reverse slower');\r\n     pbc.appendChild(pbsa);\r\n     var pbia = document.createElement('span');\r\n     pbia.setAttribute('class', 'term-progress-bar-inner');\r\n     pbsa.appendChild(pbia);\r\n\r\n     bsyDom.appendChild(pd);\r\n}\r\n\r\nTerminusUI.prototype.showMessage = function(msg, type){\r\n\tif(this.messages){\r\n\t\tTerminusClient.FrameHelper.removeChildren(this.messages);\r\n\t\tvar md = document.createElement('div');\r\n        switch(type){\r\n            case 'busy':\r\n                var msgHolder = document.createElement('div');\r\n                msgHolder.setAttribute('class', 'terminus-busy-msg')\r\n                msgHolder.appendChild(document.createTextNode(msg));\r\n                md.appendChild(msgHolder);\r\n                this.getBusyLoader(md);\r\n            break;\r\n            case 'success':\r\n                md.setAttribute('class', 'terminus-show-msg-success');\r\n                md.appendChild(document.createTextNode(msg));\r\n            break;\r\n            case 'error':\r\n                md.setAttribute('class', 'terminus-show-msg-error');\r\n                md.appendChild(document.createTextNode(msg));\r\n            break;\r\n        }\r\n\t\tthis.messages.appendChild(md);\r\n\t}\r\n};\r\n\r\nTerminusUI.prototype.showViolations = function(vios, type){\r\n\tvar nvios = new TerminusViolations(vios, this);\r\n\tif(this.messages){\r\n\t\tvar cmsg = (type == \"schema\" ? \" in Schema\" : \" in Document\");\r\n\t\tTerminusClient.FrameHelper.removeChildren(this.messages);\r\n\t\tthis.messages.appendChild(nvios.getAsDOM(cmsg));\r\n\t}\r\n}\r\n\r\nTerminusUI.prototype.showBusy = function(msg){\r\n\tthis.showMessage(msg, \"busy\");\r\n\tif(this.viewer && typeof this.viewer.busy == \"function\") this.viewer.busy(msg);\r\n};\r\n\r\nTerminusUI.prototype.pseudoCapability = function(el){\r\n\tvar pseuds = [\"server\", \"db\", \"collaborate\", \"change-server\", \"api_explorer\", \"import_schema\", \"add_new_library\"];\r\n\tif(pseuds.indexOf(el) == -1) return false;\r\n\treturn true;\r\n}\r\n\r\nTerminusUI.prototype.setOptions = function(opts){\r\n\tthis.show_controls = opts && opts.controls ? opts.controls :\r\n\t\t[\"server\", \"db\", \"change-server\", \"schema_format\",\r\n\t\t\t\"import_schema\", \"class_frame\", \"create_database\",\r\n\t\t\t\"collaborate\", \"get_document\", \"update_schema\",\r\n\t\t\t\"get_schema\", \"woql_select\"\r\n\t\t];\r\n\tthis.show_views = opts && opts.views ? opts.views : this.show_controls;\r\n\tif(opts.document){\r\n\t\tthis.document_options = opts.document;\r\n\t}\r\n\tif(opts.schema){\r\n\t\tthis.schema_options = opts.schema;\r\n\t}\r\n\tthis.piman = new TerminusPluginManager();\r\n\tvar self = this;\r\n\tthis.piman.init(opts.plugins, function(){\r\n\t\tvar pins = [\"gmaps\", \"quill\", \"select2\"];\r\n\t\tfor(var i = 0; i<pins.length; i++){\r\n\t\t\tif(self.piman.pluginAvailable(pins[i])){\r\n\t\t\t\t//RenderingMap.addPlugin(pins[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t\tself.redraw();\r\n\t});\r\n\tif(opts.css && this.piman){\r\n\t\tthis.piman.loadPageCSS(opts.css);\r\n\t}\r\n\tthis.loadControls();\r\n}\r\n\r\nTerminusUI.prototype.pluginAvailable = function(p){\r\n\treturn this.piman.pluginAvailable(p);\r\n}\r\n\r\nTerminusUI.prototype.drawPlugins = function(){\r\n\tif(!this.piman) {\r\n\t\tconsole.log(new Error(\"No plugin manager initialised in UI object\"));\r\n\t\treturn false;\r\n\t}\r\n\tthis.plugins.appendChild(this.piman.getAsDOM(this));\r\n}\r\n\r\nTerminusUI.prototype.getDocViewerOptions = function(){\r\n\tif(this.document_options && this.document_options['view']){\r\n\t\treturn this.document_options['view'];\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nTerminusUI.prototype.getDocCreatorOptions = function(){\r\n\tif(this.document_options && this.document_options['view']){\r\n\t\treturn this.document_options['view'];\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nTerminusUI.prototype.getClassFrameOptions = function(){\r\n\treturn this.viewdoc_options;\r\n}\r\n\r\nmodule.exports=TerminusUI\r\n","/**\r\n * @file Javascript Api explorer tool\r\n * @author Kitty Jose\r\n * @license Copyright 2018-2019 Data Chemist Limited, All Rights Reserved. See LICENSE file for more\r\n *\r\n * @summary Displays a demo and description of api calls from WOQLCLient and what happens under the hood of api calls\r\n */\r\nconst TerminusPluginManager = require('./plugins/TerminusPlugin');\r\nconst UTILS = require('./Utils');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nlet apiNavConfig = {\r\n    mainNav: {\r\n        connect: {\r\n    \t\tnavText: 'Connect API',\r\n            action : 'connect',\r\n            icon   : 'link',\r\n            defaultSelected: true\r\n    \t},\r\n        database: {\r\n            navText: 'Database API',\r\n            action : 'create',\r\n            icon   : 'database'\r\n        },\r\n        schema: {\r\n            navText: 'Schema API',\r\n            action : 'schema',\r\n            icon   : 'cog'\r\n        },\r\n        document: {\r\n            navText: 'Document API',\r\n            action : 'document',\r\n            icon   : 'file'\r\n        },\r\n        query: {\r\n            navText: 'Query API',\r\n            action : 'query',\r\n            icon   : 'search'\r\n        }\r\n    },\r\n    subNav: {\r\n        database: {\r\n            createDatabase: {\r\n                navText: 'Create database',\r\n                action : 'create',\r\n                icon   : 'plus',\r\n                defaultSelected: true\r\n            },\r\n            deleteDatabase: {\r\n                navText: 'Delete database',\r\n                action : 'delete',\r\n                icon   : 'trash-alt'\r\n            }\r\n        },\r\n        schema: {\r\n            getSchema: {\r\n                navText: 'View Schema',\r\n                action : 'getSchema',\r\n                icon   : 'eye',\r\n                defaultSelected: true\r\n            },\r\n            updateSchema: {\r\n                navText: 'Update Schema',\r\n                action : 'updateSchema',\r\n                icon   : 'arrow-up'\r\n            },\r\n            getClassFrames: {\r\n                navText: 'Get Class Frames',\r\n                action : 'getClassFrames',\r\n                icon   : 'share-alt'\r\n            }\r\n        },\r\n        document: {\r\n            viewDocument: {\r\n        \t\tnavText: 'View Document',\r\n                action : 'viewDocument',\r\n                icon   : 'eye',\r\n                defaultSelected: true\r\n        \t},\r\n            createDocument: {\r\n                navText: 'Create Document',\r\n                action : 'createDocument',\r\n                icon   : 'plus'\r\n            },\r\n            updateDocument: {\r\n                navText: 'Update Document',\r\n                action : 'updateDocument',\r\n                icon   : 'arrow-up'\r\n            },\r\n            deleteDocument:{\r\n                navText: 'Delete Document',\r\n                action : 'deleteDocument',\r\n                icon   : 'trash-alt'\r\n            }\r\n        },\r\n        query: {\r\n            select: {\r\n                navText: 'Select',\r\n                action : 'select',\r\n                icon   : 'mouse-pointer',\r\n                defaultSelected: true\r\n            },\r\n            update: {\r\n                navText: 'Update',\r\n                action : 'update',\r\n                icon   : 'arrow-up'\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nfunction ApiExplorer(ui){\r\n    this.ui = ui;\r\n    this.viewer = ui.mainDOM;\r\n    this.client = new TerminusClient.WOQLClient();\r\n    this.client.use_fetch = true;\r\n    this.client.return_full_response = true;\r\n    this.pman = new TerminusPluginManager();\r\n}\r\n\r\n// Controller provides access to Api explorer functions\r\nApiExplorer.prototype.getAsDOM = function(){\r\n \tvar aec = document.createElement(\"div\");\r\n    aec.setAttribute(\"class\", \"terminus-db-controller\");\r\n    if(this.ui){\r\n       this.getApiNav(aec, this.viewer); // nav\r\n       this.getApiExplorerDom('connect', this.viewer); // content dom\r\n    } // if this.ui\r\n    return aec;\r\n }\r\n\r\n/***** Api Nav bar *****/\r\n// Toggle selected nav bars\r\nApiExplorer.prototype.setSelectedNavMenu = function(a){\r\n    UTILS.removeSelectedNavClass(\"terminus-selected\");\r\n    a.classList.add(\"terminus-selected\");\r\n}\r\n\r\nApiExplorer.prototype.navOnSelect = function(action, nav, viewer){\r\n    UTILS.removeSelectedNavClass(\"terminus-selected\");\r\n    nav.classList.add(\"terminus-selected\");\r\n    this.getApiExplorerDom(action, viewer);\r\n}\r\n\r\n// create nav bars\r\nApiExplorer.prototype.createNavs = function(navConfig, viewer, ul){\r\n    var a = document.createElement('a');\r\n    a.setAttribute('class', 'terminus-a terminus-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\r\n    if(navConfig.defaultSelected) a.classList.add('terminus-selected');\r\n    var self = this;\r\n    a.addEventListener(\"click\", function(){\r\n        self.navOnSelect(navConfig.action, this, viewer);\r\n    })\r\n    var icon = document.createElement('i');\r\n    icon.setAttribute('class', 'terminus-menu-icon fa fa-' + navConfig.icon);\r\n    a.appendChild(icon);\r\n    var txt = document.createTextNode(navConfig.navText);\r\n    a.appendChild(txt);\r\n    ul.appendChild(a);\r\n}\r\n\r\n// gets api nav bar\r\nApiExplorer.prototype.getApiNav = function(navDom, viewer){\r\n    // list view of apis\r\n    var nav = document.createElement('div');\r\n    navDom.appendChild(nav);\r\n    // connect to server api\r\n    var ul = document.createElement('ul');\r\n    ul.setAttribute('class', 'terminus-ul');\r\n    nav.appendChild(ul);\r\n    // loop over apiNavConfig\r\n    for (var key in apiNavConfig.mainNav){\r\n        if (apiNavConfig.mainNav.hasOwnProperty(key)) {\r\n            this.createNavs(apiNavConfig.mainNav[key], viewer, ul);\r\n        }\r\n    } // for apiNavConfig\r\n    return navDom;\r\n} // getApiNav()\r\n\r\n/***** Api sub navs  *****/\r\n// get schema api explorer - nav bar, alert msg, headers ...\r\nApiExplorer.prototype.getApiExplorerDom = function(view, viewer){\r\n    // clear of viewer\r\n    TerminusClient.FrameHelper.removeChildren(viewer);\r\n    // wrapper\r\n    var wrap = document.createElement('div');\r\n    //wrap.setAttribute('class', 'terminus-wrapper terminus-wrapper-height');\r\n    viewer.appendChild(wrap);\r\n    var cont = document.createElement('div');\r\n    cont.setAttribute('class', 'container-fluid');\r\n    wrap.appendChild(cont);\r\n    var row = document.createElement('div');\r\n    row.setAttribute('class', 'row-fluid');\r\n    cont.appendChild(row);\r\n    var body = document.createElement('div');\r\n    body.setAttribute('class', 'terminus-module-body');\r\n    row.appendChild(body);\r\n    var api = document.createElement('div');\r\n    api.setAttribute('class', 'terminus-module-body terminus-module-body-white-bg terminus-module-body-width');\r\n    body.appendChild(api);\r\n    // body\r\n    var cont = document.createElement('div');\r\n    var self = this;\r\n    switch(view){\r\n        case 'connect':\r\n            var apiCont = self.getConnectExplorer(cont);\r\n            api.appendChild(apiCont);\r\n        break;\r\n        case 'create':\r\n            var apiCont = self.getDatabaseExplorer(cont);\r\n            api.appendChild(apiCont);\r\n        break;\r\n        case 'schema':\r\n            var apiCont = self.getSchemaApi(cont);\r\n            api.appendChild(apiCont);\r\n        break;\r\n        case 'document':\r\n            var apiCont = self.getDocumentApi(cont);\r\n            api.appendChild(apiCont);\r\n        break;\r\n        case 'query':\r\n            var apiCont = self.getQueryApi(cont);\r\n            api.appendChild(apiCont);\r\n        break;\r\n    }// switch(api)\r\n    return wrap;\r\n} // getApiExplorerDom\r\n\r\n// on trigger of click event - change dom\r\nApiExplorer.prototype.changeSubApiDom = function(curSubMenu, action, cont, body){\r\n    TerminusClient.FrameHelper.removeChildren(body);\r\n    switch(curSubMenu){\r\n        case 'database':\r\n            var dom = this.getDatabaseDom(action, body);\r\n        break;\r\n        case 'schema':  // getShowApiDom() deals with schema and document\r\n             var dom = this.getShowApiDom(action, body);\r\n        break;\r\n        case 'document': // getShowApiDom() deals with schema and document\r\n             var dom = this.getShowApiDom(action, body);\r\n        break;\r\n        case 'query':\r\n            var dom = this.getQueryApiDom(action, body);\r\n        break;\r\n        default:\r\n            console.log('Invalid Api Config');\r\n        break;\r\n    }\r\n    cont.appendChild(dom);\r\n}\r\n\r\nApiExplorer.prototype.subNavOnSelect = function(curSubMenu, subMenuConfig, subNav, cont, body){\r\n    UTILS.setSelectedSubMenu(subNav);\r\n    this.changeSubApiDom(curSubMenu, subMenuConfig.action, cont, body);\r\n}\r\n\r\n// create sub nav bars\r\nApiExplorer.prototype.createSubNavs = function(curSubMenu, subMenuConfig, cont, body, ul){\r\n    // comment getclassframes for api explorer time being\r\n    if(subMenuConfig.action == 'getClassFrames') return;\r\n    var a = document.createElement('a');\r\n    a.setAttribute('class', 'terminus-a terminus-hz-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\r\n    if(subMenuConfig.defaultSelected) a.classList.add('terminus-submenu-selected');\r\n    var self = this;\r\n    a.addEventListener(\"click\", function() {\r\n        self.subNavOnSelect(curSubMenu, subMenuConfig, this, cont, body);\r\n    })\r\n    var icon = document.createElement('i');\r\n    icon.setAttribute('class', 'terminus-menu-icon fa fa-' + subMenuConfig.icon);\r\n    a.appendChild(icon);\r\n    var txt = document.createTextNode(subMenuConfig.navText);\r\n    a.appendChild(txt);\r\n    ul.appendChild(a);\r\n}\r\n\r\n// get connect to server api calls - on click of connectAPI nav bar\r\nApiExplorer.prototype.getConnectExplorer = function(body){\r\n    var self = this;\r\n    var br = document.createElement('BR');\r\n    body.appendChild(br);\r\n    // get signature\r\n    var b = this.getSignature('connect');\r\n    body.appendChild(b);\r\n    // get header Parameter\r\n    body.appendChild(UTILS.getHeaderDom('Parameters'));\r\n    var br = document.createElement('BR');\r\n    body.appendChild(br);\r\n    //form to get server url\r\n    this.getForm( '', body, true, 'connect', 'URL : server_url');\r\n    //body.appendChild(form);\r\n    return body;\r\n} // getConnectExplorer\r\n\r\n// get database api calls - on click of databaseAPI nav bar - submenus of database Api defined here\r\nApiExplorer.prototype.getDatabaseExplorer = function(cont){\r\n    var body = document.createElement('div');\r\n    // list view of Databse tools\r\n    var ul = document.createElement('ul');\r\n    ul.setAttribute('class','terminus-ul-horizontal');\r\n    // loop over apiNavConfig\r\n    for (var key in apiNavConfig.subNav.database){\r\n        if (apiNavConfig.subNav.database.hasOwnProperty(key))\r\n            this.createSubNavs('database', apiNavConfig.subNav.database[key], cont, body, ul);\r\n    } // for apiNavConfig\r\n    cont.appendChild(ul);\r\n    // landing page\r\n    var dom = this.getDatabaseDom(apiNavConfig.subNav.database.createDatabase.action, body);\r\n    cont.appendChild(dom);\r\n    return cont;\r\n} // getDatabaseExplorer\r\n\r\n// get schema api calls - on click of SchemaAPI nav bar - submenus of schema Api defined here\r\nApiExplorer.prototype.getSchemaApi = function(cont){\r\n    var body = document.createElement('div');\r\n    // list view of Databse tools\r\n    var ul = document.createElement('ul');\r\n    ul.setAttribute('class','terminus-ul-horizontal');\r\n    // loop over apiNavConfig\r\n    for (var key in apiNavConfig.subNav.schema){\r\n        if (apiNavConfig.subNav.schema.hasOwnProperty(key)) {\r\n            this.createSubNavs('schema', apiNavConfig.subNav.schema[key], cont, body, ul);\r\n        }\r\n    } // for apiNavConfig\r\n    cont.appendChild(ul);\r\n    var dom = this.getShowApiDom(apiNavConfig.subNav.schema.getSchema.action, body);\r\n    cont.appendChild(dom);\r\n    return cont;\r\n} // getSchemaApi\r\n\r\n// get document api calls - on click of DocumentAPI nav bar\r\nApiExplorer.prototype.getDocumentApi = function(cont){\r\n    var body = document.createElement('div');\r\n    // list view of Databse tools\r\n    var ul = document.createElement('ul');\r\n    ul.setAttribute('class','terminus-ul-horizontal');\r\n    // loop over apiNavConfig\r\n    for (var key in apiNavConfig.subNav.document){\r\n        if (apiNavConfig.subNav.document.hasOwnProperty(key)) {\r\n            this.createSubNavs('document', apiNavConfig.subNav.document[key], cont, body, ul);\r\n        }\r\n    } // for apiNavConfig\r\n    cont.appendChild(ul);\r\n    var dom = this.getShowApiDom(apiNavConfig.subNav.document.viewDocument.action, body);\r\n    cont.appendChild(dom);\r\n    return cont;\r\n} // getDocumentApi\r\n\r\n// get query api calls - on click of QueryAPI nav bar - submenus of Query Api defined here\r\nApiExplorer.prototype.getQueryApi  = function(cont){\r\n    var body = document.createElement('div');\r\n    // list view of Databse tools\r\n    var ul = document.createElement('ul');\r\n    ul.setAttribute('class','terminus-ul-horizontal');\r\n    // loop over apiNavConfig\r\n    for (var key in apiNavConfig.subNav.query){\r\n        if (apiNavConfig.subNav.query.hasOwnProperty(key)) {\r\n            this.createSubNavs('query', apiNavConfig.subNav.query[key], cont, body, ul);\r\n        }\r\n    } // for apiNavConfig\r\n    cont.appendChild(ul);\r\n    var dom = this.getQueryApiDom(apiNavConfig.subNav.query.select.action, body);\r\n    cont.appendChild(dom);\r\n    return cont;\r\n} //getQueryApi\r\n\r\n/***** Api Content view  *****/\r\n// get database dom\r\nApiExplorer.prototype.getDatabaseDom = function(mode, body){\r\n    var self = this;\r\n    var br = document.createElement('BR');\r\n    body.appendChild(br);\r\n    // get signature\r\n    var b = this.getSignature(mode);\r\n    body.appendChild(b);\r\n    // get header Parameter\r\n    body.appendChild(UTILS.getHeaderDom('Parameters'));\r\n    var br = document.createElement('BR');\r\n    body.appendChild(br);\r\n    //form to get database id\r\n    if(mode == 'create') this.getForm( null, body, false, mode, 'URL : server/database_id');\r\n    else this.getForm( null, body, true, mode, 'URL : server/database_id');\r\n    return body;\r\n} // getConnectExplorer\r\n\r\n//get create & delete db form\r\nApiExplorer.prototype.getServerForm = function(){\r\n  // form\r\n  var form = document.createElement('form');\r\n  form.setAttribute('class', 'terminus-form-horizontal row-fluid');\r\n\r\n  var fd = document.createElement('div');\r\n  fd.setAttribute('class', 'terminus-control-group');\r\n  form.appendChild(fd);\r\n  var inpLabel = document.createElement('label');\r\n  inpLabel.setAttribute('class', 'terminus-control-label');\r\n  inpLabel.setAttribute('for', 'basicinput');\r\n  inpLabel.innerHTML = 'Url:';\r\n  fd.appendChild(inpLabel);\r\n  var cd = document.createElement('div');\r\n  cd.setAttribute('class', 'terminus-controls');\r\n  fd.appendChild(cd);\r\n  var inpId = document.createElement('input');\r\n  inpId.setAttribute('type', 'text');\r\n  inpId.setAttribute('id', 'basicinput');\r\n  inpId.setAttribute('class', 'terminus-input-text');\r\n  inpId.setAttribute('placeholder', 'URL : server_url');\r\n  if(this.val) inpId.value = this.val;\r\n  cd.appendChild(inpId);\r\n\r\n  var fd = document.createElement('div');\r\n  fd.setAttribute('class', 'terminus-control-group');\r\n  form.appendChild(fd);\r\n  var keyLabel = document.createElement('label');\r\n  keyLabel.setAttribute('class', 'terminus-control-label');\r\n  keyLabel.setAttribute('for', 'basicinput');\r\n  keyLabel.innerHTML = 'Key:';\r\n  fd.appendChild(keyLabel);\r\n  var cd = document.createElement('div');\r\n  cd.setAttribute('class', 'terminus-controls');\r\n  fd.appendChild(cd);\r\n  var key = document.createElement('input');\r\n  key.setAttribute('type', 'text');\r\n  key.setAttribute('id', 'basicinput');\r\n  key.setAttribute('class', 'span8 terminus-input-text');\r\n  key.setAttribute('placeholder', 'Key : key');\r\n  if(this.val) key.value = this.val;\r\n  cd.appendChild(key);\r\n\r\n  var button = document.createElement('button');\r\n  button.setAttribute('class', 'terminus-btn terminus-send-api-btn');\r\n  button.setAttribute('type', 'button');\r\n  button.innerHTML = 'Send Api';\r\n  var gatherips = function(){\r\n    var input = {};\r\n    input.url = inpId.value;\r\n    input.key = key.value;\r\n    return input;\r\n  }\r\n  var resd = document.createElement('div');\r\n  form.appendChild(button);\r\n  form.appendChild(resd);\r\n  var self = this;\r\n  button.addEventListener(\"click\", function(){\r\n    var buttonSelf = this;\r\n    //opts = {};\r\n    var input = gatherips();\r\n    self.client.connect(input.url, input.key)\r\n    .then(function(response){\r\n      TerminusClient.FrameHelper.removeChildren(resd);\r\n      var resultDom = UTILS.showHttpResult(response, 'connect', resd, self.ui);\r\n    });\r\n  }) // button click\r\n  return form;\r\n} // getServerForm()\r\n\r\n// get database api calls - on click of databaseAPI nav bar - submenus of database Api defined here\r\nApiExplorer.prototype.getDatabaseExplorer = function(cont){\r\n  var body = document.createElement('div');\r\n  // list view of Databse tools\r\n  var ul = document.createElement('ul');\r\n  ul.setAttribute('class','terminus-ul-horizontal');\r\n  // loop over apiNavConfig\r\n  for (var key in apiNavConfig.subNav.database){\r\n      if (apiNavConfig.subNav.database.hasOwnProperty(key)) {\r\n          this.createSubNavs('database', apiNavConfig.subNav.database[key], cont, body, ul);\r\n      }\r\n  } // for apiNavConfig\r\n  cont.appendChild(ul);\r\n  // landing page\r\n  var dom = this.getDatabaseDom(apiNavConfig.subNav.database.createDatabase.action, body);\r\n  cont.appendChild(dom);\r\n  return cont;\r\n} // getDatabaseExplorer\r\n\r\n\r\n// get schema & document dom\r\nApiExplorer.prototype.getShowApiDom = function(action, body){\r\n    var self = this;\r\n    var br = document.createElement('BR');\r\n    body.appendChild(br);\r\n    // signature\r\n    var b = this.getSignature(action);\r\n    body.appendChild(b);\r\n    // get header Parameter\r\n    body.appendChild(UTILS.getHeaderDom('Parameters'));\r\n    var br = document.createElement('BR');\r\n    body.appendChild(br);\r\n    // get input\r\n    switch(action){\r\n        case 'getSchema':\r\n            this.getForm( 'schema', body, true, action, 'URL : server/database_id');\r\n        break;\r\n        case 'getClassFrames':\r\n            this.getForm( 'getClassFrames', body, true, action, 'URL : server/database_id');\r\n        break;\r\n        case 'updateSchema':\r\n            this.getForm( 'schema', body, false, action, 'URL : server/database_id');\r\n        break;\r\n        case 'viewDocument':\r\n            this.getForm('document', body, true, action, 'URL : server/database_id/document/document_id');\r\n        break;\r\n        case 'deleteDocument':\r\n            this.getForm('document', body, true, action, 'URL : server/database_id/document/document_id');\r\n        break;\r\n        case 'createDocument':\r\n            this.getForm('document', body, false, action, 'URL : server/database_id/document/document_id');\r\n        break;\r\n        case 'updateDocument':\r\n            this.getForm('document', body, false, action, 'URL : server/database_id/document/document_id');\r\n        break;\r\n        default:\r\n            console.log('Invalid Api Call on form');\r\n        break;\r\n   }// switch(action)\r\n\r\n   return body;\r\n } // getShowApiDom()\r\n\r\n// get query api dom\r\nApiExplorer.prototype.getQueryApiDom = function(action, body){\r\n    var br = document.createElement('BR');\r\n    body.appendChild(br);\r\n    // signature\r\n    var b = this.getSignature(action);\r\n    body.appendChild(b);\r\n    // get header Parameter\r\n    body.appendChild(UTILS.getHeaderDom('Parameters'));\r\n    var br = document.createElement('BR');\r\n    body.appendChild(br);\r\n    this.getForm( 'query', body, false, action, 'URL : server/database_id');\r\n    return body;\r\n} // getQueryApiDom\r\n\r\n/*ApiExplorer.prototype.getClassFramesForm = function(){\r\n    // form\r\n    var form = document.createElement('form');\r\n    form.setAttribute('class', 'terminus-form-horizontal row-fluid');\r\n    var fd = document.createElement('div');\r\n    fd.setAttribute('class', 'terminus-control-group');\r\n    form.appendChild(fd);\r\n    var inpLabel = document.createElement('label');\r\n    inpLabel.setAttribute('class', 'terminus-control-label');\r\n    inpLabel.setAttribute('for', 'basicinput');\r\n    inpLabel.innerHTML = 'Url:';\r\n    fd.appendChild(inpLabel);\r\n    var cd = document.createElement('div');\r\n    cd.setAttribute('class', 'terminus-controls');\r\n    fd.appendChild(cd);\r\n    var inpUrl = document.createElement('input');\r\n    inpUrl.setAttribute('type', 'text');\r\n    inpUrl.setAttribute('id', 'basicinput');\r\n    inpUrl.setAttribute('class', 'span8 terminus-input-text');\r\n    inpUrl.setAttribute('placeholder', 'URL : database_url');\r\n    if(this.val) inpUrl.value = this.val;\r\n    cd.appendChild(inpUrl);\r\n    var fd = document.createElement('div');\r\n    fd.setAttribute('class', 'terminus-control-group');\r\n    form.appendChild(fd);\r\n    var inpLabel = document.createElement('label');\r\n    inpLabel.setAttribute('class', 'terminus-control-label');\r\n    inpLabel.setAttribute('for', 'basicinput');\r\n    inpLabel.innerHTML = 'Url/ ID:';\r\n    fd.appendChild(inpLabel);\r\n    var cd = document.createElement('div');\r\n    cd.setAttribute('class', 'terminus-controls');\r\n    fd.appendChild(cd);\r\n    var inpDocUrl = document.createElement('input');\r\n    inpDocUrl.setAttribute('type', 'text');\r\n    inpDocUrl.setAttribute('id', 'basicinput');\r\n    inpDocUrl.setAttribute('class', 'span8 terminus-input-text');\r\n    inpDocUrl.setAttribute('placeholder', 'Url or ID of document class');\r\n    cd.appendChild(inpDocUrl);\r\n    var fd = document.createElement('div');\r\n    fd.setAttribute('class', 'terminus-control-group');\r\n    form.appendChild(fd);\r\n    var optLabel = document.createElement('label');\r\n    optLabel.setAttribute('class', 'terminus-control-label');\r\n    optLabel.setAttribute('for', 'basicinput');\r\n    optLabel.innerHTML = 'Options:';\r\n    fd.appendChild(optLabel);\r\n    var cd = document.createElement('div');\r\n    cd.setAttribute('class', 'terminus-controls');\r\n    fd.appendChild(cd);\r\n    var optInp = document.createElement('input');\r\n    optInp.setAttribute('type', 'text');\r\n    optInp.setAttribute('id', 'basicinput');\r\n    optInp.setAttribute('class', 'span8 terminus-input-text');\r\n    optInp.setAttribute('placeholder', 'options');\r\n    cd.appendChild(optInp);\r\n    var button = document.createElement('button');\r\n    button.setAttribute('class', 'terminus-btn terminus-send-api-btn');\r\n    button.setAttribute('type', 'button');\r\n    button.innerHTML = 'Send Api';\r\n    var gatherips = function(){\r\n        var input = {};\r\n        input.url = inpUrl.value;\r\n        input.docUrl = inpDocUrl.value;\r\n        input.options = optInp.value;\r\n        return input;\r\n    }\r\n    var self = this;\r\n    button.addEventListener(\"click\", function(form){\r\n      var input = gatherips();\r\n      var buttonSelf = this;\r\n      opts = {};\r\n      opts.explorer = true;\r\n      self.client.getClassFrame(input.url, input.docUrl, opts)\r\n      .then(function(response){\r\n          var currForm = buttonSelf.parentNode;\r\n          var resultDom = UTILS.showHttpResult(response, 'getClassFrames', currForm, self.ui);\r\n      });\r\n    }) // button click\r\n    form.appendChild(button);\r\n    return form;\r\n}   */\r\n\r\n// get form for all Apis\r\nApiExplorer.prototype.getForm = function(curApi, body, view, action, urlPlaceholder){\r\n    // form\r\n    var formDoc = document.createElement('form');\r\n    formDoc.setAttribute('class', 'terminus-form-horizontal row-fluid');\r\n    var fd = document.createElement('div');\r\n    fd.setAttribute('class', 'terminus-control-group');\r\n    formDoc.appendChild(fd);\r\n    var urlLabel = document.createElement('label');\r\n    urlLabel.setAttribute('class', 'terminus-control-label');\r\n    urlLabel.setAttribute('for', 'basicinput');\r\n    urlLabel.innerHTML = 'Url:';\r\n    fd.appendChild(urlLabel);\r\n    var cd = document.createElement('div');\r\n    cd.setAttribute('class', 'terminus-controls');\r\n    fd.appendChild(cd);\r\n    var inpUrl = document.createElement('input');\r\n    inpUrl.setAttribute('type', 'text');\r\n    inpUrl.setAttribute('id', 'basicinput');\r\n    inpUrl.setAttribute('class', 'span8 terminus-input-text');\r\n    inpUrl.setAttribute('placeholder', urlPlaceholder);\r\n    cd.appendChild(inpUrl);\r\n    // add extra form fields based on current api chosen\r\n    switch(curApi){\r\n        case 'getClassFrames':\r\n            var fd = document.createElement('div');\r\n            fd.setAttribute('class', 'terminus-control-group');\r\n            formDoc.appendChild(fd);\r\n            var docUrlLabel = document.createElement('label');\r\n            docUrlLabel.setAttribute('class', 'terminus-control-label');\r\n            docUrlLabel.setAttribute('for', 'basicinput');\r\n            docUrlLabel.innerHTML = 'Url/ ID:';\r\n            fd.appendChild(docUrlLabel);\r\n            var cd = document.createElement('div');\r\n            cd.setAttribute('class', 'terminus-controls');\r\n            fd.appendChild(cd);\r\n            var inpDocUrl = document.createElement('input');\r\n            inpDocUrl.setAttribute('type', 'text');\r\n            inpDocUrl.setAttribute('id', 'basicinput');\r\n            inpDocUrl.setAttribute('class', 'span8 terminus-input-text');\r\n            inpDocUrl.setAttribute('placeholder', 'Url or ID of document class');\r\n            cd.appendChild(inpDocUrl);\r\n        break;\r\n        case 'schema':\r\n            //encoding\r\n           /* var fd = document.createElement('div');\r\n            fd.setAttribute('class', 'terminus-control-group');\r\n            formDoc.appendChild(fd);\r\n            var encLabel = document.createElement('label');\r\n            encLabel.setAttribute('class', 'terminus-control-label');\r\n            encLabel.setAttribute('for', 'basicinput');\r\n            encLabel.innerHTML = 'Encoding:';\r\n            fd.appendChild(encLabel);\r\n            var cd = document.createElement('div');\r\n            cd.setAttribute('class', 'terminus-controls');\r\n            fd.appendChild(cd);\r\n            var inpEnc = document.createElement('select');\r\n            inpEnc.setAttribute('style', 'height: 50px;width: 300px;padding: 10px;');\r\n            inpEnc.setAttribute('placeholder', 'turtle');\r\n            var optTurt = document.createElement('option');\r\n            optTurt.setAttribute('value', 'terminus:turtle');\r\n            optTurt.appendChild(document.createTextNode('turtle'));\r\n            inpEnc.appendChild(optTurt);\r\n            var optJld = document.createElement('option');\r\n            optJld.setAttribute('value', 'terminus:jsonld');\r\n            optJld.appendChild(document.createTextNode('jsonLD'));\r\n            inpEnc.appendChild(optJld);\r\n            cd.appendChild(inpEnc); */\r\n        break;\r\n    }\r\n    var fd = document.createElement('div');\r\n    fd.setAttribute('class', 'terminus-control-group');\r\n    formDoc.appendChild(fd);\r\n    var keyLabel = document.createElement('label');\r\n    keyLabel.setAttribute('class', 'terminus-control-label');\r\n    keyLabel.setAttribute('for', 'basicinput');\r\n    keyLabel.innerHTML = 'Key:';\r\n    fd.appendChild(keyLabel);\r\n    var cd = document.createElement('div');\r\n    cd.setAttribute('class', 'terminus-controls');\r\n    fd.appendChild(cd);\r\n    var inpKey = document.createElement('input');\r\n    inpKey.setAttribute('type', 'text');\r\n    inpKey.setAttribute('id', 'basicinput');\r\n    inpKey.setAttribute('class', 'span8 terminus-input-text');\r\n    inpKey.setAttribute('placeholder', 'Key');\r\n    cd.appendChild(inpKey);\r\n    if(!view){\r\n        // include text area only if call is type post\r\n        var fd = document.createElement('div');\r\n        fd.setAttribute('class', 'terminus-control-group');\r\n        formDoc.appendChild(fd);\r\n        var docLabel = document.createElement('label');\r\n        docLabel.setAttribute('class', 'terminus-control-label');\r\n        docLabel.setAttribute('for', 'basicinput');\r\n        if(curApi == 'query') docLabel.innerHTML = 'Query:';\r\n        docLabel.innerHTML = 'Document:';\r\n        fd.appendChild(docLabel);\r\n        var cd = document.createElement('div');\r\n        cd.setAttribute('class', 'terminus-controls');\r\n        fd.appendChild(cd);\r\n        var inpDoc = document.createElement('textarea');\r\n        cd.appendChild(inpDoc);\r\n        inpDoc.setAttribute('class', 'terminus-api-explorer-text-area');\r\n        UTILS.stylizeEditor(this.ui, inpDoc, 'api-doc', 'javascript');\r\n    }\r\n    body.appendChild(formDoc);\r\n    // gather inputs\r\n    var inp ={};\r\n    inp.url = inpUrl;\r\n    inp.key = inpKey;\r\n    if(curApi == 'getClassFrames') inp.docUrl = inpDocUrl;\r\n    //if(curApi == 'schema') inp.enc = inpEnc;\r\n    if(!view) inp.doc = inpDoc;\r\n    var form = this.getApiSendButton(action, inp);\r\n    body.appendChild(form);\r\n}\r\n\r\n// define event listeners on send api of schema & documents\r\n\r\nApiExplorer.prototype.getApiForm = function(action, input){\r\n  // form\r\n  var form = document.createElement('form');\r\n  form.setAttribute('class', 'terminus-form-horizontal row-fluid');\r\n\r\n  var button = document.createElement('button');\r\n  button.setAttribute('class', 'terminus-btn terminus-send-api-btn');\r\n  button.setAttribute('type', 'button');\r\n  button.innerHTML = 'Send Api';\r\n  form.appendChild(button);\r\n  var resd = document.createElement('div');\r\n  form.appendChild(resd);\r\n  var self = this;\r\n  switch(action){\r\n    case 'getSchema':\r\n      button.addEventListener(\"click\", function(){\r\n        var opts = {};\r\n        opts['terminus:encoding'] = input.enc.value;\r\n        opts['terminus:user_key'] = 'terminus:turtle';\r\n        var schurl = input.url.value;\r\n        var buttonSelf = this;\r\n        self.client.getSchema(schurl, opts)\r\n        .then(function(response){\r\n          TerminusClient.FrameHelper.removeChildren(resd);\r\n          var resultDom = UTILS.showHttpResult(response, 'getSchema', resd, self.ui);\r\n        });\r\n      }) // button click\r\n    break;\r\n    case 'updateSchema':\r\n      button.addEventListener(\"click\", function(){\r\n        var buttonSelf = this;\r\n        opts = {};\r\n        opts['terminus:encoding'] = input.enc.value;\r\n        opts['terminus:user_key'] = 'terminus:turtle';\r\n        var schurl = input.url.value;\r\n        self.client.connectionConfig.connected_mode = false;\r\n        self.client.updateSchema(schurl, input.doc.value, opts)\r\n        .then(function(response){\r\n          var gtxtar = document.createElement('textarea');\r\n          gtxtar.setAttribute('readonly', true);\r\n          gtxtar.innerHTML = response;\r\n          var currForm = buttonSelf.parentNode;\r\n          currForm.appendChild(gtxtar);\r\n          UTILS.stylizeEditor(this.ui, txtar, 'schema', 'turtle');\r\n        });\r\n      }) // button click\r\n    break;\r\n    case 'viewDocument':\r\n      button.addEventListener(\"click\", function(){\r\n      var dcurl = input.value;\r\n      var buttonSelf = this;\r\n      var opts = {};\r\n      opts.format = 'turtle';\r\n      self.client.getDocument(dcurl, opts)\r\n      .then(function(response){\r\n        TerminusClient.FrameHelper.removeChildren(resd);\r\n        var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n      });\r\n    }) // button click\r\n    break;\r\n    case 'deleteDocument':\r\n      button.addEventListener(\"click\", function(){\r\n      var dcurl = input.value;\r\n      var buttonSelf = this;\r\n      var opts = {};\r\n      self.client.deleteDocument(dcurl, opts)\r\n      .then(function(response){\r\n        TerminusClient.FrameHelper.removeChildren(resd);\r\n        var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n      });\r\n    }) // button click\r\n    break;\r\n    case 'createDocument':\r\n      button.addEventListener(\"click\", function(){\r\n        var dcurl = input.schemaUrlDom.value;\r\n        var payload = input.htmlEditor.getValue();\r\n        var buttonSelf = this;\r\n        opts = {};\r\n        self.client.createDocument(dcurl, payload, opts)\r\n        .then(function(response){\r\n          TerminusClient.FrameHelper.removeChildren(resd);\r\n          var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n        });\r\n      }) // button click\r\n    break;\r\n    case 'updateDocument':\r\n      button.addEventListener(\"click\", function(){\r\n        var dcurl = input.schemaUrlDom.value;\r\n        var payload = input.htmlEditor.getValue();\r\n        var buttonSelf = this;\r\n        opts = {};\r\n        opts.editmode = 'replace';\r\n        opts.format = 'json';\r\n        self.client.updateDocument(dcurl, payload, opts)\r\n        .then(function(response){\r\n          TerminusClient.FrameHelper.removeChildren(resd);\r\n          var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n        });\r\n      }) // button click\r\n    break;\r\n  } // switch(action)\r\n\r\n  var br = document.createElement('BR');\r\n  form.appendChild(br);\r\n  var br = document.createElement('BR');\r\n  form.appendChild(br);\r\n\r\n  return form;\r\n} // getApiForm()\r\n\r\n\r\n// define event listeners on send api of schema & documents\r\nApiExplorer.prototype.getApiSendButton = function(action, input){\r\n    // form\r\n    var form = document.createElement('form');\r\n    form.setAttribute('class', 'terminus-form-horizontal row-fluid');\r\n    var button = document.createElement('button');\r\n    button.setAttribute('class', 'terminus-btn terminus-send-api-btn');\r\n    button.setAttribute('type', 'button');\r\n    button.innerHTML = 'Send Api';\r\n    form.appendChild(button);\r\n    var resd = document.createElement('div');\r\n    form.appendChild(resd);\r\n    var self = this;\r\n    switch(action){\r\n        case 'connect':\r\n            button.addEventListener(\"click\", function(){\r\n                self.client.connect(input.url.value, input.key.value)\r\n                .then(function(response){\r\n                \tTerminusClient.FrameHelper.removeChildren(resd);\r\n                    var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n               });\r\n            }) // button click\r\n        break;\r\n        case 'create':\r\n            button.addEventListener(\"click\", function(form){\r\n              self.client.createDatabase(input.url.value, JSON.parse(input.doc.value), input.key.value)\r\n              .then(function(response){\r\n            \t  TerminusClient.FrameHelper.removeChildren(resd);\r\n                  var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n              });\r\n            }) // button click\r\n        break;\r\n        case 'delete':\r\n            button.addEventListener(\"click\", function(){\r\n              var opts ={}\r\n              self.client.deleteDatabase(input.url.value, input.key.value)\r\n              .then(function(response){\r\n            \t  TerminusClient.FrameHelper.removeChildren(resd);\r\n                  var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n              });\r\n            }) // button click\r\n        break\r\n        case 'getSchema':\r\n            button.addEventListener(\"click\", function(){\r\n                var opts = {};\r\n                opts['terminus:encoding'] = 'terminus:turtle';\r\n                opts['terminus:user_key'] = input.key.value;\r\n                var schurl = input.url.value;\r\n                self.client.getSchema(schurl, opts)\r\n                .then(function(response){\r\n                \tTerminusClient.FrameHelper.removeChildren(resd);\r\n                    var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n                });\r\n            }) // button click\r\n        break;\r\n        case 'updateSchema':\r\n            button.addEventListener(\"click\", function(){\r\n                opts = {};\r\n                opts['terminus:encoding'] = 'terminus:turtle';\r\n                opts['terminus:user_key'] = input.key.value;\r\n                var payload = input.doc.value;\r\n                var schurl = input.url.value;\r\n                self.client.connectionConfig.connected_mode = false;\r\n                self.client.updateSchema(schurl, input.doc.value, opts)\r\n                //self.client.updateSchema(schurl, input.doc.value, opts)\r\n                .then(function(response){\r\n                \tTerminusClient.FrameHelper.removeChildren(resd);\r\n                    var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n                });\r\n            }) // button click\r\n        break;\r\n        case 'getClassFrames':\r\n            button.addEventListener(\"click\", function(form){\r\n                var schurl = input.url.value;\r\n                opts = {};\r\n                opts.explorer = true;\r\n                self.client.getClassFrame(input.url, JSON.parse(input.docUrl.value), opts)\r\n                .then(function(response){\r\n                    var currForm = buttonSelf.parentNode;\r\n                    var resultDom = UTILS.showHttpResult(response, action, currForm, self.ui);\r\n                });\r\n            }) // button click\r\n        break;\r\n        case 'viewDocument':\r\n          button.addEventListener(\"click\", function(){\r\n              var dcurl = input.url.value;\r\n              var opts = {};\r\n              opts['terminus:encoding'] = \"jsonld\";\r\n              opts['terminus:user_key'] = input.key.value;\r\n              self.client.getDocument(dcurl, opts)\r\n              .then(function(response){\r\n            \t    TerminusClient.FrameHelper.removeChildren(resd);\r\n                    var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n              });\r\n        }) // button click\r\n        break;\r\n        case 'deleteDocument':\r\n          button.addEventListener(\"click\", function(){\r\n              var dcurl = input.url.value;\r\n              var opts = {};\r\n              opts.key = input.key.value;\r\n              self.client.deleteDocument(dcurl, opts)\r\n              .then(function(response){\r\n            \t  TerminusClient.FrameHelper.removeChildren(resd);\r\n                  var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n              });\r\n          }) // button click\r\n        break;\r\n        case 'createDocument':\r\n          button.addEventListener(\"click\", function(){\r\n              var dcurl = input.url.value;\r\n              var payload = input.doc.value;\r\n              opts = {};\r\n              opts['terminus:encoding'] = \"jsonld\";\r\n              opts['terminus:user_key'] = input.key.value;\r\n              self.client.createDocument(dcurl, JSON.parse(payload), opts)\r\n              .then(function(response){\r\n            \t   TerminusClient.FrameHelper.removeChildren(resd);\r\n                   var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n               });\r\n          }) // button click\r\n        break;\r\n        case 'updateDocument':\r\n          button.addEventListener(\"click\", function(){\r\n            var dcurl = input.url.value;\r\n            var payload = input.doc.value;\r\n            var buttonSelf = this;\r\n            opts = {};\r\n            opts['terminus:encoding'] = \"jsonld\";\r\n            opts['terminus:user_key'] = input.key.value;\r\n            self.client.updateDocument(dcurl, JSON.parse(payload), opts)\r\n            .then(function(response){\r\n            \tTerminusClient.FrameHelper.removeChildren(resd);\r\n                var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n            });\r\n          }) // button click\r\n        break;\r\n        case 'select':\r\n            button.addEventListener(\"click\", function(){\r\n                var opts = {};\r\n                opts.key = input.key.value;\r\n                var doc = JSON.parse(input.doc.value);\r\n                self.client.select(input.url.value, doc, opts)\r\n                .then(function(response){\r\n                \tTerminusClient.FrameHelper.removeChildren(resd);\r\n                    var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n                });\r\n            }) // button click\r\n        break;\r\n        case 'update':\r\n            button.addEventListener(\"click\", function(){\r\n              var opts = {};\r\n              opts.key = input.key.value;\r\n              var doc = JSON.parse(input.doc.value);\r\n              self.client.update(input.url.value, doc, opts)\r\n              .then(function(response){\r\n            \t  TerminusClient.FrameHelper.removeChildren(resd);\r\n                  var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n              });\r\n            }) // button click\r\n        break;\r\n        default:\r\n            console.log('Invalid Api call on button');\r\n        break;\r\n    } // switch(action)\r\n    var br = document.createElement('BR');\r\n    form.appendChild(br);\r\n    var br = document.createElement('BR');\r\n    form.appendChild(br);\r\n    return form;\r\n} // getApiSendButton()\r\n\r\n// get signature of api calls\r\nApiExplorer.prototype.getSignature = function(action){\r\n    var api = document.createElement('div');\r\n    // get header signature\r\n    var sg = document.createElement('button');\r\n    sg.appendChild(document.createTextNode('Click to read API Signature'));\r\n    sg.setAttribute('class', 'terminus-collapsible');\r\n    ic = document.createElement('i');\r\n    ic.setAttribute('class', 'terminus-cheveron-float fa fa-chevron-down');\r\n    sg.appendChild(ic);\r\n    api.appendChild(sg);\r\n    var br = document.createElement('BR');\r\n    api.appendChild(br);\r\n    var cl = document.createElement('div');\r\n    cl.setAttribute('class', 'terminus-collapsible-content content');\r\n    var sig = UTILS.getFunctionSignature(action);\r\n    var txt = document.createTextNode(sig.spec);\r\n    var pre = document.createElement('pre');\r\n    pre.setAttribute('class', 'terminus-api-signature-pre');\r\n    pre.appendChild(txt);\r\n    var txt =  document.createTextNode(sig.descr);\r\n    pre.appendChild(txt);\r\n    var br = document.createElement('BR');\r\n    pre.appendChild(br);\r\n    var br = document.createElement('BR');\r\n    pre.appendChild(br);\r\n    var txt = document.createTextNode(sig.result);\r\n    pre.appendChild(txt);\r\n    cl.appendChild(pre);\r\n    api.appendChild(cl);\r\n    var br = document.createElement('BR');\r\n    api.appendChild(br);\r\n    sg.addEventListener('click', function(){\r\n        UTILS.tolggleContent(ic, cl);\r\n    });\r\n    return api;\r\n} // getSignature()\r\n\r\n// displays signature only on click\r\nfunction tolggleSignatureContent(content){\r\n    if (content.style.display === \"block\")\r\n        content.style.display = \"none\";\r\n    else content.style.display = \"block\";\r\n}\r\n\r\nmodule.exports=ApiExplorer\r\n","\r\nconst CONST = require('./const');\r\nconst DispatchRequest = require('./dispatchRequest');\r\nconst ErrorMessage = require('./errorMessage');\r\nconst ConnectionCapabilities = require('./connectionCapabilities');\r\nconst ConnectionConfig = require('./connectionConfig');\r\nconst UTILS = require('./utils.js');\r\n\r\n/**\r\n * @file Javascript WOQL client object\r\n * @license Apache Version 2\r\n * @summary Simple Javascript Client for accessing the Terminus DB API\r\n */\r\n\r\n/**\r\n  * @param {Object} params\r\n  */\r\nfunction WOQLClient(params) {\r\n\t// current connection context variables\r\n\tconst key = params ? params.key : undefined;\r\n\tthis.use_fetch = false;\r\n\tthis.return_full_response = false;\r\n\tthis.connectionConfig = new ConnectionConfig(params);\r\n\tthis.connection = new ConnectionCapabilities(this.connectionConfig, key);\r\n}\r\n\r\nWOQLClient.CONST = CONST;\r\n\r\n/**\r\n * Connect to a Terminus server at the given URI with an API key\r\n * Stores the terminus:ServerCapability document returned\r\n * in the connection register which stores, the url, key, capabilities,\r\n * and database meta-data for the connected server\r\n *\r\n * If the curl argument is false or null,\r\n * this.connectionConfig.server will be used if present,\r\n * or the promise will be rejected.\r\n\r\n * @param  {string} curl Terminus server URI\r\n * @param  {string} API  key\r\n * @return {Promise}\r\n * @public\r\n */\r\nWOQLClient.prototype.connect = function (curl, key) {\r\n\tif (curl && !this.connectionConfig.setServer(curl)) {\r\n\t\treturn Promise.reject(\r\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(curl, CONST.CONNECT))\r\n\t\t);\r\n\t}\r\n\tconst serverURL = this.connectionConfig.serverURL();\r\n\tif (key) {\r\n\t\tthis.connection.setClientKey(serverURL, key);\r\n\t}\r\n\t// unset the current server setting until successful connect\r\n\tthis.connectionConfig.server = false;\r\n\tconst self = this;\r\n\treturn this.dispatch(serverURL, CONST.CONNECT).then((response) => {\r\n\t\tself.connectionConfig.server = serverURL;\r\n\t\tself.connection.addConnection(serverURL, response);\r\n\t\treturn response;\r\n\t});\r\n};\r\n\r\n/**\r\n * Create a Terminus Database by posting\r\n * a terminus:Database document to the Terminus API\r\n *\r\n * The dburl argument can be\r\n *    1) a valid URL of a terminus database or\r\n *    2) a valid Terminus database id or\r\n *    3) can be omitted\r\n * \t\tin case 2) the current server will be used,\r\n * \t\tin case 3) the database id will be set from the @id field of the terminuse:Database document.\r\n *\r\n * The second (details) argument contains a terminus:Database document\r\n * with a mandatory rdfs:label field and an optional rdfs:comment field.\r\n * The third (key) argument contains an optional API key\r\n *\r\n * @param {string} dburl Terminus server URI or a TerminusID\r\n * @param {object} details\r\n * @param {string} key\r\n * @return {Promise}\r\n * @public\r\n */\r\nWOQLClient.prototype.createDatabase = function (dburl, details, key) {\r\n\tif (dburl && !this.connectionConfig.setDB(dburl)) {\r\n\t\treturn Promise.reject(\r\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(dburl, 'Create Database'))\r\n\t\t);\r\n\t}\r\n\tif (\r\n\t\tdetails\r\n    && details['@id']\r\n    && !this.connectionConfig.setDB(details['@id'], details['@context'])\r\n\t) {\r\n\t\treturn Promise.reject(\r\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(details['@id'], 'Create Database'))\r\n\t\t);\r\n\t}\r\n\tdetails = this.makeDocumentConsistentWithURL(details, this.connectionConfig.dbURL());\r\n\r\n\tconst opts = {};\r\n\tif (key) {\r\n\t\topts.key = key;\r\n\t}\r\n\tconst doc = this.addOptionsToDocument(details, opts);\r\n\treturn this.dispatch(this.connectionConfig.dbURL('create'), CONST.CREATE_DATABASE, doc);\r\n};\r\n\r\n/**\r\n * Delete a Database\r\n * @param {String} dburl it is a terminusDB Url or a terminusDB Id\r\n * @param {String} key an optional API key\r\n * @return {Promise}\r\n *\r\n * if dburl is omitted, the current server and database will be used\r\n */\r\nWOQLClient.prototype.deleteDatabase = function (dburl, key) {\r\n\tif (dburl && !this.connectionConfig.setDB(dburl)) {\r\n\t\treturn Promise.reject(\r\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(dburl, 'Delete Database'))\r\n\t\t);\r\n\t}\r\n\tconst opts = {};\r\n\r\n\tif (key) {\r\n\t\topts.key = key;\r\n\t}\r\n\r\n\tconst self = this;\r\n\treturn this.dispatch(`${this.connectionConfig.dbURL()}`, CONST.DELETE_DATABASE, opts).then(\r\n\t\t(response) => {\r\n\t\t\tself.connection.removeDB();\r\n\t\t\treturn response;\r\n\t\t}\r\n\t);\r\n};\r\n\r\n/**\r\n * Retrieves the schema of the specified database\r\n *\r\n * @param {string} schurl TerminusDB server URL or a valid TerminusDB Id or omitted\r\n * @param {object} opts is an options object\r\n * @return {Promise}\r\n *\r\n * opts.format is optional and defines which format is requested (*json / turtle)\r\n * opts.key is an optional API key\r\n */\r\nWOQLClient.prototype.getSchema = function (schurl, opts) {\r\n\tif (schurl && !this.connectionConfig.setSchemaURL(schurl)) {\r\n\t\treturn Promise.reject(\r\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(schurl, 'Get Schema'))\r\n\t\t);\r\n\t}\r\n\t// consoleco.log('schemaURL', this.connectionConfig.schemaURL());\r\n\treturn this.dispatch(this.connectionConfig.schemaURL(), CONST.GET_SCHEMA, opts);\r\n};\r\n\r\n/**\r\n * Updates the Schema of the specified database\r\n *\r\n * @param {string} schurl TerminusDB server URL or a valid TerminusDB Id or omitted\r\n * @param {object} doc is a valid owl ontology in json-ld or turtle format\r\n * @param {object} opts is an options object\r\n * @return {Promise}\r\n *\r\n * if omitted the current server and database will be used\r\n * opts.format is used to specify which format is being used (*json / turtle)\r\n * opts.key is an optional API key\r\n */\r\nWOQLClient.prototype.updateSchema = function (schurl, doc, opts) {\r\n\tif (schurl && !this.connectionConfig.setSchemaURL(schurl)) {\r\n\t\treturn Promise.reject(\r\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(schurl, 'Update Schema'))\r\n\t\t);\r\n\t}\r\n\tdoc = this.addOptionsToDocument(doc, opts);\r\n\treturn this.dispatch(this.connectionConfig.schemaURL(), 'update_schema', doc);\r\n};\r\n\r\n/**\r\n * Creates a new document in the specified database\r\n *\r\n * The first (docurl) argument can be\r\n * 1) a valid URL of a terminus database (an id will be randomly assigned) or\r\n * 2) a valid URL or of a terminus document (the document will be given the passed URL) or\r\n * 3) a valid terminus document id (the current server and database will be used)\r\n * 4) can be omitted (the URL will be taken from the document if present)\r\n * The second argument (doc) is a valid document in json-ld\r\n * the third argument (opts) is an options json - opts.key is an optional API key\r\n */\r\nWOQLClient.prototype.createDocument = function (docurl, doc, opts) {\r\n\tif (docurl && !this.connectionConfig.setDocument(docurl)) {\r\n\t\treturn Promise.reject(\r\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(docurl, 'Create Document'))\r\n\t\t);\r\n\t} if (\r\n\t\tdoc\r\n    && doc['@id']\r\n    && !this.connectionConfig.setDocument(doc['@id'], doc['@context'])\r\n\t) {\r\n\t\treturn Promise.reject(\r\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(doc['@id'], 'Create Document'))\r\n\t\t);\r\n\t}\r\n\tdoc = this.addOptionsToDocument(\r\n\t\tthis.makeDocumentConsistentWithURL(doc, this.connectionConfig.docURL()),\r\n\t\topts\r\n\t);\r\n\treturn this.dispatch(this.connectionConfig.docURL(), 'create_document', doc);\r\n};\r\n\r\n/**\r\n * Retrieves a document from the specified database\r\n *\r\n * The first (docurl) argument can be\r\n * 1) a valid URL of a terminus document or\r\n * 2) a valid ID of a terminus document in the current database\r\n * the second argument (opts) is an options json -\r\n * \t\topts.key is an optional API key\r\n * \t\topts.shape is frame | *document\r\n */\r\nWOQLClient.prototype.getDocument = function (docurl, opts) {\r\n\tif (docurl && (!this.connectionConfig.setDocument(docurl) || !this.connectionConfig.docid)) {\r\n\t\treturn Promise.reject(\r\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(docurl, 'Get Document'))\r\n\t\t);\r\n\t}\r\n\treturn this.dispatch(this.connectionConfig.docURL(), 'get_document', opts);\r\n};\r\n\r\n/**\r\n * Updates a document in the specified database with a new version\r\n *\r\n * The first (docurl) argument can be\r\n * 1) a valid URL of a terminus document or\r\n * 2) a valid ID of a terminus document in the current database or\r\n * 3) omitted in which case the id will be taken from the document @id field\r\n * the second argument (doc) is a document in json-ld format\r\n * the third argument (opts) is an options json - opts.key is an optional API key\r\n */\r\nWOQLClient.prototype.updateDocument = function (docurl, doc, opts) {\r\n\tif (docurl && !this.connectionConfig.setDocument(docurl)) {\r\n\t\treturn Promise.reject(\r\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(docurl, 'Update Document'))\r\n\t\t);\r\n\t}\r\n\tif (doc && doc['@id']\r\n    && !this.connectionConfig.setDocument(doc['@id'], doc['@context'])\r\n\t) {\r\n\t\treturn Promise.reject(\r\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(doc['@id'], 'Update Document'))\r\n\t\t);\r\n\t}\r\n\tdoc = this.addOptionsToDocument(\r\n\t\tthis.makeDocumentConsistentWithURL(doc, this.connectionConfig.docURL()),\r\n\t\topts\r\n\t);\r\n\treturn this.dispatch(this.connectionConfig.docURL(), 'update_document', doc);\r\n};\r\n\r\n/**\r\n * Deletes a document from the specified database\r\n *\r\n * The first (docurl) argument can be\r\n * 1) a valid URL of a terminus document or\r\n * 2) a valid ID of a terminus document in the current database\r\n * 3) omitted - the current document will be used\r\n * the second argument (opts) is an options json - opts.key is an optional API key\r\n */\r\nWOQLClient.prototype.deleteDocument = function (docurl, opts) {\r\n\tif (docurl && (!this.connectionConfig.setDocument(docurl) || !this.connectionConfig.docid)) {\r\n\t\treturn Promise.reject(\r\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(docurl, 'Delete Document'))\r\n\t\t);\r\n\t}\r\n\treturn this.dispatch(this.connectionConfig.docURL(), 'delete_document', opts);\r\n};\r\n\r\n/**\r\n * Executes a read-only WOQL query on the specified database and returns the results\r\n *\r\n * @param {string} qurl TerminusDB server URL or omitted (the current DB will be used)\r\n * @param {string} woql is a \"woql query select statement\"\r\n * @param {object} opts it can contents the API key (opts.key)\r\n *\r\n */\r\nWOQLClient.prototype.select = function (qurl, woql, opts) {\r\n\tif (qurl && !this.connectionConfig.setQueryURL(qurl)) {\r\n\t\treturn Promise.reject(\r\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(qurl, 'Select'))\r\n\t\t);\r\n\t}\r\n\tlet q = { 'terminus:query': JSON.stringify(woql) };\r\n\tq = this.addOptionsToWOQL(q, opts);\r\n\treturn this.dispatch(this.connectionConfig.queryURL(), CONST.WOQL_SELECT, q);\r\n};\r\n\r\n/**\r\n * Executes a WOQL query on the specified database which updates the state and returns the results\r\n *\r\n * The first (qurl) argument can be\r\n * 1) a valid URL of a terminus database or\r\n * 2) omitted - the current database will be used\r\n * the second argument (woql) is a woql select statement encoded as a string\r\n * the third argument (opts) is an options json - opts.key is an optional API key\r\n */\r\nWOQLClient.prototype.update = function (qurl, woql, opts) {\r\n\tif (qurl && !this.connectionConfig.setQueryURL(qurl)) {\r\n\t\treturn Promise.reject(\r\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(qurl, 'Update'))\r\n\t\t);\r\n\t}\r\n\twoql = this.addOptionsToWOQL(woql, opts);\r\n\treturn this.dispatch(this.connectionConfig.queryURL(), 'woql_update', woql);\r\n};\r\n\r\n/**\r\n * Retrieves a WOQL query on the specified database which updates the state and returns the results\r\n *\r\n * The first (cfurl) argument can be\r\n * 1) a valid URL of a terminus database or\r\n * 2) omitted - the current database will be used\r\n * the second argument (cls) is the URL / ID of a document class that exists in the database schema\r\n * the third argument (opts) is an options json - opts.key is an optional API key\r\n */\r\nWOQLClient.prototype.getClassFrame = function (cfurl, cls, opts) {\r\n\tif (cfurl && !this.connectionConfig.setClassFrameURL(cfurl)) {\r\n\t\treturn Promise.reject(\r\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(cfurl, 'Get Class Frame'))\r\n\t\t);\r\n\t}\r\n\tif (!opts) opts = {};\r\n\topts['terminus:class'] = cls;\r\n\treturn this.dispatch(this.connectionConfig.frameURL(), 'class_frame', opts);\r\n};\r\n\r\n/*\r\n * Utility functions for adding standard fields to API arguments\r\n */\r\nWOQLClient.prototype.addOptionsToWOQL = function (woql, opts) {\r\n\tif (opts && opts.key) {\r\n\t\twoql.key = opts.key;\r\n\t}\r\n\treturn woql;\r\n};\r\n\r\nWOQLClient.prototype.addOptionsToDocument = function (doc, opts) {\r\n\tconst pdoc = {};\r\n\tpdoc['@context'] = doc['@context'];\r\n\tif (pdoc['@context'] && doc['@id']) { // add blank node prefix as document base url\r\n\t\tpdoc['@context']._ = `${doc['@id']}/`;\r\n\t}\r\n\tif (opts && opts['terminus:encoding'] && opts['terminus:encoding'] === 'terminus:turtle') {\r\n\t\tpdoc['terminus:turtle'] = doc;\r\n\t\tpdoc['terminus:schema'] = this.connectionConfig.schemaURL();\r\n\t\tdelete pdoc['terminus:turtle']['@context'];\r\n\t} else {\r\n\t\tpdoc['terminus:document'] = doc;\r\n\t\tdelete pdoc['terminus:document']['@context'];\r\n\t}\r\n\tpdoc['@type'] = 'terminus:APIUpdate';\r\n\tif (opts && opts['terminus:user_key']) {\r\n\t\tpdoc['terminus:user_key'] = opts['terminus:user_key'];\r\n\t}\r\n\tif (opts && opts.key) {\r\n\t\tpdoc['terminus:user_key'] = opts.key;\r\n\t}\r\n\treturn pdoc;\r\n};\r\n\r\nWOQLClient.prototype.addKeyToPayload = function (payload, url) {\r\n\tif (typeof payload !== 'object')payload = {};\r\n\tif (payload.key) {\r\n\t\tpayload['terminus:user_key'] = payload.key;\r\n\t\tdelete payload.key;\r\n\t} else if (this.connection.getClientKey()) {\r\n\t\tpayload['terminus:user_key'] = this.connection.getClientKey();\r\n\t} else if (this.connection.getClientKey(url)) {\r\n\t\tpayload['terminus:user_key'] = this.connection.getClientKey(url);\r\n\t}\r\n\treturn payload;\r\n};\r\n\r\nWOQLClient.prototype.makeDocumentConsistentWithURL = function (doc, dburl) {\r\n\tdoc['@id'] = dburl;\r\n\treturn doc;\r\n};\r\n\r\nWOQLClient.prototype.dispatch = function (url, action, payload) {\r\n\tif (this.connectionConfig.includeKey()) {\r\n\t\tpayload = this.addKeyToPayload(payload, url);\r\n\t}\r\n\tif (this.use_fetch) {\r\n\t\treturn this.dispatchFetch(url, action, payload);\r\n\t}\r\n\treturn DispatchRequest(url, action, payload);\r\n};\r\n\r\n\r\nWOQLClient.prototype.dispatchFetch = function (url, action, payload) {\r\n\tconst api = {\r\n\t\t//mode: 'cors',  no-cors, cors, *same-origin\r\n\t\tredirect: 'follow', // manual, *follow, error\r\n\t\treferrer: 'client', // no-referrer, *client\r\n\t};\r\n\tlet hdrs = {};\r\n\tif (this.connectionConfig.platformEndpoint()) {\r\n\t\tapi.credentials = 'include'; // include, *same-origin, omit\r\n\t}\r\n\tif (payload && payload['terminus:user_key']) {\r\n\t\thdrs = { Authorization: `Basic ${btoa(`:${payload['terminus:user_key']}`)}` };\r\n\t\tdelete (payload['terminus:user_key']);\r\n\t}\r\n\t// read only API calls - use GET\r\n\tswitch (action) {\r\n\tcase CONST.DELETE_DATABASE:\r\n\tcase CONST.DELETE_DOCUMENT:\r\n\t\tif (Object.keys(payload).length > 0) url += `?${UTILS.URIEncodePayload(payload)}`;\r\n\t\tapi.method = 'DELETE';\r\n\t\tapi.cache = 'no-cache';\r\n\t\tbreak;\r\n\tcase CONST.CREATE_DATABASE:\r\n\tcase CONST.UPDATE_SCHEMA:\r\n\tcase CONST.CREATE_DOCUMENT:\r\n\tcase CONST.UPDATE_DOCUMENT:\r\n\tcase CONST.WOQL_UPDATE:\r\n\t\tapi.method = 'POST';\r\n\t\tapi.cache = 'no-cache';\r\n\t\thdrs['Content-Type'] = 'application/json';\r\n\t\tapi.body = JSON.stringify(payload);\r\n\t\tbreak;\r\n\tcase CONST.GET_SCHEMA:\r\n\tcase CONST.CONNECT:\r\n\tcase CONST.CLASS_FRAME:\r\n\tcase CONST.WOQL_SELECT:\r\n\tcase CONST.GET_DOCUMENT:\r\n\tdefault:\r\n\t\tapi.method = 'GET';\r\n\t\tif (Object.keys(payload).length > 0) url += `?${UTILS.URIEncodePayload(payload)}`;\r\n\t}\r\n\tconst self = this;\r\n\tif (Object.keys(hdrs).length > 0) {\r\n\t\tapi.headers = new Headers(hdrs);\r\n\t}\r\n\treturn fetch(url, api).then((response) => {\r\n\t\tif (self.return_full_response) return response;\r\n\t\tif (response.ok) {\r\n\t\t\treturn response.json();\r\n\t\t}\r\n\t\tself.error = self.parseAPIError(response);\r\n\t\treturn Promise.reject(new Error(self.getAPIErrorMessage(url, api, self.error)));\r\n\t});\r\n};\r\n\r\nmodule.exports = WOQLClient;\r\n","const axios = require('axios');\nconst UTILS = require('./utils.js');\nconst CONST = require('./const.js');\nconst ErrorMessage = require('./errorMessage');\n/*\nAccess-Control-Allow-Credentials   true\nAccess-Control-Allow-Headers  X-PINGOTHER, Content-Type\nAccess-Control-Allow-Methods GET, POST, PUT, PATCH, DELETE, HEAD, OPTIONS\nAccess-Control-Allow-Origin: http://localhost:3000 // WILD CARD WILL NOT WORK WHEN POSTING\n*/\n\nfunction btoaImplementation(str) {\n\ttry {\n\t\treturn btoa(str);\n\t} catch (err) {\n\t\t// console.log('in buffer')\n\t\treturn Buffer.from(str).toString('base64');\n\t}\n}\n\nfunction DispatchRequest(url, action, payload) {\n\t/*\n\t*CORS is only required when trying to fetch data from a browser,\n\t*as browsers by default will block requests to different origins\n\t*/\n\tconst options = {\n\t\tmode: 'cors', // no-cors, cors, *same-origin\n\t\tredirect: 'follow', // manual, *follow, error\n\t\treferrer: 'client',\n\t\t// url:url,\n\t\t// no-referrer, *client\n\t};\n\tif (payload && payload['terminus:user_key']) {\n\t\toptions.headers = { Authorization: `Basic ${btoaImplementation(`:${payload['terminus:user_key']}`)}` };\n\t\tdelete (payload['terminus:user_key']);\n\t}\n\n\tswitch (action) {\n\tcase CONST.DELETE_DATABASE:\n\tcase CONST.DELETE_DOCUMENT:\n\t\tif (payload) {\n\t\t\tconst ext = UTILS.URIEncodePayload(payload);\n\t\t\tif (ext) url += `?${ext}`;\n\t\t}\n\t\treturn axios.delete(url, options)\n\t\t\t.then(response => response.data)\n\t\t\t.catch((err) => {\n\t\t\t\tthrow new Error(ErrorMessage.getAPIErrorMessage(url, options, err));\n\t\t\t});\n\tcase CONST.CREATE_DATABASE:\n\tcase CONST.UPDATE_SCHEMA:\n\tcase CONST.CREATE_DOCUMENT:\n\tcase CONST.UPDATE_DOCUMENT:\n\tcase CONST.WOQL_UPDATE:\n\t\toptions.headers = options.headers ? options.headers : {};\n\t\toptions.headers['Content-Type'] = 'application/json';\n\t\treturn axios.post(url, JSON.stringify(payload), options)\n\t\t\t.then(response => response.data)\n\t\t\t.catch((err) => {\n\t\t\t\tconst e = new Error(ErrorMessage.getAPIErrorMessage(url, options, err));\n\t\t\t\tif (err.response && err.response.data) e.data = err.response.data;\n\t\t\t\tthrow e;\n\t\t\t});\n\tcase CONST.GET_SCHEMA:\n\tcase CONST.CONNECT:\n\tcase CONST.CLASS_FRAME:\n\tcase CONST.WOQL_SELECT:\n\tcase CONST.GET_DOCUMENT:\n\tdefault:\n\t\tif (payload) {\n\t\t\tconst ext = UTILS.URIEncodePayload(payload);\n\t\t\tif (ext) url += `?${ext}`;\n\t\t}\n\t\treturn axios.get(url, options)\n\t\t\t.then((response => response.data))\n\t\t\t.catch((err) => {\n\t\t\t\tthrow new Error(ErrorMessage.getAPIErrorMessage(url, options, err));\n\t\t\t});\n\t}\n}\n\nmodule.exports = DispatchRequest;\n","/*!\n * The buffer module from node.js, for the browser.\n *\n * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>\n * @license  MIT\n */\n/* eslint-disable no-proto */\n\n'use strict'\n\nvar base64 = require('base64-js')\nvar ieee754 = require('ieee754')\nvar isArray = require('isarray')\n\nexports.Buffer = Buffer\nexports.SlowBuffer = SlowBuffer\nexports.INSPECT_MAX_BYTES = 50\n\n/**\n * If `Buffer.TYPED_ARRAY_SUPPORT`:\n *   === true    Use Uint8Array implementation (fastest)\n *   === false   Use Object implementation (most compatible, even IE6)\n *\n * Browsers that support typed arrays are IE 10+, Firefox 4+, Chrome 7+, Safari 5.1+,\n * Opera 11.6+, iOS 4.2+.\n *\n * Due to various browser bugs, sometimes the Object implementation will be used even\n * when the browser supports typed arrays.\n *\n * Note:\n *\n *   - Firefox 4-29 lacks support for adding new properties to `Uint8Array` instances,\n *     See: https://bugzilla.mozilla.org/show_bug.cgi?id=695438.\n *\n *   - Chrome 9-10 is missing the `TypedArray.prototype.subarray` function.\n *\n *   - IE10 has a broken `TypedArray.prototype.subarray` function which returns arrays of\n *     incorrect length in some situations.\n\n * We detect these buggy browsers and set `Buffer.TYPED_ARRAY_SUPPORT` to `false` so they\n * get the Object implementation, which is slower but behaves correctly.\n */\nBuffer.TYPED_ARRAY_SUPPORT = global.TYPED_ARRAY_SUPPORT !== undefined\n  ? global.TYPED_ARRAY_SUPPORT\n  : typedArraySupport()\n\n/*\n * Export kMaxLength after typed array support is determined.\n */\nexports.kMaxLength = kMaxLength()\n\nfunction typedArraySupport () {\n  try {\n    var arr = new Uint8Array(1)\n    arr.__proto__ = {__proto__: Uint8Array.prototype, foo: function () { return 42 }}\n    return arr.foo() === 42 && // typed array instances can be augmented\n        typeof arr.subarray === 'function' && // chrome 9-10 lack `subarray`\n        arr.subarray(1, 1).byteLength === 0 // ie10 has broken `subarray`\n  } catch (e) {\n    return false\n  }\n}\n\nfunction kMaxLength () {\n  return Buffer.TYPED_ARRAY_SUPPORT\n    ? 0x7fffffff\n    : 0x3fffffff\n}\n\nfunction createBuffer (that, length) {\n  if (kMaxLength() < length) {\n    throw new RangeError('Invalid typed array length')\n  }\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    // Return an augmented `Uint8Array` instance, for best performance\n    that = new Uint8Array(length)\n    that.__proto__ = Buffer.prototype\n  } else {\n    // Fallback: Return an object instance of the Buffer class\n    if (that === null) {\n      that = new Buffer(length)\n    }\n    that.length = length\n  }\n\n  return that\n}\n\n/**\n * The Buffer constructor returns instances of `Uint8Array` that have their\n * prototype changed to `Buffer.prototype`. Furthermore, `Buffer` is a subclass of\n * `Uint8Array`, so the returned instances will have all the node `Buffer` methods\n * and the `Uint8Array` methods. Square bracket notation works as expected -- it\n * returns a single octet.\n *\n * The `Uint8Array` prototype remains unmodified.\n */\n\nfunction Buffer (arg, encodingOrOffset, length) {\n  if (!Buffer.TYPED_ARRAY_SUPPORT && !(this instanceof Buffer)) {\n    return new Buffer(arg, encodingOrOffset, length)\n  }\n\n  // Common case.\n  if (typeof arg === 'number') {\n    if (typeof encodingOrOffset === 'string') {\n      throw new Error(\n        'If encoding is specified then the first argument must be a string'\n      )\n    }\n    return allocUnsafe(this, arg)\n  }\n  return from(this, arg, encodingOrOffset, length)\n}\n\nBuffer.poolSize = 8192 // not used by this implementation\n\n// TODO: Legacy, not needed anymore. Remove in next major version.\nBuffer._augment = function (arr) {\n  arr.__proto__ = Buffer.prototype\n  return arr\n}\n\nfunction from (that, value, encodingOrOffset, length) {\n  if (typeof value === 'number') {\n    throw new TypeError('\"value\" argument must not be a number')\n  }\n\n  if (typeof ArrayBuffer !== 'undefined' && value instanceof ArrayBuffer) {\n    return fromArrayBuffer(that, value, encodingOrOffset, length)\n  }\n\n  if (typeof value === 'string') {\n    return fromString(that, value, encodingOrOffset)\n  }\n\n  return fromObject(that, value)\n}\n\n/**\n * Functionally equivalent to Buffer(arg, encoding) but throws a TypeError\n * if value is a number.\n * Buffer.from(str[, encoding])\n * Buffer.from(array)\n * Buffer.from(buffer)\n * Buffer.from(arrayBuffer[, byteOffset[, length]])\n **/\nBuffer.from = function (value, encodingOrOffset, length) {\n  return from(null, value, encodingOrOffset, length)\n}\n\nif (Buffer.TYPED_ARRAY_SUPPORT) {\n  Buffer.prototype.__proto__ = Uint8Array.prototype\n  Buffer.__proto__ = Uint8Array\n  if (typeof Symbol !== 'undefined' && Symbol.species &&\n      Buffer[Symbol.species] === Buffer) {\n    // Fix subarray() in ES2016. See: https://github.com/feross/buffer/pull/97\n    Object.defineProperty(Buffer, Symbol.species, {\n      value: null,\n      configurable: true\n    })\n  }\n}\n\nfunction assertSize (size) {\n  if (typeof size !== 'number') {\n    throw new TypeError('\"size\" argument must be a number')\n  } else if (size < 0) {\n    throw new RangeError('\"size\" argument must not be negative')\n  }\n}\n\nfunction alloc (that, size, fill, encoding) {\n  assertSize(size)\n  if (size <= 0) {\n    return createBuffer(that, size)\n  }\n  if (fill !== undefined) {\n    // Only pay attention to encoding if it's a string. This\n    // prevents accidentally sending in a number that would\n    // be interpretted as a start offset.\n    return typeof encoding === 'string'\n      ? createBuffer(that, size).fill(fill, encoding)\n      : createBuffer(that, size).fill(fill)\n  }\n  return createBuffer(that, size)\n}\n\n/**\n * Creates a new filled Buffer instance.\n * alloc(size[, fill[, encoding]])\n **/\nBuffer.alloc = function (size, fill, encoding) {\n  return alloc(null, size, fill, encoding)\n}\n\nfunction allocUnsafe (that, size) {\n  assertSize(size)\n  that = createBuffer(that, size < 0 ? 0 : checked(size) | 0)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) {\n    for (var i = 0; i < size; ++i) {\n      that[i] = 0\n    }\n  }\n  return that\n}\n\n/**\n * Equivalent to Buffer(num), by default creates a non-zero-filled Buffer instance.\n * */\nBuffer.allocUnsafe = function (size) {\n  return allocUnsafe(null, size)\n}\n/**\n * Equivalent to SlowBuffer(num), by default creates a non-zero-filled Buffer instance.\n */\nBuffer.allocUnsafeSlow = function (size) {\n  return allocUnsafe(null, size)\n}\n\nfunction fromString (that, string, encoding) {\n  if (typeof encoding !== 'string' || encoding === '') {\n    encoding = 'utf8'\n  }\n\n  if (!Buffer.isEncoding(encoding)) {\n    throw new TypeError('\"encoding\" must be a valid string encoding')\n  }\n\n  var length = byteLength(string, encoding) | 0\n  that = createBuffer(that, length)\n\n  var actual = that.write(string, encoding)\n\n  if (actual !== length) {\n    // Writing a hex string, for example, that contains invalid characters will\n    // cause everything after the first invalid character to be ignored. (e.g.\n    // 'abxxcd' will be treated as 'ab')\n    that = that.slice(0, actual)\n  }\n\n  return that\n}\n\nfunction fromArrayLike (that, array) {\n  var length = array.length < 0 ? 0 : checked(array.length) | 0\n  that = createBuffer(that, length)\n  for (var i = 0; i < length; i += 1) {\n    that[i] = array[i] & 255\n  }\n  return that\n}\n\nfunction fromArrayBuffer (that, array, byteOffset, length) {\n  array.byteLength // this throws if `array` is not a valid ArrayBuffer\n\n  if (byteOffset < 0 || array.byteLength < byteOffset) {\n    throw new RangeError('\\'offset\\' is out of bounds')\n  }\n\n  if (array.byteLength < byteOffset + (length || 0)) {\n    throw new RangeError('\\'length\\' is out of bounds')\n  }\n\n  if (byteOffset === undefined && length === undefined) {\n    array = new Uint8Array(array)\n  } else if (length === undefined) {\n    array = new Uint8Array(array, byteOffset)\n  } else {\n    array = new Uint8Array(array, byteOffset, length)\n  }\n\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    // Return an augmented `Uint8Array` instance, for best performance\n    that = array\n    that.__proto__ = Buffer.prototype\n  } else {\n    // Fallback: Return an object instance of the Buffer class\n    that = fromArrayLike(that, array)\n  }\n  return that\n}\n\nfunction fromObject (that, obj) {\n  if (Buffer.isBuffer(obj)) {\n    var len = checked(obj.length) | 0\n    that = createBuffer(that, len)\n\n    if (that.length === 0) {\n      return that\n    }\n\n    obj.copy(that, 0, 0, len)\n    return that\n  }\n\n  if (obj) {\n    if ((typeof ArrayBuffer !== 'undefined' &&\n        obj.buffer instanceof ArrayBuffer) || 'length' in obj) {\n      if (typeof obj.length !== 'number' || isnan(obj.length)) {\n        return createBuffer(that, 0)\n      }\n      return fromArrayLike(that, obj)\n    }\n\n    if (obj.type === 'Buffer' && isArray(obj.data)) {\n      return fromArrayLike(that, obj.data)\n    }\n  }\n\n  throw new TypeError('First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.')\n}\n\nfunction checked (length) {\n  // Note: cannot use `length < kMaxLength()` here because that fails when\n  // length is NaN (which is otherwise coerced to zero.)\n  if (length >= kMaxLength()) {\n    throw new RangeError('Attempt to allocate Buffer larger than maximum ' +\n                         'size: 0x' + kMaxLength().toString(16) + ' bytes')\n  }\n  return length | 0\n}\n\nfunction SlowBuffer (length) {\n  if (+length != length) { // eslint-disable-line eqeqeq\n    length = 0\n  }\n  return Buffer.alloc(+length)\n}\n\nBuffer.isBuffer = function isBuffer (b) {\n  return !!(b != null && b._isBuffer)\n}\n\nBuffer.compare = function compare (a, b) {\n  if (!Buffer.isBuffer(a) || !Buffer.isBuffer(b)) {\n    throw new TypeError('Arguments must be Buffers')\n  }\n\n  if (a === b) return 0\n\n  var x = a.length\n  var y = b.length\n\n  for (var i = 0, len = Math.min(x, y); i < len; ++i) {\n    if (a[i] !== b[i]) {\n      x = a[i]\n      y = b[i]\n      break\n    }\n  }\n\n  if (x < y) return -1\n  if (y < x) return 1\n  return 0\n}\n\nBuffer.isEncoding = function isEncoding (encoding) {\n  switch (String(encoding).toLowerCase()) {\n    case 'hex':\n    case 'utf8':\n    case 'utf-8':\n    case 'ascii':\n    case 'latin1':\n    case 'binary':\n    case 'base64':\n    case 'ucs2':\n    case 'ucs-2':\n    case 'utf16le':\n    case 'utf-16le':\n      return true\n    default:\n      return false\n  }\n}\n\nBuffer.concat = function concat (list, length) {\n  if (!isArray(list)) {\n    throw new TypeError('\"list\" argument must be an Array of Buffers')\n  }\n\n  if (list.length === 0) {\n    return Buffer.alloc(0)\n  }\n\n  var i\n  if (length === undefined) {\n    length = 0\n    for (i = 0; i < list.length; ++i) {\n      length += list[i].length\n    }\n  }\n\n  var buffer = Buffer.allocUnsafe(length)\n  var pos = 0\n  for (i = 0; i < list.length; ++i) {\n    var buf = list[i]\n    if (!Buffer.isBuffer(buf)) {\n      throw new TypeError('\"list\" argument must be an Array of Buffers')\n    }\n    buf.copy(buffer, pos)\n    pos += buf.length\n  }\n  return buffer\n}\n\nfunction byteLength (string, encoding) {\n  if (Buffer.isBuffer(string)) {\n    return string.length\n  }\n  if (typeof ArrayBuffer !== 'undefined' && typeof ArrayBuffer.isView === 'function' &&\n      (ArrayBuffer.isView(string) || string instanceof ArrayBuffer)) {\n    return string.byteLength\n  }\n  if (typeof string !== 'string') {\n    string = '' + string\n  }\n\n  var len = string.length\n  if (len === 0) return 0\n\n  // Use a for loop to avoid recursion\n  var loweredCase = false\n  for (;;) {\n    switch (encoding) {\n      case 'ascii':\n      case 'latin1':\n      case 'binary':\n        return len\n      case 'utf8':\n      case 'utf-8':\n      case undefined:\n        return utf8ToBytes(string).length\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return len * 2\n      case 'hex':\n        return len >>> 1\n      case 'base64':\n        return base64ToBytes(string).length\n      default:\n        if (loweredCase) return utf8ToBytes(string).length // assume utf8\n        encoding = ('' + encoding).toLowerCase()\n        loweredCase = true\n    }\n  }\n}\nBuffer.byteLength = byteLength\n\nfunction slowToString (encoding, start, end) {\n  var loweredCase = false\n\n  // No need to verify that \"this.length <= MAX_UINT32\" since it's a read-only\n  // property of a typed array.\n\n  // This behaves neither like String nor Uint8Array in that we set start/end\n  // to their upper/lower bounds if the value passed is out of range.\n  // undefined is handled specially as per ECMA-262 6th Edition,\n  // Section 13.3.3.7 Runtime Semantics: KeyedBindingInitialization.\n  if (start === undefined || start < 0) {\n    start = 0\n  }\n  // Return early if start > this.length. Done here to prevent potential uint32\n  // coercion fail below.\n  if (start > this.length) {\n    return ''\n  }\n\n  if (end === undefined || end > this.length) {\n    end = this.length\n  }\n\n  if (end <= 0) {\n    return ''\n  }\n\n  // Force coersion to uint32. This will also coerce falsey/NaN values to 0.\n  end >>>= 0\n  start >>>= 0\n\n  if (end <= start) {\n    return ''\n  }\n\n  if (!encoding) encoding = 'utf8'\n\n  while (true) {\n    switch (encoding) {\n      case 'hex':\n        return hexSlice(this, start, end)\n\n      case 'utf8':\n      case 'utf-8':\n        return utf8Slice(this, start, end)\n\n      case 'ascii':\n        return asciiSlice(this, start, end)\n\n      case 'latin1':\n      case 'binary':\n        return latin1Slice(this, start, end)\n\n      case 'base64':\n        return base64Slice(this, start, end)\n\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return utf16leSlice(this, start, end)\n\n      default:\n        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)\n        encoding = (encoding + '').toLowerCase()\n        loweredCase = true\n    }\n  }\n}\n\n// The property is used by `Buffer.isBuffer` and `is-buffer` (in Safari 5-7) to detect\n// Buffer instances.\nBuffer.prototype._isBuffer = true\n\nfunction swap (b, n, m) {\n  var i = b[n]\n  b[n] = b[m]\n  b[m] = i\n}\n\nBuffer.prototype.swap16 = function swap16 () {\n  var len = this.length\n  if (len % 2 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 16-bits')\n  }\n  for (var i = 0; i < len; i += 2) {\n    swap(this, i, i + 1)\n  }\n  return this\n}\n\nBuffer.prototype.swap32 = function swap32 () {\n  var len = this.length\n  if (len % 4 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 32-bits')\n  }\n  for (var i = 0; i < len; i += 4) {\n    swap(this, i, i + 3)\n    swap(this, i + 1, i + 2)\n  }\n  return this\n}\n\nBuffer.prototype.swap64 = function swap64 () {\n  var len = this.length\n  if (len % 8 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 64-bits')\n  }\n  for (var i = 0; i < len; i += 8) {\n    swap(this, i, i + 7)\n    swap(this, i + 1, i + 6)\n    swap(this, i + 2, i + 5)\n    swap(this, i + 3, i + 4)\n  }\n  return this\n}\n\nBuffer.prototype.toString = function toString () {\n  var length = this.length | 0\n  if (length === 0) return ''\n  if (arguments.length === 0) return utf8Slice(this, 0, length)\n  return slowToString.apply(this, arguments)\n}\n\nBuffer.prototype.equals = function equals (b) {\n  if (!Buffer.isBuffer(b)) throw new TypeError('Argument must be a Buffer')\n  if (this === b) return true\n  return Buffer.compare(this, b) === 0\n}\n\nBuffer.prototype.inspect = function inspect () {\n  var str = ''\n  var max = exports.INSPECT_MAX_BYTES\n  if (this.length > 0) {\n    str = this.toString('hex', 0, max).match(/.{2}/g).join(' ')\n    if (this.length > max) str += ' ... '\n  }\n  return '<Buffer ' + str + '>'\n}\n\nBuffer.prototype.compare = function compare (target, start, end, thisStart, thisEnd) {\n  if (!Buffer.isBuffer(target)) {\n    throw new TypeError('Argument must be a Buffer')\n  }\n\n  if (start === undefined) {\n    start = 0\n  }\n  if (end === undefined) {\n    end = target ? target.length : 0\n  }\n  if (thisStart === undefined) {\n    thisStart = 0\n  }\n  if (thisEnd === undefined) {\n    thisEnd = this.length\n  }\n\n  if (start < 0 || end > target.length || thisStart < 0 || thisEnd > this.length) {\n    throw new RangeError('out of range index')\n  }\n\n  if (thisStart >= thisEnd && start >= end) {\n    return 0\n  }\n  if (thisStart >= thisEnd) {\n    return -1\n  }\n  if (start >= end) {\n    return 1\n  }\n\n  start >>>= 0\n  end >>>= 0\n  thisStart >>>= 0\n  thisEnd >>>= 0\n\n  if (this === target) return 0\n\n  var x = thisEnd - thisStart\n  var y = end - start\n  var len = Math.min(x, y)\n\n  var thisCopy = this.slice(thisStart, thisEnd)\n  var targetCopy = target.slice(start, end)\n\n  for (var i = 0; i < len; ++i) {\n    if (thisCopy[i] !== targetCopy[i]) {\n      x = thisCopy[i]\n      y = targetCopy[i]\n      break\n    }\n  }\n\n  if (x < y) return -1\n  if (y < x) return 1\n  return 0\n}\n\n// Finds either the first index of `val` in `buffer` at offset >= `byteOffset`,\n// OR the last index of `val` in `buffer` at offset <= `byteOffset`.\n//\n// Arguments:\n// - buffer - a Buffer to search\n// - val - a string, Buffer, or number\n// - byteOffset - an index into `buffer`; will be clamped to an int32\n// - encoding - an optional encoding, relevant is val is a string\n// - dir - true for indexOf, false for lastIndexOf\nfunction bidirectionalIndexOf (buffer, val, byteOffset, encoding, dir) {\n  // Empty buffer means no match\n  if (buffer.length === 0) return -1\n\n  // Normalize byteOffset\n  if (typeof byteOffset === 'string') {\n    encoding = byteOffset\n    byteOffset = 0\n  } else if (byteOffset > 0x7fffffff) {\n    byteOffset = 0x7fffffff\n  } else if (byteOffset < -0x80000000) {\n    byteOffset = -0x80000000\n  }\n  byteOffset = +byteOffset  // Coerce to Number.\n  if (isNaN(byteOffset)) {\n    // byteOffset: it it's undefined, null, NaN, \"foo\", etc, search whole buffer\n    byteOffset = dir ? 0 : (buffer.length - 1)\n  }\n\n  // Normalize byteOffset: negative offsets start from the end of the buffer\n  if (byteOffset < 0) byteOffset = buffer.length + byteOffset\n  if (byteOffset >= buffer.length) {\n    if (dir) return -1\n    else byteOffset = buffer.length - 1\n  } else if (byteOffset < 0) {\n    if (dir) byteOffset = 0\n    else return -1\n  }\n\n  // Normalize val\n  if (typeof val === 'string') {\n    val = Buffer.from(val, encoding)\n  }\n\n  // Finally, search either indexOf (if dir is true) or lastIndexOf\n  if (Buffer.isBuffer(val)) {\n    // Special case: looking for empty string/buffer always fails\n    if (val.length === 0) {\n      return -1\n    }\n    return arrayIndexOf(buffer, val, byteOffset, encoding, dir)\n  } else if (typeof val === 'number') {\n    val = val & 0xFF // Search for a byte value [0-255]\n    if (Buffer.TYPED_ARRAY_SUPPORT &&\n        typeof Uint8Array.prototype.indexOf === 'function') {\n      if (dir) {\n        return Uint8Array.prototype.indexOf.call(buffer, val, byteOffset)\n      } else {\n        return Uint8Array.prototype.lastIndexOf.call(buffer, val, byteOffset)\n      }\n    }\n    return arrayIndexOf(buffer, [ val ], byteOffset, encoding, dir)\n  }\n\n  throw new TypeError('val must be string, number or Buffer')\n}\n\nfunction arrayIndexOf (arr, val, byteOffset, encoding, dir) {\n  var indexSize = 1\n  var arrLength = arr.length\n  var valLength = val.length\n\n  if (encoding !== undefined) {\n    encoding = String(encoding).toLowerCase()\n    if (encoding === 'ucs2' || encoding === 'ucs-2' ||\n        encoding === 'utf16le' || encoding === 'utf-16le') {\n      if (arr.length < 2 || val.length < 2) {\n        return -1\n      }\n      indexSize = 2\n      arrLength /= 2\n      valLength /= 2\n      byteOffset /= 2\n    }\n  }\n\n  function read (buf, i) {\n    if (indexSize === 1) {\n      return buf[i]\n    } else {\n      return buf.readUInt16BE(i * indexSize)\n    }\n  }\n\n  var i\n  if (dir) {\n    var foundIndex = -1\n    for (i = byteOffset; i < arrLength; i++) {\n      if (read(arr, i) === read(val, foundIndex === -1 ? 0 : i - foundIndex)) {\n        if (foundIndex === -1) foundIndex = i\n        if (i - foundIndex + 1 === valLength) return foundIndex * indexSize\n      } else {\n        if (foundIndex !== -1) i -= i - foundIndex\n        foundIndex = -1\n      }\n    }\n  } else {\n    if (byteOffset + valLength > arrLength) byteOffset = arrLength - valLength\n    for (i = byteOffset; i >= 0; i--) {\n      var found = true\n      for (var j = 0; j < valLength; j++) {\n        if (read(arr, i + j) !== read(val, j)) {\n          found = false\n          break\n        }\n      }\n      if (found) return i\n    }\n  }\n\n  return -1\n}\n\nBuffer.prototype.includes = function includes (val, byteOffset, encoding) {\n  return this.indexOf(val, byteOffset, encoding) !== -1\n}\n\nBuffer.prototype.indexOf = function indexOf (val, byteOffset, encoding) {\n  return bidirectionalIndexOf(this, val, byteOffset, encoding, true)\n}\n\nBuffer.prototype.lastIndexOf = function lastIndexOf (val, byteOffset, encoding) {\n  return bidirectionalIndexOf(this, val, byteOffset, encoding, false)\n}\n\nfunction hexWrite (buf, string, offset, length) {\n  offset = Number(offset) || 0\n  var remaining = buf.length - offset\n  if (!length) {\n    length = remaining\n  } else {\n    length = Number(length)\n    if (length > remaining) {\n      length = remaining\n    }\n  }\n\n  // must be an even number of digits\n  var strLen = string.length\n  if (strLen % 2 !== 0) throw new TypeError('Invalid hex string')\n\n  if (length > strLen / 2) {\n    length = strLen / 2\n  }\n  for (var i = 0; i < length; ++i) {\n    var parsed = parseInt(string.substr(i * 2, 2), 16)\n    if (isNaN(parsed)) return i\n    buf[offset + i] = parsed\n  }\n  return i\n}\n\nfunction utf8Write (buf, string, offset, length) {\n  return blitBuffer(utf8ToBytes(string, buf.length - offset), buf, offset, length)\n}\n\nfunction asciiWrite (buf, string, offset, length) {\n  return blitBuffer(asciiToBytes(string), buf, offset, length)\n}\n\nfunction latin1Write (buf, string, offset, length) {\n  return asciiWrite(buf, string, offset, length)\n}\n\nfunction base64Write (buf, string, offset, length) {\n  return blitBuffer(base64ToBytes(string), buf, offset, length)\n}\n\nfunction ucs2Write (buf, string, offset, length) {\n  return blitBuffer(utf16leToBytes(string, buf.length - offset), buf, offset, length)\n}\n\nBuffer.prototype.write = function write (string, offset, length, encoding) {\n  // Buffer#write(string)\n  if (offset === undefined) {\n    encoding = 'utf8'\n    length = this.length\n    offset = 0\n  // Buffer#write(string, encoding)\n  } else if (length === undefined && typeof offset === 'string') {\n    encoding = offset\n    length = this.length\n    offset = 0\n  // Buffer#write(string, offset[, length][, encoding])\n  } else if (isFinite(offset)) {\n    offset = offset | 0\n    if (isFinite(length)) {\n      length = length | 0\n      if (encoding === undefined) encoding = 'utf8'\n    } else {\n      encoding = length\n      length = undefined\n    }\n  // legacy write(string, encoding, offset, length) - remove in v0.13\n  } else {\n    throw new Error(\n      'Buffer.write(string, encoding, offset[, length]) is no longer supported'\n    )\n  }\n\n  var remaining = this.length - offset\n  if (length === undefined || length > remaining) length = remaining\n\n  if ((string.length > 0 && (length < 0 || offset < 0)) || offset > this.length) {\n    throw new RangeError('Attempt to write outside buffer bounds')\n  }\n\n  if (!encoding) encoding = 'utf8'\n\n  var loweredCase = false\n  for (;;) {\n    switch (encoding) {\n      case 'hex':\n        return hexWrite(this, string, offset, length)\n\n      case 'utf8':\n      case 'utf-8':\n        return utf8Write(this, string, offset, length)\n\n      case 'ascii':\n        return asciiWrite(this, string, offset, length)\n\n      case 'latin1':\n      case 'binary':\n        return latin1Write(this, string, offset, length)\n\n      case 'base64':\n        // Warning: maxLength not taken into account in base64Write\n        return base64Write(this, string, offset, length)\n\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return ucs2Write(this, string, offset, length)\n\n      default:\n        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)\n        encoding = ('' + encoding).toLowerCase()\n        loweredCase = true\n    }\n  }\n}\n\nBuffer.prototype.toJSON = function toJSON () {\n  return {\n    type: 'Buffer',\n    data: Array.prototype.slice.call(this._arr || this, 0)\n  }\n}\n\nfunction base64Slice (buf, start, end) {\n  if (start === 0 && end === buf.length) {\n    return base64.fromByteArray(buf)\n  } else {\n    return base64.fromByteArray(buf.slice(start, end))\n  }\n}\n\nfunction utf8Slice (buf, start, end) {\n  end = Math.min(buf.length, end)\n  var res = []\n\n  var i = start\n  while (i < end) {\n    var firstByte = buf[i]\n    var codePoint = null\n    var bytesPerSequence = (firstByte > 0xEF) ? 4\n      : (firstByte > 0xDF) ? 3\n      : (firstByte > 0xBF) ? 2\n      : 1\n\n    if (i + bytesPerSequence <= end) {\n      var secondByte, thirdByte, fourthByte, tempCodePoint\n\n      switch (bytesPerSequence) {\n        case 1:\n          if (firstByte < 0x80) {\n            codePoint = firstByte\n          }\n          break\n        case 2:\n          secondByte = buf[i + 1]\n          if ((secondByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0x1F) << 0x6 | (secondByte & 0x3F)\n            if (tempCodePoint > 0x7F) {\n              codePoint = tempCodePoint\n            }\n          }\n          break\n        case 3:\n          secondByte = buf[i + 1]\n          thirdByte = buf[i + 2]\n          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0xF) << 0xC | (secondByte & 0x3F) << 0x6 | (thirdByte & 0x3F)\n            if (tempCodePoint > 0x7FF && (tempCodePoint < 0xD800 || tempCodePoint > 0xDFFF)) {\n              codePoint = tempCodePoint\n            }\n          }\n          break\n        case 4:\n          secondByte = buf[i + 1]\n          thirdByte = buf[i + 2]\n          fourthByte = buf[i + 3]\n          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80 && (fourthByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0xF) << 0x12 | (secondByte & 0x3F) << 0xC | (thirdByte & 0x3F) << 0x6 | (fourthByte & 0x3F)\n            if (tempCodePoint > 0xFFFF && tempCodePoint < 0x110000) {\n              codePoint = tempCodePoint\n            }\n          }\n      }\n    }\n\n    if (codePoint === null) {\n      // we did not generate a valid codePoint so insert a\n      // replacement char (U+FFFD) and advance only 1 byte\n      codePoint = 0xFFFD\n      bytesPerSequence = 1\n    } else if (codePoint > 0xFFFF) {\n      // encode to utf16 (surrogate pair dance)\n      codePoint -= 0x10000\n      res.push(codePoint >>> 10 & 0x3FF | 0xD800)\n      codePoint = 0xDC00 | codePoint & 0x3FF\n    }\n\n    res.push(codePoint)\n    i += bytesPerSequence\n  }\n\n  return decodeCodePointsArray(res)\n}\n\n// Based on http://stackoverflow.com/a/22747272/680742, the browser with\n// the lowest limit is Chrome, with 0x10000 args.\n// We go 1 magnitude less, for safety\nvar MAX_ARGUMENTS_LENGTH = 0x1000\n\nfunction decodeCodePointsArray (codePoints) {\n  var len = codePoints.length\n  if (len <= MAX_ARGUMENTS_LENGTH) {\n    return String.fromCharCode.apply(String, codePoints) // avoid extra slice()\n  }\n\n  // Decode in chunks to avoid \"call stack size exceeded\".\n  var res = ''\n  var i = 0\n  while (i < len) {\n    res += String.fromCharCode.apply(\n      String,\n      codePoints.slice(i, i += MAX_ARGUMENTS_LENGTH)\n    )\n  }\n  return res\n}\n\nfunction asciiSlice (buf, start, end) {\n  var ret = ''\n  end = Math.min(buf.length, end)\n\n  for (var i = start; i < end; ++i) {\n    ret += String.fromCharCode(buf[i] & 0x7F)\n  }\n  return ret\n}\n\nfunction latin1Slice (buf, start, end) {\n  var ret = ''\n  end = Math.min(buf.length, end)\n\n  for (var i = start; i < end; ++i) {\n    ret += String.fromCharCode(buf[i])\n  }\n  return ret\n}\n\nfunction hexSlice (buf, start, end) {\n  var len = buf.length\n\n  if (!start || start < 0) start = 0\n  if (!end || end < 0 || end > len) end = len\n\n  var out = ''\n  for (var i = start; i < end; ++i) {\n    out += toHex(buf[i])\n  }\n  return out\n}\n\nfunction utf16leSlice (buf, start, end) {\n  var bytes = buf.slice(start, end)\n  var res = ''\n  for (var i = 0; i < bytes.length; i += 2) {\n    res += String.fromCharCode(bytes[i] + bytes[i + 1] * 256)\n  }\n  return res\n}\n\nBuffer.prototype.slice = function slice (start, end) {\n  var len = this.length\n  start = ~~start\n  end = end === undefined ? len : ~~end\n\n  if (start < 0) {\n    start += len\n    if (start < 0) start = 0\n  } else if (start > len) {\n    start = len\n  }\n\n  if (end < 0) {\n    end += len\n    if (end < 0) end = 0\n  } else if (end > len) {\n    end = len\n  }\n\n  if (end < start) end = start\n\n  var newBuf\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    newBuf = this.subarray(start, end)\n    newBuf.__proto__ = Buffer.prototype\n  } else {\n    var sliceLen = end - start\n    newBuf = new Buffer(sliceLen, undefined)\n    for (var i = 0; i < sliceLen; ++i) {\n      newBuf[i] = this[i + start]\n    }\n  }\n\n  return newBuf\n}\n\n/*\n * Need to make sure that buffer isn't trying to write out of bounds.\n */\nfunction checkOffset (offset, ext, length) {\n  if ((offset % 1) !== 0 || offset < 0) throw new RangeError('offset is not uint')\n  if (offset + ext > length) throw new RangeError('Trying to access beyond buffer length')\n}\n\nBuffer.prototype.readUIntLE = function readUIntLE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var val = this[offset]\n  var mul = 1\n  var i = 0\n  while (++i < byteLength && (mul *= 0x100)) {\n    val += this[offset + i] * mul\n  }\n\n  return val\n}\n\nBuffer.prototype.readUIntBE = function readUIntBE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    checkOffset(offset, byteLength, this.length)\n  }\n\n  var val = this[offset + --byteLength]\n  var mul = 1\n  while (byteLength > 0 && (mul *= 0x100)) {\n    val += this[offset + --byteLength] * mul\n  }\n\n  return val\n}\n\nBuffer.prototype.readUInt8 = function readUInt8 (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 1, this.length)\n  return this[offset]\n}\n\nBuffer.prototype.readUInt16LE = function readUInt16LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  return this[offset] | (this[offset + 1] << 8)\n}\n\nBuffer.prototype.readUInt16BE = function readUInt16BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  return (this[offset] << 8) | this[offset + 1]\n}\n\nBuffer.prototype.readUInt32LE = function readUInt32LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return ((this[offset]) |\n      (this[offset + 1] << 8) |\n      (this[offset + 2] << 16)) +\n      (this[offset + 3] * 0x1000000)\n}\n\nBuffer.prototype.readUInt32BE = function readUInt32BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset] * 0x1000000) +\n    ((this[offset + 1] << 16) |\n    (this[offset + 2] << 8) |\n    this[offset + 3])\n}\n\nBuffer.prototype.readIntLE = function readIntLE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var val = this[offset]\n  var mul = 1\n  var i = 0\n  while (++i < byteLength && (mul *= 0x100)) {\n    val += this[offset + i] * mul\n  }\n  mul *= 0x80\n\n  if (val >= mul) val -= Math.pow(2, 8 * byteLength)\n\n  return val\n}\n\nBuffer.prototype.readIntBE = function readIntBE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var i = byteLength\n  var mul = 1\n  var val = this[offset + --i]\n  while (i > 0 && (mul *= 0x100)) {\n    val += this[offset + --i] * mul\n  }\n  mul *= 0x80\n\n  if (val >= mul) val -= Math.pow(2, 8 * byteLength)\n\n  return val\n}\n\nBuffer.prototype.readInt8 = function readInt8 (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 1, this.length)\n  if (!(this[offset] & 0x80)) return (this[offset])\n  return ((0xff - this[offset] + 1) * -1)\n}\n\nBuffer.prototype.readInt16LE = function readInt16LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  var val = this[offset] | (this[offset + 1] << 8)\n  return (val & 0x8000) ? val | 0xFFFF0000 : val\n}\n\nBuffer.prototype.readInt16BE = function readInt16BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  var val = this[offset + 1] | (this[offset] << 8)\n  return (val & 0x8000) ? val | 0xFFFF0000 : val\n}\n\nBuffer.prototype.readInt32LE = function readInt32LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset]) |\n    (this[offset + 1] << 8) |\n    (this[offset + 2] << 16) |\n    (this[offset + 3] << 24)\n}\n\nBuffer.prototype.readInt32BE = function readInt32BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset] << 24) |\n    (this[offset + 1] << 16) |\n    (this[offset + 2] << 8) |\n    (this[offset + 3])\n}\n\nBuffer.prototype.readFloatLE = function readFloatLE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n  return ieee754.read(this, offset, true, 23, 4)\n}\n\nBuffer.prototype.readFloatBE = function readFloatBE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n  return ieee754.read(this, offset, false, 23, 4)\n}\n\nBuffer.prototype.readDoubleLE = function readDoubleLE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 8, this.length)\n  return ieee754.read(this, offset, true, 52, 8)\n}\n\nBuffer.prototype.readDoubleBE = function readDoubleBE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 8, this.length)\n  return ieee754.read(this, offset, false, 52, 8)\n}\n\nfunction checkInt (buf, value, offset, ext, max, min) {\n  if (!Buffer.isBuffer(buf)) throw new TypeError('\"buffer\" argument must be a Buffer instance')\n  if (value > max || value < min) throw new RangeError('\"value\" argument is out of bounds')\n  if (offset + ext > buf.length) throw new RangeError('Index out of range')\n}\n\nBuffer.prototype.writeUIntLE = function writeUIntLE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    var maxBytes = Math.pow(2, 8 * byteLength) - 1\n    checkInt(this, value, offset, byteLength, maxBytes, 0)\n  }\n\n  var mul = 1\n  var i = 0\n  this[offset] = value & 0xFF\n  while (++i < byteLength && (mul *= 0x100)) {\n    this[offset + i] = (value / mul) & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeUIntBE = function writeUIntBE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    var maxBytes = Math.pow(2, 8 * byteLength) - 1\n    checkInt(this, value, offset, byteLength, maxBytes, 0)\n  }\n\n  var i = byteLength - 1\n  var mul = 1\n  this[offset + i] = value & 0xFF\n  while (--i >= 0 && (mul *= 0x100)) {\n    this[offset + i] = (value / mul) & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeUInt8 = function writeUInt8 (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 1, 0xff, 0)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)\n  this[offset] = (value & 0xff)\n  return offset + 1\n}\n\nfunction objectWriteUInt16 (buf, value, offset, littleEndian) {\n  if (value < 0) value = 0xffff + value + 1\n  for (var i = 0, j = Math.min(buf.length - offset, 2); i < j; ++i) {\n    buf[offset + i] = (value & (0xff << (8 * (littleEndian ? i : 1 - i)))) >>>\n      (littleEndian ? i : 1 - i) * 8\n  }\n}\n\nBuffer.prototype.writeUInt16LE = function writeUInt16LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n  } else {\n    objectWriteUInt16(this, value, offset, true)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeUInt16BE = function writeUInt16BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 8)\n    this[offset + 1] = (value & 0xff)\n  } else {\n    objectWriteUInt16(this, value, offset, false)\n  }\n  return offset + 2\n}\n\nfunction objectWriteUInt32 (buf, value, offset, littleEndian) {\n  if (value < 0) value = 0xffffffff + value + 1\n  for (var i = 0, j = Math.min(buf.length - offset, 4); i < j; ++i) {\n    buf[offset + i] = (value >>> (littleEndian ? i : 3 - i) * 8) & 0xff\n  }\n}\n\nBuffer.prototype.writeUInt32LE = function writeUInt32LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset + 3] = (value >>> 24)\n    this[offset + 2] = (value >>> 16)\n    this[offset + 1] = (value >>> 8)\n    this[offset] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, true)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeUInt32BE = function writeUInt32BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 24)\n    this[offset + 1] = (value >>> 16)\n    this[offset + 2] = (value >>> 8)\n    this[offset + 3] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, false)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeIntLE = function writeIntLE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) {\n    var limit = Math.pow(2, 8 * byteLength - 1)\n\n    checkInt(this, value, offset, byteLength, limit - 1, -limit)\n  }\n\n  var i = 0\n  var mul = 1\n  var sub = 0\n  this[offset] = value & 0xFF\n  while (++i < byteLength && (mul *= 0x100)) {\n    if (value < 0 && sub === 0 && this[offset + i - 1] !== 0) {\n      sub = 1\n    }\n    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeIntBE = function writeIntBE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) {\n    var limit = Math.pow(2, 8 * byteLength - 1)\n\n    checkInt(this, value, offset, byteLength, limit - 1, -limit)\n  }\n\n  var i = byteLength - 1\n  var mul = 1\n  var sub = 0\n  this[offset + i] = value & 0xFF\n  while (--i >= 0 && (mul *= 0x100)) {\n    if (value < 0 && sub === 0 && this[offset + i + 1] !== 0) {\n      sub = 1\n    }\n    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeInt8 = function writeInt8 (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 1, 0x7f, -0x80)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)\n  if (value < 0) value = 0xff + value + 1\n  this[offset] = (value & 0xff)\n  return offset + 1\n}\n\nBuffer.prototype.writeInt16LE = function writeInt16LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n  } else {\n    objectWriteUInt16(this, value, offset, true)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeInt16BE = function writeInt16BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 8)\n    this[offset + 1] = (value & 0xff)\n  } else {\n    objectWriteUInt16(this, value, offset, false)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeInt32LE = function writeInt32LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n    this[offset + 2] = (value >>> 16)\n    this[offset + 3] = (value >>> 24)\n  } else {\n    objectWriteUInt32(this, value, offset, true)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeInt32BE = function writeInt32BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)\n  if (value < 0) value = 0xffffffff + value + 1\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 24)\n    this[offset + 1] = (value >>> 16)\n    this[offset + 2] = (value >>> 8)\n    this[offset + 3] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, false)\n  }\n  return offset + 4\n}\n\nfunction checkIEEE754 (buf, value, offset, ext, max, min) {\n  if (offset + ext > buf.length) throw new RangeError('Index out of range')\n  if (offset < 0) throw new RangeError('Index out of range')\n}\n\nfunction writeFloat (buf, value, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    checkIEEE754(buf, value, offset, 4, 3.4028234663852886e+38, -3.4028234663852886e+38)\n  }\n  ieee754.write(buf, value, offset, littleEndian, 23, 4)\n  return offset + 4\n}\n\nBuffer.prototype.writeFloatLE = function writeFloatLE (value, offset, noAssert) {\n  return writeFloat(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeFloatBE = function writeFloatBE (value, offset, noAssert) {\n  return writeFloat(this, value, offset, false, noAssert)\n}\n\nfunction writeDouble (buf, value, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    checkIEEE754(buf, value, offset, 8, 1.7976931348623157E+308, -1.7976931348623157E+308)\n  }\n  ieee754.write(buf, value, offset, littleEndian, 52, 8)\n  return offset + 8\n}\n\nBuffer.prototype.writeDoubleLE = function writeDoubleLE (value, offset, noAssert) {\n  return writeDouble(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeDoubleBE = function writeDoubleBE (value, offset, noAssert) {\n  return writeDouble(this, value, offset, false, noAssert)\n}\n\n// copy(targetBuffer, targetStart=0, sourceStart=0, sourceEnd=buffer.length)\nBuffer.prototype.copy = function copy (target, targetStart, start, end) {\n  if (!start) start = 0\n  if (!end && end !== 0) end = this.length\n  if (targetStart >= target.length) targetStart = target.length\n  if (!targetStart) targetStart = 0\n  if (end > 0 && end < start) end = start\n\n  // Copy 0 bytes; we're done\n  if (end === start) return 0\n  if (target.length === 0 || this.length === 0) return 0\n\n  // Fatal error conditions\n  if (targetStart < 0) {\n    throw new RangeError('targetStart out of bounds')\n  }\n  if (start < 0 || start >= this.length) throw new RangeError('sourceStart out of bounds')\n  if (end < 0) throw new RangeError('sourceEnd out of bounds')\n\n  // Are we oob?\n  if (end > this.length) end = this.length\n  if (target.length - targetStart < end - start) {\n    end = target.length - targetStart + start\n  }\n\n  var len = end - start\n  var i\n\n  if (this === target && start < targetStart && targetStart < end) {\n    // descending copy from end\n    for (i = len - 1; i >= 0; --i) {\n      target[i + targetStart] = this[i + start]\n    }\n  } else if (len < 1000 || !Buffer.TYPED_ARRAY_SUPPORT) {\n    // ascending copy from start\n    for (i = 0; i < len; ++i) {\n      target[i + targetStart] = this[i + start]\n    }\n  } else {\n    Uint8Array.prototype.set.call(\n      target,\n      this.subarray(start, start + len),\n      targetStart\n    )\n  }\n\n  return len\n}\n\n// Usage:\n//    buffer.fill(number[, offset[, end]])\n//    buffer.fill(buffer[, offset[, end]])\n//    buffer.fill(string[, offset[, end]][, encoding])\nBuffer.prototype.fill = function fill (val, start, end, encoding) {\n  // Handle string cases:\n  if (typeof val === 'string') {\n    if (typeof start === 'string') {\n      encoding = start\n      start = 0\n      end = this.length\n    } else if (typeof end === 'string') {\n      encoding = end\n      end = this.length\n    }\n    if (val.length === 1) {\n      var code = val.charCodeAt(0)\n      if (code < 256) {\n        val = code\n      }\n    }\n    if (encoding !== undefined && typeof encoding !== 'string') {\n      throw new TypeError('encoding must be a string')\n    }\n    if (typeof encoding === 'string' && !Buffer.isEncoding(encoding)) {\n      throw new TypeError('Unknown encoding: ' + encoding)\n    }\n  } else if (typeof val === 'number') {\n    val = val & 255\n  }\n\n  // Invalid ranges are not set to a default, so can range check early.\n  if (start < 0 || this.length < start || this.length < end) {\n    throw new RangeError('Out of range index')\n  }\n\n  if (end <= start) {\n    return this\n  }\n\n  start = start >>> 0\n  end = end === undefined ? this.length : end >>> 0\n\n  if (!val) val = 0\n\n  var i\n  if (typeof val === 'number') {\n    for (i = start; i < end; ++i) {\n      this[i] = val\n    }\n  } else {\n    var bytes = Buffer.isBuffer(val)\n      ? val\n      : utf8ToBytes(new Buffer(val, encoding).toString())\n    var len = bytes.length\n    for (i = 0; i < end - start; ++i) {\n      this[i + start] = bytes[i % len]\n    }\n  }\n\n  return this\n}\n\n// HELPER FUNCTIONS\n// ================\n\nvar INVALID_BASE64_RE = /[^+\\/0-9A-Za-z-_]/g\n\nfunction base64clean (str) {\n  // Node strips out invalid characters like \\n and \\t from the string, base64-js does not\n  str = stringtrim(str).replace(INVALID_BASE64_RE, '')\n  // Node converts strings with length < 2 to ''\n  if (str.length < 2) return ''\n  // Node allows for non-padded base64 strings (missing trailing ===), base64-js does not\n  while (str.length % 4 !== 0) {\n    str = str + '='\n  }\n  return str\n}\n\nfunction stringtrim (str) {\n  if (str.trim) return str.trim()\n  return str.replace(/^\\s+|\\s+$/g, '')\n}\n\nfunction toHex (n) {\n  if (n < 16) return '0' + n.toString(16)\n  return n.toString(16)\n}\n\nfunction utf8ToBytes (string, units) {\n  units = units || Infinity\n  var codePoint\n  var length = string.length\n  var leadSurrogate = null\n  var bytes = []\n\n  for (var i = 0; i < length; ++i) {\n    codePoint = string.charCodeAt(i)\n\n    // is surrogate component\n    if (codePoint > 0xD7FF && codePoint < 0xE000) {\n      // last char was a lead\n      if (!leadSurrogate) {\n        // no lead yet\n        if (codePoint > 0xDBFF) {\n          // unexpected trail\n          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n          continue\n        } else if (i + 1 === length) {\n          // unpaired lead\n          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n          continue\n        }\n\n        // valid lead\n        leadSurrogate = codePoint\n\n        continue\n      }\n\n      // 2 leads in a row\n      if (codePoint < 0xDC00) {\n        if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n        leadSurrogate = codePoint\n        continue\n      }\n\n      // valid surrogate pair\n      codePoint = (leadSurrogate - 0xD800 << 10 | codePoint - 0xDC00) + 0x10000\n    } else if (leadSurrogate) {\n      // valid bmp char, but last char was a lead\n      if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n    }\n\n    leadSurrogate = null\n\n    // encode utf8\n    if (codePoint < 0x80) {\n      if ((units -= 1) < 0) break\n      bytes.push(codePoint)\n    } else if (codePoint < 0x800) {\n      if ((units -= 2) < 0) break\n      bytes.push(\n        codePoint >> 0x6 | 0xC0,\n        codePoint & 0x3F | 0x80\n      )\n    } else if (codePoint < 0x10000) {\n      if ((units -= 3) < 0) break\n      bytes.push(\n        codePoint >> 0xC | 0xE0,\n        codePoint >> 0x6 & 0x3F | 0x80,\n        codePoint & 0x3F | 0x80\n      )\n    } else if (codePoint < 0x110000) {\n      if ((units -= 4) < 0) break\n      bytes.push(\n        codePoint >> 0x12 | 0xF0,\n        codePoint >> 0xC & 0x3F | 0x80,\n        codePoint >> 0x6 & 0x3F | 0x80,\n        codePoint & 0x3F | 0x80\n      )\n    } else {\n      throw new Error('Invalid code point')\n    }\n  }\n\n  return bytes\n}\n\nfunction asciiToBytes (str) {\n  var byteArray = []\n  for (var i = 0; i < str.length; ++i) {\n    // Node's code seems to be doing this and not & 0x7F..\n    byteArray.push(str.charCodeAt(i) & 0xFF)\n  }\n  return byteArray\n}\n\nfunction utf16leToBytes (str, units) {\n  var c, hi, lo\n  var byteArray = []\n  for (var i = 0; i < str.length; ++i) {\n    if ((units -= 2) < 0) break\n\n    c = str.charCodeAt(i)\n    hi = c >> 8\n    lo = c % 256\n    byteArray.push(lo)\n    byteArray.push(hi)\n  }\n\n  return byteArray\n}\n\nfunction base64ToBytes (str) {\n  return base64.toByteArray(base64clean(str))\n}\n\nfunction blitBuffer (src, dst, offset, length) {\n  for (var i = 0; i < length; ++i) {\n    if ((i + offset >= dst.length) || (i >= src.length)) break\n    dst[i + offset] = src[i]\n  }\n  return i\n}\n\nfunction isnan (val) {\n  return val !== val // eslint-disable-line no-self-compare\n}\n","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","'use strict'\n\nexports.byteLength = byteLength\nexports.toByteArray = toByteArray\nexports.fromByteArray = fromByteArray\n\nvar lookup = []\nvar revLookup = []\nvar Arr = typeof Uint8Array !== 'undefined' ? Uint8Array : Array\n\nvar code = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'\nfor (var i = 0, len = code.length; i < len; ++i) {\n  lookup[i] = code[i]\n  revLookup[code.charCodeAt(i)] = i\n}\n\n// Support decoding URL-safe base64 strings, as Node.js does.\n// See: https://en.wikipedia.org/wiki/Base64#URL_applications\nrevLookup['-'.charCodeAt(0)] = 62\nrevLookup['_'.charCodeAt(0)] = 63\n\nfunction getLens (b64) {\n  var len = b64.length\n\n  if (len % 4 > 0) {\n    throw new Error('Invalid string. Length must be a multiple of 4')\n  }\n\n  // Trim off extra bytes after placeholder bytes are found\n  // See: https://github.com/beatgammit/base64-js/issues/42\n  var validLen = b64.indexOf('=')\n  if (validLen === -1) validLen = len\n\n  var placeHoldersLen = validLen === len\n    ? 0\n    : 4 - (validLen % 4)\n\n  return [validLen, placeHoldersLen]\n}\n\n// base64 is 4/3 + up to two characters of the original data\nfunction byteLength (b64) {\n  var lens = getLens(b64)\n  var validLen = lens[0]\n  var placeHoldersLen = lens[1]\n  return ((validLen + placeHoldersLen) * 3 / 4) - placeHoldersLen\n}\n\nfunction _byteLength (b64, validLen, placeHoldersLen) {\n  return ((validLen + placeHoldersLen) * 3 / 4) - placeHoldersLen\n}\n\nfunction toByteArray (b64) {\n  var tmp\n  var lens = getLens(b64)\n  var validLen = lens[0]\n  var placeHoldersLen = lens[1]\n\n  var arr = new Arr(_byteLength(b64, validLen, placeHoldersLen))\n\n  var curByte = 0\n\n  // if there are placeholders, only get up to the last complete 4 chars\n  var len = placeHoldersLen > 0\n    ? validLen - 4\n    : validLen\n\n  var i\n  for (i = 0; i < len; i += 4) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 18) |\n      (revLookup[b64.charCodeAt(i + 1)] << 12) |\n      (revLookup[b64.charCodeAt(i + 2)] << 6) |\n      revLookup[b64.charCodeAt(i + 3)]\n    arr[curByte++] = (tmp >> 16) & 0xFF\n    arr[curByte++] = (tmp >> 8) & 0xFF\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  if (placeHoldersLen === 2) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 2) |\n      (revLookup[b64.charCodeAt(i + 1)] >> 4)\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  if (placeHoldersLen === 1) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 10) |\n      (revLookup[b64.charCodeAt(i + 1)] << 4) |\n      (revLookup[b64.charCodeAt(i + 2)] >> 2)\n    arr[curByte++] = (tmp >> 8) & 0xFF\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  return arr\n}\n\nfunction tripletToBase64 (num) {\n  return lookup[num >> 18 & 0x3F] +\n    lookup[num >> 12 & 0x3F] +\n    lookup[num >> 6 & 0x3F] +\n    lookup[num & 0x3F]\n}\n\nfunction encodeChunk (uint8, start, end) {\n  var tmp\n  var output = []\n  for (var i = start; i < end; i += 3) {\n    tmp =\n      ((uint8[i] << 16) & 0xFF0000) +\n      ((uint8[i + 1] << 8) & 0xFF00) +\n      (uint8[i + 2] & 0xFF)\n    output.push(tripletToBase64(tmp))\n  }\n  return output.join('')\n}\n\nfunction fromByteArray (uint8) {\n  var tmp\n  var len = uint8.length\n  var extraBytes = len % 3 // if we have 1 byte left, pad 2 bytes\n  var parts = []\n  var maxChunkLength = 16383 // must be multiple of 3\n\n  // go through the array every three bytes, we'll deal with trailing stuff later\n  for (var i = 0, len2 = len - extraBytes; i < len2; i += maxChunkLength) {\n    parts.push(encodeChunk(\n      uint8, i, (i + maxChunkLength) > len2 ? len2 : (i + maxChunkLength)\n    ))\n  }\n\n  // pad the end with zeros, but make sure to not forget the extra bytes\n  if (extraBytes === 1) {\n    tmp = uint8[len - 1]\n    parts.push(\n      lookup[tmp >> 2] +\n      lookup[(tmp << 4) & 0x3F] +\n      '=='\n    )\n  } else if (extraBytes === 2) {\n    tmp = (uint8[len - 2] << 8) + uint8[len - 1]\n    parts.push(\n      lookup[tmp >> 10] +\n      lookup[(tmp >> 4) & 0x3F] +\n      lookup[(tmp << 2) & 0x3F] +\n      '='\n    )\n  }\n\n  return parts.join('')\n}\n","exports.read = function (buffer, offset, isLE, mLen, nBytes) {\n  var e, m\n  var eLen = (nBytes * 8) - mLen - 1\n  var eMax = (1 << eLen) - 1\n  var eBias = eMax >> 1\n  var nBits = -7\n  var i = isLE ? (nBytes - 1) : 0\n  var d = isLE ? -1 : 1\n  var s = buffer[offset + i]\n\n  i += d\n\n  e = s & ((1 << (-nBits)) - 1)\n  s >>= (-nBits)\n  nBits += eLen\n  for (; nBits > 0; e = (e * 256) + buffer[offset + i], i += d, nBits -= 8) {}\n\n  m = e & ((1 << (-nBits)) - 1)\n  e >>= (-nBits)\n  nBits += mLen\n  for (; nBits > 0; m = (m * 256) + buffer[offset + i], i += d, nBits -= 8) {}\n\n  if (e === 0) {\n    e = 1 - eBias\n  } else if (e === eMax) {\n    return m ? NaN : ((s ? -1 : 1) * Infinity)\n  } else {\n    m = m + Math.pow(2, mLen)\n    e = e - eBias\n  }\n  return (s ? -1 : 1) * m * Math.pow(2, e - mLen)\n}\n\nexports.write = function (buffer, value, offset, isLE, mLen, nBytes) {\n  var e, m, c\n  var eLen = (nBytes * 8) - mLen - 1\n  var eMax = (1 << eLen) - 1\n  var eBias = eMax >> 1\n  var rt = (mLen === 23 ? Math.pow(2, -24) - Math.pow(2, -77) : 0)\n  var i = isLE ? 0 : (nBytes - 1)\n  var d = isLE ? 1 : -1\n  var s = value < 0 || (value === 0 && 1 / value < 0) ? 1 : 0\n\n  value = Math.abs(value)\n\n  if (isNaN(value) || value === Infinity) {\n    m = isNaN(value) ? 1 : 0\n    e = eMax\n  } else {\n    e = Math.floor(Math.log(value) / Math.LN2)\n    if (value * (c = Math.pow(2, -e)) < 1) {\n      e--\n      c *= 2\n    }\n    if (e + eBias >= 1) {\n      value += rt / c\n    } else {\n      value += rt * Math.pow(2, 1 - eBias)\n    }\n    if (value * c >= 2) {\n      e++\n      c /= 2\n    }\n\n    if (e + eBias >= eMax) {\n      m = 0\n      e = eMax\n    } else if (e + eBias >= 1) {\n      m = ((value * c) - 1) * Math.pow(2, mLen)\n      e = e + eBias\n    } else {\n      m = value * Math.pow(2, eBias - 1) * Math.pow(2, mLen)\n      e = 0\n    }\n  }\n\n  for (; mLen >= 8; buffer[offset + i] = m & 0xff, i += d, m /= 256, mLen -= 8) {}\n\n  e = (e << mLen) | m\n  eLen += mLen\n  for (; eLen > 0; buffer[offset + i] = e & 0xff, i += d, e /= 256, eLen -= 8) {}\n\n  buffer[offset + i - d] |= s * 128\n}\n","var toString = {}.toString;\n\nmodule.exports = Array.isArray || function (arr) {\n  return toString.call(arr) == '[object Array]';\n};\n","module.exports = require('./lib/axios');","'use strict';\n\nvar utils = require('./utils');\nvar bind = require('./helpers/bind');\nvar Axios = require('./core/Axios');\nvar mergeConfig = require('./core/mergeConfig');\nvar defaults = require('./defaults');\n\n/**\n * Create an instance of Axios\n *\n * @param {Object} defaultConfig The default config for the instance\n * @return {Axios} A new instance of Axios\n */\nfunction createInstance(defaultConfig) {\n  var context = new Axios(defaultConfig);\n  var instance = bind(Axios.prototype.request, context);\n\n  // Copy axios.prototype to instance\n  utils.extend(instance, Axios.prototype, context);\n\n  // Copy context to instance\n  utils.extend(instance, context);\n\n  return instance;\n}\n\n// Create the default instance to be exported\nvar axios = createInstance(defaults);\n\n// Expose Axios class to allow class inheritance\naxios.Axios = Axios;\n\n// Factory for creating new instances\naxios.create = function create(instanceConfig) {\n  return createInstance(mergeConfig(axios.defaults, instanceConfig));\n};\n\n// Expose Cancel & CancelToken\naxios.Cancel = require('./cancel/Cancel');\naxios.CancelToken = require('./cancel/CancelToken');\naxios.isCancel = require('./cancel/isCancel');\n\n// Expose all/spread\naxios.all = function all(promises) {\n  return Promise.all(promises);\n};\naxios.spread = require('./helpers/spread');\n\nmodule.exports = axios;\n\n// Allow use of default import syntax in TypeScript\nmodule.exports.default = axios;\n","/*!\n * Determine if an object is a Buffer\n *\n * @author   Feross Aboukhadijeh <https://feross.org>\n * @license  MIT\n */\n\nmodule.exports = function isBuffer (obj) {\n  return obj != null && obj.constructor != null &&\n    typeof obj.constructor.isBuffer === 'function' && obj.constructor.isBuffer(obj)\n}\n","'use strict';\n\nvar utils = require('./../utils');\nvar buildURL = require('../helpers/buildURL');\nvar InterceptorManager = require('./InterceptorManager');\nvar dispatchRequest = require('./dispatchRequest');\nvar mergeConfig = require('./mergeConfig');\n\n/**\n * Create a new instance of Axios\n *\n * @param {Object} instanceConfig The default config for the instance\n */\nfunction Axios(instanceConfig) {\n  this.defaults = instanceConfig;\n  this.interceptors = {\n    request: new InterceptorManager(),\n    response: new InterceptorManager()\n  };\n}\n\n/**\n * Dispatch a request\n *\n * @param {Object} config The config specific for this request (merged with this.defaults)\n */\nAxios.prototype.request = function request(config) {\n  /*eslint no-param-reassign:0*/\n  // Allow for axios('example/url'[, config]) a la fetch API\n  if (typeof config === 'string') {\n    config = arguments[1] || {};\n    config.url = arguments[0];\n  } else {\n    config = config || {};\n  }\n\n  config = mergeConfig(this.defaults, config);\n  config.method = config.method ? config.method.toLowerCase() : 'get';\n\n  // Hook up interceptors middleware\n  var chain = [dispatchRequest, undefined];\n  var promise = Promise.resolve(config);\n\n  this.interceptors.request.forEach(function unshiftRequestInterceptors(interceptor) {\n    chain.unshift(interceptor.fulfilled, interceptor.rejected);\n  });\n\n  this.interceptors.response.forEach(function pushResponseInterceptors(interceptor) {\n    chain.push(interceptor.fulfilled, interceptor.rejected);\n  });\n\n  while (chain.length) {\n    promise = promise.then(chain.shift(), chain.shift());\n  }\n\n  return promise;\n};\n\nAxios.prototype.getUri = function getUri(config) {\n  config = mergeConfig(this.defaults, config);\n  return buildURL(config.url, config.params, config.paramsSerializer).replace(/^\\?/, '');\n};\n\n// Provide aliases for supported request methods\nutils.forEach(['delete', 'get', 'head', 'options'], function forEachMethodNoData(method) {\n  /*eslint func-names:0*/\n  Axios.prototype[method] = function(url, config) {\n    return this.request(utils.merge(config || {}, {\n      method: method,\n      url: url\n    }));\n  };\n});\n\nutils.forEach(['post', 'put', 'patch'], function forEachMethodWithData(method) {\n  /*eslint func-names:0*/\n  Axios.prototype[method] = function(url, data, config) {\n    return this.request(utils.merge(config || {}, {\n      method: method,\n      url: url,\n      data: data\n    }));\n  };\n});\n\nmodule.exports = Axios;\n","'use strict';\n\nvar utils = require('./../utils');\n\nfunction InterceptorManager() {\n  this.handlers = [];\n}\n\n/**\n * Add a new interceptor to the stack\n *\n * @param {Function} fulfilled The function to handle `then` for a `Promise`\n * @param {Function} rejected The function to handle `reject` for a `Promise`\n *\n * @return {Number} An ID used to remove interceptor later\n */\nInterceptorManager.prototype.use = function use(fulfilled, rejected) {\n  this.handlers.push({\n    fulfilled: fulfilled,\n    rejected: rejected\n  });\n  return this.handlers.length - 1;\n};\n\n/**\n * Remove an interceptor from the stack\n *\n * @param {Number} id The ID that was returned by `use`\n */\nInterceptorManager.prototype.eject = function eject(id) {\n  if (this.handlers[id]) {\n    this.handlers[id] = null;\n  }\n};\n\n/**\n * Iterate over all the registered interceptors\n *\n * This method is particularly useful for skipping over any\n * interceptors that may have become `null` calling `eject`.\n *\n * @param {Function} fn The function to call for each interceptor\n */\nInterceptorManager.prototype.forEach = function forEach(fn) {\n  utils.forEach(this.handlers, function forEachHandler(h) {\n    if (h !== null) {\n      fn(h);\n    }\n  });\n};\n\nmodule.exports = InterceptorManager;\n","'use strict';\n\nvar utils = require('./../utils');\nvar transformData = require('./transformData');\nvar isCancel = require('../cancel/isCancel');\nvar defaults = require('../defaults');\nvar isAbsoluteURL = require('./../helpers/isAbsoluteURL');\nvar combineURLs = require('./../helpers/combineURLs');\n\n/**\n * Throws a `Cancel` if cancellation has been requested.\n */\nfunction throwIfCancellationRequested(config) {\n  if (config.cancelToken) {\n    config.cancelToken.throwIfRequested();\n  }\n}\n\n/**\n * Dispatch a request to the server using the configured adapter.\n *\n * @param {object} config The config that is to be used for the request\n * @returns {Promise} The Promise to be fulfilled\n */\nmodule.exports = function dispatchRequest(config) {\n  throwIfCancellationRequested(config);\n\n  // Support baseURL config\n  if (config.baseURL && !isAbsoluteURL(config.url)) {\n    config.url = combineURLs(config.baseURL, config.url);\n  }\n\n  // Ensure headers exist\n  config.headers = config.headers || {};\n\n  // Transform request data\n  config.data = transformData(\n    config.data,\n    config.headers,\n    config.transformRequest\n  );\n\n  // Flatten headers\n  config.headers = utils.merge(\n    config.headers.common || {},\n    config.headers[config.method] || {},\n    config.headers || {}\n  );\n\n  utils.forEach(\n    ['delete', 'get', 'head', 'post', 'put', 'patch', 'common'],\n    function cleanHeaderConfig(method) {\n      delete config.headers[method];\n    }\n  );\n\n  var adapter = config.adapter || defaults.adapter;\n\n  return adapter(config).then(function onAdapterResolution(response) {\n    throwIfCancellationRequested(config);\n\n    // Transform response data\n    response.data = transformData(\n      response.data,\n      response.headers,\n      config.transformResponse\n    );\n\n    return response;\n  }, function onAdapterRejection(reason) {\n    if (!isCancel(reason)) {\n      throwIfCancellationRequested(config);\n\n      // Transform response data\n      if (reason && reason.response) {\n        reason.response.data = transformData(\n          reason.response.data,\n          reason.response.headers,\n          config.transformResponse\n        );\n      }\n    }\n\n    return Promise.reject(reason);\n  });\n};\n","'use strict';\n\nvar utils = require('./../utils');\n\n/**\n * Transform the data for a request or a response\n *\n * @param {Object|String} data The data to be transformed\n * @param {Array} headers The headers for the request or response\n * @param {Array|Function} fns A single function or Array of functions\n * @returns {*} The resulting transformed data\n */\nmodule.exports = function transformData(data, headers, fns) {\n  /*eslint no-param-reassign:0*/\n  utils.forEach(fns, function transform(fn) {\n    data = fn(data, headers);\n  });\n\n  return data;\n};\n","'use strict';\n\nvar utils = require('../utils');\n\nmodule.exports = function normalizeHeaderName(headers, normalizedName) {\n  utils.forEach(headers, function processHeader(value, name) {\n    if (name !== normalizedName && name.toUpperCase() === normalizedName.toUpperCase()) {\n      headers[normalizedName] = value;\n      delete headers[name];\n    }\n  });\n};\n","'use strict';\n\nvar createError = require('./createError');\n\n/**\n * Resolve or reject a Promise based on response status.\n *\n * @param {Function} resolve A function that resolves the promise.\n * @param {Function} reject A function that rejects the promise.\n * @param {object} response The response.\n */\nmodule.exports = function settle(resolve, reject, response) {\n  var validateStatus = response.config.validateStatus;\n  if (!validateStatus || validateStatus(response.status)) {\n    resolve(response);\n  } else {\n    reject(createError(\n      'Request failed with status code ' + response.status,\n      response.config,\n      null,\n      response.request,\n      response\n    ));\n  }\n};\n","'use strict';\n\n/**\n * Update an Error with the specified config, error code, and response.\n *\n * @param {Error} error The error to update.\n * @param {Object} config The config.\n * @param {string} [code] The error code (for example, 'ECONNABORTED').\n * @param {Object} [request] The request.\n * @param {Object} [response] The response.\n * @returns {Error} The error.\n */\nmodule.exports = function enhanceError(error, config, code, request, response) {\n  error.config = config;\n  if (code) {\n    error.code = code;\n  }\n\n  error.request = request;\n  error.response = response;\n  error.isAxiosError = true;\n\n  error.toJSON = function() {\n    return {\n      // Standard\n      message: this.message,\n      name: this.name,\n      // Microsoft\n      description: this.description,\n      number: this.number,\n      // Mozilla\n      fileName: this.fileName,\n      lineNumber: this.lineNumber,\n      columnNumber: this.columnNumber,\n      stack: this.stack,\n      // Axios\n      config: this.config,\n      code: this.code\n    };\n  };\n  return error;\n};\n","'use strict';\n\nvar utils = require('./../utils');\n\n// Headers whose duplicates are ignored by node\n// c.f. https://nodejs.org/api/http.html#http_message_headers\nvar ignoreDuplicateOf = [\n  'age', 'authorization', 'content-length', 'content-type', 'etag',\n  'expires', 'from', 'host', 'if-modified-since', 'if-unmodified-since',\n  'last-modified', 'location', 'max-forwards', 'proxy-authorization',\n  'referer', 'retry-after', 'user-agent'\n];\n\n/**\n * Parse headers into an object\n *\n * ```\n * Date: Wed, 27 Aug 2014 08:58:49 GMT\n * Content-Type: application/json\n * Connection: keep-alive\n * Transfer-Encoding: chunked\n * ```\n *\n * @param {String} headers Headers needing to be parsed\n * @returns {Object} Headers parsed into an object\n */\nmodule.exports = function parseHeaders(headers) {\n  var parsed = {};\n  var key;\n  var val;\n  var i;\n\n  if (!headers) { return parsed; }\n\n  utils.forEach(headers.split('\\n'), function parser(line) {\n    i = line.indexOf(':');\n    key = utils.trim(line.substr(0, i)).toLowerCase();\n    val = utils.trim(line.substr(i + 1));\n\n    if (key) {\n      if (parsed[key] && ignoreDuplicateOf.indexOf(key) >= 0) {\n        return;\n      }\n      if (key === 'set-cookie') {\n        parsed[key] = (parsed[key] ? parsed[key] : []).concat([val]);\n      } else {\n        parsed[key] = parsed[key] ? parsed[key] + ', ' + val : val;\n      }\n    }\n  });\n\n  return parsed;\n};\n","'use strict';\n\nvar utils = require('./../utils');\n\nmodule.exports = (\n  utils.isStandardBrowserEnv() ?\n\n  // Standard browser envs have full support of the APIs needed to test\n  // whether the request URL is of the same origin as current location.\n    (function standardBrowserEnv() {\n      var msie = /(msie|trident)/i.test(navigator.userAgent);\n      var urlParsingNode = document.createElement('a');\n      var originURL;\n\n      /**\n    * Parse a URL to discover it's components\n    *\n    * @param {String} url The URL to be parsed\n    * @returns {Object}\n    */\n      function resolveURL(url) {\n        var href = url;\n\n        if (msie) {\n        // IE needs attribute set twice to normalize properties\n          urlParsingNode.setAttribute('href', href);\n          href = urlParsingNode.href;\n        }\n\n        urlParsingNode.setAttribute('href', href);\n\n        // urlParsingNode provides the UrlUtils interface - http://url.spec.whatwg.org/#urlutils\n        return {\n          href: urlParsingNode.href,\n          protocol: urlParsingNode.protocol ? urlParsingNode.protocol.replace(/:$/, '') : '',\n          host: urlParsingNode.host,\n          search: urlParsingNode.search ? urlParsingNode.search.replace(/^\\?/, '') : '',\n          hash: urlParsingNode.hash ? urlParsingNode.hash.replace(/^#/, '') : '',\n          hostname: urlParsingNode.hostname,\n          port: urlParsingNode.port,\n          pathname: (urlParsingNode.pathname.charAt(0) === '/') ?\n            urlParsingNode.pathname :\n            '/' + urlParsingNode.pathname\n        };\n      }\n\n      originURL = resolveURL(window.location.href);\n\n      /**\n    * Determine if a URL shares the same origin as the current location\n    *\n    * @param {String} requestURL The URL to test\n    * @returns {boolean} True if URL shares the same origin, otherwise false\n    */\n      return function isURLSameOrigin(requestURL) {\n        var parsed = (utils.isString(requestURL)) ? resolveURL(requestURL) : requestURL;\n        return (parsed.protocol === originURL.protocol &&\n            parsed.host === originURL.host);\n      };\n    })() :\n\n  // Non standard browser envs (web workers, react-native) lack needed support.\n    (function nonStandardBrowserEnv() {\n      return function isURLSameOrigin() {\n        return true;\n      };\n    })()\n);\n","'use strict';\n\nvar utils = require('./../utils');\n\nmodule.exports = (\n  utils.isStandardBrowserEnv() ?\n\n  // Standard browser envs support document.cookie\n    (function standardBrowserEnv() {\n      return {\n        write: function write(name, value, expires, path, domain, secure) {\n          var cookie = [];\n          cookie.push(name + '=' + encodeURIComponent(value));\n\n          if (utils.isNumber(expires)) {\n            cookie.push('expires=' + new Date(expires).toGMTString());\n          }\n\n          if (utils.isString(path)) {\n            cookie.push('path=' + path);\n          }\n\n          if (utils.isString(domain)) {\n            cookie.push('domain=' + domain);\n          }\n\n          if (secure === true) {\n            cookie.push('secure');\n          }\n\n          document.cookie = cookie.join('; ');\n        },\n\n        read: function read(name) {\n          var match = document.cookie.match(new RegExp('(^|;\\\\s*)(' + name + ')=([^;]*)'));\n          return (match ? decodeURIComponent(match[3]) : null);\n        },\n\n        remove: function remove(name) {\n          this.write(name, '', Date.now() - 86400000);\n        }\n      };\n    })() :\n\n  // Non standard browser env (web workers, react-native) lack needed support.\n    (function nonStandardBrowserEnv() {\n      return {\n        write: function write() {},\n        read: function read() { return null; },\n        remove: function remove() {}\n      };\n    })()\n);\n","'use strict';\n\n/**\n * Determines whether the specified URL is absolute\n *\n * @param {string} url The URL to test\n * @returns {boolean} True if the specified URL is absolute, otherwise false\n */\nmodule.exports = function isAbsoluteURL(url) {\n  // A URL is considered absolute if it begins with \"<scheme>://\" or \"//\" (protocol-relative URL).\n  // RFC 3986 defines scheme name as a sequence of characters beginning with a letter and followed\n  // by any combination of letters, digits, plus, period, or hyphen.\n  return /^([a-z][a-z\\d\\+\\-\\.]*:)?\\/\\//i.test(url);\n};\n","'use strict';\n\n/**\n * Creates a new URL by combining the specified URLs\n *\n * @param {string} baseURL The base URL\n * @param {string} relativeURL The relative URL\n * @returns {string} The combined URL\n */\nmodule.exports = function combineURLs(baseURL, relativeURL) {\n  return relativeURL\n    ? baseURL.replace(/\\/+$/, '') + '/' + relativeURL.replace(/^\\/+/, '')\n    : baseURL;\n};\n","'use strict';\n\nvar Cancel = require('./Cancel');\n\n/**\n * A `CancelToken` is an object that can be used to request cancellation of an operation.\n *\n * @class\n * @param {Function} executor The executor function.\n */\nfunction CancelToken(executor) {\n  if (typeof executor !== 'function') {\n    throw new TypeError('executor must be a function.');\n  }\n\n  var resolvePromise;\n  this.promise = new Promise(function promiseExecutor(resolve) {\n    resolvePromise = resolve;\n  });\n\n  var token = this;\n  executor(function cancel(message) {\n    if (token.reason) {\n      // Cancellation has already been requested\n      return;\n    }\n\n    token.reason = new Cancel(message);\n    resolvePromise(token.reason);\n  });\n}\n\n/**\n * Throws a `Cancel` if cancellation has been requested.\n */\nCancelToken.prototype.throwIfRequested = function throwIfRequested() {\n  if (this.reason) {\n    throw this.reason;\n  }\n};\n\n/**\n * Returns an object that contains a new `CancelToken` and a function that, when called,\n * cancels the `CancelToken`.\n */\nCancelToken.source = function source() {\n  var cancel;\n  var token = new CancelToken(function executor(c) {\n    cancel = c;\n  });\n  return {\n    token: token,\n    cancel: cancel\n  };\n};\n\nmodule.exports = CancelToken;\n","'use strict';\n\n/**\n * Syntactic sugar for invoking a function and expanding an array for arguments.\n *\n * Common use case would be to use `Function.prototype.apply`.\n *\n *  ```js\n *  function f(x, y, z) {}\n *  var args = [1, 2, 3];\n *  f.apply(null, args);\n *  ```\n *\n * With `spread` this example can be re-written.\n *\n *  ```js\n *  spread(function(x, y, z) {})([1, 2, 3]);\n *  ```\n *\n * @param {Function} callback\n * @returns {Function}\n */\nmodule.exports = function spread(callback) {\n  return function wrap(arr) {\n    return callback.apply(null, arr);\n  };\n};\n","/**\r\n * Represents a frame for programmatic access to object frame, anywhere within a document\r\n * Recursive data structure where this.children contains an indexed array of object frames\r\n * and this.dataframes contains a property indexed array of data frames\r\n * Every object frame carries a reference to its classframe\r\n * This gives us instructions as to how to create new frames according to the schema\r\n * After that it's turtles all the way down.\r\n * @param cls - ID of the class (URL)\r\n * @param classframe - an array of frames representing a class\r\n * @param archetypes list of class frames\r\n * @param parent parent object\r\n * @returns\r\n */\r\nconst FrameHelper = require('./frameHelper');\r\nconst FramePattern = require('./framePattern');\r\n\r\nfunction ObjectFrame(cls, dataframes, classframes, parent, parentframe) {\r\n\t// the class of the frame - mandatory\r\n\tthis.empty();\r\n\tthis.cls = cls;\r\n\r\n\t// array of frames representing the full class frame\r\n\t// (optional - required to be able to safely add missing properties)\r\n\tif (classframes && typeof classframes === 'object') {\r\n\t\tthis.loadClassFrames(classframes);\r\n\t}\r\n\tif (dataframes && typeof dataframes === 'object') {\r\n\t\tthis.originalFrames = dataframes;\r\n\t\tthis.loadDataFrames(dataframes);\r\n\t} else {\r\n\t\tthis.originalFrames = false;\r\n\t}\r\n\t// parent object frame\r\n\tthis.parent = parent;\r\n\t// original frame used by parent to create me\r\n\tthis.parentframe = parentframe;\r\n\t// set to true if this is a newly created document\r\n\tthis.newDoc = false;\r\n}\r\n\r\n/**\r\n * Loads class frames for the object's class - the instructions about how to put an object together\r\n */\r\nObjectFrame.prototype.loadClassFrames = function (classframes) {\r\n\tfor (let j = 0; j < classframes.length; j += 1) {\r\n\t\tif (classframes[j]['@context']) this.jsonld_context = classframes[j]['@context'];\r\n\r\n\t\tconst cf = new ClassFrame(classframes[j]);\r\n\t\tif (cf.isValid()) {\r\n\t\t\tif(!this.classframes) this.classframes = {};\r\n\t\t\tif(typeof this.classframes[classframes[j].property] === 'undefined') {\r\n\t\t\t\tthis.classframes[classframes[j].property] = [];\r\n\t\t\t}\r\n\t\t\tthis.classframes[classframes[j].property] = cf;\r\n\t\t\tif (cf.isObject() && this.properties[classframes[j].property]) {\r\n\t\t\t\tfor (let i = 0; i < this.properties[classframes[j].property].values.length; i += 1) {\r\n\t\t\t\t\tthis.properties[classframes[j].property].values[i].loadClassFrames(classframes[j].frame);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn this;\r\n};\r\n\r\n/**\r\n * Does this object have a schema loaded?\r\n */\r\nObjectFrame.prototype.hasSchema = function () {\r\n\treturn !FrameHelper.empty(this.classframes);\r\n};\r\n\r\n/*\r\n * Loads an array of data frames into the object's internal index\r\n * {property: [frames]}\r\n */\r\nObjectFrame.prototype.loadDataFrames = function (frames) {\r\n\tif (typeof frames !== 'object' || !frames.length) return undefined;\r\n\tif (!this.originalFrames) this.originalFrames = frames;\r\n\tif (!this.subjid && frames[0].domainValue) this.subjid = frames[0].domainValue;\r\n\tfor (let i = 0; i < frames.length; i += 1) {\r\n\t\tif (frames[i]['@context']) this.jsonld_context = frames[i]['@context'];\r\n\t\tlet cframe = this.getPropertyClassFrame(frames[i].property, frames[i]);\r\n\t\tif (cframe.isClassChoice()) {\r\n\t\t\tcframe = cframe.getChosenClassFrame(frames[i].range);\r\n\t\t\tif (!cframe) {\r\n\t\t\t\tconsole.log(`no choice frame ${frames[i].range}`);\r\n\t\t\t}\r\n\t\t} else if (cframe.isLogic()) {\r\n\t\t\tcframe = cframe.getChosenFrame(frames[i]);\r\n\t\t}\r\n\t\tif (cframe) {\r\n\t\t\tif (typeof this.properties[frames[i].property] === 'undefined') {\r\n\t\t\t\tthis.properties[frames[i].property] = new PropertyFrame(frames[i].property, cframe, this);\r\n\t\t\t}\r\n\t\t\tthis.properties[frames[i].property].addFrame(frames[i]);\r\n\t\t}\r\n\t}\r\n\treturn this;\r\n};\r\n\r\n/*\r\n * Serialises the javascript object as an array of frames\r\n */\r\nObjectFrame.prototype.getAsFrame = function (prop, parent) {\r\n\tif (this.parentframe) return this.parentframe;\r\n\tconst ff = { type: 'objectProperty', property: prop };\r\n\tff.range = this.cls;\r\n\tff.domain = parent.cls;\r\n\tff.domainValue = parent.subjid;\r\n\tff.frame = [];\r\n\tfor (const prop of Object.keys(this.properties)) {\r\n\t\tff.frame = ff.frame.concat(ff.frame, this.properties[prop].getAsFrames());\r\n\t}\r\n\treturn ff;\r\n};\r\n\r\nObjectFrame.prototype.getAsFrames = function (prop, parent) {\r\n\tvar frames = [];\r\n\tfor (const prop of Object.keys(this.properties)) {\r\n\t\tframes = frames.concat(frames, this.properties[prop].getAsFrames());\r\n\t}\r\n\treturn frames;\r\n}\r\n\r\nObjectFrame.prototype.isnew = function () {\r\n\treturn this.newDoc;\r\n};\r\n\r\n/**\r\n * Cleans out object and sets everything empty\r\n */\r\nObjectFrame.prototype.empty = function () {\r\n\t// all indexed by property\r\n\tthis.properties = {};\r\n\tthis.restrictions = {};\r\n\tthis.subjid = false;\r\n\tthis.cls = false;\r\n};\r\n\r\n/*\r\n * Resets object state to original state\r\n */\r\nObjectFrame.prototype.reset = function (prop) {\r\n\tif (prop) {\r\n\t\tconst props = [];\r\n\t\tfor (let i = 0; i < this.originalFrames.length; i += 1) {\r\n\t\t\tif (this.originalFrames[i].property === prop) {\r\n\t\t\t\tprops.push(this.originalFrames[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (this.properties[prop]) this.properties[prop] = [];\r\n\t\tthis.loadDataFrames(props);\r\n\t} else {\r\n\t\tthis.restrictions = {};\r\n\t\tthis.properties = {};\r\n\t\tthis.loadDataFrames(this.originalFrames);\r\n\t}\r\n};\r\n\r\n/*\r\n * Clears out any specific information from a tree\r\n */\r\nObjectFrame.prototype.clear = function () {\r\n\tfor (const prop of Object.keys(this.properties)) {\r\n\t\tthis.properties[prop].clear();\r\n\t}\r\n\treturn this;\r\n};\r\n\r\n/*\r\n * Filters the frame and its children\r\n */\r\nObjectFrame.prototype.filter = function (rules, onmatch, options) {\r\n\tconst cascading = (options && options.ignore_failure ? true : false);\r\n\tvar hits = FramePattern.FramePatternMatcher.testRules(rules, this, onmatch);\r\n\t//if(hits.length || cascading){\r\n\t\tfor (const prop of Object.keys(this.properties)) {\r\n\t\t\tthis.properties[prop].filter(rules, onmatch, options);\r\n\t\t}\r\n\t//}\r\n\treturn this;\r\n};\r\n\r\n\r\n/**\r\n * If a class frame is present, it is returned for the given property\r\n * If no class frame is present and an instance frame is passed in the\r\n * this enables make it up as you go along editing\r\n * second argument a class frame will be created from the instance frame.\r\n */\r\nObjectFrame.prototype.getPropertyClassFrame = function (prop, instance) {\r\n\tif (this.classframes && typeof this.classframes === 'object' && typeof this.classframes[prop] === 'object') {\r\n\t\treturn this.classframes[prop];\r\n\t}\r\n\tif (instance) {\r\n\t\tconst cf = new ClassFrame(instance);\r\n\t\treturn cf;\r\n\t}\r\n\tif (this.properties[prop]) {\r\n\t\treturn new ClassFrame(this.properties[prop].values[0]);\r\n\t}\r\n\treturn false;\r\n};\r\n\r\n/*\r\n * Returns a list of properties - type can be filled|missing|all\r\n */\r\nObjectFrame.prototype.getProperties = function (type) {\r\n\tif(type == \"filled\" || !this.classframes){\r\n\t\treturn Object.keys(this.properties);\r\n\t}\r\n\tif (type == 'missing') {\r\n\t\tconst filled = Object.keys(this.properties);\r\n\t\tconst all = Object.keys(this.classframes);\r\n\t\tconst missing = [];\r\n\t\tfor (let i = 0; i < all.length; i++) {\r\n\t\t\tif (filled.indexOf(all[i]) == -1 && missing.indexOf(all[i]) == -1) {\r\n\t\t\t\tmissing.push(all[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn missing;\r\n\t}\r\n\treturn Object.keys(this.classframes);\r\n};\r\n\r\n/**\r\n * Missing properties are those that are present in the classframe,\r\n * but not instantiated in the current object frame\r\n * for this to work we need to load the frame with the associated classframe\r\n */\r\nObjectFrame.prototype.getMissingPropertyList = function () {\r\n\tvar missing = this.getProperties(\"missing\");\r\n\tconst nmissing = [];\r\n\tfor (let i = 0; i < missing.length; i++) {\r\n\t\tconst cframe = this.getPropertyClassFrame(missing[i]);\r\n\t\tconst newb = { label: cframe.getLabel(), value: missing[i] };\r\n\t\tnmissing.push(newb);\r\n\t}\r\n\treturn nmissing;\r\n};\r\n\r\n/**\r\n * List of properties that are filled in the object\r\n */\r\nObjectFrame.prototype.getFilledPropertyList = function () {\r\n\tvar props = this.getProperties(\"filled\");\r\n\tconst filled = [];\r\n\tfor (let i = 0; i < props.length; i++) {\r\n\t\tconst cframe = this.getPropertyClassFrame(props[i]);\r\n\t\tconst newb = { label: cframe.getLabel(), value: props[i] };\r\n\t\tfilled.push(newb);\r\n\t}\r\n\treturn filled;\r\n};\r\n\r\n/*\r\n * Fills the object frame from the schema - adding all the necessary property frames, etc to make it complete\r\n */\r\nObjectFrame.prototype.fillFromSchema = function (newid) {\r\n\tif (newid) this.subjid = newid;\r\n\tnewid = (newid || FrameHelper.genBNID());\r\n\tconst properties = {};\r\n\tfor (const prop of Object.keys(this.classframes)) {\r\n\t\tconst pf = this.getPropertyClassFrame(prop);\r\n\t\tproperties[prop] = new PropertyFrame(prop, pf);\r\n\t\tproperties[prop].fillFromSchema(newid);\r\n\t}\r\n\tthis.properties = properties;\r\n\tthis.originalFrames = [];\r\n\tfor (const prop of Object.keys(this.properties)) {\r\n\t\tthis.originalFrames.push(this.properties[prop].getAsFrames());\r\n\t}\r\n\treturn this;\r\n};\r\n\r\n/*\r\n * Clones an object frame to be a copy of the current frame\r\n */\r\nObjectFrame.prototype.clone = function (newid) {\r\n\tconst properties = {};\r\n\tconst cloned = new ObjectFrame(this.cls, false, false, this.parent);\r\n\tcloned.classframes = this.classframes;\r\n\tcloned.subjid = newid;\r\n\tfor (const prop of Object.keys(this.properties)) {\r\n\t\tproperties[prop] = this.properties[prop].clone();\r\n\t}\r\n\tcloned.properties = properties;\r\n\treturn cloned;\r\n};\r\n\r\n\r\n/**\r\n * Returns a child frame with a particular id\r\n * If the second parameter is included, it will only look in that specific property\r\n * Otherwise searches all properties for the child\r\n */\r\nObjectFrame.prototype.getChild = function (childid, prop) {\r\n\tlet pframe = this.getProperty(prop);\r\n\tfor (let i = 0; i < pframe.values.length; pframe++) {\r\n\t\tif (pframe.values[i].isObject() && pframe.values[i].subject === childid) return pframe.values[i];\r\n\t}\r\n\tif (!prop) {\r\n\t\tfor (const key of Object.keys(this.properties)) {\r\n\t\t\tfor (let i = 0; i < this.properties[key].values.length; i += 1) {\r\n\t\t\t\tif (this.properties[key].values[i].subject() === childid) return this.properties[key].values[i];\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nObjectFrame.prototype.addProperty = function (prop, cls) {\r\n\tconst cframe = this.getPropertyClassFrame(prop);\r\n\tconst nprop = new PropertyFrame(prop, cframe);\r\n\tif (nprop.isData()) {\r\n\t\tconst df = cframe.copy();\r\n\t\tdf.set('');\r\n\t}\r\n\tif (cframe.isObject()) {\r\n\t\tif (!cframe.isClassChoice()) {\r\n\t\t\tconst df = cframe.createEmpty(FrameHelper.genBNID());\r\n\t\t}\r\n\t\tif (cls) {\r\n\t\t\tconst df = cframe.createEmptyChoice(cls, FrameHelper.genBNID());\r\n\t\t}\r\n\t\tconst clss = cframe.getClassChoices();\r\n\t\tif (clss && clss.length) {\r\n\t\t\tconst df = cframe.createEmptyChoice(clss[0], FrameHelper.genBNID());\r\n\t\t}\r\n\t}\r\n\tif (typeof this.properties[prop] === 'undefined') {\r\n\t\tthis.properties[prop] = [];\r\n\t}\r\n\tthis.properties[prop].push(df);\r\n\treturn df;\r\n};\r\n\r\nObjectFrame.prototype.addPropertyValue = function (prop, value) {\r\n\tconst pframe = this.properties[prop];\r\n\treturn pframe.addValue(value);\r\n};\r\n\r\nObjectFrame.prototype.removeProperty = function (prop) {\r\n\tif (typeof this.properties[prop] !== 'undefined') {\r\n\t\tdelete (this.properties[prop]);\r\n\t}\r\n};\r\n\r\nObjectFrame.prototype.removePropertyValue = function (prop, value, index) {\r\n\tconst pframe = this.properties[prop];\r\n\tpframe.removeValue(value, index);\r\n\tif (pframe.values.length == 0) {\r\n\t\tthis.removeProperty(prop);\r\n\t}\r\n};\r\n\r\nObjectFrame.prototype.error = function (msg) {\r\n\tconsole.error(msg);\r\n};\r\n\r\n\r\nObjectFrame.prototype.subject = function () {\r\n\treturn this.subjid;\r\n};\r\n\r\nObjectFrame.prototype.get = ObjectFrame.prototype.subject;\r\n\r\nObjectFrame.prototype.isObject = function () { return true; };\r\nObjectFrame.prototype.isProperty = function () { return false; };\r\nObjectFrame.prototype.isData = function () { return false; };\r\n\r\n\r\nObjectFrame.prototype.subjectClass = function () {\r\n\treturn this.cls;\r\n};\r\n\r\nObjectFrame.prototype.depth = function () {\r\n\tif (this.parent) return (this.parent.depth() + 1);\r\n\treturn 0;\r\n};\r\n\r\nObjectFrame.prototype.getProperty = function (prop) {\r\n\treturn this.properties[prop];\r\n};\r\n\r\nObjectFrame.prototype.first = function (prop) {\r\n\tif (this.properties && this.properties[prop]) {\r\n\t\treturn this.properties[prop].first();\r\n\t}\r\n};\r\n\r\nObjectFrame.prototype.property = function (prop) {\r\n\tif (this.parent) return this.parent.property();\r\n\treturn false;\r\n};\r\n\r\nObjectFrame.prototype.parentObject = function () {\r\n\tif (this.parent && this.parent.parent) {\r\n\t\treturn this.parent.parent;\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nObjectFrame.prototype.root = function () {\r\n\tif (this.parent) return false;\r\n\treturn true;\r\n};\r\n\r\nObjectFrame.prototype.renderProperties = function () {\r\n\tconst props = this.sortProperties();\r\n\tconst nprops = [];\r\n\tfor (let i = 0; i < props.length; i++) {\r\n\t\tif (this.properties[props[i]].render) {\r\n\t\t\tconst rend = this.properties[props[i]].render(this.properties[props[i]]);\r\n\t\t\tif (rend) nprops.push(rend);\r\n\t\t}\r\n\t}\r\n\treturn nprops;\r\n};\r\n\r\nObjectFrame.prototype.sortProperties = function () {\r\n\tconst unsorted = Object.keys(this.properties);\r\n\tif (this.compare) {\r\n\t\treturn unsorted.sort((a, b) => this.compare(a, b, this));\r\n\t}\r\n\treturn unsorted.sort((a, b) => this.standardCompare(a, b, this));\r\n};\r\n\r\n/*\r\n * Label first, then datatype properties, then object properties\r\n */\r\nObjectFrame.prototype.standardCompare = function (a, b, doc) {\r\n\tif (a == 'rdfs:label') return -1;\r\n\tif (b == 'rdfs:label') return 1;\r\n\tif (a == 'rdfs:comment') return -1;\r\n\tif (b == 'rdfs:comment') return 1;\r\n\tif (doc.properties[a].isData() && doc.properties[b].isObject()) return -1;\r\n\tif (doc.properties[b].isData() && doc.properties[a].isObject()) return 1;\r\n\treturn 0;\r\n};\r\n\r\nObjectFrame.prototype.cardControlAllows = function(action){\r\n\tif(!this.parent) return true;\r\n\tif(this.parent.cframe.hasRestriction()){\r\n\t\tvar rest = this.parent.cframe.restriction;\r\n\t\tvar currentnum = this.parent.values.length;\r\n\t\tif(action == \"add\" || action == \"clone\"){\r\n\t\t\tif(rest.max && currentnum >= rest.max){\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(action == \"delete\" && (rest.min && currentnum <= rest.min)){\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nObjectFrame.prototype.isUpdated = function(){\r\n\tvar i = 0;\r\n\tfor(var prop in this.properties){\r\n\t\tif(this.originalFrames[i] != prop) return true;\r\n\t\tif(this.properties[prop].isUpdated()) return true;\r\n\t\ti++;\r\n\t}\r\n\tif(i != this.originalFrames.length) return true;\r\n\treturn false;\r\n}\r\n\r\n\r\nObjectFrame.prototype.getSummary = function(){\r\n\tvar ret = { status: \"ok\" };\r\n\tif(this.isUpdated()) ret.status = \"updated\";\r\n\tif(this.isNew()) ret.status = \"new\";\r\n\tret.propcount = 0;\r\n\tfor(var prop in this.properties){\r\n\t\tret.propcount++;\r\n\t}\r\n\tret.long = ret.propcount + \" properties\";\r\n\treturn ret;\r\n}\r\n\r\nfunction PropertyFrame(property, cframe, parent) {\r\n\tthis.predicate = property;\r\n\tthis.cframe = cframe;\r\n\tthis.parent = parent;\r\n\tthis.values = [];\r\n}\r\n\r\nPropertyFrame.prototype.addFrame = function (frame) {\r\n\tif(this.cframe.isData()){\r\n\t\tvar df = new DataFrame(frame, this, this.values.length);\r\n\t\tthis.values.push(df);\r\n\t} else {\r\n\t\tconst kid = new ObjectFrame(this.range(), cframe.frame, frame.frame, this, frame);\r\n\t\tthis.values.push(kid);\r\n\t}\r\n};\r\n\r\nPropertyFrame.prototype.fillFromSchema = function (newid) {\r\n\tif (this.isData() || (this.isObject() && !this.isClassChoice())) {\r\n\t\tif (this.cframe.hasRestriction() && this.cframe.restriction.min) {\r\n\t\t\tvalues = [];\r\n\t\t\tfor (let i = 0; i < this.cframe.restriction.min; i += 1) {\r\n\t\t\t\tvalues.push(this.createEmpty(newid));\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tvalues = [this.createEmpty(newid)];\r\n\t\t}\r\n\t} else if (this.isClassChoice()) {\r\n\t\tconst clss = this.getClassChoices();\r\n\t\tif (clss && clss.length) {\r\n\t\t\tconst empty = this.createEmptyChoice(clss[0], FrameHelper.genBNID());\r\n\t\t\tvalues = [empty];\r\n\t\t}\r\n\t}\r\n\tthis.values = values;\r\n};\r\n\r\nPropertyFrame.prototype.isData = function () {\r\n\treturn this.cframe.isData();\r\n};\r\n\r\nPropertyFrame.prototype.isObject = function () {\r\n\treturn this.cframe.isObject();\r\n};\r\n\r\nPropertyFrame.prototype.isProperty = function () {\r\n\treturn true;\r\n};\r\n\r\nPropertyFrame.prototype.property = function () {\r\n\treturn this.predicate;\r\n};\r\n\r\nPropertyFrame.prototype.extract = function () {\r\n \tconst extracts = [];\r\n \tfor (let i = 0; i < this.values.length; i++) {\r\n \t\tconst val = this.values[i].extract();\r\n \t\tif (val !== '' && val !== false && typeof val !== 'undefined') extracts.push(val);\r\n \t}\r\n\treturn extracts;\r\n};\r\n\r\nPropertyFrame.prototype.subject = function () {\r\n\treturn (this.parent ? this.parent.subject() : false);\r\n};\r\nPropertyFrame.prototype.subjectClass = function () {\r\n\treturn (this.parent ? this.parent.subjectClass() : false);\r\n};\r\nPropertyFrame.prototype.depth = function () {\r\n\treturn (this.parent ? this.parent.depth() : false);\r\n};\r\nPropertyFrame.prototype.updated = function () {\r\n\treturn (this.parent ? this.parent.childUpdated() : false);\r\n};\r\nPropertyFrame.prototype.range = function () {\r\n\treturn (this.cframe ? this.cframe.range : '');\r\n};\r\nPropertyFrame.prototype.getLabel = function () {\r\n\treturn (\r\n\t\tthis.cframe ? this.cframe.getLabel() : '');\r\n};\r\nPropertyFrame.prototype.getComment = function () {\r\n\treturn (this.cframe ? this.cframe.getComment() : false);\r\n};\r\nPropertyFrame.prototype.hasCardinalityRestriction = function () {\r\n\treturn (this.cframe ? this.cframe.hasRestriction() : false);\r\n};\r\nPropertyFrame.prototype.getRestriction = function () {\r\n\treturn (this.cframe ? this.cframe.restriction : false);\r\n};\r\nPropertyFrame.prototype.isClassChoice = function () {\r\n\treturn (this.cframe ? this.cframe.isClassChoice() : false);\r\n};\r\n\r\nPropertyFrame.prototype.deletePropertyValue = function (value, index) {\r\n\tthis.parent.removePropertyValue(this.property(), value, index);\r\n};\r\n\r\nPropertyFrame.prototype.get = function(){\r\n\tvar gets = [];\r\n\tfor(var i = 0; i<this.values.length; i++){\r\n\t\tif(this.values[i]) {\r\n\t\t\tvar x = this.values[i].get();\r\n\t\t\tif(x) gets.push(x);\r\n\t\t}\r\n\t}\r\n\treturn gets;\r\n}\r\n\r\nPropertyFrame.prototype.clear = function(){\r\n\tfor(var i = 0 ; i<this.values.length; i++){\r\n\t\tthis.values[i].clear();\r\n\t}\r\n}\r\n\r\nPropertyFrame.prototype.clone = function(){\r\n\tconst cvalues = [];\r\n\tconst cloned = new PropertyFrame(this.predicate, this.cframe, this.parent);\r\n\tfor(var i = 0 ; i<this.values.length; i++){\r\n\t\tcvalues.push(this.values[i].clone());\r\n\t}\r\n\tcloned.values = cvalues;\r\n\treturn cloned;\r\n\t//\r\n}\r\n\r\nPropertyFrame.prototype.getAsFrames = function(){\r\n\tvar fs = [];\r\n\tfor(var i = 0; i<this.values.length; i++){\r\n\t\tif(this.values[i]){\r\n\t\t\tif(this.isData()){\r\n\t\t\t\tfs.push(this.values[i].getAsFrame());\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tfs = fs.concat(this.values[i].getAsFrames());\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn fs;\r\n}\r\n\r\nPropertyFrame.prototype.createEmpty = function(){\r\n\tif (this.cframe.isData()) {\r\n\t\tconst df = this.cframe.copy();\r\n\t\tdf.set('');\r\n\t\treturn df;\r\n\t}\r\n\telse if (this.cframe.isObject()) {\r\n\t\tif (!this.cframe.isClassChoice()) {\r\n\t\t\tconst df = this.cframe.createEmpty(FrameHelper.genBNID());\r\n\t\t\treturn df;\r\n\t\t}\r\n\t\tconst clss = this.cframe.getClassChoices();\r\n\t\tif (clss && clss.length) {\r\n\t\t\tconst df = this.cframe.createEmptyChoice(clss[0], FrameHelper.genBNID());\r\n\t\t\treturn df;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nPropertyFrame.prototype.filter = function (rules, onmatch, options) {\r\n\tconst cascading = (options && options.ignore_failure ? true : false);\r\n\tvar hits = FramePattern.FramePatternMatcher.testRules(rules, this, onmatch);\r\n\t//if(hits.length || cascading){\r\n\t\tfor (var i = 0; i<this.values.length; i++){\r\n\t\t\tthis.values[i].filter(rules, onmatch, options);\r\n\t\t}\r\n\t//}\r\n\treturn this;\r\n}\r\n\r\n/*\r\n * Shorthand functions to make it easier to access the underlying data\r\n */\r\n\r\nPropertyFrame.prototype.first = function () {\r\n\tif (this.values && this.values[0]) {\r\n\t\treturn this.values[0].get();\r\n\t}\r\n};\r\n\r\nPropertyFrame.prototype.renderValues = function(){\r\n\tvar sortedVals = this.sortValues();\r\n\tvar vals = [];\r\n\tfor(var i = 0; i<sortedVals.length; i++){\r\n\t\tif(sortedVals[i] && sortedVals[i].render){\r\n\t\t\tvar rend = sortedVals[i].render(sortedVals[i]);\r\n\t\t\tif(rend) vals.push(rend);\r\n\t\t}\r\n\t}\r\n\treturn vals;\r\n};\r\n\r\nPropertyFrame.prototype.sortValues = function () {\r\n\tif (this.compare) {\r\n\t\treturn this.values.sort((a, b) => this.compare(a, b, this));\r\n\t}\r\n\treturn this.values;\r\n};\r\n\r\nPropertyFrame.prototype.cardControlAllows = function(action){\r\n\tif(this.cframe.hasRestriction()){\r\n\t\tvar rest = this.cframe.restriction;\r\n\t\tvar currentnum = this.values.length;\r\n\t\tif(action == \"add\" || action == \"clone\"){\r\n\t\t\tif(rest.max && currentnum >= rest.max){\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(action == \"delete\" && (rest.min)){\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nPropertyFrame.prototype.isUpdated = function(){\r\n\treturn true;\r\n\tif(this.values.length != this.originalValues.length) return true;\r\n\tfor(var i = 0 ; i < this.values.length; i++){\r\n\t\tif(this.cframe && this.cframe.isData()){\r\n\t\t\tif(this.values[i].value() != this.originalValues[i]){\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tif(this.values[i].subject() != this.originalValues[i]) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\tif(this.values[i].isUpdated()) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\n\r\nfunction DataFrame(frame, parent, index) {\r\n\tthis.err = false;\r\n\tthis.parent = parent;\r\n\t// the id of the object that owns this dataframe\r\n\tthis.subjid = (parent ? parent.subjid : false);\r\n\tthis.index = index;\r\n\tif (frame) {\r\n\t\tthis.load(frame);\r\n\t}\r\n}\r\n\r\nDataFrame.prototype.load = function (frame) {\r\n\tif (typeof frame !== 'object') {\r\n\t\tthis.error('No frame passed to load');\r\n\t\treturn;\r\n\t}\r\n\t// all the meta-data carried in frames:\r\n\tthis.type = frame.type;\r\n\tthis.predicate = frame.property;\r\n\tthis.range = frame.range;\r\n\tthis.rangeValue = frame.rangeValue;\r\n\tthis.domain = frame.domain;\r\n\tthis.domainValue = frame.domainValue;\r\n\tthis.frame = frame.frame;\r\n\tthis.label = frame.label;\r\n\tthis.comment = frame.comment;\r\n\tconst { restriction } = frame;\r\n\tthis.restriction = false;\r\n\tif (restriction && typeof restriction === 'object') {\r\n\t\tthis.restriction = new Restriction(restriction);\r\n\t}\r\n};\r\n\r\nDataFrame.prototype.filter = function (rules, onmatch) {\r\n\tFramePattern.FramePatternMatcher.testRules(rules, this, onmatch);\r\n\treturn this;\r\n};\r\n\r\nDataFrame.prototype.delete = function () {\r\n\tthis.parent.deletePropertyValue(this.get(), this.index);\r\n};\r\n\r\nDataFrame.prototype.save = function () {\r\n\tif (this.parent) {\r\n\t\tthis.parent.save();\r\n\t}\r\n};\r\n\r\nDataFrame.prototype.reset = function () {\r\n\tthis.set(this.originalValue);\r\n\t// this.redraw();\r\n};\r\n\r\nDataFrame.prototype.clone = function () {\r\n\tconst newb = this.parent.addPropertyValue(this.get());\r\n\tconst nrend = this.copy(newb);\r\n\tnrend.setNew();\r\n\tnrend.mode = 'edit';\r\n\tnrend.index = this.parent.values.length;\r\n\tthis.parent.values.push(nrend);\r\n};\r\n\r\n\r\nDataFrame.prototype.depth = function () { return (this.parent ? this.parent.depth() : false); };\r\nDataFrame.prototype.property = function () { return (this.parent ? this.parent.property() : false); };\r\nDataFrame.prototype.subject = function () { return (this.parent ? this.parent.subject() : false); };\r\nDataFrame.prototype.subjectClass = function () { return (this.parent ? this.parent.subjectClass() : false); };\r\nDataFrame.prototype.range = function () {\treturn (this.frame ? this.frame.range : false); };\r\n\r\nDataFrame.prototype.isValidType = function (dt) {\r\n\tconst vtypes = ['datatypeProperty', 'objectProperty', 'restriction '];\r\n\tif (vtypes.indexOf(dt) === -1) return false;\r\n\treturn true;\r\n};\r\n\r\n\r\nDataFrame.prototype.getAsFrame = function () {\r\n\t const ff = { type: this.type, property: this.property() };\r\n\t if (this.range) ff.range = this.range;\r\n\t if (this.rangeValue) ff.rangeValue = this.rangeValue;\r\n\t if (this.domain) ff.domain = this.domain;\r\n\t if (this.domainValue) ff.domainValue = this.domainValue;\r\n\t if (this.frame) ff.frame = this.frame;\r\n\t if (this.label) ff.label = this.label;\r\n\t if (this.comment) ff.comment = this.comment;\r\n\t return ff;\r\n};\r\n\r\nDataFrame.prototype.hasRestriction = function () {\r\n\t if (this.restriction) {\r\n\t\t return this.restriction.hasCardRestriction();\r\n\t }\r\n\t return false;\r\n};\r\n\r\nDataFrame.prototype.copy = function (newid) {\r\n\tconst copy = new DataFrame(this, this.parent);\r\n\tif (newid) copy.domainValue = newid;\r\n\treturn copy;\r\n};\r\n\r\nDataFrame.prototype.getLabel = function () {\r\n\tlet lab = '';\r\n\tif(this.predicate == \"rdfs:label\") return \"Label\";\r\n\tif(this.predicate == \"rdfs:comment\") return \"Comment\";\r\n\tif (this.label && typeof this.label === 'object') lab = this.label['@value'];\r\n\tif (this.label && typeof this.label === 'string') lab = this.label;\r\n\t// always return something\r\n\tif (!lab && this.property()) lab = FrameHelper.labelFromURL(this.property());\r\n\tif (!lab) lab = FrameHelper.labelFromURL(this.cls);\r\n\treturn lab;\r\n};\r\n\r\nDataFrame.prototype.getType = function () {\r\n\tif (this.range) return this.range;\r\n\tif (this.rangeValue && this.rangeValue.type) return this.rangeValue.type;\r\n\treturn false;\r\n};\r\n\r\nObjectFrame.prototype.getLabel = DataFrame.prototype.getLabel;\r\n\r\nDataFrame.prototype.getComment = function () {\r\n\tlet comment = '';\r\n\tif (this.comment && typeof this.comment === 'object') comment = this.comment['@value'];\r\n\tif (this.comment && typeof this.comment === 'string') comment = this.comment;\r\n\treturn comment;\r\n};\r\n\r\nObjectFrame.prototype.getComment = DataFrame.prototype.getComment;\r\n\r\n\r\nDataFrame.prototype.error = function (msg) {\r\n\tif (msg)\tthis.err = msg;\r\n\treturn this.err;\r\n};\r\n\r\nDataFrame.prototype.isValid = function () {\r\n\tif (!(this.type && this.isValidType(this.type))) {\r\n\t\tthis.error(`Missing or Illegal Frame Type ${this.type}`);\r\n\t\treturn false;\r\n\t}\r\n\tif (!(this.predicate)) {\r\n\t\tthis.error('Missing Frame Property');\r\n\t\treturn false;\r\n\t}\r\n\tif (!(this.domain)) {\r\n\t\tthis.error('Missing Frame Domain');\r\n\t\treturn false;\r\n\t}\r\n\tif (!(this.range)) {\r\n\t\tthis.error('Missing Frame Range');\r\n\t\treturn false;\r\n\t}\r\n\tif (this.isObjectProperty() && !(this.frame && typeof this.frame === 'object')) {\r\n\t\tthis.error('Missing Object Frame');\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n};\r\n\r\nDataFrame.prototype.isObjectProperty = function () {\r\n\treturn this.type === 'objectProperty';\r\n};\r\n\r\nDataFrame.prototype.isDatatypeProperty = function () {\r\n\treturn this.type === 'datatypeProperty';\r\n};\r\n\r\nDataFrame.prototype.isLogic = function () {\r\n\tif (this.type === 'and' || this.type === 'or' || this.type === 'xor') {\r\n\t\treturn true;\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nDataFrame.prototype.isRestriction = function () {\r\n\treturn this.type === 'restriction';\r\n};\r\n\r\nDataFrame.prototype.ftype = function () {\r\n\tif (this.isDocument()) return 'document';\r\n\tif (this.isDatatypeProperty()) return 'data';\r\n\tif (this.isChoice()) return 'oneOf';\r\n\tif (this.isObject()) return 'object';\r\n\tif (this.isLogic()) return 'logic';\r\n\tif (this.isClassChoice()) return 'class_choice';\r\n\treturn undefined;\r\n};\r\n\r\n\r\nDataFrame.prototype.isClassChoice = function () {\r\n\treturn (this.frame && this.frame.type === 'class_choice');\r\n};\r\n\r\nDataFrame.prototype.isString = function () {\r\n\tif (this.range === FrameHelper.getStdURL('xsd', 'string')) {\r\n\t\treturn true;\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nDataFrame.prototype.getChoiceOptions = function () {\r\n\tconst opts = [];\r\n\tfor (let i = 0; i < this.frame.elements.length; i += 1) {\r\n\t\tconst option = {};\r\n\t\tif (this.frame.elements[i].label) {\r\n\t\t\toption.label = this.frame.elements[i].label['@value'];\r\n\t\t} else {\r\n\t\t\toption.label = FrameHelper.labelFromURL(this.frame.elements[i].class);\r\n\t\t}\r\n\t\toption.value = this.frame.elements[i].class;\r\n\t\topts.push(option);\r\n\t}\r\n\treturn opts;\r\n};\r\n\r\nDataFrame.prototype.lang = function () {\r\n\treturn 'en';\r\n};\r\n\r\nDataFrame.prototype.isChoice = function () {\r\n\treturn (this.frame && this.frame.type === 'oneOf');\r\n};\r\n\r\nDataFrame.prototype.isDocument = function () {\r\n\treturn (this.frame && this.frame.type === 'document');\r\n};\r\n\r\nDataFrame.prototype.isData = function () {\r\n\treturn (this.isDocument() || this.isChoice() || this.isDatatypeProperty());\r\n};\r\n\r\nDataFrame.prototype.isObject = function () {\r\n\treturn (this.isObjectProperty() && this.frame && !(this.isChoice() || this.isDocument()));\r\n};\r\n\r\nDataFrame.prototype.isProperty = function () {\r\n\treturn false;\r\n};\r\n\r\nDataFrame.prototype.getTypeShorthand = function () {\r\n\tif (this.isDocument()) return 'document';\r\n\tif (this.isChoice()) return 'choice';\r\n\tconst sh = FrameHelper.getShorthand(this.getType());\r\n\treturn (sh || this.getType());\r\n};\r\n\r\nDataFrame.prototype.get = function () {\r\n\tif (this.contents) {\r\n\t\treturn this.contents;\r\n\t}\r\n\tif (this.isDatatypeProperty() && this.rangeValue && typeof this.rangeValue['@value'] !== 'undefined') {\r\n\t\treturn this.rangeValue['@value'];\r\n\t}\r\n\tif (this.isChoice() || this.isDocument()) {\r\n\t\treturn this.frame.domainValue;\r\n\t}\r\n\treturn '';\r\n};\r\n\r\nDataFrame.prototype.set = function (value, normalizer) {\r\n\tif (normalizer) value = normalizer(value, this);\r\n\tthis.contents = value;\r\n\tif (this.isChoice() || this.isDocument()) {\r\n\t\tthis.frame.domainValue = value;\r\n\t}\r\n\tif (this.isDatatypeProperty() && this.rangeValue) {\r\n\t\tthis.rangeValue['@value'] = value;\r\n\t}\r\n};\r\n\r\nDataFrame.prototype.clear = function () {\r\n\tif (this.isDocument() || this.isChoice() || this.isDatatypeProperty()) {\r\n\t\tthis.set('');\r\n\t}\r\n};\r\n\r\nDataFrame.prototype.cardControlAllows = function(action){\r\n\tif(this.parent.cframe.hasRestriction()){\r\n\t\tvar rest = this.parent.cframe.restriction;\r\n\t\tvar currentnum = this.parent.values.length;\r\n\t\tif(action == \"add\" || action == \"clone\"){\r\n\t\t\tif(rest.max && currentnum >= rest.max){\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(action == \"delete\" && (rest.min && currentnum <= rest.min)){\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\treturn true;\r\n}\r\n\r\n\r\n/*\r\n * Class frames represent the archetypal version of a property frame as returned by the class frame api\r\n */\r\nfunction ClassFrame(frame, parent) {\r\n\tthis.err = false;\r\n\tthis.parent = parent;\r\n\t// the id of the object that owns this dataframe\r\n\tthis.subjid = (parent ? parent.subjid : false);\r\n\tif (frame) {\r\n\t\tthis.load(frame);\r\n\t}\r\n}\r\n\r\nClassFrame.prototype = DataFrame.prototype;\r\n\r\nClassFrame.prototype.loadFromObjectFrame = function (par, child) {\r\n\t// all the meta-data carried in frames:\r\n\tthis.type = 'objectProperty';\r\n\tthis.predicate = par.property;\r\n\tthis.range = par.range;\r\n\tthis.rangeValue = child.subjid;\r\n\tthis.domain = par.cls;\r\n\tthis.domainValue = par.subjid;\r\n\tthis.label = par.getLabel();\r\n\tthis.comment = par.getComment();\r\n\tthis.restriction = par.restriction;\r\n};\r\n\r\nClassFrame.prototype.createEmptyChoice = function (cls, newid) {\r\n\tconst cf = this.getChosenClassFrames(cls);\r\n\tconst objframe = new ObjectFrame(cls);\r\n\tif (newid) objframe.subjid = newid;\r\n\tobjframe.loadClassFrames(cf);\r\n\tconst fframe = objframe.fillFromSchema();\r\n\treturn fframe;\r\n};\r\n\r\nClassFrame.prototype.getChosenClassFrames = function (chosen) {\r\n\tlet nc = [];\r\n\tfor (let i = 0; i < this.frame.operands.length; i += 1) {\r\n\t\tfor (let j = 0; j < this.frame.operands[i].length; j += 1) {\r\n\t\t\tif (chosen === this.frame.operands[i][j].domain) {\r\n\t\t\t\tnc = nc.concat(this.frame.operands[i][j]);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn nc;\r\n};\r\n\r\nClassFrame.prototype.createEmpty = function (newid) {\r\n\tif (this.isObject()) {\r\n\t\tconst objframe = new ObjectFrame(this.range);\r\n\t\tif (newid) objframe.subjid = newid;\r\n\t\tobjframe.loadClassFrames(this.frame);\r\n\t\tconst fframe = objframe.fillFromSchema();\r\n\t\treturn fframe;\r\n\t}\r\n\tif (this.isData()) {\r\n\t\tconst dataframe = this.copy();\r\n\t\tdataframe.set('');\r\n\t\treturn dataframe;\r\n\t}\r\n\treturn undefined;\r\n};\r\n\r\nClassFrame.prototype.cloneDataFrame = function (newid, other) {\r\n\treturn other;\r\n};\r\n\r\nClassFrame.prototype.clone = function (newid, other) {\r\n\tif (this.isObject()) {\r\n\t\tconsole.log('cannot clone class frame');\r\n\t} else if (this.isData()) {\r\n\t\treturn this.cloneDataFrame(newid, other);\r\n\t}\r\n\treturn undefined;\r\n};\r\n\r\nClassFrame.prototype.getClassChoices = function () {\r\n\tconst choices = [];\r\n\tif (this.frame.operands) {\r\n\t\tfor (let i = 0; i < this.frame.operands.length; i += 1) {\r\n\t\t\tfor (let j = 0; j < this.frame.operands[i].length; j += 1) {\r\n\t\t\t\tconst domcls = this.frame.operands[i][j].domain;\r\n\t\t\t\tif (domcls && choices.indexOf(domcls) === -1) {\r\n\t\t\t\t\tchoices.push(domcls);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn choices;\r\n};\r\n\r\nClassFrame.prototype.getChosenClassFrame = function (chosen) {\r\n\tfor (let i = 0; i < this.frame.operands.length; i += 1) {\r\n\t\tconst operand = this.frame.operands[i];\r\n\t\tif (operand.length) {\r\n\t\t\tfor (let j = 0; j < operand.length; j += 1) {\r\n\t\t\t\tif (operand[j] && (chosen === operand[j].domain)) {\r\n\t\t\t\t\tconst cf = new ClassFrame(operand);\r\n\t\t\t\t\treturn cf;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else if (operand.range && chosen === operand.range) {\r\n\t\t\tconst cf = new ClassFrame(operand);\r\n\t\t\treturn cf;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nClassFrame.prototype.getChosenFrame = function (dataframe) {\r\n\treturn dataframe;\r\n};\r\n\r\n\r\nfunction Restriction(restriction) {\r\n\tthis.min = 0;\r\n\tthis.max = 0;\r\n\tif (restriction) this.loadRestriction(restriction);\r\n}\r\n\r\nRestriction.prototype.hasCardRestriction = function () {\r\n\tif (this.min === 0 && this.max === 0) return false;\r\n\treturn true;\r\n};\r\n\r\nRestriction.prototype.loadRestriction = function (restriction) {\r\n\tif (typeof restriction.cardinality !== 'undefined') {\r\n\t\tthis.max = restriction.cardinality;\r\n\t\tthis.min = restriction.cardinality;\r\n\t} else if (typeof restriction.maxCardinality !== 'undefined') {\r\n\t\tthis.max = restriction.maxCardinality;\r\n\t} else if (typeof restriction.minCardinality !== 'undefined') {\r\n\t\tthis.min = restriction.minCardinality;\r\n\t} else if (typeof restriction.type !== 'undefined' && restriction.type === 'and' && typeof restriction.operands === 'object') {\r\n\t\tfor (let i = 0; i < restriction.operands.length; i += 1) {\r\n\t\t\tconst nrest = new Restriction(restriction.operands[i]);\r\n\t\t\tif (this.max === 0 && nrest.max > 0) this.max = nrest.max;\r\n\t\t\telse if (this.max > 0 && nrest.max > 0 && nrest.max < this.max) this.max = nrest.max;\r\n\t\t\tif (this.min === 0 && nrest.min > 0) this.min = nrest.min;\r\n\t\t\telse if (this.min > 0 && nrest.min > 0 && nrest.min > this.min) this.min = nrest.min;\r\n\t\t}\r\n\t}\r\n};\r\n\r\nmodule.exports = ObjectFrame;\r\n","const FrameHelper = require('./frameHelper');\r\n\r\nfunction WOQLResult(results, query, config) {\r\n\tthis.bindings = results.bindings;\r\n\tif(query.constructor.name == \"WOQLQuery\"){\r\n\t\tthis.query = query;\r\n\t}\r\n\telse {\r\n\t\tthis.query = query.query;\r\n\t}\r\n\tthis.cursor = 0;\r\n\tif (!(config && config.no_compress)) {\r\n\t\tconst context = (config && config.context ? config.context : false);\r\n\t\tthis.compress(context);\r\n\t}\r\n}\r\n\r\nWOQLResult.prototype.compress = function (context) {\r\n\tcontext = (context || this.query.getContext());\r\n\tfor (let i = 0; i < this.bindings.length; i++) {\r\n\t\tfor (const prop of Object.keys(this.bindings[i])) {\r\n\t\t\tconst nprop = FrameHelper.shorten(prop, context);\r\n\t\t\tconst nval = ((typeof this.bindings[i][prop] === 'string')\r\n\t\t\t\t? FrameHelper.shorten(this.bindings[i][prop], context)\r\n\t\t\t\t: this.bindings[i][prop]\r\n\t\t\t);\r\n\t\t\tdelete (this.bindings[i][prop]);\r\n\t\t\tthis.bindings[i][nprop] = nval;\r\n\t\t}\r\n\t}\r\n\treturn this;\r\n}\r\n\r\nWOQLResult.prototype.first = function () {\r\n\tthis.cursor = 0;\r\n\treturn this.bindings[0];\r\n};\r\n\r\nWOQLResult.prototype.last = function(){\r\n\tthis.cursor = this.bindings.length-1;\r\n\treturn this.bindings[this.bindings.length-1];\r\n}\r\n\r\nWOQLResult.prototype.next = function () {\r\n\tconst res = this.bindings[this.cursor];\r\n\tthis.cursor++;\r\n\treturn res;\r\n};\r\n\r\nWOQLResult.prototype.prev = function () {\r\n\tif (this.cursor > 0) {\r\n\t\tthis.cursor--;\r\n\t\treturn this.bindings[this.cursor];\r\n\t}\r\n};\r\n\r\nWOQLResult.prototype.compareValues = function(a, b, asc_or_desc){\r\n\tif(!a || !b) return 0;\r\n\tif(typeof a['@value'] != \"undefined\" && typeof b['@value'] != \"undefined\"){\r\n\t\ta = a['@value'];\r\n\t\tb = b['@value'];\r\n\t}\r\n\tif (a > b) {\r\n\t\treturn (asc_or_desc && asc_or_desc == 'asc' ? 1 : -1);\r\n\t}\r\n\tif (b > a) {\r\n\t\treturn (asc_or_desc && asc_or_desc == 'asc' ? -1 : 1);\r\n\t}\r\n};\r\n\r\nWOQLResult.prototype.sort = function(key, asc_or_desc){\r\n\tthis.bindings.sort((a, b) => {\r\n\t\treturn this.compareValues(a[key], b[key], asc_or_desc);\r\n\t});\r\n\tthis;\r\n}\r\n\r\nWOQLResult.prototype.getVariableList = function () {\r\n\tif (this.bindings && this.bindings[0]) {\r\n\t\treturn Object.keys(this.bindings[0]);\r\n\t}\r\n};\r\n\r\nWOQLResult.prototype.count = function () {\r\n\treturn this.bindings.length;\r\n};\r\n\r\nWOQLResult.prototype.hasBindings = function (result) {\r\n\treturn (this.bindings && this.count());\r\n};\r\n\r\nWOQLResult.prototype.getBindings = function () {\r\n\treturn this.bindings;\r\n};\r\n\r\nmodule.exports = WOQLResult;\r\n","/**\r\n * The WOQL object is a wrapper around the WOQL query object\r\n * Syntactic sugar to allow you to write WOQL.triple()... instead of new WOQLQuery().triple()\r\n * Every function matches one of the public api functions of the woql query object\r\n */\r\n\r\nconst FrameHelper = require('./frameHelper');\r\nconst Pattern = require('./framePattern');\r\n\r\nconst WOQL = {};\r\n\r\n/*\r\n * We expose all the real woql predicates via the WOQL object,\r\n * for ease of typing - all return a WOQL query object\r\n */\r\nWOQL.when = function(Query, Update){ return new WOQLQuery().when(Query, Update);}\r\nWOQL.opt = function(query){ return new WOQLQuery().opt(query); }\r\nWOQL.from = function(dburl, query){ return new WOQLQuery().from(dburl, query); }\r\nWOQL.into = function(dburl, query){ return new WOQLQuery().into(dburl, query); }\r\nWOQL.limit = function(limit, query){ return new WOQLQuery().limit(limit, query); }\r\nWOQL.start = function(start, query){ return new WOQLQuery().start(start, query); }\r\nWOQL.select = function(...list){ return new WOQLQuery().select(...list); }\r\nWOQL.or = function(...queries){\treturn new WOQLQuery().or(...queries); }\r\nWOQL.and = function(...queries){ return new WOQLQuery().and(...queries); }\r\nWOQL.not = function(query){ return new WOQLQuery().not(query); }\r\nWOQL.triple = function(a, b, c){ return new WOQLQuery().triple(a, b, c); }\r\nWOQL.quad = function(a, b, c, d){ return new WOQLQuery().quad(a, b, c, d); }\r\nWOQL.sub = function(a, b){ return new WOQLQuery().sub(a, b); }\r\nWOQL.isa = function(a, b){\treturn new WOQLQuery().isa(a, b);\t}\r\nWOQL.eq = function(a, b){ return new WOQLQuery().eq(a, b);}\r\nWOQL.trim = function(a, b){\treturn new WOQLQuery().trim(a, b);\t}\r\nWOQL.delete = function(JSON_or_IRI){ return new WOQLQuery().delete(JSON_or_IRI);\t}\r\nWOQL.delete_triple = function( S, P, O ){ return new WOQLQuery().delete_triple (S, P, O);\t}\r\nWOQL.delete_quad = function( S, P, O, G ){ return new WOQLQuery().delete_quad (S, P, O, G); }\r\nWOQL.add_triple = function( S, P, O ){ return new WOQLQuery().add_triple (S, P, O); }\r\nWOQL.add_quad = function( S, P, O, G ){ \treturn new WOQLQuery().add_quad (S, P, O, G);}\r\nWOQL.get = function(vars, cols, target){\treturn new WOQLQuery().get(vars, cols, target); }\r\nWOQL.as = function(map, vari){\treturn new WOQLQuery().as(map, vari); }\r\nWOQL.remote = function(url){\treturn new WOQLQuery().remote(url); }\r\nWOQL.file = function(url){\treturn new WOQLQuery().file(url); }\r\nWOQL.list = function(...vars){\treturn new WOQLQuery().list(...vars); }\r\nWOQL.group_by = function(gvarlist, groupedvar, groupquery, output){\treturn new WOQLQuery().group_by(gvarlist, groupedvar, groupquery, output); }\r\nWOQL.update = function(Q){\treturn new WOQLQuery().update(Q); }\r\n\r\n/* String and other processing functions */\r\nWOQL.concat = function(list, v){\treturn new WOQLQuery().concat(list, v); }\r\nWOQL.lower = function(u, l){\treturn new WOQLQuery().lower(u, l); }\r\nWOQL.pad = function(input, pad, len, output){\treturn new WOQLQuery().pad(input, pad, len, output); }\r\nWOQL.join = function(...list){\treturn new WOQLQuery().join(...list); }\r\nWOQL.unique = function(prefix, vari, type){\treturn new WOQLQuery().unique(prefix, vari, type); }\r\nWOQL.idgen = function(prefix, vari, type, output){\treturn new WOQLQuery().idgen(prefix, vari, type, output); }\r\nWOQL.typecast = function(vara, type, varb){\treturn new WOQLQuery().typecast(vara, type, varb); }\r\n\r\n\r\n/* Mathematical Processing */\r\nWOQL.eval = function(arith, v){\treturn new WOQLQuery().eval(arith, v);}\t\r\nWOQL.plus = function(...args){\treturn new WOQLQuery().plus(...args);}\r\nWOQL.minus = function(...args){\treturn new WOQLQuery().minus(...args); }\r\nWOQL.times = function(...args){\treturn new WOQLQuery().times(...args); }\r\nWOQL.divide = function(...args){ return new WOQLQuery().divide(...args); }\r\nWOQL.exp = function(a, b){\treturn new WOQLQuery().exp(a, b); }\r\nWOQL.div = function(...args){\treturn new WOQLQuery().div(...args); }\r\nWOQL.comment = function(arg){\treturn new WOQLQuery().comment(arg); }\r\n\r\n\r\n//language extensions that can be chained after 'grounded' stuff (clauses with a specific subject) sub, isa, delete_triple, add_triple, delete_quad, add_quad, node\r\n//WOQL.value = function(vars){\treturn new WOQLQuery().list(vars); }\r\n//These ones are special ones for dealing with the schema only...\r\nWOQL.star = function(G, S, P, O){\treturn new WOQLQuery().star(G, S, P, O); }\r\nWOQL.addClass = function(classid, graph){\treturn new WOQLQuery().addClass(classid, graph); }\r\nWOQL.addProperty = function(propid, type, graph){\treturn new WOQLQuery().addProperty(propid, type, graph); }\r\nWOQL.deleteClass = function(classid, graph){\treturn new WOQLQuery().deleteClass(classid, graph); }\r\nWOQL.deleteProperty = function(propid, type, graph){\treturn new WOQLQuery().deleteProperty(propid, type, graph); }\r\nWOQL.node = function(nodeid, type){\treturn new WOQLQuery().node(nodeid, type); }\r\n\r\n\r\n/*\r\n * Beneath here are pseudo predicates - they belong to the javascript object\r\n * but not to the WOQL language\r\n */\r\n//returns empty query object\r\nWOQL.query = function(){\treturn new WOQLQuery(); }\r\n//loads query from json\r\nWOQL.json = function(json){\treturn new WOQLQuery().json(json); }\r\n\r\nWOQL.rule = function(){ return new Pattern.FrameRule(); }\r\n//Simple utility function for typechecking\r\nWOQL.isLiteralType = function(t){\r\n\tif(t){\r\n\t\tvar pref = t.split(\":\");\r\n\t\tif(pref[0] == \"xdd\" || pref[0] == \"xsd\") return true;\r\n\t}\r\n\treturn false;\r\n}\r\n/**\r\n * The WOQL Query object implements the WOQL language via the fluent style\r\n * @param query - json version of query\r\n * @returns WOQLQuery object\r\n */\r\nfunction WOQLQuery(query){\r\n\tthis.query = (query ? query : {});\r\n\tthis.cursor = this.query;\r\n\tthis.chain_ended = false;\r\n\tthis.contains_update = false;\r\n\t// operators which preserve global paging\r\n\tthis.paging_transitive_properties = ['select', 'from', 'start', 'when', 'opt', 'limit'];\r\n\tthis.vocab = this.loadDefaultVocabulary();\r\n\t//object used to accumulate triples from fragments to support usage like node(\"x\").label(\"y\");\r\n\tthis.tripleBuilder = false;\r\n\treturn this;\r\n}\r\n\r\n/**\r\n * Takes an array of variables, an optional array of column names\r\n */\r\nWOQLQuery.prototype.get = function(arr1, arr2, target){\r\n\tif(arr1.json){\r\n\t\tvar map = arr1.json();\r\n\t\ttarget = arr2;\r\n\t}\r\n\telse {\r\n\t\tvar map = this.buildAsClauses(arr1, arr2); \r\n\t}\r\n\tif(target){\r\n\t\tif(target.json) target = target.json();\r\n\t\tthis.cursor['get'] = [map, target];\r\n\t}\r\n\telse {\r\n\t\tthis.cursor['get'] = [map, {}];\r\n\t\tthis.cursor = this.cursor[\"get\"][1];\r\n\t}\r\n\treturn this;\r\n}\r\n\r\nWOQLQuery.prototype.buildAsClauses = function(vars, cols){\r\n\tvar clauses = [];\r\n\tif(vars && typeof vars == \"object\" && vars.length){\r\n\t\tfor(var i = 0; i<vars.length; i++){\r\n\t\t\tvar v = vars[i];\r\n\t\t\tif(cols && typeof cols == \"object\" && cols.length){\r\n\t\t\t\tvar c = cols[i];\r\n\t\t\t\tif(typeof c == \"string\"){\r\n\t\t\t\t\tc = {\"@value\": c};\r\n\t\t\t\t}\r\n\t\t\t\tclauses.push({as: [c, v]});\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tv.as ? clauses.push(v) : clauses.push({as: [v]});\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn clauses;\r\n}\r\n\r\nWOQLQuery.prototype.typecast = function(va, type, vb){\r\n\tthis.cursor['typecast'] = [va, type, vb];\r\n\treturn this;\r\n}\r\n\r\n\r\nWOQLQuery.prototype.remote = function(json){\r\n\tthis.cursor['remote'] = [json];\r\n\treturn this;\r\n}\r\n\r\nWOQLQuery.prototype.file = function(json){\r\n\tthis.cursor['file'] = [json];\r\n\treturn this;\r\n}\r\n\r\n//WOQL.group_by = function(gvarlist, groupedvar, groupquery, output){\treturn new WOQLQuery().group_by(gvarlist, groupedvar, groupquery, output); }\r\n\r\nWOQLQuery.prototype.group_by = function(gvarlist, groupedvar, groupquery, output){\r\n\tvar args = [];\r\n\tthis.cursor['group_by'] = args;\r\n\tif(gvarlist.json){\r\n\t\targs.push(gvarlist.json());\r\n\t}\r\n\tif(gvarlist['list']){\r\n\t\targs.push(gvarlist);\r\n\t}\r\n\telse {\r\n\t\targs.push({'list': gvarlist});\r\n\t}\r\n\tif(groupedvar.substring(0, 2) != \"v:\") groupedvar = \"v:\" + groupedvar;\r\n\targs.push(groupedvar);\r\n\tif(output){\r\n\t\targs.push(groupquery.json());\r\n\t}\r\n\telse {\r\n\t\toutput = groupquery;\r\n\t\tvar sq = {};\r\n\t\tthis.cursor = sq;\r\n\t\targs.push(sq);\r\n\t}\r\n\tif(output.substring(0, 2) != \"v:\") output = \"v:\" + output;\r\n\targs.push(output);\r\n\treturn this;\r\n}\r\n\r\nWOQLQuery.prototype.idgen = function(prefix, vari, type, mode){\r\n\tthis.cursor['idgen'] = [prefix];\r\n\tif(vari.json){\r\n\t\tthis.cursor['idgen'].push(vari.json());\r\n\t}\r\n\telse if(vari.list){\r\n\t\tthis.cursor['idgen'].push(vari);\r\n\t}\r\n\telse {\r\n\t\tthis.cursor['idgen'].push({\"list\": vari})\r\n\t}\r\n\tif(mode){\r\n\t\tthis.cursor['idgen'].push(mode);\r\n\t}\r\n\tthis.cursor['idgen'].push(type);\r\n\treturn this;\r\n}\r\n\r\n\r\nWOQLQuery.prototype.unique = function(prefix, vari, type){\r\n\tthis.cursor['unique'] = [prefix];\r\n\tif(vari.json){\r\n\t\tthis.cursor['unique'].push(vari.json());\r\n\t}\r\n\telse if(vari.list){\r\n\t\tthis.cursor['unique'].push(vari);\r\n\t}\r\n\telse {\r\n\t\tthis.cursor['unique'].push({\"list\": vari})\r\n\t}\r\n\tthis.cursor['unique'].push(type);\r\n\treturn this;\r\n}\r\n\r\n\r\nWOQLQuery.prototype.concat = function(list, v){\r\n\tif(typeof list == \"string\"){\r\n\t\tvar nlist = list.split(/(v:[\\w_]+)\\b/);\r\n\t\tvar nxlist = [];\r\n\t\tfor(var i = 1; i<nlist.length; i++){\r\n\t\t\tif(nlist[i-1].substring(nlist[i-1].length-1) == \"v\" && nlist[i].substring(0, 1) == \":\"){\r\n\t\t\t\tnlist[i-1] = nlist[i-1].substring(0, nlist[i-1].length-1);\r\n\t\t\t\tnlist[i] = nlist[i].substring(1);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\telse if(list.list){\r\n\t\tvar nlist = list.list;\r\n\t}\r\n\telse if(typeof list == \"object\"){\r\n\t\tvar nlist = list;\r\n\t}\r\n\tvar args = [];\r\n\tfor(var i = 0; i<nlist.length; i++){\r\n\t\tif(!nlist[i]) continue;\r\n\t\tif(typeof nlist[i] == \"string\"){\r\n\t\t\tif(nlist[i].substring(0, 2) == \"v:\"){\r\n\t\t\t\targs.push(nlist[i]);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tvar nvalue = {\"@value\": nlist[i], \"@type\": \"xsd:string\"};\r\n\t\t\t\targs.push(nvalue);\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if(nlist[i]){\r\n\t\t\targs.push(nlist[i]);\r\n\t\t}\r\n\t}\r\n\tif(v.indexOf(\":\") == -1) v = \"v:\" + v;\r\n\tthis.cursor['concat'] = [{\"list\": args}, v];\r\n\treturn this;\r\n};\r\n\r\nWOQLQuery.prototype.lower = function(u, l){\r\n\tthis.cursor['lower'] = [u, l];\r\n\treturn this;\r\n};\r\n\r\nWOQLQuery.prototype.pad = function(input, pad, len, output){\r\n\tthis.cursor['pad'] = [input, pad, len, output];\r\n\treturn this;\r\n}\r\n\r\nWOQLQuery.prototype.join = function(...list){\r\n\tthis.cursor['join'] = list;\r\n\treturn this;\r\n}\r\n\r\n\r\nWOQLQuery.prototype.list  = function(...vars){\r\n\tthis.cursor['list'] = vars;\r\n\treturn this;\r\n}\r\n\r\n\r\n/*\r\n * json version of query for passing to api\r\n */\r\nWOQLQuery.prototype.json = function(json){\r\n\tif(json){\r\n\t\tthis.query = json;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.query;\r\n}\r\n\r\n/*\r\n * Functions which take a query as an argument advance the cursor to make the chaining of queries fall\r\n * into the corrent place in the encompassing json\r\n */\r\nWOQLQuery.prototype.when = function(Query, Update){\r\n\tif(typeof Query == 'boolean'){\r\n\t\tif(Query){\r\n\t\t\tthis.cursor[\"when\"] = [{\"true\": []}, {}];\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.cursor[\"when\"] = [{\"false\": []}, {}];\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tvar q = (Query.json ? Query.json() : Query);\r\n\t\tthis.cursor['when'] = [q, {}];\r\n\t}\r\n\tif(Update){\r\n\t\tvar upd = (Update.json ? Update.json() : Update);\r\n\t\tthis.cursor[\"when\"][1] = upd;\r\n\t}\r\n\tthis.cursor = this.cursor[\"when\"][1];\r\n\treturn this;\r\n}\r\n\r\nWOQLQuery.prototype.opt = function(query){\r\n\tif(query){\r\n\t\tvar q = ((typeof query.json == \"function\") ? query.json() : query);\r\n\t\tthis.cursor[\"opt\"] = [q];\r\n\t}\r\n\telse {\r\n\t\tthis.cursor['opt'] = [{}];\r\n\t\tthis.cursor = this.cursor[\"opt\"][0];\r\n\t}\r\n\treturn this;\r\n};\r\n\r\nWOQLQuery.prototype.from = function(dburl, query){\r\n\tthis.advanceCursor(\"from\", dburl);\r\n\tif(query){\r\n\t\tthis.cursor = query.json();\r\n\t}\r\n\treturn this;\r\n}\r\n\r\nWOQLQuery.prototype.into = function(dburl, query){\r\n\tthis.advanceCursor(\"into\", dburl);\r\n\tif(query){\r\n\t\tthis.cursor = query.json();\r\n\t}\r\n\treturn this;\r\n};\r\n\r\n\r\nWOQLQuery.prototype.limit = function(limit, query){\r\n\tthis.advanceCursor(\"limit\", limit);\r\n\tif(query){\r\n\t\tthis.cursor = query.json();\r\n\t}\r\n\treturn this;\r\n}\r\n\r\nWOQLQuery.prototype.start = function(start, query){\r\n\tthis.advanceCursor(\"start\", start);\r\n\tif(query){\r\n\t\tthis.cursor = query.json();\r\n\t}\r\n\treturn this;\r\n};\r\n\r\nWOQLQuery.prototype.select = function (...list) {\r\n\tthis.cursor.select = list;\r\n\tconst index = list.length;\r\n\tif (typeof this.cursor.select[index - 1] === 'object') {\r\n\t\tthis.cursor.select[index - 1] = this.cursor.select[index - 1].json();\r\n\t} else {\r\n\t\tthis.cursor.select[index] = {};\r\n\t\tthis.cursor = this.cursor.select[index];\r\n\t}\r\n\treturn this;\r\n};\r\n\r\nWOQLQuery.prototype.and = function (...queries) {\r\n\tthis.cursor.and = [];\r\n\tfor (let i = 0; i < queries.length; i++) {\r\n\t\tif (queries[i].contains_update) this.contains_update = true;\r\n\t\tthis.cursor.and.push(queries[i].json());\r\n\t}\r\n\treturn this;\r\n};\r\n\r\nWOQLQuery.prototype.or = function (...queries) {\r\n\tthis.cursor.or = [];\r\n\tfor (let i = 0; i < queries.length; i++) {\r\n\t\tif (queries[i].contains_update) this.contains_update = true;\r\n\t\tthis.cursor.or.push(queries[i].json());\r\n\t}\r\n\treturn this;\r\n};\r\n\r\nWOQLQuery.prototype.not = function (query) {\r\n\tif (query) {\r\n\t\tif (query.contains_update) this.contains_update = true;\r\n\t\tthis.cursor.not = [query.json()];\r\n\t} else {\r\n\t\tthis.cursor.not = [{}];\r\n\t\tthis.cursor = this.cursor.not[0];\r\n\t}\r\n\treturn this;\r\n};\r\n\r\nWOQLQuery.prototype.triple = function(a, b, c){\r\n\tthis.cursor[\"triple\"] = [this.cleanSubject(a),this.cleanPredicate(b),this.cleanObject(c)];\r\n\treturn this.last(\"triple\", this.cleanSubject(a));\r\n}\r\n\r\nWOQLQuery.prototype.quad = function(a, b, c, g){\r\n\tthis.cursor[\"quad\"] = [this.cleanSubject(a),this.cleanPredicate(b),this.cleanObject(c),this.cleanGraph(g)];\r\n\treturn this.last(\"quad\", this.cleanSubject(a));\r\n}\r\n\r\nWOQLQuery.prototype.eq = function(a, b){\r\n\tthis.cursor[\"eq\"] = [this.cleanObject(a),this.cleanObject(b)];\r\n\treturn this.last();\r\n};\r\n\r\nWOQLQuery.prototype.sub = function(a, b){\r\n\tif(!b && this.tripleBuilder){\r\n\t\tthis.tripleBuilder.sub(this.cleanClass(a));\r\n\t\treturn this;\r\n\t}\r\n\tthis.cursor[\"sub\"] = [this.cleanClass(a),this.cleanClass(b)];\r\n\treturn this.last(\"sub\", a);\r\n}\r\n\r\nWOQLQuery.prototype.comment = function(val){\r\n\tif(val){\r\n\t\tval = (val.json ? val.json() : val)\r\n\t\tthis.cursor['comment'] = val;\r\n\t}\r\n\telse {\r\n\t\tthis.cursor['comment'] = null;\r\n\t\tthis.cursor = this.cursor['comment'];\r\n\t}\r\n\treturn this;\r\n}\r\n\r\n\r\nWOQLQuery.prototype.abstract = function(varname){\r\n\tif(varname){\r\n\t\treturn this.quad(varname, \"tcs:tag\", \"tcs:abstract\", \"db:schema\");\r\n\t}\r\n\telse if(this.tripleBuilder){\r\n\t\tthis.tripleBuilder.abstract();\r\n\t}\r\n\treturn this;\r\n}\r\n\r\nWOQLQuery.prototype.isa = function(a, b){\r\n\tif(!b && this.tripleBuilder){\r\n\t\tthis.tripleBuilder.isa(this.cleanClass(a));\r\n\t\treturn this;\r\n\t}\r\n\tif(b){\r\n\t\tthis.cursor[\"isa\"] = [this.cleanClass(a),this.cleanClass(b)];\r\n\t\treturn this.last(\"isa\", a);\r\n\t}\r\n}\r\n\r\nWOQLQuery.prototype.trim = function(a, b){\r\n\tthis.cursor['trim'] = [a, b];\r\n\treturn this.last('trim', b);\r\n}\r\n\r\nWOQLQuery.prototype.eval = function(arith, v){\r\n\tarith = arith.json ? arith.json() : arith;\r\n\tthis.cursor['eval'] = [arith, v];\r\n\treturn this.last('eval', v);\r\n}\r\n\r\nWOQLQuery.prototype.plus = function (...args) {\r\n\tthis.cursor.plus = []; \r\n\tfor(var i = 0; i < args.length; i++){\r\n\t\tthis.cursor.plus.push(args[i].json ? args[i].json() : args[i]);\r\n\t}\r\n\treturn this.last();\r\n};\r\n\r\nWOQLQuery.prototype.minus = function (...args) {\r\n\tthis.cursor.minus = [];\r\n\tfor(var i = 0; i < args.length; i++){\r\n\t\tthis.cursor.minus.push(args[i].json ? args[i].json() : args[i]);\r\n\t}\r\n\treturn this.last();\r\n};\r\n\r\nWOQLQuery.prototype.times = function (...args) {\r\n\tthis.cursor.times = [];\r\n\tfor(var i = 0; i < args.length; i++){\r\n\t\tthis.cursor.times.push(args[i].json ? args[i].json() : args[i]);\r\n\t}\r\n\treturn this.last();\r\n};\r\n\r\nWOQLQuery.prototype.divide = function (...args) {\r\n\tthis.cursor.divide = [];\r\n\tfor(var i = 0; i < args.length; i++){\r\n\t\tthis.cursor.divide.push(args[i].json ? args[i].json() : args[i]);\r\n\t}\r\n\treturn this.last();\r\n};\r\n\r\nWOQLQuery.prototype.div = function (...args) {\r\n\tthis.cursor.div = [];\r\n\tfor(var i = 0; i < args.length; i++){\r\n\t\tthis.cursor.div.push(args[i].json ? args[i].json() : args[i]);\r\n\t}\r\n\treturn this.last();\r\n};\r\n\r\nWOQLQuery.prototype.exp = function (a, b) {\r\n\ta = (a.json ? a.json() : a);\r\n\tb = (b.json ? b.json() : b);\r\n\tthis.cursor.exp = [a, b];\r\n\treturn this.last();\r\n};\r\n\r\nWOQLQuery.prototype.delete = function (JSON_or_IRI) {\r\n\tthis.cursor.delete = [JSON_or_IRI];\r\n\treturn this.lastUpdate();\r\n};\r\n\r\nWOQLQuery.prototype.delete_triple = function( Subject, Predicate, Object_or_Literal ){\r\n\tthis.cursor['delete_triple'] = [this.cleanSubject(Subject),this.cleanPredicate(Predicate),this.cleanObject(Object_or_Literal)];\r\n\treturn this.lastUpdate('delete_triple', this.cleanSubject(Subject));\r\n}\r\n\r\nWOQLQuery.prototype.add_triple = function( Subject, Predicate, Object_or_Literal ){\r\n\tthis.cursor['add_triple'] =[this.cleanSubject(Subject),this.cleanPredicate(Predicate),this.cleanObject(Object_or_Literal)];\r\n\treturn this.lastUpdate('add_triple', this.cleanSubject(Subject));\r\n}\r\n\r\nWOQLQuery.prototype.delete_quad = function( Subject, Predicate, Object_or_Literal, Graph ){\r\n\tthis.cursor['delete_quad'] =[this.cleanSubject(Subject),this.cleanPredicate(Predicate),this.cleanObject(Object_or_Literal),this.cleanGraph(Graph)];\r\n\treturn this.lastUpdate('delete_quad', this.cleanSubject(Subject));\r\n}\r\n\r\nWOQLQuery.prototype.add_quad = function( Subject, Predicate, Object_or_Literal, Graph){\r\n\tthis.cursor['add_quad'] = [this.cleanSubject(Subject),this.cleanPredicate(Predicate),this.cleanObject(Object_or_Literal),this.cleanGraph(Graph)];\r\n\treturn this.lastUpdate(\"add_quad\", this.cleanSubject(Subject));\r\n}\r\n\r\nWOQLQuery.prototype.update = function(woql){\r\n\tthis.cursor['update'] = [ woql.json() ];\r\n\treturn this.lastUpdate();\r\n}\r\n\r\n/**\r\n * Schema manipulation shorthand\r\n */\r\nWOQLQuery.prototype.addClass = function(c, graph){\r\n\tif(c){\r\n\t\tgraph = (graph ? this.cleanGraph(graph) : \"db:schema\");\r\n\t\tc = (c.indexOf(\":\") == -1) ? \"scm:\" + c : c;\r\n\t\tthis.add_quad(c, \"rdf:type\", \"owl:Class\", graph);\r\n\t}\r\n\treturn this;\r\n}\r\n\r\nWOQLQuery.prototype.addProperty = function(p, t, g){\r\n\tt = (t ? t : \"xsd:string\");\r\n\tif(p){\r\n\t\tvar graph = (g ? this.cleanGraph(g) : \"db:schema\");\r\n\t\tp = (p.indexOf(\":\") == -1) ?  \"scm:\" + p : p;\r\n\t\tt = (t.indexOf(\":\") == -1) ? this.cleanType(t) : t ;\r\n\t\tvar tc = this.cursor;\r\n\t\tif(WOQL.isLiteralType(t)){\r\n\t\t\tthis.and(\r\n\t\t\t\tWOQL.add_quad(p, \"rdf:type\", \"owl:DatatypeProperty\", graph),\r\n\t\t\t\tWOQL.add_quad(p, \"rdfs:range\", t, graph)\r\n\t\t\t);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.and(\r\n\t\t\t\tWOQL.add_quad(p, \"rdf:type\", \"owl:ObjectProperty\", graph),\r\n\t\t\t\tWOQL.add_quad(p, \"rdfs:range\", t, graph)\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n\treturn this.lastUpdate(\"add_quad\", this.cleanClass(p));\r\n}\r\n\r\nWOQLQuery.prototype.deleteClass = function(c, graph){\r\n\tif(c){\r\n\t\tgraph = (graph ? this.cleanGraph(graph) : \"db:schema\");\r\n\t\tc = (c.indexOf(\":\") == -1) ?  \"scm:\" + c : c;\r\n\t\treturn this.and(\r\n\t\t\tWOQL.delete_quad(c, \"v:All\", \"v:Al2\", graph),\r\n\t\t\tWOQL.opt().delete_quad(\"v:Al3\", \"v:Al4\", c, graph)\r\n\t\t);\r\n\t}\r\n\treturn this;\r\n}\r\n\r\nWOQLQuery.prototype.deleteProperty = function(p, graph){\r\n\tif(p){\r\n\t\tgraph = (graph ? this.cleanGraph(graph) : \"db:schema\");\r\n\t\tp = (p.indexOf(\":\") == -1) ? \"scm:\" + p : p;\r\n\t\treturn this.and(\r\n\t\t\tWOQL.delete_quad(p, \"v:All\", \"v:Al2\", graph),\r\n\t\t\tWOQL.delete_quad(\"v:Al3\", \"v:Al4\", p, graph)\r\n\t\t);\r\n\t}\r\n\treturn this;\r\n}\r\n\r\n/**\r\n * Language elements that cannot be invoked from the top level and therefore are not exposed in the WOQL api\r\n */\r\nWOQLQuery.prototype.as = function(a, b){\r\n\tif(!a || !b) return;\r\n\tif(!this.asArray){\r\n\t\tthis.asArray = true;\r\n\t\tthis.query = [];\r\n\t}\r\n\tb = (b.indexOf(\":\") == -1 ? \"v:\" + b : b);\r\n\tvar val = (typeof a == \"object\" ? a : { \"@value\" : a});\r\n\tthis.query.push({as: [val, b]});\r\n\treturn this;\t\t\r\n}\r\n\r\n/**\r\n * WOQL API\r\n */\r\n\r\nWOQLQuery.prototype.node = function(node, type){\r\n\ttype = (type ? type : \"triple\");\r\n\tthis.tripleBuilder = new TripleBuilder(type, this.cursor, node);\r\n\treturn this;\r\n}\r\n\r\nWOQLQuery.prototype.max = function(m){\r\n\tif(this.tripleBuilder) this.tripleBuilder.card(m, \"max\");\r\n\treturn this;\r\n}\r\n\r\nWOQLQuery.prototype.cardinality = function(m){\r\n\tif(this.tripleBuilder) this.tripleBuilder.card(m, \"cardinality\");\r\n\treturn this;\r\n}\r\n\r\nWOQLQuery.prototype.min = function(m){\r\n\tif(this.tripleBuilder) this.tripleBuilder.card(m, \"min\");\r\n\treturn this;\r\n}\r\n\r\nWOQLQuery.prototype.graph = function(g){\r\n\tg = this.cleanGraph(g);\r\n\tvar t = (this.type == \"triple\") ? \"quad\" : false;\r\n\tif(this.type == \"add_triple\") t = \"add_quad\";\r\n\tif(this.type == \"delete_triple\") t = \"delete_quad\";\r\n\tif(!this.tripleBuilder){\r\n\t\tthis.tripleBuilder = new TripleBuilder(t, this.cursor);\r\n\t}\r\n\tthis.tripleBuilder.graph(g);\r\n\treturn this;\r\n}\r\n\r\nWOQLQuery.prototype.domain = function(d){\r\n\td = this.cleanClass(d);\r\n\tif(this.tripleBuilder) this.tripleBuilder.addPO('rdfs:domain',d);\r\n\treturn this;\r\n}\r\n\r\nWOQLQuery.prototype.label = function(l, lang){\r\n\tif(this.tripleBuilder) this.tripleBuilder.label(l, lang);\r\n\treturn this;\r\n}\r\n\r\nWOQLQuery.prototype.description = function(c, lang){\r\n\tif(this.tripleBuilder) this.tripleBuilder.comment(c, lang);\r\n\treturn this;\r\n}\r\n\r\nWOQLQuery.prototype.parent = function(...p){\r\n\tif(this.tripleBuilder){\r\n\t\tfor(var i = 0 ; i<p.length; i++){\r\n\t\t\tvar pn = this.cleanClass(p[i]);\r\n\t\t\tthis.tripleBuilder.addPO('rdfs:subClassOf', pn);\r\n\t\t}\r\n\t}\r\n\treturn this;\r\n}\r\n\r\nWOQLQuery.prototype.entity = function(...p){\r\n\treturn this.parent(\"tcs:Entity\");\r\n}\r\n\r\nWOQLQuery.prototype.relationship = function(...p){\r\n\treturn this.parent(\"tcs:Entity\");\r\n}\r\n\r\nWOQLQuery.prototype.property = function(p,val){\r\n\tif(this.tripleBuilder) {\r\n\t\tp = this.cleanPredicate(p);\r\n\t\tthis.tripleBuilder.addPO(p, val);\r\n\t}\r\n\treturn this;\r\n}\r\n\r\nWOQLQuery.prototype.star = function(GraphIRI, Subj, Pred, Obj){\r\n\tSubj = (Subj ? this.cleanSubject(Subj) : \"v:Subject\");\r\n\tPred = (Pred ? this.cleanPredicate(Pred) : \"v:Predicate\");\r\n\tObj = (Obj  ? this.cleanObject(Obj) : \"v:Object\");\r\n\tGraphIRI = (GraphIRI ? this.cleanGraph(GraphIRI) : false);\r\n\tif(GraphIRI){\r\n\t\treturn this.quad(Subj, Pred, Obj, GraphIRI);\r\n\t}\r\n\telse {\r\n\t\treturn this.triple(Subj, Pred, Obj);\r\n\t}\r\n}\r\n\r\n\r\nWOQLQuery.prototype.getEverything = function(GraphIRI){\r\n\tif(GraphIRI){\r\n\t\tGraphIRI = this.cleanGraph(GraphIRI);\r\n\t\treturn this.quad(\"v:Subject\", \"v:Predicate\", \"v:Object\", GraphIRI);\r\n\t}\r\n\telse {\r\n\t\treturn this.triple(\"v:Subject\", \"v:Predicate\", \"v:Object\");\r\n\t}\r\n}\r\n\r\nWOQLQuery.prototype.getAllDocuments = function(){\r\n\treturn this.and(\r\n\t\tWOQL.triple(\"v:Subject\", \"rdf:type\", \"v:Type\"),\r\n\t\tWOQL.sub(\"v:Type\", \"tcs:Document\")\r\n\t);\r\n}\r\n\r\nWOQLQuery.prototype.documentMetadata = function(){\r\n\treturn this.and(\r\n\t\tWOQL.triple(\"v:ID\", \"rdf:type\", \"v:Class\"),\r\n\t\tWOQL.sub(\"v:Class\", \"tcs:Document\"),\r\n\t\tWOQL.opt().triple(\"v:ID\", \"rdfs:label\", \"v:Label\"),\r\n\t\tWOQL.opt().triple(\"v:ID\", \"rdfs:comment\", \"v:Comment\"),\r\n\t\tWOQL.opt().quad(\"v:Class\", \"rdfs:label\", \"v:Type\", \"db:schema\"),\r\n\t\tWOQL.opt().quad(\"v:Class\", \"rdfs:comment\", \"v:Type_Comment\", \"db:schema\")\r\n\t);\r\n}\r\n\r\nWOQLQuery.prototype.concreteDocumentClasses = function(){\r\n\treturn this.and(\r\n\t\tWOQL.sub(\"v:Class\", \"tcs:Document\"),\r\n\t\tWOQL.not().abstract(\"v:Class\"),\r\n\t\tWOQL.opt().quad(\"v:Class\", \"rdfs:label\", \"v:Label\", \"db:schema\"),\r\n\t\tWOQL.opt().quad(\"v:Class\", \"rdfs:comment\", \"v:Comment\", \"db:schema\")\r\n\t);\r\n}\r\n\r\nWOQLQuery.prototype.propertyMetadata = function(){\r\n\treturn this.and(\r\n\t\tWOQL.or(\r\n\t\t\tWOQL.quad(\"v:Property\", \"rdf:type\", \"owl:DatatypeProperty\", \"db:schema\"),\r\n\t\t\tWOQL.quad(\"v:Property\", \"rdf:type\", \"owl:ObjectProperty\", \"db:schema\")\r\n\t\t),\r\n\t\tWOQL.opt().quad(\"v:Property\", \"rdfs:range\", \"v:Range\", \"db:schema\"),\r\n\t\tWOQL.opt().quad(\"v:Property\", \"rdf:type\", \"v:Type\", \"db:schema\"),\r\n\t\tWOQL.opt().quad(\"v:Property\", \"rdfs:label\", \"v:Label\", \"db:schema\"),\r\n\t\tWOQL.opt().quad(\"v:Property\", \"rdfs:comment\", \"v:Comment\", \"db:schema\"),\r\n\t\tWOQL.opt().quad(\"v:Property\", \"rdfs:domain\", \"v:Domain\", \"db:schema\")\r\n\t);\r\n}\r\n\r\nWOQLQuery.prototype.elementMetadata = function(){\r\n\treturn this.and(\r\n\t\tWOQL.quad(\"v:Element\", \"rdf:type\", \"v:Type\", \"db:schema\"),\r\n\t\tWOQL.opt().quad(\"v:Element\", \"tcs:tag\", \"v:Abstract\", \"db:schema\"),\r\n\t\tWOQL.opt().quad(\"v:Element\", \"rdfs:label\", \"v:Label\", \"db:schema\"),\r\n\t\tWOQL.opt().quad(\"v:Element\", \"rdfs:comment\", \"v:Comment\", \"db:schema\"),\r\n\t\tWOQL.opt().quad(\"v:Element\", \"rdfs:subClassOf\", \"v:Parent\", \"db:schema\"),\r\n\t\tWOQL.opt().quad(\"v:Element\", \"rdfs:domain\", \"v:Domain\", \"db:schema\"),\r\n\t\tWOQL.opt().quad(\"v:Element\", \"rdfs:range\", \"v:Range\", \"db:schema\")\r\n\t);\r\n}\r\n\r\nWOQLQuery.prototype.classMetadata = function(){\r\n\treturn this.and(\r\n\t\tWOQL.quad(\"v:Element\", \"rdf:type\", \"owl:Class\", \"db:schema\"),\r\n\t\tWOQL.opt().quad(\"v:Element\", \"rdfs:label\", \"v:Label\", \"db:schema\"),\r\n\t\tWOQL.opt().quad(\"v:Element\", \"rdfs:comment\", \"v:Comment\", \"db:schema\"),\r\n\t\tWOQL.opt().quad(\"v:Element\", \"tcs:tag\", \"v:Abstract\", \"db:schema\")\r\n\t);\r\n}\r\n\r\nWOQLQuery.prototype.getDataOfClass = function(chosen){\r\n\treturn this.and(\r\n\t\tWOQL.triple(\"v:Subject\", \"rdf:type\", chosen),\r\n\t\tWOQL.opt().triple(\"v:Subject\", \"v:Property\", \"v:Value\")\r\n\t);\r\n}\r\n\r\nWOQLQuery.prototype.getDataOfProperty = function(chosen){\r\n\treturn this.and(\r\n\t\tWOQL.triple(\"v:Subject\", chosen, \"v:Value\"),\r\n\t\tWOQL.opt().triple(\"v:Subject\", \"rdfs:label\", \"v:Label\")\r\n\t);\r\n}\r\n\r\nWOQLQuery.prototype.documentProperties = function(id){\r\n\treturn this.and(\r\n\t\tWOQL.triple(id, \"v:Property\", \"v:Property_Value\"),\r\n\t\tWOQL.opt().quad(\"v:Property\", \"rdfs:label\", \"v:Property_Label\", \"db:schema\"),\r\n\t\tWOQL.opt().quad(\"v:Property\", \"rdf:type\", \"v:Property_Type\", \"db:schema\")\r\n\t);\r\n}\r\n\r\nWOQLQuery.prototype.getDocumentConnections = function(id){\r\n\treturn this.and(\r\n\t\tWOQL.or(\r\n\t\t\tWOQL.triple(id, \"v:Outgoing\", \"v:Entid\"),\r\n\t\t\tWOQL.triple(\"v:Entid\", \"v:Incoming\", id)\r\n\t\t),\r\n\t\tWOQL.isa(\"v:Entid\", \"v:Enttype\"),\r\n\t\tWOQL.sub(\"v:Enttype\", \"tcs:Document\"),\r\n\t\tWOQL.opt().triple(\"v:Entid\", \"rdfs:label\", \"v:Label\"),\r\n\t\tWOQL.opt().quad(\"v:Enttype\", \"rdfs:label\", \"v:Class_Label\", \"db:schema\")\r\n\t);\r\n}\r\n\r\nWOQLQuery.prototype.getInstanceMeta = function(url){\r\n\treturn this.and(\r\n\t\tWOQL.triple(url, \"rdf:type\", \"v:InstanceType\"),\r\n\t\tWOQL.opt().triple(url, \"rdfs:label\", \"v:InstanceLabel\"),\r\n\t\tWOQL.opt().triple(url, \"rdfs:comment\", \"v:InstanceComment\"),\r\n\t\tWOQL.opt().quad(\"v:InstanceType\", \"rdfs:label\", \"v:ClassLabel\", \"db:schema\")\r\n\t);\r\n}\r\n\r\nWOQLQuery.prototype.simpleGraphQuery = function(){\r\n\treturn this.and(\r\n\t    WOQL.triple(\"v:Source\", \"v:Edge\", \"v:Target\"),\r\n\t    WOQL.isa(\"v:Source\", \"v:Source_Class\"),\r\n\t    WOQL.sub(\"v:Source_Class\", \"tcs:Document\"),\r\n\t    WOQL.isa(\"v:Target\", \"v:Target_Class\"),\r\n\t    WOQL.sub(\"v:Target_Class\", \"tcs:Document\"),\r\n\t    WOQL.opt().triple(\"v:Source\", \"rdfs:label\", \"v:Source_Label\"),\r\n\t    WOQL.opt().triple(\"v:Source\", \"rdfs:comment\", \"v:Source_Comment\"),\r\n\t    WOQL.opt().quad(\"v:Source_Class\", \"rdfs:label\", \"v:Source_Type\", \"db:schema\"),\r\n\t    WOQL.opt().quad(\"v:Source_Class\", \"rdfs:comment\", \"v:Source_Type_Comment\", \"db:schema\"),\r\n\t    WOQL.opt().triple(\"v:Target\", \"rdfs:label\", \"v:Target_Label\"),\r\n\t    WOQL.opt().triple(\"v:Target\", \"rdfs:comment\", \"v:Target_Comment\"),\r\n\t    WOQL.opt().quad(\"v:Target_Class\", \"rdfs:label\", \"v:Target_Type\", \"db:schema\"),\r\n\t    WOQL.opt().quad(\"v:Target_Class\", \"rdfs:comment\", \"v:Target_Type_Comment\", \"db:schema\"),\r\n\t    WOQL.opt().quad(\"v:Edge\", \"rdfs:label\", \"v:Edge_Type\", \"db:schema\"),\r\n\t    WOQL.opt().quad(\"v:Edge\", \"rdfs:comment\", \"v:Edge_Type_Comment\", \"db:schema\")\r\n\t);\r\n}\r\n\r\n\r\n/**\r\n * Queries the schema graph and loads all the ids found there as vocabulary that can be used without prefixes\r\n * ignoring blank node ids\r\n */\r\nWOQLQuery.prototype.loadVocabulary = function(client){\r\n\tvar nw = new WOQLQuery().quad(\"v:S\", \"v:P\", \"v:O\", \"db:schema\");\r\n\tnw.execute(client).then( (result) => {\r\n\t\tif(result.bindings && result.bindings.length > 0){\r\n\t\t\tfor(var i = 0; i<result.bindings.length; i++){\r\n\t\t\t\tfor(var k in result.bindings[i]){\r\n\t\t\t\t\tvar v = result.bindings[i][k]\r\n\t\t\t\t\tif(typeof v == \"string\"){\r\n\t\t\t\t\t\tvar spl = v.split(\":\");\r\n\t\t\t\t\t\tif(spl.length == 2 && spl[1] && spl[0] != \"_\"){\r\n\t\t\t\t\t\t\tthis.vocab[spl[1]] = v;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n}\r\n\r\n\r\n/**\r\n * Provides the query with a 'vocabulary' a list of well known predicates that can be used without prefixes mapping: id: prefix:id ...\r\n */\r\nWOQLQuery.prototype.setVocabulary = function(vocab){\r\n\tthis.vocab = vocab;\r\n}\r\n\r\nWOQLQuery.prototype.getVocabulary = function(vocab){\r\n\treturn this.vocab;\r\n}\r\n\r\nWOQLQuery.prototype.getLimit = function(){\r\n\treturn this.getPagingProperty(\"limit\");\r\n}\r\n\r\nWOQLQuery.prototype.setLimit = function(l){\r\n\treturn this.setPagingProperty(\"limit\", l);\r\n}\r\n\r\nWOQLQuery.prototype.isPaged = function(q){\r\n\tq = (q ? q : this.query);\r\n\tfor (const prop of Object.keys(q)) {\r\n\t\tif(prop == \"limit\") return true;\r\n\t\telse if(this.paging_transitive_properties.indexOf(prop) !== -1){\r\n\t\t\treturn this.isPaged(q[prop][q[prop].length-1]);\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nWOQLQuery.prototype.getPage = function(){\r\n\tif(this.isPaged()){\r\n\t\tvar psize = this.getLimit();\r\n\t\tif(this.hasStart()){\r\n\t\t\tvar s = this.getStart();\r\n\t\t\treturn (parseInt(s / psize) + 1);\r\n\t\t}\r\n\t\telse return 1;\r\n\t}\r\n\telse return false;\r\n}\r\n\r\nWOQLQuery.prototype.setPage = function(pagenum){\r\n\tvar pstart = (this.getLimit() * (pagenum - 1));\r\n\tif(this.hasStart()){\r\n\t\tthis.setStart(pstart);\r\n\t}\r\n\telse {\r\n\t\tthis.addStart(pstart);\r\n\t}\r\n\treturn this;\r\n}\r\n\r\nWOQLQuery.prototype.nextPage = function(){\r\n\treturn this.setPage(this.getPage() + 1);\r\n}\r\n\r\nWOQLQuery.prototype.firstPage = function(){\r\n\treturn this.setPage(1);\r\n}\r\n\r\nWOQLQuery.prototype.previousPage = function(){\r\n\tconst npage = this.getPage() - 1;\r\n\tif(npage > 0) this.setPage(npage);\r\n\treturn this;\r\n}\r\n\r\nWOQLQuery.prototype.setPageSize = function(size){\r\n\tthis.setPagingProperty(\"limit\", size);\r\n\tif(this.hasStart()){\r\n\t\tthis.setStart(0);\r\n\t}\r\n\telse {\r\n\t\tthis.addStart(0);\r\n\t}\r\n\treturn this;\r\n}\r\n\r\nWOQLQuery.prototype.hasSelect = function(){\r\n\treturn (this.getPagingProperty(\"select\") ? true : false);\r\n}\r\n\r\nWOQLQuery.prototype.getSelectVariables = function(q){\r\n\tq = (q ? q : this.query);\r\n\tfor (const prop of Object.keys(q)) {\r\n\t\tif(prop == \"select\") {\r\n\t\t\tvar vars = q[prop].slice(0, q[prop].length - 1);\r\n\t\t\treturn vars;\r\n\t\t}\r\n\t\telse if(this.paging_transitive_properties.indexOf(prop) !== -1){\r\n\t\t\tvar val = this.getSelectVariables(q[prop][q[prop].length-1]);\r\n\t\t\tif(typeof val != \"undefined\"){\r\n\t\t\t\treturn val;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\nWOQLQuery.prototype.hasStart = function(){\r\n\treturn (typeof this.getPagingProperty(\"start\") != \"undefined\");\r\n}\r\n\r\nWOQLQuery.prototype.getStart = function(){\r\n\treturn this.getPagingProperty(\"start\");\r\n}\r\n\r\nWOQLQuery.prototype.setStart = function(start){\r\n\treturn this.setPagingProperty(\"start\", start);\r\n}\r\n\r\nWOQLQuery.prototype.addStart = function(s){\r\n\tif(this.hasStart()) this.setStart(s);\r\n\telse {\r\n\t\tvar nq = {'start': [s, this.query]};\r\n\t\tthis.query = nq;\r\n\t}\r\n\treturn this;\r\n}\r\n\r\n\r\n/**\r\n * Executes the query using the passed client to connect to a server\r\n */\r\nWOQLQuery.prototype.execute = function(client){\r\n\tif(!this.query[\"@context\"]){\r\n\t\tthis.query['@context'] = this.defaultContext(client.connectionConfig.dbURL());\r\n\t\tvar json = this.json();\r\n\t}\r\n\telse {\r\n\t\tvar json = this.json();\r\n\t}\r\n\tif(this.contains_update){\r\n\t\treturn client.select(false, json);\r\n\t\t//return client.update(false, json);\r\n\t}\r\n\telse {\r\n\t\treturn client.select(false, json);\r\n\t}\r\n}\r\n\r\n/*\r\n * Internal State Control Functions\r\n * Not part of public API -\r\n */\r\n\r\n /**\r\n * Advances internal cursor to support chaining of calls: limit(50).start(50). rather than (limit, [50, (start, [50, (lisp-style (encapsulation)))))\r\n */\r\nWOQLQuery.prototype.advanceCursor = function(action, value){\r\n\tthis.cursor[action] = [value];\r\n\tthis.cursor[action][1] = {};\r\n\tthis.cursor = this.cursor[action][1];\r\n}\r\n\r\nWOQLQuery.prototype.loadDefaultVocabulary = function(){\r\n\tvar vocab = {};\r\n\tvocab.type = \"rdf:type\";\r\n\tvocab.label = \"rdfs:label\";\r\n\tvocab.Class = \"owl:Class\";\r\n\tvocab.DatatypeProperty = \"owl:DatatypeProperty\";\r\n\tvocab.ObjectProperty = \"owl:ObjectProperty\";\r\n\tvocab.Entity = \"tcs:Entity\";\r\n\tvocab.Document = \"tcs:Document\";\r\n\tvocab.Relationship = \"tcs:Relationship\";\r\n\tvocab.temporality = \"tcs:temporality\";\r\n\tvocab.geotemporality = \"tcs:geotemporality\";\r\n\tvocab.geography = \"tcs:geography\";\r\n\tvocab.abstract = \"tcs:abstract\";\r\n\tvocab.comment = \"rdfs:comment\";\r\n\tvocab.range = \"rdfs:range\";\r\n\tvocab.domain = \"rdfs:domain\";\r\n\tvocab.subClassOf = \"rdfs:subClassOf\";\r\n\tvocab.string = \"xsd:string\";\r\n\tvocab.integer = \"xsd:integer\";\r\n\tvocab.decimal = \"xsd:decimal\";\r\n\tvocab.email = \"xdd:email\";\r\n\tvocab.json = \"xdd:json\";\r\n\tvocab.dateTime = \"xsd:dateTime\";\r\n\tvocab.date = \"xsd:date\";\r\n\tvocab.coordinate = \"xdd:coordinate\";\r\n\tvocab.line = \"xdd:coordinatePolyline\";\r\n\tvocab.polygon = \"xdd:coordinatePolygon\";\r\n\treturn vocab;\r\n}\r\n\r\nWOQLQuery.prototype.defaultContext = function(DB_IRI){\r\n\tlet def = {}\r\n\tfor(var pref in FrameHelper.standard_urls){\r\n\t\tdef[pref] = FrameHelper.standard_urls[pref];\r\n\t}\r\n\tdef.scm = DB_IRI + \"/schema#\"\r\n\tdef.doc = DB_IRI + \"/document/\"\r\n\tdef.db = DB_IRI + \"/\";\r\n\treturn def;\r\n}\r\n\r\n\r\n\r\n/**\r\n * Called to indicate that this is the last call that is chainable - for example triple pattern matching..\r\n *\r\n */\r\nWOQLQuery.prototype.last = function(call, subject){\r\n\tthis.chain_ended = true;\r\n\tif(call) this.tripleBuilder = new TripleBuilder(call, this.cursor, this.cleanSubject(subject));\r\n\treturn this;\r\n}\r\n\r\nWOQLQuery.prototype.lastUpdate = function(call, subj){\r\n\tthis.contains_update = true;\r\n\tvar ret = this.last(call, subj);\r\n\treturn ret;\r\n}\r\n\r\n/**\r\n * Returns the value of one of the 'paging' related properties (limit, start,...)\r\n */\r\nWOQLQuery.prototype.getPagingProperty = function(pageprop, q){\r\n\tq = (q ? q : this.query);\r\n\tfor (const prop of Object.keys(q)) {\r\n\t\tif(prop == pageprop) return q[prop][0];\r\n\t\telse if(this.paging_transitive_properties.indexOf(prop) !== -1){\r\n\t\t\tvar val = this.getPagingProperty(pageprop, q[prop][q[prop].length-1]);\r\n\t\t\tif(typeof val != \"undefined\"){\r\n\t\t\t\treturn val;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\n/**\r\n * Sets the value of one of the paging_transitive_properties properties\r\n */\r\nWOQLQuery.prototype.setPagingProperty = function(pageprop, val, q){\r\n\tq = (q ? q : this.query);\r\n\tfor (const prop of Object.keys(q)) {\r\n\t\tif(prop == pageprop) {\r\n\t\t\tq[prop][0] = val;\r\n\t\t}\r\n\t\telse if(this.paging_transitive_properties.indexOf(prop) !== -1){\r\n\t\t\tthis.setPagingProperty(pageprop, val, q[prop][q[prop].length-1]);\r\n\t\t}\r\n\t}\r\n\treturn this;\r\n}\r\n\r\n/**\r\n * Retrieves the value of the current json-ld context\r\n */\r\nWOQLQuery.prototype.getContext = function(q){\r\n\tq = (q ? q : this.query);\r\n\tfor (const prop of Object.keys(q)) {\r\n\t\tif(prop == \"@context\") return q[prop];\r\n\t\tif(this.paging_transitive_properties.indexOf(prop) !== -1){\r\n\t\t\tvar nq = q[prop][1];\r\n\t\t\tvar nc = this.getContext(nq);\r\n\t\t\tif(nc) return nc;\r\n\t\t}\r\n\t}\r\n}\r\n\r\n\r\n/**\r\n * Retrieves the value of the current json-ld context\r\n */\r\nWOQLQuery.prototype.context = function(c){\r\n\tthis.cursor['@context'] = c;\r\n}\r\n\r\n\r\n/*\r\n* Transforms from internal json representation to human writable WOQL.js format\r\n*/\r\nWOQLQuery.prototype.prettyPrint = function(indent, show_context, q, fluent){\r\n\tif(!this.indent) this.indent = indent;\r\n\tq = (q ? q : this.query);\r\n\tvar str = \"\";\r\n\tconst newlining_operators = [\"get\", \"from\", \"into\"];\r\n\tfor(var operator in q){\r\n\t\t//ignore context in pretty print\r\n\t\tif(operator == \"@context\") {\r\n\t\t\tif( show_context){\r\n\t\t\t\tvar c = this.getContext();\r\n\t\t\t\tif(c) str += \"@context: \" + JSON.stringify(c) + \"\\n\";\r\n\t\t\t}\r\n\t\t\tcontinue;\r\n\t\t}\r\n\t\t//statement starts differently depending on indent and whether it is fluent style or regular function style\r\n\t\tstr += this.getWOQLPrelude(operator, fluent, indent - this.indent);\r\n\t\tvar val = q[operator];\r\n\t\tif(this.chainable(operator, val[val.length-1])){\r\n\t\t\t//all arguments up until the last are regular function arguments \r\n\t\t\tstr += this.uncleanArguments(operator,  val.slice(0, val.length-1), indent, show_context);\r\n\t\t\tif(newlining_operators.indexOf(operator) !== -1){\r\n\t\t\t\t//some fluent function calls demand a linebreak..\r\n\t\t\t\tstr += \"\\n\" + nspaces(indent-this.indent);\r\n\t\t\t}\r\n\t\t\t//recursive call to query included in tail\r\n\t\t\tstr += this.prettyPrint(indent, show_context, val[val.length-1], true);\r\n\t\t}\r\n\t\telse {\r\n\t\t\t//non chainable operators all live inside the function call parameters\r\n\t\t\tstr += this.uncleanArguments(operator,  val, indent, show_context);\r\n\t\t}\r\n\t}\r\n\t//remove any trailing dots in the chain (only exist in incompletely specified queries)\r\n\tif(str.substring(str.length-1) == \".\"){\r\n\t\tstr = str.substring(0, str.length-1);\r\n\t}\r\n\treturn str;\r\n}\r\n\r\n/**\r\n * Gets the starting characters for a WOQL query - varies depending on how the query is invoked and how indented it is\r\n */\r\nWOQLQuery.prototype.getWOQLPrelude = function(operator, fluent, inline){\r\n\tif(operator === \"true\" || operator === \"false\"){\r\n\t\treturn operator;\r\n\t}\r\n\tif(fluent){\r\n\t\treturn \".\" + operator;\r\n\t}\r\n\treturn (inline ? \"\\n\" + nspaces(inline) : \"\") + \"WOQL.\" + operator;\t\t\r\n}\r\n\r\n/**\r\n * Determines whether a given operator can have a chained query as its last argument\r\n */\r\nWOQLQuery.prototype.chainable = function(operator, lastArg){\r\n\tconst non_chaining_operators = [\"and\", \"or\"];\r\n\tif(typeof lastArg == \"object\" && typeof lastArg['@value'] == \"undefined\"  && typeof lastArg['@type'] == \"undefined\"  && typeof lastArg['value'] == \"undefined\" && non_chaining_operators.indexOf(operator) == -1){\r\n\t\treturn true;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\n/**\r\n * Transforms arguments to WOQL functions from the internal (clean) version, to the WOQL.js human-friendly version\r\n */\r\nWOQLQuery.prototype.uncleanArguments = function(operator, args, indent, show_context){\r\n\tstr = '(';\r\n\tconst args_take_newlines = [\"and\", \"or\"];\r\n\tif(this.hasShortcut(operator, args)){\r\n\t\treturn this.getShortcut(args, indent);\r\n\t}\r\n\telse {\r\n\t\tfor(var i = 0; i<args.length; i++){\r\n\t\t\tif(this.argIsSubQuery(operator, args[i], i)){\r\n\t\t\t\tstr += this.prettyPrint(indent + this.indent, show_context, args[i], false);\r\n\t\t\t}\r\n\t\t\telse if(operator == \"get\" && i == 0){ // weird one, needs special casing\r\n\t\t\t\tstr += \"\\n\" + nspaces(indent-this.indent) + \"WOQL\";\r\n\t\t\t\tfor(var j = 0; j < args[0].length; j++){\r\n\t\t\t\t\tvar myas = (args[0][j].as ? args[0][j].as : args[0][j]);\r\n\t\t\t\t\tvar lhs = myas[0];\r\n\t\t\t\t\tvar rhs = myas[1];\r\n\t\t\t\t\tif(typeof lhs == \"object\" && lhs['@value']){\r\n\t\t\t\t\t\tlhs = lhs['@value'];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(typeof lhs == \"object\") {\r\n\t\t\t\t\t\tlhs = JSON.stringify(lhs);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tlhs = '\"' + lhs + '\"'\r\n\t\t\t\t\t}\r\n\t\t\t\t\tstr += '.as(' + lhs;\r\n\t\t\t\t\tif(rhs) str += ', \"' + rhs + '\"';\r\n\t\t\t\t\tstr += \")\";\r\n\t\t\t\t\tstr += \"\\n\" + nspaces(indent);\r\n\t\t\t\t}\r\n\t\t\t}\t\r\n\t\t\telse {\r\n\t\t\t\tstr += this.uncleanArgument(operator, args[i], i, args);\r\n\t\t\t}\r\n\t\t\tif(i < args.length -1) str +=  ',';\r\n\t\t}\r\n\t}\r\n\tif(args_take_newlines.indexOf(operator) != -1){\r\n\t\tstr += \"\\n\" + nspaces(indent-this.indent);\r\n\t}\r\n\tstr += \")\";\r\n\treturn str;\r\n}\r\n\r\n\r\n/**\r\n * Passed as arguments: 1) the operator (and, triple, not, opt, etc)\r\n * 2) the value of the argument\r\n * 3) the index (position) of the argument. \r\n */\r\nWOQLQuery.prototype.uncleanArgument = function(operator, val, index, allArgs){\r\n\t//numeric values go out untouched... \r\n\tconst numeric_operators = [\"limit\", \"start\", \"eval\", \"plus\", \"minus\", \"times\", \"divide\", \"exp\", \"div\"];\r\n\tif(operator == \"isa\"){\r\n\t\tval = (index == 0 ? this.unclean(val, 'subject') : this.unclean(val, 'class'));\r\n\t}\r\n\telse if(operator == \"sub\"){\r\n\t\tval = this.unclean(val, 'class');\r\n\t}\r\n\telse if([\"select\"].indexOf(operator) != -1){\r\n\t\tif(val.substring(0, 2) == \"v:\") val = val.substring(2);\r\n\t}\r\n\telse if([\"quad\", \"add_quad\", \"delete_quad\", \"add_triple\", \"delete_triple\", \"triple\"].indexOf(operator) != -1){\r\n\t\tswitch(index){\r\n\t\t\tcase 0: val = this.unclean(val, \"subject\"); break;\r\n\t\t\tcase 1: val = this.unclean(val, \"predicate\"); break;\r\n\t\t\tcase 2: val = this.unclean(val, \"object\"); break;\r\n\t\t\tcase 3: val = this.unclean(val, \"graph\"); break;\r\n\t\t}\r\n\t}\r\n\tif(typeof val == \"object\"){\r\n\t\tif(operator == \"concat\" && index == 0){\r\n\t\t\tvar cstr = \"\";\r\n\t\t\tif(val.list){\r\n\t\t\t\tfor(var i = 0 ; i<val.list.length; i++){\r\n\t\t\t\t\tif(val.list[i]['@value']) cstr += val.list[i]['@value'];\r\n\t\t\t\t\telse cstr += val.list[i];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar oval = '\"' + cstr + '\"';\r\n\t\t}\r\n\t\telse {\r\n\t\t\tvar oval = this.uncleanObjectArgument(operator, val, index);\r\n\t\t}\r\n\t\treturn oval;\r\n\t}\r\n\t//else if(numeric_operators.indexOf(operator) !== -1){\r\n\t//\treturn val;\r\n\t//}\r\n\tif(typeof val == \"string\"){\r\n\t\treturn '\"' + val + '\"';\r\n\t}\r\n\treturn val;\r\n}\r\n\r\n\r\n\r\nWOQLQuery.prototype.uncleanObjectArgument = function(operator, val, index){\r\n\tif(val['@value'] && (val['@language'] || (val['@type'] && val['@type'] == \"xsd:string\"))) return '\"' + val['@value'] + '\"';\r\n\tif(val['@value'] && (val['@type'] && val['@type'] == \"xsd:integer\")) return val['@value'];\r\n\tif(val['list']) {\r\n\t\tvar nstr = \"[\";\r\n\t\tfor(var i = 0 ; i<val['list'].length; i++){\r\n\t\t\tif(typeof val['list'][i] == \"object\"){\r\n\t\t\t\tnstr += this.uncleanObjectArgument(\"list\", val['list'][i], i);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tnstr += '\"' + val['list'][i] + '\"';\r\n\t\t\t}\r\n\t\t\tif(i < val['list'].length-1){\r\n\t\t\t\tnstr += \",\";\r\n\t\t\t}\r\n\t\t}\r\n\t\tnstr += \"]\";\r\n\t\treturn nstr;\r\n\t}\r\n\treturn JSON.stringify(val);\r\n}\r\n\r\nWOQLQuery.prototype.argIsSubQuery = function(operator, args){\r\n\tconst squery_operators = [\"and\", \"or\", \"when\", \"not\", \"opt\"];\r\n\treturn (squery_operators.indexOf(operator) !== -1);\r\n}\r\n\r\n/**\r\n * Goes from the properly prefixed clean internal version of a variable to the WOQL.js unprefixed form\r\n */\r\nWOQLQuery.prototype.unclean = function(s, part){\r\n\tif(typeof s != \"string\") return s;\r\n\tif(s.indexOf(\":\") == -1) return s;\r\n\tif(s.substring(0,4) == \"http\") return s;\r\n\tvar suff = s.split(\":\")[1];\r\n\tif(this.vocab && this.vocab[suff] && this.vocab[suff] == s){\r\n\t\treturn suff;\r\n\t}\r\n\tif(!part) return s;\r\n\tif(part == \"subject\" && (s.split(\":\")[0] == \"doc\")) return suff;\r\n\tif(part == \"class\" && (s.split(\":\")[0] == \"scm\")) return suff;\r\n\tif(part == \"predicate\" && (s.split(\":\")[0] == \"scm\")) return suff;\r\n\tif(part == \"type\" && (s.split(\":\")[0] == \"scm\")) return suff;\r\n\tif(part == \"graph\" && (s.split(\":\")[0] == \"db\")) return suff;\r\n\treturn s;\r\n}\r\n\r\nWOQLQuery.prototype.hasShortcut = function(operator, args, indent, show_context){\r\n\tif(operator == \"true\") return true;\r\n}\r\n\r\nWOQLQuery.prototype.getShortcut = function(operator, args, indent, show_context){\r\n\tif(operator == \"true\") return true;\r\n}\r\n\r\n\r\n\r\n\r\nfunction nspaces(n){\r\n\tlet spaces = \"\";\r\n\tfor(var i = 0; i<n; i++){\r\n\t\tspaces += \" \";\r\n\t}\r\n\treturn spaces;\r\n}\r\n\r\n\r\nWOQLQuery.prototype.printLine = function(indent, clauses){\r\n\treturn \"(\\n\" + nspaces(indent) + \"WOQL.\" + clauses.join(\",\\n\"+ nspaces(indent) + \"WOQL.\") + \"\\n\" + nspaces(indent - this.indent) + \")\";\r\n}\r\n\r\n\r\n\r\n\r\nWOQLQuery.prototype.cleanSubject = function(s){\r\n\tif(typeof s != \"string\") return s;\r\n\tif(s.indexOf(\":\") != -1) return s;\r\n\tif(this.vocab && this.vocab[s]) return this.vocab[s];\r\n\treturn \"doc:\" + s;\r\n}\r\n\r\nWOQLQuery.prototype.cleanPredicate = function(p){\r\n\tif(p.indexOf(\":\") != -1) return p;\r\n\tif(this.vocab && this.vocab[p]) return this.vocab[p];\r\n\treturn \"scm:\" + p;\r\n}\r\nWOQLQuery.prototype.cleanType = function(t){\r\n\tif(t.indexOf(\":\") != -1) return t;\r\n\tif(this.vocab && this.vocab[t]) return this.vocab[t];\r\n\treturn \"scm:\" + t;\r\n}\r\n\r\nWOQLQuery.prototype.cleanObject = function(o){\r\n\tif(typeof o != \"string\" || o.indexOf(\":\") != -1) return o;\r\n\tif(this.vocab && this.vocab[o]) return this.vocab[o];\r\n\treturn { \"@value\": o, \"@language\": \"en\"};\r\n}\r\n\r\nWOQLQuery.prototype.cleanGraph = function(g){\r\n\tif(g.indexOf(\":\") != -1) return g;\r\n\tif(this.vocab && this.vocab[g]) return this.vocab[g];\r\n\treturn \"db:\" + g;\r\n}\r\n\r\nWOQLQuery.prototype.cleanClass = function(c){\r\n\tif(c.indexOf(\":\") != -1) return c;\r\n\tif(this.vocab && this.vocab[c]) return this.vocab[c];\r\n\treturn \"scm:\" + c;\r\n}\r\n\r\n/*\r\n * higher level composite queries - not language or api elements\r\n */\r\n/**\r\n * Class for enabling building of triples from pieces\r\n * type is add_quad / remove_quad / add_triple / remove_triple\r\n */\r\nfunction TripleBuilder(type, cursor, s){\r\n\t//what accumulation type are we\r\n\tthis.type = type;\r\n\tthis.cursor = cursor;\r\n\tthis.subject = (s ? s : false);\r\n\tthis.g = false;\r\n}\r\n\r\nTripleBuilder.prototype.label = function(l, lang){\r\n\tlang = (lang ? lang : \"en\");\r\n\tif(l.substring(0, 2) == \"v:\"){\r\n\t\tvar d = {\"value\": l, \"@language\": lang }\r\n\t}\r\n\telse {\r\n\t\tvar d = {\"@value\": l, \"@language\": lang }\r\n\t}\r\n\tvar x = this.addPO('rdfs:label', d);\r\n\treturn x;\r\n}\r\n\r\nTripleBuilder.prototype.comment = function(c, lang){\r\n\tlang = (lang ? lang : \"en\");\r\n\tif(c.substring(0, 2) == \"v:\"){\r\n\t\tvar d = {\"value\": l, \"@language\": lang }\r\n\t}\r\n\telse {\r\n\t\tvar d = {\"@value\": l, \"@language\": lang }\r\n\t}\r\n\treturn this.addPO('rdfs:comment', d);\r\n}\r\n\r\nTripleBuilder.prototype.addPO = function(p, o, g){\r\n\tif(this.type){\r\n\t\tvar ttype = (this.type == \"isa\" || this.type == \"sub\" ? \"triple\" : this.type);\r\n\t}\r\n\telse var ttype = \"triple\";\r\n\tvar evstr = ttype + '(\"' + this.subject + '\", \"' + p + '\", ';\r\n\tif(typeof o == \"string\"){\r\n\t\tevstr += \"'\" + o + \"'\";\t\t\r\n\t} \r\n\telse if(typeof o == \"object\"){\r\n\t\tevstr += JSON.stringify(o);\r\n\t}\r\n\telse {\r\n\t\tevstr += o;\r\n\t}\r\n\tif(ttype.substring(ttype.length-4) == \"quad\" || this.g){\r\n\t\tvar g = (g ? g : (this.g ? this.g : \"db:schema\"));\r\n\t\tevstr += ', \"' + g + '\"'; \r\n\t}\r\n\tevstr += \")\";\r\n\ttry {\r\n\t\tvar unit = eval(\"new WOQLQuery().\" + evstr );\r\n\t\treturn this.addEntry(unit);\r\n\t}\r\n\tcatch(e){\r\n\t\tconsole.error(e);\r\n\t\treturn this;\r\n\t}\r\n}\r\n\r\nTripleBuilder.prototype.getO = function(s, p){\r\n\tif(this.cursor['and']){\r\n\t\tfor(var i = 0; i<this.cursor['and'].length; i++){\r\n\t\t\tvar clause = this.cursor['and'][i];\r\n\t\t\tvar key = Object.keys(clause)[0];\r\n\t\t\tif(clause[key][0] == s && clause[key][1] == p && clause[key][2]) return clause[key][2];\r\n\t\t}\r\n\t}\r\n\telse if(Object.keys(this.cursor)) {\r\n\t\tvar key =  Object.keys(this.cursor)[0];\r\n\t\tif(this.cursor[key][0] == s && this.cursor[key][1] == p && this.cursor[key][2])  return this.cursor[key][2];\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nTripleBuilder.prototype.addEntry = function(unit){\r\n\tif(this.cursor[this.type]){\r\n\t\tvar next = {};\r\n\t\tnext[this.type] = this.cursor[this.type];\r\n\t\tthis.cursor['and'] = [next];\r\n\t\tdelete(this.cursor[this.type]);\r\n\t}\r\n\tif(this.cursor['and']){\r\n\t\tthis.cursor['and'].push(unit.json());\r\n\t}\r\n\telse {\r\n\t\tvar j = unit.json();\r\n\t\tif(j[this.type]) this.cursor[this.type] = j[this.type];\r\n\t\telse {\r\n\t\t\talert(JSON.stringify(j));\r\n\t\t}\r\n\t}\r\n\treturn this;\r\n}\r\n\r\nTripleBuilder.prototype.card = function(n, which){\r\n\tlet os = this.subject;\r\n\tthis.subject += \"_\" + which;\r\n\tthis.addPO('rdf:type', \"owl:Restriction\");\r\n\tthis.addPO(\"owl:onProperty\", os);\r\n\tswitch(which){\r\n\t\tcase \"max\": this.addPO(\"owl:maxCardinality\", n);\r\n\t\t\tbreak;\r\n\t\tcase \"min\": this.addPO(\"owl:minCardinality\", n);\r\n\t\t\tbreak;\r\n\t\tdefault: this.addPO(\"owl:cardinality\", n);\r\n\t}\r\n\tlet od = this.getO(os, \"rdfs:domain\");\r\n\tif(od){\r\n\t\tvar x = this.subject;\r\n\t\tthis.subject = od;\r\n\t\tthis.addPO(\"rdfs:subClassOf\", this.subject);\r\n\t\t//this.triples.push([od, \"rdfs:subClassOf\", this.subject]);\r\n\t}\r\n\tthis.subject = os;\r\n\treturn this;\r\n};\r\n\r\nTripleBuilder.prototype.isa = function(a){\r\n\tvar unit = new WOQLQuery.isa(this.subject, a);\r\n\tthis.tb.addEntry(unit);\r\n}\r\n\r\nTripleBuilder.prototype.graph = function(g){\r\n\tthis.g = g;\r\n}\r\n\r\nTripleBuilder.prototype.sub = function(s){\r\n\tvar unit = new WOQLQuery.sub(this.subject, s);\r\n\treturn this.addEntry(unit);\r\n}\r\n\r\nTripleBuilder.prototype.abstract = function(){\r\n\treturn this.addPO('tcs:tag', \"tcs:abstract\");\r\n}\r\n\r\nmodule.exports = WOQL;\r\n","function Codemirror(text, format, config){\r\n  this.textdom = text;\r\n  this.mode = format;\r\n  if(objectIsEmpty(config)) this.darkMode = config.darkMode;\r\n  if(this.jsonldCheck(format)) this.mode = 'javascript';\r\n}\r\n// checks if a json object is empty\r\nfunction objectIsEmpty(arg) {\r\n  for (var item in arg) {\r\n    return false;\r\n  }\r\n  return true;\r\n}\r\n\r\nfunction autocomplete(){\r\n    var orig = CodeMirror.hint.javascript = function (cm) {\r\n        var list = [\"limit()\",\"start()\",\"triple()\"];//Session.get(Template.strSessionDistinctFields) || [];\r\n        var cursor = cm.getCursor();\r\n        var currentLine = cm.getLine(cursor.line);\r\n        var start = cursor.ch;\r\n        var end = start;\r\n        while (end < currentLine.length && /[\\w$]+/.test(currentLine.charAt(end))) ++end;\r\n        while (start && /[\\w$]+/.test(currentLine.charAt(start - 1))) --start;\r\n        var curWord = start != end && currentLine.slice(start, end);\r\n        var regex = new RegExp('^' + curWord, 'i');\r\n        var result = {\r\n            list: (!curWord ? list : list.filter(function (item) {\r\n                return item.match(regex);\r\n            })).sort(),\r\n            from: CodeMirror.Pos(cursor.line, start),\r\n            to: CodeMirror.Pos(cursor.line, end)\r\n        };\r\n        return result;\r\n    };\r\n    // codeMirror.hint.sql is defined when importing codemirror/addon/hint/sql-hint\r\n    // (this is mentioned in codemirror addon documentation)\r\n    // Reference the hint function imported here when including other hint addons\r\n    // or supply your own\r\n   \t//cm.replaceSelection(\".\");\r\n    //codeMirror.showHint(cm, CodeMirror.hint.javascript, hintOptions);\r\n}\r\n\r\n/*\r\ntxtar    : editor is attached to textar\r\nmode     : format for highlighting, ex: json, html etc.\r\neditable : readOnly false/ nocursor is special value in code editor to set readonly true */\r\nCodemirror.prototype.colorizeTextArea = function(dimensions){\r\n    //initize auto complete\r\n    /*CodeMirror.commands.autocomplete = function(cm) {\r\n    cm.showHint({hint: CodeMirror.hint.anyword});\r\n    }*/\r\n\r\n    // initialise code editor on text area\r\n    var editor = CodeMirror.fromTextArea(this.textdom, {\r\n        mode                : this.mode,\r\n        firstLineNumber     : 1,\r\n        lineNumbers         : true,\r\n        styleActiveLine     : true,\r\n        lineWrapping        : true,\r\n        smartIndent         : true,\r\n        indentWithTabs      : true,\r\n        newlineAndIndent    : true,\r\n        autoCloseBrackets   : true,\r\n        matchBrackets       : {afterCursor: true},\r\n        extraKeys           : {\"Ctrl-F\": \"find\",\r\n                               \"Tab\": \"autocomplete\",\r\n                               \"Ctrl-Q\": function(cm){ cm.foldCode(cm.getCursor()); }},\r\n        refresh             : true,\r\n        foldGutter          : true,\r\n        gutters             : [\"CodeMirror-linenumbers\", \"CodeMirror-foldgutter\"]\r\n    });\r\n    editor.foldCode(CodeMirror.Pos(13, 0));\r\n    if(!(objectIsEmpty(dimensions)))\r\n        editor.setSize(dimensions.width, dimensions.height);\r\n    else this.setCodemirrorSize(editor, dimensions);\r\n    editor.defaultCharWidth('20px');\r\n    if(this.darkMode) editor.setOption(\"theme\", 'erlang-dark');\r\n    else editor.setOption(\"theme\", 'neo');\r\n    return editor;\r\n} // colorizeTextArea()\r\n\r\n/*\r\n  set editor size according to screens\r\n  editor : code mirror editor Object\r\n  mode   : editor being viewed from schema/ doc/ query page*/\r\nCodemirror.prototype.setCodemirrorSize = function(editor, dimensions){\r\n  switch(dimensions){\r\n    case 'query':\r\n      editor.setSize('800', '400');\r\n    break;\r\n    case 'schema':\r\n      editor.setSize('auto', '1550');\r\n    break;\r\n    case 'document':\r\n     editor.setSize('765', '500');\r\n    break;\r\n    case 'api-doc':\r\n        editor.setSize('800', '500');\r\n    break;\r\n    case 'doc-json':\r\n        editor.setSize('1410', 'auto');\r\n    break;\r\n    case 'doc-json-create':\r\n        editor.setSize('1410', '500');\r\n    break;\r\n  } // switch(dimensions)\r\n} // setCodemirrorSize()\r\n\r\n// updateTextArea(): highlights new changes on editor\r\nCodemirror.prototype.updateTextArea = function(editor){\r\n  editor.save();\r\n  setTimeout(function() {\r\n      editor.refresh();\r\n  },1);\r\n  // save changes of code mirror editor\r\n  editor.on('change', function(){\r\n    editor.save();\r\n  });\r\n} //updateTextArea()\r\n\r\n/*\r\ncolorizePre() to colorise pre tags (read only mode)\r\ntext (string)    : The document to run through the highlighter.\r\nmode (mode spec) : format to highlight color\r\noutput (DOM node): The tokens will be converted to spans as in an editor,\r\n                   and inserted into the node (through innerHTML).*/\r\nCodemirror.prototype.colorizePre = function(){\r\n  CodeMirror.runMode(this.textdom.innerText, this.mode, this.textdom);\r\n  if(this.darkMode)\r\n      var theme = 'cm-s-erlang-dark';\r\n  else var theme = 'cm-s-neo';\r\n  this.textdom.setAttribute('class', 'CodeMirror CodeMirror-wrap ' + theme + ' terminus-wrap-text terminus-wrapper-height ');\r\n  return this.textdom;\r\n} // colorizePre()\r\n\r\nCodemirror.prototype.jsonldCheck = function(format){\r\n  if(format == 'jsonld') return true;\r\n}\r\n\r\nmodule.exports=Codemirror\r\n","/*\r\n * User Interface elements dealing with database level functions - view, delete, create, db\r\n * view document etc\r\n */\r\nconst UTILS=require('./Utils');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\nconst WOQLRule = require(\"./viewer/WOQLRule\");\r\nconst QueryPane = require(\"./html/QueryPane\");\r\nconst TerminusFrame = require(\"./viewer/TerminusFrame\");\r\nconst DocumentPane = require(\"./html/DocumentPane\");\r\n\r\n\r\n/*\r\n * User Interface elements dealing with database level functions - view, delete, create, db\r\n * view document etc\r\n */\r\nfunction TerminusDBController(ui){\r\n\t this.ui = ui;\r\n}\r\n\r\n/*\r\n * Controller provides access to the server level functions (create/delete db) and db-level functions (schema, query, document)\r\n * Populates left hand column on dashboard page\r\n */\r\nTerminusDBController.prototype.getAsDOM = function(){\r\n\tvar self = this;\r\n\tvar dbc = document.createElement(\"div\");\r\n\tdbc.setAttribute(\"class\", \"terminus-db-controller\");\r\n\tif(this.ui && this.ui.db()){\r\n\t\tvar scd = document.createElement(\"div\");\r\n\t\tscd.setAttribute(\"class\", \"terminus-field terminus-db-connection\");\r\n\t\tvar dbrec = this.ui.client.connection.getDBRecord();\r\n\t\tvar nm = (dbrec && dbrec[\"rdfs:label\"] && dbrec[\"rdfs:label\"][\"@value\"] ? dbrec[\"rdfs:label\"][\"@value\"] : this.ui.db());\r\n\t\t//dbc.appendChild(scd);\r\n\t\tvar nav = document.createElement('div');\r\n\t\tnav.setAttribute('class', 'span3');\r\n\t\tdbc.appendChild(nav);\r\n\t\tvar ul = document.createElement('ul');\r\n\t\tul.setAttribute('class','terminus-ul' );\r\n\t\tnav.appendChild(ul);\r\n\t\t// connected to db\r\n\t\tvar a = document.createElement('a');\r\n        a.setAttribute('class', 'terminus-dashboard-info terminus-a terminus-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer\"');\r\n        a.appendChild(document.createTextNode(nm));\r\n\t\tul.appendChild(a);\r\n\t\tvar p = this.ui.page ? this.ui.page : \"db\";\r\n\t\tif(this.ui.showControl(\"db\")){\r\n\t\t\tif(p == \"db\") a.classList.add(\"terminus-selected\");\r\n\t\t\tself.ui.page = \"db\";\r\n\t\t\ta.addEventListener(\"click\", function(){\r\n\t\t\t\tself.ui.showDBMainPage();\r\n\t\t\t\tself.ui.page = \"db\";\r\n\t\t\t\tself.ui.redrawControls();\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tif(this.ui.showControl(\"get_document\")){\r\n\t\t\tvar item = this.getControlHTML(\"Documents\", \"fas fa-file\");\r\n\t\t\tif(p == \"docs\") item.classList.add(\"terminus-selected\");\r\n\t\t    item.addEventListener(\"click\", function(){\r\n\t\t\t\tself.ui.showDocumentPage();\r\n\t\t\t\tself.ui.page = \"docs\";\r\n\t\t\t\tself.ui.redrawControls();\r\n\t\t\t });\r\n\t        ul.appendChild(item);\r\n\t    }\r\n\t\tif(this.ui.showControl(\"delete_database\")){\r\n\t\t\tvar item = this.getControlHTML(\"Delete Database\", \"fa-trash-alt\");\r\n\t\t    item.addEventListener(\"click\", function(){\r\n\t\t\t\tUTILS.activateSelectedNav(this, self);\r\n\t\t\t\tself.ui.deleteDatabase();\r\n\t\t\t });\r\n\t        ul.appendChild(item);\r\n\t\t}\r\n\t\tif(this.ui.showControl(\"woql_select\")){\r\n\t\t\tvar item = this.getControlHTML(\"Query\", \"fa-search\");\r\n\t\t\tif(p == \"query\") item.classList.add(\"terminus-selected\");\r\n\t\t    item.addEventListener(\"click\", function(){\r\n\t\t\t\tUTILS.activateSelectedNav(this, self);\r\n\t\t\t\tself.ui.page = \"query\";\r\n\t\t\t\tself.ui.showQueryPage();\r\n\t\t\t\tself.ui.redrawControls();\r\n\t\t\t});\r\n\t        ul.appendChild(item);\r\n\t\t}\r\n\t\tif(this.ui.showControl(\"get_schema\")){\r\n\t\t\tvar item = this.getControlHTML(\"Schema\", \"fa-cog\");\r\n\t\t\tif(p == \"schema\") item.classList.add(\"terminus-selected\");\r\n\t        item.addEventListener(\"click\", function(){\r\n\t\t\t\tUTILS.activateSelectedNav(this, self);\r\n\t\t\t\tself.ui.page = \"schema\";\r\n\t\t\t\tself.ui.showSchemaPage();\r\n\t\t\t\tself.ui.redrawControls();\r\n\t\t\t})\r\n\t        ul.appendChild(item);\r\n\t\t}\r\n\t}\r\n\treturn dbc;\r\n}\r\n\r\n\r\nTerminusDBController.prototype.getControlHTML = function(text, ic, css){\r\n    var self = this;\r\n    var a = document.createElement('a');\r\n\ta.setAttribute('class', 'terminus-a terminus-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\r\n    var icon = document.createElement('i');\r\n    icon.setAttribute('class', 'terminus-menu-icon fa ' + ic);\r\n    a.appendChild(icon);\r\n    var txt = document.createTextNode(text);\r\n    a.appendChild(txt);\r\n    return a;\r\n}\r\n\r\n\r\n/**\r\n * DB home page main function\r\n * @param {TerminusUI} ui\r\n */\r\nfunction TerminusDBViewer(ui){\r\n\tthis.ui = ui;\r\n\tthis.container = document.createElement(\"span\");\r\n\tthis.container.setAttribute(\"class\", \"terminus-main-page\");\r\n\tthis.pages = [\"home\"];\r\n}\r\n\r\nTerminusDBViewer.prototype.getAsDOM = function(){\r\n\tTerminusClient.FrameHelper.removeChildren(this.container);\r\n\tvar limit = 20;\r\n\tvar WOQL = TerminusClient.WOQL;\r\n\tvar dburl = this.ui.client.connectionConfig.dbURL();\r\n\tvar q = WOQL.from(dburl).limit(limit).documentMetadata();\r\n\tq.execute(this.ui.client).then( (result) => {\r\n\t\tvar docs = new TerminusClient.WOQLResult(result, q);\r\n\t\tvar q2 = WOQL.from(dburl).concreteDocumentClasses();\r\n\t\tq2.execute(this.ui.client).then( (result2) => {\r\n\t\t\tvar docClasses = new TerminusClient.WOQLResult(result2, q2);\r\n\t\t\tvar bdom = this.getBodyAsDOM(docs, docClasses);\r\n\t\t\tif(bdom) this.container.appendChild(bdom);\r\n\t\t});\r\n\t}).catch((e) => {\r\n\t\tthis.ui.showError(e);\r\n\t});\r\n\treturn this.container;\r\n}\r\n\r\nTerminusDBViewer.prototype.getRulesForListOfDocuments = function(woql) {\r\n\tvar table = woql.table();\r\n\ttable.column('Label').header('Document');\r\n\ttable.column('Comment').header('Description');\r\n\ttable.column('Type_Comment').header('Type Description');\r\n\treturn table;\r\n}\r\n\r\nTerminusDBViewer.prototype.getRulesForGraphOfDocuments = function(woql){\r\n\tvar graph = woql.graph();\r\n\tgraph.height(500).width(1250);\r\n\treturn graph;\r\n}\r\n\r\nTerminusDBViewer.prototype.getBodyAsDOM = function(docs, docClasses){\r\n\t if(this.page == \"docs\"){\r\n\t\t return this.getDocumentsDOM(docs, docClasses);\r\n\t }\r\n\t else {\r\n\t\t return this.getHomeDOM(docs, docClasses);\r\n\t }\r\n}\r\n\r\nTerminusDBViewer.prototype.getHomeDOM = function(docs, docClasses){\r\n\tif(this.body){\r\n\t\tTerminusClient.FrameHelper.removeChildren(this.body);\r\n\t}\r\n\telse {\r\n\t\tthis.body = document.createElement(\"div\");\r\n\t\tthis.body.setAttribute(\"class\", \"terminus-home-body terminus-document-view\");\r\n\t\t//this.body.setAttribute('style', 'display: table-caption;');\r\n\t}\r\n\tif(docs.count() > 0){\r\n\t\tthis.body.appendChild(this.showHappyBox(\"dbhome\", \"demo\"));\r\n\t\tthis.body.appendChild(this.showHappyBox(\"dbhome\", \"intro\"));\r\n\t\tthis.body.appendChild(this.showHappyBox(\"happy\", \"query\"));\r\n\t\tvar delw = this.getDeleteDatabaseWidget();\r\n\t\tvar config = TerminusClient.WOQL.document();\r\n\t\tconfig.show_all(\"SimpleFrameViewer\");\r\n\t\tconfig.object().features(\"id\", \"type\", \"comment\", \"save\", \"value\");\r\n\t\tconfig.property().features(\"label\", \"value\");\r\n\t\tconfig.data().features(\"value\");\r\n\t\t\r\n\t\tvar cont = document.createElement(\"span\");\r\n\t\tthis.body.appendChild(cont);\r\n\t\tvar mydb = this.ui.db();\r\n\t\tthis.ui.connectToDB(\"terminus\");\r\n\t\tthis.insertDocument(\"doc:\" + mydb, cont, config);\r\n\t\tthis.ui.connectToDB(mydb); \r\n\t}\r\n\telse if(docClasses.count() > 0) {\r\n\t\tvar dchooser = this.getCreateDataChooser(docClasses,\r\n\t\t\t{showQuery: false, editQuery: false},\r\n\t\t\t{showConfig: false, editConfig: false});\r\n\t\tif(docClasses.count() <= 3){\r\n\t\t\tthis.body.appendChild(this.showHappyBox(\"empty\", \"schema\"));\r\n\t\t\tthis.body.appendChild(this.showHappyBox(\"empty\", \"query\"));\r\n\t\t\tif(docClasses.count() > 0){\r\n\t\t\t\tthis.body.appendChild(this.showHappyBox(\"empty\", \"docs\", dchooser));\r\n\t\t\t}\r\n\t\t}\r\n\t\telse  {\r\n\t\t\tthis.body.appendChild(this.showHappyBox(\"happy\", \"schema\"));\r\n\t\t\tthis.body.appendChild(this.showHappyBox(\"happy\", \"docs\", dchooser));\r\n\t\t\tthis.body.appendChild(this.showHappyBox(\"happy\", \"query\"));\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tthis.body.appendChild(this.showHappyBox(\"empty\", \"schema\"));\r\n\t\tthis.body.appendChild(this.showHappyBox(\"empty\", \"query\"));\t\r\n\t}\r\n\tif(delw) this.body.appendChild(delw);\r\n\treturn this.body;\r\n}\r\n\r\n\r\nTerminusDBViewer.prototype.getDocumentsDOM = function(docs, docClasses){\r\n\tvar WOQL = TerminusClient.WOQL;\r\n\tvar self = this;\r\n\tif(this.body){\r\n\t\tTerminusClient.FrameHelper.removeChildren(this.body);\r\n\t\tvar body = this.body;\r\n\t}\r\n\telse {\r\n\t\tvar body = document.createElement(\"div\");\r\n\t\tbody.setAttribute(\"class\", \"terminus-home-body terminus-document-view\");\r\n\t\t//body.setAttribute('style', 'display: table-caption;');\r\n\t}\r\n\tvar page_actions = document.createElement(\"div\");\r\n\tpage_actions.setAttribute(\"class\", \"terminus-home-actions\");\r\n\tbody.appendChild(page_actions);\r\n\tvar span = document.createElement('span');\r\n\tspan.setAttribute('class', 'terminus-display-flex');\r\n\tpage_actions.appendChild(span);\r\n\tif(docClasses.count() > 0){\r\n\t\tvar ch = function(cls){\r\n\t\t\tif(cls)\tself.loadCreateDocumentPage(cls);\r\n\t\t}\r\n\t\tvar dchooser = this.getCreateDataChooser(docClasses,\r\n\t\t\t\t\t\t\t\t\t\t\t\t{showQuery: false, editQuery: false},\r\n\t\t\t\t\t\t\t\t\t\t\t\t{showConfig: false, editConfig: true},\r\n\t\t\t\t\t\t\t\t\t\t\t\t ch );\r\n\t\tif(docs.count() > 1) span.appendChild(dchooser);\r\n\t}\r\n\telse {\r\n\t\tthis.ui.showError(\"No document classes found in schema - you must define a document, entity or relationship class before you can create documents\");\r\n\t}\r\n\tif(docs.count() > 0){\r\n\t\tvar show_doc_action = this.getShowDocumentControl();\r\n\t\tspan.prepend(show_doc_action);\r\n\t\tvar dp = new QueryPane(this.ui.client, docs.query, docs)\r\n\t\t\t\t\t.options({showQuery: \"icon\", editQuery: true});\r\n\t\tvar table = this.getRulesForListOfDocuments(WOQL);\r\n\t\tvar g = this.getRulesForGraphOfDocuments(WOQL);\r\n\t\tvar options =  { showConfig: \"icon\", editConfig: \"true\", viewers: [g]};\r\n\t\tdp.addView(table, options);\r\n\t\tbody.appendChild(dp.getAsDOM());\r\n\t\tvar WOQL = TerminusClient.WOQL;\r\n\t\tvar dburl = this.ui.client.connectionConfig.dbURL();\r\n\t\tvar q = WOQL.from(dburl).limit(100).documentMetadata();\r\n\t\tq.execute(this.ui.client).then( (result) => {\r\n\t\t\tvar g = new TerminusClient.WOQLResult(result, q);\r\n\t\t\tvar ddp = new QueryPane(this.ui.client, g.query, g).options({showQuery: \"icon\", editQuery: false});\r\n\t\t\tvar g2 = this.getRulesForGraphOfDocuments(WOQL);\r\n\t\t\tvar options =  { showConfig: \"icon\", editConfig: \"true\", viewers: [table] };\r\n\t\t\tbody.appendChild(UTILS.getHeaderDom('Graph showing links between documents'));\r\n\t\t\tddp.addView(g2, options);\r\n\t\t\tbody.appendChild(ddp.getAsDOM());\r\n\t\t\tthis.container.appendChild(body);\r\n\t\t}).catch((e) => {\r\n\t\t\tthis.ui.showError(e);\r\n\t\t});\r\n\t}\r\n\telse {\r\n\t\tif(docClasses.count() == 3){\r\n\t\t\tbody.appendChild(this.showHappyBox(\"empty\", \"schema\"));\r\n\t\t\tbody.appendChild(this.showHappyBox(\"empty\", \"query\"));\r\n\t\t\tbody.appendChild(this.showHappyBox(\"empty\", \"docs\", dchooser));\r\n\t\t}\r\n\t\telse {\r\n\t\t\tbody.appendChild(this.showHappyBox(\"happy\", \"schema\"));\r\n\t\t\tbody.appendChild(this.showHappyBox(\"happy\", \"docs\", dchooser));\r\n\t\t\tbody.appendChild(this.showHappyBox(\"happy\", \"query\"));\r\n\t\t}\r\n\t}\r\n\tthis.body = body;\r\n\treturn body;\r\n}\r\n\r\n\r\nTerminusDBViewer.prototype.getDeleteDatabaseWidget = function(){\r\n\t// delete database\r\n\tif(this.ui.db() == \"terminus\") return;\r\n\tvar d = document.createElement(\"span\");\r\n\td.setAttribute(\"class\", \"terminus-db-widget\");\r\n\tTerminusClient.FrameHelper.removeChildren(this.container);\r\n    var del = document.createElement('button');\r\n    del.setAttribute('class', 'terminus-btn terminus-btn-float-right terminus-home-del');\r\n    del.setAttribute('type', 'button');\r\n\tdel.appendChild(document.createTextNode('Delete Database'));\r\n\tvar di = document.createElement(\"i\");\r\n\tdi.setAttribute(\"class\", \"fa fa-trash terminus-icon-padding\");\r\n\tdel.appendChild(di);\r\n\tvar dbrec = this.ui.getDBRecord();\r\n\tif(dbrec)\r\n\t\tvar nm = (dbrec[\"rdfs:label\"] && dbrec[\"rdfs:label\"][\"@value\"] ? dbrec[\"rdfs:label\"][\"@value\"] : this.ui.db());\r\n\telse var nm = this.ui.db();\r\n    var self = this;\r\n\tvar dbdel = this.ui.db();\r\n\tvar delbut = this.ui.getDeleteDBButton(dbdel);\r\n\tif(delbut){\r\n\t\td.appendChild(delbut);\r\n\t}\r\n\treturn d;\r\n}\r\n\r\nTerminusDBViewer.prototype.styleCreateDocumentChooser = function(){\r\n\tvar select = document.getElementsByClassName('woql-chooser');\r\n\tfor(i=0; i<select.length; i++){\r\n\t\tif(select[i].type == 'select'){\r\n\t\t\tselect[i].classList.add('terminus-form-doc-value');\r\n\t\t\tvar self = this;\r\n\t\t\tselect[i].addEventListener('change', function(){\r\n\t\t\t\tself.showCreateDocument(this.value);\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n}\r\n\r\nTerminusDBViewer.prototype.getCreateDataChooser = function(docClasses, qopts, ropts, change, pholder){\r\n\tvar WOQL = TerminusClient.WOQL;\r\n\tpholder = (pholder ? pholder : \"Create a New Document\");\r\n\tqopts  = (qopts ? qopts :  { showConfig: \"icon\", editConfig: \"true\" });\r\n\tvar dp = new QueryPane(this.ui.client, docClasses.query, docClasses).options(qopts);\r\n\tvar chooser = WOQL.chooser().values(\"Class\").labels(\"Label\").titles(\"Comment\").show_empty(pholder);\r\n\r\n\tvar self = this;\r\n\tchooser.change = (change ? change : function(cls){\r\n\t\tif(cls)\tself.loadCreateDocumentPage(cls);\r\n\t});\r\n\tropts  = (ropts ? ropts :  { showConfig: \"icon\", editConfig: \"true\" });\r\n\tdp.addView(chooser, ropts);\r\n\tvar dchooser = dp.getAsDOM();\r\n\treturn dchooser;\r\n}\r\n\r\nTerminusDBViewer.prototype.showHappyBox = function(happy, type, chooser){\r\n\tvar hbox = document.createElement(\"div\");\r\n\thbox.setAttribute(\"class\", \"terminus-welcome-box terminus-no-res-alert\");\r\n\tvar self = this;\r\n\tvar sets = {};\r\n\tif(type == \"schema\"){\r\n\t\tsets.title = (happy == \"happy\") ? \"Document Classes Created\" : \"No Schema Created\";\r\n\t\tsets.text = (happy == \"happy\") ? \"You have successfully created a schema with valid document classes!\" : \"You should create a schema and add at least one document classes before you add data to the system\";\r\n\t\tsets.css = \"fa fa-cog fa-2x terminus-welcome-icons\";\r\n\t}\r\n\telse if(type == \"docs\"){\r\n\t\tsets.css = \"fa fa-book fa-2x terminus-welcome-icons\";\r\n\t\tsets.title = \"Create Documents\";\r\n\t\tsets.text = (happy == \"happy\") ? \"Add data to the system through easy to use automatically generated forms for each document type\" : \"You should create a schema and add at least one document classes before you add data to the system\";\r\n\t}\r\n\telse if(type == \"intro\"){\r\n\t\tsets.css = \"fa fa-book fa-2x\";\r\n\t\tsets.title = \"View Documents\";\r\n\t\tsets.text = \"View the documents in the database and add new ones\";\r\n\t}\r\n\telse if(type == \"query\"){\r\n\t\tsets.css = \"fa fa-search fa-2x\";\r\n\t\tsets.title = \"Run Queries\";\r\n\t\tsets.css = \"fa fa-search fa-2x terminus-welcome-icons\";\r\n\t\tsets.title = \"Run Queries\";\r\n\t\tsets.text = (happy == \"happy\") ? \"You can add data to the system with queries and scripts, and import data directly from CSVs and URLs\" : \"You can write WOQL queries to create a schema through our query interface\";\r\n\t}\r\n\telse if(type == \"demo\"){\r\n\t\tsets.css = \"fa fa-database fa-2x terminus-welcome-icons\";\r\n\t\tvar dbrec = this.ui.getDBRecord();\r\n\t\tif(dbrec)\r\n\t\t\tvar nm = (dbrec[\"rdfs:label\"] && dbrec[\"rdfs:label\"][\"@value\"] ? dbrec[\"rdfs:label\"][\"@value\"] : this.ui.db());\r\n\t\telse var nm = this.ui.db();\r\n\t\tsets.title = nm ;\r\n\t\tsets.text = \"On this level we just want functions that have database granularity - collaboration, access control, database meta-data...\";\r\n\t}\r\n\tvar ispan =  document.createElement(\"span\");\r\n\tvar ic = document.createElement(\"i\");\r\n\tic.setAttribute(\"class\", sets.css);\r\n\tispan.appendChild(ic);\r\n\thbox.appendChild(ispan);\r\n\tvar htit = document.createElement(\"span\");\r\n\thtit.appendChild(document.createElement(\"strong\").appendChild(document.createTextNode(sets.title)));\r\n\thtit.classList.add('terminus-welcome-title');\r\n\thbox.appendChild(htit);\r\n\tvar body = document.createElement(\"p\");\r\n\tbody.setAttribute('class', 'terminus-welcome-body');\r\n\tbody.appendChild(document.createTextNode(sets.text));\r\n\thbox.appendChild(body);\r\n\tif(type == \"schema\"){\r\n\t\thbox.addEventListener(\"click\", function(){\r\n\t\t\tself.ui.page = \"schema\";\r\n\t\t\tself.ui.showSchemaPage();\r\n\t\t\tself.ui.redrawControls();\r\n\t\t});\r\n\t};\r\n\tif(type == \"intro\"){\r\n\t\thbox.addEventListener(\"click\", function(){\r\n\t\t\tself.ui.page = \"docs\";\r\n\t\t\tself.ui.showDocumentPage();\r\n\t\t\tself.ui.redrawControls();\r\n\t\t});\r\n\t};\r\n\tif(type == \"query\"){\r\n\t\thbox.addEventListener(\"click\", function(){\r\n\t\t\tself.ui.page = \"query\";\r\n\t\t\tself.ui.showQueryPage();\r\n\t\t\tself.ui.redrawControls();\r\n\t\t});\r\n\t};\r\n\tif(type == \"query\" || type == \"schema\" || type == \"intro\"){\r\n\t\thbox.addEventListener('mouseover', function(){\r\n            this.style.cursor = \"pointer\";\r\n\t\t});\r\n\t}\r\n\tif(type == \"docs\"){\r\n\t\tvar sp = document.createElement('span');\r\n\t\tsp.setAttribute('class', 'terminus-welcome-chooser');\r\n\t\tsp.appendChild(chooser);\r\n\t\thbox.appendChild(sp);\r\n\t}\r\n\treturn hbox;\r\n}\r\n\r\nTerminusDBViewer.prototype.loadCreateDocumentPage = function(cls){\r\n\tthis.ui.page = \"docs\";\r\n\tthis.ui.redrawControls();\r\n\tvar WOQL = TerminusClient.WOQL;\r\n\tvar dburl = this.ui.client.connectionConfig.dbURL();\r\n\r\n\tvar df = new DocumentPane(this.ui.client).options({\r\n\t\tshowQuery: \"icon\",\r\n\t\teditQuery: false,\r\n\t\tloadDocument: this.getShowDocumentControl(),\r\n\t});\r\n\tvar q2 = WOQL.from(dburl).concreteDocumentClasses();\r\n\tq2.execute(this.ui.client).then( (result2) => {\r\n\t\tvar docClasses = new TerminusClient.WOQLResult(result2, q2);\r\n\t\tvar dchooser = this.getCreateDataChooser(docClasses, {showQuery: \"icon\", editQuery: false},  { showConfig: \"icon\", editConfig: \"true\" } );\r\n\t\tdf.setClassLoader(dchooser);\r\n\t});\r\n\tvar config = WOQL.document().load_schema(true);\r\n\tconfig.show_all(\"SimpleFrameViewer\");\r\n\tconfig.object().features(\"id\", \"type\", \"comment\", \"delete\", \"reset\", \"hide\", \"show\", \"clone\", \"update\", \"view\", \"add\", \"value\").mode(\"edit\");//\"summary\", \"viewer\", \"status\",\r\n\tconfig.property().features(\"value\", \"label\").mode(\"edit\");//features(\"id\", \"cardinality\", \"type\", \"comment\", \"delete\", \"reset\", \"hide\", \"show\", \"clone\", \"update\", \"view\", \"add\", \"value\");//\"summary\", \"status\",\r\n\tconfig.data().features(\"value\").mode(\"edit\");//.dataviewer(\"HTMLStringViewer\").args({max_cell_size: 20, max_word_size: 10});\r\n\r\n\tdf.loadClass(cls, config).then(() => {\r\n\t\tthis.pages.push(\"New \" + cls);\r\n\t\tTerminusClient.FrameHelper.removeChildren(this.container);\r\n\t\tvar nav = this.getNavigationDOM();\r\n\t\tthis.container.appendChild(nav);\r\n\t\tthis.container.appendChild(df.getAsDOM());\r\n\t});\r\n}\r\n\r\nTerminusDBViewer.prototype.getNavigationDOM = function(){\r\n\tvar s = document.createElement(\"span\");\r\n\ts.setAttribute('class', 'terminus-back-to-home terminus-backtohome-span');\r\n\tvar i = document.createElement(\"span\");\r\n\ti.setAttribute(\"class\", \"fa fas fa-arrow-left\");\r\n\ts.appendChild(i);\r\n\tvar p =  this.pages[this.pages.length-2];\r\n\ts.appendChild(document.createTextNode(\" back to \" + p));\r\n\ts.addEventListener(\"click\", () => {\r\n\t\tvar pp = this.pages.pop();\r\n\t\tp =  this.pages[this.pages.length-1];\r\n\t\tif(p == \"home\"){\r\n\t\t\t//this.ui.page = \"docs\";\r\n\t\t\tthis.getAsDOM();\r\n\t\t}\r\n\t\telse {\r\n\t\t\tpp = this.pages.pop();\r\n\t\t\tthis.showDocumentPage(pp);\r\n\t\t}\r\n\t});\r\n\ts.addEventListener('mouseover', function(){\r\n\t\tthis.style.cursor = \"pointer\";\r\n\t});\r\n\treturn s;\r\n}\r\n\r\nTerminusDBViewer.prototype.insertDocument = function(docid, insertDOM, config){\r\n\tvar df = new DocumentPane(this.ui.client).options(config);\r\n\treturn df.loadDocument(docid, config).then(() => {\r\n\t\tinsertDOM.appendChild(df.getAsDOM());\r\n\t})\r\n\t.catch((e) => this.ui.showError(e));\t\r\n}\r\n\r\nTerminusDBViewer.prototype.showDocumentPage = function(docid){\r\n\tthis.ui.page = \"docs\";\r\n\tthis.ui.redrawControls();\r\n\tvar start = docid.substring(0, 4);\r\n\tif(start != \"doc:\" && start != \"http\") docid = \"doc:\" + docid;\r\n\tvar WOQL = TerminusClient.WOQL;\r\n\tvar dburl = this.ui.client.connectionConfig.dbURL();\r\n\tvar df = new DocumentPane(this.ui.client).options({\r\n\t\tshowQuery: \"icon\",\r\n\t\teditQuery: true,\r\n\t\tloadDocument: this.getShowDocumentControl(),\r\n\t});\r\n\tvar q2 = WOQL.from(dburl).concreteDocumentClasses();\r\n\tq2.execute(this.ui.client).then( (result2) => {\r\n\t\tvar docClasses = new TerminusClient.WOQLResult(result2, q2);\r\n\t\tvar dchooser = this.getCreateDataChooser(docClasses, {showQuery: \"icon\", editQuery: false},  { showConfig: \"icon\", editConfig: \"true\" } );\r\n\t\tdf.setClassLoader(dchooser);\r\n\t});\r\n\r\n\r\n\tvar config = WOQL.document().load_schema(true);\r\n\tconfig.show_all(\"SimpleFrameViewer\");\r\n\tconfig.object().features(\"id\", \"type\", \"comment\", \"delete\", \"reset\", \"hide\", \"show\", \"clone\", \"update\", \"view\", \"add\", \"value\");//\"summary\", \"viewer\", \"status\",\r\n\tconfig.property().features(\"value\");//features(\"id\", \"cardinality\", \"type\", \"comment\", \"delete\", \"reset\", \"hide\", \"show\", \"clone\", \"update\", \"view\", \"add\", \"value\");//\"summary\", \"status\",\r\n\tconfig.data().features(\"value\");//.dataviewer(\"HTMLStringViewer\").args({max_cell_size: 20, max_word_size: 10});\r\n\r\n\tthis.pages.push(docid);\r\n\tTerminusClient.FrameHelper.removeChildren(this.container);\r\n\tthis.insertDocument(docid, this.container, config);\r\n}\r\n\r\nTerminusDBViewer.prototype.getShowDocumentControl = function(){\r\n\tvar scd = document.createElement(\"span\");\r\n\tscd.setAttribute(\"class\", \"terminus-get-doc terminus-document-chooser terminus-form-horizontal terminus-control-group\");\r\n\tvar lab = document.createElement(\"span\");\r\n\tlab.setAttribute(\"class\", \"terminus-document-chooser-label terminus-doc-control-label terminus-control-label-padding\");\r\n\tvar dcip = document.createElement(\"input\");\r\n\tdcip.setAttribute(\"class\", \"terminus-form-doc-value terminus-document-chooser terminus-doc-input-text\");\r\n\tdcip.setAttribute(\"placeholder\", \"Enter Document ID to view ...\");\r\n\tvar nbut = document.createElement(\"button\");\r\n\tnbut.setAttribute('class', \"terminus-control-button terminus-document-button terminus-btn\");\r\n\tnbut.setAttribute('title', 'Enter Document ID to view');\r\n\tvar is = document.createElement('i');\r\n\tis.setAttribute('class', 'fa fa-caret-left');\r\n\tnbut.appendChild(is);\r\n\tnbut.appendChild(document.createTextNode(\" Load \"));\r\n\tvar i = document.createElement('i');\r\n\ti.setAttribute('class', 'fa fa-caret-right');\r\n\tnbut.appendChild(i);\r\n\tvar self = this;\r\n\tnbut.addEventListener(\"click\", function(){\r\n\t\tif(dcip.value) {\r\n\t\t\tself.showDocumentPage(dcip.value);\r\n\t\t}\r\n\t})\r\n\tdcip.addEventListener(\"keyup\", function(event) {\r\n\t\tevent.preventDefault();\r\n\t\tif (event.keyCode === 13 && dcip.value) {\r\n\t\t\tself.showDocumentPage(dcip.value);\r\n\t\t}\r\n\t});\r\n\tscd.appendChild(lab);\r\n\tscd.appendChild(dcip);\r\n\tscd.appendChild(nbut);\r\n\treturn scd;\r\n}\r\n\r\nTerminusDBViewer.prototype.getDocumentTableConfig = function(nq){\r\n\tvar self = this;\r\n\tvar rowClick = function(row){\r\n\t\tself.ui.showDocument(row['v:ID']);\r\n\t};\r\n\tvar cellClick = function(key, value){\r\n\t\tself.ui.showDocument(value);\r\n\t}\r\n\r\n\tvar opts = {\r\n\t\t//cellClick: cellClick,\r\n\t\trowClick: rowClick,\r\n\t\t\"v:ID\": {\r\n\t\t\thidden: true\r\n\t\t},\r\n\t\t\"v:Class\": {hidden: true },\r\n\t\t\"v:Type_Comment\": {hidden: true },\r\n\t\t\"v:Label\": {\r\n\t\t\theader: \"Document\",\r\n\t\t\trenderer: function(dataviewer){\r\n\t\t\t\treturn dataviewer.annotateValue(dataviewer.value(),\r\n\t\t\t\t\t{ ID: dataviewer.binding('v:ID')});\r\n\t\t\t},\r\n\t\t},\r\n\t\t\"v:Type\": {\r\n\t\t\trenderer: function(dataviewer){\r\n\t\t\t\treturn dataviewer.annotateValue(dataviewer.value(),\r\n\t\t\t\t\t\t{ Class: dataviewer.binding('v:Class'), Description: dataviewer.binding('v:Type_Comment')}\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t},\r\n\t\t\"v:Comment\": {\theader: \"Description\", renderer: \"HTMLStringViewer\", args: {max_cell_size: 40, max_word_size: 10} },\r\n\t\t\"column_order\" : [\"v:Label\", \"v:Type\", \"v:Comment\"]\r\n\t}\r\n\t//return {};\r\n\treturn opts;\r\n}\r\n\r\nTerminusDBViewer.prototype.getExplanation = function(view){\r\n\tvar d = document.createElement('div');\r\n\tvar title = view.charAt(0).toUpperCase() + view.slice(1)\r\n\td.appendChild(UTILS.getHeaderDom(title + ' View'));\r\n\tif(view == 'table')\r\n\t\tvar explaination = 'Below view shows a table view of available documents within the database';\r\n\telse var explaination = 'Below view shows a graph view of how available documents are related to other documents';\r\n\td.appendChild(document.createTextNode(explaination));\r\n\treturn d;\r\n}\r\n\r\nTerminusDBViewer.prototype.getClassesDOM = function(d){\r\n\tvar q = TerminusClient.WOQL\r\n\t\t\t\t.limit(25)\r\n\t\t\t\t.start(0)\r\n\t\t\t\t.documentMetadata();\r\n\tvar self = this;\r\n\tvar rowClick = function(row){\r\n\t\tself.ui.showDocument(row['v:ID']);\r\n\t};\r\n\tvar cellClick = function(key, value){\r\n\t\tself.ui.showDocument(value);\r\n\t}\r\n\r\n\tvar showLabel = function(value, key, row){\r\n\t\tif(value) return document.createTextNode(value['@value'] + \" aa\");\r\n\t\treturn document.createElement(\"span\");\r\n\t}\r\n\tlet nq = new TerminusHTMLViewer(this.ui.client);//should specify default renderers here....\r\n\tlet WOQL = TerminusClient.WOQL;\r\n\tlet query = WOQL.from(this.ui.client.connectionConfig.dbURL()).limit(25).start(0).documentMetadata();\r\n\t//TerminusClient.FrameHelper.loadDynamicCSS(\"myfa\", \"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0-11/css/all.css\");\r\n\tquery.execute(this.ui.client).then((results) => {\r\n\t\tlet qres = new TerminusClient.WOQLResult(results, query);\r\n\t\tvar nt = nq.showResult(qres, WOQL.table(), false);\r\n\t\td.appendChild(this.getExplanation('table'));\r\n\t\td.appendChild(nt);\r\n\t\t/*qres.first()\r\n\t\tvar n = nq.showResult(qres, WOQL.chooser());\r\n\t\td.appendChild(n); */\r\n\t\tqres.first();\r\n\t\tvar lg = WOQL.graph();\r\n\t\tlg.source(\"v:Subject\");\r\n\t\tvar licon2 = { color: [255,255,25], weight: 100, unicode: \"\\uf2bb\", size:2 };\r\n\t\tlg.edge(\"v:Subject\", \"v:Object\").icon(licon2);\r\n\t\tvar ng = nq.showResult(qres, lg, false);\r\n\t\td.appendChild(this.getExplanation('graph'));\r\n\t\td.appendChild(ng);\r\n\t\tqres.first();\r\n\t\t//var sg = nq.showResult(qres, WOQL.stream());\r\n\t\t//d.appendChild(sg);\r\n\t\t//d.appendChild(nc);\r\n\t\t//var ng = nq.displayResults(false, WOQL.graph());\r\n\t\t//d.appendChild(ng);\r\n\t\t/*let t = WOQL.table().pager(false);\r\n\t\tt.column(\"Class\", \"Type_Comment\", \"ID\").hidden(true);\r\n\t\tt.column(\"Label\").header(\"Document\");\r\n\t\tt.column(\"Comment\").header(\"Description\");\r\n\t\tt.column(\"Comment\").renderer(\"HTMLStringViewer\").args({max_cell_size: 20, max_word_size: 10});\r\n\t\t//t.column_order(\"Subject\", \"Predicate\", \"Object\");\r\n\t\tt.column(\"Label\").render(showLabel);\r\n\t\tt.row().click(rowClick);\r\n\t\tqres.first();\r\n\t\tvar dt2 = nq.showResult(qres, t);\r\n\t\td.appendChild(dt2);\r\n\r\n\t\tqres.first();\r\n\t\tvar w = WOQL.chooser().values(\"ID\").labels(\"Comment\").titles(\"Class\").sort(\"Comment\").direction(\"asc\");\r\n\t\tw.change(function(x){\r\n\t\t\talert(x);\r\n\t\t}).show_empty(\"Choose something\");\r\n\t\tvar n2 = nq.showResult(qres, w);\r\n\t\td.appendChild(n2);\r\n\t\tvar licon2 = { color: [255,255,25], weight: 100, unicode: \"\\uf2bb\", size:2 };\r\n\t\tvar licon = { color: [255,255,255], weight: 100, unicode: \"\\uf1c2\"};\r\n\t\tvar licon3 = { color: [23,3,34], weight: 100, unicode: \"\\uf1c2\"};\r\n\t\tvar lborder = { color: [10,255,0], weight: 100, unicode: \"\\uf2bb\", size:2 };\r\n\t\tvar g = WOQL.graph();\r\n\t\tg.source(\"ID\").width(\"1000\").height(1000);//.literals(false);\r\n\t\t//g.node(\"Id\").size(20).color([220, 202, 230]).collisionRadius(100).icon(licon3);\r\n\t\tg.node(\"Object\").size(24).color([20, 20, 20]).icon(licon2);\r\n\t\tg.node().literal(true).color([200, 200, 220]).size(10).icon(licon);\r\n\t\tg.node(\"Predicate\").hidden(true);\r\n\t\t//var e = g.rule().edge(\"ID\", \"Class\").label(x).icon(y).color();\r\n\t\t//var n = g.rule().node(\"ID\").label(x).icon(y).color();\r\n\t\tg.edges([\"Subject\", \"Object\"]);\r\n\t\tg.edge().color([150, 200, 250]);\r\n\t\tqres.first()\r\n\t\tvar ng3 = nq.showResult(qres, g);\r\n\t\td.appendChild(ng3);*/\r\n\t\t/*var x = \"doc:access_all_areas\";\r\n\t\tvar nd = WOQL.document();\r\n\t\tnd.show_all(\"SimpleFrameViewer\");\r\n\t\tnd.object().features(\"id\", \"type\", \"comment\", \"delete\", \"reset\", \"hide\", \"show\", \"clone\", \"update\", \"view\", \"add\", \"value\");//\"summary\", \"viewer\", \"status\",\r\n\t\tnd.property().features(\"value\");//features(\"id\", \"cardinality\", \"type\", \"comment\", \"delete\", \"reset\", \"hide\", \"show\", \"clone\", \"update\", \"view\", \"add\", \"value\");//\"summary\", \"status\",\r\n\t\tnd.data().features(\"value\");//.dataviewer(\"HTMLStringViewer\").args({max_cell_size: 20, max_word_size: 10});\r\n\t\tvar d1 = nq.document(x, nd);\r\n\t\td.appendChild(d1); */\r\n\t});\r\n\t//let c = WOQL.chooser();\r\n\r\n\t//t.display(query);\r\n\t//t.column(\"Label\").header(\"Document\").render(showLabel).click(cellClick);\r\n\t//t.column(\"ID\").header(\"l\").renderer(\"MyRenderer\");\r\n\t//should specify default renderers here....\r\n\t//var qp = nq.querypane(woql, this.getDocumentTableConfig());\r\n\r\n\t//let nquery = WOQL.from(this.ui.client.connectionConfig.dbURL()).limit(1000).simpleGraphQuery();\r\n\t//let g = WOQL.graph();\r\n\t//g.edge(\"v:Source\", \"v:Edge\", \"v:Target\").label(\"bla\").color([23,23,45]).weight(\"v:Account\")\r\n\t//t.column(\"Class\", \"Type_Comment\", \"ID\").hidden(true);\r\n\t//t.column(\"Label\").header(\"Document\").render(showLabel).click(cellClick);\r\n\t//t.column(\"Comment\").header(\"Description\").renderer(\"HTMLStringViewer\").args({max_cell_size: 20, max_word_size: 10});\r\n\t//t.column(\"ID\").header(\"l\").renderer(\"MyRenderer\");\r\n\t//t.order(\"Label\", \"Type\", \"Comment\");\r\n\t//var ng = nq.displayResults(nquery, g);\r\n\t//d.appendChild(ng);\r\n\r\n\r\n\treturn d;\r\n\t/*var q = this.wquery.getClassesQuery(25, 0);\r\n\tvar self = this;\r\n\t//this.wquery.execute(q)\r\n\tq.execute(this.ui.client)\r\n\t.then(function(result){\r\n\t\tvar wqRes = new TerminusClient.WOQLResult(result, q);\r\n\t\tself.result = new WOQLResultsViewer.WOQLResultsViewer(self.ui, result, wqRes, {}, {}, false);\r\n\t\tif(self.result){\r\n\t\t\tvar nd = self.result.getAsDOM(d, false);\r\n\t\t\tif(nd){\r\n\t\t\t\tnd.setAttribute('class', 'terminus-margin-box');\r\n\t        }\r\n\t\t\telse{\r\n\t\t\t\tnor = document.createElement('div');\r\n\t\t\t\tnor.setAttribute('class', 'terminus-no-res-alert');\r\n\t\t\t\tnor.appendChild(document.createTextNode(\"No results available, create new ones to view them here...\"));\r\n\t\t\t\td.appendChild(nor);\r\n\t\t\t}\r\n\t\t}\r\n\t})\r\n\t.catch(function(err){\r\n\t\tconsole.error(err);\r\n\t\tself.ui.showError(err);\r\n\t});\r\n\treturn d;*/\r\n}\r\n\r\n/**\r\n * Class Representing the create Database form\r\n * @param {TerminusUI} ui\r\n */\r\nfunction TerminusDBCreator(ui){\r\n\tthis.ui = ui;\r\n}\r\n\r\nTerminusDBCreator.prototype.getAsDOM = function(selected){\r\n\tvar scd = document.createElement(\"div\");\r\n\tscd.setAttribute(\"class\", \"terminus-db-creator\");\r\n\tvar sct = document.createElement(\"h3\");\r\n\tsct.setAttribute(\"class\", \"terminus-db-creator-title terminus-module-head\");\r\n\tsct.appendChild(UTILS.getHeaderDom(\"Create Database\"));\r\n\tscd.appendChild(sct);\r\n\tvar mfd = document.createElement('div');\r\n\tmfd.setAttribute('class', 'terminus-form-border ');\r\n\tscd.appendChild(mfd);\r\n\tvar dht = document.createElement('div');\r\n\tdht.setAttribute('class', 'terminus-form-margin-top');\r\n\tmfd.appendChild(dht);\r\n\tvar sci = document.createElement(\"div\");\r\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-form-field-spacing terminus-form-horizontal terminus-control-group\");\r\n\tvar slab = document.createElement(\"span\");\r\n\tslab.setAttribute(\"class\", \"terminus-id-label terminus-form-label terminus-control-label\");\r\n\tslab.appendChild(document.createTextNode(\"ID\"));\r\n\tsci.appendChild(slab);\r\n\tvar idip = document.createElement(\"input\");\r\n\tidip.setAttribute(\"type\", \"text\");\r\n\tidip.setAttribute(\"class\", \"terminus-form-value terminus-input-text\");\r\n\tidip.setAttribute(\"placeholder\", \"No spaces or special characters allowed in IDs\");\r\n\tsci.appendChild(idip);\r\n\tmfd.appendChild(sci);\r\n\tvar sci = document.createElement(\"div\");\r\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-form-field-spacing terminus-form-horizontal terminus-control-group\");\r\n\tvar slab = document.createElement(\"span\");\r\n\tslab.setAttribute(\"class\", \"terminus-title-label terminus-form-label terminus-control-label\");\r\n\tslab.appendChild(document.createTextNode(\"Title\"));\r\n\tvar titip = document.createElement(\"input\");\r\n\ttitip.setAttribute(\"type\", \"text\");\r\n\ttitip.setAttribute(\"placeholder\", \"A brief title for the Database\");\r\n\ttitip.setAttribute(\"class\", \"terminus-form-value terminus-input-text\");\r\n\tsci.appendChild(slab);\r\n\tsci.appendChild(titip);\r\n\tmfd.appendChild(sci);\r\n\tvar sci = document.createElement(\"div\");\r\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-form-field-spacing terminus-form-horizontal terminus-control-group\");\r\n\tvar slab = document.createElement(\"span\");\r\n\tslab.setAttribute(\"class\", \"terminus-title-label terminus-form-label terminus-control-label\");\r\n\tslab.appendChild(document.createTextNode(\"Description\"));\r\n\tsci.appendChild(slab);\r\n\tvar descip = document.createElement(\"textarea\");\r\n\tdescip.setAttribute(\"class\", \"terminus-textarea terminus-db-description terminus-textarea \");\r\n\tdescip.setAttribute(\"placeholder\", \"A short text describing the database and its purpose\");\r\n\tsci.appendChild(descip);\r\n\tmfd.appendChild(sci);\r\n\tvar sci = document.createElement(\"div\");\r\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-form-field-spacing terminus-form-horizontal terminus-control-group\");\r\n\tvar slab = document.createElement(\"span\");\r\n\tslab.setAttribute(\"class\", \"terminus-schema-label terminus-form-label terminus-control-label\");\r\n\tslab.appendChild(document.createTextNode(\"Import Schema\"));\r\n\tsci.appendChild(slab);\r\n\tvar schem = document.createElement(\"input\");\r\n\tschem.setAttribute(\"placeholder\", \"Terminus DB URL\");\r\n\tschem.setAttribute(\"type\", \"text\");\r\n\tschem.setAttribute(\"class\", \"terminus-form-value terminus-form-url terminus-input-text\");\r\n\tsci.appendChild(schem);\r\n\tmfd.appendChild(sci);\r\n\r\n\tvar sci = document.createElement(\"div\");\r\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-form-field-spacing terminus-form-horizontal terminus-control-group\");\r\n\tvar slab = document.createElement(\"span\");\r\n\tslab.setAttribute(\"class\", \"terminus-schema-label terminus-form-label terminus-control-label\");\r\n\tslab.appendChild(document.createTextNode(\"Key\"));\r\n\tsci.appendChild(slab);\r\n\tvar kip = document.createElement(\"input\");\r\n\tkip.setAttribute(\"placeholder\", \"Server API Key\");\r\n\tkip.setAttribute(\"type\", \"text\");\r\n\tkip.setAttribute(\"class\", \"terminus-form-value terminus-form-url terminus-input-text\");\r\n\tsci.appendChild(kip);\r\n\tmfd.appendChild(sci);\r\n\r\n\tvar sci = document.createElement(\"div\");\r\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-form-field-spacing terminus-form-horizontal terminus-control-group\");\r\n\tvar slab = document.createElement(\"span\");\r\n\tslab.setAttribute(\"class\", \"terminus-data-label terminus-form-label terminus-control-label\");\r\n\tslab.appendChild(document.createTextNode(\"Import Data\"));\r\n\tsci.appendChild(slab);\r\n\tvar datip = document.createElement(\"input\");\r\n\tdatip.setAttribute(\"type\", \"text\");\r\n\tdatip.setAttribute(\"placeholder\", \"Terminus DB URL\");\r\n\tdatip.setAttribute(\"class\", \"terminus-form-value terminus-form-url terminus-input-text\");\r\n\tsci.appendChild(datip);\r\n\t//mfd.appendChild(sci);\r\n\tvar butfield = document.createElement(\"div\");\r\n\tbutfield.setAttribute(\"class\", \"terminus-control-buttons\");\r\n\tvar cancbut = document.createElement(\"button\");\r\n\tcancbut.setAttribute(\"class\", \"terminus-control-button terminus-cancel-db-button terminus-btn terminus-btn-float-right\");\r\n\tcancbut.appendChild(document.createTextNode(\"Cancel\"));\r\n\tvar loadbut = document.createElement(\"button\");\r\n\tloadbut.setAttribute(\"class\", \"terminus-control-button terminus-create-db-button terminus-btn terminus-btn-float-right\");\r\n\tloadbut.appendChild(document.createTextNode(\"Create\"));\r\n\tvar self = this;\r\n\tvar gatherips = function(){\r\n\t\tvar input = {};\r\n\t\tinput.id = idip.value;\r\n\t\tinput.title = titip.value;\r\n\t\tinput.description = descip.value;\r\n\t\tinput.schema = schem.value;\r\n\t\tinput.key = kip.value;\r\n\t\tinput.data = datip.value;\r\n\t\treturn input;\r\n\t}\r\n\tvar self = this;\r\n\tloadbut.addEventListener(\"click\", function(){\r\n\t\tvar input = gatherips();\r\n\t\tself.ui.createDatabase(input);\r\n\t})\r\n\tcancbut.addEventListener(\"click\", function(){\r\n\t\tself.ui.showServerMainPage();\r\n\t})\r\n\tbutfield.appendChild(cancbut);\r\n\tbutfield.appendChild(loadbut);\r\n\tmfd.appendChild(butfield);\r\n\r\n\treturn scd;\r\n}\r\n\r\nmodule.exports={TerminusDBViewer:TerminusDBViewer,\r\n\t            TerminusDBController:TerminusDBController,\r\n\t            TerminusDBCreator:TerminusDBCreator}\r\n","const TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction WOQLQueryView(client){\r\n\tthis.client = client;\r\n}\r\n\r\nWOQLQueryView.prototype.options = function(options){\r\n\tthis.options = options;\r\n\treturn this;\r\n}\r\n\r\nWOQLQueryView.prototype.setQuery = function(query){\r\n\tthis.query = query;\r\n\treturn this;\r\n}\r\n\r\nWOQLQueryView.prototype.setRenderer = function(rend){\r\n\tthis.renderer = rend;\r\n\treturn this;\r\n}\r\n\r\nWOQLQueryView.prototype.render = function(){\r\n\tif(this.renderer){\r\n\t\tif(this.query){\r\n\t\t\tthis.renderer.set(this.query);\r\n\t\t}\r\n\t\treturn this.renderer.render(this);\r\n\t}\r\n}\r\n\r\n//parses a string encoding a woql in either json or js notation\r\nWOQLQueryView.prototype.parseText = function(text, format){\r\n\ttry {\r\n\t\tvar WOQL = TerminusClient.WOQL;\r\n\t\tif(format == \"json\"){\r\n\t\t\tvar qval = JSON.parse(text);\r\n\t\t\treturn WOQL.json(qval);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tvar nw = eval(\"WOQL.\" + text);\r\n\t\t\treturn nw;\r\n\t\t}\r\n\t}\r\n\tcatch(e){\r\n\t\tthis.error(\"Failed to parse Query \" + e.toString());\r\n\t}\r\n}\r\n\r\nWOQLQueryView.prototype.submitQuery = function(qObj){\r\n\r\n}\r\n\r\nWOQLQueryView.prototype.error = function(msg){\r\n\tconsole.log(msg);\r\n}\r\n\r\nWOQLQueryView.prototype.serialise = function(query, format){\r\n\tif(format == \"json\"){\r\n\t\treturn JSON.stringify(query.json(), 0, 2);\r\n\t}\r\n\telse {\r\n\t\treturn query.prettyPrint(4);\r\n\t}\r\n}\r\n\r\nmodule.exports = WOQLQueryView;\r\n","const TerminusCodeSnippet = require('./query/TerminusCodeSnippet');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\nconst Datatypes = require(\"./Datatypes\");\r\nconst SimpleTable = require(\"./table/SimpleTable\");\r\nconst SimpleGraph = require(\"./graph/SimpleGraph\");\r\nconst SimpleStream = require(\"./stream/SimpleStream\");\r\nconst SimpleChooser = require(\"./chooser/SimpleChooser\");\r\n\r\n/**\r\n * Result Pane is defined by a WOQL configuration object\r\n * Visually it consists of a single rule editor (showing the current state of the configuration object) which may be collapsed behind a configuration link\r\n * and a single result view which shows the result of the rule when applied to the current results.\r\n *\r\n */\r\nfunction ResultPane(client, querypane, config){\r\n    this.client = client;\r\n    this.qp = querypane;\r\n    this.config = config;\r\n\tthis.container = document.createElement('span');\r\n    this.container.setAttribute('class', 'terminus-result-pane');\r\n}\r\n\r\nResultPane.prototype.options = function(opts){\r\n\tthis.showConfig = (opts && typeof opts.showConfig != \"undefined\" ? opts.showConfig : false);\r\n    this.editConfig = (opts && typeof opts.editConfig != \"undefined\" ? opts.editConfig : false);\r\n    this.changeViewType = (opts && typeof opts.changeViewType != \"undefined\" ? opts.changeViewType : true);\r\n    this.intro = (opts && typeof opts.intro != \"undefined\" ? opts.intro : false);\r\n    this.renderers =  (opts && opts.renderers ? opts.renderers : {\r\n\t\ttable: new SimpleTable(),\r\n\t\tgraph: new SimpleGraph(),\r\n\t\tstream: new SimpleStream(),\r\n\t\tchooser: new SimpleChooser()\r\n    });\r\n    if(this.config){\r\n        this.viewers = [this.config];\r\n    }\r\n    this.viewers =  (opts && typeof opts.viewers != \"undefined\" ? this.viewers.concat(opts.viewers) : this.viewers);\r\n    this.currentViewer = 0;\r\n    return this;\r\n}\r\n\r\nResultPane.prototype.getAsDOM = function(){\r\n    if(this.intro){\r\n        var di = (typeof this.intro == \"string\" ? document.createTextNode(this.intro) : this.intro);\r\n\t\tthis.container.appendChild(di);\r\n\t}\r\n    var configspan = document.createElement(\"span\");\r\n    configspan.setAttribute(\"class\", \"pane-config-icons\");\r\n    this.container.appendChild(configspan);\r\n\tthis.resultDOM = document.createElement('span');\r\n\tthis.resultDOM.setAttribute('class', 'terminus-result-view');\r\n\tif(this.result){\r\n\t\tthis.resultDOM.appendChild(this.getResultDOM());\r\n\t}\r\n\tthis.container.appendChild(this.resultDOM);\r\n\tif(this.showConfig){\r\n        this.showingQuery = (this.showConfig != \"icon\");\r\n\t\tvar mode = (this.editConfig ? \"edit\" : \"view\");\r\n\t\tthis.input = this.createInput(mode);\r\n\t\tvar ipdom = this.input.getAsDOM();\r\n        var ispan = document.createElement(\"span\");\r\n        ispan.addEventListener('mouseover', function(){\r\n            this.style.cursor = \"pointer\";\r\n\t\t});\r\n\t\tispan.setAttribute(\"class\", \"result-pane-config\");\r\n\t\tvar ic = document.createElement(\"i\");\r\n\t\tispan.appendChild(ic);\r\n\t\tconfigspan.appendChild(ispan);\r\n\t\tvar self = this;\r\n\t\tfunction showQueryConfig(){\r\n\t\t\tconfigspan.title=\"Click to Hide View Configuration\";\r\n\t\t\tic.setAttribute(\"class\", \"fas fa fa-times-circle\");\r\n            if(configspan.nextSibling){\r\n                self.container.insertBefore(ipdom, configspan.nextSibling);\r\n                if(self.input.snippet.value)\r\n\t\t\t\t\tself.input.stylizeSnippet();\r\n            }\r\n            else{\r\n                self.container.appendChild(ipdom);\r\n                if(self.input.snippet.value)\r\n\t\t\t\t\tself.input.stylizeSnippet();\r\n            }\r\n\t\t}\r\n\t\tfunction hideQueryConfig(){\r\n\t\t\tconfigspan.title=\"Click to View Configuration\";\r\n            ic.setAttribute(\"class\", \"terminus-result-icons terminus-result-view-icon \" + self.getViewConfigIconClass());\r\n\t\t\tself.container.removeChild(ipdom);\r\n\t\t}\r\n\t\tispan.addEventListener(\"click\", () => {\r\n\t\t\tif(this.showingQuery) hideQueryConfig();\r\n\t\t\telse showQueryConfig();\r\n\t\t\tthis.showingQuery = !this.showingQuery;\r\n        });\r\n        showQueryConfig();\r\n\t\tif(this.showConfig == \"icon\") hideQueryConfig();\r\n    }\r\n    if(this.changeViewType){\r\n        cvicons = this.getViewTypeIconDOM(ipdom);\r\n        if(cvicons) configspan.prepend(cvicons);\r\n    }\r\n\treturn this.container;\r\n}\r\n\r\nResultPane.prototype.getViewConfigIconClass = function(){\r\n    if(this.changeViewType && this.viewers.length > 1){\r\n        return \"fas fa fa-vial\";\r\n    }\r\n    if(this.viewers[this.currentViewer].icon){\r\n        return this.viewers[this.currentViewer].icon;\r\n    }\r\n    var def = this.getDefaultViewerIcon(this.viewers[this.currentViewer]);\r\n    return def.icon;\r\n}\r\n\r\n\r\nResultPane.prototype.getViewTypeIconDOM = function(sp, ipdom){\r\n    var bsp = document.createElement('span');\r\n    bsp.setAttribute('class', 'terminus-result-icons');\r\n    if(this.viewers.length > 1){\r\n        for(var i = 0; i<this.viewers.length; i++){\r\n            var isp = this.getIconForViewer(this.viewers[i], i, bsp);\r\n            bsp.appendChild(isp);\r\n        }\r\n    }\r\n    return bsp;\r\n}\r\n\r\nResultPane.prototype.changeViewerType = function(viewer, index){\r\n    this.currentViewer = index;\r\n    this.config = viewer;\r\n    this.input.setQuery(viewer);\r\n    this.input.submit(this.input.qObj);\r\n}\r\n\r\n\r\nResultPane.prototype.getDefaultViewerIcon = function(viewer){\r\n    var view_types = {\r\n        table: {label: \"Table\", icon: \"fa fa-table\"},\r\n\t\tgraph: {label: \"Graph\", icon: \"fas fa-code-branch\"},\r\n\t\tchooser: {label: \"Drop-down List\", icon: \"fas fa-caret-down\"},\r\n\t\tstream: {label: \"Result Stream\", icon: \"fa fa-list\"}\r\n    }\r\n    return view_types[viewer.type];\r\n}\r\n\r\n\r\nResultPane.prototype.getIconForViewer = function(viewer, index, container){\r\n    var isp = document.createElement('span');\r\n    var icon = document.createElement(\"i\");\r\n    var def = this.getDefaultViewerIcon(viewer);\r\n    icon.title = (viewer.label) ? viewer.label : def.label;\r\n    var ic = (viewer.icon ? viewer.icon : def.icon);\r\n    icon.setAttribute(\"class\", ic);\r\n    icon.classList.add('terminus-result-view-icon');\r\n    //icon.classList.add('circle-icon');\r\n    isp.appendChild(icon);\r\n    if(this.currentViewer == index){\r\n        isp.setAttribute(\"class\", \"result-icon-selected selected terminus-result-selected\");\r\n        icon.classList.add('terminus-view-selected');\r\n    }\r\n    else {\r\n        isp.setAttribute(\"class\", \"result-icon-selectable selectable\");\r\n        isp.addEventListener('mouseover', function(){\r\n            this.style.cursor = \"pointer\";\r\n\t\t});\r\n    }\r\n    isp.addEventListener(\"click\", () => {\r\n        this.changeViewerType(viewer, index);\r\n        TerminusClient.FrameHelper.removeChildren(container);\r\n        for(var i = 0; i<this.viewers.length; i++){\r\n            var isp = this.getIconForViewer(this.viewers[i], i, container);\r\n            container.appendChild(isp);\r\n        }\r\n    });\r\n    return isp;\r\n}\r\n\r\nResultPane.prototype.createInput = function(mode){\r\n    let input = new TerminusCodeSnippet(\"rule\", mode);\r\n    if(this.config){\r\n    \tinput.setQuery(this.config);\r\n\t}\r\n\tvar self = this;\r\n\tinput.submit = function(config){\r\n\t\tself.updateView(config);\r\n\t};\r\n\treturn input;\r\n}\r\n\r\nResultPane.prototype.setResult = function(wres){\r\n\tthis.result = wres;\r\n}\r\n\r\nResultPane.prototype.updateResult = function(wres){\r\n\tthis.result = wres;\r\n\tTerminusClient.FrameHelper.removeChildren(this.resultDOM);\r\n\tthis.resultDOM.appendChild(this.getResultDOM());\r\n}\r\n\r\nResultPane.prototype.updateView = function(config){\r\n\tthis.config = config;\r\n\tTerminusClient.FrameHelper.removeChildren(this.resultDOM);\r\n\tif(this.result){\r\n\t\tthis.resultDOM.appendChild(this.getResultDOM());\r\n\t}\r\n}\r\n\r\nResultPane.prototype.getResultDOM = function(){\r\n\tlet span = document.createElement(\"span\");\r\n\tspan.setAttribute(\"class\", \"terminus-query-results\");\r\n    let viewer = this.config.create(this.client, this.renderers, Datatypes.initialiseDataRenderers);\r\n    var self = this;\r\n    viewer.notify = function(r){\r\n        self.qp.updateResult(r);\r\n    }\r\n\tthis.result.first();\r\n\tviewer.setResult(this.result);\r\n\tspan.appendChild(viewer.render());\r\n\treturn span;\r\n}\r\n\r\nmodule.exports = ResultPane;\r\n","const TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction HTMLStringEditor(options){\r\n\tthis.css = ((options && options.css) ? \"terminus-literal-value \" + options.css : \"terminus-literal-value\");\r\n\tthis.options = options; \r\n}\r\n\r\nHTMLStringEditor.prototype.renderFrame = function(frame, dataviewer){\r\n\tvar value = frame.get();\r\n\tvar big = ((this.options && typeof this.options.big != \"undefined\") ? this.options.big : this.isBigType(this.type, value));\r\n\tif(big){\r\n\t\tvar input = document.createElement(\"textarea\");\r\n\t\tthis.css += \" terminus-literal-big-value\";\t\t\r\n\t}\r\n\telse {\r\n\t\tvar size = ((this.options && typeof this.options.size != \"undefined\") ? this.options.size : this.getTypeSize(this.type, value));\r\n\t\tvar input = document.createElement(\"input\");\r\n\t\tinput.setAttribute('type', \"text\");\r\n\t\tinput.setAttribute('size', size);\r\n\t}\r\n\tinput.setAttribute('class', this.css);\r\n\tinput.setAttribute(\"data-value\", value);\r\n\t\r\n\tinput.value = value;\r\n\tvar self = this;\r\n\tinput.addEventListener(\"input\", function(){\r\n\t\tframe.set(this.value);\r\n\t});\r\n\treturn input;\r\n}\r\n\r\nHTMLStringEditor.prototype.isBigType = function(ty, value){\r\n\tif(value && value.length && value.length > 100) return true;\r\n\tvar longs = [\"xdd:coordinatePolyline\", \"xdd:coordinatePolygon\", \"xsd:base64Binary\", \"xdd:html\", \"xdd:json\", \"rdf:XMLLiteral\"];\r\n\tif(longs.indexOf(ty) == -1) return false;\r\n\treturn true;\r\n}\r\n\r\nHTMLStringEditor.prototype.getTypeSize = function(ty, value){\r\n\tif(value && value.length && value.length > 40) return 80;\r\n\tvar bigs = [\"xdd:url\", \"xdd:coordinate\", \"xsd:anyURI\"];\r\n\tvar smalls = [\"xsd:gYearMonth\", \"xdd:gYearRange\", \"xsd:decimal\", \"xsd:float\", \"xsd:time\", \"xsd:date\", \r\n\t\t\"xsd:dateTimeStamp\",\"xsd:gYearMonth\", \"xsd:gMonthDay\", \"xsd:duration\", \"xsd:yearMonthDuration\", \"xsd:dayTimeDuration\", \r\n\t\t\"xsd:nonNegativeInteger\", \"xsd:positiveInteger\", \"xsd:negativeInteger\",\t\"xsd:nonPositiveInteger\", \"xsd:integer\",\"xsd:unsignedInt\"];\r\n\tvar tinys = [\"xsd:boolean\", \"xsd:gYear\", \"xsd:gMonth\", \"xsd:gDay\", \"xsd:byte\", \"xsd:short\", \"xsd:unsignedByte\", \"xsd:language\"];\r\n\tif(bigs.indexOf(ty) != -1) return 80;\r\n\tif(smalls.indexOf(ty) != -1) return 16;\r\n\tif(tinys.indexOf(ty) != -1) return 8;\r\n\treturn 32;\r\n}\r\n\r\nmodule.exports={HTMLStringEditor}\r\n\r\n\r\n","function HTMLBooleanViewer(options){\r\n\tthis.css = \"terminus-literal-value terminus-literal-value-boolean \" + ((options && options.css) ?  options.css : \"\");\r\n}\r\n\r\nHTMLBooleanViewer.prototype.renderFrame = function(frame, dataviewer){\r\n\treturn this.render(frame.get());\r\n}\r\n\r\nHTMLBooleanViewer.prototype.renderValue = function(dataviewer){\r\n\treturn this.render(dataviewer.value());\t\r\n}\r\n\r\nHTMLBooleanViewer.prototype.render = function(value){\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', this.css);\r\n\tif(value){\r\n\t\tvar vallab = document.createTextNode(value);\r\n\t\tinput.appendChild(vallab);\r\n\t}\r\n\treturn input;\r\n}\r\n\r\n\r\nmodule.exports={HTMLBooleanViewer}\r\n\r\n","function HTMLBooleanEditor(options){\r\n\tthis.css = \"terminus-literal-value terminus-literal-value-range \" + ((options && options.css) ?  options.css : \"\");\r\n}\r\n\r\nHTMLBooleanEditor.prototype.renderFrame = function(frame, dataviewer){\r\n\tvar value = frame.get();\r\n\tvar input = document.createElement(\"input\");\r\n\tinput.setAttribute('type', \"checkbox\");\r\n\tif(value){\r\n\t\tinput.setAttribute(\"checked\", \"checked\");\t\t\t\t\t\r\n\t}\r\n\tinput.addEventListener(\"change\", function(){\r\n\t\tif(value){\r\n\t\t\tframe.set(\"\");\r\n\t\t}\r\n\t\telse {\r\n\t\t\tframe.set(\"true\");\r\n\t\t}\r\n\t});\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={HTMLBooleanEditor}\r\n\r\n","const TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction HTMLChoiceViewer(options){};\r\n\r\nHTMLChoiceViewer.prototype.renderFrame = function(frame, dataviewer){\r\n\tvar value = frame.get();\r\n\tif(frame.frame && frame.frame.elements){\r\n\t\tthis.elements = frame.frame.elements;\r\n\t}\r\n\treturn this.render(value);\r\n}\r\n\r\nHTMLChoiceViewer.prototype.renderValue = function(dataviewer){\r\n\treturn this.render(dataviewer.value());\r\n}\r\n\r\nHTMLChoiceViewer.prototype.render = function(value){\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', \"terminus-literal-value terminus-choice-value\");\r\n\tinput.setAttribute('data-value', value);\r\n\tvar lab = false;\r\n\tif(value && this.elements){\r\n\t\tfor(var i = 0; i<this.elements.length; i++){\r\n\t\t\tvar elt = this.elements[i];\r\n\t\t\tif(elt.class == value){\r\n\t\t\t\tif(elt.label && elt.label[\"@value\"]){\r\n\t\t\t\t\tlab = elt.label[\"@value\"];\r\n\t\t\t\t}\r\n\t\t\t\tcontinue;\r\n\t\t\t}\t\t\t\t\r\n\t\t}\r\n\t}\r\n\tif(value && !lab){\r\n\t\tlab = TerminusClient.FrameHelper.labelFromURL(value);\t\t\t\t\t\r\n\t}\r\n\tif(lab){\r\n\t\tinput.appendChild(document.createTextNode(lab));\t\t\r\n\t}\r\n\treturn input\r\n}\r\n\r\nmodule.exports={HTMLChoiceViewer}\r\n\r\n\r\n","const HTMLFrameHelper = require('../HTMLFrameHelper');\r\n\r\nfunction HTMLChoiceEditor(options){};\r\n\r\nHTMLChoiceEditor.prototype.renderFrame = function(frame, dataviewer){\r\n\tvar value = frame.get();\r\n\tvar optInput = document.createElement(\"select\");\r\n\toptInput.setAttribute('class', \"terminus-choice-picker\");\r\n\tvar foptions = frame.getChoiceOptions();\r\n\tfoptions.unshift({ value: \"\", label: \"Not Specified\"});\r\n\tvar callback = function(val){\r\n\t\tframe.set(val);\r\n\t}\r\n\tvar sel = HTMLFrameHelper.getSelectionControl(\"select-choice\", foptions, value, callback);\r\n\treturn sel;\r\n}\r\n\r\nmodule.exports={HTMLChoiceEditor}\r\n\r\n","const TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction HTMLCoordinateViewer(options){\r\n\tthis.inputs = [];\r\n}\r\n\r\nHTMLCoordinateViewer.prototype.parseValue = function(value){\r\n\ttry {\r\n\t\tvar parsed = (value ? JSON.parse(value) : false);\r\n\t\tif(parsed && this.type == \"xdd:coordinate\"){\r\n\t\t\tparsed = [parsed];\r\n\t\t}\r\n\t\treturn parsed;\r\n\t}\r\n\tcatch(e){\r\n\t\tthis.error = this.type + \" value \" + value + \" failed to parse as json\", e.toString();\r\n\t\treturn [];\r\n\t}\r\n}\r\n\r\n\r\nHTMLCoordinateViewer.prototype.renderFrame = function(frame, dataviewer){\r\n\treturn this.render(frame.get());\r\n}\r\n\r\nHTMLCoordinateViewer.prototype.renderValue = function(dataviewer){\r\n\treturn this.render(dataviewer.value());\r\n}\r\n\r\nHTMLCoordinateViewer.prototype.render = function(value){ \r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', \"terminus-literal-value terminus-literal-coordinate\");\r\n\tif(value){\r\n\t\tinput.setAttribute('data-value', value);\t\t\r\n\t\tvar parsed = this.parseValue(value);\r\n\t\tif(parsed){\r\n\t\t\tfor(var i = 0; i < parsed.length; i++){\r\n\t\t\t\tvar lldom = document.createElement(\"span\");\r\n\t\t\t\tlldom.setAttribute(\"class\", \"latlong\");\r\n\t\t\t\tlldom.appendChild(document.createTextNode(\"Latitude: \"));\r\n\t\t\t\tlldom.appendChild(document.createTextNode(parsed[i][0] + \" °\" + \" \"));\r\n\t\t\t\tlldom.appendChild(document.createTextNode(\"Longitude: \"));\r\n\t\t\t\tlldom.appendChild(document.createTextNode(parsed[i][1] + \" °\" ));\r\n\t\t\t\tinput.appendChild(lldom);\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tinput.setAttribute(\"title\", this.error);\r\n\t\t}\r\n\t}\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={HTMLCoordinateViewer}\r\n\r\n","function HTMLCoordinateEditor(options){\r\n\tthis.inputs = [];\r\n}\r\n\r\nHTMLCoordinateEditor.prototype.getInputDOMs = function(lat, long, change){\r\n\tvar latdom = document.createElement(\"input\");\r\n\tlatdom.setAttribute(\"type\", \"text\");\r\n\tlatdom.value = lat;\r\n\tvar longdom = document.createElement(\"input\");\r\n\tlongdom.setAttribute(\"type\", \"text\");\r\n\tlongdom.value = long;\r\n\tlatdom.addEventListener(\"change\", change);\r\n\tlongdom.addEventListener(\"change\", change);\r\n\treturn [latdom, longdom];\r\n}\r\n\r\nHTMLCoordinateEditor.prototype.getLatLongDOM = function(lat, long, ty, index, parent){\r\n\tvar lldom = document.createElement(\"span\");\r\n\tlldom.setAttribute(\"class\", \"terminus-lat-long\");\r\n\tvar firstcol = document.createElement(\"span\");\r\n\tfirstcol.setAttribute(\"class\", \"terminus-lat-long-col\");\r\n\tlldom.appendChild(firstcol);\r\n\tif(index > 2 || (ty == \"xdd:coordinatePolyline\" && index > 1)){\r\n\t\tvar delbut = document.createElement(\"button\");\r\n\t\tdelbut.setAttribute(\"class\", \"delete-coordinate\");\r\n\t\tdelbut.appendChild(document.createTextNode(\"Remove\"));\r\n\t\tdelbut.addEventListener(\"click\", function(){\r\n\t\t\tlong.value = \"\";\r\n\t\t\tlat.value = \"\";\r\n\t\t\tparent.removeChild(lldom);\r\n\t\t});\r\n\t\tfirstcol.appendChild(delbut);\r\n\t}\r\n\tlldom.appendChild(document.createTextNode(\"Latitude: \"));\r\n\tlldom.appendChild(lat);\r\n\tlldom.appendChild(document.createTextNode(\" °\" + \" \"));\r\n\tlldom.appendChild(document.createTextNode(\"  Longitude: \"));\r\n\tlldom.appendChild(long);\r\n\tlldom.appendChild(document.createTextNode(\" ° \" ));\r\n\treturn lldom;\r\n}\r\n\r\n\r\nHTMLCoordinateEditor.prototype.renderFrame = function(frame, dataviewer){\r\n\tvar value = frame.get();\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', \"terminus-literal-value terminus-literal-coordinate\");\r\n\tinput.setAttribute('data-value', value);\r\n\ttry {\r\n\t\tvar parsed = (value ? JSON.parse(value) : false);\r\n\t}\r\n\tcatch(e){\r\n\t\tthis.error = this.type + \" failed to parse as json\", e.toString();\r\n\t\tvar parsed = false;\r\n\t}\r\n\tvar self = this;\r\n\tvar updateValueFromForm = function(){\r\n\t\tvar vals = [];\r\n\t\tfor(var i = 0; i<self.inputs.length; i++){\r\n\t\t\tif(self.inputs[i][0].value && self.inputs[i][1].value){\r\n\t\t\t\tvar val = \"[\" + self.inputs[i][0].value + \",\" + self.inputs[i][1].value + \"]\";\r\n\t\t\t\tvals.push(val);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(vals.length == 0){\r\n\t\t\tframe.set(\"\");\r\n\t\t}\r\n\t\telse if(this.type == \"xdd:coordinate\"){\r\n\t\t\tframe.set(vals[0]);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tvar op = \"[\";\r\n\t\t\tfor(var i = 0; i<vals.length; i++){\r\n\t\t\t\top += vals[i];\r\n\t\t\t\tif(i+1 < vals.length) op += \",\";\r\n\t\t\t}\r\n\t\t\top += \"]\";\r\n\t\t\tframe.set(op);\r\n\t\t}\r\n\t};\r\n\tif(!parsed){\r\n\t\tif(this.type == \"xdd:coordinate\") parsed = [\"\",\"\"];\r\n\t\telse {\r\n\t\t\tparsed = [[\"\",\"\"],[\"\",\"\"]];\r\n\t\t\tif(this.type == \"xdd:coordinatePolygon\") parsed.push([\"\",\"\"]);\r\n\t\t}\r\n\t}\r\n\tif(this.type == \"xdd:coordinate\"){\r\n\t\tparsed = [parsed];\r\n\t}\r\n\tfor(var i = 0; i < parsed.length; i++){\r\n\t\tthis.inputs.push(this.getInputDOMs(parsed[i][0], parsed[i][1], updateValueFromForm))\r\n\t}\r\n\tvar lldoms = document.createElement(\"span\");\r\n\tfor(var i = 0; i < this.inputs.length; i++){\r\n\t\tvar lldom = this.getLatLongDOM(this.inputs[i][0], this.inputs[i][1], this.type, i, lldoms);\r\n\t\tlldoms.appendChild(lldom);\r\n\t}\r\n\tinput.appendChild(lldoms);\r\n\tvar self = this;\r\n\tif(this.type != \"xdd:coordinate\"){\r\n\t\tvar butspan = document.createElement(\"span\");\r\n\t\tbutspan.setAttribute(\"class\", \"terminus-add-coordinate\")\r\n\t\tvar addbut = document.createElement(\"button\");\r\n\t\taddbut.setAttribute(\"class\", \"terminus-add-coordinate\");\r\n\t\taddbut.appendChild(document.createTextNode(\"Add\"));\r\n\t\taddbut.addEventListener(\"click\", function(){\r\n\t\t\tvar ipdoms = self.getInputDOMs(\"\", \"\", updateValueFromForm);\r\n\t\t\tvar lldom = self.getLatLongDOM(ipdoms[0], ipdoms[1], this.type, self.inputs.length, lldoms);\r\n\t\t\tlldoms.appendChild(lldom);\r\n\t\t\tself.inputs.push(ipdoms);\r\n\t\t});\r\n\t\tbutspan.appendChild(addbut);\r\n\t\tinput.appendChild(butspan);\t\t\t\r\n\t}\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={HTMLCoordinateEditor}","const DateHelper = require('./DateHelper');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction HTMLDateViewer(options){\r\n\tthis.max = (options && options.max ? options.max : false);\r\n\tthis.min = (options && options.min ? options.min : false);\r\n\tthis.allowbce = (options && options.allowbce ? options.allowbce : false);\r\n\tthis.date_spacer = \"/\";\r\n\tthis.time_spacer = \":\";\r\n\tthis.datetime_separator = \", \";\r\n\tthis.helper = new DateHelper.HTMLDateHelper();\r\n}\r\n\r\nHTMLDateViewer.prototype.renderFrame = function(frame, dataviewer){\r\n\treturn this.render(frame.get());\r\n}\r\n\r\nHTMLDateViewer.prototype.renderValue = function(dataviewer){\r\n\treturn this.render(dataviewer.value());\r\n}\r\n\r\nHTMLDateViewer.prototype.render = function(value){\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', \"terminus-literal-value terminus-literal-date\");\r\n\tinput.setAttribute('data-value', value);\r\n\tif(value){\r\n\t\tvar parsed = TerminusClient.FrameHelper.parseDate(this.type, value);\r\n\t\tvar datepart = this.getDateComponentDOM(parsed);\r\n\t\tvar timepart = this.getTimeComponentDOM(parsed);\r\n\t\tif(timepart) input.appendChild(timepart);\r\n\t\tif(timepart && datepart) input.appendChild(document.createTextNode(this.datetime_separator));\r\n\t\tif(datepart) input.appendChild(datepart);\r\n\t}\r\n\treturn input;\r\n}\r\n\r\nHTMLDateViewer.prototype.getTimeComponentDOM = function(parsed, ty){\r\n\tvar hdom = (parsed.hour ? document.createElement(\"span\") : false);\r\n\tif(hdom){\r\n\t\thdom.setAttribute(\"class\", \"terminus-time-hour\");\r\n\t\thdom.appendChild(document.createTextNode(parsed.hour));\r\n\t}\r\n\tvar mdom = (typeof parsed.minute != \"undefined\" ? document.createElement(\"span\") : false);\r\n\tif(mdom){\r\n\t\tmdom.setAttribute(\"class\", \"terminus-time-minute\");\r\n\t\tvar mlab = (parsed.minute < 10 ? parsed.minute : parsed.minute);\r\n\t\tmdom.appendChild(document.createTextNode(mlab));\r\n\t}\r\n\tvar sdom = (typeof parsed.second != \"undefined\" ? document.createElement(\"span\") : false);\r\n\tif(sdom){\r\n\t\tsdom.setAttribute(\"class\", \"terminus-time-second\");\r\n\t\tvar slab = (parsed.second < 10 ? parsed.second : parsed.second);\r\n\t\tsdom.appendChild(document.createTextNode(slab));\r\n\t}\r\n\tvar tz = (parsed.timezone ? document.createElement(\"span\") : false);\r\n\tif(tz){\r\n\t\tsdom.setAttribute(\"class\", \"terminus-time-timezone\");\r\n\t\tsdom.appendChild(document.createTextNode(parsed.timezone));\r\n\t}\r\n\tif(hdom || mdom || sdom || tz){\r\n\t\tvar dadom = document.createElement(\"span\");\r\n\t\tdadom.setAttribute(\"class\", \"terminus-time-components time-\"+ty);\r\n\t\tif(hdom) dadom.appendChild(hdom); \r\n\t\tif(mdom) {\r\n\t\t\tif(hdom) dadom.appendChild(document.createTextNode(this.time_spacer));\r\n\t\t\tdadom.appendChild(mdom); \r\n\t\t}\r\n\t\tif(sdom) {\r\n\t\t\tif(mdom || hdom) dadom.appendChild(document.createTextNode(this.time_spacer));\r\n\t\t\tdadom.appendChild(sdom); \r\n\t\t}\r\n\t\tif(tz){\r\n\t\t\tdadom.appendChild(document.createTextNode(\" (Timezone: \")); \r\n\t\t\tdadom.appendChild(sdom); \r\n\t\t\tdadom.appendChild(document.createTextNode(\")\")); \t\t\t\r\n\t\t}\r\n\t\treturn dadom;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLDateViewer.prototype.getDateComponentDOM = function(parsed, ty){\r\n\tvar ydom = (parsed.year ? document.createElement(\"span\") : false);\r\n\tif(ydom){\r\n\t\tydom.setAttribute(\"class\", \"terminus-date-year\");\r\n\t\tydom.appendChild(document.createTextNode(parsed.year));\r\n\t}\r\n\tvar mdom = (parsed.month ? document.createElement(\"span\") : false);\r\n\tif(mdom){\r\n\t\tmdom.setAttribute(\"class\", \"terminus-date-month\");\r\n\t\tmdom.appendChild(document.createTextNode(this.helper.getMonthName(parsed.month)));\t\t\r\n\t}\r\n\tvar ddom = (parsed.day ? document.createElement(\"span\") : false );\r\n\tif(ddom){\r\n\t\tddom.setAttribute(\"class\", \"terminus-date-day\");\r\n\t\tddom.appendChild(document.createTextNode(parsed.day));\t\t\r\n\t}\r\n\tif(ydom || mdom || ddom){\r\n\t\tvar dadom = document.createElement(\"span\");\r\n\t\tif(ddom) dadom.appendChild(ddom); \r\n\t\tif(mdom) {\r\n\t\t\tif(ddom) dadom.appendChild(document.createTextNode(this.date_spacer));\r\n\t\t\tdadom.appendChild(mdom); \r\n\t\t}\r\n\t\tif(ydom) {\r\n\t\t\tif(mdom || ddom) dadom.appendChild(document.createTextNode(this.date_spacer));\r\n\t\t\tdadom.appendChild(ydom); \r\n\t\t}\r\n\t\treturn dadom;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nmodule.exports={HTMLDateViewer}","const DateHelper = require('./DateHelper');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction HTMLDateEditor(options){\r\n\tthis.max = (options && options.max ? options.max : false);\r\n\tthis.min = (options && options.min ? options.min : false);\r\n\tthis.allowbce = (options && options.allowbce ? options.allowbce : false);\r\n\tthis.date_spacer = \"/\";\r\n\tthis.time_spacer = \":\";\r\n\tthis.datetime_separator = \", \";\r\n\tthis.helper = new DateHelper.HTMLDateHelper();\r\n}\r\n\r\nHTMLDateEditor.prototype.renderFrame = function(frame, dataviewer){\r\n\tvar value = frame.get();\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', \"terminus-literal-value terminus-literal-date\");\r\n\tinput.setAttribute('data-value', value);\r\n\tif(value){\r\n\t\tthis.parsed = TerminusClient.FrameHelper.parseDate(this.type, value);\r\n\t}\r\n\telse this.parsed = {};\r\n\tvar datepart = this.getDateComponentDOM(this.parsed, this.type, frame);\r\n\tvar timepart = this.getTimeComponentDOM(this.parsed, this.type, frame);\r\n\tif(timepart) input.appendChild(timepart);\r\n\tif(timepart && datepart) input.appendChild(document.createTextNode(this.datetime_separator));\r\n\tif(datepart) input.appendChild(datepart);\r\n\treturn input;\r\n}\r\n\r\nHTMLDateEditor.prototype.set = function(part, val, frame, ty){\r\n\tthis.parsed[part] = val;\r\n\tvar xsd = TerminusClient.FrameHelper.xsdFromParsed(this.parsed, ty);\r\n\tif(xsd){\r\n\t\tframe.set(xsd);\r\n\t}\r\n}\r\n\r\nHTMLDateEditor.prototype.getTimeComponentDOM = function(parsed, ty, frame){\r\n\tif([\"xsd:dateTime\", \"xsd:dateTimeStamp\", \"xsd:time\"].indexOf(ty) == -1){\r\n\t\treturn false;\r\n\t}\r\n\tvar self = this;\r\n\tvar hdom = document.createElement(\"input\");\r\n\thdom.setAttribute(\"class\", \"terminus-hour-input terminus-hour-\"+ty);\r\n\thdom.setAttribute(\"size\", 2);\r\n\thdom.setAttribute(\"placeholder\", \"HH\");\r\n\thdom.value = (parsed.hour ? parsed.hour : \"\");\r\n\thdom.addEventListener(\"input\", function(){\r\n\t\tself.set(\"hour\", this.value, frame, ty);\r\n\t});\r\n\tvar mdom = document.createElement(\"input\");\r\n\tmdom.setAttribute(\"class\", \"terminus-minute-input terminus-minute-\"+ty);\r\n\tmdom.setAttribute(\"size\", 2);\r\n\tmdom.setAttribute(\"placeholder\", \"MM\");\r\n\tmdom.value = (parsed.minute ? parsed.minute: \"\");\r\n\tmdom.addEventListener(\"input\", function(){\r\n\t\tself.set(\"minute\", this.value, frame, ty);\r\n\t});\r\n\tvar sdom = document.createElement(\"input\");\r\n\tsdom.setAttribute(\"class\", \"terminus-second-input terminus-second-\"+ty);\r\n\tsdom.setAttribute(\"size\", 8);\r\n\tsdom.setAttribute(\"placeholder\", \"SS.sss...\");\r\n\tsdom.value = (parsed.second ? parsed.second: \"\");\r\n\tsdom.addEventListener(\"input\", function(){\r\n\t\tself.set(\"second\", this.value, frame, ty);\r\n\t})\r\n\tvar tdom = document.createElement(\"span\");\r\n\ttdom.appendChild(hdom);\r\n\ttdom.appendChild(document.createTextNode(this.time_spacer));\r\n\ttdom.appendChild(mdom);\r\n\ttdom.appendChild(document.createTextNode(this.time_spacer));\r\n\ttdom.appendChild(sdom);\r\n\treturn tdom;\r\n}\r\n\r\nHTMLDateEditor.prototype.getDateComponentDOM = function(parsed, ty, frame){\r\n\tvar self = this;\r\n\tif([\"xsd:date\", \"xsd:dateTime\", \"xsd:gYear\", \"xsd:gYearMonth\", \"xsd:dateTimeStamp\"].indexOf(ty) != -1){\r\n\t\tvar ydom = document.createElement(\"input\");\r\n\t\tydom.setAttribute(\"class\", \"terminus-year-input terminus-year-\"+ty);\r\n\t\tydom.setAttribute(\"size\", 6);\r\n\t\tydom.setAttribute(\"placeholder\", \"YYYY\");\r\n\t\tydom.value = (parsed.year ? parsed.year : \"\");\r\n\t\tydom.addEventListener(\"input\", function(){\r\n\t\t\tself.set(\"year\", this.value, frame, ty);\r\n\t\t})\r\n\t}\r\n\tif([\"xsd:date\", \"xsd:dateTime\", \"xsd:gYearMonth\", \"xsd:dateTimeStamp\", \"xsd:gMonth\", \"xsd:gMonthDay\"].indexOf(ty) != -1){\r\n\t\tvar mdom = document.createElement(\"select\");\r\n\t\tmdom.setAttribute(\"class\", \"terminus-month-input terminus-month-\"+ty);\r\n\t\tfor(var i = 0; i<this.helper.months.length; i++){\r\n\t\t\tvar opdom = document.createElement(\"option\");\r\n\t\t\topdom.value = i+1;\r\n\t\t\topdom.appendChild(document.createTextNode(this.helper.months[i]));\r\n\t\t\tif(parsed.month && parsed.month == i+1){\r\n\t\t\t\topdom.selected = true;\r\n\t\t\t}\r\n\t\t\tmdom.appendChild(opdom);\r\n\t\t}\r\n\t\tmdom.addEventListener(\"change\", function(){\r\n\t\t\tself.set(\"month\", this.value, frame, ty);\r\n\t\t})\r\n\t}\t\r\n\tif([\"xsd:date\", \"xsd:dateTime\", \"xsd:dateTimeStamp\", \"xsd:gDay\", \"xsd:gMonthDay\"].indexOf(ty) != -1){\r\n\t\tvar ddom = document.createElement(\"input\");\r\n\t\tddom.setAttribute(\"class\", \"terminus-day-input terminus-day-\"+ty);\r\n\t\tddom.setAttribute(\"size\", 2);\r\n\t\tddom.setAttribute(\"placeholder\", \"DD\");\r\n\t\tddom.value = (parsed.day ? parsed.day : \"\");\t\r\n\t\tddom.addEventListener(\"input\", function(){\r\n\t\t\tself.set(\"day\", this.value, frame, ty);\r\n\t\t})\r\n\t}\t\r\n\tif(ydom || mdom || ddom){\r\n\t\tvar dadom = document.createElement(\"span\");\r\n\t\tif(ddom) dadom.appendChild(ddom); \r\n\t\tif(mdom) {\r\n\t\t\tif(ddom) dadom.appendChild(document.createTextNode(this.date_spacer));\r\n\t\t\tdadom.appendChild(mdom); \r\n\t\t}\r\n\t\tif(ydom) {\r\n\t\t\tif(mdom || ddom) dadom.appendChild(document.createTextNode(this.date_spacer));\r\n\t\t\tdadom.appendChild(ydom); \r\n\t\t}\r\n\t\treturn dadom;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nmodule.exports={HTMLDateEditor}","const HTMLFrameHelper = require('../HTMLFrameHelper');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction HTMLEntityViewer(options){\r\n\tthis.onclick = false;\r\n}\r\n\r\nHTMLEntityViewer.prototype.renderFrame = function(frame, dataviewer){\r\n\t//this.client = dataviewer.getClient();\r\n\treturn this.render(frame.get());\t\r\n}\r\n\r\nHTMLEntityViewer.prototype.renderValue = function(dataviewer){\r\n\t//this.client = dataviewer.getClient();\r\n\treturn this.render(dataviewer.value());\r\n}\r\n\r\nHTMLEntityViewer.prototype.render = function(value){\r\n\t//var value = TerminusClient.FrameHelper.unshorten(value);\r\n\tvar holder = document.createElement(\"span\");\r\n\tholder.setAttribute(\"class\", \"terminus-literal-value terminus-entity-reference-value\");\r\n\tvar self = this;\r\n\tif(this.holder){\r\n\t\treturn this.holder;\r\n\t}\r\n\tif(value){\r\n\t\tvar dom = this.showValue(value)\r\n\t\tholder.appendChild(dom);\r\n\t}\r\n\treturn holder;\r\n}\r\n\r\nHTMLEntityViewer.prototype.showValue = function(value){\r\n\treturn document.createTextNode(value);\r\n}\r\n\r\n\r\nHTMLEntityViewer.prototype.getEntityViewHTML = function(value, frame, dataviewer){\r\n\tvar span = document.createElement(\"span\");\r\n\tvar self = this;\r\n\tspan.setAttribute(\"class\", \"terminus-internal-link\");\r\n\tspan.appendChild(dataviewer.internalLink(value));\r\n\tif(controller = renderer.getController()){\r\n\t\tcontroller.getInstanceMeta(value).then(function(response){\r\n\t\t\tvar lab = self.getEntityLabel(value, response, dataviewer);\r\n\t\t\tif(lab){ \r\n\t\t\t\tTerminusClient.FrameHelper.removeChildren(span);\r\n\t\t\t\tspan.appendChild(lab);\r\n\t\t\t}\t\r\n\t\t});\r\n\t}\r\n\treturn span;\r\n}\r\n\r\nHTMLEntityViewer.prototype.getEntityLabel = function(url, response, dv){\r\n\tvar nspan = document.createElement(\"span\");\r\n\tif(response && (il = HTMLFrameHelper.getVariableValueFromBinding(\"InstanceLabel\", response))){\r\n\t\tnspan.appendChild(dv.internalLink(url, il));\r\n\t\tvar rt = HTMLFrameHelper.getVariableValueFromBinding(\"InstanceType\", response);\r\n\t\tvar tit = url + \" Type: \" + rt;\r\n\t\tvar ic = HTMLFrameHelper.getVariableValueFromBinding(\"InstanceComment\", response);\r\n\t\tif(typeof ic == \"object\" && ic[\"@value\"]){\r\n\t\t\ttit += \" \" + ic[\"@value\"];\r\n\t\t}\r\n\t\tnspan.setAttribute(\"title\", tit);\r\n\t\treturn nspan;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nmodule.exports={HTMLEntityViewer}","function HTMLEntityEditor(options){}\r\nHTMLEntityEditor.prototype.renderFrame = function(frame, dataviewer){\r\n\tvar value = frame.get();\r\n\tvar input = document.createElement(\"input\");\r\n\tinput.setAttribute(\"class\", \"terminus-literal-value terminus-entity-reference-value\");\r\n\tinput.setAttribute(\"type\", \"text\");\r\n\tinput.setAttribute('size', 80);\r\n\tinput.value = value;\r\n\tvar self = this;\r\n\tinput.addEventListener(\"change\", function(){\r\n\t\tvar url = this.value;\r\n\t\tif(url.indexOf(\"/\") == -1 && url.indexOf(\":\") == -1){\r\n\t\t\turl = \"doc:\" + url;\r\n\t\t}\r\n\t\tframe.set(url);\r\n\t});\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={HTMLEntityEditor}","const TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction HTMLImageViewer(options){}\r\n\r\nHTMLImageViewer.prototype.renderFrame = function(frame, dataviewer){\r\n\treturn this.render(frame.get());\r\n}\r\n\r\nHTMLImageViewer.prototype.renderValue = function(dataviewer){\r\n\treturn this.render(dataviewer.value());\r\n}\r\n\t\r\nHTMLImageViewer.prototype.render = function(value){\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', \"terminus-literal-value terminus-literal-image-value\");\r\n\tinput.setAttribute('data-value', value);\r\n\tif(value){\r\n\t\tvar img = document.createElement(\"a\");\r\n\t\timg.setAttribute('src', value);\r\n\t\tinput.appendChild(img);\r\n\t}\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={HTMLImageViewer}\r\n\r\n\r\n","const TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction HTMLImageEditor(options){}\r\nHTMLImageEditor.prototype.renderFrame = function(frame, dataviewer){\r\n\tif(this.type == \"xsd:base64Binary\"){\r\n\t\tvar input = document.createElement(\"textarea\");\r\n\t\tinput.setAttribute('class', \"terminus-literal-value terminus-literal-b64image-value\");\r\n\t\tinput.value = value;\r\n\t\tinput.addEventListener(\"change\", function(){\r\n\t\t\tframe.set(this.value);\r\n\t\t});\r\n\t\treturn input;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nmodule.exports={HTMLImageEditor}","function HTMLLinkViewer(options){\r\n\tthis.css = \"terminus-literal-value terminus-literal-value-range \" + ((options && options.css) ?  options.css : \"\");\r\n}\r\n\r\nHTMLLinkViewer.prototype.renderFrame = function(frame, dataviewer){\r\n\treturn this.render(frame.get());\r\n}\r\n\r\nHTMLLinkViewer.prototype.renderValue = function(dataviewer){\r\n\treturn this.render(dataviewer.value());\r\n}\r\n\t\r\nHTMLLinkViewer.prototype.render = function(value){\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', this.css);\r\n\tinput.setAttribute('size', 80);\r\n\tinput.setAttribute('data-value', value);\r\n\tif(value){\r\n\t\tvar a = document.createElement(\"a\");\r\n\t\ta.setAttribute('href', value);\r\n\t\ta.appendChild(document.createTextNode(value));\r\n\t\tinput.appendChild(a);\r\n\t}\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={HTMLLinkViewer}\r\n\r\n","const TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction HTMLNumberViewer(options){\r\n\tthis.commas = (options && options.commas ? options.commas : true);\r\n}\r\n\r\nHTMLNumberViewer.prototype.renderFrame = function(frame, dataviewer){\r\n\treturn this.render(frame.get());\r\n}\r\n\r\nHTMLNumberViewer.prototype.renderValue = function(dataviewer){\r\n\treturn this.render(dataviewer.value());\r\n}\r\n\t\r\nHTMLNumberViewer.prototype.render = function(value){\r\n\tif(value === 0) value = \"0\";\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', 'terminus-number-value terminus-literal-value');\r\n\tinput.setAttribute('data-value', value);\r\n\tvalue = (this.commas ? TerminusClient.FrameHelper.numberWithCommas(value) : value);\r\n\tinput.appendChild(document.createTextNode(value));\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={HTMLNumberViewer}\r\n","const TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction HTMLRangeViewer(options){\r\n\tthis.commas = (options && options.commas ? options.commas : true);\r\n\tthis.css = \"terminus-literal-value terminus-literal-value-range \" + ((options && options.css) ?  options.css : \"\");\r\n\tthis.delimiter = (options && options.delimiter ? options.delimiter : false);\r\n}\r\n\r\nHTMLRangeViewer.prototype.renderFrame = function(frame, dataviewer){\r\n\treturn this.render(frame.get());\r\n}\r\n\r\nHTMLRangeViewer.prototype.renderValue = function(dataviewer){\r\n\treturn this.render(dataviewer.value());\r\n}\r\n\t\r\nHTMLRangeViewer.prototype.render = function(value){\r\n\tvar vals = TerminusClient.FrameHelper.parseRangeValue(value, this.delimiter);\r\n\tvar d = document.createElement(\"span\");\r\n\td.setAttribute(\"class\", this.css);\r\n\tvar rvals = document.createElement(\"span\");\r\n\trvals.setAttribute(\"class\", \"terminus-range-value-left\");\r\n\tvar svals = document.createElement(\"span\");\r\n\tsvals.setAttribute(\"class\", \"terminus-range-value-right\");\r\n\tvar x = (this.useCommas() ? TerminusClient.FrameHelper.numberWithCommas(vals[0]) : vals[0]);\r\n\tvar tnode = document.createTextNode(x);\r\n\trvals.appendChild(tnode);\r\n\td.appendChild(rvals);\t\r\n\tif(vals.length == 2){\r\n\t\td.appendChild(getRangeSymbolDOM());\r\n\t\tvar x2 = (this.useCommas(renderer) ? TerminusClient.FrameHelper.numberWithCommas(vals[1]) : vals[1]);\r\n\t\tvar t2node = document.createTextNode(x2);\r\n\t\tsvals.appendChild(t2node);\r\n\t\td.appendChild(svals);\t\r\n\t}\r\n\treturn d;\r\n}\r\n\r\nHTMLRangeViewer.prototype.useCommas = function(){\r\n\tif([\"xdd:gYearRange\", \"xdd:dateRange\"].indexOf(this.type) != -1) return false;\r\n\treturn this.commas;\r\n}\r\n\r\nfunction getRangeSymbolDOM(){\r\n\tvar d = document.createElement(\"span\");\r\n\td.setAttribute(\"class\", \"terminus-range-indicator\");\r\n\td.setAttribute(\"title\", \"The value is uncertain, it lies somewhere in this range\");\r\n\td.appendChild(document.createTextNode(\" ... \"));\r\n\treturn d;\r\n}\r\n\r\nmodule.exports={HTMLRangeViewer}\r\n","const TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction HTMLRangeEditor(options){\r\n\tthis.commas = (options && options.commas ? options.commas : true);\r\n\tthis.css = \"terminus-literal-value terminus-literal-value-range \" + ((options && options.css) ?  options.css : \"\");\r\n\tthis.delimiter = (options && options.delimiter ? options.delimiter : false);\r\n}\r\n\r\nHTMLRangeEditor.prototype.renderFrame = function(frame, dataviewer){\r\n\tvar value = frame.get();\r\n\tvar vals = TerminusClient.FrameHelper.parseRangeValue(value, this.delimiter);\r\n\tvar d = document.createElement(\"span\");\r\n\td.setAttribute(\"class\", this.css);\r\n\tvar rvals = document.createElement(\"span\");\r\n\tvar svals = document.createElement(\"span\");\r\n\tvar data1 = (vals.length > 0 ? vals[0] : \"\");\r\n\tvar data2 = (vals.length > 1 ? vals[1] : \"\");\r\n\tvar firstip = document.createElement(\"input\");\r\n\tfirstip.setAttribute('type', \"text\");\r\n\tfirstip.setAttribute('size', 16);\r\n\tif(data1){\r\n\t\tfirstip.value = data1;\r\n\t}\r\n\tvar secondip = document.createElement(\"input\");\r\n\tsecondip.setAttribute('type', \"text\");\r\n\tsecondip.setAttribute('size', 16);\r\n\tif(data2){\r\n\t\tthis.showing_range = true;\r\n\t\tsecondip.value = data2;\r\n\t}\r\n\trvals.appendChild(firstip);\r\n\td.appendChild(rvals);\t\r\n\tif(this.showing_range){\r\n\t\tsvals.appendChild(getRangeSymbolDOM());\r\n\t\tsvals.appendChild(secondip);\r\n\t}\r\n\td.appendChild(svals);\t\r\n\tvar but = document.createElement(\"button\");\r\n\tbut.setAttribute(\"class\", \"terminus-change-range\");\r\n\tvar txt = this.showing_range ? \"Change to Simple Value\" : \"Change to Uncertain Range\";\r\n\tbut.appendChild(document.createTextNode(txt));\r\n\td.appendChild(but);\t\r\n\tvar self = this;\r\n\tbut.addEventListener(\"click\", function(){\r\n\t\tif(self.showing_range){\r\n\t\t\tself.showing_range = false;\r\n\t\t\tsecondip.value = \"\";\t\t\t\t\r\n\t\t\tTerminusClient.FrameHelper.removeChildren(svals);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tself.showing_range = true;\r\n\t\t\tsecondip.value = \"\";\t\t\t\t\r\n\t\t\tsvals.appendChild(getRangeSymbolDOM());\r\n\t\t\tsvals.appendChild(secondip);\r\n\t\t}\r\n\t\tvar txt = self.showing_range ? \"Change to Simple Value\" : \"Change to Uncertain Range\";\r\n\t\tbut.innerText = txt;\r\n\t\tchangeHandler();\r\n\t});\r\n\tvar changeHandler = function(){\r\n\t\tif(self.showing_range && secondip.value){\r\n\t\t\tif(firstip.value) frame.set(\"[\" + firstip.value + \",\" + secondip.value + \"]\");\t\t\t\t\r\n\t\t\telse frame.set(secondip.value);\t\t\t\t\r\n\t\t}\r\n\t\telse {\r\n\t\t\tframe.set(firstip.value);\r\n\t\t}\r\n\t}\r\n\tfirstip.addEventListener(\"change\", changeHandler);\r\n\tsecondip.addEventListener(\"change\", changeHandler);\r\n\treturn d;\r\n}\r\n\r\nfunction getRangeSymbolDOM(){\r\n\tvar d = document.createElement(\"span\");\r\n\td.setAttribute(\"class\", \"terminus-range-indicator\");\r\n\td.setAttribute(\"title\", \"The value is uncertain, it lies somewhere in this range\");\r\n\td.appendChild(document.createTextNode(\" ... \"));\r\n\treturn d;\r\n}\r\n\r\nmodule.exports={HTMLRangeEditor}\r\n","const GoogleMapHelper = require(\"./GoogleMapHelper\")\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\nfunction GoogleMapEditor(options){}\r\n\r\nGoogleMapEditor.prototype.renderFrame = function(frame, dataviewer){\r\n\tvar mapcontainer = document.createElement(\"div\");\r\n\tmapcontainer.setAttribute('class', \"gmap-window gmap-editor\");\r\n\tvar self = this;\r\n\tvar ghelper = new GoogleMapHelper();\r\n\tvar map = ghelper.initMap(mapcontainer, value, this.type);\r\n    if(ty == \"xdd:coordinate\"){\r\n\t    google.maps.event.addListener(map, 'click', function(event) {\r\n\t    \tvar position = event.latLng;\r\n\t    \tvar coo = \"[\" + position.lat() + \",\" + position.lng() + \"]\";\r\n\t    \trenderer.set(coo);\r\n\t        ghelper.clearMarkers();\r\n\t        var init = {\r\n\t    \t\tposition: position, \r\n\t    \t\tmap: map\r\n\t    \t}\r\n\t    \tvar marker = new google.maps.Marker(init);\r\n\t    \tghelper.markers.push(marker);\r\n\t  \t});\r\n\t}\r\n    else {\r\n    \tgoogle.maps.event.addListener(map, 'click', function(event) {\r\n        \tvar path = ghelper.polyline.getPath();\r\n        \tpath.push(event.latLng);\r\n      \t    var position = event.latLng;\r\n      \t    ghelper.addMarker(position, map, frame, '#' + path.getLength(), this.type);\r\n      \t});\r\n    }\r\n    return mapcontainer;\r\n}\r\n\r\nmodule.exports={GoogleMapEditor};","const GoogleMapHelper = require(\"./GoogleMapHelper\")\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction GoogleMapViewer(options){}\r\n\r\nGoogleMapViewer.prototype.renderFrame = function(frame, dataviewer){\r\n\treturn this.render(frame.get());\r\n}\r\n\r\nGoogleMapViewer.prototype.renderValue = function(dataviewer){\r\n\treturn this.render(dataviewer.value());\r\n}\r\n\t\r\nGoogleMapViewer.prototype.render = function(value){\r\n\tvar map = document.createElement(\"div\");\r\n\tmap.setAttribute('class', \"gmap-window gmap-viewer\");\r\n\tvar self = this;\r\n\tvar ghelper = new GoogleMapHelper();\r\n\tghelper.initMap(map, value, this.type);\t\t\r\n    return map;\r\n}\r\n\r\nmodule.exports={GoogleMapViewer};","const TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction HTMLMarkupEditor(options){}\r\n\r\nHTMLMarkupEditor.prototype.renderFrame = function(frame, dataviewer){\r\n\tvar value = frame.get();\r\n\tvar input = document.createElement(\"div\");\r\n\tinput.setAttribute('class', \"html-wysiwyg\");\r\n\tvar inner = document.createElement(\"span\");\r\n\tinner.setAttribute('class', \"html-literal literal-value\");\r\n\tinner.innerHTML=value;\r\n\tinput.appendChild(inner);\r\n\tif(typeof Quill != \"undefined\"){\r\n\t\tvar quill = new Quill(inner, { theme: 'snow' });\r\n\t\tquill.on(\"text-change\", function(){\r\n\t\t\tframe.set(quill.root.innerHTML);\r\n\t\t});\r\n\t}\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={HTMLMarkupEditor}","function S2EntityEditor(options){}\r\n\r\nS2EntityEditor.prototype.renderFrame = function(frame, dataviewer){\r\n\tvar value = frame.get();\r\n\tvar cls = frame.range();\r\n\tvar cback = frame.set;\r\n\tvar ctl = dataviewer.getClient();\r\n\tvar d2ch = new TerminusDocumentChooser(ctl, cls, value);\r\n\td2ch.change = function(val){\r\n\t\tframe.set(val);\r\n\t}\r\n\td2ch.view = \"label\";\r\n\tvar d2dom = d2ch.getAsDOM();\r\n\treturn d2dom;\r\n}\r\n\r\n\r\nmodule.exports={S2EntityEditor}","function GraphResultsViewer(config) {\r\n\tthis.svg;\r\n\tthis.visid = randomString(8);\r\n\tthis.currentDate = Date.now() / 1000; // nowish\r\n\t// Individual links, nodes and text graphical elements\r\n\tthis.link_elements;\r\n\tthis.node_elements;\r\n\t// DOM object that this this is directly drawn into\r\n\tthis.container = false;\r\n\t// Map of ids to loaded nodes for ease\r\n\tthis.loadedNodes = {};\r\n\tthis.focusNodes = [];\r\n\t// Currently displayed nodes and links\r\n\tthis.nodes;\r\n\tthis.links;\r\n\t// Var for selecting and deselecting elements\r\n\tthis.selected_id;\r\n\tthis.setConfigOptions(config);\r\n}\r\n\r\n/*\r\n * Loads the graph with new data and optionally starts the animation\r\n */\r\nGraphResultsViewer.prototype.load = function(show) {\r\n\tthis.initD3(this.d3DOM);\r\n\tthis.loadNewData();\r\n\tthis.updateGraph();\r\n\tif(show){\r\n\t\tthis.updateSimulation(\"init\");\r\n\t}\r\n}\r\n\r\n/*\r\n * Called to issue a new set of datapoints\r\n */\r\nGraphResultsViewer.prototype.setData = function(dqr, show){\r\n\t//this.setFocusNodeFromResult(dqr);\r\n\tif(this.result){\r\n\t\tthis.clear();\r\n\t}\r\n\tthis.result = dqr;\r\n\t//if(this.svg){\r\n\t\tthis.load(show);\r\n\t//}\r\n}\r\n\r\nGraphResultsViewer.prototype.loadNewData = function(){\r\n\tthis.nodes = jQuery.extend(true, [], this.result.getNodes());\r\n\tfor(var i = 0 ; i<this.nodes.length; i++){\r\n\t\tthis.loadedNodes[this.nodes[i].id] = this.nodes[i];\r\n\t}\r\n\tthis.links = this.result.getEdges();\r\n\t//this.browser.rebuildController();\r\n}\r\n\r\n\r\n/*\r\n * Called to indicate that the current set of datapoints has been updated\r\n */\r\nGraphResultsViewer.prototype.updateData = function(dqr, show) {\r\n\tthis.setFocusNodeFromResult(dqr);\r\n\tthis.result = dqr;\r\n\tthis.reload(show, \"update\", this.fix_nodes);\r\n}\r\n\r\nGraphResultsViewer.prototype.setFocusNodeFromResult = function(dqr) {\r\n\tvar fn = dqr.getFocusNode();\r\n\tif(fn){\r\n\t\tthis.selected_id = fn;\r\n\t\tthis.focusNodes.push(fn);\r\n\t}\r\n}\r\n\r\n/*\r\n * Called to indicate that the filter setting has been changed on the current datapoints\r\n */\r\nGraphResultsViewer.prototype.setFilter = function(dqr, show){\r\n\tthis.simulation.stop();\r\n\tthis.reload(show, \"filter\", true);\r\n}\r\n\r\nGraphResultsViewer.prototype.wake = function() {\r\n\tif(this.simulation)\tthis.updateSimulation(\"wake\");\r\n}\r\n\r\nGraphResultsViewer.prototype.hibernate = function() {\r\n\tthis.simulation.stop();\r\n}\r\n\r\n/*\r\n * Called when more data is added to the result but the query remains the same\r\n */\r\nGraphResultsViewer.prototype.reload = function(show, mode, no_animate) {\r\n\tfor(var i = 0 ; i<this.nodes.length; i++){\r\n\t\tthis.loadedNodes[this.nodes[i].id] = this.nodes[i];\r\n\t}\r\n\tvar nnodes = jQuery.extend(true, [], this.result.getNodesAndFringes());\r\n\tthis.nodes = [];\r\n\tvar snode = this.loadedNodes[this.selected_id];\r\n\tfor(var i = 0 ; i<nnodes.length; i++){\r\n\t\tvar nnode = nnodes[i];\r\n\t\tif(this.loadedNodes[nnode.id]){\r\n\t\t\tif(nnode.id == this.selected_id){\r\n\t\t\t\tthis.loadedNodes[nnode.id].fx = this.loadedNodes[nnode.id].x;\r\n\t\t\t\tthis.loadedNodes[nnode.id].fy = this.loadedNodes[nnode.id].y;\r\n\t\t\t}\r\n\t\t\telse if(!no_animate) {\r\n\t\t\t\tthis.loadedNodes[nnode.id].fx = null;\r\n\t\t\t\tthis.loadedNodes[nnode.id].fy = null;\r\n\t\t\t}\r\n\t\t\telse if(this.loadedNodes[nnode.id].x){\r\n\t\t\t\tthis.loadedNodes[nnode.id].fx = this.loadedNodes[nnode.id].x;\r\n\t\t\t\tthis.loadedNodes[nnode.id].fy = this.loadedNodes[nnode.id].y;\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tif(this.explode_out && snode.x){\r\n\t\t\t\tnnode.x = snode.x;\r\n\t\t\t\tnnode.y = snode.y;\r\n\t\t\t}\r\n\t\t\tthis.loadedNodes[nnode.id] = nnode;\r\n\t\t}\r\n\t\tthis.nodes.push(this.loadedNodes[nnode.id]);\r\n\t}\r\n\tthis.links = this.result.getLinks();\r\n\tthis.updateGraph();\r\n\tif(show){\r\n\t\t//this.browser.rebuildController();\r\n\t\tthis.updateSimulation(mode);\r\n\t}\r\n}\r\n\r\nGraphResultsViewer.prototype.clear = function() {\r\n\tthis.nodes = [];\r\n\tthis.loadedNodes = {};\r\n\tthis.links = [];\r\n\tthis.updateGraph();\r\n\tjQuery(this.d3DOM).empty();\r\n\tthis.scale_factor = 1;\r\n}\r\n\r\n/*\r\n * Called to initialise the DOM when it is first loaded (called after setData)\r\n */\r\nGraphResultsViewer.prototype.initDOM = function(vdom) {\r\n\tif(!this.width) this.width = this.setWidth();\r\n\tif(!this.height) this.height = this.setHeight();\r\n\tthis.d3DOM = vdom;\r\n\tif(this.result){\r\n\t\tthis.load(true);\r\n\t}\r\n}\r\n\r\n/*\r\n * Generate the div that contains the visualisation panel\r\n */\r\nGraphResultsViewer.prototype.getAsDOM = function() {\r\n\tvar vdom = document.createElement(\"div\");\r\n\tvdom.setAttribute(\"class\", \"terminus-gviz-panel\");\r\n\tvdom.setAttribute(\"id\", this.visid);\r\n\tvdom.setAttribute(\"width\", \"100%\");\r\n\tthis.container = vdom;\r\n\treturn vdom;\r\n}\r\n\r\n/*\r\n * Calculates the width of the container area available for the SVG\r\n */\r\nGraphResultsViewer.prototype.setWidth = function() {\r\n\tif(this.container && this.container.clientWidth){\r\n\t\tthis.width = this.container.clientWidth;\r\n\t}\r\n\telse if(this.container.parentNode && this.container.parentNode.clientWidth){\r\n\t\tthis.width = this.container.parentNode.clientWidth;\r\n\t}\r\n\telse {\r\n\t\tvar w = jQuery(this.container).width();\r\n\t\tif(w == 0){\r\n\t\t\tw = jQuery(this.container.parentNode).width();\r\n\t\t}\r\n\t\tif(w == 0) {\r\n\t\t\tw = 800;\r\n\t\t}\r\n\t\tthis.width = w;\r\n\t}\r\n\treturn this.width;\r\n}\r\n\r\nGraphResultsViewer.prototype.setHeight = function() {\r\n\tif(this.container && this.container.clientHeight){\r\n\t\tthis.height = this.container.clientHeight;\r\n\t}\r\n\telse if(this.container.parentNode && this.container.parentNode.clientHeight){\r\n\t\tthis.height = this.container.parentNode.clientHeight;\r\n\t}\r\n\telse {\r\n\t\tvar w = jQuery(this.container).height();\r\n\t\tif(w == 0){\r\n\t\t\tw = jQuery(this.container.parentNode).height();\r\n\t\t}\r\n\t\tif(w == 0) {\r\n\t\t\tw = 400;\r\n\t\t}\r\n\t\tthis.height = w;\r\n\t}\r\n\treturn this.height;\r\n}\r\n\r\n\r\nGraphResultsViewer.prototype.initD3 = function(jqid) {\r\n\tvar self = this;\r\n\r\n\t/********************* Seed the data **************************/\r\n\tthis.svg = d3.select(jqid).append(\"svg\")\r\n\t\t.attr(\"width\", this.width)\r\n\t\t.attr(\"height\", this.height);\r\n\r\n\tvar distanceFun = function(link){\r\n\t\treturn self.getLinkDistance(link);\r\n\t}\r\n\r\n\t// create the force object\r\n\tthis.simulation  = d3.forceSimulation()\r\n\t\t//link distance varies with link type\r\n\t    .force(\"link\", d3.forceLink().distance(distanceFun).id(function(link) { return link.id; }))\r\n\t    //charge is the same for all nodes\r\n\t    .force('charge', d3.forceManyBody().strength(function(node){ return self.getCharge(node)}))\r\n\t    //collision radius changes with node type\r\n\t    .force('collision', d3.forceCollide().radius(function(node) {\r\n\t    \treturn (self.getCollisionRadius(node));\r\n\t    }))\r\n\t\t.force(\"center\", d3.forceCenter(this.width / 2, this.height / 2));\r\n\r\n\t// node drag\r\n\tthis.drag_drop = d3.drag()\r\n\t\t.on('start', function(node) {\r\n\t\t\tnode.fx = node.x\r\n\t\t\tnode.fy = node.y\r\n\t\t})\r\n\t\t.on('drag', function(node) {\r\n\t\t\tself.simulation.restart()\r\n\t\t\tnode.fx = d3.event.x;\r\n\t\t\tnode.fy = d3.event.y;\r\n\t\t})\r\n\t\t.on('end', function(node) {\r\n\t\t\tnode.fx = null;\r\n\t\t\tnode.fx = null;\r\n\t\t\tself.simulation.stop()\r\n\t\t});\r\n\r\n\tthis.svg.append(\"rect\")\r\n\t   .attr(\"width\", this.width)\r\n\t   .attr(\"height\", this.height)\r\n\t   .style(\"fill\", \"none\")\r\n\t   .style(\"pointer-events\", \"all\")\r\n\t   .call(d3.zoom().on(\"zoom\", function(){self.zoomed()}));\r\n\r\n\t// Append graphic element to svg which are groups for graph elements\r\n\tthis.link_group = this.svg.append(\"g\").classed(\"links\", true);\r\n\tthis.node_group = this.svg.append(\"g\").classed(\"nodes\", true);\r\n}\r\n\r\nGraphResultsViewer.prototype.zoomed = function() {\r\n\tthis.current_transform = d3.event.transform;\r\n\tif(this.node_elements)\r\n\t\tthis.node_elements.attr(\"transform\", d3.event.transform);\r\n    if(this.link_elements)\r\n    \tthis.link_elements.attr(\"transform\", d3.event.transform);\r\n}\r\n\r\n/***\r\n * updates the svg with the current nodes and links\r\n */\r\nGraphResultsViewer.prototype.updateGraph = function(nodes, links) {\r\n\tvar self = this;\r\n\r\n\tvar follow_node_wrapper = function(graph_node){\r\n\t\tself.nodeSelected(graph_node);\r\n\t}\r\n\tvar zoomed = function(){\r\n\t\tself.zoomed();\r\n\t}\r\n\r\n\tnodes = (typeof nodes != \"undefined\" ? nodes : this.nodes);\r\n\tlinks = (typeof links != \"undefined\" ? links : this.links);\r\n\tthis.node_elements  = this.node_group.selectAll(\"g\").data(nodes);\r\n\tthis.node_elements.exit().remove();\r\n\r\n\t/*Create and place the \"blocks\" containing the circle and the text */\r\n    var node_enter = this.node_elements.enter().append(\"g\");\r\n\r\n\t// enter and create new ones\r\n\tnode_enter.append(\"circle\")\r\n\t\t.style('opacity', 0.99)\r\n\t\t.attr('r', function(node){return self.getRadius(node)})\r\n\t\t.attr(\"cx\",  function(node){ return node.x})\r\n\t\t.attr(\"cy\",  function(node){ return node.y})\r\n\t\t.attr(\"type\", function(node) {return self.isFringe(node) ? \"fringe\" : \"node\"})\r\n\t\t.call(self.drag_drop)\r\n\t\t.on(\"mouseover\", function(d){ d3.select(this).style(\"cursor\", \"pointer\"); })\r\n\t\t.on(\"mouseout\", function(d){ d3.select(this).style(\"cursor\", \"default\"); })\r\n\t\t.on('click', follow_node_wrapper);\r\n\r\n    node_enter.append(\"text\")\r\n\t\t.attr(\"x\",  function(node){ return node.x})\r\n\t\t.attr(\"y\",  function(node){ return node.y})\r\n\t\t.text(function(node) { return self.getNodeIconUnicode(node)})\r\n\t\t.call(self.drag_drop)\r\n\t\t.on(\"mouseover\", function(d){ d3.select(this).style(\"cursor\", \"pointer\"); })\r\n\t\t.on(\"mouseout\", function(d){ d3.select(this).style(\"cursor\", \"default\"); })\r\n\t\t.on('click', follow_node_wrapper);\r\n\r\n\t// merge new and old nodes\r\n\tthis.node_elements = node_enter.merge(this.node_elements);\r\n\r\n\tthis.styleNodeElements();\r\n\r\n\t// update LINKS ********************************************\r\n\tthis.link_elements  = this.link_group.selectAll(\"line\").data(links);\r\n\r\n\t// remove old links\r\n\tthis.link_elements.exit().remove();\r\n\t// enter and create new ones\r\n\tvar link_enter = this.link_elements.enter().append(\"line\");\r\n\r\n\t// merge new and old links\r\n\tthis.link_elements = link_enter.merge(this.link_elements)\r\n\r\n\tthis.styleLinkElements();\r\n\r\n\t//execute the current state of the pan-zoom transform\r\n\tif(this.current_transform){\r\n\t\tif(this.node_elements)\r\n\t\t\tthis.node_elements.attr(\"transform\", this.current_transform);\r\n\t    if(this.link_elements)\r\n\t    \tthis.link_elements.attr(\"transform\", this.current_transform);\r\n\t}\r\n}\r\n\r\nGraphResultsViewer.prototype.updateSimulation = function(mode) {\r\n\tvar self = this;\r\n\t//move all of the graphical elements corresponding to the nodes with each tick\r\n\tvar ticker = function(){\r\n\t\tself.node_elements.selectAll(\"circle\")\r\n\t\t\t.attr(\"cx\",  function(node){ return node.x})\r\n\t\t\t.attr(\"cy\",  function(node){ return node.y});\r\n\t\tself.node_elements.selectAll(\"text\")\r\n\t\t\t.attr(\"x\",  function(node){ return node.x})\r\n\t\t\t.attr(\"y\",  function(node){ return node.y});\r\n\t\tself.link_elements\r\n\t\t\t.attr('x1', function(link){ return link.source.x})\r\n\t\t\t.attr('y1', function(link){ return link.source.y})\r\n\t\t\t.attr('x2', function(link){ return link.target.x})\r\n\t\t\t.attr('y2', function(link){ return link.target.y});\r\n\t}\r\n\tif(this.show_force){\r\n\t\tthis.simulation.nodes(this.nodes).on('tick', ticker).force('link').links(this.links);\r\n\t}\r\n\telse {\r\n\t\tthis.simulation.nodes(this.nodes).on('end', ticker).force('link').links(this.links);\r\n\t}\r\n\tif(this.nodes.length){\r\n\t\tif(mode == \"wake\" || mode == \"init\"){\r\n\t\t\tthis.simulation.restart();\r\n\t\t}\r\n\t\telse if(mode == \"filter\"){\r\n\t\t\tthis.simulation.restart();\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.simulation.alpha(1).restart();\r\n\t\t}\r\n\t}\r\n}\r\n\r\nGraphResultsViewer.prototype.styleNodeElements = function() {\r\n\tvar self = this;\r\n\tif(this.node_elements){\r\n\t\tthis.node_elements.each(function(node){\r\n\t\t\tvar g = d3.select(this);\r\n\t\t\tvar sel = g.select(\"circle\");\r\n\t\t\tsel.select(\"title\").remove();\r\n\t\t\tsel.style(\"fill\", self.getNodeColour(node));\r\n\t\t\tsel.attr('r', self.getRadius(node));\r\n\t\t\tsel.classed(\"highlighted\", function(node) { return self.focusNodes.indexOf(node.id) != -1});\r\n\t\t\tsel.append(\"title\")\r\n\t\t\t\t.classed(\"terminus-gnode-title\", true)\r\n\t\t\t\t.text(self.getNodeText(node));\r\n\t\t\tvar txt = g.select(\"text\");\r\n\t\t\ttxt.select(\"title\").remove();\r\n\t\t\ttxt.attr('text-anchor', 'middle')\r\n\t\t\t\t.attr(\"title\", self.getNodeText(node))\r\n\t\t\t\t.attr('dominant-baseline', 'central')\r\n\t\t\t\t.style('font-family', \"'\" + self.fontfam + \"'\")\r\n\t\t\t\t.style('font-weight', self.getNodeIconWeight(node))\r\n\t\t\t\t.style('font-size', self.getNodeIconSize(node))\r\n\t\t\t\t.style(\"fill\", self.getNodeIconColour(node))\r\n\t\t\t\t.text(self.getNodeIconUnicode(node))\r\n\t\t\t\t.append(\"title\")\r\n\t\t\t\t\t.classed(\"terminus-gnode-title\", true)\r\n\t\t\t\t\t.text(self.getNodeText(node));\r\n\t\t});\r\n\t}\r\n}\r\n\r\nGraphResultsViewer.prototype.styleLinkElements = function() {\r\n\tvar self = this;\r\n\tif(this.link_elements){\r\n\t\tthis.link_elements.each(function(link){\r\n\t\t\tvar sel = d3.select(this);\r\n\t\t\tsel.select(\"title\").remove();\r\n\t\t\tsel.attr(\"stroke-width\", self.getLineWidth(link));\r\n\t\t\tsel.attr(\"marker-end\", self.getEdgeArrow(link));\r\n\t\t\tsel.style(\"stroke\", self.getEdgeColour(link));\r\n\t\t\tsel.append(\"title\")\r\n\t\t\t\t.classed(\"terminus-glink-title\", true)\r\n\t\t\t\t.text(self.getLinkText(link));\r\n\t\t});\r\n\t}\r\n}\r\n\r\nGraphResultsViewer.prototype.getEdgeArrow = function(edge) {\r\n\tif(edge){\r\n\t\tvar dir = this.getEdgeDirection(edge);\r\n\t\t//if(dir){\r\n\t\t\tvar col = this.getEdgeColour(edge);\r\n\t\t\tvar reference;\r\n\t\t\tthis.svg.append(\"svg:defs\").selectAll(\"marker\")\r\n\t\t\t\t.data([reference])\r\n\t\t\t\t.enter().append(\"svg:marker\")\r\n\t\t\t\t.attr(\"id\", String)\r\n\t\t\t\t.attr(\"viewBox\", \"0 -5 10 10\")\r\n\t\t\t\t.attr(\"refX\", 22)  // This sets how far back it sits, kinda\r\n\t\t\t\t.attr(\"refY\", 0)\r\n\t\t\t\t.attr(\"markerWidth\", this.getArrowWidth(edge))\r\n\t\t\t\t.attr(\"markerHeight\", this.getArrowHeight(edge))\r\n\t\t\t\t.attr(\"orient\", \"auto\")\r\n\t\t\t\t.attr(\"markerUnits\", \"userSpaceOnUse\")\r\n\t\t\t\t.append(\"svg:path\")\r\n\t\t\t\t\t.attr(\"d\", dir)\r\n\t\t\t\t\t.style(\"fill\", col);\r\n\t\t\t\treturn \"url(#\" + reference + \")\";\r\n\t\t//}\r\n\t}\r\n\treturn \"\";\r\n}\r\n\r\n\r\nGraphResultsViewer.prototype.nodeSelected = function(selected_node) {\r\n\tvar self = this;\r\n\tif(this.selected_id == selected_node.id && this.selection_grows){\r\n\t\tthis.selection_grows = false;\r\n\t\tthis.styleNodeElements();\r\n\t}\r\n\telse {\r\n\t\tthis.selection_grows = true;\r\n\t\tthis.selected_id = selected_node.id;\r\n\t\tthis.styleNodeElements();\r\n\t\t//this.browser.nodeSelected(selected_node);\r\n\t\tif(this.isFringe(selected_node)){\r\n\t\t\t//this.browser.followNode(selected_node);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nGraphResultsViewer.prototype.getScaleTransform = function(x, y, scale_factor){\r\n\treturn \"scale(\"+ scale_factor + \") translate(\" + x + \",\" + y + \")\";\r\n}\r\n\r\nGraphResultsViewer.prototype.scale = function(min_ratio) {\r\n    // the new dimensions of the molecule\r\n    new_mol_width = this.width * min_ratio;\r\n    new_mol_height = this.height * min_ratio;\r\n\r\n    var y_trans = (this.height - new_mol_height) ;\r\n\r\n    var x_trans = (this.width - new_mol_width);\r\n    // do the actual moving\r\n    var self = this;\r\n    if(this.node_elements)\r\n    \tthis.node_elements.transition()\r\n        .duration(750).attr(\"transform\", function(node){ return self.getScaleTransform(x_trans, y_trans, min_ratio)});\r\n    if(this.link_elements)\r\n        this.link_elements.transition()\r\n        .duration(750).attr(\"transform\", function(node){ return self.getScaleTransform(x_trans, y_trans, min_ratio)});\r\n\tthis.scale_factor = min_ratio;\r\n\tthis.svg.selectAll(\"marker\").attr(\"markerWidth\", this.getArrowWidth())\r\n\t\t\t.attr(\"markerHeight\", this.getArrowHeight());\r\n}\r\n\r\n\r\nGraphResultsViewer.prototype.scaleToFit = function() {\r\n    // Center the view on the molecule(s) and scale it so that everything\r\n    // fits in the window\r\n    //no molecules, nothing to do\r\n    if (this.nodes.length === 0)\r\n        return;\r\n\r\n    // Get the bounding box\r\n    min_x = d3.min(this.nodes.map(function(d) {return d.x;}));\r\n    min_y = d3.min(this.nodes.map(function(d) {return d.y;}));\r\n    max_x = d3.max(this.nodes.map(function(d) {return d.x;}));\r\n    max_y = d3.max(this.nodes.map(function(d) {return d.y;}));\r\n\r\n    // The width and the height of the graph\r\n    mol_width = max_x - min_x;\r\n    mol_height = max_y - min_y;\r\n\r\n    mol_width = mol_width * 1.05;\r\n    mol_height = mol_height * 1.05;\r\n    // how much larger the drawing area is than the width and the height\r\n    width_ratio = this.width / mol_width;\r\n    height_ratio = this.height / mol_height;\r\n\r\n    // we need to fit it in both directions, so we scale according to\r\n    // the direction in which we need to scale the most\r\n    min_ratio = Math.min(width_ratio, height_ratio);\r\n    if(min_ratio < 1){\r\n    \tthis.scale(min_ratio);\r\n    }\r\n};\r\n\r\n// recentre graph\r\nGraphResultsViewer.prototype.recentre = function(graph_node) {\r\n\tthis.translated = true;\r\n\t// get the x and y you need to transform the nodes by\r\n\tthis.dcx = (this.width/2-graph_node.x);\r\n\tthis.dcy = (this.height/2-graph_node.y);\r\n\t//zoom.translate([dcx,dcy]); If we do zooming we'll need to do something here\r\n\tthis.node_elements.attr(\"transform\", \"translate(\"+ this.dcx + \",\" + this.dcy  + \")\");\r\n\tthis.link_elements.attr(\"transform\", \"translate(\"+ this.dcx + \",\" + this.dcy  + \")\");\r\n\tthis.text_elements.attr(\"transform\", \"translate(\"+ this.dcx + \",\" + this.dcy  + \")\");\r\n}\r\n\r\n\r\nGraphResultsViewer.prototype.setConfigOptions = function(config) {\r\n\t//configuration options for different types of behaviour\r\n\t// Need to explicitly know font family name for unicode glyphs\r\n\tthis.fontfam = (config && (config.fontfamily()) ? config.fontfamily() : 'Font Awesome 5 Free');\r\n\tthis.selected_grows = (config && typeof config.selected_grows() != \"undefined\" ? config.selected_grows() : true);\r\n\tthis.show_force = (config && typeof config.show_force() != \"undefined\" ? config.show_force() : true);\r\n\tthis.fix_nodes = (config && typeof config.fix_nodes() != \"undefined\" ? config.fix_nodes() : false);\r\n\tthis.explode_out = (config && typeof config.explode_out() != \"undefined\" ? config.explode_out(): false);\r\n\tthis.width = (config && config.width() ? config.width(): false);\r\n\tthis.height = (config && config.height() ? config.height(): false);\r\n\tthis.defaults = {\r\n\t\tedge: {\r\n\t\t\ttype: \"edge\",\r\n\t\t\tdistance: (config && config.edge && config.edge.distance ? config.edge.distance : 70),\r\n\t\t\tarrow: (config && config.edge && config.edge.arrow ? config.edge.arrow : { width: 36, height: 16}),\r\n\t\t\tsymmetric: (config && config.edge && config.edge.symmetric ? config.edge.symmetric : true),\r\n\t\t\tcolor: (config && config.edge && config.edge.color ? config.edge.color : [150,150,255]),\r\n\t\t\tweight: (config && config.edge && config.edge.weight ? config.edge.weight : 0.3),\r\n\t\t\tsize: (config && config.edge && config.edge.size ? config.edge.size : 4)\r\n\t\t},\r\n\t\tnode: {\r\n\t\t\ttype: \"node\",\r\n\t\t\tradius: (config && config.node && config.node.radius ? config.node.radius : 14),\r\n\t\t\tcharge: (config && config.node && config.node.charge ? config.node.charge : -60),\r\n\t\t\tcollisionRadius: (config && config.node && config.node.collisionRadius ? config.node.collisionRadius : 20),\r\n\t\t\tcolor: (config && config.node && config.node.color ? config.node.color : [0,255,255]),\r\n\t\t\ticon: {\r\n\t\t\t\tweight: (config && config.node && config.node.icon && config.node.icon.weight ? config.node.icon.weight : 900),\r\n\t\t\t\tcolor: (config && config.node && config.node.icon && config.node.icon.color ? config.node.icon.color : [0,0,255]),\r\n\t\t\t\tunicode: (config && config.node && config.node.icon && config.node.icon.unicode ? config.node.icon.unicode : \"\\uf4fb\"),\r\n\t\t\t\tsize: (config && config.node && config.node.icon && config.node.icon.size ? config.node.icon.size : 10),\r\n\t\t\t\tfaclass: (config && config.node && config.node.icon && config.node.icon.faclass ? config.node.icon.faclass : \"fas fa-user-astronaut\")\r\n\t\t\t},\r\n\t\t\ttext: {\r\n\t\t\t\tcolor: (config && config.node && config.node.text && config.node.text.color ? config.node.text.color : [0,0,0]),\r\n\t\t\t\tsize: (config && config.node && config.node.icon && config.node.text.size ? config.node.text.size : 10)\r\n\t\t\t},\r\n\t\t\tborder: {\r\n\t\t\t\tcolor: (config && config.node && config.node.border && config.node.border.color ? config.node.border.color : [0,0,0]),\r\n\t\t\t\tsize: (config && config.node && config.node.border && config.node.border.size ? config.node.border.size : 10)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\n/*\r\n * Dimensions / forces / etc all settable with a scale factor - for zooming\r\n */\r\nGraphResultsViewer.prototype.getMultiplier = function(node) {\r\n\tvar mult = (node && node.size ? node.size : 1);\r\n\tif(node.id == this.selected_id && this.selection_grows){\r\n\t\tmult = mult * 2;\r\n\t}\r\n\treturn mult;\r\n}\r\n\r\nGraphResultsViewer.prototype.getRadius = function(node) {\r\n\tvar radius = (node && node.radius ? node.radius : this.defaults.node.radius);\r\n\tvar r = (this.scale_factor ? Math.min(this.scale_factor * radius, radius) : radius);\r\n\tr = r * this.getMultiplier(node);\r\n\treturn r;\r\n}\r\n\r\nGraphResultsViewer.prototype.getCollisionRadius = function(node) {\r\n\tvar colrad = (node && node.collisionRadius ? node.collisionRadius : this.defaults.node.collisionRadius );\r\n\tvar v = (this.scale_factor ? Math.min(this.scale_factor * colrad, colrad) : colrad);\r\n\treturn v * this.getMultiplier(node);\r\n}\r\n\r\nGraphResultsViewer.prototype.getCharge = function(node) {\r\n\tvar charge = (node && node.charge ? node.charge : this.defaults.node.charge);\r\n\tif(charge < 0){\r\n\t\tvar v = (this.scale_factor ? Math.max(this.scale_factor * charge, charge) : charge);\r\n\t}\r\n\telse {\r\n\t\tvar v = (this.scale_factor ? Math.min(this.scale_factor * charge, charge) : charge);\r\n\t}\r\n\treturn v * this.getMultiplier(node);\r\n}\r\n\r\nGraphResultsViewer.prototype.getLinkDistance = function(link) {\r\n\tvar linkDistance = (link && link.distance ? link.distance : this.defaults.edge.distance);\r\n\tvar x = (this.scale_factor ? Math.min(this.scale_factor * linkDistance, linkDistance) : linkDistance);\r\n\treturn x;\r\n}\r\n\r\nGraphResultsViewer.prototype.getNodeIconSize = function(node) {\r\n\tif(node && node.icon && node.icon.size){\r\n\t\treturn node.icon.size + \"em\";\r\n\t}\r\n\treturn (this.getMultiplier(node) + \"em\");\r\n}\r\n\r\nGraphResultsViewer.prototype.getNodeColour = function(node) {\r\n\tvar col = (node && node.color ? node.color : this.defaults.node.color);\r\n\tif(this.isFringe(node)){\r\n\t\treturn \"rgba(\"+col.join(\",\")+\",0.25)\";\r\n\t}\r\n\telse {\r\n\t\treturn \"rgb(\"+col.join(\",\")+\")\";\r\n\t}\r\n}\r\n\r\nGraphResultsViewer.prototype.getNodeIcon = function(node) {\r\n\tvar fac = (node && node.icon && node.icon.faclass ? node.icon.faclass : this.defaults.node.icon.faclass);\r\n\treturn fac;\r\n}\r\n\r\nGraphResultsViewer.prototype.getNodeIconUnicode= function(node) {\r\n\treturn (node && node.icon && node.icon.unicode ? node.icon.unicode : this.defaults.node.icon.unicode);\r\n}\r\n\r\nGraphResultsViewer.prototype.getNodeIconWeight = function(node) {\r\n\treturn (node && node.icon && node.icon.weight ? node.icon.weight : this.defaults.node.icon.weight );\r\n}\r\n\r\nGraphResultsViewer.prototype.getNodeIconColour = function(node) {\r\n\tvar col = (node && node.icon && node.icon.color ? node.icon.color : this.defaults.node.icon.color );\r\n\tif(this.isFringe(node)){\r\n\t\treturn \"rgba(\"+col.join(\",\")+\",0.25)\";\r\n\t}\r\n\telse {\r\n\t\treturn \"rgb(\"+col.join(\",\")+\")\";\r\n\t}\r\n}\r\n\r\nGraphResultsViewer.prototype.getEdgeColour = function(edge) {\r\n\tvar col = (edge && edge.color ? edge.color : this.defaults.edge.color );\r\n\tvar weight = (edge && edge.weight ? edge.weight : this.defaults.edge.weight);\r\n\tvar nc = col.concat([weight]);\r\n\treturn \"rgba(\"+nc.join(\",\")+\")\";\r\n}\r\n\r\nGraphResultsViewer.prototype.getEdgeDirection = function(edge) {\r\n\tif(edge && edge.symmetric){\r\n\t\treturn \"M10,-5 L0,0 L10,5\";\r\n\t}\r\n\treturn \"M0,-5 L10,0 L0,5\";\r\n\treturn false;\r\n}\r\n\r\nGraphResultsViewer.prototype.getLineWidth = function(link) {\r\n\tvar x = (link && link.size ? link.size : this.defaults.edge.size);\r\n\treturn x;\r\n}\r\n\r\n\r\nGraphResultsViewer.prototype.getNodeText = function(node) {\r\n\tif(node && node.text) return node.text;\r\n\treturn node.id;\r\n}\r\n\r\nGraphResultsViewer.prototype.getLinkText = function(edge) {\r\n\tif(edge && edge.text) return edge.text;\r\n\tif(edge && edge.id) return edge.id;\r\n\treturn \"\";\r\n}\r\n\r\nGraphResultsViewer.prototype.getArrowWidth = function(edge) {\r\n\tvar w = (edge && edge.arrow && edge.arrow.width ? edge.arrow.width : this.defaults.edge.arrow.width);\r\n\treturn (this.scale_factor ? Math.min(this.scale_factor * w, w) : w);\r\n}\r\n\r\nGraphResultsViewer.prototype.getArrowHeight = function(edge) {\r\n\tvar w = (edge && edge.arrow && edge.arrow.height ? edge.arrow.height : this.defaults.edge.arrow.height );\r\n\treturn (this.scale_factor ? Math.min(this.scale_factor * w, w) : w);\r\n}\r\n\r\nGraphResultsViewer.prototype.isNeighbourLink = function(node, link) {\r\n\treturn link.target.id === node.id || link.source.id === node.id;\r\n}\r\n\r\nGraphResultsViewer.prototype.isFringe = function(node){\r\n\tif(this.result && this.result.added && this.result.added.upgraded){\r\n\t\tif(this.result.added.upgraded.indexOf(node.id) != -1){\r\n\t\t\tnode.type = \"node\";\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\treturn node.type && node.type == \"fringe\";\r\n}\r\n\r\nfunction randomString(length) {\r\n    var chars = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz'.split('');\r\n    if (! length) {\r\n        length = Math.floor(Math.random() * chars.length);\r\n    }\r\n    var str = '';\r\n    for (var i = 0; i < length; i++) {\r\n        str += chars[Math.floor(Math.random() * chars.length)];\r\n    }\r\n    return str;\r\n}\r\n\r\nmodule.exports = GraphResultsViewer;\r\n","function TerminusViolations(vios, ui){\r\n\tthis.ui = ui;\r\n\tthis.vios = [];\r\n\tvar nvios = [];\r\n\tfor(var i = 0; i<vios.length; i++){\r\n\t\tfor(var j = 0; j<nvios.length; j++){\r\n\t\t\tif(JSON.stringify(vios[i]) == JSON.stringify(nvios[j])) continue;\r\n\t\t}\r\n\t\tnvios.push(vios[i]);\r\n\t}\r\n\tfor(var i = 0; i<nvios.length; i++){\r\n\t\tthis.vios.push(new TerminusViolation(nvios[i], this.ui));\r\n\t}\r\n}\r\n\r\nTerminusViolations.prototype.getAsDOM = function(context_msg){\r\n\tvar vdom = document.createElement(\"div\");\r\n\tvdom.setAttribute(\"class\", \"terminus-violations terminus-show-msg-vio\");\r\n\tvar vioHeading = document.createElement(\"div\");\r\n\tvioHeading.setAttribute('class', 'terminus-violations-heading');\r\n\tvdom.appendChild(vioHeading);\r\n\tvar msg = this.vios.length + (this.vios.length > 1 ? \" Violations Detected\" : \" Violation Detected\");\r\n\tif(context_msg) msg += \" \" + context_msg;\r\n\tvioHeading.appendChild(document.createTextNode(msg));\r\n\tfor(var i = 0; i<this.vios.length; i++){\r\n\t\tvdom.appendChild(this.vios[i].getAsDOM());\r\n\t}\r\n\treturn vdom;\r\n}\r\n\r\n/*\r\n * Class for displaying violation reports as HTML\r\n */\r\nfunction TerminusViolation(vio, ui){\r\n\tthis.ui = ui;\r\n\tthis.vio = vio;\r\n}\r\n\r\nTerminusViolation.prototype.getAsDOM = function(){\r\n\tvar vdom = document.createElement(\"div\");\r\n\tvdom.setAttribute(\"class\", \"terminus-violation\");\r\n\tif(this.vio['@type']){\r\n\t\tvar msg = this.vio['vio:message'] || {\"@value\": \"\"};\r\n\t\tvdom.appendChild(this.getPropertyAsDOM(this.vio[\"@type\"], msg));\r\n\t}\r\n\tfor(var prop in this.vio){\r\n\t\tif(prop != \"vio:message\" && prop != \"@type\"){\r\n\t\t\tvdom.appendChild(this.getPropertyAsDOM(prop, this.vio[prop]));\r\n\t\t}\r\n\t}\r\n\treturn vdom;\r\n}\r\n\r\nTerminusViolation.prototype.getPropertyAsDOM = function(prop, val){\r\n\tvar pdom = document.createElement(\"div\");\r\n\tpdom.setAttribute(\"class\", \"terminus-violation-property\");\r\n\tvar ldom = document.createElement(\"span\");\r\n\tldom.setAttribute(\"class\", \"terminus-label terminus-violation-property-label\");\r\n\tldom.appendChild(document.createTextNode(prop));\r\n\tvar vdom = document.createElement(\"span\");\r\n\tvdom.setAttribute(\"class\", \"terminus-violation-property-value\");\r\n\tvdom.appendChild(document.createTextNode(val[\"@value\"]));\r\n\tpdom.appendChild(ldom);\r\n\tpdom.appendChild(vdom);\r\n\treturn pdom;\r\n}\r\n\r\nmodule.exports=TerminusViolations\r\n","//const TerminusHTMLViewer = require('./html/TerminusHTMLViewer');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\nconst QueryPane = require(\"./html/QueryPane\");\r\nconst ScriptPane = require(\"./html/ScriptPane\");\r\nconst DocumentPane = require(\"./html/DocumentPane\");\r\n\r\nfunction TerminusQueryViewer(ui, options){\r\n\tthis.ui = ui;\r\n\tthis.options = options;\r\n\tthis.panes = [];\r\n\tthis.new_pane = false;\r\n\tthis.new_pane_type = false;\r\n\tthis.meta = {};\r\n\tthis.container = document.createElement(\"div\");\r\n\tthis.container.setAttribute(\"class\", \"terminus-query-page\");   \r\n}\r\n\r\nTerminusQueryViewer.prototype.newPaneOptions = function(){ \r\n\tvar opts = {\r\n\t\tshowQuery: true, \r\n\t\teditQuery: true,\r\n\t\tshowHeader: true, \r\n\t};\r\n\treturn opts;\r\n} \r\n\r\nTerminusQueryViewer.prototype.defaultResultOptions = function(){ \r\n\tvar opts = {\r\n\t\tshowConfig: \"icon\", \r\n\t\teditConfig: true,\r\n\t\tshowHeader: false, \r\n\t\tviewers: [new TerminusClient.WOQL.graph()],\r\n\t};\r\n\treturn opts;\r\n} \r\n\r\nTerminusQueryViewer.prototype.getNewQueryPane = function(){\r\n\tlet qpane = new QueryPane(this.ui.client).options(this.newPaneOptions());\r\n\tqpane.addView(new TerminusClient.WOQL.table(), this.defaultResultOptions());\r\n\treturn qpane;\r\n}\r\n\r\n\r\nTerminusQueryViewer.prototype.addQueryPane = function(){\r\n\tvar qpane = this.getNewQueryPane();\r\n\tthis.panes.push(qpane);\r\n\treturn qpane;\r\n}\r\n\r\nTerminusQueryViewer.prototype.addScriptPane = function(q){\r\n\tlet qpane = new ScriptPane(this.ui.client, q);\r\n\tthis.panes.push(qpane);\r\n\treturn qpane;\r\n}\r\n\r\nTerminusQueryViewer.prototype.addScriptPaneDOM = function(){\r\n\tlet qpane = new ScriptPane(this.ui.client);\r\n\tthis.addNewPaneDOM(qpane);\r\n}\r\n\r\nTerminusQueryViewer.prototype.addQueryPaneDOM = function(){\r\n\tlet qpane = new QueryPane(this.ui.client).options({showQuery: true, editQuery: true});\r\n\tthis.addNewPaneDOM(qpane);\r\n}\r\n\r\nTerminusQueryViewer.prototype.setNewDocumentPaneDOM = function(){\r\n\tthis.new_pane = new DocumentPane(this.ui.client).options({showQuery: true, editQuery: true});\r\n\tthis.new_pane_type = \"document\";\r\n}\r\n\r\nTerminusQueryViewer.prototype.addDocumentPaneDOM = function(){\r\n\tlet qpane = new DocumentPane(this.ui.client).options({showQuery: true, editQuery: true});\r\n\tthis.addNewPaneDOM(qpane);\r\n}\r\n\r\nTerminusQueryViewer.prototype.addNewPaneDOM = function(qpane){\r\n\tvar lpane = this.panes[this.panes.length-1];\r\n\t//if(lpane && lpane.empty()){\r\n\t//\tthis.panes[this.panes.length-1] = qpane;\r\n\t//\tthis.paneDOM.removeChild(this.paneDOM.lastChild)\t\t \r\n\t//}\r\n\t//else {\r\n\t\tthis.panes.push(qpane);\r\n\t//}\r\n\tvar qdom = qpane.getAsDOM();\r\n\tvar qhdr = this.getPaneHeader();\r\n\tqdom.prepend(qhdr);\r\n\tthis.paneDOM.appendChild(qdom);\r\n}\r\n\r\nTerminusQueryViewer.prototype.getAsDOM = function(q){\r\n\tTerminusClient.FrameHelper.removeChildren(this.container);\r\n\tif(!this.paneDOM) this.paneDOM = this.getPanesDOM();\r\n\tthis.container.appendChild(this.paneDOM);\r\n\tthis.controlDOM = this.getControlsDOM();\r\n\t//this.container.appendChild(this.controlDOM);\r\n\tvar newPaneButton = document.createElement('button');\r\n\t\tnewPaneButton.setAttribute('class', 'terminus-btn terminus-query-btn');\r\n\t\tnewPaneButton.appendChild(document.createTextNode('Add New Query'));\r\n\t\tnewPaneButton.addEventListener('click', () => this.addQueryPaneDOM());\t    \r\n\tthis.container.appendChild(newPaneButton);\r\n\treturn this.container;\r\n}\r\n\r\nTerminusQueryViewer.prototype.getPanesDOM = function(q){\r\n\tthis.panesDOM = document.createElement(\"div\");\r\n\tthis.panesDOM.setAttribute(\"class\", \"terminus-query-panes\");\r\n\tfor(var i = 0; i<this.panes.length; i++){\r\n\t\tvar pd = this.panes[i].getAsDOM();\r\n\t\tvar qhdr = this.getPaneHeader();\r\n\t\tpd.prepend(qhdr);\r\n\t\tthis.panesDOM.appendChild(pd);\r\n\t}\r\n\tif(!this.new_pane){\r\n\t\tthis.new_pane = this.getNewQueryPane();\r\n\t}\r\n\tvar npd = this.new_pane.getAsDOM();\r\n\tvar nqhdr = this.getNewPaneHeader();\r\n\tthis.new_pane.headerDOM = nqhdr;\r\n\tthis.new_pane.paneDOM = npd;\r\n\tnpd.prepend(nqhdr);\r\n\tthis.panesDOM.appendChild(npd);\r\n\treturn this.panesDOM;\r\n}\r\n\r\nTerminusQueryViewer.prototype.removePane = function(pane, index){\r\n\tTerminusClient.FrameHelper.removeChildren(pane.paneDOM);\r\n\tpane.paneDOM.appendChild(pane.headerDOM);\r\n\tif(this.panes[i]){\r\n\t\tthis.panes.splice(i, 1);\r\n\t}\r\n}\r\n\r\nTerminusQueryViewer.prototype.showPane = function(pane){\r\n\t//TerminusClient.FrameHelper.removeChildren(pane.paneDOM);\r\n\t//var pd = pane.getAsDOM();\r\n\t//var qhdr = this.getPaneHeader();\r\n\t//pd.prepend(qhdr);\r\n\t//pane.headerDOM = qhdr;\t\r\n}\r\n\r\nTerminusQueryViewer.prototype.hidePane = function(pane){\r\n\t\r\n}\r\n\r\n\r\n\r\nTerminusQueryViewer.prototype.getPaneHeader = function(){\r\n\tvar hdr = document.createElement(\"div\");\r\n\t//hdr.appendChild(this.getControlsDOM());\r\n\treturn hdr;\r\n}\r\n\r\nTerminusQueryViewer.prototype.getNewPaneHeader = function(){\r\n\tvar hdr = document.createElement(\"div\");\r\n\t//hdr.appendChild(this.getControlsDOM(\"new\"));\r\n\treturn hdr;\r\n}\r\n\r\nTerminusQueryViewer.prototype.getControlsDOM = function(isnew){\r\n\tvar c = document.createElement(\"div\");\r\n\tc.setAttribute(\"class\", \"terminus-query-page-controls\");    \r\n\tif(isnew == \"new\"){\r\n\t\tvar newPaneButton = document.createElement('button');\r\n\t\tnewPaneButton.setAttribute('class', 'terminus-btn terminus-query-btn');\r\n\t\tnewPaneButton.appendChild(document.createTextNode('WOQL Query'));\r\n\t\t//newPaneButton.addEventListener('click', () => this.addQueryPaneDOM());\t    \r\n\t\tc.appendChild(newPaneButton);\r\n\t\tvar newScriptButton = document.createElement('button');\r\n\t\tnewScriptButton.setAttribute('class', 'terminus-btn terminus-query-btn');\r\n\t\tnewScriptButton.appendChild(document.createTextNode('Script'));\r\n\t\t//newScriptButton.addEventListener('click', () => this.addScriptPaneDOM());\t    \r\n\t\tc.appendChild(newScriptButton);\r\n\t\tvar newDocButton = document.createElement('button');\r\n\t\tnewDocButton.setAttribute('class', 'terminus-btn terminus-query-btn');\r\n\t\tnewDocButton.appendChild(document.createTextNode('Document Query'));\r\n\t\tnewDocButton.addEventListener('click', () => this.setNewDocumentPaneDOM());\t    \r\n\t\tc.appendChild(newDocButton);\r\n\t}\r\n\telse {\r\n\t\tvar savePaneButton = document.createElement('button');\r\n\t\tsavePaneButton.setAttribute('class', 'terminus-btn terminus-query-btn');\r\n\t\tsavePaneButton.appendChild(document.createTextNode('Save'));\r\n\t\tc.appendChild(savePaneButton);\r\n\t\tvar closePaneButton = document.createElement('button');\r\n\t\tclosePaneButton.setAttribute('class', 'terminus-btn terminus-query-btn');\r\n\t\tclosePaneButton.appendChild(document.createTextNode('Close'));\r\n\t\tc.appendChild(closePaneButton);\r\n\t\tvar collapsePaneButton = document.createElement('button');\r\n\t\tcollapsePaneButton.setAttribute('class', 'terminus-btn terminus-query-btn');\r\n\t\tcollapsePaneButton.appendChild(document.createTextNode('Collapse'));\t\t\r\n\t\tc.appendChild(collapsePaneButton);\r\n\t}\r\n\treturn c;\r\n}\r\n\r\n\r\nmodule.exports=TerminusQueryViewer\r\n","const TerminusClient = require('@terminusdb/terminus-client');\r\nconst TerminusCodeSnippet = require('./query/TerminusCodeSnippet');\r\nconst UTILS = require('../Utils');\r\n\r\nfunction ScriptPane(client, script){\r\n\tthis.client = client;\r\n\tthis.script = (script ? script : \"\");\r\n\tthis.container = document.createElement('div');\r\n    this.container.setAttribute('class', 'terminus-script-pane-cont');\r\n}\r\n\r\nScriptPane.prototype.empty = function(){\r\n\treturn this.script == \"\";\r\n}\r\n\r\n\r\nScriptPane.prototype.createInput = function(ui){\r\n\tlet input = new TerminusCodeSnippet(\"code\", \"edit\");\r\n\tif(this.script){\r\n\t\tinput.setQuery(this.script);\r\n\t}\r\n\tvar self = this;\r\n\tinput.submit = function(qObj){\r\n\t\tself.executeScript(qObj, ui);\r\n\t};\r\n\treturn input;\r\n}\r\n\r\n\r\nScriptPane.prototype.executeScript = function(script, ui){\r\n    if(ui) ui.clearMessages();\r\n    this.script = script;\r\n\tvar client = this.client;\r\n\tvar WOQL = TerminusClient.WOQL;\r\n\ttry {\r\n\t\tvar res = eval(script);\r\n\t\tif(res){\r\n\t\t\tthis.updateResult(res);\r\n\t\t}\r\n\t\telse {\r\n\t\t\t//executed ok message \r\n\t\t}\r\n\t}\r\n\tcatch(e){\r\n\t\tif(ui) ui.showError(e);\r\n\t\tconsole.error(e);\r\n\t}\r\n}\r\n\r\nScriptPane.prototype.showOKMessage = function(){\r\n    var msg = document.createTextNode(\"Script executed ok\");\r\n    this.updateResult(msg);\r\n}\r\n\r\nScriptPane.prototype.updateResult = function(res){\r\n    TerminusClient.FrameHelper.removeChildren(this.resultDOM);\r\n    this.resultDOM.appendChild(res);\r\n}\r\n\r\n\r\nScriptPane.prototype.getAsDOM = function(ui){\r\n\tthis.container.appendChild(UTILS.getHeaderDom('Enter Script'));\r\n\tthis.input = this.createInput(ui);\r\n\tthis.container.appendChild(this.input.getAsDOM());\r\n\tthis.resultDOM = document.createElement(\"div\");\r\n\tthis.resultDOM.setAttribute(\"class\", \"terminus-script-results\"); \r\n\t//var form = (this.input.format == \"js\" ? \"javascript\" : \"json\");\r\n\t//UTILS.stylizeEditor(ui, this.input.snippet, {width: this.input.width, height: this.input.height}, form);\r\n\tif(this.result){\r\n        this.resultDOM.appendChild(this.result);\r\n    }\r\n\tthis.container.appendChild(this.resultDOM);\r\n\treturn this.container;\r\n}\r\n\r\n\r\nmodule.exports = ScriptPane;\r\n","/*\r\n * Draws the screen for viewing and updating the schema\r\n * and provides wrappers around the client's schema API\r\n */\r\nconst TerminusHTMLViewer = require('./html/TerminusHTMLViewer');\r\nconst UTILS=require('./Utils')\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction TerminusSchemaViewer(ui){\r\n\tthis.ui = ui;\r\n\tthis.mode = \"view\";\r\n\tthis.format = \"turtle\";\r\n\tthis.confirm_before_update = false;\r\n\tthis.thv = new TerminusHTMLViewer(this.ui.client);\r\n\tlet WOQL = TerminusClient.WOQL;\r\n\tthis.woql = WOQL;\r\n}\r\n\r\nTerminusSchemaViewer.prototype.changeHeaders = function() {\r\n\tvar table = this.woql.table();\r\n\ttable.column('Comment').header('Description');\r\n\treturn table;\r\n}\r\n\r\nTerminusSchemaViewer.prototype.setGraphSize = function(){\r\n\tvar graph = this.woql.graph();\r\n\tgraph.source(\"v:Subject\");\r\n\tvar licon2 = { color: [255,255,25], weight: 100, unicode: \"\\uf2bb\", size:2 };\r\n\tgraph.edge(\"v:Subject\", \"v:Object\").icon(licon2);\r\n\tgraph.width(1223);\r\n\treturn graph;\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getOWLView = function(){\r\n\tthis.mode = 'view'; // reset mode\r\n\tthis.loadSchema();\r\n}\r\n\r\nTerminusSchemaViewer.prototype.appendRuleViews = function(){\r\n\tthis.view.appendChild(UTILS.getHeaderDom('Classes'));\r\n\tthis.appendClassViews(this.woql.table());\r\n\tthis.appendClassViews(this.woql.graph());\r\n\tthis.view.appendChild(UTILS.getHeaderDom('Properties'));\r\n\tthis.appendPropertyViews(this.woql.table());\r\n\tthis.appendPropertyViews(this.woql.graph());\r\n}\r\n\r\nTerminusSchemaViewer.prototype.appendPropertyViews = function(config){\r\n\tthis.qprops.first();\r\n\tvar n = this.thv.showResult(this.qprops, config, false);\r\n\tthis.view.appendChild(n);\r\n}\r\n\r\nTerminusSchemaViewer.prototype.appendClassViews = function(config){\r\n\tthis.qclasses.first();\r\n\tvar n = this.thv.showResult(this.qclasses, config, false);\r\n\tthis.view.appendChild(n);\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getAllProperties = function(){\r\n\tlet query = this.woql.from(this.ui.client.connectionConfig.dbURL())\r\n\t\t\t\t\t\t .limit(25)\r\n\t\t\t\t\t\t .start(0)\r\n\t\t\t\t\t\t .propertyMetadata();\r\n    var self = this;\r\n    query.execute(this.ui.client).then((results) => {\r\n\t\tlet qres = new TerminusClient.WOQLResult(results, query);\r\n\t\tself.qprops = qres;\r\n\t\tthis.view.appendChild(UTILS.getHeaderDom('Table & Graph View of Properties'));\r\n\t\tvar table = self.changeHeaders();\r\n\t\tvar graph = self. setGraphSize();\r\n\t\tself.appendPropertyViews(table);\r\n\t\tself.appendPropertyViews(graph);\r\n\t})\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getAllClasses = function(){\r\n\tlet query = this.woql.from(this.ui.client.connectionConfig.dbURL())\r\n\t\t\t\t\t\t .limit(25)\r\n\t\t\t\t\t\t .start(0)\r\n\t\t\t\t\t\t .classMetadata();\r\n    var self = this;\r\n    query.execute(this.ui.client).then((results) => {\r\n\t\tlet qres = new TerminusClient.WOQLResult(results, query);\r\n\t\tself.qclasses = qres;\r\n\t\tself.view.appendChild(UTILS.getHeaderDom('Table & Graph View of Classes'));\r\n\t\tvar table = self.changeHeaders();\r\n\t\tvar graph = self. setGraphSize();\r\n\t\tself.appendClassViews(table);\r\n\t\tself.appendClassViews(graph);\r\n\t})\r\n}\r\n\r\nTerminusSchemaViewer.prototype.defineViewAction = function(a, view){\r\n\tTerminusClient.FrameHelper.removeChildren(this.view);\r\n\tUTILS.setSelectedSubMenu(a);\r\n\tswitch(view){\r\n\t\tcase 'table':\r\n\t\t\tthis.appendRuleViews();\r\n\t\tbreak;\r\n\t\tcase 'owl':\r\n\t\t\tthis.getOWLView();\r\n\t\tbreak;\r\n\t\tdefault:\r\n\t\t\tconsole.log('Invalid view passed in TerminusSchema.js')\r\n\t\tbreak;\r\n\t}\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getTabs = function(view){\r\n\tvar a = document.createElement('a');\r\n    a.setAttribute('class', 'terminus-a terminus-hz-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\r\n    //if(navConfig.defaultSelected) a.classList.add('terminus-selected');\r\n    var self = this;\r\n    a.addEventListener(\"click\", function(){\r\n        self.defineViewAction(this, view);\r\n    })\r\n\tif(view == 'owl')\r\n\t\tvar t = view.toUpperCase();\r\n\telse var t = view.charAt(0).toUpperCase() + view.slice(1)\r\n\ta.appendChild(document.createTextNode(t + ' View'));\r\n    return a;\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getSchemaViews = function(){\r\n\tvar ul = document.createElement('ul');\r\n    ul.setAttribute('class', 'terminus-ul-horizontal');\r\n\tvar tview = this.getTabs('table');\r\n\ttview.classList.add('terminus-submenu-selected'); // default view is table\r\n\tul.appendChild(tview);\r\n\tul.appendChild(this.getTabs('owl'));\r\n\tthis.controldom.appendChild(ul);\r\n\tthis.getAllClasses();\r\n\tthis.getAllProperties();\r\n}\r\n\r\n/*\r\n * Retrieves schema from API and writes the response into the page\r\n */\r\nTerminusSchemaViewer.prototype.getAsDOM = function(){\r\n\tthis.holder = document.createElement(\"div\");\r\n\tthis.controldom = document.createElement(\"div\");\r\n\tthis.controldom.setAttribute(\"class\", \"terminus-schema-controls\");\r\n\tthis.view = document.createElement(\"div\");\r\n\tthis.view.setAttribute(\"class\", \"terminus-schema-view\");\r\n\tthis.getSchemaViews();\r\n\tthis.pagedom = document.createElement(\"div\");\r\n\tthis.pagedom.setAttribute(\"class\", \"terminus-schema-viewer\");\r\n\t//this.loadSchema();\r\n\tthis.holder.appendChild(this.controldom);\r\n\tthis.controldom.appendChild(this.view);\r\n\tthis.holder.appendChild(this.pagedom);\r\n\treturn this.holder;\r\n}\r\n\r\nTerminusSchemaViewer.prototype.loadSchema = function(msg, msgtype){\r\n\tvar self = this;\r\n\tthis.ui.showBusy(\"Fetching Database Schema\");\r\n\tthis.ui.client.getSchema(false, {\"terminus:encoding\": \"terminus:\" + this.format})\r\n\t.then(function(response){\r\n\t\tself.ui.clearBusy();\r\n\t\tself.schema = response;\r\n\t\tself.refreshPage(msg, msgtype);\r\n\t})\r\n\t.catch(function(error){\r\n\t\tself.ui.clearBusy();\r\n\t\tself.ui.showError(error);\r\n\t});\r\n}\r\n\r\nTerminusSchemaViewer.prototype.resetControlDOM = function(){\r\n\tTerminusClient.FrameHelper.removeChildren(this.view);\r\n\tif(this.mode == \"edit\"){\r\n\t\tthis.view.appendChild(this.getSchemaSaveButtons());\r\n\t}\r\n\telse if(this.mode == \"import\"){\r\n\t\tthis.view.appendChild(this.getSchemaImportActionButtons());\r\n\t}\r\n\telse if(this.mode == \"class_frame\"){\r\n\t\tif(this.ui.showControl(\"get_schema\")){\r\n\t\t\tthis.view.appendChild(this.getShowSchemaButton());\r\n\t\t}\r\n\t\tif(this.ui.showControl(\"class_frame\")){\r\n\t\t\tthis.view.appendChild(this.getClassFrameChooser());\r\n\t\t}\r\n\t}\r\n\telse if(this.mode == \"view\"){\r\n\t\tif(this.ui.showControl(\"update_schema\")){\r\n\t\t\tthis.view.appendChild(this.getSchemaEditButton());\r\n\t\t}\r\n\t\tif(this.ui.showControl(\"import_schema\")){\r\n\t\t\tthis.view.appendChild(this.getImportButton());\r\n\t\t}\r\n\t\tif(this.ui.showControl(\"add_new_library\")){\r\n\t\t\tthis.view.appendChild(this.getNewLibaryButton());\r\n\t\t}\r\n\t\tif(this.ui.showControl(\"class_frame\")){\r\n\t\t\tthis.view.appendChild(this.getClassFrameChooser());\r\n\t\t}\r\n\t}\r\n}\r\n/*\r\nTerminusSchemaViewer.prototype.getFormatChoices = function(){\r\n\tvar fc = document.createElement(\"select\");\r\n\tfc.setAttribute(\"class\", \"terminus-form-select terminus-schema-format terminus-type-select\");\r\n\tvar tc = document.createElement(\"option\");\r\n\ttc.setAttribute(\"class\", \"terminus-schema-turtle\");\r\n\ttc.value = \"turtle\";\r\n\ttc.appendChild(document.createTextNode(\"Turtle\"));\r\n\tif(this.format == \"turtle\") tc.selected = true;\r\n\tfc.appendChild(tc);\r\n\tvar tj = document.createElement(\"option\");\r\n\ttj.setAttribute(\"class\", \"terminus-schema-jsonld\");\r\n\ttj.value = \"jsonld\";\r\n\ttj.appendChild(document.createTextNode(\"Json LD\"));\r\n\tif(this.format == \"jsonld\") tj.selected = true;\r\n\tfc.appendChild(tj);\r\n\tvar self = this;\r\n\tfc.addEventListener(\"change\", function(e){\r\n\t\tself.format = this.value;\r\n\t\tself.loadSchema();\r\n\t});\r\n\treturn fc;\r\n}\r\n*/\r\n\r\nTerminusSchemaViewer.prototype.refreshPage = function(msg, msgtype){\r\n\tif(this.view) {\r\n\t\tthis.resetControlDOM();\r\n\t\tthis.refreshMainPage(msg, msgtype);\r\n\t}\r\n\t/*if(this.controldom)\tthis.resetControlDOM();\r\n\tif(this.pagedom) this.refreshMainPage(msg, msgtype);*/\r\n}\r\n\r\nTerminusSchemaViewer.prototype.refreshMainPage = function(msg, msgtype){\r\n\tTerminusClient.FrameHelper.removeChildren(this.pagedom);\r\n\tif(this.mode == 'view'){\r\n\t\tthis.view.appendChild(this.getSchemaViewDOM());\r\n\t}\r\n\telse if(this.mode == \"edit\"){\r\n\t\tthis.view.appendChild(this.getSchemaEditDOM());\r\n\t}\r\n\telse if(this.mode == \"import\"){\r\n\t\tthis.view.appendChild(this.getSchemaImportDOM());\r\n\t}\r\n\tif(msg){\r\n\t\tthis.ui.showMessage(msg, msgtype);\r\n\t}\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getSchemaSaveButtons = function(){\r\n\tvar ssb = document.createElement(\"span\");\r\n\tssb.setAttribute(\"class\", \"terminus-schema-save-buttons\");\r\n\tssb.appendChild(this.getCancelButton());\r\n\tssb.appendChild(this.getSaveButton());\r\n\treturn ssb;\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getSchemaImportActionButtons = function(){\r\n\tvar ssb = document.createElement(\"span\");\r\n\tssb.setAttribute(\"class\", \"terminus-schema-import-buttons\");\r\n\tssb.appendChild(this.getCancelButton(true));\r\n\tssb.appendChild(this.getImportSaveButton());\r\n\treturn ssb;\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getShowSchemaButton = function(){\r\n\tvar self = this;\r\n\tvar func = function(){\r\n\t\tself.ui.clearMessages();\r\n\t\tself.mode = \"view\";\r\n\t\tself.refreshPage();\r\n\t}\r\n\treturn this.getSchemaButton(\"View Schema\", \"get_schema\", func);\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getImportPreviewButton = function(){\r\n\tvar self = this;\r\n\tvar func = function(){\r\n\t\tself.ui.clearMessages();\r\n\t\tself.mode = \"preview\";\r\n\t\tself.refreshPage();\r\n\t}\r\n\treturn this.getSchemaButton(\"Preview\", \"preview\", func);\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getCancelButton = function(is_import){\r\n\tvar self = this;\r\n\tvar func = function(){\r\n\t\tself.ui.clearMessages();\r\n\t\tself.mode = \"view\";\r\n\t\tif(is_import){\r\n\t\t\tself.ui.redraw();\r\n\t\t}\r\n\t\telse {\r\n\t\t\tself.refreshPage();\r\n\t\t}\r\n\t}\r\n\treturn this.getSchemaButton(\"Cancel\", \"cancel_update\", func);\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getImportSaveButton = function(){\r\n\tvar self = this;\r\n\tvar func = function(){\r\n\t\tself.ui.clearMessages();\r\n\t\tif(typeof self.doImport == \"function\"){\r\n\t\t\tself.doImport();\r\n\t\t}\r\n\t}\r\n\treturn this.getSchemaButton(\"Import\", \"import_schema\", func)\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getSaveButton = function(){\r\n\tvar self = this;\r\n\tvar func = function(){\r\n\t\tself.ui.clearMessages();\r\n\t\tvar text = self.schema_edit_dom.value;\r\n\t\tif(typeof(self.schema) == \"object\"){\r\n\t\t\ttext = JSON.parse(text);\r\n\t\t}\r\n\t\tvar opts = {};\r\n\t\topts['terminus:encoding'] =  'terminus:' + self.format;\r\n\t\tif(!(TerminusClient.FrameHelper.empty(self.schema_edit_dom_name)))\r\n\t\t\topts['schemaId'] = self.ui.client.connectionConfig.dbURL() + '/' + self.schema_edit_dom_name.value;\r\n\t\telse opts['schemaId'] = self.ui.client.connectionConfig.dbURL() + '/' + 'schema';\r\n\t\treturn self.updateSchema(text, opts);\r\n\t}\r\n\treturn this.getSchemaButton(\"Save\", \"update_schema\", func);\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getSchemaEditButton = function(){\r\n\tvar self = this;\r\n\tvar func = function(){\r\n\t\tself.mode = \"edit\";\r\n\t\tself.refreshPage();\r\n\t}\r\n\treturn this.getSchemaButton(\"Edit\", \"update_schema\", func);\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getNewLibaryButton = function(){  //add_new_library\r\n\tvar self = this;\r\n\tvar func = function(){\r\n\t\tself.ui.clearMessages();\r\n\t\tself.mode = \"edit\";\r\n\t\tself.refreshPage();\r\n\t}\r\n\treturn this.getSchemaButton(\"New Library\", \"add_new_library\", func);\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getImportButton = function(){\r\n\tvar self = this;\r\n\tvar func = function(){\r\n\t\tself.ui.clearMessages();\r\n\t\tself.mode = \"import\";\r\n\t\tself.refreshPage();\r\n\t}\r\n\treturn this.getSchemaButton(\"Import New Schema\", \"import_schema\", func);\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getSchemaButton = function(label, action, func){\r\n\tvar opt = document.createElement(\"button\");\r\n\topt.appendChild(document.createTextNode(label));\r\n\topt.setAttribute(\"class\", \"terminus-btn terminus-control-button terminus-schema-\" + action);\r\n\topt.addEventListener(\"click\", func);\r\n\treturn opt;\r\n}\r\n\r\n/*\r\n * Updates schema, then fetches updated version and updates the page with it\r\n */\r\nTerminusSchemaViewer.prototype.updateSchema  = function(text, opts) {\r\n\tthis.ui.showBusy(\"Updating Database Schema\");\r\n\tvar self = this;\r\n\treturn this.ui.client.updateSchema(false, text, opts)\r\n\t.then(function(response){\r\n\t\tif(response['terminus:status'] && response['terminus:status'] == \"terminus:success\"){\r\n\t\t\tself.ui.showBusy(\"Retrieving updated schema\");\r\n\t\t\tself.mode = \"view\";\r\n\t\t\tself.loadSchema(\"Successfully Updated Schema\");\r\n\t\t\tself.ui.redraw();\r\n\t\t}\r\n\t\telse if(response['terminus:status'] && response['terminus:status'] == \"terminus:failure\"){\r\n\t\t\tself.ui.clearBusy();\r\n\t\t\tself.ui.showViolations(response['terminus:witnesses'], \"schema\");\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthrow new Error(\"Update Schema returned no terminus:status code\");\r\n\t\t}\r\n\t})\r\n\t.catch(function(error){\r\n\t\tself.ui.clearBusy();\r\n\t\tif(error.data && error.data['terminus:witnesses']){\r\n\t\t\tself.ui.showViolations(error.data['terminus:witnesses'], \"schema\");\r\n\t\t}\r\n\t\telse {\r\n\t\t\tself.ui.showError(error);\r\n\t\t}\r\n\t});\r\n}\r\n\r\n/*\r\n * Imports a schema from the passed url\r\n * mode: replace | append\r\n */\r\nTerminusSchemaViewer.prototype.load  = function(url, key, mode){\r\n\tvar self = this;\r\n\tmode = (mode ? mode : \"replace\");\r\n\tthis.ui.showBusy(\"Loading schema from \" + url);\r\n\tvar origurl = this.ui.client.connectionConfig.schemaURL();\r\n\treturn this.ui.client.getSchema(url, {\"terminus:user_key\": key, \"terminus:encoding\" : \"terminus:\" + this.format})\r\n\t.then(function(response){\r\n\t\tvar newschema = (mode == \"append\") ? self.appendSchema(response) : response;\r\n\t\tif(self.confirm_before_update){\r\n\t\t\t//reconnect to original db\r\n\t\t\tself.ui.showResult(\"Schema retrieved - click save to deploy\");\r\n\t\t\tself.ui.client.connectionConfig.setSchemaURL(origurl);\r\n\t\t\tself.showConfirmPage(newschema);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tself.ui.showBusy(\"Updating schema\");\r\n\t\t\tself.ui.client.connectionConfig.setSchemaURL(origurl);\r\n\t\t\tself.updateSchema(newschema, {\"terminus:encoding\": \"terminus:\" + self.format}).then(function(response){\r\n\t\t\t\tself.mode = \"view\";\r\n\t\t\t\tself.ui.clearBusy();\r\n\t\t\t\tself.ui.redraw();\r\n\t\t\t\tself.ui.showResult(\"Successfully deployed new schema from \" + url);\r\n\t\t\t\treturn response;\r\n\t\t\t});\r\n\t\t}\r\n\t}).catch(function(error){\r\n\t\tself.ui.clearBusy();\r\n\t\tself.ui.showError(error);\r\n\t});\r\n}\r\n\r\nTerminusSchemaViewer.prototype.appendSchema = function(s2){\r\n\tvar nschema = this.schema;\r\n\tif(this.format == 'turtle'){\r\n\t\tnschema = this.schema + s2;\r\n\t}\r\n\telse if(this.format == 'jsonld'){\r\n\t\tfor(var i in s2){\r\n\t\t\tnschema[i] = s2[i];\r\n\t\t}\r\n\t}\r\n\treturn nschema;\r\n}\r\n\r\n\r\n\r\n\r\nTerminusSchemaViewer.prototype.showConfirmPage = function(newschema){\r\n\tthis.schema = newschema;\r\n\tthis.confirm_before_update = false;\r\n\tthis.mode = \"edit\";\r\n\tthis.refreshPage(\"Confirm new schema\");\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getSchemaNameInputDOM = function(np){\r\n\tvar label = document.createElement('label');\r\n    label.setAttribute('class', 'terminus-control-label');\r\n\tlabel.setAttribute('for', 'basicinput');\r\n    label.appendChild(document.createTextNode('Schema name:'));\r\n\tvar sid = document.createElement('input');\r\n\tsid.setAttribute('class', 'terminus-input-text terminus-schema-id-display');\r\n\tsid.setAttribute('placeholder', 'Enter schema name');\r\n\tnp.appendChild(label);\r\n\tnp.appendChild(sid);\r\n\treturn sid;\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getSchemaEditDOM = function(){\r\n\tvar np = document.createElement(\"div\");\r\n\tnp.setAttribute(\"class\", \"terminus-schema-page terminus-schema-edit-page\");\r\n\tif(this.ui.showControl(\"add_new_library\")) var sid = this.getSchemaNameInputDOM(np);\r\n\tvar ipval = document.createElement(\"textarea\");\r\n\tipval.setAttribute(\"class\", \"terminus-schema-edit terminus-schema-textarea\");\r\n\tipval.setAttribute(\"width\", \"100%\");\r\n\tipval.setAttribute(\"style\", \"min-width: 400px; min-height: 400px;\");\r\n\tif(typeof(this.schema) == \"string\"){\r\n\t\tipval.innerHTML = this.schema;\r\n\t}\r\n\telse if(typeof (this.schema) == \"object\") {\r\n\t\tipval.innerHTML = JSON.stringify(this.schema, 0, 4);\r\n\t}\r\n\tif(this.ui.showControl(\"add_new_library\")) this.schema_edit_dom_name = sid;\r\n\tthis.schema_edit_dom = ipval;\r\n\tnp.appendChild(ipval);\r\n\tUTILS.stylizeEditor(this.ui, ipval, 'schema', 'turtle');\r\n\treturn np;\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getSchemaViewDOM = function(){\r\n\tvar self = this;\r\n\tvar np = document.createElement(\"div\");\r\n\tnp.setAttribute(\"class\", \"terminus-schema-page terminus-schema-view-page\");\r\n\tvar ipval = document.createElement(\"pre\");\r\n\tipval.setAttribute(\"class\", \"terminus-schema-view terminus-scheme-pre\");\r\n\tif(typeof(this.schema) == \"string\"){\r\n\t\tvar txt = this.schema.replace(/&/g, \"&amp;\")\r\n         .replace(/</g, \"&lt;\")\r\n         .replace(/>/g, \"&gt;\")\r\n         .replace(/\"/g, \"&quot;\")\r\n         .replace(/'/g, \"&#039;\");\r\n\t\tipval.innerHTML = txt;\r\n\t}\r\n\telse if(typeof (this.schema) == \"object\") {\r\n\t\tipval.innerHTML = JSON.stringify(this.schema, 0, 4);\r\n\t}\r\n\tvar cm = UTILS.stylizeCodeDisplay(this.ui, ipval, np, 'turtle');\r\n\tif(!cm) np.appendChild(ipval);\r\n\treturn np;\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getSchemaImportDOM = function(){\r\n\tvar scd = document.createElement(\"div\");\r\n\tscd.setAttribute(\"class\", \"terminus-form-border terminus-schema-page terminus-schema-import-page\");\r\n\r\n\r\n\tvar sci = document.createElement(\"div\");\r\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-form-field-spacing terminus-form-horizontal terminus-control-group\");\r\n\tvar slab = document.createElement(\"span\");\r\n\tslab.setAttribute(\"class\", \"terminus-url-loader-input terminus-form-label terminus-control-label\");\r\n\tslab.appendChild(document.createTextNode(\"URL\"));\r\n\tsci.appendChild(slab);\r\n\tvar inpUrl  = document.createElement(\"input\");\r\n\tinpUrl.setAttribute(\"type\", \"text\");\r\n\tinpUrl.setAttribute(\"class\", \"terminus-form-value terminus-input-text terminus-form-url terminus-url-connect\");\r\n\tinpUrl.setAttribute(\"placeholder\", \"Enter URL of DB to import from\");\r\n\tsci.appendChild(inpUrl);\r\n\tscd.appendChild(sci);\r\n\r\n\tvar sci = document.createElement(\"div\");\r\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-form-field-spacing terminus-form-horizontal terminus-control-group\");\r\n\tvar klab = document.createElement(\"span\");\r\n\tklab.setAttribute(\"class\", \"terminus-url-loader-input terminus-form-label  terminus-control-label terminus-import_mode-input\");\r\n\tklab.appendChild(document.createTextNode(\"Import Mode\"));\r\n\tsci.appendChild(klab);\r\n\tvar modes = document.createElement(\"select\");\r\n\tmodes.setAttribute(\"class\", \"terminus-form-select\");\r\n\r\n\tvar overwrite = document.createElement(\"option\");\r\n\toverwrite.value = \"replace\";\r\n\toverwrite.appendChild(document.createTextNode(\"Replace Mode\"))\r\n\tmodes.appendChild(overwrite);\r\n\tvar append = document.createElement(\"option\");\r\n\tappend.value = \"append\";\r\n\tappend.appendChild(document.createTextNode(\"Append Mode\"))\r\n\tmodes.appendChild(append);\r\n\tmodes.setAttribute(\"class\", \"terminus-form-select terminus-import-mode\");\r\n\tsci.appendChild(klab);\r\n\tsci.appendChild(modes);\r\n\tscd.appendChild(sci);\r\n\r\n\tvar sci = document.createElement(\"div\");\r\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-form-field-spacing terminus-form-horizontal terminus-control-group\");\r\n\tvar klab = document.createElement(\"span\");\r\n\tklab.setAttribute(\"class\", \"terminus-form-label terminus-url-key-input terminus-control-label\");\r\n\tklab.appendChild(document.createTextNode(\"Key\"))\r\n\tvar key = document.createElement(\"input\");\r\n\tkey.setAttribute(\"type\", \"text\");\r\n\tkey.setAttribute(\"class\", \"terminus-form-value terminus-input-text terminus-url-key\");\r\n\tsci.appendChild(klab);\r\n\tsci.appendChild(key);\r\n\tscd.appendChild(sci);\r\n\tvar self = this;\r\n\tthis.doImport = function(){\r\n\t\tif(inpUrl.value){\r\n\t\t\tself.load(inpUrl.value, key.value, modes.value);\r\n\t\t}\r\n\t}\r\n\treturn scd;\r\n}\r\n\r\nmodule.exports=TerminusSchemaViewer\r\n","const TerminusClient = require('@terminusdb/terminus-client');\r\nconst WOQLRule = require(\"../viewer/WOQLRule\");\r\nconst WOQLTable = require(\"../viewer/WOQLTable\");\r\nconst WOQLChooser = require(\"../viewer/WOQLChooser\");\r\n//const WOQLQueryViewer = require(\"./viewer/WOQLQueryView\");\r\nconst WOQLGraph = require(\"../viewer/WOQLGraph\");\r\nconst WOQLStream = require(\"../viewer/WOQLStream\");\r\nconst TerminusFrame = require(\"../viewer/TerminusFrame\");\r\nconst Datatypes = require(\"./Datatypes\");\r\nconst SimpleTable = require(\"./table/SimpleTable\");\r\nconst SimpleGraph = require(\"./graph/SimpleGraph\");\r\nconst SimpleStream = require(\"./stream/SimpleStream\");\r\n//const SimpleTextbox = require(\"./html/query/SimpleTextbox\");\r\nconst SimpleChooser = require(\"./chooser/SimpleChooser\");\r\nconst SimpleDocument = require(\"./document/SimpleDocument\");\r\nconst DocumentTable = require(\"./document/DocumentTable\");\r\nconst SimpleFrameViewer = require(\"./document/SimpleFrameViewer\");\r\nconst HTMLObjectViewer = require(\"./document/ObjectViewer\");\r\nconst HTMLPropertyViewer = require(\"./document/PropertyViewer\");\r\nconst HTMLDataViewer = require(\"./document/DataViewer\");\r\nconst TerminusCodeSnippet = require('./query/TerminusCodeSnippet');\r\nconst UTILS = require('../Utils');\r\n\r\n/**\r\n * Provides access to the two basic HTML views supported by the system:\r\n * QueryPane(, [rvs])\r\n * DocumentPane(qeditor, [rvs])\r\n * ScriptPane(seditor, sv)\r\n */\r\n\r\n\r\nfunction TerminusHTMLViewer(client){\r\n\tthis.client = client;\r\n}\r\n\r\nTerminusHTMLViewer.prototype.setRenderers = function(config){\r\n}\r\n\r\nTerminusHTMLViewer.prototype.getEditor = function(width, height, placeholder){\r\n    var woql = TerminusClient.WOQL;\r\n\tvar tcs = new TerminusCodeSnippet({}, width, height, placeholder, this.mode);\r\n\tvar snippet = tcs.getAsDOM();\r\n\tvar dimensions = {};\r\n\tdimensions.width = width;\r\n\tdimensions.height = height;\r\n\tUTILS.stylizeEditor(this.ui, snippet.snippetText, dimensions, 'javascript');\r\n\treturn snippet;\r\n}\r\n\r\nTerminusHTMLViewer.prototype.showConfigEditor = function(result, config, span){\r\n    var cSnippet = this.getEditor(300, 250,\r\n                        JSON.stringify(config, undefined, 2));\r\n    var self = this;\r\n    cSnippet.actionButton.addEventListener('click', function(){\r\n        try{\r\n            //self.submitConfigRules(woql, cSnippet, qSnippet, rSnippet);\r\n\t\t\tvar cObj = UTILS.getqObjFromInput(cSnippet.snippetText.value);\r\n\t\t\tTerminusClient.FrameHelper.removeChildren(span);\r\n\t\t\tspan.appendChild(self.showResult(result, cObj));\r\n        }\r\n        catch(e){\r\n            //self.ui.showError('Error in config editor: ' + e);\r\n\t\t\tconsole.log('Error in config editor: ' + e);\r\n        }\r\n    })\r\n    return cSnippet;\r\n}\r\n\r\nTerminusHTMLViewer.prototype.submitConfig = function(result, config, span, cdom){\r\n\tvar cSnippet = this.showConfigEditor(result, config, span);\r\n\tcdom.appendChild(cSnippet.dom);\r\n}\r\n\r\nTerminusHTMLViewer.prototype.showConfig = function(result, config, span, cdom){\r\n\tvar cbtn = document.createElement('button');\r\n    //cbtn.setAttribute('style', 'margin-top: 10px;');\r\n    cbtn.setAttribute('class', 'terminus-btn terminus-query-config-btn');\r\n    cbtn.appendChild(document.createTextNode('Config'));\r\n    //rSnippet.dom.appendChild(cbtn);\r\n    //qSnippet.dom.appendChild(cbtn);\r\n    var self = this;\r\n    cbtn.addEventListener('click', function(){\r\n\t\tTerminusClient.FrameHelper.removeChildren(cdom);\r\n        self.submitConfig(result, config, span, cdom);\r\n    })\r\n    return cbtn;\r\n}\r\n\r\nTerminusHTMLViewer.prototype.showResult = function(result, config, cDisplay){\r\n\tlet span = document.createElement(\"span\");\r\n\tspan.setAttribute(\"class\", \"terminus-query-results\");\r\n\tresult.first();\r\n\tlet renderers = {\r\n\t\ttable: new SimpleTable(),\r\n\t\tgraph: new SimpleGraph(),\r\n\t\tstream: new SimpleStream(),\r\n\t\tchooser: new SimpleChooser()\r\n\t}\r\n\tlet viewer = config.create(this.client, renderers, Datatypes.initialiseDataRenderers);\r\n\tviewer.setResult(result);\r\n\tspan.appendChild(viewer.render());\r\n\tvar cdom = document.createElement('div');\r\n\tspan.appendChild(cdom);\r\n\tif(cDisplay) span.appendChild(this.showConfig(result, config, span, cdom));\r\n\treturn span;\r\n}\r\n\r\nTerminusHTMLViewer.prototype.displayResults = function(query, config){\r\n\tlet span = document.createElement(\"span\");\r\n\tspan.setAttribute(\"class\", \"terminus-results\");\r\n\tlet renderers = {\r\n\t\t\ttable: new SimpleTable(),\r\n\t\t\tgraph: new SimpleGraph(),\r\n\t\t//\tstream: [new SimpleStream()],\r\n\t\t\tchoice: new SimpleChooser()\r\n\t}\r\n\tlet viewer = config.create(this.client, renderers, Datatypes.initialiseDataRenderers);\r\n\tif(query){\r\n\t\tthis.loadResults(query, viewer, function(){ span.appendChild(viewer.render()); })\r\n\t}\r\n\telse {\r\n\t\tif(this.last_result){\r\n\t\t\tviewer.setResult(this.last_result);\r\n\t\t\tspan.appendChild(viewer.render());\r\n\t\t}\r\n\t}\r\n\treturn span;\r\n}\r\n\r\nTerminusHTMLViewer.prototype.loadResults = function(query, viewer, then){\r\n\tvar self = this;\r\n\treturn query.execute(this.client).then((results) => {\r\n\t\tself.last_result = new TerminusClient.WOQLResult(results, query);\r\n\t\tviewer.setResult(self.last_result);\r\n\t\tconsole.log('self.last_result', self.last_result);\r\n\t});\r\n}\r\n\r\nTerminusHTMLViewer.prototype.table = function(query, config){\r\n\tvar span = document.createElement(\"span\");\r\n\tspan.setAttribute(\"class\", \"terminus-table\");\r\n\tvar wqt = new WOQLTable(this.client).options(config);\r\n\twqt.setDatatypes(Datatypes.initialiseDataRenderers);\r\n\twqt.setRenderer(new SimpleTable());\r\n\tquery.execute(this.client).then((results) => {\r\n\t\tvar result = new TerminusClient.WOQLResult(results, query);\r\n\t\twqt.setResult(result);\r\n\t\tspan.appendChild(wqt.render());\r\n\t});\r\n\treturn span;\r\n}\r\n\r\nTerminusHTMLViewer.prototype.stream = function(query, config){\r\n\tvar span = document.createElement(\"span\");\r\n\tspan.setAttribute(\"class\", \"terminus-stream\");\r\n\tvar wqt = new WOQLStream(this.client).options(config);\r\n\twqt.setDatatypes(Datatypes.initialiseDataRenderers);\r\n\treturn query.execute(this.client).then((results) => {\r\n\t\tvar result = new WOQLResult(results, query);\r\n\t\tspan.appendChild(wqt.render());\r\n\t});\r\n\treturn span;\r\n}\r\n\r\nTerminusHTMLViewer.prototype.woql = function(query, config){\r\n\tvar span = document.createElement(\"span\");\r\n\tspan.setAttribute(\"class\", \"terminus-woql\");\r\n\tvar wqt = new WOQLQueryViewer(this.client).options(config);\r\n\tspan.appendChild(wqt.render());\r\n\tif(query){\r\n\t\twqt.setQuery(query, true);\r\n\t}\r\n\treturn span;\r\n}\r\n\r\nTerminusHTMLViewer.prototype.ruleEditor = function(){\r\n\r\n}\r\n\r\nTerminusHTMLViewer.prototype.getAddRuleButton = function(cont){\r\n\tvar rbtn = document.createElement('button');\r\n\trbtn.appendChild(document.createTextNode('Add another rule'));\r\n\tvar self = this;\r\n\trbtn.addEventListener('click', function(){\r\n\t\t//self.QueryPane.addResultViewer(\"Choice\", wqc);\r\n\t\t//qp.addResultViewer(\"Choice\", wqc);\r\n\t\t//addResultViewer = function(label, rule, ruleviewer){\r\n\t})\r\n\tcont.appendChild(rbtn);\r\n}\r\n\r\nTerminusHTMLViewer.prototype.getConfigButton = function(cont){\r\n\tvar cbtn = document.createElement('button');\r\n\tcbtn.appendChild(document.createTextNode('Rule'));\r\n\tvar self = this;\r\n\tcbtn.addEventListener('click', function(){\r\n\t\tcont.appendChild(self.ruleEditor());\r\n\t\tself.getAddRuleButton(cont);\r\n\t})\r\n\tcont.appendChild(cbtn);\r\n}\r\n\r\nTerminusHTMLViewer.prototype.querypane = function(query, config){\r\n\tvar span = document.createElement(\"span\");\r\n\tspan.setAttribute(\"class\", \"terminus-woql-pane\");\r\n\tvar qp = new QueryPane(this.client, query);\r\n\tqp.options(config);\r\n\tthis.queryPane = qp;\r\n\tvar wqv = new WOQLQueryViewer(this.client).options(config);\r\n\tthis.queryViewer = wqv;\r\n\r\n\t// Query Viewer\r\n/*\tvar tcs = new TerminusCodeSnippet({}, 800, 250, 'Enter Query', 'edit');\r\n\tvar snippet = tcs.getAsDOM();\r\n\tspan.appendChild(snippet.dom);\r\n\t//span.appendChild(this.ruleEditor());\r\n\tvar abtn = snippet.actionButton;\r\n\tvar self = this; */\r\n\t// On submit query\r\n\t/*abtn.addEventListener('click', function(){\r\n\t\tvar qObj = wqv.getqObjFromInput(snippet.snippetText.value);\r\n\t\tlet t = TerminusClient.WOQL.table();\r\n\t\tconsole.log('t', t);\r\n\r\n\r\n\t\tspan.appendChild(self.displayResults(qObj, t));\r\n\t\tself.getConfigButton(span);\r\n\r\n\t\t/*qObj.execute(self.client).then(function(response){\r\n\t\t\t// default result in table format\r\n\t\t\tlet t = TerminusClient.WOQL.table();\r\n\t\t\tlet res = TerminusClient.WOQLResult(response, qObj, t);\r\n\t\t\t/*t.column(\"Label\").header(\"Document\");\r\n\t\t\tt.column(\"Range\").header(\"Range\");\r\n\t\t\tt.column(\"Domain\").header(\"Domain\");\r\n\t\t\tt.column(\"Comment\").header(\"Description\");\r\n\t\t\tt.column(\"Comment\").renderer(\"HTMLStringViewer\").args({max_cell_size: 20, max_word_size: 10});\r\n\t\t    t.column_order(\"Label\", \"Type\", \"Comment\");*/\r\n\t\t/*\tspan.appendChild(self.displayResults(res, t));\r\n\t\t\tself.getConfigButton(span);\r\n\t\t}) */\r\n\t\t//wqv.submitQuery(qObj);\r\n\t/*})\r\n\t*/\r\n\r\n\t//console.log('wqv', wqv);\r\n\t//var wqc = new WOQLChoice(this.client).options(config);\r\n\t//var wqs = new WOQLStream(this.client).options(config);\r\n\t//var wqg = new WOQLGraph(this.client).options(config);\r\n\t//var wqt = new WOQLTable(this.client).options(config)\r\n\t//wqv.setRenderer(new SimpleTextbox(wqv, 1000, 600));\r\n\t//wqt.setRenderer(new SimpleTable());\r\n\t//wqg.setRenderer(new SimpleGraph());\r\n\t//wqt.setDatatypes(Datatypes.initialiseDataRenderers);\r\n\t//wqs.setDatatypes(Datatypes.initialiseDataRenderers);\r\n\t//qp.addQueryViewer(wqv);\r\n\t//qp.addResultViewer(\"Choice\", wqc);\r\n\t//qp.addResultViewer(\"Stream\", wqs);\r\n\t//qp.addResultViewer(\"Graph\", wqg);\r\n\t//qp.addResultViewer(\"Table\", wqt);\r\n\r\n\t//qp.addResultViewer(\"ABC\", config, new SimpleTextbox(wqv, 1000, 600));\r\n\t//span.appendChild(qp.render());\r\n\r\n\treturn span;\r\n}\r\n\r\n\r\nTerminusHTMLViewer.prototype.chooser = function(query, config){\r\n\tvar span = document.createElement(\"span\");\r\n\tspan.setAttribute(\"class\", \"terminus-chooser\");\r\n\tvar wqt = new WOQLChoice(this.client).options(config);\r\n\treturn query.execute(this.client).then((results) => {\r\n\t\tvar result = new WOQLResult(results, query);\r\n\t\tspan.appendChild(wqt.render(result));\r\n\t});\r\n\treturn span;\r\n}\r\n\r\nTerminusHTMLViewer.prototype.graph = function(query, config){\r\n\tvar span = document.createElement(\"span\");\r\n\tspan.setAttribute(\"class\", \"terminus-graph terminus-graph-holder\");\r\n\tvar wqt = new WOQLGraph(this.client).options(config);\r\n\treturn query.execute(this.client).then((results) => {\r\n\t\tvar result = new WOQLResult(results, query);\r\n\t\tspan.appendChild(wqt.render(result));\r\n\t});\r\n\treturn span;\r\n}\r\n\r\nTerminusHTMLViewer.prototype.document = function(id, config){\r\n\tvar holder = document.createElement(\"span\");\r\n\tholder.setAttribute(\"class\", \"terminus-document terminus-document-holder\");\r\n\t//config.renderer(new DocumentTable());\r\n\t//config.show_all(\"SimpleFrameViewer\");\r\n\tvar tdv = new TerminusFrame(this.client).options(config);\r\n\ttdv.owner = this;\r\n\ttdv.setDatatypes(Datatypes.initialiseDataRenderers);\r\n\ttdv.loadDocument(id).then(() => {\r\n\t\tlet dom = tdv.render();\r\n\t\tif(dom) holder.appendChild(dom);\r\n\t});\r\n\treturn holder;\r\n}\r\n\r\nTerminusHTMLViewer.prototype.loadRenderer = function(rendname, frame, args, termframe){\r\n\tvar evalstr = \"new \" + rendname + \"(\";\r\n\tif(args) evalstr += JSON.stringify(args);\r\n\tevalstr += \");\";\r\n\ttry {\r\n\t\tvar nr = eval(evalstr);\r\n\t\tnr.terminus = termframe;\r\n\t\treturn nr;\r\n\t}\r\n\tcatch(e){\r\n\t\tconsole.log(\"Failed to load \" + rendname + e.toString());\r\n\t\treturn false;\r\n\t}\r\n}\r\n\r\nmodule.exports = TerminusHTMLViewer;\r\n","function SimpleDocument(){}\r\n\r\nSimpleDocument.prototype.render = function(frame){\r\n\tvar s = document.createElement(\"div\");\r\n\tfor(var p in frame.properties){\r\n\t\tvar pr = this.renderProperty(frame.properties[p])\r\n\t\tif(pr) s.appendChild(pr);\r\n\t}\r\n\treturn s;\r\n}\r\n\r\nSimpleDocument.prototype.renderProperty = function(frame){\r\n\tvar s = document.createElement(\"div\");\r\n\ts.appendChild(document.createTextNode(frame.getLabel() + \": \"));\r\n\tfor(var i = 0 ; i < frame.values.length; i++){\r\n\t\tif(frame.values[i].isData()){\r\n\t\t\tvar pr = this.renderValue(frame.values[i]);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tvar pr = this.render(frame.values[i]);\t\t\t\r\n\t\t}\r\n\t\tif(pr) s.appendChild(pr);\r\n\t}\r\n\treturn s;\r\n}\r\n\r\nSimpleDocument.prototype.renderValue = function(frame){\r\n\tvar s = document.createElement(\"span\");\r\n\ts.appendChild(document.createTextNode(frame.get() + \" \"));\r\n\treturn s;\r\n}\r\n\r\nmodule.exports = SimpleDocument;","function DocumentTable(){}\r\n\r\nDocumentTable.prototype.render = function(frame){\r\n\tvar t = this.getTableDOM(frame);\r\n\tvar tbody = document.createElement(\"tbody\");\r\n\tfor(var p in frame.properties){\r\n\t\t//s.appendChild(document.createTextNode(p));\r\n\t\tvar pr = this.renderProperty(tbody, frame.properties[p]);\r\n\t\t//if(pr) tbody.appendChild(pr);\r\n\t}\r\n\tt.appendChild(tbody);\r\n\treturn t;\r\n}\r\n\r\nDocumentTable.prototype.getTableDOM = function(frame){\r\n\t//const columns = this.woqltable.getColumnsToRender();\r\n\tvar tab = document.createElement(\"table\");\r\n\ttab.setAttribute(\"class\", \"terminus-hover-table\");\r\n\tvar thead = document.createElement(\"thead\");\r\n\tvar thr = document.createElement(\"tr\");\r\n\tvar th = document.createElement(\"th\");\r\n\tth.setAttribute('class', 'terminus-table-header-full-css');\r\n\tth.setAttribute('colspan', 2);\r\n\tth.appendChild(document.createTextNode(frame.subject() + \", \" + frame.subjectClass()));\r\n\tthr.appendChild(th);\r\n\tthead.appendChild(thr);\t\r\n\ttab.appendChild(thead);\r\n\treturn tab;\r\n}\r\n\r\nDocumentTable.prototype.renderProperty = function(tbody, frame){\r\n\tfor(var i = 0 ; i < frame.values.length; i++){\r\n\t\tvar thr = document.createElement(\"tr\");\r\n\t\tvar td = document.createElement(\"td\");\r\n\t\ttd.appendChild(document.createTextNode(frame.getLabel()));\r\n\t\tvar td2 = document.createElement(\"td\");\r\n\t\tif(frame.values[i].isData()){\r\n\t\t\ttd2.appendChild(this.renderValue(frame.values[i]));\r\n\t\t}\r\n\t\telse {\r\n\t\t\ttd2.appendChild(this.render(frame.values[i]));\t\t\t\r\n\t\t}\r\n\t\tthr.appendChild(td);\t\r\n\t\tthr.appendChild(td2);\t\r\n\t\ttbody.appendChild(thr);\t\r\n\t}\r\n}\r\n\r\nDocumentTable.prototype.renderValue = function(frame){\r\n\treturn document.createTextNode(frame.get());\r\n}\r\n\r\nmodule.exports = DocumentTable;","/**\r\n * Object for producing a HTML view of a given object in a frame\r\n */\r\nconst HTMLFrameHelper = require('../HTMLFrameHelper');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction HTMLObjectViewer(renderer){\r\n\tthis.properties = [];\r\n}\r\n\r\n/**\r\n * Functions for rendering / re-rendering the object as header and body components\r\n */\r\nHTMLObjectViewer.prototype.render = function(renderer){\r\n\tthis.renderer = renderer;\r\n\tthis.headerViewer = new HTMLObjectHeaderViewer();\r\n\tif(this.renderedDOM){\r\n\t\t//var renderedDOM = this.getObjectDOM();\r\n\t\t//this.renderedDOM.replaceWith(renderedDOM);\r\n\t\t//this.renderedDOM = renderedDOM;\r\n\t}\r\n\telse {\r\n\t\t//this.renderedDOM = this.getObjectDOM();\r\n\t}\r\n\t//this.renderedDOM.appendChild(this.getObjectIDMarker(this.renderer));\r\n\tif(this.headerViewer){\r\n\t\tthis.header = this.headerViewer.getAsDOM(this.renderer);\r\n\t\tif(this.header) this.renderedDOM.appendChild(this.header);\r\n\t}\r\n\tthis.body = this.getObjectBodyDOM();\r\n\tif(this.body) this.renderedDOM.appendChild(this.body);\r\n\treturn this.renderedDOM;\r\n}\r\n\r\nHTMLObjectViewer.prototype.getObjectDOM = function(){\r\n\tvar orientation = this.renderer.getContentOrientation();\r\n\tvar pcls = \"terminus-object-frame-\" + orientation;\r\n\tif(orientation == \"page\"){\r\n\t\tvar sp = document.createElement(\"div\");\r\n\t}\r\n\telse {\r\n\t\tvar sp = document.createElement(\"span\");\r\n\t}\r\n\tvar css = \"terminus-object-frame \" + pcls + (this.renderer.parent ? \"\" : \" terminus-root-frame\") + \" terminus-object-frame-\" + this.renderer.mode;\r\n\tsp.setAttribute(\"class\", css);\r\n\tsp.setAttribute(\"data-class\", this.renderer.subjectClass());\r\n\tsp.setAttribute(\"data-id\", this.renderer.subject());\r\n\treturn sp;\r\n}\r\n\r\nHTMLObjectViewer.prototype.getObjectBodyDOM = function(){\r\n\tvar orientation = \"page\";//this.renderer.getContentOrientation();\r\n\tvar pcls = \"terminus-object-properties-\" + orientation;\r\n\tif(orientation == \"page\"){\r\n\t\tvar vholder = document.createElement(\"div\");\r\n\t}\r\n\telse {\r\n\t\tvar vholder = document.createElement(\"span\");\r\n\t}\r\n    vholder.setAttribute('class', 'terminus-object-properties ' + pcls);\r\n    for(var prop in this.properties){\r\n\t\tif(this.properties[prop]) vholder.appendChild(this.properties[prop]);\r\n\t}\r\n\treturn vholder;\r\n}\r\n\r\nHTMLObjectViewer.prototype.getFeatureDOM = function(feature){\r\n\tif(this.hasFeatureViewer(feature)){\r\n\t\treturn this.featureViewer[feature](this.renderer, this);\r\n\t}\r\n}\r\n\r\nHTMLObjectViewer.prototype.redraw = function(){\r\n\tTerminusClient.FrameHelper.removeChildren(this.renderedDOM);\r\n\tthis.properties = [];\r\n\tthis.renderer.render(this);\r\n}\r\n\r\nHTMLObjectViewer.prototype.redrawHeader = function(){\r\n\tif(this.headerViewer && this.header) {\r\n\t\tvar nheader = this.headerViewer.getAsDOM(this.renderer);\r\n\t\tthis.header.replaceWith(nheader);\r\n\t\tthis.header = nheader;\r\n\t}\r\n}\r\n\r\nHTMLObjectViewer.prototype.redrawBody = function(){\r\n\tif(this.body){\r\n\t\tvar nbody = this.getObjectBodyDOM();\r\n\t\tthis.body.replaceWith(nbody);\r\n\t\tthis.body = nbody;\r\n\t}\r\n}\r\n\r\n/**\r\n * Adds a rendered version of a property to the internal properties array\r\n */\r\nHTMLObjectViewer.prototype.addRenderedProperty = function(prop, renderedprop){\r\n\tthis.properties[prop] = renderedprop;\r\n}\r\n\r\nHTMLObjectViewer.prototype.clear = function(){\r\n\tTerminusClient.FrameHelper.removeChildren(this.renderedDOM);\r\n\tthis.properties = {};\r\n}\r\n\r\n/**\r\n * Removes the object from the dom\r\n */\r\nHTMLObjectViewer.prototype.remove = function(){\r\n\tthis.renderedDOM.parentNode.removeChild(this.renderedDOM);\r\n}\r\n\r\nHTMLObjectViewer.prototype.goTo = function(subj, property){\r\n\tHTMLFrameHelper.goToName(subj, property);\r\n}\r\n\r\n/**\r\n * Generates a html anchor element to use as a marker to find the object on the page\r\n */\r\nHTMLObjectViewer.prototype.getObjectIDMarker = function(renderer){\r\n\tvar idm = document.createElement(\"a\");\r\n\tidm.setAttribute(\"class\", \"terminus-object-idmarker\");\r\n\tvar sh = TerminusClient.FrameHelper.getShorthand(renderer.subject());\r\n    if(!sh) sh = renderer.subject();\r\n    if(sh){\r\n\t\tvar bits = sh.split(\":\");\r\n\t\tif(bits.length > 1) sh = bits[1];\r\n\t\tidm.setAttribute(\"name\", sh);\r\n    }\r\n\treturn idm;\r\n}\r\n\r\nfunction HTMLObjectHeaderViewer(){}\r\n\r\nHTMLObjectHeaderViewer.prototype.getAsDOM = function(renderer){\r\n\tvar orientation = renderer.getContentOrientation();\r\n\tvar pcls = \"terminus-object-frame-btn terminus-object-header-\" + orientation;\r\n\tif(orientation == \"page\"){\r\n\t\tvar objDOM = document.createElement(\"div\");\r\n\t}\r\n\telse {\r\n\t\tvar objDOM = document.createElement(\"span\");\r\n\t}\r\n\tobjDOM.setAttribute(\"class\", \"terminus-object-header \" + pcls);\r\n\tif(renderer.showFeature(\"facet\")){\r\n\t\tvar facetDOM = this.getObjectFacetDOM(renderer);\r\n\t\tif(facetDOM) objDOM.appendChild(facetDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"label\")){\r\n\t\tvar sumDOM = this.getObjectLabelDOM(renderer);\r\n\t\tif(sumDOM) objDOM.appendChild(sumDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"id\")){\r\n\t\tvar idDOM = this.getObjectIDDOM(renderer);\r\n\t\tif(idDOM) objDOM.appendChild(idDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"type\")){\r\n\t\tvar typeDOM = this.getObjectTypeDOM(renderer);\r\n\t\tif(typeDOM) objDOM.appendChild(typeDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"status\")){\r\n\t\tvar sumDOM = this.getObjectStatusDOM(renderer);\r\n\t\tif(sumDOM) objDOM.appendChild(sumDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"view\")){\r\n\t\tvar viewDOM = this.getViewPropertyDOM(renderer);\r\n\t\tif(viewDOM) objDOM.appendChild(viewDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"viewer\")){\r\n\t\tvar hideDOM = this.getViewerSelectorDOM(renderer);\r\n\t\tif(hideDOM) objDOM.appendChild(hideDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"control\")){\r\n\t\tvar controlsDOM = this.getObjectControlsDOM(renderer);\r\n\t\tif(controlsDOM) objDOM.appendChild(controlsDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"summary\")){\r\n\t\tvar controlsDOM = this.getObjectSummaryDOM(renderer);\r\n\t\tif(controlsDOM) objDOM.appendChild(controlsDOM);\r\n\t}\r\n\treturn objDOM;\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectSummaryDOM = function(renderer){\r\n\tvar sum = renderer.getSummary();\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"object-summary\", false, sum.long, sum.status);\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectControlsDOM = function(renderer){\r\n\tvar controlsDOM = document.createElement(\"span\");\r\n\tcontrolsDOM.setAttribute(\"class\", \"terminus-object-controls\");\r\n\tif(renderer.showFeature(\"add\")){\r\n\t\tvar addDOM = this.getAddPropertyDOM(renderer);\r\n\t\tif(addDOM) controlsDOM.appendChild(addDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"mode\")){\r\n\t\tvar viewsDOM = HTMLFrameHelper.getModeSelectorDOM(\"object\", renderer);\r\n\t\tif(viewsDOM) controlsDOM.appendChild(viewsDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"delete\")){\r\n\t\tvar dpropDOM = this.getObjectDeleteDOM(renderer);\r\n\t\tif(dpropDOM) controlsDOM.appendChild(dpropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"clone\")){\r\n\t\tvar cpropDOM = this.getObjectCloneDOM(renderer);\r\n\t\tif(cpropDOM) controlsDOM.appendChild(cpropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"reset\")){\r\n\t\tvar rpropDOM = this.getObjectResetDOM(renderer);\r\n\t\tif(rpropDOM) controlsDOM.appendChild(rpropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"update\")){\r\n\t\tvar upropDOM = this.getObjectUpdateDOM(renderer);\r\n\t\tif(upropDOM) controlsDOM.appendChild(upropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"show\")){\r\n\t\tvar showDOM = this.getObjectShowDOM(renderer);\r\n\t\tif(showDOM) controlsDOM.appendChild(showDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"hide\")){\r\n\t\tvar hideDOM = this.getObjectHideDOM(renderer);\r\n\t\tif(hideDOM) controlsDOM.appendChild(hideDOM);\r\n\t}\r\n\treturn controlsDOM;\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectFacetDOM = function(renderer){\r\n\tvar viewables = renderer.getAvailableFacets();\r\n\tvar self = this;\r\n\tif(viewables && viewables.length){\r\n\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-object-facet\");\r\n\t\tvar callback = function(val){\r\n\t\t\tif(val){\r\n\t\t\t\trenderer.setFacet(val);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"object-facet\", viewables, renderer.currentFacet(), callback);\r\n\t\tmpropDOM.appendChild(sel);\r\n\t\treturn mpropDOM;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectLabelDOM = function(renderer){\r\n\tvar lab = renderer.getLabel();\r\n\tif(lab){\r\n\t\treturn HTMLFrameHelper.getInfoboxDOM(\"object-label\", false, lab);\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectIDDOM = function(renderer){\r\n\tvar val = renderer.subject();\r\n\tvar input = false;\r\n\tif(renderer.mode == \"edit\" && renderer.isNewDocument()){\r\n\t\tif(renderer.idDOM) val = renderer.idDOM.value;\r\n\t\tinput = document.createElement(\"input\");\r\n\t\tinput.setAttribute(\"class\", \"terminus-object-id-input\");\r\n\t\tinput.required  = true;\r\n\t\tif(val == \"_:\") val = \"\";\r\n\t\trenderer.idDOM = input;\r\n\t}\r\n\telse {\r\n\t\tif(renderer.isNewDocument() && val == \"_:\") val = \"New Document\";\r\n\t}\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"object-id\", \"ID\", val, \"Every fragment of data is identified by a unique URL\", input);\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectTypeDOM = function(renderer){\r\n\tif(renderer.mode == \"edit\" && renderer.parent && renderer.parent.isClassChoice() && renderer.isNew()){\r\n\t\tvar cs = renderer.parent.getAvailableClassChoices();\r\n\t\tif(cs && cs.length){\r\n\t\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\t\tmpropDOM.setAttribute(\"class\", \"terminus-property-change-class\");\r\n\t\t\tvar mlabDOM = document.createElement(\"span\");\r\n\t\t\tmlabDOM.setAttribute(\"class\", \"terminus-property-change-label\");\r\n\t\t\tmlabDOM.appendChild(document.createTextNode(\"Type\"));\r\n\t\t\tmpropDOM.appendChild(mlabDOM);\r\n\t\t\tvar callback = function(cls){\r\n\t\t\t\tif(cls){\r\n\t\t\t\t\trenderer.changeClass(cls);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"change-class\", cs, renderer.subjectClass(), callback);\r\n\t\t\tmpropDOM.appendChild(sel);\r\n\t\t\treturn mpropDOM;\r\n\t\t}\r\n\t}\r\n\tvar cm = renderer.getClassMeta(renderer.subjectClass());\r\n\tvar lab = renderer.subjectClass();\r\n\tvar cmt = \"All objects have types, identified by a unique URL\";\r\n\tif(cm){\r\n\t\tlab = HTMLFrameHelper.getVariableValueFromBinding(\"Label\", cm);\r\n\t\tcmt = HTMLFrameHelper.getVariableValueFromBinding(\"Comment\", cm);\r\n\t\tcmt = (cmt ? renderer.subjectClass() + \" \" + cmt : renderer.subjectClass());\r\n\t}\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"object-type\", \"Type\", lab, cmt);\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectStatusDOM = function(renderer){\r\n\tvar sum = renderer.getSummary();\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"status-\"+sum.status, false, sum.status, sum.status);\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getAddPropertyDOM = function(renderer){\r\n\tvar addables = renderer.getAddableProperties();\r\n\tif(addables && addables.length){\r\n\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-object-add-property\");\r\n\t\taddables.unshift({ value: \"\", label: \"Add New Property\"});\r\n\t\tvar callback = function(add){\r\n\t\t\tif(add){\r\n\t\t\t\trenderer.addNewProperty(add);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar disabled = (renderer.cardControlAllows(\"add\") ? false : \"Cardinality Rules Forbid Add\");\r\n\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"add-property\", addables, \"\", callback, disabled);\r\n\t\tmpropDOM.appendChild(sel);\r\n\t\treturn mpropDOM;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getViewPropertyDOM = function(renderer){\r\n\tvar viewables = renderer.getViewableProperties();\r\n\tvar self = this;\r\n\tif(viewables && viewables.length){\r\n\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-object-view-property\");\r\n\t\tviewables.unshift({ value: \"\", label: \"View Property\"});\r\n\t\tvar callback = function(add){\r\n\t\t\tif(add){\r\n\t\t\t\trenderer.goToProperty(add);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"view-property\", viewables, \"\", callback);\r\n\t\tmpropDOM.appendChild(sel);\r\n\t\treturn mpropDOM;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectDeleteDOM = function(renderer){\r\n\tvar callback = function(){renderer.delete()};\r\n\tvar disabled = (renderer.cardControlAllows(\"delete\") ? false : \"Cardinality Rules Forbid Delete\");\r\n\treturn HTMLFrameHelper.getActionControl(\"object\", \"delete\", \"Delete\", callback, disabled);\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectCloneDOM = function(renderer){\r\n\tvar callback = function(){renderer.clone()};\r\n\tvar disabled = (renderer.cardControlAllows(\"clone\") ? false : \"Cardinality Rules Forbid Clone\");\r\n\treturn HTMLFrameHelper.getActionControl(\"object\", \"clone\", \"Clone\", callback, disabled);\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectResetDOM = function(renderer){\r\n\tvar callback = function(){renderer.reset()};\r\n\tvar disabled = (renderer.isUpdated() ? false : \"Nothing to reset\");\r\n\treturn HTMLFrameHelper.getActionControl(\"object\", \"reset\", \"Reset\", callback, disabled);\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getViewerSelectorDOM = function(renderer){\r\n\tvar viewers = renderer.getAvailableViewers();\r\n\tif(viewers && viewers.length){\r\n\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-object-viewer\");\r\n\t\tvar callback = function(viewer){\r\n\t\t\tif(viewer){\r\n\t\t\t\trenderer.setViewer(viewer);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar selected = renderer.currentViewer();\r\n\t\tvar sel = HTMLFrameHelper.getSelectionControl('object-viewer', viewers, selected, callback);\r\n\t\tmpropDOM.appendChild(sel);\r\n\t\treturn mpropDOM;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectHideDOM = function(renderer){\r\n\tvar callback = function(){renderer.hide()};\r\n\treturn HTMLFrameHelper.getActionControl(\"object\", \"hide\", \"Hide\", callback);\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectShowDOM = function(renderer){\r\n\tvar callback = function(){renderer.show()};\r\n\treturn HTMLFrameHelper.getActionControl(\"object\", \"show\", \"Show\", callback);\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectUpdateDOM = function(renderer){\r\n\tvar dpropDOM = document.createElement(\"span\");\r\n\tdpropDOM.setAttribute(\"class\", \"terminus-object-update\");\r\n\tif(renderer.isNewDocument()){\r\n\t\tvar disabled = false;//(renderer.isUpdated() ? false : \"No changes\");\r\n\t}\r\n\telse {\r\n\t\tvar disabled = (renderer.isUpdated() ? false : \"No changes\");\r\n\t}\r\n\tvar saveback = function(){renderer.save()};\r\n\tdpropDOM.appendChild(HTMLFrameHelper.getActionControl(\"object\", \"save\", \"Save\", saveback, disabled));\r\n\treturn dpropDOM;\r\n}\r\n\r\nmodule.exports=HTMLObjectViewer;\r\n","const HTMLFrameHelper = require('../HTMLFrameHelper');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\n/**\r\n * Property Viewer\r\n */\r\nfunction HTMLPropertyViewer(renderer){\r\n\tthis.values = [];\r\n}\r\n\r\n\r\n/**\r\n * Draws the property as header and body components\r\n */\r\nHTMLPropertyViewer.prototype.render = function(renderer){\r\n\tthis.renderer = renderer;\r\n\tthis.headerViewer = new HTMLPropertyHeaderViewer();\r\n\t//var block = document.createElement('div');\r\n\t//block.setAttribute('style', 'display: flex; margin: 10px');\r\n\t//var br = document.createElement('br');\r\n\t//block.appendChild(br);\r\n\tif(this.propDOM){\r\n\t\tvar npropDOM = this.getPropertyDOM();\r\n\t\t//npropDOM.setAttribute('style', 'display: flex; margin: 10px;');\r\n\t\t\t//block.appendChild(npropDOM);\r\n\t\tthis.propDOM.replaceWith(npropDOM);\r\n\t\tthis.propDOM = npropDOM;\r\n\t\t//this.propDOM = block;\r\n\t}\r\n\telse {\r\n\t\t//block.appendChild(this.getPropertyDOM());\r\n\t\t//this.propDOM = block;\r\n\t\tthis.propDOM = this.getPropertyDOM();\r\n\t\t//this.propDOM.setAttribute('style', 'display: flex; margin: 10px;');\r\n\t}\r\n\tthis.propDOM.appendChild(this.getPropertyIDMarker(this.renderer));\r\n\tif(this.headerViewer){\r\n\t\tthis.header = this.headerViewer.getAsDOM(this.renderer);\r\n\t\tif(this.header) this.propDOM.appendChild(this.header);\r\n\t}\r\n\tthis.body = this.getPropertyBodyDOM();\r\n\tif(this.body) this.propDOM.appendChild(this.body);\r\n\treturn this.propDOM;\r\n}\r\n\r\nHTMLPropertyViewer.prototype.getPropertyDOM = function(){\r\n\tvar orientation = this.renderer.getContentOrientation();\r\n\tvar pcls = \" terminus-property-frame-display terminus-property-frame-\" + orientation;\r\n\tif(orientation == \"label\"){\r\n\t\tvar sp = document.createElement(\"span\");\r\n\t}\r\n\telse {\r\n\t\tvar sp = document.createElement(\"div\");\r\n\t}\r\n\t//terminus-property-frame-spacer\r\n\r\n\tsp.setAttribute(\"class\", \"terminus-property-frame terminus-zebra-frame terminus-property-frame-\" + this.renderer.mode + \" \" + pcls);\r\n\tsp.setAttribute('data-property', this.renderer.property());\r\n\treturn sp;\r\n}\r\n\r\nHTMLPropertyViewer.prototype.getPropertyBodyDOM = function(){\r\n\tvar orientation = this.renderer.getContentOrientation();\r\n\tvar pcls = \"terminus-property-values-\" + orientation;\r\n\tif(orientation == \"page\"){\r\n\t\tvar vholder = document.createElement(\"div\");\r\n\t}\r\n\telse {\r\n\t\tvar vholder = document.createElement(\"span\");\r\n\t}\r\n    vholder.setAttribute('class', 'terminus-property-values ' + pcls + ' terminus-property-values-align');\r\n\tfor(var i =0; i<this.values.length; i++){\r\n\t\tvholder.appendChild(this.values[i]);\r\n\t}\r\n\treturn vholder;\r\n}\r\n\r\nHTMLPropertyViewer.prototype.addRenderedValue = function(renderedval){\r\n\tthis.values.push(renderedval);\r\n}\r\n\r\nHTMLPropertyViewer.prototype.clear = function(){\r\n\tTerminusClient.FrameHelper.removeChildren(this.propDOM);\r\n\tthis.values = [];\r\n}\r\n\r\n\r\n/**\r\n * Removes the property from the dom\r\n */\r\nHTMLPropertyViewer.prototype.remove = function(){\r\n\tthis.propDOM.parentNode.removeChild(this.propDOM);\r\n}\r\n\r\n/**\r\n * Redraws the property to reflect an updated state\r\n */\r\nHTMLPropertyViewer.prototype.redraw = function(){\r\n\tvar npropDOM = this.getPropertyDOM();\r\n\tthis.propDOM.replaceWith(npropDOM);\r\n\tthis.propDOM = npropDOM;\r\n\tthis.values = [];\r\n\tthis.renderer.render(this);\r\n}\r\n\r\nHTMLPropertyViewer.prototype.redrawHeader = function(){\r\n\tif(this.headerViewer && this.header) {\r\n\t\tvar nheader = this.headerViewer.getAsDOM(this.renderer);\r\n\t\tthis.header.replaceWith(nheader);\r\n\t\tthis.header = nheader;\r\n\t}\r\n}\r\n\r\nHTMLPropertyViewer.prototype.redrawBody = function(){\r\n\tif(this.body){\r\n\t\tvar nbody = this.getPropertyBodyDOM();\r\n\t\tthis.body.replaceWith(nbody);\r\n\t\tthis.body = nbody;\r\n\t}\r\n}\r\n\r\n/**\r\n * Generates a html anchor element to use as a marker to find the property on the page\r\n */\r\nHTMLPropertyViewer.prototype.getPropertyIDMarker = function(renderer){\r\n\tvar idm = document.createElement(\"a\");\r\n\tidm.setAttribute(\"class\", \"terminus-property-idmarker\");\r\n\tvar subj = TerminusClient.FrameHelper.getShorthand(renderer.subject());\r\n\tif(!subj ) subj = renderer.subject();\r\n\tvar bits = subj .split(\":\");\r\n\tif(bits.length > 1) subj = bits[1];\r\n\tvar prop = TerminusClient.FrameHelper.getShorthand(renderer.property());\r\n\tif(!prop ) prop = renderer.property();\r\n\tvar bits = prop.split(\":\");\r\n\tif(bits.length > 1) prop = bits[1];\r\n\tidm.setAttribute(\"name\", subj + \"_\" + prop);\r\n\treturn idm;\r\n}\r\n\r\nHTMLPropertyViewer.prototype.goTo = function(subj, property, index){\r\n\tHTMLFrameHelper.goToName(subj, property, index);\r\n}\r\n\r\nfunction HTMLPropertyHeaderViewer(){}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getAsDOM = function(renderer){\r\n\tvar orientation = renderer.getContentOrientation();\r\n\tvar pcls = \"terminus-property-header-\" + orientation;\r\n\tif(orientation == \"page\"){\r\n\t\tvar objDOM = document.createElement(\"div\");\r\n\t}\r\n\telse {\r\n\t\tvar objDOM = document.createElement(\"span\");\r\n\t}\r\n\tobjDOM.setAttribute(\"class\", \"terminus-text terminus-property-header \" + pcls);\r\n\tvar wrapper = document.createElement(\"span\");\r\n\twrapper.setAttribute(\"class\", \"terminus-property-header-wrapper\");\r\n\tif(renderer.showFeature(\"control\")){\r\n\t\tvar expModeMenu = this.getPropertyControlsDOM(wrapper, renderer);\r\n\t\tif(orientation == 'page') this.expModeMenu = expModeMenu;\r\n\t\telse this.expModeMenu = null;\r\n\t}\r\n\tif(renderer.showFeature(\"label\")){\r\n\t\tvar sumDOM = this.getPropertyLabelDOM(renderer);\r\n\t\tif(renderer.showFeature(\"status\")){\r\n\t\t\tvar statDOM = this.getPropertyStatusDOM(renderer);\r\n\t\t\tif(statDOM) sumDOM.prepend(statDOM);\r\n\t\t}\r\n\t\tif(sumDOM) wrapper.appendChild(sumDOM);\r\n\t}\r\n\telse if(renderer.showFeature(\"status\")){\r\n\t\tvar statDOM = this.getPropertyStatusDOM(renderer);\r\n\t\tif(statDOM) wrapper.appendChild(statDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"summary\")){\r\n\t\tvar sumDOM = this.getPropertySummaryDOM(renderer);\r\n\t\tif(sumDOM) wrapper.appendChild(sumDOM);\r\n\t}\r\n\r\n\tvar prelude = document.createElement(\"span\");\r\n\tprelude.setAttribute(\"class\", \"terminus-property-header-info terminus-property-header-info-\"+renderer.currentFacet());\r\n\r\n\tif(renderer.showFeature(\"facet\")){\r\n\t\tvar facetDOM = this.getPropertyFacetDOM(renderer);\r\n\t\tif(facetDOM) prelude.appendChild(facetDOM);\r\n\t\t//if(facetDOM && this.expModeMenu) this.expModeMenu.appendChild(facetDOM);//\r\n\t}\r\n\tif(renderer.showFeature(\"view\")){\r\n\t\tvar viewDOM = this.getViewValueDOM(renderer);\r\n\t\tif(viewDOM) prelude.appendChild(viewDOM);\r\n\t\t//if(viewDOM && this.expModeMenu) this.expModeMenu.appendChild(viewDOM); //prelude.appendChild(viewDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"id\")){\r\n\t\tvar idDOM = this.getPropertyIDDOM(renderer);\r\n\t\tif(idDOM) prelude.appendChild(idDOM);\r\n\t\t//if(idDOM && this.expModeMenu) this.expModeMenu.appendChild(idDOM); //\r\n\t}\r\n\tif(renderer.showFeature(\"type\")){\r\n\t\tvar typeDOM = this.getPropertyRangeDOM(renderer);\r\n\t\tif(typeDOM)\tprelude.appendChild(typeDOM);\r\n\t\t/*if(typeDOM && this.expModeMenu){\r\n\t\t\tthis.expModeMenu.appendChild(typeDOM);//\r\n\t\t\ttypeDOM.style.display = 'block';\r\n\t\t}*/\r\n\t}\r\n\tif(renderer.showFeature(\"cardinality\") && renderer.hasCardinalityRestriction()){\r\n\t\tvar hideDOM = this.getPropertyCardinalityDOM(renderer);\r\n\t\tif(hideDOM) prelude.appendChild(hideDOM);\r\n\t\t//\tthis.expModeMenu.appendChild(hideDOM); \t\t\thideDOM.style.display = 'block';\r\n\r\n\t}\r\n\tif(renderer.showFeature(\"comment\")){\r\n\t\tvar sumDOM = this.getPropertyCommentDOM(renderer);\r\n\t\tif(sumDOM) prelude.appendChild(sumDOM);\r\n\t\t/*if(sumDOM && this.expModeMenu){\r\n\t\t\tthis.expModeMenu.appendChild(sumDOM); //\r\n\t\t\tsumDOM.style.display = 'block';\r\n\t\t}*/\r\n\t}\r\n\twrapper.appendChild(prelude);\r\n\tobjDOM.appendChild(wrapper);\r\n\treturn objDOM;\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyFacetDOM = function(renderer){\r\n\tvar viewables = renderer.getAvailableFacets();\r\n\tvar self = this;\r\n\tif(viewables && viewables.length){\r\n\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-property-facet\");\r\n\t\tvar callback = function(val){\r\n\t\t\tif(val){\r\n\t\t\t\trenderer.setFacet(val);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"property-facet\", viewables, renderer.currentFacet(), callback);\r\n\t\tmpropDOM.appendChild(sel);\r\n\t\treturn mpropDOM;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyIDDOM = function(renderer){\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"property-id\", \"Property\", renderer.property(), \"This property is identified by this unique URL: \" + renderer.property());\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyRangeDOM = function(renderer){\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"property-type\", \"Type\", renderer.range(), \"The type of arguments that this property accepts\");\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertySummaryDOM = function(renderer){\r\n\tvar sum = renderer.getSummary();\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"property-summary\", false, sum.long, sum.status);\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyStatusDOM = function(renderer){\r\n\tvar sum = renderer.getSummary();\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"status-\"+sum.status, false, sum.status, sum.status);\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyLabelDOM = function(renderer){\r\n\tvar lab = renderer.getLabel();\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"property-label\", false, lab);\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyCommentDOM = function(renderer){\r\n\tvar lab = renderer.getComment();\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"property-comment\", false, lab);\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyCardinalityDOM = function(renderer){\r\n\tvar restriction = renderer.getRestriction();\r\n\tif(restriction.min && restriction.max){\r\n\t\tif(restriction.min == restriction.max){\r\n\t\t\tvar lab = restriction.min;\r\n\t\t\tvar help = \"Cardinality: \" + restriction.min;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tvar lab = restriction.min + \"-\" + restriction.max;\r\n\t\t\tvar help = \"Minimum Cardinality: \" + restriction.min;\r\n\t\t\thelp += \", Maximum Cardinality: \" + restriction.max;\r\n\t\t}\r\n\t}\r\n\telse if(restriction.min){\r\n\t\tvar lab = \">\"+(restriction.min-1);\r\n\t\tvar help = \"Minimum Cardinality: \" + restriction.min;\r\n\t}\r\n\telse if(restriction.max){\r\n\t\tvar lab = \"<\"+(restriction.max+1);\r\n\t\tvar help = \"Maximum Cardinality: \" + restriction.max;\r\n\t}\r\n\telse {\r\n\t\treturn false;\r\n\t}\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"property-cardinality\", \"Cardinality\", lab, help);\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getActionControlDOM = function(settingsDOM, renderer){\r\n\tif(renderer.showFeature(\"mode\")){\r\n\t\tvar viewsDOM = HTMLFrameHelper.getModeSelectorDOM(\"property\", renderer);\r\n\t\tif (viewsDOM) settingsDOM.appendChild(viewsDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"delete\")){\r\n\t\tvar dpropDOM = this.getPropertyDeleteDOM(renderer);\r\n\t\tif (dpropDOM) settingsDOM.appendChild(dpropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"add\") && !renderer.isClassChoice()){\r\n\t\tvar addDOM = this.getAddValueDOM(renderer);\r\n\t\tif(addDOM) settingsDOM.appendChild(addDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"reset\")){\r\n\t\tvar rpropDOM = this.getPropertyResetDOM(renderer);\r\n\t\tif(rpropDOM) settingsDOM.appendChild(rpropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"update\")){\r\n\t\tvar upropDOM = this.getPropertyUpdateDOM(renderer);\r\n\t\tif(upropDOM) settingsDOM.appendChild(upropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"show\")){\r\n\t\tvar showDOM = this.getPropertyShowDOM(renderer);\r\n\t\tif(showDOM) settingsDOM.appendChild(showDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"hide\")){\r\n\t\tvar hideDOM = this.getPropertyHideDOM(renderer);\r\n\t\tif(hideDOM) settingsDOM.appendChild(hideDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"viewer\")){\r\n\t\tvar hideDOM = this.getViewerSelectorDOM(renderer);\r\n\t\tif(hideDOM) settingsDOM.appendChild(hideDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"add\") && renderer.isClassChoice()){\r\n\t\tvar addDOM = this.getAddValueDOM(renderer);\r\n\t\tif(addDOM) settingsDOM.appendChild(addDOM);\r\n\t}\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getSettingsControlDOM = function(controlsDOM, renderer){\r\n\tvar settings = document.createElement(\"div\");\r\n\tcontrolsDOM.appendChild(settings);\r\n\tvar orientation = renderer.getContentOrientation();\r\n\tif(false && orientation == 'page'){ // expert mode\r\n\t\tvar sControl = HTMLFrameHelper.getSettingsControl('property');\r\n\t\tvar menu = document.createElement('div');\r\n\t\tmenu.setAttribute('class', 'terminus-hide terminus-popup');\r\n\t\tmenu.appendChild(document.createTextNode('Edit property'));\r\n\t\tmenu.appendChild(document.createElement('BR'));\r\n\t\tsControl.appendChild(menu);\r\n\t\tsControl.addEventListener('click', function(e){\r\n\t\t\tvar target = e.target || e.srcElement,\r\n        \ttext = target.textContent || target.innerText;\r\n\t\t\tif((target.nodeName == 'ICON') || (target.nodeName == 'BUTTON')){\r\n\t\t\t\tif(this.children[0].style.display == 'none') this.children[0].style.display = 'block';\r\n\t\t\t\telse this.children[0].style.display = 'none';\r\n\t\t\t}\r\n\t\t});\r\n\t\tthis.getActionControlDOM(menu, renderer);\r\n\t    settings.appendChild(sControl);\r\n\t\treturn menu;\r\n\t}\r\n\telse this.getActionControlDOM(controlsDOM, renderer);\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyControlsDOM = function(wrapper, renderer){\r\n\tvar controlsDOM = document.createElement(\"span\");\r\n\tcontrolsDOM.setAttribute(\"class\", \"terminus-property-controls\");\r\n\t//controlsDOM.setAttribute(\"style\", \"display: table-cell;\");\r\n\t// get settings icon or button\r\n\tvar expModeMenu = this.getSettingsControlDOM(controlsDOM, renderer);\r\n\twrapper.appendChild(controlsDOM);\r\n\treturn expModeMenu;\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getAddValueDOM = function(renderer){\r\n\tif(renderer.isClassChoice()){\r\n\t\tvar cs = renderer.getAvailableClassChoices();\r\n\t\tif(cs && cs.length){\r\n\t\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\t\tmpropDOM.setAttribute(\"class\", \"terminus-property-add-class\");\r\n\t\t\tcs.unshift({ value: \"\", label: \"Add Type\"});\r\n\t\t\tvar callback = function(cls){\r\n\t\t\t\tif(cls){\r\n\t\t\t\t\trenderer.addClass(cls);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"add-property\", cs, \"\", callback);\r\n\t\t\tmpropDOM.appendChild(sel);\r\n\t\t\treturn mpropDOM;\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tvar callback = function(){renderer.add(\"edit\")};\r\n\t\tvar disabled = (renderer.cardControlAllows(\"add\") ? false : \"Cardinality Rules Forbid Add\");\r\n\t\treturn HTMLFrameHelper.getActionControl(\"property\", \"add\", \"Add\", callback, disabled);\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getViewValueDOM = function(renderer){\r\n\tvar viewables = renderer.getViewableValues();\r\n\tvar self = this;\r\n\tif(viewables && viewables.length){\r\n\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-property-view-value\");\r\n\t\tviewables.unshift({ value: \"\", label: \"View Value\"});\r\n\t\tvar callback = function(val){\r\n\t\t\trenderer.goToValue(val);\r\n\t\t}\r\n\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"view-values\", viewables, \"\", callback);\r\n\t\tmpropDOM.appendChild(sel);\r\n\t\treturn mpropDOM;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyDeleteDOM = function(renderer){\r\n\tvar callback = function(){renderer.delete()};\r\n\tvar disabled = (renderer.cardControlAllows(\"delete\") ? false : \"Cardinality Rules Forbid Delete\");\r\n\treturn HTMLFrameHelper.getActionControl(\"property\", \"delete\", \"Delete\", callback, disabled);\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyHideDOM = function(renderer){\r\n\tvar callback = function(){renderer.hide()};\r\n\treturn HTMLFrameHelper.getActionControl(\"property\", \"hide\", \"Hide\", callback);\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyResetDOM = function(renderer){\r\n\tvar callback = function(){renderer.reset()};\r\n\tvar disabled = (renderer.isUpdated() ? false : \"Nothing to reset\");\r\n\treturn HTMLFrameHelper.getActionControl(\"property\", \"reset\", \"Reset\", callback, disabled);\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyShowDOM = function(renderer){\r\n\tvar callback = function(){renderer.show()};\r\n\treturn HTMLFrameHelper.getActionControl(\"property\", \"show\", \"Show\", callback);\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyUpdateDOM = function(renderer){\r\n\tvar dpropDOM = document.createElement(\"span\");\r\n\tdpropDOM.setAttribute(\"class\", \"terminus-property-update\");\r\n\tvar disabled = (renderer.isUpdated() ? false : \"No Change\");\r\n\tvar saveback = function(){renderer.save()};\r\n\tdpropDOM.appendChild(HTMLFrameHelper.getActionControl(\"property\", \"save\", \"Save\", saveback, disabled));\r\n\treturn dpropDOM;\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getViewerSelectorDOM = function(renderer){\r\n\tvar viewers = renderer.getAvailableViewers();\r\n\tif(viewers && viewers.length){\r\n\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-property-viewer\");\r\n\t\tvar callback = function(viewer){\r\n\t\t\tif(viewer){\r\n\t\t\t\trenderer.setViewer(viewer);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar selected = renderer.currentViewer();\r\n\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"property-viewers\", viewers, selected, callback);\r\n\t\tmpropDOM.appendChild(sel);\r\n\t\treturn mpropDOM;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.showValue = function(renderer, index){\r\n\tvar htmlid = renderer.subject() + \"->\" + renderer.property() + \"_\" + index;\r\n\twindow.location = (\"\"+window.location).replace(/#[A-Za-z0-9_]*$/,'') + \"#\" + htmlid;\r\n}\r\n\r\nfunction HTMLDataViewer(){\r\n}\r\n\r\nmodule.exports=HTMLPropertyViewer;\r\n","/**\r\n * Draws the property as header and body components\r\n */\r\nconst HTMLFrameHelper = require('../HTMLFrameHelper');\r\nconst HTMLStringViewer = require('../datatypes/String');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction HTMLDataViewer(){\r\n}\r\n\r\nHTMLDataViewer.prototype.render = function(renderer){\r\n\tthis.headerViewer = new HTMLDataHeaderViewer();\r\n\tif(this.valDOM){\r\n\t\tvar nvalDOM = this.getValueDOM();\r\n\t\tthis.valDOM.replaceWith(nvalDOM);\r\n\t\tthis.valDOM = nvalDOM;\r\n\t}\r\n\telse {\r\n\t\tthis.valDOM = this.getValueDOM();\r\n\t}\r\n\tthis.valDOM.appendChild(this.getValueIDMarker(this.renderer));\r\n\tthis.body = this.getValueBodyDOM();\r\n\tif(this.body) this.valDOM.appendChild(this.body);\r\n\tif(this.headerViewer){\r\n\t\tthis.header = this.headerViewer.getAsDOM(this.renderer);\r\n\t\tif(this.renderer.facet == 'page'){ //expert mode\r\n\t\t\tif(this.header && this.expModeMenu) {\r\n\t\t\t\tthis.expModeMenu.appendChild(this.header);\r\n\t\t\t\t//this.valDOM.appendChild(this.expModeMenu);\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if(this.header) this.valDOM.appendChild(this.header);\r\n\t}\r\n\treturn this.valDOM;\r\n}\r\n\r\nHTMLDataViewer.prototype.getValueDOM = function(){\r\n\tif(this.renderer.currentFacet() == \"page\"){\r\n\t\tvar sp = document.createElement(\"div\");\r\n\t}\r\n\telse {\r\n\t\tvar sp = document.createElement(\"span\");\r\n\t}\r\n\tsp.setAttribute(\"class\", \"terminus-property-value property-value-\" + this.renderer.currentFacet() + \" property-value-\" + this.renderer.mode);\r\n\tif(this.renderer.mode == \"view\"){\r\n\t\tsp.setAttribute('data-value', this.renderer.value());\r\n\t}\r\n\treturn sp;\r\n}\r\n\r\nHTMLDataViewer.prototype.getValueBodyDOM = function(){\r\n\tif(this.renderer.currentFacet() == \"page\"){\r\n\t\tvar vholder = document.createElement(\"div\");\r\n\t}\r\n\telse {\r\n\t\tvar vholder = document.createElement(\"span\");\r\n\t}\r\n    vholder.setAttribute('class', ' terminus-property-body property-value-body property-value-body-'+this.renderer.currentFacet() + ' terminus-property-body-align');\r\n\t//vholder.setAttribute('style', 'display: flex;');\r\n\tif(this.renderer.showFeature(\"body\")){\r\n        var valueViewer = this.renderer.getDataValueViewer();\r\n    \tvar vdom = valueViewer.getDOM(this.renderer, this);\r\n    }\r\n    else if(this.renderer.showFeature(\"summary\")){\r\n\t\tvar vdom = this.getSummaryDOM();\r\n    }\r\n    else {\r\n    \treturn false;\r\n    }\r\n    if(vdom) vholder.appendChild(vdom);\r\n\tif(false && this.renderer.currentFacet() == \"page\"){\r\n\t\tvar sControl = HTMLFrameHelper.getSettingsControl('data');\r\n\t\tvar menu = document.createElement('div');\r\n\t\tmenu.setAttribute('class', 'terminus-hide terminus-popup');\r\n\t\tmenu.appendChild(document.createTextNode('Edit property value'));\r\n\t\tmenu.appendChild(document.createElement('BR'));\r\n\t\tsControl.appendChild(menu);\r\n\t\tsControl.addEventListener('click', function(e){\r\n\t\t\tvar target = e.target || e.srcElement,\r\n\t\t\ttext = target.textContent || target.innerText;\r\n\t\t\tif((target.nodeName == 'ICON') || (target.nodeName == 'BUTTON')){\r\n\t\t\t\tif(this.children[0].style.display == 'none') this.children[0].style.display = 'block';\r\n\t\t\t\telse this.children[0].style.display = 'none';\r\n\t\t\t}\r\n\t\t});\r\n\t\tthis.expModeMenu = menu;\r\n\t\tvholder.appendChild(sControl);\r\n\t}\r\n\treturn vholder;\r\n}\r\n\r\n/**\r\n * Removes the value from the dom\r\n */\r\nHTMLDataViewer.prototype.remove = function(){\r\n\tthis.valDOM.parentNode.removeChild(this.valDOM);\r\n}\r\n\r\nHTMLDataViewer.prototype.redrawHeader = function(){\r\n\tif(this.headerViewer && this.header) {\r\n\t\tvar nheader = this.headerViewer.getAsDOM(this.renderer);\r\n\t\tthis.header.replaceWith(nheader);\r\n\t\tthis.header = nheader;\r\n\t}\r\n}\r\n\r\nHTMLDataViewer.prototype.redrawBody = function(){\r\n\tif(this.body){\r\n\t\tvar nbody = this.getValueBodyDOM();\r\n\t\tthis.body.replaceWith(nbody);\r\n\t\tthis.body = nbody;\r\n\t}\r\n}\r\n\r\n/**\r\n * Generates a html anchor element to use as a marker to find the property on the page\r\n */\r\nHTMLDataViewer.prototype.getValueIDMarker = function(renderer){\r\n\tvar idm = document.createElement(\"a\");\r\n\tidm.setAttribute(\"class\", \"terminus-value-idmarker\");\r\n\tvar subj = TerminusClient.FrameHelper.getShorthand(renderer.subject());\r\n\tif(!subj ) subj = renderer.subject();\r\n\tvar bits = subj .split(\":\");\r\n\tif(bits.length > 1) subj = bits[1];\r\n\tvar prop = TerminusClient.FrameHelper.getShorthand(renderer.property());\r\n\tif(!prop ) prop = renderer.property();\r\n\tvar bits = prop.split(\":\");\r\n\tif(bits.length > 1) prop = bits[1];\r\n\tidm.setAttribute(\"name\", subj + \"_\" + prop + \"_\" + renderer.index);\r\n\treturn idm;\r\n}\r\n\r\nHTMLDataViewer.prototype.getSummaryDOM = function(){\r\n\tvar sum = this.renderer.getSummary();\r\n\treturn HTMLTerminusClient.FrameHelper.getInfoboxDOM(\"value-summary\", false, sum.long, sum.long);\r\n}\r\n\r\nHTMLDataViewer.prototype.fireInternalLink = function(link){\r\n\tvar self = this;\r\n\tvar fire = function(e){\r\n\t\te.preventDefault();\r\n\t\tself.renderer.load(link);\t\t\r\n\t}\r\n\treturn fire;\r\n}\r\n\r\nHTMLDataViewer.prototype.internalLink = function(link, label){\r\n\tvar onclick = this.fireInternalLink(link);\r\n\tvar a = document.createElement(\"a\");\r\n\ta.onClick = onclick;\r\n\ta.href=link;\r\n\ta.addEventListener(\"click\", onclick);\r\n\tif(label){\r\n\t\ta.appendChild(document.createTextNode(label));\r\n\t}\r\n\telse {\r\n\t\tvar sh = TerminusClient.FrameHelper.getShorthand(link);\r\n\t\tif(sh){\r\n\t\t\ta.setAttribute(\"title\", link);\r\n\t\t\ta.appendChild(document.createTextNode(sh));\r\n\t\t}\r\n\t\telse {\r\n\t\t\ta.appendChild(document.createTextNode(link));\r\n\t\t}\r\n\t}\r\n\treturn a;\r\n}\r\n\r\nHTMLDataViewer.prototype.clear = function(){\r\n\tTerminusClient.FrameHelper.removeChildren(this.valDOM);\r\n}\r\n\r\n\r\nfunction HTMLDataHeaderViewer(){}\r\n\r\nHTMLDataHeaderViewer.prototype.getAsDOM = function(renderer){\r\n\tif(renderer.currentFacet() == \"page\"){\r\n\t\tvar objDOM = document.createElement(\"div\");\r\n\t}\r\n\telse {\r\n\t\tvar objDOM = document.createElement(\"span\");\r\n\t}\r\n\tobjDOM.setAttribute(\"class\", \"terminus-value-header terminus-value-header-\" + renderer.currentFacet());\r\n\tif(renderer.showFeature(\"facet\")){\r\n\t\tvar facetDOM = this.getValueFacetDOM(renderer);\r\n\t\tif(facetDOM) objDOM.appendChild(facetDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"viewer\")){\r\n\t\tvar hideDOM = this.getViewerSelectorDOM(renderer);\r\n\t\tif(hideDOM) objDOM.appendChild(hideDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"type\")){\r\n\t\tvar typeDOM = this.getValueTypeDOM(renderer);\r\n\t\tif(typeDOM) objDOM.appendChild(typeDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"status\")){\r\n\t\tvar sumDOM = this.getValueStatusDOM(renderer);\r\n\t\tif(sumDOM) objDOM.appendChild(sumDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"control\")){\r\n\t\tvar controlsDOM = this.getValueControlsDOM(renderer);\r\n\t\tif(controlsDOM) objDOM.appendChild(controlsDOM);\r\n\t}\r\n\treturn objDOM;\r\n}\r\n\r\nHTMLDataHeaderViewer.prototype.getValueFacetDOM = function(renderer){\r\n\tvar viewables = renderer.getAvailableFacets();\r\n\tvar self = this;\r\n\tif(viewables && viewables.length){\r\n\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-value-facet\");\r\n\t\tvar callback = function(val){\r\n\t\t\tif(val){\r\n\t\t\t\trenderer.setFacet(val);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"value-facet\", viewables, renderer.currentFacet(), callback);\r\n\t\tmpropDOM.appendChild(sel);\r\n\t\treturn mpropDOM;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\n\r\nHTMLDataHeaderViewer.prototype.getValueTypeDOM = function(renderer){\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"value-type\", \"Type\", renderer.type(), \"All data values have types, identified by a unique URL\");\r\n}\r\n\r\nHTMLDataHeaderViewer.prototype.getValueStatusDOM = function(renderer){\r\n\tvar sum = renderer.getSummary();\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"status-\"+sum.status, false, sum.status, sum.status);\r\n}\r\n\r\n\r\nHTMLDataHeaderViewer.prototype.getValueControlsDOM = function(renderer){\r\n\tvar controlsDOM = document.createElement(\"span\");\r\n\tcontrolsDOM.setAttribute(\"class\", \"terminus-value-controls\");\r\n\tif(renderer.showFeature(\"mode\")){\r\n\t\tvar viewsDOM = HTMLFrameHelper.getModeSelectorDOM(\"value\", renderer);\r\n\t\tif(viewsDOM) controlsDOM.appendChild(viewsDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"delete\")){\r\n\t\tvar dpropDOM = this.getValueDeleteDOM(renderer);\r\n\t\tif(dpropDOM) controlsDOM.appendChild(dpropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"clone\")){\r\n\t\tvar cpropDOM = this.getValueCloneDOM(renderer);\r\n\t\tif(cpropDOM) controlsDOM.appendChild(cpropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"reset\")){\r\n\t\tvar rpropDOM = this.getValueResetDOM(renderer);\r\n\t\tif(rpropDOM) controlsDOM.appendChild(rpropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"update\")){\r\n\t\tvar upropDOM = this.getValueUpdateDOM(renderer);\r\n\t\tif(upropDOM) controlsDOM.appendChild(upropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"show\")){\r\n\t\tvar showDOM = this.getValueShowDOM(renderer);\r\n\t\tif(showDOM) controlsDOM.appendChild(showDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"hide\")){\r\n\t\tvar hideDOM = this.getValueHideDOM(renderer);\r\n\t\tif(hideDOM) controlsDOM.appendChild(hideDOM);\r\n\t}\r\n\treturn controlsDOM;\r\n}\r\n\r\nHTMLDataHeaderViewer.prototype.getValueDeleteDOM = function(renderer){\r\n\tvar callback = function(){renderer.delete()};\r\n\tvar disabled = (renderer.cardControlAllows(\"delete\") ? false : \"Cardinality Rules Forbid Delete\");\r\n\treturn HTMLFrameHelper.getActionControl(\"value\", \"delete\", \"Delete\", callback, disabled);\r\n}\r\n\r\nHTMLDataHeaderViewer.prototype.getValueResetDOM = function(renderer){\r\n\tvar callback = function(){renderer.reset()};\r\n\tvar disabled = (renderer.isUpdated() ? false : \"Nothing to reset\");\r\n\treturn HTMLFrameHelper.getActionControl(\"value\", \"reset\", \"Reset\", callback, disabled);\r\n}\r\n\r\nHTMLDataHeaderViewer.prototype.getValueShowDOM = function(renderer){\r\n\tvar callback = function(){renderer.show()};\r\n\treturn HTMLFrameHelper.getActionControl(\"value\", \"show\", \"Show\", callback);\r\n}\r\n\r\nHTMLDataHeaderViewer.prototype.getValueHideDOM = function(renderer){\r\n\tvar callback = function(){renderer.hide()};\r\n\treturn HTMLFrameHelper.getActionControl(\"value\", \"hide\", \"Hide\", callback);\r\n}\r\n\r\nHTMLDataHeaderViewer.prototype.getValueCloneDOM = function(renderer){\r\n\tvar callback = function(){renderer.clone()};\r\n\tvar disabled = (renderer.cardControlAllows(\"clone\") ? false : \"Cardinality Rules Forbid Clone\");\r\n\treturn HTMLFrameHelper.getActionControl(\"value\", \"clone\", \"Clone\", callback, disabled);\r\n}\r\n\r\nHTMLDataHeaderViewer.prototype.getValueUpdateDOM = function(renderer){\r\n\tvar dpropDOM = document.createElement(\"span\");\r\n\tdpropDOM.setAttribute(\"class\", \"terminus-value-update\");\r\n\tvar saveback = function(){renderer.save()};\r\n\tvar disabled = (renderer.isUpdated() ? false : \"Nothing to save - no change\");\r\n\tdpropDOM.appendChild(HTMLFrameHelper.getActionControl(\"value\", \"save\", \"Save\", saveback, disabled));\r\n\treturn dpropDOM;\r\n}\r\n\r\nHTMLDataHeaderViewer.prototype.getViewerSelectorDOM = function(renderer){\r\n\tvar viewers = renderer.getAvailableViewers();\r\n\tif(viewers && viewers.length){\r\n\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-value-viewer\");\r\n\t\tvar callback = function(viewer){\r\n\t\t\tif(viewer){\r\n\t\t\t\trenderer.setViewer(viewer);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar selected = renderer.currentViewer();\r\n\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"data-viewer\", viewers, selected, callback);\r\n\t\tmpropDOM.appendChild(sel);\r\n\t\treturn mpropDOM;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nmodule.exports=HTMLDataViewer;\r\n","/* User interface elements that relate to server context\r\n *\r\n * TerminusServerController is a control widget that invokes server actions\r\n * TerminusServerViewer is a window that displays server actions and server screens\r\n *\r\n */\r\n const Datatables = require('./plugins/datatables.terminus');\r\n const UTILS =require('./Utils');\r\n const HTMLFrameHelper = require('./html/HTMLFrameHelper');\r\n \r\n const TerminusClient = require('@terminusdb/terminus-client');\r\n\r\n function TerminusServerController(ui){\r\n\t this.ui = ui;\r\n }\r\n\r\nTerminusServerController.prototype.getAsDOM = function(){\r\n\tvar rsc = document.createElement(\"div\");\r\n\trsc.setAttribute(\"class\", \"terminus-server-controller\");\r\n\tvar self = this;\r\n\tif(this.ui && this.ui.server()){\r\n\t\tvar scd = document.createElement(\"div\");\r\n\t\tscd.setAttribute(\"class\", \"terminus-server-connection\");\r\n        var nav = document.createElement('div');\r\n        nav.setAttribute('class', 'span3');\r\n        var ul = document.createElement('ul');\r\n        ul.setAttribute('class', 'terminus-ul');\r\n        nav.appendChild(ul);\r\n        rsc.appendChild(nav);\r\n        // connected to server\r\n        // change server\r\n        if(this.ui.showControl(\"change-server\")){\r\n            var a = document.createElement('a');\r\n            a.setAttribute('class', 'terminus-a terminus-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\r\n            var self = this;\r\n            a.addEventListener(\"click\", function(){\r\n                UTILS.activateSelectedNav(this, self);\r\n                self.ui.showLoadURLPage();\r\n            })\r\n            var icon = document.createElement('i');\r\n            icon.setAttribute('class', 'terminus-menu-icon fa fa-link');\r\n            a.appendChild(icon);\r\n            var txt = document.createTextNode('Change Server');\r\n            a.appendChild(txt);\r\n            ul.appendChild(a);\r\n        }\r\n        // view databases\r\n        if(this.ui.showControl(\"db\")){\r\n            var a = document.createElement('a');\r\n            a.setAttribute('class', 'terminus-a terminus-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\r\n            var self = this;\r\n            a.addEventListener(\"click\", function(){\r\n                UTILS.activateSelectedNav(this, self);\r\n                if(self.ui.db()){\r\n                    self.ui.clearDB();\r\n\t\t\t\t\tself.ui.redrawControls();\r\n                }\r\n                self.ui.showServerMainPage();\r\n            })\r\n            var icon = document.createElement('i');\r\n            icon.setAttribute('class', 'terminus-menu-icon fa fa-home');\r\n            a.appendChild(icon);\r\n            var txt = document.createTextNode('Home');\r\n            a.appendChild(txt);\r\n            ul.appendChild(a);\r\n        }\r\n\t\tif(this.ui.showControl(\"create_database\")){\r\n            var a = document.createElement('a');\r\n            a.setAttribute('class', 'terminus-a terminus-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\r\n            var self = this;\r\n            a.addEventListener(\"click\", function(){\r\n               UTILS.activateSelectedNav(this, self);\r\n                if(self.ui.db()){\r\n                    self.ui.clearDB();\r\n\t\t\t\t\tself.ui.redrawControls();\r\n                }\r\n                self.ui.showCreateDBPage();\r\n            })\r\n            var icon = document.createElement('i');\r\n            icon.setAttribute('class', 'terminus-menu-icon fa fa-plus');\r\n            a.appendChild(icon);\r\n            var txt = document.createTextNode('Create Database');\r\n            a.appendChild(txt);\r\n            ul.appendChild(a);\r\n        }\r\n        if(this.ui.showControl(\"collaborate\")){\r\n            var a = document.createElement('a');\r\n            a.setAttribute('class', 'terminus-a terminus-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\r\n            var self = this;\r\n            a.addEventListener(\"click\", function(){\r\n               UTILS.activateSelectedNav(this, self);\r\n                if(self.ui.db()){\r\n                    self.ui.clearDB();\r\n\t\t\t\t\tself.ui.redrawControls();\r\n                }\r\n                self.ui.showCollaboratePage();\r\n            })\r\n            var icon = document.createElement('i');\r\n            icon.setAttribute('class', 'terminus-menu-icon fa fa-share-alt');\r\n            a.appendChild(icon);\r\n            var txt = document.createTextNode('Collaborate');\r\n            a.appendChild(txt);\r\n            ul.appendChild(a);\r\n\t\t}\r\n\t}\r\n\treturn rsc;\r\n}\r\n\r\nTerminusServerController.prototype.getServerLabelDOM = function(){\r\n\tvar srec = this.ui.client.connection.getServerRecord();\r\n\tvar lab = (srec && srec['rdfs:label'] && srec['rdfs:label'][\"@value\"] ? srec['rdfs:label'][\"@value\"] : this.ui.server());\r\n\tvar desc = (srec && srec['rdfs:comment'] && srec['rdfs:comment'][\"@value\"] ? srec['rdfs:comment'][\"@value\"] : \"\");\r\n\tdesc += \" Server URL: \"+ this.ui.server();\r\n\tvar val = document.createElement(\"span\");\r\n\tval.setAttribute(\"class\", \"terminus-server-value\");\r\n\tval.setAttribute(\"title\", desc);\r\n\tval.appendChild(document.createTextNode(lab));\r\n    val =  document.createElement('div');\r\n\treturn val;\r\n}\r\n\r\nfunction TerminusServerViewer(ui){\r\n\tthis.ui = ui;\r\n\tthis.server = this.ui.server();\r\n\tthis.max_cell_size = 500;\r\n\tthis.max_word_size = 40;\r\n}\r\n\r\nTerminusServerViewer.prototype.getAsDOM = function(selected){\r\n\tvar self = this;\r\n\tvar pd = document.createElement(\"span\");\r\n\tpd.setAttribute(\"class\", \"terminus-server-home-page\");\r\n\tif(this.ui.server()){\r\n\t\tvar scd = document.createElement(\"span\");\r\n\t\tscd.setAttribute(\"class\", \"terminus-server-home\");\r\n\t\tif(this.ui.showView(\"server\")){\r\n\t\t\t// 11092019 scd.appendChild(this.getServerDetailsDOM());\r\n\t\t}\r\n\t\tif(this.ui.showView(\"change-server\")){\r\n\t\t\tvar csbut = document.createElement(\"button\");\r\n\t\t\tcsbut.setAttribute(\"class\", \"terminus-control-button terminus-change-server-button terminus-btn\")\r\n\t\t\tcsbut.appendChild(document.createTextNode(\"Disconnect\"));\r\n\t\t\tcsbut.addEventListener(\"click\", function(){\r\n\t\t\t\t//self.ui.clearDB();\r\n\t\t\t\t//self.ui.clearServer();\r\n\t\t\t\tself.ui.showLoadURLPage();\r\n\t\t\t})\r\n\t\t\t// 11092019 scd.appendChild(csbut);\r\n\t\t}\r\n\t\tif(this.ui.showView(\"create_database\")){\r\n\t\t\tvar crbut = document.createElement(\"button\");\r\n\t\t\tcrbut.setAttribute(\"class\", \"terminus-control-button terminus-create-db-button terminus-btn\")\r\n\t\t\tcrbut.appendChild(document.createTextNode(\"Create New Database\"));\r\n\t\t\tcrbut.addEventListener(\"click\", function(){\r\n\t\t\t\tif(self.ui.db()){\r\n\t\t\t\t\t//self.ui.clearDB();\r\n\t\t\t\t}\r\n\t\t\t\tself.ui.clearMessages();\r\n\t\t\t\tself.ui.showCreateDBPage();\r\n\t\t\t})\r\n\t\t\t// 11092019 scd.appendChild(crbut);\r\n\t\t}\r\n\t\tif(this.ui.showView(\"db\")){\r\n\t\t\t//scd.appendChild(this.getNDBListDOM());\r\n\t\t\tscd.appendChild(this.getDBListDOM());\r\n\t\t}\r\n\t\tpd.appendChild(scd);\r\n\t}\r\n\telse {\r\n\t\tself.ui.showLoadURLPage();\r\n\r\n\t\t//pd.appendChild(this.getLoadURLPage());\r\n\t}\r\n\treturn pd;\r\n}\r\n\r\nTerminusServerViewer.prototype.getServerDetailsDOM = function(){\r\n\tvar scd = document.createElement(\"span\");\r\n\tscd.setAttribute(\"class\", \"terminus-server-details terminus-server-banner\");\r\n\tvar scl = document.createElement(\"span\");\r\n\tscl.setAttribute(\"class\", \"terminus-label terminus-server-info\");\r\n\tscl.appendChild(document.createTextNode(\"Connected to Server - \"))\r\n\tvar scs = document.createElement(\"span\");\r\n\tscs.setAttribute(\"class\", \"terminus-value terminus-server-info\");\r\n\tscs.appendChild(document.createTextNode(this.ui.server()))\r\n\tscd.appendChild(scl);\r\n\tscd.appendChild(scs);\r\n\treturn scd;\r\n}\r\n\r\nTerminusServerViewer.prototype.wrapTableLinkCell = function(tdElement,dbid, text){\r\n\tvar self = this;\r\n\tvar wrap = document.createElement(\"p\");\r\n//\twrap.setAttribute(\"href\", \"#\");\r\n\twrap.setAttribute(\"class\", \"terminus-table-content\");\r\n\tHTMLFrameHelper.wrapShortenedText(wrap, text, this.max_cell_size, this.max_word_size);\r\n\ttdElement.addEventListener(\"click\", function(){\r\n\t\tself.ui.connectToDB(dbid);\r\n\t\tself.ui.showDBMainPage();\r\n\t});\r\n\treturn wrap;\r\n}\r\n\r\nTerminusServerViewer.prototype.getNDBListDOM = function(){\r\n\tvar whtml = new TerminusHTMLViewer(this.ui.client);\r\n\tvar dbrecs = this.ui.client.connection.getServerDBRecords();\r\n\r\n\t//var tab = whtml.table();\r\n}\r\n\r\nTerminusServerViewer.prototype.getDBListDOM = function(){\r\n\tvar self = this;\r\n\tvar sec = document.createElement(\"div\");\r\n\tsec.appendChild(UTILS.getHeaderDom('Available Databases'));\r\n\tvar scd = document.createElement(\"table\");\r\n\tscd.setAttribute(\"class\", \"terminus-db-list terminus-db-size terminus-hover-table terminus-margin-top\");\r\n\tvar thead = document.createElement(\"thead\");\r\n\tvar thr = document.createElement(\"tr\");\r\n\tvar th1 = document.createElement(\"th\");\r\n\tth1.appendChild(document.createTextNode(\"ID\"));\r\n\tth1.setAttribute(\"class\", \"terminus-db-id terminus-table-header-full-css\");\r\n\tvar th2 = document.createElement(\"th\");\r\n\tth2.appendChild(document.createTextNode(\"Title\"));\r\n\tth2.setAttribute(\"class\", \"terminus-db-title terminus-table-header-full-css\");\r\n\tvar th3 = document.createElement(\"th\");\r\n\tth3.appendChild(document.createTextNode(\"Description\"));\r\n\tth3.setAttribute(\"class\", \"terminus-db-description terminus-table-header-full-css\");\r\n\tvar th4 = document.createElement(\"th\");\r\n\tth4.setAttribute(\"class\", \"terminus-db-size terminus-table-header-full-css\");\r\n\tth4.appendChild(document.createTextNode(\"Size\"));\r\n\tvar th5 = document.createElement(\"th\");\r\n\tth5.setAttribute(\"class\", \"terminus-db-created terminus-table-header-full-css\");\r\n\tth5.appendChild(document.createTextNode(\"Created\"));\r\n\tvar th6 = document.createElement(\"th\");\r\n\tth6.appendChild(document.createTextNode(\"Delete\"));\r\n\tth6.setAttribute(\"class\", \"terminus-db-delete terminus-table-header-full-css\");\r\n\tthr.appendChild(th1);\r\n\tthr.appendChild(th2);\r\n\tthr.appendChild(th3);\r\n\t//thr.appendChild(th4);\r\n\t//thr.appendChild(th5);\r\n\tthr.appendChild(th6);\r\n\tthead.appendChild(thr);\r\n\tscd.appendChild(thead);\r\n\tvar tbody = document.createElement(\"tbody\");\r\n\tvar dbrecs = this.ui.client.connection.getServerDBRecords();\r\n\tfor(let fullid in dbrecs){\r\n\t\tlet dbrec = dbrecs[fullid];\r\n\t\tconst dbid = fullid.split(\":\")[1];\r\n\t\tlet tr = document.createElement(\"tr\");\r\n\t\tvar td1 = document.createElement(\"td\");\r\n\t\ttd1.appendChild(this.wrapTableLinkCell(td1,dbid, dbid));\r\n\t\ttd1.setAttribute(\"class\", \"terminus-db-id terminus-db-pointer\");\r\n\t\tvar td2 = document.createElement(\"td\");\r\n\t\ttd2.setAttribute(\"class\", \"terminus-db-title terminus-db-pointer\");\r\n\t\tvar txt = (dbrec && dbrec['rdfs:label'] && dbrec['rdfs:label']['@value'] ? dbrec['rdfs:label']['@value'] : \"\");\r\n\t\ttd2.appendChild(this.wrapTableLinkCell(td2,dbid, txt));\r\n\t\tvar td3 = document.createElement(\"td\");\r\n\t\ttd3.setAttribute(\"class\", \"terminus-db-description terminus-db-pointer\");\r\n\t\tvar txt = (dbrec && dbrec['rdfs:comment'] && dbrec['rdfs:comment']['@value'] ? dbrec['rdfs:comment']['@value'] : \"\");\r\n\t\ttd3.appendChild(this.wrapTableLinkCell(td3,dbid, txt));\r\n\t\tvar td4 = document.createElement(\"td\");\r\n\t\ttd4.setAttribute(\"class\", \"terminus-db-size terminus-db-pointer\");\r\n\t\tvar txt = (dbrec && dbrec['terminus:size'] && dbrec['terminus:size']['@value'] ? dbrec['terminus:size']['@value'] : \"\");\r\n\t\ttd4.appendChild(this.wrapTableLinkCell(td4,dbid, txt));\r\n\t\tvar td5 = document.createElement(\"td\");\r\n\t\ttd5.setAttribute(\"class\", \"terminus-db-created terminus-db-pointer\");\r\n\t\tvar txt = (dbrec && dbrec['terminus:last_updated'] && dbrec['terminus:last_updated']['@value'] ? dbrec['terminus:last_updated']['@value'] : \"\");\r\n\t\ttd5.appendChild(this.wrapTableLinkCell(td5,dbid, txt));\r\n\t\tvar td6 = document.createElement(\"td\");\r\n\t\ttd6.setAttribute(\"class\", \"db-delete\");\r\n\t\tvar delbut = this.ui.getDeleteDBButton(dbid);\r\n\t\tif(delbut) td6.appendChild(delbut);\r\n\r\n\t\ttr.appendChild(td1);\r\n\t\ttr.appendChild(td2);\r\n\t\ttr.appendChild(td3);\r\n\t\t//tr.appendChild(td4);\r\n\t\t//tr.appendChild(td5);\r\n\t\ttr.appendChild(td6);\r\n\t\ttbody.appendChild(tr);\r\n\t}\r\n\tscd.appendChild(tbody);\r\n\tsec.appendChild(scd);\r\n\r\n\tif(this.ui.pluginAvailable(\"datatables\")){\r\n        var dt = new Datatables.CspDatatables(this.ui);\r\n\t\tvar tab = dt.draw(scd);\r\n\t}\r\n\treturn sec;\r\n}\r\n\r\n\r\nmodule.exports = {TerminusServerViewer,TerminusServerController}\r\n","const TerminusClient = require('@terminusdb/terminus-client');\r\nconst HTMLFrameHelper = require('../html/HTMLFrameHelper');\r\nconst UTILS= require('../Utils')\r\n\r\n/*** client side processing ***/\r\nfunction CspDatatables(ui){\r\n    this.ui = ui;\r\n}\r\n\r\nCspDatatables.prototype.convertToDatatable = function(tab){\r\n    var dt = this;\r\n    var table = jQuery(tab).DataTable({\r\n         searching : false,\r\n         pageLength: 25,\r\n         lengthMenu: [10, 25, 50, 75, 100],\r\n         paging    : true,\r\n         select    : true,\r\n         initComplete: function(settings) {\r\n                        var ict =settings.oInstance.api();\r\n                        ict.$('td').each(function(){\r\n                            this.setAttribute('title', $(this).html())\r\n                        })},\r\n         columnDefs:[{targets:'_all',className:\"truncate\"}],\r\n         createdRow: function(row) {\r\n                            var td = $(row).find(\".truncate\");\r\n                            td.attr(\"title\", td.html());}\r\n    }); //jQuery(tab)\r\n\r\n    // on click of row connect to db, on click of 5th column delete db\r\n    jQuery(tab, 'tbody').on('click', 'td', function(){\r\n        if(table.cell(this).index().column == 5){\r\n            var dbInfo = table.row(jQuery(this).parents('tr')).data();\r\n            var dbId = UTILS.extractValueFromCell(dbInfo[0]);\r\n            dt.ui.deleteDatabase(dbId);\r\n            return;\r\n        }\r\n        else dt.ui.showDBMainPage();\r\n     }); // on click\r\n\r\n    tab.setAttribute('class'      , 'stripe dataTable terminus-db-size');\r\n    tab.setAttribute('cellpadding', '1');\r\n    tab.setAttribute('cellspacing', '0');\r\n    tab.setAttribute('border'     , '0');\r\n    return tab;\r\n}\r\n\r\nCspDatatables.prototype.draw = function(dtResult){\r\n    return(this.convertToDatatable(dtResult));\r\n}\r\n\r\n/*** server side processing ***/\r\nfunction Datatables(wResViewer, qPage){\r\n   this.wrViewer = wResViewer;\r\n   this.wQuery = wResViewer.wQuery;\r\n   this.ui = wResViewer.ui;\r\n   this.qPage = qPage;\r\n   this.currDTSettings = wResViewer.settings;\r\n}\r\n\r\n/*\r\n    query: new woqlquery with current pagination changes\r\n    pageInfo: current drawCallBack page change info\r\n    resultDOM: result dom on veiwer page\r\n*/\r\nDatatables.prototype.executeQuery = function(qObj, pageInfo, resultDOM){\r\n    var self = this;\r\n    // return this.wQuery.execute(query)\r\n    return qObj.execute(this.ui.client)\r\n    .then(function(result){\r\n      var dtResult = {};\r\n      var wqRes = new TerminusClient.WOQLResult(result, qObj);\r\n      dtResult = self.wrViewer.formatResultsForDatatableDisplay(result.bindings, pageInfo)\r\n      return dtResult.data;\r\n    })\r\n    .catch(function(err){\r\n      console.error(err);\r\n      self.ui.showError(err);\r\n    });\r\n}\r\n\r\n/* get query string based on datatable pagination and current query */\r\n/*Datatables.prototype.getQueryOnPagination = function(wq, settings){\r\n    switch(settings.query){\r\n        case 'Show_All_Documents':\r\n            return wq.getAllDocumentQuery(null, settings.pageLength, settings.start);\r\n        break;\r\n        case 'Show_All_Data':\r\n            return wq.getEverythingQuery(null, settings.pageLength, settings.start);\r\n        break;\r\n        case 'Show_All_Schema_Elements':\r\n            return wq.getElementMetaDataQuery(null, settings.pageLength, settings.start);\r\n        break;\r\n        case 'Show_Document_Classes':\r\n        \tvar sqp = wq.getConcreteDocumentClassPattern(\"Class\");\r\n            return wq.getClassMetaDataQuery(sqp);\r\n        break;\r\n        case 'Show_All_Properties':\r\n            return wq.getPropertyListQuery(null, settings.pageLength, settings.start);\r\n        break;\r\n        case 'Show_All_Classes':\r\n            return wq.getClassMetaDataQuery(null, settings.pageLength, settings.start);\r\n        break;\r\n        case 'Show_Data_Class':\r\n            return  wq.getDataOfChosenClassQuery(settings.chosenValue, settings.pageLength, settings.start);\r\n        break;\r\n        case 'Show_Property_Class':\r\n            return wq.getDataOfChosenPropertyQuery(settings.chosenValue, settings.pageLength, settings.start);\r\n        break;\r\n        case 'Show_Document_Info_by_Id':\r\n            return wq.getDocumentQuery(settings.chosenValue, settings.pageLength, settings.start);\r\n        break;\r\n        case 'Show_All_Document_classes':\r\n            return wq.getClassesQuery(settings.pageLength, settings.start);\r\n        break;\r\n        default:\r\n            console.log('Invalid woql option passed');\r\n        break;\r\n\r\n    }\r\n}   */\r\n/*\r\n    pageInfo: current drawCallBack page change info\r\n*/\r\nDatatables.prototype.generateNewQueryOnPageChange = function(pageInfo){\r\n    if(this.qPage) UTILS.deleteStylizedEditor(this.ui, pageInfo.qTextDom);\r\n    var qObj = UTILS.getCurrentWoqlQueryObject(null, pageInfo);\r\n    //var query = this.getQueryOnPagination(this.wQuery, pageInfo)\r\n    if(this.qPage) {\r\n        if(pageInfo.queryMode.value == 'woql')\r\n            pageInfo.qTextDom.value = JSON.stringify(qObj.prettyPrint(), undefined, 2);\r\n        else pageInfo.qTextDom.value = JSON.stringify(qObj, undefined, 2);\r\n        UTILS.stylizeEditor(this.ui, pageInfo.qTextDom, 'query', 'javascript');\r\n    }\r\n    //return query;\r\n    return qObj;\r\n}\r\n\r\n/*\r\n    dt: Datatable reference\r\n    len : current number of records to display\r\n*/\r\nDatatables.prototype.getCallbackSettings = function(dt, dtAPIChangeSettings){\r\n    var pageInfo = {};\r\n    pageInfo.pageLength  = dtAPIChangeSettings._iDisplayLength;\r\n    pageInfo.start       = dtAPIChangeSettings._iDisplayStart;\r\n    pageInfo.draw        = dtAPIChangeSettings.iDraw;\r\n    pageInfo.qTextDom    = dt.qTextDom;\r\n    pageInfo.queryMode   = dt.queryMode;\r\n    if(this.qPage) pageInfo.query = dt.query;\r\n    else pageInfo.query = 'Show_All_Document_classes';\r\n    pageInfo.chosenValue = dt.chosenValue;\r\n    return pageInfo;\r\n}\r\n\r\n/*\r\n    tab: datatable table dom\r\n    settings : settings from woql txt generator\r\n    resultDOM: result dom of viewer\r\n*/\r\nDatatables.prototype.setUp = function(tab, settings, resultDOM){\r\n    // delete previous datatable\r\n    TerminusClient.FrameHelper.removeChildren(this.dtdom);\r\n    this.dtdom = document.createElement('div');\r\n    this.dtdom.appendChild(tab);\r\n    resultDOM.appendChild(this.dtdom);\r\n    // saving query text box dom to change limit value on change of datatable page length\r\n    this.qTextDom = settings.qTextDom;\r\n    this.query = settings.query;\r\n    this.chosenValue = settings.chosenValue;\r\n    this.queryMode = settings.queryMode;\r\n}\r\n\r\n// update datatables settings so it can be reused in WOQLTextboxGenerator to re write query in woql/ jsonld\r\nDatatables.prototype.updateCurrDTSettings = function(pageInfo){\r\n    this.currDTSettings.pageLength = pageInfo.pageLength;\r\n    this.currDTSettings.start      = pageInfo.start;\r\n}\r\n\r\nDatatables.prototype.getNewDataOnChange = function(drawnTab, aSettings, resultDOM){\r\n    var pageInfo = this.getCallbackSettings(this, aSettings);\r\n    this.updateCurrDTSettings(pageInfo);\r\n   // var query = this.generateNewQueryOnPageChange(pageInfo);\r\n    var qObj = this.generateNewQueryOnPageChange(pageInfo);\r\n    return this.executeQuery(qObj, pageInfo, resultDOM);\r\n    //return this.executeQuery(query, pageInfo, resultDOM);\r\n    //return  dtResult.result.data;\r\n}\r\n\r\nDatatables.prototype.getDataFromServer = function(dtResult, resultDOM){\r\n    var dt = this;\r\n    var tab = dtResult.tab;\r\n    this.setUp(tab, this.wrViewer.settings, resultDOM);\r\n    // initialize datatables\r\n    var table = jQuery(tab).DataTable({\r\n         searching   : false,\r\n         pageLength  : dt.wrViewer.settings.pageLength,\r\n         serverSide  : true,\r\n         processing  : true,\r\n         lengthMenu  : [25, 50, 75, 100],\r\n         dom         : 'RBlftip',\r\n         columns     : dtResult.result.columns,\r\n         paging      : true,\r\n         select      : true,\r\n         autoWidth   : true,\r\n         ajax        : function (data, callback, settings) {\r\n                            if(Object.entries(dtResult.result.data).length > 0){\r\n                                // first draw is loaded\r\n                                var res = dtResult.result.data;\r\n                                dtResult.result.data = {};\r\n                                callback(res);\r\n                            }\r\n                            else{\r\n                                dt.getNewDataOnChange(this, settings, resultDOM)\r\n                                    .then(function(result){\r\n                                     callback(result);\r\n                                })\r\n                            }\r\n                       },\r\n         buttons     : [{ extend: 'copy', text: 'Copy to clipboard' },\r\n                        { extend: 'excel', text: 'Export to Excel' }],\r\n         columnDefs  : [{ targets:'_all',\r\n                          className:\"truncate\"}],\r\n         createdRow  : function(row){\r\n                            var td = $(row).find(\".truncate\");\r\n                            td.attr(\"title\", td.html());},\r\n         scrollX     : true\r\n    }); //jQuery(tab)\r\n\r\n    // on click of doc\r\n    jQuery(tab, 'tbody').on('click', 'td', function(){\r\n        if(table.cell(this).data){\r\n            if(this.innerText.substring(0, 4) == \"doc:\"){\r\n                if(dt.wrViewer.result.ui) {\r\n        \t\t\tdt.wrViewer.result.ui.showDocument(this.innerText);\r\n        \t\t\tdt.wrViewer.result.ui.redraw();\r\n        \t\t\tdt.wrViewer.selectDocumentNavBar(dt.ui);\r\n        \t\t}\r\n            }\r\n        }\r\n     }); // on click\r\n\r\n    //styling\r\n    tab.setAttribute('class'      , 'stripe dataTable');\r\n    tab.setAttribute('style'      , 'margin: 0!important');\r\n    tab.setAttribute('cellpadding', '1');\r\n    tab.setAttribute('cellspacing', '1');\r\n    tab.setAttribute('border'     , '0');\r\n\r\n    return tab;\r\n}\r\n\r\n/*\r\nserverside: true or false\r\n*/\r\nDatatables.prototype.draw = function(dtResult, resultDOM){\r\n    return(this.getDataFromServer(dtResult, resultDOM));\r\n}\r\n\r\nmodule.exports={Datatables, CspDatatables}\r\n","const UTILS = require(\"./Utils.js\");\r\n\r\nfunction TerminusURLLoader(ui, val){\r\n\tthis.ui = ui;\r\n\tthis.val = val;\r\n\tthis.url_input = false;\r\n\tthis.key_input = false;\r\n}\r\n\r\nTerminusURLLoader.prototype.getLabelDOM = function(){\r\n\treturn document.createTextNode(\"Connect\");\r\n}\r\n\r\nTerminusURLLoader.prototype.getFormFieldDOM = function(ip, fname, ltxt, pholder){\r\n\tvar sci = document.createElement(\"div\");\r\n\tsci.setAttribute(\"class\", \"terminus-form-horizontal terminus-control-group terminus-form-field-spacing terminus-display-flex terminus-field-\"+fname);\r\n\tvar lab = document.createElement(\"span\");\r\n\tlab.setAttribute(\"class\", \"terminus-control-label terminus-form-label terminus-form-field-label terminus-label-\"+fname);\r\n\tlab.appendChild(document.createTextNode(ltxt))\r\n\tip.setAttribute(\"type\", \"text\");\r\n\tip.setAttribute(\"placeholder\", pholder);\r\n\tsci.appendChild(lab);\r\n\tsci.appendChild(ip);\r\n\treturn sci;\r\n}\r\n\r\nTerminusURLLoader.prototype.getAsDOM = function(){\r\n\tvar scd = document.createElement(\"div\");\r\n\tscd.setAttribute(\"class\", \"terminus-form terminus-url-loader\");\r\n\tscd.appendChild(UTILS.getHeaderDom('Connect To Terminus Server'));\r\n\tvar mfd = document.createElement('div');\r\n\tmfd.setAttribute('class', 'terminus-form-border terminus-margin-top');\r\n\tscd.appendChild(mfd);\r\n\tthis.url_input = document.createElement(\"input\");\r\n\tthis.url_input.setAttribute(\"class\", \"terminus-form-value terminus-form-url terminus-form-field-input terminus-input-text\");\r\n\tif(this.val){\r\n\t\tthis.url_input.value = this.val;\r\n\t}\r\n\tvar dht = document.createElement('div');\r\n\tdht.setAttribute('class', 'terminus-form-margin-top');\r\n\tmfd.appendChild(dht);\r\n\tmfd.appendChild(this.getFormFieldDOM(this.url_input, \"connect\", \"URL\", \"Terminus DB URL\"));\r\n\tthis.key_input = document.createElement(\"input\");\r\n\tthis.key_input.setAttribute(\"class\", \"terminus-form-value terminus-value terminus-input-text\");\r\n\tmfd.appendChild(this.getFormFieldDOM(this.key_input, \"connect\", \"Key\", \"Server API Key\"));\r\n\tvar loadbuts = document.createElement(\"div\");\r\n\tloadbuts.setAttribute(\"class\", \"terminus-control-buttons\");\r\n\tvar loadbut = document.createElement(\"button\");\r\n\tloadbut.setAttribute(\"class\", \"terminus-control-button terminus-url-load terminus-btn terminus-btn-float-right\");\r\n\tloadbut.appendChild(document.createTextNode(\"Connect\"));\r\n\tvar self = this;\r\n\tloadbut.addEventListener(\"click\", function(){\r\n\t\tif(self.url_input.value){\r\n\t\t\tself.ui.load(self.url_input.value, self.key_input.value);\r\n\t\t}\r\n\t});\r\n\tloadbuts.appendChild(loadbut);\r\n\tmfd.appendChild(loadbuts);\r\n\treturn scd;\r\n}\r\n\r\n\r\nmodule.exports=TerminusURLLoader\r\n"],"sourceRoot":""}
{"version":3,"sources":["webpack://TerminusDashboard/webpack/bootstrap","webpack://TerminusDashboard/./src/Utils.js","webpack://TerminusDashboard/./src/query/WOQLQuery.js","webpack://TerminusDashboard/./src/plugins/TerminusPlugin.js","webpack://TerminusDashboard/./src/client/RenderingMap.js","webpack://TerminusDashboard/./src/client/HTMLFrameHelper.js","webpack://TerminusDashboard/./src/client/TerminusClassChooser.js","webpack://TerminusDashboard/./src/query/WOQLResultsViewer.js","webpack://TerminusDashboard/./src/client/TerminusDocument.js","webpack://TerminusDashboard/./src/plugins/datatables.terminus.js","webpack://TerminusDashboard/./src/client/ObjectViewer.js","webpack://TerminusDashboard/./src/client/viewers/String.js","webpack://TerminusDashboard/./src/client/viewers/DateHelper.js","webpack://TerminusDashboard/./src/client/viewers/GoogleMapHelper.js","webpack://TerminusDashboard/./src/client/PropertyViewer.js","webpack://TerminusDashboard/./src/client/DataViewer.js","webpack://TerminusDashboard/./src/client/TerminusDocumentChooser.js","webpack://TerminusDashboard/./src/index.js","webpack://TerminusDashboard/./src/TerminusUI.js","webpack://TerminusDashboard/./src/ApiExplorer.js","webpack://TerminusDashboard/./src/plugins/codemirror.terminus.js","webpack://TerminusDashboard/./src/client/ObjectRenderer.js","webpack://TerminusDashboard/./src/client/viewers/StringEditor.js","webpack://TerminusDashboard/./src/client/viewers/Boolean.js","webpack://TerminusDashboard/./src/client/viewers/BooleanEditor.js","webpack://TerminusDashboard/./src/client/viewers/Choice.js","webpack://TerminusDashboard/./src/client/viewers/ChoiceEditor.js","webpack://TerminusDashboard/./src/client/viewers/Coordinate.js","webpack://TerminusDashboard/./src/client/viewers/CoordinateEditor.js","webpack://TerminusDashboard/./src/client/viewers/Date.js","webpack://TerminusDashboard/./src/client/viewers/DateEditor.js","webpack://TerminusDashboard/./src/client/viewers/Entity.js","webpack://TerminusDashboard/./src/client/viewers/EntityEditor.js","webpack://TerminusDashboard/./src/client/viewers/Image.js","webpack://TerminusDashboard/./src/client/viewers/ImageEditor.js","webpack://TerminusDashboard/./src/client/viewers/Link.js","webpack://TerminusDashboard/./src/client/viewers/Number.js","webpack://TerminusDashboard/./src/client/viewers/Range.js","webpack://TerminusDashboard/./src/client/viewers/RangeEditor.js","webpack://TerminusDashboard/./src/client/viewers/SanitizedHTML.js","webpack://TerminusDashboard/./src/client/viewers/GoogleMapEditor.js","webpack://TerminusDashboard/./src/client/viewers/GoogleMapViewer.js","webpack://TerminusDashboard/./src/client/viewers/HTMLMarkupEditor.js","webpack://TerminusDashboard/./src/client/viewers/S2EntityEditor.js","webpack://TerminusDashboard/./src/client/ValueRenderer.js","webpack://TerminusDashboard/./src/client/TerminusDB.js","webpack://TerminusDashboard/./src/client/TerminusViolation.js","webpack://TerminusDashboard/./src/client/TerminusQuery.js","webpack://TerminusDashboard/./src/query/WOQLTextboxGenerator.js","webpack://TerminusDashboard/./src/client/TerminusPropertyChooser.js","webpack://TerminusDashboard/./src/query/WOQLGraphBrowserGenerator.js","webpack://TerminusDashboard/./src/query/WOQLTimePicker.js","webpack://TerminusDashboard/./src/client/TerminusMapping.js","webpack://TerminusDashboard/./src/client/TerminusSchema.js","webpack://TerminusDashboard/./src/client/TerminusServer.js","webpack://TerminusDashboard/./src/client/TerminusURL.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","Codemirror","require","getHeaderDom","text","hd","document","createElement","setAttribute","h","innerHTML","appendChild","stylizeCodeDisplay","ui","txt","dom","cmConfig","pluginAvailable","pr","colorizePre","removeSelectedNavClass","el","getElementsByClassName","length","classList","remove","hideDocumentSubMenus","contains","add","tolggleContent","icon","content","style","display","stylizeEditor","view","cm","ar","colorizeTextArea","updateTextArea","deleteStylizedEditor","qip","nextElementSibling","TerminusClient","FrameHelper","removeChildren","showHttpResult","response","action","currForm","terminator","br","retHttpHeaders","headers","hdres","createTextNode","json","then","rd","data","JSON","stringify","pre","getResponse","getInfoAlertDom","type","label","msg","ald","str","getFunctionSignature","which","sigs","spec","descr","result","args","server_url","options","title","description","database_url","details","format","editmode","document_url","fail_on_id_denied","woql","class","term","source","target","toggleVisibility","extractValueFromCell","cellValue","DOMParser","parseFromString","firstChild","activateSelectedNav","nav","showControl","checkDocumentSubMenus","WOQLResult","WOQLQuery","client","this","default_limit","prefixes","connectionConfig","platformEndpoint","sid","server","substring","lastIndexOf","colid","dbid","serverURL","schemaURL","dbURL","docURL","pref","standard_urls","setPrefixes","shorten","url","execute","wrapped","wrap","self","select","getConcreteDocumentClassPattern","varc","and","getSubclassQueryPattern","not","getAbstractQueryPattern","varname","quad","clsname","sub","queryWrappedWithLimit","query","limit","start","getAllDocumentQuery","constraint","triple","push","getEverythingQuery","wjson","getPropertyListQuery","opt","getElementMetaDataQuery","getClassListMetaDataQuery","getClassMetaDataQuery","getDataOfChosenClassQuery","chosen","getDataOfChosenPropertyQuery","getInstanceMeta","getDocumentQuery","id","getClassesQuery","TerminusPluginManager","preloaded","loaded","loading","precluded","plugins","css","js","requires","setPluginOptions","opts","k","init","calculatePreloaded","toload","calculateRequiredInitPlugins","loadPlugins","pins","pid","indexOf","getDefaultPlugins","needed_pins","loading_order","getAvailablePlugins","pl","plugin","version_check","pluginmeta","version","jQuery","isFunction","fn","slider","e","Quill","JSONEditor","CodeMirror","fontAwesomeCheck","dataTable","select2","google","maps","ol","Map","d3","console","log","Error","element","span","className","body","insertBefore","window","getComputedStyle","getPropertyValue","replace","removeChild","ticker","cback","loadPlugin","pug","cssid","loadDynamicCSS","scripts","splice","loadDynamicScript","loadPluginScripts","loadPageCSS","cssfid","cssdom","getElementById","parentNode","cssurl","pluginLoadable","pluginLoadedOrLoading","disabled","obj","getPluginDOM","plugid","a","cl","cbox","checked","clab","addEventListener","togglePlugin","redraw","unloadPlugin","drawPlugins","num","getAsDOM","dm","clh","showPlugins","ObjectViewer","HTMLStringViewer","HTMLStringEditor","HTMLBooleanViewer","HTMLBooleanEditor","HTMLChoiceViewer","HTMLChoiceEditor","HTMLCoordinateViewer","HTMLCoordinateEditor","HTMLDateViewer","HTMLDateEditor","HTMLEntityViewer","HTMLEntityEditor","HTMLImageViewer","HTMLImageEditor","HTMLLinkViewer","HTMLNumberViewer","HTMLRangeViewer","HTMLRangeEditor","SantizedHTMLViewer","GoogleMapEditor","GoogleMapViewer","HTMLMarkupEditor","S2EntityEditor","RenderingMap","registeredDataViewers","registeredDataEditors","registeredPropertyViewers","registeredPropertyEditors","registeredObjectViewers","registeredObjectEditors","getValidDataViewerList","frametype","valids","concat","getValidDataEditorList","nftypes","getValidPropertyViewerList","proptype","proprange","propdom","getValidPropertyEditorList","getViewer","vi","renderers","viewer","eval","alert","toString","getAvailablePropertyViewers","renderer","viewers","nviewers","sets","getAvailablePropertyEditors","getAvailableDataViewers","getAvailableDataEditors","getViewerForDataFrame","vals","getEditorForDataFrame","registerViewerForTypes","types","registerEditorForTypes","registerEditorForFrameType","registerViewerForFrameType","registerViewerForProperties","properties","registerEditorForProperties","HTMLPropertyViewer","patternMatchesRenderer","pattern","FramePattern","checkRenderer","compiled_options","compileOptions","parent","facets","getDefaultFacets","facet","deffacet","getDefaultFacet","hide_disabled_buttons","features","controls","viewerType","viewerOptions","header","header_viewer","HTMLObjectHeaderViewer","filter","sort","rules","output","frame_type","subject","subjectClass","range","children","depth","index","status","rtype","getRendererType","illegalRuleType","checkFrameType","checkLabel","checkSubject","checkSubjectClass","checkProperty","checkDepth","checkRange","checkValue","checkParent","checkChildren","checkIndex","checkStatus","rsubj","IDsMatch","found","prop","j","values","isUpdated","isNew","numberMatch","propertyIDsMatch","valuesMatch","rangeIDsMatch","rcls","classIDsMatch","frame","ftype","renderder","getLabel","stringMatch","ida","idb","compareIDs","vala","valb","RegExp","test","constructor","renderer_type","HTMLFrameHelper","control","callback","dpropDOM","button","selected","sel","labelFromURL","viewsDOM","setMode","getActionControl","cancel","location","href","loc","split","sh","getShorthand","bits","htmlid","help","input","infoDOM","linfo","lspacer","lval","TerminusClassChooser","choice","show_single","setRoot","root","setFilter","change","cls","ccdom","ccsel","wq","getResultsAsOptions","clist","choices","bindings","empty_choice","opt1","added","bclass","getVariableValueFromBinding","lab","Datatables","res","WOQLResultsViewer","wresult","wQuery","settings","queryPage","qPage","pman","count","hasBindings","showTable","show_table","orderColumns","sample","ordered","unshift","resultDOM","displayResultHeader","rs","rh","getTableDOM","dtResult","getTable","tab","draw","getDtTableDOMOnChange","pageInfo","formatResultsForDatatableDisplay","columns","colDataData","formattedResult","ordered_headings","validURL","getDocumentLocalLink","outerHTML","recordsTotal","recordsFiltered","getTableBody","tbody","tr","td","showDocument","dtPlugin","thead","thr","th","Renderers","TerminusDocumentViewer","db","editor","load_schema","config_options","getBuiltInViewerOptions","classmeta","instancemeta","Class","refreshPage","elid","getClassMeta","loadCreateDocument","showBusy","page_config","loadDocumentSchema","clearBusy","setLabel","error","showError","loadDocument","getDocument","loadDataFrames","ncls","unshorten","getClassFrame","loadSchemaFrames","deleteDocument","URL","createDocument","extr","extract","showViolations","updateDocument","durl","subjid","dataframes","domain","ObjectFrame","classframes","loadClassFrames","newDoc","fillFromSchema","render","getOptionsFromPageConfig","ObjectRenderer","controller","FrameConfig","pageconf","getClient","docid","labdom","dfs","getDataFrames","getStdURL","pagedom","rends","holder","controldom","keys","getDocumentPageControls","dpc","UTILS","CspDatatables","wResViewer","wrViewer","convertToDatatable","dt","table","DataTable","searching","pageLength","lengthMenu","paging","initComplete","oInstance","api","$","each","html","columnDefs","targets","createdRow","row","find","attr","on","cell","column","showDBMainPage","dbInfo","parents","dbId","deleteDatabase","executeQuery","err","getQueryOnPagination","sqp","chosenValue","generateNewQueryOnPageChange","qTextDom","undefined","getCallbackSettings","len","setUp","dtdom","getNewDataOnChange","drawnTab","aSettings","_iDisplayLength","_iDisplayStart","getDataFromServer","serverSide","processing","ajax","entries","buttons","extend","scrollX","HTMLObjectViewer","headerViewer","getObjectHeaderViewer","renderedDOM","getObjectDOM","replaceWith","getObjectIDMarker","getObjectBodyDOM","orientation","getContentOrientation","pcls","sp","vholder","getFeatureDOM","feature","hasFeatureViewer","featureViewer","redrawHeader","nheader","redrawBody","nbody","addRenderedProperty","renderedprop","clear","goTo","subj","goToName","idm","sumDOM","controlsDOM","objDOM","showFeature","facetDOM","getObjectFacetDOM","getObjectLabelDOM","idDOM","getObjectIDDOM","typeDOM","getObjectTypeDOM","getObjectStatusDOM","viewDOM","getViewPropertyDOM","hideDOM","getViewerSelectorDOM","getObjectControlsDOM","getObjectSummaryDOM","sum","getSummary","getInfoboxDOM","addDOM","getAddPropertyDOM","getModeSelectorDOM","getObjectDeleteDOM","cpropDOM","getObjectCloneDOM","rpropDOM","getObjectResetDOM","upropDOM","getObjectUpdateDOM","showDOM","getObjectShowDOM","getObjectHideDOM","viewables","getAvailableFacets","mpropDOM","getSelectionControl","currentFacet","val","setFacet","isNewDocument","required","isClassChoice","cs","getAvailableClassChoices","mlabDOM","changeClass","cmt","Label","Comment","addables","getAddableProperties","cardControlAllows","addNewProperty","getViewableProperties","goToProperty","clone","reset","getAvailableViewers","currentViewer","setViewer","hide","show","save","size","getDOM","dataviewer","HTMLDateHelper","months","getMonthName","GoogleMapHelper","polygon","polyline","markers","config","width","height","mapLat","mapLong","zoom","stroke","color","opacity","weight","fill","line","destroy","translatePolygonToArray","vertices","getPath","seenValue","getLength","xy","getAt","lat","lng","translateArrayToPolygon","array","jsonified","parse","latlong","createPolygon","coords","map","Polygon","paths","strokeColor","strokeOpacity","strokeWeight","fillColor","fillOpacity","setMap","createPolyline","Polyline","clearMarkers","addMarker","position","ty","marker","Marker","addListener","getCoordsFromMarkers","set","x","initMap","mapContainer","center","parseFloat","setPath","event","trigger","getPropertyHeaderViewer","HTMLPropertyHeaderViewer","block","propDOM","npropDOM","getPropertyDOM","getPropertyIDMarker","getPropertyBodyDOM","addRenderedValue","renderedval","wrapper","expModeMenu","getPropertyControlsDOM","getPropertyLabelDOM","statDOM","getPropertyStatusDOM","prepend","getPropertySummaryDOM","prelude","getPropertyFacetDOM","getViewValueDOM","getPropertyIDDOM","getPropertyRangeDOM","hasCardinalityRestriction","getPropertyCardinalityDOM","getPropertyCommentDOM","getComment","restriction","getRestriction","min","max","getActionControlDOM","settingsDOM","getPropertyDeleteDOM","getAddValueDOM","getPropertyResetDOM","getPropertyUpdateDOM","getPropertyShowDOM","getPropertyHideDOM","getSettingsControlDOM","addClass","getViewableValues","goToValue","showValue","HTMLDataViewer","getValueHeaderViewer","HTMLDataHeaderViewer","JSONObjectViewer","valDOM","nvalDOM","getValueDOM","getValueIDMarker","getValueBodyDOM","vdom","getDataValueViewer","getSummaryDOM","HTMLTerminusClient","internalLink","link","onclick","preventDefault","load","onClick","getValueFacetDOM","getValueTypeDOM","getValueStatusDOM","getValueControlsDOM","getValueDeleteDOM","getValueCloneDOM","getValueResetDOM","getValueUpdateDOM","getValueShowDOM","getValueHideDOM","TerminusDocumentChooser","show_button","getS2DOM","getIDDOM","docchooser","cfilter","termcc","new_class","tdom","s2config","dataType","params","contentType","delay","cache","placeholder","dcip","keyCode","dbut","toggleView","getChangeViewText","TerminusUI","ApiExplorer","TerminusDBsdk","TerminusViolations","TerminusQueryViewer","TerminusMappingViewer","TerminusSchemaViewer","TerminusServersdk","TerminusURLLoader","WOQLClient","setOptions","connect","getDBRecord","connectToDB","showView","schema","showSchemaPage","showQueryPage","explorer","showExplorer","showServerMainPage","createDatabase","dbdets","Promise","reject","getBadArguments","myserver","dbdoc","generateNewDatabaseDocument","getSchema","updateSchema","refreshDBList","crec","connection","getCrashString","showMessage","delrec","lid","dbn","removeDB","dets","doc","rdfs","terminus","fname","getConnectionEndpoint","clearServer","clearDB","TerminusServerViewer","redrawMainPage","showLoadURLPage","TerminusDBViewer","showCreateDBPage","TerminusDBCreator","showMappingPage","mapping","getDocViewerOptions","showCreateDocument","getDocCreatorOptions","main","showResult","clearMessages","messages","clearMainPage","setMessageDOM","setbuttonControls","setControllerDOM","setExplorerDOM","setPluginsDOM","setViewerDOM","comps","slocation","toggleControl","drawControls","toggleDashboardWidget","widget","drawExplorer","loadControls","ncontrol","nd","exp","ae","sc","TerminusServerController","TerminusDBController","show_controls","pseudoCapability","capabilitiesPermit","show_views","busy","getBusyLoader","bsyDom","pd","pbc","pbsa","pbia","md","msgHolder","vios","nvios","cmsg","views","document_options","schema_options","piman","addPlugin","getClassFrameOptions","viewdoc_options","apiNavConfig","mainNav","navText","defaultSelected","database","subNav","getClassFrames","viewDocument","update","use_fetch","return_full_response","aec","getApiNav","getApiExplorerDom","setSelectedNavMenu","setSelectedSubMenu","navOnSelect","createNavs","navConfig","ul","navDom","cont","apiCont","getConnectExplorer","getDatabaseExplorer","getSchemaApi","getDocumentApi","getQueryApi","changeSubApiDom","curSubMenu","getDatabaseDom","getShowApiDom","getQueryApiDom","subNavOnSelect","subMenuConfig","createSubNavs","b","getSignature","getForm","getServerForm","form","fd","inpLabel","cd","inpId","keyLabel","resd","gatherips","curApi","urlPlaceholder","formDoc","urlLabel","inpUrl","docUrlLabel","inpDocUrl","inpKey","docLabel","inpDoc","inp","docUrl","getApiSendButton","getApiForm","enc","schurl","buttonSelf","connected_mode","gtxtar","txtar","dcurl","schemaUrlDom","payload","htmlEditor","getValue","sg","ic","sig","textdom","darkMode","jsonldCheck","fromTextArea","firstLineNumber","lineNumbers","styleActiveLine","lineWrapping","smartIndent","indentWithTabs","newlineAndIndent","autoCloseBrackets","matchBrackets","afterCursor","extraKeys","refresh","setCodemirrorSize","defaultCharWidth","setOption","setSize","setTimeout","runMode","innerText","theme","ValueRenderer","PropertyViewer","PropertyRenderer","predicate","cframe","objframe","getPropertyClassFrame","originalValues","changed","originalProperties","newProperties","TerminusDashboard","decorateRenderer","getOptionsForChild","getOptionsForValue","df","getOptionsForObject","buildValueRenderers","getViewerForProperty","adorig","isData","getDataFramesToRender","vr","kids","getChildrenToRender","kidf","viewIncludesChildren","allkids","getChildren","extracts","updated","childUpdated","hasRestriction","cf","getClassChoices","clsmeta","deleteProperty","addProperty","setNew","addPropertyClass","newb","nvals","deletePropertyValue","removePropertyValue","addPropertyValue","rest","currentnum","new_property","hideDisabledControls","hide_disabled_controls","nocascade","parentFacetChange","page","multiline","summary","containsPage","isObject","setView","nukeViewer","ptype","ret","valcount","vsum","getFeaturesForFacet","getOptionsForProperty","buildPropertyRenderers","getViewerForObject","props","getPropertiesToRender","renders","parentObject","copy","nkid","genBNID","parentobj","newrend","demandid","inputID","dval","nprops","removeProperty","ctl","getController","new_object","isPartOfNewDocument","isnew","pfacet","vrend","propcount","nviewer","getFilledPropertyList","getMissingPropertyList","standardSort","patterns","sorted","rdft","rdfc","extractLDO","full","extractJSONLD","jsonld_context","extracted","empty","getType","big","isBigType","getTypeSize","vallab","els","elements","foptions","getChoiceOptions","inputs","parsed","badData","lldom","getInputDOMs","long","latdom","longdom","getLatLongDOM","firstcol","delbut","getTypeShorthand","updateValueFromForm","op","lldoms","butspan","addbut","ipdoms","DateHelper","allowbce","date_spacer","time_spacer","datetime_separator","helper","parseDate","datepart","getDateComponentDOM","timepart","getTimeComponentDOM","hdom","hour","mdom","minute","mlab","sdom","second","slab","tz","timezone","dadom","ydom","year","month","ddom","day","part","xsd","xsdFromParsed","opdom","getEntityViewHTML","getEntityLabel","dv","nspan","InstanceLabel","tit","InstanceType","InstanceComment","img","commas","numberWithCommas","delimiter","parseRangeValue","rvals","svals","tnode","getRangeSymbolDOM","x2","t2node","data1","data2","firstip","secondip","showing_range","but","changeHandler","mapcontainer","ghelper","latLng","coo","path","inner","quill","d2ch","dataframe","originalValue","isDocument","nf","nvr","inline","getAPIURL","DBURL","getEntityReference","entities","bd","new_value","text_summary_length","v","nrend","getViewerForValue","isDatatypeProperty","objlit","isString","lang","isChoice","getViewerForDataValue","ft","wquery","dbc","scd","dbrec","nm","item","getControlHTML","displayDocumentSubMenus","getDocumentChooserDOM","getDocumentCreatorDOM","showSubMenus","gd","nbut","mcls","nlab","click","nbuts","tcdom","gb","bi","tds","bt","tts","nlabs","ccDOM","sth","banner","dhp","scs","getDeleteOnHomePage","getDBSummary","getClassesDOM","getDbInfoBox","info","charAt","toUpperCase","slice","del","dbdel","confirm","q","nor","sct","mfd","sci","idip","titip","descip","schem","datip","butfield","cancbut","loadbut","TerminusViolation","vio","context_msg","vioHeading","getPropertyAsDOM","pdom","ldom","WOQLTextboxGenerator","WOQLGraphBrowserGenerator","meta","generator","gentype","generators","gbrowse","loadGenerator","hasGeneratorOptions","changeGenerator","ng","redrawGenerator","inputDOM","getQueryButtonsDOM","nquery","Element","getResultViewDom","qbox","getQueryCreatorChoiceDOM","qtHolder","qTextBox","getQueryTextAreaDOM","buttonsDOM","qcc","gen","box","TerminusPropertyChooser","tq","qman","datatable","gatherDatatableSettings","txtArea","queryName","getQueryButtonGroups","qGroupQueries","qrow","g","srcElement","textContent","nodeName","qeb","ch","setDatatableSettings","eqh","qbut","qval","qbuts","qexs","qh","qcGroup","nqbut","aqbut","qvalue","ebut","pbut","prbut","qdGroup","termpc","qdocGroup","docch","docdom","d2dom","clGroup","dtGroup","docGroup","labopt","comopt","cprop","WOQLTimePicker","DCOGBrowser","model","myowner","default_viewport","current_viewport","viewports","viewportDOMs","browserid","randomString","query_timeslice","current_result","focus_node","show_filter","entity_count","default_display","icon_unicode","forward","backward","getSliderDOM","DCOGQueryFilter","DCOGTimePicker","getViewportAsDOM","vpdom","newQuery","success","getQuery","setBusy","untell","DCOGQueryResult","containsData","setViewportData","node","getNodeOrFringe","from_node","nodeCount","fillInfoBoxes","nodeSelected","rebuildController","tellUser","moreResults","nfocus","addMoreResults","updateViewportData","showBusyOverlay","insert_patterns","browser","dqr","qstruct","to_node","source_node","target_node","current_relationships","relationships","current_depth","max_path_length","current_threshold","filters","shareholding_threshold","server_side","timeslice","date","wake","initData","qstr","groupID","initDOM","setData","updateData","setViewportFilter","sections","getNodeInfoSections","followNode","setFocusNode","setPathSearch","node_from","node_to","changeTimeSlice","valto","force","isTemporalSuperset","setFilterTimeslice","setQueryTimeslice","getTimeslice","getControllerAsDOM","cdom","getControllerViewButtonsAsDOM","toolboxDOM","getUserToolboxDOM","filterDOM","legendDOM","getControllerFilterAsDOM","fdom","getRelationshipFilterAsDOM","ndom","getQueryParameterDOM","ipfield","getSliderTypeDOM","gobut","toggleFilterVisibility","getLegendAsDOM","userMessageDOM","msgdom","dlc","bdoms","bdom","legend","getNodeRelativeSize","nconf","getNodeDisplaySettings","getLineWidth","getModelElementDisplaySettings","elt","modeldisplay","isBidirectional","edge","typeID","conf","getRelationshipClass","nick","getGraphElementDisplaySettings","nds","getLinkDisplaySettings","getElementIcon","getClassIcon","getElementIconUnicode","getElementColour","setUpIPGSpecials","reldisptypes","entdisptypes","rid","disptype","eid","slidertype","from","to","ss","years","toggleServerSideFiltering","getSliderParameters","end","pointInit","slide","tt","tickToTime","rangeInit","val2","noshow","showCurrentPick","ticknum","nval","seconds_ago","Date","getTime","timeToTick","timeval","y","getFullYear","thisy","changeSliderType","ntype","updateSliderDOM","dcd","cb","lb","slideDOM","TopAxisDOM","curdate","cursdate","curedate","LabelDOM","PayloadDOM","L2DOM","getSliderAxisDOM","sconfig","getTimesliceAsTicks","vtf","vtt","fy","adjustOffset","tval","tick","unit","offsetWidth","off","sd","Y2Time","tsel","o1","o2","ff","getFormFieldDOM","getFormField","queries","submit","jsonip","map_source","map_target","confirm_before_update","loadSchema","msgtype","resetControlDOM","getSchemaSaveButtons","getSchemaImportActionButtons","getShowSchemaButton","getClassFrameChooser","getSchemaEditButton","getImportButton","getFormatChoices","fc","tc","tj","refreshMainPage","getSchemaViewDOM","getSchemaEditDOM","getSchemaImportDOM","getClassFrameDOM","ssb","getCancelButton","getSaveButton","getImportSaveButton","getSchemaButton","getImportPreviewButton","is_import","doImport","schema_edit_dom","func","origurl","newschema","appendSchema","setSchemaURL","showConfirmPage","s2","nschema","np","docviewer","ipval","klab","modes","overwrite","append","max_cell_size","max_word_size","rsc","getServerLabelDOM","srec","getServerRecord","desc","csbut","crbut","getDBListDOM","getServerDetailsDOM","scl","wrapTableLinkCell","tdElement","replacements","words","word","newstr","sec","lihed","th1","th2","th3","th4","th5","th6","dbrecs","getServerDBRecords","fullid","td1","td2","td3","td4","td5","td6","deleteDBPermitted","delDB","url_input","key_input","getLabelDOM","ip","ltxt","pholder","stit","loadbuts"],"mappings":"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","file":"terminus-dashboard.min.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 16);\n","/**\r\n * @file Javascript Api explorer tool\r\n * @author Kitty Jose\r\n * @license Copyright 2018-2019 Data Chemist Limited, All Rights Reserved. See LICENSE file for more\r\n *\r\n * @summary Set of functions used across scripts\r\n */\r\nconst Codemirror= require('./plugins/codemirror.terminus');\r\n// function to read Files\r\nfunction readFile(file){\r\n    if (window.XMLHttpRequest){\r\n        // code for IE7+, Firefox, Chrome, Opera, Safari\r\n        xmlhttp=new XMLHttpRequest();\r\n    }\r\n    else{\r\n        // code for IE6, IE5\r\n        xmlhttp=new ActiveXObject(\"Microsoft.XMLHTTP\");\r\n    }\r\n    xmlhttp.open(\"GET\",file,false);\r\n    xmlhttp.send();\r\n    xmlDoc=xmlhttp.responseText;\r\n    return xmlDoc;\r\n} // readFile()\r\n\r\n// function to write api call signatures from woql client\r\nfunction getFunctionSignature(which){\r\n  var sigs = {};\r\n  sigs.connect = {\r\n    spec   : \"WOQLClient.connect(surl, key)\",\r\n    descr  : \"\\n\\nConnect to a Terminus server at the given URI with an API key\"\r\n                + \"Stores the terminus:ServerCapability document returned in the connection register\"\r\n                + \"which stores, the url, key, capabilities, and database meta-data for the connected server\"\r\n                + \"If the curl argument is false or null, the this.server will be used if present,\"\r\n                + \" or the promise will be rejected.\"\r\n                + \"\\n1)The first (surl) argument: {string} argument it is the Server Url\"\r\n                + \"\\n2)The second(key) argument: {string} argument contains an API key\",\r\n    result : \"HTTP 200 on success, 409 for already existing database, otherwise error code\",\r\n    args   : {server_url : 'url', key: 'Api key'},\r\n    options: { title: \"\", description: \"\" }\r\n  };\r\n  sigs.create = {\r\n    spec    : \"WOQLClient.createDatabase(dburl, details, key)\",\r\n    descr   : \"\\n\\nCreate a Terminus Database\"\r\n                + \"\\n1)The first (dburl) argument:{string}, it is a terminusDB Url or a terminusDB Id \"\r\n                + \"\\n2)The second(details) argument:{object}, details which is the payload\"\r\n                + \"\\n which included information of the new database to be created\"\r\n                +  \"\\n3)The third (key) argument:{string}, contains an API key \",\r\n    result : \"HTTP 200 on success, 409 for already existing database, otherwise error code\",\r\n    args   : {database_url : 'url', details: '', key: ' Api key'},\r\n    options: { title: \"\", description: \"\" }\r\n  };\r\n  sigs.delete = {\r\n      spec  : \"WOQLClient.deleteDatabase(dburl, key)\",\r\n      descr : \"\\n\\nDeletes a Database\"\r\n                + \"\\n1)The first (dburl) argument: {string}, it is a terminusDB Url or a terminusDB Id \"\r\n                + \"\\n2)The second(key) argument: {string}, contains an API key\",\r\n      result: \"HTTP 200 on success, otherwise error code\",\r\n  };\r\n  sigs.getSchema = {\r\n    spec   : \"WOQLClient.getSchema(surl, options)\",\r\n    descr  : \"\\n\\nGets the schema of a database.\"\r\n             +\"\\n1)The first (surl) argument: {string}, it is a dbUrl/schema\"\r\n             + \"\\n2)The second(key) argument: {string}, contains an API key\",\r\n    result : \"Ontology Document on success (HTTP 200), 409 for already existing database, otherwise error code\",\r\n    options: { format: \"turtle\" }\r\n  };\r\n  sigs.getClassFrames = {\r\n    spec   : \"WOQLClient.getClassFrame = function(cfurl, cls, opts)\",\r\n    descr  : \"\\n\\nRetrieves a WOQL query on the specified database which updates the state and returns the results\"\r\n              +  \"\\nThe first (cfurl) argument can be\"\r\n              + \"\\n1) a valid URL of a terminus database or\"\r\n              +  \"\\n2) omitted - the current database will be used\"\r\n              +  \"\\nthe second argument (cls) is the URL / ID of a document class that exists in the database schema\"\r\n              +  \"\\nthe third argument (opts) is an options json - opts.key is an optional API key\",\r\n    result : \"Ontology Document on success (HTTP 200), 409 for already existing database, otherwise error code\",\r\n    options: { format: \"turtle\" }\r\n  };\r\n  sigs.updateSchema = {\r\n    spec    : \"WOQLClient.updateSchema(schurl, docs, options)\",\r\n    descr   : \"\\n\\nUpdates the Schema of the specified database\"\r\n                +\"\\n1)The first (surl) argument :{string}, is a dbUrl/schema\"\r\n                + \"\\n2)The second(docs) argument:{object}, is a valid owl ontology (new schema to be updated) in turtle format\"\r\n                + \"\\n3)The third (key) argument:{string}, contains an API key\",\r\n    result : \"Ontology Document on success (HTTP 200), 409 for already existing database, otherwise error code\",\r\n    args   : {document : 'doc'},\r\n    options: { format: \"turtle\", editmode: \"replace\"}\r\n  };\r\n  sigs.createDocument = {\r\n    spec   : \"WOQLClient.createDocument(docurl, document, options)\",\r\n    descr  : \"\\n\\nCreates a new document in the specified database\"\r\n              + \"\\n1)The first (docurl) argument: {string}, is a dbUrl/document/document_id\"\r\n              + \"\\n2)The second(document) argument: {object}, is a valid document in json-ld\"\r\n              + \"\\n3)The third (key) argument:{string}, contains an API key\",\r\n    result : \"Created Document on success (HTTP 200), Violation Report Otherwise (HTTP 400+)\",\r\n    args   : {document_url : 'url', document: \"doc\"},\r\n    options: { format: \"turtle\", fail_on_id_denied: false}\r\n  };\r\n  sigs.viewDocument = {\r\n    spec    : \"WOQLClient.getDocument(docurl, options)\",\r\n    descr   : \"\\n\\nRetrieves a document from the specified database\"\r\n              + \"\\n1)The first (docurl) argument: {string}, is a dbUrl/document/document_id\"\r\n              + \"\\n2)The second (key) argument: {string}, contains an API key\",\r\n    result : \"Document (HTTP 200), Violation Report Otherwise (HTTP 400+)\",\r\n    args   : {document_url : 'url'},\r\n    options: { format: \"turtle\"}\r\n  };\r\n  sigs.updateDocument = {\r\n    spec   : \"WOQLClient.updateDocument(docurl, document, options)\",\r\n    descr  : \"\\n\\nUpdates a document in the specified database with a new version\"\r\n                + \"\\n1)The first (docurl) argument: {string}, is a dbUrl/document/document_id\"\r\n                + \"\\n2)The second(document) argument: {object}, is a valid document in json-ld\"\r\n                + \"\\n3)The third (key) argument:{string} argument contains an API key\",\r\n    result : \"Ontology Document on success (HTTP 200), 409 for already existing database, otherwise error code\",\r\n    args   : {document_url : 'url', document: \"doc\"},\r\n    options: { format: \"turtle\", editmode: \"replace\"}\r\n  };\r\n  sigs.deleteDocument = {\r\n    spec  : \"WOQLClient.deleteDocument(docurl, key)\",\r\n    descr : \"\\n\\nDeletes a document from the specified database\"\r\n            + \"\\n1)The first (docurl) argument: {string},is a dbUrl/document/document_id\"\r\n            + \"\\n2)The second (key) argument: {string}, contains an API key\",\r\n    result: \"Ontology Document on success (HTTP 200), 409 for already existing database, otherwise error code\",\r\n    args  : {document_url : 'url'},\r\n  };\r\n  sigs.select = {\r\n    spec: \"WOQLClient.select(dburl, query, options)\",\r\n    descr: \"\\n\\nExecutes a read-only WOQL query on the specified database and returns the results\"\r\n              + \"\\n1)The first (docurl) argument: {string}, is a terminusDB Url or a terminusDB Id\"\r\n              + \"\\n2)The second (query) argument: {object}, a valid query in json-ld format \"\r\n              + \"\\n3)The third (key) argument:{string}, contains an API key\",\r\n    result: \"WOQL Result (HTTP 200), otherwise error code\",\r\n    args: {woql: 'woql'},\r\n  };\r\n  sigs.update = {\r\n    spec  : \"WOQLClient.update(dburl, query, options)\",\r\n    descr : \"\\n\\nExecutes a WOQL query on the specified database which updates the state and returns the results\"\r\n              + \"\\n1)The first (dburl) argument: {string}, is a terminusDB Url or a terminusDB Id\"\r\n              + \"\\n2)The second (query) argument: {object}, a valid query in json-ld format \"\r\n              + \"\\n3)The third (key) argument:{string}, contains an API key\",\r\n    result: \"WOQL Result (HTTP 200), otherwise error code\",\r\n    args  : {woql: 'woql'},\r\n  };\r\n  sigs.lookup = {\r\n    spec: \"WOQLClient.lookup(database_url, woql, options)\",\r\n    result: \"WOQL Result (HTTP 200), otherwise error code\",\r\n    args: {class: 'url', term: 'string'},\r\n  };\r\n  sigs.map = {\r\n    spec: \"WOQLClient.lookup(source, target, woql, options)\",\r\n    result: \"WOQL Result (HTTP 200), otherwise error code\",\r\n    args: {source: 'json', target: \"json\", woql: 'json'},\r\n  };\r\n  sigs.getClassFrame = {\r\n    spec: \"WOQLClient.getClassFrame(class, options)\",\r\n    result: \"WOQL Result (HTTP 200), otherwise error code\",\r\n    args: {class: 'url'},\r\n  };\r\n  sigs.getPropertyFrame = {\r\n    spec: \"WOQLClient.getPropertyFrame(class, property, options)\",\r\n    result: \"WOQL Result (HTTP 200), otherwise error code\",\r\n    args: {class: 'url', property: 'url'},\r\n  };\r\n  sigs.getFilledPropertyFrame = {\r\n    spec: \"WOQLClient.getPropertyFrame(document_url, property, options)\",\r\n    result: \"WOQL Result (HTTP 200), otherwise error code\",\r\n    args: {document_url: 'url', property: 'url'},\r\n  };\r\n  sigs.getSubClasses = {\r\n    spec: \"WOQLClient.getSubClasses(class, options)\",\r\n    result: \"WOQL Result (HTTP 200), otherwise error code\",\r\n    args: {class: 'url'},\r\n  };\r\n  return sigs[which];\r\n}//getFunctionSignature\r\n\r\n// returns dom element for header text\r\nfunction getHeaderDom(text){\r\n  var hd = document.createElement('div');\r\n  hd.setAttribute('class', 'terminus-module-head');\r\n  var h = document.createElement('h3');\r\n  h.innerHTML = text;\r\n  hd.appendChild(h);\r\n  return hd;\r\n} // getHeaderTextDom\r\n\r\n// returns dom for alert banner\r\nfunction getInfoAlertDom(type, label, msg){\r\n  var ald = document.createElement('div');\r\n  if(type == 'info') ald.setAttribute('class', 'terminus-alert terminus-alert-success');\r\n  else ald.setAttribute('class', 'alert');\r\n  var str = document.createElement('STRONG');\r\n  str.innerHTML = label;\r\n  ald.appendChild(str);\r\n  var txt = document.createTextNode(msg);\r\n  ald.appendChild(txt);\r\n  return ald;\r\n} // getInfoAlertDom()\r\n\r\n// formats response results from platform\r\nfunction getResponse(currForm, action, response, terminator){\r\n\r\n  var rd = document.createElement('div');\r\n\r\n  // get header result\r\n  rd.appendChild(getHeaderDom('Result'));\r\n  var br = document.createElement('BR');\r\n  rd.appendChild(br);\r\n\r\n  var data = JSON.stringify(response, 0, 4);\r\n\r\n  var pre = document.createElement('pre');\r\n  pre.setAttribute('class', 'terminus-api-view terminus-scheme-pre');\r\n  pre.innerHTML = data;\r\n\r\n  var cm = stylizeCodeDisplay(terminator, pre, rd, 'javascript');\r\n  if(!cm) rd.appendChild(pre);\r\n\r\n  var br = document.createElement('BR');\r\n  rd.appendChild(br);\r\n\r\n  currForm.appendChild(rd);\r\n\r\n  return currForm;\r\n}\r\n\r\n// formats the response from fetch call and spits out Http header and result\r\nfunction showHttpResult(response, action, currForm, terminator){\r\n    //var currForm = document.createElement('div');\r\n\r\n    var br = document.createElement('BR');\r\n    currForm.appendChild(br);\r\n    var br = document.createElement('BR');\r\n    currForm.appendChild(br);\r\n\r\n    // get header result\r\n    currForm.appendChild(getHeaderDom('HTTP Header'));\r\n\r\n    var br = document.createElement('BR');\r\n    currForm.appendChild(br);\r\n\r\n     var retHttpHeaders  = '';\r\n\r\n     // iterate over all headers\r\n     for (let [key, value] of response.headers) {\r\n       retHttpHeaders = retHttpHeaders +  `${key} = ${value}` + '\\n';\r\n     }\r\n\r\n    // http header result\r\n    var hdres = document.createElement('pre');\r\n    hdres.setAttribute('class', 'terminus-api-signature-pre');\r\n    var txt = document.createTextNode(retHttpHeaders);\r\n    hdres.appendChild(txt);\r\n\r\n    var cm = stylizeCodeDisplay(terminator, hdres, currForm, 'message/http');\r\n    if(!cm) currForm.appendChild(hdres);\r\n\r\n    return response.json()\r\n    .then(function(response){\r\n      getResponse(currForm, action, response, terminator); // get return response\r\n    })\r\n\r\n} // UTILS.showHttpResult()\r\n\r\n\r\nfunction deleteStylizedEditor(ui, qip){\r\n    if(ui.pluginAvailable(\"codemirror\")){\r\n\t\tvar cm = qip.nextElementSibling;\r\n\t\tcm.setAttribute('class', 'terminus-hide');\r\n\t\tTerminusClient.FrameHelper.removeChildren(cm);\r\n\t}\r\n}\r\n\r\n/* ui: terminus ui reference\r\n   txt: text area to be stylized\r\n   view: defines the size of editor to appear in pages (schema/ query)\r\n   mode: format to be displayed in\r\n*/\r\nfunction stylizeEditor(ui, txt, view, mode){\r\n    var cmConfig = ui.pluginAvailable(\"codemirror\");\r\n    if(!(cmConfig)) return;\r\n\tvar cm = new Codemirror(txt, mode, cmConfig);\r\n\tvar ar = cm.colorizeTextArea(view);\r\n\tcm.updateTextArea(ar);\r\n}\r\n\r\n/* ui: terminus ui reference\r\n   txt: text area to be stylized\r\n   dom: stylized pre area is appended to dom\r\n   mode: format to be displayed in\r\n*/\r\nfunction stylizeCodeDisplay(ui, txt, dom, mode){\r\n    var cmConfig = ui.pluginAvailable(\"codemirror\");\r\n    if(!(cmConfig)) return false;\r\n    var cm = new Codemirror(txt, mode, cmConfig);\r\n    var pr = cm.colorizePre();\r\n    dom.appendChild(pr);\r\n    return true;\r\n}\r\n\r\n/* name: classname to find and remove classes from elements\r\n*/\r\nfunction removeSelectedNavClass(name){\r\n    var el = document.getElementsByClassName(name);\r\n    for(var i=0; i<el.length; i++){\r\n        el[i].classList.remove(name);\r\n    }\r\n}\r\n\r\n// toggles between contents\r\nfunction tolggleContent(icon, content){\r\n    if (content.style.display === \"block\"){\r\n        removeSelectedNavClass(\"fa-chevron-up\");\r\n        icon.classList.add(\"fa-chevron-down\");\r\n        content.style.display = \"none\";\r\n    }\r\n    else{\r\n        removeSelectedNavClass(\"fa-chevron-down\");\r\n        icon.classList.add(\"fa-chevron-up\");\r\n        content.style.display = \"block\";\r\n    }\r\n}\r\n\r\n// controls current selected nav bar\r\nfunction activateSelectedNav(nav, terminator){\r\n    removeSelectedNavClass(\"terminus-selected\");\r\n\tcheckDocumentSubMenus(terminator);\r\n\tnav.classList.add(\"terminus-selected\");\r\n}\r\n\r\nfunction hideDocumentSubMenus(el){\r\n\tif(el.classList.contains('terminus-display')){\r\n\t\tel.classList.remove('terminus-display');\r\n\t\tel.classList.add('terminus-hide');\r\n\t}\r\n}\r\n\r\nfunction checkDocumentSubMenus(terminator){\r\n\tif(terminator.ui.showControl(\"get_document\")) {\r\n\t\tvar gd = document.getElementsByClassName('terminus-get-doc');\r\n\t\thideDocumentSubMenus(gd[0]);\r\n\t}\r\n\tif(terminator.ui.showControl(\"create_document\")) {\r\n\t\tvar cd = document.getElementsByClassName('terminus-create-doc');\r\n\t\thideDocumentSubMenus(cd[0]);\r\n\t}\r\n}\r\n\r\nfunction toggleVisibility(el){\r\n\tif(el.classList.contains('terminus-display')){\r\n\t\tel.classList.remove('terminus-display');\r\n\t\tel.classList.add('terminus-hide');\r\n\t}\r\n    else if(el.classList.contains('terminus-hide')){\r\n        el.classList.remove('terminus-hide');\r\n\t\tel.classList.add('terminus-display');\r\n\t}\r\n}\r\n\r\nfunction extractValueFromCell(cellValue){\r\n    var ihtml = new DOMParser().parseFromString(cellValue, \"text/xml\");\r\n    return ihtml.firstChild.innerHTML;\r\n}\r\n\r\nmodule.exports={tolggleContent,\r\n               removeSelectedNavClass,\r\n               stylizeCodeDisplay,\r\n               stylizeEditor,\r\n               deleteStylizedEditor,\r\n               showHttpResult,\r\n               getHeaderDom,\r\n               getInfoAlertDom,\r\n               getFunctionSignature,\r\n               toggleVisibility,\r\n               extractValueFromCell,\r\n               activateSelectedNav}\r\n","const WOQLResult = require('./WOQLResultsViewer');\r\n\r\nfunction WOQLQuery(client, options, ui){\r\n\tthis.client = client;\r\n\tthis.options = options;\r\n\tthis.ui = ui;\r\n\tthis.default_limit = 1000;\r\n\tthis.prefixes = {};\r\n\tif(client.connectionConfig.platformEndpoint()){\r\n\t\tvar sid = client.connectionConfig.server.substring(0, client.connectionConfig.server.lastIndexOf(\"platform\"));\r\n\t\tthis.sid = sid;\r\n\t\tvar colid = client.connectionConfig.server.substring(0, client.connectionConfig.server.lastIndexOf(\"platform\")) + client.connectionConfig.dbid;\r\n\t\tthis.prefixes['s'] = colid + \"/ontology/main#\";\r\n\t\tthis.prefixes['g'] = sid;\r\n\t\tthis.prefixes['db'] = colid + \"/\";\r\n\t\tthis.prefixes['doc'] = colid + \"/candidate/\";\r\n\t\tthis.prefixes['dg'] = colid + \"/graph/main/\";\r\n\t}\r\n\telse {\r\n\t\tthis.sid = client.connectionConfig.serverURL();\r\n\t\tthis.prefixes['s'] = client.connectionConfig.schemaURL() + \"#\";\r\n\t\tthis.prefixes['dg'] = client.connectionConfig.dbURL() + \"/schema\";\r\n\t\tthis.prefixes['doc'] = client.connectionConfig.docURL();\r\n\t\tthis.prefixes['db'] = client.connectionConfig.dbURL() + \"/\";\r\n\t\tthis.prefixes['g'] = client.connectionConfig.serverURL();\r\n\t}\r\n\tfor(var pref in TerminusClient.FrameHelper.standard_urls){\r\n\t\tthis.prefixes[pref] = TerminusClient.FrameHelper.standard_urls[pref];\r\n\t}\r\n}\r\n\r\nWOQLQuery.prototype.setPrefixes = function(prefixes){\r\n\tthis.prefixes = prefixes;\r\n}\r\n\r\n\r\nWOQLQuery.prototype.shorten = function(url){\r\n\tfor(var pref in this.prefixes){\r\n\t\tif(this.prefixes[pref] == url.substring(0, this.prefixes[pref].length)){\r\n\t\t\treturn ( pref + \":\" + url.substring(this.prefixes[pref].length));\r\n\t\t}\r\n\t}\r\n\treturn url;\r\n}\r\n\r\nWOQLQuery.prototype.execute = function(woql){\r\n\tvar wrapped = this.wrap(woql);\r\n\tvar self = this;\r\n\treturn this.client.select(false, wrapped)\r\n\t.then(function(response){\r\n\t\tvar res = new WOQLResult.WOQLResult(response, self, self.options, self.ui);\r\n\t\treturn res;\r\n\t});\r\n}\r\n\r\nWOQLQuery.prototype.wrap = function(woql){\r\n\tvar wjson = {\r\n\t\t\"@context\" : this.prefixes,\r\n\t\t\"from\": [\r\n\t\t\tthis.client.connectionConfig.dbURL(),\r\n\t\t\twoql\r\n\t\t]\r\n\t};\r\n\treturn wjson;\r\n}\r\n\r\nWOQLQuery.prototype.getConcreteDocumentClassPattern = function(varc){\r\n\tvar varc = varc || \"v:Class\";\r\n\tvar pat = {\r\n\t\tand: [\r\n\t\t\tthis.getSubclassQueryPattern(varc, \"tcs:Document\"),\r\n\t\t\t{\r\n\t\t\t\tnot: [this.getAbstractQueryPattern(varc)]\r\n\t\t\t}\r\n\t\t]\r\n\t}\r\n\treturn pat;\r\n}\r\n\r\nWOQLQuery.prototype.getAbstractQueryPattern = function(varname){\r\n\tvar qp = {\r\n\t\tquad: [varname, \"tcs:tag\", \"tcs:abstract\", \"db:schema\"]\r\n\t}\r\n\treturn qp;\r\n}\r\n\r\nWOQLQuery.prototype.getSubclassQueryPattern = function(varname, clsname){\r\n\tvar sqp = {sub: [varname, clsname]};\r\n\treturn sqp;\r\n}\r\n\r\nWOQLQuery.prototype.queryWrappedWithLimit = function(query, limit, start){\r\n\tlimit = limit ? limit : this.default_limit ;\r\n\tstart = start ? start : 0;\r\n\tvar wjson = {\r\n\t\tlimit: [limit, {\r\n\t\t\tstart: [start, query]\r\n\t\t}]\r\n\t};\r\n\treturn wjson;\r\n}\r\n\r\n\r\nWOQLQuery.prototype.getAllDocumentQuery = function(constraint, limit, start){\r\n\tvar query = {\r\n\t\tand: [\r\n\t\t\t{\r\n\t\t\t\ttriple: [\"v:Document\", \"rdf:type\", \"v:Type\"]\r\n\t\t\t},\r\n\t\t\tthis.getSubclassQueryPattern(\"v:Type\", \"tcs:Document\")\r\n\t\t]\r\n\t}\r\n\tif(constraint){\r\n\t\tquery.and.push(constraint);\r\n\t}\r\n\treturn this.queryWrappedWithLimit(query, limit, start);\r\n}\r\n\r\nWOQLQuery.prototype.getEverythingQuery = function(constraint, limit, start){\r\n\tvar wjson = {triple: [\"v:Subject\", \"v:Predicate\", \"v:Object\"]};\r\n\tif(constraint){\r\n\t\twjson = {and: [wjson, constraint]};\r\n\t}\r\n\treturn this.queryWrappedWithLimit(wjson, limit, start);\r\n}\r\n\r\nWOQLQuery.prototype.getPropertyListQuery = function(constraint, limit, start){\r\n\tvar wjson = {\r\n\t\tand: [{quad: [\"v:Property\", \"rdfs:range\", \"v:Range\", \"db:schema\"]},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Property\", \"rdf:type\", \"v:Type\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Property\", \"rdfs:label\", \"v:Label\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Property\", \"rdfs:comment\", \"v:Comment\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Property\", \"rdfs:domain\", \"v:Domain\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t]\r\n\t}\r\n\tif(constraint){\r\n\t\twjson = {and: [wjson, constraint]};\r\n\t}\r\n\treturn this.queryWrappedWithLimit(wjson, limit, start);\r\n}\r\n\r\n\r\nWOQLQuery.prototype.getElementMetaDataQuery = function(constraint, limit, start){\r\n\tvar wjson = {\r\n\t\tand: [{quad: [\"v:Element\", \"rdf:type\", \"v:Type\", \"db:schema\"]},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Element\", \"rdfs:label\", \"v:Label\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Element\", \"rdfs:comment\", \"v:Comment\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Element\", \"tcs:tag\", \"v:Abstract\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Element\", \"rdfs:domain\", \"v:Domain\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Element\", \"rdfs:range\", \"v:Range\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t]\r\n\t}\r\n\tif(constraint){\r\n\t\twjson = {and: [wjson, constraint]};\r\n\t}\r\n\treturn this.queryWrappedWithLimit(wjson, limit, start);\r\n}\r\n\r\nWOQLQuery.prototype.getClassListMetaDataQuery = function(constraint, limit, start){\r\n\tvar wjson = {\r\n\t\tand: [{quad: [\"v:Element\", \"rdf:type\", \"owl:Class\", \"db:schema\"]},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Element\", \"rdfs:label\", \"v:Label\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Element\", \"rdfs:comment\", \"v:Comment\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Element\", \"tcs:tag\", \"v:Abstract\", \"db:schema\"]}]\r\n\t\t\t}\r\n\t\t]\r\n\t}\r\n\tif(constraint){\r\n\t\twjson = {and: [wjson, constraint]};\r\n\t}\r\n\treturn this.queryWrappedWithLimit(wjson, limit, start);\r\n}\r\n\r\nWOQLQuery.prototype.getClassMetaDataQuery = WOQLQuery.prototype.getClassListMetaDataQuery;\r\n\r\nWOQLQuery.prototype.getDataOfChosenClassQuery = function(chosen, limit, start){\r\n\tvar wjson = {\r\n\t\tand: [{triple: [\"v:Document\", \"rdf:type\", chosen]},\r\n\t\t\t{\r\n\t\t\t\topt: [{triple: [\"v:Document\", \"v:Property\", \"v:Value\"]}]\r\n\t\t\t}\r\n\t\t]\r\n\t}\r\n\treturn this.queryWrappedWithLimit(wjson, limit, start);\r\n}\r\n\r\nWOQLQuery.prototype.getDataOfChosenPropertyQuery = function(chosen, limit, start){\r\n\tvar wjson = {\r\n\t\tand: [{triple: [\"v:Document\", chosen, \"v:Value\"]},\r\n\t\t\t{\r\n\t\t\t\topt: [{triple: [\"v:Document\", \"rdfs:label\", \"v:Label\"]}]\r\n\t\t\t}\r\n\t\t]\r\n\t}\r\n\treturn this.queryWrappedWithLimit(wjson, limit, start);\r\n}\r\n\r\nWOQLQuery.prototype.getInstanceMeta = function(url, limit, start){\r\n\tvar wjson = {\r\n\t\tand: [\r\n\t\t\t{triple: [url, \"rdfs:label\", \"v:InstanceLabel\"]},\r\n\t\t\t{triple: [url, \"rdf:type\", \"v:InstanceType\"]},\r\n\t\t\t{\r\n\t\t\t\topt: [{triple: [url, \"rdfs:comment\", \"v:InstanceComment\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:InstanceType\", \"rdfs:label\", \"v:ClassLabel\", \"db:schema\"]}]\r\n\t\t\t}\r\n\t\t]\r\n\t}\r\n\treturn this.queryWrappedWithLimit(wjson, limit, start);\r\n}\r\n\r\n\r\nWOQLQuery.prototype.getDocumentQuery = function(id, limit, start){\r\n\tvar wjson = {\r\n\t\tand: [\r\n\t\t\t{triple: [id, \"v:Property\", \"v:Property_Value\"]},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Property\", \"rdfs:label\", \"v:Property_Label\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Property\", \"rdf:type\", \"v:Property_Type\", \"db:schema\"]}]\r\n\t\t\t}\r\n\t\t]\r\n\t}\r\n\treturn this.queryWrappedWithLimit(wjson, limit, start);\r\n}\r\n\r\nWOQLQuery.prototype.getClassesQuery = function(){\r\n\tvar wjson = {\r\n\t\tand: [\r\n\t\t\t{triple: [\"v:ID\", \"rdf:type\", \"v:Class\"]},\r\n\t\t\t{\r\n\t\t\t\topt: [{triple: [\"v:ID\", \"rdfs:label\", \"v:Label\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\topt: [{triple: [\"v:ID\", \"rdfs:comment\", \"v:Comment\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Class\", \"rdfs:label\", \"v:Type\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tsub: ['v:Class', 'tcs:Document']\r\n\t\t\t}\r\n\t\t]\r\n\t}\r\n\treturn wjson;\r\n}\r\n\r\nmodule.exports=WOQLQuery\r\n","function TerminusPluginManager(){\r\n\tthis.preloaded = [];\r\n\tthis.loaded = [];\r\n\tthis.loading = [];\r\n\tthis.precluded = [];\r\n\tthis.plugins = {};\r\n\tthis.plugins[\"font-awesome\"] = {\r\n\t\tlabel: \"Font Awesome\",\r\n\t\tcss: [\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0-11/css/all.css\"]\r\n\t};\r\n\tthis.plugins[\"quill\"] = {\r\n\t\tlabel: \"Quill\",\r\n\t\tjs: [\"https://cdn.quilljs.com/1.3.6/quill.min.js\"],\r\n\t\tcss: [\"https://cdn.quilljs.com/1.3.6/quill.snow.css\"],\r\n\t};\r\n\tthis.plugins[\"codemirror\"] = {\r\n\t\tlabel : \"Code Mirror\",\r\n\t\tjs: [\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/codemirror.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/mode/xml/xml.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/mode/css/css.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/mode/turtle/turtle.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/mode/javascript/javascript.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/addon/hint/anyword-hint.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/addon/hint/show-hint.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/addon/runmode/runmode.js\",\r\n\t\t  \t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/mode/http/http.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/addon/edit/closebrackets.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/addon/edit/matchbrackets.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/addon/display/placeholder.js\"\r\n\t  ],\r\n\t\tcss: [\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/codemirror.css\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/addon/hint/show-hint.css\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/theme/neo.css\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/theme/erlang-dark.css\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/theme/eclipse.css\"\r\n\t\t]\r\n\t};\r\n\tthis.plugins[\"jquery\"] = {\r\n\t\tlabel: \"jQuery\",\r\n\t\tjs: [\"https://code.jquery.com/jquery-2.2.4.min.js\"]\r\n\t};\r\n\tthis.plugins[\"jqueryui\"] = {\r\n\t\tlabel: \"jQuery UI\",\r\n\t\tcss: [\"https://code.jquery.com/ui/1.12.0/themes/smoothness/jquery-ui.css\"],\r\n\t\tjs: [\"https://code.jquery.com/ui/1.12.0/jquery-ui.js\"],\r\n\t\trequires: ['jquery']\r\n\t};\r\n\tthis.plugins[\"datatables\"] = {\r\n\t\tlabel: \"Data Tables\",\r\n\t\tjs: [\"https://cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js\",\r\n\t\t\t \"https://cdn.datatables.net/v/dt/jszip-2.5.0/dt-1.10.16/b-1.5.1/b-html5-1.5.1/datatables.min.js\"],\r\n\t\tcss: [\"https://cdn.datatables.net/1.10.19/css/jquery.dataTables.min.css\"],\r\n\t\trequires: ['jquery']\r\n\t};\r\n\t/*this.plugins[\"prettify\"] = {\r\n\t\tlabel: \"Prettify\",\r\n\t\tjs: [\"https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.js\"],\r\n\t\tcss: [\"https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.css\"],\r\n\t\trequires: ['jquery']\r\n\t};*/\r\n\tthis.plugins[\"gmaps\"] = {\r\n\t\tlabel: \"Google Maps\",\r\n\t\tjs: [\"https://maps.googleapis.com/maps/api/js\"],\r\n\t\t//plugin: \"gmaps.terminus.js\"\r\n\t};\r\n\tthis.plugins[\"d3\"] = {\r\n\t\tlabel: \"d3\",\r\n\t\tjs: [\"https://code.jquery.com/jquery-2.2.4.min.js\"],\r\n\t\trequires: ['jquery']\r\n\t};\r\n\tthis.plugins[\"select2\"] = {\r\n\t\tlabel: \"Select 2\",\r\n\t\tjs: [\"https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.7/js/select2.min.js\"],\r\n\t\tcss: [\"https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.7/css/select2.min.css\"],\r\n\t\trequires: ['jquery']\r\n\t};\r\n\t/*this.plugins[\"jsoneditor\"] = {\r\n\t\tlabel: \"JSON Editor\",\r\n\t\tjs: [\"https://cdnjs.cloudflare.com/ajax/libs/jsoneditor/7.0.4/jsoneditor.min.js\"],\r\n\t\tcss: [\"https://cdnjs.cloudflare.com/ajax/libs/jsoneditor/7.0.4/jsoneditor.min.css\"],\r\n\t\t//plugin: \"jsoneditor.terminus.js\"\r\n\t};\r\n\tthis.plugins[\"bootstrap\"] = {\r\n\t\tlabel: \"Bootstrap\",\r\n\t\tjs: [\"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js\"],\r\n\t\tcss: [\"https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/2.2.2/css/bootstrap.min.css\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/2.2.2/css/bootstrap-responsive.min.css\"]\r\n\t};\r\n\tthis.plugins[\"flot\"] = {\r\n\t\tlabel: \"Flot\",\r\n\t\tjs: [\"https://cdnjs.cloudflare.com/ajax/libs/flot/0.8.3/jquery.flot.min.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/flot/0.8.3/jquery.flot.resize.min.js\"],\r\n\t\trequires: [\"jquery\"]\r\n\t};*/\r\n}\r\n\r\nTerminusPluginManager.prototype.setPluginOptions = function(opts){\r\n\tfor(var p in opts){\r\n\t\tif(!this.plugins[p]) continue;\r\n\t\tfor(var k in opts[p]){\r\n\t\t\tthis.plugins[p][k] = opts[p][k];\r\n\t\t}\r\n\t}\r\n}\r\n\r\nTerminusPluginManager.prototype.init = function(opts, then){\r\n\tif(opts) this.setPluginOptions(opts);\r\n\tthis.calculatePreloaded();\r\n\tvar toload = this.calculateRequiredInitPlugins(opts);\r\n\tif(toload && toload[0].length) {\r\n\t\tif(toload[1].length){\r\n\t\t\tvar self = this;\r\n\t\t\tvar nthen = function(){\r\n\t\t\t\tself.loadPlugins(toload[1], then);\r\n\t\t\t}\r\n\t\t\tthis.loadPlugins(toload[0], nthen);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.loadPlugins(toload[0], then);\r\n\t\t}\r\n\t}\r\n\telse if(then){\r\n\t\tthen();\r\n\t}\r\n}\r\n\r\nTerminusPluginManager.prototype.calculateRequiredInitPlugins = function(opts){\r\n\tif(opts){\r\n\t\tvar pins = [];\r\n\t\tfor(var pid in opts){\r\n\t\t\tif(opts[pid] && pins.indexOf(pid) == -1){\r\n\t\t\t\tif(typeof opts[pid] != \"object\" && opts[pid]){\r\n\t\t\t\t\tpins.push(pid);\r\n\t\t\t\t}\r\n\t\t\t\telse if(typeof opts[pid] == \"object\"){\r\n\t\t\t\t\tif(!(typeof opts[pid].loaded != \"undefined\" && !opts[pid].loaded)){\r\n\t\t\t\t\t\tpins.push(pid);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tvar pins = this.getDefaultPlugins();\r\n\t}\r\n\tvar needed_pins = [];\r\n\tfor(var i = 0; i<pins.length; i++){\r\n\t\tif(this.loaded.indexOf(pins[i]) == -1 && this.preloaded.indexOf(pins[i]) == -1 ){\r\n\t\t\tneeded_pins.push(pins[i])\r\n\t\t}\r\n\t}\r\n\tvar loading_order = [[], []];\r\n\tfor(var i = 0; i<needed_pins.length; i++){\r\n\t\tif(this.plugins[needed_pins[i]]){\r\n\t\t\tif(this.plugins[needed_pins[i]].requires && this.plugins[needed_pins[i]].requires.length){\r\n\t\t\t\tloading_order[1].push(needed_pins[i]);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tloading_order[0].push(needed_pins[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn loading_order;\r\n}\r\n\r\nTerminusPluginManager.prototype.getAvailablePlugins = function(){\r\n\treturn this.plugins;\r\n}\r\n\r\nTerminusPluginManager.prototype.calculatePreloaded = function(){\r\n\tfor(var pl in this.plugins){\r\n\t\tif(this.pluginAvailable(pl)){\r\n\t\t\tthis.preloaded.push(pl);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nTerminusPluginManager.prototype.pluginAvailable = function(plugin, version_check){\r\n\tif(typeof this.plugins[plugin] == \"object\"){\r\n\t\tvar pluginmeta = this.plugins[plugin];\r\n\t\tif(pluginmeta.requires && pluginmeta.requires.length){\r\n\t\t\tfor(var i =0 ; i < pluginmeta.requires.length; i++){\r\n\t\t\t\tif(!this.pluginAvailable(pluginmeta.requires[i], version_check)) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar required_version = (pluginmeta.version ? pluginmeta.version : false);\r\n\t\tswitch(plugin){\r\n\t\t\tcase \"jquery\": {\r\n\t\t\t\tif(typeof jQuery == \"undefined\") return false;\r\n\t\t\t\tif(version_check && required_version){}\r\n\t\t\t\treturn true;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tcase \"jqueryui\": {\r\n\t\t\t\ttry{\r\n\t\t\t\t\tif(typeof jQuery != \"undefined\" && jQuery.isFunction( jQuery.fn.slider )) return true;\r\n\t\t\t\t}\r\n\t\t\t\tcatch(e){}\r\n\t\t\t\treturn false;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tcase \"quill\": {\r\n\t\t\t\tif(typeof Quill == \"undefined\") return false;\r\n\t\t\t\treturn true;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tcase \"jsoneditor\": {\r\n\t\t\t\tif(typeof JSONEditor == \"undefined\") return false;\r\n\t\t\t\treturn true;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tcase \"codemirror\": {\r\n\t\t\t\tif(typeof CodeMirror == \"undefined\") return false;\r\n\t\t\t\treturn this.plugins[plugin];  // sent plugin config with darkmode true/ false\r\n\t\t\t}\r\n\t\t\tcase \"font-awesome\": {\r\n\t\t\t\t//if(typeof CodeMirror != \"undefined\") return true;\r\n\t\t\t\treturn this.fontAwesomeCheck();\r\n\t\t\t}\r\n\t\t\tcase \"datatables\": {\r\n\t\t\t\t if(typeof jQuery != \"undefined\" && jQuery.isFunction( jQuery.fn.dataTable)) return true;\r\n\t\t\t\t return false;\r\n\t\t\t}\r\n\t\t\tcase \"select2\": {\r\n\t\t\t\t if(typeof jQuery != \"undefined\" && jQuery.isFunction( jQuery.fn.select2 )) return true;\r\n\t\t\t\t return false;\r\n\t\t\t}\r\n\t\t\tcase \"gmaps\": {\r\n\t\t\t\tif(typeof google == \"undefined\" || typeof google.maps == \"undefined\") return false;\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\tcase \"openlayers\": {\r\n\t\t\t\tif(typeof ol == \"undefined\" || typeof ol.Map == \"undefined\") return false;\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\tcase \"d3\": {\r\n\t\t\t\tif(typeof d3 == \"undefined\") return false;\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tconsole.log(new Error(plugin + \" is not a supported plugin ID\"));\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nTerminusPluginManager.prototype.fontAwesomeCheck = function(){\r\n\tvar span = document.createElement('span');\r\n\tspan.className = 'fa';\r\n\tspan.style.display = 'none';\r\n\tif(document.body){\r\n\t\tdocument.body.insertBefore(span, document.body.firstChild);\r\n\t\tfunction css(element, property) {\r\n\t\t  return window.getComputedStyle(element, null).getPropertyValue(property);\r\n\t\t}\r\n\t\tvar loaded = false;\r\n\t\tvar fontAwsm = css(span, 'font-family');\r\n\t\tif (fontAwsm.replace(/\"/g, \"\") == 'Font Awesome 5 Free') { // remove double quotes\r\n\t\t\tloaded = true;\r\n\t\t}\r\n\t\tdocument.body.removeChild(span);\r\n\t\treturn loaded;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nTerminusPluginManager.prototype.getDefaultPlugins = function(){\r\n\tvar defplugs = [\"font-awesome\"];\r\n\treturn defplugs;\r\n}\r\n\r\nTerminusPluginManager.prototype.loadPlugins = function(plugins, then){\r\n\tvar ticker = plugins.length;\r\n\tvar cback = function(){\r\n\t\tif(--ticker <= 1 && then){\r\n\t\t\tthen();\r\n\t\t}\r\n\t};\r\n\tfor(var i = 0; i < plugins.length; i++){\r\n\t\tthis.loadPlugin(plugins[i], cback);\r\n\t}\r\n}\r\n\r\nTerminusPluginManager.prototype.loadPlugin = function(plugin, then){\r\n\tvar pug = this.plugins[plugin];\r\n\tif(pug.css){\r\n\t\tfor(var i=0; i<pug.css.length; i++){\r\n\t\t\tvar cssid = plugin + \"_css_\" + i;\r\n\t\t\tTerminusClient.FrameHelper.loadDynamicCSS(cssid, pug.css[i]);\r\n\t\t}\r\n\t}\r\n\tvar scripts = (pug.js ? pug.js : []);\r\n\tif(plugin == \"gmaps\" && pug.key){\r\n\t\tscripts[0] += \"?key=\" + pug.key;\r\n\t}\r\n\tif(pug.plugin){\r\n\t\t//scripts.push(\"plugins/\" + pug.plugin);\r\n\t}\r\n\tif(plugin == \"codemirror\"){\r\n\t\tvar cm = scripts[0];\r\n\t\tvar sid = plugin + \"_js_\" + (scripts.length -1);\r\n\t\tscripts.splice(0, 1);\r\n\t\tvar self = this;\r\n\t\tvar cback = function(){\r\n\t\t\tself.loadPluginScripts(plugin, scripts, then);\r\n\t\t}\r\n\t\tTerminusClient.FrameHelper.loadDynamicScript(sid, cm, cback);\r\n\t}\r\n\telse {\r\n\t\tthis.loadPluginScripts(plugin, scripts, then);\r\n\t}\r\n}\r\n\r\nTerminusPluginManager.prototype.loadPluginScripts = function(plugin, scripts, then){\r\n\tvar ticker = scripts.length - 1;\r\n\tvar self = this;\r\n\tvar cback = function(){\r\n\t\tif(ticker == 0) {\r\n\t\t\tif(self.loaded.indexOf(plugin) == -1){\r\n\t\t\t\tself.loaded.push(plugin);\r\n\t\t\t}\r\n\t\t\tif(self.loading.indexOf(plugin) != -1){\r\n\t\t\t\tself.loading.splice(self.loading.indexOf(plugin), 1);\r\n\t\t\t}\r\n\t\t\tthen();\r\n\t\t}\r\n\t\tticker--;\r\n\t};\r\n\tif(scripts.length == 0){\r\n\t\tthis.loaded.push(plugin);\r\n\t}\r\n\telse {\r\n\t\tthis.loading.push(plugin);\r\n\t}\r\n\tfor(var i = 0; i<scripts.length; i++){\r\n\t\tvar sid = plugin + \"_js_\" + i;\r\n\t\tTerminusClient.FrameHelper.loadDynamicScript(sid, scripts[i], cback);\r\n\t}\r\n}\r\n\r\nTerminusPluginManager.prototype.loadPageCSS = function(css){\r\n\tcssfid = \"terminus_client_css\";\r\n\tvar cssdom = document.getElementById(cssfid);\r\n\tif(cssdom){\r\n\t\tcssdom.parentNode.removeChild(cssdom);\r\n\t}\r\n\tif(css){\r\n\t\tcssurl = \"css/\" + css + \".css\";\r\n\t\tTerminusClient.FrameHelper.loadDynamicCSS(cssfid, cssurl);\r\n\t}\r\n}\r\n\r\nTerminusPluginManager.prototype.pluginLoadable = function(pid){\r\n\treturn (this.precluded.indexOf(pid) !== -1 || this.pluginLoadedOrLoading(pid));\r\n}\r\n\r\nTerminusPluginManager.prototype.pluginLoadedOrLoading = function(pid){\r\n\tif(this.loaded.indexOf(pid) != -1) return true;\r\n\tif(this.preloaded.indexOf(pid) != -1) return true;\r\n\tif(this.loading.indexOf(pid) != -1) return true;\r\n\treturn false;\r\n}\r\n\r\nTerminusPluginManager.prototype.disabled = function(pid, obj){\r\n\tif(this.precluded.indexOf(pid) != -1) return true;\r\n\tif(obj.requires){\r\n\t\tfor(var i = 0; i<obj.requires.length; i++){\r\n\t\t\tif(!this.pluginLoadedOrLoading(obj.requires[i])) return true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nTerminusPluginManager.prototype.getPluginDOM = function(plugid, obj, ui){\r\n\tvar a = document.createElement(\"a\");\r\n\tvar cl = document.createElement(\"span\");\r\n\ta.appendChild(cl);\r\n\tcl.setAttribute(\"class\", \"terminus-plugin-control\");\r\n\tvar cbox = document.createElement(\"input\");\r\n\tcbox.id = \"terminus-plugin-control-\" + plugid;\r\n\tcbox.type = \"checkbox\";\r\n\tif(this.preloaded.indexOf(plugid) != -1){\r\n\t\tcbox.checked = true;\r\n\t\tcbox.disabled = true;\r\n\t}\r\n\telse if(this.loaded.indexOf(plugid) != -1){\r\n\t\tcbox.checked = true;\r\n\t}\r\n\telse if(this.loading.indexOf(plugid) != -1){\r\n\t\tcbox.checked = true;\r\n\t}\r\n\telse if(this.disabled(plugid, obj)){\r\n\t\tcbox.disabled = true;\r\n\t}\r\n\tvar clab = document.createElement(\"label\");\r\n\tclab.setAttribute(\"class\", \"terminus-plugin-label terminus-pointer\");\r\n\tclab.setAttribute(\"for\", cbox.id);\r\n\tclab.appendChild(document.createTextNode(obj.label));\r\n\tcl.appendChild(clab);\r\n\tcl.appendChild(cbox);\r\n\tvar self = this;\r\n\tcbox.addEventListener(\"change\", function(){\r\n\t\tself.togglePlugin(plugid, ui);\r\n\t});\r\n\treturn a;\r\n}\r\n\r\nTerminusPluginManager.prototype.togglePlugin = function(plugid, ui){\r\n\tif(this.loaded.indexOf(plugid) == -1){\r\n\t\tvar then = function(){\r\n\t\t\tui.redraw();\r\n\t\t}\r\n\t\tthis.loadPlugin(plugid, then);\r\n\t}\r\n\telse {\r\n\t\tthis.unloadPlugin(plugid);\r\n\t}\r\n\tTerminusClient.FrameHelper.removeChildren(ui.plugins);\r\n\tui.drawPlugins();\r\n}\r\n\r\nTerminusPluginManager.prototype.unloadPlugin = function(plugid){\r\n\tif(!this.plugins[plugid] || this.loaded.indexOf(plugid) == -1) {\r\n\t\tconsole.log(new Error(plugid + \" plugin unload request when it is not loaded\"));\r\n\t\treturn false;\r\n\t}\r\n\tvar pug = this.plugins[plugid];\r\n\tvar num = (pug.js) ? pug.js.length : 0;\r\n\tif(pug.plugin) num++;\r\n\tfor(var i=0; i< num; i++){\r\n\t\tvar cssfid = plugid + \"_js_\" + i;\r\n\t\tvar cssdom = document.getElementById(cssfid);\r\n\t\tif(cssdom){\r\n\t\t\tcssdom.parentNode.removeChild(cssdom);\r\n\t\t}\r\n\t}\r\n\tnum = (pug.css ? pug.css.length : 0);\r\n\tfor(var i=0; i< num; i++){\r\n\t\tvar cssfid = plugid + \"_css_\" + i;\r\n\t\tvar cssdom = document.getElementById(cssfid);\r\n\t\tif(cssdom){\r\n\t\t\tcssdom.parentNode.removeChild(cssdom);\r\n\t\t}\r\n\t}\r\n\tthis.loaded.splice(this.loaded.indexOf(plugid), 1);\r\n}\r\n\r\nTerminusPluginManager.prototype.getAsDOM = function(ui){\r\n\tvar dm = document.createElement(\"span\");\r\n\tdm.setAttribute(\"class\", \"terminus-plugin-manager\");\r\n\tvar clh = document.createElement(\"span\");\r\n\tclh.setAttribute(\"class\", \"terminus-plugin-control-header terminus-plugin-nav terminus-pointer\");\r\n\tclh.appendChild(document.createTextNode(\"Plugins\"));\r\n\tdm.appendChild(clh);\r\n\tvar a = document.createElement('a');\r\n\tthis.showPlugins(a, ui);\r\n\tclh.appendChild(a);\r\n\ta.style.display = 'none';\r\n\tclh.addEventListener('click', function(){\r\n\t\tif(a.style.display == 'none')\r\n\t\t\ta.style.display = 'block';\r\n\t\telse a.style.display = 'none';\r\n\t})\r\n\treturn dm;\r\n}\r\n\r\nTerminusPluginManager.prototype.showPlugins = function(a, ui){\r\n\ta.setAttribute('style', 'background-color: #111;');\r\n\tfor(var pid in this.plugins){\r\n\t\ta.appendChild(this.getPluginDOM(pid, this.plugins[pid], ui));\r\n\t}\r\n}\r\n\r\nmodule.exports=TerminusPluginManager\r\n","const ObjectViewer= require(\"./ObjectViewer\")\r\nconst HTMLStringViewer = require('./viewers/String');\r\nconst HTMLStringEditor = require('./viewers/StringEditor');\r\nconst HTMLBooleanViewer = require('./viewers/Boolean');\r\nconst HTMLBooleanEditor = require('./viewers/BooleanEditor');\r\nconst HTMLChoiceViewer = require('./viewers/Choice');\r\nconst HTMLChoiceEditor = require('./viewers/ChoiceEditor');\r\nconst HTMLCoordinateViewer = require('./viewers/Coordinate');\r\nconst HTMLCoordinateEditor = require('./viewers/CoordinateEditor');\r\nconst HTMLDateViewer = require('./viewers/Date');\r\nconst HTMLDateEditor = require('./viewers/DateEditor');\r\nconst HTMLEntityViewer = require('./viewers/Entity');\r\nconst HTMLEntityEditor = require('./viewers/EntityEditor');\r\nconst HTMLImageViewer = require('./viewers/Image');\r\nconst HTMLImageEditor = require('./viewers/ImageEditor');\r\nconst HTMLLinkViewer = require('./viewers/Link');\r\nconst HTMLNumberViewer = require('./viewers/Number');\r\nconst HTMLRangeViewer = require('./viewers/Range');\r\nconst HTMLRangeEditor = require('./viewers/RangeEditor');\r\nconst SantizedHTMLViewer = require('./viewers/SanitizedHTML');\r\nconst GoogleMapEditor = require('./viewers/GoogleMapEditor');\r\nconst GoogleMapViewer = require('./viewers/GoogleMapViewer');\r\nconst HTMLMarkupEditor = require('./viewers/HTMLMarkupEditor');\r\nconst S2EntityEditor = require('./viewers/S2EntityEditor');\r\n\r\n\r\nlet RenderingMap = {\r\n\tregisteredDataViewers: {},\r\n\tregisteredDataEditors: {},\t\r\n\tregisteredPropertyViewers: {},\r\n\tregisteredPropertyEditors: {},\r\n\tregisteredObjectViewers: {},\r\n\tregisteredObjectEditors: {},\r\n\tgetValidDataViewerList: function(type, frametype){\r\n\t\tvar valids = ['HTMLStringViewer'];\r\n\t\tif(frametype && typeof this.registeredDataViewers[frametype] != \"undefined\"){\r\n\t\t\tvalids = valids.concat(this.registeredDataViewers[frametype]);\r\n\t\t}\r\n\t\tif(typeof this.registeredDataViewers[type] != \"undefined\"){\r\n\t\t\tvalids = valids.concat(this.registeredDataViewers[type]);\r\n\t\t}\r\n\t\treturn valids;\r\n\t},\r\n\tgetValidDataEditorList: function(type, frametype){\r\n\t\tvar valids = ['HTMLStringEditor'];\r\n\t\tif(frametype && typeof this.registeredDataEditors[frametype] != \"undefined\"){\r\n\t\t\tvar nftypes = this.registeredDataEditors[frametype];\r\n\t\t\tif(nftypes){\r\n\t\t\t\tfor(var i = 0; i<nftypes.length; i++){\r\n\t\t\t\t\tif(valids.indexOf(nftypes[i]) == -1) valids.push(nftypes[i]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(typeof this.registeredDataEditors[type] != \"undefined\"){\r\n\t\t\tvalids = valids.concat(this.registeredDataEditors[type]);\r\n\t\t}\r\n\t\treturn valids;\r\n\t},\r\n\tgetValidPropertyViewerList: function(property, proptype, proprange, propdom){\r\n\t\tvar valids = ['HTMLPropertyViewer'];\r\n\t\tif(property && typeof this.registeredPropertyViewers[property] != \"undefined\"){\r\n\t\t\tvalids = valids.concat(this.registeredPropertyViewers[property]);\r\n\t\t}\r\n\t\tif(proprange && typeof this.registeredPropertyViewers[proprange] != \"undefined\"){\r\n\t\t\tvalids = valids.concat(this.registeredPropertyViewers[proprange]);\r\n\t\t}\r\n\t\tif(propdom && typeof this.registeredPropertyViewers[propdom] != \"undefined\"){\r\n\t\t\tvalids = valids.concat(this.registeredPropertyViewers[propdom]);\r\n\t\t}\r\n\t\tif(proptype && typeof this.registeredPropertyViewers[proptype] != \"undefined\"){\r\n\t\t\tvalids = valids.concat(this.registeredPropertyViewers[proptype]);\r\n\t\t}\r\n\t\treturn valids;\r\n\t},\r\n\tgetValidPropertyEditorList: function(property, proptype, proprange, propdom){\r\n\t\tvar valids = ['HTMLPropertyViewer'];\r\n\t\tif(property && typeof this.registeredPropertyEditors[property] != \"undefined\"){\r\n\t\t\tvalids = valids.concat(this.registeredPropertyEditors[property]);\r\n\t\t}\r\n\t\tif(proprange && typeof this.registeredPropertyEditors[proprange] != \"undefined\"){\r\n\t\t\tvalids = valids.concat(this.registeredPropertyEditors[proprange]);\r\n\t\t}\r\n\t\tif(propdom && typeof this.registeredPropertyEditors[propdom] != \"undefined\"){\r\n\t\t\tvalids = valids.concat(this.registeredPropertyEditors[propdom]);\r\n\t\t}\r\n\t\tif(proptype && typeof this.registeredPropertyEditors[proptype] != \"undefined\"){\r\n\t\t\tvalids = valids.concat(this.registeredPropertyEditors[proptype]);\r\n\t\t}\r\n\t\treturn valids;\r\n\t},\r\n\tgetViewer: function(type, options){\r\n\t\tvar vi = this.renderers[type];\r\n\t\toptions = (options ? options: {});\r\n\t\ttry {\r\n\t\t\tvar viewer = eval(\"new \" + type + \".\" + type + \"(\" + JSON.stringify(options) + \")\");\t\r\n\t\t\treturn viewer;\r\n\t\t}\r\n\t\tcatch(e){\r\n\t\t\talert(\"failed on create \" + e.toString());\r\n\t\t}\r\n\t},\r\n\tgetAvailablePropertyViewers: function(type, renderer) {\r\n\t\tvar viewers = [];\r\n\t\tvar nviewers = []\r\n\t\tvar opts = this.getValidPropertyViewerList(type);\r\n\t\tfor(var i = 0; i<opts.length; i++){\r\n\t\t\tif(nviewers.indexOf(opts[i]) == -1) {\r\n\t\t\t\tnviewers.push(opts[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor(var i = 0; i<nviewers.length; i++){\r\n\t\t\tif(this.renderers[nviewers[i]]){\r\n\t\t\t\tvar sets = this.renderers[nviewers[i]];\r\n\t\t\t\tviewers.push({value: nviewers[i], label: sets.label});\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn viewers;\r\n\t},\r\n\tgetAvailablePropertyEditors: function(type, renderer) {\r\n\t\tvar viewers = [];\r\n\t\tvar nviewers = []\r\n\t\tvar opts = this.getValidPropertyEditorList();\r\n\t\tfor(var i = 0; i<opts.length; i++){\r\n\t\t\tif(nviewers.indexOf(opts[i]) == -1) {\r\n\t\t\t\tnviewers.push(opts[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor(var i = 0; i<nviewers.length; i++){\r\n\t\t\tif(this.renderers[nviewers[i]]){\r\n\t\t\t\tvar sets = this.renderers[nviewers[i]];\r\n\t\t\t\tviewers.push({value: nviewers[i], label: sets.label});\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn viewers;\r\n\t\t\r\n\t},\r\n\tgetAvailableDataViewers: function(type, frametype){\r\n\t\tvar viewers = [];\r\n\t\tvar nviewers = []\r\n\t\tvar opts = this.getValidDataViewerList(type, frametype);\r\n\t\tfor(var i = 0; i<opts.length; i++){\r\n\t\t\tif(nviewers.indexOf(opts[i]) == -1) {\r\n\t\t\t\tnviewers.push(opts[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor(var i = 0; i<nviewers.length; i++){\r\n\t\t\tif(this.renderers[nviewers[i]]){\r\n\t\t\t\tvar sets = this.renderers[nviewers[i]];\r\n\t\t\t\tviewers.push({value: nviewers[i], label: sets.label});\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn viewers;\r\n\t},\r\n\tgetAvailableDataEditors: function(type, frametype){\r\n\t\tvar viewers = [];\r\n\t\tvar nviewers = []\r\n\t\tvar opts = this.getValidDataEditorList(type, frametype);\r\n\t\tfor(var i = 0; i<opts.length; i++){\r\n\t\t\tif(nviewers.indexOf(opts[i]) == -1) {\r\n\t\t\t\tnviewers.push(opts[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor(var i = 0; i<nviewers.length; i++){\r\n\t\t\tif(this.renderers[nviewers[i]]){\r\n\t\t\t\tvar sets = this.renderers[nviewers[i]];\r\n\t\t\t\tviewers.push({value: nviewers[i], label: sets.label});\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn viewers;\r\n\t},\r\n\tgetViewerForDataFrame: function(type, frametype){\r\n\t\tvar vals = this.getValidDataViewerList(type, frametype);\r\n\t\treturn vals[vals.length-1];\r\n\t},\r\n\tgetEditorForDataFrame: function(type, frametype){\r\n\t\tvar vals = this.getValidDataEditorList(type, frametype);\r\n\t\treturn vals[vals.length-1];\r\n\t},\r\n\tregisterViewerForTypes: function(viewer, label, types){\r\n\t\tfor(var i = 0; i < types.length; i++){\r\n\t\t\tif(typeof this.registeredDataViewers[types[i]] == \"undefined\"){\r\n\t\t\t\tthis.registeredDataViewers[types[i]] = [];\r\n\t\t\t}\r\n\t\t\tif(this.registeredDataViewers[types[i]].indexOf(viewer) == -1){\r\n\t\t\t\tthis.registeredDataViewers[types[i]].push(viewer);\r\n\t\t\t\tthis.renderers[viewer] = {label: label};\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tregisterEditorForTypes: function(viewer, label, types){\r\n\t\tfor(var i = 0; i < types.length; i++){\r\n\t\t\tif(typeof this.registeredDataEditors[types[i]] == \"undefined\"){\r\n\t\t\t\tthis.registeredDataEditors[types[i]] = [];\r\n\t\t\t}\r\n\t\t\tif(this.registeredDataEditors[types[i]].indexOf(viewer) == -1){\r\n\t\t\t\tthis.registeredDataEditors[types[i]].push(viewer);\r\n\t\t\t\tthis.renderers[viewer] = {label: label};\r\n\t\t\t}\t\t\t\r\n\t\t}\r\n\t},\r\n\tregisterEditorForFrameType: function(viewer, label, frametype){\r\n\t\tthis.renderers[viewer] = {label: label};\r\n\t\tif(typeof this.registeredDataEditors[frametype] == \"undefined\") this.registeredDataEditors[frametype] = [];\r\n\t\tif(this.registeredDataEditors[frametype].indexOf(viewer) == -1){\r\n\t\t\tthis.registeredDataEditors[frametype].push(viewer);\r\n\t\t}\r\n\t},\r\n\tregisterViewerForFrameType: function(viewer, label, frametype){\r\n\t\tthis.renderers[viewer] = {label: label};\r\n\t\tif(typeof this.registeredDataViewers[frametype] == \"undefined\") this.registeredDataViewers[frametype] = [];\r\n\t\tif(this.registeredDataViewers[frametype].indexOf(viewer) == -1){\r\n\t\t\tthis.registeredDataViewers[frametype].push(viewer);\r\n\t\t}\r\n\t},\r\n\tregisterViewerForProperties: function(viewer, label, properties){\r\n\t\tfor(var i = 0; i < properties.length; i++){\r\n\t\t\tif(typeof this.registeredPropertyViewers[properties[i]] == \"undefined\"){\r\n\t\t\t\tthis.registeredPropertyViewers[properties[i]] = [];\r\n\t\t\t}\r\n\t\t\tif(this.registeredPropertyViewers[properties[i]].indexOf(viewer) == -1){\r\n\t\t\t\tthis.registeredPropertyViewers[properties[i]].push(viewer);\r\n\t\t\t\tthis.renderers[viewer] = {label: label};\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tregisterEditorForProperties: function(viewer, label, properties){\r\n\t\tfor(var i = 0; i < properties.length; i++){\r\n\t\t\tif(typeof this.registeredPropertyEditors[properties[i]] == \"undefined\"){\r\n\t\t\t\tthis.registeredPropertyEditors[properties[i]] = [];\r\n\t\t\t}\r\n\t\t\tif(this.registeredPropertyEditors[properties[i]].indexOf(viewer) == -1){\r\n\t\t\t\tthis.registeredPropertyEditors[properties].push(viewer);\r\n\t\t\t\tthis.renderers[viewer] = {label: label};\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\trenderers: {\r\n\t\tHTMLStringViewer: { label: \"String Viewer\"},\r\n\t\tHTMLStringEditor: { label: \"String Editor\"},\r\n\t\tHTMLPropertyViewer: { label: \"HTML Property Viewer\"}\r\n\t},\r\n\tpatternMatchesRenderer: function(pattern, renderer){\r\n\t\tif(typeof pattern == \"object\" && pattern.length){ //multiple patterns are ANDed\r\n\t\t\tfor(var i = 0 ; i<pattern.length; i++){\r\n\t\t\t\tvar fp = new FramePattern(pattern[i]);\r\n\t\t\t\tif(!fp.checkRenderer(renderer)) return false;\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tvar fp = new FramePattern(pattern);\r\n\t\t\treturn fp.checkRenderer(renderer);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nRenderingMap.addPlugin = function(plugin){\r\n\tif(plugin == \"gmaps\"){\r\n\t\tthis.registerEditorForTypes(\"GoogleMapEditor\", \"Google Map Editor\", [\"xdd:coordinate\", \"xdd:coordinatePolyline\", \"xdd:coordinatePolygon\"]);\r\n\t\tthis.registerViewerForTypes(\"GoogleMapViewer\", \"Google Map Editor\", [\"xdd:coordinate\", \"xdd:coordinatePolyline\", \"xdd:coordinatePolygon\"]);\r\n\t}\r\n\tif(plugin == \"quill\"){\r\n\t\tthis.registerEditorForTypes(\"HTMLMarkupEditor\", \"Quill WYSIWIG HTML Editor\", [\"xdd:html\"]);\r\n\t}\r\n\tif(plugin == \"select2\"){\r\n\t\tRenderingMap.registerEditorForFrameType(\"S2EntityEditor\", \"S2 Autocomplete Selector\", \"document\");\r\n\t}\r\n\tif(plugin == \"jsoneditor\"){\r\n\t\tRenderingMap.registerEditorForFrameType(\"S2EntityEditor\", \"S2 Autocomplete Selector\", \"document\");\r\n\t}\r\n}\r\n\r\nRenderingMap.getAvailableObjectViewers = function(renderer){\r\n\tvar entries = ['html', 'json'];\r\n\treturn entries;\r\n}\r\n\r\nRenderingMap.decorateRenderer = function(options, renderer){\r\n\tvar compiled_options = this.compileOptions(options, renderer);\r\n\tif(compiled_options && compiled_options.mode){\r\n\t\trenderer.mode = compiled_options.mode;\r\n\t}\r\n\telse {\r\n\t\tif(renderer.parent && renderer.parent.mode) renderer.mode = renderer.parent.mode;\r\n\t\telse renderer.mode = \"view\";\r\n\t}\r\n\tif(compiled_options && compiled_options.view){\r\n\t\trenderer.view = compiled_options.view;\r\n\t}\r\n\telse {\r\n\t\tif(renderer.parent && renderer.parent.view) renderer.view = renderer.parent.view;\r\n\t\telse renderer.view = \"full\";\r\n\t}\r\n\tif(compiled_options && compiled_options.facets){\r\n\t\trenderer.facets = compiled_options.facets;\r\n\t}\r\n\telse {\r\n\t\trenderer.facets = renderer.getDefaultFacets();\r\n\t}\r\n\tif(compiled_options && compiled_options.facet && typeof renderer.facets[compiled_options.facet] == \"object\"){\r\n\t\trenderer.facet = compiled_options.facet;\r\n\t}\t\r\n\telse {\r\n\t\tvar deffacet = renderer.getDefaultFacet();\r\n\t\tif(typeof renderer.facets[deffacet] == \"object\"){\r\n\t\t\trenderer.facet = deffacet;\r\n\t\t}\r\n\t\telse {\r\n\t\t\trenderer.facet = key(renderer.facets);\r\n\t\t}\r\n\t}\r\n\tif(compiled_options && compiled_options.hide_disabled_buttons){\r\n\t\trenderer.hide_disabled_buttons = compiled_options.hide_disabled_buttons;\r\n\t}\r\n\telse if(renderer.parent) renderer.hide_disabled_buttons = parent.hide_disabled_buttons;\r\n\telse renderer.hide_disabled_buttons = true;\r\n\tif(compiled_options && typeof compiled_options.features == \"object\"){\r\n\t\trenderer.features = compiled_options.features;\r\n\t}\r\n\telse {\r\n\t\trenderer.features = renderer.facets[renderer.facet].features;\r\n\t\t//renderer.features = renderer.getDefaultFeatures(renderer.facet);\r\n\t}\r\n\tif(compiled_options && typeof compiled_options.controls == \"object\"){\r\n\t\trenderer.controls = compiled_options.controls;\r\n\t}\r\n\telse {\r\n\t\trenderer.controls = renderer.facets[renderer.facet].controls;\r\n\t\t//renderer.controls = renderer.getDefaultControls();\r\n\t}\r\n\tif(compiled_options && typeof compiled_options.viewerType != \"undefined\"){\r\n\t\trenderer.viewerType = compiled_options.viewerType;\r\n\t\tif(compiled_options.viewerOptions)\r\n\t\t\trenderer.viewerOptions = compiled_options.viewerOptions;\r\n\t}\r\n\tif(compiled_options && typeof compiled_options.header != \"undefined\"){}\r\n\telse {\r\n\t\trenderer.header_viewer = new ObjectViewer.HTMLObjectHeaderViewer();\r\n\t}\r\n\tif(compiled_options && typeof compiled_options.filter != \"undefined\"){}\r\n\telse {}\r\n\tif(compiled_options && typeof compiled_options.sort != \"undefined\"){}\r\n\telse {}\r\n\treturn options;\r\n}\t\r\n\r\nRenderingMap.compileOptions = function(options, renderer){\r\n\tvar compiled_options = {};\r\n\tvar rules = [];\r\n\tfor(var key in options){\r\n\t\tif(key != \"rules\"){\r\n\t\t\tcompiled_options[key] = options[key];\r\n\t\t}\r\n\t}\r\n\tif(options.rules){\r\n\t\tfor(var i = 0; i<options.rules.length; i++){\r\n\t\t\tvar match = (!options.rules[i].pattern || this.patternMatchesRenderer(options.rules[i].pattern, renderer));\r\n\t\t\tif(match && options.rules[i].output){\r\n\t\t\t\tfor(var k in options.rules[i].output){\r\n\t\t\t\t\tcompiled_options[k] = options.rules[i].output[k];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn compiled_options;\r\n}\r\n\r\n\r\nRenderingMap.registerViewerForTypes(\"HTMLBooleanViewer\", \"Checkbox Viewer\", [\"xsd:boolean\"]);\r\nRenderingMap.registerEditorForTypes(\"HTMLBooleanEditor\", \"Checkbox Editor\", [\"xsd:boolean\"]);\r\nRenderingMap.registerViewerForFrameType(\"HTMLChoiceViewer\", \"Choice Viewer\", \"oneOf\");\r\nRenderingMap.registerEditorForFrameType(\"HTMLChoiceEditor\", \"Choice Selector\", \"oneOf\");\r\nRenderingMap.registerViewerForTypes(\"HTMLCoordinateViewer\", \"Coordinate Viewer\", [\"xdd:coordinate\", \"xdd:coordinatePolyline\", \"xdd:coordinatePolygon\"]);\r\nRenderingMap.registerEditorForTypes(\"HTMLCoordinateEditor\", \"Coordinate Editor\", [\"xdd:coordinate\", \"xdd:coordinatePolyline\", \"xdd:coordinatePolygon\"]);\r\nRenderingMap.registerViewerForTypes(\"HTMLDateViewer\", \"Date Viewer\", [\"xsd:time\", \"xsd:date\", \"xsd:dateTime\", \"xsd:gYear\", \r\n\t\"xsd:gYearRange\", \"xsd:gMonth\", \"xsd:gDay\", \"xsd:gYearMonth\", \"xsd:gMonthDay\", \"xsd:dateTimeStamp\"]);\r\nRenderingMap.registerEditorForTypes(\"HTMLDateEditor\", \"Date Editor\", [\"xsd:time\", \"xsd:date\", \"xsd:dateRange\" ,\"xsd:dateTime\", \"xsd:gYear\", \r\n\t\"xsd:gYearRange\", \"xsd:gMonth\", \"xsd:gDay\", \"xsd:gYearMonth\", \"xsd:gMonthDay\", \"xsd:dateTimeStamp\"]);\r\nRenderingMap.registerViewerForFrameType(\"HTMLEntityViewer\", \"Document Viewer\", \"document\");\r\nRenderingMap.registerEditorForFrameType(\"HTMLEntityEditor\", \"Document Selector\", \"document\");\r\nRenderingMap.registerViewerForTypes(\"HTMLImageViewer\", \"Image Viewer\", [\"xdd:url\", \"xsd:anyURI\", \"xsd:base64Binary\"]);\r\nRenderingMap.registerEditorForTypes(\"HTMLImageEditor\", \"Image Editor\", [\"xsd:base64Binary\"]);\r\nRenderingMap.registerViewerForTypes(\"HTMLImageViewer\", \"Image Viewer\", [\"xdd:url\", \"xsd:anyURI\", \"xsd:base64Binary\"]);\r\nRenderingMap.registerEditorForTypes(\"HTMLImageEditor\", \"Image Editor\", [\"xsd:base64Binary\"]);\r\nRenderingMap.registerViewerForTypes(\"HTMLLinkViewer\", \"Link Viewer\", [\"xdd:url\", \"xsd:anyURI\"]);\r\nRenderingMap.registerViewerForTypes(\"HTMLNumberViewer\", \"Number with commas\", \r\n\t\t[\"xsd:decimal\", \"xsd:double\", \"xsd:float\", \"xsd:short\", \"xsd:integer\", \"xsd:long\", \r\n\t\t\t\"xsd:nonNegativeInteger\", \"xsd:positiveInteger\", \"xsd:negativeInteger\", \"xsd:nonPositiveInteger\"]);\r\nRenderingMap.registerViewerForTypes(\"HTMLRangeViewer\", \"Range Viewer\", [\"xdd:gYearRange\", \"xdd:dateRange\", \"xdd:integerRange\", \"xdd:decimalRange\"]);\r\nRenderingMap.registerEditorForTypes(\"HTMLRangeEditor\", \"Range Editor\", [\"xdd:gYearRange\", \"xdd:dateRange\", \"xdd:integerRange\", \"xdd:decimalRange\"]);\r\nRenderingMap.registerViewerForTypes(\"SantizedHTMLViewer\", \"Sanitized HTML\", [\"xsd:string\", \"xdd:html\"]);\r\n\r\nFramePattern = function(pattern){\r\n\tthis.renderer = (pattern.renderer ? pattern.renderer : false);\r\n\tthis.label = (pattern.value ? pattern.value : false);\r\n\tthis.frame_type = (pattern.frame_type ? pattern.frame_type : false);\r\n\tthis.subject = (pattern.subject ? pattern.subject : false);\r\n\tthis.subjectClass = (pattern.subjectClass ? pattern.subjectClass : false);\r\n\tthis.range = (pattern.range ? pattern.range : false);\r\n\tthis.property = (pattern.property ? pattern.property : false);\r\n\tthis.value = (pattern.value ? pattern.value : false);\r\n\tthis.parent = (pattern.parent ? new FramePattern(pattern.parent) : false);\r\n\tthis.children = [];\r\n\tif(pattern.children){\r\n\t\tfor(var i = 0 ; i < pattern.children.length ; i++){\r\n\t\t\tthis.children.push(new FramePattern(pattern.children[i]));\r\n\t\t}\r\n\t}\r\n\tthis.depth = (typeof pattern.depth != \"undefined\" ? pattern.depth : false);\r\n\tthis.index = (pattern.index ? pattern.index : false);\r\n\tthis.status = (pattern.status ? pattern.status : false);\r\n}\r\n\r\nFramePattern.prototype.checkRenderer = function(renderer){\r\n\tvar rtype = this.getRendererType(renderer);\r\n\tif(!rtype) return false;\r\n\tif(this.renderer && this.renderer != rtype) return false;\r\n\tif(this.illegalRuleType(rtype)) return false;\r\n\tif(this.frame_type && !this.checkFrameType(rtype, renderer)) return false;\r\n\tif(this.label && !this.checkLabel(rtype, renderer)) return false;\r\n\tif(this.subject && !this.checkSubject(rtype, renderer)) return false;\r\n\tif(this.subjectClass && !this.checkSubjectClass(rtype, renderer)) return false;\r\n\tif(this.property && !this.checkProperty(rtype, renderer)) return false;\r\n\tif(this.depth !== false && !this.checkDepth(rtype, renderer)) return false;\r\n\tif(this.range && !this.checkRange(rtype, renderer)) return false;\r\n\tif(this.value && !this.checkValue(rtype, renderer)) return false;\r\n\tif(this.parent && !this.checkParent(rtype, renderer)) return false;\r\n\tif(this.children && this.children.length && !this.checkChildren(rtype, renderer)) return false;\r\n\tif(this.index && !this.checkIndex(rtype, renderer)) return false;\r\n\tif(this.status && !this.checkStatus(rtype, renderer)) return false;\r\n\treturn true;\r\n} \r\n\r\nFramePattern.prototype.illegalRuleType = function(rtype){\r\n\tif(rtype == 'value' && (this.children.length || this.label)) return true;\r\n\tif(rtype == 'object' && this.range ) return true;\r\n\treturn false;\r\n}\r\n\r\n/* subject is an id or an array of ids, \r\n/* match is positive if the renderer's subject appears in the array or is the id\r\n */\r\nFramePattern.prototype.checkSubject = function(subject, renderer){\r\n\tif(typeof this.subject != \"object\" || !this.subject.length) this.subject = [this.subject];\r\n\tvar rsubj = renderer.subject();\r\n\tfor(var i = 0 ; i<this.subject.length; i++){\r\n\t\tif(this.IDsMatch(subject[i], rsubj)){\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\n//at least one child must match all child rules\r\nFramePattern.prototype.checkChildren = function(rtype, renderer){\r\n\tfor(var i = 0 ; i<this.children.length; i++){\r\n\t\tvar found = false;\r\n\t\tif(rtype == \"object\"){\r\n\t\t\tfor(var prop in renderer.properties){\r\n\t\t\t\tif(this.children[i].checkRenderer(renderer.properties[prop])) {\r\n\t\t\t\t\tfound = true;\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if(rtype == \"property\"){\r\n\t\t\tfor(var j = 0; j <= renderer.values.length; j++){\r\n\t\t\t\tif(this.children[j].checkRenderer(renderer.values[j])) {\r\n\t\t\t\t\tfound = true;\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(!found) return false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nFramePattern.prototype.checkStatus = function(rtype, renderer){\r\n\tif(typeof this.status != \"object\" || this.status.length == 0) this.status = [this.status];\r\n\tfor(var i = 0; i<this.status.length; i++){\r\n\t\tif(this.status[i] == \"updated\" && !renderer.isUpdated()) return false;\r\n\t\tif(this.status[i] == \"new\" && !renderer.isNew()) return false;\r\n\t\tif(this.status[i] == \"unchanged\" && renderer.isUpdated()) return false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nFramePattern.prototype.checkDepth = function(rtype, renderer){\r\n\treturn this.numberMatch(this.depth, renderer.depth());\r\n}\r\n\r\nFramePattern.prototype.checkParent = function(rtype, renderer){\r\n\treturn this.parent.checkRenderer(renderer.parent);\r\n}\r\n\r\nFramePattern.prototype.checkIndex = function(rtype, renderer){\r\n\tif(rtype == 'value'){\r\n\t\treturn this.index == renderer.index;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nFramePattern.prototype.checkProperty  = function(rtype, renderer){\r\n\tif(typeof this.property != \"object\" || !this.property.length) this.property = [this.property];\r\n\tfor(var i = 0 ; i<this.property.length; i++){\r\n\t\tif(this.propertyIDsMatch(renderer.property(), this.property[i])){\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\n//returns true if any of the values are found\r\nFramePattern.prototype.checkValue = function(rtype, renderer){\r\n\tif(typeof this.value != \"object\" || !this.value.length) this.value = [this.value];\r\n\tfor(var i = 0 ; i<this.value.length; i++){\r\n\t\tif(rtype == \"value\"){\r\n\t\t\tif(this.valuesMatch(renderer.value(), this.value[i])){\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if(rtype == \"property\"){\r\n\t\t\tfor(var j = 0; j<= renderer.values.length;  j++){\r\n\t\t\t\tif(this.getRendererType(renderer.values[i]) == 'value' &&\r\n\t\t\t\t\t\tthis.valuesMatch(renderer.values[i].value(), this.value[i])){\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if(rtype == \"object\"){\r\n\t\t\tfor(var prop in renderer.properties){\r\n\t\t\t\tif(this.checkValue(this.getRendererType(renderer.properties[prop]), renderer.properties[prop])){\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nFramePattern.prototype.checkRange  = function(rtype, renderer){\r\n\tif(typeof this.range != \"object\" || !this.range.length) this.range = [this.range];\r\n\tfor(var i = 0 ; i<this.range.length; i++){\r\n\t\tif(this.rangeIDsMatch(renderer.range(), this.range[i])){ \r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nFramePattern.prototype.checkSubjectClass = function(rtype, renderer){\r\n\tif(typeof this.subjectClass != \"object\" || !this.subjectClass.length) this.subjectClass = [this.subjectClass];\r\n\tvar rcls = renderer.subjectClass();\r\n\tfor(var i = 0 ; i<this.subjectClass.length; i++){\r\n\t\tif(this.classIDsMatch(this.subjectClass[i], rcls)){\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nFramePattern.prototype.checkFrameType = function (rtype, renderer){\r\n\tif(rtype == \"object\") return this.frame_type == \"object\";\r\n\tif(rtype == \"value\") {\r\n\t\tif(renderer.frame){\r\n\t\t\treturn this.frame_type == renderer.frame.ftype();\r\n\t\t}\r\n\t\telse {\r\n\t\t\talert(JSON.stringify(renderer));\r\n\t\t\talert(\"No frame\");\r\n\t\t}\r\n\t}\r\n\tif(rtype == \"property\") return false;\r\n}\r\n\r\nFramePattern.prototype.checkLabel = function(rtype, renderer){\r\n\tif(typeof renderder.getLabel != \"function\"){\r\n\t\tconsole.log(new Error(\"Rule passed to check label with broken renderer object - no getLabel\"));\r\n\t\treturn false;\r\n\t}\r\n\treturn this.stringMatch(this.label, renderer.getLabel());\r\n}\r\n\r\nFramePattern.prototype.IDsMatch = function(ida, idb){\r\n\treturn TerminusClient.FrameHelper.compareIDs(ida, idb);\r\n}\r\n\r\nFramePattern.prototype.classIDsMatch = function(ida, idb){\r\n\treturn this.IDsMatch(ida, idb);\r\n}\r\nFramePattern.prototype.propertyIDsMatch = function(ida, idb){\r\n\tvar match = this.IDsMatch(ida, idb);\r\n\treturn match;\r\n}\r\nFramePattern.prototype.rangeIDsMatch = function(ida, idb){\r\n\treturn this.IDsMatch(ida, idb);\r\n}\r\nFramePattern.prototype.valuesMatch = function(vala, valb){\r\n\treturn vala == valb;\r\n}\r\nFramePattern.prototype.numberMatch = function(vala, valb){\r\n\tif(typeof vala == \"string\"){\r\n\t\ttry {\r\n\t\t\treturn eval(valb + vala);\r\n\t\t}\r\n\t\tcatch(e){\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\treturn vala === valb;\r\n}\r\n\r\nFramePattern.prototype.stringMatch = function(vala, valb){\r\n\tvar pat = new RegExp(vala);\r\n\treturn pat.test(valb);\r\n}\r\n\r\nFramePattern.prototype.getRendererType = function(renderer){\r\n    if(renderer.constructor.name == \"ObjectRenderer\") return \"object\";\r\n    if(renderer.constructor.name == \"PropertyRenderer\") return \"property\";\r\n    if(renderer.constructor.name == \"ValueRenderer\") return \"value\";\r\n\tif(renderer.renderer_type) return renderer.renderer_type;\r\n\tconsole.log(new Error(\"frame configuration passed non-renderer type \" + renderer.constructor.name));\r\n\tconsole.log(renderer);\r\n\treturn false;\r\n}\r\n\r\n\r\nmodule.exports=RenderingMap\r\n\r\n\r\n","const TerminusPluginManager = require('../plugins/TerminusPlugin');\r\n\r\nlet HTMLFrameHelper = {};\r\n\r\nHTMLFrameHelper.getActionControl = function(type, control, label, callback, disabled){\r\n\tvar pman = new TerminusPluginManager();\r\n\tvar dpropDOM = document.createElement(\"span\");\r\n\tdpropDOM.setAttribute(\"class\", \"terminus-action-control terminus-save-btn \" + type + \"-\" + control);\r\n\tvar pman = new TerminusPluginManager();\r\n    /*if(pman.pluginAvailable(\"font-awesome\")){\r\n\t\tvar icon = document.createElement('icon');\r\n\t\tvar faic = this.getControlIcon(control);\r\n\t\tif(disabled){\r\n\t\t\ticon.setAttribute(\"class\", \"terminus-frame-control frame-control-action action-disabled fa fa\" + faic + \" \" + type + \"-\" + control + \"-disabled terminus-font-align\");\r\n\t\t\ticon.setAttribute(\"title\", disabled);\r\n\t\t}\r\n\t\telse {\r\n\t\t\ticon.setAttribute(\"class\", \"terminus-frame-control frame-control-action frame-control-action fa fa\" + faic + \" \" + type + \"-\" + control + \" terminus-font-align\");\r\n\t\t\ticon.addEventListener(\"click\", function(){\r\n\t\t\t\tcallback(control);\r\n\t\t\t});\r\n\t\t}\r\n\t\tdpropDOM.appendChild(icon);\r\n\t}\r\n\telse{*/\r\n\t\tvar button = document.createElement(\"button\");\r\n\t\tbutton.appendChild(document.createTextNode(label));\r\n\t\tif(disabled){\r\n\t\t\tbutton.setAttribute(\"class\", \"terminus-frame-control terminus-frame-btn frame-control-action action-disabled \" + type + \"-\" + control + \"-disabled\");\r\n\t\t\tbutton.setAttribute(\"title\", disabled);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tbutton.setAttribute(\"class\", \"terminus-frame-control terminus-frame-btn frame-control-action \" + type + \"-\" + control);\r\n\t\t\tbutton.addEventListener(\"click\", function(){\r\n\t\t\t\tcallback(control);\r\n\t\t\t});\r\n\t\t}\r\n\t\tdpropDOM.appendChild(button);\r\n\t//}\r\n\treturn dpropDOM;\r\n}\r\n\r\nHTMLFrameHelper.getSettingsControl = function(view){\r\n\tvar pman = new TerminusPluginManager();\r\n\tif(pman.pluginAvailable(\"font-awesome\")){\r\n\t\tvar icon = document.createElement('icon');\r\n\t\tif(view == 'property') icon.setAttribute('class', 'fa fa-cog terminus-pointer');\r\n\t\telse if(view == 'data') icon.setAttribute('class', 'fa fa-edit terminus-pointer');\r\n\t\ticon.setAttribute('style', 'margin: 10px;')\r\n\t\treturn icon;\r\n\t}\r\n\telse{\r\n\t\tvar button = document.createElement(\"button\");\r\n\t\tbutton.setAttribute('class', 'terminus-btn');\r\n\t\tbutton.appendChild(document.createTextNode('Settings'));\r\n\t\treturn button;\r\n\t}\r\n}\r\n\r\nHTMLFrameHelper.getControlIcon = function(control){\r\n\tvar icon;\r\n\tswitch(control){\r\n\t\tcase 'delete':\r\n\t\t\ticon = '-alt-delete';\r\n\t\tbreak;\r\n\t\tcase 'add':\r\n\t\t\ticon = '-plus';\r\n\t\tbreak;\r\n\t\tcase 'reset':\r\n\t\t\ticon = '-undo';\r\n\t\tbreak;\r\n\t\tcase 'save':\r\n\t\t\ticon = '-save';\r\n\t\tbreak;\r\n\t\tcase 'hide':\r\n\t\t\ticon = '-eye-slash';\r\n\t\tbreak;\r\n\t}\r\n\treturn icon;\r\n}\r\n\r\nHTMLFrameHelper.getSelectionControl = function(type, options, selected, callback){\r\n\tvar sel = document.createElement(\"select\");\r\n\tsel.setAttribute(\"class\", \"terminus-frame-selector frame-control-selection \" + type);\r\n\tfor(var i = 0; i < options.length; i++){\r\n\t\tvar opt = document.createElement(\"option\");\r\n\t\tif(typeof options[i] == \"object\"){\r\n\t\t\topt.value = options[i].value;\r\n\t\t\tvar label = (options[i].label ?  document.createTextNode(options[i].label) : document.createTextNode(TerminusClient.FrameHelper.labelFromURL(options[i].value)));\r\n\t\t\topt.appendChild(label);\r\n\t\t}\r\n\t\telse {\r\n\t\t\topt.value = options[i];\r\n\t\t\tlabel = TerminusClient.FrameHelper.labelFromURL(opt.value);\r\n\t\t\topt.appendChild(document.createTextNode(label));\r\n\t\t}\r\n\t\tif(selected == opt.value){\r\n\t\t\topt.setAttribute(\"selected\", \"selected\");\r\n\t\t}\r\n\t\tsel.appendChild(opt);\r\n\t}\r\n\tsel.addEventListener(\"change\", function(){\r\n\t\tcallback(this.value);\r\n\t});\r\n\treturn sel;\r\n}\r\n\r\nHTMLFrameHelper.getModeSelectorDOM = function(which, renderer){\r\n\tvar viewsDOM = document.createElement(\"span\");\r\n\tviewsDOM.setAttribute(\"class\", \"terminus-mode terminus-\"+which+\"-mode\");\r\n\tif(renderer.mode == \"view\"){\r\n\t\tvar callback = function(){ renderer.setMode(\"edit\");}\r\n\t\tviewsDOM.appendChild(HTMLFrameHelper.getActionControl(\"terminus-mode terminus-\"+which+\"-mode\", \"edit\", \" Edit \", callback));\r\n\t}\r\n\telse if(renderer.isNew()){\r\n\t\treturn false;\r\n\t}\r\n\telse {\r\n\t\tvar callback = function(){ renderer.cancel();}\r\n\t\tviewsDOM.appendChild(HTMLFrameHelper.getActionControl(which, \"cancel\", \"Cancel\", callback));\r\n\t}\r\n\treturn viewsDOM;\r\n}\r\n\r\nHTMLFrameHelper.goToName = function(s, p, i){\r\n\tvar url = window.location.href;\r\n\tif(url){\r\n\t\tvar wbits = url.split(\"#\");\r\n\t\tvar loc = wbits[0];\r\n\t\tvar sh = TerminusClient.FrameHelper.getShorthand(s);\r\n\t    if(!sh) sh = s;\r\n\t\tvar bits = sh.split(\":\");\r\n\t\tif(bits.length > 1) sh = bits[1];\r\n\t\tvar htmlid = sh;\r\n\t\tif(p){\r\n\t\t\tvar prop = TerminusClient.FrameHelper.getShorthand(p);\r\n\t\t\tif(!prop ) prop = p;\r\n\t\t\tvar bits = prop.split(\":\");\r\n\t\t\tif(bits.length > 1) prop = bits[1];\r\n\t\t\thtmlid += \"_\" + prop;\r\n\t\t\tif(i){\r\n\t\t\t\thtmlid += \"_\" + i;\r\n\t\t\t}\r\n\t\t}\r\n\t\twindow.location = loc + \"#\" + htmlid;\r\n\t}\r\n}\r\n\r\n\r\n\r\n/*HTMLFrameHelper.getFrameRow = function(){\r\n\tvar row = document.createElement('div');\r\n\trow.setAttribute('class', 'terminus-frame-row');\r\n\treturn row;\r\n}\r\n\r\nHTMLFrameHelper.getFrameGroup = function(frow){\r\n\tvar fl = document.createElement('div');\r\n\tfl.setAttribute('class', 'terminus-frame-length');\r\n\tfrow.appendChild(fl);\r\n\r\n\tvar fg = document.createElement('div');\r\n\tfg.setAttribute('class', 'terminus-frame-group');\r\n\tfl.appendChild(fg);\r\n\treturn fl;\r\n}*/\r\n\r\nHTMLFrameHelper.getInfoboxDOM = function(type, label, value, help, input){\r\n\t/*var frow = this.getFrameRow();\r\n\tvar fgroup = this.getFrameGroup(frow);*/\r\n\tvar infoDOM = document.createElement(\"span\");\r\n\tinfoDOM.setAttribute(\"class\", \"terminus-frame-infobox-box \" + \"terminus-\" +type );\r\n\t//fgroup.appendChild(infoDOM);\r\n\tif(help){\r\n\t\tinfoDOM.setAttribute(\"title\", help);\r\n\t}\r\n\tif(label){\r\n\t\tvar linfo = document.createElement(\"span\");\r\n\t\tlinfo.setAttribute(\"class\", \"terminus-frame-infobox-label \" + \"terminus-\" +type + \"-label\");\r\n\t\tlinfo.appendChild(document.createTextNode(label));\r\n\t\tinfoDOM.appendChild(linfo);\r\n\t}\r\n\tvar lspacer = document.createElement(\"span\");\r\n\tlspacer.setAttribute(\"class\", \"terminus-frame-infobox-spacer \" + \"terminus-\" +type + \"-spacer\");\r\n\tlspacer.appendChild(document.createTextNode(\" \"));\r\n\tinfoDOM.appendChild(lspacer);\r\n\tvar lval = document.createElement(\"span\");\r\n\tlval.setAttribute(\"class\", \"terminus-frame-infobox-value \" + \"terminus-\" +type + \"-value terminus-property-label-align\");\r\n\tif(input){\r\n\t\tinput.value = value;\r\n\t\tlval.appendChild(input);\r\n\t}\r\n\telse if(value) {\r\n\t\tvar sh = TerminusClient.FrameHelper.getShorthand(value);\r\n        if(sh){\r\n    \t   \tvar bits = sh.split(\":\");\r\n            sh = bits[1];\r\n   \t\t\tlval.setAttribute(\"title\", value);\r\n\t\t\tlval.appendChild(document.createTextNode(sh));\r\n\t\t}\r\n\t\telse {\r\n\t\t\tlval.appendChild(document.createTextNode(value));\r\n\t\t}\r\n\t}\r\n\tinfoDOM.appendChild(lval);\r\n\treturn infoDOM;\r\n}\r\n\r\nmodule.exports=HTMLFrameHelper\r\n","/*\r\n * Utility class which runs a query against the schema and presents the returned classes as a drop-down / class filter list\r\n */\r\n//const FrameHelper = require('../FrameHelper');\r\nconst WOQLQuery = require('../query/WOQLQuery');\r\n\r\nTerminusClassChooser = function(ui, filter, chosen){\r\n\tthis.ui = ui;\r\n\tthis.choice = (chosen ? chosen : false);\r\n\tthis.filter = filter;\r\n\tthis.show_single = true;\r\n}\r\n\r\nTerminusClassChooser.prototype.setRoot = function(root){\r\n\tthis.root = root;\r\n}\r\n\r\nTerminusClassChooser.prototype.setFilter = function(filter){\r\n\tthis.filter = filter;\r\n}\r\n\r\nTerminusClassChooser.prototype.change = function(cls){\r\n\talert(\"Need to specify class chooser function (\" + cls + \")\");\r\n}\r\n\r\nTerminusClassChooser.prototype.getAsDOM = function(style){\r\n\tvar ccdom = document.createElement(\"span\");\r\n\tccdom.setAttribute(\"class\", \"terminus-class-chooser\");\r\n\tvar ccsel = document.createElement(\"select\");\r\n\tccsel.setAttribute(\"class\", style + \" terminus-type-select terminus-class-select\");\r\n\t// ccsel.setAttribute(\"class\", \"terminus-class-select terminus-type-select terminus-query-select\");\r\n\tvar self = this;\r\n\tccsel.addEventListener(\"change\", function(){\r\n\t\tthis.choice = this.value;\r\n\t\tself.change(this.value);\r\n\t\tthis.value = \"\";\r\n\t});\r\n\tccdom.appendChild(ccsel);\r\n\tvar wq = new WOQLQuery(this.ui.client, {}, this.ui);\r\n\tvar woql = wq.getClassListMetaDataQuery(this.filter);\r\n\tvar self = this;\r\n\twq.execute(woql)\r\n\t.then(function(response){\r\n\t\tvar opts = self.getResultsAsOptions(response);\r\n\t\tif(opts){\r\n\t\t\tfor(var i = 0; i<opts.length; i++){\r\n\t\t\t\tccsel.appendChild(opts[i]);\r\n\t\t\t}\r\n\t\t\tself.options = opts;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tccdom.removeChild(ccsel);\r\n\t\t}\r\n\t});\r\n\treturn ccdom;\r\n}\r\n\r\nTerminusClassChooser.prototype.getResultsAsOptions = function(clist){\r\n\tvar choices = [];\r\n\tif(clist.bindings){\r\n\t\tif(this.show_single == false && clist.bindings.length < 2) return false;\r\n\t\tif(this.empty_choice){\r\n\t\t\tvar opt1 = document.createElement(\"option\");\r\n\t\t\topt1.setAttribute(\"class\", \"terminus-class-choice terminus-empty-choice\");\r\n\t\t\topt1.value = \"\";\r\n\t\t\topt1.appendChild(document.createTextNode(this.empty_choice));\r\n\t\t\tchoices.push(opt1);\r\n\t\t}\r\n\t\tvar added = [];\r\n\t\tfor(var i = 0; i<clist.bindings.length; i++){\r\n\t\t\tvar bclass = this.getVariableValueFromBinding(\"Element\", clist.bindings[i]);\r\n\t\t\tif(!bclass) bclass = this.getVariableValueFromBinding(\"Class\", clist.bindings[i]);\r\n\t\t\tif(bclass && added.indexOf(bclass) == -1){\r\n\t\t\t\tadded.push(bclass);\r\n\t\t\t\tvar opt = document.createElement(\"option\");\r\n\t\t\t\topt.setAttribute(\"class\", \"terminus-class-choice\");\r\n\t\t\t\topt.value = bclass;\r\n\t\t\t\tif(opt.value == this.choice){\r\n\t\t\t\t\topt.selected = true;\r\n\t\t\t\t}\r\n\t\t\t\tvar lab = this.getVariableValueFromBinding(\"Label\", clist.bindings[i]);\r\n\t\t\t\tif(!lab || lab == \"unknown\"){\r\n\r\n\t\t\t\t\tlab = TerminusClient.FrameHelper.labelFromURL(bclass);\r\n\r\n\t\t\t\t}\r\n\t\t\t\tif(lab[\"@value\"]) lab = lab[\"@value\"];\r\n\t\t\t\topt.appendChild(document.createTextNode(lab));\r\n\t\t\t\tchoices.push(opt);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn choices;\r\n}\r\n\r\nTerminusClassChooser.prototype.getVariableValueFromBinding = function(varname, bind){\r\n\tfor(var key in bind){\r\n\t\tvar skey = key.substring(key.lastIndexOf(\"/\")+1);\r\n\t\tif(skey == varname){\r\n\t\t\treturn bind[key];\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nmodule.exports=TerminusClassChooser\r\n","const TerminusPluginManager = require('../plugins/TerminusPlugin');\r\nconst Datatables = require('../plugins/datatables.terminus');\r\n\r\nfunction WOQLResult(res, query, options, ui){\r\n\tthis.ui = ui;\r\n\tthis.query = query;\r\n\tthis.bindings = ((res && res.bindings) ? res.bindings : []);\r\n}\r\n\r\nWOQLResult.prototype.count = function(){\r\n\treturn this.bindings.length;\r\n}\r\n\r\nWOQLResult.prototype.shorten = function(url){\r\n\treturn this.query.shorten(url);\r\n}\r\n\r\nWOQLResult.prototype.hasBindings = function(result){\r\n\tif(result) return (result.bindings && result.bindings.length);\r\n\telse return (this.bindings && this.bindings.length);\r\n}\r\n\r\n\r\n\r\nfunction WOQLResultsViewer(ui, wresult, wQuery, options, settings, queryPage){\r\n\tthis.ui = ui;\r\n\tthis.result = wresult;\r\n\tthis.wQuery = wQuery;\r\n\tthis.options = options;\r\n\tthis.qPage = queryPage;\r\n\t//this.wqlRes = new WOQLResult();\r\n\tthis.pman = new TerminusPluginManager();\r\n\tthis.settings = settings;\r\n}\r\n\r\nWOQLResultsViewer.prototype.showTable = function(){\r\n\tif(this.options && typeof this.options.show_table != \"undefined\") return this.options.show_table;\r\n\treturn true;\r\n}\r\n\r\nWOQLResultsViewer.prototype.orderColumns = function(sample){\r\n\tvar ordered = [];\r\n\tfor(var h in sample){\r\n\t\tif(ordered.indexOf(h) == -1){\r\n\t\t\tordered.unshift(h);\r\n\t\t}\r\n\t}\r\n\treturn ordered;\r\n}\r\n\r\nWOQLResultsViewer.prototype.getAsDOM = function(resultDOM, displayResultHeader){\r\n\tvar rs = document.createElement('div');\r\n\tresultDOM.appendChild(rs);\r\n\tif(displayResultHeader){\r\n\t\tvar rh = document.createElement('div');\r\n\t\trh.setAttribute(\"class\", \"terminus-margin-top-bottom terminus-module-head\");\r\n\t\trh.appendChild(document.createTextNode(\"Results\"));\r\n\t\trs.appendChild(rh);\r\n\t}\r\n\tif(this.result && this.result.hasBindings() && this.showTable()){\r\n\t\tthis.getTableDOM(this.result.bindings, rs);\r\n\t\treturn rs;\r\n\t}\r\n\telse {\r\n\t\tconsole.log(\"no bindings for query\");\r\n\t}\r\n}\r\n\r\nWOQLResultsViewer.prototype.getTableDOM = function(bindings, resultDOM){\r\n\tif(this.pman.pluginAvailable(\"datatables\")){\r\n\t\tvar dtResult = this.getTable(bindings, true, {});\r\n\t\tresultDOM.appendChild(dtResult.tab);\r\n\t\tvar dt = new Datatables.Datatables(this, this.qPage);\r\n\t\tdt.draw(dtResult, resultDOM);\r\n\t\tresultDOM.classList.add('terminus-expandable');\r\n\t\tresultDOM.classList.add('terminus-dt-result-cont');\r\n\t\treturn tab;\r\n    }\r\n\telse{\r\n\t\tvar tab = this.getTable(bindings, false, {});\r\n\t\tresultDOM.appendChild(tab);\r\n\t}\r\n}\r\n\r\nWOQLResultsViewer.prototype.getDtTableDOMOnChange = function(bindings, resultDOM, pageInfo){\r\n\t\tvar dtResult = this.getTable(bindings, true, pageInfo);\r\n\t\tresultDOM.appendChild(dtResult.tab);\r\n\t\treturn dtResult;\r\n}\r\n\r\nWOQLResultsViewer.prototype.formatResultsForDatatableDisplay = function(bindings, pageInfo){\r\n    var columns = [], colDataData = {}, data = [], formattedResult = {}, arr = [];\r\n\tvar dtResult = {};\r\n    var ordered_headings = this.orderColumns(bindings[0]);\r\n\t// get columns\r\n\tfor(var i = 0; i<ordered_headings.length; i++){\r\n\t\tvar clab = TerminusClient.FrameHelper.validURL(ordered_headings[i]) ? TerminusClient.FrameHelper.labelFromURL(ordered_headings[i]) : ordered_headings[i];\r\n        columns.push({data: clab});\r\n\t}\r\n\t// get data for respective columns\r\n\tfor(var i = 0; i<bindings.length; i++){\r\n\t\tcolDataData = {};\r\n\t\tfor(var j = 0; j<ordered_headings.length; j++){\r\n\t\t\tif(typeof bindings[i][ordered_headings[j]] == \"object\"){\r\n\t\t\t\tvar lab = (bindings[i][ordered_headings[j]]['@value'] ? bindings[i][ordered_headings[j]]['@value'] : \"Object?\");\r\n\t\t\t}\r\n\t\t\telse if(typeof bindings[i][ordered_headings[j]] == \"string\") {\r\n\t\t\t\tvar lab = this.result.shorten(bindings[i][ordered_headings[j]]);\r\n\t\t\t\tif(lab == \"unknown\") lab = \"\";\r\n\t\t\t\tif(lab.substring(0, 4) == \"doc:\"){\r\n\t\t\t\t\tlab = this.getDocumentLocalLink(lab).outerHTML;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar clab = TerminusClient.FrameHelper.validURL(ordered_headings[j]) ? TerminusClient.FrameHelper.labelFromURL(ordered_headings[j]) : ordered_headings[j];\r\n\t\t\tcolDataData[clab] = lab;\r\n\t\t}\r\n\t\tdata.push(colDataData);\r\n\t}\r\n\tdtResult.columns = columns;\r\n\tformattedResult.data = data;\r\n\tformattedResult.recordsTotal = 65;\r\n\tformattedResult.recordsFiltered = 65;\r\n\tformattedResult.draw = 1;\r\n\tdtResult.data = formattedResult;\r\n\treturn dtResult;\r\n}\r\n\r\nWOQLResultsViewer.prototype.getTableBody = function(bindings, ordered_headings){\r\n\tvar tbody = document.createElement(\"tbody\");\r\n\tvar self = this;\r\n\tfor(var i = 0; i<bindings.length; i++){\r\n\t\tvar tr = document.createElement(\"tr\");\r\n\t\tfor(var j = 0; j<ordered_headings.length; j++){\r\n\t\t\tvar td = document.createElement(\"td\");\r\n\t\t\tif(typeof bindings[i][ordered_headings[j]] == \"object\"){\r\n\t\t\t\tvar lab = (bindings[i][ordered_headings[j]]['@value'] ? bindings[i][ordered_headings[j]]['@value'] : \"?\");\r\n\t\t\t}\r\n\t\t\telse if(typeof bindings[i][ordered_headings[j]] == \"string\") {\r\n\t\t\t\tvar lab = this.result.shorten(bindings[i][ordered_headings[j]]);\r\n\t\t\t}\r\n\t\t\tif(lab == \"unknown\") lab = \"\";\r\n\t\t\tif(lab.substring(0, 4) == \"doc:\"){\r\n\t\t\t\tvar a = this.getDocumentLocalLink(lab);\r\n\t\t\t\ttd.appendChild(a);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\ttd.appendChild(document.createTextNode(lab));\r\n\t\t\t}\r\n\t\t\ttr.appendChild(td);\r\n\t\t}\r\n\t\ttbody.appendChild(tr);\r\n\t}\r\n\treturn tbody;\r\n}\r\n\r\nWOQLResultsViewer.prototype.getDocumentLocalLink = function(lab){\r\n\tvar a = document.createElement(\"a\");\r\n\ta.setAttribute(\"title\", lab);\r\n\ta.setAttribute(\"href\", '#');\r\n\tvar self = this;\r\n\ta.addEventListener(\"click\", function(){\r\n\t\tif(self.result.ui) {\r\n\t\t\tself.result.ui.showDocument(this.title);\r\n\t\t\tself.result.ui.redraw();\r\n\t\t}\r\n\t});\r\n\ta.appendChild(document.createTextNode(lab));\r\n\treturn a;\r\n}\r\n\r\nWOQLResultsViewer.prototype.getTable = function(bindings, dtPlugin, pageInfo){\r\n\tvar tab = document.createElement(\"table\");\r\n\ttab.setAttribute(\"class\", \"terminus-hover-table\");\r\n\tvar thead = document.createElement(\"thead\");\r\n\tvar thr = document.createElement(\"tr\");\r\n\tvar ordered_headings = this.orderColumns(bindings[0]);\r\n\tfor(var i = 0; i<ordered_headings.length; i++){\r\n\t\tvar th = document.createElement(\"th\");\r\n\t\tth.setAttribute('class', 'terminus-table-header-full-css');\r\n\t\tvar clab = (ordered_headings[i].indexOf(\"http\") != -1) ? TerminusClient.FrameHelper.labelFromURL(ordered_headings[i]) : ordered_headings[i];\r\n\t\tth.appendChild(document.createTextNode(clab));\r\n\t\tthr.appendChild(th);\r\n\t}\r\n\tthead.appendChild(thr);\r\n\ttab.appendChild(thead);\r\n\tif(dtPlugin){\r\n\t\tvar tbody = document.createElement(\"tbody\");\r\n\t\ttab.appendChild(tbody);\r\n\t\tvar dtResult ={};\r\n\t\tdtResult.result = this.formatResultsForDatatableDisplay(bindings, pageInfo);\r\n\t\tdtResult.tab = tab;\r\n\t\treturn dtResult;\r\n\t}\r\n\telse {\r\n\t\tvar tbody = this.getTableBody(bindings, ordered_headings);\r\n\t\ttab.appendChild(tbody);\r\n\t\treturn tab;\r\n\t}\r\n}\r\n\r\n\r\nmodule.exports={WOQLResultsViewer, WOQLResult}\r\n","const WOQLQuery = require('../query/WOQLQuery');\r\nconst Renderers = require('./ObjectRenderer');\r\n\r\nfunction TerminusDocumentViewer(ui, action, options){\r\n\tthis.ui = ui;\r\n\tthis.server = this.ui.server();\r\n\tthis.db = this.ui.db();\r\n\tthis.init();\r\n\tthis.mode = (options && options.mode ? options.mode : \"view\");\r\n\tthis.editor = (options && options.editor ? options.editor : false);\r\n\tthis.load_schema = (options && options.load_schema ? options.load_schema : true);\r\n\tthis.config_options = this.getBuiltInViewerOptions();\r\n\tthis.options = (options ? options : this.config_options[action]);\r\n\tthis.action = action;\r\n\tthis.document = false;\r\n}\r\n\r\nTerminusDocumentViewer.prototype.init = function(){\r\n\tvar wq = new WOQLQuery(this.ui.client, this.options, this.ui);\r\n\tvar woql = wq.getClassMetaDataQuery();\r\n\tvar self = this;\r\n\tself.classmeta = {};\r\n\tself.instancemeta = {};\r\n\twq.execute(woql).then(function(wresult){\r\n\t\tif(wresult && wresult.hasBindings()){\r\n\t\t\tfor(var i = 0; i<wresult.bindings.length; i++){\r\n\t\t\t\tvar cls = wresult.bindings[i].Class;\r\n\t\t\t\tif(cls && typeof self.classmeta[cls] == \"undefined\"){\r\n\t\t\t\t\tself.classmeta[cls] = wresult.bindings[i];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tself.refreshPage();\r\n\t\t}\r\n\t})\r\n\t.catch(function(e){\r\n\t\tconsole.log(e);\r\n\t});\r\n}\r\n\r\nTerminusDocumentViewer.prototype.getInstanceMeta = function(elid){\r\n\tvar self = this;\r\n\tif(self.instancemeta && typeof self.instancemeta[elid] != \"undefined\") return self.instancemeta[elid] ;\r\n\tvar wq = new WOQLQuery(this.ui.client, this.options, this.ui);\r\n\tvar woql = wq.getInstanceMeta(elid);\r\n\treturn wq.execute(woql).then(function(wresult){\r\n\t\tif(wresult && wresult.hasBindings()){\r\n\t\t\tvar res = wresult.bindings[0];\r\n\t\t\treturn res;\r\n\t\t}\r\n\t\treturn false;\r\n\t})\r\n\t.catch(function(e){\r\n\t\tconsole.log(e);\r\n\t});\r\n}\r\n\r\nTerminusDocumentViewer.prototype.getClassMeta = function(cls){\r\n\tif(typeof this.classmeta[cls]){\r\n\t\treturn this.classmeta[cls];\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nTerminusDocumentViewer.prototype.loadCreateDocument = function(url){\r\n\tif(url){\r\n\t\tthis.ui.showBusy(\"Fetching frame for document class \" + url);\r\n\t\tvar self = this;\r\n\t\tthis.mode = \"edit\";\r\n\t\tthis.page_config = \"create\";\r\n\t\tif(url.indexOf(\"/\") == -1 && url.indexOf(\":\") == -1) {\r\n\t\t\turl = \"schema:\" + url;\r\n\t\t}\r\n\t\treturn this.loadDocumentSchema(url)\r\n\t\t.then(function(response){\r\n\t\t\tself.ui.clearBusy();\r\n\t\t\tself.setLabel();\r\n\t\t})\r\n\t\t.catch(function(error) {\r\n\t\t\tconsole.error(error);\r\n\t\t\tself.ui.clearBusy();\r\n\t\t\tself.ui.showError(error);\r\n\t\t});\r\n\t}\r\n}\r\n\r\nTerminusDocumentViewer.prototype.loadDocument = function(url, cls){\r\n\tif(!url) return false;\r\n\tvar self = this;\r\n\tif(url.substring(0,4) == \"doc:\"){\r\n\t\turl = url.substring(4);\r\n\t}\r\n\tthis.page_config = \"view\";\r\n\turl = url.replace(\"/candidate\", \"/platform/document\");\r\n\tthis.ui.showBusy(\"Loading Document from \" + url);\r\n\treturn this.ui.client.getDocument(url, {\"terminus:encoding\": \"terminus:frame\"})\r\n\t.then(function(response){\r\n\t\tself.ui.clearBusy();\r\n\t\tself.loadDataFrames(response);\r\n\t\tself.setLabel();\r\n\t\tself.refreshPage();\r\n\t\tif(self.load_schema){\r\n\t\t\treturn self.loadDocumentSchema(self.document.cls).then(function(){ self.refreshPage()}).catch(function(e){console.error(e)});\r\n\t\t}\r\n\t\treturn response;\r\n\t})\r\n\t.catch(function(error) {\r\n\t\tconsole.error(error);\r\n\t\tself.ui.clearBusy();\r\n\t\tself.ui.showError(error);\r\n\t});\r\n}\r\n\r\nTerminusDocumentViewer.prototype.loadDocumentSchema = function(cls){\r\n\tvar self = this;\r\n\tvar ncls = TerminusClient.FrameHelper.unshorten(cls);\r\n\treturn this.ui.client.getClassFrame(false, ncls)\r\n\t.then(function(response){\r\n\t\tself.loadSchemaFrames(response, cls);\r\n\t\tself.refreshPage();\r\n\t});\r\n}\r\n\r\nTerminusDocumentViewer.prototype.deleteDocument = function(URL){\r\n\tthis.document = false;\r\n\tvar self = this;\r\n\tthis.ui.showBusy(\"Deleting Document \" + URL);\r\n\treturn this.ui.client.deleteDocument(URL)\r\n\t.then(function(response){\r\n\t\tself.ui.clearBusy();\r\n\t}).catch(function(error){\r\n\t\tself.ui.clearBusy();\r\n\t\tself.ui.showError(error);\r\n\t});\r\n}\r\n\r\nTerminusDocumentViewer.prototype.createDocument = function(id){\r\n\tvar self = this;\r\n\tvar extr = this.renderer.extract();\r\n\tvar opts = { \"terminus:encoding\": \"jsonld\" };\r\n\tthis.ui.showBusy(\"Creating document\");\r\n\treturn this.ui.client.createDocument(id, extr, opts)\r\n\t.then(function(response){\r\n\t\tself.ui.clearBusy();\r\n\t\tself.ui.showDocument(id);\r\n\t}).catch(function(error){\r\n\t\tself.ui.clearBusy();\r\n\t\tif(error.data && error.data['terminus:witnesses']){\r\n\t\t\tself.ui.showViolations(error.data['terminus:witnesses'], \"instance\");\t\t\t\r\n\t\t}\r\n\t\telse {\r\n\t\t\tself.ui.showError(error);\r\n\t\t}\r\n\t});\r\n}\r\n\r\nTerminusDocumentViewer.prototype.updateDocument = function(){\r\n\tvar durl = this.document.subjid;\r\n\tvar extr = this.renderer.extract();\r\n\tvar self = this;\r\n\tvar opts = { \"terminus:encoding\": \"jsonld\" };\r\n\tthis.ui.showBusy(\"Updating document \" + durl);\r\n\treturn this.ui.client.updateDocument(durl, extr, opts)\r\n\t.then(function(response){\r\n\t\tself.ui.clearBusy();\r\n\t\tself.ui.showDocument(durl);\r\n\t}).catch(function(error){\r\n\t\tself.ui.clearBusy();\r\n\t\tif(error.data && error.data['terminus:witnesses']){\r\n\t\t\tself.ui.showViolations(error.data['terminus:witnesses'], \"instance\");\t\t\t\r\n\t\t}\r\n\t\telse {\r\n\t\t\tself.ui.showError(error);\r\n\t\t}\r\n\t});\r\n}\r\n\r\nTerminusDocumentViewer.prototype.loadDataFrames = function(dataframes, cls){\r\n\tif(!cls){\r\n\t\tif(this.document) cls = this.document.cls;\r\n\t\telse {\r\n\t\t\tif(dataframes && dataframes.length && dataframes[0] && dataframes[0].domain){\r\n\t\t\t\tcls = dataframes[0].domain;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tif(cls){\r\n\t\tif(!this.document){\r\n\t\t\tthis.document = new TerminusClient.ObjectFrame(cls, dataframes);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.document.loadDataFrames(dataframes);\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\talert(\"Missing Class\" + \" \" + \"Failed to add dataframes due to missing class\");\r\n\t}\r\n}\r\n\r\n\r\nTerminusDocumentViewer.prototype.loadSchemaFrames = function(classframes, cls){\r\n\tif(!cls){\r\n\t\tif(classframes && classframes.length && classframes[0] && classframes[0].domain){\r\n\t\t\tcls = classframes[0].domain;\r\n\t\t}\r\n\t}\r\n\tif(cls){\r\n\t\tif(!this.document){\r\n\t\t\tthis.document = new TerminusClient.ObjectFrame(cls);\r\n\t\t}\r\n\t\tif(classframes){\r\n\t\t\tthis.document.loadClassFrames(classframes);\r\n\t\t\tif(!this.document.subjid){\r\n\t\t\t\tthis.document.newDoc = true;\r\n\t\t\t\tthis.document.fillFromSchema(\"_:\");\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tthis.error(\"Missing Class\", \"Failed to add class frames due to missing class\");\r\n\t}\r\n}\r\n\r\nTerminusDocumentViewer.prototype.render = function(){\r\n\tif(!this.renderer && this.document){\r\n\t\tif(this.page_config){\r\n\t\t\tthis.options = this.getOptionsFromPageConfig(this.page_config);\r\n\t\t}\r\n\t\ttry{\r\n\t\t\tthis.renderer = new Renderers.ObjectRenderer(this.document, false, this.options);\r\n\t\t\tthis.renderer.mode = this.mode;\r\n\t\t\tthis.renderer.controller = this;\r\n\t\t}catch(e){\r\n\t \t\tconsole.error('TerminusDocumentViewer render',e.toString())\r\n\t \t}\r\n\t}\r\n\tif(this.renderer){\r\n\t\treturn this.renderer.render();\r\n\t}\r\n}\r\n\r\nTerminusDocumentViewer.prototype.getBuiltInViewerOptions = function(){\r\n\treturn FrameConfig;\r\n}\r\n\r\nTerminusDocumentViewer.prototype.getOptionsFromPageConfig = function(pageconf){\r\n\tif(typeof this.config_options[pageconf] == \"object\") {\r\n\t\treturn this.config_options[pageconf];\r\n\t}\r\n\treturn this.options;\r\n}\r\n\r\n\r\nTerminusDocumentViewer.prototype.getClient = function(){\r\n\treturn this.ui.client;\r\n}\r\n\r\nTerminusDocumentViewer.prototype.extract = function(options){\r\n\treturn this.renderer.extract();\r\n}\r\n\r\nTerminusDocumentViewer.prototype.getLabel = function(){\r\n\tvar lab = (this.cls ? this.cls : false);\r\n\tif(!lab) lab = (this.docid ? this.docid : \"Void\");\r\n\treturn lab;\r\n}\r\n\r\nTerminusDocumentViewer.prototype.setLabel = function(){\r\n\tif(this.document && this.labdom){\r\n\t\tTerminusClient.FrameHelper.removeChildren(this.labdom);\r\n\t\tvar dfs = this.document.getDataFrames(TerminusClient.FrameHelper.getStdURL(\"rdfs\", \"label\"));\r\n\t\tfor(var i = 0; i< dfs.length; i++){\r\n\t\t\tvar lab = dfs[i].get();\r\n\t\t\tif(lab) {\r\n\t\t\t\tthis.labdom.appendChild(document.createTextNode(lab));\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\nTerminusDocumentViewer.prototype.refreshPage = function(){\r\n\tif(this.pagedom){\r\n\t\tTerminusClient.FrameHelper.removeChildren(this.pagedom);\r\n\t\tvar rends = this.render();\r\n\t\tif(rends){\r\n\t\t\tthis.pagedom.appendChild(rends);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nTerminusDocumentViewer.prototype.getAsDOM = function(){\r\n\tvar holder = document.createElement(\"div\");\r\n\tholder.setAttribute(\"class\", \"terminus-document-holder\");\r\n\tif(this.mode !== 'edit'){ // dont provide drop down on create mode\r\n\t\tthis.controldom = document.createElement(\"div\");\r\n\t\tthis.controldom.setAttribute(\"class\", \"terminus-document-controller\");\r\n\t\tif(Object.keys(this.config_options).length > 1)\tthis.controldom.appendChild(this.getDocumentPageControls());\r\n\t\tholder.appendChild(this.controldom);\r\n\t}\r\n\tthis.pagedom = document.createElement(\"div\");\r\n\tthis.pagedom.setAttribute(\"class\", \"terminus-document-page\");\r\n\tvar rends = this.render();\r\n\tif(rends){\r\n\t\tthis.pagedom.appendChild(rends);\r\n\t}\r\n\tholder.appendChild(this.pagedom);\r\n\treturn holder;\r\n}\r\n\r\nTerminusDocumentViewer.prototype.getDocumentPageControls = function(){\r\n\tvar dpc = document.createElement(\"select\");\r\n\tdpc.setAttribute(\"class\", \"terminus-form-select terminus-document-config\");\r\n\tfor(var i in this.config_options){\r\n\t\tif(i === 'create') continue; // create docuemnt option from config is not taken in edit mode \r\n\t\tvar opt = document.createElement(\"option\");\r\n\t\topt.value = i;\r\n\t\tif(this.page_config == i){\r\n\t\t\topt.selected = true;\r\n\t\t}\r\n\t\topt.appendChild(document.createTextNode(this.config_options[i].label));\r\n\t\tdpc.appendChild(opt);\r\n\t}\r\n\tvar self = this;\r\n\tdpc.addEventListener(\"change\", function(){\r\n\t\tself.page_config = this.value;\r\n\t\tself.renderer = false;\r\n\t\tself.refreshPage();\r\n\t})\r\n\treturn dpc;\r\n}\r\n\r\nmodule.exports=TerminusDocumentViewer\r\n","const UTILS= require('../Utils')\r\n\r\n/*** client side processing ***/\r\nfunction CspDatatables(ui){\r\n    this.ui = ui;\r\n}\r\n\r\nCspDatatables.prototype.convertToDatatable = function(tab){\r\n    var dt = this;\r\n    var table = jQuery(tab).DataTable({\r\n         searching : false,\r\n         pageLength: 25,\r\n         lengthMenu: [10, 25, 50, 75, 100],\r\n         paging    : true,\r\n         select    : true,\r\n         initComplete: function(settings) {\r\n                        var ict =settings.oInstance.api();\r\n                        ict.$('td').each(function(){\r\n                            this.setAttribute('title', $(this).html())\r\n                        })},\r\n         columnDefs:[{targets:'_all',className:\"truncate\"}],\r\n         createdRow: function(row) {\r\n                            var td = $(row).find(\".truncate\");\r\n                            td.attr(\"title\", td.html());}\r\n    }); //jQuery(tab)\r\n\r\n    // on click of row connect to db, on click of 5th column delete db\r\n    jQuery(tab, 'tbody').on('click', 'td', function(){\r\n        if(table.cell(this).index().column == 5){\r\n            var dbInfo = table.row(jQuery(this).parents('tr')).data();\r\n            var dbId = UTILS.extractValueFromCell(dbInfo[0]);\r\n            dt.ui.deleteDatabase(dbId);\r\n            return;\r\n        }\r\n        else dt.ui.showDBMainPage();\r\n     }); // on click\r\n\r\n    tab.setAttribute('class'      , 'stripe dataTable terminus-db-size');\r\n    tab.setAttribute('cellpadding', '1');\r\n    tab.setAttribute('cellspacing', '0');\r\n    tab.setAttribute('border'     , '0');\r\n    return tab;\r\n}\r\n\r\nCspDatatables.prototype.draw = function(dtResult){\r\n    return(this.convertToDatatable(dtResult));\r\n}\r\n\r\n/*** server side processing ***/\r\nfunction Datatables(wResViewer, qPage){\r\n   this.wrViewer = wResViewer;\r\n   this.wQuery = wResViewer.wQuery;\r\n   this.ui = wResViewer.ui;\r\n   this.qPage = qPage;\r\n}\r\n\r\n/*\r\n    query: new woqlquery with current pagination changes\r\n    pageInfo: current drawCallBack page change info\r\n    resultDOM: result dom on veiwer page\r\n*/\r\nDatatables.prototype.executeQuery = function(query, pageInfo, resultDOM){\r\n    var self = this;\r\n    //dcb.wquery.execute(query)\r\n    this.wQuery.execute(query)\r\n      .then(function(result){\r\n          var dtResult = {};\r\n          dtResult =self.wrViewer.getDtTableDOMOnChange(result.bindings, resultDOM, pageInfo);\r\n          return dtResult;\r\n          //self.getDataFromServer(dtResult, wrViewer, ui, wQuery, resultDOM);\r\n      })\r\n      .catch(function(err){\r\n          console.error(err);\r\n          self.ui.showError(err);\r\n      });\r\n}\r\n\r\n/* get query string based on datatable pagination and current query */\r\nDatatables.prototype.getQueryOnPagination = function(wq, settings){\r\n    switch(settings.query){\r\n        case 'Show_All_Documents':\r\n            return wq.getAllDocumentQuery(null, settings.pageLength, settings.start);\r\n        break;\r\n        case 'Show_All_Data':\r\n            return wq.getEverythingQuery(null, settings.pageLength, settings.start);\r\n        break;\r\n        case 'Show_All_Schema_Elements':\r\n            return wq.getElementMetaDataQuery(null, settings.pageLength, settings.start);\r\n        break;\r\n        case 'Show_Document_Classes':\r\n        \tvar sqp = wq.getConcreteDocumentClassPattern(\"Class\");\r\n            return wq.getClassMetaDataQuery(sqp);\r\n        break;\r\n        case 'Show_All_Properties':\r\n            return wq.getPropertyListQuery(null, settings.pageLength, settings.start);\r\n        break;\r\n        case 'Show_All_Classes':\r\n            return wq.getClassMetaDataQuery(null, settings.pageLength, settings.start);\r\n        break;\r\n        case 'Show_Data_Class':\r\n            return  wq.getDataOfChosenClassQuery(settings.chosenValue, settings.pageLength, settings.start);\r\n        break;\r\n        case 'Show_Property_Class':\r\n            return wq.getDataOfChosenPropertyQuery(settings.chosenValue, settings.pageLength, settings.start);\r\n        break;\r\n        case 'Show_Document_Info_by_Id':\r\n            return wq.getDocumentQuery(settings.chosenValue, settings.pageLength, settings.start);\r\n        break;\r\n        default:\r\n            console.log('Invalid woql option passed');\r\n        break;\r\n\r\n    }\r\n}\r\n\r\n/*\r\n    pageInfo: current drawCallBack page change info\r\n*/\r\nDatatables.prototype.generateNewQueryOnPageChange = function(pageInfo){\r\n    if(this.qPage) UTILS.deleteStylizedEditor(this.ui, pageInfo.qTextDom);\r\n    var query = this.getQueryOnPagination(this.wQuery, pageInfo)\r\n    if(this.qPage) {\r\n        pageInfo.qTextDom.value = JSON.stringify(query,undefined, 2);\r\n        UTILS.stylizeEditor(this.ui, pageInfo.qTextDom, 'query', 'javascript');\r\n    }\r\n    return query;\r\n}\r\n\r\n/*\r\n    dt: Datatable reference\r\n    len : current number of records to display\r\n*/\r\nDatatables.prototype.getCallbackSettings = function(dt, len, start){\r\n    var pageInfo = {};\r\n    pageInfo.pageLength = len;\r\n    pageInfo.start      = start;\r\n    pageInfo.qTextDom   = dt.qTextDom;\r\n    pageInfo.query      = dt.query;\r\n    pageInfo.chosenValue = dt.chosenValue;\r\n    return pageInfo;\r\n}\r\n\r\n/*\r\n    tab: datatable table dom\r\n    settings : settings from woql txt generator\r\n    resultDOM: result dom of viewer\r\n*/\r\nDatatables.prototype.setUp = function(tab, settings, resultDOM){\r\n    // delete previous datatable\r\n    TerminusClient.FrameHelper.removeChildren(this.dtdom);\r\n    this.dtdom = document.createElement('div');\r\n    this.dtdom.appendChild(tab);\r\n    resultDOM.appendChild(this.dtdom);\r\n    // saving query text box dom to change limit value on change of datatable page length\r\n    this.qTextDom = settings.qTextDom;\r\n    this.query = settings.query;\r\n    this.chosenValue = settings.chosenValue;\r\n}\r\n\r\nDatatables.prototype.getNewDataOnChange = function(drawnTab, aSettings, resultDOM){\r\n    var pageInfo = this.getCallbackSettings(this, aSettings._iDisplayLength, aSettings._iDisplayStart);\r\n    var query = this.generateNewQueryOnPageChange(pageInfo);\r\n    return this.executeQuery(query, pageInfo, resultDOM);\r\n    //return  dtResult.result.data;\r\n}\r\n\r\nDatatables.prototype.getDataFromServer = function(dtResult,resultDOM){\r\n    var dt = this;\r\n    var tab = dtResult.tab;\r\n    this.setUp(tab, this.wrViewer.settings, resultDOM);\r\n    // initialize datatables\r\n    var table = jQuery(tab).DataTable({\r\n         searching   : false,\r\n         pageLength  : dt.wrViewer.settings.pageLength,\r\n         serverSide  : true,\r\n         processing  : true,\r\n         lengthMenu  : [5, 10, 25, 50, 75, 100],\r\n         dom         : 'RBlftip',\r\n         columns     : dtResult.result.columns,\r\n         paging      : true,\r\n         select      : true,\r\n         initComplete: function(settings) {\r\n                        var ict =settings.oInstance.api();\r\n                        ict.$('td').each(function(){\r\n                            this.setAttribute('title', $(this).html())\r\n                        })},\r\n         ajax        : function (data, callback, settings) {\r\n                        if(Object.entries(dtResult.result.data).length > 0){\r\n                            // first draw is loaded\r\n                            var res = dtResult.result.data;\r\n                            dtResult.result.data = {};\r\n                        }\r\n                        else{\r\n                            var res = dt.getNewDataOnChange(this, settings, resultDOM);\r\n                            console.log('res', res);\r\n                        }\r\n                        callback(res);},\r\n         buttons     : [{ extend: 'copy', text: 'Copy to clipboard' },\r\n                        { extend: 'excel', text: 'Export to Excel' }],\r\n         columnDefs  : [{targets:'_all',className:\"truncate\"}],\r\n         createdRow  : function(row){\r\n                            var td = $(row).find(\".truncate\");\r\n                            td.attr(\"title\", td.html());},\r\n         //colReorder  : {addFixed : true, liveDrag:true},\r\n         scrollX     : true\r\n    }); //jQuery(tab)\r\n\r\n    //styling\r\n    tab.setAttribute('class'      , 'stripe dataTable');\r\n    tab.setAttribute('style'       , 'margin: 0!important');\r\n    tab.setAttribute('cellpadding', '1');\r\n    tab.setAttribute('cellspacing', '1');\r\n    tab.setAttribute('border'     , '0');\r\n\r\n    return tab;\r\n}\r\n\r\n/*\r\nserverside: true or false\r\n*/\r\nDatatables.prototype.draw = function(dtResult, resultDOM){\r\n    return(this.getDataFromServer(dtResult, resultDOM));\r\n}\r\n\r\nmodule.exports={Datatables, CspDatatables}\r\n","/**\r\n * Object for producing a HTML view of a given object in a frame\r\n */\r\nconst HTMLFrameHelper = require('./HTMLFrameHelper');\r\n\r\nfunction HTMLObjectViewer(renderer){\r\n\tthis.renderer = renderer;\r\n\tthis.properties = [];\r\n\tthis.headerViewer = renderer.getObjectHeaderViewer();\r\n\t//this.featureViewers = {};\r\n}\r\n\r\n/**\r\n * Functions for rendering / re-rendering the object as header and body components\r\n */\r\nHTMLObjectViewer.prototype.render = function(){\r\n\tif(this.renderedDOM){\r\n\t\tvar renderedDOM = this.getObjectDOM();\r\n\t\tthis.renderedDOM.replaceWith(renderedDOM);\r\n\t\tthis.renderedDOM = renderedDOM;\r\n\t}\r\n\telse {\r\n\t\tthis.renderedDOM = this.getObjectDOM();\r\n\t}\r\n\tthis.renderedDOM.appendChild(this.getObjectIDMarker(this.renderer));\r\n\tif(this.headerViewer){\r\n\t\tthis.header = this.headerViewer.getAsDOM(this.renderer);\r\n\t\tif(this.header) this.renderedDOM.appendChild(this.header);\r\n\t}\r\n\tthis.body = this.getObjectBodyDOM();\r\n\tif(this.body) this.renderedDOM.appendChild(this.body);\r\n\treturn this.renderedDOM;\r\n}\r\n\r\nHTMLObjectViewer.prototype.getObjectDOM = function(){\r\n\tvar orientation = this.renderer.getContentOrientation();\r\n\tvar pcls = \"terminus-object-frame-\" + orientation;\r\n\tif(orientation == \"page\"){\r\n\t\tvar sp = document.createElement(\"div\");\r\n\t}\r\n\telse {\r\n\t\tvar sp = document.createElement(\"span\");\r\n\t}\r\n\tvar css = \"terminus-object-frame \" + pcls + (this.renderer.parent ? \"\" : \" terminus-root-frame\") + \" terminus-object-frame-\" + this.renderer.mode;\r\n\tsp.setAttribute(\"class\", css);\r\n\tsp.setAttribute(\"data-class\", this.renderer.subjectClass());\r\n\tsp.setAttribute(\"data-id\", this.renderer.subject());\r\n\treturn sp;\r\n}\r\n\r\nHTMLObjectViewer.prototype.getObjectBodyDOM = function(){\r\n\tvar orientation = this.renderer.getContentOrientation();\r\n\tvar pcls = \"terminus-object-properties-\" + orientation;\r\n\tif(orientation == \"page\"){\r\n\t\tvar vholder = document.createElement(\"div\");\r\n\t}\r\n\telse {\r\n\t\tvar vholder = document.createElement(\"span\");\r\n\t}\r\n    vholder.setAttribute('class', 'terminus-object-properties ' + pcls);\r\n    for(var prop in this.properties){\r\n\t\tif(this.properties[prop]) vholder.appendChild(this.properties[prop]);\r\n\t}\r\n\treturn vholder;\r\n}\r\n\r\nHTMLObjectViewer.prototype.getFeatureDOM = function(feature){\r\n\tif(this.hasFeatureViewer(feature)){\r\n\t\treturn this.featureViewer[feature](this.renderer, this);\r\n\t}\r\n}\r\n\r\nHTMLObjectViewer.prototype.redraw = function(){\r\n\tTerminusClient.FrameHelper.removeChildren(this.renderedDOM);\r\n\tthis.properties = [];\r\n\tthis.renderer.render(this);\r\n}\r\n\r\nHTMLObjectViewer.prototype.redrawHeader = function(){\r\n\tif(this.headerViewer && this.header) {\r\n\t\tvar nheader = this.headerViewer.getAsDOM(this.renderer);\r\n\t\tthis.header.replaceWith(nheader);\r\n\t\tthis.header = nheader;\r\n\t}\r\n}\r\n\r\nHTMLObjectViewer.prototype.redrawBody = function(){\r\n\tif(this.body){\r\n\t\tvar nbody = this.getObjectBodyDOM();\r\n\t\tthis.body.replaceWith(nbody);\r\n\t\tthis.body = nbody;\r\n\t}\r\n}\r\n\r\n/**\r\n * Adds a rendered version of a property to the internal properties array\r\n */\r\nHTMLObjectViewer.prototype.addRenderedProperty = function(prop, renderedprop){\r\n\tthis.properties[prop] = renderedprop;\r\n}\r\n\r\nHTMLObjectViewer.prototype.clear = function(){\r\n\tTerminusClient.FrameHelper.removeChildren(this.renderedDOM);\r\n\tthis.properties = {};\r\n}\r\n\r\n/**\r\n * Removes the object from the dom\r\n */\r\nHTMLObjectViewer.prototype.remove = function(){\r\n\tthis.renderedDOM.parentNode.removeChild(this.renderedDOM);\r\n}\r\n\r\nHTMLObjectViewer.prototype.goTo = function(subj, property){\r\n\tHTMLFrameHelper.goToName(subj, property);\r\n}\r\n\r\n/**\r\n * Generates a html anchor element to use as a marker to find the object on the page\r\n */\r\nHTMLObjectViewer.prototype.getObjectIDMarker = function(renderer){\r\n\tvar idm = document.createElement(\"a\");\r\n\tidm.setAttribute(\"class\", \"terminus-object-idmarker\");\r\n\tvar sh = TerminusClient.FrameHelper.getShorthand(renderer.subject());\r\n    if(!sh) sh = renderer.subject();\r\n    if(sh){\r\n\t\tvar bits = sh.split(\":\");\r\n\t\tif(bits.length > 1) sh = bits[1];\r\n\t\tidm.setAttribute(\"name\", sh);\r\n    }\r\n\treturn idm;\r\n}\r\n\r\nfunction HTMLObjectHeaderViewer(){}\r\n\r\nHTMLObjectHeaderViewer.prototype.getAsDOM = function(renderer){\r\n\tvar orientation = renderer.getContentOrientation();\r\n\tvar pcls = \"terminus-object-frame-btn terminus-object-header-\" + orientation;\r\n\tif(orientation == \"page\"){\r\n\t\tvar objDOM = document.createElement(\"div\");\r\n\t}\r\n\telse {\r\n\t\tvar objDOM = document.createElement(\"span\");\r\n\t}\r\n\tobjDOM.setAttribute(\"class\", \"terminus-object-header \" + pcls);\r\n\tif(renderer.showFeature(\"facet\")){\r\n\t\tvar facetDOM = this.getObjectFacetDOM(renderer);\r\n\t\tif(facetDOM) objDOM.appendChild(facetDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"label\")){\r\n\t\tvar sumDOM = this.getObjectLabelDOM(renderer);\r\n\t\tif(sumDOM) objDOM.appendChild(sumDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"id\")){\r\n\t\tvar idDOM = this.getObjectIDDOM(renderer);\r\n\t\tif(idDOM) objDOM.appendChild(idDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"type\")){\r\n\t\tvar typeDOM = this.getObjectTypeDOM(renderer);\r\n\t\tif(typeDOM) objDOM.appendChild(typeDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"status\")){\r\n\t\tvar sumDOM = this.getObjectStatusDOM(renderer);\r\n\t\tif(sumDOM) objDOM.appendChild(sumDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"view\")){\r\n\t\tvar viewDOM = this.getViewPropertyDOM(renderer);\r\n\t\tif(viewDOM) objDOM.appendChild(viewDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"viewer\")){\r\n\t\tvar hideDOM = this.getViewerSelectorDOM(renderer);\r\n\t\tif(hideDOM) objDOM.appendChild(hideDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"control\")){\r\n\t\tvar controlsDOM = this.getObjectControlsDOM(renderer);\r\n\t\tif(controlsDOM) objDOM.appendChild(controlsDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"summary\")){\r\n\t\tvar controlsDOM = this.getObjectSummaryDOM(renderer);\r\n\t\tif(controlsDOM) objDOM.appendChild(controlsDOM);\r\n\t}\r\n\treturn objDOM;\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectSummaryDOM = function(renderer){\r\n\tvar sum = renderer.getSummary();\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"object-summary\", false, sum.long, sum.status);\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectControlsDOM = function(renderer){\r\n\tvar controlsDOM = document.createElement(\"span\");\r\n\tcontrolsDOM.setAttribute(\"class\", \"terminus-object-controls\");\r\n\tif(renderer.showFeature(\"add\")){\r\n\t\tvar addDOM = this.getAddPropertyDOM(renderer);\r\n\t\tif(addDOM) controlsDOM.appendChild(addDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"mode\")){\r\n\t\tvar viewsDOM = HTMLFrameHelper.getModeSelectorDOM(\"object\", renderer);\r\n\t\tif(viewsDOM) controlsDOM.appendChild(viewsDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"delete\")){\r\n\t\tvar dpropDOM = this.getObjectDeleteDOM(renderer);\r\n\t\tif(dpropDOM) controlsDOM.appendChild(dpropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"clone\")){\r\n\t\tvar cpropDOM = this.getObjectCloneDOM(renderer);\r\n\t\tif(cpropDOM) controlsDOM.appendChild(cpropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"reset\")){\r\n\t\tvar rpropDOM = this.getObjectResetDOM(renderer);\r\n\t\tif(rpropDOM) controlsDOM.appendChild(rpropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"update\")){\r\n\t\tvar upropDOM = this.getObjectUpdateDOM(renderer);\r\n\t\tif(upropDOM) controlsDOM.appendChild(upropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"show\")){\r\n\t\tvar showDOM = this.getObjectShowDOM(renderer);\r\n\t\tif(showDOM) controlsDOM.appendChild(showDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"hide\")){\r\n\t\tvar hideDOM = this.getObjectHideDOM(renderer);\r\n\t\tif(hideDOM) controlsDOM.appendChild(hideDOM);\r\n\t}\r\n\treturn controlsDOM;\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectFacetDOM = function(renderer){\r\n\tvar viewables = renderer.getAvailableFacets();\r\n\tvar self = this;\r\n\tif(viewables && viewables.length){\r\n\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-object-facet\");\r\n\t\tvar callback = function(val){\r\n\t\t\tif(val){\r\n\t\t\t\trenderer.setFacet(val);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"object-facet\", viewables, renderer.currentFacet(), callback);\r\n\t\tmpropDOM.appendChild(sel);\r\n\t\treturn mpropDOM;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectLabelDOM = function(renderer){\r\n\tvar lab = renderer.getLabel();\r\n\tif(lab){\r\n\t\treturn HTMLFrameHelper.getInfoboxDOM(\"object-label\", false, lab);\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectIDDOM = function(renderer){\r\n\tvar val = renderer.subject();\r\n\tvar input = false;\r\n\tif(renderer.mode == \"edit\" && renderer.isNewDocument()){\r\n\t\tif(renderer.idDOM) val = renderer.idDOM.value;\r\n\t\tinput = document.createElement(\"input\");\r\n\t\tinput.setAttribute(\"class\", \"terminus-object-id-input\");\r\n\t\tinput.required  = true;\r\n\t\tif(val == \"_:\") val = \"\";\r\n\t\trenderer.idDOM = input;\r\n\t}\r\n\telse {\r\n\t\tif(renderer.isNewDocument() && val == \"_:\") val = \"New Document\";\r\n\t}\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"object-id\", \"ID\", val, \"Every fragment of data is identified by a unique URL\", input);\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectTypeDOM = function(renderer){\r\n\tif(renderer.mode == \"edit\" && renderer.parent && renderer.parent.isClassChoice() && renderer.isNew()){\r\n\t\tvar cs = renderer.parent.getAvailableClassChoices();\r\n\t\tif(cs && cs.length){\r\n\t\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\t\tmpropDOM.setAttribute(\"class\", \"terminus-property-change-class\");\r\n\t\t\tvar mlabDOM = document.createElement(\"span\");\r\n\t\t\tmlabDOM.setAttribute(\"class\", \"terminus-property-change-label\");\r\n\t\t\tmlabDOM.appendChild(document.createTextNode(\"Type\"));\r\n\t\t\tmpropDOM.appendChild(mlabDOM);\r\n\t\t\tvar callback = function(cls){\r\n\t\t\t\tif(cls){\r\n\t\t\t\t\trenderer.changeClass(cls);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"change-class\", cs, renderer.subjectClass(), callback);\r\n\t\t\tmpropDOM.appendChild(sel);\r\n\t\t\treturn mpropDOM;\r\n\t\t}\r\n\t}\r\n\tvar cm = renderer.getClassMeta(renderer.subjectClass());\r\n\tvar lab = renderer.subjectClass();\r\n\tvar cmt = \"All objects have types, identified by a unique URL\";\r\n\tif(cm){\r\n\t\tlab = (cm.Label && cm.Label[\"@value\"] ? cm.Label[\"@value\"]: lab);\r\n\t\tcmt = (cm.Comment && cm.Comment[\"@value\"] ? renderer.subjectClass() + \" \" + cm.Comment[\"@value\"] : cmt);\r\n\t}\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"object-type\", \"Type\", lab, cmt);\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectStatusDOM = function(renderer){\r\n\tvar sum = renderer.getSummary();\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"status-\"+sum.status, false, sum.status, sum.status);\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getAddPropertyDOM = function(renderer){\r\n\tvar addables = renderer.getAddableProperties();\r\n\tif(addables && addables.length){\r\n\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-object-add-property\");\r\n\t\taddables.unshift({ value: \"\", label: \"Add New Property\"});\r\n\t\tvar callback = function(add){\r\n\t\t\tif(add){\r\n\t\t\t\trenderer.addNewProperty(add);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar disabled = (renderer.cardControlAllows(\"add\") ? false : \"Cardinality Rules Forbid Add\");\r\n\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"add-property\", addables, \"\", callback, disabled);\r\n\t\tmpropDOM.appendChild(sel);\r\n\t\treturn mpropDOM;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getViewPropertyDOM = function(renderer){\r\n\tvar viewables = renderer.getViewableProperties();\r\n\tvar self = this;\r\n\tif(viewables && viewables.length){\r\n\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-object-view-property\");\r\n\t\tviewables.unshift({ value: \"\", label: \"View Property\"});\r\n\t\tvar callback = function(add){\r\n\t\t\tif(add){\r\n\t\t\t\trenderer.goToProperty(add);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"view-property\", viewables, \"\", callback);\r\n\t\tmpropDOM.appendChild(sel);\r\n\t\treturn mpropDOM;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectDeleteDOM = function(renderer){\r\n\tvar callback = function(){renderer.delete()};\r\n\tvar disabled = (renderer.cardControlAllows(\"delete\") ? false : \"Cardinality Rules Forbid Delete\");\r\n\treturn HTMLFrameHelper.getActionControl(\"object\", \"delete\", \"Delete\", callback, disabled);\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectCloneDOM = function(renderer){\r\n\tvar callback = function(){renderer.clone()};\r\n\tvar disabled = (renderer.cardControlAllows(\"clone\") ? false : \"Cardinality Rules Forbid Clone\");\r\n\treturn HTMLFrameHelper.getActionControl(\"object\", \"clone\", \"Clone\", callback, disabled);\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectResetDOM = function(renderer){\r\n\tvar callback = function(){renderer.reset()};\r\n\tvar disabled = (renderer.isUpdated() ? false : \"Nothing to reset\");\r\n\treturn HTMLFrameHelper.getActionControl(\"object\", \"reset\", \"Reset\", callback, disabled);\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getViewerSelectorDOM = function(renderer){\r\n\tvar viewers = renderer.getAvailableViewers();\r\n\tif(viewers && viewers.length){\r\n\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-object-viewer\");\r\n\t\tvar callback = function(viewer){\r\n\t\t\tif(viewer){\r\n\t\t\t\trenderer.setViewer(viewer);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar selected = renderer.currentViewer();\r\n\t\tvar sel = HTMLFrameHelper.getSelectionControl('object-viewer', viewers, selected, callback);\r\n\t\tmpropDOM.appendChild(sel);\r\n\t\treturn mpropDOM;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectHideDOM = function(renderer){\r\n\tvar callback = function(){renderer.hide()};\r\n\treturn HTMLFrameHelper.getActionControl(\"object\", \"hide\", \"Hide\", callback);\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectShowDOM = function(renderer){\r\n\tvar callback = function(){renderer.show()};\r\n\treturn HTMLFrameHelper.getActionControl(\"object\", \"show\", \"Show\", callback);\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectUpdateDOM = function(renderer){\r\n\tvar dpropDOM = document.createElement(\"span\");\r\n\tdpropDOM.setAttribute(\"class\", \"terminus-object-update\");\r\n\tif(renderer.isNewDocument()){\r\n\t\tvar disabled = false;//(renderer.isUpdated() ? false : \"No changes\");\r\n\t}\r\n\telse {\r\n\t\tvar disabled = (renderer.isUpdated() ? false : \"No changes\");\r\n\t}\r\n\tvar saveback = function(){renderer.save()};\r\n\tdpropDOM.appendChild(HTMLFrameHelper.getActionControl(\"object\", \"save\", \"Save\", saveback, disabled));\r\n\treturn dpropDOM;\r\n}\r\n\r\nmodule.exports={HTMLObjectViewer,HTMLObjectHeaderViewer}\r\n","function HTMLStringViewer(options){\r\n\tthis.size = ((options && options.size) ? options.size : false);\r\n\tthis.css = ((options && options.css) ? \"terminus-literal-value \" + options.css : \"terminus-literal-value\");\r\n}\r\n\r\nHTMLStringViewer.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar value = renderer.value();\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', this.css);\r\n\tinput.setAttribute('data-value', value);\r\n\tvalue = document.createTextNode(value);\r\n\tinput.appendChild(value);\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={HTMLStringViewer}\r\n\r\n\r\n","function HTMLDateHelper(){\r\n\tthis.months = [\"January\", \"Februrary\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"];\r\n}\r\n\r\nHTMLDateHelper.prototype.getMonthName = function(num){\r\n\treturn this.months[num-1];\r\n}\r\n\r\nmodule.exports={HTMLDateHelper}","\r\nfunction GoogleMapHelper(options){\r\n\tthis.polygon = false;\r\n\tthis.polyline = false;\r\n\tthis.markers = [];\r\n\tthis.init(options);\r\n}\r\n\r\nGoogleMapHelper.prototype.init = function(config){\r\n\tthis.type = ((config && config.type) ? config.type: 'Shape'); \r\n\tthis.width = ((config && config.width) ? config.width : '400px'); \r\n\tthis.height = ((config && config.height ) ? config.height : '400px'); \r\n\tthis.mapLat = ((config && config.mapLat) ? config.mapLat : '41.9010004'); \r\n\tthis.mapLong = ((config && config.mapLong ) ? config.mapLong : '12.500061500000015');\r\n\tthis.zoom = ((config && config.zoom) ? config.zoom : 3);\r\n\tthis.stroke = ((config && config.stroke) ? config.stroke : { color: '#FF0000', opacity: 0.3, weight: 3});\r\n\tthis.fill = ((config && config.fill) ? config.fill : { color: '#FF0000', opacity: 0.1});\r\n\tthis.line = ((config && config.line) ? config.line : { color: '#000000', opacity: 0.9, weight: 3});\r\n}\r\n\r\nGoogleMapHelper.prototype.destroy = function(){\r\n    this.clear();\r\n} \r\n\r\nGoogleMapHelper.prototype.translatePolygonToArray = function(polygon){\r\n   var data = \"[\";\r\n   var vertices = polygon.getPath();\r\n   var seenValue = false;\r\n   for (var j=0; j<vertices.getLength(); j++){\r\n       if(seenValue){\r\n           data = data + \",\";\r\n       }\r\n       var xy = vertices.getAt(j);\r\n       data = data + \"[\" + xy.lat() + \",\" + xy.lng() + \"]\"\r\n       seenValue = true;\r\n   }\r\n   data = data + \"]\";\r\n   return data;\r\n};\r\n\r\nGoogleMapHelper.prototype.translateArrayToPolygon = function(array){\r\n   var jsonified = JSON.parse(array);\r\n   var output = [];\r\n   for(var i=0;i<jsonified.length;i++){\r\n       var latlong = {}\r\n       latlong.lat = jsonified[i][0];\r\n       latlong.lng = jsonified[i][1];\r\n       output.push(latlong);\r\n   }\r\n   return output;\r\n}\r\n\r\nGoogleMapHelper.prototype.createPolygon = function(coords, map) {\r\n\tvar polygon = new google.maps.Polygon({\r\n        paths: coords,\r\n        strokeColor: this.stroke.color,\r\n        strokeOpacity: this.stroke.opacity,\r\n        strokeWeight: this.stroke.weight,\r\n        fillColor: this.fill.color,\r\n        fillOpacity: this.fill.opacity\r\n\t});\r\n    polygon.setMap(map);\r\n\treturn polygon;\r\n}\r\n\r\nGoogleMapHelper.prototype.createPolyline = function(coords){\r\n\tvar init = {\r\n\t      strokeColor: this.line.color,\r\n\t      strokeOpacity: this.line.opacity,\r\n\t      strokeWeight: this.line.weight\r\n\t};\r\n\tif(coords){\r\n\t\tinit.paths = coords;\r\n\t}\r\n\tvar poly = new google.maps.Polyline(init);\r\n\treturn poly;\r\n}\r\n\r\nGoogleMapHelper.prototype.clearMarkers = function() {\r\n\tfor (var i = 0; i < this.markers.length; i++ ) {\r\n\t\tthis.markers[i].setMap(null);\r\n\t}\r\n\tthis.markers.length = 0;\r\n}\r\n\r\n\r\nGoogleMapHelper.prototype.addMarker = function(position, map, renderer, title, ty) {\r\n\tvar init = {\r\n\t\tposition: position, \r\n\t\tmap: map\r\n\t}\r\n\tif(title){\r\n\t\tinit.title = title;\r\n\t}\r\n\tvar marker = new google.maps.Marker(init);\r\n\tvar self = this;\r\n\tif(this.markers.length == 0 && ty == \"xdd:coordinatePolygon\"){\r\n     \tmarker.addListener('click', function() {\r\n\t\t\tvar coords = self.getCoordsFromMarkers();\r\n    \t\tself.polygon = self.createPolygon(coords, map);\r\n            self.clearMarkers();\r\n            self.polyline.setMap(null);\r\n            renderer.set(self.translatePolygonToArray(self.polygon));\r\n        });                \t\r\n    }\r\n\tthis.markers.push(marker);\r\n\tif(ty == \"xdd:coordinatePolyline\"){\r\n\t\tvar x = this.translatePolygonToArray(this.polyline);\r\n\t\trenderer.set(x);\r\n\t}\r\n\treturn marker;\r\n}\r\n\r\nGoogleMapHelper.prototype.getCoordsFromMarkers = function(){\r\n\treturn this.polyline.getPath();\r\n}\r\n\r\nGoogleMapHelper.prototype.clear = function(){\r\n\tif(this.polygon) {\r\n\t\tthis.polygon.setMap(null);\r\n\t\tthis.polygon = false;\r\n\t}\r\n\tif(this.polyline) {\r\n\t\tthis.clearMarkers();\r\n\t\tthis.polyline.setMap(null);\r\n\t}\r\n}\r\n\r\nGoogleMapHelper.prototype.initMap = function(mapContainer, renderer, value, type){\r\n\tmapContainer.style.width = this.width;\r\n\tmapContainer.style.height = this.height;\r\n\tif(typeof google == \"undefined\"){\r\n\t\talert(\"google is not effing loaded\");\r\n\t\treturn false;\r\n\t}\r\n\tvar map = new google.maps.Map(mapContainer, {\r\n\t    zoom: this.zoom,\r\n\t\tcenter: {lat: parseFloat(this.mapLat), lng: parseFloat(this.mapLong)}  \r\n\t});\r\n\tif(type == \"xdd:coordinatePolygon\"){\r\n\t    this.polyline = this.createPolyline();\r\n\t\tthis.polyline.setMap(map);\r\n\t\tvar coords = (value ? this.translateArrayToPolygon(value) : []);\r\n\t\tif(value){\r\n\t    \tthis.polygon = this.createPolygon(coords, map);\r\n\t    }\r\n\t}\r\n\telse if(type == \"xdd:coordinatePolyline\"){\r\n\t\tvar coords = (value ? this.translateArrayToPolygon(value) : []);\r\n\t    this.polyline = this.createPolyline();\r\n\t\tthis.polyline.setMap(map);\t\t\r\n\t\tif(value){\r\n\t    \tthis.polyline.setPath(coords);\r\n\t    }\r\n\t}\t\r\n\telse if(type == \"xdd:coordinate\"){\r\n\t\tif(value){\r\n\t\t\tthis.clearMarkers();\r\n            var lat = parseFloat(value.substring(1, value.indexOf(\",\")));\r\n\t\t\tvar long = parseFloat(value.substring(value.indexOf(\",\")+1, value.length-1));\r\n            var init = {\r\n            \tposition: {lat: lat, lng: long},\r\n        \t\tmap: map\r\n\t        }\r\n\t        var marker = new google.maps.Marker(init);\r\n\t        this.markers.push(marker);\r\n\t\t}\r\n\t}\r\n    google.maps.event.trigger(map, 'resize');\r\n    return map;\r\n}\r\n\r\nmodule.exports=GoogleMapHelper;","//const FrameHelper = require('../FrameHelper');\r\nconst HTMLFrameHelper = require('./HTMLFrameHelper');\r\n\r\n/**\r\n * Property Viewer\r\n */\r\nfunction HTMLPropertyViewer(renderer){\r\n\tthis.renderer = renderer;\r\n\tthis.values = [];\r\n\tthis.headerViewer = renderer.getPropertyHeaderViewer();\r\n}\r\n\r\n\r\n/**\r\n * Draws the property as header and body components\r\n */\r\nHTMLPropertyViewer.prototype.render = function(){\r\n\tvar block = document.createElement('div');\r\n\tblock.setAttribute('style', 'display: flex; margin: 10px');\r\n\tvar br = document.createElement('br');\r\n\tblock.appendChild(br);\r\n\tif(this.propDOM){\r\n\t\tvar npropDOM = this.getPropertyDOM();\r\n\t\tnpropDOM.setAttribute('style', 'display: flex; margin: 10px;');\r\n\t\t\t//block.appendChild(npropDOM);\r\n\t\tthis.propDOM.replaceWith(npropDOM);\r\n\t\tthis.propDOM = npropDOM;\r\n\t\t//this.propDOM = block;\r\n\t}\r\n\telse {\r\n\t\t//block.appendChild(this.getPropertyDOM());\r\n\t\t//this.propDOM = block;\r\n\t\tthis.propDOM = this.getPropertyDOM();\r\n\t\tthis.propDOM.setAttribute('style', 'display: flex; margin: 10px;');\r\n\t}\r\n\tthis.propDOM.appendChild(this.getPropertyIDMarker(this.renderer));\r\n\tif(this.headerViewer){\r\n\t\tthis.header = this.headerViewer.getAsDOM(this.renderer);\r\n\t\tif(this.header) this.propDOM.appendChild(this.header);\r\n\t}\r\n\tthis.body = this.getPropertyBodyDOM();\r\n\tif(this.body) this.propDOM.appendChild(this.body);\r\n\treturn this.propDOM;\r\n}\r\n\r\nHTMLPropertyViewer.prototype.getPropertyDOM = function(){\r\n\tvar orientation = this.renderer.getContentOrientation();\r\n\tvar pcls = \" terminus-property-frame-display terminus-property-frame-\" + orientation;\r\n\tif(orientation == \"label\"){\r\n\t\tvar sp = document.createElement(\"span\");\r\n\t}\r\n\telse {\r\n\t\tvar sp = document.createElement(\"div\");\r\n\t}\r\n\t//terminus-property-frame-spacer\r\n\r\n\tsp.setAttribute(\"class\", \"terminus-property-frame terminus-zebra-frame \"+ sp + \" terminus-property-frame-\" + this.renderer.mode + \" \" + pcls);\r\n\tsp.setAttribute('data-property', this.renderer.property());\r\n\treturn sp;\r\n}\r\n\r\nHTMLPropertyViewer.prototype.getPropertyBodyDOM = function(){\r\n\tvar orientation = this.renderer.getContentOrientation();\r\n\tvar pcls = \"terminus-property-values-\" + orientation;\r\n\tif(orientation == \"page\"){\r\n\t\tvar vholder = document.createElement(\"div\");\r\n\t}\r\n\telse {\r\n\t\tvar vholder = document.createElement(\"span\");\r\n\t}\r\n    vholder.setAttribute('class', 'terminus-property-values ' + pcls + ' terminus-property-values-align');\r\n\tfor(var i =0; i<this.values.length; i++){\r\n\t\tvholder.appendChild(this.values[i]);\r\n\t}\r\n\treturn vholder;\r\n}\r\n\r\nHTMLPropertyViewer.prototype.addRenderedValue = function(renderedval){\r\n\tthis.values.push(renderedval);\r\n}\r\n\r\nHTMLPropertyViewer.prototype.clear = function(){\r\n\tTerminusClient.FrameHelper.removeChildren(this.propDOM);\r\n\tthis.values = [];\r\n}\r\n\r\n\r\n/**\r\n * Removes the property from the dom\r\n */\r\nHTMLPropertyViewer.prototype.remove = function(){\r\n\tthis.propDOM.parentNode.removeChild(this.propDOM);\r\n}\r\n\r\n/**\r\n * Redraws the property to reflect an updated state\r\n */\r\nHTMLPropertyViewer.prototype.redraw = function(){\r\n\tvar npropDOM = this.getPropertyDOM();\r\n\tthis.propDOM.replaceWith(npropDOM);\r\n\tthis.propDOM = npropDOM;\r\n\tthis.values = [];\r\n\tthis.renderer.render(this);\r\n}\r\n\r\nHTMLPropertyViewer.prototype.redrawHeader = function(){\r\n\tif(this.headerViewer && this.header) {\r\n\t\tvar nheader = this.headerViewer.getAsDOM(this.renderer);\r\n\t\tthis.header.replaceWith(nheader);\r\n\t\tthis.header = nheader;\r\n\t}\r\n}\r\n\r\nHTMLPropertyViewer.prototype.redrawBody = function(){\r\n\tif(this.body){\r\n\t\tvar nbody = this.getPropertyBodyDOM();\r\n\t\tthis.body.replaceWith(nbody);\r\n\t\tthis.body = nbody;\r\n\t}\r\n}\r\n\r\n/**\r\n * Generates a html anchor element to use as a marker to find the property on the page\r\n */\r\nHTMLPropertyViewer.prototype.getPropertyIDMarker = function(renderer){\r\n\tvar idm = document.createElement(\"a\");\r\n\tidm.setAttribute(\"class\", \"terminus-property-idmarker\");\r\n\tvar subj = TerminusClient.FrameHelper.getShorthand(renderer.subject());\r\n\tif(!subj ) subj = renderer.subject();\r\n\tvar bits = subj .split(\":\");\r\n\tif(bits.length > 1) subj = bits[1];\r\n\tvar prop = TerminusClient.FrameHelper.getShorthand(renderer.property());\r\n\tif(!prop ) prop = renderer.property();\r\n\tvar bits = prop.split(\":\");\r\n\tif(bits.length > 1) prop = bits[1];\r\n\tidm.setAttribute(\"name\", subj + \"_\" + prop);\r\n\treturn idm;\r\n}\r\n\r\nHTMLPropertyViewer.prototype.goTo = function(subj, property, index){\r\n\tHTMLFrameHelper.goToName(subj, property, index);\r\n}\r\n\r\nfunction HTMLPropertyHeaderViewer(){}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getAsDOM = function(renderer){\r\n\tvar orientation = renderer.getContentOrientation();\r\n\tvar pcls = \"terminus-property-header-\" + orientation;\r\n\tif(orientation == \"page\"){\r\n\t\tvar objDOM = document.createElement(\"div\");\r\n\t}\r\n\telse {\r\n\t\tvar objDOM = document.createElement(\"span\");\r\n\t}\r\n\tobjDOM.setAttribute(\"class\", \"terminus-text terminus-property-header \" + pcls);\r\n\tvar wrapper = document.createElement(\"span\");\r\n\twrapper.setAttribute(\"class\", \"terminus-property-header-wrapper\");\r\n\tif(renderer.showFeature(\"control\")){\r\n\t\tvar expModeMenu = this.getPropertyControlsDOM(wrapper, renderer);\r\n\t\tif(orientation == 'page') this.expModeMenu = expModeMenu;\r\n\t\telse this.expModeMenu = null;\r\n\t}\r\n\tif(renderer.showFeature(\"label\")){\r\n\t\tvar sumDOM = this.getPropertyLabelDOM(renderer);\r\n\t\tif(renderer.showFeature(\"status\")){\r\n\t\t\tvar statDOM = this.getPropertyStatusDOM(renderer);\r\n\t\t\tif(statDOM) sumDOM.prepend(statDOM);\r\n\t\t}\r\n\t\tif(sumDOM) wrapper.appendChild(sumDOM);\r\n\t}\r\n\telse if(renderer.showFeature(\"status\")){\r\n\t\tvar statDOM = this.getPropertyStatusDOM(renderer);\r\n\t\tif(statDOM) wrapper.appendChild(statDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"summary\")){\r\n\t\tvar sumDOM = this.getPropertySummaryDOM(renderer);\r\n\t\tif(sumDOM) wrapper.appendChild(sumDOM);\r\n\t}\r\n\r\n\tvar prelude = document.createElement(\"span\");\r\n\tprelude.setAttribute(\"class\", \"terminus-property-header-info terminus-property-header-info-\"+renderer.currentFacet());\r\n\r\n\tif(renderer.showFeature(\"facet\")){\r\n\t\tvar facetDOM = this.getPropertyFacetDOM(renderer);\r\n\t\tif(facetDOM) prelude.appendChild(facetDOM);\r\n\t\t//if(facetDOM && this.expModeMenu) this.expModeMenu.appendChild(facetDOM);//\r\n\t}\r\n\tif(renderer.showFeature(\"view\")){\r\n\t\tvar viewDOM = this.getViewValueDOM(renderer);\r\n\t\tif(viewDOM) prelude.appendChild(viewDOM);\r\n\t\t//if(viewDOM && this.expModeMenu) this.expModeMenu.appendChild(viewDOM); //prelude.appendChild(viewDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"id\")){\r\n\t\tvar idDOM = this.getPropertyIDDOM(renderer);\r\n\t\tif(idDOM) prelude.appendChild(idDOM);\r\n\t\t//if(idDOM && this.expModeMenu) this.expModeMenu.appendChild(idDOM); //\r\n\t}\r\n\tif(renderer.showFeature(\"type\")){\r\n\t\tvar typeDOM = this.getPropertyRangeDOM(renderer);\r\n\t\tif(typeDOM)\tprelude.appendChild(typeDOM);\r\n\t\t/*if(typeDOM && this.expModeMenu){\r\n\t\t\tthis.expModeMenu.appendChild(typeDOM);//\r\n\t\t\ttypeDOM.style.display = 'block';\r\n\t\t}*/\r\n\t}\r\n\tif(renderer.showFeature(\"cardinality\") && renderer.hasCardinalityRestriction()){\r\n\t\tvar hideDOM = this.getPropertyCardinalityDOM(renderer);\r\n\t\tif(hideDOM) prelude.appendChild(hideDOM);\r\n\t\t//\tthis.expModeMenu.appendChild(hideDOM); \t\t\thideDOM.style.display = 'block';\r\n\r\n\t}\r\n\tif(renderer.showFeature(\"comment\")){\r\n\t\tvar sumDOM = this.getPropertyCommentDOM(renderer);\r\n\t\tif(sumDOM) prelude.appendChild(sumDOM);\r\n\t\t/*if(sumDOM && this.expModeMenu){\r\n\t\t\tthis.expModeMenu.appendChild(sumDOM); //\r\n\t\t\tsumDOM.style.display = 'block';\r\n\t\t}*/\r\n\t}\r\n\twrapper.appendChild(prelude);\r\n\tobjDOM.appendChild(wrapper);\r\n\treturn objDOM;\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyFacetDOM = function(renderer){\r\n\tvar viewables = renderer.getAvailableFacets();\r\n\tvar self = this;\r\n\tif(viewables && viewables.length){\r\n\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-property-facet\");\r\n\t\tvar callback = function(val){\r\n\t\t\tif(val){\r\n\t\t\t\trenderer.setFacet(val);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"property-facet\", viewables, renderer.currentFacet(), callback);\r\n\t\tmpropDOM.appendChild(sel);\r\n\t\treturn mpropDOM;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyIDDOM = function(renderer){\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"property-id\", \"Property\", renderer.property(), \"This property is identified by this unique URL: \" + renderer.property());\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyRangeDOM = function(renderer){\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"property-type\", \"Type\", renderer.range(), \"The type of arguments that this property accepts\");\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertySummaryDOM = function(renderer){\r\n\tvar sum = renderer.getSummary();\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"property-summary\", false, sum.long, sum.status);\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyStatusDOM = function(renderer){\r\n\tvar sum = renderer.getSummary();\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"status-\"+sum.status, false, sum.status, sum.status);\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyLabelDOM = function(renderer){\r\n\tvar lab = renderer.getLabel();\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"property-label\", false, lab);\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyCommentDOM = function(renderer){\r\n\tvar lab = renderer.getComment();\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"property-comment\", false, lab);\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyCardinalityDOM = function(renderer){\r\n\tvar restriction = renderer.getRestriction();\r\n\tif(restriction.min && restriction.max){\r\n\t\tif(restriction.min == restriction.max){\r\n\t\t\tvar lab = restriction.min;\r\n\t\t\tvar help = \"Cardinality: \" + restriction.min;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tvar lab = restriction.min + \"-\" + restriction.max;\r\n\t\t\tvar help = \"Minimum Cardinality: \" + restriction.min;\r\n\t\t\thelp += \", Maximum Cardinality: \" + restriction.max;\r\n\t\t}\r\n\t}\r\n\telse if(restriction.min){\r\n\t\tvar lab = \">\"+(restriction.min-1);\r\n\t\tvar help = \"Minimum Cardinality: \" + restriction.min;\r\n\t}\r\n\telse if(restriction.max){\r\n\t\tvar lab = \"<\"+(restriction.max+1);\r\n\t\tvar help = \"Maximum Cardinality: \" + restriction.max;\r\n\t}\r\n\telse {\r\n\t\treturn false;\r\n\t}\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"property-cardinality\", \"Cardinality\", lab, help);\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getActionControlDOM = function(settingsDOM, renderer){\r\n\tif(renderer.showFeature(\"mode\")){\r\n\t\tvar viewsDOM = HTMLFrameHelper.getModeSelectorDOM(\"property\", renderer);\r\n\t\tif (viewsDOM) settingsDOM.appendChild(viewsDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"delete\")){\r\n\t\tvar dpropDOM = this.getPropertyDeleteDOM(renderer);\r\n\t\tif (dpropDOM) settingsDOM.appendChild(dpropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"add\") && !renderer.isClassChoice()){\r\n\t\tvar addDOM = this.getAddValueDOM(renderer);\r\n\t\tif(addDOM) settingsDOM.appendChild(addDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"reset\")){\r\n\t\tvar rpropDOM = this.getPropertyResetDOM(renderer);\r\n\t\tif(rpropDOM) settingsDOM.appendChild(rpropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"update\")){\r\n\t\tvar upropDOM = this.getPropertyUpdateDOM(renderer);\r\n\t\tif(upropDOM) settingsDOM.appendChild(upropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"show\")){\r\n\t\tvar showDOM = this.getPropertyShowDOM(renderer);\r\n\t\tif(showDOM) settingsDOM.appendChild(showDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"hide\")){\r\n\t\tvar hideDOM = this.getPropertyHideDOM(renderer);\r\n\t\tif(hideDOM) settingsDOM.appendChild(hideDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"viewer\")){\r\n\t\tvar hideDOM = this.getViewerSelectorDOM(renderer);\r\n\t\tif(hideDOM) settingsDOM.appendChild(hideDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"add\") && renderer.isClassChoice()){\r\n\t\tvar addDOM = this.getAddValueDOM(renderer);\r\n\t\tif(addDOM) settingsDOM.appendChild(addDOM);\r\n\t}\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getSettingsControlDOM = function(controlsDOM, renderer){\r\n\tvar settings = document.createElement(\"div\");\r\n\tcontrolsDOM.appendChild(settings);\r\n\tvar orientation = renderer.getContentOrientation();\r\n\tif(false && orientation == 'page'){ // expert mode\r\n\t\tvar sControl = HTMLFrameHelper.getSettingsControl('property');\r\n\t\tvar menu = document.createElement('div');\r\n\t\tmenu.setAttribute('class', 'terminus-hide terminus-popup');\r\n\t\tmenu.appendChild(document.createTextNode('Edit property'));\r\n\t\tmenu.appendChild(document.createElement('BR'));\r\n\t\tsControl.appendChild(menu);\r\n\t\tsControl.addEventListener('click', function(e){\r\n\t\t\tvar target = e.target || e.srcElement,\r\n        \ttext = target.textContent || target.innerText;\r\n\t\t\tif((target.nodeName == 'ICON') || (target.nodeName == 'BUTTON')){\r\n\t\t\t\tif(this.children[0].style.display == 'none') this.children[0].style.display = 'block';\r\n\t\t\t\telse this.children[0].style.display = 'none';\r\n\t\t\t}\r\n\t\t});\r\n\t\tthis.getActionControlDOM(menu, renderer);\r\n\t    settings.appendChild(sControl);\r\n\t\treturn menu;\r\n\t}\r\n\telse this.getActionControlDOM(controlsDOM, renderer);\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyControlsDOM = function(wrapper, renderer){\r\n\tvar controlsDOM = document.createElement(\"span\");\r\n\tcontrolsDOM.setAttribute(\"class\", \"terminus-property-controls\");\r\n\t//controlsDOM.setAttribute(\"style\", \"display: table-cell;\");\r\n\t// get settings icon or button\r\n\tvar expModeMenu = this.getSettingsControlDOM(controlsDOM, renderer);\r\n\twrapper.appendChild(controlsDOM);\r\n\treturn expModeMenu;\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getAddValueDOM = function(renderer){\r\n\tif(renderer.isClassChoice()){\r\n\t\tvar cs = renderer.getAvailableClassChoices();\r\n\t\tif(cs && cs.length){\r\n\t\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\t\tmpropDOM.setAttribute(\"class\", \"terminus-property-add-class\");\r\n\t\t\tcs.unshift({ value: \"\", label: \"Add Type\"});\r\n\t\t\tvar callback = function(cls){\r\n\t\t\t\tif(cls){\r\n\t\t\t\t\trenderer.addClass(cls);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"add-property\", cs, \"\", callback);\r\n\t\t\tmpropDOM.appendChild(sel);\r\n\t\t\treturn mpropDOM;\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tvar callback = function(){renderer.add(\"edit\")};\r\n\t\tvar disabled = (renderer.cardControlAllows(\"add\") ? false : \"Cardinality Rules Forbid Add\");\r\n\t\treturn HTMLFrameHelper.getActionControl(\"property\", \"add\", \"Add\", callback, disabled);\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getViewValueDOM = function(renderer){\r\n\tvar viewables = renderer.getViewableValues();\r\n\tvar self = this;\r\n\tif(viewables && viewables.length){\r\n\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-property-view-value\");\r\n\t\tviewables.unshift({ value: \"\", label: \"View Value\"});\r\n\t\tvar callback = function(val){\r\n\t\t\trenderer.goToValue(val);\r\n\t\t}\r\n\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"view-values\", viewables, \"\", callback);\r\n\t\tmpropDOM.appendChild(sel);\r\n\t\treturn mpropDOM;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyDeleteDOM = function(renderer){\r\n\tvar callback = function(){renderer.delete()};\r\n\tvar disabled = (renderer.cardControlAllows(\"delete\") ? false : \"Cardinality Rules Forbid Delete\");\r\n\treturn HTMLFrameHelper.getActionControl(\"property\", \"delete\", \"Delete\", callback, disabled);\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyHideDOM = function(renderer){\r\n\tvar callback = function(){renderer.hide()};\r\n\treturn HTMLFrameHelper.getActionControl(\"property\", \"hide\", \"Hide\", callback);\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyResetDOM = function(renderer){\r\n\tvar callback = function(){renderer.reset()};\r\n\tvar disabled = (renderer.isUpdated() ? false : \"Nothing to reset\");\r\n\treturn HTMLFrameHelper.getActionControl(\"property\", \"reset\", \"Reset\", callback, disabled);\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyShowDOM = function(renderer){\r\n\tvar callback = function(){renderer.show()};\r\n\treturn HTMLFrameHelper.getActionControl(\"property\", \"show\", \"Show\", callback);\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyUpdateDOM = function(renderer){\r\n\tvar dpropDOM = document.createElement(\"span\");\r\n\tdpropDOM.setAttribute(\"class\", \"terminus-property-update\");\r\n\tvar disabled = (renderer.isUpdated() ? false : \"No Change\");\r\n\tvar saveback = function(){renderer.save()};\r\n\tdpropDOM.appendChild(HTMLFrameHelper.getActionControl(\"property\", \"save\", \"Save\", saveback, disabled));\r\n\treturn dpropDOM;\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getViewerSelectorDOM = function(renderer){\r\n\tvar viewers = renderer.getAvailableViewers();\r\n\tif(viewers && viewers.length){\r\n\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-property-viewer\");\r\n\t\tvar callback = function(viewer){\r\n\t\t\tif(viewer){\r\n\t\t\t\trenderer.setViewer(viewer);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar selected = renderer.currentViewer();\r\n\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"property-viewers\", viewers, selected, callback);\r\n\t\tmpropDOM.appendChild(sel);\r\n\t\treturn mpropDOM;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.showValue = function(renderer, index){\r\n\tvar htmlid = renderer.subject() + \"->\" + renderer.property() + \"_\" + index;\r\n\twindow.location = (\"\"+window.location).replace(/#[A-Za-z0-9_]*$/,'') + \"#\" + htmlid;\r\n}\r\n\r\nfunction HTMLDataViewer(renderer){\r\n\tthis.renderer = renderer;\r\n\tthis.headerViewer = renderer.getValueHeaderViewer();\r\n}\r\n\r\nmodule.exports={HTMLPropertyViewer,HTMLPropertyHeaderViewer}\r\n","/**\r\n * Draws the property as header and body components\r\n */\r\nconst HTMLFrameHelper = require('./HTMLFrameHelper');\r\nconst HTMLStringViewer = require('./viewers/String');\r\n\r\nfunction HTMLDataViewer(renderer){\r\n\tthis.renderer = renderer;\r\n\tthis.headerViewer = renderer.getValueHeaderViewer();\r\n}\r\n\r\nHTMLDataViewer.prototype.render = function(){\r\n\tif(this.valDOM){\r\n\t\tvar nvalDOM = this.getValueDOM();\r\n\t\tthis.valDOM.replaceWith(nvalDOM);\r\n\t\tthis.valDOM = nvalDOM;\r\n\t}\r\n\telse {\r\n\t\tthis.valDOM = this.getValueDOM();\r\n\t}\r\n\tthis.valDOM.appendChild(this.getValueIDMarker(this.renderer));\r\n\tthis.body = this.getValueBodyDOM();\r\n\tif(this.body) this.valDOM.appendChild(this.body);\r\n\tif(this.headerViewer){\r\n\t\tthis.header = this.headerViewer.getAsDOM(this.renderer);\r\n\t\tif(this.renderer.facet == 'page'){ //expert mode\r\n\t\t\tif(this.header && this.expModeMenu) {\r\n\t\t\t\tthis.expModeMenu.appendChild(this.header);\r\n\t\t\t\t//this.valDOM.appendChild(this.expModeMenu);\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if(this.header) this.valDOM.appendChild(this.header);\r\n\t}\r\n\treturn this.valDOM;\r\n}\r\n\r\nHTMLDataViewer.prototype.getValueDOM = function(){\r\n\tif(this.renderer.currentFacet() == \"page\"){\r\n\t\tvar sp = document.createElement(\"div\");\r\n\t}\r\n\telse {\r\n\t\tvar sp = document.createElement(\"span\");\r\n\t}\r\n\tsp.setAttribute(\"class\", \"terminus-property-value property-value-\" + this.renderer.currentFacet() + \" property-value-\" + this.renderer.mode);\r\n\tif(this.renderer.mode == \"view\"){\r\n\t\tsp.setAttribute('data-value', this.renderer.value());\r\n\t}\r\n\treturn sp;\r\n}\r\n\r\nHTMLDataViewer.prototype.getValueBodyDOM = function(){\r\n\tif(this.renderer.currentFacet() == \"page\"){\r\n\t\tvar vholder = document.createElement(\"div\");\r\n\t}\r\n\telse {\r\n\t\tvar vholder = document.createElement(\"span\");\r\n\t}\r\n    vholder.setAttribute('class', ' terminus-property-body property-value-body property-value-body-'+this.renderer.currentFacet() + ' terminus-property-body-align');\r\n\tvholder.setAttribute('style', 'display: flex;');\r\n\tif(this.renderer.showFeature(\"body\")){\r\n        var valueViewer = this.renderer.getDataValueViewer();\r\n    \tvar vdom = valueViewer.getDOM(this.renderer, this);\r\n    }\r\n    else if(this.renderer.showFeature(\"summary\")){\r\n\t\tvar vdom = this.getSummaryDOM();\r\n    }\r\n    else {\r\n    \treturn false;\r\n    }\r\n    if(vdom) vholder.appendChild(vdom);\r\n\tif(false && this.renderer.currentFacet() == \"page\"){\r\n\t\tvar sControl = HTMLFrameHelper.getSettingsControl('data');\r\n\t\tvar menu = document.createElement('div');\r\n\t\tmenu.setAttribute('class', 'terminus-hide terminus-popup');\r\n\t\tmenu.appendChild(document.createTextNode('Edit property value'));\r\n\t\tmenu.appendChild(document.createElement('BR'));\r\n\t\tsControl.appendChild(menu);\r\n\t\tsControl.addEventListener('click', function(e){\r\n\t\t\tvar target = e.target || e.srcElement,\r\n\t\t\ttext = target.textContent || target.innerText;\r\n\t\t\tif((target.nodeName == 'ICON') || (target.nodeName == 'BUTTON')){\r\n\t\t\t\tif(this.children[0].style.display == 'none') this.children[0].style.display = 'block';\r\n\t\t\t\telse this.children[0].style.display = 'none';\r\n\t\t\t}\r\n\t\t});\r\n\t\tthis.expModeMenu = menu;\r\n\t\tvholder.appendChild(sControl);\r\n\t}\r\n\treturn vholder;\r\n}\r\n\r\n/**\r\n * Removes the value from the dom\r\n */\r\nHTMLDataViewer.prototype.remove = function(){\r\n\tthis.valDOM.parentNode.removeChild(this.valDOM);\r\n}\r\n\r\nHTMLDataViewer.prototype.redrawHeader = function(){\r\n\tif(this.headerViewer && this.header) {\r\n\t\tvar nheader = this.headerViewer.getAsDOM(this.renderer);\r\n\t\tthis.header.replaceWith(nheader);\r\n\t\tthis.header = nheader;\r\n\t}\r\n}\r\n\r\nHTMLDataViewer.prototype.redrawBody = function(){\r\n\tif(this.body){\r\n\t\tvar nbody = this.getValueBodyDOM();\r\n\t\tthis.body.replaceWith(nbody);\r\n\t\tthis.body = nbody;\r\n\t}\r\n}\r\n\r\n/**\r\n * Generates a html anchor element to use as a marker to find the property on the page\r\n */\r\nHTMLDataViewer.prototype.getValueIDMarker = function(renderer){\r\n\tvar idm = document.createElement(\"a\");\r\n\tidm.setAttribute(\"class\", \"terminus-value-idmarker\");\r\n\tvar subj = TerminusClient.FrameHelper.getShorthand(renderer.subject());\r\n\tif(!subj ) subj = renderer.subject();\r\n\tvar bits = subj .split(\":\");\r\n\tif(bits.length > 1) subj = bits[1];\r\n\tvar prop = TerminusClient.FrameHelper.getShorthand(renderer.property());\r\n\tif(!prop ) prop = renderer.property();\r\n\tvar bits = prop.split(\":\");\r\n\tif(bits.length > 1) prop = bits[1];\r\n\tidm.setAttribute(\"name\", subj + \"_\" + prop + \"_\" + renderer.index);\r\n\treturn idm;\r\n}\r\n\r\nHTMLDataViewer.prototype.getSummaryDOM = function(){\r\n\tvar sum = this.renderer.getSummary();\r\n\treturn HTMLTerminusClient.FrameHelper.getInfoboxDOM(\"value-summary\", false, sum.long, sum.long);\r\n}\r\n\r\nHTMLDataViewer.prototype.internalLink = function(link, label){\r\n\tvar self = this;\r\n\r\n\tvar onclick = function(e){\r\n\t\te.preventDefault();\r\n\t\tself.renderer.load(link);\r\n\t}\r\n\tvar a = document.createElement(\"a\");\r\n\ta.onClick = onclick;\r\n\ta.href=\"\";\r\n\ta.addEventListener(\"click\", onclick);\r\n\tif(label){\r\n\t\ta.appendChild(document.createTextNode(label));\r\n\t}\r\n\telse {\r\n\t\tvar sh = TerminusClient.FrameHelper.getShorthand(link);\r\n\t\tif(sh){\r\n\t\t\ta.setAttribute(\"title\", link);\r\n\t\t\ta.appendChild(document.createTextNode(sh));\r\n\t\t}\r\n\t\telse {\r\n\t\t\ta.appendChild(document.createTextNode(link));\r\n\t\t}\r\n\t}\r\n\treturn a;\r\n}\r\n\r\nHTMLDataViewer.prototype.clear = function(){\r\n\tTerminusClient.FrameHelper.removeChildren(this.valDOM);\r\n}\r\n\r\n\r\nfunction HTMLDataHeaderViewer(){}\r\n\r\nHTMLDataHeaderViewer.prototype.getAsDOM = function(renderer){\r\n\tif(renderer.currentFacet() == \"page\"){\r\n\t\tvar objDOM = document.createElement(\"div\");\r\n\t}\r\n\telse {\r\n\t\tvar objDOM = document.createElement(\"span\");\r\n\t}\r\n\tobjDOM.setAttribute(\"class\", \"terminus-value-header terminus-value-header-\" + renderer.currentFacet());\r\n\tif(renderer.showFeature(\"facet\")){\r\n\t\tvar facetDOM = this.getValueFacetDOM(renderer);\r\n\t\tif(facetDOM) objDOM.appendChild(facetDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"viewer\")){\r\n\t\tvar hideDOM = this.getViewerSelectorDOM(renderer);\r\n\t\tif(hideDOM) objDOM.appendChild(hideDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"type\")){\r\n\t\tvar typeDOM = this.getValueTypeDOM(renderer);\r\n\t\tif(typeDOM) objDOM.appendChild(typeDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"status\")){\r\n\t\tvar sumDOM = this.getValueStatusDOM(renderer);\r\n\t\tif(sumDOM) objDOM.appendChild(sumDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"control\")){\r\n\t\tvar controlsDOM = this.getValueControlsDOM(renderer);\r\n\t\tif(controlsDOM) objDOM.appendChild(controlsDOM);\r\n\t}\r\n\treturn objDOM;\r\n}\r\n\r\nHTMLDataHeaderViewer.prototype.getValueFacetDOM = function(renderer){\r\n\tvar viewables = renderer.getAvailableFacets();\r\n\tvar self = this;\r\n\tif(viewables && viewables.length){\r\n\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-value-facet\");\r\n\t\tvar callback = function(val){\r\n\t\t\tif(val){\r\n\t\t\t\trenderer.setFacet(val);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"value-facet\", viewables, renderer.currentFacet(), callback);\r\n\t\tmpropDOM.appendChild(sel);\r\n\t\treturn mpropDOM;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\n\r\nHTMLDataHeaderViewer.prototype.getValueTypeDOM = function(renderer){\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"value-type\", \"Type\", renderer.type(), \"All data values have types, identified by a unique URL\");\r\n}\r\n\r\nHTMLDataHeaderViewer.prototype.getValueStatusDOM = function(renderer){\r\n\tvar sum = renderer.getSummary();\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"status-\"+sum.status, false, sum.status, sum.status);\r\n}\r\n\r\n\r\nHTMLDataHeaderViewer.prototype.getValueControlsDOM = function(renderer){\r\n\tvar controlsDOM = document.createElement(\"span\");\r\n\tcontrolsDOM.setAttribute(\"class\", \"terminus-value-controls\");\r\n\tif(renderer.showFeature(\"mode\")){\r\n\t\tvar viewsDOM = HTMLFrameHelper.getModeSelectorDOM(\"value\", renderer);\r\n\t\tif(viewsDOM) controlsDOM.appendChild(viewsDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"delete\")){\r\n\t\tvar dpropDOM = this.getValueDeleteDOM(renderer);\r\n\t\tif(dpropDOM) controlsDOM.appendChild(dpropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"clone\")){\r\n\t\tvar cpropDOM = this.getValueCloneDOM(renderer);\r\n\t\tif(cpropDOM) controlsDOM.appendChild(cpropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"reset\")){\r\n\t\tvar rpropDOM = this.getValueResetDOM(renderer);\r\n\t\tif(rpropDOM) controlsDOM.appendChild(rpropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"update\")){\r\n\t\tvar upropDOM = this.getValueUpdateDOM(renderer);\r\n\t\tif(upropDOM) controlsDOM.appendChild(upropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"show\")){\r\n\t\tvar showDOM = this.getValueShowDOM(renderer);\r\n\t\tif(showDOM) controlsDOM.appendChild(showDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"hide\")){\r\n\t\tvar hideDOM = this.getValueHideDOM(renderer);\r\n\t\tif(hideDOM) controlsDOM.appendChild(hideDOM);\r\n\t}\r\n\treturn controlsDOM;\r\n}\r\n\r\nHTMLDataHeaderViewer.prototype.getValueDeleteDOM = function(renderer){\r\n\tvar callback = function(){renderer.delete()};\r\n\tvar disabled = (renderer.cardControlAllows(\"delete\") ? false : \"Cardinality Rules Forbid Delete\");\r\n\treturn HTMLFrameHelper.getActionControl(\"value\", \"delete\", \"Delete\", callback, disabled);\r\n}\r\n\r\nHTMLDataHeaderViewer.prototype.getValueResetDOM = function(renderer){\r\n\tvar callback = function(){renderer.reset()};\r\n\tvar disabled = (renderer.isUpdated() ? false : \"Nothing to reset\");\r\n\treturn HTMLFrameHelper.getActionControl(\"value\", \"reset\", \"Reset\", callback, disabled);\r\n}\r\n\r\nHTMLDataHeaderViewer.prototype.getValueShowDOM = function(renderer){\r\n\tvar callback = function(){renderer.show()};\r\n\treturn HTMLFrameHelper.getActionControl(\"value\", \"show\", \"Show\", callback);\r\n}\r\n\r\nHTMLDataHeaderViewer.prototype.getValueHideDOM = function(renderer){\r\n\tvar callback = function(){renderer.hide()};\r\n\treturn HTMLFrameHelper.getActionControl(\"value\", \"hide\", \"Hide\", callback);\r\n}\r\n\r\nHTMLDataHeaderViewer.prototype.getValueCloneDOM = function(renderer){\r\n\tvar callback = function(){renderer.clone()};\r\n\tvar disabled = (renderer.cardControlAllows(\"clone\") ? false : \"Cardinality Rules Forbid Clone\");\r\n\treturn HTMLFrameHelper.getActionControl(\"value\", \"clone\", \"Clone\", callback, disabled);\r\n}\r\n\r\nHTMLDataHeaderViewer.prototype.getValueUpdateDOM = function(renderer){\r\n\tvar dpropDOM = document.createElement(\"span\");\r\n\tdpropDOM.setAttribute(\"class\", \"terminus-value-update\");\r\n\tvar saveback = function(){renderer.save()};\r\n\tvar disabled = (renderer.isUpdated() ? false : \"Nothing to save - no change\");\r\n\tdpropDOM.appendChild(HTMLFrameHelper.getActionControl(\"value\", \"save\", \"Save\", saveback, disabled));\r\n\treturn dpropDOM;\r\n}\r\n\r\nHTMLDataHeaderViewer.prototype.getViewerSelectorDOM = function(renderer){\r\n\tvar viewers = renderer.getAvailableViewers();\r\n\tif(viewers && viewers.length){\r\n\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-value-viewer\");\r\n\t\tvar callback = function(viewer){\r\n\t\t\tif(viewer){\r\n\t\t\t\trenderer.setViewer(viewer);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar selected = renderer.currentViewer();\r\n\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"data-viewer\", viewers, selected, callback);\r\n\t\tmpropDOM.appendChild(sel);\r\n\t\treturn mpropDOM;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nfunction JSONObjectViewer(renderer){\r\n\tthis.renderer = renderer;\r\n\tthis.properties = [];\r\n}\r\n\r\n/**\r\n * Functions for rendering / re-rendering the object as header and body components\r\n */\r\nJSONObjectViewer.prototype.render = function(){\r\n\talert(\"render json tbd\");\r\n}\r\nJSONObjectViewer.prototype.redraw = function(){\r\n\talert('redraw json tbd');\r\n}\r\n\r\nmodule.exports={HTMLDataViewer,HTMLDataHeaderViewer,JSONObjectViewer}\r\n","const WOQLQuery = require('../query/WOQLQuery');\r\nconst TerminusClassChooser = require('./TerminusClassChooser');\r\n/*\r\n * Utility class which allows the user to choose a document by id or by label (if select2 and full text indexing is turned on)\r\n */\r\n\r\nTerminusDocumentChooser = function(ui, root, value, view){\r\n\tthis.ui = ui;\r\n\tthis.root = root;\r\n\tthis.choice = value;\r\n\tthis.view = (view ? view : \"id\");\r\n\tthis.show_button = true;\r\n}\r\n\r\nTerminusDocumentChooser.prototype.setRoot = function(root){\r\n\tthis.root = root;\r\n}\r\n\r\nTerminusDocumentChooser.prototype.setFilter = function(filter){\r\n\tthis.filter = filter;\r\n}\r\n\r\nTerminusDocumentChooser.prototype.change = function(docid){\r\n\talert(\"Need to specify doc chooser function (\" + docid + \")\");\r\n}\r\n\r\nTerminusDocumentChooser.prototype.getAsDOM = function(style){\r\n\tif(this.view == \"label\" && \tthis.ui.client.connectionConfig.platformEndpoint() && this.ui.pluginAvailable(\"select2\")){\r\n\t\treturn this.getS2DOM(style);\r\n\t}\r\n\treturn this.getIDDOM();\r\n}\r\n\r\nTerminusDocumentChooser.prototype.getS2DOM = function(style){\r\n\tvar docchooser = document.createElement(\"span\");\r\n\tdocchooser.setAttribute(\"class\", \"terminus-document-chooser terminus-doc-holder\");\r\n\tvar wq = new WOQLQuery(this.ui.client, {}, this.ui);\r\n\tvar cfilter = wq.getSubclassQueryPattern(\"v:Class\", \"'\"+this.root+\"'\");\r\n\tvar termcc = new TerminusClassChooser(this.ui, cfilter);\r\n\ttermcc.empty_choice = \"Filter by Type\";\r\n\ttermcc.show_single = false;\r\n\tvar self = this;\r\n\ttermcc.change = function(new_class){\r\n\t\tif(new_class){\r\n\t\t\tself.filter = new_class;\r\n\t\t}\r\n\t}\r\n\ttdom = termcc.getAsDOM(style);\r\n\tif(tdom) docchooser.appendChild(tdom);\r\n\tvar holder = document.createElement(\"span\");\r\n\tholder.setAttribute(\"class\", \"terminus-entity-reference-value\");\r\n\tvar sel = document.createElement(\"select\");\r\n\tsel.setAttribute(\"class\", \"terminus-entity-class-input\");\r\n\tholder.appendChild(sel);\r\n\tvar opt = document.createElement(\"option\");\r\n\tvar lookup = function (params) {\r\n\t\tparams.class = self.filter;\r\n\t\treturn JSON.stringify(params);\r\n    }\r\n\tvar searchurl = this.ui.client.dbURL() + \"/search\";\r\n\tvar s2config = {\r\n\t\tajax: {\r\n\t\t    url: searchurl,\r\n\t\t    dataType: 'json',\r\n\t\t    data: lookup,\r\n\t\t    type: \"POST\",\r\n\t\t\tcontentType: \"application/json; charset=utf-8\",\r\n\t\t    delay: 250,\r\n\t\t    cache: true\r\n\t\t},\r\n\t\tplaceholder: \"Enter Document Name\",\r\n\t\twidth: 200\r\n\t};\r\n\tjQuery(sel).select2(s2config).change(function(){\r\n\t\tcallback(this.value);\r\n\t});\r\n\tdocchooser.appendChild(holder);\r\n\treturn docchooser;\r\n}\r\n\r\nTerminusDocumentChooser.prototype.getIDDOM = function(){\r\n\tvar docchooser = document.createElement(\"span\");\r\n\tdocchooser.setAttribute(\"class\", \"terminus-document-chooser terminus-doc-holder\");\r\n\tvar dcip = document.createElement(\"input\");\r\n\tdcip.setAttribute(\"class\", \"terminus-document-chooser terminus-query-text\");\r\n\t//11092019 dcip.setAttribute(\"class\", \"terminus-form-value terminus-document-chooser\");\r\n\tdcip.setAttribute(\"placeholder\", \"Enter Document ID\");\r\n\tdcip.addEventListener('keypress', function(e){\r\n\t\tvar key = e.which || e.keyCode;\r\n\t\t// on enter\r\n\t\tif (key === 13 && dcip.value) {\r\n\t\t\tself.choice = dcip.value;\r\n\t\t\tself.change(dcip.value);\r\n\t\t}\r\n\t});\r\n\tdocchooser.appendChild(dcip);\r\n\tif(this.show_button){\r\n\t\tvar dbut = document.createElement(\"button\");\r\n\t\tdbut.setAttribute(\"class\", \"terminus-control-button terminus-btn\");\r\n\t\tvar self = this;\r\n\t\tdbut.addEventListener(\"click\", function(){\r\n\t\t\tif(dcip.value) {\r\n\t\t\t\tself.choice = dcip.value;\r\n\t\t\t\tself.change(dcip.value);\r\n\t\t\t}\r\n\t\t});\r\n\t\t//11092019 dbut.appendChild(document.createTextNode(\"View Document Properties\"));\r\n\t\tdbut.appendChild(document.createTextNode(\"Go\"));\r\n\t\tdocchooser.appendChild(dbut);\r\n\t}\r\n\treturn docchooser;\r\n}\r\n\r\nTerminusDocumentChooser.prototype.toggleView = function(){\r\n\tif(this.view == \"id\") this.view = \"label\";\r\n\telse this.view = \"id\";\r\n}\r\n\r\nTerminusDocumentChooser.prototype.getChangeViewText = function(){\r\n\tif(this.view == \"id\"){\r\n\t\treturn \"Document Lookup\";\r\n\t}\r\n\treturn \"Load Document ID\";\r\n}\r\n\r\nmodule.exports=TerminusDocumentChooser\r\n","const TerminusUI = require('./TerminusUI');\r\nconst RenderingMap = require('./client/RenderingMap');\r\n/*\r\nvar terminator = new TerminusUI(TerminusConfig);\r\nvar pconfig = {};\r\npconfig.buttons = {'client'   : document.getElementById(\"terminus-client-btn\"),\r\n\t\t\t\t   'explorer' : document.getElementById(\"terminus-explorer-btn\")}\r\npconfig.controller \t= document.getElementById(\"terminus-control-panel\");\r\npconfig.messages = document.getElementById(\"terminus-user-messages\");\r\npconfig.plugins = document.getElementById(\"terminus-plugin-loader\");\r\npconfig.explorer = document.getElementById(\"terminus-explorer\");\r\npconfig.viewer = document.getElementById(\"terminus-content-viewer\");\r\nvar nlocation = (TerminusConfig && TerminusConfig.location) ? TerminusConfig.location : false;\r\nterminator.draw(pconfig, nlocation);\r\n\r\nfunction showPanel(mode){\r\n\ttoggleHeaders(mode, document.getElementById(\"terminus-content-viewer\"));\r\n}\r\n*/\r\nmodule.exports={TerminusUI:TerminusUI,\r\n                RenderingMap:RenderingMap}","/**\r\n * Terminus UI object\r\n *\r\n * Traffic control of messages going between different Terminus UI pages and features\r\n *\r\n * @param opts - options array\r\n */\r\nconst ApiExplorer = require('./ApiExplorer');\r\nconst TerminusDocumentViewer = require('./client/TerminusDocument');\r\nconst TerminusDBsdk = require('./client/TerminusDB');\r\nconst TerminusViolations = require('./client/TerminusViolation');\r\nconst TerminusQueryViewer = require('./client/TerminusQuery');\r\nconst TerminusMappingViewer = require('./client/TerminusMapping');\r\nconst TerminusSchemaViewer = require('./client/TerminusSchema');\r\nconst TerminusServersdk = require('./client/TerminusServer');\r\nconst TerminusURLLoader = require('./client/TerminusURL');\r\nconst TerminusPluginManager = require('./plugins/TerminusPlugin');\r\nconst UTILS=require('./Utils');\r\nconst RenderingMap = require('./client/RenderingMap');\r\n\r\nfunction TerminusUI(opts){\r\n\tthis.client = new TerminusClient.WOQLClient();\r\n\tthis.controls = [];\r\n\tthis.setOptions(opts);\r\n}\r\n\r\n/*\r\n * Client connects to specified server and specified part\r\n * opts is a json with the following fields:\r\n * server: mandatory URL of the server to connect to\r\n * key: optional client API key\r\n * dbid: id of the database to connect to\r\n * schema: if set, the UI will load the schema page after connecting\r\n * query: if set, the query will be sent to the server and the results will be loaded on the query page\r\n * document: if set, the document page corresponding to this document will be loaded after connecting\r\n *\r\n * (note: schema, query, document are mutually exclusive and must also have a dbid set)\r\n */\r\nTerminusUI.prototype.connect = function(opts){\r\n\tvar self = this;\r\n\tthis.client.connectionConfig.server = false;\r\n\tvar key = ((opts && opts.key) ? opts.key : false);\r\n\tthis.showBusy(\"Connecting to server at \" + opts.server);\r\n\treturn this.client.connect(opts.server, key)\r\n\t.then( function(response) {\r\n\t\tself.clearBusy();\r\n\t\tif(opts && opts.db && self.getDBRecord(opts.db)){\r\n\t\t\tself.connectToDB(opts.db);\r\n\t\t\tif(opts.document && self.showView(\"get_document\")){\r\n\t\t\t\tself.showDocument(opts.document);\r\n\t\t\t}\r\n\t\t\telse if(opts.schema && self.showView(\"get_schema\")){\r\n\t\t\t\tself.showSchemaPage(opts.schema);\r\n\t\t\t}\r\n\t\t\telse if(opts.query && self.showView(\"woql_select\")){\r\n\t\t\t\tself.showQueryPage(opts.query);\r\n\t\t\t}\r\n\t\t\telse if(opts.explorer && self.showView(\"api_explorer\")){\r\n\t\t\t\tself.showExplorer(opts.explorer);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tself.showDBMainPage();\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tself.showServerMainPage();\r\n\t\t}\r\n\t\tself.redraw();\r\n\t})\r\n\t.catch(function(err) {\r\n\t\tself.clearBusy();\r\n\t\tself.showError(err);\r\n\t\tthrow(err);\r\n\t});\r\n}\r\n\r\n/**\r\n * Sends a request to create a new database to the server and interprets the response\r\n *\r\n * dbdets is a json object with the following fields:\r\n * id: the id of the new database (alphanumeric, no spaces, url friendly) mandatory\r\n * title: the text name of the new database for tables, etc. mandatory\r\n * description: text description of the database (optional)\r\n * key: a API client key for server auth\r\n * schema: the url of another Terminus DB from which to import schema\r\n * instance: the url of another Terminus DB from which to import data\r\n *\r\n */\r\nTerminusUI.prototype.createDatabase = function(dbdets){\r\n\tvar self = this;\r\n\tif(!dbdets.id || !dbdets.title){\r\n        return Promise.reject(new Error(self.getBadArguments(\"createDatabase\", \"ID and title are mandatory fields\")));\r\n\t}\r\n\tvar dbid = dbdets.id;\r\n\tvar myserver = this.client.connectionConfig.server;\r\n\tself.showBusy(\"Creating Database \" + dbdets.title + \" with id \" + dbid);\r\n\tvar dbdoc = this.generateNewDatabaseDocument(dbdets);\r\n\treturn this.client.createDatabase(dbid, dbdoc)\r\n\t.then(function(response){ //import schema into newly created DB\r\n\t\tif(dbdets.schema){\r\n\t\t\tself.showBusy(\"Fetching imported schema from \" + dbdets.schema);\r\n\t\t\tvar opts = (dbdets.key ?  {\"terminus:user_key\": dbdets.key } : {});\r\n\t\t\topts['terminus:encoding'] = \"terminus:turtle\";\r\n\t\t\treturn self.client.getSchema(dbdets.schema, opts)\r\n\t\t\t.then(function(response){\r\n\t\t\t\tself.showBusy(\"Updating database with new schema\");\r\n\t\t\t\tself.client.connectionConfig.server = myserver;\r\n\t\t\t\tself.client.connectionConfig.dbid = dbid;\r\n\t\t\t\tvar nopts = {'terminus:encoding':  \"terminus:turtle\"};\r\n\t\t\t\treturn self.client.updateSchema(false, response, nopts);\r\n\t\t\t})\r\n\t\t\t.then(function(response){\r\n\t\t\t\tself.clearBusy();\r\n\t\t\t\tself.redraw();\r\n\t\t\t\treturn response;\r\n\t\t\t});\r\n\t\t}\r\n\t\telse {\r\n\t\t\tself.clearBusy();\r\n\t\t}\r\n\t\treturn response;\r\n\t})\r\n\t.then(function(response){ //reload list of databases in background..\r\n\t\treturn self.refreshDBList()\r\n\t\t.then(function(response){\r\n\t\t\tif(crec = self.client.connection.getDBRecord(dbid)){\r\n\t\t\t\tself.client.connectionConfig.dbid = dbid;\r\n\t\t\t\tself.showDBMainPage();\r\n\t\t\t\tself.showMessage(\"Successfully Created Database \" + dbid, \"success\");\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t        return Promise.reject(new Error(self.getCrashString(\"createDatabase\", \"Failed to retrieve record of created database \" + dbid)));\r\n\t\t\t}\r\n\t\t})\r\n\t})\r\n\t.catch(function(error){\r\n\t\tself.clearBusy();\r\n\t\tself.showError(error);\r\n\t});\r\n}\r\n\r\n/**\r\n * Deletes the database with the passed id from the currently connected server\r\n */\r\nTerminusUI.prototype.deleteDatabase = function(dbid){\r\n\tvar self = this;\r\n\tvar delrec = this.client.connection.getDBRecord();\r\n\tvar lid = (dbid ? dbid : this.db());\r\n\tvar dbn = (delrec && delrec['rdfs:label'] && delrec['rdfs:label'][\"@value\"] ? delrec['rdfs:label'][\"@value\"] + \" (id: \" + lid + \")\" : lid);\r\n\tthis.showBusy(\"Deleting database \" + dbn);\r\n\treturn this.client.deleteDatabase(dbid)\r\n\t.then(function(response){\r\n\t\tself.clearBusy();\r\n\t\tself.client.connectionConfig.dbid = false;\r\n\t\tself.removeDB(dbid);\r\n\t\tself.showServerMainPage();\r\n\t\tself.showMessage(\"Successfully Deleted Database \" + dbn, \"success\");\r\n\t\tself.refreshDBList();\r\n\t\treturn response;\r\n\t})\r\n\t.catch(function(error){\r\n\t\tself.clearBusy();\r\n\t\tself.showError(error);\r\n\t});\r\n}\r\n\r\n/*\r\n * Transforms a details (id, title, description) array into  json-ld document\r\n */\r\nTerminusUI.prototype.generateNewDatabaseDocument = function(dets){\r\n\tvar doc = {\r\n\t\t\"@context\" : {\r\n\t\t\trdfs: \"http://www.w3.org/2000/01/rdf-schema#\",\r\n\t\t\tterminus: \"http://terminusdb.com/schema/terminus#\"\r\n\t\t},\r\n\t\t\"@type\": \"terminus:Database\"\r\n\t}\r\n\tif(dets.title){\r\n\t\tdoc['rdfs:label'] = {\r\n\t\t\t\"@language\":  \"en\",\r\n\t\t\t\"@value\": dets.title\r\n\t\t};\r\n\t}\r\n\tif(dets.description){\r\n\t\tdoc['rdfs:comment'] = {\r\n\t\t\t\"@language\":  \"en\",\r\n\t\t\t\"@value\": dets.description\r\n\t\t};\r\n\t}\r\n\tdoc['terminus:allow_origin'] = { \"@type\" : \"xsd:string\", \"@value\" : \"*\" };\r\n\treturn doc;\r\n}\r\n\r\nTerminusUI.prototype.getBadArguments = function(fname, str){\r\n\treturn \"Bad arguments to \" + fname + \": \" + str;\r\n}\r\n\r\nTerminusUI.prototype.getCrashString = function(fname, str){\r\n\treturn \"Results from \" + fname + \" indicate the possibility of a system failure \" + str;\r\n}\r\n\r\n/*\r\n * Parses the passed URL and turns it into a call to the connect function - loads the appropriate endpoing\r\n */\r\nTerminusUI.prototype.load = function(url, key){\r\n\tvar args = {};\r\n\tif(url && url.indexOf(\"/document/\") != -1){\r\n\t\turl = url.substring(0, url.indexOf(\"/document/\"));\r\n\t\targs.document = url.substring(url.indexOf(\"/document/\")+10);\r\n\t}\r\n\telse if(url && url.indexOf(\"/schema\") != -1){\r\n\t\turl = url.substring(0, url.indexOf(\"/schema\"));\r\n\t\targs.schema = {};\r\n\t}\r\n\telse if(url && url.indexOf(\"/woql\") != -1){\r\n\t\turl = url.substring(0, url.indexOf(\"/query\"));\r\n\t\targs.query = url.substring(url.indexOf(\"/query\")+7);\r\n\t}\r\n\targs.server = url;\r\n\tif(key) args.key = key;\r\n\treturn this.connect(args);\r\n}\r\n\r\n/**\r\n * Fetches the DB URL from the url by chopping off the extra bits\r\n */\r\nTerminusUI.prototype.getConnectionEndpoint = function(url){\r\n\tif(url && url.lastIndexOf(\"/schema\") != -1){\r\n\t\treturn url.substring(0, url.lastIndexOf(\"/schema\"));\r\n\t}\r\n\tif(url && url.lastIndexOf(\"/document\") != -1){\r\n\t\treturn url.substring(0, url.lastIndexOf(\"/document\"));\r\n\t}\r\n\tif(url && url.lastIndexOf(\"/frame\") != -1){\r\n\t\treturn url.substring(0, url.lastIndexOf(\"/frame\"));\r\n\t}\r\n\tif(url && url.lastIndexOf(\"/woql\") != -1){\r\n\t\treturn url.substring(0, url.lastIndexOf(\"/woql\"));\r\n\t}\r\n\treturn url;\r\n}\r\n\r\nTerminusUI.prototype.server = function(){\r\n\treturn this.client.connectionConfig.server;\r\n}\r\n\r\nTerminusUI.prototype.db = function(){\r\n\treturn this.client.connectionConfig.dbid;\r\n}\r\n\r\nTerminusUI.prototype.clearServer = function(){\r\n\tthis.client.connectionConfig.server = false;\r\n}\r\n\r\nTerminusUI.prototype.connectToDB = function(dbid){\r\n\tthis.client.connectionConfig.dbid = dbid;\r\n\tTerminusClient.FrameHelper.standard_urls['doc'] = this.client.connectionConfig.dbURL() + \"/document/\";\r\n\tTerminusClient.FrameHelper.standard_urls['scm'] = this.client.connectionConfig.dbURL() + \"/schema#\";\r\n}\r\n\r\nTerminusUI.prototype.clearDB = function(){\r\n\tthis.client.connectionConfig.dbid = false;\r\n}\r\n\r\nTerminusUI.prototype.removeDB = function(db, url){\r\n\tthis.client.connection.removeDB(db, url);\r\n}\r\n\r\nTerminusUI.prototype.getDBRecord = function(db, url){\r\n\treturn this.client.connection.getDBRecord(db, url);\r\n}\r\n\r\nTerminusUI.prototype.refreshDBList = function(){\r\n\tvar self = this;\r\n\treturn this.client.connect();\r\n}\r\n\r\nTerminusUI.prototype.showServerMainPage = function(){\r\n\tthis.viewer = new TerminusServersdk.TerminusServerViewer(this);\r\n\tthis.redrawMainPage();\r\n}\r\n\r\nTerminusUI.prototype.showLoadURLPage = function(val){\r\n\tthis.viewer = new TerminusURLLoader(this, val);\r\n\tthis.redrawMainPage();\r\n}\r\n\r\nTerminusUI.prototype.showDBMainPage = function(){\r\n\tthis.viewer = new TerminusDBsdk.TerminusDBViewer(this);\r\n\tthis.redraw();\r\n}\r\n\r\nTerminusUI.prototype.showCreateDBPage = function(){\r\n\tthis.viewer = new TerminusDBsdk.TerminusDBCreator(this);\r\n\tthis.redrawMainPage();\r\n}\r\n\r\nTerminusUI.prototype.showSchemaPage = function(durl){\r\n\tthis.viewer = new TerminusSchemaViewer(this);\r\n\tthis.redrawMainPage();\r\n}\r\n\r\nTerminusUI.prototype.showQueryPage = function(query){\r\n\tthis.viewer = new TerminusQueryViewer(this, query, this.options);\r\n\tthis.redrawMainPage();\r\n}\r\n\r\nTerminusUI.prototype.showMappingPage = function(mapping){\r\n\tthis.viewer = new TerminusMappingViewer(this, mapping, this.options);\r\n\tthis.redrawMainPage();\r\n}\r\n\r\nTerminusUI.prototype.showDocument = function(durl){\r\n\tthis.viewer = new TerminusDocumentViewer(this, \"view\", this.getDocViewerOptions());\r\n\tthis.viewer.loadDocument(durl);\r\n\tthis.redrawMainPage();\r\n}\r\n\r\nTerminusUI.prototype.showCreateDocument = function(durl){\r\n\tthis.viewer = new TerminusDocumentViewer(this, \"create\", this.getDocCreatorOptions());\r\n\tthis.viewer.loadCreateDocument(durl);\r\n\tthis.redrawMainPage();\r\n}\r\n\r\nTerminusUI.prototype.redrawMainPage = function(){\r\n\tTerminusClient.FrameHelper.removeChildren(this.main);\r\n\tif(this.viewer){\r\n\t\tthis.main.appendChild(this.viewer.getAsDOM());\r\n\t}\r\n}\r\n\r\nTerminusUI.prototype.showResult = function(response){\r\n\tthis.showMessage(response, \"success\");\r\n};\r\n\r\nTerminusUI.prototype.showError = function(response){\r\n\tthis.showMessage(response, \"error\");\r\n};\r\n\r\nTerminusUI.prototype.clearMessages = function(response){\r\n\tif(this.messages) TerminusClient.FrameHelper.removeChildren(this.messages);\r\n};\r\n\r\nTerminusUI.prototype.clearMainPage = function(){\r\n\tif(this.main) TerminusClient.FrameHelper.removeChildren(this.main);\r\n}\r\n\r\nTerminusUI.prototype.setMessageDOM = function(dom){\r\n\tthis.messages = dom;\r\n}\r\n\r\nTerminusUI.prototype.setbuttonControls = function(dom){\r\n\tthis.buttons = dom;\r\n}\r\n\r\nTerminusUI.prototype.setControllerDOM = function(dom){\r\n\tthis.controller = dom;\r\n}\r\n\r\nTerminusUI.prototype.setExplorerDOM = function(dom){\r\n\tthis.explorer = dom;\r\n}\r\n\r\nTerminusUI.prototype.setPluginsDOM = function(dom){\r\n\tthis.plugins = dom;\r\n}\r\n\r\nTerminusUI.prototype.setViewerDOM = function(dom){\r\n\tthis.main = dom;\r\n}\r\n\r\nTerminusUI.prototype.draw = function(comps, slocation){\r\n\tif(comps && comps.buttons) this.setbuttonControls(comps.buttons);\r\n\tif(comps && comps.messages) this.setMessageDOM(comps.messages);\r\n\tif(comps && comps.controller) this.setControllerDOM(comps.controller);\r\n\tif(comps && comps.explorer) this.setExplorerDOM(comps.explorer);\r\n\tif(comps && comps.viewer) this.setViewerDOM(comps.viewer);\r\n\tif(comps && comps.plugins) this.setPluginsDOM(comps.plugins);\r\n\tif(this.plugins){\r\n\t\tthis.drawPlugins();\r\n\t}\r\n\tvar self = this;\r\n\tvar cdrawn = false;\r\n\tif(slocation && slocation.server){\r\n\t\tif(typeof this.client.connection.connection[slocation.server] == \"undefined\") {\r\n\t\t\tthis.connect(slocation)\r\n\t\t\t.catch(function(error){\r\n\t\t\t\tself.showLoadURLPage();\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tthis.showLoadURLPage();\r\n\t};\r\n\tif(this.buttons){\r\n\t\tthis.toggleControl();\r\n\t}\r\n}\r\n\r\n\r\n\r\nTerminusUI.prototype.redraw = function(msg){\r\n\tthis.clearMessages();\r\n\tif(this.controller){\r\n\t\tTerminusClient.FrameHelper.removeChildren(this.controller);\r\n\t\tthis.drawControls();\r\n\t}\r\n\tif(this.explorer){\r\n\t\tTerminusClient.FrameHelper.removeChildren(this.explorer);\r\n\t\t//this.drawExplorer();\r\n\t}\r\n\tif(this.viewer){\r\n\t\tthis.redrawMainPage();\r\n\t}\r\n\tif(msg) this.showMessage(msg);\r\n};\r\n\r\n\r\nTerminusUI.prototype.toggleDashboardWidget = function(widget){\r\n    TerminusClient.FrameHelper.removeChildren(this.controller);\r\n    TerminusClient.FrameHelper.removeChildren(this.explorer);\r\n    UTILS.removeSelectedNavClass('terminus-dashboard-selected');\r\n    widget.classList.add('terminus-dashboard-selected');\r\n}\r\n\r\nTerminusUI.prototype.toggleControl = function(){\r\n  var self = this;\r\n  this.buttons.client.addEventListener('click', function(){\r\n    self.toggleDashboardWidget(this);\r\n    self.drawControls();\r\n    self.showServerMainPage();\r\n  })\r\n  this.buttons.explorer.addEventListener('click', function(){\r\n    self.toggleDashboardWidget(this);\r\n    self.drawExplorer();\r\n  })\r\n}\r\n\r\nTerminusUI.prototype.drawControls = function(){\r\n\tthis.controls = [];\r\n\tthis.loadControls();\r\n\tfor(var i = 0; i<this.controls.length; i++){\r\n\t\tvar ncontrol = this.controls[i];\r\n\t\tif(ncontrol && (nd = ncontrol.getAsDOM())){\r\n\t\t\tthis.controller.appendChild(nd);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nTerminusUI.prototype.drawExplorer = function(){\r\n\tif(this.explorer){\r\n\t\tif(this.showControl(\"api_explorer\")){\r\n\t\t\tvar exp = new ApiExplorer(this);\r\n\t\t\tae = exp.getAsDOM();\r\n\t\t\tthis.explorer.appendChild(ae);\r\n\t\t\tthis.explorer.style.display = 'block';\r\n\t\t}\r\n\t}\r\n}\r\n\r\nTerminusUI.prototype.loadControls = function(){\r\n\tif(this.showControl('server')){\r\n\t\tvar sc = new TerminusServersdk.TerminusServerController(this);\r\n\t\tif(sc) {\r\n\t\t\tthis.controls.push(sc);\r\n\t\t}\r\n\t\tif(this.db() && this.showControl(\"db\")){\r\n\t\t\tvar sc = new TerminusDBsdk.TerminusDBController(this);\r\n\t\t\tif(sc) this.controls.push(sc);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nTerminusUI.prototype.showControl = function(el){\r\n\tif(this.show_controls.indexOf(el) == -1) return false;\r\n\tif(this.pseudoCapability(el)) return true;\r\n\tif(this.client.connection.capabilitiesPermit(el)) {\r\n\t\treturn true;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nTerminusUI.prototype.showView = function(el){\r\n\tif(this.show_views.indexOf(el) == -1) return false;\r\n\tif(this.pseudoCapability(el)) return true;\r\n\tif(this.client.connection.capabilitiesPermit(el)) {\r\n\t\treturn true;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nTerminusUI.prototype.clearBusy = function(response){\r\n\tthis.clearMessages();\r\n\tif(this.viewer && typeof this.viewer.busy == \"function\") this.viewer.busy(false);\r\n}\r\n\r\nTerminusUI.prototype.getBusyLoader = function(bsyDom){\r\n     var pd = document.createElement('div');\r\n     var pbc = document.createElement('div');\r\n     pbc.setAttribute('class', 'term-progress-bar-container');\r\n     pd.appendChild(pbc);\r\n\r\n     var pbsa = document.createElement('div');\r\n     pbsa.setAttribute('class', 'term-progress-bar term-stripes animated reverse slower');\r\n     pbc.appendChild(pbsa);\r\n     var pbia = document.createElement('span');\r\n     pbia.setAttribute('class', 'term-progress-bar-inner');\r\n     pbsa.appendChild(pbia);\r\n\r\n     bsyDom.appendChild(pd);\r\n}\r\n\r\nTerminusUI.prototype.showMessage = function(msg, type){\r\n\tif(this.messages){\r\n\t\tTerminusClient.FrameHelper.removeChildren(this.messages);\r\n\t\tvar md = document.createElement('div');\r\n        switch(type){\r\n            case 'busy':\r\n                var msgHolder = document.createElement('div');\r\n                msgHolder.setAttribute('class', 'terminus-busy-msg')\r\n                msgHolder.appendChild(document.createTextNode(msg));\r\n                md.appendChild(msgHolder);\r\n                this.getBusyLoader(md);\r\n            break;\r\n            case 'success':\r\n                md.setAttribute('class', 'terminus-show-msg-success');\r\n                md.appendChild(document.createTextNode(msg));\r\n            break;\r\n            case 'error':\r\n                md.setAttribute('class', 'terminus-show-msg-error');\r\n                md.appendChild(document.createTextNode(msg));\r\n            break;\r\n        }\r\n\t\tthis.messages.appendChild(md);\r\n\t}\r\n};\r\n\r\nTerminusUI.prototype.showViolations = function(vios, type){\r\n\tvar nvios = new TerminusViolations(vios, this);\r\n\tif(this.messages){\r\n\t\tvar cmsg = (type == \"schema\" ? \" in Schema\" : \" in Document\");\r\n\t\tTerminusClient.FrameHelper.removeChildren(this.messages);\r\n\t\tthis.messages.appendChild(nvios.getAsDOM(cmsg));\r\n\t}\r\n}\r\n\r\nTerminusUI.prototype.showBusy = function(msg){\r\n\tthis.showMessage(msg, \"busy\");\r\n\tif(this.viewer && typeof this.viewer.busy == \"function\") this.viewer.busy(msg);\r\n};\r\n\r\nTerminusUI.prototype.pseudoCapability = function(el){\r\n\tvar pseuds = [\"server\", \"db\", \"change-server\", \"api_explorer\", \"import_schema\", \"schema_format\"];\r\n\tif(pseuds.indexOf(el) == -1) return false;\r\n\treturn true;\r\n}\r\n\r\nTerminusUI.prototype.setOptions = function(opts){\r\n\tthis.show_controls = opts && opts.controls ? opts.controls :\r\n\t\t[\"server\", \"db\", \"change-server\", \"schema_format\",\r\n\t\t\t\"import_schema\", \"class_frame\", \"create_database\",\r\n\t\t\t\"create_document\", \"get_document\", \"update_schema\",\r\n\t\t\t\"get_schema\", \"woql_select\"\r\n\t\t];\r\n\tthis.show_views = opts && opts.views ? opts.views : this.show_controls;\r\n\tif(opts.document){\r\n\t\tthis.document_options = opts.document;\r\n\t}\r\n\tif(opts.schema){\r\n\t\tthis.schema_options = opts.schema;\r\n\t}\r\n\tthis.piman = new TerminusPluginManager();\r\n\tvar self = this;\r\n\tthis.piman.init(opts.plugins, function(){\r\n\t\tvar pins = [\"gmaps\", \"quill\", \"select2\"];\r\n\t\tfor(var i = 0; i<pins.length; i++){\r\n\t\t\tif(self.piman.pluginAvailable(pins[i])){\r\n\t\t\t\tRenderingMap.addPlugin(pins[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t\tself.redraw();\r\n\t});\r\n\tif(opts.css && this.piman){\r\n\t\tthis.piman.loadPageCSS(opts.css);\r\n\t}\r\n\tthis.loadControls();\r\n}\r\n\r\nTerminusUI.prototype.pluginAvailable = function(p){\r\n\treturn this.piman.pluginAvailable(p);\r\n}\r\n\r\nTerminusUI.prototype.drawPlugins = function(){\r\n\tif(!this.piman) {\r\n\t\tconsole.log(new Error(\"No plugin manager initialised in UI object\"));\r\n\t\treturn false;\r\n\t}\r\n\tthis.plugins.appendChild(this.piman.getAsDOM(this));\r\n}\r\n\r\nTerminusUI.prototype.getDocViewerOptions = function(){\r\n\tif(this.document_options && this.document_options['view']){\r\n\t\treturn this.document_options['view'];\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nTerminusUI.prototype.getDocCreatorOptions = function(){\r\n\tif(this.document_options && this.document_options['view']){\r\n\t\treturn this.document_options['view'];\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nTerminusUI.prototype.getClassFrameOptions = function(){\r\n\treturn this.viewdoc_options;\r\n}\r\n\r\nmodule.exports=TerminusUI\r\n","/**\r\n * @file Javascript Api explorer tool\r\n * @author Kitty Jose\r\n * @license Copyright 2018-2019 Data Chemist Limited, All Rights Reserved. See LICENSE file for more\r\n *\r\n * @summary Displays a demo and description of api calls from WOQLCLient and what happens under the hood of api calls\r\n */\r\nconst TerminusPluginManager = require('./plugins/TerminusPlugin');\r\nconst UTILS = require('./Utils')\r\n\r\nlet apiNavConfig = {\r\n    mainNav: {\r\n        connect: {\r\n    \t\tnavText: 'Connect Server Api',\r\n            action : 'connect',\r\n            icon   : 'link',\r\n            defaultSelected: true\r\n    \t},\r\n        database: {\r\n            navText: 'Database Api',\r\n            action : 'create',\r\n            icon   : 'database'\r\n        },\r\n        schema: {\r\n            navText: 'Schema Api',\r\n            action : 'schema',\r\n            icon   : 'cog'\r\n        },\r\n        document: {\r\n            navText: 'Document Api',\r\n            action : 'document',\r\n            icon   : 'file'\r\n        },\r\n        query: {\r\n            navText: 'Query Api',\r\n            action : 'query',\r\n            icon   : 'search'\r\n        }\r\n    },\r\n    subNav: {\r\n        database: {\r\n            createDatabase: {\r\n                navText: 'Create database',\r\n                action : 'create',\r\n                icon   : 'plus',\r\n                defaultSelected: true\r\n            },\r\n            deleteDatabase: {\r\n                navText: 'Delete database',\r\n                action : 'delete',\r\n                icon   : 'trash-alt'\r\n            }\r\n        },\r\n        schema: {\r\n            getSchema: {\r\n                navText: 'View Schema',\r\n                action : 'getSchema',\r\n                icon   : 'eye',\r\n                defaultSelected: true\r\n            },\r\n            updateSchema: {\r\n                navText: 'Update Schema',\r\n                action : 'updateSchema',\r\n                icon   : 'arrow-up'\r\n            },\r\n            getClassFrames: {\r\n                navText: 'Get Class Frames',\r\n                action : 'getClassFrames',\r\n                icon   : 'share-alt'\r\n            }\r\n        },\r\n        document: {\r\n            viewDocument: {\r\n        \t\tnavText: 'View Document',\r\n                action : 'viewDocument',\r\n                icon   : 'eye',\r\n                defaultSelected: true\r\n        \t},\r\n            createDocument: {\r\n                navText: 'Create Document',\r\n                action : 'createDocument',\r\n                icon   : 'plus'\r\n            },\r\n            updateDocument: {\r\n                navText: 'Update Document',\r\n                action : 'updateDocument',\r\n                icon   : 'arrow-up'\r\n            },\r\n            deleteDocument:{\r\n                navText: 'Delete Document',\r\n                action : 'deleteDocument',\r\n                icon   : 'trash-alt'\r\n            }\r\n        },\r\n        query: {\r\n            select: {\r\n                navText: 'Select',\r\n                action : 'select',\r\n                icon   : 'mouse-pointer',\r\n                defaultSelected: true\r\n            },\r\n            update: {\r\n                navText: 'Update',\r\n                action : 'update',\r\n                icon   : 'arrow-up'\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nfunction ApiExplorer(ui){\r\n    this.ui = ui;\r\n    this.viewer = ui.main;\r\n    this.client = new TerminusClient.WOQLClient();\r\n    this.client.use_fetch = true;\r\n    this.client.return_full_response = true;\r\n    this.pman = new TerminusPluginManager();\r\n}\r\n\r\n// Controller provides access to Api explorer functions\r\nApiExplorer.prototype.getAsDOM = function(){\r\n \tvar aec = document.createElement(\"div\");\r\n    aec.setAttribute(\"class\", \"terminus-db-controller\");\r\n    if(this.ui){\r\n       this.getApiNav(aec, this.viewer); // nav\r\n       this.getApiExplorerDom('connect', this.viewer); // content dom\r\n    } // if this.ui\r\n    return aec;\r\n }\r\n\r\n/***** Api Nav bar *****/\r\n// Toggle selected nav bars\r\nApiExplorer.prototype.setSelectedNavMenu = function(a){\r\n    UTILS.removeSelectedNavClass(\"terminus-selected\");\r\n    a.classList.add(\"terminus-selected\");\r\n}\r\n\r\nApiExplorer.prototype.setSelectedSubMenu = function(a){\r\n    UTILS.removeSelectedNavClass(\"terminus-submenu-selected\");\r\n    a.classList.add(\"terminus-submenu-selected\");\r\n}\r\n\r\nApiExplorer.prototype.navOnSelect = function(action, nav, viewer){\r\n    UTILS.removeSelectedNavClass(\"terminus-selected\");\r\n    nav.classList.add(\"terminus-selected\");\r\n    this.getApiExplorerDom(action, viewer);\r\n}\r\n\r\n// create nav bars\r\nApiExplorer.prototype.createNavs = function(navConfig, viewer, ul){\r\n    var a = document.createElement('a');\r\n    a.setAttribute('class', 'terminus-a terminus-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\r\n    if(navConfig.defaultSelected) a.classList.add('terminus-selected');\r\n    var self = this;\r\n    a.addEventListener(\"click\", function(){\r\n        self.navOnSelect(navConfig.action, this, viewer);\r\n    })\r\n    var icon = document.createElement('i');\r\n    icon.setAttribute('class', 'terminus-menu-icon fa fa-' + navConfig.icon);\r\n    a.appendChild(icon);\r\n    var txt = document.createTextNode(navConfig.navText);\r\n    a.appendChild(txt);\r\n    ul.appendChild(a);\r\n}\r\n\r\n// gets api nav bar\r\nApiExplorer.prototype.getApiNav = function(navDom, viewer){\r\n    // list view of apis\r\n    var nav = document.createElement('div');\r\n    navDom.appendChild(nav);\r\n    // connect to server api\r\n    var ul = document.createElement('ul');\r\n    ul.setAttribute('class', 'terminus-ul');\r\n    nav.appendChild(ul);\r\n    // loop over apiNavConfig\r\n    for (var key in apiNavConfig.mainNav){\r\n        if (apiNavConfig.mainNav.hasOwnProperty(key)) {\r\n            this.createNavs(apiNavConfig.mainNav[key], viewer, ul);\r\n        }\r\n    } // for apiNavConfig\r\n    return navDom;\r\n} // getApiNav()\r\n\r\n/***** Api sub navs  *****/\r\n// get schema api explorer - nav bar, alert msg, headers ...\r\nApiExplorer.prototype.getApiExplorerDom = function(view, viewer){\r\n    // clear of viewer\r\n    TerminusClient.FrameHelper.removeChildren(viewer);\r\n    // wrapper\r\n    var wrap = document.createElement('div');\r\n    //wrap.setAttribute('class', 'terminus-wrapper terminus-wrapper-height');\r\n    viewer.appendChild(wrap);\r\n    var cont = document.createElement('div');\r\n    cont.setAttribute('class', 'container-fluid');\r\n    wrap.appendChild(cont);\r\n    var row = document.createElement('div');\r\n    row.setAttribute('class', 'row-fluid');\r\n    cont.appendChild(row);\r\n    var body = document.createElement('div');\r\n    body.setAttribute('class', 'terminus-module-body');\r\n    row.appendChild(body);\r\n    var api = document.createElement('div');\r\n    api.setAttribute('class', 'terminus-module-body terminus-module-body-white-bg terminus-module-body-width');\r\n    body.appendChild(api);\r\n    // body\r\n    var cont = document.createElement('div');\r\n    var self = this;\r\n    switch(view){\r\n        case 'connect':\r\n            var apiCont = self.getConnectExplorer(cont);\r\n            api.appendChild(apiCont);\r\n        break;\r\n        case 'create':\r\n            var apiCont = self.getDatabaseExplorer(cont);\r\n            api.appendChild(apiCont);\r\n        break;\r\n        case 'schema':\r\n            var apiCont = self.getSchemaApi(cont);\r\n            api.appendChild(apiCont);\r\n        break;\r\n        case 'document':\r\n            var apiCont = self.getDocumentApi(cont);\r\n            api.appendChild(apiCont);\r\n        break;\r\n        case 'query':\r\n            var apiCont = self.getQueryApi(cont);\r\n            api.appendChild(apiCont);\r\n        break;\r\n    }// switch(api)\r\n    return wrap;\r\n} // getApiExplorerDom\r\n\r\n// on trigger of click event - change dom\r\nApiExplorer.prototype.changeSubApiDom = function(curSubMenu, action, cont, body){\r\n    TerminusClient.FrameHelper.removeChildren(body);\r\n    switch(curSubMenu){\r\n        case 'database':\r\n            var dom = this.getDatabaseDom(action, body);\r\n        break;\r\n        case 'schema':  // getShowApiDom() deals with schema and document\r\n             var dom = this.getShowApiDom(action, body);\r\n        break;\r\n        case 'document': // getShowApiDom() deals with schema and document\r\n             var dom = this.getShowApiDom(action, body);\r\n        break;\r\n        case 'query':\r\n            var dom = this.getQueryApiDom(action, body);\r\n        break;\r\n        default:\r\n            console.log('Invalid Api Config');\r\n        break;\r\n    }\r\n    cont.appendChild(dom);\r\n}\r\n\r\nApiExplorer.prototype.subNavOnSelect = function(curSubMenu, subMenuConfig, subNav, cont, body){\r\n    this.setSelectedSubMenu(subNav);\r\n    this.changeSubApiDom(curSubMenu, subMenuConfig.action, cont, body);\r\n}\r\n\r\n// create sub nav bars\r\nApiExplorer.prototype.createSubNavs = function(curSubMenu, subMenuConfig, cont, body, ul){\r\n    // comment getclassframes for api explorer time being\r\n    if(subMenuConfig.action == 'getClassFrames') return;\r\n    var a = document.createElement('a');\r\n    a.setAttribute('class', 'terminus-a terminus-hz-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\r\n    if(subMenuConfig.defaultSelected) a.classList.add('terminus-submenu-selected');\r\n    var self = this;\r\n    a.addEventListener(\"click\", function() {\r\n        self.subNavOnSelect(curSubMenu, subMenuConfig, this, cont, body);\r\n    })\r\n    var icon = document.createElement('i');\r\n    icon.setAttribute('class', 'terminus-menu-icon fa fa-' + subMenuConfig.icon);\r\n    a.appendChild(icon);\r\n    var txt = document.createTextNode(subMenuConfig.navText);\r\n    a.appendChild(txt);\r\n    ul.appendChild(a);\r\n}\r\n\r\n// get connect to server api calls - on click of connectAPI nav bar\r\nApiExplorer.prototype.getConnectExplorer = function(body){\r\n    var self = this;\r\n    var br = document.createElement('BR');\r\n    body.appendChild(br);\r\n    // get signature\r\n    var b = this.getSignature('connect');\r\n    body.appendChild(b);\r\n    // get header Parameter\r\n    body.appendChild(UTILS.getHeaderDom('Parameters'));\r\n    var br = document.createElement('BR');\r\n    body.appendChild(br);\r\n    //form to get server url\r\n    this.getForm( '', body, true, 'connect', 'URL : server_url');\r\n    //body.appendChild(form);\r\n    return body;\r\n} // getConnectExplorer\r\n\r\n// get database api calls - on click of databaseAPI nav bar - submenus of database Api defined here\r\nApiExplorer.prototype.getDatabaseExplorer = function(cont){\r\n    var body = document.createElement('div');\r\n    // list view of Databse tools\r\n    var ul = document.createElement('ul');\r\n    ul.setAttribute('class','terminus-ul-horizontal');\r\n    // loop over apiNavConfig\r\n    for (var key in apiNavConfig.subNav.database){\r\n        if (apiNavConfig.subNav.database.hasOwnProperty(key))\r\n            this.createSubNavs('database', apiNavConfig.subNav.database[key], cont, body, ul);\r\n    } // for apiNavConfig\r\n    cont.appendChild(ul);\r\n    // landing page\r\n    var dom = this.getDatabaseDom(apiNavConfig.subNav.database.createDatabase.action, body);\r\n    cont.appendChild(dom);\r\n    return cont;\r\n} // getDatabaseExplorer\r\n\r\n// get schema api calls - on click of SchemaAPI nav bar - submenus of schema Api defined here\r\nApiExplorer.prototype.getSchemaApi = function(cont){\r\n    var body = document.createElement('div');\r\n    // list view of Databse tools\r\n    var ul = document.createElement('ul');\r\n    ul.setAttribute('class','terminus-ul-horizontal');\r\n    // loop over apiNavConfig\r\n    for (var key in apiNavConfig.subNav.schema){\r\n        if (apiNavConfig.subNav.schema.hasOwnProperty(key)) {\r\n            this.createSubNavs('schema', apiNavConfig.subNav.schema[key], cont, body, ul);\r\n        }\r\n    } // for apiNavConfig\r\n    cont.appendChild(ul);\r\n    var dom = this.getShowApiDom(apiNavConfig.subNav.schema.getSchema.action, body);\r\n    cont.appendChild(dom);\r\n    return cont;\r\n} // getSchemaApi\r\n\r\n// get document api calls - on click of DocumentAPI nav bar\r\nApiExplorer.prototype.getDocumentApi = function(cont){\r\n    var body = document.createElement('div');\r\n    // list view of Databse tools\r\n    var ul = document.createElement('ul');\r\n    ul.setAttribute('class','terminus-ul-horizontal');\r\n    // loop over apiNavConfig\r\n    for (var key in apiNavConfig.subNav.document){\r\n        if (apiNavConfig.subNav.document.hasOwnProperty(key)) {\r\n            this.createSubNavs('document', apiNavConfig.subNav.document[key], cont, body, ul);\r\n        }\r\n    } // for apiNavConfig\r\n    cont.appendChild(ul);\r\n    var dom = this.getShowApiDom(apiNavConfig.subNav.document.viewDocument.action, body);\r\n    cont.appendChild(dom);\r\n    return cont;\r\n} // getDocumentApi\r\n\r\n// get query api calls - on click of QueryAPI nav bar - submenus of Query Api defined here\r\nApiExplorer.prototype.getQueryApi  = function(cont){\r\n    var body = document.createElement('div');\r\n    // list view of Databse tools\r\n    var ul = document.createElement('ul');\r\n    ul.setAttribute('class','terminus-ul-horizontal');\r\n    // loop over apiNavConfig\r\n    for (var key in apiNavConfig.subNav.query){\r\n        if (apiNavConfig.subNav.query.hasOwnProperty(key)) {\r\n            this.createSubNavs('query', apiNavConfig.subNav.query[key], cont, body, ul);\r\n        }\r\n    } // for apiNavConfig\r\n    cont.appendChild(ul);\r\n    var dom = this.getQueryApiDom(apiNavConfig.subNav.query.select.action, body);\r\n    cont.appendChild(dom);\r\n    return cont;\r\n} //getQueryApi\r\n\r\n/***** Api Content view  *****/\r\n// get database dom\r\nApiExplorer.prototype.getDatabaseDom = function(mode, body){\r\n    var self = this;\r\n    var br = document.createElement('BR');\r\n    body.appendChild(br);\r\n    // get signature\r\n    var b = this.getSignature(mode);\r\n    body.appendChild(b);\r\n    // get header Parameter\r\n    body.appendChild(UTILS.getHeaderDom('Parameters'));\r\n    var br = document.createElement('BR');\r\n    body.appendChild(br);\r\n    //form to get database id\r\n    if(mode == 'create') this.getForm( null, body, false, mode, 'URL : server/database_id');\r\n    else this.getForm( null, body, true, mode, 'URL : server/database_id');\r\n    return body;\r\n} // getConnectExplorer\r\n\r\n//get create & delete db form\r\nApiExplorer.prototype.getServerForm = function(){\r\n  // form\r\n  var form = document.createElement('form');\r\n  form.setAttribute('class', 'terminus-form-horizontal row-fluid');\r\n\r\n  var fd = document.createElement('div');\r\n  fd.setAttribute('class', 'terminus-control-group');\r\n  form.appendChild(fd);\r\n  var inpLabel = document.createElement('label');\r\n  inpLabel.setAttribute('class', 'terminus-control-label');\r\n  inpLabel.setAttribute('for', 'basicinput');\r\n  inpLabel.innerHTML = 'Url:';\r\n  fd.appendChild(inpLabel);\r\n  var cd = document.createElement('div');\r\n  cd.setAttribute('class', 'terminus-controls');\r\n  fd.appendChild(cd);\r\n  var inpId = document.createElement('input');\r\n  inpId.setAttribute('type', 'text');\r\n  inpId.setAttribute('id', 'basicinput');\r\n  inpId.setAttribute('class', 'terminus-input-text');\r\n  inpId.setAttribute('placeholder', 'URL : server_url');\r\n  if(this.val) inpId.value = this.val;\r\n  cd.appendChild(inpId);\r\n\r\n  var fd = document.createElement('div');\r\n  fd.setAttribute('class', 'terminus-control-group');\r\n  form.appendChild(fd);\r\n  var keyLabel = document.createElement('label');\r\n  keyLabel.setAttribute('class', 'terminus-control-label');\r\n  keyLabel.setAttribute('for', 'basicinput');\r\n  keyLabel.innerHTML = 'Key:';\r\n  fd.appendChild(keyLabel);\r\n  var cd = document.createElement('div');\r\n  cd.setAttribute('class', 'terminus-controls');\r\n  fd.appendChild(cd);\r\n  var key = document.createElement('input');\r\n  key.setAttribute('type', 'text');\r\n  key.setAttribute('id', 'basicinput');\r\n  key.setAttribute('class', 'span8 terminus-input-text');\r\n  key.setAttribute('placeholder', 'Key : key');\r\n  if(this.val) key.value = this.val;\r\n  cd.appendChild(key);\r\n\r\n  var button = document.createElement('button');\r\n  button.setAttribute('class', 'terminus-btn terminus-send-api-btn');\r\n  button.setAttribute('type', 'button');\r\n  button.innerHTML = 'Send Api';\r\n  var gatherips = function(){\r\n    var input = {};\r\n    input.url = inpId.value;\r\n    input.key = key.value;\r\n    return input;\r\n  }\r\n  var resd = document.createElement('div');\r\n  form.appendChild(button);\r\n  form.appendChild(resd);\r\n  var self = this;\r\n  button.addEventListener(\"click\", function(){\r\n    var buttonSelf = this;\r\n    //opts = {};\r\n    var input = gatherips();\r\n    self.client.connect(input.url, input.key)\r\n    .then(function(response){\r\n      TerminusClient.FrameHelper.removeChildren(resd);\r\n      var resultDom = UTILS.showHttpResult(response, 'connect', resd, self.ui);\r\n    });\r\n  }) // button click\r\n  return form;\r\n} // getServerForm()\r\n\r\n// get database api calls - on click of databaseAPI nav bar - submenus of database Api defined here\r\nApiExplorer.prototype.getDatabaseExplorer = function(cont){\r\n  var body = document.createElement('div');\r\n  // list view of Databse tools\r\n  var ul = document.createElement('ul');\r\n  ul.setAttribute('class','terminus-ul-horizontal');\r\n  // loop over apiNavConfig\r\n  for (var key in apiNavConfig.subNav.database){\r\n      if (apiNavConfig.subNav.database.hasOwnProperty(key)) {\r\n          this.createSubNavs('database', apiNavConfig.subNav.database[key], cont, body, ul);\r\n      }\r\n  } // for apiNavConfig\r\n  cont.appendChild(ul);\r\n  // landing page\r\n  var dom = this.getDatabaseDom(apiNavConfig.subNav.database.createDatabase.action, body);\r\n  cont.appendChild(dom);\r\n  return cont;\r\n} // getDatabaseExplorer\r\n\r\n\r\n// get schema & document dom\r\nApiExplorer.prototype.getShowApiDom = function(action, body){\r\n    var self = this;\r\n    var br = document.createElement('BR');\r\n    body.appendChild(br);\r\n    // signature\r\n    var b = this.getSignature(action);\r\n    body.appendChild(b);\r\n    // get header Parameter\r\n    body.appendChild(UTILS.getHeaderDom('Parameters'));\r\n    var br = document.createElement('BR');\r\n    body.appendChild(br);\r\n    // get input\r\n    switch(action){\r\n        case 'getSchema':\r\n            this.getForm( 'schema', body, true, action, 'URL : server/database_id');\r\n        break;\r\n        case 'getClassFrames':\r\n            this.getForm( 'getClassFrames', body, true, action, 'URL : server/database_id');\r\n        break;\r\n        case 'updateSchema':\r\n            this.getForm( 'schema', body, false, action, 'URL : server/database_id');\r\n        break;\r\n        case 'viewDocument':\r\n            this.getForm('document', body, true, action, 'URL : server/database_id/document/document_id');\r\n        break;\r\n        case 'deleteDocument':\r\n            this.getForm('document', body, true, action, 'URL : server/database_id/document/document_id');\r\n        break;\r\n        case 'createDocument':\r\n            this.getForm('document', body, false, action, 'URL : server/database_id/document/document_id');\r\n        break;\r\n        case 'updateDocument':\r\n            this.getForm('document', body, false, action, 'URL : server/database_id/document/document_id');\r\n        break;\r\n        default:\r\n            console.log('Invalid Api Call on form');\r\n        break;\r\n   }// switch(action)\r\n\r\n   return body;\r\n } // getShowApiDom()\r\n\r\n// get query api dom\r\nApiExplorer.prototype.getQueryApiDom = function(action, body){\r\n    var br = document.createElement('BR');\r\n    body.appendChild(br);\r\n    // signature\r\n    var b = this.getSignature(action);\r\n    body.appendChild(b);\r\n    // get header Parameter\r\n    body.appendChild(UTILS.getHeaderDom('Parameters'));\r\n    var br = document.createElement('BR');\r\n    body.appendChild(br);\r\n    this.getForm( 'query', body, false, action, 'URL : server/database_id');\r\n    return body;\r\n} // getQueryApiDom\r\n\r\n/*ApiExplorer.prototype.getClassFramesForm = function(){\r\n    // form\r\n    var form = document.createElement('form');\r\n    form.setAttribute('class', 'terminus-form-horizontal row-fluid');\r\n    var fd = document.createElement('div');\r\n    fd.setAttribute('class', 'terminus-control-group');\r\n    form.appendChild(fd);\r\n    var inpLabel = document.createElement('label');\r\n    inpLabel.setAttribute('class', 'terminus-control-label');\r\n    inpLabel.setAttribute('for', 'basicinput');\r\n    inpLabel.innerHTML = 'Url:';\r\n    fd.appendChild(inpLabel);\r\n    var cd = document.createElement('div');\r\n    cd.setAttribute('class', 'terminus-controls');\r\n    fd.appendChild(cd);\r\n    var inpUrl = document.createElement('input');\r\n    inpUrl.setAttribute('type', 'text');\r\n    inpUrl.setAttribute('id', 'basicinput');\r\n    inpUrl.setAttribute('class', 'span8 terminus-input-text');\r\n    inpUrl.setAttribute('placeholder', 'URL : database_url');\r\n    if(this.val) inpUrl.value = this.val;\r\n    cd.appendChild(inpUrl);\r\n    var fd = document.createElement('div');\r\n    fd.setAttribute('class', 'terminus-control-group');\r\n    form.appendChild(fd);\r\n    var inpLabel = document.createElement('label');\r\n    inpLabel.setAttribute('class', 'terminus-control-label');\r\n    inpLabel.setAttribute('for', 'basicinput');\r\n    inpLabel.innerHTML = 'Url/ ID:';\r\n    fd.appendChild(inpLabel);\r\n    var cd = document.createElement('div');\r\n    cd.setAttribute('class', 'terminus-controls');\r\n    fd.appendChild(cd);\r\n    var inpDocUrl = document.createElement('input');\r\n    inpDocUrl.setAttribute('type', 'text');\r\n    inpDocUrl.setAttribute('id', 'basicinput');\r\n    inpDocUrl.setAttribute('class', 'span8 terminus-input-text');\r\n    inpDocUrl.setAttribute('placeholder', 'Url or ID of document class');\r\n    cd.appendChild(inpDocUrl);\r\n    var fd = document.createElement('div');\r\n    fd.setAttribute('class', 'terminus-control-group');\r\n    form.appendChild(fd);\r\n    var optLabel = document.createElement('label');\r\n    optLabel.setAttribute('class', 'terminus-control-label');\r\n    optLabel.setAttribute('for', 'basicinput');\r\n    optLabel.innerHTML = 'Options:';\r\n    fd.appendChild(optLabel);\r\n    var cd = document.createElement('div');\r\n    cd.setAttribute('class', 'terminus-controls');\r\n    fd.appendChild(cd);\r\n    var optInp = document.createElement('input');\r\n    optInp.setAttribute('type', 'text');\r\n    optInp.setAttribute('id', 'basicinput');\r\n    optInp.setAttribute('class', 'span8 terminus-input-text');\r\n    optInp.setAttribute('placeholder', 'options');\r\n    cd.appendChild(optInp);\r\n    var button = document.createElement('button');\r\n    button.setAttribute('class', 'terminus-btn terminus-send-api-btn');\r\n    button.setAttribute('type', 'button');\r\n    button.innerHTML = 'Send Api';\r\n    var gatherips = function(){\r\n        var input = {};\r\n        input.url = inpUrl.value;\r\n        input.docUrl = inpDocUrl.value;\r\n        input.options = optInp.value;\r\n        return input;\r\n    }\r\n    var self = this;\r\n    button.addEventListener(\"click\", function(form){\r\n      var input = gatherips();\r\n      var buttonSelf = this;\r\n      opts = {};\r\n      opts.explorer = true;\r\n      self.client.getClassFrame(input.url, input.docUrl, opts)\r\n      .then(function(response){\r\n          var currForm = buttonSelf.parentNode;\r\n          var resultDom = UTILS.showHttpResult(response, 'getClassFrames', currForm, self.ui);\r\n      });\r\n    }) // button click\r\n    form.appendChild(button);\r\n    return form;\r\n}   */\r\n\r\n// get form for all Apis\r\nApiExplorer.prototype.getForm = function(curApi, body, view, action, urlPlaceholder){\r\n    // form\r\n    var formDoc = document.createElement('form');\r\n    formDoc.setAttribute('class', 'terminus-form-horizontal row-fluid');\r\n    var fd = document.createElement('div');\r\n    fd.setAttribute('class', 'terminus-control-group');\r\n    formDoc.appendChild(fd);\r\n    var urlLabel = document.createElement('label');\r\n    urlLabel.setAttribute('class', 'terminus-control-label');\r\n    urlLabel.setAttribute('for', 'basicinput');\r\n    urlLabel.innerHTML = 'Url:';\r\n    fd.appendChild(urlLabel);\r\n    var cd = document.createElement('div');\r\n    cd.setAttribute('class', 'terminus-controls');\r\n    fd.appendChild(cd);\r\n    var inpUrl = document.createElement('input');\r\n    inpUrl.setAttribute('type', 'text');\r\n    inpUrl.setAttribute('id', 'basicinput');\r\n    inpUrl.setAttribute('class', 'span8 terminus-input-text');\r\n    inpUrl.setAttribute('placeholder', urlPlaceholder);\r\n    cd.appendChild(inpUrl);\r\n    // add extra form fields based on current api chosen\r\n    switch(curApi){\r\n        case 'getClassFrames':\r\n            var fd = document.createElement('div');\r\n            fd.setAttribute('class', 'terminus-control-group');\r\n            formDoc.appendChild(fd);\r\n            var docUrlLabel = document.createElement('label');\r\n            docUrlLabel.setAttribute('class', 'terminus-control-label');\r\n            docUrlLabel.setAttribute('for', 'basicinput');\r\n            docUrlLabel.innerHTML = 'Url/ ID:';\r\n            fd.appendChild(docUrlLabel);\r\n            var cd = document.createElement('div');\r\n            cd.setAttribute('class', 'terminus-controls');\r\n            fd.appendChild(cd);\r\n            var inpDocUrl = document.createElement('input');\r\n            inpDocUrl.setAttribute('type', 'text');\r\n            inpDocUrl.setAttribute('id', 'basicinput');\r\n            inpDocUrl.setAttribute('class', 'span8 terminus-input-text');\r\n            inpDocUrl.setAttribute('placeholder', 'Url or ID of document class');\r\n            cd.appendChild(inpDocUrl);\r\n        break;\r\n        case 'schema':\r\n            //encoding\r\n           /* var fd = document.createElement('div');\r\n            fd.setAttribute('class', 'terminus-control-group');\r\n            formDoc.appendChild(fd);\r\n            var encLabel = document.createElement('label');\r\n            encLabel.setAttribute('class', 'terminus-control-label');\r\n            encLabel.setAttribute('for', 'basicinput');\r\n            encLabel.innerHTML = 'Encoding:';\r\n            fd.appendChild(encLabel);\r\n            var cd = document.createElement('div');\r\n            cd.setAttribute('class', 'terminus-controls');\r\n            fd.appendChild(cd);\r\n            var inpEnc = document.createElement('select');\r\n            inpEnc.setAttribute('style', 'height: 50px;width: 300px;padding: 10px;');\r\n            inpEnc.setAttribute('placeholder', 'turtle');\r\n            var optTurt = document.createElement('option');\r\n            optTurt.setAttribute('value', 'terminus:turtle');\r\n            optTurt.appendChild(document.createTextNode('turtle'));\r\n            inpEnc.appendChild(optTurt);\r\n            var optJld = document.createElement('option');\r\n            optJld.setAttribute('value', 'terminus:jsonld');\r\n            optJld.appendChild(document.createTextNode('jsonLD'));\r\n            inpEnc.appendChild(optJld);\r\n            cd.appendChild(inpEnc); */\r\n        break;\r\n    }\r\n    var fd = document.createElement('div');\r\n    fd.setAttribute('class', 'terminus-control-group');\r\n    formDoc.appendChild(fd);\r\n    var keyLabel = document.createElement('label');\r\n    keyLabel.setAttribute('class', 'terminus-control-label');\r\n    keyLabel.setAttribute('for', 'basicinput');\r\n    keyLabel.innerHTML = 'Key:';\r\n    fd.appendChild(keyLabel);\r\n    var cd = document.createElement('div');\r\n    cd.setAttribute('class', 'terminus-controls');\r\n    fd.appendChild(cd);\r\n    var inpKey = document.createElement('input');\r\n    inpKey.setAttribute('type', 'text');\r\n    inpKey.setAttribute('id', 'basicinput');\r\n    inpKey.setAttribute('class', 'span8 terminus-input-text');\r\n    inpKey.setAttribute('placeholder', 'Key');\r\n    cd.appendChild(inpKey);\r\n    if(!view){\r\n        // include text area only if call is type post\r\n        var fd = document.createElement('div');\r\n        fd.setAttribute('class', 'terminus-control-group');\r\n        formDoc.appendChild(fd);\r\n        var docLabel = document.createElement('label');\r\n        docLabel.setAttribute('class', 'terminus-control-label');\r\n        docLabel.setAttribute('for', 'basicinput');\r\n        if(curApi == 'query') docLabel.innerHTML = 'Query:';\r\n        docLabel.innerHTML = 'Document:';\r\n        fd.appendChild(docLabel);\r\n        var cd = document.createElement('div');\r\n        cd.setAttribute('class', 'terminus-controls');\r\n        fd.appendChild(cd);\r\n        var inpDoc = document.createElement('textarea');\r\n        cd.appendChild(inpDoc);\r\n        inpDoc.setAttribute('class', 'terminus-api-explorer-text-area');\r\n        UTILS.stylizeEditor(this.ui, inpDoc, 'api-doc', 'javascript');\r\n    }\r\n    body.appendChild(formDoc);\r\n    // gather inputs\r\n    var inp ={};\r\n    inp.url = inpUrl;\r\n    inp.key = inpKey;\r\n    if(curApi == 'getClassFrames') inp.docUrl = inpDocUrl;\r\n    //if(curApi == 'schema') inp.enc = inpEnc;\r\n    if(!view) inp.doc = inpDoc;\r\n    var form = this.getApiSendButton(action, inp);\r\n    body.appendChild(form);\r\n}\r\n\r\n// define event listeners on send api of schema & documents\r\n\r\nApiExplorer.prototype.getApiForm = function(action, input){\r\n  // form\r\n  var form = document.createElement('form');\r\n  form.setAttribute('class', 'terminus-form-horizontal row-fluid');\r\n\r\n  var button = document.createElement('button');\r\n  button.setAttribute('class', 'terminus-btn terminus-send-api-btn');\r\n  button.setAttribute('type', 'button');\r\n  button.innerHTML = 'Send Api';\r\n  form.appendChild(button);\r\n  var resd = document.createElement('div');\r\n  form.appendChild(resd);\r\n  var self = this;\r\n  switch(action){\r\n    case 'getSchema':\r\n      button.addEventListener(\"click\", function(){\r\n        var opts = {};\r\n        opts['terminus:encoding'] = input.enc.value;\r\n        opts['terminus:user_key'] = input.key.value;\r\n        var schurl = input.url.value;\r\n        var buttonSelf = this;\r\n        self.client.getSchema(schurl, opts)\r\n        .then(function(response){\r\n          TerminusClient.FrameHelper.removeChildren(resd);\r\n          var resultDom = UTILS.showHttpResult(response, 'getSchema', resd, self.ui);\r\n        });\r\n      }) // button click\r\n    break;\r\n    case 'updateSchema':\r\n      button.addEventListener(\"click\", function(){\r\n        var buttonSelf = this;\r\n        opts = {};\r\n        opts['terminus:encoding'] = input.enc.value;\r\n        opts['terminus:user_key'] = input.key.value;\r\n        var schurl = input.url.value;\r\n        self.client.connectionConfig.connected_mode = false;\r\n        self.client.updateSchema(schurl, input.doc.value, opts)\r\n        .then(function(response){\r\n          var gtxtar = document.createElement('textarea');\r\n          gtxtar.setAttribute('readonly', true);\r\n          gtxtar.innerHTML = response;\r\n          var currForm = buttonSelf.parentNode;\r\n          currForm.appendChild(gtxtar);\r\n          UTILS.stylizeEditor(this.ui, txtar, 'schema', 'turtle');\r\n        });\r\n      }) // button click\r\n    break;\r\n    case 'viewDocument':\r\n      button.addEventListener(\"click\", function(){\r\n      var dcurl = input.value;\r\n      var buttonSelf = this;\r\n      var opts = {};\r\n      opts.format = 'turtle';\r\n      self.client.getDocument(dcurl, opts)\r\n      .then(function(response){\r\n        TerminusClient.FrameHelper.removeChildren(resd);\r\n        var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n      });\r\n    }) // button click\r\n    break;\r\n    case 'deleteDocument':\r\n      button.addEventListener(\"click\", function(){\r\n      var dcurl = input.value;\r\n      var buttonSelf = this;\r\n      var opts = {};\r\n      self.client.deleteDocument(dcurl, opts)\r\n      .then(function(response){\r\n        TerminusClient.FrameHelper.removeChildren(resd);\r\n        var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n      });\r\n    }) // button click\r\n    break;\r\n    case 'createDocument':\r\n      button.addEventListener(\"click\", function(){\r\n        var dcurl = input.schemaUrlDom.value;\r\n        var payload = input.htmlEditor.getValue();\r\n        var buttonSelf = this;\r\n        opts = {};\r\n        self.client.createDocument(dcurl, payload, opts)\r\n        .then(function(response){\r\n          TerminusClient.FrameHelper.removeChildren(resd);\r\n          var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n        });\r\n      }) // button click\r\n    break;\r\n    case 'updateDocument':\r\n      button.addEventListener(\"click\", function(){\r\n        var dcurl = input.schemaUrlDom.value;\r\n        var payload = input.htmlEditor.getValue();\r\n        var buttonSelf = this;\r\n        opts = {};\r\n        opts.editmode = 'replace';\r\n        opts.format = 'json';\r\n        self.client.updateDocument(dcurl, payload, opts)\r\n        .then(function(response){\r\n          TerminusClient.FrameHelper.removeChildren(resd);\r\n          var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n        });\r\n      }) // button click\r\n    break;\r\n  } // switch(action)\r\n\r\n  var br = document.createElement('BR');\r\n  form.appendChild(br);\r\n  var br = document.createElement('BR');\r\n  form.appendChild(br);\r\n\r\n  return form;\r\n} // getApiForm()\r\n\r\n\r\n// define event listeners on send api of schema & documents\r\nApiExplorer.prototype.getApiSendButton = function(action, input){\r\n    // form\r\n    var form = document.createElement('form');\r\n    form.setAttribute('class', 'terminus-form-horizontal row-fluid');\r\n    var button = document.createElement('button');\r\n    button.setAttribute('class', 'terminus-btn terminus-send-api-btn');\r\n    button.setAttribute('type', 'button');\r\n    button.innerHTML = 'Send Api';\r\n    form.appendChild(button);\r\n    var resd = document.createElement('div');\r\n    form.appendChild(resd);\r\n    var self = this;\r\n    switch(action){\r\n        case 'connect':\r\n            button.addEventListener(\"click\", function(){\r\n                console.log('input', input.url.value);\r\n                self.client.connect(input.url.value, input.key.value)\r\n                .then(function(response){\r\n                \tTerminusClient.FrameHelper.removeChildren(resd);\r\n                    var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n               });\r\n            }) // button click\r\n        break;\r\n        case 'create':\r\n            button.addEventListener(\"click\", function(form){\r\n              self.client.createDatabase(input.url.value, JSON.parse(input.doc.value), input.key.value)\r\n              .then(function(response){\r\n            \t  TerminusClient.FrameHelper.removeChildren(resd);\r\n                  var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n              });\r\n            }) // button click\r\n        break;\r\n        case 'delete':\r\n            button.addEventListener(\"click\", function(){\r\n              self.client.deleteDatabase(input.url.value, input.key.value)\r\n              .then(function(response){\r\n            \t  TerminusClient.FrameHelper.removeChildren(resd);\r\n                  var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n              });\r\n            }) // button click\r\n        break\r\n        case 'getSchema':\r\n            button.addEventListener(\"click\", function(){\r\n                var opts = {};\r\n                opts['terminus:encoding'] = 'turtle';\r\n                opts['terminus:user_key'] = input.key.value;\r\n                var schurl = input.url.value;\r\n                self.client.getSchema(schurl, opts)\r\n                .then(function(response){\r\n                \tTerminusClient.FrameHelper.removeChildren(resd);\r\n                    var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n                });\r\n            }) // button click\r\n        break;\r\n        case 'updateSchema':\r\n            button.addEventListener(\"click\", function(){\r\n                opts = {};\r\n                opts['terminus:encoding'] = 'turtle';\r\n                opts['terminus:user_key'] = input.key.value;\r\n                var payload = input.doc.value;\r\n                var schurl = input.url.value;\r\n                self.client.connectionConfig.connected_mode = false;\r\n                self.client.updateSchema(schurl, input.doc.value, opts)\r\n                //self.client.updateSchema(schurl, input.doc.value, opts)\r\n                .then(function(response){\r\n                \tTerminusClient.FrameHelper.removeChildren(resd);\r\n                    var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n                });\r\n            }) // button click\r\n        break;\r\n        case 'getClassFrames':\r\n            button.addEventListener(\"click\", function(form){\r\n                var schurl = input.url.value;\r\n                opts = {};\r\n                opts.explorer = true;\r\n                self.client.getClassFrame(input.url, JSON.parse(input.docUrl.value), opts)\r\n                .then(function(response){\r\n                    var currForm = buttonSelf.parentNode;\r\n                    var resultDom = UTILS.showHttpResult(response, action, currForm, self.ui);\r\n                });\r\n            }) // button click\r\n        break;\r\n        case 'viewDocument':\r\n          button.addEventListener(\"click\", function(){\r\n              var dcurl = input.url.value;\r\n              var opts = {};\r\n              opts['terminus:encoding'] = \"terminus:frame\";\r\n              opts['terminus:user_key'] = input.key.value;\r\n              self.client.getDocument(dcurl, opts)\r\n              .then(function(response){\r\n            \t    TerminusClient.FrameHelper.removeChildren(resd);\r\n                    var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n              });\r\n        }) // button click\r\n        break;\r\n        case 'deleteDocument':\r\n          button.addEventListener(\"click\", function(){\r\n              var dcurl = input.url.value;\r\n              var opts = {};\r\n              opts.key = input.key.value;\r\n              self.client.deleteDocument(dcurl, opts)\r\n              .then(function(response){\r\n            \t  TerminusClient.FrameHelper.removeChildren(resd);\r\n                  var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n              });\r\n          }) // button click\r\n        break;\r\n        case 'createDocument':\r\n          button.addEventListener(\"click\", function(){\r\n              var dcurl = input.url.value;\r\n              var payload = input.doc.value;\r\n              opts = {};\r\n              opts['terminus:encoding'] = \"jsonld\";\r\n              opts['terminus:user_key'] = input.key.value;\r\n              self.client.createDocument(dcurl, JSON.parse(payload), opts)\r\n              .then(function(response){\r\n            \t   TerminusClient.FrameHelper.removeChildren(resd);\r\n                   var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n               });\r\n          }) // button click\r\n        break;\r\n        case 'updateDocument':\r\n          button.addEventListener(\"click\", function(){\r\n            var dcurl = input.url.value;\r\n            var payload = input.doc.value;\r\n            var buttonSelf = this;\r\n            opts = {};\r\n            opts['terminus:encoding'] = \"jsonld\";\r\n            opts['terminus:user_key'] = input.key.value;\r\n            self.client.updateDocument(dcurl, JSON.parse(payload), opts)\r\n            .then(function(response){\r\n            \tTerminusClient.FrameHelper.removeChildren(resd);\r\n                var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n            });\r\n          }) // button click\r\n        break;\r\n        case 'select':\r\n            button.addEventListener(\"click\", function(){\r\n                var opts = {};\r\n                opts.key = input.key.value;\r\n                var doc = JSON.parse(input.doc.value);\r\n                self.client.select(input.url.value, doc, opts)\r\n                .then(function(response){\r\n                \tTerminusClient.FrameHelper.removeChildren(resd);\r\n                    var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n                });\r\n            }) // button click\r\n        break;\r\n        case 'update':\r\n            button.addEventListener(\"click\", function(){\r\n              var opts = {};\r\n              opts.key = input.key.value;\r\n              var doc = JSON.parse(input.doc.value);\r\n              self.client.update(input.url.value, doc, opts)\r\n              .then(function(response){\r\n            \t  TerminusClient.FrameHelper.removeChildren(resd);\r\n                  var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n              });\r\n            }) // button click\r\n        break;\r\n        default:\r\n            console.log('Invalid Api call on button');\r\n        break;\r\n    } // switch(action)\r\n    var br = document.createElement('BR');\r\n    form.appendChild(br);\r\n    var br = document.createElement('BR');\r\n    form.appendChild(br);\r\n    return form;\r\n} // getApiSendButton()\r\n\r\n// get signature of api calls\r\nApiExplorer.prototype.getSignature = function(action){\r\n    var api = document.createElement('div');\r\n    // get header signature\r\n    var sg = document.createElement('button');\r\n    sg.appendChild(document.createTextNode('Click to read Api Signature'));\r\n    sg.setAttribute('class', 'terminus-collapsible');\r\n    ic = document.createElement('i');\r\n    ic.setAttribute('class', 'terminus-cheveron-float fa fa-chevron-down');\r\n    sg.appendChild(ic);\r\n    api.appendChild(sg);\r\n    var br = document.createElement('BR');\r\n    api.appendChild(br);\r\n    var cl = document.createElement('div');\r\n    cl.setAttribute('class', 'terminus-collapsible-content content');\r\n    var sig = UTILS.getFunctionSignature(action);\r\n    var txt = document.createTextNode(sig.spec);\r\n    var pre = document.createElement('pre');\r\n    pre.setAttribute('class', 'terminus-api-signature-pre');\r\n    pre.appendChild(txt);\r\n    var txt =  document.createTextNode(sig.descr);\r\n    pre.appendChild(txt);\r\n    var br = document.createElement('BR');\r\n    pre.appendChild(br);\r\n    var br = document.createElement('BR');\r\n    pre.appendChild(br);\r\n    var txt = document.createTextNode(sig.result);\r\n    pre.appendChild(txt);\r\n    cl.appendChild(pre);\r\n    api.appendChild(cl);\r\n    var br = document.createElement('BR');\r\n    api.appendChild(br);\r\n    sg.addEventListener('click', function(){\r\n        UTILS.tolggleContent(ic, cl);\r\n    });\r\n    return api;\r\n} // getSignature()\r\n\r\n// displays signature only on click\r\nfunction tolggleSignatureContent(content){\r\n    if (content.style.display === \"block\")\r\n        content.style.display = \"none\";\r\n    else content.style.display = \"block\";\r\n}\r\n\r\nmodule.exports=ApiExplorer\r\n","function Codemirror(text, format, config){\r\n  this.textdom = text;\r\n  this.mode = format;\r\n  this.darkMode = config.darkMode;\r\n  if(this.jsonldCheck(format)) this.mode = 'javascript';\r\n}\r\n\r\n/*\r\ntxtar    : editor is attached to textar\r\nmode     : format for highlighting, ex: json, html etc.\r\neditable : readOnly false/ nocursor is special value in code editor to set readonly true */\r\nCodemirror.prototype.colorizeTextArea = function(mode){\r\n    //initize auto complete\r\n    /*CodeMirror.commands.autocomplete = function(cm) {\r\n    cm.showHint({hint: CodeMirror.hint.anyword});\r\n    }*/\r\n\r\n    // initialise code editor on text area\r\n    var editor = CodeMirror.fromTextArea(this.textdom, {\r\n        mode                : this.mode,\r\n        firstLineNumber     : 1,\r\n        lineNumbers         : true,\r\n        styleActiveLine     : true,\r\n        lineWrapping        : true,\r\n        smartIndent         : true,\r\n        indentWithTabs      : true,\r\n        newlineAndIndent    : true,\r\n        autoCloseBrackets   : true,\r\n        matchBrackets       : {afterCursor: true},\r\n        extraKeys           : {\"Ctrl-F\": \"find\", \"Tab\": \"autocomplete\" },\r\n        refresh             : true\r\n    });\r\n\r\n    this.setCodemirrorSize(editor, mode);\r\n    editor.defaultCharWidth('20px');\r\n    if(this.darkMode) editor.setOption(\"theme\", 'erlang-dark');\r\n    else editor.setOption(\"theme\", 'neo');\r\n\r\n    return editor;\r\n} // colorizeTextArea()\r\n\r\n/*\r\n  set editor size according to screens\r\n  editor : code mirror editor Object\r\n  mode   : editor being viewed from schema/ doc/ query page*/\r\nCodemirror.prototype.setCodemirrorSize = function(editor, mode){\r\n  switch(mode){\r\n    case 'query':\r\n      editor.setSize('800', '400');\r\n    break;\r\n    case 'schema':\r\n      editor.setSize('1200', '1550');\r\n    break;\r\n    case 'document':\r\n     editor.setSize('765', '500');\r\n    break;\r\n    case 'api-doc':\r\n        editor.setSize('800', '500');\r\n    break;\r\n  } // switch(mode)\r\n} // setCodemirrorSize()\r\n\r\n// updateTextArea(): highlights new changes on editor\r\nCodemirror.prototype.updateTextArea = function(editor){\r\n  editor.save();\r\n  setTimeout(function() {\r\n      editor.refresh();\r\n  },1);\r\n  // save changes of code mirror editor\r\n  editor.on('change', function(){\r\n    editor.save();\r\n  });\r\n} //updateTextArea()\r\n\r\n/*\r\ncolorizePre() to colorise pre tags (read only mode)\r\ntext (string)    : The document to run through the highlighter.\r\nmode (mode spec) : format to highlight color\r\noutput (DOM node): The tokens will be converted to spans as in an editor,\r\n                   and inserted into the node (through innerHTML).*/\r\nCodemirror.prototype.colorizePre = function(){\r\n  CodeMirror.runMode(this.textdom.innerText, this.mode, this.textdom);\r\n  if(this.darkMode)\r\n      var theme = 'cm-s-erlang-dark';\r\n  else var theme = 'cm-s-neo';\r\n  this.textdom.setAttribute('class', 'CodeMirror CodeMirror-wrap ' + theme + ' terminus-wrap-text terminus-wrapper-height ');\r\n  return this.textdom;\r\n} // colorizePre()\r\n\r\nCodemirror.prototype.jsonldCheck = function(format){\r\n  if(format == 'jsonld') return true;\r\n}\r\n\r\nmodule.exports=Codemirror\r\n","/**\r\n * object renderer binds to object frame - provides filters, sorts and manipulations of underlying object frame\r\n * and coordinates viewer to draw updates\r\n\r\n * Object Renderer - provides sorting / filtering / state management of objects\r\n * @param obj ObjectFrame object - contains underlying data and frame structure\r\n * @param parent PropertyRenderer - property that owns this object (if any)\r\n * @param options options json\r\n * @returns\r\n */\r\n\r\nconst RenderingMap = require('./RenderingMap');\r\nconst ValueRenderer = require('./ValueRenderer');\r\nconst ObjectViewer = require('./ObjectViewer');\r\nconst PropertyViewer = require('./PropertyViewer');\r\nconst HTMLDataViewer = require('./DataViewer');\r\n\r\nfunction PropertyRenderer(prop, parent, options){\r\n\tthis.predicate = prop;\r\n\tthis.parent = parent;\r\n\tthis.cframe = this.parent.objframe.getPropertyClassFrame(this.predicate);\r\n\tthis.originalValues = false;\r\n\tthis.changed = false;\r\n\tthis.values = [];\r\n\tthis.renderer_type = \"property\";\r\n\tthis.options = this.setOptions(options);\r\n}\r\n\r\nPropertyRenderer.prototype.setOptions = function(options){\r\n\treturn TerminusDashboard.RenderingMap.decorateRenderer(options, this);\r\n}\r\n\r\nPropertyRenderer.prototype.getOptionsForChild = function(){\r\n\tvar opts = {};\r\n\tif(this.options.features){ opts.features = this.options.features };\r\n\tif(this.options.controls){ opts.controls = this.options.controls};\r\n\treturn this.options;\r\n}\r\n\r\nPropertyRenderer.prototype.getOptionsForValue = function(df, index){\r\n\treturn this.getOptionsForChild();\r\n}\r\n\r\nPropertyRenderer.prototype.getOptionsForObject = function(objframe){\r\n\treturn this.getOptionsForChild();\r\n}\r\n\r\n\r\nPropertyRenderer.prototype.render = function(viewer){\r\n \tthis.buildValueRenderers();\r\n \tif(this.cframe && this.cframe.property){\r\n \t\tthis.viewer = (viewer ? viewer : this.getViewerForProperty());\r\n \t\tfor(var i = 0; i<this.values.length; i++){\r\n \t\t\tvar renderedval = this.values[i].render();\r\n \t\t\tif(renderedval && this.showFeature(\"body\")) this.viewer.addRenderedValue(renderedval);\r\n \t\t}\r\n \t\treturn this.viewer.render();\r\n \t}\r\n} \r\n\r\n/*\r\n * Creates the array of object renderer or value renderer objects corresponding to the property values. \r\n */\r\nPropertyRenderer.prototype.buildValueRenderers = function(){\r\n \tvar adorig = (this.originalValues === false ? true : false);\r\n \tthis.cframe = this.parent.objframe.getPropertyClassFrame(this.predicate);\r\n \tif(!this.cframe){\r\n \t\tconsole.error(\"No frame for \" + this.property() + \" id: \" + this.subject());\r\n \t\treturn false;\r\n \t}\r\n \tif(this.cframe && this.cframe.isData()){\r\n \t\tvar dataframes = this.getDataFramesToRender();\r\n \t\tif(dataframes.length == 0){\r\n \t\t\talert(this.predicate);\r\n \t\t}\r\n \t\tvar vals = [];\r\n \t\tfor(var i = this.values.length; i<dataframes.length; i++){\r\n \t\t\tvar vr = new ValueRenderer(dataframes[i], i, this, this.getOptionsForValue(dataframes[i], i));\r\n \t\t\tthis.values.push(vr);\r\n \t\t\tvals.push(vr.value());\r\n \t\t}\r\n \t\tif(adorig) this.originalValues = vals;\r\n \t}\r\n \telse {\r\n \t\tif(adorig) this.originalValues = [];\r\n \t\tvar kids = this.getChildrenToRender();\r\n \t\tif(kids && kids.length){\r\n \t\t\tfor(var i = this.values.length; i<kids.length; i++){\r\n \t\t\t\tvar kidf = new ObjectRenderer(kids[i], this, this.getOptionsForObject(kids[i]));\r\n \t\t\t\tif(adorig) this.originalValues.push(kidf.subject());\r\n \t\t\t\tthis.values.push(kidf);\r\n \t\t\t}\r\n \t\t}\r\n \t}\r\n}\r\n\r\n/*\r\n * Returns the array of values that should be rendered (enables value filtering)\r\n */\r\nPropertyRenderer.prototype.getDataFramesToRender = function(options){\r\n \tvar allvals = this.parent.objframe.getDataFrames(this.property());\r\n \treturn allvals;\r\n}\r\n\r\n/*\r\n * Returns the array of child / objects that should be rendered (enables value filtering)\r\n */\r\nPropertyRenderer.prototype.getChildrenToRender = function(options){\r\n \tif(TerminusClient.FrameHelper.viewIncludesChildren(this.view, \"property\")){\r\n \t\tvar allkids = this.parent.objframe.getChildren(this.property());\r\n \t}\r\n \telse {\r\n \t\tvar allkids = [];\r\n \t}\r\n \treturn allkids;\r\n}\r\n\r\nPropertyRenderer.prototype.redraw = function(){\r\n \tthis.viewer.clear();\r\n \tthis.render(this.viewer, \"x\");\r\n \t//alert(this.values.length);\r\n}\r\n\r\nPropertyRenderer.prototype.extract = function(){\r\n \tvar extracts = [];\r\n \tfor(var i = 0; i<this.values.length; i++){\r\n \t\tvar val = this.values[i].extract();\r\n \t\tif(val !== \"\" && val !== false && typeof val != \"undefined\") extracts.push(val);\r\n \t}\r\n \tif(this.cframe.isData()){\r\n \t\treturn extracts;\r\n \t}\r\n \telse {\r\n \t\treturn extracts;\r\n \t\tvar extr = {};\r\n \t\tfor(var i = 0; i<extracts.length; i++){\r\n \t\t\tfor(var subjid in extracts[i]){\r\n \t\t\t\textr[subjid] = extracts[i][subjid];\r\n \t\t\t}\r\n \t\t}\r\n \t\treturn extr;\r\n \t}\r\n}\r\n\r\n/*\r\n * simple wrapper functions\r\n */\r\nPropertyRenderer.prototype.currentViewer = function(){return this.viewerType;}\r\nPropertyRenderer.prototype.property = function(){return this.predicate;}\r\nPropertyRenderer.prototype.subject = function(){return (this.parent ? this.parent.subject() : false);};\r\nPropertyRenderer.prototype.depth = function(){return (this.parent ? this.parent.depth() : false);};\r\nPropertyRenderer.prototype.subjectClass = function(){return (this.parent ? this.parent.subjectClass() : false);};\r\nPropertyRenderer.prototype.updated = function(){ return (this.parent ? this.parent.childUpdated() : false);};\r\nPropertyRenderer.prototype.range = function(){\treturn (this.cframe ? this.cframe.range : \"\");};\r\nPropertyRenderer.prototype.getLabel = function(){ return (this.cframe ? this.cframe.getLabel() : \"\" );};\r\nPropertyRenderer.prototype.getComment = function(){ return (this.cframe ? this.cframe.getComment() : false);}\r\nPropertyRenderer.prototype.load = function(link){ return (this.parent ? this.parent.load(link) : false);}\r\nPropertyRenderer.prototype.hasCardinalityRestriction = function(){return (this.cframe ? this.cframe.hasRestriction() : false);};\r\nPropertyRenderer.prototype.getRestriction = function(){return (this.cframe ? this.cframe.restriction : false);};\r\nPropertyRenderer.prototype.isClassChoice = function(){\treturn (this.cframe ? this.cframe.isClassChoice() : false);};\r\nPropertyRenderer.prototype.currentFacet = function(){\treturn this.facet;} ;\r\nPropertyRenderer.prototype.save = function(){ return (this.parent ? this.parent.save() : false);};\r\n\r\nPropertyRenderer.prototype.cancel = function(){\r\n\tthis.reset();\r\n\tthis.setMode(\"view\");\r\n}\r\n\r\nPropertyRenderer.prototype.getAvailableClassChoices = function(){ \r\n\tif(this.cframe){\r\n\t\tvar cf = this.cframe.getClassChoices();\r\n\t\tif(this.parent){\r\n\t\t\tvar choices = [];\r\n\t\t\tfor(var i = 0; i < cf.length; i++){\r\n\t\t\t\tvar clsmeta = this.parent.getClassMeta(cf[i]);\r\n\t\t\t\tvar lab = ((clsmeta && clsmeta.Label && clsmeta.Label[\"@value\"]) ? clsmeta.Label[\"@value\"] : TerminusClient.FrameHelper.labelFromURL(cf[i]));\r\n\t\t\t\tchoices.push({value: cf[i], label: lab});\r\n\t\t\t}\r\n\t\t\treturn choices;\r\n\t\t}\r\n\t\treturn cf;\r\n\t\t\r\n\t}\r\n\treturn false;\r\n};\r\n\r\n\r\nPropertyRenderer.prototype.delete = function(){\r\n\tvar prop = this.predicate;\r\n\tif(prop){\r\n\t\tthis.reset();\r\n\t\tthis.parent.deleteProperty(prop);\t\r\n\t\tthis.parent.redraw();\r\n\t}\r\n}\r\n\r\nPropertyRenderer.prototype.add = function(view){\r\n\tthis.parent.addProperty(this.property(), view);\r\n\tthis.updated();\r\n\tif(view) {\r\n\t\tthis.values[this.values.length-1].setMode(view);\r\n\t\tthis.values[this.values.length-1].setNew();\r\n\t}\r\n\tthis.redraw();\r\n}\r\n\r\nPropertyRenderer.prototype.goToValue = function(index){\r\n\tthis.viewer.goTo(this.subject(), this.property(), index);\r\n}\r\n\r\nPropertyRenderer.prototype.addClass = function(cls){\r\n\tthis.parent.addPropertyClass(this.property(), cls);\r\n\tthis.updated();\r\n\tvar newb = this.values[this.values.length-1];\r\n\tif(newb){\r\n\t\tnewb.setNew();\r\n\t\tnewb.setMode(\"edit\");\r\n\t}\r\n\tthis.redraw();\r\n\tif(newb) this.viewer.goTo(newb.subject());\r\n}\r\n\r\nPropertyRenderer.prototype.reset = function(){\r\n\tthis.parent.objframe.reset(this.predicate);\r\n\tif(this.cframe && this.cframe.isData()){\r\n\t\tfor(var i = 0; i<this.values.length; i++){\r\n\t\t\tthis.values[i].reset();\r\n\t\t}\r\n\t\tthis.values = [];\r\n\t}\r\n\telse {\r\n\t\tvar nvals = [];\r\n\t\tfor(var i = 0; i<this.originalValues.length; i++){\r\n\t\t\tfor(var j = 0; j<this.values.length; j++){\r\n\t\t\t\tthis.values[j].reset();\r\n\t\t\t\tif(this.values[j].subject() == this.originalValues[i]){\r\n\t\t\t\t\tnvals.push(this.values[j]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.values = nvals;\r\n\t}\r\n\tthis.redraw();\t\r\n\tthis.parent.childUpdated();\r\n}\r\n\r\nPropertyRenderer.prototype.deletePropertyValue = function(value, index){\r\n\tthis.parent.objframe.removePropertyValue(this.property(), value, index);\r\n\tvar nvals = [];\r\n\tfor(var i = 0; i<this.values.length; i++){\r\n\t\tif(typeof index == \"undefined\"){\r\n\t\t\tif(this.values[i].subject() == value){\r\n\t\t\t\tthis.values[i].reset();\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tnvals.push(this.values[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if(i != index){\r\n\t\t\tthis.values[i].index = nvals.length;\r\n\t\t\tnvals.push(this.values[i]);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.values[i].reset();\r\n\t\t}\r\n\t}\r\n\tthis.values = nvals;\r\n\tthis.parent.childUpdated();\r\n\tthis.parent.redraw();\r\n}\r\n\r\nPropertyRenderer.prototype.addPropertyValue = function(value){\r\n\tthis.updated();\r\n\treturn this.parent.objframe.addPropertyValue(this.property(), value);\r\n}\r\n\r\n/*\r\n * Checks to see if an action (add, clone, delete) which affects the cardinality of the property is allowed by cardinality rules.\r\n */\r\nPropertyRenderer.prototype.cardControlAllows = function(action){\r\n\tif(this.cframe.hasRestriction()){\r\n\t\tvar rest = this.cframe.restriction;\r\n\t\tvar currentnum = this.values.length;\r\n\t\tif(action == \"add\" || action == \"clone\"){\r\n\t\t\tif(rest.max && currentnum >= rest.max){\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(action == \"delete\" && (rest.min)){\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nPropertyRenderer.prototype.isNew = function(){\r\n\tif(this.new_property){\r\n\t\treturn true;\r\n\t}\r\n\treturn this.parent.isNew();\r\n}\r\n\r\nPropertyRenderer.prototype.setNew = function(){\r\n\tthis.new_property = true;\r\n}\r\n\r\n\r\nPropertyRenderer.prototype.isUpdated = function(){\r\n\tif(this.values.length != this.originalValues.length) return true;\r\n\tfor(var i = 0 ; i < this.values.length; i++){\r\n\t\tif(this.cframe && this.cframe.isData()){\r\n\t\t\tif(this.values[i].value() != this.originalValues[i]){\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tif(this.values[i].subject() != this.originalValues[i]) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\tif(this.values[i].isUpdated()) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nPropertyRenderer.prototype.childUpdated = function(){\r\n\tthis.viewer.redrawHeader();\r\n\tif(this.parent) this.parent.childUpdated();\r\n}\r\n\r\n\r\n/**\r\n * Sets mode of viewer to either \"view\" or \"edit\"\r\n */\r\nPropertyRenderer.prototype.setMode = function(mode){\r\n\tthis.mode = mode;\r\n\tfor(var i = 0; i<this.values.length; i++){\r\n\t\tthis.values[i].setMode(mode);\r\n\t}\r\n\tthis.redraw();\r\n}\r\n\r\n/*\r\n * Jump to property value\r\n */\r\nPropertyRenderer.prototype.getViewableValues = function(){\r\n\tvar viewables = [];\r\n\tif(this.cframe && this.cframe.isData())\r\n\tfor(var i = 0; i<this.values.length; i++){\r\n\t\tvar sum = this.values[i].getSummary();\r\n\t\tvar lab = sum.long;\r\n\t\tviewables.push({label: lab, value: i});\r\n\t}\r\n\treturn viewables;\r\n}\r\n\r\nPropertyRenderer.prototype.hideDisabledControls = function(){\r\n\treturn this.hide_disabled_controls;\r\n}\r\n\r\nPropertyRenderer.prototype.setFacet = function(facet, nocascade){\r\n\tthis.facet = facet;\r\n\tif(!nocascade){\r\n\t\tfor(var i = 0; i<this.values.length; i++){\r\n\t\t\tthis.values[i].parentFacetChange(facet);\r\n\t\t}\r\n\t}\r\n\tthis.redraw();\r\n}\r\n\r\nPropertyRenderer.prototype.parentFacetChange = function(facet){\r\n\tif(facet == 'page'){\r\n\t\tif(!(this.facet == \"page\" || this.facet == \"multiline\")){\r\n\t\t\tthis.setFacet('multiline');\r\n\t\t}\r\n\t}\r\n\tif(facet == 'line'){\r\n\t\tthis.setFacet(\"label\");\r\n\t}\r\n\t\t\r\n}\r\n\r\n\r\n\r\nPropertyRenderer.prototype.getDefaultFacets = function(){\r\n\tvar defs = {\r\n\t\tpage: {\r\n\t\t\tlabel: \"Full Page\", value: \"page\", \r\n\t\t\tfeatures: [\"facet\", \"label\", \"comment\", \"id\", \"control\", \"type\", \"cardinality\", \"body\", \"status\", \"facet\", \"view\", \"viewer\"], \r\n\t\t\tcontrols: [\"delete\", \"clone\", \"add\", \"reset\", \"cancel\", \"update\", \"mode\", \"show\", \"hide\"]\r\n\t\t},\r\n\t\tmultiline: {\r\n\t\t\tlabel: \"Multiple Lines\", value: \"multiline\",\r\n\t\t\tfeatures: [\"facet\", \"label\", \"comment\", \"id\", \"control\", \"type\", \"cardinality\", \"body\", \"status\", \"facet\", \"view\", \"viewer\"], \r\n\t\t\tcontrols: [\"delete\", \"clone\", \"add\", \"reset\", \"cancel\", \"update\", \"mode\", \"show\", \"hide\"]\r\n\t\t},\r\n\t\tline: {\r\n\t\t\tlabel: \"Single Line\", value: \"line\",\r\n\t\t\tfeatures: [\"facet\", \"label\", \"comment\", \"id\", \"control\", \"type\", \"cardinality\", \"body\", \"status\", \"facet\", \"viewer\"], \r\n\t\t\tcontrols: [\"delete\", \"clone\", \"add\", \"reset\", \"cancel\", \"update\", \"mode\", \"show\", \"hide\"]\r\n\t\t},\r\n\t\tsummary: {\r\n\t\t\tlabel: \"Summary\", value: \"summary\",\r\n\t\t\tfeatures: [\"facet\", \"satus\", \"label\", \"type\", \"cardinality\", \"body\", \"status\", \"facet\", \"viewer\"], \r\n\t\t\tcontrols: [] \r\n\t\t},\r\n\t\tlabel: {\r\n\t\t\tlabel: \"Label\", value: \"label\",\r\n\t\t\tfeatures: [\"facet\", \"status\", \"label\", \"summary\"],\r\n\t\t\tcontrols: []\r\n\t\t},\r\n\t\ticon: {\r\n\t\t\tlabel: \"Snippet\", value: \"icon\",\r\n\t\t\tfeatures: [\"facet\", \"summary\"],\r\n\t\t\tcontrols: []\r\n\t\t}\r\n\t}\r\n\treturn defs;\t\r\n}\r\n\r\nPropertyRenderer.prototype.getAvailableFacets = function(){\r\n\treturn Object.values(this.facets);\r\n\tvar facets = [];\r\n\tfacets.push({label: \"Full Page\", value: \"page\"});\r\n\tfacets.push({label: \"Multiple Lines\", value: \"multiline\"});\r\n\tfacets.push({label: \"Single Line\", value: \"line\"});\r\n\tfacets.push({label: \"Summary\", value: \"summary\"});\r\n\tfacets.push({label: \"Label\", value: \"label\"});\r\n\tfacets.push({label: \"Snippet\", value: \"icon\"});\r\n\treturn facets;\r\n}\r\n\r\nPropertyRenderer.prototype.getContentOrientation = function(facet){\r\n\tif(this.currentFacet() == \"page\" || this.containsPage()){\r\n\t\treturn \"page\";\r\n\t}\r\n\tif(this.currentFacet() == \"line\" || this.currentFacet() == \"multiline\" || this.currentFacet() == \"summary\"){\r\n\t\treturn \"line\";\r\n\t}\r\n\treturn \"label\";\r\n}\r\n\r\n\r\nPropertyRenderer.prototype.getDefaultFacet = function(){\r\n\tif(this.cframe && this.cframe.isObject()){\r\n\t\treturn \"page\";\r\n\t}\r\n\treturn \"multiline\";\r\n}\r\n\r\n/*\r\n * Viewers for specific properties\r\n */\r\n\r\nPropertyRenderer.prototype.hide = function(){\r\n\tthis.setView(\"hidden\");\r\n}\r\n\r\nPropertyRenderer.prototype.show = function(){\r\n\tthis.setView(\"full\");\r\n}\r\n\r\nPropertyRenderer.prototype.setView = function(view){\r\n\tthis.view = view;\r\n\tthis.redraw();\r\n}\r\n\r\nPropertyRenderer.prototype.getAvailableViewers = function(){\r\n\tif(this.mode == \"view\"){\r\n\t\treturn TerminusDashboard.RenderingMap.getAvailablePropertyViewers(this);\t\t\r\n\t}\r\n\treturn TerminusDashboard.RenderingMap.getAvailablePropertyEditors(this);\t\t\t\t\r\n}\r\n\r\nPropertyRenderer.prototype.nukeViewer = function(){\r\n\tthis.viewer.remove();\r\n}\r\n\r\nPropertyRenderer.prototype.containsPage = function(){\r\n\t//collapsed facets do not show their values\r\n\tif(this.currentFacet() == \"icon\" || this.currentFacet() == \"label\") return false;\r\n\tfor(var i = 0; i<this.values.length; i++){\r\n\t\tif(this.values[i].facet == \"page\") {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nPropertyRenderer.prototype.getViewerForProperty = function(ptype){\r\n\tif(this.mode == \"edit\"){\r\n\t\treturn new PropertyViewer.HTMLPropertyViewer(this);\r\n\t}\r\n\treturn new PropertyViewer.HTMLPropertyViewer(this);\r\n}\r\n\r\nPropertyRenderer.prototype.getPropertyHeaderViewer = function(){\r\n\treturn new PropertyViewer.HTMLPropertyHeaderViewer();\r\n}\r\n\r\nPropertyRenderer.prototype.getSummary = function(){\r\n\tvar status = \"ok\";\r\n\tif(this.isNew()) status = \"new\";\r\n\telse if(this.isUpdated()) status = \"updated\";\r\n\tvar ret = {\r\n\t\tstatus: status,\r\n\t\tvalcount: this.values.length\r\n\t};\r\n\tret.long = ((ret.valcount != 1) ? \"(\" + ret.valcount + \") \" : \"\");\r\n\tfor(var i = 0; i<this.values.length; i++){\r\n\t\tvsum = this.values[i].getSummary();\r\n\t\tret.long += vsum.long;\r\n\t\tif(i < this.values.length-1) ret.long += \", \";\r\n\t}\r\n\treturn ret;\t\r\n}\r\n\r\nPropertyRenderer.prototype.getFeaturesForFacet = function(facet){\r\n\treturn this.facets[facet].features.concat(this.facets[facet].controls);\r\n}\r\n \r\nPropertyRenderer.prototype.showFeature = function(which){\r\n\tif(this.features.indexOf(which) == -1 && this.controls.indexOf(which) == -1) {\r\n\t\treturn false;\r\n\t}\r\n\tvar cardcontrols = [\"delete\", \"clone\", \"add\"];\r\n\tif(cardcontrols.indexOf(which) != -1){\r\n\t\tif(!this.cardControlAllows(which)) return false;\r\n\t}\r\n\tvar updcontrols = [\"update\", \"reset\"];\r\n\tif(this.hideDisabledControls() && updcontrols.indexOf(which) != -1 ){\r\n\t\tif(!this.isUpdated()){\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\tif(which == 'hide' && this.view == \"hidden\") return false;\r\n\tif(which == 'show' && this.view != \"hidden\") return false;\r\n\tvar fets = this.getFeaturesForFacet(this.facet);\r\n\treturn (fets.indexOf(which) != -1);\r\n}\r\n\r\nfunction ObjectRenderer(obj, parent, options){\r\n\tthis.objframe = obj;\r\n\tthis.parent = parent;\r\n\tthis.properties = {};\r\n\tthis.originalProperties = false;\r\n\tthis.newProperties = [];\r\n\tthis.renderer_type = \"object\";\r\n\tthis.options = this.setOptions(options);\r\n}\r\n\r\n//options has to include mode, viewer, facet, controls, features, hide_disabled_controls\r\n\r\nObjectRenderer.prototype.setOptions = function(options){\r\n\treturn TerminusDashboard.RenderingMap.decorateRenderer(options, this);\r\n}\r\n\r\nObjectRenderer.prototype.getOptionsForProperty = function(prop){\r\n\treturn this.options;\r\n}\r\n\r\nObjectRenderer.prototype.render = function(viewer){\r\n\tthis.buildPropertyRenderers();\r\n\tthis.viewer = (viewer ? viewer: this.getViewerForObject());\r\n\tfor(var prop in this.properties){\r\n\t\tvar renderedprop = this.properties[prop].render();\r\n\t\tif(renderedprop && this.showFeature(\"body\")) this.viewer.addRenderedProperty(prop, renderedprop);\r\n\t}\r\n\treturn this.viewer.render(this.view);\r\n}\r\n\r\nObjectRenderer.prototype.buildPropertyRenderers = function(){\r\n\tvar props = this.getPropertiesToRender();\r\n\tif(this.originalProperties === false) this.originalProperties = props;\r\n\tvar renders = {};\r\n\tfor(var j = 0; j<props.length; j++){\r\n\t\tif(typeof this.properties[props[j]] == \"undefined\"){\r\n\t\t\trenders[props[j]] = new PropertyRenderer(props[j], this, this.getOptionsForProperty(props[j]));\r\n\t\t}\r\n\t\telse {\r\n\t\t\trenders[props[j]] = this.properties[props[j]];\r\n\t\t}\r\n\t\tif(this.newProperties.indexOf(props[j]) != -1) {\r\n\t\t\trenders[props[j]].setNew(); \r\n\t\t\trenders[props[j]].mode = \"edit\"; \r\n\t\t}\r\n\t}\r\n\tthis.properties = renders;\r\n}\r\n\r\nObjectRenderer.prototype.subject = function(){\r\n\tif(this.objframe) return this.objframe.subjid;\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.subjectClass = function(){\r\n\tif(this.objframe) return this.objframe.cls;\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.getAvailableViewers = function(){\r\n\t//if(this.mode == \"view\"){\r\n\t//\treturn RenderingMap.getAvailableObjectViewers(this);\t\t\r\n\t//}\r\n\t//return RenderingMap.getAvailableObjectEditors(this);\t\t\t\t\r\n\treturn [\"html\", \"json\"];\r\n}\r\n\r\nObjectRenderer.prototype.depth = function(){\r\n\tif(this.parent) return (this.parent.depth() + 1);\r\n\treturn 0;\r\n}\r\n\r\n\r\nObjectRenderer.prototype.property = function(){\r\n\tif(this.parent) return this.parent.property();\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.parentObject = function(){\r\n\tif(this.parent && this.parent.parent && this.parent.parent.objframe){\r\n\t\treturn this.parent.parent.objframe;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.root = function(){\r\n\tif(this.parent) return false;\r\n\treturn true;\r\n}\r\n\r\nObjectRenderer.prototype.load = function(link){\r\n\tvar self = this;\r\n\tif(this.controller){\r\n\t\tthis.controller.ui.showDocument(link);\r\n\t}\r\n\telse if(this.parent) {\r\n\t\tthis.parent.load(link);\r\n\t}\r\n}\r\n\r\nObjectRenderer.prototype.copy = function(nkid){\r\n\tnkid = (nkid ? nkid : this.objframe);\r\n\tvar other = new ObjectRenderer(nkid, this.parent, this.options);\r\n\treturn other;\r\n}\r\n\r\nObjectRenderer.prototype.clone = function(){\r\n\tif(this.root()){\r\n\t\tthis.objframe = this.objframe.clone(\"_:\");\r\n\t\tthis.objframe.newDoc = true;\r\n\t\tthis.setMode(\"edit\");\r\n\t}\r\n\telse {\r\n\t\tvar nkid = this.objframe.clone(TerminusClient.FrameHelper.genBNID());\r\n\t\tvar parentobj = this.parentObject();\r\n\t\tvar prop = this.property();\r\n\t\tif(parentobj && prop){\r\n\t\t\tif(typeof parentobj.children[prop] == \"undefined\"){\r\n\t\t\t\tparentobj.children[prop] = [];\r\n\t\t\t}\r\n\t\t\tparentobj.children[prop].push(nkid);\r\n\t\t\tvar newrend = this.copy(nkid);\r\n\t\t\tthis.parent.values.push(newrend);\r\n\t\t}\r\n\t\tthis.parent.redraw();\r\n\t}\r\n}\r\n\r\nObjectRenderer.prototype.cancel = function(){\r\n\tthis.reset();\r\n\tthis.setMode(\"view\");\r\n}\r\n\r\nObjectRenderer.prototype.save = function(){\r\n\tif(this.controller){\r\n\t\tif(this.isNewDocument()){\r\n\t\t\tvar demandid = this.inputID();\r\n\t\t\tif(demandid == \"_:\") demandid = \"\";\r\n\t\t\tthis.controller.createDocument(demandid);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.controller.updateDocument();\r\n\t\t}\r\n\t}\r\n\telse if(this.parent) {\r\n\t\tthis.parent.save();\r\n\t}\r\n}\r\n\r\nObjectRenderer.prototype.delete = function(){\r\n\tvar dval = this.subject();\r\n\tif(this.controller && this.root()){\r\n\t\tif(!this.isNewDocument()){\r\n\t\t\tthis.controller.deleteDocument(dval);\r\n\t\t}\r\n\t\tthis.nukeViewer();\r\n\t}\r\n\telse {\r\n\t\tif(this.parent){\r\n\t\t\tthis.parent.deletePropertyValue(dval);\t\t\r\n\t\t\tthis.parent.redraw();\r\n\t\t}\r\n\t}\r\n}\r\n\r\nObjectRenderer.prototype.reset = function(){\r\n\tthis.objframe.reset();\r\n\tvar nprops = {};\r\n\tfor(var i = 0; i<this.originalProperties.length; i++){\r\n\t\tvar prop = this.originalProperties[i];\r\n\t\tif(typeof this.properties[prop] == \"object\"){\r\n\t\t\tthis.properties[prop].reset();\r\n\t\t\tnprops[prop] = this.properties[prop];\r\n\t\t}\r\n\t}\r\n\tthis.properties = nprops;\r\n\tthis.redraw();\r\n}\r\n\r\nObjectRenderer.prototype.deleteProperty = function(prop){\r\n\tthis.objframe.removeProperty(prop);\r\n\tdelete(this.properties[prop]);\r\n\tthis.updated();\r\n}\r\n\r\nObjectRenderer.prototype.addProperty = function(prop){\r\n\tthis.objframe.addProperty(prop);\r\n\tthis.updated();\r\n\tthis.redraw();\r\n}\r\n\r\nObjectRenderer.prototype.addNewProperty = function(prop){\r\n\tthis.objframe.addProperty(prop);\r\n\tthis.updated();\r\n\tthis.newProperties.push(prop);\r\n\tthis.redraw();\r\n\tthis.goToProperty(prop);\r\n}\r\n\r\nObjectRenderer.prototype.addPropertyClass = function(prop, cls){\r\n\tthis.objframe.addProperty(prop, cls);\r\n\tthis.updated();\r\n}\r\n\r\nObjectRenderer.prototype.changeClass = function(cls){\r\n\tif(this.parent){\r\n\t\tthis.parent.addClass(cls);\t\t\r\n\t\tthis.parent.deletePropertyValue(this.subject());\t\t\r\n\t}\r\n}\r\n\r\nObjectRenderer.prototype.getClassMeta = function(cls){\r\n\tvar ctl = this.getController();\r\n\tif(ctl && ctl.classmeta && ctl.classmeta[cls]){\r\n\t\treturn ctl.classmeta[cls];\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.getController = function(){\r\n\tif(this.controller){\r\n\t\treturn this.controller;\r\n\t}\r\n\tif(this.parent && this.parent.parent){\r\n\t\treturn this.parent.parent.getController();\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.getClient = function(){\r\n\tif(this.controller){\r\n\t\treturn this.controller.getClient();\r\n\t}\r\n\telse {\r\n\t\tif(this.parent && this.parent.parent){\r\n\t\t\treturn(this.parent.parent.getClient())\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.inputID = function(){\r\n\tif(this.idDOM){\r\n\t\treturn this.idDOM.value;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.isNew = function(){\r\n\tif(this.new_object){\r\n\t\treturn true;\r\n\t}\r\n\tif(this.isPartOfNewDocument()){\r\n\t\treturn true;\r\n\t}\r\n\tif(this.parent) return this.parent.isNew();\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.setNew = function(){\r\n\tthis.new_object = true;\r\n}\r\n\r\nObjectRenderer.prototype.isUpdated = function(){\r\n\tvar i = 0;\r\n\tfor(var prop in this.properties){\r\n\t\tif(this.originalProperties[i] != prop) return true;\r\n\t\tif(this.properties[prop].isUpdated()) return true;\r\n\t\ti++;\t\t\r\n\t}\r\n\tif(i != this.originalProperties.length) return true;\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.childUpdated = function(){\r\n\tthis.viewer.redrawHeader();\r\n\tif(this.parent) this.parent.childUpdated();\r\n}\r\n\r\nObjectRenderer.prototype.updated = ObjectRenderer.prototype.childUpdated;\r\n\r\nObjectRenderer.prototype.isNewDocument = function(){\r\n\tif(this.root() && this.objframe.isnew()) return true;\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.isPartOfNewDocument = function(){\r\n\tif(this.isNewDocument()) return true;\r\n\tif(this.parent && this.parent.parent){\r\n\t\treturn this.parent.parent.isPartOfNewDocument();\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.setFacet = function(facet, nocascade){\r\n\tthis.facet = facet;\r\n\tif(!nocascade){\r\n\t\tfor(var prop in this.properties){\r\n\t\t\tthis.properties[prop].parentFacetChange(facet);\r\n\t\t}\r\n\t}\r\n\tif(this.parent){\r\n\t\tthis.parent.redraw();\r\n\t}\r\n\telse {\r\n\t\tthis.redraw();\r\n\t}\r\n}\r\n\r\nObjectRenderer.prototype.getDefaultFacets = function(){\r\n\tvar defs = {\r\n\t\tpage: {\r\n\t\t\tlabel: \"Full Page\", value: \"page\", \r\n\t\t\tfeatures: [\"facet\", \"label\", \"comment\", \"id\", \"control\", \"type\", \"body\", \"status\", \"facet\", \"view\", \"viewer\"],\r\n\t\t\tcontrols: [\"delete\", \"clone\", \"add\", \"reset\", \"cancel\", \"update\", \"mode\", \"show\", \"hide\"] \r\n\t\t},\r\n\t\tline: {\r\n\t\t\tlabel: \"Single Line\", value: \"line\",\r\n\t\t\tfeatures: [\"facet\", \"label\", \"comment\", \"id\", \"type\", \"body\", \"status\", \"facet\"], \r\n\t\t\tcontrols: [] \r\n\t\t},\r\n\t\tsummary: {\r\n\t\t\tlabel: \"Summary\", value: \"summary\",\r\n\t\t\tfeatures: [\"facet\", \"satus\", \"label\", \"type\", \"summary\", \"status\", \"facet\"], \r\n\t\t\tcontrols: [] \r\n\t\t},\r\n\t\tlabel: {\r\n\t\t\tlabel: \"Label\", value: \"label\",\r\n\t\t\tfeatures: [\"facet\", \"status\", \"label\"],\r\n\t\t\tcontrols: []\r\n\t\t}\r\n\t}\r\n\treturn defs;\r\n}\r\n\r\nObjectRenderer.prototype.getAvailableFacets = function(){\r\n\treturn Object.keys(this.facets);\r\n}\r\n\r\nObjectRenderer.prototype.currentFacet = function(){\r\n\treturn this.facet;\r\n}\r\n\r\nObjectRenderer.prototype.getDefaultFacet = function(){\r\n\tif(!this.parent) return \"page\";\r\n\tvar pfacet = this.parent.currentFacet();\r\n\tif(pfacet == \"page\"){\r\n\t\treturn \"page\";\r\n\t}\r\n\tif(pfacet == \"multiline\") return \"line\";\r\n\tif(pfacet == \"line\") return \"summary\";\r\n\treturn \"label\";\r\n}\r\n\r\nObjectRenderer.prototype.parentFacetChange = function(pfacet){\r\n\tif(pfacet == \"page\") this.setFacet(\"page\");\r\n\tif(pfacet == \"multiline\") this.setFacet(\"summary\");\r\n\tif(pfacet == \"line\") this.setFacet(\"summary\");\r\n\tif(pfacet == \"summary\") this.setFacet(\"summary\");\r\n}\r\n\r\nObjectRenderer.prototype.getContentOrientation = function(){\r\n\tif(this.currentFacet() == \"page\"){\r\n\t\treturn \"page\";\r\n\t}\r\n\tif(this.currentFacet() == \"line\"){\r\n\t\treturn \"line\";\r\n\t}\r\n\treturn \"label\";\r\n}\r\n\r\nObjectRenderer.prototype.getLabel = function(){\r\n\tfor(var prop in this.properties){\r\n\t\tif(TerminusClient.FrameHelper.getShorthand(prop) == \"rdfs:label\" || prop == \"rdfs:label\"){\r\n\t\t\tvar prend = this.properties[prop];\r\n\t\t\tvar vrend = prend.values[0];\r\n\t\t\tif(vrend){\r\n\t\t\t\tvar sum = vrend.getSummary();\r\n\t\t\t\tif(sum.long != \"empty\") return sum.long;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tvar s = this.subject();\r\n\tif(s && s.substring(0, 2) == \"_:\"){\r\n\t\tvar ty = this.subjectClass();\r\n\t\tvar sh = TerminusClient.FrameHelper.getShorthand(ty);\r\n\t\tif(!sh) sh = ty;\r\n\t\tvar b = sh.split(\":\");\r\n\t\tif(b.length > 1){\r\n\t\t\treturn \"New \" + b[1];\r\n\t\t}\r\n\t\treturn \"New Object\";\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.getSummary = function(){\r\n\tvar ret = { status: \"ok\" };\r\n\tif(this.isUpdated()) ret.status = \"updated\";\r\n\tif(this.isNew()) ret.status = \"new\";\r\n\tret.propcount = 0;\r\n\tfor(var prop in this.properties){\r\n\t\tret.propcount++;\r\n\t}\r\n\tret.long = ret.propcount + \" properties\";\r\n\treturn ret;\t\r\n}\r\n\r\nObjectRenderer.prototype.getObjectHeaderViewer = function(){\r\n\treturn this.header_viewer;\r\n}\r\n\r\nObjectRenderer.prototype.getViewerForObject = function(format){\r\n\tif(format == \"json\"){\r\n\t\treturn new ObjectViewer.JSONObjectViewer(this);\r\n\t}\r\n\treturn new ObjectViewer.HTMLObjectViewer(this);\r\n}\r\n\r\nObjectRenderer.prototype.getFeaturesForFacet = function(facet){\r\n\treturn this.facets[facet].features.concat(this.facets[facet].controls);\r\n}\r\n \r\nObjectRenderer.prototype.hideDisabledControls = function(){\r\n\treturn this.hide_disabled_controls;\r\n}\r\n\r\nObjectRenderer.prototype.showFeature = function(which){\r\n\tif(this.features.indexOf(which) == -1 && this.controls.indexOf(which) == -1) {\r\n\t\treturn false;\r\n\t}\r\n\tvar cardcontrols = [\"delete\", \"clone\", \"add\"];\r\n\tif(cardcontrols.indexOf(which) != -1){\r\n\t\tif(!this.cardControlAllows(which)) return false;\r\n\t}\r\n\tvar updcontrols = [\"update\", \"reset\"];\r\n\tif(this.hideDisabledControls() && updcontrols.indexOf(which) != -1 ){\r\n\t\tif(!this.isUpdated()){\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\tif(this.isNewDocument() && which == \"clone\") return false;\r\n\tif(which == 'hide' && this.view == \"hidden\") return false;\r\n\tif(which == 'show' && this.view != \"hidden\") return false;\r\n\tvar fets = this.getFeaturesForFacet(this.facet);\r\n\tif (fets.indexOf(which) != -1){\r\n\t\treturn true;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.cardControlAllows = function(action){\r\n\tif(!this.parent) return true;\r\n\tif(this.parent.cframe.hasRestriction()){\r\n\t\tvar rest = this.parent.cframe.restriction;\r\n\t\tvar currentnum = this.parent.values.length;\r\n\t\tif(action == \"add\" || action == \"clone\"){\r\n\t\t\tif(rest.max && currentnum >= rest.max){\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(action == \"delete\" && (rest.min && currentnum <= rest.min)){\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nObjectRenderer.prototype.goToProperty = function(prop){\r\n\tthis.viewer.goTo(this.subject(), prop);\r\n}\r\n\r\nObjectRenderer.prototype.setMode = function(mode){\r\n\tthis.mode = mode;\r\n\tfor(var prop in this.properties){\r\n\t\tthis.properties[prop].setMode(mode);\r\n\t}\r\n\tthis.viewer.redraw();\r\n}\r\n\r\nObjectRenderer.prototype.currentViewer = function(){return this.viewerType;}\r\n\r\n\r\nObjectRenderer.prototype.setViewer = function(viewer){\r\n\tvar nviewer = this.getViewerForObject(viewer);\r\n\tif(nviewer){\r\n\t\tthis.viewerType = viewer;\r\n\t\tthis.viewer = nviewer;\r\n\t\tthis.viewer.redraw();\r\n\t}\r\n}\r\n\r\n\r\nObjectRenderer.prototype.setView = function(view){\r\n\tvar views = {\r\n\t\t\"full\": {\r\n\t\t\t\r\n\t\t},\r\n\t\t\"hidden\": {\r\n\t\t\t\r\n\t\t}\r\n\t};\r\n\tthis.view = view;\r\n\tthis.viewer.redraw();\r\n}\r\n\r\n\r\nObjectRenderer.prototype.hide = function(){\r\n\tthis.setView(\"hidden\");\r\n}\r\n\r\nObjectRenderer.prototype.show = function(){\r\n\tthis.setView(\"full\");\r\n}\r\n\r\nObjectRenderer.prototype.nukeViewer = function(){\r\n\tthis.viewer.remove();\r\n}\r\n\r\nObjectRenderer.prototype.getViewableProperties = function(){\r\n\treturn this.objframe.getFilledPropertyList();\t\r\n}\r\n\r\nObjectRenderer.prototype.getAddableProperties = function(){\r\n\tvar props = this.objframe.getMissingPropertyList();\t\r\n\treturn props;\r\n}\r\n\r\nObjectRenderer.prototype.getPropertiesToRender = function(options){\r\n\tvar sort = this.standardSort;\r\n\tvar filter = function(){return true};\r\n\tif(options && options.map && options.map.patterns){\r\n\t\t/*for(var i = 0; i<options.map.patterns.length; i++){\r\n\t\t\tif(this.objframe.matchesPattern({property: this.property(), action: \"sort\"}, options.map.patterns[i])){\r\n\t\t\t\tsort = options.map.patterns[i].sort;\r\n\t\t\t}\r\n\t\t\tif(this.objframe.matchesPattern({property: this.property(), action: \"filter\"}, options.map.patterns[i])){\r\n\t\t\t\tfilter = options.map.patterns[i].filter;\r\n\t\t\t}\r\n\t\t}*/\r\n\t}\r\n\treturn sort(this.objframe, filter);\r\n}\r\n\r\nObjectRenderer.prototype.standardSort = function(objframe, filter){\r\n\tvar sorted = [];\r\n\tvar rdft = TerminusClient.FrameHelper.getStdURL(\"rdfs\", \"label\");\r\n\tif(objframe.dataframes[rdft] && filter(objframe, rdft, objframe.dataframes[rdft])){\r\n\t\tsorted.push(rdft);\r\n\t}\r\n\tvar rdfc = TerminusClient.FrameHelper.getStdURL(\"rdfs\", \"comment\");\r\n\tif(objframe.dataframes[rdfc]){\r\n\t\tsorted.push(rdfc);\r\n\t}\r\n\tfor(var prop in objframe.dataframes){\r\n\t\tif(sorted.indexOf(prop) == -1) sorted.push(prop);\r\n\t}\r\n\tfor(var prop in objframe.children){\r\n\t\tif(sorted.indexOf(prop) == -1) sorted.push(prop);\t\t\r\n\t}\r\n\treturn sorted;\r\n}\r\n\r\n\r\nObjectRenderer.prototype.redraw = function(){\r\n\tthis.viewer.clear();\r\n\tthis.render(this.viewer);\r\n}\r\n\r\nObjectRenderer.prototype.extractLDO = function(extracts){\r\n\textracts[\"rdf:type\"] = this.objframe.cls;\r\n\tvar full = {};\r\n\tfull[this.subject()] = extracts;\r\n\treturn full;\t\r\n}\r\n\r\nObjectRenderer.prototype.extractJSONLD = function(extracts){\r\n\textracts[\"@type\"] = this.objframe.cls;\r\n\tif(this.subject() != \"_:\")\textracts[\"@id\"] = this.subject();\r\n\tif(this.objframe.jsonld_context) extracts['@context'] = this.objframe.jsonld_context;\r\n\treturn extracts;\r\n}\r\n\r\nObjectRenderer.prototype.extract = function(){\r\n\tvar extracts = {};\r\n\tfor(var i in this.properties){\r\n\t\tvar extracted = this.properties[i].extract();\r\n\t\tif(!TerminusClient.FrameHelper.empty(extracted)){\r\n\t\t\textracts[i] = extracted;\r\n\t\t}\r\n\t}\r\n\tif(TerminusClient.FrameHelper.empty(extracts) && this.parent){\r\n\t\treturn false;\r\n\t}\r\n\telse {\r\n\t\tvar ext = this.extractJSONLD(extracts);\r\n\t\treturn ext;\r\n\t\t//return this.extractLDO(extracts);\r\n\t}\r\n}\r\n\r\nmodule.exports={ObjectRenderer,PropertyRenderer}\r\n\r\n","\r\n\r\nfunction HTMLStringEditor(options){\r\n\tthis.css = ((options && options.css) ? \"terminus-literal-value \" + options.css : \"terminus-literal-value\");\r\n\tthis.options = options; \r\n}\r\n\r\nHTMLStringEditor.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar ty = TerminusClient.FrameHelper.getShorthand(renderer.frame.getType());\r\n\tty = (ty ? ty : renderer.frame.getType());\r\n\tvar value = renderer.value();\r\n\tvar big = ((this.options && typeof this.options.big != \"undefined\") ? this.options.big : this.isBigType(ty, value));\r\n\tif(big){\r\n\t\tvar input = document.createElement(\"textarea\");\r\n\t\tthis.css += \" terminus-literal-big-value\";\t\t\r\n\t}\r\n\telse {\r\n\t\tvar size = ((this.options && typeof this.options.size != \"undefined\") ? this.options.size : this.getTypeSize(ty, value));\r\n\t\tvar input = document.createElement(\"input\");\r\n\t\tinput.setAttribute('type', \"text\");\r\n\t\tinput.setAttribute('size', size);\r\n\t}\r\n\tinput.setAttribute('class', this.css);\r\n\tinput.value = value;\r\n\tvar self = this;\r\n\tinput.addEventListener(\"input\", function(){\r\n\t\trenderer.set(this.value);\r\n\t});\r\n\treturn input;\r\n}\r\n\r\nHTMLStringEditor.prototype.isBigType = function(ty, value){\r\n\tif(value && value.length && value.length > 100) return true;\r\n\tvar longs = [\"xdd:coordinatePolyline\", \"xdd:coordinatePolygon\", \"xsd:base64Binary\", \"xdd:html\", \"xdd:json\", \"rdf:XMLLiteral\"];\r\n\tif(longs.indexOf(ty) == -1) return false;\r\n\treturn true;\r\n}\r\n\r\nHTMLStringEditor.prototype.getTypeSize = function(ty, value){\r\n\tif(value && value.length && value.length > 40) return 80;\r\n\tvar bigs = [\"xdd:url\", \"xdd:coordinate\", \"xsd:anyURI\"];\r\n\tvar smalls = [\"xsd:gYearMonth\", \"xdd:gYearRange\", \"xsd:decimal\", \"xsd:float\", \"xsd:time\", \"xsd:date\", \r\n\t\t\"xsd:dateTimeStamp\",\"xsd:gYearMonth\", \"xsd:gMonthDay\", \"xsd:duration\", \"xsd:yearMonthDuration\", \"xsd:dayTimeDuration\", \r\n\t\t\"xsd:nonNegativeInteger\", \"xsd:positiveInteger\", \"xsd:negativeInteger\",\t\"xsd:nonPositiveInteger\", \"xsd:integer\",\"xsd:unsignedInt\"];\r\n\tvar tinys = [\"xsd:boolean\", \"xsd:gYear\", \"xsd:gMonth\", \"xsd:gDay\", \"xsd:byte\", \"xsd:short\", \"xsd:unsignedByte\", \"xsd:language\"];\r\n\tif(bigs.indexOf(ty) != -1) return 80;\r\n\tif(smalls.indexOf(ty) != -1) return 16;\r\n\tif(tinys.indexOf(ty) != -1) return 8;\r\n\treturn 32;\r\n}\r\n\r\nmodule.exports={HTMLStringEditor}\r\n\r\n\r\n","function HTMLBooleanViewer(options){\r\n\tthis.css = \"terminus-literal-value terminus-literal-value-range \" + ((options && options.css) ?  options.css : \"\");\r\n}\r\n\r\nHTMLBooleanViewer.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar value = renderer.value();\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', this.css);\r\n\tif(value){\r\n\t\tvar vallab = document.createTextNode(value);\r\n\t\tinput.appendChild(vallab);\r\n\t}\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={HTMLBooleanViewer}\r\n\r\n","function HTMLBooleanEditor(options){\r\n\tthis.css = \"terminus-literal-value terminus-literal-value-range \" + ((options && options.css) ?  options.css : \"\");\r\n}\r\n\r\nHTMLBooleanEditor.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar value = renderer.value();\r\n\tvar input = document.createElement(\"input\");\r\n\tinput.setAttribute('type', \"checkbox\");\r\n\tif(value){\r\n\t\tinput.setAttribute(\"checked\", \"checked\");\t\t\t\t\t\r\n\t}\r\n\tinput.addEventListener(\"change\", function(){\r\n\t\tif(value){\r\n\t\t\trenderer.set(\"\");\r\n\t\t}\r\n\t\telse {\r\n\t\t\trenderer.set(\"true\");\r\n\t\t}\r\n\t});\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={HTMLBooleanEditor}\r\n\r\n","function HTMLChoiceViewer(options){};\r\n\r\nHTMLChoiceViewer.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar value = renderer.value();\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', \"terminus-literal-value terminus-choice-value\");\r\n\tinput.setAttribute('data-value', value);\r\n\tif(value){\r\n\t\tvar els = renderer.frame.frame.elements;\r\n\t\tfor(var i = 0; i<els.length; i++){\r\n\t\t\tif(els[i].class == value){\r\n\t\t\t\tif(els[i].label && els[i].label[\"@value\"]){\r\n\t\t\t\t\tvar lab = els[i].label[\"@value\"];\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tlab = TerminusClient.FrameHelper.labelFromURL(value);\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t\tinput.appendChild(document.createTextNode(lab));\r\n\t\t\t\tcontinue;\r\n\t\t\t}\t\t\t\t\r\n\t\t}\r\n\t}\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={HTMLChoiceViewer}\r\n\r\n\r\n","const HTMLFrameHelper = require('../HTMLFrameHelper');\r\n\r\nfunction HTMLChoiceEditor(options){};\r\n\r\nHTMLChoiceEditor.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar value = renderer.value();\r\n\tvar optInput = document.createElement(\"select\");\r\n\toptInput.setAttribute('class', \"terminus-choice-picker\");\r\n\tvar foptions = renderer.frame.getChoiceOptions();\r\n\tfoptions.unshift({ value: \"\", label: \"Not Specified\"});\r\n\tvar callback = function(val){\r\n\t\trenderer.set(val);\r\n\t}\r\n\tvar sel = HTMLFrameHelper.getSelectionControl(\"select-choice\", foptions, value, callback);\r\n\treturn sel;\r\n}\r\n\r\nmodule.exports={HTMLChoiceEditor}\r\n\r\n","\r\nfunction HTMLCoordinateViewer(options){\r\n\tthis.inputs = [];\r\n}\r\n\r\nHTMLCoordinateViewer.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar ty = TerminusClient.FrameHelper.getShorthand(renderer.frame.getType());\r\n\tty = (ty ? ty : renderer.frame.getType());\r\n\tvar value = renderer.value();\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', \"terminus-literal-value terminus-literal-coordinate\");\r\n\tinput.setAttribute('data-value', value);\r\n\ttry {\r\n\t\tvar parsed = (value ? JSON.parse(value) : false);\r\n\t}\r\n\tcatch(e){\r\n\t\trenderer.badData(ty + \" failed to parse as json\", e.toString());\r\n\t\tvar parsed = false;\r\n\t\tvalue = false;\r\n\t}\r\n\tif(value){\r\n\t\tif(ty == \"xdd:coordinate\"){\r\n\t\t\tparsed = [parsed];\r\n\t\t}\r\n\t\tfor(var i = 0; i < parsed.length; i++){\r\n\t\t\tvar lldom = document.createElement(\"span\");\r\n\t\t\tlldom.setAttribute(\"class\", \"latlong\");\r\n\t\t\tlldom.appendChild(document.createTextNode(\"Latitude: \"));\r\n\t\t\tlldom.appendChild(document.createTextNode(parsed[i][0] + \" °\" + \" \"));\r\n\t\t\tlldom.appendChild(document.createTextNode(\"Longitude: \"));\r\n\t\t\tlldom.appendChild(document.createTextNode(parsed[i][1] + \" °\" ));\r\n\t\t\tinput.appendChild(lldom);\r\n\t\t}\r\n\t}\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={HTMLCoordinateViewer}\r\n\r\n","function HTMLCoordinateEditor(options){\r\n\tthis.inputs = [];\r\n}\r\n\r\nHTMLCoordinateEditor.prototype.getInputDOMs = function(lat, long, change){\r\n\tvar latdom = document.createElement(\"input\");\r\n\tlatdom.setAttribute(\"type\", \"text\");\r\n\tlatdom.value = lat;\r\n\tvar longdom = document.createElement(\"input\");\r\n\tlongdom.setAttribute(\"type\", \"text\");\r\n\tlongdom.value = long;\r\n\tlatdom.addEventListener(\"change\", change);\r\n\tlongdom.addEventListener(\"change\", change);\r\n\treturn [latdom, longdom];\r\n}\r\n\r\nHTMLCoordinateEditor.prototype.getLatLongDOM = function(lat, long, ty, index, parent){\r\n\tvar lldom = document.createElement(\"span\");\r\n\tlldom.setAttribute(\"class\", \"terminus-lat-long\");\r\n\tvar firstcol = document.createElement(\"span\");\r\n\tfirstcol.setAttribute(\"class\", \"terminus-lat-long-col\");\r\n\tlldom.appendChild(firstcol);\r\n\tif(index > 2 || (ty == \"xdd:coordinatePolyline\" && index > 1)){\r\n\t\tvar delbut = document.createElement(\"button\");\r\n\t\tdelbut.setAttribute(\"class\", \"delete-coordinate\");\r\n\t\tdelbut.appendChild(document.createTextNode(\"Remove\"));\r\n\t\tdelbut.addEventListener(\"click\", function(){\r\n\t\t\tlong.value = \"\";\r\n\t\t\tlat.value = \"\";\r\n\t\t\tparent.removeChild(lldom);\r\n\t\t});\r\n\t\tfirstcol.appendChild(delbut);\r\n\t}\r\n\tlldom.appendChild(document.createTextNode(\"Latitude: \"));\r\n\tlldom.appendChild(lat);\r\n\tlldom.appendChild(document.createTextNode(\" °\" + \" \"));\r\n\tlldom.appendChild(document.createTextNode(\"  Longitude: \"));\r\n\tlldom.appendChild(long);\r\n\tlldom.appendChild(document.createTextNode(\" ° \" ));\r\n\treturn lldom;\r\n}\r\n\r\n\r\nHTMLCoordinateEditor.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar ty = renderer.frame.getTypeShorthand();\r\n\tvar value = renderer.value();\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', \"terminus-literal-value terminus-literal-coordinate\");\r\n\tinput.setAttribute('data-value', value);\r\n\ttry {\r\n\t\tvar parsed = (value ? JSON.parse(value) : false);\r\n\t}\r\n\tcatch(e){\r\n\t\trenderer.badData(ty + \" failed to parse as json\", e.toString());\r\n\t\tvar parsed = false;\r\n\t\tvalue = false;\r\n\t}\r\n\tvar self = this;\r\n\tvar updateValueFromForm = function(){\r\n\t\tvar vals = [];\r\n\t\tfor(var i = 0; i<self.inputs.length; i++){\r\n\t\t\tif(self.inputs[i][0].value && self.inputs[i][1].value){\r\n\t\t\t\tvar val = \"[\" + self.inputs[i][0].value + \",\" + self.inputs[i][1].value + \"]\";\r\n\t\t\t\tvals.push(val);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(vals.length == 0){\r\n\t\t\trenderer.set(\"\");\r\n\t\t}\r\n\t\telse if(ty == \"xdd:coordinate\"){\r\n\t\t\trenderer.set(vals[0]);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tvar op = \"[\";\r\n\t\t\tfor(var i = 0; i<vals.length; i++){\r\n\t\t\t\top += vals[i];\r\n\t\t\t\tif(i+1 < vals.length) op += \",\";\r\n\t\t\t}\r\n\t\t\top += \"]\";\r\n\t\t\trenderer.set(op);\r\n\t\t}\r\n\t};\r\n\tif(!parsed){\r\n\t\tif(ty == \"xdd:coordinate\") parsed = [\"\",\"\"];\r\n\t\telse {\r\n\t\t\tparsed = [[\"\",\"\"],[\"\",\"\"]];\r\n\t\t\tif(ty == \"xdd:coordinatePolygon\") parsed.push([\"\",\"\"]);\r\n\t\t}\r\n\t}\r\n\tif(ty == \"xdd:coordinate\"){\r\n\t\tparsed = [parsed];\r\n\t}\r\n\tfor(var i = 0; i < parsed.length; i++){\r\n\t\tthis.inputs.push(this.getInputDOMs(parsed[i][0], parsed[i][1], updateValueFromForm))\r\n\t}\r\n\tvar lldoms = document.createElement(\"span\");\r\n\tfor(var i = 0; i < this.inputs.length; i++){\r\n\t\tvar lldom = this.getLatLongDOM(this.inputs[i][0], this.inputs[i][1], ty, i, lldoms);\r\n\t\tlldoms.appendChild(lldom);\r\n\t}\r\n\tinput.appendChild(lldoms);\r\n\tvar self = this;\r\n\tif(ty != \"xdd:coordinate\"){\r\n\t\tvar butspan = document.createElement(\"span\");\r\n\t\tbutspan.setAttribute(\"class\", \"terminus-add-coordinate\")\r\n\t\tvar addbut = document.createElement(\"button\");\r\n\t\taddbut.setAttribute(\"class\", \"terminus-add-coordinate\");\r\n\t\taddbut.appendChild(document.createTextNode(\"Add\"));\r\n\t\taddbut.addEventListener(\"click\", function(){\r\n\t\t\tvar ipdoms = self.getInputDOMs(\"\", \"\", updateValueFromForm);\r\n\t\t\tvar lldom = self.getLatLongDOM(ipdoms[0], ipdoms[1], ty, self.inputs.length, lldoms);\r\n\t\t\tlldoms.appendChild(lldom);\r\n\t\t\tself.inputs.push(ipdoms);\r\n\t\t});\r\n\t\tbutspan.appendChild(addbut);\r\n\t\tinput.appendChild(butspan);\t\t\t\r\n\t}\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={HTMLCoordinateEditor}","const DateHelper = require('./DateHelper');\r\n\r\nfunction HTMLDateViewer(options){\r\n\tthis.max = (options && options.max ? options.max : false);\r\n\tthis.min = (options && options.min ? options.min : false);\r\n\tthis.allowbce = (options && options.allowbce ? options.allowbce : false);\r\n\tthis.date_spacer = \"/\";\r\n\tthis.time_spacer = \":\";\r\n\tthis.datetime_separator = \", \";\r\n\tthis.helper = new DateHelper.HTMLDateHelper();\r\n}\r\n\r\nHTMLDateViewer.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar ty = TerminusClient.FrameHelper.getShorthand(renderer.frame.getType());\r\n\tty = (ty ? ty : renderer.frame.getType());\r\n\tvar value = renderer.value();\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', \"terminus-literal-value terminus-literal-date\");\r\n\tinput.setAttribute('data-value', value);\r\n\tif(value){\r\n\t\tvar parsed = TerminusClient.FrameHelper.parseDate(ty, value);\r\n\t\tvar datepart = this.getDateComponentDOM(parsed);\r\n\t\tvar timepart = this.getTimeComponentDOM(parsed);\r\n\t\tif(timepart) input.appendChild(timepart);\r\n\t\tif(timepart && datepart) input.appendChild(document.createTextNode(this.datetime_separator));\r\n\t\tif(datepart) input.appendChild(datepart);\r\n\t}\r\n\treturn input;\r\n}\r\n\r\nHTMLDateViewer.prototype.getTimeComponentDOM = function(parsed, ty){\r\n\tvar hdom = (parsed.hour ? document.createElement(\"span\") : false);\r\n\tif(hdom){\r\n\t\thdom.setAttribute(\"class\", \"terminus-time-hour\");\r\n\t\thdom.appendChild(document.createTextNode(parsed.hour));\r\n\t}\r\n\tvar mdom = (typeof parsed.minute != \"undefined\" ? document.createElement(\"span\") : false);\r\n\tif(mdom){\r\n\t\tmdom.setAttribute(\"class\", \"terminus-time-minute\");\r\n\t\tvar mlab = (parsed.minute < 10 ? parsed.minute : parsed.minute);\r\n\t\tmdom.appendChild(document.createTextNode(mlab));\r\n\t}\r\n\tvar sdom = (typeof parsed.second != \"undefined\" ? document.createElement(\"span\") : false);\r\n\tif(sdom){\r\n\t\tsdom.setAttribute(\"class\", \"terminus-time-second\");\r\n\t\tvar slab = (parsed.second < 10 ? parsed.second : parsed.second);\r\n\t\tsdom.appendChild(document.createTextNode(slab));\r\n\t}\r\n\tvar tz = (parsed.timezone ? document.createElement(\"span\") : false);\r\n\tif(tz){\r\n\t\tsdom.setAttribute(\"class\", \"terminus-time-timezone\");\r\n\t\tsdom.appendChild(document.createTextNode(parsed.timezone));\r\n\t}\r\n\tif(hdom || mdom || sdom || tz){\r\n\t\tvar dadom = document.createElement(\"span\");\r\n\t\tdadom.setAttribute(\"class\", \"terminus-time-components time-\"+ty);\r\n\t\tif(hdom) dadom.appendChild(hdom); \r\n\t\tif(mdom) {\r\n\t\t\tif(hdom) dadom.appendChild(document.createTextNode(this.time_spacer));\r\n\t\t\tdadom.appendChild(mdom); \r\n\t\t}\r\n\t\tif(sdom) {\r\n\t\t\tif(mdom || hdom) dadom.appendChild(document.createTextNode(this.time_spacer));\r\n\t\t\tdadom.appendChild(sdom); \r\n\t\t}\r\n\t\tif(tz){\r\n\t\t\tdadom.appendChild(document.createTextNode(\" (Timezone: \")); \r\n\t\t\tdadom.appendChild(sdom); \r\n\t\t\tdadom.appendChild(document.createTextNode(\")\")); \t\t\t\r\n\t\t}\r\n\t\treturn dadom;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLDateViewer.prototype.getDateComponentDOM = function(parsed, ty){\r\n\tvar ydom = (parsed.year ? document.createElement(\"span\") : false);\r\n\tif(ydom){\r\n\t\tydom.setAttribute(\"class\", \"terminus-date-year\");\r\n\t\tydom.appendChild(document.createTextNode(parsed.year));\r\n\t}\r\n\tvar mdom = (parsed.month ? document.createElement(\"span\") : false);\r\n\tif(mdom){\r\n\t\tmdom.setAttribute(\"class\", \"terminus-date-month\");\r\n\t\tmdom.appendChild(document.createTextNode(this.helper.getMonthName(parsed.month)));\t\t\r\n\t}\r\n\tvar ddom = (parsed.day ? document.createElement(\"span\") : false );\r\n\tif(ddom){\r\n\t\tddom.setAttribute(\"class\", \"terminus-date-day\");\r\n\t\tddom.appendChild(document.createTextNode(parsed.day));\t\t\r\n\t}\r\n\tif(ydom || mdom || ddom){\r\n\t\tvar dadom = document.createElement(\"span\");\r\n\t\tif(ddom) dadom.appendChild(ddom); \r\n\t\tif(mdom) {\r\n\t\t\tif(ddom) dadom.appendChild(document.createTextNode(this.date_spacer));\r\n\t\t\tdadom.appendChild(mdom); \r\n\t\t}\r\n\t\tif(ydom) {\r\n\t\t\tif(mdom || ddom) dadom.appendChild(document.createTextNode(this.date_spacer));\r\n\t\t\tdadom.appendChild(ydom); \r\n\t\t}\r\n\t\treturn dadom;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nmodule.exports={HTMLDateViewer}","const DateHelper = require('./DateHelper');\r\n\r\nfunction HTMLDateEditor(options){\r\n\tthis.max = (options && options.max ? options.max : false);\r\n\tthis.min = (options && options.min ? options.min : false);\r\n\tthis.allowbce = (options && options.allowbce ? options.allowbce : false);\r\n\tthis.date_spacer = \"/\";\r\n\tthis.time_spacer = \":\";\r\n\tthis.datetime_separator = \", \";\r\n\tthis.helper = new DateHelper.HTMLDateHelper();\r\n}\r\n\r\nHTMLDateEditor.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar ty = TerminusClient.FrameHelper.getShorthand(renderer.frame.getType());\r\n\tty = (ty ? ty : renderer.frame.getType())\r\n\tvar value = renderer.value();\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', \"terminus-literal-value terminus-literal-date\");\r\n\tinput.setAttribute('data-value', value);\r\n\tif(value){\r\n\t\tthis.parsed = TerminusClient.FrameHelper.parseDate(ty, value);\r\n\t}\r\n\telse this.parsed = {};\r\n\tvar datepart = this.getDateComponentDOM(this.parsed, ty, renderer);\r\n\tvar timepart = this.getTimeComponentDOM(this.parsed, ty, renderer);\r\n\tif(timepart) input.appendChild(timepart);\r\n\tif(timepart && datepart) input.appendChild(document.createTextNode(this.datetime_separator));\r\n\tif(datepart) input.appendChild(datepart);\r\n\treturn input;\r\n}\r\n\r\nHTMLDateEditor.prototype.set = function(part, val, renderer, ty){\r\n\tthis.parsed[part] = val;\r\n\tvar xsd = TerminusClient.FrameHelper.xsdFromParsed(this.parsed, ty);\r\n\tif(xsd){\r\n\t\trenderer.set(xsd);\r\n\t}\r\n}\r\n\r\nHTMLDateEditor.prototype.getTimeComponentDOM = function(parsed, ty, renderer){\r\n\tif([\"xsd:dateTime\", \"xsd:dateTimeStamp\", \"xsd:time\"].indexOf(ty) == -1){\r\n\t\treturn false;\r\n\t}\r\n\tvar self = this;\r\n\tvar hdom = document.createElement(\"input\");\r\n\thdom.setAttribute(\"class\", \"terminus-hour-input terminus-hour-\"+ty);\r\n\thdom.setAttribute(\"size\", 2);\r\n\thdom.setAttribute(\"placeholder\", \"HH\");\r\n\thdom.value = (parsed.hour ? parsed.hour : \"\");\r\n\thdom.addEventListener(\"input\", function(){\r\n\t\tself.set(\"hour\", this.value, renderer, ty);\r\n\t});\r\n\tvar mdom = document.createElement(\"input\");\r\n\tmdom.setAttribute(\"class\", \"terminus-minute-input terminus-minute-\"+ty);\r\n\tmdom.setAttribute(\"size\", 2);\r\n\tmdom.setAttribute(\"placeholder\", \"MM\");\r\n\tmdom.value = (parsed.minute ? parsed.minute: \"\");\r\n\tmdom.addEventListener(\"input\", function(){\r\n\t\tself.set(\"minute\", this.value, renderer, ty);\r\n\t});\r\n\tvar sdom = document.createElement(\"input\");\r\n\tsdom.setAttribute(\"class\", \"terminus-second-input terminus-second-\"+ty);\r\n\tsdom.setAttribute(\"size\", 8);\r\n\tsdom.setAttribute(\"placeholder\", \"SS.sss...\");\r\n\tsdom.value = (parsed.second ? parsed.second: \"\");\r\n\tsdom.addEventListener(\"input\", function(){\r\n\t\tself.set(\"second\", this.value, renderer, ty);\r\n\t})\r\n\tvar tdom = document.createElement(\"span\");\r\n\ttdom.appendChild(hdom);\r\n\ttdom.appendChild(document.createTextNode(this.time_spacer));\r\n\ttdom.appendChild(mdom);\r\n\ttdom.appendChild(document.createTextNode(this.time_spacer));\r\n\ttdom.appendChild(sdom);\r\n\treturn tdom;\r\n}\r\n\r\nHTMLDateEditor.prototype.getDateComponentDOM = function(parsed, ty, renderer){\r\n\tvar self = this;\r\n\tif([\"xsd:date\", \"xsd:dateTime\", \"xsd:gYear\", \"xsd:gYearMonth\", \"xsd:dateTimeStamp\"].indexOf(ty) != -1){\r\n\t\tvar ydom = document.createElement(\"input\");\r\n\t\tydom.setAttribute(\"class\", \"terminus-year-input terminus-year-\"+ty);\r\n\t\tydom.setAttribute(\"size\", 6);\r\n\t\tydom.setAttribute(\"placeholder\", \"YYYY\");\r\n\t\tydom.value = (parsed.year ? parsed.year : \"\");\r\n\t\tydom.addEventListener(\"input\", function(){\r\n\t\t\tself.set(\"year\", this.value, renderer, ty);\r\n\t\t})\r\n\t}\r\n\tif([\"xsd:date\", \"xsd:dateTime\", \"xsd:gYearMonth\", \"xsd:dateTimeStamp\", \"xsd:gMonth\", \"xsd:gMonthDay\"].indexOf(ty) != -1){\r\n\t\tvar mdom = document.createElement(\"select\");\r\n\t\tmdom.setAttribute(\"class\", \"terminus-month-input terminus-month-\"+ty);\r\n\t\tfor(var i = 0; i<this.helper.months.length; i++){\r\n\t\t\tvar opdom = document.createElement(\"option\");\r\n\t\t\topdom.value = i+1;\r\n\t\t\topdom.appendChild(document.createTextNode(this.helper.months[i]));\r\n\t\t\tif(parsed.month && parsed.month == i+1){\r\n\t\t\t\topdom.selected = true;\r\n\t\t\t}\r\n\t\t\tmdom.appendChild(opdom);\r\n\t\t}\r\n\t\tmdom.addEventListener(\"change\", function(){\r\n\t\t\tself.set(\"month\", this.value, renderer, ty);\r\n\t\t})\r\n\t}\t\r\n\tif([\"xsd:date\", \"xsd:dateTime\", \"xsd:dateTimeStamp\", \"xsd:gDay\", \"xsd:gMonthDay\"].indexOf(ty) != -1){\r\n\t\tvar ddom = document.createElement(\"input\");\r\n\t\tddom.setAttribute(\"class\", \"terminus-day-input terminus-day-\"+ty);\r\n\t\tddom.setAttribute(\"size\", 2);\r\n\t\tddom.setAttribute(\"placeholder\", \"DD\");\r\n\t\tddom.value = (parsed.day ? parsed.day : \"\");\t\r\n\t\tddom.addEventListener(\"input\", function(){\r\n\t\t\tself.set(\"day\", this.value, renderer, ty);\r\n\t\t})\r\n\t}\t\r\n\tif(ydom || mdom || ddom){\r\n\t\tvar dadom = document.createElement(\"span\");\r\n\t\tif(ddom) dadom.appendChild(ddom); \r\n\t\tif(mdom) {\r\n\t\t\tif(ddom) dadom.appendChild(document.createTextNode(this.date_spacer));\r\n\t\t\tdadom.appendChild(mdom); \r\n\t\t}\r\n\t\tif(ydom) {\r\n\t\t\tif(mdom || ddom) dadom.appendChild(document.createTextNode(this.date_spacer));\r\n\t\t\tdadom.appendChild(ydom); \r\n\t\t}\r\n\t\treturn dadom;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nmodule.exports={HTMLDateEditor}","function HTMLEntityViewer(options){}\r\nHTMLEntityViewer.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar value = renderer.value();\r\n\tvar value = TerminusClient.FrameHelper.unshorten(value);\r\n\tvar holder = document.createElement(\"span\");\r\n\tholder.setAttribute(\"class\", \"terminus-literal-value terminus-entity-reference-value\");\r\n\tvar self = this;\r\n\tif(this.holder){\r\n\t\treturn this.holder;\r\n\t}\r\n\tif(value){\r\n\t\tvar dom = this.getEntityViewHTML(value, renderer, dataviewer);\t\t\r\n\t\tholder.appendChild(dom);\r\n\t}\r\n\treturn holder;\r\n}\r\n\r\nHTMLEntityViewer.prototype.getEntityViewHTML = function(value, renderer, dataviewer){\r\n\tvar span = document.createElement(\"span\");\r\n\tvar self = this;\r\n\tspan.setAttribute(\"class\", \"terminus-internal-link\");\r\n\tspan.appendChild(dataviewer.internalLink(value));\r\n\tif(controller = renderer.getController()){\r\n\t\tcontroller.getInstanceMeta(value).then(function(response){\r\n\t\t\tvar lab = self.getEntityLabel(value, response, dataviewer);\r\n\t\t\tif(lab){ \r\n\t\t\t\tTerminusClient.FrameHelper.removeChildren(span);\r\n\t\t\t\tspan.appendChild(lab);\r\n\t\t\t}\t\r\n\t\t});\r\n\t}\r\n\treturn span;\r\n}\r\n\r\nHTMLEntityViewer.prototype.getEntityLabel = function(url, response, dv){\r\n\tvar nspan = document.createElement(\"span\");\r\n\tif(response && typeof response.InstanceLabel == \"object\" && response.InstanceLabel[\"@value\"]){\r\n\t\tnspan.appendChild(dv.internalLink(url, response.InstanceLabel[\"@value\"]));\r\n\t\tvar tit = url + \" Type: \" + response.InstanceType;\r\n\t\tif(typeof response.InstanceComment == \"object\" && response.InstanceComment[\"@value\"]){\r\n\t\t\ttit += \" \" + response.InstanceComment[\"@value\"];\r\n\t\t}\r\n\t\tnspan.setAttribute(\"title\", tit);\r\n\t\treturn nspan;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nmodule.exports={HTMLEntityViewer}","function HTMLEntityEditor(options){}\r\nHTMLEntityEditor.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar value = renderer.value();\r\n\tvar input = document.createElement(\"input\");\r\n\tinput.setAttribute(\"class\", \"terminus-literal-value terminus-entity-reference-value\");\r\n\tinput.setAttribute(\"type\", \"text\");\r\n\tinput.setAttribute('size', 80);\r\n\tinput.value = value;\r\n\tvar self = this;\r\n\tinput.addEventListener(\"change\", function(){\r\n\t\tvar url = this.value;\r\n\t\tif(url.indexOf(\"/\") == -1 && url.indexOf(\":\") == -1){\r\n\t\t\turl = \"doc:\" + url;\r\n\t\t}\r\n\t\trenderer.set(url);\r\n\t});\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={HTMLEntityEditor}","function HTMLImageViewer(options){}\r\nHTMLImageViewer.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar value = renderer.value();\r\n\tvar ty = TerminusClient.FrameHelper.getShorthand(renderer.frame.getType());\r\n\tty = (ty ? ty : renderer.frame.getType());\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', \"terminus-literal-value terminus-literal-image-value\");\r\n\tinput.setAttribute('data-value', value);\r\n\tif(value){\r\n\t\tvar img = document.createElement(\"a\");\r\n\t\timg.setAttribute('src', value);\r\n\t\tinput.appendChild(img);\r\n\t}\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={HTMLImageViewer}\r\n\r\n\r\n","\r\n\r\nfunction HTMLImageEditor(options){}\r\nHTMLImageEditor.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar value = renderer.value();\r\n\tvar ty = TerminusClient.FrameHelper.getShorthand(renderer.frame.getType());\r\n\tty = (ty ? ty : renderer.frame.getType());\r\n\tif(ty == \"xsd:base64Binary\"){\r\n\t\tvar input = document.createElement(\"textarea\");\r\n\t\tinput.setAttribute('class', \"terminus-literal-value terminus-literal-b64image-value\");\r\n\t\tinput.value = value;\r\n\t\tinput.addEventListener(\"change\", function(){\r\n\t\t\trenderer.set(this.value);\r\n\t\t});\r\n\t\treturn input;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nmodule.exports={HTMLImageEditor}","function HTMLLinkViewer(options){\r\n\tthis.css = \"terminus-literal-value terminus-literal-value-range \" + ((options && options.css) ?  options.css : \"\");\r\n}\r\n\r\nHTMLLinkViewer.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar value = renderer.value();\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', this.css);\r\n\tinput.setAttribute('size', 80);\r\n\tinput.setAttribute('data-value', value);\r\n\tif(value){\r\n\t\tvar a = document.createElement(\"a\");\r\n\t\ta.setAttribute('href', value);\r\n\t\ta.appendChild(document.createTextNode(value));\r\n\t\tinput.appendChild(a);\r\n\t}\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={HTMLLinkViewer}\r\n\r\n","function HTMLNumberViewer(options){\r\n\tthis.commas = (options && options.commas ? options.commas : true);\r\n}\r\n\r\nHTMLNumberViewer.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar value = renderer.value();\r\n\tif(value === 0) value = \"0\";\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', 'terminus-number-value terminus-literal-value');\r\n\tinput.setAttribute('data-value', value);\r\n\tvalue = (this.commas ? TerminusClient.FrameHelper.numberWithCommas(value) : value);\r\n\tinput.appendChild(document.createTextNode(value));\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={HTMLNumberViewer}\r\n","function HTMLRangeViewer(options){\r\n\tthis.commas = (options && options.commas ? options.commas : true);\r\n\tthis.css = \"terminus-literal-value terminus-literal-value-range \" + ((options && options.css) ?  options.css : \"\");\r\n\tthis.delimiter = (options && options.delimiter ? options.delimiter : false);\r\n}\r\n\r\nHTMLRangeViewer.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar value = renderer.value();\r\n\tvar vals = TerminusClient.FrameHelper.parseRangeValue(value, this.delimiter);\r\n\tvar d = document.createElement(\"span\");\r\n\td.setAttribute(\"class\", this.css);\r\n\tvar rvals = document.createElement(\"span\");\r\n\trvals.setAttribute(\"class\", \"terminus-range-value-left\");\r\n\tvar svals = document.createElement(\"span\");\r\n\tsvals.setAttribute(\"class\", \"terminus-range-value-right\");\r\n\tvar x = (this.commas ? TerminusClient.FrameHelper.numberWithCommas(vals[0]) : vals[0]);\r\n\tvar tnode = document.createTextNode(x);\r\n\trvals.appendChild(tnode);\r\n\td.appendChild(rvals);\t\r\n\tif(vals.length == 2){\r\n\t\td.appendChild(getRangeSymbolDOM());\r\n\t\tvar x2 = (this.commas ? TerminusClient.FrameHelper.numberWithCommas(vals[1]) : vals[1]);\r\n\t\tvar t2node = document.createTextNode(x2);\r\n\t\tsvals.appendChild(t2node);\r\n\t\td.appendChild(svals);\t\r\n\t}\r\n\treturn d;\r\n}\r\n\r\nfunction getRangeSymbolDOM(){\r\n\tvar d = document.createElement(\"span\");\r\n\td.setAttribute(\"class\", \"terminus-range-indicator\");\r\n\td.setAttribute(\"title\", \"The value is uncertain, it lies somewhere in this range\");\r\n\td.appendChild(document.createTextNode(\" ... \"));\r\n\treturn d;\r\n}\r\n\r\nmodule.exports={HTMLRangeViewer}\r\n","function HTMLRangeEditor(options){\r\n\tthis.commas = (options && options.commas ? options.commas : true);\r\n\tthis.css = \"terminus-literal-value terminus-literal-value-range \" + ((options && options.css) ?  options.css : \"\");\r\n\tthis.delimiter = (options && options.delimiter ? options.delimiter : false);\r\n}\r\n\r\nHTMLRangeEditor.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar value = renderer.value();\r\n\tvar vals = TerminusClient.FrameHelper.parseRangeValue(value, this.delimiter);\r\n\tvar d = document.createElement(\"span\");\r\n\td.setAttribute(\"class\", this.css);\r\n\tvar rvals = document.createElement(\"span\");\r\n\tvar svals = document.createElement(\"span\");\r\n\tvar data1 = (vals.length > 0 ? vals[0] : \"\");\r\n\tvar data2 = (vals.length > 1 ? vals[1] : \"\");\r\n\tvar firstip = document.createElement(\"input\");\r\n\tfirstip.setAttribute('type', \"text\");\r\n\tfirstip.setAttribute('size', 16);\r\n\tif(data1){\r\n\t\tfirstip.value = data1;\r\n\t}\r\n\tvar secondip = document.createElement(\"input\");\r\n\tsecondip.setAttribute('type', \"text\");\r\n\tsecondip.setAttribute('size', 16);\r\n\tif(data2){\r\n\t\tthis.showing_range = true;\r\n\t\tsecondip.value = data2;\r\n\t}\r\n\trvals.appendChild(firstip);\r\n\td.appendChild(rvals);\t\r\n\tif(this.showing_range){\r\n\t\tsvals.appendChild(getRangeSymbolDOM());\r\n\t\tsvals.appendChild(secondip);\r\n\t}\r\n\td.appendChild(svals);\t\r\n\tvar but = document.createElement(\"button\");\r\n\tbut.setAttribute(\"class\", \"terminus-change-range\");\r\n\tvar txt = this.showing_range ? \"Change to Simple Value\" : \"Change to Uncertain Range\";\r\n\tbut.appendChild(document.createTextNode(txt));\r\n\td.appendChild(but);\t\r\n\tvar self = this;\r\n\tbut.addEventListener(\"click\", function(){\r\n\t\tif(self.showing_range){\r\n\t\t\tself.showing_range = false;\r\n\t\t\tsecondip.value = \"\";\t\t\t\t\r\n\t\t\tTerminusClient.FrameHelper.removeChildren(svals);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tself.showing_range = true;\r\n\t\t\tsecondip.value = \"\";\t\t\t\t\r\n\t\t\tsvals.appendChild(getRangeSymbolDOM());\r\n\t\t\tsvals.appendChild(secondip);\r\n\t\t}\r\n\t\tvar txt = self.showing_range ? \"Change to Simple Value\" : \"Change to Uncertain Range\";\r\n\t\tbut.innerText = txt;\r\n\t\tchangeHandler();\r\n\t});\r\n\tvar changeHandler = function(){\r\n\t\tif(self.showing_range && secondip.value){\r\n\t\t\tif(firstip.value) renderer.set(\"[\" + firstip.value + \",\" + secondip.value + \"]\");\t\t\t\t\r\n\t\t\telse renderer.set(secondip.value);\t\t\t\t\r\n\t\t}\r\n\t\telse {\r\n\t\t\trenderer.set(firstip.value);\r\n\t\t}\r\n\t}\r\n\tfirstip.addEventListener(\"change\", changeHandler);\r\n\tsecondip.addEventListener(\"change\", changeHandler);\r\n\treturn d;\r\n}\r\n\r\nfunction getRangeSymbolDOM(){\r\n\tvar d = document.createElement(\"span\");\r\n\td.setAttribute(\"class\", \"terminus-range-indicator\");\r\n\td.setAttribute(\"title\", \"The value is uncertain, it lies somewhere in this range\");\r\n\td.appendChild(document.createTextNode(\" ... \"));\r\n\treturn d;\r\n}\r\n\r\nmodule.exports={HTMLRangeEditor}\r\n","function SantizedHTMLViewer(options){\r\n\tthis.css = ((options && options.css) ? \"literal-value \" + options.css : \"literal-value\");\r\n}\r\n\r\nSantizedHTMLViewer.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar val = renderer.value();\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', this.css);\r\n\tinput.setAttribute('data-value', val);\r\n\tinput.innerHTML = val;\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={SantizedHTMLViewer}\r\n","const GoogleMapHelper = require(\"./GoogleMapHelper\")\r\n\r\nfunction GoogleMapEditor(options){}\r\n\r\nGoogleMapEditor.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar value = renderer.value();\r\n\tvar ty = TerminusClient.FrameHelper.getShorthand(renderer.frame.getType());\r\n\tty = (ty ? ty : renderer.frame.getType())\r\n\tvar mapcontainer = document.createElement(\"div\");\r\n\tmapcontainer.setAttribute('class', \"gmap-window gmap-editor\");\r\n\tvar self = this;\r\n\tvar ghelper = new GoogleMapHelper();\r\n\tvar map = ghelper.initMap(mapcontainer, renderer, value, ty);\r\n    if(ty == \"xdd:coordinate\"){\r\n\t    google.maps.event.addListener(map, 'click', function(event) {\r\n\t    \tvar position = event.latLng;\r\n\t    \tvar coo = \"[\" + position.lat() + \",\" + position.lng() + \"]\";\r\n\t    \trenderer.set(coo);\r\n\t        ghelper.clearMarkers();\r\n\t        var init = {\r\n\t    \t\tposition: position, \r\n\t    \t\tmap: map\r\n\t    \t}\r\n\t    \tvar marker = new google.maps.Marker(init);\r\n\t    \tghelper.markers.push(marker);\r\n\t  \t});\r\n\t}\r\n    else {\r\n    \tgoogle.maps.event.addListener(map, 'click', function(event) {\r\n        \tvar path = ghelper.polyline.getPath();\r\n        \tpath.push(event.latLng);\r\n      \t    var position = event.latLng;\r\n      \t    ghelper.addMarker(position, map, renderer, '#' + path.getLength(), ty);\r\n      \t});\r\n    }\r\n    return mapcontainer;\r\n}\r\n\r\nmodule.exports={GoogleMapEditor};","const GoogleMapHelper = require(\"./GoogleMapHelper\")\r\n\r\nfunction GoogleMapViewer(options){}\r\n\r\nGoogleMapViewer.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar value = renderer.value();\r\n\tvar ty = TerminusClient.FrameHelper.getShorthand(renderer.frame.getType());\r\n\tty = (ty ? ty : renderer.frame.getType())\r\n\t\tvar map = document.createElement(\"div\");\r\n\tmap.setAttribute('class', \"gmap-window gmap-viewer\");\r\n\tvar self = this;\r\n\tvar ghelper = new GoogleMapHelper();\r\n\tghelper.initMap(map, renderer, value, ty);\t\t\r\n    return map;\r\n}\r\n\r\nmodule.exports={GoogleMapViewer};","function HTMLMarkupEditor(options){}\r\nHTMLMarkupEditor.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar value = renderer.value();\r\n\tvar ty = TerminusClient.FrameHelper.getShorthand(renderer.frame.getType());\r\n\tty = (ty ? ty : renderer.frame.getType());\r\n\tvar input = document.createElement(\"div\");\r\n\tinput.setAttribute('class', \"html-wysiwyg\");\r\n\tvar inner = document.createElement(\"span\");\r\n\tinner.setAttribute('class', \"html-literal literal-value\");\r\n\tinner.innerHTML=value;\r\n\tinput.appendChild(inner);\r\n\tif(typeof Quill != \"undefined\"){\r\n\t\tvar quill = new Quill(inner, { theme: 'snow' });\r\n\t\tquill.on(\"text-change\", function(){\r\n\t\t\trenderer.set(quill.root.innerHTML);\r\n\t\t});\r\n\t}\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={HTMLMarkupEditor}","function S2EntityEditor(options){}\r\n\r\nS2EntityEditor.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar value = renderer.value();\r\n\tvar cls = renderer.frame.range;\r\n\tvar cback = renderer.set;\r\n\tvar ctl = renderer.getController();\r\n\tvar d2ch = new TerminusDocumentChooser(ctl.ui, cls, value);\r\n\td2ch.change = function(val){\r\n\t\trenderer.set(val);\r\n\t}\r\n\td2ch.view = \"label\";\r\n\tvar d2dom = d2ch.getAsDOM();\r\n\treturn d2dom;\r\n}\r\n\r\n\r\nmodule.exports={S2EntityEditor}","const HTMLPropertyViewer = require('./PropertyViewer');\r\nconst RenderingMap = require('./RenderingMap');\r\nconst HTMLDataViewer = require('./DataViewer');\r\n\r\nfunction ValueRenderer(dataframe, index, parent, options){\r\n\tthis.frame = dataframe;\r\n\tthis.index = index;\r\n\tthis.parent = parent;\r\n\tthis.originalValue = this.value();\r\n\tthis.renderer_type = \"value\";\r\n\tthis.options = this.setOptions(options);\r\n}\r\n\r\nValueRenderer.prototype.depth = function(){return (this.parent ? this.parent.depth() : false);};\r\nValueRenderer.prototype.property = function(){ return (this.parent ? this.parent.property() : false);};\r\nValueRenderer.prototype.subject = function(){ return (this.parent ? this.parent.subject() : false);};\r\nValueRenderer.prototype.subjectClass = function(){ return (this.parent ? this.parent.subjectClass() : false);};\r\nValueRenderer.prototype.type = function(){\treturn (this.frame ? this.frame.range : false);};\r\nValueRenderer.prototype.range = function(){\treturn (this.frame ? this.frame.range : false);};\r\nValueRenderer.prototype.value = function(){\treturn (this.frame ? this.frame.get() : false);};\r\nValueRenderer.prototype.isDocument = function(){\treturn (this.frame ? this.frame.isDocument() : false);};\r\nValueRenderer.prototype.currentViewer = function(){\treturn this.viewerType;}\r\n\r\nValueRenderer.prototype.copy = function(nf){\r\n\tvar nvr = new ValueRenderer(nf, false, this.parent, this.options);\r\n\tnvr.mode = this.mode;\r\n\tnvr.view = this.view;\r\n\treturn nvr;\r\n}\r\n\r\nValueRenderer.prototype.setFacet = function(facet){\r\n\tthis.facet = facet;\r\n\tthis.parent.redraw();\r\n}\r\n\r\nValueRenderer.prototype.parentFacetChange = function(pfacet){\r\n\tif(pfacet == \"page\") this.setFacet(\"page\");\r\n\tif(pfacet == \"multiline\") this.setFacet(\"line\");\r\n\tif(pfacet == \"line\") this.setFacet(\"inline\");\r\n\tif(pfacet == \"summary\") this.setFacet(\"icon\");\r\n}\r\n\r\nValueRenderer.prototype.getDefaultFacet = function(){\r\n\tif(this.parent.currentFacet() == \"page\" || this.parent.currentFacet() == \"multiline\"){\r\n\t\treturn \"line\";\r\n\t}\r\n\treturn \"inline\";\r\n}\r\n\r\nValueRenderer.prototype.getAvailableFacets = function(){\r\n\treturn Object.values(this.facets);\r\n}\r\n\r\nValueRenderer.prototype.getDefaultFacets = function(){\r\n\tvar defs = {\r\n\t\tpage: {\r\n\t\t\tlabel: \"Full Page\", value: \"page\",\r\n\t\t\tfeatures: [\"facet\", \"type\", \"cardinality\", \"body\", \"status\", \"facet\", \"viewer\", \"control\"],\r\n\t\t\tcontrols: [\"delete\", \"clone\", \"add\", \"reset\", \"cancel\", \"update\", \"mode\", \"show\", \"hide\"]\r\n\t\t},\r\n\t\tline: {\r\n\t\t\tlabel: \"Single Line\", value: \"line\",\r\n\t\t\tfeatures: [\"facet\", \"type\", \"cardinality\", \"body\", \"status\", \"facet\", \"viewer\", \"control\"],\r\n\t\t\tcontrols: [\"delete\", \"clone\", \"add\", \"reset\", \"cancel\", \"update\", \"mode\", \"show\", \"hide\"]\r\n\t\t},\r\n\t\tinline: {\r\n\t\t\tlabel: \"Inline\", value: \"inline\",\r\n\t\t\tfeatures: [\"facet\", \"type\", \"cardinality\", \"body\", \"status\", \"facet\", \"viewer\", \"control\"],\r\n\t\t\tcontrols: [\"delete\", \"clone\", \"add\", \"reset\", \"cancel\", \"update\", \"mode\", \"show\", \"hide\"]\r\n\t\t},\r\n\t\tlabel: {\r\n\t\t\tlabel: \"Label\", value: \"label\",\r\n\t\t\tfeatures: [\"facet\", \"status\", \"body\"],\r\n\t\t\tcontrols: []\r\n\t\t},\r\n\t\ticon: {\r\n\t\t\tlabel: \"Snippet\", value: \"icon\",\r\n\t\t\tfeatures: [\"facet\", \"summary\"],\r\n\t\t\tcontrols: []\r\n\t\t}\r\n\t}\r\n\treturn defs;\r\n}\r\n\r\nValueRenderer.prototype.currentFacet = function(){\r\n\treturn this.facet;\r\n}\r\n\r\nValueRenderer.prototype.setOptions = function(options){\r\n\treturn TerminusDashboard.RenderingMap.decorateRenderer(options, this);\r\n}\r\n\r\nValueRenderer.prototype.hideDisabledControls = function(){\r\n\treturn this.hide_disabled_controls;\r\n}\r\n\r\nValueRenderer.prototype.setMode = function(mode){\r\n\tthis.mode = mode;\r\n\tthis.options.mode = mode;\r\n\tthis.viewerType = false;\r\n\tthis.redraw();\r\n}\r\n\r\nValueRenderer.prototype.setView = function(view){\r\n\tthis.view = view;\r\n\tthis.options.view = view;\r\n\tthis.redraw();\r\n}\r\n\r\nValueRenderer.prototype.getAPIURL = function(a, b){\r\n\tif(this.parent && this.parent.parent){\r\n\t\tif(client = this.parent.parent.getClient()){\r\n\t\t\tvar apiurl = client.dbURL() + a + \"/\" + b;\r\n\t\t\treturn apiurl;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nValueRenderer.prototype.getClient = function(){\r\n\tif(this.parent && this.parent.parent){\r\n\t\treturn this.parent.parent.getClient();\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nValueRenderer.prototype.getController = function(){\r\n\tif(this.parent && this.parent.parent){\r\n\t\treturn this.parent.parent.getController();\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nValueRenderer.prototype.DBURL = function(){\r\n\tif(this.parent && this.parent.parent){\r\n\t\tif(client = this.parent.parent.getClient()){\r\n\t\t\treturn client.dbURL();\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nValueRenderer.prototype.getEntityReference = function(url, cls, entities, opts){\r\n\tif(this.parent && this.parent.parent){\r\n\t\tif(client = this.parent.parent.getClient()){\r\n\t\t\treturn client.getEntityReference(url, cls, entities, opts);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nValueRenderer.prototype.badData = function(bd){\r\n\talert(\"bad data \" + bd);\r\n}\r\n\r\nValueRenderer.prototype.setNew = function(){\r\n\tthis.new_value = true;\r\n}\r\n\r\nValueRenderer.prototype.isNew = function(){\r\n\tif(this.new_value){\r\n\t\treturn true;\r\n\t}\r\n\treturn this.parent.isNew();\r\n}\r\n\r\n\r\nValueRenderer.prototype.isUpdated = function(){\r\n\tif(this.frame.get() != this.originalValue){\r\n\t\treturn true;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nValueRenderer.prototype.getSummary = function(){\r\n\tvar ret = { status: \"ok\" };\r\n\tif(this.isNew()) ret.status = \"new\";\r\n\telse if(this.isUpdated()) ret.status = \"updated\";\r\n\tvar val = this.frame.get();\r\n\tif(val){\r\n\t\tif(val.length && val.length > this.text_summary_length){\r\n\t\t\tret.long = val.substring(0, this.text_summary_length) + \"...\" + \" (\" + val.length + \" characters)\";\r\n\t\t}\r\n\t\telse {\r\n\t\t\tret.long = val;\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tret.long = \"empty\";\r\n\t}\r\n\treturn ret;\r\n}\r\n\r\nValueRenderer.prototype.cardControlAllows = function(action){\r\n\tif(this.parent.cframe.hasRestriction()){\r\n\t\tvar rest = this.parent.cframe.restriction;\r\n\t\tvar currentnum = this.parent.values.length;\r\n\t\tif(action == \"add\" || action == \"clone\"){\r\n\t\t\tif(rest.max && currentnum >= rest.max){\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(action == \"delete\" && (rest.min && currentnum <= rest.min)){\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nValueRenderer.prototype.set = function(v){\r\n\tthis.frame.set(v);\r\n\tthis.viewer.redrawHeader();\r\n\tthis.parent.childUpdated();\r\n}\r\n\r\nValueRenderer.prototype.delete = function(){\r\n\tthis.parent.deletePropertyValue(this.value(), this.index);\r\n\tthis.parent.parent.redraw();\r\n}\r\n\r\nValueRenderer.prototype.load = function(link){\r\n\tthis.parent.load(link);\r\n}\r\n\r\nValueRenderer.prototype.hide = function(){\r\n\tthis.setView(\"hidden\");\r\n}\r\n\r\nValueRenderer.prototype.show = function(){\r\n\tthis.setView(\"full\");\r\n}\r\n\r\nValueRenderer.prototype.cancel = function(){\r\n\tthis.reset();\r\n\tthis.setMode(\"view\");\r\n}\r\n\r\nValueRenderer.prototype.save = function(){\r\n\tif(this.parent) {\r\n\t\tthis.parent.save();\r\n\t}\r\n}\r\n\r\nValueRenderer.prototype.reset = function(){\r\n\tthis.set(this.originalValue);\r\n\tthis.redraw();\r\n}\r\n\r\nValueRenderer.prototype.clone = function(){\r\n\tvar newb = this.parent.addPropertyValue(this.value());\r\n\tvar nrend = this.copy(newb);\r\n\tnrend.setNew();\r\n\tnrend.mode = \"edit\";\r\n\tnrend.index = this.parent.values.length;\r\n\tthis.parent.values.push(nrend);\r\n\tthis.parent.childUpdated();\r\n\tthis.parent.redraw();\r\n\tthis.parent.goToValue(this.parent.values.length-1);\r\n}\r\n\r\nValueRenderer.prototype.getViewerForValue = function(){\r\n\treturn new HTMLDataViewer.HTMLDataViewer(this);\r\n}\r\n\r\nValueRenderer.prototype.getFeaturesForFacet = function(facet){\r\n\treturn this.facets[facet].features.concat(this.facets[facet].controls);\r\n}\r\n\r\nValueRenderer.prototype.showFeature = function(which){\r\n\tif(this.features.indexOf(which) == -1 && this.controls.indexOf(which) == -1) {\r\n\t\treturn false;\r\n\t}\r\n\tvar cardcontrols = [\"delete\", \"clone\", \"add\"];\r\n\tif(cardcontrols.indexOf(which) != -1){\r\n\t\tif(!this.cardControlAllows(which)) return false;\r\n\t}\r\n\tvar updcontrols = [\"update\", \"reset\"];\r\n\tif(this.hideDisabledControls() && updcontrols.indexOf(which) != -1 ){\r\n\t\tif(!this.isUpdated()){\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\tif(which == 'hide' && this.view == \"hidden\") return false;\r\n\tif(which == 'show' && this.view != \"hidden\") return false;\r\n\tvar fets = this.getFeaturesForFacet(this.facet);\r\n\treturn (fets.indexOf(which) != -1);\r\n}\r\n\r\n\r\nValueRenderer.prototype.render = function(viewer){\r\n\tthis.viewer = (viewer ? viewer : this.getViewerForValue());\r\n\treturn this.viewer.render();\r\n}\r\n\r\nValueRenderer.prototype.extract = function(){\r\n\tvar val = this.value();\r\n\tif(val !== \"\" && val !== false){\r\n\t\tif(this.frame.isDatatypeProperty()){\r\n\t\t\tvar objlit = { \"@value\": this.value()}\r\n\t\t\t//var objlit = { data: this.value()}\r\n\t\t\tif(this.frame.isString()) objlit[\"@language\"] = this.frame.lang();\r\n\t\t\telse objlit[\"@type\"] = this.type();\r\n\t\t\treturn objlit;\r\n\t\t}\r\n\t\telse if(this.frame.isChoice() || this.frame.isDocument()){\r\n\t\t\treturn {\"@id\": val}\r\n\t\t}\r\n\t}\r\n\telse return val;\r\n}\r\n\r\nValueRenderer.prototype.getValueHeaderViewer = function(){\r\n\treturn new HTMLDataViewer.HTMLDataHeaderViewer();\r\n}\r\n\r\nValueRenderer.prototype.getDataValueViewer = function(){\r\n\tif(!this.viewerType) {\r\n\t\tthis.viewerType = this.getViewerForDataValue();\r\n\t}\r\n\treturn TerminusDashboard.RenderingMap.getViewer(this.viewerType, this.viewerOptions);\r\n}\r\n\r\nValueRenderer.prototype.getAvailableViewers = function(){\r\n\tvar dt = this.frame.getTypeShorthand();\r\n\tvar ft = this.frame.ftype();\r\n\tif(this.mode == \"view\"){\r\n\t\treturn TerminusDashboard.RenderingMap.getAvailableDataViewers(dt, ft);\r\n\t}\r\n\treturn TerminusDashboard.RenderingMap.getAvailableDataEditors(dt, ft);\r\n}\r\n\r\nValueRenderer.prototype.setViewer = function(viewer){\r\n\tthis.viewerType = viewer;\r\n\tthis.redraw();\r\n}\r\n\r\nValueRenderer.prototype.getViewerForDataValue = function(){\r\n\tvar dt = this.frame.getTypeShorthand();\r\n\tvar ft = this.frame.ftype();\r\n\tif(this.mode == \"edit\"){\r\n\t\treturn TerminusDashboard.RenderingMap.getEditorForDataFrame(dt, ft);\r\n\t}\r\n\treturn TerminusDashboard.RenderingMap.getViewerForDataFrame(dt, ft);\r\n}\r\n\r\nValueRenderer.prototype.redraw = function(){\r\n\tthis.viewer.clear();\r\n\tthis.render(this.viewer);\r\n}\r\n\r\n\r\n\r\n\r\n\r\nmodule.exports=ValueRenderer\r\n","/*\r\n * User Interface elements dealing with database level functions - view, delete, create, db\r\n * view document etc\r\n */\r\nconst WOQLResultsViewer = require('../query/WOQLResultsViewer');\r\nconst TerminusClassChooser = require('./TerminusClassChooser');\r\nconst TerminusDocumentChooser = require('./TerminusDocumentChooser');\r\nconst WOQLQuery=require('../query/WOQLQuery');\r\nconst UTILS=require('../Utils');\r\n\r\n/*\r\n * User Interface elements dealing with database level functions - view, delete, create, db\r\n * view document etc\r\n */\r\nfunction TerminusDBController(ui){\r\n\t this.ui = ui;\r\n}\r\n\r\n/*\r\n * Controller provides access to the server level functions (create/delete db) and db-level functions (schema, query, document)\r\n */\r\nTerminusDBController.prototype.getAsDOM = function(){\r\n\tvar self = this;\r\n\tvar dbc = document.createElement(\"div\");\r\n\tdbc.setAttribute(\"class\", \"terminus-db-controller\");\r\n\tif(this.ui && this.ui.db()){\r\n\t\tvar scd = document.createElement(\"div\");\r\n\t\tscd.setAttribute(\"class\", \"terminus-field terminus-db-connection\");\r\n\t\tvar lab = document.createElement(\"span\");\r\n\t\tlab.setAttribute(\"class\", \"terminus-label terminus-db-label terminus-control-panel-label\");\r\n\t\tlab.appendChild(document.createTextNode(\"DB \"));\r\n\t\tvar val = document.createElement(\"span\");\r\n\t\tval.setAttribute(\"class\", \"terminus-value terminus-db-value terminus-control-panel-value\");\r\n\t\tvar dbrec = this.ui.client.connection.getDBRecord();\r\n\t\tvar nm = (dbrec && dbrec[\"rdfs:label\"] && dbrec[\"rdfs:label\"][\"@value\"] ? dbrec[\"rdfs:label\"][\"@value\"] : this.ui.db());\r\n\t\tval.appendChild(document.createTextNode(nm));\r\n\t\tscd.appendChild(lab);\r\n\t\tscd.appendChild(val);\r\n\t\t//dbc.appendChild(scd);\r\n\t\tvar nav = document.createElement('div');\r\n\t\tnav.setAttribute('class', 'span3');\r\n\t\tdbc.appendChild(nav);\r\n\t\tvar ul = document.createElement('ul');\r\n\t\tul.setAttribute('class','terminus-ul' );\r\n\t\tnav.appendChild(ul);\r\n\t\t// connected to db\r\n\t\tvar a = document.createElement('a');\r\n        a.setAttribute('class', 'terminus-dashboard-info terminus-list-group-a terminus-nav-width');\r\n        var txt = 'Database: ' + nm;\r\n        a.appendChild(document.createTextNode(txt));\r\n        ul.appendChild(a);\r\n\t\tif(this.ui.showControl(\"db\")){\r\n\t\t\tvar item = this.getControlHTML(\"Database Home\", \"fa-home\");\r\n\t\t\titem.classList.add(\"terminus-selected\");\r\n\t\t    item.addEventListener(\"click\", function(){\r\n\t\t\t\tUTILS.activateSelectedNav(this, self);\r\n\t\t\t\tself.ui.showDBMainPage();\r\n\t\t\t });\r\n\t        ul.appendChild(item);\r\n\t    }\r\n\t\tif(this.ui.showControl(\"delete_database\")){\r\n\t\t\tvar item = this.getControlHTML(\"Delete Database\", \"fa-trash-alt\");\r\n\t\t    item.addEventListener(\"click\", function(){\r\n\t\t\t\tUTILS.activateSelectedNav(this, self);\r\n\t\t\t\tself.ui.deleteDatabase();\r\n\t\t\t });\r\n\t        ul.appendChild(item);\r\n\t\t}\r\n\t\tif(this.ui.showControl(\"woql_select\")){\r\n\t\t\tvar item = this.getControlHTML(\"Query\", \"fa-search\");\r\n\t\t    item.addEventListener(\"click\", function(){\r\n\t\t\t\tUTILS.activateSelectedNav(this, self);\r\n\t\t\t\tself.ui.showQueryPage();\r\n\t\t\t});\r\n\t        ul.appendChild(item);\r\n\t\t}\r\n\t\tif(this.ui.showControl(\"woql_update\")){\r\n\t\t\tvar item = this.getControlHTML(\"Mapping\", \"fa-file-import\");\r\n\t        item.addEventListener(\"click\", function(){\r\n\t\t\t\tUTILS.activateSelectedNav(this, self);\r\n\t\t\t\tself.ui.showMappingPage();\r\n\t\t\t})\r\n\t        ul.appendChild(item);\r\n\t\t}\r\n\t\tif(this.ui.showControl(\"get_schema\")){\r\n\t\t\tvar item = this.getControlHTML(\"Schema\", \"fa-cog\");\r\n\t        item.addEventListener(\"click\", function(){\r\n\t\t\t\tUTILS.activateSelectedNav(this, self);\r\n\t\t\t\tself.ui.showSchemaPage();\r\n\t\t\t})\r\n\t        ul.appendChild(item);\r\n\t\t}\r\n\t\tif((this.ui.showControl(\"get_document\") || this.ui.showControl(\"create_document\"))){\r\n\t\t\tvar item = this.getControlHTML(\"Document\", \"fa-book\");\r\n\t        item.addEventListener(\"click\", function(){\r\n\t\t\t\tUTILS.removeSelectedNavClass(\"terminus-selected\");\r\n                this.classList.add(\"terminus-selected\");\r\n\t\t\t\tself.displayDocumentSubMenus();\r\n\t\t\t})\r\n\t        ul.appendChild(item);\r\n\t\t}\r\n\t\t// hidden submenus\r\n\t\tif(this.ui.showControl(\"get_document\")) {\r\n\t\t\tvar a = document.createElement('a');\r\n\t\t\ta.setAttribute('class', 'terminus-hide terminus-get-doc');\r\n\t\t\ta.appendChild(self.getDocumentChooserDOM());\r\n\t\t\ta.classList.add();\r\n\t\t\tul.appendChild(a);\r\n\t\t}\r\n\t\t// hidden submenus\r\n\t\tif(this.ui.showControl(\"create_document\")) {\r\n\t\t\tvar a = document.createElement('a');\r\n\t\t\ta.setAttribute('class', 'terminus-hide terminus-create-doc');\r\n\t\t\ta.appendChild(self.getDocumentCreatorDOM());\r\n\t\t\tul.appendChild(a);\r\n\t\t}\r\n\t}\r\n\treturn dbc;\r\n}\r\n\r\n\r\nTerminusDBController.prototype.getControlHTML = function(text, ic, css){\r\n    var self = this;\r\n    var a = document.createElement('a');\r\n\ta.setAttribute('class', 'terminus-a terminus-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\r\n    var icon = document.createElement('i');\r\n    icon.setAttribute('class', 'terminus-menu-icon fa ' + ic);\r\n    a.appendChild(icon);\r\n    var txt = document.createTextNode(text);\r\n    a.appendChild(txt);\r\n    return a;\r\n}\r\n\r\nTerminusDBController.prototype.showSubMenus = function(el){\r\n\tel.classList.remove('terminus-hide');\r\n\tel.classList.add('terminus-display');\r\n}\r\n\r\nTerminusDBController.prototype.displayDocumentSubMenus = function(){\r\n\t//display submenus on click of documents\r\n\tif(this.ui.showControl(\"get_document\")) {\r\n\t\tvar gd = document.getElementsByClassName('terminus-get-doc');\r\n\t\tthis.showSubMenus(gd[0]);\r\n\t}\r\n\tif(this.ui.showControl(\"create_document\")) {\r\n\t\tvar cd = document.getElementsByClassName('terminus-create-doc');\r\n\t\tthis.showSubMenus(cd[0]);\r\n\t}\r\n}\r\n\r\n\r\nTerminusDBController.prototype.getDocumentChooserDOM = function(){\r\n\tvar self = this;\r\n\tvar scd = document.createElement(\"span\");\r\n\tscd.setAttribute(\"class\", \"terminus-document-chooser terminus-form-horizontal terminus-control-group terminus-choose-by-id\");\r\n\tvar lab = document.createElement(\"span\");\r\n\tlab.setAttribute(\"class\", \"terminus-document-chooser-label terminus-control-label terminus-control-label-padding\");\r\n\t//lab.appendChild(document.createTextNode(\"ID \"));\r\n\tvar dcip = document.createElement(\"input\");\r\n\tdcip.setAttribute(\"class\", \"terminus-form-doc-value terminus-document-chooser terminus-doc-input-text\");\r\n\tdcip.setAttribute(\"placeholder\", \"Enter Document ID\");\r\n\tvar nbut = document.createElement(\"button\");\r\n\tnbut.setAttribute('class', \"terminus-control-button terminus-document-button terminus-doc-btn\")\r\n\tnbut.appendChild(document.createTextNode(\"View\"));\r\n\tnbut.addEventListener(\"click\", function(){\r\n\t\tif(dcip.value) self.ui.showDocument(dcip.value);\r\n\t})\r\n\tif(this.ui.client.connectionConfig.platformEndpoint() && this.ui.pluginAvailable(\"select2\")){\r\n\r\n\t\tvar mcls = TerminusClient.FrameHelper.unshorten(\"tcs:Document\");\r\n\t\tvar d2ch = new TerminusDocumentChooser(this.ui, mcls);\r\n\t\td2ch.change = function(val){\r\n\t\t\tself.ui.showDocument(val);\r\n\t\t}\r\n\t\td2ch.view = \"label\";\r\n\t\tvar sdom = d2ch.getAsDOM('terminus-class-select');\r\n\t\tjQuery(dcip).hide();\r\n\t\tjQuery(nbut).hide();\r\n\t\tvar nlab = document.createElement(\"a\");\r\n\t\tnlab.setAttribute(\"href\", \"#\");\r\n\t\tnlab.setAttribute(\"class\", \"terminus-document-which-chooser\");\r\n\t\tnlab.appendChild(document.createTextNode(\"Choose by ID\"));\r\n\t\tvar show = \"label\";\r\n\t\tjQuery(nlab).click(function(){\r\n\t\t\tif(show == \"label\"){\r\n\t\t\t\tshow = \"id\";\r\n\t\t\t\tjQuery(dcip).show();\r\n\t\t\t\tjQuery(nbut).show();\r\n\t\t\t\tjQuery(sdom).hide();\r\n\t\t\t\tjQuery(nlab).text(\"Choose by Label\");\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tshow = \"label\";\r\n\t\t\t\tjQuery(dcip).hide();\r\n\t\t\t\tjQuery(nbut).hide();\r\n\t\t\t\tjQuery(sdom).show();\r\n\t\t\t\tjQuery(nlab).text(\"Choose by ID\");\r\n\t\t\t}\r\n\t\t})\r\n\t\tscd.appendChild(sdom);\r\n\t\tscd.prepend(nlab);\r\n\t}\r\n\tvar nbuts = document.createElement(\"span\");\r\n\tnbuts.setAttribute(\"class\", \"terminus-control-buttons terminus-document-chooser-buttons\");\r\n\tnbuts.appendChild(nbut);\r\n\tscd.appendChild(lab);\r\n\tscd.appendChild(dcip);\r\n\tscd.appendChild(nbuts);\r\n\treturn scd;\r\n};\r\n\r\nTerminusDBController.prototype.getDocumentCreatorDOM = function(){\r\n\tvar self = this;\r\n\tvar scd = document.createElement(\"div\");\r\n\tscd.setAttribute(\"class\", \"terminus-document-creator terminus-form-horizontal terminus-control-group terminus-choose-by-id\");\r\n\r\n\tvar dcip = document.createElement(\"input\");\r\n\tdcip.setAttribute(\"class\", \"terminus-form-doc-value terminus-document-creator terminus-doc-input-text\");\r\n\tdcip.setAttribute(\"placeholder\", \"Enter Document Type\");\r\n\tvar nbut = document.createElement(\"button\");\r\n\tvar lab = document.createElement(\"span\");\r\n\tlab.setAttribute(\"class\", \"document-creator-label terminus-control-label terminus-control-label-padding\");\r\n\t//lab.appendChild(document.createTextNode(\"Type \"));\r\n\tnbut.setAttribute('class', \"terminus-control-button create-document-button terminus-doc-btn\")\r\n\tnbut.appendChild(document.createTextNode(\"Create\"));\r\n\tnbut.addEventListener(\"click\", function(){\r\n\t\tif(dcip.value) self.ui.showCreateDocument(dcip.value);\r\n\t})\r\n\tvar nbuts = document.createElement(\"div\");\r\n\tnbuts.setAttribute(\"class\", \"terminus-control-buttons terminus-document-creator-buttons\");\r\n\tvar wq = new WOQLQuery(this.ui.client, {}, this.ui);\r\n\tvar filter = wq.getConcreteDocumentClassPattern(\"v:Element\");\r\n\tvar termcc = new TerminusClassChooser(this.ui, filter);\r\n\ttermcc.empty_choice = \"Create Document of Type\";\r\n\tvar self = this;\r\n\ttermcc.change = function(new_class){\r\n\t\tif(new_class){\r\n\t\t\tself.ui.showCreateDocument(new_class);\r\n\t\t\ttermcc.choice = false;\r\n\t\t}\r\n\t}\r\n\tvar tcdom = termcc.getAsDOM('terminus-class-select');\r\n\r\n\tvar gb = document.createElement('div');\r\n\tgb.setAttribute('class', 'terminus-doc-btn-group');\r\n\tvar bi = document.createElement('button');\r\n\tbi.setAttribute('class', 'terminus-doc-btn-selected terminus-doc-toggle-btn');\r\n\tbi.appendChild((document.createTextNode('D')));\r\n\tvar tds = document.createElement('span');\r\n\ttds.setAttribute('class', 'terminus-tooltiptext');\r\n\ttds.appendChild(document.createTextNode('Dropdown List'));\r\n\tbi.appendChild(tds);\r\n\tvar bt = document.createElement('button');\r\n\tbt.setAttribute('class', 'terminus-doc-toggle-btn');\r\n\tbt.appendChild((document.createTextNode('T')));\r\n\tvar tts = document.createElement('span');\r\n\ttts.setAttribute('class', 'terminus-tooltiptext');\r\n\ttts.appendChild(document.createTextNode('Text Input'));\r\n\tbt.appendChild(tts);\r\n\tgb.appendChild(bt);\r\n\tgb.appendChild(bi);\r\n\tvar nlabs = document.createElement(\"div\");\r\n\tnlabs.setAttribute('class', 'terminus-doc-btn-gp-align');\r\n\tnlabs.appendChild(gb);\r\n\tscd.appendChild(nlabs);\r\n\tvar ccDOM = document.createElement(\"span\");\r\n\tnlabs.appendChild(ccDOM);\r\n\tccDOM.setAttribute(\"class\", \"create-document-list\");\r\n\tccDOM.appendChild(tcdom);\r\n\tvar which = \"select\";\r\n\tbt.addEventListener(\"click\", function(){\r\n\t\t// create document of TerminusClient.FrameHelper.removeChildren(nlabs);\r\n\t\tTerminusClient.FrameHelper.removeChildren(ccDOM);\r\n\t\tUTILS.removeSelectedNavClass(\"terminus-doc-btn-selected\");\r\n\t\tthis.classList.add(\"terminus-doc-btn-selected\");\r\n\t\tccDOM.appendChild(dcip);\r\n\t\tccDOM.appendChild(nbut);\r\n\t});\r\n\r\n\tbi.addEventListener(\"click\", function(){\r\n\t\t// create document from dropdown\r\n\t\tTerminusClient.FrameHelper.removeChildren(ccDOM);\r\n\t\tUTILS.removeSelectedNavClass(\"terminus-doc-btn-selected\");\r\n\t\tthis.classList.add(\"terminus-doc-btn-selected\");\r\n\t\tccDOM.appendChild(tcdom);\r\n\t});\r\n\treturn scd;\r\n};\r\n\r\nfunction TerminusDBViewer(ui){\r\n\tthis.ui = ui;\r\n\tthis.wquery = new WOQLQuery(ui.client, this.options, ui);\r\n}\r\n\r\nTerminusDBViewer.prototype.getAsDOM = function(selected){\r\n\tvar pd = document.createElement(\"span\");\r\n\tpd.setAttribute(\"class\", \"terminus-db-home-page\");\r\n\tvar sth = document.createElement('div');\r\n\tvar banner = document.createElement('div');\r\n\t//pd.appendChild(banner);\r\n\tbanner.setAttribute('class', 'terminus-banner');\r\n\tvar dhp = document.createElement(\"span\");\r\n\tdhp.setAttribute('class', 'terminus-home-heading');\r\n\tdhp.appendChild(document.createTextNode(\"DB Home Page - \"));\r\n\tsth.appendChild(dhp);\r\n\tvar scd = document.createElement(\"span\");\r\n\tscd.setAttribute(\"class\", \"terminus-db-details\");\r\n\tvar scs = document.createElement(\"span\");\r\n\tscs.setAttribute(\"class\", \"terminus-db-details-value \");\r\n\tvar dbrec = this.ui.getDBRecord();\r\n\tif(dbrec){\r\n\t\tvar nm = (dbrec[\"rdfs:label\"] && dbrec[\"rdfs:label\"][\"@value\"] ? dbrec[\"rdfs:label\"][\"@value\"] : this.db);\r\n\t\tscs.appendChild(document.createTextNode(nm));\r\n\t\tscs.setAttribute('class', 'terminus-home-heading');\r\n\t}\r\n\tscd.appendChild(scs);\r\n\tsth.appendChild(scd);\r\n\tbanner.appendChild(sth);\r\n\t//pd.appendChild(sth);\r\n\t//pd.appendChild(UTILS.getHeaderDom('Summary'));\r\n\tthis.getDeleteOnHomePage(pd);\r\n\tthis.getDBSummary(pd);\r\n\tpd.appendChild(pd.appendChild(UTILS.getHeaderDom('List of Documents')));\r\n\tthis.getClassesDOM(pd);\r\n\treturn pd;\r\n}\r\n\r\nTerminusDBViewer.prototype.getDbInfoBox = function(r, module){\r\n\tvar sp = document.createElement('span');\r\n    sp.setAttribute('class', 'terminus-db-info-box');\r\n\tvar info = document.createElement('div');\r\n\tinfo.appendChild(document.createTextNode(module.charAt(0).toUpperCase() + module.slice(1)));\r\n\tinfo.setAttribute('class', 'terminus-db-info');\r\n\tsp.appendChild(info);\r\n\r\n    var i = document.createElement('i');\r\n\tswitch(module){\r\n\t\tcase 'size':\r\n\t\t\ti.setAttribute('class', 'terminus-icon fa fa-balance-scale');\r\n\t\t    var txt = document.createTextNode('2 Gb');\r\n\t\tbreak;\r\n\t\tcase 'created':\r\n\t\t\ti.setAttribute('class', 'terminus-icon fa fa-calendar');\r\n\t\t    var txt = document.createTextNode('16 July 2015');\r\n\t\tbreak;\r\n\t\tcase 'modified':\r\n\t\t\ti.setAttribute('class', 'terminus-icon fa fa-clock');\r\n\t\t    var txt = document.createTextNode('22 Dec 2019');\r\n\t\tbreak;\r\n\t}\r\n    sp.appendChild(i);\r\n\tif(txt) sp.appendChild(txt);\r\n    r.appendChild(sp);\r\n}\r\n\r\nTerminusDBViewer.prototype.getDeleteOnHomePage = function(d){\r\n\t// delete database\r\n\tif(this.ui.db() == \"terminus\") return;\r\n    var del = document.createElement('button');\r\n    del.setAttribute('class', 'terminus-btn terminus-btn-float-right terminus-home-del');\r\n    del.setAttribute('type', 'button');\r\n    del.innerHTML = 'Delete Database';\r\n\tvar dbrec = this.ui.getDBRecord();\r\n\tif(dbrec)\r\n\t\tvar nm = (dbrec[\"rdfs:label\"] && dbrec[\"rdfs:label\"][\"@value\"] ? dbrec[\"rdfs:label\"][\"@value\"] : this.ui.db());\r\n    var self = this;\r\n    var dbdel = this.ui.db();\r\n\r\n    del.addEventListener(\"click\", function(){\r\n      \tvar deleteConfirm = confirm(`Do you want to delete ${dbdel} Database?`);\r\n\t\tif (deleteConfirm == true) {\r\n\t\t\tself.ui.deleteDatabase(dbdel);\r\n\t\t}\t\r\n    });\r\n    d.appendChild(del);\r\n}\r\n\r\nTerminusDBViewer.prototype.getDBSummary = function(d){\r\n    var r = document.createElement('span');\r\n    r.setAttribute('class', 'terminus-db-info-box-display');\r\n    d.appendChild(r);\r\n\r\n    /* getDbInfoBox() calls can change according to further requirments */\r\n    this.getDbInfoBox(r, 'size');\r\n    this.getDbInfoBox(r, 'created');\r\n    this.getDbInfoBox(r, 'modified');\r\n}\r\n\r\nTerminusDBViewer.prototype.getClassesDOM = function(d){\r\n\tvar q = this.wquery.getClassesQuery();\r\n\tvar self = this;\r\n\tthis.wquery.execute(q)\r\n\t.then(function(result){\r\n\t\tself.result = new WOQLResultsViewer.WOQLResultsViewer(self.ui, result, self.wquery, {}, {}, false);\r\n\t\tif(self.result){\r\n\t\t\tvar nd = self.result.getAsDOM(d, false);\r\n\t\t\tif(nd){\r\n\t\t\t\tnd.setAttribute('class', 'terminus-margin-box');\r\n\t        }\r\n\t\t\telse{\r\n\t\t\t\tnor = document.createElement('div');\r\n\t\t\t\tnor.setAttribute('class', 'terminus-no-res-alert');\r\n\t\t\t\tnor.appendChild(document.createTextNode(\"No documents available, create new ones to view them here...\"));\r\n\t\t\t\td.appendChild(nor);\r\n\t\t\t}\r\n\t\t}\r\n\t})\r\n\t.catch(function(err){\r\n\t\tconsole.error(err);\r\n\t\tself.ui.showError(err);\r\n\t});\r\n\treturn d;\r\n}\r\n\r\n\r\nfunction TerminusDBCreator(ui){\r\n\tthis.ui = ui;\r\n}\r\n\r\nTerminusDBCreator.prototype.getAsDOM = function(selected){\r\n\tvar scd = document.createElement(\"div\");\r\n\t/* test delete when over var txtHolder = document.createElement(\"div\");\r\n\ttxtHolder.appendChild(document.createTextNode('expecting laoder herer'));\r\n\tscd.appendChild(txtHolder);\r\n\tthis.ui.getLoader(scd);*/\r\n\tscd.setAttribute(\"class\", \"terminus-db-creator\");\r\n\tvar sct = document.createElement(\"h3\");\r\n\tsct.setAttribute(\"class\", \"terminus-db-creator-title terminus-module-head\");\r\n\tsct.appendChild(document.createTextNode(\"Create New Database\"));\r\n\tscd.appendChild(sct);\r\n\tvar mfd = document.createElement('div');\r\n\tmfd.setAttribute('class', 'terminus-form-border');\r\n\tscd.appendChild(mfd);\r\n\tvar sci = document.createElement(\"div\");\r\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-form-field-spacing terminus-form-horizontal terminus-control-group\");\r\n\tvar slab = document.createElement(\"span\");\r\n\tslab.setAttribute(\"class\", \"terminus-id-label terminus-form-label terminus-control-label\");\r\n\tslab.appendChild(document.createTextNode(\"ID\"));\r\n\tsci.appendChild(slab);\r\n\tvar idip = document.createElement(\"input\");\r\n\tidip.setAttribute(\"type\", \"text\");\r\n\tidip.setAttribute(\"class\", \"terminus-form-value terminus-input-text\");\r\n\tidip.setAttribute(\"placeholder\", \"No spaces or special characters allowed in IDs\");\r\n\tsci.appendChild(idip);\r\n\tmfd.appendChild(sci);\r\n\tvar sci = document.createElement(\"div\");\r\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-form-field-spacing terminus-form-horizontal terminus-control-group\");\r\n\tvar slab = document.createElement(\"span\");\r\n\tslab.setAttribute(\"class\", \"terminus-title-label terminus-form-label terminus-control-label\");\r\n\tslab.appendChild(document.createTextNode(\"Title\"));\r\n\tvar titip = document.createElement(\"input\");\r\n\ttitip.setAttribute(\"type\", \"text\");\r\n\ttitip.setAttribute(\"placeholder\", \"A brief title for the Database\");\r\n\ttitip.setAttribute(\"class\", \"terminus-form-value terminus-input-text\");\r\n\tsci.appendChild(slab);\r\n\tsci.appendChild(titip);\r\n\tmfd.appendChild(sci);\r\n\tvar sci = document.createElement(\"div\");\r\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-form-field-spacing terminus-form-horizontal terminus-control-group\");\r\n\tvar slab = document.createElement(\"span\");\r\n\tslab.setAttribute(\"class\", \"terminus-title-label terminus-form-label terminus-control-label\");\r\n\tslab.appendChild(document.createTextNode(\"Description\"));\r\n\tsci.appendChild(slab);\r\n\tvar descip = document.createElement(\"textarea\");\r\n\tdescip.setAttribute(\"class\", \"terminus-textarea terminus-db-description terminus-textarea \");\r\n\tdescip.setAttribute(\"placeholder\", \"A short text describing the database and its purpose\");\r\n\tsci.appendChild(descip);\r\n\tmfd.appendChild(sci);\r\n\tvar sci = document.createElement(\"div\");\r\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-form-field-spacing terminus-form-horizontal terminus-control-group\");\r\n\tvar slab = document.createElement(\"span\");\r\n\tslab.setAttribute(\"class\", \"terminus-schema-label terminus-form-label terminus-control-label\");\r\n\tslab.appendChild(document.createTextNode(\"Import Schema\"));\r\n\tsci.appendChild(slab);\r\n\tvar schem = document.createElement(\"input\");\r\n\tschem.setAttribute(\"placeholder\", \"Terminus DB URL\");\r\n\tschem.setAttribute(\"type\", \"text\");\r\n\tschem.setAttribute(\"class\", \"terminus-form-value terminus-form-url terminus-input-text\");\r\n\r\n\tsci.appendChild(schem);\r\n\tmfd.appendChild(sci);\r\n\tvar sci = document.createElement(\"div\");\r\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-form-field-spacing terminus-form-horizontal terminus-control-group\");\r\n\tvar slab = document.createElement(\"span\");\r\n\tslab.setAttribute(\"class\", \"terminus-data-label terminus-form-label terminus-control-label\");\r\n\tslab.appendChild(document.createTextNode(\"Import Data\"));\r\n\tsci.appendChild(slab);\r\n\tvar datip = document.createElement(\"input\");\r\n\tdatip.setAttribute(\"type\", \"text\");\r\n\tdatip.setAttribute(\"placeholder\", \"Terminus DB URL\");\r\n\tdatip.setAttribute(\"class\", \"terminus-form-value terminus-form-url terminus-input-text\");\r\n\tsci.appendChild(datip);\r\n\t//mfd.appendChild(sci);\r\n\tvar butfield = document.createElement(\"div\");\r\n\tbutfield.setAttribute(\"class\", \"terminus-control-buttons\");\r\n\tvar cancbut = document.createElement(\"button\");\r\n\tcancbut.setAttribute(\"class\", \"terminus-control-button terminus-cancel-db-button terminus-btn\");\r\n\tcancbut.appendChild(document.createTextNode(\"Cancel\"));\r\n\tvar loadbut = document.createElement(\"button\");\r\n\tloadbut.setAttribute(\"class\", \"terminus-control-button terminus-create-db-button terminus-btn\");\r\n\tloadbut.appendChild(document.createTextNode(\"Create\"));\r\n\tvar self = this;\r\n\tvar gatherips = function(){\r\n\t\tvar input = {};\r\n\t\tinput.id = idip.value;\r\n\t\tinput.title = titip.value;\r\n\t\tinput.description = descip.value;\r\n\t\tinput.schema = schem.value;\r\n\t\tinput.data = datip.value;\r\n\t\treturn input;\r\n\t}\r\n\tvar self = this;\r\n\tloadbut.addEventListener(\"click\", function(){\r\n\t\tvar input = gatherips();\r\n\t\tself.ui.createDatabase(input);\r\n\t})\r\n\tcancbut.addEventListener(\"click\", function(){\r\n\t\tself.ui.showServerMainPage();\r\n\t})\r\n\tbutfield.appendChild(cancbut);\r\n\tbutfield.appendChild(loadbut);\r\n\tmfd.appendChild(butfield);\r\n\r\n\treturn scd;\r\n}\r\nmodule.exports={TerminusDBViewer:TerminusDBViewer,\r\n\t            TerminusDBController:TerminusDBController,\r\n\t            TerminusDBCreator:TerminusDBCreator}\r\n","function TerminusViolations(vios, ui){\r\n\tthis.ui = ui;\r\n\tthis.vios = [];\r\n\tvar nvios = [];\r\n\tfor(var i = 0; i<vios.length; i++){\r\n\t\tfor(var j = 0; j<nvios.length; j++){\r\n\t\t\tif(JSON.stringify(vios[i]) == JSON.stringify(nvios[j])) continue;\r\n\t\t}\r\n\t\tnvios.push(vios[i]);\r\n\t}\r\n\tfor(var i = 0; i<nvios.length; i++){\r\n\t\tthis.vios.push(new TerminusViolation(nvios[i], this.ui));\r\n\t}\r\n}\r\n\r\nTerminusViolations.prototype.getAsDOM = function(context_msg){\r\n\tvar vdom = document.createElement(\"div\");\r\n\tvdom.setAttribute(\"class\", \"terminus-violations terminus-show-msg-vio\");\r\n\tvar vioHeading = document.createElement(\"div\");\r\n\tvioHeading.setAttribute('class', 'terminus-violations-heading');\r\n\tvdom.appendChild(vioHeading);\r\n\tvar msg = this.vios.length + (this.vios.length > 1 ? \" Violations Detected\" : \" Violation Detected\");\r\n\tif(context_msg) msg += \" \" + context_msg;\r\n\tvioHeading.appendChild(document.createTextNode(msg));\r\n\tfor(var i = 0; i<this.vios.length; i++){\r\n\t\tvdom.appendChild(this.vios[i].getAsDOM());\r\n\t}\r\n\treturn vdom;\r\n}\r\n\r\n/*\r\n * Class for displaying violation reports as HTML\r\n */\r\nfunction TerminusViolation(vio, ui){\r\n\tthis.ui = ui;\r\n\tthis.vio = vio;\r\n}\r\n\r\nTerminusViolation.prototype.getAsDOM = function(){\r\n\tvar vdom = document.createElement(\"div\");\r\n\tvdom.setAttribute(\"class\", \"terminus-violation\");\r\n\tif(this.vio['@type']){\r\n\t\tvar msg = this.vio['vio:message'] || {\"@value\": \"\"};\r\n\t\tvdom.appendChild(this.getPropertyAsDOM(this.vio[\"@type\"], msg));\r\n\t}\r\n\tfor(var prop in this.vio){\r\n\t\tif(prop != \"vio:message\" && prop != \"@type\"){\r\n\t\t\tvdom.appendChild(this.getPropertyAsDOM(prop, this.vio[prop]));\r\n\t\t}\r\n\t}\r\n\treturn vdom;\r\n}\r\n\r\nTerminusViolation.prototype.getPropertyAsDOM = function(prop, val){\r\n\tvar pdom = document.createElement(\"div\");\r\n\tpdom.setAttribute(\"class\", \"terminus-violation-property\");\r\n\tvar ldom = document.createElement(\"span\");\r\n\tldom.setAttribute(\"class\", \"terminus-label terminus-violation-property-label\");\r\n\tldom.appendChild(document.createTextNode(prop));\r\n\tvar vdom = document.createElement(\"span\");\r\n\tvdom.setAttribute(\"class\", \"terminus-violation-property-value\");\r\n\tvdom.appendChild(document.createTextNode(val[\"@value\"]));\r\n\tpdom.appendChild(ldom);\r\n\tpdom.appendChild(vdom);\r\n\treturn pdom;\r\n}\r\n\r\nmodule.exports=TerminusViolations\r\n","const WOQLQuery = require('../query/WOQLQuery');\r\nconst WOQLResultsViewer = require('../query/WOQLResultsViewer');\r\nconst WOQLTextboxGenerator = require('../query/WOQLTextboxGenerator');\r\nconst WOQLGraphBrowserGenerator = require('../query/WOQLGraphBrowserGenerator');\r\nconst TerminusPluginManager = require('../plugins/TerminusPlugin');\r\n\r\nfunction TerminusQueryViewer(ui, options){\r\n\tthis.ui = ui;\r\n\tthis.options = options;\r\n\tthis.meta = {};\r\n\tthis.init();\r\n\tthis.generator = false;\r\n\tthis.result = false;\r\n\tthis.wquery = new WOQLQuery(ui.client, this.options, this.ui);\r\n\tthis.pman = new TerminusPluginManager();\r\n\tthis.gentype = (options && options.generator ? options.generator : \"textbox\");\r\n\tthis.generators = {\r\n\t\t\"textbox\" : { label: \"Simple Text Box\", value: \"textbox\"},\r\n\t}\r\n\tif(ui.pluginAvailable(\"jqueryui\")){\r\n\t\tthis.generators.gbrowse = { label: \"Graph Browser\", value: \"gbrowse\"};\r\n\t}\r\n\tthis.loadGenerator();\r\n}\r\n\r\nTerminusQueryViewer.prototype.hasGeneratorOptions = function(){\r\n\treturn false;\r\n\tvar yup = false;\r\n\tfor(var gen in this.generators){\r\n\t\tif(yup) return true;\r\n\t\telse yup = true;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nTerminusQueryViewer.prototype.changeGenerator = function(ng){\r\n\tif(this.gentype != ng){\r\n\t\tthis.gentype = ng;\r\n\t\tthis.loadGenerator();\r\n\t\tthis.redrawGenerator();\r\n\t}\r\n}\r\nTerminusQueryViewer.prototype.redrawGenerator = function(q){\r\n\tTerminusClient.FrameHelper.removeChildren(this.inputDOM);\r\n\tthis.inputDOM.appendChild(this.getQueryButtonsDOM(q));\r\n}\r\n\r\nTerminusQueryViewer.prototype.loadGenerator = function(){\r\n\tvar self = this;\r\n\tvar nquery = function(q, settings){\r\n\t\tself.query(q, settings)\r\n\t}\r\n\tif(this.gentype == \"textbox\"){\r\n\t\tthis.generator = new WOQLTextboxGenerator(nquery, this, this.ui);\r\n\t}\r\n\telse if(this.gentype == \"gbrowse\"){\r\n\t\tthis.generator = new WOQLGraphBrowserGenerator(nquery, this, this.ui);\r\n\t}\r\n}\r\n\r\nTerminusQueryViewer.prototype.init = function(){\r\n\tvar wq = new WOQLQuery(this.ui.client, this.options, this.ui);\r\n\tvar woql = wq.getElementMetaDataQuery();\r\n\tvar self = this;\r\n\tself.meta = {};\r\n\twq.execute(woql).then(function(wresult){\r\n\t\tvar wqlR = new WOQLResultsViewer.WOQLResult(wresult, null ,null, self.ui);\r\n\t\tif(wqlR.hasBindings(wresult)){\r\n\t\t\tfor(var i = 0; i<wresult.bindings.length; i++){\r\n\t\t\t\tvar el = wresult.bindings[i].Element;\r\n\t\t\t\tif(el && typeof self.meta[el] == \"undefined\"){\r\n\t\t\t\t\tself.meta[el] = wresult.bindings[i];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t})\r\n\t.catch(function(e){\r\n\t\tconsole.error(e);\r\n\t});\r\n}\r\n\r\n\r\nTerminusQueryViewer.prototype.query = function(val, settings, tab){\r\n\tvar self = this;\r\n\tTerminusClient.FrameHelper.removeChildren(this.resultDOM);\r\n\tthis.wquery.execute(val)\r\n\t.then(function(result){\r\n\t\tself.result = new WOQLResultsViewer.WOQLResultsViewer(self.ui, result, self.wquery, self.options, settings, true);\r\n\t\tvar nd = self.result.getAsDOM(self.resultDOM, true);\r\n\t\tif(nd){\r\n\t\t\t self.resultDOM.appendChild(nd);\r\n\t\t}\r\n\t})\r\n\t.catch(function(err){\r\n\t\tself.ui.showError(err);\r\n\t});\r\n}\r\n\r\nTerminusQueryViewer.prototype.getResultViewDom = function(){\r\n\tthis.resultDOM = document.createElement(\"div\");\r\n\tthis.resultDOM.setAttribute(\"class\", \"terminus-query-results\");\r\n}\r\n\r\nTerminusQueryViewer.prototype.getAsDOM = function(q){\r\n\tvar qbox = document.createElement(\"div\");\r\n\tqbox.setAttribute(\"class\", \"terminus-query-page\");\r\n\tif(this.hasGeneratorOptions()){\r\n\t\tqbox.appendChild(this.getQueryCreatorChoiceDOM(q));\r\n\t}\r\n\tthis.resultDOM = document.createElement(\"div\");\r\n\tthis.resultDOM.setAttribute(\"class\", \"terminus-query-results terminus-query-section\");\r\n\r\n\tvar qtHolder = document.createElement('span');\r\n\tqtHolder.setAttribute('style', 'display: flex;');\r\n\r\n\tthis.qTextBox = this.getQueryTextAreaDOM(q, qtHolder);\r\n\tthis.buttonsDOM = document.createElement(\"span\");\r\n\tthis.buttonsDOM.setAttribute(\"class\", \"terminus-query-input\");\r\n\tthis.buttonsDOM.appendChild(this.getQueryButtonsDOM(q, this.qTextBox));\r\n\r\n\tqtHolder.appendChild(this.buttonsDOM);\r\n\r\n\tqbox.appendChild(qtHolder);\r\n\tqbox.appendChild(this.resultDOM);\r\n\treturn qbox;\r\n}\r\n\r\nTerminusQueryViewer.prototype.getQueryCreatorChoiceDOM = function(){\r\n\tvar qcc = document.createElement(\"select\");\r\n\tqcc.setAttribute(\"class\", \"terminus-query-generator-selector\");\r\n\tfor(var c in this.generators){\r\n\t\tvar gen = this.generators[c];\r\n\t\tvar opt = document.createElement(\"option\");\r\n\t\topt.value = (gen.value ? gen.value : c);\r\n\t\tvar lab = (gen.label ? gen.label : c);\r\n\t\topt.appendChild(document.createTextNode(lab));\r\n\t\tqcc.appendChild(opt);\r\n\t}\r\n\tvar self = this;\r\n\tqcc.addEventListener(\"change\", function(){\r\n\t\tself.changeGenerator(this.value);\r\n\t});\r\n\treturn qcc;\r\n}\r\n\r\nTerminusQueryViewer.prototype.getQueryButtonsDOM = function(q, qip){\r\n\treturn this.generator.getAsDOM(q, qip);\r\n}\r\n\r\nTerminusQueryViewer.prototype.getQueryTextAreaDOM = function(q, box){\r\n\treturn this.generator.getQueryTextAreaDOM(q, box);\r\n}\r\n\r\nmodule.exports=TerminusQueryViewer\r\n","const TerminusClassChooser = require('../client/TerminusClassChooser');\r\nconst TerminusPropertyChooser = require('../client/TerminusPropertyChooser');\r\nconst TerminusDocumentChooser = require('../client/TerminusDocumentChooser');\r\nconst UTILS= require('../Utils')\r\n\r\nfunction WOQLTextboxGenerator(tq, qman, ui){\r\n\tthis.query = tq;\r\n\tthis.wquery = qman.wquery;\r\n\tthis.ui = ui;\r\n\t// default datatable settings if datatable plug in available\r\n\tthis.datatable = {};\r\n\tthis.datatable.pageLength = 20;\r\n\tthis.datatable.start = 0;\r\n}\r\n\r\nWOQLTextboxGenerator.prototype.gatherDatatableSettings = function(txtArea, queryName){\r\n\tthis.datatable.qTextDom =  txtArea;\r\n\tthis.datatable.query =  queryName;\r\n\tthis.datatable.chosenValue = null;\r\n}\r\n\r\nWOQLTextboxGenerator.prototype.getQueryButtonGroups = function(qbox){\r\n\tvar row = document.createElement('div');\r\n\trow.setAttribute('class', 'terminus-query-group-row');\r\n\tqbox.appendChild(row);\r\n\treturn row;\r\n}\r\n\r\nWOQLTextboxGenerator.prototype.qGroupQueries = function(qrow, header, descr){\r\n\tvar g = document.createElement('button');\r\n\tvar self = this;\r\n\tg.addEventListener('click', function(e){\r\n\t\tself.ui.clearMessages();\r\n\t\tif(header == 'Data Queries'){ // to ensure click event is not on button but on select instead so no need to hide\r\n\t\t\tvar target = e.target || e.srcElement,\r\n        \ttext = target.textContent || target.innerText;\r\n\t\t\tif((target.nodeName == 'SELECT')) return;\r\n\t\t}\r\n\t\telse if(header == 'Document Queries'){\r\n\t\t\tvar target = e.target || e.srcElement,\r\n        \ttext = target.textContent || target.innerText;\r\n\t\t\tif((target.nodeName == 'INPUT')) return;\r\n\t\t}\r\n\t\tfor(var i=0; i<this.children.length ; i++){\r\n\t\t\tUTILS.toggleVisibility(this.children[i]);\r\n\t\t}\r\n\t\tvar qeb = document.getElementsByClassName('query-example-buttons');\r\n\t\tfor(var i=0; i<qeb.length ; i++){\r\n\t\t\tif(this != qeb[i]){\r\n\t\t\t\tfor(var j=0; j<qeb[i].children.length ; j++){\r\n\t\t\t\t\tif(qeb[i].children[j].classList.contains('terminus-display')){\r\n\t\t\t\t\t\tqeb[i].children[j].classList.remove('terminus-display');\r\n\t\t\t\t\t\tqeb[i].children[j].classList.add('terminus-hide');\r\n\t\t\t\t    }\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t})\r\n\r\n\tg.setAttribute('class', 'terminus-group-box terminus-pointer query-example-buttons');\r\n\r\n\tvar cd = document.createElement('div');\r\n\tcd.setAttribute('class', 'terminus-group');\r\n\tg.appendChild(cd);\r\n\r\n\tvar ch = document.createElement('div');\r\n\tch.setAttribute('class', 'terminus-group-header');\r\n\tcd.appendChild(ch);\r\n\r\n\tvar d = document.createElement('div');\r\n\td.setAttribute('class', 'terminus-query-block-headers')\r\n\td.appendChild(document.createTextNode(header));\r\n\tch.appendChild(d);\r\n\tic = document.createElement('i');\r\n    ic.setAttribute('class', 'terminus-hand-pointer-float fa fa-hand-pointer');\r\n\td.appendChild(ic);\r\n\r\n\tvar t = document.createElement('h5');\r\n\tt.setAttribute('class', 'terminus-group-sub-title terminus-hide');\r\n\tt.appendChild(document.createTextNode(descr));\r\n\tg.appendChild(t);\r\n\r\n\tqrow.appendChild(g);\r\n\r\n\treturn g;\r\n}\r\n\r\nWOQLTextboxGenerator.prototype.setDatatableSettings = function(query){\r\n\tif(query.limit){\r\n\t\tthis.datatable.pageLength = query.limit[0];\r\n\t\tthis.datatable.start = query.limit[1].start[0];\r\n\t}\r\n\t/*\r\n\tvar newQuery = query.replace(/\\s/g,'');  // remove spaces\r\n\tvar searchStr = 'limit(';\r\n\tif(newQuery.indexOf(searchStr) !== -1){\r\n\t\tvar remString = newQuery.substring(searchStr.length, newQuery.length);\r\n\t\tvar limit = remString.substr(0, remString.indexOf(','));\r\n\t\tthis.datatable.pageLength = limit;\r\n\t\tthis.datatable.start = 0;\r\n\t}*/\r\n}\r\n\r\nWOQLTextboxGenerator.prototype.getQueryTextAreaDOM = function(q, box){\r\n\tvar qbox = document.createElement(\"span\");\r\n\tqbox.setAttribute(\"class\", \"terminus-query-textbox-input terminus-query-section\");\r\n\r\n\tvar eqh = document.createElement(\"H3\");\r\n\teqh.appendChild(document.createTextNode(\"Enter Query\"));\r\n\teqh.setAttribute('class', 'terminus-full-css-margin-top terminus-module-head');\r\n\tqbox.appendChild(eqh);\r\n\r\n\tvar qip = document.createElement(\"textarea\");\r\n\tqip.setAttribute(\"class\", \"terminus-query-box\");\r\n\tqip.setAttribute(\"placeholder\", \"Enter new query or load queries from example buttons provided below ...\");\r\n\tqip.setAttribute(\"style\", \"min-width: 400px; min-height: 60px;\");\r\n\tif(q) qip.value = JSON.stringify(q,undefined, 2);\r\n\tqbox.appendChild(qip);\r\n\tUTILS.stylizeEditor(this.ui, qip, 'query', 'javascript');\r\n\tvar self = this;\r\n\tvar qbut = document.createElement(\"button\");\r\n\tqbut.setAttribute(\"class\", \"terminus-control-button terminus-btn\")\r\n\tqbut.appendChild(document.createTextNode(\"Send Query\"));\r\n\tqbut.addEventListener(\"click\", function(){\r\n\t\tself.ui.clearMessages();\r\n\t\ttry {\r\n\t\t\tvar qval = JSON.parse(qip.value);\r\n\t\t\tif(self.ui.pluginAvailable(\"datatables\")){\r\n\t\t\t\t// pass current Example query scope while editing the text editor\r\n\t\t\t\tself.gatherDatatableSettings(qip, self.datatable.query);\r\n\t\t\t\tself.setDatatableSettings(qval);\r\n\t\t\t\tself.query(qval, self.datatable);\r\n\t\t\t}\r\n\t\t\telse self.query(qval);\r\n\t\t}\r\n\t\tcatch(e){\r\n\t\t\talert(\"Failed to parse Query \" + e.toString());\r\n\t\t}\r\n\t})\r\n\tqbox.appendChild(qbut);\r\n\tbox.appendChild(qbox);\r\n\treturn qip;\r\n}\r\n\r\nWOQLTextboxGenerator.prototype.getAsDOM = function(q, qip){\r\n\tvar qbox = document.createElement(\"div\");\r\n\tqbox.setAttribute(\"class\", \"terminus-query-textbox-input\");\r\n\tvar qbuts = document.createElement(\"div\");\r\n\tqbuts.setAttribute(\"class\", \"terminus-control-buttons\");\r\n\t//qbuts.appendChild(qbut);\r\n\tqbox.appendChild(qbuts);\r\n\tvar qexs = document.createElement(\"div\");\r\n\tqexs.setAttribute(\"class\", \"terminus-query-examples terminus-db-list-title\");\r\n\tvar qh = document.createElement(\"H3\");\r\n\tqh.appendChild(document.createTextNode(\"Saved Queries\"));\r\n\tqh.setAttribute('class', 'terminus-full-css-margin-top terminus-module-head');\r\n\tqexs.appendChild(qh);\r\n\r\n\tvar qrow = this.getQueryButtonGroups(qexs);\r\n\tqexs.appendChild(qrow);\r\n\r\n\t/* grouping class queries */\r\n\tvar qcGroup = this.qGroupQueries(qrow, 'Schema Queries', '');\r\n\r\n\tvar nqbut = document.createElement(\"button\");\r\n\tnqbut.appendChild(document.createTextNode(\"Show All Classes\"));\r\n\tnqbut.setAttribute(\"class\", \"terminus-control-button terminus-q-btn\");\r\n\tnqbut.addEventListener(\"click\", function(){\r\n\t\tself.ui.clearMessages();\r\n\t\tUTILS.deleteStylizedEditor(self.ui, qip);\r\n\t\tvar qval = self.wquery.getClassMetaDataQuery(null, self.datatable.pageLength, self.datatable.start);\r\n\t\tqip.value = JSON.stringify(qval,undefined, 2);\r\n\t\tUTILS.stylizeEditor(self.ui, qip, 'query', 'javascript');\r\n\t\tif(self.ui.pluginAvailable(\"datatables\")){\r\n\t\t\tself.gatherDatatableSettings(qip, 'Show_All_Classes');\r\n\t\t\tself.query(qval, self.datatable);\r\n\t\t}\r\n\t\telse self.query(qval);\r\n\t})\r\n\r\n\tvar aqbut = document.createElement(\"button\");\r\n\taqbut.appendChild(document.createTextNode(\"Show Document Classes\"));\r\n\taqbut.setAttribute(\"class\", \"terminus-control-button terminus-q-btn\");\r\n\taqbut.addEventListener(\"click\", function(){\r\n\t\tself.ui.clearMessages();\r\n\t\tUTILS.deleteStylizedEditor(self.ui, qip);\r\n\t\tvar qvalue = self.wquery.getClassMetaDataQuery(self.wquery.getConcreteDocumentClassPattern(\"v:Element\"),\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tself.datatable.pageLength, self.datatable.start);\r\n\t\tqip.value = JSON.stringify(qvalue,undefined, 2);\r\n\t\tUTILS.stylizeEditor(self.ui, qip, 'query', 'javascript');\r\n\t\tif(self.ui.pluginAvailable(\"datatables\")){\r\n\t\t\tself.gatherDatatableSettings(qip, 'Show_Document_Classes');\r\n\t\t\tself.query(qvalue, self.datatable);\r\n\t\t}\r\n\t\telse self.query(qvalue);\r\n\t})\r\n\r\n\tvar ebut = document.createElement(\"button\");\r\n\tebut.appendChild(document.createTextNode(\"Show All Schema Elements\"));\r\n\tebut.setAttribute(\"class\", \"terminus-control-button terminus-q-btn\");\r\n\tvar self = this;\r\n\tebut.addEventListener(\"click\", function(){\r\n\t\tself.ui.clearMessages();\r\n\t\tUTILS.deleteStylizedEditor(self.ui, qip);\r\n\t\tvar qval = self.wquery.getElementMetaDataQuery(null, self.datatable.pageLength, self.datatable.start);\r\n\t\tqip.value = JSON.stringify(qval,undefined, 2);\r\n\t\tUTILS.stylizeEditor(self.ui, qip, 'query', 'javascript');\r\n\t\tif(self.ui.pluginAvailable(\"datatables\")){\r\n\t\t\tself.gatherDatatableSettings(qip, 'Show_All_Schema_Elements');\r\n\t\t\tself.query(qval, self.datatable);\r\n\t\t}\r\n\t\telse self.query(qval);\r\n\t})\r\n\tvar dbut = document.createElement(\"button\");\r\n\tdbut.appendChild(document.createTextNode(\"Show All Documents\"));\r\n\tdbut.setAttribute(\"class\", \"terminus-control-button terminus-q-btn\");\r\n\tdbut.addEventListener(\"click\", function(){\r\n\t\tself.ui.clearMessages();\r\n\t\tUTILS.deleteStylizedEditor(self.ui, qip);\r\n\t\tvar qvalue = self.wquery.getAllDocumentQuery(null, self.datatable.pageLength, self.datatable.start);\r\n\t\tqip.value = JSON.stringify(qvalue,undefined, 2);\r\n\t\tUTILS.stylizeEditor(self.ui, qip, 'query', 'javascript');\r\n\t\tif(self.ui.pluginAvailable(\"datatables\")){\r\n\t\t\tself.gatherDatatableSettings(qip, 'Show_All_Documents');\r\n\t\t\tself.query(qvalue, self.datatable);\r\n\t\t}\r\n\t\telse self.query(qvalue);\r\n\t})\r\n\tvar pbut = document.createElement(\"button\");\r\n\tpbut.appendChild(document.createTextNode(\"Show All Data\"));\r\n\tpbut.setAttribute(\"class\", \"terminus-control-button terminus-q-btn\");\r\n\tpbut.addEventListener(\"click\", function(){\r\n\t\tself.ui.clearMessages();\r\n\t\tUTILS.deleteStylizedEditor(self.ui, qip);\r\n\t\tvar qvalue = self.wquery.getEverythingQuery(null, self.datatable.pageLength, self.datatable.start);\r\n\t\tqip.value = JSON.stringify(qvalue,undefined, 2);\r\n\t\tUTILS.stylizeEditor(self.ui, qip, 'query', 'javascript');\r\n\t\tif(self.ui.pluginAvailable(\"datatables\")){\r\n\t\t\tself.gatherDatatableSettings(qip, 'Show_All_Data');\r\n\t\t\tself.query(qvalue, self.datatable);\r\n\t\t}\r\n\t\telse self.query(qvalue);\r\n\t})\r\n\r\n\tvar prbut = document.createElement(\"button\");\r\n\tprbut.appendChild(document.createTextNode(\"Show All Properties\"));\r\n\tprbut.setAttribute(\"class\", \"terminus-control-button terminus-q-btn\");\r\n\tprbut.addEventListener(\"click\", function(){\r\n\t\tself.ui.clearMessages();\r\n\t\tUTILS.deleteStylizedEditor(self.ui, qip);\r\n\t\tvar qvalue = self.wquery.getPropertyListQuery(null, self.datatable.pageLength, self.datatable.start);\r\n\t\tqip.value = JSON.stringify(qvalue,undefined, 2);\r\n\t\tUTILS.stylizeEditor(self.ui, qip, 'query', 'javascript');\r\n\t\tif(self.ui.pluginAvailable(\"datatables\")){\r\n\t\t\tself.gatherDatatableSettings(qip, 'Show_All_Properties');\r\n\t\t\tself.query(qvalue, self.datatable);\r\n\t\t}\r\n\t\telse self.query(qvalue);\r\n\t})\r\n\r\n\t/* grouping data queries */\r\n\tvar qdGroup = this.qGroupQueries(qrow, 'Data Queries', '');\r\n\r\n\tvar termcc = new TerminusClassChooser(this.ui);\r\n\ttermcc.empty_choice = \"Show data of type\";\r\n\tvar self = this;\r\n\ttermcc.change = function(new_class){\r\n\t\tself.ui.clearMessages();\r\n\t\tif(new_class){\r\n\t\t\tUTILS.deleteStylizedEditor(self.ui, qip);\r\n\t\t\tvar qvalue = self.wquery.getDataOfChosenClassQuery(new_class, self.datatable.pageLength, self.datatable.start);\r\n\t\t\tqip.value = JSON.stringify(qvalue,undefined, 2);\r\n\t\t\tUTILS.stylizeEditor(self.ui, qip, 'query', 'javascript');\r\n\t\t\tif(self.ui.pluginAvailable(\"datatables\")){\r\n\t\t\t\tself.gatherDatatableSettings(qip, 'Show_Data_Class');\r\n\t\t\t\tself.datatable.chosenValue = new_class; // set chosen val from drop down\r\n\t\t\t\tself.query(qvalue, self.datatable);\r\n\t\t\t}\r\n\t\t\telse self.query(qvalue);\r\n\t\t}\r\n\t}\r\n\tvar tcdom = termcc.getAsDOM('terminus-query-select');\r\n\r\n\tvar termpc = new TerminusPropertyChooser(this.ui);\r\n\ttermpc.empty_choice = \"Show property data\";\r\n\tvar self = this;\r\n\ttermpc.change = function(new_property){\r\n\t\tif(new_property){\r\n\t\t\tUTILS.deleteStylizedEditor(self.ui, qip);\r\n\t\t\tvar qvalue = self.wquery.getDataOfChosenPropertyQuery(new_property, self.datatable.pageLength, self.datatable.start);\r\n\t\t\tqip.value = JSON.stringify(qvalue,undefined, 2);\r\n\t\t\tUTILS.stylizeEditor(self.ui, qip, 'query', 'javascript');\r\n\t\t\tif(self.ui.pluginAvailable(\"datatables\")){\r\n\t\t\t\tself.gatherDatatableSettings(qip, 'Show_Property_Class');\r\n\t\t\t\tself.datatable.chosenValue = new_property; // set chosen val from drop down\r\n\t\t\t\tself.query(qvalue, self.datatable);\r\n\t\t\t}\r\n\t\t\telse self.query(qvalue);\r\n\t\t}\r\n\t}\r\n\r\n\t/* grouping document queries */\r\n\tvar qdocGroup = this.qGroupQueries(qrow, 'Document Queries', '');\r\n\r\n\tvar pdom = termpc.getAsDOM();\r\n\r\n\tvar docch = new TerminusDocumentChooser(this.ui);\r\n\tdocch.change = function(val){\r\n\t\tself.ui.clearMessages();\r\n\t\tUTILS.deleteStylizedEditor(self.ui, qip);\r\n\t\tvar qvalue = self.wquery.getDocumentQuery(val, self.datatable.pageLength, self.datatable.start);\r\n\t\tqip.value = JSON.stringify(qvalue,undefined, 2);\r\n\t\tUTILS.stylizeEditor(self.ui, qip, 'query', 'javascript');\r\n\t\tif(self.ui.pluginAvailable(\"datatables\")){\r\n\t\t\tself.gatherDatatableSettings(qip, 'Show_Document_Info_by_Id');\r\n\t\t\tself.datatable.chosenValue = val;\r\n\t\t\tself.query(qvalue, self.datatable);\r\n\t\t}\r\n\t\telse self.query(qvalue);\r\n\t}\r\n\tvar docdom = docch.getAsDOM('terminus-query-select');\r\n\r\n\tvar d2ch = new TerminusDocumentChooser(this.ui, TerminusClient.FrameHelper.unshorten(\"tcs:Document\"));\r\n\td2ch.view = \"label\";\r\n\td2ch.change = docch.change;\r\n\tvar d2dom = d2ch.getAsDOM('terminus-query-select');\r\n\tvar p = document.createElement(\"p\");\r\n\tp.appendChild(d2dom);\r\n\r\n\t/* class queries */\r\n\tvar clGroup = document.createElement('div');\r\n\tclGroup.setAttribute('class', 'terminus-hide ');\r\n\tclGroup.appendChild(ebut);\r\n\tvar br = document.createElement('BR');\r\n\tclGroup.appendChild(br);\r\n\tclGroup.appendChild(nqbut);\r\n\tvar br = document.createElement('BR');\r\n\tclGroup.appendChild(br);\r\n\tclGroup.appendChild(aqbut);\r\n\tvar br = document.createElement('BR');\r\n\tclGroup.appendChild(br);\r\n\tclGroup.appendChild(prbut);\r\n\tvar br = document.createElement('BR');\r\n\tclGroup.appendChild(br);\r\n\tqcGroup.appendChild(clGroup);\r\n\r\n\tqbox.appendChild(qexs);\r\n\r\n\t/* data queries */\r\n\tvar dtGroup = document.createElement('div');\r\n\tdtGroup.setAttribute('class', 'terminus-hide');\r\n\tdtGroup.appendChild(tcdom);\r\n\tdtGroup.appendChild(pdom);\r\n\r\n\tvar br = document.createElement('BR');\r\n\tdtGroup.appendChild(br);\r\n\tdtGroup.appendChild(pbut);\r\n\tqdGroup.appendChild(dtGroup);\r\n\r\n\r\n\t/* document queries */\r\n\tvar docGroup = document.createElement('div');\r\n\tdocGroup.setAttribute('class', 'terminus-hide');\r\n\tdocGroup.appendChild(docdom);\r\n\tdocGroup.appendChild(dbut);\r\n\t//docGroup.appendChild(p);\r\n\tqdocGroup.appendChild(docGroup);\r\n\r\n\treturn qbox;\r\n}\r\n\r\nmodule.exports=WOQLTextboxGenerator\r\n","/*\r\n * Utility Property which runs a query against the schema and presents the returned Propertyes as a drop-down / Property filter list\r\n */\r\nconst WOQLQuery = require('../query/WOQLQuery');\r\n\r\nTerminusPropertyChooser = function(ui, filter){\r\n\tthis.ui = ui;\r\n\tthis.choice = false;\r\n\tthis.filter = filter;\r\n}\r\n\r\nTerminusPropertyChooser.prototype.setRoot = function(root){\r\n\tthis.root = root;\r\n}\r\n\r\nTerminusPropertyChooser.prototype.setFilter = function(filter){\r\n\tthis.filter = filter;\r\n}\r\n\r\nTerminusPropertyChooser.prototype.change = function(cls){\r\n\talert(\"Need to specify Property chooser function (\" + cls + \")\");\r\n}\r\n\r\nTerminusPropertyChooser.prototype.getAsDOM = function(){\r\n\tvar ccdom = document.createElement(\"span\");\r\n\tccdom.setAttribute(\"Class\", \"terminus-Class-chooser\");\r\n\tvar ccsel = document.createElement(\"select\");\r\n\tccsel.setAttribute(\"Class\", \" terminus-type-select terminus-query-select\");\r\n\tvar self = this;\r\n\tccsel.addEventListener(\"change\", function(){\r\n\t\tif(this.value != this.choice){\r\n\t\t\tthis.choice = this.value;\r\n\t\t\tself.change(this.value);\r\n\t\t}\r\n\t});\r\n\tccdom.appendChild(ccsel);\r\n\tvar wq = new WOQLQuery(this.ui.client, false, this.ui);\r\n\tvar woql = wq.getPropertyListQuery(this.filter);\r\n\tvar self = this;\r\n\twq.execute(woql)\r\n\t.then(function(response){\r\n\t\tvar opts = self.getResultsAsOptions(response);\r\n\t\tfor(var i = 0; i<opts.length; i++){\r\n\t\t\tccsel.appendChild(opts[i]);\r\n\t\t}\r\n\t});\r\n\treturn ccdom;\r\n}\r\n\r\nTerminusPropertyChooser.prototype.getResultsAsOptions = function(clist){\r\n\tvar choices = [];\r\n\tif(this.empty_choice){\r\n\t\tvar opt1 = document.createElement(\"option\");\r\n\t\topt1.setAttribute(\"Class\", \"terminus-class-choice terminus-empty-choice\");\r\n\t\topt1.value = \"\";\r\n\t\topt1.appendChild(document.createTextNode(this.empty_choice));\r\n\t\tchoices.push(opt1);\r\n\t}\r\n\tvar labopt = document.createElement(\"option\");\r\n\tlabopt.setAttribute(\"Class\", \"terminus-class-choice\");\r\n\tlabopt.value = \"rdfs:label\";\r\n\tlabopt.appendChild(document.createTextNode(\"Label\"));\r\n\tchoices.push(labopt);\r\n\r\n\tvar comopt = document.createElement(\"option\");\r\n\tcomopt.setAttribute(\"Class\", \"terminus-class-choice\");\r\n\tcomopt.value = \"rdfs:comment\";\r\n\tcomopt.appendChild(document.createTextNode(\"Comment\"));\r\n\tchoices.push(comopt);\r\n\r\n\tif(clist.bindings){\r\n\t\tvar added = [];\r\n\t\tfor(var i = 0; i<clist.bindings.length; i++){\r\n\t\t\tvar cprop = this.getVariableValueFromBinding(\"Property\", clist.bindings[i]);\r\n\t\t\tif(cprop && added.indexOf(cprop) == -1){\r\n\t\t\t\tadded.push(cprop);\r\n\t\t\t\tvar opt = document.createElement(\"option\");\r\n\t\t\t\topt.setAttribute(\"Class\", \"terminus-class-choice\");\r\n\t\t\t\topt.value = cprop;\r\n\t\t\t\tvar lab = this.getVariableValueFromBinding(\"Label\", clist.bindings[i]);\r\n\t\t\t\tif(!lab || lab == \"unknown\"){\r\n\t\t\t\t\tlab = TerminusClient.FrameHelper.labelFromURL(cprop);\r\n\t\t\t\t}\r\n\t\t\t\tif(lab[\"@value\"]) lab = lab[\"@value\"];\r\n\t\t\t\topt.appendChild(document.createTextNode(lab));\r\n\t\t\t\tchoices.push(opt);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn choices;\r\n}\r\n\r\nTerminusPropertyChooser.prototype.getVariableValueFromBinding = function(varname, bind){\r\n\tfor(var key in bind){\r\n\t\tvar skey = key.substring(key.lastIndexOf(\"/\")+1);\r\n\t\tif(skey == varname){\r\n\t\t\treturn bind[key];\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\n\r\nmodule.exports=TerminusPropertyChooser\r\n","const WOQLQuery = require('./WOQLQuery');\r\nconst WOQLTimePicker = require('./WOQLTimePicker');\r\n\r\nfunction WOQLGraphBrowserGenerator(tq, qman, ui){\r\n\tthis.query = tq;\r\n\tthis.wquery = qman.wquery;\r\n\t//this.filter = new WOQLQueryFilter(this);\r\n\tthis.slider = new WOQLTimePicker();\r\n}\r\n\r\nWOQLGraphBrowserGenerator.prototype.getAsDOM = function(q){\r\n\tvar qbox = document.createElement(\"div\");\r\n\tqbox.setAttribute(\"class\", \"terminus-query-textbox-input\");\r\n\tqbox.appendChild(document.createTextNode(\"afsdfa\"));\r\n\tqbox.appendChild(this.slider.getSliderDOM());\r\n\treturn qbox;\r\n}\r\n\r\n\r\nfunction DCOGBrowser(controller, model, config){\r\n\tthis.myowner = controller;\r\n\tthis.model = model;\r\n\tthis.config = config;\r\n\tthis.default_viewport = (config && config.view ? config.view : \"graph\");\r\n\tthis.current_viewport = false;\r\n\r\n\t//internal state\r\n\tthis.viewports = {};\r\n\tthis.viewportDOMs = {};\r\n\tthis.browserid = randomString(8);\r\n\tthis.query_timeslice = false;\r\n\tthis.current_result = false;\r\n\tthis.focus_node = false;\r\n\tthis.show_filter = false;\r\n\t//this.relationships = model.mgraphs['main'].elements.relationships;\r\n\t//this.entities = model.mgraphs['main'].elements.entities;\r\n\t\t\r\n\t//this.setUpIPGSpecials();\r\n\t\r\n\tthis.entity_count = false;\r\n\r\n\tthis.config.default_display = {\r\n\t\ticon: \"fas fa-question\",\r\n\t\ticon_unicode: \"\\uf128\",\r\n\t\tcolor: [255,125,125],\r\n\t\tforward: \"Unknown\",\r\n\t\tbackward: \"Unknown\",\r\n\t\ttext: \"Unknown\"\r\n\t};\r\n}\r\n\r\n\r\nDCOGBrowser.prototype.init = function(){\r\n\tthis.filter = new DCOGQueryFilter(this, this.config, this.model);\r\n\tthis.slider = new DCOGTimePicker(this, this.config);\r\n\t//this.viewports['graph'] = new DCOGGVis(this, this.config);\r\n\t//this.viewports['table'] = new DCOGTable(this, this.config);\r\n\t//this.viewports['map'] = new DCOGMap(this, this.config);\r\n\t//this.viewports['api'] = new DCOGAPIView(this, this.config);\r\n\t//this.viewports['timeline'] = new DCOGTimeline(this, this.config);\r\n};\r\n\r\nDCOGBrowser.prototype.getViewportAsDOM = function(){\r\n\tvar vpdom = document.createElement(\"div\");\r\n\tvpdom.setAttribute(\"class\", \"dcog-viewport\");\r\n\tfor(var k in this.viewports){\r\n\t\tif(typeof this.viewportDOMs[k] == \"undefined\"){\r\n\t\t\tthis.viewportDOMs[k] = this.viewports[k].getAsDOM();\r\n\t\t}\r\n\t\tvpdom.appendChild(this.viewportDOMs[k]);\r\n\t}\r\n\treturn vpdom;\r\n}\r\n\r\nDCOGBrowser.prototype.newQuery = function(query, success, error){\r\n\tquery = (query ? query : this.getQuery());\r\n\tvar self = this;\r\n\tvar busy = this.setBusy(\"Fetching Results from Data Chemist Server\");\r\n\tvar handle = function(data){\r\n\t\tself.clearBusy(busy);\r\n\t\tself.current_result = new DCOGQueryResult(data, query);\r\n\t\tif(self.current_result.containsData()){\r\n\t\t\tself.setViewportData(self.current_result);\r\n\t\t\tif(self.focus_node){\r\n\t\t\t\tvar node = self.current_result.getNodeOrFringe(query.focus_node);\r\n\t\t\t}\r\n\t\t\telse if(query.from_node){\r\n\t\t\t\tvar node = self.current_result.getNodeOrFringe(query.from_node);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tself.entity_count = data.nodeCount;\r\n\t\t\t\tself.myowner.fillInfoBoxes();\r\n\t\t\t}\r\n\t\t\tif(node){\r\n\t\t\t\tself.nodeSelected(node);\r\n\t\t\t}\r\n\t\t\tself.rebuildController();\t\t\t\r\n\t\t}\r\n\t\telse {\r\n\t\t\tself.tellUser(\"No results returned\", \"warning\");\r\n\t\t}\r\n\t\tif(typeof success == \"function\") {\r\n\t\t\tsuccess(self.current_result);\r\n\t\t}\r\n\t};\r\n\tvar ehandle = function(a){\r\n\t\tvar msg = {title: \"Results Overload\", body: \"Your query was terminated because it would have returned too many records - please reduce the depth of your search or add extra constraints and try again\"};\r\n\t\tself.tellUser(msg, \"error\");\r\n\t\tself.clearBusy(busy);\r\n\t}\r\n\tthis.untell();\r\n\tthis.model.client.query(query, handle, ehandle);\r\n}\r\n\r\nDCOGBrowser.prototype.moreResults = function(nfocus, success){\r\n\tvar busy = this.setBusy(\"Fetching Results from Data Chemist Server\");\r\n\tvar ehandle = function(a){\r\n\t\tvar msg = {title: \"Results Overload\", body: \"Your query was terminated because it would have returned too many records - please reduce the depth of your search or add extra constraints and try again\"};\r\n\t\tself.tellUser(msg, \"error\");\r\n\t\tself.clearBusy(busy);\r\n\t}\r\n\tthis.focus_node = nfocus;\r\n\tvar self = this;\r\n\tvar handle = function(data){\r\n\t\tself.clearBusy(busy);\r\n\t\tself.current_result.addMoreResults(data, self.getQuery());\r\n\t\tself.updateViewportData(self.current_result);\r\n\t\tself.rebuildController();\r\n\t\tif(typeof success == \"function\"){\r\n\t\t\tsuccess(self.current_result);\r\n\t\t}\r\n\t};\r\n\tthis.untell();\r\n\tthis.model.client.query(this.getQuery(), handle, ehandle);\r\n}\r\n\r\nDCOGBrowser.prototype.setBusy = function(msg){\r\n\tvar busy = showBusyOverlay(this.myowner.insert_patterns.browser, msg);\r\n\tthis.busy = busy;\r\n\treturn busy;\r\n}\r\n\r\nDCOGBrowser.prototype.getQuery = function(dqr){\r\n\tvar qstruct = {};\r\n\tif(this.focus_node){\r\n\t\tqstruct.focus_node = this.focus_node;\r\n\t}\r\n\telse if(this.from_node && this.to_node){\r\n\t\tqstruct.source_node = this.from_node;\r\n\t\tqstruct.target_node = this.to_node;\r\n\t}\r\n\tif(this.filter && this.filter.current_relationships){\r\n\t\tqstruct.relationships = this.filter.current_relationships;\r\n\t}\r\n\tif(this.filter && this.filter.current_depth){\r\n\t\tqstruct.max_path_length = this.filter.current_depth;\r\n\t}\r\n\tif(this.filter && this.filter.current_threshold && this.filter.current_threshold > 0 && qstruct.relationships.indexOf(\"share\") != -1){\r\n\t\tqstruct.filters = {shareholding_threshold: this.filter.current_threshold};\r\n\t}\r\n\tif(this.slider && this.slider.server_side && this.slider.timeslice){\r\n\t\tthis.query_timeslice = this.slider.timeslice;\r\n\t}\r\n\telse {\r\n\t\tthis.query_timeslice = false;\r\n\t}\r\n\tif(this.query_timeslice){\r\n\t\tqstruct.date = this.query_timeslice;\r\n\t}\r\n\treturn qstruct;\r\n}\r\n\r\nDCOGBrowser.prototype.setView = function(which){\r\n\tif(which != this.current_viewport){\r\n\t\tthis.current_viewport = which;\r\n\t\tfor(var k in this.viewports){\r\n\t\t\tif(k != this.current_viewport) {\r\n\t\t\t\tif(typeof this.viewports[k][\"hibernate\"] == \"function\"){\r\n\t\t\t\t\t//this.viewports[k].hiberate();\r\n\t\t\t\t}\r\n\t\t\t\tjQuery(this.viewportDOMs[k]).hide();\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tif(typeof this.viewports[k][\"wake\"] == \"function\"){\r\n\t\t\t\t\tthis.viewports[k].wake();\r\n\t\t\t\t}\r\n\t\t\t\tjQuery(this.viewportDOMs[k]).show();\r\n\t\t\t}\r\n\t\t\tthis.rebuildController();\r\n\t\t}\r\n\t}\r\n}\r\n\r\n\r\n/**\r\n * @summary Initialises the viewports by firing off a starter query and loading it into the contained viewports\r\n */\r\nDCOGBrowser.prototype.initData = function(which){\r\n\tthis.current_viewport = (which ? which : this.default_viewport);\r\n\tvar self = this;\r\n\tvar setInitNodes = function(dqr){\r\n\t\tif(self.focus_node){\r\n\t\t\tvar node = dqr.getNodeOrFringe(self.focus_node);\r\n\t\t\tif(node && node.groupID){\r\n\t\t\t\tself.nodeSelected(node);\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\t\r\n\t\t}\r\n\t\tfor(var k in self.viewports){\r\n\t\t\tif(typeof self.viewports[k].initDOM == \"function\"){\r\n\t\t\t\tself.viewports[k].initDOM(self.viewportDOMs[k]);\r\n\t\t\t}\r\n\t\t\tif(k != self.current_viewport) jQuery(self.viewportDOMs[k]).hide();\r\n\t\t\telse if(typeof self.viewportDOMs[k].wake == \"function\") self.viewportDOMs[k].wake()\r\n\t\t}\r\n\t}\r\n\tvar qstr = this.getQuery();\r\n\tif(qstr){\r\n\t\tthis.newQuery(qstr, setInitNodes);\r\n\t}\r\n\telse {\r\n\t\talert(\"No query string - must set filter and focus node before initialisation\");\r\n\t}\r\n}\r\n\r\nDCOGBrowser.prototype.setViewportData = function(dqr){\r\n\tfor(var k in this.viewports){\r\n\t\tthis.viewports[k].setData(dqr, k == this.current_viewport);\r\n\t}\r\n}\r\n\r\nDCOGBrowser.prototype.updateViewportData = function(dqr){\r\n\tfor(var k in this.viewports){\r\n\t\tthis.viewports[k].updateData(dqr, k == this.current_viewport);\r\n\t}\r\n}\r\nDCOGBrowser.prototype.setViewportFilter = function(dqr){\r\n\tfor(var k in this.viewports){\r\n\t\tif(typeof this.viewports[k].setFilter == \"function\"){\r\n\t\t\tthis.viewports[k].setFilter(dqr, k == this.current_viewport);\r\n\t\t}\r\n\t\telse {\r\n\t\t\talert(k + \" does not implement set filter browser function\");\r\n\t\t}\r\n\t}\r\n}\r\n\r\nDCOGBrowser.prototype.nodeSelected = function(node){\r\n\tif(this.focus_node != node.id){\r\n\t\tthis.focus_node = node.id;\r\n\t}\r\n\tvar sections = this.getNodeInfoSections(node);\r\n\tthis.myowner.nodeSelected(node, sections);\r\n}\r\n\r\nDCOGBrowser.prototype.getNodeInfoSections = function(node){\r\n\treturn [];\r\n}\r\n\r\nDCOGBrowser.prototype.followNode = function(node, success){\r\n\tthis.moreResults(node.id, success);\r\n}\r\n\r\nDCOGBrowser.prototype.setFocusNode = function(id){\r\n\tvar self = this;\r\n\tthis.focus_node = id;\r\n\tthis.newQuery(this.getQuery());\r\n}\r\n\r\nDCOGBrowser.prototype.setPathSearch = function(node_from, node_to){\r\n\tthis.focus_node = false;\r\n\tthis.from_node = node_from;\r\n\tthis.to_node = node_to;\r\n\tthis.newQuery(this.getQuery());\r\n}\r\n\r\nDCOGBrowser.prototype.changeTimeSlice = function(val, valto, force){\r\n\tif(this.current_result){\r\n\t\tif(!this.current_result.isTemporalSuperset(this.query_timeslice, val, valto)){\r\n\t\t\tthis.current_result.setQueryTimeslice(val, valto);\r\n\t\t\tthis.query_timeslice = this.current_result.getTimeslice()\r\n\t\t\tthis.newQuery(this.getQuery());\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.current_result.setFilterTimeslice(val, valto);\r\n\t\t\tthis.setViewportFilter(this.current_result);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nDCOGBrowser.prototype.getControllerAsDOM = function(){\r\n\tvar cdom = document.createElement(\"div\");\r\n\tcdom.setAttribute(\"class\", \"dcog-browser-controller-wrapper\");\r\n\tcdom.appendChild(this.getControllerViewButtonsAsDOM());\r\n\tcdom.appendChild(this.slider.getSliderDOM());\r\n\tthis.toolboxDOM = this.getUserToolboxDOM();\r\n\tcdom.appendChild(this.toolboxDOM);\r\n\tthis.rebuildController();\r\n\tcdom.appendChild(this.filterDOM);\r\n\tcdom.appendChild(this.legendDOM);\r\n\treturn cdom;\r\n}\r\n\r\nDCOGBrowser.prototype.getControllerFilterAsDOM = function(){\r\n\tif(this.filterDOM) {\r\n\t\tjQuery(this.filterDOM).empty();\r\n\t}\r\n\telse {\r\n\t\tvar cdom = document.createElement(\"div\");\r\n\t\tcdom.setAttribute(\"class\", \"dcog-browser-controller-filter\");\r\n\t\tthis.filterDOM = cdom;\r\n\t}\r\n\tvar fdom = this.filter.getRelationshipFilterAsDOM();\r\n\tvar ndom = this.filter.getQueryParameterDOM();\r\n\tvar ipfield = this.slider.getSliderTypeDOM();\r\n\tndom.appendChild(ipfield);\r\n\tvar self = this;\r\n\tvar gobut = document.createElement(\"button\");\r\n\tgobut.setAttribute(\"class\", \"dcog-filter-submit dcog-dashboard-button\");\r\n\tgobut.appendChild(document.createTextNode(\"Go\"));\r\n\tgobut.addEventListener(\"click\", function(){\r\n\t\tself.newQuery();\r\n\t});\r\n\t\r\n\tthis.filterDOM.appendChild(fdom);\r\n\tthis.filterDOM.appendChild(ndom);\r\n\tndom.appendChild(gobut);\r\n\t\r\n\tif(!this.show_filter){\r\n\t\tjQuery(this.filterDOM).hide();\r\n\t}\r\n\treturn this.filterDOM;\r\n}\r\n\r\nDCOGBrowser.prototype.toggleFilterVisibility = function(){\r\n\tif(this.show_filter){\r\n\t\tjQuery(this.filterDOM).hide();\r\n\t}\r\n\telse {\r\n\t\tjQuery(this.filterDOM).show();\r\n\t}\r\n\tthis.show_filter = !this.show_filter;\r\n}\r\n\r\n\r\nDCOGBrowser.prototype.rebuildController = function(){\r\n\tthis.getControllerFilterAsDOM();\r\n\tthis.legendDOM = this.getLegendAsDOM();\r\n}\r\n\r\nDCOGBrowser.prototype.untell = function(){\r\n\tjQuery(this.userMessageDOM).empty(); \r\n}\r\n\r\n\r\nDCOGBrowser.prototype.tellUser = function(msg, type){\r\n\tif(typeof msg == \"undefined\") {\r\n\t\tjQuery(this.userMessageDOM).empty(); \r\n\t}\r\n\telse {\r\n\t\ttype = (type ? type : \"info\");\r\n\t\tvar msgdom = document.createElement(\"span\");\r\n\t\tmsgdom.setAttribute(\"class\", \"dcog-browser-message dcog-message-\" + type);\r\n\t\tif(typeof msg == \"object\"){\r\n\t\t\tmsg = \"<b>\" + msg.title + \"</b> \" + msg.body;\r\n\t\t}\r\n\t\tmsgdom.innerHTML = msg;\r\n\t\tjQuery(this.userMessageDOM).html(msgdom);\r\n\t}\r\n}\r\n\r\nDCOGBrowser.prototype.clearBusy = function(busy){\r\n\tbusy = (busy ? busy : this.busy);\r\n\tif(busy){\t\r\n\t\tjQuery(busy).remove();\r\n\t}\r\n}\r\n\r\nDCOGBrowser.prototype.getUserToolboxDOM = function(){\r\n\tvar cdom = document.createElement(\"div\");\r\n\tcdom.setAttribute(\"class\", \"dcog-browser-toolbox\");\r\n\tvar msgdom = document.createElement(\"span\");\r\n\tmsgdom.setAttribute(\"class\", \"dcog-browser-message-container\");\r\n\tthis.userMessageDOM = msgdom;\r\n\tcdom.appendChild(msgdom);\r\n\tvar tdom = document.createElement(\"span\");\r\n\ttdom.setAttribute(\"class\", \"dcog-browser-tools\");\r\n\t//var dld = document.createElement(\"i\");\r\n\t//dld.setAttribute(\"class\", \"fas fa-download dcog-browser-tool-icon\");\r\n\tvar self = this;\r\n\t/*dld.addEventListener(\"click\", function(){\r\n\t\tif(typeof told == \"undefined\" || !told){\r\n\t\t\tself.tellUser(\"this is the user dialogue box - it will tell the user how to download the data\");\r\n\t\t\ttold = true;\r\n\t\t}\r\n\t\telse {\r\n\t\t\ttold = false;\r\n\t\t\tself.tellUser();\r\n\t\t}\r\n\t});*/\r\n\t//tdom.appendChild(dld);\r\n\tvar dlc = document.createElement(\"i\");\r\n\tdlc.setAttribute(\"class\", \"fas fa-cog dcog-browser-tool-icon\");\r\n\tdlc.addEventListener(\"click\", function(){\r\n\t\tself.toggleFilterVisibility();\r\n\t});\r\n\ttdom.appendChild(dlc);\r\n\tcdom.appendChild(tdom);\r\n\treturn cdom;\r\n}\r\n\r\nDCOGBrowser.prototype.getControllerViewButtonsAsDOM = function(){\r\n\tvar self = this;\r\n\tvar bdoms = [];\r\n\tvar cdom = document.createElement(\"div\");\r\n\tcdom.setAttribute(\"class\", \"dcog-browser-view-buttons\");\r\n\tfor(var k in this.viewports){\r\n\t\tvar bdom = document.createElement(\"button\");\r\n\t\tbdom.appendChild(document.createTextNode(k));\r\n\t\tvar i = document.createElement(\"i\");\r\n\t\tif(k == \"graph\"){\r\n\t\t\ti.setAttribute(\"class\", \"dcog-viewer-icon fas fa-code-branch\")\r\n\t\t}\r\n\t\telse if(k == \"map\"){\r\n\t\t\ti.setAttribute(\"class\", \"dcog-viewer-icon fas fa-globe\")\t\t\t\r\n\t\t}\r\n\t\telse if(k == \"table\"){\r\n\t\t\ti.setAttribute(\"class\", \"dcog-viewer-icon fas fa-list\")\t\t\t\r\n\t\t}\r\n\t\telse if(k == \"api\"){\r\n\t\t\ti.setAttribute(\"class\", \"dcog-viewer-icon fas fa-robot\")\t\t\t\r\n\t\t}\r\n\t\tbdom.appendChild(i);\r\n\t\tbdom.setAttribute(\"id\", this.browserid + k);\r\n\t\tif(k == this.current_viewport){\r\n\t\t\tbdom.setAttribute(\"class\", \"selected\");\r\n\t\t}\r\n\t\telse {\r\n\t\t\tbdom.setAttribute(\"class\", \"not-selected\");\r\n\t\t}\r\n\t\tbdom.addEventListener(\"click\", function(){\r\n\t\t\tfor(var i=0; i<bdoms.length; i++){\r\n\t\t\t\tbdoms[i].setAttribute(\"class\", \"not-selected\");\r\n\t\t\t}\r\n\t\t\tthis.setAttribute(\"class\", \"selected\");\r\n\t\t\tself.setView(this.id.substring(self.browserid.length));\r\n\t\t});\r\n\t\tbdoms.push(bdom);\r\n\t\tcdom.appendChild(bdom);\r\n\t}\r\n\treturn cdom;\t\r\n}\r\n\r\nDCOGBrowser.prototype.getLegendAsDOM = function(){\r\n\tif(this.legendDOM) {\r\n\t\tjQuery(this.legendDOM).empty();\r\n\t}\r\n\telse {\r\n\t\tthis.legendDOM = document.createElement(\"div\");\r\n\t\tthis.legendDOM.setAttribute(\"class\", \"dcog-viewport-legend\");\r\n\t}\r\n\tif(typeof this.viewports[this.current_viewport].legend == \"function\"){\r\n\t\tvar dom = this.viewports[this.current_viewport].legend();\r\n\t\tif(dom){\r\n\t\t\tthis.legendDOM.appendChild(dom);\r\n\t\t\tjQuery(this.legendDOM).show();\r\n\t\t}\r\n\t\telse {\r\n\t\t\tjQuery(this.legendDOM).hide();\r\n\t\t}\r\n\t}\r\n\treturn this.legendDOM;\r\n}\r\n\r\n/*\r\n * Display settings for shared look and field between different views - eventually to be kicked back to model \r\n */\r\n\r\nDCOGBrowser.prototype.getNodeRelativeSize = function(node){\r\n\tvar nconf = this.getNodeDisplaySettings(node);\r\n\tif(nconf.size) return nconf.size;\r\n\treturn 1;\r\n}\r\n\r\nDCOGBrowser.prototype.getLineWidth = function(node){\r\n\tvar nconf = this.getNodeDisplaySettings(node);\r\n\tif(nconf.size) return nconf.size;\r\n\treturn 4;\r\n}\r\n\r\nDCOGBrowser.prototype.getModelElementDisplaySettings = function(elt){\r\n\tif(typeof this.config.modeldisplay[elt] != \"undefined\"){\r\n\t\treturn jQuery.extend(true, {}, this.config.modeldisplay[elt]);\r\n\t}\r\n\talert(elt);\r\n\treturn jQuery.extend(true, {}, this.config.default_display);\r\n}\r\n\r\nDCOGBrowser.prototype.isBidirectional = function(edge){\r\n\tif(edge.typeID){\r\n\t\tvar conf = this.config.modeldisplay[edge.typeID];\r\n\t\tif(!conf){\r\n\t\t\t//jpr(edge);\r\n\t\t}\r\n\t\telse if(conf.forward && conf.backward){\r\n\t\t\tvar s = this.current_result.getNodeOrFringe(edge.source);\r\n\t\t\tvar t = this.current_result.getNodeOrFringe(edge.target);\r\n\t\t\tif((t && s && t.groupID && s.groupID) && (s.groupID.indexOf(\"Person\") == -1 && t.groupID.indexOf(\"Person\") == -1) )\r\n\t\t\t\treturn true;\t\t\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\n\r\nDCOGBrowser.prototype.getRelationshipClass = function(nick){\r\n\treturn nick;\r\n\t//if(this.config.cmap[nick]) return this.config.cmap[nick];\r\n\t//return false;\r\n}\r\n\r\nDCOGBrowser.prototype.getGraphElementDisplaySettings = function(node){\r\n\tif(node){\r\n\t\tvar nds = this.getNodeDisplaySettings(node);\r\n\t\tif(!nds){\r\n\t\t\tnds = this.getLinkDisplaySettings(node);\r\n\t\t}\r\n\t\treturn nds;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nDCOGBrowser.prototype.getNodeDisplaySettings = function(node){\r\n\tif(typeof node.groupID != \"undefined\"){\r\n\t\treturn this.getModelElementDisplaySettings(node.groupID);\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nDCOGBrowser.prototype.getLinkDisplaySettings = function(link){\r\n\tif(typeof link.typeID != \"undefined\"){\r\n\t\treturn this.getModelElementDisplaySettings(link.typeID);\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nDCOGBrowser.prototype.getElementIcon = function(elt){\r\n\tvar settings = this.getGraphElementDisplaySettings(elt);\r\n\tif(!settings) settings = this.config.default_display;\r\n\treturn settings.icon;\r\n}\r\n\r\nDCOGBrowser.prototype.getClassIcon = function(cls){\r\n\tvar settings = this.getModelElementDisplaySettings(cls);\r\n\tif(!settings) settings = this.config.default_display;\r\n\treturn settings.icon;\r\n}\r\n\r\nDCOGBrowser.prototype.getElementIconUnicode = function(elt){\r\n\tvar settings = this.getGraphElementDisplaySettings(elt);\r\n\tif(!settings) settings = this.config.default_display;\r\n\treturn settings.icon_unicode;\r\n}\r\n\r\nDCOGBrowser.prototype.getElementColour = function(elt){\r\n\tvar settings = this.getGraphElementDisplaySettings(elt);\r\n\tif(!settings) settings = this.config.default_display;\r\n\treturn jQuery.extend(true, [], settings.color);\r\n}\r\n\r\n\r\nDCOGBrowser.prototype.setUpIPGSpecials = function(){\r\n\tthis.config.modeldisplay = {};\r\n\tvar reldisptypes = [\r\n\t\t{\r\n\t\t\ticon: \"fas fa-caret-right\",\r\n\t\t\ticon_unicode: \"\\uf0d6\",\r\n\t\t\tsize: 6,\r\n\t\t\tcolor: [125,125,255],\r\n\t\t},\r\n\t\t{\r\n\t\t\ticon: \"fab fa-creative-commons-by\",\r\n\t\t\ticon_unicode: \"\\uf4e7\",\r\n\t\t\tsize: 5,\r\n\t\t\tcolor: [255,125,125],\r\n\t\t},\r\n\t\t{\r\n\t\t\ticon: \"fas fa-handshake\",\r\n\t\t\tcolor: [125,255,125],\r\n\t\t\tsize: 7,\r\n\t\t\ticon_unicode: \"\\uf2b5\",\r\n\t\t},\r\n\t\t{\r\n\t\t\ticon: \"fas fa-creative-commons-nc-eu\",\r\n\t\t\ticon_unicode: \"\\uf4e9\",\r\n\t\t\tsize: 4,\r\n\t\t\tcolor: [50,50,50],\r\n\t\t},\r\n\t\t{\r\n\t\t\ticon: \"fas fa-sitemap\",\r\n\t\t\ticon_unicode: \"\\uf0e8\",\r\n\t\t\tsize: 8,\r\n\t\t\tcolor: [125,255,255],\r\n\t\t}\r\n\t];\r\n\tvar entdisptypes = [ \r\n\t\t {\r\n\t\t    \ticon: \"fas fa-users\",\r\n\t\t\t\tsize: 1,\r\n\t\t\t\ticon_unicode: \"\\uf0c0\",\r\n\t\t\t\tcolor: [255,125,125],\r\n\t\t\t},\r\n\t\t{\r\n\t\t\ticon: \"fas fa-industry\",\r\n\t\t\tsize: 1.5,\r\n\t\t\ticon_unicode: \"\\uf275\",\r\n\t\t\tcolor: [100,125,255],\r\n\t    },\r\n\t\t{\r\n\t\t\ticon: \"fas fa-user\",\r\n\t\t\tsize: 0.9,\r\n\t\t\ticon_unicode: \"\\uf007\",\r\n\t\t\tcolor: [125,255,125],\r\n\t\t},\r\n\t   {\r\n\t\t\ticon: \"fas fa-building\",\r\n\t\t\ticon_unicode: \"\\uf1ad\",\r\n\t\t\tsize: 1.4,\r\n\t\t\tcolor: [125,125,225],\r\n\t\t},\r\n\t\t{\r\n\t\t\ticon: \"fas fa-briefcase\",\r\n\t\t\ticon_unicode: \"\\uf0b1\",\r\n\t\t\tcolor: [125,125,200],\r\n\t\t\tsize: 1.2,\r\n\t\t},\r\n\t\t{\r\n\t\t\ticon: \"fas fa-user-astronaut\",\r\n\t\t\ticon_unicode: \"\\uf4fb\",\r\n\t\t\tsize: 0.9,\r\n\t\t\tcolor: [125,220,125],\r\n\t\t}\r\n\t];\r\n\t\r\n\tvar i = 0;\r\n\tfor(var rid in this.relationships){\r\n\t\tif(i >= reldisptypes.length) i = 0;\r\n\t\tvar disptype = reldisptypes[i];\r\n\t\tdisptype['forward'] = this.relationships[rid].label;\r\n\t\tthis.config.modeldisplay[rid] = disptype;\r\n\t\ti++;\r\n\t}\r\n\ti = 0;\r\n\tfor(var eid in this.entities){\r\n\t\tif(i >= reldisptypes.length) i = 0;\r\n\t\tvar disptype = entdisptypes[i];\r\n\t\tdisptype['text'] = this.entities[eid].label;\r\n\t\tthis.config.modeldisplay[eid] = disptype;\r\n\t\ti++;\r\n\t}\r\n}\r\n\r\nmodule.exports=WOQLGraphBrowserGenerator\r\n\r\n","WOQLTimePicker = function(config){\r\n\tthis.type = (config && config.slidertype ? config.slidertype : \"range\");\r\n\tthis.timeslice = false;\r\n\tvar defch = function(from, to, ss){\r\n\t\talert(\"changed to: (from) \" + from + \" ... (to) \" + to + \" (\" + ss + \")\");\r\n\t};\r\n\tthis.change = config && config.change ? config.change : defch;  \r\n\tthis.years = (config && config.years ? config.years : 20);\r\n\tthis.server_side = false;\r\n}\r\n\r\nWOQLTimePicker.prototype.toggleServerSideFiltering = function(val){\r\n\tthis.server_side = !this.server_side;\r\n}\r\n\r\nWOQLTimePicker.prototype.getSliderParameters = function(val){\r\n\tstart = 0;\r\n\tend = this.years;\r\n\tvar self = this;\r\n\tvar pointInit = {\r\n\t\t\tmin: start, \r\n\t\t\tmax: end, \r\n\t\t\tvalue: val,\r\n\t\t\tslide: function(event, ui){\r\n\t\t\t\tvar tt = self.tickToTime(ui.value);\r\n\t\t\t\tself.changeTimeSlice(tt);\r\n\t\t\t}\r\n\t}\r\n\tvar rangeInit = {\r\n\t\t\trange: true,\r\n\t\t\tmin: start, \r\n\t\t\tmax: end, \r\n\t\t\tvalues: val,\r\n\t\t\tslide: function(event, ui){\r\n\t\t\t\tself.changeTimeSlice(self.tickToTime(ui.values[0]), self.tickToTime(ui.values[1]));\r\n\t\t\t}\r\n\t}\r\n\tvar sconfig = (this.type == \"range\" ? rangeInit : pointInit);\r\n\treturn sconfig;\r\n}\r\n\r\nWOQLTimePicker.prototype.changeTimeSlice = function(val, val2, noshow){\r\n\tif(this.type == \"range\"){\r\n\t\tthis.timeslice = {};\r\n\t\tthis.timeslice.from = val;\r\n\t\tthis.timeslice.to = val2;\r\n\t\tthis.change(val, val2, this.server_side);\r\n\t}\r\n\telse {\r\n\t\tthis.timeslice = val;\r\n\t\tthis.change(val, false, this.server_side);\r\n\t}\r\n\tif(!noshow){\t\r\n\t\tthis.showCurrentPick();\r\n\t}\r\n}\r\n\r\nWOQLTimePicker.prototype.tickToTime = function(ticknum){\r\n\tif(ticknum == 0){\r\n\t\tvar nval = 0;\r\n\t}\r\n\telse {\r\n\t\tvar year = 31622400 ;\r\n\t\tvar seconds_ago = year * (this.years - ticknum);\r\n\t\tvar now = new Date().getTime()/1000;\r\n\t\tvar nval = now - seconds_ago;\r\n\t}\r\n\treturn nval;\r\n}\r\n\r\n\r\nWOQLTimePicker.prototype.timeToTick = function(timeval){\r\n\tif(timeval){\r\n\t\tvar y = (new Date(timeval * 1000)).getFullYear();\r\n\t\tvar thisy = (new Date()).getFullYear();\r\n\t\treturn this.years - (thisy -y);\r\n\t}\r\n\treturn 0;\r\n}\r\n\r\nWOQLTimePicker.prototype.changeSliderType = function(ntype){\r\n\tvar val, val2;\r\n\tif(this.type == \"point\" && ntype == \"range\"){\r\n\t\tif(this.timeslice){\r\n\t\t\tval = this.timeslice\r\n\t\t\tval2 = this.timeslice;\r\n\t\t}\r\n\t}\r\n\telse if(this.type == \"range\" && ntype == \"point\"){\r\n\t\tif(this.timeslice){\r\n\t\t\tif(this.timeslice.from == 0 && this.timeslice.to == 0) val = false;\r\n\t\t\telse if(this.timeslice.from == 0) val = this.timeslice.to;\r\n\t\t\telse if(this.timeslice.to == 0) val = this.timeslice.from;\r\n\t\t\telse val = (this.timeslice.from + this.timeslice.to) / 2;\r\n\t\t\tval2 = false;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tval = 0;\r\n\t\t}\r\n\t\t\r\n\t}\r\n\tthis.type = ntype;\r\n\tthis.changeTimeSlice(val, val2, true);\r\n\tthis.updateSliderDOM();\r\n}\r\n\r\nWOQLTimePicker.prototype.getSliderTypeDOM = function(){\r\n\tvar dcd = document.createElement(\"span\");\r\n\tdcd.setAttribute(\"class\", \"terminus-parameter\");\r\n\tvar lab = document.createElement(\"label\");\r\n\tlab.appendChild(document.createTextNode(\"Dates\"));\r\n\tdcd.appendChild(lab);\r\n\tvar self = this;\r\n\tvar sel = document.createElement(\"select\");\r\n\tvar opt = document.createElement(\"option\");\r\n\topt.value = \"\";\r\n\topt.appendChild(document.createTextNode(\"None\"));\r\n\tif(this.type == \"\"){\r\n\t\topt.setAttribute(\"selected\", \"selected\");\r\n\t}\r\n\tsel.appendChild(opt);\r\n\topt = document.createElement(\"option\");\r\n\topt.value = \"point\";\r\n\topt.appendChild(document.createTextNode(\"Point\"));\r\n\tif(this.type == \"point\"){\r\n\t\topt.setAttribute(\"selected\", \"selected\");\r\n\t}\r\n\tsel.appendChild(opt);\r\n\topt = document.createElement(\"option\");\r\n\topt.value = \"range\";\r\n\topt.appendChild(document.createTextNode(\"Range\"));\r\n\tif(this.type == \"range\"){\r\n\t\topt.setAttribute(\"selected\", \"selected\");\r\n\t}\r\n\tsel.appendChild(opt);\r\n\tvar self = this;\r\n\tsel.addEventListener(\"change\", function(){\r\n\t\tif(this.value != self.type){\r\n\t\t\tself.changeSliderType(this.value);\r\n\t\t}\r\n\t});\r\n\tdcd.appendChild(sel);\r\n\t\r\n\tvar cb = document.createElement(\"input\");\r\n\tcb.setAttribute(\"type\", \"checkbox\");\r\n\tvar elid = this.browserid + \"-ssp\";\r\n\tif(this.server_side){\r\n\t\tcb.setAttribute(\"checked\", true);\r\n\t}\r\n\tvar self = this;\r\n\tcb.addEventListener(\"change\", function(){\r\n\t\tself.toggleServerSideFiltering();\r\n\t});\r\n\tvar lb = document.createElement(\"label\");\r\n\tlb.setAttribute(\"for\", elid);\r\n\tlb.appendChild(document.createTextNode(\"Server Side\"));\r\n\tdcd.appendChild(lb);\r\n\tdcd.appendChild(cb);\r\n\treturn dcd;\r\n\t\r\n}\r\n\r\nWOQLTimePicker.prototype.updateSliderDOM = function(){\r\n\tthis.slideDOM = this.getSliderDOM();\r\n}\r\n\r\nWOQLTimePicker.prototype.getSliderDOM = function(start, end){\r\n\tif(this.slideDOM){\r\n\t\tjQuery(this.slideDOM).empty();\r\n\t}\r\n\telse {\r\n\t\tthis.slideDOM = document.createElement(\"div\");\r\n\t\tthis.slideDOM.setAttribute(\"class\", \"terminus-controller-slider\");\r\n\t}\r\n\tif(this.type == \"\"){\r\n\t\tthis.changeTimeSlice(false);\r\n\t\treturn this.slideDOM;\r\n\t}\r\n\tvar TopAxisDOM = document.createElement(\"div\");\r\n\tTopAxisDOM.setAttribute(\"class\", \"terminus-controller-slider-panel terminus-controller-slider-topaxis\");\r\n\tif(this.type == \"point\"){\r\n\t\tthis.curdate = document.createElement(\"span\");\r\n\t\tthis.curdate.setAttribute(\"class\", \"terminus-slider-current terminus-slider-current-date\");\r\n\t\tTopAxisDOM.appendChild(this.curdate);\r\n\t}\r\n\telse if(this.type == \"range\") {\r\n\t\tthis.cursdate = document.createElement(\"span\");\r\n\t\tthis.cursdate.setAttribute(\"class\", \"terminus-slider-current terminus-slider-current-date-start\");\r\n\t\tTopAxisDOM.appendChild(this.cursdate);\r\n\t\tthis.curedate = document.createElement(\"span\");\t\t\r\n\t\tthis.curedate.setAttribute(\"class\", \"terminus-slider-current terminus-slider-current-date-end\");\r\n\t\tTopAxisDOM.appendChild(this.curedate);\r\n\t}\r\n\tthis.slideDOM.appendChild(TopAxisDOM);\r\n\tthis.showCurrentPick();\r\n\tvar LabelDOM = document.createElement(\"span\");\r\n\tLabelDOM.setAttribute(\"class\", \"terminus-controller-slider-label terminus-controller-slider-startlabel\");\r\n\tthis.slideDOM.appendChild(LabelDOM);\r\n\tvar PayloadDOM = document.createElement(\"div\");\r\n\tPayloadDOM.setAttribute(\"class\", \"terminus-controller-slider-payload\");\r\n\tthis.slideDOM.appendChild(PayloadDOM);\r\n\tvar L2DOM = document.createElement(\"span\");\r\n\tL2DOM.setAttribute(\"class\", \"terminus-controller-slider-label terminus-controller-slider-endlabel\");\r\n\tthis.slideDOM.appendChild(L2DOM);\r\n\tL2DOM.appendChild(this.getSliderAxisDOM());\r\n\tvar sconfig = this.getSliderParameters(this.getTimesliceAsTicks());\r\n\tjQuery(PayloadDOM).slider(sconfig);\r\n\treturn this.slideDOM;\r\n}\r\n\r\nWOQLTimePicker.prototype.getTimesliceAsTicks = function(){\r\n\tif(this.timeslice){\r\n\t\tif(this.type == \"range\"){\r\n\t\t\tvtf = (this.timeslice.from ? this.timeToTick(this.timeslice.from) : 0);\r\n\t\t\tvtt = (this.timeslice.to ? this.timeToTick(this.timeslice.to) : 0);\r\n\t\t\tvar val = [vtf, vtt];\r\n\t\t}\r\n\t\telse {\r\n\t\t\tvar val = this.timeToTick(this.timeslice)\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tvar val = (this.type == \"range\" ? [0, this.years] : 0);\r\n\t}\r\n\treturn val;\r\n}\r\n\r\nWOQLTimePicker.prototype.showCurrentPick = function(){\r\n\tif(this.type == \"range\"){\r\n\t\tif(!this.timeslice.from) {\r\n\t\t\tvar nd  = new Date();\r\n\t\t\tvar fy = nd.getFullYear() - this.years;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tvar nd = new Date(this.timeslice.from * 1000);\r\n\t\t\tvar fy = nd.getFullYear(); \r\n\t\t}\r\n\t\tthis.cursdate.innerHTML = fy;\r\n\t\tthis.adjustOffset(this.cursdate, this.timeslice.from);\r\n\t\tif(!this.timeslice.to) {\r\n\t\t\tvar ty = new Date().getFullYear();\r\n\t\t}\r\n\t\telse {\r\n\t\t\tvar ty = new Date(this.timeslice.to * 1000).getFullYear(); \r\n\t\t}\r\n\t\tif(ty != fy){\r\n\t\t\tthis.curedate.innerHTML = ty;\r\n\t\t\tthis.adjustOffset(this.curedate, this.timeslice.to, true);\r\n\t\t\t//jQuery(this.curedate).show();\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.curedate.innerHTML = \"\";\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tif(this.timeslice){\r\n\t\t\tvar nd = new Date(this.timeslice * 1000);\r\n\t\t\tfy = nd.getFullYear(); \r\n\t\t}\r\n\t\telse {\r\n\t\t\tfy = \"off\";\r\n\t\t}\r\n\t\tthis.curdate.innerHTML = fy;\r\n\t\tthis.adjustOffset(this.curdate, this.timeslice);\r\n\t}\r\n}\r\n\r\nWOQLTimePicker.prototype.adjustOffset = function(dom, tval, r){\r\n\tvar tick = this.timeToTick(tval);\r\n\tvar totwidth = 50 + (this.slideDOM.offsetWidth ? this.slideDOM.offsetWidth : 0);\r\n\tvar unit = totwidth / (this.years + 1);\r\n\tvar box = -25;\r\n\tvar which = (r ? \"margin-right\" : \"margin-left\");\r\n\tif(r){\r\n\t\tif(tick){\r\n\t\t\tvar off = ((this.years - tick) * unit) + box;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tvar off = box;\r\n\t\t}\r\n\t\tdom.setAttribute(\"style\", \"margin-right: \" + off + \"px\");\r\n\t}\r\n\telse {\r\n\t\tvar off = unit * tick + box;\r\n\t\tdom.setAttribute(\"style\", \"margin-left: \" + off + \"px\");\r\n\t}\r\n}\r\n\r\nWOQLTimePicker.prototype.getSliderAxisDOM = function(){\r\n\tvar cdom = document.createElement(\"div\");\r\n\tcdom.setAttribute(\"class\", \"terminus-slider-axis-wrapper\");\r\n\tvar fy = new Date().getFullYear();\r\n\tvar sd = fy%5;\r\n\tvar vals = [];\r\n\tfor(var i = this.years; i>0; i-=5){\r\n\t\tvar val = (fy-i) - sd + 5;\r\n\t\tvals.push(val);\r\n\t}\r\n\tfor(var i = 0; i<vals.length; i++){\r\n\t\tvar ldom = document.createElement(\"label\");\r\n\t\tldom.setAttribute(\"class\", \"terminus-axis-label\");\r\n\t\tldom.innerHTML = \"<div class='terminus-tick'>|</div>\"+ vals[i];\r\n\t\tcdom.appendChild(ldom);\r\n\t}\r\n\tndom = document.createElement(\"label\");\r\n\tndom.setAttribute(\"class\", \"terminus-axis-label terminus-axis-now-label\");\r\n\tcdom.appendChild(ndom);\r\n\treturn cdom;\r\n}\r\n\r\nWOQLTimePicker.prototype.Y2Time = function(y){\r\n\treturn (new Date(y+ \"-12-31T12:00:00.000Z\").getTime() / 1000);\r\n}\r\n\r\nmodule.exports=WOQLTimePicker\r\n","function TerminusMappingViewer(ui, mode){\r\n\tthis.ui = ui;\r\n\tthis.mode = (mode ? mode : \"data\");\r\n}\r\n\r\nTerminusMappingViewer.prototype.getAsDOM = function(){\r\n\tvar scd = document.createElement(\"div\");\r\n\tscd.setAttribute(\"class\", \"terminus-mapping-page terminus-page\");\r\n\tvar tsel = document.createElement(\"select\");\r\n\tvar o1 = document.createElement(\"option\");\r\n\to1.value = \"data\";\r\n\to1.appendChild(document.createTextNode(\"Data Map\"))\r\n\ttsel.appendChild(o1);\r\n\tvar o2 = document.createElement(\"option\");\r\n\to2.value = \"model\";\r\n\to2.appendChild(document.createTextNode(\"Model Map\"))\r\n\ttsel.appendChild(o2);\r\n\tvar ff = this.getFormFieldDOM(\"Map Type\");\r\n\tff.appendChild(tsel);\r\n\tscd.appendChild(ff);\r\n\tvar source = this.getFormField(scd, \"Map Source\");\r\n\tvar target = this.getFormField(scd, \"Map Target\");\r\n\tvar queries = this.getFormField(scd, \"Queries\");\r\n\tvar options = this.getFormField(scd, \"Options\");\r\n\t\r\n\tvar mdom = this.getFormFieldDOM(\"Existing Mapping\");\r\n\tvar mapping = document.createElement(\"input\");\r\n\tmapping.setAttribute(\"type\", \"text\");\r\n\tmapping.setAttribute(\"size\", 80);\r\n\tmdom.appendChild(mapping);\r\n\tscd.appendChild(mdom);\r\n\t\r\n\tvar submit = document.createElement(\"button\");\r\n\tsubmit.setAttribute(\"class\", \"terminus-btn terminus-control-button\");\r\n\tsubmit.appendChild(document.createTextNode(\"Execute Mapping\"));\r\n\tvar self = this;\r\n\tsubmit.addEventListener(\"click\", function(){\r\n\t\tvar jsonip = {\r\n\t\t\tmap_source: JSON.parse(source.value),\r\n\t\t};\r\n\t\tif(tsel.value == \"data\"){\r\n\t\t\tjsonip[\"rdf:type\"] = \"dcogmodel:DataMap\";\r\n\t\t}\r\n\t\telse {\r\n\t\t\tjsonip[\"rdf:type\"] = \"dcogmodel:ModelMap\";\t\t\t\r\n\t\t}\r\n\t\tif(target.value) jsonip.map_target = target.value;\r\n\t\tif(queries.value) jsonip.queries = queries.value;\r\n\t\tif(options.value) jsonip.options = options.value;\r\n\t\tif(mapping.value) jsonip.mapping = mapping.value;\r\n\t\tself.ui.client.update(false, jsonip);\r\n\t})\r\n\tscd.appendChild(submit);\r\n\treturn scd;\r\n}\r\n\r\nTerminusMappingViewer.prototype.getFormFieldDOM = function(label){\r\n\tvar sci = document.createElement(\"div\");\r\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-mapping-field\");\r\n\tvar lab = document.createElement(\"span\");\r\n\tlab.setAttribute(\"class\", \"terminus-form-label terminus-mapping-label\");\r\n\tlab.appendChild(document.createTextNode(label));\r\n\tsci.appendChild(lab);\r\n\treturn sci;\r\n}\r\n\r\nTerminusMappingViewer.prototype.getFormField = function(holder, label){\r\n\tvar ff = this.getFormFieldDOM(label);\r\n\tvar source = document.createElement(\"textarea\");\r\n\tsource.setAttribute(\"class\", \"terminus-form-value terminus-textarea\");\r\n\tff.appendChild(source);\r\n\tholder.appendChild(ff);\r\n\treturn source;\r\n}\r\n\r\nmodule.exports=TerminusMappingViewer\r\n","/*\r\n * Draws the screen for viewing and updating the schema\r\n * and provides wrappers around the client's schema API\r\n */\r\nconst TerminusClassChooser = require('./TerminusClassChooser');\r\nconst TerminusDocumentViewer = require('./TerminusDocument');\r\nconst UTILS=require('../Utils')\r\n\r\nfunction TerminusSchemaViewer(ui){\r\n\tthis.ui = ui;\r\n\tthis.mode = \"view\";\r\n\tthis.format = \"turtle\";\r\n\tthis.confirm_before_update = false;\r\n}\r\n\r\n/*\r\n * Retrieves schema from API and writes the response into the page\r\n */\r\nTerminusSchemaViewer.prototype.getAsDOM = function(){\r\n\tthis.holder = document.createElement(\"div\");\r\n\tthis.controldom = document.createElement(\"div\");\r\n\tthis.controldom.setAttribute(\"class\", \"terminus-schema-controls\");\r\n\tthis.pagedom = document.createElement(\"div\");\r\n\tthis.pagedom.setAttribute(\"class\", \"terminus-schema-viewer\");\r\n\tthis.loadSchema();\r\n\tthis.holder.appendChild(this.controldom);\r\n\tthis.holder.appendChild(this.pagedom);\r\n\treturn this.holder;\r\n}\r\n\r\nTerminusSchemaViewer.prototype.loadSchema = function(msg, msgtype){\r\n\tvar self = this;\r\n\tthis.ui.showBusy(\"Fetching Database Schema\");\r\n\tthis.ui.client.getSchema(false, {\"terminus:encoding\": \"terminus:\" + this.format})\r\n\t.then(function(response){\r\n\t\tself.ui.clearBusy();\r\n\t\tself.schema = response;\r\n\t\tself.refreshPage(msg, msgtype);\r\n\t})\r\n\t.catch(function(error){\r\n\t\tself.ui.clearBusy();\r\n\t\tself.ui.showError(error);\r\n\t});\r\n}\r\n\r\nTerminusSchemaViewer.prototype.resetControlDOM = function(){\r\n\tTerminusClient.FrameHelper.removeChildren(this.controldom);\r\n\tif(this.mode == \"edit\"){\r\n\t\tthis.controldom.appendChild(this.getSchemaSaveButtons());\r\n\t}\r\n\telse if(this.mode == \"import\"){\r\n\t\tthis.controldom.appendChild(this.getSchemaImportActionButtons());\r\n\t}\r\n\telse if(this.mode == \"class_frame\"){\r\n\t\tif(this.ui.showControl(\"get_schema\")){\r\n\t\t\tthis.controldom.appendChild(this.getShowSchemaButton());\r\n\t\t}\r\n\t\tif(this.ui.showControl(\"class_frame\")){\r\n\t\t\tthis.controldom.appendChild(this.getClassFrameChooser());\r\n\t\t}\r\n\t}\r\n\telse if(this.mode == \"view\"){\r\n\t\tif(this.ui.showControl(\"update_schema\")){\r\n\t\t\tthis.controldom.appendChild(this.getSchemaEditButton());\r\n\t\t}\r\n\t\tif(this.ui.showControl(\"import_schema\")){\r\n\t\t\tthis.controldom.appendChild(this.getImportButton());\r\n\t\t}\r\n\t\tif(this.ui.showControl(\"schema_format\")){\r\n\t\t\tthis.controldom.appendChild(this.getFormatChoices());\r\n\t\t}\r\n\t\tif(this.ui.showControl(\"class_frame\")){\r\n\t\t\tthis.controldom.appendChild(this.getClassFrameChooser());\r\n\t\t}\r\n\t}\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getFormatChoices = function(){\r\n\tvar fc = document.createElement(\"select\");\r\n\tfc.setAttribute(\"class\", \"terminus-form-select terminus-schema-format terminus-type-select\");\r\n\tvar tc = document.createElement(\"option\");\r\n\ttc.setAttribute(\"class\", \"terminus-schema-turtle\");\r\n\ttc.value = \"turtle\";\r\n\ttc.appendChild(document.createTextNode(\"Turtle\"));\r\n\tif(this.format == \"turtle\") tc.selected = true;\r\n\tfc.appendChild(tc);\r\n\tvar tj = document.createElement(\"option\");\r\n\ttj.setAttribute(\"class\", \"terminus-schema-jsonld\");\r\n\ttj.value = \"jsonld\";\r\n\ttj.appendChild(document.createTextNode(\"Json LD\"));\r\n\tif(this.format == \"jsonld\") tj.selected = true;\r\n\tfc.appendChild(tj);\r\n\tvar self = this;\r\n\tfc.addEventListener(\"change\", function(e){\r\n\t\tself.format = this.value;\r\n\t\tself.loadSchema();\r\n\t});\r\n\treturn fc;\r\n}\r\n\r\n\r\nTerminusSchemaViewer.prototype.refreshPage = function(msg, msgtype){\r\n\tif(this.controldom) this.resetControlDOM();\r\n\tif(this.pagedom) this.refreshMainPage(msg, msgtype);\r\n}\r\n\r\nTerminusSchemaViewer.prototype.refreshMainPage = function(msg, msgtype){\r\n\tTerminusClient.FrameHelper.removeChildren(this.pagedom);\r\n\tif(this.mode == 'view'){\r\n\t\tthis.pagedom.appendChild(this.getSchemaViewDOM());\r\n\t}\r\n\telse if(this.mode == \"edit\"){\r\n\t\tthis.pagedom.appendChild(this.getSchemaEditDOM());\r\n\t}\r\n\telse if(this.mode == \"import\"){\r\n\t\tthis.pagedom.appendChild(this.getSchemaImportDOM());\r\n\t}\r\n\telse if(this.mode == \"class_frame\"){\r\n\t\tthis.pagedom.appendChild(this.getClassFrameDOM());\r\n\t}\r\n\tif(msg){\r\n\t\tthis.ui.showMessage(msg, msgtype);\r\n\t}\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getSchemaSaveButtons = function(){\r\n\tvar ssb = document.createElement(\"span\");\r\n\tssb.setAttribute(\"class\", \"terminus-schema-save-buttons\");\r\n\tssb.appendChild(this.getCancelButton());\r\n\tssb.appendChild(this.getSaveButton());\r\n\treturn ssb;\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getSchemaImportActionButtons = function(){\r\n\tvar ssb = document.createElement(\"span\");\r\n\tssb.setAttribute(\"class\", \"terminus-schema-import-buttons\");\r\n\tssb.appendChild(this.getCancelButton(true));\r\n\tssb.appendChild(this.getImportSaveButton());\r\n\treturn ssb;\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getShowSchemaButton = function(){\r\n\tvar self = this;\r\n\tvar func = function(){\r\n\t\tself.ui.clearMessages();\r\n\t\tself.mode = \"view\";\r\n\t\tself.refreshPage();\r\n\t}\r\n\treturn this.getSchemaButton(\"View Schema\", \"get_schema\", func);\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getImportPreviewButton = function(){\r\n\tvar self = this;\r\n\tvar func = function(){\r\n\t\tself.ui.clearMessages();\r\n\t\tself.mode = \"preview\";\r\n\t\tself.refreshPage();\r\n\t}\r\n\treturn this.getSchemaButton(\"Preview\", \"preview\", func);\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getCancelButton = function(is_import){\r\n\tvar self = this;\r\n\tvar func = function(){\r\n\t\tself.ui.clearMessages();\r\n\t\tself.mode = \"view\";\r\n\t\tif(is_import){\r\n\t\t\tself.ui.redraw();\r\n\t\t}\r\n\t\telse {\r\n\t\t\tself.refreshPage();\r\n\t\t}\r\n\t}\r\n\treturn this.getSchemaButton(\"Cancel\", \"cancel_update\", func);\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getImportSaveButton = function(){\r\n\tvar self = this;\r\n\tvar func = function(){\r\n\t\tself.ui.clearMessages();\r\n\t\tif(typeof self.doImport == \"function\"){\r\n\t\t\tself.doImport();\r\n\t\t}\r\n\t}\r\n\treturn this.getSchemaButton(\"Import\", \"import_schema\", func)\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getSaveButton = function(){\r\n\tvar self = this;\r\n\tvar func = function(){\r\n\t\tself.ui.clearMessages();\r\n\t\tvar text = self.schema_edit_dom.value;\r\n\t\tif(typeof(self.schema) == \"object\"){\r\n\t\t\ttext = JSON.parse(text);\r\n\t\t}\r\n\t\treturn self.updateSchema(text, {\"terminus:encoding\": \"terminus:\" + self.format});\r\n\t}\r\n\treturn this.getSchemaButton(\"Save\", \"update_schema\", func);\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getSchemaEditButton = function(){\r\n\tvar self = this;\r\n\tvar func = function(){\r\n\t\tself.mode = \"edit\";\r\n\t\tself.refreshPage();\r\n\t}\r\n\treturn this.getSchemaButton(\"Edit\", \"update_schema\", func);\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getImportButton = function(){\r\n\tvar self = this;\r\n\tvar func = function(){\r\n\t\tself.ui.clearMessages();\r\n\t\tself.mode = \"import\";\r\n\t\tself.refreshPage();\r\n\t}\r\n\treturn this.getSchemaButton(\"Import New Schema\", \"import_schema\", func);\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getSchemaButton = function(label, action, func){\r\n\tvar opt = document.createElement(\"button\");\r\n\topt.appendChild(document.createTextNode(label));\r\n\topt.setAttribute(\"class\", \"terminus-btn terminus-control-button terminus-schema-\" + action);\r\n\topt.addEventListener(\"click\", func);\r\n\treturn opt;\r\n}\r\n\r\n/*\r\n * Updates schema, then fetches updated version and updates the page with it\r\n */\r\nTerminusSchemaViewer.prototype.updateSchema  = function(text, opts){\r\n\tthis.ui.showBusy(\"Updating Database Schema\");\r\n\tvar self = this;\r\n\treturn this.ui.client.updateSchema(false, text, opts)\r\n\t.then(function(response){\r\n\t\tif(response['terminus:status'] && response['terminus:status'] == \"terminus:success\"){\r\n\t\t\tself.ui.showBusy(\"Retrieving updated schema\");\r\n\t\t\tself.mode = \"view\";\r\n\t\t\tself.loadSchema(\"Successfully Updated Schema\");\r\n\t\t\tself.ui.redraw();\r\n\t\t}\r\n\t\telse if(response['terminus:status'] && response['terminus:status'] == \"terminus:failure\"){\r\n\t\t\tself.ui.clearBusy();\r\n\t\t\tself.ui.showViolations(response['terminus:witnesses'], \"schema\");\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthrow new Error(\"Update Schema returned no terminus:status code\");\r\n\t\t}\r\n\t})\r\n\t.catch(function(error){\r\n\t\tself.ui.clearBusy();\r\n\t\tif(error.data && error.data['terminus:witnesses']){\r\n\t\t\tself.ui.showViolations(error.data['terminus:witnesses'], \"schema\");\t\t\t\r\n\t\t}\r\n\t\telse {\r\n\t\t\tself.ui.showError(error);\r\n\t\t}\r\n\t});\r\n}\r\n\r\n/*\r\n * Imports a schema from the passed url\r\n * mode: replace | append\r\n */\r\nTerminusSchemaViewer.prototype.load  = function(url, key, mode){\r\n\tvar self = this;\r\n\tmode = (mode ? mode : \"replace\");\r\n\tthis.ui.showBusy(\"Loading schema from \" + url);\r\n\tvar origurl = this.ui.client.connectionConfig.schemaURL();\r\n\treturn this.ui.client.getSchema(url, {\"terminus:user_key\": key, \"terminus:encoding\" : \"terminus:\" + this.format})\r\n\t.then(function(response){\r\n\t\tvar newschema = (mode == \"append\") ? self.appendSchema(response) : response;\r\n\t\tif(self.confirm_before_update){\r\n\t\t\t//reconnect to original db\r\n\t\t\tself.ui.showResult(\"Schema retrieved - click save to deploy\");\r\n\t\t\tself.ui.client.connectionConfig.setSchemaURL(origurl);\r\n\t\t\tself.showConfirmPage(newschema);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tself.ui.showBusy(\"Updating schema\");\r\n\t\t\tself.ui.client.connectionConfig.setSchemaURL(origurl);\r\n\t\t\tself.updateSchema(newschema, {\"terminus:encoding\": \"terminus:\" + self.format}).then(function(response){\r\n\t\t\t\tself.mode = \"view\";\r\n\t\t\t\tself.ui.clearBusy();\r\n\t\t\t\tself.ui.redraw();\r\n\t\t\t\tself.ui.showResult(\"Successfully deployed new schema from \" + url);\r\n\t\t\t\treturn response;\r\n\t\t\t});\r\n\t\t}\r\n\t}).catch(function(error){\r\n\t\tself.ui.clearBusy();\r\n\t\tself.ui.showError(error);\r\n\t});\r\n}\r\n\r\nTerminusSchemaViewer.prototype.appendSchema = function(s2){\r\n\tvar nschema = this.schema;\r\n\tif(this.format == 'turtle'){\r\n\t\tnschema = this.schema + s2;\r\n\t}\r\n\telse if(this.format == 'jsonld'){\r\n\t\tfor(var i in s2){\r\n\t\t\tnschema[i] = s2[i];\r\n\t\t}\r\n\t}\r\n\treturn nschema;\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getClassFrameChooser = function(){\r\n\tvar np = document.createElement(\"span\");\r\n\tnp.setAttribute(\"class\", \"terminus-class frame-chooser\");\r\n\tvar termcc = new TerminusClassChooser(this.ui);\r\n\ttermcc.empty_choice = \"View Individual Class Frames\";\r\n\tvar self = this;\r\n\ttermcc.change = function(new_class){\r\n\t\tif(new_class){\r\n\t\t\tself.cls = new_class;\r\n\t\t\tif(self.mode != \"class_frame\"){\r\n\t\t\t\tself.mode = \"class_frame\";\r\n\t\t\t\tself.refreshPage();\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tself.refreshMainPage();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tvar tcdom = termcc.getAsDOM();\r\n\tnp.appendChild(tcdom);\r\n\treturn np;\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getClassFrameDOM = function(){\r\n\tvar np = document.createElement(\"div\");\r\n\tnp.setAttribute(\"class\", \"terminus-schema-page terminus-schema-classframe-page\");\r\n\tvar docviewer = new TerminusDocumentViewer(this.ui, \"model\");\r\n\tdocviewer.loadCreateDocument(this.cls);\r\n\tdocviewer.page_config = \"model\";\r\n\tnp.appendChild(docviewer.getAsDOM());\r\n\treturn np;\r\n}\r\n\r\nTerminusSchemaViewer.prototype.showConfirmPage = function(newschema){\r\n\tthis.schema = newschema;\r\n\tthis.confirm_before_update = false;\r\n\tthis.mode = \"edit\";\r\n\tthis.refreshPage(\"Confirm new schema\");\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getSchemaEditDOM = function(){\r\n\tvar np = document.createElement(\"div\");\r\n\tnp.setAttribute(\"class\", \"terminus-schema-page terminus-schema-edit-page\");\r\n\tvar ipval = document.createElement(\"textarea\");\r\n\tipval.setAttribute(\"class\", \"terminus-schema-edit terminus-schema-textarea\");\r\n\tipval.setAttribute(\"width\", \"100%\");\r\n\tipval.setAttribute(\"style\", \"min-width: 400px; min-height: 400px;\");\r\n\tif(typeof(this.schema) == \"string\"){\r\n\t\tipval.innerHTML = this.schema;\r\n\t}\r\n\telse if(typeof (this.schema) == \"object\") {\r\n\t\tipval.innerHTML = JSON.stringify(this.schema, 0, 4);\r\n\t}\r\n\tthis.schema_edit_dom = ipval;\r\n\tnp.appendChild(ipval);\r\n\tUTILS.stylizeEditor(this.ui, ipval, 'schema', 'turtle');\r\n\treturn np;\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getSchemaViewDOM = function(){\r\n\tvar self = this;\r\n\tvar np = document.createElement(\"div\");\r\n\tnp.setAttribute(\"class\", \"terminus-schema-page terminus-schema-view-page\");\r\n\tvar ipval = document.createElement(\"pre\");\r\n\tipval.setAttribute(\"class\", \"terminus-schema-view terminus-scheme-pre\");\r\n\tif(typeof(this.schema) == \"string\"){\r\n\t\tvar txt = this.schema.replace(/&/g, \"&amp;\")\r\n         .replace(/</g, \"&lt;\")\r\n         .replace(/>/g, \"&gt;\")\r\n         .replace(/\"/g, \"&quot;\")\r\n         .replace(/'/g, \"&#039;\");\r\n\t\tipval.innerHTML = txt;\r\n\t}\r\n\telse if(typeof (this.schema) == \"object\") {\r\n\t\tipval.innerHTML = JSON.stringify(this.schema, 0, 4);\r\n\t}\r\n\tvar cm = UTILS.stylizeCodeDisplay(this.ui, ipval, np, 'turtle');\r\n\tif(!cm) np.appendChild(ipval);\r\n\treturn np;\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getSchemaImportDOM = function(){\r\n\tvar scd = document.createElement(\"div\");\r\n\tscd.setAttribute(\"class\", \"terminus-form-border terminus-schema-page terminus-schema-import-page\");\r\n\r\n\r\n\tvar sci = document.createElement(\"div\");\r\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-form-field-spacing terminus-form-horizontal terminus-control-group\");\r\n\tvar slab = document.createElement(\"span\");\r\n\tslab.setAttribute(\"class\", \"terminus-url-loader-input terminus-form-label terminus-control-label\");\r\n\tslab.appendChild(document.createTextNode(\"URL\"));\r\n\tsci.appendChild(slab);\r\n\tvar inpUrl  = document.createElement(\"input\");\r\n\tinpUrl.setAttribute(\"type\", \"text\");\r\n\tinpUrl.setAttribute(\"class\", \"terminus-form-value terminus-input-text terminus-form-url terminus-url-connect\");\r\n\tinpUrl.setAttribute(\"placeholder\", \"Enter URL of DB to import from\");\r\n\tsci.appendChild(inpUrl);\r\n\tscd.appendChild(sci);\r\n\r\n\tvar sci = document.createElement(\"div\");\r\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-form-field-spacing terminus-form-horizontal terminus-control-group\");\r\n\tvar klab = document.createElement(\"span\");\r\n\tklab.setAttribute(\"class\", \"terminus-url-loader-input terminus-form-label  terminus-control-label terminus-import_mode-input\");\r\n\tklab.appendChild(document.createTextNode(\"Import Mode\"));\r\n\tsci.appendChild(klab);\r\n\tvar modes = document.createElement(\"select\");\r\n\tmodes.setAttribute(\"class\", \"terminus-form-select\");\r\n\r\n\tvar overwrite = document.createElement(\"option\");\r\n\toverwrite.value = \"replace\";\r\n\toverwrite.appendChild(document.createTextNode(\"Replace Mode\"))\r\n\tmodes.appendChild(overwrite);\r\n\tvar append = document.createElement(\"option\");\r\n\tappend.value = \"append\";\r\n\tappend.appendChild(document.createTextNode(\"Append Mode\"))\r\n\tmodes.appendChild(append);\r\n\tmodes.setAttribute(\"class\", \"terminus-form-select terminus-import-mode\");\r\n\tsci.appendChild(klab);\r\n\tsci.appendChild(modes);\r\n\tscd.appendChild(sci);\r\n\r\n\tvar sci = document.createElement(\"div\");\r\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-form-field-spacing terminus-form-horizontal terminus-control-group\");\r\n\tvar klab = document.createElement(\"span\");\r\n\tklab.setAttribute(\"class\", \"terminus-form-label terminus-url-key-input terminus-control-label\");\r\n\tklab.appendChild(document.createTextNode(\"Key\"))\r\n\tvar key = document.createElement(\"input\");\r\n\tkey.setAttribute(\"type\", \"text\");\r\n\tkey.setAttribute(\"class\", \"terminus-form-value terminus-input-text terminus-url-key\");\r\n\tsci.appendChild(klab);\r\n\tsci.appendChild(key);\r\n\tscd.appendChild(sci);\r\n\tvar self = this;\r\n\tthis.doImport = function(){\r\n\t\tif(inpUrl.value){\r\n\t\t\tself.load(inpUrl.value, key.value, modes.value);\r\n\t\t}\r\n\t}\r\n\treturn scd;\r\n}\r\n\r\nmodule.exports=TerminusSchemaViewer\r\n","/* User interface elements that relate to server context\r\n *\r\n * TerminusServerController is a control widget that invokes server actions\r\n * TerminusServerViewer is a window that displays server actions and server screens\r\n *\r\n */\r\n const Datatables = require('../plugins/datatables.terminus');\r\n const UTILS =require('../Utils')\r\n function TerminusServerController(ui){\r\n\t this.ui = ui;\r\n }\r\n\r\nTerminusServerController.prototype.getAsDOM = function(){\r\n\tvar rsc = document.createElement(\"div\");\r\n\trsc.setAttribute(\"class\", \"terminus-server-controller\");\r\n\tvar self = this;\r\n\tif(this.ui && this.ui.server()){\r\n\t\tvar scd = document.createElement(\"div\");\r\n\t\tscd.setAttribute(\"class\", \"terminus-server-connectiAlso, the title / hover stuff should include the full entry when it is shortened (for urls / comments) so when I hover over it I should see the full texton\");\r\n        var nav = document.createElement('div');\r\n        nav.setAttribute('class', 'span3');\r\n        var ul = document.createElement('ul');\r\n        ul.setAttribute('class', 'terminus-ul');\r\n        nav.appendChild(ul);\r\n        rsc.appendChild(nav);\r\n        // connected to server\r\n        var a = document.createElement('a');\r\n        a.setAttribute('class', 'terminus-dashboard-info terminus-list-group-a terminus-nav-width');\r\n        var txt = 'Server: ' + this.ui.server();\r\n        a.appendChild(document.createTextNode(txt));\r\n        ul.appendChild(a);\r\n        // change server\r\n        if(this.ui.showControl(\"change-server\")){\r\n            var a = document.createElement('a');\r\n            a.setAttribute('class', 'terminus-a terminus-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\r\n            var self = this;\r\n            a.addEventListener(\"click\", function(){\r\n                UTILS.activateSelectedNav(this, self);\r\n                self.ui.showLoadURLPage();\r\n            })\r\n            var icon = document.createElement('i');\r\n            icon.setAttribute('class', 'terminus-menu-icon fa fa-link');\r\n            a.appendChild(icon);\r\n            var txt = document.createTextNode('Change Server');\r\n            a.appendChild(txt);\r\n            ul.appendChild(a);\r\n        }\r\n        // view databases\r\n        if(this.ui.showControl(\"db\")){\r\n            var a = document.createElement('a');\r\n            a.setAttribute('class', 'terminus-a terminus-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\r\n            var self = this;\r\n            a.addEventListener(\"click\", function(){\r\n                UTILS.activateSelectedNav(this, self);\r\n                if(self.ui.db()){\r\n                    //self.ui.clearDB();\r\n                }\r\n                self.ui.showServerMainPage();\r\n            })\r\n            var icon = document.createElement('i');\r\n            icon.setAttribute('class', 'terminus-menu-icon fa fa-eye');\r\n            a.appendChild(icon);\r\n            var txt = document.createTextNode('View Databases');\r\n            a.appendChild(txt);\r\n            ul.appendChild(a);\r\n        }\r\n        if(this.ui.showControl(\"create_database\")){\r\n            var a = document.createElement('a');\r\n            a.setAttribute('class', 'terminus-a terminus-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\r\n            var self = this;\r\n            a.addEventListener(\"click\", function(){\r\n               UTILS.activateSelectedNav(this, self);\r\n                if(self.ui.db()){\r\n                    //self.ui.clearDB();\r\n                }\r\n                self.ui.showCreateDBPage();\r\n            })\r\n            var icon = document.createElement('i');\r\n            icon.setAttribute('class', 'terminus-menu-icon fa fa-plus');\r\n            a.appendChild(icon);\r\n            var txt = document.createTextNode('Create New Database');\r\n            a.appendChild(txt);\r\n            ul.appendChild(a);\r\n        }\r\n\t}\r\n\treturn rsc;\r\n}\r\n\r\nTerminusServerController.prototype.getServerLabelDOM = function(){\r\n\tvar srec = this.ui.client.connection.getServerRecord();\r\n\tvar lab = (srec && srec['rdfs:label'] && srec['rdfs:label'][\"@value\"] ? srec['rdfs:label'][\"@value\"] : this.ui.server());\r\n\tvar desc = (srec && srec['rdfs:comment'] && srec['rdfs:comment'][\"@value\"] ? srec['rdfs:comment'][\"@value\"] : \"\");\r\n\tdesc += \" Server URL: \"+ this.ui.server();\r\n\tvar val = document.createElement(\"span\");\r\n\tval.setAttribute(\"class\", \"terminus-server-value\");\r\n\tval.setAttribute(\"title\", desc);\r\n\tval.appendChild(document.createTextNode(lab));\r\n    val =  document.createElement('div');\r\n\treturn val;\r\n}\r\n\r\nfunction TerminusServerViewer(ui){\r\n\tthis.ui = ui;\r\n\tthis.server = this.ui.server();\r\n\tthis.max_cell_size = 500;\r\n\tthis.max_word_size = 40;\r\n}\r\n\r\nTerminusServerViewer.prototype.getAsDOM = function(selected){\r\n\tvar self = this;\r\n\tvar pd = document.createElement(\"span\");\r\n\tpd.setAttribute(\"class\", \"terminus-server-home-page\");\r\n\tif(this.ui.server()){\r\n\t\tvar scd = document.createElement(\"span\");\r\n\t\tscd.setAttribute(\"class\", \"terminus-server-home\");\r\n\t\tif(this.ui.showView(\"server\")){\r\n\t\t\t// 11092019 scd.appendChild(this.getServerDetailsDOM());\r\n\t\t}\r\n\t\tif(this.ui.showView(\"change-server\")){\r\n\t\t\tvar csbut = document.createElement(\"button\");\r\n\t\t\tcsbut.setAttribute(\"class\", \"terminus-control-button terminus-change-server-button terminus-btn\")\r\n\t\t\tcsbut.appendChild(document.createTextNode(\"Disconnect\"));\r\n\t\t\tcsbut.addEventListener(\"click\", function(){\r\n\t\t\t\t//self.ui.clearDB();\r\n\t\t\t\t//self.ui.clearServer();\r\n\t\t\t\tself.ui.showLoadURLPage();\r\n\t\t\t})\r\n\t\t\t// 11092019 scd.appendChild(csbut);\r\n\t\t}\r\n\t\tif(this.ui.showView(\"create_database\")){\r\n\t\t\tvar crbut = document.createElement(\"button\");\r\n\t\t\tcrbut.setAttribute(\"class\", \"terminus-control-button terminus-create-db-button terminus-btn\")\r\n\t\t\tcrbut.appendChild(document.createTextNode(\"Create New Database\"));\r\n\t\t\tcrbut.addEventListener(\"click\", function(){\r\n\t\t\t\tif(self.ui.db()){\r\n\t\t\t\t\t//self.ui.clearDB();\r\n\t\t\t\t}\r\n\t\t\t\tself.ui.clearMessages();\r\n\t\t\t\tself.ui.showCreateDBPage();\r\n\t\t\t})\r\n\t\t\t// 11092019 scd.appendChild(crbut);\r\n\t\t}\r\n\t\tif(this.ui.showView(\"db\")){\r\n\t\t\tscd.appendChild(this.getDBListDOM());\r\n\t\t}\r\n\t\tpd.appendChild(scd);\r\n\t}\r\n\telse {\r\n\t\tself.ui.showLoadURLPage();\r\n\r\n\t\t//pd.appendChild(this.getLoadURLPage());\r\n\t}\r\n\treturn pd;\r\n}\r\n\r\nTerminusServerViewer.prototype.getServerDetailsDOM = function(){\r\n\tvar scd = document.createElement(\"span\");\r\n\tscd.setAttribute(\"class\", \"terminus-server-details terminus-server-banner\");\r\n\tvar scl = document.createElement(\"span\");\r\n\tscl.setAttribute(\"class\", \"terminus-label terminus-server-info\");\r\n\tscl.appendChild(document.createTextNode(\"Connected to Server - \"))\r\n\tvar scs = document.createElement(\"span\");\r\n\tscs.setAttribute(\"class\", \"terminus-value terminus-server-info\");\r\n\tscs.appendChild(document.createTextNode(this.ui.server()))\r\n\tscd.appendChild(scl);\r\n\tscd.appendChild(scs);\r\n\treturn scd;\r\n}\r\n\r\nTerminusServerViewer.prototype.wrapTableLinkCell = function(tdElement,dbid, text){\r\n\tvar self = this;\r\n\tvar wrap = document.createElement(\"p\");\r\n//\twrap.setAttribute(\"href\", \"#\");\r\n\twrap.setAttribute(\"class\", \"terminus-table-content\");\r\n\tif(text.length > this.max_cell_size){\r\n\t\twrap.setAttribute(\"title\", text);\r\n\t\ttext = text.substring(0, this.max_cell_size) + \"...\";\r\n\t}\r\n\tconst replacements = {}\r\n\tconst words = text.split(\" \");\r\n\tfor(var i = 0; i < words.length; i++){\r\n\t\tvar word = words[i];\r\n\t\tif(word.length > this.max_word_size){\r\n\t\t\twrap.setAttribute(\"title\", text);\r\n\t\t\tvar newstr = word.substring(0, this.max_word_size) + \"...\";\r\n\t\t\treplacements[word] = newstr;\r\n\t\t}\r\n\t}\r\n\tfor(var k in replacements){\r\n\t\ttext = text.replace(k, replacements[k]);\r\n\t}\r\n\twrap.appendChild(document.createTextNode(text));\r\n\ttdElement.addEventListener(\"click\", function(){\r\n\t\tself.ui.connectToDB(dbid);\r\n\t\tself.ui.showDBMainPage();\r\n\t});\r\n\treturn wrap;\r\n}\r\n\r\nTerminusServerViewer.prototype.getDBListDOM = function(){\r\n\tvar self = this;\r\n\tvar sec = document.createElement(\"div\");\r\n\tvar lihed = document.createElement(\"h3\");\r\n\tlihed.setAttribute(\"class\", \"terminus-db-list-title terminus-module-head\");\r\n\tlihed.appendChild(document.createTextNode(\"Available Databases\"));\r\n\tsec.appendChild(lihed);\r\n\tvar scd = document.createElement(\"table\");\r\n\tscd.setAttribute(\"class\", \"terminus-db-list terminus-db-size terminus-hover-table\");\r\n\tvar thead = document.createElement(\"thead\");\r\n\tvar thr = document.createElement(\"tr\");\r\n\tvar th1 = document.createElement(\"th\");\r\n\tth1.appendChild(document.createTextNode(\"ID\"));\r\n\tth1.setAttribute(\"class\", \"terminus-db-id terminus-table-header-full-css\");\r\n\tvar th2 = document.createElement(\"th\");\r\n\tth2.appendChild(document.createTextNode(\"Title\"));\r\n\tth2.setAttribute(\"class\", \"terminus-db-title terminus-table-header-full-css\");\r\n\tvar th3 = document.createElement(\"th\");\r\n\tth3.appendChild(document.createTextNode(\"Description\"));\r\n\tth3.setAttribute(\"class\", \"terminus-db-description terminus-table-header-full-css\");\r\n\tvar th4 = document.createElement(\"th\");\r\n\tth4.setAttribute(\"class\", \"terminus-db-size terminus-table-header-full-css\");\r\n\tth4.appendChild(document.createTextNode(\"Size\"));\r\n\tvar th5 = document.createElement(\"th\");\r\n\tth5.setAttribute(\"class\", \"terminus-db-created terminus-table-header-full-css\");\r\n\tth5.appendChild(document.createTextNode(\"Created\"));\r\n\tvar th6 = document.createElement(\"th\");\r\n\tth6.appendChild(document.createTextNode(\"Delete\"));\r\n\tth6.setAttribute(\"class\", \"terminus-db-delete terminus-table-header-full-css\");\r\n\tthr.appendChild(th1);\r\n\tthr.appendChild(th2);\r\n\tthr.appendChild(th3);\r\n\tthr.appendChild(th4);\r\n\tthr.appendChild(th5);\r\n\tthr.appendChild(th6);\r\n\tthead.appendChild(thr);\r\n\tscd.appendChild(thead);\r\n\tvar tbody = document.createElement(\"tbody\");\r\n\tvar dbrecs = this.ui.client.connection.getServerDBRecords();\r\n\tfor(let fullid in dbrecs){\r\n\t\tlet dbrec = dbrecs[fullid];\r\n\t\tconst dbid = fullid.split(\":\")[1];\r\n\t\tlet tr = document.createElement(\"tr\");\r\n\t\tvar td1 = document.createElement(\"td\");\r\n\t\ttd1.appendChild(this.wrapTableLinkCell(td1,dbid, dbid));\r\n\t\ttd1.setAttribute(\"class\", \"terminus-db-id terminus-db-pointer\");\r\n\t\tvar td2 = document.createElement(\"td\");\r\n\t\ttd2.setAttribute(\"class\", \"terminus-db-title terminus-db-pointer\");\r\n\t\tvar txt = (dbrec && dbrec['rdfs:label'] && dbrec['rdfs:label']['@value'] ? dbrec['rdfs:label']['@value'] : \"\");\r\n\t\ttd2.appendChild(this.wrapTableLinkCell(td2,dbid, txt));\r\n\t\tvar td3 = document.createElement(\"td\");\r\n\t\ttd3.setAttribute(\"class\", \"terminus-db-description terminus-db-pointer\");\r\n\t\tvar txt = (dbrec && dbrec['rdfs:comment'] && dbrec['rdfs:comment']['@value'] ? dbrec['rdfs:comment']['@value'] : \"\");\r\n\t\ttd3.appendChild(this.wrapTableLinkCell(td3,dbid, txt));\r\n\t\tvar td4 = document.createElement(\"td\");\r\n\t\ttd4.setAttribute(\"class\", \"terminus-db-size terminus-db-pointer\");\r\n\t\tvar txt = (dbrec && dbrec['terminus:size'] && dbrec['terminus:size']['@value'] ? dbrec['terminus:size']['@value'] : \"\");\r\n\t\ttd4.appendChild(this.wrapTableLinkCell(td4,dbid, txt));\r\n\t\tvar td5 = document.createElement(\"td\");\r\n\t\ttd5.setAttribute(\"class\", \"terminus-db-created terminus-db-pointer\");\r\n\t\tvar txt = (dbrec && dbrec['terminus:last_updated'] && dbrec['terminus:last_updated']['@value'] ? dbrec['terminus:last_updated']['@value'] : \"\");\r\n\t\ttd5.appendChild(this.wrapTableLinkCell(td5,dbid, txt));\r\n\t\tvar td6 = document.createElement(\"td\");\r\n\t\ttd6.setAttribute(\"class\", \"db-delete\");\r\n        if(this.deleteDBPermitted(dbid)){\r\n            if(this.ui.pluginAvailable(\"font-awesome\")){\r\n                var delbut = document.createElement('i');\r\n        \t\tdelbut.setAttribute(\"class\", \"terminus-db-list-del-icon fa fa-times-circle\");\r\n        \t}\r\n            else{\r\n                var delbut = document.createElement(\"button\");\r\n    \t\t\tdelbut.appendChild(document.createTextNode(\"Delete\"));\r\n    \t\t\tdelbut.setAttribute(\"class\", \"terminus-control-button terminus-delete-db-button\");\r\n            }\r\n\t\t\t// function to fix db in a closure\r\n\t\t\tvar delDB = function(db){\r\n\t\t\t\treturn function(){\r\n\t\t\t\t\tlet deleteConfirm = confirm(`Do you want to delete ${db} Database?`);\r\n\t\t\t\t\tif (deleteConfirm == true) {\r\n\t\t\t  \t\t\tself.ui.deleteDatabase(db);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t//self.ui.deleteDatabase(db);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tdelbut.addEventListener(\"click\", delDB(dbid));\r\n\t\t\ttd6.appendChild(delbut);\r\n\t\t}\r\n\r\n\t\ttr.appendChild(td1);\r\n\t\ttr.appendChild(td2);\r\n\t\ttr.appendChild(td3);\r\n\t\ttr.appendChild(td4);\r\n\t\ttr.appendChild(td5);\r\n\t\ttr.appendChild(td6);\r\n\t\ttbody.appendChild(tr);\r\n\t}\r\n\tscd.appendChild(tbody);\r\n\tsec.appendChild(scd);\r\n\r\n\tif(this.ui.pluginAvailable(\"datatables\")){\r\n        var dt = new Datatables.CspDatatables(this.ui);\r\n\t\tvar tab = dt.draw(scd);\r\n\t}\r\n\treturn sec;\r\n}\r\n\r\nTerminusServerViewer.prototype.deleteDBPermitted = function(dbid){\r\n\tif(dbid == \"terminus\") return false;\r\n\tif(this.ui.client.connection.capabilitiesPermit(\"delete_database\", dbid)) return true;\r\n\treturn false;\r\n}\r\n\r\nmodule.exports = {TerminusServerViewer,TerminusServerController}\r\n","function TerminusURLLoader(ui, val){\r\n\tthis.ui = ui;\r\n\tthis.val = val;\r\n\tthis.url_input = false;\r\n\tthis.key_input = false;\r\n}\r\n\r\nTerminusURLLoader.prototype.getLabelDOM = function(){\r\n\treturn document.createTextNode(\"Connect\");\r\n}\r\n\r\nTerminusURLLoader.prototype.getFormFieldDOM = function(ip, fname, ltxt, pholder){\r\n\tvar sci = document.createElement(\"div\");\r\n\tsci.setAttribute(\"class\", \"terminus-form-horizontal terminus-control-group terminus-form-field-spacing terminus-form-field terminus-field-\"+fname);\r\n\tvar lab = document.createElement(\"span\");\r\n\tlab.setAttribute(\"class\", \"terminus-control-label terminus-form-label terminus-form-field-label terminus-label-\"+fname);\r\n\tlab.appendChild(document.createTextNode(ltxt))\r\n\tip.setAttribute(\"type\", \"text\");\r\n\tip.setAttribute(\"placeholder\", pholder);\r\n\tsci.appendChild(lab);\r\n\tsci.appendChild(ip);\r\n\treturn sci;\r\n}\r\n\r\nTerminusURLLoader.prototype.getAsDOM = function(){\r\n\tvar scd = document.createElement(\"div\");\r\n\tscd.setAttribute(\"class\", \"terminus-form terminus-url-loader\");\r\n\tvar stit = document.createElement(\"h3\");\r\n\tstit.setAttribute(\"class\", \"terminus-form-header terminus-connect-header terminus-module-head\");\r\n\tstit.appendChild(document.createTextNode(\"Connect To Terminus Server\"));\r\n\tscd.appendChild(stit);\r\n\tvar mfd = document.createElement('div');\r\n\tmfd.setAttribute('class', 'terminus-form-border');\r\n\tscd.appendChild(mfd);\r\n\tthis.url_input = document.createElement(\"input\");\r\n\tthis.url_input.setAttribute(\"class\", \"terminus-form-value terminus-form-url terminus-form-field-input terminus-input-text\");\r\n\tif(this.val){\r\n\t\tthis.url_input.value = this.val;\r\n\t}\r\n\tmfd.appendChild(this.getFormFieldDOM(this.url_input, \"connect\", \"URL\", \"Terminus DB URL\"));\r\n\tthis.key_input = document.createElement(\"input\");\r\n\tthis.key_input.setAttribute(\"class\", \"terminus-form-value terminus-value terminus-input-text\");\r\n\tmfd.appendChild(this.getFormFieldDOM(this.key_input, \"connect\", \"Key\", \"Server API Key\"));\r\n\tvar loadbuts = document.createElement(\"div\");\r\n\tloadbuts.setAttribute(\"class\", \"terminus-control-buttons\");\r\n\tvar loadbut = document.createElement(\"button\");\r\n\tloadbut.setAttribute(\"class\", \"terminus-control-button terminus-url-load terminus-btn\");\r\n\tloadbut.appendChild(document.createTextNode(\"Connect\"));\r\n\tvar self = this;\r\n\tloadbut.addEventListener(\"click\", function(){\r\n\t\tif(self.url_input.value){\r\n\t\t\tself.ui.load(self.url_input.value, self.key_input.value);\r\n\t\t}\r\n\t});\r\n\tloadbuts.appendChild(loadbut);\r\n\tmfd.appendChild(loadbuts);\r\n\treturn scd;\r\n}\r\n\r\n\r\nmodule.exports=TerminusURLLoader\r\n"],"sourceRoot":""}
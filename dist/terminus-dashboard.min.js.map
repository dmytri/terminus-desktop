{"version":3,"sources":["webpack://TerminusDashboard/webpack/bootstrap","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/index.js","webpack://TerminusDashboard/./src/html/HTMLFrameHelper.js","webpack://TerminusDashboard/./node_modules/axios/lib/utils.js","webpack://TerminusDashboard/./src/Utils.js","webpack://TerminusDashboard/./src/plugins/TerminusPlugin.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/errorMessage.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/frameHelper.js","webpack://TerminusDashboard/./src/client/WOQLQuery.js","webpack://TerminusDashboard/./src/client/RenderingMap.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/const.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/utils.js","webpack://TerminusDashboard/./src/html/document/ObjectViewer.js","webpack://TerminusDashboard/./src/html/datatypes/String.js","webpack://TerminusDashboard/./src/html/document/PropertyViewer.js","webpack://TerminusDashboard/./src/html/document/DataViewer.js","webpack://TerminusDashboard/./src/client/TerminusClassChooser.js","webpack://TerminusDashboard/./node_modules/axios/lib/helpers/bind.js","webpack://TerminusDashboard/./node_modules/axios/lib/helpers/buildURL.js","webpack://TerminusDashboard/./node_modules/axios/lib/cancel/isCancel.js","webpack://TerminusDashboard/./node_modules/axios/lib/defaults.js","webpack://TerminusDashboard/./node_modules/axios/lib/adapters/xhr.js","webpack://TerminusDashboard/./node_modules/axios/lib/core/createError.js","webpack://TerminusDashboard/./node_modules/axios/lib/core/mergeConfig.js","webpack://TerminusDashboard/./node_modules/axios/lib/cancel/Cancel.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/connectionCapabilities.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/connectionConfig.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/terminusIDParser.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/framePattern.js","webpack://TerminusDashboard/./src/TerminusDocument.js","webpack://TerminusDashboard/./src/client/WOQLResultsViewer.js","webpack://TerminusDashboard/./src/plugins/datatables.terminus.js","webpack://TerminusDashboard/./src/html/datatypes/StringEditor.js","webpack://TerminusDashboard/./src/html/datatypes/Boolean.js","webpack://TerminusDashboard/./src/html/datatypes/BooleanEditor.js","webpack://TerminusDashboard/./src/html/datatypes/Choice.js","webpack://TerminusDashboard/./src/html/datatypes/ChoiceEditor.js","webpack://TerminusDashboard/./src/html/datatypes/Coordinate.js","webpack://TerminusDashboard/./src/html/datatypes/CoordinateEditor.js","webpack://TerminusDashboard/./src/html/datatypes/Date.js","webpack://TerminusDashboard/./src/html/datatypes/DateHelper.js","webpack://TerminusDashboard/./src/html/datatypes/DateEditor.js","webpack://TerminusDashboard/./src/html/datatypes/Entity.js","webpack://TerminusDashboard/./src/html/datatypes/EntityEditor.js","webpack://TerminusDashboard/./src/html/datatypes/Image.js","webpack://TerminusDashboard/./src/html/datatypes/ImageEditor.js","webpack://TerminusDashboard/./src/html/datatypes/Link.js","webpack://TerminusDashboard/./src/html/datatypes/Number.js","webpack://TerminusDashboard/./src/html/datatypes/Range.js","webpack://TerminusDashboard/./src/html/datatypes/RangeEditor.js","webpack://TerminusDashboard/./src/html/datatypes/SanitizedHTML.js","webpack://TerminusDashboard/./src/html/datatypes/GoogleMapEditor.js","webpack://TerminusDashboard/./src/html/datatypes/GoogleMapHelper.js","webpack://TerminusDashboard/./src/html/datatypes/GoogleMapViewer.js","webpack://TerminusDashboard/./src/html/datatypes/HTMLMarkupEditor.js","webpack://TerminusDashboard/./src/html/datatypes/S2EntityEditor.js","webpack://TerminusDashboard/./src/TerminusDB.js","webpack://TerminusDashboard/./src/TerminusHTMLViewer.js","webpack://TerminusDashboard/./src/viewer/WOQLRule.js","webpack://TerminusDashboard/./src/viewer/WOQLChooser.js","webpack://TerminusDashboard/./src/viewer/WOQLTable.js","webpack://TerminusDashboard/./src/viewer/DatatypeRenderers.js","webpack://TerminusDashboard/./src/viewer/WOQLGraph.js","webpack://TerminusDashboard/./src/viewer/WOQLStream.js","webpack://TerminusDashboard/./src/viewer/TerminusFrame.js","webpack://TerminusDashboard/./src/html/QueryPane.js","webpack://TerminusDashboard/./src/html/query/TerminusCodeSnippet.js","webpack://TerminusDashboard/./src/index.js","webpack://TerminusDashboard/./src/TerminusUI.js","webpack://TerminusDashboard/./src/ApiExplorer.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/woqlClient.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/dispatchRequest.js","webpack://TerminusDashboard/./node_modules/buffer/index.js","webpack://TerminusDashboard/(webpack)/buildin/global.js","webpack://TerminusDashboard/./node_modules/base64-js/index.js","webpack://TerminusDashboard/./node_modules/ieee754/index.js","webpack://TerminusDashboard/./node_modules/isarray/index.js","webpack://TerminusDashboard/./node_modules/axios/index.js","webpack://TerminusDashboard/./node_modules/axios/lib/axios.js","webpack://TerminusDashboard/./node_modules/is-buffer/index.js","webpack://TerminusDashboard/./node_modules/axios/lib/core/Axios.js","webpack://TerminusDashboard/./node_modules/axios/lib/core/InterceptorManager.js","webpack://TerminusDashboard/./node_modules/axios/lib/core/dispatchRequest.js","webpack://TerminusDashboard/./node_modules/axios/lib/core/transformData.js","webpack://TerminusDashboard/./node_modules/axios/lib/helpers/normalizeHeaderName.js","webpack://TerminusDashboard/./node_modules/axios/lib/core/settle.js","webpack://TerminusDashboard/./node_modules/axios/lib/core/enhanceError.js","webpack://TerminusDashboard/./node_modules/axios/lib/helpers/parseHeaders.js","webpack://TerminusDashboard/./node_modules/axios/lib/helpers/isURLSameOrigin.js","webpack://TerminusDashboard/./node_modules/axios/lib/helpers/cookies.js","webpack://TerminusDashboard/./node_modules/axios/lib/helpers/isAbsoluteURL.js","webpack://TerminusDashboard/./node_modules/axios/lib/helpers/combineURLs.js","webpack://TerminusDashboard/./node_modules/axios/lib/cancel/CancelToken.js","webpack://TerminusDashboard/./node_modules/axios/lib/helpers/spread.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/objectFrame.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/woqlResult.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/woql.js","webpack://TerminusDashboard/./src/plugins/codemirror.terminus.js","webpack://TerminusDashboard/./src/client/ObjectRenderer.js","webpack://TerminusDashboard/./src/client/ValueRenderer.js","webpack://TerminusDashboard/./src/client/TerminusDocumentChooser.js","webpack://TerminusDashboard/./src/viewer/WOQLQueryView.js","webpack://TerminusDashboard/./src/html/Datatypes.js","webpack://TerminusDashboard/./src/html/table/SimpleTable.js","webpack://TerminusDashboard/./src/html/graph/SimpleGraph.js","webpack://TerminusDashboard/./src/html/graph/GraphResultsViewer.js","webpack://TerminusDashboard/./src/html/chooser/SimpleChooser.js","webpack://TerminusDashboard/./src/html/document/SimpleDocument.js","webpack://TerminusDashboard/./src/html/document/DocumentTable.js","webpack://TerminusDashboard/./src/html/document/SimpleFrameViewer.js","webpack://TerminusDashboard/./src/html/TerminusViolation.js","webpack://TerminusDashboard/./src/TerminusQuery.js","webpack://TerminusDashboard/./src/TerminusSchema.js","webpack://TerminusDashboard/./src/TerminusServer.js","webpack://TerminusDashboard/./src/TerminusURL.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","WOQLClient","ConnectionCapabilities","ConnectionConfig","IDParser","ErrorMessage","FrameHelper","ObjectFrame","WOQLResult","WOQL","TerminusPluginManager","require","TerminusClient","HTMLFrameHelper","type","control","label","callback","disabled","dpropDOM","document","createElement","setAttribute","button","appendChild","createTextNode","addEventListener","this","innerHTML","objId","getElementsByClassName","length","style","background","view","pluginAvailable","icon","options","selected","sel","opt","labelFromURL","which","renderer","viewsDOM","setMode","getActionControl","isNew","cancel","url","window","location","href","loc","split","sh","getShorthand","bits","htmlid","prop","wrap","text","max_cell_size","max_word_size","substring","replacements","words","word","newstr","k","replace","varname","lastIndexOf","obj","help","input","infoDOM","linfo","lspacer","lval","scope","frame","orientation","hfeatures","features","display_options","hidden","framedom","getFrameHolderDOM","header","hd","header_features","getFrameHeaderDOM","getFrameBodyDOM","pcls","sp","css","parent","subjectClass","subject","hid","hash","index","idm","objDOM","vholder","charCodeAt","feature","val","getInfoboxDOM","sum","getSummary","status","lab","getLabel","getComment","isClassChoice","getClassChoiceTypeSelector","range","getType","cardControlAllows","show_disabled_buttons","clone","reset","isUpdated","hide","show","save","getViewerSelectorDOM","getViewEntryDOM","getCardinalityDOM","getAddDOM","viewers","terminus","datatypes","getAvailableViewers","getRenderer","mpropDOM","currentViewer","getSelectionControl","viewer","setViewer","viewables","getFilledPropertyList","unshift","add","goToEntry","restriction","getRestriction","min","max","cs","getAvailableClassChoices","mlabDOM","cls","changeClass","addClass","addables","getMissingPropertyList","addNewProperty","addNewValue","isBuffer","toString","isArray","isObject","isFunction","forEach","fn","isArrayBuffer","isFormData","FormData","isArrayBufferView","ArrayBuffer","isView","buffer","isString","isNumber","isUndefined","isDate","isFile","isBlob","isStream","pipe","isURLSearchParams","URLSearchParams","isStandardBrowserEnv","navigator","product","merge","result","assignValue","arguments","deepMerge","extend","a","b","thisArg","trim","str","Codemirror","readFile","file","XMLHttpRequest","xmlhttp","ActiveXObject","open","send","xmlDoc","responseText","getFunctionSignature","sigs","spec","descr","args","server_url","title","description","database_url","details","format","editmode","document_url","fail_on_id_denied","woql","class","term","source","target","getHeaderDom","h","getInfoAlertDom","msg","ald","txt","getResponse","currForm","action","response","terminator","rd","br","data","JSON","stringify","pre","stylizeCodeDisplay","showHttpResult","retHttpHeaders","headers","hdres","json","then","deleteStylizedEditor","ui","qip","cm","nextElementSibling","removeChildren","stylizeEditor","cmConfig","ar","colorizeTextArea","updateTextArea","dom","pr","colorizePre","removeSelectedNavClass","el","classList","remove","setSelectedSubMenu","tolggleContent","content","display","activateSelectedNav","nav","hideDocumentSubMenus","contains","checkDocumentSubMenus","showControl","toggleVisibility","extractValueFromCell","cellValue","DOMParser","parseFromString","firstChild","displayDocumentSubMenus","showSubMenus","checkForMandatoryId","getCurrentWoqlQueryObject","query","settings","qval","limit","pageLength","start","elementMetadata","classMetadata","getEverything","getAllDocuments","documentMetadata","and","quad","sub","propertyMetadata","console","log","trimValue","getqObjFromInput","q","qObj","eval","e","preloaded","loaded","loading","precluded","plugins","js","requires","setPluginOptions","opts","init","calculatePreloaded","toload","calculateRequiredInitPlugins","self","loadPlugins","pins","pid","indexOf","push","getDefaultPlugins","needed_pins","loading_order","getAvailablePlugins","pl","plugin","version_check","pluginmeta","version","jQuery","slider","Quill","JSONEditor","CodeMirror","fontAwesomeCheck","dataTable","select2","google","maps","ol","Map","d3","Error","element","span","className","body","insertBefore","getComputedStyle","getPropertyValue","removeChild","ticker","cback","loadPlugin","pug","cssid","loadDynamicCSS","scripts","sid","splice","loadDynamicScript","loadPluginScripts","loadPageCSS","cssfid","cssdom","getElementById","parentNode","cssurl","pluginLoadable","pluginLoadedOrLoading","getPluginDOM","plugid","cl","cbox","id","checked","clab","togglePlugin","redraw","unloadPlugin","drawPlugins","num","getAsDOM","dm","clh","showPlugins","getErrorAsMessage","api","err","formatErrorMessage","method","nmsg","keys","getAPIErrorMessage","getAccessDeniedMessage","accessDenied","db","server","getInvalidURIMessage","parseAPIError","error","redirected","standard_urls","rdf","rdfs","xsd","owl","tcs","tbs","xdd","v","vio","docs","prefix","node","hasChildNodes","childNodes","Math","random","Date","getTime","link","pref","full","ida","idb","unshorten","sha","shb","prefixes","validURL","nurl","urlFragment","charAt","toUpperCase","slice","urlStr","baseUrl","stype","urlFirst","urlTmp","ext","viewIncludesProperties","parts","join","ty","parsed","parseXsdDate","parseXsdTime","parseXsdDateTime","year","month","day","tz","extractXsdTimezone","abs","parseInt","timezone","nparsed","hour","minute","second","xparsed","addXsdPadding","ret","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","convertTimestampToXsd","datetime","ptime","dividor","vals","scriptid","src","existingScript","script","onload","rel","WOQLQuery","client","default_limit","connectionConfig","platformEndpoint","colid","dbid","serverURL","schemaURL","dbURL","docURL","setPrefixes","shorten","execute","wrapped","select","getConcreteDocumentClassPattern","varc","getSubclassQueryPattern","not","getAbstractQueryPattern","clsname","queryWrappedWithLimit","getAllDocumentQuery","constraint","triple","getEverythingQuery","wjson","getPropertyListQuery","getElementMetaDataQuery","getClassListMetaDataQuery","getClassMetaDataQuery","getDataOfChosenClassQuery","chosen","getDataOfChosenPropertyQuery","getInstanceMeta","getDocumentQuery","getClassesQuery","ObjectViewer","HTMLStringViewer","HTMLStringEditor","HTMLBooleanViewer","HTMLBooleanEditor","HTMLChoiceViewer","HTMLChoiceEditor","HTMLCoordinateViewer","HTMLCoordinateEditor","HTMLDateViewer","HTMLDateEditor","HTMLEntityViewer","HTMLEntityEditor","HTMLImageViewer","HTMLImageEditor","HTMLLinkViewer","HTMLNumberViewer","HTMLRangeViewer","HTMLRangeEditor","SantizedHTMLViewer","GoogleMapEditor","GoogleMapViewer","HTMLMarkupEditor","S2EntityEditor","RenderingMap","registeredDataViewers","registeredDataEditors","getValidDataViewerList","frametype","valids","concat","getValidDataEditorList","nftypes","getViewer","datatype","vi","renderers","alert","getAvailableDataViewers","nviewers","sets","getAvailableDataEditors","getViewerForDataFrame","getEditorForDataFrame","registerViewerForTypes","types","registerEditorForTypes","registerEditorForFrameType","registerViewerForFrameType","compiled_options","compileOptions","facets","getDefaultFacets","facet","deffacet","getDefaultFacet","hide_disabled_buttons","controls","viewerType","viewerOptions","header_viewer","HTMLObjectHeaderViewer","filter","sort","rules","pattern","patternMatchesRenderer","output","freeze","CONNECT","GET_SCHEMA","UPDATE_SCHEMA","UPDATE_DOCUMENT","CLASS_FRAME","WOQL_SELECT","GET_DOCUMENT","DELETE_DATABASE","DELETE_DOCUMENT","CREATE_DATABASE","CREATE_DOCUMENT","WOQL_UPDATE","authorityActionsToArr","Array","map","item","URIEncodePayload","payload","encodeURIComponent","payloadArr","keyElement","valueElement","HTMLObjectViewer","properties","render","headerViewer","renderedDOM","getObjectBodyDOM","getObjectDOM","getContentOrientation","getFeatureDOM","hasFeatureViewer","featureViewer","redrawHeader","nheader","replaceWith","redrawBody","nbody","addRenderedProperty","renderedprop","clear","goTo","subj","goToName","getObjectIDMarker","sumDOM","controlsDOM","showFeature","facetDOM","getObjectFacetDOM","getObjectLabelDOM","idDOM","getObjectIDDOM","typeDOM","getObjectTypeDOM","getObjectStatusDOM","viewDOM","getViewPropertyDOM","hideDOM","getObjectControlsDOM","getObjectSummaryDOM","addDOM","getAddPropertyDOM","getModeSelectorDOM","getObjectDeleteDOM","cpropDOM","getObjectCloneDOM","rpropDOM","getObjectResetDOM","upropDOM","getObjectUpdateDOM","showDOM","getObjectShowDOM","getObjectHideDOM","getAvailableFacets","currentFacet","setFacet","isNewDocument","required","getClassMeta","cmt","getVariableValueFromBinding","getAddableProperties","getViewableProperties","goToProperty","size","renderFrame","dataviewer","renderValue","wrapShortenedText","HTMLPropertyViewer","values","HTMLPropertyHeaderViewer","propDOM","npropDOM","getPropertyDOM","getPropertyIDMarker","getPropertyBodyDOM","addRenderedValue","renderedval","wrapper","expModeMenu","getPropertyControlsDOM","getPropertyLabelDOM","statDOM","getPropertyStatusDOM","prepend","getPropertySummaryDOM","prelude","getPropertyFacetDOM","getViewValueDOM","getPropertyIDDOM","getPropertyRangeDOM","hasCardinalityRestriction","getPropertyCardinalityDOM","getPropertyCommentDOM","getActionControlDOM","settingsDOM","getPropertyDeleteDOM","getAddValueDOM","getPropertyResetDOM","getPropertyUpdateDOM","getPropertyShowDOM","getPropertyHideDOM","getSettingsControlDOM","getViewableValues","goToValue","showValue","HTMLDataViewer","HTMLDataHeaderViewer","valDOM","nvalDOM","getValueDOM","getValueIDMarker","getValueBodyDOM","vdom","getDataValueViewer","getDOM","getSummaryDOM","HTMLTerminusClient","fireInternalLink","preventDefault","load","internalLink","onclick","onClick","getValueFacetDOM","getValueTypeDOM","getValueStatusDOM","getValueControlsDOM","getValueDeleteDOM","getValueCloneDOM","getValueResetDOM","getValueUpdateDOM","getValueShowDOM","getValueHideDOM","TerminusClassChooser","choice","show_single","setRoot","root","setFilter","change","ccdom","ccsel","wq","getResultsAsOptions","clist","choices","bindings","empty_choice","opt1","added","bclass","apply","utils","encode","params","paramsSerializer","serializedParams","toISOString","hashmarkIndex","__CANCEL__","normalizeHeaderName","DEFAULT_CONTENT_TYPE","setContentTypeIfUnset","adapter","defaults","process","transformRequest","transformResponse","parse","timeout","xsrfCookieName","xsrfHeaderName","maxContentLength","validateStatus","common","settle","buildURL","parseHeaders","isURLSameOrigin","createError","config","Promise","resolve","reject","requestData","requestHeaders","request","auth","username","password","Authorization","btoa","onreadystatechange","readyState","responseURL","responseHeaders","getAllResponseHeaders","responseType","statusText","onabort","onerror","ontimeout","cookies","xsrfValue","withCredentials","read","undefined","toLowerCase","setRequestHeader","onDownloadProgress","onUploadProgress","upload","cancelToken","promise","abort","enhanceError","message","code","config1","config2","Cancel","UTILS","CONST","connection","setClientKey","getClientKey","curl","addConnection","capabilities","capabilitiesKeys","pred","auths","actions","actionsArr","j","nrec","serverConnected","capabilitiesPermit","connectionMode","client_checks_capabilities","rec","getServerRecord","getDBRecord","srvr","connectionObj","okeys","oid","dbCapabilityID","getServerDBRecords","dbrecs","removeDB","dbidCap","newParams","docid","setServer","setDB","doc","setDocument","connected_mode","include_key","includeKey","queryURL","frameURL","baseURL","inputStr","context","parser","parseServerURL","parseDBID","setSchemaURL","parseSchemaURL","parseDocumentURL","setQueryURL","parseQueryURL","setClassFrameURL","parseClassFrameURL","setContext","validPrefixedURL","expandPrefixed","validIDString","stripOptionalPath","bit","FramePatternMatcher","FrameRule","rule","testRules","onmatch","matched_rules","patternMatchesFrame","FramePattern","checkFrame","setPattern","frame_type","children","depth","rtype","getRendererType","illegalRuleType","checkFrameType","checkLabel","checkSubject","checkSubjectClass","checkProperty","checkDepth","checkRange","checkValue","checkParent","checkChildren","checkIndex","checkStatus","rsubj","IDsMatch","found","numberMatch","propertyIDsMatch","valuesMatch","rangeIDsMatch","rcls","classIDsMatch","ftype","stringMatch","compareIDs","vala","valb","RegExp","test","isProperty","isData","renderer_type","constructor","prettyPrint","frameType","kids","compare","collapse","showDisabledButtons","headerFeatures","showEmpty","show_empty","featureRenderers","f","feature_renderers","rend","func","Renderers","TerminusDBViewer","TerminusDocumentViewer","page_config","editor","load_schema","config_options","getBuiltInViewerOptions","dbViewer","classmeta","instancemeta","wresult","hasBindings","refreshPage","getJsonLdViewer","getDocument","clearBusy","pagedom","res","document_json_response","ohv","getDocumentJsonldCreateButton","json_editor","getEncodingChooserDOM","scd","nbuts","enc","oframe","ojson","viewMode","ccDOM","getDocumentChooserDOM","holder","dcip","nbut","showDocument","mcls","d2ch","TerminusDocumentChooser","sdom","nlab","click","getDocumentCreatorSelect","termcc","new_class","showCreateDocument","getDocumentCreatorDOM","cr","showBusy","createDocument","getListOfDocuments","showError","getDocumentJsonldSaveButton","sv","updateDocument","toggleControlActions","lod","getClassesDOM","getDocumentEditControls","dpc","getDocumentSubMenus","ul","active","controldom","loadDocumentHome","sd","elid","loadCreateDocument","loadDocumentSchema","setLabel","loadDocument","loadDataFrames","ncls","getClassFrame","loadSchemaFrames","deleteDocument","URL","extr","showViolations","durl","subjid","dataframes","domain","classframes","loadClassFrames","newDoc","fillFromSchema","getOptionsFromPageConfig","ObjectRenderer","controller","FrameConfig","pageconf","getClient","extract","labdom","dfs","getDataFrames","getStdURL","rends","getDocumentPageControls","Datatables","WOQLResultsViewer","woqlResult","queryPage","qPage","pman","count","showTable","show_table","orderColumns","sample","ordered","resultDOM","displayResultHeader","rs","rh","getTableDOM","nor","dtResult","getTable","tab","draw","getDtTableDOMOnChange","pageInfo","formatResultsForDatatableDisplay","columns","colDataData","formattedResult","ordered_headings","innerText","outerHTML","recordsTotal","recordsFiltered","getTableBody","tbody","tr","td","getDocumentLocalLink","selectDocumentNavBar","dtPlugin","thead","thr","th","CspDatatables","wResViewer","wrViewer","wQuery","currDTSettings","convertToDatatable","dt","table","DataTable","searching","lengthMenu","paging","initComplete","oInstance","$","each","html","columnDefs","targets","createdRow","row","find","attr","on","cell","column","showDBMainPage","dbInfo","parents","dbId","deleteDatabase","executeQuery","generateNewQueryOnPageChange","qTextDom","queryMode","getCallbackSettings","dtAPIChangeSettings","_iDisplayLength","_iDisplayStart","iDraw","chosenValue","setUp","dtdom","updateCurrDTSettings","getNewDataOnChange","drawnTab","aSettings","getDataFromServer","serverSide","processing","autoWidth","ajax","entries","buttons","scrollX","big","isBigType","getTypeSize","set","vallab","elements","elt","foptions","getChoiceOptions","inputs","parseValue","lldom","getInputDOMs","lat","long","latdom","longdom","getLatLongDOM","firstcol","delbut","updateValueFromForm","op","lldoms","butspan","addbut","ipdoms","DateHelper","allowbce","date_spacer","time_spacer","datetime_separator","helper","HTMLDateHelper","parseDate","datepart","getDateComponentDOM","timepart","getTimeComponentDOM","hdom","mdom","mlab","slab","dadom","ydom","getMonthName","ddom","months","part","xsdFromParsed","tdom","opdom","getEntityViewHTML","getController","getEntityLabel","dv","nspan","il","tit","ic","img","commas","numberWithCommas","delimiter","parseRangeValue","rvals","svals","x","useCommas","tnode","getRangeSymbolDOM","x2","t2node","data1","data2","firstip","secondip","showing_range","but","changeHandler","GoogleMapHelper","mapcontainer","ghelper","initMap","event","addListener","position","latLng","coo","lng","clearMarkers","marker","Marker","markers","path","polyline","getPath","addMarker","getLength","polygon","width","height","mapLat","mapLong","zoom","stroke","color","opacity","weight","fill","line","destroy","translatePolygonToArray","vertices","seenValue","xy","getAt","translateArrayToPolygon","array","jsonified","latlong","createPolygon","coords","Polygon","paths","strokeColor","strokeOpacity","strokeWeight","fillColor","fillOpacity","setMap","createPolyline","Polyline","getCoordsFromMarkers","mapContainer","center","parseFloat","setPath","trigger","inner","quill","theme","ctl","TerminusHTMLViewer","TerminusDBController","wquery","TerminusDBCreator","dbc","dbrec","nm","getControlHTML","showQueryPage","showMappingPage","showSchemaPage","showDocumentPage","tcdom","gb","bi","tds","bt","tts","nlabs","pd","sth","banner","dhp","scs","getDeleteOnHomePage","getDbInfoBox","info","del","dbdel","confirm","getDBSummary","getDocumentTableConfig","nq","rowClick","annotateValue","ID","binding","Class","Description","from","results","nd","show_all","d1","sct","mfd","sci","idip","titip","descip","schem","kip","datip","butfield","cancbut","loadbut","schema","gatherips","createDatabase","showServerMainPage","WOQLRule","WOQLTable","WOQLChooser","WOQLGraph","WOQLStream","TerminusFrame","Datatypes","QueryPane","SimpleTable","SimpleGraph","SimpleChooser","SimpleDocument","DocumentTable","SimpleFrameViewer","TerminusCodeSnippet","setRenderers","getEditor","placeholder","snippet","dimensions","snippetText","showConfigEditor","cSnippet","actionButton","cObj","showResult","submitConfig","cdom","showConfig","cbtn","first","graph","chooser","initialiseDataRenderers","setResult","displayResults","loadResults","last_result","wqt","setDatatypes","setRenderer","stream","WOQLQueryViewer","setQuery","ruleEditor","getAddRuleButton","cont","rbtn","getConfigButton","querypane","qp","queryPane","wqv","queryViewer","WOQLChoice","tdv","owner","loadRenderer","rendname","termframe","evalstr","nr","WOQLStreamConfig","WOQLChooserConfig","WOQLTableConfig","show_pager","show_pagesize","change_pagesize","show_pagenumber","addNamespacesToVariables","vars","nvars","nvar","removeNamespaceFromVariable","mvar","getMatchingRules","matches","match","WOQLGraphConfig","tf","trenderer","json_rules","jr","get_schema","all","show_parts","fp","setFrameDisplayOptions","labels","titles","direction","onChange","value_variable","label_variable","title_variable","sort_variable","sort_direction","dtypes","column_order","pagesize","pager","page","order","editable","cols","setVariables","literals","fontfamily","show_force","fix_nodes","explode_out","selected_grows","edges","nedges","estrs","show_literals","source_variable","fontfam","force","fixed","explode","bigsel","gwidth","gheight","show_edges","edge","variables","literal","removeNamespacesFromVariables","charge","distance","symmetric","collisionRadius","arrow","border","hover","constraints","w","hdr","onHover","list","current_variable","tester","vundertest","ch","cursor","getVariableList","next","includeRow","rowToChoice","rownum","getRowID","getLabelFromBinding","getTitleFromBinding","getSelectedFromBinding","rval","getSpecialRenderer","renderSpecial","prev","DatatypeRenderers","DataValue","datavalue","canAdvancePage","getLimit","canChangePage","canRetreatPage","getPage","getPageSize","setPage","setPageSize","update","nextPage","previousPage","getColumnsToRender","hasColumnOrder","getColumnOrder","hasSelect","getSelectVariables","col","getColumnHeaderContents","hr","nquery","nresult","hasDefinedEvent","getDefinedEvent","getRowClick","getCellClick","getRowHover","getCellHover","hasCellClick","hasRowClick","hasCellHover","hasRowHover","getSpecificRender","getRendererForDatatype","createRenderer","nvalue","defaultViewers","defaultEditors","universalViewer","universalEditor","specials","record","nodes","node_ids","calculateVariableTypes","getEdges","getBindings","rowIncludesEdge","makeEdgesFromRow","getNodes","source_variables","makeNodeFromSource","target_variables","makeNodeFromTarget","adornNode","adornEdge","makeEdgeFromRow","eid","extractFromBinding","lits","includeNode","includeLiteralNode","nid","genBNID","getLiteralOwner","addAdornedNode","addAdornedEdge","createEdgesFromIDs","ndid","ks","kt","nodetype","rad","radius","es","page_size","wqrs","applyRulesToDocument","views","container","ResultViewer","addView","form","getViewDOM","nview","submit","submitQuery","clearMessages","processResults","thv","qSnippet","generateResultsFromRules","getAddViewControl","vd","showRuleEditor","getWOQLEditor","addResultViewer","result_viewers","addLibrary","lib","libraries","qps","query_viewers","qv","rv","ruleviewer","setRuleViewer","language","formats","view_types","refreshContents","serialise","parseText","nw","getInputElement","readInput","scont","snpc","getFormatButtons","getViewTypeButtons","serial","actbtn","getSubmitButton","bsp","btn","TerminusUI","ApiExplorer","TerminusDBsdk","TerminusViolations","TerminusQueryViewer","TerminusSchemaViewer","TerminusServersdk","TerminusURLLoader","setOptions","connect","connectToDB","showView","explorer","showExplorer","dbdets","getBadArguments","myserver","dbdoc","generateNewDatabaseDocument","getSchema","updateSchema","refreshDBList","crec","getCrashString","showMessage","delrec","lid","dbn","dets","fname","getConnectionEndpoint","clearServer","clearDB","TerminusServerViewer","redrawMainPage","showLoadURLPage","showCreateDBPage","getDocViewerOptions","getDocCreatorOptions","mainDOM","messages","clearMainPage","main","setMessageDOM","setbuttonControls","setControllerDOM","setExplorerDOM","setPluginsDOM","setViewerDOM","comps","slocation","toggleControl","drawControls","toggleDashboardWidget","widget","drawExplorer","loadControls","ncontrol","exp","ae","sc","TerminusServerController","show_controls","pseudoCapability","show_views","busy","getBusyLoader","bsyDom","pbc","pbsa","pbia","md","msgHolder","vios","nvios","cmsg","document_options","schema_options","piman","addPlugin","getClassFrameOptions","viewdoc_options","apiNavConfig","mainNav","navText","defaultSelected","database","subNav","getClassFrames","viewDocument","use_fetch","return_full_response","aec","getApiNav","getApiExplorerDom","setSelectedNavMenu","navOnSelect","createNavs","navConfig","navDom","apiCont","getConnectExplorer","getDatabaseExplorer","getSchemaApi","getDocumentApi","getQueryApi","changeSubApiDom","curSubMenu","getDatabaseDom","getShowApiDom","getQueryApiDom","subNavOnSelect","subMenuConfig","createSubNavs","getSignature","getForm","getServerForm","fd","inpLabel","cd","inpId","keyLabel","resd","curApi","urlPlaceholder","formDoc","urlLabel","inpUrl","docUrlLabel","inpDocUrl","inpKey","docLabel","inpDoc","inp","docUrl","getApiSendButton","getApiForm","schurl","buttonSelf","gtxtar","txtar","dcurl","schemaUrlDom","htmlEditor","getValue","sg","sig","DispatchRequest","URIError","dispatch","dburl","makeDocumentConsistentWithURL","addOptionsToDocument","docurl","qurl","addOptionsToWOQL","cfurl","pdoc","_","addKeyToPayload","dispatchFetch","redirect","referrer","hdrs","credentials","cache","Headers","fetch","ok","btoaImplementation","Buffer","axios","delete","catch","post","base64","ieee754","kMaxLength","TYPED_ARRAY_SUPPORT","createBuffer","that","RangeError","Uint8Array","__proto__","arg","encodingOrOffset","allocUnsafe","TypeError","byteOffset","byteLength","fromArrayLike","fromArrayBuffer","string","encoding","isEncoding","actual","write","fromString","len","copy","fromObject","assertSize","loweredCase","utf8ToBytes","base64ToBytes","slowToString","end","hexSlice","utf8Slice","asciiSlice","latin1Slice","base64Slice","utf16leSlice","swap","bidirectionalIndexOf","dir","isNaN","arrayIndexOf","arr","indexSize","arrLength","valLength","String","buf","readUInt16BE","foundIndex","hexWrite","offset","Number","remaining","strLen","substr","utf8Write","blitBuffer","asciiWrite","byteArray","asciiToBytes","latin1Write","base64Write","ucs2Write","units","hi","lo","utf16leToBytes","fromByteArray","secondByte","thirdByte","fourthByte","tempCodePoint","firstByte","codePoint","bytesPerSequence","codePoints","MAX_ARGUMENTS_LENGTH","fromCharCode","decodeCodePointsArray","SlowBuffer","alloc","INSPECT_MAX_BYTES","global","foo","subarray","typedArraySupport","poolSize","_augment","species","configurable","allocUnsafeSlow","_isBuffer","y","pos","swap16","swap32","swap64","equals","inspect","thisStart","thisEnd","thisCopy","targetCopy","includes","isFinite","toJSON","_arr","out","toHex","bytes","checkOffset","checkInt","objectWriteUInt16","littleEndian","objectWriteUInt32","checkIEEE754","writeFloat","noAssert","writeDouble","newBuf","sliceLen","readUIntLE","mul","readUIntBE","readUInt8","readUInt16LE","readUInt32LE","readUInt32BE","readIntLE","pow","readIntBE","readInt8","readInt16LE","readInt16BE","readInt32LE","readInt32BE","readFloatLE","readFloatBE","readDoubleLE","readDoubleBE","writeUIntLE","writeUIntBE","writeUInt8","floor","writeUInt16LE","writeUInt16BE","writeUInt32LE","writeUInt32BE","writeIntLE","writeIntBE","writeInt8","writeInt16LE","writeInt16BE","writeInt32LE","writeInt32BE","writeFloatLE","writeFloatBE","writeDoubleLE","writeDoubleBE","targetStart","INVALID_BASE64_RE","Infinity","leadSurrogate","toByteArray","stringtrim","base64clean","dst","g","Function","b64","lens","getLens","validLen","placeHoldersLen","tmp","Arr","_byteLength","curByte","revLookup","uint8","extraBytes","len2","encodeChunk","lookup","isLE","mLen","nBytes","eLen","eMax","eBias","nBits","NaN","rt","LN2","Axios","mergeConfig","createInstance","defaultConfig","instance","instanceConfig","CancelToken","isCancel","promises","spread","default","InterceptorManager","dispatchRequest","interceptors","chain","interceptor","fulfilled","rejected","shift","getUri","handlers","use","eject","transformData","isAbsoluteURL","combineURLs","throwIfCancellationRequested","throwIfRequested","reason","fns","normalizedName","isAxiosError","number","fileName","lineNumber","columnNumber","stack","ignoreDuplicateOf","originURL","msie","userAgent","urlParsingNode","resolveURL","protocol","host","search","hostname","port","pathname","requestURL","expires","secure","cookie","toGMTString","decodeURIComponent","now","relativeURL","executor","resolvePromise","token","parentframe","empty","originalFrames","PropertyFrame","cframe","predicate","DataFrame","ClassFrame","Restriction","loadRestriction","jsonld_context","cf","isValid","hasSchema","frames","domainValue","getPropertyClassFrame","getChosenClassFrame","isLogic","getChosenFrame","addFrame","getAsFrame","ff","getAsFrames","isnew","restrictions","props","cascading","ignore_failure","getProperties","filled","missing","nmissing","newb","newid","pf","cloned","getChild","childid","pframe","getProperty","addProperty","createEmpty","createEmptyChoice","clss","getClassChoices","df","addPropertyValue","addValue","removeProperty","removePropertyValue","removeValue","parentObject","renderProperties","sortProperties","nprops","unsorted","standardCompare","hasRestriction","rest","currentnum","propcount","kid","extracts","updated","childUpdated","deletePropertyValue","gets","renderValues","sortedVals","sortValues","rangeValue","comment","originalValue","nrend","setNew","isValidType","hasCardRestriction","isObjectProperty","isDatatypeProperty","isRestriction","isDocument","isChoice","option","lang","getTypeShorthand","contents","normalizer","loadFromObjectFrame","par","child","getChosenClassFrames","objframe","nc","operands","dataframe","cloneDataFrame","other","domcls","operand","cardinality","maxCardinality","minCardinality","nrest","no_compress","compress","getContext","nprop","nval","last","curor","compareValues","asc_or_desc","Pattern","chain_ended","contains_update","paging_transitive_properties","WOQLSchema","triples","when","Query","Update","or","queries","eq","isa","JSON_or_IRI","delete_triple","S","P","O","add_triple","delete_quad","G","add_quad","arith","plus","minus","times","divide","as","vari","remote","unique","isLiteralType","advanceCursor","isPaged","getPagingProperty","pageprop","setPagingProperty","addStart","nspaces","spaces","indent","show_context","embed","clauses","nxt","nvals","setLimit","psize","hasStart","getStart","pagenum","pstart","setStart","firstPage","npage","lastUpdate","Context","defaultContext","DB_IRI","def","scm","Subject","Predicate","Object_or_Literal","Graph","abstract","GraphIRI","getDataOfClass","getDataOfProperty","documentProperties","simpleGraphQuery","subs","getO","addPO","entity","relationship","card","os","od","textdom","darkMode","jsonldCheck","fromTextArea","firstLineNumber","lineNumbers","styleActiveLine","lineWrapping","smartIndent","indentWithTabs","newlineAndIndent","autoCloseBrackets","matchBrackets","afterCursor","extraKeys","refresh","isEmpty","setSize","setCodemirrorSize","defaultCharWidth","setOption","setTimeout","runMode","ValueRenderer","PropertyViewer","PropertyRenderer","originalValues","changed","originalProperties","newProperties","TerminusDashboard","decorateRenderer","getOptionsForChild","getOptionsForValue","getOptionsForObject","buildValueRenderers","getViewerForProperty","adorig","getDataFramesToRender","vr","getChildrenToRender","kidf","viewIncludesChildren","allkids","getChildren","clsmeta","deleteProperty","addPropertyClass","new_property","hideDisabledControls","hide_disabled_controls","nocascade","parentFacetChange","multiline","summary","containsPage","setView","getAvailablePropertyViewers","getAvailablePropertyEditors","nukeViewer","ptype","getPropertyHeaderViewer","valcount","vsum","getFeaturesForFacet","getOptionsForProperty","buildPropertyRenderers","getViewerForObject","getPropertiesToRender","renders","nkid","parentobj","newrend","demandid","inputID","dval","new_object","isPartOfNewDocument","pfacet","vrend","getObjectHeaderViewer","JSONObjectViewer","nviewer","standardSort","patterns","sorted","rdft","rdfc","extractLDO","extractJSONLD","extracted","nf","nvr","inline","getAPIURL","DBURL","getEntityReference","entities","badData","bd","new_value","text_summary_length","getViewerForValue","objlit","getValueHeaderViewer","getViewerForDataValue","ft","show_button","getS2DOM","getIDDOM","docchooser","cfilter","s2config","dataType","contentType","delay","keyCode","dbut","toggleView","getChangeViewText","WOQLQueryView","addPlugins","createDataRenderer","woqltable","ctls","getControlsDOM","ctrls","getPaging","getTableHeader","getColumnHeader","getHTMLRow","getCell","rc","getCellData","pdom","pn","getFirst","getPrev","getPageNumber","getNext","chunk","clabel","pval","GraphResultsViewer","wgraph","getGraphDOM","gviz","gdom","setData","initDOM","svg","visid","chars","randomString","currentDate","link_elements","node_elements","loadedNodes","focusNodes","links","selected_id","setConfigOptions","initD3","d3DOM","loadNewData","updateGraph","updateSimulation","dqr","updateData","setFocusNodeFromResult","reload","getFocusNode","simulation","stop","wake","hibernate","no_animate","nnodes","getNodesAndFringes","snode","nnode","fx","fy","getLinks","scale_factor","setWidth","setHeight","clientWidth","clientHeight","jqid","append","forceSimulation","forceLink","getLinkDistance","forceManyBody","strength","getCharge","forceCollide","getCollisionRadius","forceCenter","drag_drop","drag","restart","zoomed","link_group","classed","node_group","current_transform","transform","follow_node_wrapper","graph_node","nodeSelected","selectAll","exit","node_enter","enter","getRadius","isFringe","getNodeIconUnicode","styleNodeElements","link_enter","styleLinkElements","alpha","getNodeColour","getNodeText","getNodeIconWeight","getNodeIconSize","getNodeIconColour","getLineWidth","getEdgeArrow","getEdgeColour","getLinkText","getEdgeDirection","reference","getArrowWidth","getArrowHeight","selected_node","selection_grows","getScaleTransform","scale","min_ratio","new_mol_width","new_mol_height","y_trans","x_trans","transition","duration","scaleToFit","min_x","min_y","max_x","max_y","mol_width","mol_height","width_ratio","height_ratio","recentre","translated","dcx","dcy","text_elements","unicode","faclass","getMultiplier","mult","colrad","linkDistance","getNodeIcon","isNeighbourLink","upgraded","getEmptyOption","createOptionFromChoice","renderProperty","td2","getScope","getDatatypeViewer","getFeaturesDOM","orient","ndom","getFrameDOM","flist","featuresToCSS","TerminusViolation","context_msg","vioHeading","getPropertyAsDOM","ldom","panes","meta","newPaneButton","qpane","confirm_before_update","loadSchema","msgtype","resetControlDOM","getSchemaSaveButtons","getSchemaImportActionButtons","getShowSchemaButton","getClassFrameChooser","getSchemaEditButton","getImportButton","getFormatChoices","fc","tc","tj","refreshMainPage","getSchemaViewDOM","getSchemaEditDOM","getSchemaImportDOM","getClassFrameDOM","ssb","getCancelButton","getSaveButton","getImportSaveButton","getSchemaButton","getImportPreviewButton","is_import","doImport","schema_edit_dom","origurl","newschema","appendSchema","showConfirmPage","s2","nschema","np","docviewer","ipval","klab","modes","overwrite","rsc","getServerLabelDOM","srec","desc","csbut","crbut","getDBListDOM","getServerDetailsDOM","scl","wrapTableLinkCell","tdElement","getNDBListDOM","sec","lihed","th1","th2","th3","th4","th5","th6","fullid","td1","td3","td4","td5","td6","deleteDBPermitted","delDB","url_input","key_input","getLabelDOM","getFormFieldDOM","ip","ltxt","pholder","stit","loadbuts"],"mappings":"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","file":"terminus-dashboard.min.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 66);\n","'use strict';\r\nmodule.exports = {\r\n\t\t\t\t WOQLClient:require('./lib/woqlClient'),\r\n                  ConnectionCapabilities:require('./lib/connectionCapabilities'),\r\n                  ConnectionConfig:require('./lib/connectionConfig'),\r\n                  IDParser:require('./lib/terminusIDParser'),\r\n                  ErrorMessage:require('./lib/errorMessage'),\r\n                  FrameHelper:require('./lib/frameHelper'),\r\n                  ObjectFrame:require('./lib/objectFrame'),\r\n                  WOQLResult:require('./lib/woqlResult'),\r\n                  WOQL:require('./lib/woql')};","const TerminusPluginManager = require('../plugins/TerminusPlugin');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\nlet HTMLFrameHelper = {};\r\n\r\nHTMLFrameHelper.getActionControl = function(type, control, label, callback, disabled){\r\n\tvar pman = new TerminusPluginManager();\r\n\tvar dpropDOM = document.createElement(\"span\");\r\n\tdpropDOM.setAttribute(\"class\", \"terminus-action-control terminus-save-btn \" + type + \"-\" + control);\r\n\tvar pman = new TerminusPluginManager();\r\n    /*if(pman.pluginAvailable(\"font-awesome\")){\r\n\t\tvar icon = document.createElement('icon');\r\n\t\tvar faic = this.getControlIcon(control);\r\n\t\tif(disabled){\r\n\t\t\ticon.setAttribute(\"class\", \"terminus-frame-control frame-control-action action-disabled fa fa\" + faic + \" \" + type + \"-\" + control + \"-disabled terminus-font-align\");\r\n\t\t\ticon.setAttribute(\"title\", disabled);\r\n\t\t}\r\n\t\telse {\r\n\t\t\ticon.setAttribute(\"class\", \"terminus-frame-control frame-control-action frame-control-action fa fa\" + faic + \" \" + type + \"-\" + control + \" terminus-font-align\");\r\n\t\t\ticon.addEventListener(\"click\", function(){\r\n\t\t\t\tcallback(control);\r\n\t\t\t});\r\n\t\t}\r\n\t\tdpropDOM.appendChild(icon);\r\n\t}\r\n\telse{*/\r\n\t\tvar button = document.createElement(\"button\");\r\n\t\tbutton.appendChild(document.createTextNode(label));\r\n\t\tif(disabled){\r\n\t\t\tbutton.setAttribute(\"class\", \"terminus-frame-control terminus-frame-btn frame-control-action action-disabled \" + type + \"-\" + control + \"-disabled\");\r\n\t\t\tbutton.setAttribute(\"title\", disabled);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tbutton.setAttribute(\"class\", \"terminus-frame-control terminus-frame-btn frame-control-action \" + type + \"-\" + control);\r\n\t\t\tbutton.addEventListener(\"click\", function(){\r\n\t\t\t\tif(this.innerHTML == 'Save'){\r\n\t\t\t\t\tvar objId = document.getElementsByClassName('terminus-object-id-input');\r\n\t\t\t\t\tif(objId.length>0){\r\n\t\t\t\t\t\tif(!objId[0].value){\r\n\t\t\t\t\t\t\tobjId[0].setAttribute('placeholder', 'Required field');\r\n\t\t\t\t\t\t\tobjId[0].style.background = '#f8d7da';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse callback(control);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse callback(control);\r\n\t\t\t\t}\r\n\t\t\t\telse callback(control);\r\n\t\t\t\t//(control);\r\n\t\t\t});\r\n\t\t}\r\n\t\tdpropDOM.appendChild(button);\r\n\t//}\r\n\treturn dpropDOM;\r\n}\r\n\r\nHTMLFrameHelper.getSettingsControl = function(view){\r\n\tvar pman = new TerminusPluginManager();\r\n\tif(pman.pluginAvailable(\"font-awesome\")){\r\n\t\tvar icon = document.createElement('icon');\r\n\t\tif(view == 'property') icon.setAttribute('class', 'fa fa-cog terminus-pointer');\r\n\t\telse if(view == 'data') icon.setAttribute('class', 'fa fa-edit terminus-pointer');\r\n\t\ticon.setAttribute('style', 'margin: 10px;')\r\n\t\treturn icon;\r\n\t}\r\n\telse{\r\n\t\tvar button = document.createElement(\"button\");\r\n\t\tbutton.setAttribute('class', 'terminus-btn');\r\n\t\tbutton.appendChild(document.createTextNode('Settings'));\r\n\t\treturn button;\r\n\t}\r\n}\r\n\r\nHTMLFrameHelper.getControlIcon = function(control){\r\n\tvar icon;\r\n\tswitch(control){\r\n\t\tcase 'delete':\r\n\t\t\ticon = '-alt-delete';\r\n\t\tbreak;\r\n\t\tcase 'add':\r\n\t\t\ticon = '-plus';\r\n\t\tbreak;\r\n\t\tcase 'reset':\r\n\t\t\ticon = '-undo';\r\n\t\tbreak;\r\n\t\tcase 'save':\r\n\t\t\ticon = '-save';\r\n\t\tbreak;\r\n\t\tcase 'hide':\r\n\t\t\ticon = '-eye-slash';\r\n\t\tbreak;\r\n\t}\r\n\treturn icon;\r\n}\r\n\r\nHTMLFrameHelper.getSelectionControl = function(type, options, selected, callback){\r\n\tvar sel = document.createElement(\"select\");\r\n\tsel.setAttribute(\"class\", \"terminus-frame-selector frame-control-selection \" + type);\r\n\tfor(var i = 0; i < options.length; i++){\r\n\t\tvar opt = document.createElement(\"option\");\r\n\t\tif(typeof options[i] == \"object\"){\r\n\t\t\topt.value = options[i].value;\r\n\t\t\tvar label = (options[i].label ?  document.createTextNode(options[i].label) : document.createTextNode(TerminusClient.FrameHelper.labelFromURL(options[i].value)));\r\n\t\t\topt.appendChild(label);\r\n\t\t}\r\n\t\telse {\r\n\t\t\topt.value = options[i];\r\n\t\t\tlabel = TerminusClient.FrameHelper.labelFromURL(opt.value);\r\n\t\t\topt.appendChild(document.createTextNode(label));\r\n\t\t}\r\n\t\tif(selected == opt.value){\r\n\t\t\topt.setAttribute(\"selected\", \"selected\");\r\n\t\t}\r\n\t\tsel.appendChild(opt);\r\n\t}\r\n\tsel.addEventListener(\"change\", function(){\r\n\t\tcallback(this.value);\r\n\t});\r\n\treturn sel;\r\n}\r\n\r\nHTMLFrameHelper.getModeSelectorDOM = function(which, renderer){\r\n\tvar viewsDOM = document.createElement(\"span\");\r\n\tviewsDOM.setAttribute(\"class\", \"terminus-mode terminus-\"+which+\"-mode\");\r\n\tif(renderer.mode == \"view\"){\r\n\t\tvar callback = function(){ renderer.setMode(\"edit\");}\r\n\t\tviewsDOM.appendChild(HTMLFrameHelper.getActionControl(\"terminus-mode terminus-\"+which+\"-mode\", \"edit\", \" Edit \", callback));\r\n\t}\r\n\telse if(renderer.isNew()){\r\n\t\treturn false;\r\n\t}\r\n\telse {\r\n\t\tvar callback = function(){ renderer.cancel();}\r\n\t\tviewsDOM.appendChild(HTMLFrameHelper.getActionControl(which, \"cancel\", \"Cancel\", callback));\r\n\t}\r\n\treturn viewsDOM;\r\n}\r\n\r\nHTMLFrameHelper.goToName = function(s, p, i){\r\n\tvar url = window.location.href;\r\n\tif(url){\r\n\t\tvar wbits = url.split(\"#\");\r\n\t\tvar loc = wbits[0];\r\n\t\tvar sh = TerminusClient.FrameHelper.getShorthand(s);\r\n\t    if(!sh) sh = s;\r\n\t\tvar bits = sh.split(\":\");\r\n\t\tif(bits.length > 1) sh = bits[1];\r\n\t\tvar htmlid = sh;\r\n\t\tif(p){\r\n\t\t\tvar prop = TerminusClient.FrameHelper.getShorthand(p);\r\n\t\t\tif(!prop ) prop = p;\r\n\t\t\tvar bits = prop.split(\":\");\r\n\t\t\tif(bits.length > 1) prop = bits[1];\r\n\t\t\thtmlid += \"_\" + prop;\r\n\t\t\tif(i){\r\n\t\t\t\thtmlid += \"_\" + i;\r\n\t\t\t}\r\n\t\t}\r\n\t\twindow.location = loc + \"#\" + htmlid;\r\n\t}\r\n}\r\n\r\nHTMLFrameHelper.wrapShortenedText = function(wrap, text, max_cell_size, max_word_size){\r\n\tif(max_cell_size && (text.length > max_cell_size)){\r\n\t\twrap.setAttribute(\"title\", text);\r\n\t\ttext = text.substring(0, max_cell_size) + \"...\";\r\n\t}\r\n\tif(max_word_size){\r\n\t\tconst replacements = {}\r\n\t\tconst words = text.split(\" \");\r\n\t\tfor(var i = 0; i < words.length; i++){\r\n\t\t\tvar word = words[i];\r\n\t\t\tif(word.length > max_word_size){\r\n\t\t\t\twrap.setAttribute(\"title\", text);\r\n\t\t\t\tvar newstr = word.substring(0, max_word_size) + \"...\";\r\n\t\t\t\treplacements[word] = newstr;\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor(var k in replacements){\r\n\t\t\ttext = text.replace(k, replacements[k]);\r\n\t\t}\r\n\t}\r\n\twrap.appendChild(document.createTextNode(text));\r\n}\r\n\r\nHTMLFrameHelper.getVariableValueFromBinding = function(varname, bind){\r\n\tfor(var key in bind){\r\n\t\tvar skey = key.substring(key.lastIndexOf(\"/\")+1);\r\n\t\tif(skey == varname){\r\n\t\t\tconst obj = bind[key];\r\n\t\t\tif(typeof obj == \"object\" && obj['@value']) return obj['@value'];\r\n\t\t\treturn obj;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\n\r\nHTMLFrameHelper.getInfoboxDOM = function(type, label, value, help, input){\r\n\t/*var frow = this.getFrameRow();\r\n\tvar fgroup = this.getFrameGroup(frow);*/\r\n\tvar infoDOM = document.createElement(\"span\");\r\n\tinfoDOM.setAttribute(\"class\", \"terminus-frame-infobox-box \" + \"terminus-\" +type );\r\n\t//fgroup.appendChild(infoDOM);\r\n\tif(help){\r\n\t\tinfoDOM.setAttribute(\"title\", help);\r\n\t}\r\n\tif(label){\r\n\t\tvar linfo = document.createElement(\"span\");\r\n\t\tlinfo.setAttribute(\"class\", \"terminus-frame-infobox-label \" + \"terminus-\" +type + \"-label\");\r\n\t\tlinfo.appendChild(document.createTextNode(label));\r\n\t\tinfoDOM.appendChild(linfo);\r\n\t}\r\n\tvar lspacer = document.createElement(\"span\");\r\n\tlspacer.setAttribute(\"class\", \"terminus-frame-infobox-spacer \" + \"terminus-\" +type + \"-spacer\");\r\n\tlspacer.appendChild(document.createTextNode(\" \"));\r\n\tinfoDOM.appendChild(lspacer);\r\n\tvar lval = document.createElement(\"span\");\r\n\tlval.setAttribute(\"class\", \"terminus-frame-infobox-value \" + \"terminus-\" +type + \"-value\");\r\n\tif(input){\r\n\t\tinput.value = value;\r\n\t\tlval.appendChild(input);\r\n\t}\r\n\telse if(value) {\r\n\t\tvar sh = TerminusClient.FrameHelper.getShorthand(value);\r\n        if(sh){\r\n    \t   \tvar bits = sh.split(\":\");\r\n            sh = bits[1];\r\n   \t\t\tlval.setAttribute(\"title\", value);\r\n\t\t\tlval.appendChild(document.createTextNode(sh));\r\n\t\t}\r\n\t\telse {\r\n\t\t\tlval.appendChild(document.createTextNode(value));\r\n\t\t}\r\n\t}\r\n\tinfoDOM.appendChild(lval);\r\n\treturn infoDOM;\r\n}\r\n\r\n/*\r\n * HTML drawing function for document rendering \r\n */\r\n\r\nHTMLFrameHelper.getFrameDOM = function(scope, frame, orientation, hfeatures, features){\r\n\tif(frame.display_options.hidden) return false;\r\n\tvar framedom = HTMLFrameHelper.getFrameHolderDOM(scope, frame, orientation);\r\n\tif(typeof frame.display_options.header != \"undefined\"){\r\n\t\tif(typeof frame.display_options.header == \"function\"){\r\n\t\t\tvar hd = frame.display_options.header(frame.display_options.header_features, hfeatures);\r\n\t\t\tframedom.appendChild(hd);\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tvar hd = HTMLFrameHelper.getFrameHeaderDOM(scope, frame, orientation, hfeatures);\r\n\t\tif(hfeatures) hd.appendChild(hfeatures);\r\n\t\tframedom.appendChild(hd);\r\n\t}\r\n\treturn framedom.appendChild(HTMLFrameHelper.getFrameBodyDOM(scope, frame, orientation, features));\r\n}\r\n\r\nHTMLFrameHelper.getFrameHolderDOM = function(scope, frame, orientation){\r\n\tvar pcls = \"terminus-\" + scope + \"-frame\";\r\n\tif(orientation == \"page\"){\r\n\t\tvar sp = document.createElement(\"div\");\r\n\t}\r\n\telse {\r\n\t\tvar sp = document.createElement(\"span\");\r\n\t}\r\n\tvar css = pcls + \" \" + pcls + \"-\" + orientation + \r\n\t\t(scope == \"object\" && frame.parent ? \"\" : \" terminus-root-frame\") \r\n\t\t+ \" \" + pcls + \"-\" + frame.display_options.mode;\r\n\tsp.setAttribute(\"class\", css);\r\n\tif(scope == \"object\"){\r\n\t\tsp.setAttribute(\"data-class\", frame.subjectClass());\r\n\t\tsp.setAttribute(\"data-id\", frame.subject());\t\t\r\n\t\tvar hid = this.hash(frame.subject());\r\n\t}\r\n\telse if(scope == \"property\"){\r\n\t\tsp.setAttribute('data-property', frame.property());\t\r\n\t\tvar hid = this.hash(frame.subject()+frame.property());\r\n\t}\r\n\telse if(scope == \"data\"){\r\n\t\tsp.setAttribute('data-value', frame.get());\r\n\t\tvar hid = this.hash(frame.subject() + frame.property() + frame.index);\r\n\t}\r\n\tvar idm = document.createElement(\"a\");\r\n\tidm.setAttribute(\"class\", \"terminus-\" + scope + \"-idmarker\");\r\n\tidm.setAttribute(\"name\", hid);\t\t\t\t\r\n    sp.appendChild(idm);\r\n\treturn sp;\r\n}\r\n\r\nHTMLFrameHelper.getFrameHeaderDOM = function(scope, frame, orientation, features){\r\n\tvar css = \"terminus-\" + scope + \"-header\";\r\n\tif(orientation == \"page\"){\r\n\t\tvar objDOM = document.createElement(\"div\");\r\n\t}\r\n\telse {\r\n\t\tvar objDOM = document.createElement(\"span\");\r\n\t}\r\n\tobjDOM.setAttribute(\"class\", css + \" \" + css + \"-\" + orientation);\r\n    if(features) objDOM.appendChild(features);\r\n\treturn objDOM;\r\n}\r\n\r\nHTMLFrameHelper.getFrameBodyDOM = function(scope, frame, orientation, features){\r\n\tvar css = \"terminus-\" + scope + \"-properties\";\r\n\tif(orientation == \"page\"){\r\n\t\tvar vholder = document.createElement(\"div\");\r\n\t}\r\n\telse {\r\n\t\tvar vholder = document.createElement(\"span\");\r\n\t}\r\n    vholder.setAttribute('class', css + \" \" + css + \"-\" + orientation);\r\n    if(features) vholder.appendChild(features);\r\n    return vholder;\r\n}\r\n\r\nHTMLFrameHelper.hash = function(s) {\r\n\tvar hash = 0, i, chr;\r\n\tif (s.length === 0) return hash;\r\n\tfor (i = 0; i < s.length; i++) {\r\n\t    chr   = s.charCodeAt(i);\r\n\t    hash  = ((hash << 5) - hash) + chr;\r\n\t    hash |= 0; // Convert to 32bit integer\r\n\t}\r\n\treturn hash;\r\n};\r\n\r\nHTMLFrameHelper.getFeatureDOM = function(feature, scope, frame){\r\n\tif(feature == \"id\"){\t\r\n\t\tif(scope == \"object\") var val = frame.subject();\r\n\t\telse if(scope == \"property\") var val = frame.property();\r\n\t\tif(val == \"_:\") var val = \"New Document\";\r\n\t\treturn HTMLFrameHelper.getInfoboxDOM(\"object-id\", \"ID\", val, \"The URL that identifies this data object\");\r\n\t}\r\n\telse if(feature == \"summary\"){\r\n\t\tvar sum = frame.getSummary();\r\n\t\treturn HTMLFrameHelper.getInfoboxDOM(scope + \"-summary\", false, sum.long, sum.status);\r\n\t}\r\n\telse if(feature == \"label\"){\r\n\t\tvar lab = frame.getLabel();\r\n\t\tif(lab){\r\n\t\t\treturn HTMLFrameHelper.getInfoboxDOM(scope + \"-type\", false, lab);\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\telse if(feature == \"status\"){\r\n\t\tvar sum = frame.getSummary();\r\n\t\treturn HTMLFrameHelper.getInfoboxDOM(scope + \"-status-\"+sum.status, false, sum.status, sum.status);\r\n\t}\r\n\telse if(feature == \"comment\"){\r\n\t\tvar lab = frame.getComment();\r\n\t\treturn HTMLFrameHelper.getInfoboxDOM(\"property-comment\", false, lab);\r\n\t}\r\n\telse if(feature == \"type\"){\r\n\t\tif(scope == \"property\" && frame.display_options.mode == \"edit\" && frame.parent && frame.parent.isClassChoice() && frame.isNew()){\r\n\t\t\treturn this.getClassChoiceTypeSelector(frame);\r\n\t\t}\r\n\t\tif(scope == \"object\") var lab = frame.subjectClass();\r\n\t\telse if(scope == \"property\") var lab = frame.range();\r\n\t\telse if(scope == \"data\") var lab = frame.getType();\r\n\t\tif(lab){\r\n\t\t\treturn HTMLFrameHelper.getInfoboxDOM(scope + \"-type\", \"Type\", lab);\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\telse if(feature == \"delete\"){\r\n\t\tvar callback = function(){frame.delete()};\r\n\t\tvar disabled = false;\r\n\t\tif(!frame.cardControlAllows(\"delete\", scope)){\r\n\t\t\tif(!frame.display_options.show_disabled_buttons){\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tdisabled = \"Cardinality rules prevent deleting this element\";\r\n\t\t}\r\n\t\treturn HTMLFrameHelper.getActionControl(scope, \"delete\", \"Delete\", callback, disabled);\r\n\t}\r\n\telse if(feature == \"clone\"){\r\n\t\tvar callback = function(){frame.clone()};\r\n\t\tvar disabled = false;\r\n\t\tif(!frame.cardControlAllows(\"clone\", scope)){\r\n\t\t\tif(!frame.display_options.show_disabled_buttons){\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tdisabled = \"Cardinality rules prevent cloning this element\";\r\n\t\t}\r\n\t\treturn HTMLFrameHelper.getActionControl(scope, \"clone\", \"Clone\", callback, disabled);\r\n\t}\r\n\telse if(feature == \"reset\"){\r\n\t\tvar callback = function(){frame.reset()};\r\n\t\tvar disabled = false;\r\n\t\tif(!frame.isUpdated()){\r\n\t\t\tif(!frame.display_options.show_disabled_buttons){\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tdisabled = \"No changes have been made to this element\";\r\n\t\t}\r\n\t\treturn HTMLFrameHelper.getActionControl(scope, \"reset\", \"Reset\", callback, disabled);\r\n\t}\r\n\telse if(feature == \"hide\"){\r\n\t\tvar callback = function(){frame.hide()};\r\n\t\treturn HTMLFrameHelper.getActionControl(scope, \"hide\", \"Hide\", callback);\r\n\t}\r\n\telse if(feature == \"show\"){\r\n\t\tvar callback = function(){frame.show()};\r\n\t\treturn HTMLFrameHelper.getActionControl(scope, \"show\", \"Show\", callback);\r\n\t}\r\n\telse if(feature == \"update\"){\r\n\t\tvar callback = function(){frame.save()};\r\n\t\tif(!frame.isUpdated() && !frame.display_options.show_disabled_buttons){\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tvar disabled = frame.isUpdated() ? false : \"No changes have been made to this element\";\r\n\t\treturn HTMLFrameHelper.getActionControl(scope, \"save\", \"Save\", callback, disabled);\r\n\t}\r\n\telse if(feature == \"viewer\"){\r\n\t\treturn this.getViewerSelectorDOM(scope, frame);\r\n\t}\r\n\telse if(feature == \"view\"){\r\n\t\treturn this.getViewEntryDOM(scope, frame);\r\n\t}\r\n\telse if(feature == \"cardinality\"){\r\n\t\treturn this.getCardinalityDOM(scope, frame);\r\n\t}\r\n\telse if(feature == \"add\"){\r\n\t\treturn this.getAddDOM(scope, frame);\r\n\t}\r\n}\r\n\r\nHTMLFrameHelper.getViewerSelectorDOM = function(scope, frame){\r\n\tvar viewers = frame.terminus.datatypes.getAvailableViewers();\r\n\tvar r = this.terminus.datatypes.getRenderer(t);\r\n\r\n\tif(viewers && viewers.length){\r\n\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-\" + scope + \"-viewer\");\r\n\t\tvar callback = function(viewer){\r\n\t\t\tif(viewer){\r\n\t\t\t\tframe.setViewer(viewer);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar selected = frame.currentViewer();\r\n\t\tvar sel = HTMLFrameHelper.getSelectionControl(scope + '-viewer', viewers, selected, callback);\r\n\t\tmpropDOM.appendChild(sel);\r\n\t\treturn mpropDOM;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\n\r\n/* needs html viewer context for goto */\r\nHTMLFrameHelper.getViewEntryDOM = function(scope, frame){\r\n\tif(scope == \"object\"){\r\n\t\tvar viewables = frame.getFilledPropertyList();\r\n\t}\r\n\telse if(scope == \"property\"){\r\n\t\t\r\n\t}\r\n\tvar self = this;\r\n\tif(viewables && viewables.length){\r\n\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-\"+scope + \"-view-entry\");\r\n\t\tviewables.unshift({ value: \"\", label: \"View \" + scope});\r\n\t\tvar callback = function(add){\r\n\t\t\tif(add){\r\n\t\t\t\tframe.goToEntry(add);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar sel = HTMLFrameHelper.getSelectionControl(scope + \"-view-entry\", viewables, \"\", callback);\r\n\t\tmpropDOM.appendChild(sel);\r\n\t\treturn mpropDOM;\r\n\t}\r\n\treturn false;\r\n\t\r\n}\r\n\r\nHTMLFrameHelper.getCardinalityDOM = function(scope, frame){\r\n\tvar restriction = frame.getRestriction();\r\n\tif(restriction.min && restriction.max){\r\n\t\tif(restriction.min == restriction.max){\r\n\t\t\tvar lab = restriction.min;\r\n\t\t\tvar help = \"Cardinality: \" + restriction.min;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tvar lab = restriction.min + \"-\" + restriction.max;\r\n\t\t\tvar help = \"Minimum Cardinality: \" + restriction.min;\r\n\t\t\thelp += \", Maximum Cardinality: \" + restriction.max;\r\n\t\t}\r\n\t}\r\n\telse if(restriction.min){\r\n\t\tvar lab = \">\"+(restriction.min-1);\r\n\t\tvar help = \"Minimum Cardinality: \" + restriction.min;\r\n\t}\r\n\telse if(restriction.max){\r\n\t\tvar lab = \"<\"+(restriction.max+1);\r\n\t\tvar help = \"Maximum Cardinality: \" + restriction.max;\r\n\t}\r\n\telse {\r\n\t\treturn false;\r\n\t}\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"property-cardinality\", \"Cardinality\", lab, help);\r\n}\r\n\r\nHTMLFrameHelper.getClassChoiceTypeSelector = function(frame){\r\n\tvar cs = frame.parent.getAvailableClassChoices();\r\n\tif(cs && cs.length){\r\n\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-property-change-class\");\r\n\t\tvar mlabDOM = document.createElement(\"span\");\r\n\t\tmlabDOM.setAttribute(\"class\", \"terminus-property-change-label\");\r\n\t\tmlabDOM.appendChild(document.createTextNode(\"Type\"));\r\n\t\tmpropDOM.appendChild(mlabDOM);\r\n\t\tvar callback = function(cls){\r\n\t\t\tif(cls){\r\n\t\t\t\tframe.changeClass(cls);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"change-class\", cs, frame.subjectClass(), callback);\r\n\t\tmpropDOM.appendChild(sel);\r\n\t\treturn mpropDOM;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLFrameHelper.getAddDOM = function(scope, frame){\r\n\tif(scope == \"property\"){\r\n\t\tif(frame.isClassChoice()){\r\n\t\t\tvar cs = frame.getAvailableClassChoices();\r\n\t\t\tif(cs && cs.length){\r\n\t\t\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\t\t\tmpropDOM.setAttribute(\"class\", \"terminus-property-add-class\");\r\n\t\t\t\tcs.unshift({ value: \"\", label: \"Add Type\"});\r\n\t\t\t\tvar callback = function(cls){\r\n\t\t\t\t\tif(cls){\r\n\t\t\t\t\t\tframe.addClass(cls);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"add-property\", cs, \"\", callback);\r\n\t\t\t\tmpropDOM.appendChild(sel);\r\n\t\t\t\treturn mpropDOM;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(frame.cardControlAllows(\"add\") || frame.display_options.show_disabled_buttons){\r\n\t\t\tvar callback = function(){frame.add(\"edit\")};\r\n\t\t\tvar disabled = (frame.cardControlAllows(\"add\") ? false : \"Cardinality Rules Forbid Add\");\r\n\t\t\treturn HTMLFrameHelper.getActionControl(scope + \"-add-entry\", \"add\", \"Add\", callback, disabled);\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tvar addables = frame.getMissingPropertyList();\r\n\t\tif(addables && addables.length){\r\n\t\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\t\tmpropDOM.setAttribute(\"class\", \"terminus-\" + scope + \"-add-entry\");\r\n\t\t\taddables.unshift({ value: \"\", label: \"Add new \" + scope});\r\n\t\t\tvar callback = function(add){\r\n\t\t\t\tif(add){\r\n\t\t\t\t\tif(scope == \"object\") frame.addNewProperty(add);\r\n\t\t\t\t\telse if(scope == \"property\") frame.addNewValue(add);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif(frame.cardControlAllows(\"add\") || frame.display_options.show_disabled_buttons){\r\n\t\t\t\tvar disabled = (frame.cardControlAllows(\"add\") ? false : \"Cardinality rules forbid adding element\");\r\n\t\t\t\tvar sel = HTMLFrameHelper.getSelectionControl(scope + \"-add-entry\", addables, \"\", callback, disabled);\r\n\t\t\t\tmpropDOM.appendChild(sel);\r\n\t\t\t\treturn mpropDOM;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nmodule.exports=HTMLFrameHelper\r\n","'use strict';\n\nvar bind = require('./helpers/bind');\nvar isBuffer = require('is-buffer');\n\n/*global toString:true*/\n\n// utils is a library of generic helper functions non-specific to axios\n\nvar toString = Object.prototype.toString;\n\n/**\n * Determine if a value is an Array\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is an Array, otherwise false\n */\nfunction isArray(val) {\n  return toString.call(val) === '[object Array]';\n}\n\n/**\n * Determine if a value is an ArrayBuffer\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is an ArrayBuffer, otherwise false\n */\nfunction isArrayBuffer(val) {\n  return toString.call(val) === '[object ArrayBuffer]';\n}\n\n/**\n * Determine if a value is a FormData\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is an FormData, otherwise false\n */\nfunction isFormData(val) {\n  return (typeof FormData !== 'undefined') && (val instanceof FormData);\n}\n\n/**\n * Determine if a value is a view on an ArrayBuffer\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a view on an ArrayBuffer, otherwise false\n */\nfunction isArrayBufferView(val) {\n  var result;\n  if ((typeof ArrayBuffer !== 'undefined') && (ArrayBuffer.isView)) {\n    result = ArrayBuffer.isView(val);\n  } else {\n    result = (val) && (val.buffer) && (val.buffer instanceof ArrayBuffer);\n  }\n  return result;\n}\n\n/**\n * Determine if a value is a String\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a String, otherwise false\n */\nfunction isString(val) {\n  return typeof val === 'string';\n}\n\n/**\n * Determine if a value is a Number\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a Number, otherwise false\n */\nfunction isNumber(val) {\n  return typeof val === 'number';\n}\n\n/**\n * Determine if a value is undefined\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if the value is undefined, otherwise false\n */\nfunction isUndefined(val) {\n  return typeof val === 'undefined';\n}\n\n/**\n * Determine if a value is an Object\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is an Object, otherwise false\n */\nfunction isObject(val) {\n  return val !== null && typeof val === 'object';\n}\n\n/**\n * Determine if a value is a Date\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a Date, otherwise false\n */\nfunction isDate(val) {\n  return toString.call(val) === '[object Date]';\n}\n\n/**\n * Determine if a value is a File\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a File, otherwise false\n */\nfunction isFile(val) {\n  return toString.call(val) === '[object File]';\n}\n\n/**\n * Determine if a value is a Blob\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a Blob, otherwise false\n */\nfunction isBlob(val) {\n  return toString.call(val) === '[object Blob]';\n}\n\n/**\n * Determine if a value is a Function\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a Function, otherwise false\n */\nfunction isFunction(val) {\n  return toString.call(val) === '[object Function]';\n}\n\n/**\n * Determine if a value is a Stream\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a Stream, otherwise false\n */\nfunction isStream(val) {\n  return isObject(val) && isFunction(val.pipe);\n}\n\n/**\n * Determine if a value is a URLSearchParams object\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a URLSearchParams object, otherwise false\n */\nfunction isURLSearchParams(val) {\n  return typeof URLSearchParams !== 'undefined' && val instanceof URLSearchParams;\n}\n\n/**\n * Trim excess whitespace off the beginning and end of a string\n *\n * @param {String} str The String to trim\n * @returns {String} The String freed of excess whitespace\n */\nfunction trim(str) {\n  return str.replace(/^\\s*/, '').replace(/\\s*$/, '');\n}\n\n/**\n * Determine if we're running in a standard browser environment\n *\n * This allows axios to run in a web worker, and react-native.\n * Both environments support XMLHttpRequest, but not fully standard globals.\n *\n * web workers:\n *  typeof window -> undefined\n *  typeof document -> undefined\n *\n * react-native:\n *  navigator.product -> 'ReactNative'\n * nativescript\n *  navigator.product -> 'NativeScript' or 'NS'\n */\nfunction isStandardBrowserEnv() {\n  if (typeof navigator !== 'undefined' && (navigator.product === 'ReactNative' ||\n                                           navigator.product === 'NativeScript' ||\n                                           navigator.product === 'NS')) {\n    return false;\n  }\n  return (\n    typeof window !== 'undefined' &&\n    typeof document !== 'undefined'\n  );\n}\n\n/**\n * Iterate over an Array or an Object invoking a function for each item.\n *\n * If `obj` is an Array callback will be called passing\n * the value, index, and complete array for each item.\n *\n * If 'obj' is an Object callback will be called passing\n * the value, key, and complete object for each property.\n *\n * @param {Object|Array} obj The object to iterate\n * @param {Function} fn The callback to invoke for each item\n */\nfunction forEach(obj, fn) {\n  // Don't bother if no value provided\n  if (obj === null || typeof obj === 'undefined') {\n    return;\n  }\n\n  // Force an array if not already something iterable\n  if (typeof obj !== 'object') {\n    /*eslint no-param-reassign:0*/\n    obj = [obj];\n  }\n\n  if (isArray(obj)) {\n    // Iterate over array values\n    for (var i = 0, l = obj.length; i < l; i++) {\n      fn.call(null, obj[i], i, obj);\n    }\n  } else {\n    // Iterate over object keys\n    for (var key in obj) {\n      if (Object.prototype.hasOwnProperty.call(obj, key)) {\n        fn.call(null, obj[key], key, obj);\n      }\n    }\n  }\n}\n\n/**\n * Accepts varargs expecting each argument to be an object, then\n * immutably merges the properties of each object and returns result.\n *\n * When multiple objects contain the same key the later object in\n * the arguments list will take precedence.\n *\n * Example:\n *\n * ```js\n * var result = merge({foo: 123}, {foo: 456});\n * console.log(result.foo); // outputs 456\n * ```\n *\n * @param {Object} obj1 Object to merge\n * @returns {Object} Result of all merge properties\n */\nfunction merge(/* obj1, obj2, obj3, ... */) {\n  var result = {};\n  function assignValue(val, key) {\n    if (typeof result[key] === 'object' && typeof val === 'object') {\n      result[key] = merge(result[key], val);\n    } else {\n      result[key] = val;\n    }\n  }\n\n  for (var i = 0, l = arguments.length; i < l; i++) {\n    forEach(arguments[i], assignValue);\n  }\n  return result;\n}\n\n/**\n * Function equal to merge with the difference being that no reference\n * to original objects is kept.\n *\n * @see merge\n * @param {Object} obj1 Object to merge\n * @returns {Object} Result of all merge properties\n */\nfunction deepMerge(/* obj1, obj2, obj3, ... */) {\n  var result = {};\n  function assignValue(val, key) {\n    if (typeof result[key] === 'object' && typeof val === 'object') {\n      result[key] = deepMerge(result[key], val);\n    } else if (typeof val === 'object') {\n      result[key] = deepMerge({}, val);\n    } else {\n      result[key] = val;\n    }\n  }\n\n  for (var i = 0, l = arguments.length; i < l; i++) {\n    forEach(arguments[i], assignValue);\n  }\n  return result;\n}\n\n/**\n * Extends object a by mutably adding to it the properties of object b.\n *\n * @param {Object} a The object to be extended\n * @param {Object} b The object to copy properties from\n * @param {Object} thisArg The object to bind function to\n * @return {Object} The resulting value of object a\n */\nfunction extend(a, b, thisArg) {\n  forEach(b, function assignValue(val, key) {\n    if (thisArg && typeof val === 'function') {\n      a[key] = bind(val, thisArg);\n    } else {\n      a[key] = val;\n    }\n  });\n  return a;\n}\n\nmodule.exports = {\n  isArray: isArray,\n  isArrayBuffer: isArrayBuffer,\n  isBuffer: isBuffer,\n  isFormData: isFormData,\n  isArrayBufferView: isArrayBufferView,\n  isString: isString,\n  isNumber: isNumber,\n  isObject: isObject,\n  isUndefined: isUndefined,\n  isDate: isDate,\n  isFile: isFile,\n  isBlob: isBlob,\n  isFunction: isFunction,\n  isStream: isStream,\n  isURLSearchParams: isURLSearchParams,\n  isStandardBrowserEnv: isStandardBrowserEnv,\n  forEach: forEach,\n  merge: merge,\n  deepMerge: deepMerge,\n  extend: extend,\n  trim: trim\n};\n","/**\r\n * @file Javascript Api explorer tool\r\n * @author Kitty Jose\r\n * @license Copyright 2018-2019 Data Chemist Limited, All Rights Reserved. See LICENSE file for more\r\n *\r\n * @summary Set of functions used across scripts\r\n */\r\nconst Codemirror= require('./plugins/codemirror.terminus');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\n// function to read Files\r\nfunction readFile(file){\r\n    if (window.XMLHttpRequest){\r\n        // code for IE7+, Firefox, Chrome, Opera, Safari\r\n        xmlhttp=new XMLHttpRequest();\r\n    }\r\n    else{\r\n        // code for IE6, IE5\r\n        xmlhttp=new ActiveXObject(\"Microsoft.XMLHTTP\");\r\n    }\r\n    xmlhttp.open(\"GET\",file,false);\r\n    xmlhttp.send();\r\n    xmlDoc=xmlhttp.responseText;\r\n    return xmlDoc;\r\n} // readFile()\r\n\r\n// function to write api call signatures from woql client\r\nfunction getFunctionSignature(which){\r\n  var sigs = {};\r\n  sigs.connect = {\r\n    spec   : \"WOQLClient.connect(surl, key)\",\r\n    descr  : \"\\n\\nConnect to a Terminus server at the given URI with an API key\"\r\n                + \"Stores the terminus:ServerCapability document returned in the connection register\"\r\n                + \"which stores, the url, key, capabilities, and database meta-data for the connected server\"\r\n                + \"If the curl argument is false or null, the this.server will be used if present,\"\r\n                + \" or the promise will be rejected.\"\r\n                + \"\\n1)The first (surl) argument: {string} argument it is the Server Url\"\r\n                + \"\\n2)The second(key) argument: {string} argument contains an API key\",\r\n    result : \"HTTP 200 on success, 409 for already existing database, otherwise error code\",\r\n    args   : {server_url : 'url', key: 'Api key'},\r\n    options: { title: \"\", description: \"\" }\r\n  };\r\n  sigs.create = {\r\n    spec    : \"WOQLClient.createDatabase(dburl, details, key)\",\r\n    descr   : \"\\n\\nCreate a Terminus Database\"\r\n                + \"\\n1)The first (dburl) argument:{string}, it is a terminusDB Url or a terminusDB Id \"\r\n                + \"\\n2)The second(details) argument:{object}, details which is the payload\"\r\n                + \"\\n which included information of the new database to be created\"\r\n                +  \"\\n3)The third (key) argument:{string}, contains an API key \",\r\n    result : \"HTTP 200 on success, 409 for already existing database, otherwise error code\",\r\n    args   : {database_url : 'url', details: '', key: ' Api key'},\r\n    options: { title: \"\", description: \"\" }\r\n  };\r\n  sigs.delete = {\r\n      spec  : \"WOQLClient.deleteDatabase(dburl, key)\",\r\n      descr : \"\\n\\nDeletes a Database\"\r\n                + \"\\n1)The first (dburl) argument: {string}, it is a terminusDB Url or a terminusDB Id \"\r\n                + \"\\n2)The second(key) argument: {string}, contains an API key\",\r\n      result: \"HTTP 200 on success, otherwise error code\",\r\n  };\r\n  sigs.getSchema = {\r\n    spec   : \"WOQLClient.getSchema(surl, options)\",\r\n    descr  : \"\\n\\nGets the schema of a database.\"\r\n             +\"\\n1)The first (surl) argument: {string}, it is a dbUrl/schema\"\r\n             + \"\\n2)The second(key) argument: {string}, contains an API key\",\r\n    result : \"Ontology Document on success (HTTP 200), 409 for already existing database, otherwise error code\",\r\n    options: { format: \"turtle\" }\r\n  };\r\n  sigs.getClassFrames = {\r\n    spec   : \"WOQLClient.getClassFrame = function(cfurl, cls, opts)\",\r\n    descr  : \"\\n\\nRetrieves a WOQL query on the specified database which updates the state and returns the results\"\r\n              +  \"\\nThe first (cfurl) argument can be\"\r\n              + \"\\n1) a valid URL of a terminus database or\"\r\n              +  \"\\n2) omitted - the current database will be used\"\r\n              +  \"\\nthe second argument (cls) is the URL / ID of a document class that exists in the database schema\"\r\n              +  \"\\nthe third argument (opts) is an options json - opts.key is an optional API key\",\r\n    result : \"Ontology Document on success (HTTP 200), 409 for already existing database, otherwise error code\",\r\n    options: { format: \"turtle\" }\r\n  };\r\n  sigs.updateSchema = {\r\n    spec    : \"WOQLClient.updateSchema(schurl, docs, options)\",\r\n    descr   : \"\\n\\nUpdates the Schema of the specified database\"\r\n                +\"\\n1)The first (surl) argument :{string}, is a dbUrl/schema\"\r\n                + \"\\n2)The second(docs) argument:{object}, is a valid owl ontology (new schema to be updated) in turtle format\"\r\n                + \"\\n3)The third (key) argument:{string}, contains an API key\",\r\n    result : \"Ontology Document on success (HTTP 200), 409 for already existing database, otherwise error code\",\r\n    args   : {document : 'doc'},\r\n    options: { format: \"turtle\", editmode: \"replace\"}\r\n  };\r\n  sigs.createDocument = {\r\n    spec   : \"WOQLClient.createDocument(docurl, document, options)\",\r\n    descr  : \"\\n\\nCreates a new document in the specified database\"\r\n              + \"\\n1)The first (docurl) argument: {string}, is a dbUrl/document/document_id\"\r\n              + \"\\n2)The second(document) argument: {object}, is a valid document in json-ld\"\r\n              + \"\\n3)The third (key) argument:{string}, contains an API key\",\r\n    result : \"Created Document on success (HTTP 200), Violation Report Otherwise (HTTP 400+)\",\r\n    args   : {document_url : 'url', document: \"doc\"},\r\n    options: { format: \"turtle\", fail_on_id_denied: false}\r\n  };\r\n  sigs.viewDocument = {\r\n    spec    : \"WOQLClient.getDocument(docurl, options)\",\r\n    descr   : \"\\n\\nRetrieves a document from the specified database\"\r\n              + \"\\n1)The first (docurl) argument: {string}, is a dbUrl/document/document_id\"\r\n              + \"\\n2)The second (key) argument: {string}, contains an API key\",\r\n    result : \"Document (HTTP 200), Violation Report Otherwise (HTTP 400+)\",\r\n    args   : {document_url : 'url'},\r\n    options: { format: \"turtle\"}\r\n  };\r\n  sigs.updateDocument = {\r\n    spec   : \"WOQLClient.updateDocument(docurl, document, options)\",\r\n    descr  : \"\\n\\nUpdates a document in the specified database with a new version\"\r\n                + \"\\n1)The first (docurl) argument: {string}, is a dbUrl/document/document_id\"\r\n                + \"\\n2)The second(document) argument: {object}, is a valid document in json-ld\"\r\n                + \"\\n3)The third (key) argument:{string} argument contains an API key\",\r\n    result : \"Ontology Document on success (HTTP 200), 409 for already existing database, otherwise error code\",\r\n    args   : {document_url : 'url', document: \"doc\"},\r\n    options: { format: \"turtle\", editmode: \"replace\"}\r\n  };\r\n  sigs.deleteDocument = {\r\n    spec  : \"WOQLClient.deleteDocument(docurl, key)\",\r\n    descr : \"\\n\\nDeletes a document from the specified database\"\r\n            + \"\\n1)The first (docurl) argument: {string},is a dbUrl/document/document_id\"\r\n            + \"\\n2)The second (key) argument: {string}, contains an API key\",\r\n    result: \"Ontology Document on success (HTTP 200), 409 for already existing database, otherwise error code\",\r\n    args  : {document_url : 'url'},\r\n  };\r\n  sigs.select = {\r\n    spec: \"WOQLClient.select(dburl, query, options)\",\r\n    descr: \"\\n\\nExecutes a read-only WOQL query on the specified database and returns the results\"\r\n              + \"\\n1)The first (docurl) argument: {string}, is a terminusDB Url or a terminusDB Id\"\r\n              + \"\\n2)The second (query) argument: {object}, a valid query in json-ld format \"\r\n              + \"\\n3)The third (key) argument:{string}, contains an API key\",\r\n    result: \"WOQL Result (HTTP 200), otherwise error code\",\r\n    args: {woql: 'woql'},\r\n  };\r\n  sigs.update = {\r\n    spec  : \"WOQLClient.update(dburl, query, options)\",\r\n    descr : \"\\n\\nExecutes a WOQL query on the specified database which updates the state and returns the results\"\r\n              + \"\\n1)The first (dburl) argument: {string}, is a terminusDB Url or a terminusDB Id\"\r\n              + \"\\n2)The second (query) argument: {object}, a valid query in json-ld format \"\r\n              + \"\\n3)The third (key) argument:{string}, contains an API key\",\r\n    result: \"WOQL Result (HTTP 200), otherwise error code\",\r\n    args  : {woql: 'woql'},\r\n  };\r\n  sigs.lookup = {\r\n    spec: \"WOQLClient.lookup(database_url, woql, options)\",\r\n    result: \"WOQL Result (HTTP 200), otherwise error code\",\r\n    args: {class: 'url', term: 'string'},\r\n  };\r\n  sigs.map = {\r\n    spec: \"WOQLClient.lookup(source, target, woql, options)\",\r\n    result: \"WOQL Result (HTTP 200), otherwise error code\",\r\n    args: {source: 'json', target: \"json\", woql: 'json'},\r\n  };\r\n  sigs.getClassFrame = {\r\n    spec: \"WOQLClient.getClassFrame(class, options)\",\r\n    result: \"WOQL Result (HTTP 200), otherwise error code\",\r\n    args: {class: 'url'},\r\n  };\r\n  sigs.getPropertyFrame = {\r\n    spec: \"WOQLClient.getPropertyFrame(class, property, options)\",\r\n    result: \"WOQL Result (HTTP 200), otherwise error code\",\r\n    args: {class: 'url', property: 'url'},\r\n  };\r\n  sigs.getFilledPropertyFrame = {\r\n    spec: \"WOQLClient.getPropertyFrame(document_url, property, options)\",\r\n    result: \"WOQL Result (HTTP 200), otherwise error code\",\r\n    args: {document_url: 'url', property: 'url'},\r\n  };\r\n  sigs.getSubClasses = {\r\n    spec: \"WOQLClient.getSubClasses(class, options)\",\r\n    result: \"WOQL Result (HTTP 200), otherwise error code\",\r\n    args: {class: 'url'},\r\n  };\r\n  return sigs[which];\r\n}//getFunctionSignature\r\n\r\n// returns dom element for header text\r\nfunction getHeaderDom(text){\r\n  var hd = document.createElement('div');\r\n  hd.setAttribute('class', 'terminus-module-head');\r\n  var h = document.createElement('h3');\r\n  h.innerHTML = text;\r\n  hd.appendChild(h);\r\n  return hd;\r\n} // getHeaderTextDom\r\n\r\n// returns dom for alert banner\r\nfunction getInfoAlertDom(type, label, msg){\r\n  var ald = document.createElement('div');\r\n  if(type == 'info') ald.setAttribute('class', 'terminus-alert terminus-alert-success');\r\n  else ald.setAttribute('class', 'alert');\r\n  var str = document.createElement('STRONG');\r\n  str.innerHTML = label;\r\n  ald.appendChild(str);\r\n  var txt = document.createTextNode(msg);\r\n  ald.appendChild(txt);\r\n  return ald;\r\n} // getInfoAlertDom()\r\n\r\n// formats response results from platform\r\nfunction getResponse(currForm, action, response, terminator){\r\n\r\n  var rd = document.createElement('div');\r\n\r\n  // get header result\r\n  rd.appendChild(getHeaderDom('Result'));\r\n  var br = document.createElement('BR');\r\n  rd.appendChild(br);\r\n\r\n  var data = JSON.stringify(response, 0, 4);\r\n\r\n  var pre = document.createElement('pre');\r\n  pre.setAttribute('class', 'terminus-api-view terminus-scheme-pre');\r\n  pre.innerHTML = data;\r\n\r\n  var cm = stylizeCodeDisplay(terminator, pre, rd, 'javascript');\r\n  if(!cm) rd.appendChild(pre);\r\n\r\n  var br = document.createElement('BR');\r\n  rd.appendChild(br);\r\n\r\n  currForm.appendChild(rd);\r\n\r\n  return currForm;\r\n}\r\n\r\n// formats the response from fetch call and spits out Http header and result\r\nfunction showHttpResult(response, action, currForm, terminator){\r\n    //var currForm = document.createElement('div');\r\n\r\n    var br = document.createElement('BR');\r\n    currForm.appendChild(br);\r\n    var br = document.createElement('BR');\r\n    currForm.appendChild(br);\r\n\r\n    // get header result\r\n    currForm.appendChild(getHeaderDom('HTTP Header'));\r\n\r\n    var br = document.createElement('BR');\r\n    currForm.appendChild(br);\r\n\r\n     var retHttpHeaders  = '';\r\n\r\n     // iterate over all headers\r\n     for (let [key, value] of response.headers) {\r\n       retHttpHeaders = retHttpHeaders +  `${key} = ${value}` + '\\n';\r\n     }\r\n\r\n    // http header result\r\n    var hdres = document.createElement('pre');\r\n    hdres.setAttribute('class', 'terminus-api-signature-pre');\r\n    var txt = document.createTextNode(retHttpHeaders);\r\n    hdres.appendChild(txt);\r\n\r\n    var cm = stylizeCodeDisplay(terminator, hdres, currForm, 'message/http');\r\n    if(!cm) currForm.appendChild(hdres);\r\n\r\n    return response.json()\r\n    .then(function(response){\r\n      getResponse(currForm, action, response, terminator); // get return response\r\n    })\r\n\r\n} // UTILS.showHttpResult()\r\n\r\n\r\nfunction deleteStylizedEditor(ui, qip){\r\n    if(ui.pluginAvailable(\"codemirror\")){\r\n\t\tvar cm = qip.nextElementSibling;\r\n\t\tcm.setAttribute('class', 'terminus-hide');\r\n\t\tTerminusClient.FrameHelper.removeChildren(cm);\r\n\t}\r\n}\r\n\r\n/* ui: terminus ui reference\r\n   txt: text area to be stylized\r\n   view: defines the size of editor to appear in pages (schema/ query)\r\n   mode: format to be displayed in\r\n*/\r\nfunction stylizeEditor(ui, txt, view, mode){\r\n    var cmConfig = ui.pluginAvailable(\"codemirror\");\r\n    if(!(cmConfig)) return;\r\n\tvar cm = new Codemirror(txt, mode, cmConfig);\r\n\tvar ar = cm.colorizeTextArea(view);\r\n\tcm.updateTextArea(ar);\r\n}\r\n\r\n/* ui: terminus ui reference\r\n   txt: text area to be stylized\r\n   dom: stylized pre area is appended to dom\r\n   mode: format to be displayed in\r\n*/\r\nfunction stylizeCodeDisplay(ui, txt, dom, mode){\r\n    var cmConfig = ui.pluginAvailable(\"codemirror\");\r\n    if(!(cmConfig)) return false;\r\n    var cm = new Codemirror(txt, mode, cmConfig);\r\n    var pr = cm.colorizePre();\r\n    dom.appendChild(pr);\r\n    return true;\r\n}\r\n\r\n/* name: classname to find and remove classes from elements\r\n*/\r\nfunction removeSelectedNavClass(name){\r\n    var el = document.getElementsByClassName(name);\r\n    if (el.length < 1) return;\r\n    for(var i=0; i<(el.length + 1); i++){\r\n        el[i].classList.remove(name);\r\n    }\r\n}\r\n\r\nfunction setSelectedSubMenu(a){\r\n    removeSelectedNavClass(\"terminus-submenu-selected\");\r\n    a.classList.add(\"terminus-submenu-selected\");\r\n}\r\n\r\n// toggles between contents\r\nfunction tolggleContent(icon, content){\r\n    if (content.style.display === \"block\"){\r\n        removeSelectedNavClass(\"fa-chevron-up\");\r\n        icon.classList.add(\"fa-chevron-down\");\r\n        content.style.display = \"none\";\r\n    }\r\n    else{\r\n        removeSelectedNavClass(\"fa-chevron-down\");\r\n        icon.classList.add(\"fa-chevron-up\");\r\n        content.style.display = \"block\";\r\n    }\r\n}\r\n\r\n// controls current selected nav bar\r\nfunction activateSelectedNav(nav, terminator){\r\n    removeSelectedNavClass(\"terminus-selected\");\r\n\t//checkDocumentSubMenus(terminator);\r\n\tnav.classList.add(\"terminus-selected\");\r\n}\r\n\r\nfunction hideDocumentSubMenus(el){\r\n\tif(el.classList.contains('terminus-display')){\r\n\t\tel.classList.remove('terminus-display');\r\n\t\tel.classList.add('terminus-hide');\r\n\t}\r\n}\r\n\r\nfunction checkDocumentSubMenus(terminator){\r\n\tif(terminator.ui.showControl(\"get_document\")) {\r\n\t\tvar gd = document.getElementsByClassName('terminus-get-doc');\r\n\t\thideDocumentSubMenus(gd[0]);\r\n\t}\r\n\tif(terminator.ui.showControl(\"create_document\")) {\r\n\t\tvar cd = document.getElementsByClassName('terminus-create-doc');\r\n\t\thideDocumentSubMenus(cd[0]);\r\n\t}\r\n}\r\n\r\nfunction toggleVisibility(el){\r\n\tif(el.classList.contains('terminus-display')){\r\n\t\tel.classList.remove('terminus-display');\r\n\t\tel.classList.add('terminus-hide');\r\n\t}\r\n    else if(el.classList.contains('terminus-hide')){\r\n        el.classList.remove('terminus-hide');\r\n\t\tel.classList.add('terminus-display');\r\n\t}\r\n}\r\n\r\nfunction extractValueFromCell(cellValue){\r\n    var ihtml = new DOMParser().parseFromString(cellValue, \"text/xml\");\r\n    return ihtml.firstChild.innerHTML;\r\n}\r\n\r\nfunction displayDocumentSubMenus(ui) {\r\n\t//display submenus on click of documents\r\n\tif(ui.showControl(\"get_document\")) {\r\n\t\tvar gd = document.getElementsByClassName('terminus-get-doc');\r\n\t\tshowSubMenus(gd[0]);\r\n\t}\r\n\tif(ui.showControl(\"create_document\")) {\r\n\t\tvar cd = document.getElementsByClassName('terminus-create-doc');\r\n\t\tshowSubMenus(cd[0]);\r\n\t}\r\n}\r\n\r\nfunction checkForMandatoryId(){\r\n    var objId = document.getElementsByClassName('terminus-object-id-input');\r\n    if(objId.length>0){\r\n        if(!objId[0].value){\r\n            objId[0].setAttribute('placeholder', 'Required field');\r\n            objId[0].style.background = '#f8d7da';\r\n            return false;\r\n        }\r\n        else return true;\r\n    }\r\n}\r\n\r\nfunction showSubMenus (el){\r\n\tel.classList.remove('terminus-hide');\r\n\tel.classList.add('terminus-display');\r\n}\r\n\r\n// function which generates query based on current settings from different screens of dashboard\r\nfunction getCurrentWoqlQueryObject(query, settings){\r\n\tvar qval;\r\n    if(!query) query = settings.query;\r\n\tswitch(query){\r\n\t\tcase 'Show_All_Schema_Elements':\r\n\t\t\tqval = TerminusClient.WOQL.limit(settings.pageLength)\r\n                        .start(settings.start)\r\n                        .elementMetadata();\r\n\t\tbreak;\r\n\t\tcase 'Show_All_Classes':\r\n\t\t\tqval = TerminusClient.WOQL.limit(settings.pageLength)\r\n                        .start(settings.start)\r\n                        .classMetadata();\r\n\t\tbreak;\r\n\t\tcase 'Show_All_Data':\r\n\t\t\tqval = TerminusClient.WOQL.limit(settings.pageLength)\r\n                        .start(settings.start)\r\n                        .getEverything();\r\n\t\tbreak;\r\n\t\tcase 'Show_All_Documents':\r\n\t\t\tqval = TerminusClient.WOQL.limit(settings.pageLength)\r\n                        .start(settings.start)\r\n                        .getAllDocuments();\r\n\t\tbreak;\r\n        case 'Show_All_Document_classes':\r\n            qval = TerminusClient.WOQL.limit(settings.pageLength)\r\n                        .start(settings.start)\r\n                        .documentMetadata();\r\n        break;\r\n        case 'Show_Document_Classes':\r\n            qval = TerminusClient.WOQL.limit(settings.pageLength)\r\n                        .start(settings.start).and(\r\n                        TerminusClient.WOQL.quad(\"v:Element\", \"rdf:type\", \"owl:Class\", \"db:schema\"),\r\n                        TerminusClient.WOQL.abstract(\"v:Element\"),\r\n                        TerminusClient.WOQL.sub(\"v:Element\", \"tcs:Document\"),\r\n                        TerminusClient.WOQL.opt().quad(\"v:Element\", \"rdfs:label\", \"v:Label\", \"db:schema\"),\r\n                        TerminusClient.WOQL.opt().quad(\"v:Element\", \"rdfs:comment\", \"v:Comment\", \"db:schema\"));\r\n        break;\r\n        case 'Show_All_Properties':\r\n            qval = TerminusClient.WOQL.limit(settings.pageLength)\r\n                        .start(settings.start)\r\n                        .propertyMetadata();\r\n        break;\r\n\t\tdefault:\r\n\t\t\tconsole.log('Invalid query ' + query + ' passed in WOQLTextboxGenerator');\r\n\t\tbreak;\r\n\t}\r\n\treturn qval;\r\n}\r\n\r\n// removes spaces\r\nfunction trimValue(text){\r\n    (text).replace(/[\\s\\t\\r\\n\\f]/g,'');\r\n    return text;\r\n}\r\n\r\n// query string\r\nfunction getqObjFromInput(q){\r\n    const WOQL = TerminusClient.WOQL ;\r\n    //var query = 'WOQL.' + q;\r\n    var query = q;\r\n    try {\r\n        var qObj = eval(query);\r\n        this.qObj = qObj;\r\n        return qObj;\r\n    }\r\n    catch(e){\r\n        console.log('Error in getting woql object ',e.toString());\r\n    }\r\n}\r\n\r\nmodule.exports={tolggleContent,\r\n               removeSelectedNavClass,\r\n               stylizeCodeDisplay,\r\n               stylizeEditor,\r\n               deleteStylizedEditor,\r\n               showHttpResult,\r\n               getHeaderDom,\r\n               getInfoAlertDom,\r\n               getFunctionSignature,\r\n               toggleVisibility,\r\n               extractValueFromCell,\r\n               displayDocumentSubMenus,\r\n               setSelectedSubMenu,\r\n               checkForMandatoryId,\r\n               activateSelectedNav,\r\n               getCurrentWoqlQueryObject,\r\n               trimValue,\r\n               getqObjFromInput}\r\n","const TerminusClient = require('@terminusdb/terminus-client');\r\nfunction TerminusPluginManager(){\r\n\tthis.preloaded = [];\r\n\tthis.loaded = [];\r\n\tthis.loading = [];\r\n\tthis.precluded = [];\r\n\tthis.plugins = {};\r\n\tthis.plugins[\"font-awesome\"] = {\r\n\t\tlabel: \"Font Awesome\",\r\n\t\tcss: [\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0-11/css/all.css\"]\r\n\t};\r\n\tthis.plugins[\"quill\"] = {\r\n\t\tlabel: \"Quill\",\r\n\t\tjs: [\"https://cdn.quilljs.com/1.3.6/quill.min.js\"],\r\n\t\tcss: [\"https://cdn.quilljs.com/1.3.6/quill.snow.css\"],\r\n\t};\r\n\tthis.plugins[\"codemirror\"] = {\r\n\t\tlabel : \"Code Mirror\",\r\n\t\tjs: [\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/codemirror.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/mode/xml/xml.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/mode/css/css.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/mode/turtle/turtle.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/mode/javascript/javascript.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/addon/hint/anyword-hint.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/addon/hint/show-hint.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/addon/runmode/runmode.js\",\r\n\t\t  \t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/mode/http/http.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/addon/edit/closebrackets.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/addon/edit/matchbrackets.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/addon/display/placeholder.js\"\r\n\t  ],\r\n\t\tcss: [\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/codemirror.css\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/addon/hint/show-hint.css\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/theme/neo.css\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/theme/erlang-dark.css\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/theme/eclipse.css\"\r\n\t\t]\r\n\t};\r\n\tthis.plugins[\"jquery\"] = {\r\n\t\tlabel: \"jQuery\",\r\n\t\tjs: [\"https://code.jquery.com/jquery-2.2.4.min.js\"]\r\n\t};\r\n\tthis.plugins[\"jqueryui\"] = {\r\n\t\tlabel: \"jQuery UI\",\r\n\t\tcss: [\"https://code.jquery.com/ui/1.12.0/themes/smoothness/jquery-ui.css\"],\r\n\t\tjs: [\"https://code.jquery.com/ui/1.12.0/jquery-ui.js\"],\r\n\t\trequires: ['jquery']\r\n\t};\r\n\tthis.plugins[\"datatables\"] = {\r\n\t\tlabel: \"Data Tables\",\r\n\t\tjs: [\"https://cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js\",\r\n\t\t\t \"https://cdn.datatables.net/v/dt/jszip-2.5.0/dt-1.10.16/b-1.5.1/b-html5-1.5.1/datatables.min.js\"],\r\n\t\tcss: [\"https://cdn.datatables.net/1.10.19/css/jquery.dataTables.min.css\"],\r\n\t\trequires: ['jquery']\r\n\t};\r\n\t/*this.plugins[\"prettify\"] = {\r\n\t\tlabel: \"Prettify\",\r\n\t\tjs: [\"https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.js\"],\r\n\t\tcss: [\"https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.css\"],\r\n\t\trequires: ['jquery']\r\n\t};*/\r\n\tthis.plugins[\"gmaps\"] = {\r\n\t\tlabel: \"Google Maps\",\r\n\t\tjs: [\"https://maps.googleapis.com/maps/api/js\"],\r\n\t\t//plugin: \"gmaps.terminus.js\"\r\n\t};\r\n\tthis.plugins[\"d3\"] = {\r\n\t\tlabel: \"d3\",\r\n\t\tjs: [\"https://code.jquery.com/jquery-2.2.4.min.js\"],\r\n\t\trequires: ['jquery']\r\n\t};\r\n\tthis.plugins[\"select2\"] = {\r\n\t\tlabel: \"Select 2\",\r\n\t\tjs: [\"https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.7/js/select2.min.js\"],\r\n\t\tcss: [\"https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.7/css/select2.min.css\"],\r\n\t\trequires: ['jquery']\r\n\t};\r\n\t/*this.plugins[\"jsoneditor\"] = {\r\n\t\tlabel: \"JSON Editor\",\r\n\t\tjs: [\"https://cdnjs.cloudflare.com/ajax/libs/jsoneditor/7.0.4/jsoneditor.min.js\"],\r\n\t\tcss: [\"https://cdnjs.cloudflare.com/ajax/libs/jsoneditor/7.0.4/jsoneditor.min.css\"],\r\n\t\t//plugin: \"jsoneditor.terminus.js\"\r\n\t};\r\n\tthis.plugins[\"bootstrap\"] = {\r\n\t\tlabel: \"Bootstrap\",\r\n\t\tjs: [\"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js\"],\r\n\t\tcss: [\"https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/2.2.2/css/bootstrap.min.css\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/2.2.2/css/bootstrap-responsive.min.css\"]\r\n\t};\r\n\tthis.plugins[\"flot\"] = {\r\n\t\tlabel: \"Flot\",\r\n\t\tjs: [\"https://cdnjs.cloudflare.com/ajax/libs/flot/0.8.3/jquery.flot.min.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/flot/0.8.3/jquery.flot.resize.min.js\"],\r\n\t\trequires: [\"jquery\"]\r\n\t};*/\r\n}\r\n\r\nTerminusPluginManager.prototype.setPluginOptions = function(opts){\r\n\tfor(var p in opts){\r\n\t\tif(!this.plugins[p]) continue;\r\n\t\tfor(var k in opts[p]){\r\n\t\t\tthis.plugins[p][k] = opts[p][k];\r\n\t\t}\r\n\t}\r\n}\r\n\r\nTerminusPluginManager.prototype.init = function(opts, then){\r\n\tif(opts) this.setPluginOptions(opts);\r\n\tthis.calculatePreloaded();\r\n\tvar toload = this.calculateRequiredInitPlugins(opts);\r\n\tif(toload && toload[0].length) {\r\n\t\tif(toload[1].length){\r\n\t\t\tvar self = this;\r\n\t\t\tvar nthen = function(){\r\n\t\t\t\tself.loadPlugins(toload[1], then);\r\n\t\t\t}\r\n\t\t\tthis.loadPlugins(toload[0], nthen);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.loadPlugins(toload[0], then);\r\n\t\t}\r\n\t}\r\n\telse if(then){\r\n\t\tthen();\r\n\t}\r\n}\r\n\r\nTerminusPluginManager.prototype.calculateRequiredInitPlugins = function(opts){\r\n\tif(opts){\r\n\t\tvar pins = [];\r\n\t\tfor(var pid in opts){\r\n\t\t\tif(opts[pid] && pins.indexOf(pid) == -1){\r\n\t\t\t\tif(typeof opts[pid] != \"object\" && opts[pid]){\r\n\t\t\t\t\tpins.push(pid);\r\n\t\t\t\t}\r\n\t\t\t\telse if(typeof opts[pid] == \"object\"){\r\n\t\t\t\t\tif(!(typeof opts[pid].loaded != \"undefined\" && !opts[pid].loaded)){\r\n\t\t\t\t\t\tpins.push(pid);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tvar pins = this.getDefaultPlugins();\r\n\t}\r\n\tvar needed_pins = [];\r\n\tfor(var i = 0; i<pins.length; i++){\r\n\t\tif(this.loaded.indexOf(pins[i]) == -1 && this.preloaded.indexOf(pins[i]) == -1 ){\r\n\t\t\tneeded_pins.push(pins[i])\r\n\t\t}\r\n\t}\r\n\tvar loading_order = [[], []];\r\n\tfor(var i = 0; i<needed_pins.length; i++){\r\n\t\tif(this.plugins[needed_pins[i]]){\r\n\t\t\tif(this.plugins[needed_pins[i]].requires && this.plugins[needed_pins[i]].requires.length){\r\n\t\t\t\tloading_order[1].push(needed_pins[i]);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tloading_order[0].push(needed_pins[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn loading_order;\r\n}\r\n\r\nTerminusPluginManager.prototype.getAvailablePlugins = function(){\r\n\treturn this.plugins;\r\n}\r\n\r\nTerminusPluginManager.prototype.calculatePreloaded = function(){\r\n\tfor(var pl in this.plugins){\r\n\t\tif(this.pluginAvailable(pl)){\r\n\t\t\tthis.preloaded.push(pl);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nTerminusPluginManager.prototype.pluginAvailable = function(plugin, version_check){\r\n\tif(typeof this.plugins[plugin] == \"object\"){\r\n\t\tvar pluginmeta = this.plugins[plugin];\r\n\t\tif(pluginmeta.requires && pluginmeta.requires.length){\r\n\t\t\tfor(var i =0 ; i < pluginmeta.requires.length; i++){\r\n\t\t\t\tif(!this.pluginAvailable(pluginmeta.requires[i], version_check)) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar required_version = (pluginmeta.version ? pluginmeta.version : false);\r\n\t\tswitch(plugin){\r\n\t\t\tcase \"jquery\": {\r\n\t\t\t\tif(typeof jQuery == \"undefined\") return false;\r\n\t\t\t\tif(version_check && required_version){}\r\n\t\t\t\treturn true;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tcase \"jqueryui\": {\r\n\t\t\t\ttry{\r\n\t\t\t\t\tif(typeof jQuery != \"undefined\" && jQuery.isFunction( jQuery.fn.slider )) return true;\r\n\t\t\t\t}\r\n\t\t\t\tcatch(e){}\r\n\t\t\t\treturn false;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tcase \"quill\": {\r\n\t\t\t\tif(typeof Quill == \"undefined\") return false;\r\n\t\t\t\treturn true;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tcase \"jsoneditor\": {\r\n\t\t\t\tif(typeof JSONEditor == \"undefined\") return false;\r\n\t\t\t\treturn true;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tcase \"codemirror\": {\r\n\t\t\t\tif(typeof CodeMirror == \"undefined\") return false;\r\n\t\t\t\treturn this.plugins[plugin];  // sent plugin config with darkmode true/ false\r\n\t\t\t}\r\n\t\t\tcase \"font-awesome\": {\r\n\t\t\t\t//if(typeof CodeMirror != \"undefined\") return true;\r\n\t\t\t\treturn this.fontAwesomeCheck();\r\n\t\t\t}\r\n\t\t\tcase \"datatables\": {\r\n\t\t\t\t if(typeof jQuery != \"undefined\" && jQuery.isFunction( jQuery.fn.dataTable)) return true;\r\n\t\t\t\t return false;\r\n\t\t\t}\r\n\t\t\tcase \"select2\": {\r\n\t\t\t\t if(typeof jQuery != \"undefined\" && jQuery.isFunction( jQuery.fn.select2 )) return true;\r\n\t\t\t\t return false;\r\n\t\t\t}\r\n\t\t\tcase \"gmaps\": {\r\n\t\t\t\tif(typeof google == \"undefined\" || typeof google.maps == \"undefined\") return false;\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\tcase \"openlayers\": {\r\n\t\t\t\tif(typeof ol == \"undefined\" || typeof ol.Map == \"undefined\") return false;\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\tcase \"d3\": {\r\n\t\t\t\tif(typeof d3 == \"undefined\") return false;\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tconsole.log(new Error(plugin + \" is not a supported plugin ID\"));\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nTerminusPluginManager.prototype.fontAwesomeCheck = function(){\r\n\tvar span = document.createElement('span');\r\n\tspan.className = 'fa';\r\n\tspan.style.display = 'none';\r\n\tif(document.body){\r\n\t\tdocument.body.insertBefore(span, document.body.firstChild);\r\n\t\tfunction css(element, property) {\r\n\t\t  return window.getComputedStyle(element, null).getPropertyValue(property);\r\n\t\t}\r\n\t\tvar loaded = false;\r\n\t\tvar fontAwsm = css(span, 'font-family');\r\n\t\tif (fontAwsm.replace(/\"/g, \"\") == 'Font Awesome 5 Free') { // remove double quotes\r\n\t\t\tloaded = true;\r\n\t\t}\r\n\t\tdocument.body.removeChild(span);\r\n\t\treturn loaded;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nTerminusPluginManager.prototype.getDefaultPlugins = function(){\r\n\tvar defplugs = [\"font-awesome\"];\r\n\treturn defplugs;\r\n}\r\n\r\nTerminusPluginManager.prototype.loadPlugins = function(plugins, then){\r\n\tvar ticker = plugins.length;\r\n\tvar cback = function(){\r\n\t\tif(--ticker <= 1 && then){\r\n\t\t\tthen();\r\n\t\t}\r\n\t};\r\n\tfor(var i = 0; i < plugins.length; i++){\r\n\t\tthis.loadPlugin(plugins[i], cback);\r\n\t}\r\n}\r\n\r\nTerminusPluginManager.prototype.loadPlugin = function(plugin, then){\r\n\tvar pug = this.plugins[plugin];\r\n\tif(pug.css){\r\n\t\tfor(var i=0; i<pug.css.length; i++){\r\n\t\t\tvar cssid = plugin + \"_css_\" + i;\r\n\t\t\tTerminusClient.FrameHelper.loadDynamicCSS(cssid, pug.css[i]);\r\n\t\t}\r\n\t}\r\n\tvar scripts = (pug.js ? pug.js : []);\r\n\tif(plugin == \"gmaps\" && pug.key){\r\n\t\tscripts[0] += \"?key=\" + pug.key;\r\n\t}\r\n\tif(pug.plugin){\r\n\t\t//scripts.push(\"plugins/\" + pug.plugin);\r\n\t}\r\n\tif(plugin == \"codemirror\"){\r\n\t\tvar cm = scripts[0];\r\n\t\tvar sid = plugin + \"_js_\" + (scripts.length -1);\r\n\t\tscripts.splice(0, 1);\r\n\t\tvar self = this;\r\n\t\tvar cback = function(){\r\n\t\t\tself.loadPluginScripts(plugin, scripts, then);\r\n\t\t}\r\n\t\tTerminusClient.FrameHelper.loadDynamicScript(sid, cm, cback);\r\n\t}\r\n\telse {\r\n\t\tthis.loadPluginScripts(plugin, scripts, then);\r\n\t}\r\n}\r\n\r\nTerminusPluginManager.prototype.loadPluginScripts = function(plugin, scripts, then){\r\n\tvar ticker = scripts.length - 1;\r\n\tvar self = this;\r\n\tvar cback = function(){\r\n\t\tif(ticker == 0) {\r\n\t\t\tif(self.loaded.indexOf(plugin) == -1){\r\n\t\t\t\tself.loaded.push(plugin);\r\n\t\t\t}\r\n\t\t\tif(self.loading.indexOf(plugin) != -1){\r\n\t\t\t\tself.loading.splice(self.loading.indexOf(plugin), 1);\r\n\t\t\t}\r\n\t\t\tthen();\r\n\t\t}\r\n\t\tticker--;\r\n\t};\r\n\tif(scripts.length == 0){\r\n\t\tthis.loaded.push(plugin);\r\n\t}\r\n\telse {\r\n\t\tthis.loading.push(plugin);\r\n\t}\r\n\tfor(var i = 0; i<scripts.length; i++){\r\n\t\tvar sid = plugin + \"_js_\" + i;\r\n\t\tTerminusClient.FrameHelper.loadDynamicScript(sid, scripts[i], cback);\r\n\t}\r\n}\r\n\r\nTerminusPluginManager.prototype.loadPageCSS = function(css){\r\n\tcssfid = \"terminus_client_css\";\r\n\tvar cssdom = document.getElementById(cssfid);\r\n\tif(cssdom){\r\n\t\tcssdom.parentNode.removeChild(cssdom);\r\n\t}\r\n\tif(css){\r\n\t\tcssurl = \"css/\" + css + \".css\";\r\n\t\tTerminusClient.FrameHelper.loadDynamicCSS(cssfid, cssurl);\r\n\t}\r\n}\r\n\r\nTerminusPluginManager.prototype.pluginLoadable = function(pid){\r\n\treturn (this.precluded.indexOf(pid) !== -1 || this.pluginLoadedOrLoading(pid));\r\n}\r\n\r\nTerminusPluginManager.prototype.pluginLoadedOrLoading = function(pid){\r\n\tif(this.loaded.indexOf(pid) != -1) return true;\r\n\tif(this.preloaded.indexOf(pid) != -1) return true;\r\n\tif(this.loading.indexOf(pid) != -1) return true;\r\n\treturn false;\r\n}\r\n\r\nTerminusPluginManager.prototype.disabled = function(pid, obj){\r\n\tif(this.precluded.indexOf(pid) != -1) return true;\r\n\tif(obj.requires){\r\n\t\tfor(var i = 0; i<obj.requires.length; i++){\r\n\t\t\tif(!this.pluginLoadedOrLoading(obj.requires[i])) return true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nTerminusPluginManager.prototype.getPluginDOM = function(plugid, obj, ui){\r\n\tvar a = document.createElement(\"a\");\r\n\tvar cl = document.createElement(\"span\");\r\n\ta.appendChild(cl);\r\n\tcl.setAttribute(\"class\", \"terminus-plugin-control\");\r\n\tvar cbox = document.createElement(\"input\");\r\n\tcbox.id = \"terminus-plugin-control-\" + plugid;\r\n\tcbox.type = \"checkbox\";\r\n\tif(this.preloaded.indexOf(plugid) != -1){\r\n\t\tcbox.checked = true;\r\n\t\tcbox.disabled = true;\r\n\t}\r\n\telse if(this.loaded.indexOf(plugid) != -1){\r\n\t\tcbox.checked = true;\r\n\t}\r\n\telse if(this.loading.indexOf(plugid) != -1){\r\n\t\tcbox.checked = true;\r\n\t}\r\n\telse if(this.disabled(plugid, obj)){\r\n\t\tcbox.disabled = true;\r\n\t}\r\n\tvar clab = document.createElement(\"label\");\r\n\tclab.setAttribute(\"class\", \"terminus-plugin-label terminus-pointer\");\r\n\tclab.setAttribute(\"for\", cbox.id);\r\n\tclab.appendChild(document.createTextNode(obj.label));\r\n\tcl.appendChild(clab);\r\n\tcl.appendChild(cbox);\r\n\tvar self = this;\r\n\tcbox.addEventListener(\"change\", function(){\r\n\t\tself.togglePlugin(plugid, ui);\r\n\t});\r\n\treturn a;\r\n}\r\n\r\nTerminusPluginManager.prototype.togglePlugin = function(plugid, ui){\r\n\tif(this.loaded.indexOf(plugid) == -1){\r\n\t\tvar then = function(){\r\n\t\t\tui.redraw();\r\n\t\t}\r\n\t\tthis.loadPlugin(plugid, then);\r\n\t}\r\n\telse {\r\n\t\tthis.unloadPlugin(plugid);\r\n\t}\r\n\tTerminusClient.FrameHelper.removeChildren(ui.plugins);\r\n\tui.drawPlugins();\r\n}\r\n\r\nTerminusPluginManager.prototype.unloadPlugin = function(plugid){\r\n\tif(!this.plugins[plugid] || this.loaded.indexOf(plugid) == -1) {\r\n\t\tconsole.log(new Error(plugid + \" plugin unload request when it is not loaded\"));\r\n\t\treturn false;\r\n\t}\r\n\tvar pug = this.plugins[plugid];\r\n\tvar num = (pug.js) ? pug.js.length : 0;\r\n\tif(pug.plugin) num++;\r\n\tfor(var i=0; i< num; i++){\r\n\t\tvar cssfid = plugid + \"_js_\" + i;\r\n\t\tvar cssdom = document.getElementById(cssfid);\r\n\t\tif(cssdom){\r\n\t\t\tcssdom.parentNode.removeChild(cssdom);\r\n\t\t}\r\n\t}\r\n\tnum = (pug.css ? pug.css.length : 0);\r\n\tfor(var i=0; i< num; i++){\r\n\t\tvar cssfid = plugid + \"_css_\" + i;\r\n\t\tvar cssdom = document.getElementById(cssfid);\r\n\t\tif(cssdom){\r\n\t\t\tcssdom.parentNode.removeChild(cssdom);\r\n\t\t}\r\n\t}\r\n\tthis.loaded.splice(this.loaded.indexOf(plugid), 1);\r\n}\r\n\r\nTerminusPluginManager.prototype.getAsDOM = function(ui){\r\n\tvar dm = document.createElement(\"span\");\r\n\tdm.setAttribute(\"class\", \"terminus-plugin-manager\");\r\n\tvar clh = document.createElement(\"span\");\r\n\tclh.setAttribute(\"class\", \"terminus-plugin-control-header terminus-plugin-nav terminus-pointer\");\r\n\tclh.appendChild(document.createTextNode(\"Plugins\"));\r\n\tdm.appendChild(clh);\r\n\tvar a = document.createElement('a');\r\n\tthis.showPlugins(a, ui);\r\n\tclh.appendChild(a);\r\n\ta.style.display = 'none';\r\n\tclh.addEventListener('click', function(){\r\n\t\tif(a.style.display == 'none')\r\n\t\t\ta.style.display = 'block';\r\n\t\telse a.style.display = 'none';\r\n\t})\r\n\treturn dm;\r\n}\r\n\r\nTerminusPluginManager.prototype.showPlugins = function(a, ui){\r\n\ta.setAttribute('style', 'background-color: #111;');\r\n\tfor(var pid in this.plugins){\r\n\t\ta.appendChild(this.getPluginDOM(pid, this.plugins[pid], ui));\r\n\t}\r\n}\r\n\r\nmodule.exports=TerminusPluginManager\r\n","function getErrorAsMessage(url, api, err) {\r\n\t// console.log('getErrorAsMessage');\r\n\tlet str = '';\r\n\tif (err.response) {\r\n\t\terr = err.response;\r\n\t\tif (err.data) str += `${formatErrorMessage(err.data)}`;\r\n\t} else if (err.body) str += `${formatErrorMessage(err.data)}`;\r\n\r\n\tif (err.status) str += `Code: ${err.status}`;\r\n\tif (err.action) str += `, Action: ${err.action}`;\r\n\tif (err.type) str += `, Type: ${err.type}`;\r\n\tif (url) str += `, url: ${url}`;\r\n\tif (api && api.method) str += `, method: ${api.method}`;\r\n\treturn str;\r\n}\r\n\r\nfunction formatErrorMessage(msg) {\r\n\tif (typeof msg === 'object') {\r\n\t\tlet nmsg = '';\r\n\t\tfor (const key of Object.keys(msg)) {\r\n\t\t\tnmsg += `${key} ${msg[key]} `;\r\n\t\t}\r\n\t\treturn nmsg;\r\n\t}\r\n\treturn msg;\r\n}\r\n\r\nfunction accessDenied(action, db, server) {\r\n\tconst err = {};\r\n\terr.status = 403;\r\n\terr.url = (server || '') + (db || '');\r\n\terr.type = 'client';\r\n\terr.action = action;\r\n\terr.body = `${err.action} not permitted for ${err.url}`;\r\n\treturn err;\r\n}\r\n\r\nfunction getAPIErrorMessage(url, api, err) {\r\n\treturn `API Error ${getErrorAsMessage(url, api, err)}`;\r\n}\r\n\r\nfunction getAccessDeniedMessage(url, api, err) {\r\n\treturn `Access Denied ${getErrorAsMessage(url, api, err)}`;\r\n}\r\n\r\nfunction getInvalidURIMessage(url, call) {\r\n\tconst str = `Invalid argument to\r\n            ${call}. \r\n            ${url}\r\n            is not a valid Terminus DB API endpoint`;\r\n\treturn str;\r\n}\r\n\r\n/**\r\n * Utility functions for generating and retrieving error messages\r\n * and storing error state\r\n */\r\n\r\nfunction parseAPIError(response) {\r\n\tconst err = {};\r\n\terr.status = response.status;\r\n\terr.type = response.type;\r\n\tif (response.data && typeof response.data === 'object') {\r\n\t\tlet msg;\r\n\t\ttry {\r\n\t\t\tmsg = response.text();\r\n\t\t} catch (e) {\r\n\t\t\ttry {\r\n\t\t\t\tmsg = response.json();\r\n\t\t\t} catch (error) {\r\n\t\t\t\tmsg = response.toString();\r\n\t\t\t}\r\n\t\t}\r\n\t\terr.body = msg;\r\n\t} else if (response.data) err.body = response.data;\r\n\terr.url = response.url;\r\n\terr.headers = response.headers;\r\n\terr.redirected = response.redirected;\r\n\treturn err;\r\n}\r\n\r\n\r\nmodule.exports = {\r\n\tgetErrorAsMessage,\r\n\tgetAPIErrorMessage,\r\n\tgetAccessDeniedMessage,\r\n\taccessDenied,\r\n\tgetInvalidURIMessage,\r\n\tparseAPIError\r\n};\r\n","/**\r\n * Helper functions for dealing with frames and linked data documents\r\n */\r\nconst FrameHelper = {\r\n\tstandard_urls: {\r\n\t\trdf: 'http://www.w3.org/1999/02/22-rdf-syntax-ns#',\r\n\t\trdfs: 'http://www.w3.org/2000/01/rdf-schema#',\r\n\t\txsd: 'http://www.w3.org/2001/XMLSchema#',\r\n\t\towl: 'http://www.w3.org/2002/07/owl#',\r\n\t\ttcs: 'http://terminusdb.com/schema/tcs#',\r\n\t\ttbs: 'http://terminusdb.com/schema/tbs#',\r\n\t\txdd: 'http://terminusdb.com/schema/xdd#',\r\n\t\tv: 'http://terminusdb.com/woql/variable/',\r\n\t\tterminus: 'http://terminusdb.com/schema/terminus#',\r\n\t\tvio: 'http://terminusdb.com/schema/vio#',\r\n\t\tdocs: 'http://terminusdb.com/schema/documentation#'\r\n\t}\r\n};\r\n\r\nFrameHelper.addURLPrefix = function (prefix, url) {\r\n\tthis.standard_urls[prefix] = url;\r\n};\r\n\r\n\r\nFrameHelper.removeChildren = function (node) {\r\n\tif (node) {\r\n\t\twhile (node.hasChildNodes()) {\r\n\t\t\tnode.removeChild(node.childNodes[0]);\r\n\t\t}\r\n\t}\r\n};\r\n\r\nFrameHelper.empty = function (obj) {\r\n\t   // null and undefined are \"empty\"\r\n\tif (!obj) return true;\r\n\t// Assume if it has a length property with a non-zero value\r\n\t// that that property is correct.\r\n\tif (obj.length > 0) return false;\r\n\tif (obj.length === 0) return true;\r\n\t// Otherwise, does it have any properties of its own?\r\n\t// Note that this doesn't handle\r\n\t// toString and valueOf enumeration bugs in IE < 9\r\n\t// for (const key in obj) {\r\n\tif (typeof obj === 'object') {\r\n\t\tfor (const key of Object.keys(obj)) {\r\n\t\t\tif (Object.prototype.hasOwnProperty.call(obj, key)) return false;\r\n\t\t}\r\n\t}\r\n\treturn true;\r\n};\r\n\r\nFrameHelper.genBNID = function () {\r\n\tconst r = Math.random().toString(36).substring(7);\r\n\tconst d = new Date();\r\n\tconst bnid = `_:${r}${d.getTime()}`;\r\n\treturn bnid;\r\n};\r\n\r\nFrameHelper.getShorthand = function (link) {\r\n\tif (typeof link === 'object' && link.length) link = link[0];\r\n\tif (link && typeof link === 'string') {\r\n\t\tfor (const pref of Object.keys(this.standard_urls)) {\r\n\t\t\tconst full = this.standard_urls[pref];\r\n\t\t\tif (link.substring(0, full.length) === full) {\r\n\t\t\t\tconst sh = `${pref}:${link.substring(full.length)}`;\r\n\t\t\t\treturn sh;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nFrameHelper.compareIDs = function (ida, idb) {\r\n\tif (ida === idb) return true;\r\n\tif (this.unshorten(ida) === idb) return true;\r\n\tif (this.unshorten(ida) === this.unshorten(idb)) return true;\r\n\tconst sha = this.getShorthand(ida);\r\n\tconst shb = this.getShorthand(idb);\r\n\tif (sha && ((sha === idb) || (sha === shb))) return true;\r\n\tif (shb && shb === ida) return true;\r\n\treturn false;\r\n};\r\n\r\n\r\n\r\nFrameHelper.shorten = function(url, prefixes){\r\n\tfor(var pref in prefixes){\r\n\t\tif(prefixes[pref] == url.substring(0, prefixes[pref].length)){\r\n\t\t\treturn ( pref + \":\" + url.substring(prefixes[pref].length));\r\n\t\t}\r\n\t}\r\n\treturn url;\r\n}\r\n\r\nFrameHelper.unshorten = function (url) {\r\n\tif (this.validURL(url)) return url;\r\n\tif (!url) return url;\r\n\tconst bits = url.split(':');\r\n\tif (bits[1]) {\r\n\t\tif (this.standard_urls[bits[0]]) {\r\n\t\t\treturn this.standard_urls[bits[0]] + bits[1];\r\n\t\t}\r\n\t}\r\n\treturn url;\r\n};\r\n\r\n// Valid URLs are those that start with http:// or https://\r\nFrameHelper.validURL = function (str) {\r\n\tif (str && (str.substring(0, 7) === 'http://' || str.substring(0, 8) === 'https://')) return true;\r\n\treturn false;\r\n};\r\n\r\n\r\nFrameHelper.labelFromURL = function (url) {\r\n\tlet nurl = this.urlFragment(url);\r\n\tnurl = (nurl || url);\r\n\tif (nurl.lastIndexOf('/') < nurl.length - 1) {\r\n\t\tnurl = nurl.substring(nurl.lastIndexOf('/') + 1);\r\n\t}\r\n\tnurl = nurl.replace('_', ' ');\r\n\treturn nurl.charAt(0).toUpperCase() + nurl.slice(1);\r\n};\r\n\r\nFrameHelper.urlFragment = function (url) {\r\n\turl = (typeof url !== 'string') ? window.location.href : url;\r\n\tlet bits = url.split('#');\r\n\tif (bits.length <= 1) {\r\n\t\tif (!this.validURL(url)) {\r\n\t\t\tbits = url.split(':');\r\n\t\t}\r\n\t}\r\n\tif (bits.length >= 1) {\r\n\t\tconst [, urlStr] = bits;\r\n\r\n\t\tif (urlStr) {\r\n\t\t\tconst [baseUrl] = urlStr.split('?');\r\n\t\t\turl = baseUrl;\r\n\t\t}\r\n\t}\r\n\treturn url;\r\n};\r\n\r\nFrameHelper.isStringType = function (stype) {\r\n\tif (stype === 'http://www.w3.org/2001/XMLSchema#string') return true;\r\n\tif (stype === 'xsd:string') return true;\r\n\treturn false;\r\n};\r\n\r\nFrameHelper.lastURLBit = function (url) {\r\n\turl = (typeof url === 'undefined') ? window.location.href : url;\r\n\tconst [urlFirst] = url.split('#');\r\n\tconst [urlTmp] = urlFirst.split('?');\r\n\turl = urlTmp.substring(url.lastIndexOf('/') + 1);\r\n\treturn url;\r\n};\r\n\r\n\r\nFrameHelper.getStdURL = function (pref, ext, url) {\r\n\tif (this.standard_urls[pref]) {\r\n\t\tif (url) {\r\n\t\t\tif (url === this.standard_urls[pref] + ext) return url;\r\n\t\t} else {\r\n\t\t\treturn this.standard_urls[pref] + ext;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nFrameHelper.viewIncludesProperties = function (view) {\r\n\tif (view === 'full' || view === 'production' || view === 'terse') {\r\n\t\treturn true;\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nFrameHelper.viewIncludesChildren = function (view, type) {\r\n\treturn this.viewIncludesProperties(view, type);\r\n};\r\n\r\nFrameHelper.viewIncludesValue = function (view, type) {\r\n\treturn this.viewIncludesProperties(view, type);\r\n};\r\n\r\nFrameHelper.numberWithCommas = function (value) {\r\n\tif (value >= 1000 || value <= -1000) {\r\n\t    const parts = value.toString().split('.');\r\n\t    if (value <= -1000) parts[0] = parts[0].substring(1);\r\n\t    parts[0] = parts[0].replace(/\\B(?=(\\d{3})+(?!\\d))/g, ',');\r\n\t    if (value <= -1000) value = `-${parts.join('.')}`;\r\n\t    else value = parts.join('.');\r\n\t}\r\n\treturn value;\r\n};\r\n\r\nFrameHelper.datatypes = [\r\n\t'xdd:coordinate', 'xdd:coordinatePolyline',\r\n\t'xdd:coordinatePolygon', 'xdd:dateRange', 'xdd:gYearRange', 'xdd:integerRange',\r\n\t'xdd:decimalRange', 'xdd:cc', 'xdd:email', 'xdd:html', 'xdd:url', 'xsd:anySimpleType',\r\n\t'xsd:string', 'xsd:boolean', 'xsd:decimal', 'xsd:double', 'xsd:float', 'xsd:time', 'xsd:date',\r\n\t'xsd:dateTime', 'xsd:dateTimeStamp', 'xsd:gYear', 'xsd:gMonth', 'xsd:gDay', 'xsd:gYearMonth',\r\n\t'xsd:gMonthDay', 'xsd:duration', 'xsd:yearMonthDuration', 'xsd:dayTimeDuration',\r\n\t'xsd:byte', 'xsd:short', 'xsd:integer', 'xsd:long', 'xsd:unsignedByte',\t'xsd:unsignedInt',\r\n\t'xsd:unsignedLong',\t'xsd:nonNegativeInteger', 'xsd:positiveInteger', 'xsd:negativeInteger',\r\n\t'xsd:nonPositiveInteger', 'xsd:base64Binary', 'xsd:anyURI', 'xsd:language', 'xsd:normalizedString',\r\n\t'xsd:token', 'xsd:NMTOKEN',\t'xsd:Name',\t'xsd:NCName', 'xsd:NOTATION', 'xsd:QName', 'xsd:ID',\r\n\t'xsd:IDREF', 'xsd:ENTITY', 'rdf:XMLLiteral', 'rdf:PlainLiteral', 'rdfs:Literal', 'xdd:json'\r\n];\r\n\r\nFrameHelper.parseDate = function (ty, value) {\r\n\tlet parsed;\r\n\tif (ty === 'xsd:date') {\r\n\t\tparsed = this.parseXsdDate(value);\r\n\t} else if (ty === 'xsd:time') {\r\n\t\tparsed = this.parseXsdTime(value);\r\n\t} else if (ty === 'xsd:dateTime') {\r\n\t\tparsed = this.parseXsdDateTime(value);\r\n\t} else if (ty === 'xsd:gYear') {\r\n\t\tparsed = { year: value };\r\n\t} else if (ty === 'xsd:gYearRange') {\r\n\t\tparsed = { year: value };\r\n\t} else if (ty === 'xsd:gMonth') {\r\n\t\tparsed = { month: value.substring(2) };\r\n\t} else if (ty === 'xsd:gDay') {\r\n\t\tparsed = { day: value };\r\n\t} else if (ty === 'xsd:gYearMonth') {\r\n\t\tconst bits = value.split('-');\r\n\t\twhile (bits.length < 2) bits.push('');\r\n\t\tparsed = { year: bits[0], month: bits[1] };\r\n\t} else if (ty === 'xsd:gMonthDay') {\r\n\t\tconst bits = value.split('-');\r\n\t\twhile (bits.length < 2) bits.push('');\r\n\t\tparsed = { month: bits[0], day: bits[1] };\r\n\t} else if (ty === 'xsd:dateTimeStamp') {\r\n\t\tparsed = this.parseXsdDateTime(value);\r\n\t}\r\n\treturn parsed;\r\n};\r\n\r\nFrameHelper.parseXsdDate = function (val) {\r\n\tconst tz = this.extractXsdTimezone(val);\r\n\tif (tz) {\r\n\t\tval = val.substring(0, val.length - tz.length);\r\n\t}\r\n\tlet year;\r\n\tif (val.substring(0, 1) === '-') {\r\n\t\tyear = val.substring(0, 5);\r\n\t} else {\r\n\t\tyear = val.substring(0, 4);\r\n\t}\r\n\tlet parsed;\r\n\tif (year && Math.abs(year) < 10000) {\r\n\t\tlet month = val.substring(year.length + 1, year.length + 3);\r\n\t\tif (month) { month = parseInt(month, 10); } else return false;\r\n\t\tlet day = val.substring(year.length + 4);\r\n\t\tif (day) day = parseInt(day, 10);\r\n\t\telse return false;\r\n\t\tparsed = {\r\n\t\t\tyear,\r\n\t\t\t   month,\r\n\t\t\t   day,\r\n\t\t\t   timezone: tz\r\n\t\t};\r\n\t}\r\n\treturn parsed;\r\n};\r\n\r\nFrameHelper.addXsdPadding = function (parsed) {\r\n\tconst nparsed = {};\r\n\tif (typeof parsed.year !== 'undefined' && parsed.year !== false && parsed.year < 1000) {\r\n\t\tif (Math.abs(parsed.year) < 10) nparsed.year = (parsed.year < 0 ? `-000${Math.abs(parsed.year)}` : `000${parsed.year}`);\r\n\t\telse if (Math.abs(parsed.year) < 100) nparsed.year = (parsed.year < 0 ? `-00${Math.abs(parsed.year)}` : `00${parsed.year}`);\r\n\t\telse nparsed.year = (parsed.year < 0 ? `-0${Math.abs(parsed.year)}` : `0${parsed.year}`);\r\n\t} else if (parsed.year) {\r\n\t\tnparsed.year = parsed.year;\r\n\t}\r\n\tif (typeof parsed.month !== 'undefined' && parsed.month !== false && parsed.month < 10) {\r\n\t\tnparsed.month = `0${parsed.month}`;\r\n\t} else if (parsed.month) {\r\n\t\tnparsed.month = parsed.month;\r\n\t}\r\n\tif (typeof parsed.day !== 'undefined' && parsed.day !== false && parsed.day < 10) {\r\n\t\tnparsed.day = `0${parsed.day}`;\r\n\t} else if (parsed.day) {\r\n\t\tnparsed.day = parsed.day;\r\n\t}\r\n\tif (typeof parsed.hour !== 'undefined' && parsed.hour !== false && parsed.hour < 10) {\r\n\t\tnparsed.hour = `0${parsed.hour}`;\r\n\t} else if (parsed.hour) {\r\n\t\tnparsed.hour = parsed.hour;\r\n\t}\r\n\tif (typeof parsed.minute !== 'undefined' && parsed.minute !== false && parsed.minute < 10) {\r\n\t\tnparsed.minute = `0${parsed.minute}`;\r\n\t} else if (parsed.minute) {\r\n\t\tnparsed.minute = parsed.minute;\r\n\t}\r\n\tif (typeof parsed.second !== 'undefined' && parsed.second !== false && parsed.second < 10) {\r\n\t\tnparsed.second = `0${parsed.second}`;\r\n\t} else if (parsed.second) {\r\n\t\tnparsed.second = parsed.second;\r\n\t}\r\n\treturn nparsed;\r\n};\r\n\r\n\r\nFrameHelper.xsdFromParsed = function (parsed, ty) {\r\n\tconst xparsed = this.addXsdPadding(parsed);\r\n\tlet ret;\r\n\tif (ty === 'xsd:gYear') {\r\n\t\tret = (xparsed.year ? xparsed.year : false);\r\n\t} else if (ty === 'xsd:time') {\r\n\t\treturn (xparsed.hour && xparsed.minute && xparsed.second) ? `${xparsed.hour}:${xparsed.minute}:${xparsed.second}` : false;\r\n\t} else if (ty === 'xsd:date') {\r\n\t\treturn (xparsed.year && xparsed.month && xparsed.day) ? `${xparsed.year}-${xparsed.month}-${xparsed.day}` : false;\r\n\t} else if (ty === 'xsd:dateTime' || ty === 'xsd:dateTimeStamp') {\r\n\t\tret = (xparsed.year && xparsed.month && xparsed.day) ? `${xparsed.year}-${xparsed.month}-${xparsed.day}T` : false;\r\n\t\tif (ret) ret += `${xparsed.hour ? xparsed.hour : '12'}:${xparsed.minute ? xparsed.minute : '00'}:${xparsed.second ? xparsed.second : '00'}`;\r\n\t} else if (ty === 'xsd:gMonth') {\r\n\t\tret = (xparsed.month ? `--${xparsed.month}` : false);\r\n\t} else if (ty === 'xsd:gDay') {\r\n\t\tret = (xparsed.day ? `---${xparsed.day}` : false);\r\n\t} else if (ty === 'xsd:gYearMonth') {\r\n\t\tret = (xparsed.year && xparsed.month) ? `${xparsed.year}-${xparsed.month}` : false;\r\n\t} else if (ty === 'xsd:gMonthDay') {\r\n\t\tret = (xparsed.day && xparsed.month) ? `--${xparsed.month}-${xparsed.day}` : false;\r\n\t}\r\n\tif (xparsed.timezone) {\r\n\t\tret += xparsed.timezone;\r\n\t}\r\n\treturn ret;\r\n};\r\n\r\n\r\nFrameHelper.parseXsdTime = function (val) {\r\n\tif (!val) return {};\r\n\tconst tz = this.extractXsdTimezone(val);\r\n\tif (tz) {\r\n\t\tval = val.substring(0, val.length - tz.length);\r\n\t}\r\n\tconst parsed = {\r\n\t\thour: val.substring(0, 2),\r\n\t\tminute: val.substring(3, 5),\r\n\t\tsecond: val.substring(6),\r\n\t\ttimezone: tz\r\n\t};\r\n\treturn parsed;\r\n};\r\n\r\nFrameHelper.convertTimestampToXsd = function (val) {\r\n\t  const a = new Date(val * 1000);\r\n\t  const parsed = {\r\n\t\tyear: a.getFullYear(),\r\n\t\tmonth: a.getMonth() + 1,\r\n\t\tday: a.getDate(),\r\n\t\thour: a.getHours(),\r\n\t\tminute: a.getMinutes(),\r\n\t\tsecond: a.getSeconds()\r\n\t  };\r\n\t  return parsed;\r\n};\r\n\r\nFrameHelper.parseXsdDateTime = function (val) {\r\n\tif (!val) return {};\r\n\tif (typeof val === 'number') {\r\n\t\treturn this.convertTimestampToXsd(val);\r\n\t}\r\n\tconst tz = this.extractXsdTimezone(val);\r\n\tif (tz) {\r\n\t\tval = val.substring(0, val.length - tz.length);\r\n\t}\r\n\tconst datetime = this.parseXsdDate(val);\r\n\tconst ptime = this.parseXsdTime(val.substring(val.indexOf('T') + 1));\r\n\r\n\tfor (const i of Object.keys(ptime)) {\r\n\t\tdatetime[i] = ptime[i];\r\n\t}\r\n\tdatetime.timezone = tz;\r\n\treturn datetime;\r\n};\r\n\r\nFrameHelper.extractXsdTimezone = function (val) {\r\n\tif (val && val.charAt(val.length - 1) === 'Z') {\r\n\t\treturn 'Z';\r\n\t}\r\n\tif (val && (val.charAt(val.length - 6) === '+' || val.charAt(val.length - 6) === '-')) {\r\n\t\tval.substring(val.length - 6);\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nFrameHelper.parseRangeValue = function (val, dividor) {\r\n\tdividor = (dividor || ',');\r\n\tlet vals = [];\r\n\tif (typeof val === 'object' && val.length) {\r\n\t\tvals = val;\r\n\t} else if (val) {\r\n\t\tif (typeof val !== 'string') {\r\n\t\t\tval = `${val}`;\r\n\t\t}\r\n\t\tif (val.length && (val.charAt(0) === '[') && val.charAt(val.length - 1) === ']') {\r\n\t\t\tvals.push(val.substring(1, val.indexOf(dividor)));\r\n\t\t\tvals.push(val.substring(val.indexOf(dividor) + 1, val.length - 1));\r\n\t\t} else {\r\n\t\t\tvals.push(val);\r\n\t\t}\r\n\t}\r\n\treturn vals;\r\n};\r\n\r\nFrameHelper.loadDynamicScript = function (scriptid, src, callback) {\r\n\tconst existingScript = document.getElementById(scriptid);\r\n\tif (!existingScript) {\r\n\t\tconst script = document.createElement('script');\r\n\t\tscript.src = src; // URL for the third-party library being loaded.\r\n\t\tdocument.body.appendChild(script);\r\n\t\tscript.onload = function () {\r\n\t\t\tscript.id = scriptid; // do it here so it doesn't trigger the callback below on multiple calls\r\n\t\t\tif (callback) callback(scriptid);\r\n\t\t};\r\n\t}\r\n\tif (existingScript && callback) {\r\n\t\tcallback(scriptid);\r\n\t}\r\n};\r\n\r\nFrameHelper.loadDynamicCSS = function (cssid, src, callback) {\r\n\tconst existingScript = document.getElementById(cssid);\r\n\tif (!existingScript) {\r\n\t\tconst link = document.createElement('link');\r\n\t\tlink.href = src; // URL for the third-party library being loaded.\r\n\t\tlink.id = cssid; // e.g., googleMaps or stripe\r\n\t\tlink.rel = 'stylesheet';\r\n\t\tdocument.body.appendChild(link);\r\n\t\tlink.onload = function () {\r\n\t\t\tif (callback) callback(cssid);\r\n\t\t};\r\n\t}\r\n\tif (existingScript && callback) callback(cssid);\r\n};\r\n\r\nmodule.exports = FrameHelper;\r\n","const WOQLResult = require('./WOQLResultsViewer');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\nfunction WOQLQuery(client, options, ui){\r\n\tthis.client = client;\r\n\tthis.options = options;\r\n\tthis.ui = ui;\r\n\tthis.default_limit = 1000;\r\n\tthis.prefixes = {};\r\n\tif(client.connectionConfig.platformEndpoint()){\r\n\t\tvar sid = client.connectionConfig.server.substring(0, client.connectionConfig.server.lastIndexOf(\"platform\"));\r\n\t\tthis.sid = sid;\r\n\t\tvar colid = client.connectionConfig.server.substring(0, client.connectionConfig.server.lastIndexOf(\"platform\")) + client.connectionConfig.dbid;\r\n\t\tthis.prefixes['s'] = colid + \"/ontology/main#\";\r\n\t\tthis.prefixes['g'] = sid;\r\n\t\tthis.prefixes['db'] = colid + \"/\";\r\n\t\tthis.prefixes['doc'] = colid + \"/candidate/\";\r\n\t\tthis.prefixes['dg'] = colid + \"/graph/main/\";\r\n\t}\r\n\telse {\r\n\t\tthis.sid = client.connectionConfig.serverURL();\r\n\t\tthis.prefixes['s'] = client.connectionConfig.schemaURL() + \"#\";\r\n\t\tthis.prefixes['dg'] = client.connectionConfig.dbURL() + \"/schema\";\r\n\t\tthis.prefixes['doc'] = client.connectionConfig.docURL();\r\n\t\tthis.prefixes['db'] = client.connectionConfig.dbURL() + \"/\";\r\n\t\tthis.prefixes['g'] = client.connectionConfig.serverURL();\r\n\t}\r\n\tfor(var pref in TerminusClient.FrameHelper.standard_urls){\r\n\t\tthis.prefixes[pref] = TerminusClient.FrameHelper.standard_urls[pref];\r\n\t}\r\n}\r\n\r\nWOQLQuery.prototype.setPrefixes = function(prefixes){\r\n\tthis.prefixes = prefixes;\r\n}\r\n\r\n\r\nWOQLQuery.prototype.shorten = function(url){\r\n\tfor(var pref in this.prefixes){\r\n\t\tif(this.prefixes[pref] == url.substring(0, this.prefixes[pref].length)){\r\n\t\t\treturn ( pref + \":\" + url.substring(this.prefixes[pref].length));\r\n\t\t}\r\n\t}\r\n\treturn url;\r\n}\r\n\r\nWOQLQuery.prototype.execute = function(woql){\r\n\tvar wrapped = this.wrap(woql);\r\n\tvar self = this;\r\n\treturn this.client.select(false, wrapped)\r\n\t.then(function(response){\r\n\t\tvar res = new WOQLResult.WOQLResult(response, self, self.options, self.ui);\r\n\t\treturn res;\r\n\t});\r\n}\r\n\r\nWOQLQuery.prototype.wrap = function(woql){\r\n\tvar wjson = {\r\n\t\t\"@context\" : this.prefixes,\r\n\t\t\"from\": [\r\n\t\t\tthis.client.connectionConfig.dbURL(),\r\n\t\t\twoql\r\n\t\t]\r\n\t};\r\n\treturn wjson;\r\n}\r\n\r\nWOQLQuery.prototype.getConcreteDocumentClassPattern = function(varc){\r\n\tvar varc = varc || \"v:Class\";\r\n\tvar pat = {\r\n\t\tand: [\r\n\t\t\tthis.getSubclassQueryPattern(varc, \"tcs:Document\"),\r\n\t\t\t{\r\n\t\t\t\tnot: [this.getAbstractQueryPattern(varc)]\r\n\t\t\t}\r\n\t\t]\r\n\t}\r\n\treturn pat;\r\n}\r\n\r\nWOQLQuery.prototype.getAbstractQueryPattern = function(varname){\r\n\tvar qp = {\r\n\t\tquad: [varname, \"tcs:tag\", \"tcs:abstract\", \"db:schema\"]\r\n\t}\r\n\treturn qp;\r\n}\r\n\r\nWOQLQuery.prototype.getSubclassQueryPattern = function(varname, clsname){\r\n\tvar sqp = {sub: [varname, clsname]};\r\n\treturn sqp;\r\n}\r\n\r\nWOQLQuery.prototype.queryWrappedWithLimit = function(query, limit, start){\r\n\tlimit = limit ? limit : this.default_limit ;\r\n\tstart = start ? start : 0;\r\n\tvar wjson = {\r\n\t\tlimit: [limit, {\r\n\t\t\tstart: [start, query]\r\n\t\t}]\r\n\t};\r\n\treturn wjson;\r\n}\r\n\r\n//getAllDocuments\r\nWOQLQuery.prototype.getAllDocumentQuery = function(constraint, limit, start){\r\n\tvar query = {\r\n\t\tand: [\r\n\t\t\t{\r\n\t\t\t\ttriple: [\"v:Document\", \"rdf:type\", \"v:Type\"]\r\n\t\t\t},\r\n\t\t\tthis.getSubclassQueryPattern(\"v:Type\", \"tcs:Document\")\r\n\t\t]\r\n\t}\r\n\tif(constraint){\r\n\t\tquery.and.push(constraint);\r\n\t}\r\n\treturn this.queryWrappedWithLimit(query, limit, start);\r\n}\r\n\r\n//getEverything\r\nWOQLQuery.prototype.getEverythingQuery = function(constraint, limit, start){\r\n\tvar wjson = {triple: [\"v:Subject\", \"v:Predicate\", \"v:Object\"]};\r\n\tif(constraint){\r\n\t\twjson = {and: [wjson, constraint]};\r\n\t}\r\n\treturn this.queryWrappedWithLimit(wjson, limit, start);\r\n}\r\n\r\n// propertyMetadata\r\nWOQLQuery.prototype.getPropertyListQuery = function(constraint, limit, start){\r\n\tvar wjson = {\r\n\t\tand: [{quad: [\"v:Property\", \"rdfs:range\", \"v:Range\", \"db:schema\"]},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Property\", \"rdf:type\", \"v:Type\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Property\", \"rdfs:label\", \"v:Label\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Property\", \"rdfs:comment\", \"v:Comment\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Property\", \"rdfs:domain\", \"v:Domain\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t]\r\n\t}\r\n\tif(constraint){\r\n\t\twjson = {and: [wjson, constraint]};\r\n\t}\r\n\treturn this.queryWrappedWithLimit(wjson, limit, start);\r\n}\r\n\r\n// elementMetadata() in new woql query\r\nWOQLQuery.prototype.getElementMetaDataQuery = function(constraint, limit, start){\r\n\tvar wjson = {\r\n\t\tand: [{quad: [\"v:Element\", \"rdf:type\", \"v:Type\", \"db:schema\"]},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Element\", \"rdfs:label\", \"v:Label\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Element\", \"rdfs:comment\", \"v:Comment\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Element\", \"tcs:tag\", \"v:Abstract\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Element\", \"rdfs:domain\", \"v:Domain\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Element\", \"rdfs:range\", \"v:Range\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t]\r\n\t}\r\n\tif(constraint){\r\n\t\twjson = {and: [wjson, constraint]};\r\n\t}\r\n\treturn this.queryWrappedWithLimit(wjson, limit, start);\r\n}\r\n\r\n// classMetadata in new woql client\r\nWOQLQuery.prototype.getClassListMetaDataQuery = function(constraint, limit, start){\r\n\tvar wjson = {\r\n\t\tand: [{quad: [\"v:Element\", \"rdf:type\", \"owl:Class\", \"db:schema\"]},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Element\", \"rdfs:label\", \"v:Label\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Element\", \"rdfs:comment\", \"v:Comment\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Element\", \"tcs:tag\", \"v:Abstract\", \"db:schema\"]}]\r\n\t\t\t}\r\n\t\t]\r\n\t}\r\n\tif(constraint){\r\n\t\twjson = {and: [wjson, constraint]};\r\n\t}\r\n\treturn this.queryWrappedWithLimit(wjson, limit, start);\r\n}\r\n\r\n// classMetadata\r\nWOQLQuery.prototype.getClassMetaDataQuery = WOQLQuery.prototype.getClassListMetaDataQuery;\r\n\r\nWOQLQuery.prototype.getDataOfChosenClassQuery = function(chosen, limit, start){\r\n\tvar wjson = {\r\n\t\tand: [{triple: [\"v:Document\", \"rdf:type\", chosen]},\r\n\t\t\t{\r\n\t\t\t\topt: [{triple: [\"v:Document\", \"v:Property\", \"v:Value\"]}]\r\n\t\t\t}\r\n\t\t]\r\n\t}\r\n\treturn this.queryWrappedWithLimit(wjson, limit, start);\r\n}\r\n\r\nWOQLQuery.prototype.getDataOfChosenPropertyQuery = function(chosen, limit, start){\r\n\tvar wjson = {\r\n\t\tand: [{triple: [\"v:Document\", chosen, \"v:Value\"]},\r\n\t\t\t{\r\n\t\t\t\topt: [{triple: [\"v:Document\", \"rdfs:label\", \"v:Label\"]}]\r\n\t\t\t}\r\n\t\t]\r\n\t}\r\n\treturn this.queryWrappedWithLimit(wjson, limit, start);\r\n}\r\n\r\nWOQLQuery.prototype.getInstanceMeta = function(url, limit, start){\r\n\tvar wjson = {\r\n\t\tand: [\r\n\t\t\t{triple: [url, \"rdfs:label\", \"v:InstanceLabel\"]},\r\n\t\t\t{triple: [url, \"rdf:type\", \"v:InstanceType\"]},\r\n\t\t\t{\r\n\t\t\t\topt: [{triple: [url, \"rdfs:comment\", \"v:InstanceComment\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:InstanceType\", \"rdfs:label\", \"v:ClassLabel\", \"db:schema\"]}]\r\n\t\t\t}\r\n\t\t]\r\n\t}\r\n\treturn this.queryWrappedWithLimit(wjson, limit, start);\r\n}\r\n\r\n\r\nWOQLQuery.prototype.getDocumentQuery = function(id, limit, start){\r\n\tvar wjson = {\r\n\t\tand: [\r\n\t\t\t{triple: [id, \"v:Property\", \"v:Property_Value\"]},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Property\", \"rdfs:label\", \"v:Property_Label\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Property\", \"rdf:type\", \"v:Property_Type\", \"db:schema\"]}]\r\n\t\t\t}\r\n\t\t]\r\n\t}\r\n\treturn this.queryWrappedWithLimit(wjson, limit, start);\r\n}\r\n\r\n//documentMetadata\r\nWOQLQuery.prototype.getClassesQuery = function(limit, start){\r\n\tvar wjson = {\r\n\t\tand: [\r\n\t\t\t{triple: [\"v:ID\", \"rdf:type\", \"v:Class\"]},\r\n\t\t\t{\r\n\t\t\t\topt: [{triple: [\"v:ID\", \"rdfs:label\", \"v:Label\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\topt: [{triple: [\"v:ID\", \"rdfs:comment\", \"v:Comment\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Class\", \"rdfs:label\", \"v:Type\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tsub: ['v:Class', 'tcs:Document']\r\n\t\t\t}\r\n\t\t]\r\n\t}\r\n\treturn this.queryWrappedWithLimit(wjson, limit, start);\r\n}\r\n\r\nmodule.exports=WOQLQuery\r\n","const ObjectViewer= require(\"../html/document/ObjectViewer\")\r\nconst HTMLStringViewer = require('../html/datatypes/String');\r\nconst HTMLStringEditor = require('../html/datatypes/StringEditor');\r\nconst HTMLBooleanViewer = require('../html/datatypes/Boolean');\r\nconst HTMLBooleanEditor = require('../html/datatypes/BooleanEditor');\r\nconst HTMLChoiceViewer = require('../html/datatypes/Choice');\r\nconst HTMLChoiceEditor = require('../html/datatypes/ChoiceEditor');\r\nconst HTMLCoordinateViewer = require('../html/datatypes/Coordinate');\r\nconst HTMLCoordinateEditor = require('../html/datatypes/CoordinateEditor');\r\nconst HTMLDateViewer = require('../html/datatypes/Date');\r\nconst HTMLDateEditor = require('../html/datatypes/DateEditor');\r\nconst HTMLEntityViewer = require('../html/datatypes/Entity');\r\nconst HTMLEntityEditor = require('../html/datatypes/EntityEditor');\r\nconst HTMLImageViewer = require('../html/datatypes/Image');\r\nconst HTMLImageEditor = require('../html/datatypes/ImageEditor');\r\nconst HTMLLinkViewer = require('../html/datatypes/Link');\r\nconst HTMLNumberViewer = require('../html/datatypes/Number');\r\nconst HTMLRangeViewer = require('../html/datatypes/Range');\r\nconst HTMLRangeEditor = require('../html/datatypes/RangeEditor');\r\nconst SantizedHTMLViewer = require('../html/datatypes/SanitizedHTML');\r\nconst GoogleMapEditor = require('../html/datatypes/GoogleMapEditor');\r\nconst GoogleMapViewer = require('../html/datatypes/GoogleMapViewer');\r\nconst HTMLMarkupEditor = require('../html/datatypes/HTMLMarkupEditor');\r\nconst S2EntityEditor = require('../html/datatypes/S2EntityEditor');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nlet RenderingMap = {\r\n\tregisteredDataViewers: {},\r\n\tregisteredDataEditors: {},\t\r\n\tgetValidDataViewerList: function(type, frametype){\r\n\t\tvar valids = ['HTMLStringViewer'];\r\n\t\tif(frametype && typeof this.registeredDataViewers[frametype] != \"undefined\"){\r\n\t\t\tvalids = valids.concat(this.registeredDataViewers[frametype]);\r\n\t\t}\r\n\t\tif(typeof this.registeredDataViewers[type] != \"undefined\"){\r\n\t\t\tvalids = valids.concat(this.registeredDataViewers[type]);\r\n\t\t}\r\n\t\treturn valids;\r\n\t},\r\n\tgetValidDataEditorList: function(type, frametype){\r\n\t\tvar valids = ['HTMLStringEditor'];\r\n\t\tif(frametype && typeof this.registeredDataEditors[frametype] != \"undefined\"){\r\n\t\t\tvar nftypes = this.registeredDataEditors[frametype];\r\n\t\t\tif(nftypes){\r\n\t\t\t\tfor(var i = 0; i<nftypes.length; i++){\r\n\t\t\t\t\tif(valids.indexOf(nftypes[i]) == -1) valids.push(nftypes[i]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(typeof this.registeredDataEditors[type] != \"undefined\"){\r\n\t\t\tvalids = valids.concat(this.registeredDataEditors[type]);\r\n\t\t}\r\n\t\treturn valids;\r\n\t},\r\n\tgetViewer: function(type, options, datatype){\r\n\t\tvar vi = this.renderers[type];\r\n\t\toptions = (options ? options: {});\r\n\t\ttry {\r\n\t\t\tvar viewer = eval(\"new \" + type + \".\" + type + \"(\" + JSON.stringify(options) + \")\");\r\n\t\t\tif(datatype) viewer.type = datatype;\r\n\t\t\treturn viewer;\r\n\t\t}\r\n\t\tcatch(e){\r\n\t\t\talert(\"failed on create \" + e.toString());\r\n\t\t}\r\n\t},\r\n\tgetAvailableDataViewers: function(type, frametype){\r\n\t\tvar viewers = [];\r\n\t\tvar nviewers = []\r\n\t\tvar opts = this.getValidDataViewerList(type, frametype);\r\n\t\tfor(var i = 0; i<opts.length; i++){\r\n\t\t\tif(nviewers.indexOf(opts[i]) == -1) {\r\n\t\t\t\tnviewers.push(opts[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor(var i = 0; i<nviewers.length; i++){\r\n\t\t\tif(this.renderers[nviewers[i]]){\r\n\t\t\t\tvar sets = this.renderers[nviewers[i]];\r\n\t\t\t\tviewers.push({value: nviewers[i], label: sets.label});\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn viewers;\r\n\t},\r\n\tgetAvailableDataEditors: function(type, frametype){\r\n\t\tvar viewers = [];\r\n\t\tvar nviewers = []\r\n\t\tvar opts = this.getValidDataEditorList(type, frametype);\r\n\t\tfor(var i = 0; i<opts.length; i++){\r\n\t\t\tif(nviewers.indexOf(opts[i]) == -1) {\r\n\t\t\t\tnviewers.push(opts[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor(var i = 0; i<nviewers.length; i++){\r\n\t\t\tif(this.renderers[nviewers[i]]){\r\n\t\t\t\tvar sets = this.renderers[nviewers[i]];\r\n\t\t\t\tviewers.push({value: nviewers[i], label: sets.label});\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn viewers;\r\n\t},\r\n\tgetViewerForDataFrame: function(type, frametype){\r\n\t\tvar vals = this.getValidDataViewerList(type, frametype);\r\n\t\treturn vals[vals.length-1];\r\n\t},\r\n\tgetEditorForDataFrame: function(type, frametype){\r\n\t\tvar vals = this.getValidDataEditorList(type, frametype);\r\n\t\treturn vals[vals.length-1];\r\n\t},\r\n\tregisterViewerForTypes: function(viewer, label, types){\r\n\t\tfor(var i = 0; i < types.length; i++){\r\n\t\t\tif(typeof this.registeredDataViewers[types[i]] == \"undefined\"){\r\n\t\t\t\tthis.registeredDataViewers[types[i]] = [];\r\n\t\t\t}\r\n\t\t\tif(this.registeredDataViewers[types[i]].indexOf(viewer) == -1){\r\n\t\t\t\tthis.registeredDataViewers[types[i]].push(viewer);\r\n\t\t\t\tthis.renderers[viewer] = {label: label};\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tregisterEditorForTypes: function(viewer, label, types){\r\n\t\tfor(var i = 0; i < types.length; i++){\r\n\t\t\tif(typeof this.registeredDataEditors[types[i]] == \"undefined\"){\r\n\t\t\t\tthis.registeredDataEditors[types[i]] = [];\r\n\t\t\t}\r\n\t\t\tif(this.registeredDataEditors[types[i]].indexOf(viewer) == -1){\r\n\t\t\t\tthis.registeredDataEditors[types[i]].push(viewer);\r\n\t\t\t\tthis.renderers[viewer] = {label: label};\r\n\t\t\t}\t\t\t\r\n\t\t}\r\n\t},\r\n\tregisterEditorForFrameType: function(viewer, label, frametype){\r\n\t\tthis.renderers[viewer] = {label: label};\r\n\t\tif(typeof this.registeredDataEditors[frametype] == \"undefined\") this.registeredDataEditors[frametype] = [];\r\n\t\tif(this.registeredDataEditors[frametype].indexOf(viewer) == -1){\r\n\t\t\tthis.registeredDataEditors[frametype].push(viewer);\r\n\t\t}\r\n\t},\r\n\tregisterViewerForFrameType: function(viewer, label, frametype){\r\n\t\tthis.renderers[viewer] = {label: label};\r\n\t\tif(typeof this.registeredDataViewers[frametype] == \"undefined\") this.registeredDataViewers[frametype] = [];\r\n\t\tif(this.registeredDataViewers[frametype].indexOf(viewer) == -1){\r\n\t\t\tthis.registeredDataViewers[frametype].push(viewer);\r\n\t\t}\r\n\t},\r\n\trenderers: {\r\n\t\tHTMLStringViewer: { label: \"String Viewer\"},\r\n\t\tHTMLStringEditor: { label: \"String Editor\"},\r\n\t}\r\n}\r\n\r\nRenderingMap.addPlugin = function(plugin){\r\n\tif(plugin == \"gmaps\"){\r\n\t\tthis.registerEditorForTypes(\"GoogleMapEditor\", \"Google Map Editor\", [\"xdd:coordinate\", \"xdd:coordinatePolyline\", \"xdd:coordinatePolygon\"]);\r\n\t\tthis.registerViewerForTypes(\"GoogleMapViewer\", \"Google Map Editor\", [\"xdd:coordinate\", \"xdd:coordinatePolyline\", \"xdd:coordinatePolygon\"]);\r\n\t}\r\n\tif(plugin == \"quill\"){\r\n\t\tthis.registerEditorForTypes(\"HTMLMarkupEditor\", \"Quill WYSIWIG HTML Editor\", [\"xdd:html\"]);\r\n\t}\r\n\tif(plugin == \"select2\"){\r\n\t\tRenderingMap.registerEditorForFrameType(\"S2EntityEditor\", \"S2 Autocomplete Selector\", \"document\");\r\n\t}\r\n\tif(plugin == \"jsoneditor\"){\r\n\t\tRenderingMap.registerEditorForFrameType(\"S2EntityEditor\", \"S2 Autocomplete Selector\", \"document\");\r\n\t}\r\n}\r\n\r\nRenderingMap.decorateRenderer = function(options, renderer){\r\n\tvar compiled_options = this.compileOptions(options, renderer);\r\n\tif(compiled_options && compiled_options.mode){\r\n\t\trenderer.mode = compiled_options.mode;\r\n\t}\r\n\telse {\r\n\t\tif(renderer.parent && renderer.parent.mode) renderer.mode = renderer.parent.mode;\r\n\t\telse renderer.mode = \"view\";\r\n\t}\r\n\tif(compiled_options && compiled_options.view){\r\n\t\trenderer.view = compiled_options.view;\r\n\t}\r\n\telse {\r\n\t\tif(renderer.parent && renderer.parent.view) renderer.view = renderer.parent.view;\r\n\t\telse renderer.view = \"full\";\r\n\t}\r\n\tif(compiled_options && compiled_options.facets){\r\n\t\trenderer.facets = compiled_options.facets;\r\n\t}\r\n\telse {\r\n\t\trenderer.facets = renderer.getDefaultFacets();\r\n\t}\r\n\tif(compiled_options && compiled_options.facet && typeof renderer.facets[compiled_options.facet] == \"object\"){\r\n\t\trenderer.facet = compiled_options.facet;\r\n\t}\t\r\n\telse {\r\n\t\tvar deffacet = renderer.getDefaultFacet();\r\n\t\tif(typeof renderer.facets[deffacet] == \"object\"){\r\n\t\t\trenderer.facet = deffacet;\r\n\t\t}\r\n\t\telse {\r\n\t\t\trenderer.facet = key(renderer.facets);\r\n\t\t}\r\n\t}\r\n\tif(compiled_options && compiled_options.hide_disabled_buttons){\r\n\t\trenderer.hide_disabled_buttons = compiled_options.hide_disabled_buttons;\r\n\t}\r\n\telse if(renderer.parent) renderer.hide_disabled_buttons = parent.hide_disabled_buttons;\r\n\telse renderer.hide_disabled_buttons = true;\r\n\tif(compiled_options && typeof compiled_options.features == \"object\"){\r\n\t\trenderer.features = compiled_options.features;\r\n\t}\r\n\telse {\r\n\t\trenderer.features = renderer.facets[renderer.facet].features;\r\n\t\t//renderer.features = renderer.getDefaultFeatures(renderer.facet);\r\n\t}\r\n\tif(compiled_options && typeof compiled_options.controls == \"object\"){\r\n\t\trenderer.controls = compiled_options.controls;\r\n\t}\r\n\telse {\r\n\t\trenderer.controls = renderer.facets[renderer.facet].controls;\r\n\t\t//renderer.controls = renderer.getDefaultControls();\r\n\t}\r\n\tif(compiled_options && typeof compiled_options.viewerType != \"undefined\"){\r\n\t\trenderer.viewerType = compiled_options.viewerType;\r\n\t\tif(compiled_options.viewerOptions)\r\n\t\t\trenderer.viewerOptions = compiled_options.viewerOptions;\r\n\t}\r\n\tif(compiled_options && typeof compiled_options.header != \"undefined\"){}\r\n\telse {\r\n\t\trenderer.header_viewer = new ObjectViewer.HTMLObjectHeaderViewer();\r\n\t}\r\n\tif(compiled_options && typeof compiled_options.filter != \"undefined\"){}\r\n\telse {}\r\n\tif(compiled_options && typeof compiled_options.sort != \"undefined\"){}\r\n\telse {}\r\n\treturn options;\r\n}\t\r\n\r\nRenderingMap.compileOptions = function(options, renderer){\r\n\tvar compiled_options = {};\r\n\tvar rules = [];\r\n\tfor(var key in options){\r\n\t\tif(key != \"rules\"){\r\n\t\t\tcompiled_options[key] = options[key];\r\n\t\t}\r\n\t}\r\n\tif(options.rules){\r\n\t\tfor(var i = 0; i<options.rules.length; i++){\r\n\t\t\tvar match = (!options.rules[i].pattern || this.patternMatchesRenderer(options.rules[i].pattern, renderer));\r\n\t\t\tif(match && options.rules[i].output){\r\n\t\t\t\tfor(var k in options.rules[i].output){\r\n\t\t\t\t\tcompiled_options[k] = options.rules[i].output[k];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn compiled_options;\r\n}\r\n\r\nRenderingMap.registerViewerForTypes(\"HTMLBooleanViewer\", \"Checkbox Viewer\", [\"xsd:boolean\"]);\r\nRenderingMap.registerEditorForTypes(\"HTMLBooleanEditor\", \"Checkbox Editor\", [\"xsd:boolean\"]);\r\nRenderingMap.registerViewerForFrameType(\"HTMLChoiceViewer\", \"Choice Viewer\", \"oneOf\");\r\nRenderingMap.registerEditorForFrameType(\"HTMLChoiceEditor\", \"Choice Selector\", \"oneOf\");\r\nRenderingMap.registerViewerForTypes(\"HTMLCoordinateViewer\", \"Coordinate Viewer\", [\"xdd:coordinate\", \"xdd:coordinatePolyline\", \"xdd:coordinatePolygon\"]);\r\nRenderingMap.registerEditorForTypes(\"HTMLCoordinateEditor\", \"Coordinate Editor\", [\"xdd:coordinate\", \"xdd:coordinatePolyline\", \"xdd:coordinatePolygon\"]);\r\nRenderingMap.registerViewerForTypes(\"HTMLDateViewer\", \"Date Viewer\", [\"xsd:time\", \"xsd:date\", \"xsd:dateTime\", \"xsd:gYear\", \r\n\t\"xsd:gYearRange\", \"xsd:gMonth\", \"xsd:gDay\", \"xsd:gYearMonth\", \"xsd:gMonthDay\", \"xsd:dateTimeStamp\"]);\r\nRenderingMap.registerEditorForTypes(\"HTMLDateEditor\", \"Date Editor\", [\"xsd:time\", \"xsd:date\", \"xsd:dateRange\" ,\"xsd:dateTime\", \"xsd:gYear\", \r\n\t\"xsd:gYearRange\", \"xsd:gMonth\", \"xsd:gDay\", \"xsd:gYearMonth\", \"xsd:gMonthDay\", \"xsd:dateTimeStamp\"]);\r\nRenderingMap.registerViewerForFrameType(\"HTMLEntityViewer\", \"Document Viewer\", \"document\");\r\nRenderingMap.registerEditorForFrameType(\"HTMLEntityEditor\", \"Document Selector\", \"document\");\r\nRenderingMap.registerViewerForTypes(\"HTMLImageViewer\", \"Image Viewer\", [\"xdd:url\", \"xsd:anyURI\", \"xsd:base64Binary\"]);\r\nRenderingMap.registerEditorForTypes(\"HTMLImageEditor\", \"Image Editor\", [\"xsd:base64Binary\"]);\r\nRenderingMap.registerViewerForTypes(\"HTMLImageViewer\", \"Image Viewer\", [\"xdd:url\", \"xsd:anyURI\", \"xsd:base64Binary\"]);\r\nRenderingMap.registerEditorForTypes(\"HTMLImageEditor\", \"Image Editor\", [\"xsd:base64Binary\"]);\r\nRenderingMap.registerViewerForTypes(\"HTMLLinkViewer\", \"Link Viewer\", [\"xdd:url\", \"xsd:anyURI\"]);\r\nRenderingMap.registerViewerForTypes(\"HTMLNumberViewer\", \"Number with commas\", \r\n\t\t[\"xsd:decimal\", \"xsd:double\", \"xsd:float\", \"xsd:short\", \"xsd:integer\", \"xsd:long\", \r\n\t\t\t\"xsd:nonNegativeInteger\", \"xsd:positiveInteger\", \"xsd:negativeInteger\", \"xsd:nonPositiveInteger\"]);\r\nRenderingMap.registerViewerForTypes(\"HTMLRangeViewer\", \"Range Viewer\", [\"xdd:gYearRange\", \"xdd:dateRange\", \"xdd:integerRange\", \"xdd:decimalRange\"]);\r\nRenderingMap.registerEditorForTypes(\"HTMLRangeEditor\", \"Range Editor\", [\"xdd:gYearRange\", \"xdd:dateRange\", \"xdd:integerRange\", \"xdd:decimalRange\"]);\r\nRenderingMap.registerViewerForTypes(\"SantizedHTMLViewer\", \"Sanitized HTML\", [\"xsd:string\", \"xdd:html\"]);\r\n\r\nmodule.exports=RenderingMap\r\n\r\n\r\n","\r\nmodule.exports = Object.freeze({\r\n\tCONNECT: 'connect',\r\n\tGET_SCHEMA: 'get_schema',\r\n\tUPDATE_SCHEMA: 'update_schema',\r\n\tUPDATE_DOCUMENT: 'update_document',\r\n\tCLASS_FRAME: 'class_frame',\r\n\tWOQL_SELECT: 'woql_select',\r\n\tGET_DOCUMENT: 'get_document',\r\n\tDELETE_DATABASE: 'delete_database',\r\n\tDELETE_DOCUMENT: 'delete_document',\r\n\tCREATE_DATABASE: 'create_database',\r\n\tCREATE_DOCUMENT: 'create_document',\r\n\tWOQL_UPDATE: 'woql_update'\r\n});\r\n\r\n/*\r\n{\"extends\": \"strongloop\",\r\n  \"env\": {\r\n\t\t\"browser\": true,\r\n\t\t\"node\": true,\r\n\t\t\"es6\": true\r\n  },\r\n  \"rules\":{\"max-len\": [\"error\", { \"code\": 100 }]},\r\n \"parserOptions\": { \"ecmaVersion\": 6 }}\r\n*/\r\n","function authorityActionsToArr(action) {\r\n\tif (Array.isArray(action) === false) return [];\r\n\r\n\treturn action.map(item => item['@id']);\r\n}\r\n\r\nfunction URIEncodePayload(payload) {\r\n\tif (typeof payload === 'string') return encodeURIComponent(payload);\r\n\tconst payloadArr = [];\r\n\tfor (const key of Object.keys(payload)) {\r\n\t\tif (typeof payload[key] === 'object') {\r\n\t\t\tfor (const keyElement of Object.keys(payload[key])) {\r\n\t\t\t\t const valueElement = payload[key][keyElement];\r\n\t\t\t\t payloadArr.push(`${encodeURIComponent(keyElement)}=${encodeURIComponent(valueElement)}`);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tpayloadArr.push(`${encodeURIComponent(key)}=${encodeURIComponent(payload[key])}`);\r\n\t\t}\r\n\t}\r\n\treturn payloadArr.join('&');\r\n}\r\n\r\nmodule.exports = { authorityActionsToArr, URIEncodePayload };\r\n","/**\r\n * Object for producing a HTML view of a given object in a frame\r\n */\r\nconst HTMLFrameHelper = require('../HTMLFrameHelper');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction HTMLObjectViewer(renderer){\r\n\tthis.properties = [];\r\n}\r\n\r\n/**\r\n * Functions for rendering / re-rendering the object as header and body components\r\n */\r\nHTMLObjectViewer.prototype.render = function(renderer){\r\n\tthis.renderer = renderer;\r\n\tthis.headerViewer = new HTMLObjectHeaderViewer();\r\n\tif(this.renderedDOM){\r\n\t\t//var renderedDOM = this.getObjectDOM();\r\n\t\t//this.renderedDOM.replaceWith(renderedDOM);\r\n\t\t//this.renderedDOM = renderedDOM;\r\n\t}\r\n\telse {\r\n\t\t//this.renderedDOM = this.getObjectDOM();\r\n\t}\r\n\t//this.renderedDOM.appendChild(this.getObjectIDMarker(this.renderer));\r\n\tif(this.headerViewer){\r\n\t\tthis.header = this.headerViewer.getAsDOM(this.renderer);\r\n\t\tif(this.header) this.renderedDOM.appendChild(this.header);\r\n\t}\r\n\tthis.body = this.getObjectBodyDOM();\r\n\tif(this.body) this.renderedDOM.appendChild(this.body);\r\n\treturn this.renderedDOM;\r\n}\r\n\r\nHTMLObjectViewer.prototype.getObjectDOM = function(){\r\n\tvar orientation = this.renderer.getContentOrientation();\r\n\tvar pcls = \"terminus-object-frame-\" + orientation;\r\n\tif(orientation == \"page\"){\r\n\t\tvar sp = document.createElement(\"div\");\r\n\t}\r\n\telse {\r\n\t\tvar sp = document.createElement(\"span\");\r\n\t}\r\n\tvar css = \"terminus-object-frame \" + pcls + (this.renderer.parent ? \"\" : \" terminus-root-frame\") + \" terminus-object-frame-\" + this.renderer.mode;\r\n\tsp.setAttribute(\"class\", css);\r\n\tsp.setAttribute(\"data-class\", this.renderer.subjectClass());\r\n\tsp.setAttribute(\"data-id\", this.renderer.subject());\r\n\treturn sp;\r\n}\r\n\r\nHTMLObjectViewer.prototype.getObjectBodyDOM = function(){\r\n\tvar orientation = \"page\";//this.renderer.getContentOrientation();\r\n\tvar pcls = \"terminus-object-properties-\" + orientation;\r\n\tif(orientation == \"page\"){\r\n\t\tvar vholder = document.createElement(\"div\");\r\n\t}\r\n\telse {\r\n\t\tvar vholder = document.createElement(\"span\");\r\n\t}\r\n    vholder.setAttribute('class', 'terminus-object-properties ' + pcls);\r\n    for(var prop in this.properties){\r\n\t\tif(this.properties[prop]) vholder.appendChild(this.properties[prop]);\r\n\t}\r\n\treturn vholder;\r\n}\r\n\r\nHTMLObjectViewer.prototype.getFeatureDOM = function(feature){\r\n\tif(this.hasFeatureViewer(feature)){\r\n\t\treturn this.featureViewer[feature](this.renderer, this);\r\n\t}\r\n}\r\n\r\nHTMLObjectViewer.prototype.redraw = function(){\r\n\tTerminusClient.FrameHelper.removeChildren(this.renderedDOM);\r\n\tthis.properties = [];\r\n\tthis.renderer.render(this);\r\n}\r\n\r\nHTMLObjectViewer.prototype.redrawHeader = function(){\r\n\tif(this.headerViewer && this.header) {\r\n\t\tvar nheader = this.headerViewer.getAsDOM(this.renderer);\r\n\t\tthis.header.replaceWith(nheader);\r\n\t\tthis.header = nheader;\r\n\t}\r\n}\r\n\r\nHTMLObjectViewer.prototype.redrawBody = function(){\r\n\tif(this.body){\r\n\t\tvar nbody = this.getObjectBodyDOM();\r\n\t\tthis.body.replaceWith(nbody);\r\n\t\tthis.body = nbody;\r\n\t}\r\n}\r\n\r\n/**\r\n * Adds a rendered version of a property to the internal properties array\r\n */\r\nHTMLObjectViewer.prototype.addRenderedProperty = function(prop, renderedprop){\r\n\tthis.properties[prop] = renderedprop;\r\n}\r\n\r\nHTMLObjectViewer.prototype.clear = function(){\r\n\tTerminusClient.FrameHelper.removeChildren(this.renderedDOM);\r\n\tthis.properties = {};\r\n}\r\n\r\n/**\r\n * Removes the object from the dom\r\n */\r\nHTMLObjectViewer.prototype.remove = function(){\r\n\tthis.renderedDOM.parentNode.removeChild(this.renderedDOM);\r\n}\r\n\r\nHTMLObjectViewer.prototype.goTo = function(subj, property){\r\n\tHTMLFrameHelper.goToName(subj, property);\r\n}\r\n\r\n/**\r\n * Generates a html anchor element to use as a marker to find the object on the page\r\n */\r\nHTMLObjectViewer.prototype.getObjectIDMarker = function(renderer){\r\n\tvar idm = document.createElement(\"a\");\r\n\tidm.setAttribute(\"class\", \"terminus-object-idmarker\");\r\n\tvar sh = TerminusClient.FrameHelper.getShorthand(renderer.subject());\r\n    if(!sh) sh = renderer.subject();\r\n    if(sh){\r\n\t\tvar bits = sh.split(\":\");\r\n\t\tif(bits.length > 1) sh = bits[1];\r\n\t\tidm.setAttribute(\"name\", sh);\r\n    }\r\n\treturn idm;\r\n}\r\n\r\nfunction HTMLObjectHeaderViewer(){}\r\n\r\nHTMLObjectHeaderViewer.prototype.getAsDOM = function(renderer){\r\n\tvar orientation = renderer.getContentOrientation();\r\n\tvar pcls = \"terminus-object-frame-btn terminus-object-header-\" + orientation;\r\n\tif(orientation == \"page\"){\r\n\t\tvar objDOM = document.createElement(\"div\");\r\n\t}\r\n\telse {\r\n\t\tvar objDOM = document.createElement(\"span\");\r\n\t}\r\n\tobjDOM.setAttribute(\"class\", \"terminus-object-header \" + pcls);\r\n\tif(renderer.showFeature(\"facet\")){\r\n\t\tvar facetDOM = this.getObjectFacetDOM(renderer);\r\n\t\tif(facetDOM) objDOM.appendChild(facetDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"label\")){\r\n\t\tvar sumDOM = this.getObjectLabelDOM(renderer);\r\n\t\tif(sumDOM) objDOM.appendChild(sumDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"id\")){\r\n\t\tvar idDOM = this.getObjectIDDOM(renderer);\r\n\t\tif(idDOM) objDOM.appendChild(idDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"type\")){\r\n\t\tvar typeDOM = this.getObjectTypeDOM(renderer);\r\n\t\tif(typeDOM) objDOM.appendChild(typeDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"status\")){\r\n\t\tvar sumDOM = this.getObjectStatusDOM(renderer);\r\n\t\tif(sumDOM) objDOM.appendChild(sumDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"view\")){\r\n\t\tvar viewDOM = this.getViewPropertyDOM(renderer);\r\n\t\tif(viewDOM) objDOM.appendChild(viewDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"viewer\")){\r\n\t\tvar hideDOM = this.getViewerSelectorDOM(renderer);\r\n\t\tif(hideDOM) objDOM.appendChild(hideDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"control\")){\r\n\t\tvar controlsDOM = this.getObjectControlsDOM(renderer);\r\n\t\tif(controlsDOM) objDOM.appendChild(controlsDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"summary\")){\r\n\t\tvar controlsDOM = this.getObjectSummaryDOM(renderer);\r\n\t\tif(controlsDOM) objDOM.appendChild(controlsDOM);\r\n\t}\r\n\treturn objDOM;\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectSummaryDOM = function(renderer){\r\n\tvar sum = renderer.getSummary();\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"object-summary\", false, sum.long, sum.status);\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectControlsDOM = function(renderer){\r\n\tvar controlsDOM = document.createElement(\"span\");\r\n\tcontrolsDOM.setAttribute(\"class\", \"terminus-object-controls\");\r\n\tif(renderer.showFeature(\"add\")){\r\n\t\tvar addDOM = this.getAddPropertyDOM(renderer);\r\n\t\tif(addDOM) controlsDOM.appendChild(addDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"mode\")){\r\n\t\tvar viewsDOM = HTMLFrameHelper.getModeSelectorDOM(\"object\", renderer);\r\n\t\tif(viewsDOM) controlsDOM.appendChild(viewsDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"delete\")){\r\n\t\tvar dpropDOM = this.getObjectDeleteDOM(renderer);\r\n\t\tif(dpropDOM) controlsDOM.appendChild(dpropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"clone\")){\r\n\t\tvar cpropDOM = this.getObjectCloneDOM(renderer);\r\n\t\tif(cpropDOM) controlsDOM.appendChild(cpropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"reset\")){\r\n\t\tvar rpropDOM = this.getObjectResetDOM(renderer);\r\n\t\tif(rpropDOM) controlsDOM.appendChild(rpropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"update\")){\r\n\t\tvar upropDOM = this.getObjectUpdateDOM(renderer);\r\n\t\tif(upropDOM) controlsDOM.appendChild(upropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"show\")){\r\n\t\tvar showDOM = this.getObjectShowDOM(renderer);\r\n\t\tif(showDOM) controlsDOM.appendChild(showDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"hide\")){\r\n\t\tvar hideDOM = this.getObjectHideDOM(renderer);\r\n\t\tif(hideDOM) controlsDOM.appendChild(hideDOM);\r\n\t}\r\n\treturn controlsDOM;\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectFacetDOM = function(renderer){\r\n\tvar viewables = renderer.getAvailableFacets();\r\n\tvar self = this;\r\n\tif(viewables && viewables.length){\r\n\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-object-facet\");\r\n\t\tvar callback = function(val){\r\n\t\t\tif(val){\r\n\t\t\t\trenderer.setFacet(val);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"object-facet\", viewables, renderer.currentFacet(), callback);\r\n\t\tmpropDOM.appendChild(sel);\r\n\t\treturn mpropDOM;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectLabelDOM = function(renderer){\r\n\tvar lab = renderer.getLabel();\r\n\tif(lab){\r\n\t\treturn HTMLFrameHelper.getInfoboxDOM(\"object-label\", false, lab);\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectIDDOM = function(renderer){\r\n\tvar val = renderer.subject();\r\n\tvar input = false;\r\n\tif(renderer.mode == \"edit\" && renderer.isNewDocument()){\r\n\t\tif(renderer.idDOM) val = renderer.idDOM.value;\r\n\t\tinput = document.createElement(\"input\");\r\n\t\tinput.setAttribute(\"class\", \"terminus-object-id-input\");\r\n\t\tinput.required  = true;\r\n\t\tif(val == \"_:\") val = \"\";\r\n\t\trenderer.idDOM = input;\r\n\t}\r\n\telse {\r\n\t\tif(renderer.isNewDocument() && val == \"_:\") val = \"New Document\";\r\n\t}\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"object-id\", \"ID\", val, \"Every fragment of data is identified by a unique URL\", input);\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectTypeDOM = function(renderer){\r\n\tif(renderer.mode == \"edit\" && renderer.parent && renderer.parent.isClassChoice() && renderer.isNew()){\r\n\t\tvar cs = renderer.parent.getAvailableClassChoices();\r\n\t\tif(cs && cs.length){\r\n\t\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\t\tmpropDOM.setAttribute(\"class\", \"terminus-property-change-class\");\r\n\t\t\tvar mlabDOM = document.createElement(\"span\");\r\n\t\t\tmlabDOM.setAttribute(\"class\", \"terminus-property-change-label\");\r\n\t\t\tmlabDOM.appendChild(document.createTextNode(\"Type\"));\r\n\t\t\tmpropDOM.appendChild(mlabDOM);\r\n\t\t\tvar callback = function(cls){\r\n\t\t\t\tif(cls){\r\n\t\t\t\t\trenderer.changeClass(cls);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"change-class\", cs, renderer.subjectClass(), callback);\r\n\t\t\tmpropDOM.appendChild(sel);\r\n\t\t\treturn mpropDOM;\r\n\t\t}\r\n\t}\r\n\tvar cm = renderer.getClassMeta(renderer.subjectClass());\r\n\tvar lab = renderer.subjectClass();\r\n\tvar cmt = \"All objects have types, identified by a unique URL\";\r\n\tif(cm){\r\n\t\tlab = HTMLFrameHelper.getVariableValueFromBinding(\"Label\", cm);\r\n\t\tcmt = HTMLFrameHelper.getVariableValueFromBinding(\"Comment\", cm);\r\n\t\tcmt = (cmt ? renderer.subjectClass() + \" \" + cmt : renderer.subjectClass());\r\n\t}\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"object-type\", \"Type\", lab, cmt);\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectStatusDOM = function(renderer){\r\n\tvar sum = renderer.getSummary();\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"status-\"+sum.status, false, sum.status, sum.status);\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getAddPropertyDOM = function(renderer){\r\n\tvar addables = renderer.getAddableProperties();\r\n\tif(addables && addables.length){\r\n\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-object-add-property\");\r\n\t\taddables.unshift({ value: \"\", label: \"Add New Property\"});\r\n\t\tvar callback = function(add){\r\n\t\t\tif(add){\r\n\t\t\t\trenderer.addNewProperty(add);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar disabled = (renderer.cardControlAllows(\"add\") ? false : \"Cardinality Rules Forbid Add\");\r\n\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"add-property\", addables, \"\", callback, disabled);\r\n\t\tmpropDOM.appendChild(sel);\r\n\t\treturn mpropDOM;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getViewPropertyDOM = function(renderer){\r\n\tvar viewables = renderer.getViewableProperties();\r\n\tvar self = this;\r\n\tif(viewables && viewables.length){\r\n\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-object-view-property\");\r\n\t\tviewables.unshift({ value: \"\", label: \"View Property\"});\r\n\t\tvar callback = function(add){\r\n\t\t\tif(add){\r\n\t\t\t\trenderer.goToProperty(add);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"view-property\", viewables, \"\", callback);\r\n\t\tmpropDOM.appendChild(sel);\r\n\t\treturn mpropDOM;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectDeleteDOM = function(renderer){\r\n\tvar callback = function(){renderer.delete()};\r\n\tvar disabled = (renderer.cardControlAllows(\"delete\") ? false : \"Cardinality Rules Forbid Delete\");\r\n\treturn HTMLFrameHelper.getActionControl(\"object\", \"delete\", \"Delete\", callback, disabled);\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectCloneDOM = function(renderer){\r\n\tvar callback = function(){renderer.clone()};\r\n\tvar disabled = (renderer.cardControlAllows(\"clone\") ? false : \"Cardinality Rules Forbid Clone\");\r\n\treturn HTMLFrameHelper.getActionControl(\"object\", \"clone\", \"Clone\", callback, disabled);\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectResetDOM = function(renderer){\r\n\tvar callback = function(){renderer.reset()};\r\n\tvar disabled = (renderer.isUpdated() ? false : \"Nothing to reset\");\r\n\treturn HTMLFrameHelper.getActionControl(\"object\", \"reset\", \"Reset\", callback, disabled);\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getViewerSelectorDOM = function(renderer){\r\n\tvar viewers = renderer.getAvailableViewers();\r\n\tif(viewers && viewers.length){\r\n\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-object-viewer\");\r\n\t\tvar callback = function(viewer){\r\n\t\t\tif(viewer){\r\n\t\t\t\trenderer.setViewer(viewer);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar selected = renderer.currentViewer();\r\n\t\tvar sel = HTMLFrameHelper.getSelectionControl('object-viewer', viewers, selected, callback);\r\n\t\tmpropDOM.appendChild(sel);\r\n\t\treturn mpropDOM;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectHideDOM = function(renderer){\r\n\tvar callback = function(){renderer.hide()};\r\n\treturn HTMLFrameHelper.getActionControl(\"object\", \"hide\", \"Hide\", callback);\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectShowDOM = function(renderer){\r\n\tvar callback = function(){renderer.show()};\r\n\treturn HTMLFrameHelper.getActionControl(\"object\", \"show\", \"Show\", callback);\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectUpdateDOM = function(renderer){\r\n\tvar dpropDOM = document.createElement(\"span\");\r\n\tdpropDOM.setAttribute(\"class\", \"terminus-object-update\");\r\n\tif(renderer.isNewDocument()){\r\n\t\tvar disabled = false;//(renderer.isUpdated() ? false : \"No changes\");\r\n\t}\r\n\telse {\r\n\t\tvar disabled = (renderer.isUpdated() ? false : \"No changes\");\r\n\t}\r\n\tvar saveback = function(){renderer.save()};\r\n\tdpropDOM.appendChild(HTMLFrameHelper.getActionControl(\"object\", \"save\", \"Save\", saveback, disabled));\r\n\treturn dpropDOM;\r\n}\r\n\r\nmodule.exports=HTMLObjectViewer;\r\n","const HTMLFrameHelper = require('../HTMLFrameHelper');\r\n\r\nfunction HTMLStringViewer(options){\r\n\tthis.size = ((options && options.size) ? options.size : false);\r\n\tthis.css = ((options && options.css) ? \"terminus-literal-value \" + options.css : \"terminus-literal-value\");\r\n\tthis.max_word_size = (options && options.max_word_size ? options.max_word_size : false);\r\n\tthis.max_cell_size = (options && options.max_cell_size ? options.max_cell_size : false);\r\n}\r\n\r\nHTMLStringViewer.prototype.renderFrame = function(frame, dataviewer){\r\n\tvar value = frame.get();\r\n\treturn this.render(value);\r\n}\r\n\r\nHTMLStringViewer.prototype.renderValue = function(dataviewer){\r\n\treturn this.render(dataviewer.value());\r\n}\r\n\r\nHTMLStringViewer.prototype.render = function(value){\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', this.css);\r\n\tinput.setAttribute('data-value', value);\r\n\tif(this.max_word_size || this.max_cell_size){\r\n\t\tHTMLFrameHelper.wrapShortenedText(input, value, this.max_cell_size, this.max_word_size);\r\n\t}\r\n\telse {\r\n\t\tvalue = document.createTextNode(value);\r\n\t\tinput.appendChild(value);\r\n\t}\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={HTMLStringViewer}\r\n\r\n\r\n","const HTMLFrameHelper = require('../HTMLFrameHelper');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\n/**\r\n * Property Viewer\r\n */\r\nfunction HTMLPropertyViewer(renderer){\r\n\tthis.values = [];\r\n}\r\n\r\n\r\n/**\r\n * Draws the property as header and body components\r\n */\r\nHTMLPropertyViewer.prototype.render = function(renderer){\r\n\tthis.renderer = renderer;\r\n\tthis.headerViewer = new HTMLPropertyHeaderViewer();\r\n\t//var block = document.createElement('div');\r\n\t//block.setAttribute('style', 'display: flex; margin: 10px');\r\n\t//var br = document.createElement('br');\r\n\t//block.appendChild(br);\r\n\tif(this.propDOM){\r\n\t\tvar npropDOM = this.getPropertyDOM();\r\n\t\t//npropDOM.setAttribute('style', 'display: flex; margin: 10px;');\r\n\t\t\t//block.appendChild(npropDOM);\r\n\t\tthis.propDOM.replaceWith(npropDOM);\r\n\t\tthis.propDOM = npropDOM;\r\n\t\t//this.propDOM = block;\r\n\t}\r\n\telse {\r\n\t\t//block.appendChild(this.getPropertyDOM());\r\n\t\t//this.propDOM = block;\r\n\t\tthis.propDOM = this.getPropertyDOM();\r\n\t\t//this.propDOM.setAttribute('style', 'display: flex; margin: 10px;');\r\n\t}\r\n\tthis.propDOM.appendChild(this.getPropertyIDMarker(this.renderer));\r\n\tif(this.headerViewer){\r\n\t\tthis.header = this.headerViewer.getAsDOM(this.renderer);\r\n\t\tif(this.header) this.propDOM.appendChild(this.header);\r\n\t}\r\n\tthis.body = this.getPropertyBodyDOM();\r\n\tif(this.body) this.propDOM.appendChild(this.body);\r\n\treturn this.propDOM;\r\n}\r\n\r\nHTMLPropertyViewer.prototype.getPropertyDOM = function(){\r\n\tvar orientation = this.renderer.getContentOrientation();\r\n\tvar pcls = \" terminus-property-frame-display terminus-property-frame-\" + orientation;\r\n\tif(orientation == \"label\"){\r\n\t\tvar sp = document.createElement(\"span\");\r\n\t}\r\n\telse {\r\n\t\tvar sp = document.createElement(\"div\");\r\n\t}\r\n\t//terminus-property-frame-spacer\r\n\r\n\tsp.setAttribute(\"class\", \"terminus-property-frame terminus-zebra-frame terminus-property-frame-\" + this.renderer.mode + \" \" + pcls);\r\n\tsp.setAttribute('data-property', this.renderer.property());\r\n\treturn sp;\r\n}\r\n\r\nHTMLPropertyViewer.prototype.getPropertyBodyDOM = function(){\r\n\tvar orientation = this.renderer.getContentOrientation();\r\n\tvar pcls = \"terminus-property-values-\" + orientation;\r\n\tif(orientation == \"page\"){\r\n\t\tvar vholder = document.createElement(\"div\");\r\n\t}\r\n\telse {\r\n\t\tvar vholder = document.createElement(\"span\");\r\n\t}\r\n    vholder.setAttribute('class', 'terminus-property-values ' + pcls + ' terminus-property-values-align');\r\n\tfor(var i =0; i<this.values.length; i++){\r\n\t\tvholder.appendChild(this.values[i]);\r\n\t}\r\n\treturn vholder;\r\n}\r\n\r\nHTMLPropertyViewer.prototype.addRenderedValue = function(renderedval){\r\n\tthis.values.push(renderedval);\r\n}\r\n\r\nHTMLPropertyViewer.prototype.clear = function(){\r\n\tTerminusClient.FrameHelper.removeChildren(this.propDOM);\r\n\tthis.values = [];\r\n}\r\n\r\n\r\n/**\r\n * Removes the property from the dom\r\n */\r\nHTMLPropertyViewer.prototype.remove = function(){\r\n\tthis.propDOM.parentNode.removeChild(this.propDOM);\r\n}\r\n\r\n/**\r\n * Redraws the property to reflect an updated state\r\n */\r\nHTMLPropertyViewer.prototype.redraw = function(){\r\n\tvar npropDOM = this.getPropertyDOM();\r\n\tthis.propDOM.replaceWith(npropDOM);\r\n\tthis.propDOM = npropDOM;\r\n\tthis.values = [];\r\n\tthis.renderer.render(this);\r\n}\r\n\r\nHTMLPropertyViewer.prototype.redrawHeader = function(){\r\n\tif(this.headerViewer && this.header) {\r\n\t\tvar nheader = this.headerViewer.getAsDOM(this.renderer);\r\n\t\tthis.header.replaceWith(nheader);\r\n\t\tthis.header = nheader;\r\n\t}\r\n}\r\n\r\nHTMLPropertyViewer.prototype.redrawBody = function(){\r\n\tif(this.body){\r\n\t\tvar nbody = this.getPropertyBodyDOM();\r\n\t\tthis.body.replaceWith(nbody);\r\n\t\tthis.body = nbody;\r\n\t}\r\n}\r\n\r\n/**\r\n * Generates a html anchor element to use as a marker to find the property on the page\r\n */\r\nHTMLPropertyViewer.prototype.getPropertyIDMarker = function(renderer){\r\n\tvar idm = document.createElement(\"a\");\r\n\tidm.setAttribute(\"class\", \"terminus-property-idmarker\");\r\n\tvar subj = TerminusClient.FrameHelper.getShorthand(renderer.subject());\r\n\tif(!subj ) subj = renderer.subject();\r\n\tvar bits = subj .split(\":\");\r\n\tif(bits.length > 1) subj = bits[1];\r\n\tvar prop = TerminusClient.FrameHelper.getShorthand(renderer.property());\r\n\tif(!prop ) prop = renderer.property();\r\n\tvar bits = prop.split(\":\");\r\n\tif(bits.length > 1) prop = bits[1];\r\n\tidm.setAttribute(\"name\", subj + \"_\" + prop);\r\n\treturn idm;\r\n}\r\n\r\nHTMLPropertyViewer.prototype.goTo = function(subj, property, index){\r\n\tHTMLFrameHelper.goToName(subj, property, index);\r\n}\r\n\r\nfunction HTMLPropertyHeaderViewer(){}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getAsDOM = function(renderer){\r\n\tvar orientation = renderer.getContentOrientation();\r\n\tvar pcls = \"terminus-property-header-\" + orientation;\r\n\tif(orientation == \"page\"){\r\n\t\tvar objDOM = document.createElement(\"div\");\r\n\t}\r\n\telse {\r\n\t\tvar objDOM = document.createElement(\"span\");\r\n\t}\r\n\tobjDOM.setAttribute(\"class\", \"terminus-text terminus-property-header \" + pcls);\r\n\tvar wrapper = document.createElement(\"span\");\r\n\twrapper.setAttribute(\"class\", \"terminus-property-header-wrapper\");\r\n\tif(renderer.showFeature(\"control\")){\r\n\t\tvar expModeMenu = this.getPropertyControlsDOM(wrapper, renderer);\r\n\t\tif(orientation == 'page') this.expModeMenu = expModeMenu;\r\n\t\telse this.expModeMenu = null;\r\n\t}\r\n\tif(renderer.showFeature(\"label\")){\r\n\t\tvar sumDOM = this.getPropertyLabelDOM(renderer);\r\n\t\tif(renderer.showFeature(\"status\")){\r\n\t\t\tvar statDOM = this.getPropertyStatusDOM(renderer);\r\n\t\t\tif(statDOM) sumDOM.prepend(statDOM);\r\n\t\t}\r\n\t\tif(sumDOM) wrapper.appendChild(sumDOM);\r\n\t}\r\n\telse if(renderer.showFeature(\"status\")){\r\n\t\tvar statDOM = this.getPropertyStatusDOM(renderer);\r\n\t\tif(statDOM) wrapper.appendChild(statDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"summary\")){\r\n\t\tvar sumDOM = this.getPropertySummaryDOM(renderer);\r\n\t\tif(sumDOM) wrapper.appendChild(sumDOM);\r\n\t}\r\n\r\n\tvar prelude = document.createElement(\"span\");\r\n\tprelude.setAttribute(\"class\", \"terminus-property-header-info terminus-property-header-info-\"+renderer.currentFacet());\r\n\r\n\tif(renderer.showFeature(\"facet\")){\r\n\t\tvar facetDOM = this.getPropertyFacetDOM(renderer);\r\n\t\tif(facetDOM) prelude.appendChild(facetDOM);\r\n\t\t//if(facetDOM && this.expModeMenu) this.expModeMenu.appendChild(facetDOM);//\r\n\t}\r\n\tif(renderer.showFeature(\"view\")){\r\n\t\tvar viewDOM = this.getViewValueDOM(renderer);\r\n\t\tif(viewDOM) prelude.appendChild(viewDOM);\r\n\t\t//if(viewDOM && this.expModeMenu) this.expModeMenu.appendChild(viewDOM); //prelude.appendChild(viewDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"id\")){\r\n\t\tvar idDOM = this.getPropertyIDDOM(renderer);\r\n\t\tif(idDOM) prelude.appendChild(idDOM);\r\n\t\t//if(idDOM && this.expModeMenu) this.expModeMenu.appendChild(idDOM); //\r\n\t}\r\n\tif(renderer.showFeature(\"type\")){\r\n\t\tvar typeDOM = this.getPropertyRangeDOM(renderer);\r\n\t\tif(typeDOM)\tprelude.appendChild(typeDOM);\r\n\t\t/*if(typeDOM && this.expModeMenu){\r\n\t\t\tthis.expModeMenu.appendChild(typeDOM);//\r\n\t\t\ttypeDOM.style.display = 'block';\r\n\t\t}*/\r\n\t}\r\n\tif(renderer.showFeature(\"cardinality\") && renderer.hasCardinalityRestriction()){\r\n\t\tvar hideDOM = this.getPropertyCardinalityDOM(renderer);\r\n\t\tif(hideDOM) prelude.appendChild(hideDOM);\r\n\t\t//\tthis.expModeMenu.appendChild(hideDOM); \t\t\thideDOM.style.display = 'block';\r\n\r\n\t}\r\n\tif(renderer.showFeature(\"comment\")){\r\n\t\tvar sumDOM = this.getPropertyCommentDOM(renderer);\r\n\t\tif(sumDOM) prelude.appendChild(sumDOM);\r\n\t\t/*if(sumDOM && this.expModeMenu){\r\n\t\t\tthis.expModeMenu.appendChild(sumDOM); //\r\n\t\t\tsumDOM.style.display = 'block';\r\n\t\t}*/\r\n\t}\r\n\twrapper.appendChild(prelude);\r\n\tobjDOM.appendChild(wrapper);\r\n\treturn objDOM;\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyFacetDOM = function(renderer){\r\n\tvar viewables = renderer.getAvailableFacets();\r\n\tvar self = this;\r\n\tif(viewables && viewables.length){\r\n\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-property-facet\");\r\n\t\tvar callback = function(val){\r\n\t\t\tif(val){\r\n\t\t\t\trenderer.setFacet(val);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"property-facet\", viewables, renderer.currentFacet(), callback);\r\n\t\tmpropDOM.appendChild(sel);\r\n\t\treturn mpropDOM;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyIDDOM = function(renderer){\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"property-id\", \"Property\", renderer.property(), \"This property is identified by this unique URL: \" + renderer.property());\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyRangeDOM = function(renderer){\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"property-type\", \"Type\", renderer.range(), \"The type of arguments that this property accepts\");\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertySummaryDOM = function(renderer){\r\n\tvar sum = renderer.getSummary();\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"property-summary\", false, sum.long, sum.status);\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyStatusDOM = function(renderer){\r\n\tvar sum = renderer.getSummary();\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"status-\"+sum.status, false, sum.status, sum.status);\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyLabelDOM = function(renderer){\r\n\tvar lab = renderer.getLabel();\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"property-label\", false, lab);\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyCommentDOM = function(renderer){\r\n\tvar lab = renderer.getComment();\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"property-comment\", false, lab);\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyCardinalityDOM = function(renderer){\r\n\tvar restriction = renderer.getRestriction();\r\n\tif(restriction.min && restriction.max){\r\n\t\tif(restriction.min == restriction.max){\r\n\t\t\tvar lab = restriction.min;\r\n\t\t\tvar help = \"Cardinality: \" + restriction.min;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tvar lab = restriction.min + \"-\" + restriction.max;\r\n\t\t\tvar help = \"Minimum Cardinality: \" + restriction.min;\r\n\t\t\thelp += \", Maximum Cardinality: \" + restriction.max;\r\n\t\t}\r\n\t}\r\n\telse if(restriction.min){\r\n\t\tvar lab = \">\"+(restriction.min-1);\r\n\t\tvar help = \"Minimum Cardinality: \" + restriction.min;\r\n\t}\r\n\telse if(restriction.max){\r\n\t\tvar lab = \"<\"+(restriction.max+1);\r\n\t\tvar help = \"Maximum Cardinality: \" + restriction.max;\r\n\t}\r\n\telse {\r\n\t\treturn false;\r\n\t}\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"property-cardinality\", \"Cardinality\", lab, help);\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getActionControlDOM = function(settingsDOM, renderer){\r\n\tif(renderer.showFeature(\"mode\")){\r\n\t\tvar viewsDOM = HTMLFrameHelper.getModeSelectorDOM(\"property\", renderer);\r\n\t\tif (viewsDOM) settingsDOM.appendChild(viewsDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"delete\")){\r\n\t\tvar dpropDOM = this.getPropertyDeleteDOM(renderer);\r\n\t\tif (dpropDOM) settingsDOM.appendChild(dpropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"add\") && !renderer.isClassChoice()){\r\n\t\tvar addDOM = this.getAddValueDOM(renderer);\r\n\t\tif(addDOM) settingsDOM.appendChild(addDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"reset\")){\r\n\t\tvar rpropDOM = this.getPropertyResetDOM(renderer);\r\n\t\tif(rpropDOM) settingsDOM.appendChild(rpropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"update\")){\r\n\t\tvar upropDOM = this.getPropertyUpdateDOM(renderer);\r\n\t\tif(upropDOM) settingsDOM.appendChild(upropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"show\")){\r\n\t\tvar showDOM = this.getPropertyShowDOM(renderer);\r\n\t\tif(showDOM) settingsDOM.appendChild(showDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"hide\")){\r\n\t\tvar hideDOM = this.getPropertyHideDOM(renderer);\r\n\t\tif(hideDOM) settingsDOM.appendChild(hideDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"viewer\")){\r\n\t\tvar hideDOM = this.getViewerSelectorDOM(renderer);\r\n\t\tif(hideDOM) settingsDOM.appendChild(hideDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"add\") && renderer.isClassChoice()){\r\n\t\tvar addDOM = this.getAddValueDOM(renderer);\r\n\t\tif(addDOM) settingsDOM.appendChild(addDOM);\r\n\t}\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getSettingsControlDOM = function(controlsDOM, renderer){\r\n\tvar settings = document.createElement(\"div\");\r\n\tcontrolsDOM.appendChild(settings);\r\n\tvar orientation = renderer.getContentOrientation();\r\n\tif(false && orientation == 'page'){ // expert mode\r\n\t\tvar sControl = HTMLFrameHelper.getSettingsControl('property');\r\n\t\tvar menu = document.createElement('div');\r\n\t\tmenu.setAttribute('class', 'terminus-hide terminus-popup');\r\n\t\tmenu.appendChild(document.createTextNode('Edit property'));\r\n\t\tmenu.appendChild(document.createElement('BR'));\r\n\t\tsControl.appendChild(menu);\r\n\t\tsControl.addEventListener('click', function(e){\r\n\t\t\tvar target = e.target || e.srcElement,\r\n        \ttext = target.textContent || target.innerText;\r\n\t\t\tif((target.nodeName == 'ICON') || (target.nodeName == 'BUTTON')){\r\n\t\t\t\tif(this.children[0].style.display == 'none') this.children[0].style.display = 'block';\r\n\t\t\t\telse this.children[0].style.display = 'none';\r\n\t\t\t}\r\n\t\t});\r\n\t\tthis.getActionControlDOM(menu, renderer);\r\n\t    settings.appendChild(sControl);\r\n\t\treturn menu;\r\n\t}\r\n\telse this.getActionControlDOM(controlsDOM, renderer);\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyControlsDOM = function(wrapper, renderer){\r\n\tvar controlsDOM = document.createElement(\"span\");\r\n\tcontrolsDOM.setAttribute(\"class\", \"terminus-property-controls\");\r\n\t//controlsDOM.setAttribute(\"style\", \"display: table-cell;\");\r\n\t// get settings icon or button\r\n\tvar expModeMenu = this.getSettingsControlDOM(controlsDOM, renderer);\r\n\twrapper.appendChild(controlsDOM);\r\n\treturn expModeMenu;\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getAddValueDOM = function(renderer){\r\n\tif(renderer.isClassChoice()){\r\n\t\tvar cs = renderer.getAvailableClassChoices();\r\n\t\tif(cs && cs.length){\r\n\t\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\t\tmpropDOM.setAttribute(\"class\", \"terminus-property-add-class\");\r\n\t\t\tcs.unshift({ value: \"\", label: \"Add Type\"});\r\n\t\t\tvar callback = function(cls){\r\n\t\t\t\tif(cls){\r\n\t\t\t\t\trenderer.addClass(cls);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"add-property\", cs, \"\", callback);\r\n\t\t\tmpropDOM.appendChild(sel);\r\n\t\t\treturn mpropDOM;\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tvar callback = function(){renderer.add(\"edit\")};\r\n\t\tvar disabled = (renderer.cardControlAllows(\"add\") ? false : \"Cardinality Rules Forbid Add\");\r\n\t\treturn HTMLFrameHelper.getActionControl(\"property\", \"add\", \"Add\", callback, disabled);\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getViewValueDOM = function(renderer){\r\n\tvar viewables = renderer.getViewableValues();\r\n\tvar self = this;\r\n\tif(viewables && viewables.length){\r\n\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-property-view-value\");\r\n\t\tviewables.unshift({ value: \"\", label: \"View Value\"});\r\n\t\tvar callback = function(val){\r\n\t\t\trenderer.goToValue(val);\r\n\t\t}\r\n\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"view-values\", viewables, \"\", callback);\r\n\t\tmpropDOM.appendChild(sel);\r\n\t\treturn mpropDOM;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyDeleteDOM = function(renderer){\r\n\tvar callback = function(){renderer.delete()};\r\n\tvar disabled = (renderer.cardControlAllows(\"delete\") ? false : \"Cardinality Rules Forbid Delete\");\r\n\treturn HTMLFrameHelper.getActionControl(\"property\", \"delete\", \"Delete\", callback, disabled);\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyHideDOM = function(renderer){\r\n\tvar callback = function(){renderer.hide()};\r\n\treturn HTMLFrameHelper.getActionControl(\"property\", \"hide\", \"Hide\", callback);\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyResetDOM = function(renderer){\r\n\tvar callback = function(){renderer.reset()};\r\n\tvar disabled = (renderer.isUpdated() ? false : \"Nothing to reset\");\r\n\treturn HTMLFrameHelper.getActionControl(\"property\", \"reset\", \"Reset\", callback, disabled);\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyShowDOM = function(renderer){\r\n\tvar callback = function(){renderer.show()};\r\n\treturn HTMLFrameHelper.getActionControl(\"property\", \"show\", \"Show\", callback);\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyUpdateDOM = function(renderer){\r\n\tvar dpropDOM = document.createElement(\"span\");\r\n\tdpropDOM.setAttribute(\"class\", \"terminus-property-update\");\r\n\tvar disabled = (renderer.isUpdated() ? false : \"No Change\");\r\n\tvar saveback = function(){renderer.save()};\r\n\tdpropDOM.appendChild(HTMLFrameHelper.getActionControl(\"property\", \"save\", \"Save\", saveback, disabled));\r\n\treturn dpropDOM;\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getViewerSelectorDOM = function(renderer){\r\n\tvar viewers = renderer.getAvailableViewers();\r\n\tif(viewers && viewers.length){\r\n\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-property-viewer\");\r\n\t\tvar callback = function(viewer){\r\n\t\t\tif(viewer){\r\n\t\t\t\trenderer.setViewer(viewer);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar selected = renderer.currentViewer();\r\n\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"property-viewers\", viewers, selected, callback);\r\n\t\tmpropDOM.appendChild(sel);\r\n\t\treturn mpropDOM;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.showValue = function(renderer, index){\r\n\tvar htmlid = renderer.subject() + \"->\" + renderer.property() + \"_\" + index;\r\n\twindow.location = (\"\"+window.location).replace(/#[A-Za-z0-9_]*$/,'') + \"#\" + htmlid;\r\n}\r\n\r\nfunction HTMLDataViewer(){\r\n}\r\n\r\nmodule.exports=HTMLPropertyViewer;\r\n","/**\r\n * Draws the property as header and body components\r\n */\r\nconst HTMLFrameHelper = require('../HTMLFrameHelper');\r\nconst HTMLStringViewer = require('../datatypes/String');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction HTMLDataViewer(){\r\n}\r\n\r\nHTMLDataViewer.prototype.render = function(renderer){\r\n\tthis.headerViewer = new HTMLDataHeaderViewer();\r\n\tif(this.valDOM){\r\n\t\tvar nvalDOM = this.getValueDOM();\r\n\t\tthis.valDOM.replaceWith(nvalDOM);\r\n\t\tthis.valDOM = nvalDOM;\r\n\t}\r\n\telse {\r\n\t\tthis.valDOM = this.getValueDOM();\r\n\t}\r\n\tthis.valDOM.appendChild(this.getValueIDMarker(this.renderer));\r\n\tthis.body = this.getValueBodyDOM();\r\n\tif(this.body) this.valDOM.appendChild(this.body);\r\n\tif(this.headerViewer){\r\n\t\tthis.header = this.headerViewer.getAsDOM(this.renderer);\r\n\t\tif(this.renderer.facet == 'page'){ //expert mode\r\n\t\t\tif(this.header && this.expModeMenu) {\r\n\t\t\t\tthis.expModeMenu.appendChild(this.header);\r\n\t\t\t\t//this.valDOM.appendChild(this.expModeMenu);\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if(this.header) this.valDOM.appendChild(this.header);\r\n\t}\r\n\treturn this.valDOM;\r\n}\r\n\r\nHTMLDataViewer.prototype.getValueDOM = function(){\r\n\tif(this.renderer.currentFacet() == \"page\"){\r\n\t\tvar sp = document.createElement(\"div\");\r\n\t}\r\n\telse {\r\n\t\tvar sp = document.createElement(\"span\");\r\n\t}\r\n\tsp.setAttribute(\"class\", \"terminus-property-value property-value-\" + this.renderer.currentFacet() + \" property-value-\" + this.renderer.mode);\r\n\tif(this.renderer.mode == \"view\"){\r\n\t\tsp.setAttribute('data-value', this.renderer.value());\r\n\t}\r\n\treturn sp;\r\n}\r\n\r\nHTMLDataViewer.prototype.getValueBodyDOM = function(){\r\n\tif(this.renderer.currentFacet() == \"page\"){\r\n\t\tvar vholder = document.createElement(\"div\");\r\n\t}\r\n\telse {\r\n\t\tvar vholder = document.createElement(\"span\");\r\n\t}\r\n    vholder.setAttribute('class', ' terminus-property-body property-value-body property-value-body-'+this.renderer.currentFacet() + ' terminus-property-body-align');\r\n\t//vholder.setAttribute('style', 'display: flex;');\r\n\tif(this.renderer.showFeature(\"body\")){\r\n        var valueViewer = this.renderer.getDataValueViewer();\r\n    \tvar vdom = valueViewer.getDOM(this.renderer, this);\r\n    }\r\n    else if(this.renderer.showFeature(\"summary\")){\r\n\t\tvar vdom = this.getSummaryDOM();\r\n    }\r\n    else {\r\n    \treturn false;\r\n    }\r\n    if(vdom) vholder.appendChild(vdom);\r\n\tif(false && this.renderer.currentFacet() == \"page\"){\r\n\t\tvar sControl = HTMLFrameHelper.getSettingsControl('data');\r\n\t\tvar menu = document.createElement('div');\r\n\t\tmenu.setAttribute('class', 'terminus-hide terminus-popup');\r\n\t\tmenu.appendChild(document.createTextNode('Edit property value'));\r\n\t\tmenu.appendChild(document.createElement('BR'));\r\n\t\tsControl.appendChild(menu);\r\n\t\tsControl.addEventListener('click', function(e){\r\n\t\t\tvar target = e.target || e.srcElement,\r\n\t\t\ttext = target.textContent || target.innerText;\r\n\t\t\tif((target.nodeName == 'ICON') || (target.nodeName == 'BUTTON')){\r\n\t\t\t\tif(this.children[0].style.display == 'none') this.children[0].style.display = 'block';\r\n\t\t\t\telse this.children[0].style.display = 'none';\r\n\t\t\t}\r\n\t\t});\r\n\t\tthis.expModeMenu = menu;\r\n\t\tvholder.appendChild(sControl);\r\n\t}\r\n\treturn vholder;\r\n}\r\n\r\n/**\r\n * Removes the value from the dom\r\n */\r\nHTMLDataViewer.prototype.remove = function(){\r\n\tthis.valDOM.parentNode.removeChild(this.valDOM);\r\n}\r\n\r\nHTMLDataViewer.prototype.redrawHeader = function(){\r\n\tif(this.headerViewer && this.header) {\r\n\t\tvar nheader = this.headerViewer.getAsDOM(this.renderer);\r\n\t\tthis.header.replaceWith(nheader);\r\n\t\tthis.header = nheader;\r\n\t}\r\n}\r\n\r\nHTMLDataViewer.prototype.redrawBody = function(){\r\n\tif(this.body){\r\n\t\tvar nbody = this.getValueBodyDOM();\r\n\t\tthis.body.replaceWith(nbody);\r\n\t\tthis.body = nbody;\r\n\t}\r\n}\r\n\r\n/**\r\n * Generates a html anchor element to use as a marker to find the property on the page\r\n */\r\nHTMLDataViewer.prototype.getValueIDMarker = function(renderer){\r\n\tvar idm = document.createElement(\"a\");\r\n\tidm.setAttribute(\"class\", \"terminus-value-idmarker\");\r\n\tvar subj = TerminusClient.FrameHelper.getShorthand(renderer.subject());\r\n\tif(!subj ) subj = renderer.subject();\r\n\tvar bits = subj .split(\":\");\r\n\tif(bits.length > 1) subj = bits[1];\r\n\tvar prop = TerminusClient.FrameHelper.getShorthand(renderer.property());\r\n\tif(!prop ) prop = renderer.property();\r\n\tvar bits = prop.split(\":\");\r\n\tif(bits.length > 1) prop = bits[1];\r\n\tidm.setAttribute(\"name\", subj + \"_\" + prop + \"_\" + renderer.index);\r\n\treturn idm;\r\n}\r\n\r\nHTMLDataViewer.prototype.getSummaryDOM = function(){\r\n\tvar sum = this.renderer.getSummary();\r\n\treturn HTMLTerminusClient.FrameHelper.getInfoboxDOM(\"value-summary\", false, sum.long, sum.long);\r\n}\r\n\r\nHTMLDataViewer.prototype.fireInternalLink = function(link){\r\n\tvar self = this;\r\n\tvar fire = function(e){\r\n\t\te.preventDefault();\r\n\t\tself.renderer.load(link);\t\t\r\n\t}\r\n\treturn fire;\r\n}\r\n\r\nHTMLDataViewer.prototype.internalLink = function(link, label){\r\n\tvar onclick = this.fireInternalLink(link);\r\n\tvar a = document.createElement(\"a\");\r\n\ta.onClick = onclick;\r\n\ta.href=link;\r\n\ta.addEventListener(\"click\", onclick);\r\n\tif(label){\r\n\t\ta.appendChild(document.createTextNode(label));\r\n\t}\r\n\telse {\r\n\t\tvar sh = TerminusClient.FrameHelper.getShorthand(link);\r\n\t\tif(sh){\r\n\t\t\ta.setAttribute(\"title\", link);\r\n\t\t\ta.appendChild(document.createTextNode(sh));\r\n\t\t}\r\n\t\telse {\r\n\t\t\ta.appendChild(document.createTextNode(link));\r\n\t\t}\r\n\t}\r\n\treturn a;\r\n}\r\n\r\nHTMLDataViewer.prototype.clear = function(){\r\n\tTerminusClient.FrameHelper.removeChildren(this.valDOM);\r\n}\r\n\r\n\r\nfunction HTMLDataHeaderViewer(){}\r\n\r\nHTMLDataHeaderViewer.prototype.getAsDOM = function(renderer){\r\n\tif(renderer.currentFacet() == \"page\"){\r\n\t\tvar objDOM = document.createElement(\"div\");\r\n\t}\r\n\telse {\r\n\t\tvar objDOM = document.createElement(\"span\");\r\n\t}\r\n\tobjDOM.setAttribute(\"class\", \"terminus-value-header terminus-value-header-\" + renderer.currentFacet());\r\n\tif(renderer.showFeature(\"facet\")){\r\n\t\tvar facetDOM = this.getValueFacetDOM(renderer);\r\n\t\tif(facetDOM) objDOM.appendChild(facetDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"viewer\")){\r\n\t\tvar hideDOM = this.getViewerSelectorDOM(renderer);\r\n\t\tif(hideDOM) objDOM.appendChild(hideDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"type\")){\r\n\t\tvar typeDOM = this.getValueTypeDOM(renderer);\r\n\t\tif(typeDOM) objDOM.appendChild(typeDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"status\")){\r\n\t\tvar sumDOM = this.getValueStatusDOM(renderer);\r\n\t\tif(sumDOM) objDOM.appendChild(sumDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"control\")){\r\n\t\tvar controlsDOM = this.getValueControlsDOM(renderer);\r\n\t\tif(controlsDOM) objDOM.appendChild(controlsDOM);\r\n\t}\r\n\treturn objDOM;\r\n}\r\n\r\nHTMLDataHeaderViewer.prototype.getValueFacetDOM = function(renderer){\r\n\tvar viewables = renderer.getAvailableFacets();\r\n\tvar self = this;\r\n\tif(viewables && viewables.length){\r\n\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-value-facet\");\r\n\t\tvar callback = function(val){\r\n\t\t\tif(val){\r\n\t\t\t\trenderer.setFacet(val);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"value-facet\", viewables, renderer.currentFacet(), callback);\r\n\t\tmpropDOM.appendChild(sel);\r\n\t\treturn mpropDOM;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\n\r\nHTMLDataHeaderViewer.prototype.getValueTypeDOM = function(renderer){\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"value-type\", \"Type\", renderer.type(), \"All data values have types, identified by a unique URL\");\r\n}\r\n\r\nHTMLDataHeaderViewer.prototype.getValueStatusDOM = function(renderer){\r\n\tvar sum = renderer.getSummary();\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"status-\"+sum.status, false, sum.status, sum.status);\r\n}\r\n\r\n\r\nHTMLDataHeaderViewer.prototype.getValueControlsDOM = function(renderer){\r\n\tvar controlsDOM = document.createElement(\"span\");\r\n\tcontrolsDOM.setAttribute(\"class\", \"terminus-value-controls\");\r\n\tif(renderer.showFeature(\"mode\")){\r\n\t\tvar viewsDOM = HTMLFrameHelper.getModeSelectorDOM(\"value\", renderer);\r\n\t\tif(viewsDOM) controlsDOM.appendChild(viewsDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"delete\")){\r\n\t\tvar dpropDOM = this.getValueDeleteDOM(renderer);\r\n\t\tif(dpropDOM) controlsDOM.appendChild(dpropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"clone\")){\r\n\t\tvar cpropDOM = this.getValueCloneDOM(renderer);\r\n\t\tif(cpropDOM) controlsDOM.appendChild(cpropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"reset\")){\r\n\t\tvar rpropDOM = this.getValueResetDOM(renderer);\r\n\t\tif(rpropDOM) controlsDOM.appendChild(rpropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"update\")){\r\n\t\tvar upropDOM = this.getValueUpdateDOM(renderer);\r\n\t\tif(upropDOM) controlsDOM.appendChild(upropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"show\")){\r\n\t\tvar showDOM = this.getValueShowDOM(renderer);\r\n\t\tif(showDOM) controlsDOM.appendChild(showDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"hide\")){\r\n\t\tvar hideDOM = this.getValueHideDOM(renderer);\r\n\t\tif(hideDOM) controlsDOM.appendChild(hideDOM);\r\n\t}\r\n\treturn controlsDOM;\r\n}\r\n\r\nHTMLDataHeaderViewer.prototype.getValueDeleteDOM = function(renderer){\r\n\tvar callback = function(){renderer.delete()};\r\n\tvar disabled = (renderer.cardControlAllows(\"delete\") ? false : \"Cardinality Rules Forbid Delete\");\r\n\treturn HTMLFrameHelper.getActionControl(\"value\", \"delete\", \"Delete\", callback, disabled);\r\n}\r\n\r\nHTMLDataHeaderViewer.prototype.getValueResetDOM = function(renderer){\r\n\tvar callback = function(){renderer.reset()};\r\n\tvar disabled = (renderer.isUpdated() ? false : \"Nothing to reset\");\r\n\treturn HTMLFrameHelper.getActionControl(\"value\", \"reset\", \"Reset\", callback, disabled);\r\n}\r\n\r\nHTMLDataHeaderViewer.prototype.getValueShowDOM = function(renderer){\r\n\tvar callback = function(){renderer.show()};\r\n\treturn HTMLFrameHelper.getActionControl(\"value\", \"show\", \"Show\", callback);\r\n}\r\n\r\nHTMLDataHeaderViewer.prototype.getValueHideDOM = function(renderer){\r\n\tvar callback = function(){renderer.hide()};\r\n\treturn HTMLFrameHelper.getActionControl(\"value\", \"hide\", \"Hide\", callback);\r\n}\r\n\r\nHTMLDataHeaderViewer.prototype.getValueCloneDOM = function(renderer){\r\n\tvar callback = function(){renderer.clone()};\r\n\tvar disabled = (renderer.cardControlAllows(\"clone\") ? false : \"Cardinality Rules Forbid Clone\");\r\n\treturn HTMLFrameHelper.getActionControl(\"value\", \"clone\", \"Clone\", callback, disabled);\r\n}\r\n\r\nHTMLDataHeaderViewer.prototype.getValueUpdateDOM = function(renderer){\r\n\tvar dpropDOM = document.createElement(\"span\");\r\n\tdpropDOM.setAttribute(\"class\", \"terminus-value-update\");\r\n\tvar saveback = function(){renderer.save()};\r\n\tvar disabled = (renderer.isUpdated() ? false : \"Nothing to save - no change\");\r\n\tdpropDOM.appendChild(HTMLFrameHelper.getActionControl(\"value\", \"save\", \"Save\", saveback, disabled));\r\n\treturn dpropDOM;\r\n}\r\n\r\nHTMLDataHeaderViewer.prototype.getViewerSelectorDOM = function(renderer){\r\n\tvar viewers = renderer.getAvailableViewers();\r\n\tif(viewers && viewers.length){\r\n\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-value-viewer\");\r\n\t\tvar callback = function(viewer){\r\n\t\t\tif(viewer){\r\n\t\t\t\trenderer.setViewer(viewer);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar selected = renderer.currentViewer();\r\n\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"data-viewer\", viewers, selected, callback);\r\n\t\tmpropDOM.appendChild(sel);\r\n\t\treturn mpropDOM;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nmodule.exports=HTMLDataViewer;\r\n","/*\r\n * Utility class which runs a query against the schema and presents the returned classes as a drop-down / class filter list\r\n */\r\n\r\nconst WOQLQuery = require('./WOQLQuery');\r\nconst HTMLFrameHelper = require('../html/HTMLFrameHelper');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nTerminusClassChooser = function(ui, filter, chosen){\r\n\tthis.ui = ui;\r\n\tthis.choice = (chosen ? chosen : false);\r\n\tthis.filter = filter;\r\n\tthis.show_single = true;\r\n}\r\n\r\nTerminusClassChooser.prototype.setRoot = function(root){\r\n\tthis.root = root;\r\n}\r\n\r\nTerminusClassChooser.prototype.setFilter = function(filter){\r\n\tthis.filter = filter;\r\n}\r\n\r\nTerminusClassChooser.prototype.change = function(cls){\r\n\talert(\"Need to specify class chooser function (\" + cls + \")\");\r\n}\r\n\r\nTerminusClassChooser.prototype.getAsDOM = function(style){\r\n\tvar ccdom = document.createElement(\"span\");\r\n\tccdom.setAttribute(\"class\", \"terminus-class-chooser\");\r\n\tvar ccsel = document.createElement(\"select\");\r\n\tccsel.setAttribute(\"class\", style + \" terminus-type-select terminus-class-select\");\r\n\t// ccsel.setAttribute(\"class\", \"terminus-class-select terminus-type-select terminus-query-select\");\r\n\tvar self = this;\r\n\tccsel.addEventListener(\"change\", function(){\r\n\t\tthis.choice = this.value;\r\n\t\tself.change(this.value);\r\n\t\tthis.value = \"\";\r\n\t});\r\n\tccdom.appendChild(ccsel);\r\n\tvar wq = TerminusClient.WOQL.query().classMetadata();\r\n\tvar self = this;\r\n\twq.execute(this.ui.client)\r\n\t.then(function(response){\r\n\t\tvar opts = self.getResultsAsOptions(response);\r\n\t\tif(opts){\r\n\t\t\tfor(var i = 0; i<opts.length; i++){\r\n\t\t\t\tccsel.appendChild(opts[i]);\r\n\t\t\t}\r\n\t\t\tself.options = opts;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tccdom.removeChild(ccsel);\r\n\t\t}\r\n\t});\r\n\treturn ccdom;\r\n}\r\n\r\nTerminusClassChooser.prototype.getResultsAsOptions = function(clist){\r\n\tvar choices = [];\r\n\tif(clist.bindings){\r\n\t\tif(this.show_single == false && clist.bindings.length < 2) return false;\r\n\t\tif(this.empty_choice){\r\n\t\t\tvar opt1 = document.createElement(\"option\");\r\n\t\t\topt1.setAttribute(\"class\", \"terminus-class-choice terminus-empty-choice\");\r\n\t\t\topt1.value = \"\";\r\n\t\t\topt1.appendChild(document.createTextNode(this.empty_choice));\r\n\t\t\tchoices.push(opt1);\r\n\t\t}\r\n\t\tvar added = [];\r\n\t\tfor(var i = 0; i<clist.bindings.length; i++){\r\n\t\t\tvar bclass = HTMLFrameHelper.getVariableValueFromBinding(\"Element\", clist.bindings[i]);\r\n\t\t\tif(!bclass) bclass = HTMLFrameHelper.getVariableValueFromBinding(\"Class\", clist.bindings[i]);\r\n\t\t\tif(bclass && added.indexOf(bclass) == -1){\r\n\t\t\t\tadded.push(bclass);\r\n\t\t\t\tvar opt = document.createElement(\"option\");\r\n\t\t\t\topt.setAttribute(\"class\", \"terminus-class-choice\");\r\n\t\t\t\topt.value = bclass;\r\n\t\t\t\tif(opt.value == this.choice){\r\n\t\t\t\t\topt.selected = true;\r\n\t\t\t\t}\r\n\t\t\t\tvar lab = HTMLFrameHelper.getVariableValueFromBinding(\"Label\", clist.bindings[i]);\r\n\t\t\t\tif(!lab || lab == \"unknown\"){\r\n\r\n\t\t\t\t\tlab = TerminusClient.FrameHelper.labelFromURL(bclass);\r\n\r\n\t\t\t\t}\r\n\t\t\t\tif(lab[\"@value\"]) lab = lab[\"@value\"];\r\n\t\t\t\topt.appendChild(document.createTextNode(lab));\r\n\t\t\t\tchoices.push(opt);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn choices;\r\n}\r\n\r\n\r\n\r\nmodule.exports=TerminusClassChooser\r\n","'use strict';\n\nmodule.exports = function bind(fn, thisArg) {\n  return function wrap() {\n    var args = new Array(arguments.length);\n    for (var i = 0; i < args.length; i++) {\n      args[i] = arguments[i];\n    }\n    return fn.apply(thisArg, args);\n  };\n};\n","'use strict';\n\nvar utils = require('./../utils');\n\nfunction encode(val) {\n  return encodeURIComponent(val).\n    replace(/%40/gi, '@').\n    replace(/%3A/gi, ':').\n    replace(/%24/g, '$').\n    replace(/%2C/gi, ',').\n    replace(/%20/g, '+').\n    replace(/%5B/gi, '[').\n    replace(/%5D/gi, ']');\n}\n\n/**\n * Build a URL by appending params to the end\n *\n * @param {string} url The base of the url (e.g., http://www.google.com)\n * @param {object} [params] The params to be appended\n * @returns {string} The formatted url\n */\nmodule.exports = function buildURL(url, params, paramsSerializer) {\n  /*eslint no-param-reassign:0*/\n  if (!params) {\n    return url;\n  }\n\n  var serializedParams;\n  if (paramsSerializer) {\n    serializedParams = paramsSerializer(params);\n  } else if (utils.isURLSearchParams(params)) {\n    serializedParams = params.toString();\n  } else {\n    var parts = [];\n\n    utils.forEach(params, function serialize(val, key) {\n      if (val === null || typeof val === 'undefined') {\n        return;\n      }\n\n      if (utils.isArray(val)) {\n        key = key + '[]';\n      } else {\n        val = [val];\n      }\n\n      utils.forEach(val, function parseValue(v) {\n        if (utils.isDate(v)) {\n          v = v.toISOString();\n        } else if (utils.isObject(v)) {\n          v = JSON.stringify(v);\n        }\n        parts.push(encode(key) + '=' + encode(v));\n      });\n    });\n\n    serializedParams = parts.join('&');\n  }\n\n  if (serializedParams) {\n    var hashmarkIndex = url.indexOf('#');\n    if (hashmarkIndex !== -1) {\n      url = url.slice(0, hashmarkIndex);\n    }\n\n    url += (url.indexOf('?') === -1 ? '?' : '&') + serializedParams;\n  }\n\n  return url;\n};\n","'use strict';\n\nmodule.exports = function isCancel(value) {\n  return !!(value && value.__CANCEL__);\n};\n","'use strict';\n\nvar utils = require('./utils');\nvar normalizeHeaderName = require('./helpers/normalizeHeaderName');\n\nvar DEFAULT_CONTENT_TYPE = {\n  'Content-Type': 'application/x-www-form-urlencoded'\n};\n\nfunction setContentTypeIfUnset(headers, value) {\n  if (!utils.isUndefined(headers) && utils.isUndefined(headers['Content-Type'])) {\n    headers['Content-Type'] = value;\n  }\n}\n\nfunction getDefaultAdapter() {\n  var adapter;\n  // Only Node.JS has a process variable that is of [[Class]] process\n  if (typeof process !== 'undefined' && Object.prototype.toString.call(process) === '[object process]') {\n    // For node use HTTP adapter\n    adapter = require('./adapters/http');\n  } else if (typeof XMLHttpRequest !== 'undefined') {\n    // For browsers use XHR adapter\n    adapter = require('./adapters/xhr');\n  }\n  return adapter;\n}\n\nvar defaults = {\n  adapter: getDefaultAdapter(),\n\n  transformRequest: [function transformRequest(data, headers) {\n    normalizeHeaderName(headers, 'Accept');\n    normalizeHeaderName(headers, 'Content-Type');\n    if (utils.isFormData(data) ||\n      utils.isArrayBuffer(data) ||\n      utils.isBuffer(data) ||\n      utils.isStream(data) ||\n      utils.isFile(data) ||\n      utils.isBlob(data)\n    ) {\n      return data;\n    }\n    if (utils.isArrayBufferView(data)) {\n      return data.buffer;\n    }\n    if (utils.isURLSearchParams(data)) {\n      setContentTypeIfUnset(headers, 'application/x-www-form-urlencoded;charset=utf-8');\n      return data.toString();\n    }\n    if (utils.isObject(data)) {\n      setContentTypeIfUnset(headers, 'application/json;charset=utf-8');\n      return JSON.stringify(data);\n    }\n    return data;\n  }],\n\n  transformResponse: [function transformResponse(data) {\n    /*eslint no-param-reassign:0*/\n    if (typeof data === 'string') {\n      try {\n        data = JSON.parse(data);\n      } catch (e) { /* Ignore */ }\n    }\n    return data;\n  }],\n\n  /**\n   * A timeout in milliseconds to abort a request. If set to 0 (default) a\n   * timeout is not created.\n   */\n  timeout: 0,\n\n  xsrfCookieName: 'XSRF-TOKEN',\n  xsrfHeaderName: 'X-XSRF-TOKEN',\n\n  maxContentLength: -1,\n\n  validateStatus: function validateStatus(status) {\n    return status >= 200 && status < 300;\n  }\n};\n\ndefaults.headers = {\n  common: {\n    'Accept': 'application/json, text/plain, */*'\n  }\n};\n\nutils.forEach(['delete', 'get', 'head'], function forEachMethodNoData(method) {\n  defaults.headers[method] = {};\n});\n\nutils.forEach(['post', 'put', 'patch'], function forEachMethodWithData(method) {\n  defaults.headers[method] = utils.merge(DEFAULT_CONTENT_TYPE);\n});\n\nmodule.exports = defaults;\n","'use strict';\n\nvar utils = require('./../utils');\nvar settle = require('./../core/settle');\nvar buildURL = require('./../helpers/buildURL');\nvar parseHeaders = require('./../helpers/parseHeaders');\nvar isURLSameOrigin = require('./../helpers/isURLSameOrigin');\nvar createError = require('../core/createError');\n\nmodule.exports = function xhrAdapter(config) {\n  return new Promise(function dispatchXhrRequest(resolve, reject) {\n    var requestData = config.data;\n    var requestHeaders = config.headers;\n\n    if (utils.isFormData(requestData)) {\n      delete requestHeaders['Content-Type']; // Let the browser set it\n    }\n\n    var request = new XMLHttpRequest();\n\n    // HTTP basic authentication\n    if (config.auth) {\n      var username = config.auth.username || '';\n      var password = config.auth.password || '';\n      requestHeaders.Authorization = 'Basic ' + btoa(username + ':' + password);\n    }\n\n    request.open(config.method.toUpperCase(), buildURL(config.url, config.params, config.paramsSerializer), true);\n\n    // Set the request timeout in MS\n    request.timeout = config.timeout;\n\n    // Listen for ready state\n    request.onreadystatechange = function handleLoad() {\n      if (!request || request.readyState !== 4) {\n        return;\n      }\n\n      // The request errored out and we didn't get a response, this will be\n      // handled by onerror instead\n      // With one exception: request that using file: protocol, most browsers\n      // will return status as 0 even though it's a successful request\n      if (request.status === 0 && !(request.responseURL && request.responseURL.indexOf('file:') === 0)) {\n        return;\n      }\n\n      // Prepare the response\n      var responseHeaders = 'getAllResponseHeaders' in request ? parseHeaders(request.getAllResponseHeaders()) : null;\n      var responseData = !config.responseType || config.responseType === 'text' ? request.responseText : request.response;\n      var response = {\n        data: responseData,\n        status: request.status,\n        statusText: request.statusText,\n        headers: responseHeaders,\n        config: config,\n        request: request\n      };\n\n      settle(resolve, reject, response);\n\n      // Clean up request\n      request = null;\n    };\n\n    // Handle browser request cancellation (as opposed to a manual cancellation)\n    request.onabort = function handleAbort() {\n      if (!request) {\n        return;\n      }\n\n      reject(createError('Request aborted', config, 'ECONNABORTED', request));\n\n      // Clean up request\n      request = null;\n    };\n\n    // Handle low level network errors\n    request.onerror = function handleError() {\n      // Real errors are hidden from us by the browser\n      // onerror should only fire if it's a network error\n      reject(createError('Network Error', config, null, request));\n\n      // Clean up request\n      request = null;\n    };\n\n    // Handle timeout\n    request.ontimeout = function handleTimeout() {\n      reject(createError('timeout of ' + config.timeout + 'ms exceeded', config, 'ECONNABORTED',\n        request));\n\n      // Clean up request\n      request = null;\n    };\n\n    // Add xsrf header\n    // This is only done if running in a standard browser environment.\n    // Specifically not if we're in a web worker, or react-native.\n    if (utils.isStandardBrowserEnv()) {\n      var cookies = require('./../helpers/cookies');\n\n      // Add xsrf header\n      var xsrfValue = (config.withCredentials || isURLSameOrigin(config.url)) && config.xsrfCookieName ?\n        cookies.read(config.xsrfCookieName) :\n        undefined;\n\n      if (xsrfValue) {\n        requestHeaders[config.xsrfHeaderName] = xsrfValue;\n      }\n    }\n\n    // Add headers to the request\n    if ('setRequestHeader' in request) {\n      utils.forEach(requestHeaders, function setRequestHeader(val, key) {\n        if (typeof requestData === 'undefined' && key.toLowerCase() === 'content-type') {\n          // Remove Content-Type if data is undefined\n          delete requestHeaders[key];\n        } else {\n          // Otherwise add header to the request\n          request.setRequestHeader(key, val);\n        }\n      });\n    }\n\n    // Add withCredentials to request if needed\n    if (config.withCredentials) {\n      request.withCredentials = true;\n    }\n\n    // Add responseType to request if needed\n    if (config.responseType) {\n      try {\n        request.responseType = config.responseType;\n      } catch (e) {\n        // Expected DOMException thrown by browsers not compatible XMLHttpRequest Level 2.\n        // But, this can be suppressed for 'json' type as it can be parsed by default 'transformResponse' function.\n        if (config.responseType !== 'json') {\n          throw e;\n        }\n      }\n    }\n\n    // Handle progress if needed\n    if (typeof config.onDownloadProgress === 'function') {\n      request.addEventListener('progress', config.onDownloadProgress);\n    }\n\n    // Not all browsers support upload events\n    if (typeof config.onUploadProgress === 'function' && request.upload) {\n      request.upload.addEventListener('progress', config.onUploadProgress);\n    }\n\n    if (config.cancelToken) {\n      // Handle cancellation\n      config.cancelToken.promise.then(function onCanceled(cancel) {\n        if (!request) {\n          return;\n        }\n\n        request.abort();\n        reject(cancel);\n        // Clean up request\n        request = null;\n      });\n    }\n\n    if (requestData === undefined) {\n      requestData = null;\n    }\n\n    // Send the request\n    request.send(requestData);\n  });\n};\n","'use strict';\n\nvar enhanceError = require('./enhanceError');\n\n/**\n * Create an Error with the specified message, config, error code, request and response.\n *\n * @param {string} message The error message.\n * @param {Object} config The config.\n * @param {string} [code] The error code (for example, 'ECONNABORTED').\n * @param {Object} [request] The request.\n * @param {Object} [response] The response.\n * @returns {Error} The created error.\n */\nmodule.exports = function createError(message, config, code, request, response) {\n  var error = new Error(message);\n  return enhanceError(error, config, code, request, response);\n};\n","'use strict';\n\nvar utils = require('../utils');\n\n/**\n * Config-specific merge-function which creates a new config-object\n * by merging two configuration objects together.\n *\n * @param {Object} config1\n * @param {Object} config2\n * @returns {Object} New object resulting from merging config2 to config1\n */\nmodule.exports = function mergeConfig(config1, config2) {\n  // eslint-disable-next-line no-param-reassign\n  config2 = config2 || {};\n  var config = {};\n\n  utils.forEach(['url', 'method', 'params', 'data'], function valueFromConfig2(prop) {\n    if (typeof config2[prop] !== 'undefined') {\n      config[prop] = config2[prop];\n    }\n  });\n\n  utils.forEach(['headers', 'auth', 'proxy'], function mergeDeepProperties(prop) {\n    if (utils.isObject(config2[prop])) {\n      config[prop] = utils.deepMerge(config1[prop], config2[prop]);\n    } else if (typeof config2[prop] !== 'undefined') {\n      config[prop] = config2[prop];\n    } else if (utils.isObject(config1[prop])) {\n      config[prop] = utils.deepMerge(config1[prop]);\n    } else if (typeof config1[prop] !== 'undefined') {\n      config[prop] = config1[prop];\n    }\n  });\n\n  utils.forEach([\n    'baseURL', 'transformRequest', 'transformResponse', 'paramsSerializer',\n    'timeout', 'withCredentials', 'adapter', 'responseType', 'xsrfCookieName',\n    'xsrfHeaderName', 'onUploadProgress', 'onDownloadProgress', 'maxContentLength',\n    'validateStatus', 'maxRedirects', 'httpAgent', 'httpsAgent', 'cancelToken',\n    'socketPath'\n  ], function defaultToConfig2(prop) {\n    if (typeof config2[prop] !== 'undefined') {\n      config[prop] = config2[prop];\n    } else if (typeof config1[prop] !== 'undefined') {\n      config[prop] = config1[prop];\n    }\n  });\n\n  return config;\n};\n","'use strict';\n\n/**\n * A `Cancel` is an object that is thrown when an operation is canceled.\n *\n * @class\n * @param {string=} message The message.\n */\nfunction Cancel(message) {\n  this.message = message;\n}\n\nCancel.prototype.toString = function toString() {\n  return 'Cancel' + (this.message ? ': ' + this.message : '');\n};\n\nCancel.prototype.__CANCEL__ = true;\n\nmodule.exports = Cancel;\n","const UTILS = require('./utils.js');\r\nconst CONST = require('./const.js');\r\nconst ErrorMessage = require('./errorMessage');\r\n/*\r\n * Creates an entry in the connection registry for the server\r\n * and all the databases that the client has access to\r\n * maps the input authorties to a per-db array for internal storage and easy\r\n * access control checks\r\n * {doc:dbid => {terminus:authority =>\r\n * [terminus:woql_select, terminus:create_document, auth3, ...]}}\r\n *\r\n */\r\n\r\nfunction ConnectionCapabilities(connectionConfig, key) {\r\n\tthis.connection = {};\r\n\tthis.connectionConfig = connectionConfig;\r\n\tif (this.connectionConfig.server && key) {\r\n\t\tthis.setClientKey(this.connectionConfig.server, key);\r\n\t}\r\n}\r\n\r\nConnectionCapabilities.prototype.getClientKey = function (serverURL) {\r\n\tif (!serverURL) serverURL = this.connectionConfig.serverURL();\r\n\tif (serverURL && this.connection[serverURL]) return this.connection[serverURL].key;\r\n\treturn false;\r\n};\r\n\r\n\r\n/*\r\n * Utility functions for changing the state of connections with Terminus servers\r\n */\r\nConnectionCapabilities.prototype.setClientKey = function (curl, key) {\r\n\tif (typeof key === 'string' && key.trim()) {\r\n\t\tif (typeof this.connection[curl] === 'undefined') {\r\n\t\t\tthis.connection[curl] = {};\r\n\t\t}\r\n\t\tthis.connection[curl].key = key.trim();\r\n\t}\r\n};\r\n\r\n\r\n/**\r\n * @params {string} curl a valid terminusDB server URL\r\n * @params {object} capabilities it is the connect call response\r\n */\r\nConnectionCapabilities.prototype.addConnection = function (curl, capabilities) {\r\n\tif (typeof this.connection[curl] === 'undefined') {\r\n\t\tthis.connection[curl] = {};\r\n\t}\r\n\tconst capabilitiesKeys = capabilities ? Object.keys(capabilities) : [];\r\n\r\n\tfor (const pred of capabilitiesKeys) {\r\n\t    if (pred === 'terminus:authority' && capabilities[pred]) {\r\n\t      const auths = Array.isArray(capabilities[pred]) === true\r\n\t        ? capabilities[pred]\r\n\t        : [capabilities[pred]];\r\n\r\n\t      for (let i = 0; i < auths.length; i += 1) {\r\n\t        let scope = auths[i]['terminus:authority_scope'];\r\n\t        const actions = auths[i]['terminus:action'];\r\n\r\n\t        if (Array.isArray(scope) === false) scope = [scope];\r\n\t        const actionsArr = UTILS.authorityActionsToArr(actions);\r\n\r\n\t        for (let j = 0; j < scope.length; j += 1) {\r\n\t          const nrec = scope[j];\r\n\t          if (typeof this.connection[curl][nrec['@id']] === 'undefined') {\r\n\t            this.connection[curl][nrec['@id']] = nrec;\r\n\t          }\r\n\t          this.connection[curl][nrec['@id']]['terminus:authority'] = actionsArr;\r\n\t        }\r\n\t      }\r\n\t    } else {\r\n\t      this.connection[curl][pred] = capabilities[pred];\r\n\t    }\r\n\t}\r\n};\r\n\r\nConnectionCapabilities.prototype.serverConnected = function () {\r\n\treturn typeof this.connection[this.connectionConfig.server] !== 'undefined';\r\n};\r\n\r\nConnectionCapabilities.prototype.capabilitiesPermit = function (action, dbid, server) {\r\n\tif (!this.connectionConfig.connectionMode()\r\n         || this.connectionConfig.client_checks_capabilities !== true\r\n         || action === CONST.CONNECT) { return true; }\r\n\r\n\tserver = server || this.connectionConfig.server;\r\n\tdbid = dbid || this.connectionConfig.dbid;\r\n\r\n\tlet rec;\r\n\r\n\tif (action === CONST.CREATE_DATABASE) {\r\n\t\trec = this.getServerRecord(server);\r\n\t} else if (dbid) rec = this.getDBRecord(dbid);\r\n\telse console.log('no dbid', server, dbid);\r\n\tif (rec) {\r\n\t\tconst auths = rec['terminus:authority'];\r\n\t\tif (auths && auths.indexOf(`terminus:${action}`) !== -1) return true;\r\n\t} else {\r\n\t\tconsole.log('problem with ', this.connection, action, server, dbid);\r\n\t}\r\n\tthis.error = ErrorMessage.accessDenied(action, dbid, server);\r\n\treturn false;\r\n};\r\n\r\nConnectionCapabilities.prototype.getServerRecord = function (srvr) {\r\n\tconst url = (srvr || this.connectionConfig.server);\r\n\tconst connectionObj = this.connection[url] || {};\r\n\tconst okeys = Object.keys(connectionObj);\r\n\r\n\tfor (const oid of okeys) {\r\n\t\tif (this.connection[url][oid]['@type'] === 'terminus:Server') {\r\n\t\t\treturn this.connection[url][oid];\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nConnectionCapabilities.prototype.getDBRecord = function (dbid, srvr) {\r\n\tconst url = (srvr || this.connectionConfig.server);\r\n\tdbid = (dbid || this.connectionConfig.dbid);\r\n\tif (typeof this.connection[url] !== 'object') {\r\n\t\treturn false;\r\n\t}\r\n\tif (typeof this.connection[url][dbid] !== 'undefined') { return this.connection[url][dbid]; }\r\n\r\n\tdbid = this.dbCapabilityID(dbid);\r\n\r\n\tif (typeof this.connection[url][dbid] !== 'undefined') { return this.connection[url][dbid]; }\r\n\r\n\treturn undefined;\r\n};\r\n\r\nConnectionCapabilities.prototype.getServerDBRecords = function (srvr) {\r\n\tconst url = (srvr || this.connectionConfig.server);\r\n\tconst dbrecs = {};\r\n\tconst connectionObj = this.connection[url] || {};\r\n\r\n\tfor (const oid of Object.keys(connectionObj)) {\r\n\t\tif (this.connection[url][oid]['@type'] === 'terminus:Database') {\r\n\t\t\tdbrecs[oid] = this.connection[url][oid];\r\n\t\t}\r\n\t}\r\n\treturn dbrecs;\r\n};\r\n\r\n/*\r\n * removes a database record from the connection registry (after deletion, for example)\r\n */\r\nConnectionCapabilities.prototype.removeDB = function (dbid, srvr) {\r\n\tdbid = dbid || this.connectionConfig.dbid;\r\n\r\n\tif (dbid && this.connectionConfig.dbid && this.connectionConfig.dbid === dbid) {\r\n\t\tthis.connectionConfig.dbid = false;\r\n\t}\r\n\r\n\tconst url = srvr || this.connectionConfig.server;\r\n\tconst dbidCap = this.dbCapabilityID(dbid);\r\n\tif (dbidCap && this.connection[url] && this.connection[url][dbidCap]) {\r\n\t\tdelete this.connection[url][dbidCap];\r\n\t}\r\n};\r\n\r\n\r\nConnectionCapabilities.prototype.dbCapabilityID = function (dbid) {\r\n\treturn `doc:${dbid}`;\r\n};\r\n\r\nConnectionCapabilities.prototype.getDBRecord = function (dbid, srvr) {\r\n\tconst url = srvr || this.connectionConfig.server;\r\n\tdbid = dbid || this.connectionConfig.dbid;\r\n\tif (typeof this.connection[url] !== 'object') {\r\n\t\treturn false;\r\n\t}\r\n\tif (typeof this.connection[url][dbid] !== 'undefined') { return this.connection[url][dbid]; }\r\n\r\n\tdbid = this.dbCapabilityID(dbid);\r\n\r\n\tif (typeof this.connection[url][dbid] !== 'undefined') { return this.connection[url][dbid]; }\r\n\r\n\treturn undefined;\r\n};\r\n\r\nmodule.exports = ConnectionCapabilities;\r\n","\r\nconst IDParser = require('./terminusIDParser');\r\n\r\nfunction ConnectionConfig(params) {\r\n\tconst newParams = params || {};\r\n\tthis.server = false;\r\n\tthis.dbid = false;\r\n\tthis.docid = false;\r\n\tif (newParams.server) this.setServer(newParams.server);\r\n\tif (newParams.db) this.setDB(newParams.db);\r\n\tif (newParams.doc) this.setDocument(newParams.doc);\r\n\t/*\r\n     * client configuration options - connected_mode = connected\r\n     * tells the client to first connect to the server before invoking other services\r\n     */\r\n\r\n\tthis.connected_mode = newParams.connected_mode || 'connected';\r\n\t// include a terminus:user_key API key in the calls\r\n\tthis.include_key = newParams.include_key || true;\r\n\t// client side checking of access control (in addition to server-side access control)\r\n\tthis.client_checks_capabilities = newParams.client_checks_capabilities || true;\r\n}\r\n\r\nConnectionConfig.prototype.serverURL = function () {\r\n\treturn this.server;\r\n};\r\n\r\n\r\nConnectionConfig.prototype.connectionMode = function () {\r\n\treturn this.connected_mode === 'connected';\r\n};\r\n\r\nConnectionConfig.prototype.includeKey = function () {\r\n\treturn this.include_key === true;\r\n};\r\n\r\nConnectionConfig.prototype.schemaURL = function () {\r\n\treturn `${this.dbURL()}/schema`;\r\n};\r\nConnectionConfig.prototype.queryURL = function () {\r\n\treturn `${this.dbURL()}/woql`;\r\n};\r\nConnectionConfig.prototype.frameURL = function () {\r\n\treturn `${this.dbURL()}/frame`;\r\n};\r\nConnectionConfig.prototype.docURL = function () {\r\n\treturn `${this.dbURL()}/document/${this.docid ? this.docid : ''}`;\r\n};\r\n\r\nConnectionConfig.prototype.dbURL = function (call) {\r\n\t// url swizzling to talk to platform using server/dbid/platform/ pattern..\r\n\tif (this.platformEndpoint()) {\r\n\t\tconst baseURL = this.server.substring(0, this.server.lastIndexOf('/platform/'));\r\n\r\n\t\tif (!call || call !== 'create') {\r\n\t\t\treturn `${baseURL}/${this.dbid}/platform`;\r\n\t\t} if (call === 'platform') {\r\n\t\t\treturn `${baseURL}/${this.dbid}`;\r\n\t\t}\r\n\t}\r\n\treturn this.server + this.dbid;\r\n};\r\n\r\nConnectionConfig.prototype.platformEndpoint = function () {\r\n\tif (this.server && this.server.lastIndexOf('/platform/') === this.server.length - 10) {\r\n\t\treturn true;\r\n\t}\r\n\treturn false;\r\n};\r\n\r\n/**\r\n * Utility functions for setting and parsing urls and determining\r\n * the current server, database and document\r\n */\r\nConnectionConfig.prototype.setServer = function (inputStr, context) {\r\n\tconst parser = new IDParser(context);\r\n\tif (parser.parseServerURL(inputStr)) {\r\n\t\tthis.server = parser.server();\r\n\t\tthis.dbid = false;\r\n\t\tthis.docid = false;\r\n\t\treturn true;\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nConnectionConfig.prototype.setDB = function (inputStr, context) {\r\n\tconst parser = new IDParser(context);\r\n\tif (parser.parseDBID(inputStr)) {\r\n\t\tif (parser.server()) this.server = parser.server();\r\n\t\tthis.dbid = parser.dbid();\r\n\t\tthis.docid = false;\r\n\t\treturn true;\r\n\t}\r\n\treturn false;\r\n};\r\n\r\n// @param {string} inputStr TerminusDB server URL or a valid TerminusDB Id or omitted\r\n\r\nConnectionConfig.prototype.setSchemaURL = function (inputStr, context) {\r\n\tconst parser = new IDParser(context);\r\n\tif (parser.parseSchemaURL(inputStr)) {\r\n\t\tif (parser.server()) this.server = parser.server();\r\n\t\tthis.dbid = parser.dbid();\r\n\t\tthis.docid = false;\r\n\t\treturn true;\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nConnectionConfig.prototype.setDocument = function (inputStr, context) {\r\n\tconst parser = new IDParser(context);\r\n\tif (parser.parseDocumentURL(inputStr)) {\r\n\t\tif (parser.server()) this.server = parser.server();\r\n\t\tif (parser.dbid()) this.dbid = parser.dbid();\r\n\t\tif (parser.docid()) this.docid = parser.docid();\r\n\t\treturn true;\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nConnectionConfig.prototype.setQueryURL = function (inputStr, context) {\r\n\tconst parser = new IDParser(context);\r\n\tif (parser.parseQueryURL(inputStr)) {\r\n\t\tif (parser.server()) this.server = parser.server();\r\n\t\tthis.dbid = parser.dbid();\r\n\t\tthis.docid = false;\r\n\t\treturn true;\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nConnectionConfig.prototype.setClassFrameURL = function (inputStr, context) {\r\n\tconst parser = new IDParser(context);\r\n\tif (parser.parseClassFrameURL(inputStr)) {\r\n\t\tif (parser.server()) this.server = parser.server();\r\n\t\tthis.dbid = parser.dbid();\r\n\t\tthis.docid = false;\r\n\t\treturn true;\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nmodule.exports = ConnectionConfig;\r\n","/*\r\n11.75s$ npm install\r\n6.39s$ npm test\r\n*/\r\n/*\r\n * Helper class for parsing and decomposing Terminus URLs /\r\n * and dealing with namespace prefixed URLs\r\n */\r\n// const URL = require('url').URL;\r\n\r\n/*\r\n\"@context\": {\r\n    \"owl\":\"http://www.w3.org/2002/07/owl#\",\r\n    \"rdf\":\"http://www.w3.org/1999/02/22-rdf-syntax-ns#\",\r\n    \"xsd\":\"http://www.w3.org/2001/XMLSchema#\"\r\n  } */\r\n\r\n\r\nfunction IDParser(context) {\r\n\tthis.context = context;\r\n\tthis.server_url = false;\r\n\tthis.db = false;\r\n\tthis.doc = false;\r\n}\r\n\r\nIDParser.prototype.server = function () {\r\n\treturn this.server_url;\r\n};\r\n\r\nIDParser.prototype.dbid = function () {\r\n\treturn this.db;\r\n};\r\n\r\nIDParser.prototype.docid = function () {\r\n\treturn this.doc;\r\n};\r\n\r\nIDParser.prototype.setContext = function (context) {\r\n\tthis.context = context;\r\n};\r\n\r\nIDParser.prototype.parseServerURL = function (str) {\r\n\tthis.server_url = false;\r\n\r\n\tif (this.validURL(str)) {\r\n\t\tthis.server_url = str;\r\n\t} else if (this.context && this.validPrefixedURL(str, this.context)) {\r\n\t\tthis.server_url = this.expandPrefixed(str, this.context);\r\n\t}\r\n\r\n\tif (this.server_url && this.server_url.lastIndexOf('/') !== this.server_url.length - 1\r\n\t) {\r\n\t\tthis.server_url += '/';\r\n\t}\r\n\treturn this.server_url;\r\n};\r\n\r\nIDParser.prototype.parseDBID = function (str) {\r\n\tthis.db = false;\r\n\tif (this.context && this.validPrefixedURL(str, this.context)) {\r\n\t\tstr = this.expandPrefixed(str, this.context);\r\n\t}\r\n\tif (this.validURL(str)) {\r\n\t\tif (str.lastIndexOf('/') === str.length - 1) {\r\n\t\t\t// trim trailing slash\r\n\t\t\tstr = str.substring(0, str.length - 1);\r\n\t\t}\r\n\t\tconst index = str.lastIndexOf('/');\r\n\r\n\t\tconst serverURL = str.substring(0, index);\r\n\t\t// only dbNamer\r\n\t\tstr = str.substring(index + 1);\r\n\r\n\t\tif (this.parseServerURL(serverURL) === false) return false;\r\n\t}\r\n\r\n\tif (this.validIDString(str)) {\r\n\t\tthis.db = str;\r\n\t}\r\n\treturn this.db;\r\n};\r\n\r\nIDParser.prototype.parseDocumentURL = function (str) {\r\n\tthis.doc = false;\r\n\tif (this.context && this.validPrefixedURL(str, this.context)) {\r\n\t\tstr = this.expandPrefixed(str, this.context);\r\n\t}\r\n\r\n\tif (this.validURL(str)) {\r\n\t\tlet dbURL = str;\r\n\t\tif (str.lastIndexOf('/document/') !== -1) {\r\n\t\t\t// get dbURL\r\n\t\t\tdbURL = str.substring(0, str.lastIndexOf('/document/'));\r\n\t\t\tstr = str.substring(str.lastIndexOf('/document/') + 10);\r\n\t\t}\r\n\t\tif (this.parseDBID(dbURL) === false) return false;\r\n\t}\r\n\tif (str.substring(0, 4) === 'doc:') str = str.substring(4);\r\n\t// check if the document's name hasn't space or '/'\r\n\tif (this.validIDString(str)) {\r\n\t\tthis.doc = str;\r\n\t}\r\n\treturn this.doc;\r\n};\r\n\r\nIDParser.prototype.parseSchemaURL = function (str) {\r\n\tif (this.context && this.validPrefixedURL(str, this.context)) {\r\n\t\tstr = this.expandPrefixed(str, this.context);\r\n\t}\r\n\tif (this.validURL(str)) {\r\n\t\tstr = this.stripOptionalPath(str, 'schema');\r\n\t}\r\n\treturn this.parseDBID(str);\r\n};\r\n\r\nIDParser.prototype.parseQueryURL = function (str) {\r\n\tif (this.context && this.validPrefixedURL(str, this.context)) {\r\n\t\tstr = this.expandPrefixed(str, this.context);\r\n\t}\r\n\tif (this.validURL(str)) {\r\n\t\tstr = this.stripOptionalPath(str, 'woql');\r\n\t\tstr = this.stripOptionalPath(str, 'query');\r\n\t}\r\n\treturn this.parseDBID(str);\r\n};\r\n\r\nIDParser.prototype.stripOptionalPath = function (str, bit) {\r\n\tif (str.indexOf(`/${bit}`) !== -1) str = str.substring(0, str.indexOf(`/${bit}`));\r\n\treturn str;\r\n};\r\n\r\nIDParser.prototype.parseClassFrameURL = function (str) {\r\n\tif (this.context && this.validPrefixedURL(str, this.context)) {\r\n\t\tstr = this.expandPrefixed(str, this.context);\r\n\t}\r\n\tif (this.validURL(str)) {\r\n\t\tstr = this.stripOptionalPath(str, 'frame');\r\n\t}\r\n\treturn this.parseDBID(str);\r\n};\r\n\r\n// Valid URLs are those that start with http:// or https://\r\nIDParser.prototype.validURL = function (str) {\r\n\tif (str.substring(0, 7) === 'http://' || str.substring(0, 8) === 'https://') return true;\r\n\treturn false;\r\n};\r\n\r\nIDParser.prototype.validPrefixedURL = function (str, context) {\r\n\tif (typeof str !== 'string' || typeof context !== 'object') return false;\r\n\tconst parts = str.split(':');\r\n\tif (parts.length !== 2) return false;\r\n\tif (parts[0].length < 1 || parts[1].length < 1) return false;\r\n\tif (context && context[parts[0]] && this.validIDString(parts[1])) return true;\r\n\treturn false;\r\n};\r\n\r\nIDParser.prototype.validIDString = function (str) {\r\n\tif (typeof str !== 'string') return false;\r\n\tif (str.indexOf(':') !== -1 || str.indexOf(' ') !== -1 || str.indexOf('/') !== -1) return false;\r\n\treturn true;\r\n};\r\n\r\nIDParser.prototype.expandPrefixed = function (str, context) {\r\n\tconst parts = str.split(':');\r\n\treturn context[parts[0]] + parts[1];\r\n};\r\n\r\nmodule.exports = IDParser;\r\n","/**\r\n * FramePatternMatcher does pattern matching on frames \r\n * Does a given pattern match a given frame?\r\n */\r\nconst FramePatternMatcher = {}\r\n\r\n/**\r\n * Runs an array of matching rules across a frame and calls the passed onmatch function on each match\r\n * The optional onmatch function is called with each hit and is passed the frame and the rule that hit it.\r\n * A list of the matched rules is returned. \r\n * \r\n */\r\nFramePatternMatcher.testRules = function(rules, frame, onmatch){\r\n\tvar matched_rules = [];\r\n\tif(rules && rules.length){\r\n\t\tfor(var i = 0; i<rules.length; i++){\r\n\t\t\tvar match = (!rules[i].rule.pattern || FramePatternMatcher.patternMatchesFrame(rules[i].rule.pattern, frame));\r\n\t\t\tif(match){\r\n\t\t\t\tmatched_rules.push(rules[i]);\r\n\t\t\t\tif(onmatch && typeof onmatch == \"function\"){\r\n\t\t\t\t\tonmatch(frame, rules[i]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn matched_rules;\r\n}\r\n\r\n/**\r\n * Determines whether a given pattern matches a given frame\r\n */\r\nFramePatternMatcher.patternMatchesFrame = function(pattern, frame){\r\n\tif(typeof pattern == \"object\" && pattern.length){ //multiple patterns are ANDed\r\n\t\tfor(var i = 0 ; i<pattern.length; i++){\r\n\t\t\tvar fp = new FramePattern(pattern[i]);\r\n\t\t\tif(!fp.checkFrame(frame)) return false;\r\n\t\t}\r\n\t\treturn true;\r\n\t}\r\n\telse {\r\n\t\tvar fp = new FramePattern(pattern);\r\n\t\treturn fp.checkFrame(frame);\r\n\t}\r\n}\r\n\r\n\r\n/**\r\n * A frame pattern can have the following variables\r\n * renderer : object, property, data, * - matches a specific part of the frame \r\n * label : matches the label of a property\r\n * frame_type: object, data, document, oneOf\r\n * subject: id of the subject\r\n * subjectClass: class of the subject\r\n * range: type of a property (applies to property and data)\r\n * property: property id or list of property ids (parent property if it is an object or data)\r\n * value: value of the property\r\n * parent: a pattern relating to the parent of this frame\r\n * children: patterns for matching on the children of a frame\r\n * depth: how deep are we in the document? starts from 0\r\n * index: the index of a value in an array\r\n * status: updated, error, new, ok,  \r\n */\r\n\r\nFramePattern = function(pattern){\r\n\tif(pattern){\r\n\t\tthis.setPattern(pattern);\r\n\t}\r\n}\r\n\r\nFramePattern.prototype.setPattern = function(pattern){\r\n\tthis.scope = (pattern.scope ? pattern.scope: false);\r\n\tthis.label = (pattern.label ? pattern.label : false);\r\n\tthis.frame_type = (pattern.frame_type ? pattern.frame_type : false);\r\n\tthis.subject = (pattern.subject ? pattern.subject : false);\r\n\tthis.subjectClass = (pattern.subjectClass ? pattern.subjectClass : false);\r\n\tthis.range = (pattern.range ? pattern.range : false);\r\n\tthis.property = (pattern.property ? pattern.property : false);\r\n\tthis.value = (pattern.value ? pattern.value : false);\r\n\tthis.parent = (pattern.parent ? new FramePattern(pattern.parent) : false);\r\n\tthis.children = [];\r\n\tif(pattern.children){\r\n\t\tfor(var i = 0 ; i < pattern.children.length ; i++){\r\n\t\t\tthis.children.push(new FramePattern(pattern.children[i]));\r\n\t\t}\r\n\t}\r\n\tthis.depth = (typeof pattern.depth != \"undefined\" ? pattern.depth : false);\r\n\tthis.index = (pattern.index ? pattern.index : false);\r\n\tthis.status = (pattern.status ? pattern.status : false);\t\t\r\n}\r\n\t\r\nFramePattern.prototype.checkFrame = function(frame){\r\n\tvar rtype = this.getRendererType(frame);\r\n\tif(!rtype) return false;\r\n\tif(this.scope && (this.scope != rtype) && (this.scope != \"*\" )) return false;\r\n\tif(this.illegalRuleType(rtype)) return false;\r\n\tif(this.frame_type && !this.checkFrameType(rtype, frame)) return false;\r\n\tif(this.label && !this.checkLabel(rtype, frame)) return false;\r\n\tif(this.subject && !this.checkSubject(rtype, frame)) return false;\r\n\tif(this.subjectClass && !this.checkSubjectClass(rtype, frame)) return false;\r\n\tif(this.property && !this.checkProperty(rtype, frame)) return false;\r\n\tif(this.depth !== false && !this.checkDepth(rtype, frame)) return false;\r\n\tif(this.range && !this.checkRange(rtype, frame)) return false;\r\n\tif(this.value && !this.checkValue(rtype, frame)) return false;\r\n\tif(this.parent && !this.checkParent(rtype, frame)) return false;\r\n\tif(this.children && this.children.length && !this.checkChildren(rtype, frame)) return false;\r\n\tif(this.index && !this.checkIndex(rtype, frame)) return false;\r\n\tif(this.status && !this.checkStatus(rtype, frame)) return false;\r\n\treturn true;\r\n} \r\n\r\nFramePattern.prototype.illegalRuleType = function(rtype){\r\n\t//data frames have no children\r\n\tif(rtype == 'data' && this.children.length ) return true;\r\n\t//object frames have no range\r\n\tif(rtype == 'object' && this.range ) return true;\r\n\treturn false;\r\n}\r\n\r\n/* subject is an id or an array of ids, \r\n/* match is positive if the renderer's subject appears in the array or is the id\r\n */\r\nFramePattern.prototype.checkSubject = function(subject, frame){\r\n\tif(typeof this.subject != \"object\" || !this.subject.length) this.subject = [this.subject];\r\n\tvar rsubj = frame.subject();\r\n\tfor(var i = 0 ; i<this.subject.length; i++){\r\n\t\tif(this.IDsMatch(subject[i], rsubj)){\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\n//at least one child must match all child rules\r\nFramePattern.prototype.checkChildren = function(rtype, frame){\r\n\tfor(var i = 0 ; i<this.children.length; i++){\r\n\t\tvar found = false;\r\n\t\tif(rtype == \"object\"){\r\n\t\t\tfor(var prop in frame.properties){\r\n\t\t\t\tif(this.children[i].checkFrame(frame.properties[prop])) {\r\n\t\t\t\t\tfound = true;\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if(rtype == \"property\"){\r\n\t\t\tfor(var j = 0; j <= renderer.values.length; j++){\r\n\t\t\t\tif(this.children[j].checkFrame(frame.values[j])) {\r\n\t\t\t\t\tfound = true;\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(!found) return false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nFramePattern.prototype.checkStatus = function(rtype, frame){\r\n\tif(typeof this.status != \"object\" || this.status.length == 0) this.status = [this.status];\r\n\tfor(var i = 0; i<this.status.length; i++){\r\n\t\tif(this.status[i] == \"updated\" && !frame.isUpdated()) return false;\r\n\t\tif(this.status[i] == \"new\" && !frame.isNew()) return false;\r\n\t\tif(this.status[i] == \"unchanged\" && frame.isUpdated()) return false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nFramePattern.prototype.checkDepth = function(rtype, frame){\r\n\treturn this.numberMatch(this.depth, frame.depth());\r\n}\r\n\r\nFramePattern.prototype.checkParent = function(rtype, frame){\r\n\treturn this.parent.checkFrame(frame.parent);\r\n}\r\n\r\nFramePattern.prototype.checkIndex = function(rtype, frame){\r\n\tif(rtype == 'data'){\r\n\t\treturn this.index == frame.index;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nFramePattern.prototype.checkProperty  = function(rtype, frame){\r\n\tif(typeof this.property != \"object\" || !this.property.length) this.property = [this.property];\r\n\tfor(var i = 0 ; i<this.property.length; i++){\r\n\t\tif(this.propertyIDsMatch(frame.property(), this.property[i])){\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\n//returns true if any of the values are found\r\nFramePattern.prototype.checkValue = function(rtype, frame){\r\n\tif(typeof this.value != \"object\" || !this.value.length) this.value = [this.value];\r\n\tfor(var i = 0 ; i<this.value.length; i++){\r\n\t\tif(rtype == \"data\"){\r\n\t\t\tif(this.valuesMatch(frame.value(), this.value[i])){\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if(rtype == \"property\"){\r\n\t\t\tfor(var j = 0; j<= frame.values.length;  j++){\r\n\t\t\t\tif(this.getRendererType(frame.values[i]) == 'data' &&\r\n\t\t\t\t\t\tthis.valuesMatch(frame.values[i].get(), this.value[i])){\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if(rtype == \"object\"){\r\n\t\t\tfor(var prop in frame.properties){\r\n\t\t\t\tif(this.checkValue(this.getRendererType(frame.properties[prop]), frame.properties[prop])){\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nFramePattern.prototype.checkRange  = function(rtype, frame){\r\n\tif(typeof this.range != \"object\" || !this.range.length) this.range = [this.range];\r\n\tfor(var i = 0 ; i<this.range.length; i++){\r\n\t\tif(this.rangeIDsMatch(frame.range(), this.range[i])){ \r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nFramePattern.prototype.checkSubjectClass = function(rtype, frame){\r\n\tif(typeof this.subjectClass != \"object\" || !this.subjectClass.length) this.subjectClass = [this.subjectClass];\r\n\tvar rcls = frame.subjectClass();\r\n\tfor(var i = 0 ; i<this.subjectClass.length; i++){\r\n\t\tif(this.classIDsMatch(this.subjectClass[i], rcls)){\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nFramePattern.prototype.checkFrameType = function (rtype, frame){\r\n\tif(rtype == \"object\") return this.frame_type == \"object\";\r\n\tif(rtype == \"data\") {\r\n\t\tif(frame.frame){\r\n\t\t\treturn this.frame_type == frame.frame.ftype();\r\n\t\t}\r\n\t}\r\n\tif(rtype == \"property\") return false;\r\n}\r\n\r\nFramePattern.prototype.checkLabel = function(rtype, frame){\r\n\tif(typeof frame.getLabel != \"function\"){\r\n\t\tconsole.log(new Error(\"Rule passed to check label with broken renderer object - no getLabel\"));\r\n\t\treturn false;\r\n\t}\r\n\treturn this.stringMatch(this.label, frame.getLabel());\r\n}\r\n\r\nFramePattern.prototype.IDsMatch = function(ida, idb){\r\n\treturn TerminusClient.FrameHelper.compareIDs(ida, idb);\r\n}\r\n\r\nFramePattern.prototype.classIDsMatch = function(ida, idb){\r\n\treturn this.IDsMatch(ida, idb);\r\n}\r\nFramePattern.prototype.propertyIDsMatch = function(ida, idb){\r\n\tvar match = this.IDsMatch(ida, idb);\r\n\treturn match;\r\n}\r\nFramePattern.prototype.rangeIDsMatch = function(ida, idb){\r\n\treturn this.IDsMatch(ida, idb);\r\n}\r\nFramePattern.prototype.valuesMatch = function(vala, valb){\r\n\treturn vala == valb;\r\n}\r\nFramePattern.prototype.numberMatch = function(vala, valb){\r\n\tif(typeof vala == \"string\"){\r\n\t\ttry {\r\n\t\t\treturn eval(valb + vala);\r\n\t\t}\r\n\t\tcatch(e){\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\treturn vala === valb;\r\n}\r\n\r\nFramePattern.prototype.stringMatch = function(vala, valb){\r\n\tvar pat = new RegExp(vala);\r\n\treturn pat.test(valb);\r\n}\r\n\r\nFramePattern.prototype.getRendererType = function(frame){\r\n\tif(frame.isProperty()) return \"property\";\r\n    if(frame.isObject()) return \"object\";\r\n    if(frame.isData()) return \"data\";\r\n\tif(frame.renderer_type) return frame.renderer_type;\r\n\tconsole.log(new Error(\"frame configuration passed non-renderer type \" + frame.constructor.name));\r\n\tconsole.log(renderer);\r\n\treturn false;\r\n}\r\n\r\nfunction FrameRule(){\r\n\tthis.rule = { pattern: {} };\r\n\treturn this;\r\n}\r\n\r\nFrameRule.prototype.prettyPrint = function(type){\r\n\t//starts with obj. ...\r\n\tif(this.scope() == \"*\"){\r\n\t\tvar str = \".all()\";\r\n\t}\r\n\telse {\r\n\t\tvar str = \".\" + this.scope() + \"()\";\r\n\t}\r\n\tif(typeof this.frameType() != \"undefined\"){\r\n\t\tstr += \".frame_type(\" + JSON.stringify(this.frameType()) + \")\";\r\n\t}\r\n\tif(typeof this.label() != \"undefined\"){\r\n\t\tstr += \".label(\" + JSON.stringify(this.label()) + \")\";\r\n\t}\r\n\tif(typeof this.subject() != \"undefined\"){\r\n\t\tstr += \".subject(\" + JSON.stringify(this.subject()) + \")\";\r\n\t}\r\n\tif(typeof this.subjectClass() != \"undefined\"){\r\n\t\tstr += \".subjectClass(\" + JSON.stringify(this.subjectClass()) + \")\";\r\n\t}\r\n\tif(typeof this.property() != \"undefined\"){\r\n\t\tstr += \".property(\" + JSON.stringify(this.property()) + \")\";\r\n\t}\r\n\tif(typeof this.range() != \"undefined\"){\r\n\t\tstr += \".range(\" + JSON.stringify(this.range()) + \")\";\r\n\t}\r\n\tif(typeof this.value() != \"undefined\"){\r\n\t\tstr += \".value(\" + JSON.stringify(this.range()) + \")\";\r\n\t}\r\n\tif(typeof this.children() != \"undefined\"){\r\n\t\tstr += \".children(\\n\";\r\n\t\tvar kids = this.children();\r\n\t\tfor(var i = 0; i< kids.length; i++){\r\n\t\t\tstr += kids.prettyPrint() + \"\\n\";\r\n\t\t}\r\n\t\tstr += \")\";\r\n\t}\r\n\tif(typeof this.parent() != \"undefined\"){\r\n\t\tstr += \".parent(\" + this.parent.prettyPrint() + \")\";\r\n\t}\r\n\tif(typeof this.depth() != \"undefined\"){\r\n\t\tstr += \".depth('\" + this.depth() + \"')\";\r\n\t}\r\n\tif(typeof this.index() != \"undefined\"){\r\n\t\tstr += \".index(\" + JSON.stringify(this.index()) + \")\";\r\n\t}\r\n\tif(typeof this.status() != \"undefined\"){\r\n\t\tstr += \".status(\" + JSON.stringify(this.status()) + \")\";\r\n\t}\r\n\tif(typeof this.args() != \"undefined\"){\r\n\t\tstr += \".args(\" + JSON.stringify(this.status()) + \")\";\r\n\t}\r\n\tif(typeof this.renderer() != \"undefined\"){\r\n\t\tstr += \".renderer('\" + this.renderer() + \"')\";\r\n\t}\r\n\tif(typeof this.render() != \"undefined\"){\r\n\t\tstr += \".render(\" + this.render() + \")\";\r\n\t}\r\n\tif(typeof this.compare() != \"undefined\"){\r\n\t\tstr += \".compare(\" + this.compare() + \")\";\r\n\t}\r\n\tif(typeof this.mode() != \"undefined\"){\r\n\t\tstr += \".mode('\" + this.mode() + \"')\";\r\n\t}\r\n\tif(typeof this.collapse() != \"undefined\"){\r\n\t\tstr += \".collapse(\" + this.collapse() + \")\";\r\n\t}\r\n\tif(typeof this.hidden() != \"undefined\"){\r\n\t\tstr += \".hidden(\" + this.hidden() + \")\";\r\n\t}\r\n\tif(typeof this.view() != \"undefined\"){\r\n\t\tstr += \".view('\" + this.view() + \"')\";\r\n\t}\r\n\tif(typeof this.showDisabledButtons() != \"undefined\"){\r\n\t\tstr += \".showDisabledButtons(\" + this.showDisabledButtons() + \")\";\r\n\t}\r\n\tif(typeof this.header() != \"undefined\"){\r\n\t\tstr += \".header(\" + this.header() + \")\";\r\n\t}\r\n\tif(typeof this.features() != \"undefined\"){\r\n\t\tstr += \".features(\" + JSON.stringify(this.features()) + \")\";\r\n\t}\r\n\tif(typeof this.headerFeatures() != \"undefined\"){\r\n\t\tstr += \".headerFeatures(\" + JSON.stringify(this.headerFeatures()) + \")\";\r\n\t}\r\n\tif(typeof this.showEmpty() != \"undefined\"){\r\n\t\tstr += \".showEmpty(\" + this.show_empty() + \")\";\r\n\t}\r\n\tif(typeof this.dataviewer() != \"undefined\"){\r\n\t\tstr += \".dataviewer('\" + this.dataviewer() + \"')\";\r\n\t}\r\n\tif(typeof this.args() != \"undefined\"){\r\n\t\tstr += \".args(\" + JSON.stringify(this.args()) + \")\";\r\n\t}\r\n\tif(typeof this.featureRenderers() != \"undefined\"){\r\n\t\tstr += \".featureRenderers({\";\r\n\t\tfor(var f in this.featureRenderers()){\r\n\t\t\tstr += JSON.stringify(f) + \":\" + this.rule.feature_renderers[f] + \",\";\r\n\t\t}\r\n\t\tstr = str.substring(0, str.length-1);\r\n\t\tstr += \"})\";\r\n\t}\r\n\treturn str;\r\n}\r\n\r\n\r\nFrameRule.prototype.scope = function(scope){\r\n\tif(typeof scope == \"undefined\") return this.rule.pattern.scope;\r\n\tthis.rule.pattern.scope = scope;\r\n\treturn this;\r\n}\r\n\r\nFrameRule.prototype.frameType = function(...frametype){\r\n\tif(typeof frametype == \"undefined\" || frametype.length == 0) return this.rule.pattern.frametype;\r\n\tthis.rule.pattern.frametype = frame_type;\r\n\treturn this;\r\n}\r\n\r\nFrameRule.prototype.label = function(...label){\r\n\tif(typeof label == \"undefined\" || label.length == 0) return this.rule.pattern.label;\r\n\tthis.rule.pattern.label = label;\r\n\treturn this;\r\n}\r\n\r\nFrameRule.prototype.subject = function(...subject){\r\n\tif(typeof subject == \"undefined\" || subject.length == 0) return this.rule.pattern.subject;\r\n\tthis.rule.pattern.subject = subject;\r\n\treturn this;\r\n}\r\n\r\nFrameRule.prototype.subjectClass = function(...subjectClass){\r\n\tif(typeof subjectClass == \"undefined\" || subjectClass.length == 0) return this.rule.pattern.subjectClass;\r\n\tthis.rule.pattern.subjectClass = subjectClass;\r\n\treturn this;\r\n}\r\n\r\nFrameRule.prototype.property = function(...property){\r\n\tif(typeof property == \"undefined\" || property.length == 0) return this.rule.pattern.property;\r\n\tthis.rule.pattern.property = property;\r\n\treturn this;\r\n}\r\n\r\nFrameRule.prototype.depth = function(depth){\r\n\tif(typeof depth == \"undefined\") return this.rule.pattern.depth;\r\n\tthis.rule.pattern.depth = depth;\r\n\treturn this;\r\n}\r\n\r\nFrameRule.prototype.range = function(...range){\r\n\tif(typeof range == \"undefined\" || range.length == 0) return this.rule.pattern.range;\t\r\n\tthis.rule.pattern.range = range;\r\n\treturn this;\r\n}\r\n\r\nFrameRule.prototype.value = function(...value){\r\n\tif(typeof value == \"undefined\" || value.length == 0) return this.rule.pattern.value;\t\r\n\tthis.rule.pattern.value = value;\r\n\treturn this;\r\n}\r\n\r\nFrameRule.prototype.pattern = function(){\r\n\treturn this.rule.pattern;\r\n}\r\n\r\nFrameRule.prototype.json = function(){\r\n\treturn this.rule;\r\n}\r\n\r\nFrameRule.prototype.parent = function(parent){\r\n\tif(typeof parent == \"undefined\") return this.rule.pattern.parent;\t\r\n\tthis.rule.pattern.parent = parent.pattern();\r\n\treturn this;\r\n}\r\n\r\nFrameRule.prototype.children = function(...children){\r\n\tif(typeof children == \"undefined\") return this.rule.pattern.children;\t\r\n\tif(typeof this.rule.pattern.children == \"undefined\"){\r\n\t\tthis.rule.pattern.children = [];\r\n\t}\r\n\tfor(var i = 0; i<children.length; i++){\r\n\t\tthis.rule.pattern.children.push(children[i].pattern());\r\n\t}\r\n\treturn this;\r\n}\r\n\r\nFrameRule.prototype.index = function(...index){\r\n\tif(typeof index == \"undefined\" || index.length == 0) return this.rule.pattern.index;\t\r\n\tthis.rule.pattern.index = index;\r\n\treturn this;\t\r\n}\r\n\r\nFrameRule.prototype.status = function(...status){\r\n\tif(typeof status == \"undefined\" || status.length == 0) return this.rule.pattern.status;\t\r\n\tthis.rule.pattern.status = status;\r\n\treturn this;\t\r\n}\r\n\r\nFrameRule.prototype.renderer = function(rend){\r\n\tif(!rend) return this.rule.renderer;\r\n\tthis.rule.renderer = rend;\r\n\treturn this;\r\n}\r\n\r\nFrameRule.prototype.render = function(func){\r\n\tif(func){\r\n\t\tthis.rule.render = func;\r\n\t\treturn this;\r\n\t}\r\n\treturn func;\r\n}\r\n\r\nFrameRule.prototype.args = function(json){\r\n\tif(!json) return this.rule.args;\r\n\tthis.rule.args = json;\r\n\treturn this;\r\n}\r\n\r\nFrameRule.prototype.compare = function(func){\r\n\tif(!func) return this.rule.compare;\r\n\tthis.rule.compare = func;\r\n\treturn this;\r\n}\r\n\r\nFrameRule.prototype.mode = function(m){\r\n\tif(!m) return this.rule.mode;\r\n\tthis.rule.mode = m;\r\n\treturn this;\r\n}\r\n\r\nFrameRule.prototype.collapse = function(m){\r\n\tif(!m) return this.rule.collapse;\r\n\tthis.rule.collapse = m;\r\n\treturn this;\r\n}\r\n\r\n\r\nFrameRule.prototype.hidden = function(m){\r\n\tif(!m) return this.rule.hidden;\r\n\tthis.rule.hidden = m;\r\n\treturn this;\r\n}\r\n\r\nFrameRule.prototype.view = function(m){\r\n\tif(!m) return this.rule.view;\r\n\tthis.rule.view = m;\r\n\treturn this;\r\n}\r\n\r\nFrameRule.prototype.showDisabledButtons = function(m){\r\n\tif(!m) return this.rule.show_disabled_buttons;\r\n\tthis.rule.show_disabled_buttons = m;\r\n\treturn this;\r\n}\r\n\r\nFrameRule.prototype.features = function(...m){\r\n\tif(typeof m == \"undefined\" || m.length == 0) return this.rule.features;\r\n\tthis.rule.features = m;\r\n\treturn this;\r\n}\r\n\r\nFrameRule.prototype.headerFeatures = function(...m){\r\n\tif(typeof m == \"undefined\" || m.length == 0) return this.rule.header_features;\r\n\tthis.rule.header_features = m;\r\n\treturn this;\r\n}\r\n\r\nFrameRule.prototype.header = function(m){\r\n\tif(!m) return this.rule.header;\r\n\tthis.rule.header = m;\r\n\treturn this;\r\n}\r\n\r\nFrameRule.prototype.featureRenderers = function(m){\r\n\tif(!m) return this.rule.feature_renderers;\r\n\tthis.rule.feature_renderers = m;\r\n\treturn this;\r\n}\r\n\r\nFrameRule.prototype.showEmpty = function(m){\r\n\tif(!m) return this.rule.show_empty;\r\n\tthis.rule.show_empty = m;\r\n\treturn this;\r\n}\r\n\r\nFrameRule.prototype.dataviewer = function(m){\r\n\tif(!m) return this.rule.dataviewer;\r\n\tthis.rule.dataviewer = m;\r\n\treturn this;\r\n}\r\n\r\nmodule.exports = {FramePatternMatcher, FramePattern, FrameRule } ;\r\n","const WOQLQuery = require('./client/WOQLQuery');\r\nconst Renderers = require('./client/ObjectRenderer');\r\nconst HTMLFrameHelper = require('./html/HTMLFrameHelper');\r\nconst TerminusDBViewer = require('./TerminusDB');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\nconst UTILS=require('./Utils');\r\n\r\nfunction TerminusDocumentViewer(ui, action, options){\r\n\tthis.ui = ui;\r\n\tthis.server = this.ui.server();\r\n\tthis.db = this.ui.db();\r\n\tthis.init();\r\n\tthis.page_config = (options && options.page_config ? options.page_config : \"view\");\r\n\tthis.mode = (options && options.mode ? options.mode : \"view\");\r\n\tthis.editor = (options && options.editor ? options.editor : false);\r\n\tthis.load_schema = (options && options.load_schema ? options.load_schema : true);\r\n\tthis.config_options = this.getBuiltInViewerOptions();\r\n\tthis.options = (options ? options : this.config_options[action]);\r\n\tthis.action = action;\r\n\tthis.document = false;\r\n\tthis.dbViewer = new TerminusDBViewer.TerminusDBViewer(this.ui);\r\n}\r\n\r\nTerminusDocumentViewer.prototype.init = function(){\r\n\tconst tbv = new TerminusDBViewer.TerminusDBViewer(this.ui);\r\n\tvar wq = new WOQLQuery(this.ui.client, this.options, this.ui);\r\n\tvar woql = wq.getClassMetaDataQuery();\r\n\tvar self = this;\r\n\tself.classmeta = {};\r\n\tself.instancemeta = {};\r\n\twq.execute(woql).then(function(wresult){\r\n\t\tif(wresult && wresult.hasBindings()){\r\n\t\t\tfor(var i = 0; i<wresult.bindings.length; i++){\r\n\t\t\t\tvar cls = HTMLFrameHelper.getVariableValueFromBinding(\"Element\", wresult.bindings[i]);\r\n\t\t\t\tif(cls && typeof self.classmeta[cls] == \"undefined\"){\r\n\t\t\t\t\tself.classmeta[cls] = wresult.bindings[i];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tself.refreshPage();\r\n\t\t}\r\n\t})\r\n\t.catch(function(e){\r\n\t\tconsole.log(e);\r\n\t});\r\n}\r\n\r\nTerminusDocumentViewer.prototype.getJsonLdViewer = function(){\r\n\tswitch(this.page_config){\r\n\t\tcase 'view':\r\n\t\t\tvar self = this;\r\n\t\t\tthis.ui.client.getDocument()\r\n\t\t\t.then(function(response){\r\n\t\t\t\tself.ui.clearBusy();\r\n\t\t\t    TerminusClient.FrameHelper.removeChildren(self.pagedom);\r\n\t\t\t\tvar label = response['@id']; // get doc id\r\n\t\t\t\tvar header = document.createElement('div');\r\n\t\t\t\theader.setAttribute('class', 'terminus-application-header');\r\n\t\t\t\theader.appendChild(document.createTextNode('jsonld format of ' + label));\r\n\t\t\t\tself.pagedom.appendChild(header);\r\n\t\t\t    var res = document.createElement('pre');\r\n\t\t\t\tself.document_json_response = response;\r\n\t\t\t\tres.innerHTML = JSON.stringify(response, undefined, 2);\r\n\t\t\t    res.setAttribute('class', 'terminus-api-explorer-text-area');\r\n\t\t\t\tUTILS.stylizeCodeDisplay(self.ui, res, self.pagedom, 'javascript');\r\n\t\t\t})\r\n\t\t\t.catch(function(e){\r\n\t\t\t\tself.ui.clearBusy();\r\n\t\t\t\tthrow(e);\r\n\t\t\t});\r\n\t\tbreak;\r\n\t\tcase 'create':\r\n\t\t\tTerminusClient.FrameHelper.removeChildren(this.pagedom);\r\n\t\t\tvar header = document.createElement('div');\r\n\t\t\theader.setAttribute('class', 'terminus-application-header');\r\n\t\t \tvar ohv = new ObjectViewer.HTMLObjectHeaderViewer();\r\n\t\t\theader.appendChild(ohv.getObjectIDDOM(this.renderer));\r\n\t\t\t//header.appendChild(document.createTextNode('Create new document in jsonld format'));\r\n\t\t\theader.appendChild(this.getDocumentJsonldCreateButton());\r\n\t\t\tthis.pagedom.appendChild(header);\r\n\t\t\tvar res = document.createElement('textarea');\r\n\t\t\tthis.json_editor = res;\r\n\t\t\tthis.pagedom.appendChild(res);\r\n\t\t\tres.setAttribute('class', 'terminus-api-explorer-text-area');\r\n\t\t\tUTILS.stylizeEditor(this.ui, res, 'doc-json-create', 'javascript');\r\n\t\t\tbreak;\r\n\t}\r\n}\r\n\r\nTerminusDocumentViewer.prototype.getEncodingChooserDOM = function() {\r\n\tvar scd = document.createElement(\"div\");\r\n\tscd.setAttribute(\"class\", \"terminus-document-creator terminus-form-horizontal terminus-control-group\");\r\n\tvar nbuts = document.createElement(\"div\");\r\n\tnbuts.setAttribute(\"class\", \"terminus-control-buttons terminus-document-creator-buttons\");\r\n\tvar enc = document.createElement('select');\r\n\tenc.setAttribute('class', 'terminus-doc-config terminus-enc');\r\n\tvar oframe = document.createElement('option');\r\n\toframe.setAttribute('value', 'frame');\r\n\toframe.appendChild(document.createTextNode('HTML'));\r\n\tenc.appendChild(oframe);\r\n\tvar ojson = document.createElement('option');\r\n\tojson.setAttribute('value', 'jsonld');\r\n\tojson.appendChild(document.createTextNode('JSON-LD'));\r\n\tenc.appendChild(ojson);\r\n\tnbuts.appendChild(enc);\r\n\tvar self = this;\r\n\tenc.addEventListener('change', function(e){\r\n\t\tself.viewMode = this.value;\r\n\t\tswitch(self.page_config){\r\n\t\t\tcase 'view':\r\n\t\t\t\tself.page_config = 'view';\r\n\t\t\t\tif(this.value == 'frame'){\r\n\t\t\t\t\tself.renderer = false;\r\n\t\t\t\t\tself.refreshPage();\r\n\t\t\t\t}\r\n\t\t\t\telse self.getJsonLdViewer();\r\n\t\t\tbreak;\r\n\t\t\tcase 'create':\r\n\t\t\t\tself.page_config = 'create';\r\n\t\t\t\tif(this.value == 'frame'){\r\n\t\t\t\t\tself.renderer = false;\r\n\t\t\t\t\tself.refreshPage();\r\n\t\t\t\t}\r\n\t\t\t\telse self.getJsonLdViewer();\r\n\t\t\tbreak;\r\n\t\t}\r\n\t})\r\n\tvar ccDOM = document.createElement(\"span\");\r\n\tccDOM.setAttribute(\"class\", \"create-document-list\");\r\n\tccDOM.appendChild(nbuts);\r\n\tscd.appendChild(ccDOM);\r\n\treturn scd;\r\n}\r\n\r\nTerminusDocumentViewer.prototype.getDocumentChooserDOM = function(holder){\r\n\tvar self = this;\r\n\tvar scd = document.createElement(\"span\");\r\n\tscd.setAttribute(\"class\", \"terminus-get-doc terminus-document-chooser terminus-form-horizontal terminus-control-group\");\r\n\tvar lab = document.createElement(\"span\");\r\n\tlab.setAttribute(\"class\", \"terminus-document-chooser-label terminus-doc-control-label terminus-control-label-padding\");\r\n\tvar dcip = document.createElement(\"input\");\r\n\tdcip.setAttribute(\"class\", \"terminus-form-doc-value terminus-document-chooser terminus-doc-input-text\");\r\n\tdcip.setAttribute(\"placeholder\", \"Enter Document ID to view.\");\r\n\tvar nbut = document.createElement(\"button\");\r\n\tnbut.setAttribute('class', \"terminus-control-button terminus-document-button terminus-doc-btn\")\r\n\tnbut.setAttribute('title', 'Enter Document ID to view');\r\n\tvar i = document.createElement('i');\r\n\ti.setAttribute('class', 'fa fa-check');\r\n\tnbut.appendChild(i);\r\n\tnbut.addEventListener(\"click\", function(){\r\n\t\tif(dcip.value) {\r\n\t\t\tself.ui.showDocument(dcip.value);\r\n\t\t}\r\n\t})\r\n\tif(this.ui.client.connectionConfig.platformEndpoint() && this.ui.pluginAvailable(\"select2\")){\r\n\t\tvar mcls = TerminusClient.FrameHelper.unshorten(\"tcs:Document\");\r\n\t\tvar d2ch = new TerminusDocumentChooser(this.ui, mcls);\r\n\t\td2ch.change = function(val){\r\n\t\t\tself.ui.showDocument(val);\r\n\t\t}\r\n\t\td2ch.view = \"label\";\r\n\t\tvar sdom = d2ch.getAsDOM('terminus-class-select');\r\n\t\tjQuery(dcip).hide();\r\n\t\tjQuery(nbut).hide();\r\n\t\tvar nlab = document.createElement(\"a\");\r\n\t\tnlab.setAttribute(\"href\", \"#\");\r\n\t\tnlab.setAttribute(\"class\", \"terminus-document-which-chooser\");\r\n\t\tnlab.appendChild(document.createTextNode(\"Choose by ID\"));\r\n\t\tvar show = \"label\";\r\n\t\tjQuery(nlab).click(function(){\r\n\t\t\tif(show == \"label\"){\r\n\t\t\t\tshow = \"id\";\r\n\t\t\t\tjQuery(dcip).show();\r\n\t\t\t\tjQuery(nbut).show();\r\n\t\t\t\tjQuery(sdom).hide();\r\n\t\t\t\tjQuery(nlab).text(\"Choose by Label\");\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tshow = \"label\";\r\n\t\t\t\tjQuery(dcip).hide();\r\n\t\t\t\tjQuery(nbut).hide();\r\n\t\t\t\tjQuery(sdom).show();\r\n\t\t\t\tjQuery(nlab).text(\"Choose by ID\");\r\n\t\t\t}\r\n\t\t})\r\n\t\tscd.appendChild(sdom);\r\n\t\tscd.prepend(nlab);\r\n\t}\r\n\tvar nbuts = document.createElement(\"span\");\r\n\tnbuts.setAttribute(\"class\", \"terminus-control-buttons terminus-document-chooser-buttons\");\r\n\tnbuts.appendChild(nbut);\r\n\tscd.appendChild(lab);\r\n\tscd.appendChild(dcip);\r\n\tscd.appendChild(nbuts);\r\n\tholder.appendChild(scd);\r\n};\r\n\r\nTerminusDocumentViewer.prototype.getDocumentCreatorSelect = function(){\r\n\tvar wq = new WOQLQuery(this.ui.client, {}, this.ui);\r\n\tvar filter = wq.getConcreteDocumentClassPattern(\"v:Element\");\r\n\tvar termcc = new TerminusClassChooser(this.ui, filter);\r\n\ttermcc.empty_choice = \"Create Document of Type\";\r\n\tvar self = this;\r\n\ttermcc.change = function(new_class){\r\n\t\tif(new_class){\r\n\t\t\tself.ui.showCreateDocument(new_class);\r\n\t\t\ttermcc.choice = false;\r\n\t\t}\r\n\t}\r\n\tvar tcdom = termcc.getAsDOM('terminus-class-select');\r\n\treturn tcdom;\r\n}\r\n\r\nTerminusDocumentViewer.prototype.getDocumentCreatorDOM = function(){\r\n\tvar self = this;\r\n\tvar scd = document.createElement(\"div\");\r\n\tscd.setAttribute(\"class\", \"terminus-create-doc terminus-document-creator terminus-form-horizontal terminus-control-group\");\r\n\t// get dropdown with list of types\r\n\tvar nbuts = document.createElement(\"div\");\r\n\tnbuts.setAttribute(\"class\", \"terminus-control-buttons terminus-document-creator-buttons\");\r\n\t// get input type\r\n\tvar dcip = document.createElement(\"input\");\r\n\tdcip.setAttribute(\"class\", \"terminus-form-doc-value terminus-document-creator\");\r\n\tdcip.setAttribute(\"placeholder\", \"Enter Document Type\");\r\n\tvar nbut = document.createElement(\"button\");\r\n\tvar lab = document.createElement(\"span\");\r\n\tlab.setAttribute(\"class\", \"document-creator-label terminus-control-label terminus-control-label-padding\");\r\n\tnbut.setAttribute('class', \"terminus-control-button create-document-button terminus-doc-btn\")\r\n\tvar i = document.createElement('i');\r\n\ti.setAttribute('title', 'Input which document type to create');\r\n\ti.setAttribute('class', 'fa fa-check');\r\n\tnbut.appendChild(i);\r\n\tnbut.addEventListener(\"click\", function(){\r\n\t\tif(dcip.value) self.ui.showCreateDocument(dcip.value);\r\n\t})\r\n\tvar ccDOM = document.createElement(\"span\");\r\n\tccDOM.setAttribute(\"class\", \"create-document-list terminus-display-flex\");\r\n\tccDOM.appendChild(this.getDocumentCreatorSelect());\r\n\t//ccDOM.appendChild(tcdom);\r\n\tccDOM.appendChild(dcip);\r\n\tccDOM.appendChild(nbut);\r\n\tccDOM.appendChild(this.getEncodingChooserDOM());\r\n\tscd.appendChild(ccDOM);\r\n\treturn scd;\r\n};\r\n\r\nTerminusDocumentViewer.prototype.getDocumentJsonldCreateButton = function(){\r\n\tvar cr = document.createElement('button');\r\n\tcr.innerHTML = 'Save';\r\n\tcr.setAttribute('class', 'terminus-btn terminus-btn-float-right');\r\n\tvar self = this;\r\n\tcr.addEventListener('click', function(){\r\n\t\tif (!UTILS.checkForMandatoryId()) return;\r\n\t\tself.ui.showBusy();\r\n\t\tself.createDocument(self.renderer.idDOM.value, JSON.parse(self.json_editor.value))\r\n\t\t.then(function(page_config){\r\n\t\t\tif(page_config == 'home'){\r\n\t\t\t\tTerminusClient.FrameHelper.removeChildren(self.pagedom);\r\n\t\t\t\tself.getListOfDocuments(self.pagedom);\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\tself.page_config = \"view\";\r\n\t\t\t\tself.mode = self.page_config;\r\n\t\t\t\tself.renderer = false;\r\n\t\t\t\tself.refreshPage();\r\n\t\t\t}\r\n\t\t})\r\n\t\t.catch(function(error) {\r\n\t\t\tself.ui.clearBusy();\r\n\t\t\tself.ui.showError(error);\r\n\t\t});\r\n\t})\r\n\treturn cr;\r\n}\r\n\r\nTerminusDocumentViewer.prototype.getDocumentJsonldSaveButton = function(){\r\n\tvar sv = document.createElement('button');\r\n\tsv.innerHTML = 'Save';\r\n\tsv.setAttribute('class', 'terminus-btn terminus-btn-float-right');\r\n\tvar self = this;\r\n\tsv.addEventListener('click', function(){\r\n\t\tself.ui.showBusy();\r\n\t\tself.updateDocument(JSON.parse(self.json_editor.value))\r\n\t\t.then(function(){\r\n\t\t\tself.page_config = \"view\";\r\n\t\t\tself.renderer = false;\r\n\t\t\tself.refreshPage();\r\n\t\t})\r\n\t\t.catch(function(error) {\r\n\t\t\tself.ui.clearBusy();\r\n\t\t\tself.ui.showError(error);\r\n\t\t});\r\n\t})\r\n\treturn sv;\r\n}\r\n\r\nTerminusDocumentViewer.prototype.toggleControlActions = function(button){\r\n\tvar enc = document.getElementsByClassName('terminus-enc');\r\n\tif(button.innerHTML === 'Edit'){\r\n\t\tif(enc.length > 0) enc[0].style.display = 'none';\r\n\t\tbutton.innerHTML = 'Cancel';\r\n\t\tif(this.viewMode == 'frame'){\r\n\t\t\tthis.page_config = \"edit\";\r\n\t\t\tthis.renderer = false;\r\n\t\t\tthis.refreshPage();\r\n\t\t}\r\n\t\telse {\r\n\t\t\tTerminusClient.FrameHelper.removeChildren(this.pagedom);\r\n\t\t\tvar label = this.document_json_response['@id']; // get doc id\r\n\t\t\tvar header = document.createElement('div');\r\n\t\t\theader.setAttribute('class', 'terminus-application-header');\r\n\t\t\theader.appendChild(document.createTextNode('Edit ' + label + ' in jsonld format'));\r\n\t\t\theader.appendChild(this.getDocumentJsonldSaveButton());\r\n\t\t\tthis.pagedom.appendChild(header);\r\n\t\t\tvar res = document.createElement('textarea');\r\n\t\t\tthis.json_editor = res;\r\n\t\t\tthis.pagedom.appendChild(res);\r\n\t\t\tres.appendChild(document.createTextNode(JSON.stringify(this.document_json_response, undefined, 2)));\r\n\t\t\tres.setAttribute('class', 'terminus-api-explorer-text-area');\r\n\t\t\tUTILS.stylizeEditor(this.ui, res, 'doc-json', 'javascript');\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tbutton.innerHTML = 'Edit';\r\n\t\tif(enc.length > 0) enc[0].style.display = 'block';\r\n\t\tif(this.viewMode == 'frame'){\r\n\t\t\tthis.page_config = \"view\";\r\n\t\t\tthis.renderer = false;\r\n\t\t\tthis.refreshPage();\r\n\t\t}\r\n\t\telse{ //jsonld\r\n\t\t\tthis.getJsonLdViewer();\r\n\t\t}\r\n\t}\r\n}\r\n\r\nTerminusDocumentViewer.prototype.getListOfDocuments = function(holder){\r\n\tvar lod = document.createElement('div');\r\n\tlod.setAttribute('class', 'terminus-list-of-doc');\r\n\tlod.appendChild(UTILS.getHeaderDom('List of Documents'))\r\n\tholder.appendChild(lod);\r\n\tthis.dbViewer.getClassesDOM(holder);\r\n}\r\n\r\nTerminusDocumentViewer.prototype.getDocumentEditControls = function(holder, doc){\r\n\tvar sp = document.createElement('span');\r\n\tsp.setAttribute('class', 'terminus-document-page-controls');\r\n\tholder.appendChild(sp);\r\n    sp.appendChild(this.getEncodingChooserDOM());\r\n\tvar dpc = document.createElement('button');\r\n\tdpc.setAttribute('class', 'terminus-btn terminus-document-config');\r\n\tdpc.innerHTML = 'Edit';\r\n\tsp.appendChild(dpc);\r\n\tvar self = this;\r\n\tdpc.addEventListener(\"click\", function(){\r\n\t\tself.toggleControlActions(dpc);\r\n\t})\r\n }\r\n\r\nTerminusDocumentViewer.prototype.getDocumentSubMenus = function(feature, ul, holder, active){\r\n \tvar a = document.createElement('a');\r\n     a.setAttribute('class', 'terminus-a terminus-hz-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\r\n \tvar self = this;\r\n \tswitch(feature){\r\n \t\tcase 'get_document':\r\n \t\t\ta.appendChild(document.createTextNode('View Document'));\r\n \t\t\t// set selected nav after redrawMainPage and home page\r\n \t\t\tif(active) a.classList.add('terminus-submenu-selected');\r\n \t\t\tif((this.page_config == 'view') || (this.page_config == 'home')){ // hide in create mode\r\n \t\t\t\tvar sp = document.createElement('span');\r\n \t\t\t\tsp.setAttribute('class', 'terminus-display-flex');\r\n \t\t\t\tholder.appendChild(sp);\r\n \t\t\t\tthis.getDocumentChooserDOM(sp);\r\n \t\t\t\tthis.viewMode = 'frame';\r\n \t\t\t}\r\n \t\t\tif(this.page_config == 'view') this.getDocumentEditControls(sp);\r\n \t\t\ta.addEventListener('click', function(){\r\n \t\t\t\tTerminusClient.FrameHelper.removeChildren(self.pagedom);\r\n \t\t\t\tTerminusClient.FrameHelper.removeChildren(self.controldom);\r\n \t\t\t\tself.page_config = 'home';\r\n \t\t\t\tself.loadDocumentHome();\r\n \t\t\t});\r\n \t\tbreak;\r\n \t\tcase 'create_document':\r\n \t\t\ta.appendChild(document.createTextNode('Create Document'));\r\n \t\t    if(active) a.classList.add('terminus-submenu-selected');\r\n \t\t    holder.appendChild(self.getDocumentCreatorDOM());\r\n \t\t\ta.addEventListener('click', function(){\r\n \t\t\t\tTerminusClient.FrameHelper.removeChildren(holder);\r\n \t\t\t\tUTILS.setSelectedSubMenu(this);\r\n \t\t\t\tholder.appendChild(self.getDocumentCreatorDOM());\r\n \t\t\t});\r\n \t\tbreak;\r\n \t\tdefault:\r\n \t\t\tconsole.log('Invalid features in TerminusDocument');\r\n \t\tbreak;\r\n \t} // switch(feature)\r\n \tul.appendChild(a);\r\n }\r\n\r\nTerminusDocumentViewer.prototype.loadDocumentHome = function(){\r\n \tvar self = this;\r\n \tvar ul = document.createElement('ul');\r\n \tul.setAttribute('class','terminus-ul-horizontal');\r\n \tthis.controldom.appendChild(ul);\r\n \tvar holder = document.createElement('div');\r\n \tholder.setAttribute('class', 'terminus-doc-holder');\r\n \tthis.controldom.appendChild(holder);\r\n \tvar controls = document.createElement('span');\r\n \tcontrols.setAttribute('class', 'terminus-display-flex');\r\n \tholder.appendChild(controls);\r\n \tswitch(this.page_config){\r\n \t\tcase 'view':\r\n \t\t\tif(this.ui.showControl(\"get_document\"))\r\n \t\t\t\tthis.getDocumentSubMenus('get_document', ul, controls, true);\r\n \t\t\tcontrols.appendChild(this.getDocumentCreatorSelect());\r\n \t\tbreak;\r\n \t\tcase 'create':\r\n \t\t\tif(this.ui.showControl(\"create_document\")){\r\n \t\t\t\tthis.getDocumentSubMenus('get_document', ul, controls, false);\r\n \t\t\t\tthis.getDocumentSubMenus('create_document', ul, holder, true);\r\n \t\t\t}\r\n \t\tbreak;\r\n \t\tcase 'home':\r\n \t\t\tif(this.ui.showControl(\"get_document\"))\r\n \t\t\t\tthis.getDocumentSubMenus('get_document', ul, controls, true);\r\n \t\t    var sd = document.createElement('div');\r\n \t\t\tsd.setAttribute('class', 'terminus-class-chooser-align');\r\n \t\t\tcontrols.appendChild(sd);\r\n \t\t\tsd.appendChild(this.getDocumentCreatorSelect());\r\n \t\t\tthis.getListOfDocuments(holder);\r\n \t\tbreak;\r\n \t\tcase 'default':\r\n \t\t\tconsole.log('Invalid page config passed in TerminusDocument.js');\r\n \t\tbreak;\r\n \t}\r\n }\r\n\r\nTerminusDocumentViewer.prototype.getAsDOM = function(){\r\n\tthis.holder = document.createElement(\"div\");\r\n\tthis.controldom = document.createElement(\"div\");\r\n\tthis.controldom.setAttribute(\"class\", \"terminus-document-controls\");\r\n\tthis.pagedom = document.createElement(\"div\");\r\n\tthis.pagedom.setAttribute(\"class\", \"terminus-document-viewer\");\r\n\tthis.loadDocumentHome();\r\n\tthis.holder.appendChild(this.controldom);\r\n\tthis.holder.appendChild(this.pagedom);\r\n\treturn this.holder;\r\n}\r\n\r\nTerminusDocumentViewer.prototype.getInstanceMeta = function(elid){\r\n\tvar self = this;\r\n\tif(self.instancemeta && typeof self.instancemeta[elid] != \"undefined\") return self.instancemeta[elid] ;\r\n\tvar wq = new WOQLQuery(this.ui.client, this.options, this.ui);\r\n\tvar woql = wq.getInstanceMeta(elid);\r\n\treturn wq.execute(woql).then(function(wresult){\r\n\t\tif(wresult && wresult.hasBindings()){\r\n\t\t\tvar res = wresult.bindings[0];\r\n\t\t\treturn res;\r\n\t\t}\r\n\t\treturn false;\r\n\t})\r\n\t.catch(function(e){\r\n\t\tconsole.log(e);\r\n\t});\r\n}\r\n\r\nTerminusDocumentViewer.prototype.getClassMeta = function(cls){\r\n\tif(typeof this.classmeta[cls]){\r\n\t\treturn this.classmeta[cls];\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nTerminusDocumentViewer.prototype.loadCreateDocument = function(url){\r\n\tif(url){\r\n\t\tthis.ui.showBusy(\"Fetching frame for document class \" + url);\r\n\t\tvar self = this;\r\n\t\tthis.mode = \"edit\";\r\n\t\tthis.page_config = \"create\";\r\n\t\tif(url.indexOf(\"/\") == -1 && url.indexOf(\":\") == -1) {\r\n\t\t\turl = \"schema:\" + url;\r\n\t\t}\r\n\t\treturn this.loadDocumentSchema(url)\r\n\t\t.then(function(response){\r\n\t\t\tself.ui.clearBusy();\r\n\t\t\tself.setLabel();\r\n\t\t})\r\n\t\t.catch(function(error) {\r\n\t\t\tconsole.error(error);\r\n\t\t\tself.ui.clearBusy();\r\n\t\t\tself.ui.showError(error);\r\n\t\t});\r\n\t}\r\n}\r\n\r\nTerminusDocumentViewer.prototype.loadDocument = function(url, cls){\r\n\tif(!url) return false;\r\n\tvar self = this;\r\n\tif(url.substring(0,4) == \"doc:\"){\r\n\t\turl = url.substring(4);\r\n\t}\r\n\tthis.page_config = \"view\";\r\n\turl = url.replace(\"/candidate\", \"/platform/document\");\r\n\tthis.ui.showBusy(\"Loading Document from \" + url);\r\n\treturn this.ui.client.getDocument(url, {\"terminus:encoding\": \"terminus:frame\"})\r\n\t.then(function(response){\r\n\t\tself.ui.clearBusy();\r\n\t\tself.loadDataFrames(response);\r\n\t\tself.setLabel();\r\n\t\tself.refreshPage();\r\n\t\tif(self.load_schema){\r\n\t\t\tself.loadDocumentSchema(self.document.cls).then(function(){ self.refreshPage()}).catch(function(e){console.error(e)});\r\n\t\t}\r\n\t\treturn response;\r\n\t})\r\n\t.catch(function(error) {\r\n\t\tconsole.error(error);\r\n\t\tself.ui.clearBusy();\r\n\t\tself.ui.showError(error);\r\n\t});\r\n}\r\n\r\nTerminusDocumentViewer.prototype.loadDocumentSchema = function(cls){\r\n\tvar self = this;\r\n\tvar ncls = TerminusClient.FrameHelper.unshorten(cls);\r\n\treturn this.ui.client.getClassFrame(false, ncls)\r\n\t.then(function(response){\r\n\t\tself.loadSchemaFrames(response, cls);\r\n\t\tself.refreshPage();\r\n\t});\r\n}\r\n\r\nTerminusDocumentViewer.prototype.deleteDocument = function(URL){\r\n\tthis.document = false;\r\n\tvar self = this;\r\n\tthis.ui.showBusy(\"Deleting Document \" + URL);\r\n\treturn this.ui.client.deleteDocument(URL)\r\n\t.then(function(response){\r\n\t\tself.ui.clearBusy();\r\n\t}).catch(function(error){\r\n\t\tself.ui.clearBusy();\r\n\t\tself.ui.showError(error);\r\n\t});\r\n}\r\n\r\nTerminusDocumentViewer.prototype.createDocument = function(id, extr){\r\n\tvar self = this;\r\n\tvar opts = { \"terminus:encoding\": \"jsonld\" };\r\n\tthis.ui.showBusy(\"Creating document\");\r\n\treturn this.ui.client.createDocument(id, extr, opts)\r\n\t.then(function(response){\r\n\t\tself.ui.clearBusy();\r\n\t\tself.ui.showDocument(id);\r\n\t}).catch(function(error){\r\n\t\tself.ui.clearBusy();\r\n\t\tif(error.data && error.data['terminus:witnesses']){\r\n\t\t\tself.ui.showViolations(error.data['terminus:witnesses'], \"instance\");\r\n\t\t}\r\n\t\telse {\r\n\t\t\tself.ui.showError(error);\r\n\t\t}\r\n\t\tself.page_config = 'home';\r\n\t\treturn self.page_config;\r\n\t});\r\n}\r\n\r\nTerminusDocumentViewer.prototype.updateDocument = function(extr){\r\n\tvar durl = this.document.subjid;\r\n\tvar self = this;\r\n\tvar opts = { \"terminus:encoding\": \"jsonld\" };\r\n\tthis.ui.showBusy(\"Updating document \" + durl);\r\n\treturn this.ui.client.updateDocument(durl, extr, opts)\r\n\t.then(function(response){\r\n\t\tself.ui.clearBusy();\r\n\t\tself.ui.showDocument(durl);\r\n\t}).catch(function(error){\r\n\t\tself.ui.clearBusy();\r\n\t\tif(error.data && error.data['terminus:witnesses']){\r\n\t\t\tself.ui.showViolations(error.data['terminus:witnesses'], \"instance\");\r\n\t\t}\r\n\t\telse {\r\n\t\t\tself.ui.showError(error);\r\n\t\t}\r\n\t});\r\n}\r\n\r\nTerminusDocumentViewer.prototype.loadDataFrames = function(dataframes, cls){\r\n\tif(!cls){\r\n\t\tif(this.document) cls = this.document.cls;\r\n\t\telse {\r\n\t\t\tif(dataframes && dataframes.length && dataframes[0] && dataframes[0].domain){\r\n\t\t\t\tcls = dataframes[0].domain;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tif(cls){\r\n\t\tif(!this.document){\r\n\t\t\tthis.document = new TerminusClient.ObjectFrame(cls, dataframes);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.document.loadDataFrames(dataframes);\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tconsole.log(\"Missing Class\" + \" \" + \"Failed to add dataframes due to missing class\");\r\n\t}\r\n}\r\n\r\n\r\nTerminusDocumentViewer.prototype.loadSchemaFrames = function(classframes, cls){\r\n\tif(!cls){\r\n\t\tif(classframes && classframes.length && classframes[0] && classframes[0].domain){\r\n\t\t\tcls = classframes[0].domain;\r\n\t\t}\r\n\t}\r\n\tif(cls){\r\n\t\tif(!this.document){\r\n\t\t\tthis.document = new TerminusClient.ObjectFrame(cls);\r\n\t\t}\r\n\t\tif(classframes){\r\n\t\t\tthis.document.loadClassFrames(classframes);\r\n\t\t\tif(!this.document.subjid){\r\n\t\t\t\tthis.document.newDoc = true;\r\n\t\t\t\tthis.document.fillFromSchema(\"_:\");\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tconsole.log(\"Missing Class\", \"Failed to add class frames due to missing class\");\r\n\t}\r\n}\r\n\r\nTerminusDocumentViewer.prototype.render = function(){\r\n\tif(!this.renderer && this.document){\r\n\t\tif(this.page_config){\r\n\t\t\tthis.options = this.getOptionsFromPageConfig(this.page_config);\r\n\t\t}\r\n\t\ttry{\r\n\t\t\tthis.renderer = new Renderers.ObjectRenderer(this.document, false, this.options);\r\n\t\t\tthis.renderer.mode = this.mode;\r\n\t\t\tthis.renderer.controller = this;\r\n\t\t}catch(e){\r\n\t \t\tconsole.error('TerminusDocumentViewer render',e.toString())\r\n\t \t}\r\n\t}\r\n\tif(this.renderer){\r\n\t\treturn this.renderer.render();\r\n\t}\r\n}\r\n\r\nTerminusDocumentViewer.prototype.getBuiltInViewerOptions = function(){\r\n\treturn FrameConfig;\r\n}\r\n\r\nTerminusDocumentViewer.prototype.getOptionsFromPageConfig = function(pageconf){\r\n\tif(typeof this.config_options[pageconf] == \"object\") {\r\n\t\treturn this.config_options[pageconf];\r\n\t}\r\n\treturn this.options;\r\n}\r\n\r\n\r\nTerminusDocumentViewer.prototype.getClient = function(){\r\n\treturn this.ui.client;\r\n}\r\n\r\nTerminusDocumentViewer.prototype.extract = function(options){\r\n\treturn this.renderer.extract();\r\n}\r\n\r\nTerminusDocumentViewer.prototype.getLabel = function(){\r\n\tvar lab = (this.cls ? this.cls : false);\r\n\tif(!lab) lab = (this.docid ? this.docid : \"Void\");\r\n\treturn lab;\r\n}\r\n\r\nTerminusDocumentViewer.prototype.setLabel = function(){\r\n\tif(this.document && this.labdom){\r\n\t\tTerminusClient.FrameHelper.removeChildren(this.labdom);\r\n\t\tvar dfs = this.document.getDataFrames(TerminusClient.FrameHelper.getStdURL(\"rdfs\", \"label\"));\r\n\t\tfor(var i = 0; i< dfs.length; i++){\r\n\t\t\tvar lab = dfs[i].get();\r\n\t\t\tif(lab) {\r\n\t\t\t\tthis.labdom.appendChild(document.createTextNode(lab));\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\nTerminusDocumentViewer.prototype.refreshPage = function(){\r\n\tif(this.pagedom){\r\n\t\tTerminusClient.FrameHelper.removeChildren(this.pagedom);\r\n\t\tvar rends = this.render();\r\n\t\tif(rends){\r\n\t\t\tthis.pagedom.appendChild(rends);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nTerminusDocumentViewer.prototype.getDocumentPageControls = function(){\r\n\tvar dpc = document.createElement(\"select\");\r\n\tdpc.setAttribute(\"class\", \"terminus-form-select terminus-document-config\");\r\n\tfor(var i in this.config_options){\r\n\t\tif(i === 'create') continue; // create docuemnt option from config is not taken in edit mode\r\n\t\tvar opt = document.createElement(\"option\");\r\n\t\topt.value = i;\r\n\t\tif(this.page_config == i){\r\n\t\t\topt.selected = true;\r\n\t\t}\r\n\t\topt.appendChild(document.createTextNode(this.config_options[i].label));\r\n\t\tdpc.appendChild(opt);\r\n\t}\r\n\tvar self = this;\r\n\tdpc.addEventListener(\"change\", function(){\r\n\t\tself.page_config = this.value;\r\n\t\tself.renderer = false;\r\n\t\tself.refreshPage();\r\n\t})\r\n\treturn dpc;\r\n}\r\n\r\nmodule.exports=TerminusDocumentViewer\r\n","const TerminusPluginManager = require('../plugins/TerminusPlugin');\r\nconst Datatables = require('../plugins/datatables.terminus');\r\nconst UTILS=require('../Utils');\r\nconst HTMLFrameHelper = require('../html/HTMLFrameHelper');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction WOQLResult(res, query, options, ui){\r\n\tthis.ui = ui;\r\n\tthis.query = query;\r\n\tthis.bindings = ((res && res.bindings) ? res.bindings : []);\r\n}\r\n\r\nWOQLResult.prototype.count = function(){\r\n\treturn this.bindings.length;\r\n}\r\n\r\nWOQLResult.prototype.shorten = function(url){\r\n\treturn this.query.shorten(url);\r\n}\r\n\r\nWOQLResult.prototype.hasBindings = function(result){\r\n\tif(result) return (result.bindings && result.bindings.length);\r\n\telse return (this.bindings && this.bindings.length);\r\n}\r\n\r\n\r\nfunction WOQLResultsViewer(ui, wresult, woqlResult, options, settings, queryPage){\r\n\tthis.ui = ui;\r\n\tthis.result = wresult;\r\n\tthis.woqlResult = woqlResult;\r\n\tthis.max_cell_size = 400;\r\n\tthis.max_word_size = 60;\r\n\tthis.options = options;\r\n\tthis.qPage = queryPage;\r\n\t//this.wqlRes = new WOQLResult();\r\n\tthis.pman = new TerminusPluginManager();\r\n\tthis.settings = settings;\r\n}\r\n\r\nWOQLResultsViewer.prototype.showTable = function(){\r\n\tif(this.options && typeof this.options.show_table != \"undefined\") return this.options.show_table;\r\n\treturn true;\r\n}\r\n\r\nWOQLResultsViewer.prototype.orderColumns = function(sample){\r\n\tvar ordered = [];\r\n\tfor(var h in sample){\r\n\t\tif(ordered.indexOf(h) == -1){\r\n\t\t\tordered.unshift(h);\r\n\t\t}\r\n\t}\r\n\treturn ordered;\r\n}\r\n\r\nWOQLResultsViewer.prototype.getAsDOM = function(resultDOM, displayResultHeader){\r\n\tvar rs = document.createElement('div');\r\n\tresultDOM.appendChild(rs);\r\n\r\n\tif(displayResultHeader){\r\n\t\tvar rh = document.createElement('div');\r\n\t\trh.setAttribute(\"class\", \"terminus-margin-top-bottom terminus-module-head\");\r\n\t\trh.appendChild(document.createTextNode(\"Results\"));\r\n\t\trs.appendChild(rh);\r\n\t}\r\n\tif(this.result && this.woqlResult.hasBindings(this.result) && this.showTable()){\r\n\t\tthis.getTableDOM(this.result.bindings, rs);\r\n\t\treturn rs;\r\n\t}\r\n\telse {\r\n\t\tnor = document.createElement('div');\r\n\t\tnor.setAttribute('class', 'terminus-no-res-alert');\r\n\t\tnor.appendChild(document.createTextNode(\"No results available, create new ones to view them here...\"));\r\n\t\trs.appendChild(nor);\r\n\t\treturn rs;\r\n\t}\r\n}\r\n\r\nWOQLResultsViewer.prototype.getTableDOM = function(bindings, resultDOM){\r\n\tif(this.pman.pluginAvailable(\"datatables\")){\r\n\t\tvar dtResult = this.getTable(bindings, true, {});\r\n\t\tresultDOM.appendChild(dtResult.tab);\r\n\t\tvar dt = new Datatables.Datatables(this, this.qPage);\r\n\t\tdt.draw(dtResult, resultDOM);\r\n\t\tresultDOM.classList.add('terminus-expandable');\r\n\t\tresultDOM.classList.add('terminus-dt-result-cont');\r\n\t\treturn tab;\r\n    }\r\n\telse {\r\n\t\tvar tab = this.getTable(bindings, false, {});\r\n\t\tresultDOM.appendChild(tab);\r\n\t}\r\n}\r\n\r\nWOQLResultsViewer.prototype.getDtTableDOMOnChange = function(bindings, resultDOM, pageInfo){\r\n\t\tvar dtResult = this.getTable(bindings, true, pageInfo);\r\n\t\tresultDOM.appendChild(dtResult.tab);\r\n\t\treturn dtResult;\r\n}\r\n\r\nWOQLResultsViewer.prototype.formatResultsForDatatableDisplay = function(bindings, pageInfo){\r\n    var columns = [], colDataData = {}, data = [], formattedResult = {}, arr = [];\r\n\tvar dtResult = {};\r\n    var ordered_headings = this.orderColumns(bindings[0]);\r\n\t// get columns\r\n\tfor(var i = 0; i<ordered_headings.length; i++){\r\n\t\tvar clab = TerminusClient.FrameHelper.validURL(ordered_headings[i]) ? TerminusClient.FrameHelper.labelFromURL(ordered_headings[i]) : ordered_headings[i];\r\n        columns.push({data: clab});\r\n\t}\r\n\t// get data for respective columns\r\n\tfor(var i = 0; i<bindings.length; i++){\r\n\t\tcolDataData = {};\r\n\t\tfor(var j = 0; j<ordered_headings.length; j++){\r\n\t\t\tif(typeof bindings[i][ordered_headings[j]] == \"object\"){\r\n\t\t\t\tvar lab = (bindings[i][ordered_headings[j]]['@value'] ? bindings[i][ordered_headings[j]]['@value'] : \"Object?\");\r\n\t\t\t\tvar wrap = document.createElement(\"p\");\r\n\t\t\t\twrap.setAttribute(\"class\", \"terminus-table-content\");\r\n\t\t\t\tHTMLFrameHelper.wrapShortenedText(wrap, lab, this.max_cell_size, this.max_word_size);\r\n\t\t\t\tlab = wrap.innerText;\r\n\t\t\t}\r\n\t\t\telse if(typeof bindings[i][ordered_headings[j]] == \"string\") {\r\n\t\t\t\t//var lab = this.result.shorten(bindings[i][ordered_headings[j]]);\r\n\t\t\t\tvar lab = bindings[i][ordered_headings[j]];\r\n\t\t\t\tif(lab == \"unknown\") lab = \"\";\r\n\t\t\t\telse if(lab.substring(0, 4) == \"doc:\"){\r\n\t\t\t\t\tvar a = document.createElement(\"a\");\r\n\t\t\t\t\ta.setAttribute(\"title\", lab);\r\n\t\t\t\t\ta.setAttribute(\"href\", '#');\r\n\t\t\t\t\ta.appendChild(document.createTextNode(lab));\r\n\t\t\t\t\tlab = a.outerHTML;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar clab = TerminusClient.FrameHelper.validURL(ordered_headings[j]) ? TerminusClient.FrameHelper.labelFromURL(ordered_headings[j]) : ordered_headings[j];\r\n\t\t\tcolDataData[clab] = lab;\r\n\t\t}\r\n\t\tdata.push(colDataData);\r\n\t}\r\n\tdtResult.columns                = columns;\r\n\tformattedResult.data            = data;\r\n\tformattedResult.recordsTotal    = 65;\r\n\tformattedResult.recordsFiltered = 65;\r\n\tformattedResult.draw \t\t\t= pageInfo.draw;\r\n\tdtResult.data \t\t\t\t\t= formattedResult;\r\n\treturn dtResult;\r\n}\r\n\r\nWOQLResultsViewer.prototype.getTableBody = function(bindings, ordered_headings){\r\n\tvar tbody = document.createElement(\"tbody\");\r\n\tvar self = this;\r\n\tfor(var i = 0; i<bindings.length; i++){\r\n\t\tvar tr = document.createElement(\"tr\");\r\n\t\tfor(var j = 0; j<ordered_headings.length; j++){\r\n\t\t\tvar td = document.createElement(\"td\");\r\n\t\t\tif(typeof bindings[i][ordered_headings[j]] == \"object\"){\r\n\t\t\t\tvar lab = (bindings[i][ordered_headings[j]]['@value'] ? bindings[i][ordered_headings[j]]['@value'] : \"?\");\r\n\t\t\t}\r\n\t\t\telse if(typeof bindings[i][ordered_headings[j]] == \"string\") {\r\n\t\t\t\t//var lab = this.result.shorten(bindings[i][ordered_headings[j]]);\r\n\t\t\t\tvar lab = bindings[i][ordered_headings[j]];\r\n\t\t\t}\r\n\t\t\tif(lab == \"unknown\") lab = \"\";\r\n\t\t\tif(lab.substring(0, 4) == \"doc:\"){\r\n\t\t\t\tvar a = this.getDocumentLocalLink(lab);\r\n\t\t\t\ttd.appendChild(a);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tHTMLFrameHelper.wrapShortenedText(td, lab, this.max_cell_size, this.max_word_size);\r\n\t\t\t}\r\n\t\t\ttr.appendChild(td);\r\n\t\t}\r\n\t\ttbody.appendChild(tr);\r\n\t}\r\n\treturn tbody;\r\n}\r\n\r\nWOQLResultsViewer.prototype.selectDocumentNavBar = function(ui) {\r\n\tUTILS.removeSelectedNavClass(\"terminus-selected\");\r\n\tvar dnav = document.getElementsByClassName('terminus-document-nav');\r\n\tdnav[0].classList.add(\"terminus-selected\");\r\n\tUTILS.displayDocumentSubMenus(ui);\r\n}\r\n\r\nWOQLResultsViewer.prototype.getDocumentLocalLink = function(lab){\r\n\tvar a = document.createElement(\"a\");\r\n\ta.setAttribute(\"title\", lab);\r\n\ta.setAttribute(\"href\", '#');\r\n\tvar self = this;\r\n\ta.addEventListener(\"click\", function(){\r\n\t\tif(self.result.ui) {\r\n\t\t\tself.result.ui.showDocument(this.title);\r\n\t\t\t//self.result.ui.redraw();\r\n\t\t\tself.selectDocumentNavBar(self.ui);\r\n\t\t}\r\n\t});\r\n\ta.appendChild(document.createTextNode(lab));\r\n\treturn a;\r\n}\r\n\r\nWOQLResultsViewer.prototype.getTable = function(bindings, dtPlugin, pageInfo){\r\n\tvar tab = document.createElement(\"table\");\r\n\ttab.setAttribute(\"class\", \"terminus-hover-table\");\r\n\tvar thead = document.createElement(\"thead\");\r\n\tvar thr = document.createElement(\"tr\");\r\n\tvar ordered_headings = this.orderColumns(bindings[0]);\r\n\tfor(var i = 0; i<ordered_headings.length; i++){\r\n\t\tvar th = document.createElement(\"th\");\r\n\t\tth.setAttribute('class', 'terminus-table-header-full-css');\r\n\t\tvar clab = (ordered_headings[i].indexOf(\"http\") != -1) ? TerminusClient.FrameHelper.labelFromURL(ordered_headings[i]) : ordered_headings[i];\r\n\t\tth.appendChild(document.createTextNode(clab));\r\n\t\tthr.appendChild(th);\r\n\t}\r\n\tthead.appendChild(thr);\r\n\ttab.appendChild(thead);\r\n\tif(dtPlugin){\r\n\t\tvar tbody = document.createElement(\"tbody\");\r\n\t\ttab.appendChild(tbody);\r\n\t\tvar dtResult ={};\r\n\t\tdtResult.result = this.formatResultsForDatatableDisplay(bindings, pageInfo);\r\n\t\tdtResult.tab = tab;\r\n\t\treturn dtResult;\r\n\t}\r\n\telse {\r\n\t\tvar tbody = this.getTableBody(bindings, ordered_headings);\r\n\t\ttab.appendChild(tbody);\r\n\t\treturn tab;\r\n\t}\r\n}\r\n\r\n\r\nmodule.exports={WOQLResultsViewer, WOQLResult}\r\n","const TerminusClient = require('@terminusdb/terminus-client');\r\nconst HTMLFrameHelper = require('../html/HTMLFrameHelper');\r\nconst UTILS= require('../Utils')\r\n\r\n/*** client side processing ***/\r\nfunction CspDatatables(ui){\r\n    this.ui = ui;\r\n}\r\n\r\nCspDatatables.prototype.convertToDatatable = function(tab){\r\n    var dt = this;\r\n    var table = jQuery(tab).DataTable({\r\n         searching : false,\r\n         pageLength: 25,\r\n         lengthMenu: [10, 25, 50, 75, 100],\r\n         paging    : true,\r\n         select    : true,\r\n         initComplete: function(settings) {\r\n                        var ict =settings.oInstance.api();\r\n                        ict.$('td').each(function(){\r\n                            this.setAttribute('title', $(this).html())\r\n                        })},\r\n         columnDefs:[{targets:'_all',className:\"truncate\"}],\r\n         createdRow: function(row) {\r\n                            var td = $(row).find(\".truncate\");\r\n                            td.attr(\"title\", td.html());}\r\n    }); //jQuery(tab)\r\n\r\n    // on click of row connect to db, on click of 5th column delete db\r\n    jQuery(tab, 'tbody').on('click', 'td', function(){\r\n        if(table.cell(this).index().column == 5){\r\n            var dbInfo = table.row(jQuery(this).parents('tr')).data();\r\n            var dbId = UTILS.extractValueFromCell(dbInfo[0]);\r\n            dt.ui.deleteDatabase(dbId);\r\n            return;\r\n        }\r\n        else dt.ui.showDBMainPage();\r\n     }); // on click\r\n\r\n    tab.setAttribute('class'      , 'stripe dataTable terminus-db-size');\r\n    tab.setAttribute('cellpadding', '1');\r\n    tab.setAttribute('cellspacing', '0');\r\n    tab.setAttribute('border'     , '0');\r\n    return tab;\r\n}\r\n\r\nCspDatatables.prototype.draw = function(dtResult){\r\n    return(this.convertToDatatable(dtResult));\r\n}\r\n\r\n/*** server side processing ***/\r\nfunction Datatables(wResViewer, qPage){\r\n   this.wrViewer = wResViewer;\r\n   this.wQuery = wResViewer.wQuery;\r\n   this.ui = wResViewer.ui;\r\n   this.qPage = qPage;\r\n   this.currDTSettings = wResViewer.settings;\r\n}\r\n\r\n/*\r\n    query: new woqlquery with current pagination changes\r\n    pageInfo: current drawCallBack page change info\r\n    resultDOM: result dom on veiwer page\r\n*/\r\nDatatables.prototype.executeQuery = function(qObj, pageInfo, resultDOM){\r\n    var self = this;\r\n    // return this.wQuery.execute(query)\r\n    return qObj.execute(this.ui.client)\r\n    .then(function(result){\r\n      var dtResult = {};\r\n      var wqRes = new TerminusClient.WOQLResult(result, qObj);\r\n      dtResult = self.wrViewer.formatResultsForDatatableDisplay(result.bindings, pageInfo)\r\n      return dtResult.data;\r\n    })\r\n    .catch(function(err){\r\n      console.error(err);\r\n      self.ui.showError(err);\r\n    });\r\n}\r\n\r\n/* get query string based on datatable pagination and current query */\r\n/*Datatables.prototype.getQueryOnPagination = function(wq, settings){\r\n    switch(settings.query){\r\n        case 'Show_All_Documents':\r\n            return wq.getAllDocumentQuery(null, settings.pageLength, settings.start);\r\n        break;\r\n        case 'Show_All_Data':\r\n            return wq.getEverythingQuery(null, settings.pageLength, settings.start);\r\n        break;\r\n        case 'Show_All_Schema_Elements':\r\n            return wq.getElementMetaDataQuery(null, settings.pageLength, settings.start);\r\n        break;\r\n        case 'Show_Document_Classes':\r\n        \tvar sqp = wq.getConcreteDocumentClassPattern(\"Class\");\r\n            return wq.getClassMetaDataQuery(sqp);\r\n        break;\r\n        case 'Show_All_Properties':\r\n            return wq.getPropertyListQuery(null, settings.pageLength, settings.start);\r\n        break;\r\n        case 'Show_All_Classes':\r\n            return wq.getClassMetaDataQuery(null, settings.pageLength, settings.start);\r\n        break;\r\n        case 'Show_Data_Class':\r\n            return  wq.getDataOfChosenClassQuery(settings.chosenValue, settings.pageLength, settings.start);\r\n        break;\r\n        case 'Show_Property_Class':\r\n            return wq.getDataOfChosenPropertyQuery(settings.chosenValue, settings.pageLength, settings.start);\r\n        break;\r\n        case 'Show_Document_Info_by_Id':\r\n            return wq.getDocumentQuery(settings.chosenValue, settings.pageLength, settings.start);\r\n        break;\r\n        case 'Show_All_Document_classes':\r\n            return wq.getClassesQuery(settings.pageLength, settings.start);\r\n        break;\r\n        default:\r\n            console.log('Invalid woql option passed');\r\n        break;\r\n\r\n    }\r\n}   */\r\n/*\r\n    pageInfo: current drawCallBack page change info\r\n*/\r\nDatatables.prototype.generateNewQueryOnPageChange = function(pageInfo){\r\n    if(this.qPage) UTILS.deleteStylizedEditor(this.ui, pageInfo.qTextDom);\r\n    var qObj = UTILS.getCurrentWoqlQueryObject(null, pageInfo);\r\n    //var query = this.getQueryOnPagination(this.wQuery, pageInfo)\r\n    if(this.qPage) {\r\n        if(pageInfo.queryMode.value == 'woql')\r\n            pageInfo.qTextDom.value = JSON.stringify(qObj.prettyPrint(), undefined, 2);\r\n        else pageInfo.qTextDom.value = JSON.stringify(qObj, undefined, 2);\r\n        UTILS.stylizeEditor(this.ui, pageInfo.qTextDom, 'query', 'javascript');\r\n    }\r\n    //return query;\r\n    return qObj;\r\n}\r\n\r\n/*\r\n    dt: Datatable reference\r\n    len : current number of records to display\r\n*/\r\nDatatables.prototype.getCallbackSettings = function(dt, dtAPIChangeSettings){\r\n    var pageInfo = {};\r\n    pageInfo.pageLength  = dtAPIChangeSettings._iDisplayLength;\r\n    pageInfo.start       = dtAPIChangeSettings._iDisplayStart;\r\n    pageInfo.draw        = dtAPIChangeSettings.iDraw;\r\n    pageInfo.qTextDom    = dt.qTextDom;\r\n    pageInfo.queryMode   = dt.queryMode;\r\n    if(this.qPage) pageInfo.query = dt.query;\r\n    else pageInfo.query = 'Show_All_Document_classes';\r\n    pageInfo.chosenValue = dt.chosenValue;\r\n    return pageInfo;\r\n}\r\n\r\n/*\r\n    tab: datatable table dom\r\n    settings : settings from woql txt generator\r\n    resultDOM: result dom of viewer\r\n*/\r\nDatatables.prototype.setUp = function(tab, settings, resultDOM){\r\n    // delete previous datatable\r\n    TerminusClient.FrameHelper.removeChildren(this.dtdom);\r\n    this.dtdom = document.createElement('div');\r\n    this.dtdom.appendChild(tab);\r\n    resultDOM.appendChild(this.dtdom);\r\n    // saving query text box dom to change limit value on change of datatable page length\r\n    this.qTextDom = settings.qTextDom;\r\n    this.query = settings.query;\r\n    this.chosenValue = settings.chosenValue;\r\n    this.queryMode = settings.queryMode;\r\n}\r\n\r\n// update datatables settings so it can be reused in WOQLTextboxGenerator to re write query in woql/ jsonld\r\nDatatables.prototype.updateCurrDTSettings = function(pageInfo){\r\n    this.currDTSettings.pageLength = pageInfo.pageLength;\r\n    this.currDTSettings.start      = pageInfo.start;\r\n}\r\n\r\nDatatables.prototype.getNewDataOnChange = function(drawnTab, aSettings, resultDOM){\r\n    var pageInfo = this.getCallbackSettings(this, aSettings);\r\n    this.updateCurrDTSettings(pageInfo);\r\n   // var query = this.generateNewQueryOnPageChange(pageInfo);\r\n    var qObj = this.generateNewQueryOnPageChange(pageInfo);\r\n    return this.executeQuery(qObj, pageInfo, resultDOM);\r\n    //return this.executeQuery(query, pageInfo, resultDOM);\r\n    //return  dtResult.result.data;\r\n}\r\n\r\nDatatables.prototype.getDataFromServer = function(dtResult, resultDOM){\r\n    var dt = this;\r\n    var tab = dtResult.tab;\r\n    this.setUp(tab, this.wrViewer.settings, resultDOM);\r\n    // initialize datatables\r\n    var table = jQuery(tab).DataTable({\r\n         searching   : false,\r\n         pageLength  : dt.wrViewer.settings.pageLength,\r\n         serverSide  : true,\r\n         processing  : true,\r\n         lengthMenu  : [25, 50, 75, 100],\r\n         dom         : 'RBlftip',\r\n         columns     : dtResult.result.columns,\r\n         paging      : true,\r\n         select      : true,\r\n         autoWidth   : true,\r\n         ajax        : function (data, callback, settings) {\r\n                            if(Object.entries(dtResult.result.data).length > 0){\r\n                                // first draw is loaded\r\n                                var res = dtResult.result.data;\r\n                                dtResult.result.data = {};\r\n                                callback(res);\r\n                            }\r\n                            else{\r\n                                dt.getNewDataOnChange(this, settings, resultDOM)\r\n                                    .then(function(result){\r\n                                     callback(result);\r\n                                })\r\n                            }\r\n                       },\r\n         buttons     : [{ extend: 'copy', text: 'Copy to clipboard' },\r\n                        { extend: 'excel', text: 'Export to Excel' }],\r\n         columnDefs  : [{ targets:'_all',\r\n                          className:\"truncate\"}],\r\n         createdRow  : function(row){\r\n                            var td = $(row).find(\".truncate\");\r\n                            td.attr(\"title\", td.html());},\r\n         scrollX     : true\r\n    }); //jQuery(tab)\r\n\r\n    // on click of doc\r\n    jQuery(tab, 'tbody').on('click', 'td', function(){\r\n        if(table.cell(this).data){\r\n            if(this.innerText.substring(0, 4) == \"doc:\"){\r\n                if(dt.wrViewer.result.ui) {\r\n        \t\t\tdt.wrViewer.result.ui.showDocument(this.innerText);\r\n        \t\t\tdt.wrViewer.result.ui.redraw();\r\n        \t\t\tdt.wrViewer.selectDocumentNavBar(dt.ui);\r\n        \t\t}\r\n            }\r\n        }\r\n     }); // on click\r\n\r\n    //styling\r\n    tab.setAttribute('class'      , 'stripe dataTable');\r\n    tab.setAttribute('style'      , 'margin: 0!important');\r\n    tab.setAttribute('cellpadding', '1');\r\n    tab.setAttribute('cellspacing', '1');\r\n    tab.setAttribute('border'     , '0');\r\n\r\n    return tab;\r\n}\r\n\r\n/*\r\nserverside: true or false\r\n*/\r\nDatatables.prototype.draw = function(dtResult, resultDOM){\r\n    return(this.getDataFromServer(dtResult, resultDOM));\r\n}\r\n\r\nmodule.exports={Datatables, CspDatatables}\r\n","const TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction HTMLStringEditor(options){\r\n\tthis.css = ((options && options.css) ? \"terminus-literal-value \" + options.css : \"terminus-literal-value\");\r\n\tthis.options = options; \r\n}\r\n\r\nHTMLStringEditor.prototype.renderFrame = function(frame, dataviewer){\r\n\tvar big = ((this.options && typeof this.options.big != \"undefined\") ? this.options.big : this.isBigType(this.type, value));\r\n\tif(big){\r\n\t\tvar input = document.createElement(\"textarea\");\r\n\t\tthis.css += \" terminus-literal-big-value\";\t\t\r\n\t}\r\n\telse {\r\n\t\tvar size = ((this.options && typeof this.options.size != \"undefined\") ? this.options.size : this.getTypeSize(this.type, value));\r\n\t\tvar input = document.createElement(\"input\");\r\n\t\tinput.setAttribute('type', \"text\");\r\n\t\tinput.setAttribute('size', size);\r\n\t}\r\n\tinput.setAttribute('class', this.css);\r\n\tinput.setAttribute(\"data-value\", value);\r\n\t\r\n\tinput.value = value;\r\n\tvar self = this;\r\n\tinput.addEventListener(\"input\", function(){\r\n\t\tframe.set(this.value);\r\n\t});\r\n\treturn input;\r\n}\r\n\r\nHTMLStringEditor.prototype.isBigType = function(ty, value){\r\n\tif(value && value.length && value.length > 100) return true;\r\n\tvar longs = [\"xdd:coordinatePolyline\", \"xdd:coordinatePolygon\", \"xsd:base64Binary\", \"xdd:html\", \"xdd:json\", \"rdf:XMLLiteral\"];\r\n\tif(longs.indexOf(ty) == -1) return false;\r\n\treturn true;\r\n}\r\n\r\nHTMLStringEditor.prototype.getTypeSize = function(ty, value){\r\n\tif(value && value.length && value.length > 40) return 80;\r\n\tvar bigs = [\"xdd:url\", \"xdd:coordinate\", \"xsd:anyURI\"];\r\n\tvar smalls = [\"xsd:gYearMonth\", \"xdd:gYearRange\", \"xsd:decimal\", \"xsd:float\", \"xsd:time\", \"xsd:date\", \r\n\t\t\"xsd:dateTimeStamp\",\"xsd:gYearMonth\", \"xsd:gMonthDay\", \"xsd:duration\", \"xsd:yearMonthDuration\", \"xsd:dayTimeDuration\", \r\n\t\t\"xsd:nonNegativeInteger\", \"xsd:positiveInteger\", \"xsd:negativeInteger\",\t\"xsd:nonPositiveInteger\", \"xsd:integer\",\"xsd:unsignedInt\"];\r\n\tvar tinys = [\"xsd:boolean\", \"xsd:gYear\", \"xsd:gMonth\", \"xsd:gDay\", \"xsd:byte\", \"xsd:short\", \"xsd:unsignedByte\", \"xsd:language\"];\r\n\tif(bigs.indexOf(ty) != -1) return 80;\r\n\tif(smalls.indexOf(ty) != -1) return 16;\r\n\tif(tinys.indexOf(ty) != -1) return 8;\r\n\treturn 32;\r\n}\r\n\r\nmodule.exports={HTMLStringEditor}\r\n\r\n\r\n","function HTMLBooleanViewer(options){\r\n\tthis.css = \"terminus-literal-value terminus-literal-value-boolean \" + ((options && options.css) ?  options.css : \"\");\r\n}\r\n\r\nHTMLBooleanViewer.prototype.renderFrame = function(frame, dataviewer){\r\n\treturn this.render(frame.get());\r\n}\r\n\r\nHTMLBooleanViewer.prototype.renderValue = function(dataviewer){\r\n\treturn this.render(dataviewer.value());\t\r\n}\r\n\r\nHTMLBooleanViewer.prototype.render = function(value){\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', this.css);\r\n\tif(value){\r\n\t\tvar vallab = document.createTextNode(value);\r\n\t\tinput.appendChild(vallab);\r\n\t}\r\n\treturn input;\r\n}\r\n\r\n\r\nmodule.exports={HTMLBooleanViewer}\r\n\r\n","function HTMLBooleanEditor(options){\r\n\tthis.css = \"terminus-literal-value terminus-literal-value-range \" + ((options && options.css) ?  options.css : \"\");\r\n}\r\n\r\nHTMLBooleanEditor.prototype.renderFrame = function(frame, dataviewer){\r\n\tvar value = frame.get();\r\n\tvar input = document.createElement(\"input\");\r\n\tinput.setAttribute('type', \"checkbox\");\r\n\tif(value){\r\n\t\tinput.setAttribute(\"checked\", \"checked\");\t\t\t\t\t\r\n\t}\r\n\tinput.addEventListener(\"change\", function(){\r\n\t\tif(value){\r\n\t\t\tframe.set(\"\");\r\n\t\t}\r\n\t\telse {\r\n\t\t\tframe.set(\"true\");\r\n\t\t}\r\n\t});\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={HTMLBooleanEditor}\r\n\r\n","const TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction HTMLChoiceViewer(options){};\r\n\r\nHTMLChoiceViewer.prototype.renderFrame = function(frame, dataviewer){\r\n\tvar value = frame.get();\r\n\tif(frame.frame && frame.frame.elements){\r\n\t\tthis.elements = frame.frame.elements;\r\n\t}\r\n\treturn this.render(value);\r\n}\r\n\r\nHTMLChoiceViewer.prototype.renderValue = function(dataviewer){\r\n\treturn this.render(dataviewer.value());\r\n}\r\n\r\nHTMLChoiceViewer.prototype.render = function(value){\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', \"terminus-literal-value terminus-choice-value\");\r\n\tinput.setAttribute('data-value', value);\r\n\tvar lab = false;\r\n\tif(value && this.elements){\r\n\t\tfor(var i = 0; i<this.elements.length; i++){\r\n\t\t\tvar elt = this.elements[i];\r\n\t\t\tif(elt.class == value){\r\n\t\t\t\tif(elt.label && elt.label[\"@value\"]){\r\n\t\t\t\t\tlab = elt.label[\"@value\"];\r\n\t\t\t\t}\r\n\t\t\t\tcontinue;\r\n\t\t\t}\t\t\t\t\r\n\t\t}\r\n\t}\r\n\tif(value && !lab){\r\n\t\tlab = TerminusClient.FrameHelper.labelFromURL(value);\t\t\t\t\t\r\n\t}\r\n\tif(lab){\r\n\t\tinput.appendChild(document.createTextNode(lab));\t\t\r\n\t}\r\n\treturn input\r\n}\r\n\r\nmodule.exports={HTMLChoiceViewer}\r\n\r\n\r\n","const HTMLFrameHelper = require('../HTMLFrameHelper');\r\n\r\nfunction HTMLChoiceEditor(options){};\r\n\r\nHTMLChoiceEditor.prototype.renderFrame = function(frame, dataviewer){\r\n\tvar value = frame.get();\r\n\tvar optInput = document.createElement(\"select\");\r\n\toptInput.setAttribute('class', \"terminus-choice-picker\");\r\n\tvar foptions = frame.getChoiceOptions();\r\n\tfoptions.unshift({ value: \"\", label: \"Not Specified\"});\r\n\tvar callback = function(val){\r\n\t\tframe.set(val);\r\n\t}\r\n\tvar sel = HTMLFrameHelper.getSelectionControl(\"select-choice\", foptions, value, callback);\r\n\treturn sel;\r\n}\r\n\r\nmodule.exports={HTMLChoiceEditor}\r\n\r\n","const TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction HTMLCoordinateViewer(options){\r\n\tthis.inputs = [];\r\n}\r\n\r\nHTMLCoordinateViewer.prototype.parseValue = function(value){\r\n\ttry {\r\n\t\tvar parsed = (value ? JSON.parse(value) : false);\r\n\t\tif(parsed && this.type == \"xdd:coordinate\"){\r\n\t\t\tparsed = [parsed];\r\n\t\t}\r\n\t\treturn parsed;\r\n\t}\r\n\tcatch(e){\r\n\t\tthis.error = this.type + \" value \" + value + \" failed to parse as json\", e.toString();\r\n\t\treturn [];\r\n\t}\r\n}\r\n\r\n\r\nHTMLCoordinateViewer.prototype.renderFrame = function(frame, dataviewer){\r\n\treturn this.render(frame.get());\r\n}\r\n\r\nHTMLCoordinateViewer.prototype.renderValue = function(dataviewer){\r\n\treturn this.render(dataviewer.value());\r\n}\r\n\r\nHTMLCoordinateViewer.prototype.render = function(value){ \r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', \"terminus-literal-value terminus-literal-coordinate\");\r\n\tif(value){\r\n\t\tinput.setAttribute('data-value', value);\t\t\r\n\t\tvar parsed = this.parseValue(value);\r\n\t\tif(parsed){\r\n\t\t\tfor(var i = 0; i < parsed.length; i++){\r\n\t\t\t\tvar lldom = document.createElement(\"span\");\r\n\t\t\t\tlldom.setAttribute(\"class\", \"latlong\");\r\n\t\t\t\tlldom.appendChild(document.createTextNode(\"Latitude: \"));\r\n\t\t\t\tlldom.appendChild(document.createTextNode(parsed[i][0] + \" °\" + \" \"));\r\n\t\t\t\tlldom.appendChild(document.createTextNode(\"Longitude: \"));\r\n\t\t\t\tlldom.appendChild(document.createTextNode(parsed[i][1] + \" °\" ));\r\n\t\t\t\tinput.appendChild(lldom);\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tinput.setAttribute(\"title\", this.error);\r\n\t\t}\r\n\t}\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={HTMLCoordinateViewer}\r\n\r\n","function HTMLCoordinateEditor(options){\r\n\tthis.inputs = [];\r\n}\r\n\r\nHTMLCoordinateEditor.prototype.getInputDOMs = function(lat, long, change){\r\n\tvar latdom = document.createElement(\"input\");\r\n\tlatdom.setAttribute(\"type\", \"text\");\r\n\tlatdom.value = lat;\r\n\tvar longdom = document.createElement(\"input\");\r\n\tlongdom.setAttribute(\"type\", \"text\");\r\n\tlongdom.value = long;\r\n\tlatdom.addEventListener(\"change\", change);\r\n\tlongdom.addEventListener(\"change\", change);\r\n\treturn [latdom, longdom];\r\n}\r\n\r\nHTMLCoordinateEditor.prototype.getLatLongDOM = function(lat, long, ty, index, parent){\r\n\tvar lldom = document.createElement(\"span\");\r\n\tlldom.setAttribute(\"class\", \"terminus-lat-long\");\r\n\tvar firstcol = document.createElement(\"span\");\r\n\tfirstcol.setAttribute(\"class\", \"terminus-lat-long-col\");\r\n\tlldom.appendChild(firstcol);\r\n\tif(index > 2 || (ty == \"xdd:coordinatePolyline\" && index > 1)){\r\n\t\tvar delbut = document.createElement(\"button\");\r\n\t\tdelbut.setAttribute(\"class\", \"delete-coordinate\");\r\n\t\tdelbut.appendChild(document.createTextNode(\"Remove\"));\r\n\t\tdelbut.addEventListener(\"click\", function(){\r\n\t\t\tlong.value = \"\";\r\n\t\t\tlat.value = \"\";\r\n\t\t\tparent.removeChild(lldom);\r\n\t\t});\r\n\t\tfirstcol.appendChild(delbut);\r\n\t}\r\n\tlldom.appendChild(document.createTextNode(\"Latitude: \"));\r\n\tlldom.appendChild(lat);\r\n\tlldom.appendChild(document.createTextNode(\" °\" + \" \"));\r\n\tlldom.appendChild(document.createTextNode(\"  Longitude: \"));\r\n\tlldom.appendChild(long);\r\n\tlldom.appendChild(document.createTextNode(\" ° \" ));\r\n\treturn lldom;\r\n}\r\n\r\n\r\nHTMLCoordinateEditor.prototype.renderFrame = function(frame, dataviewer){\r\n\tvar value = frame.get();\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', \"terminus-literal-value terminus-literal-coordinate\");\r\n\tinput.setAttribute('data-value', value);\r\n\ttry {\r\n\t\tvar parsed = (value ? JSON.parse(value) : false);\r\n\t}\r\n\tcatch(e){\r\n\t\tthis.error = this.type + \" failed to parse as json\", e.toString();\r\n\t\tvar parsed = false;\r\n\t}\r\n\tvar self = this;\r\n\tvar updateValueFromForm = function(){\r\n\t\tvar vals = [];\r\n\t\tfor(var i = 0; i<self.inputs.length; i++){\r\n\t\t\tif(self.inputs[i][0].value && self.inputs[i][1].value){\r\n\t\t\t\tvar val = \"[\" + self.inputs[i][0].value + \",\" + self.inputs[i][1].value + \"]\";\r\n\t\t\t\tvals.push(val);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(vals.length == 0){\r\n\t\t\tframe.set(\"\");\r\n\t\t}\r\n\t\telse if(this.type == \"xdd:coordinate\"){\r\n\t\t\tframe.set(vals[0]);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tvar op = \"[\";\r\n\t\t\tfor(var i = 0; i<vals.length; i++){\r\n\t\t\t\top += vals[i];\r\n\t\t\t\tif(i+1 < vals.length) op += \",\";\r\n\t\t\t}\r\n\t\t\top += \"]\";\r\n\t\t\tframe.set(op);\r\n\t\t}\r\n\t};\r\n\tif(!parsed){\r\n\t\tif(this.type == \"xdd:coordinate\") parsed = [\"\",\"\"];\r\n\t\telse {\r\n\t\t\tparsed = [[\"\",\"\"],[\"\",\"\"]];\r\n\t\t\tif(this.type == \"xdd:coordinatePolygon\") parsed.push([\"\",\"\"]);\r\n\t\t}\r\n\t}\r\n\tif(this.type == \"xdd:coordinate\"){\r\n\t\tparsed = [parsed];\r\n\t}\r\n\tfor(var i = 0; i < parsed.length; i++){\r\n\t\tthis.inputs.push(this.getInputDOMs(parsed[i][0], parsed[i][1], updateValueFromForm))\r\n\t}\r\n\tvar lldoms = document.createElement(\"span\");\r\n\tfor(var i = 0; i < this.inputs.length; i++){\r\n\t\tvar lldom = this.getLatLongDOM(this.inputs[i][0], this.inputs[i][1], this.type, i, lldoms);\r\n\t\tlldoms.appendChild(lldom);\r\n\t}\r\n\tinput.appendChild(lldoms);\r\n\tvar self = this;\r\n\tif(this.type != \"xdd:coordinate\"){\r\n\t\tvar butspan = document.createElement(\"span\");\r\n\t\tbutspan.setAttribute(\"class\", \"terminus-add-coordinate\")\r\n\t\tvar addbut = document.createElement(\"button\");\r\n\t\taddbut.setAttribute(\"class\", \"terminus-add-coordinate\");\r\n\t\taddbut.appendChild(document.createTextNode(\"Add\"));\r\n\t\taddbut.addEventListener(\"click\", function(){\r\n\t\t\tvar ipdoms = self.getInputDOMs(\"\", \"\", updateValueFromForm);\r\n\t\t\tvar lldom = self.getLatLongDOM(ipdoms[0], ipdoms[1], this.type, self.inputs.length, lldoms);\r\n\t\t\tlldoms.appendChild(lldom);\r\n\t\t\tself.inputs.push(ipdoms);\r\n\t\t});\r\n\t\tbutspan.appendChild(addbut);\r\n\t\tinput.appendChild(butspan);\t\t\t\r\n\t}\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={HTMLCoordinateEditor}","const DateHelper = require('./DateHelper');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction HTMLDateViewer(options){\r\n\tthis.max = (options && options.max ? options.max : false);\r\n\tthis.min = (options && options.min ? options.min : false);\r\n\tthis.allowbce = (options && options.allowbce ? options.allowbce : false);\r\n\tthis.date_spacer = \"/\";\r\n\tthis.time_spacer = \":\";\r\n\tthis.datetime_separator = \", \";\r\n\tthis.helper = new DateHelper.HTMLDateHelper();\r\n}\r\n\r\nHTMLDateViewer.prototype.renderFrame = function(frame, dataviewer){\r\n\treturn this.render(frame.get());\r\n}\r\n\r\nHTMLDateViewer.prototype.renderValue = function(dataviewer){\r\n\treturn this.render(dataviewer.value());\r\n}\r\n\r\nHTMLDateViewer.prototype.render = function(value){\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', \"terminus-literal-value terminus-literal-date\");\r\n\tinput.setAttribute('data-value', value);\r\n\tif(value){\r\n\t\tvar parsed = TerminusClient.FrameHelper.parseDate(this.type, value);\r\n\t\tvar datepart = this.getDateComponentDOM(parsed);\r\n\t\tvar timepart = this.getTimeComponentDOM(parsed);\r\n\t\tif(timepart) input.appendChild(timepart);\r\n\t\tif(timepart && datepart) input.appendChild(document.createTextNode(this.datetime_separator));\r\n\t\tif(datepart) input.appendChild(datepart);\r\n\t}\r\n\treturn input;\r\n}\r\n\r\nHTMLDateViewer.prototype.getTimeComponentDOM = function(parsed, ty){\r\n\tvar hdom = (parsed.hour ? document.createElement(\"span\") : false);\r\n\tif(hdom){\r\n\t\thdom.setAttribute(\"class\", \"terminus-time-hour\");\r\n\t\thdom.appendChild(document.createTextNode(parsed.hour));\r\n\t}\r\n\tvar mdom = (typeof parsed.minute != \"undefined\" ? document.createElement(\"span\") : false);\r\n\tif(mdom){\r\n\t\tmdom.setAttribute(\"class\", \"terminus-time-minute\");\r\n\t\tvar mlab = (parsed.minute < 10 ? parsed.minute : parsed.minute);\r\n\t\tmdom.appendChild(document.createTextNode(mlab));\r\n\t}\r\n\tvar sdom = (typeof parsed.second != \"undefined\" ? document.createElement(\"span\") : false);\r\n\tif(sdom){\r\n\t\tsdom.setAttribute(\"class\", \"terminus-time-second\");\r\n\t\tvar slab = (parsed.second < 10 ? parsed.second : parsed.second);\r\n\t\tsdom.appendChild(document.createTextNode(slab));\r\n\t}\r\n\tvar tz = (parsed.timezone ? document.createElement(\"span\") : false);\r\n\tif(tz){\r\n\t\tsdom.setAttribute(\"class\", \"terminus-time-timezone\");\r\n\t\tsdom.appendChild(document.createTextNode(parsed.timezone));\r\n\t}\r\n\tif(hdom || mdom || sdom || tz){\r\n\t\tvar dadom = document.createElement(\"span\");\r\n\t\tdadom.setAttribute(\"class\", \"terminus-time-components time-\"+ty);\r\n\t\tif(hdom) dadom.appendChild(hdom); \r\n\t\tif(mdom) {\r\n\t\t\tif(hdom) dadom.appendChild(document.createTextNode(this.time_spacer));\r\n\t\t\tdadom.appendChild(mdom); \r\n\t\t}\r\n\t\tif(sdom) {\r\n\t\t\tif(mdom || hdom) dadom.appendChild(document.createTextNode(this.time_spacer));\r\n\t\t\tdadom.appendChild(sdom); \r\n\t\t}\r\n\t\tif(tz){\r\n\t\t\tdadom.appendChild(document.createTextNode(\" (Timezone: \")); \r\n\t\t\tdadom.appendChild(sdom); \r\n\t\t\tdadom.appendChild(document.createTextNode(\")\")); \t\t\t\r\n\t\t}\r\n\t\treturn dadom;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLDateViewer.prototype.getDateComponentDOM = function(parsed, ty){\r\n\tvar ydom = (parsed.year ? document.createElement(\"span\") : false);\r\n\tif(ydom){\r\n\t\tydom.setAttribute(\"class\", \"terminus-date-year\");\r\n\t\tydom.appendChild(document.createTextNode(parsed.year));\r\n\t}\r\n\tvar mdom = (parsed.month ? document.createElement(\"span\") : false);\r\n\tif(mdom){\r\n\t\tmdom.setAttribute(\"class\", \"terminus-date-month\");\r\n\t\tmdom.appendChild(document.createTextNode(this.helper.getMonthName(parsed.month)));\t\t\r\n\t}\r\n\tvar ddom = (parsed.day ? document.createElement(\"span\") : false );\r\n\tif(ddom){\r\n\t\tddom.setAttribute(\"class\", \"terminus-date-day\");\r\n\t\tddom.appendChild(document.createTextNode(parsed.day));\t\t\r\n\t}\r\n\tif(ydom || mdom || ddom){\r\n\t\tvar dadom = document.createElement(\"span\");\r\n\t\tif(ddom) dadom.appendChild(ddom); \r\n\t\tif(mdom) {\r\n\t\t\tif(ddom) dadom.appendChild(document.createTextNode(this.date_spacer));\r\n\t\t\tdadom.appendChild(mdom); \r\n\t\t}\r\n\t\tif(ydom) {\r\n\t\t\tif(mdom || ddom) dadom.appendChild(document.createTextNode(this.date_spacer));\r\n\t\t\tdadom.appendChild(ydom); \r\n\t\t}\r\n\t\treturn dadom;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nmodule.exports={HTMLDateViewer}","function HTMLDateHelper(){\r\n\tthis.months = [\"January\", \"Februrary\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"];\r\n}\r\n\r\nHTMLDateHelper.prototype.getMonthName = function(num){\r\n\treturn this.months[num-1];\r\n}\r\n\r\nmodule.exports={HTMLDateHelper}","const DateHelper = require('./DateHelper');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction HTMLDateEditor(options){\r\n\tthis.max = (options && options.max ? options.max : false);\r\n\tthis.min = (options && options.min ? options.min : false);\r\n\tthis.allowbce = (options && options.allowbce ? options.allowbce : false);\r\n\tthis.date_spacer = \"/\";\r\n\tthis.time_spacer = \":\";\r\n\tthis.datetime_separator = \", \";\r\n\tthis.helper = new DateHelper.HTMLDateHelper();\r\n}\r\n\r\nHTMLDateEditor.prototype.renderFrame = function(frame, dataviewer){\r\n\tvar value = frame.get();\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', \"terminus-literal-value terminus-literal-date\");\r\n\tinput.setAttribute('data-value', value);\r\n\tif(value){\r\n\t\tthis.parsed = TerminusClient.FrameHelper.parseDate(this.type, value);\r\n\t}\r\n\telse this.parsed = {};\r\n\tvar datepart = this.getDateComponentDOM(this.parsed, this.type, frame);\r\n\tvar timepart = this.getTimeComponentDOM(this.parsed, this.type, frame);\r\n\tif(timepart) input.appendChild(timepart);\r\n\tif(timepart && datepart) input.appendChild(document.createTextNode(this.datetime_separator));\r\n\tif(datepart) input.appendChild(datepart);\r\n\treturn input;\r\n}\r\n\r\nHTMLDateEditor.prototype.set = function(part, val, frame, ty){\r\n\tthis.parsed[part] = val;\r\n\tvar xsd = TerminusClient.FrameHelper.xsdFromParsed(this.parsed, ty);\r\n\tif(xsd){\r\n\t\tframe.set(xsd);\r\n\t}\r\n}\r\n\r\nHTMLDateEditor.prototype.getTimeComponentDOM = function(parsed, ty, frame){\r\n\tif([\"xsd:dateTime\", \"xsd:dateTimeStamp\", \"xsd:time\"].indexOf(ty) == -1){\r\n\t\treturn false;\r\n\t}\r\n\tvar self = this;\r\n\tvar hdom = document.createElement(\"input\");\r\n\thdom.setAttribute(\"class\", \"terminus-hour-input terminus-hour-\"+ty);\r\n\thdom.setAttribute(\"size\", 2);\r\n\thdom.setAttribute(\"placeholder\", \"HH\");\r\n\thdom.value = (parsed.hour ? parsed.hour : \"\");\r\n\thdom.addEventListener(\"input\", function(){\r\n\t\tself.set(\"hour\", this.value, frame, ty);\r\n\t});\r\n\tvar mdom = document.createElement(\"input\");\r\n\tmdom.setAttribute(\"class\", \"terminus-minute-input terminus-minute-\"+ty);\r\n\tmdom.setAttribute(\"size\", 2);\r\n\tmdom.setAttribute(\"placeholder\", \"MM\");\r\n\tmdom.value = (parsed.minute ? parsed.minute: \"\");\r\n\tmdom.addEventListener(\"input\", function(){\r\n\t\tself.set(\"minute\", this.value, frame, ty);\r\n\t});\r\n\tvar sdom = document.createElement(\"input\");\r\n\tsdom.setAttribute(\"class\", \"terminus-second-input terminus-second-\"+ty);\r\n\tsdom.setAttribute(\"size\", 8);\r\n\tsdom.setAttribute(\"placeholder\", \"SS.sss...\");\r\n\tsdom.value = (parsed.second ? parsed.second: \"\");\r\n\tsdom.addEventListener(\"input\", function(){\r\n\t\tself.set(\"second\", this.value, frame, ty);\r\n\t})\r\n\tvar tdom = document.createElement(\"span\");\r\n\ttdom.appendChild(hdom);\r\n\ttdom.appendChild(document.createTextNode(this.time_spacer));\r\n\ttdom.appendChild(mdom);\r\n\ttdom.appendChild(document.createTextNode(this.time_spacer));\r\n\ttdom.appendChild(sdom);\r\n\treturn tdom;\r\n}\r\n\r\nHTMLDateEditor.prototype.getDateComponentDOM = function(parsed, ty, frame){\r\n\tvar self = this;\r\n\tif([\"xsd:date\", \"xsd:dateTime\", \"xsd:gYear\", \"xsd:gYearMonth\", \"xsd:dateTimeStamp\"].indexOf(ty) != -1){\r\n\t\tvar ydom = document.createElement(\"input\");\r\n\t\tydom.setAttribute(\"class\", \"terminus-year-input terminus-year-\"+ty);\r\n\t\tydom.setAttribute(\"size\", 6);\r\n\t\tydom.setAttribute(\"placeholder\", \"YYYY\");\r\n\t\tydom.value = (parsed.year ? parsed.year : \"\");\r\n\t\tydom.addEventListener(\"input\", function(){\r\n\t\t\tself.set(\"year\", this.value, frame, ty);\r\n\t\t})\r\n\t}\r\n\tif([\"xsd:date\", \"xsd:dateTime\", \"xsd:gYearMonth\", \"xsd:dateTimeStamp\", \"xsd:gMonth\", \"xsd:gMonthDay\"].indexOf(ty) != -1){\r\n\t\tvar mdom = document.createElement(\"select\");\r\n\t\tmdom.setAttribute(\"class\", \"terminus-month-input terminus-month-\"+ty);\r\n\t\tfor(var i = 0; i<this.helper.months.length; i++){\r\n\t\t\tvar opdom = document.createElement(\"option\");\r\n\t\t\topdom.value = i+1;\r\n\t\t\topdom.appendChild(document.createTextNode(this.helper.months[i]));\r\n\t\t\tif(parsed.month && parsed.month == i+1){\r\n\t\t\t\topdom.selected = true;\r\n\t\t\t}\r\n\t\t\tmdom.appendChild(opdom);\r\n\t\t}\r\n\t\tmdom.addEventListener(\"change\", function(){\r\n\t\t\tself.set(\"month\", this.value, frame, ty);\r\n\t\t})\r\n\t}\t\r\n\tif([\"xsd:date\", \"xsd:dateTime\", \"xsd:dateTimeStamp\", \"xsd:gDay\", \"xsd:gMonthDay\"].indexOf(ty) != -1){\r\n\t\tvar ddom = document.createElement(\"input\");\r\n\t\tddom.setAttribute(\"class\", \"terminus-day-input terminus-day-\"+ty);\r\n\t\tddom.setAttribute(\"size\", 2);\r\n\t\tddom.setAttribute(\"placeholder\", \"DD\");\r\n\t\tddom.value = (parsed.day ? parsed.day : \"\");\t\r\n\t\tddom.addEventListener(\"input\", function(){\r\n\t\t\tself.set(\"day\", this.value, frame, ty);\r\n\t\t})\r\n\t}\t\r\n\tif(ydom || mdom || ddom){\r\n\t\tvar dadom = document.createElement(\"span\");\r\n\t\tif(ddom) dadom.appendChild(ddom); \r\n\t\tif(mdom) {\r\n\t\t\tif(ddom) dadom.appendChild(document.createTextNode(this.date_spacer));\r\n\t\t\tdadom.appendChild(mdom); \r\n\t\t}\r\n\t\tif(ydom) {\r\n\t\t\tif(mdom || ddom) dadom.appendChild(document.createTextNode(this.date_spacer));\r\n\t\t\tdadom.appendChild(ydom); \r\n\t\t}\r\n\t\treturn dadom;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nmodule.exports={HTMLDateEditor}","const HTMLFrameHelper = require('../HTMLFrameHelper');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction HTMLEntityViewer(options){\r\n\tthis.onclick = false;\r\n}\r\n\r\nHTMLEntityViewer.prototype.renderFrame = function(frame, dataviewer){\r\n\t//this.client = dataviewer.getClient();\r\n\treturn this.render(frame.get());\t\r\n}\r\n\r\nHTMLEntityViewer.prototype.renderValue = function(dataviewer){\r\n\t//this.client = dataviewer.getClient();\r\n\treturn this.render(dataviewer.value());\r\n}\r\n\r\nHTMLEntityViewer.prototype.render = function(value){\r\n\t//var value = TerminusClient.FrameHelper.unshorten(value);\r\n\tvar holder = document.createElement(\"span\");\r\n\tholder.setAttribute(\"class\", \"terminus-literal-value terminus-entity-reference-value\");\r\n\tvar self = this;\r\n\tif(this.holder){\r\n\t\treturn this.holder;\r\n\t}\r\n\tif(value){\r\n\t\tvar dom = this.showValue(value)\r\n\t\tholder.appendChild(dom);\r\n\t}\r\n\treturn holder;\r\n}\r\n\r\nHTMLEntityViewer.prototype.showValue = function(value){\r\n\treturn document.createTextNode(value);\r\n}\r\n\r\n\r\nHTMLEntityViewer.prototype.getEntityViewHTML = function(value, frame, dataviewer){\r\n\tvar span = document.createElement(\"span\");\r\n\tvar self = this;\r\n\tspan.setAttribute(\"class\", \"terminus-internal-link\");\r\n\tspan.appendChild(dataviewer.internalLink(value));\r\n\tif(controller = renderer.getController()){\r\n\t\tcontroller.getInstanceMeta(value).then(function(response){\r\n\t\t\tvar lab = self.getEntityLabel(value, response, dataviewer);\r\n\t\t\tif(lab){ \r\n\t\t\t\tTerminusClient.FrameHelper.removeChildren(span);\r\n\t\t\t\tspan.appendChild(lab);\r\n\t\t\t}\t\r\n\t\t});\r\n\t}\r\n\treturn span;\r\n}\r\n\r\nHTMLEntityViewer.prototype.getEntityLabel = function(url, response, dv){\r\n\tvar nspan = document.createElement(\"span\");\r\n\tif(response && (il = HTMLFrameHelper.getVariableValueFromBinding(\"InstanceLabel\", response))){\r\n\t\tnspan.appendChild(dv.internalLink(url, il));\r\n\t\tvar rt = HTMLFrameHelper.getVariableValueFromBinding(\"InstanceType\", response);\r\n\t\tvar tit = url + \" Type: \" + rt;\r\n\t\tvar ic = HTMLFrameHelper.getVariableValueFromBinding(\"InstanceComment\", response);\r\n\t\tif(typeof ic == \"object\" && ic[\"@value\"]){\r\n\t\t\ttit += \" \" + ic[\"@value\"];\r\n\t\t}\r\n\t\tnspan.setAttribute(\"title\", tit);\r\n\t\treturn nspan;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nmodule.exports={HTMLEntityViewer}","function HTMLEntityEditor(options){}\r\nHTMLEntityEditor.prototype.renderFrame = function(frame, dataviewer){\r\n\tvar value = frame.get();\r\n\tvar input = document.createElement(\"input\");\r\n\tinput.setAttribute(\"class\", \"terminus-literal-value terminus-entity-reference-value\");\r\n\tinput.setAttribute(\"type\", \"text\");\r\n\tinput.setAttribute('size', 80);\r\n\tinput.value = value;\r\n\tvar self = this;\r\n\tinput.addEventListener(\"change\", function(){\r\n\t\tvar url = this.value;\r\n\t\tif(url.indexOf(\"/\") == -1 && url.indexOf(\":\") == -1){\r\n\t\t\turl = \"doc:\" + url;\r\n\t\t}\r\n\t\tframe.set(url);\r\n\t});\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={HTMLEntityEditor}","const TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction HTMLImageViewer(options){}\r\n\r\nHTMLImageViewer.prototype.renderFrame = function(frame, dataviewer){\r\n\treturn this.render(frame.get());\r\n}\r\n\r\nHTMLImageViewer.prototype.renderValue = function(dataviewer){\r\n\treturn this.render(dataviewer.value());\r\n}\r\n\t\r\nHTMLImageViewer.prototype.render = function(value){\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', \"terminus-literal-value terminus-literal-image-value\");\r\n\tinput.setAttribute('data-value', value);\r\n\tif(value){\r\n\t\tvar img = document.createElement(\"a\");\r\n\t\timg.setAttribute('src', value);\r\n\t\tinput.appendChild(img);\r\n\t}\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={HTMLImageViewer}\r\n\r\n\r\n","const TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction HTMLImageEditor(options){}\r\nHTMLImageEditor.prototype.renderFrame = function(frame, dataviewer){\r\n\tif(this.type == \"xsd:base64Binary\"){\r\n\t\tvar input = document.createElement(\"textarea\");\r\n\t\tinput.setAttribute('class', \"terminus-literal-value terminus-literal-b64image-value\");\r\n\t\tinput.value = value;\r\n\t\tinput.addEventListener(\"change\", function(){\r\n\t\t\tframe.set(this.value);\r\n\t\t});\r\n\t\treturn input;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nmodule.exports={HTMLImageEditor}","function HTMLLinkViewer(options){\r\n\tthis.css = \"terminus-literal-value terminus-literal-value-range \" + ((options && options.css) ?  options.css : \"\");\r\n}\r\n\r\nHTMLLinkViewer.prototype.renderFrame = function(frame, dataviewer){\r\n\treturn this.render(frame.get());\r\n}\r\n\r\nHTMLLinkViewer.prototype.renderValue = function(dataviewer){\r\n\treturn this.render(dataviewer.value());\r\n}\r\n\t\r\nHTMLLinkViewer.prototype.render = function(value){\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', this.css);\r\n\tinput.setAttribute('size', 80);\r\n\tinput.setAttribute('data-value', value);\r\n\tif(value){\r\n\t\tvar a = document.createElement(\"a\");\r\n\t\ta.setAttribute('href', value);\r\n\t\ta.appendChild(document.createTextNode(value));\r\n\t\tinput.appendChild(a);\r\n\t}\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={HTMLLinkViewer}\r\n\r\n","const TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction HTMLNumberViewer(options){\r\n\tthis.commas = (options && options.commas ? options.commas : true);\r\n}\r\n\r\nHTMLNumberViewer.prototype.renderFrame = function(frame, dataviewer){\r\n\treturn this.render(frame.get());\r\n}\r\n\r\nHTMLNumberViewer.prototype.renderValue = function(dataviewer){\r\n\treturn this.render(dataviewer.value());\r\n}\r\n\t\r\nHTMLNumberViewer.prototype.render = function(value){\r\n\tif(value === 0) value = \"0\";\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', 'terminus-number-value terminus-literal-value');\r\n\tinput.setAttribute('data-value', value);\r\n\tvalue = (this.commas ? TerminusClient.FrameHelper.numberWithCommas(value) : value);\r\n\tinput.appendChild(document.createTextNode(value));\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={HTMLNumberViewer}\r\n","const TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction HTMLRangeViewer(options){\r\n\tthis.commas = (options && options.commas ? options.commas : true);\r\n\tthis.css = \"terminus-literal-value terminus-literal-value-range \" + ((options && options.css) ?  options.css : \"\");\r\n\tthis.delimiter = (options && options.delimiter ? options.delimiter : false);\r\n}\r\n\r\nHTMLRangeViewer.prototype.renderFrame = function(frame, dataviewer){\r\n\treturn this.render(frame.get());\r\n}\r\n\r\nHTMLRangeViewer.prototype.renderValue = function(dataviewer){\r\n\treturn this.render(dataviewer.value());\r\n}\r\n\t\r\nHTMLRangeViewer.prototype.render = function(value){\r\n\tvar vals = TerminusClient.FrameHelper.parseRangeValue(value, this.delimiter);\r\n\tvar d = document.createElement(\"span\");\r\n\td.setAttribute(\"class\", this.css);\r\n\tvar rvals = document.createElement(\"span\");\r\n\trvals.setAttribute(\"class\", \"terminus-range-value-left\");\r\n\tvar svals = document.createElement(\"span\");\r\n\tsvals.setAttribute(\"class\", \"terminus-range-value-right\");\r\n\tvar x = (this.useCommas() ? TerminusClient.FrameHelper.numberWithCommas(vals[0]) : vals[0]);\r\n\tvar tnode = document.createTextNode(x);\r\n\trvals.appendChild(tnode);\r\n\td.appendChild(rvals);\t\r\n\tif(vals.length == 2){\r\n\t\td.appendChild(getRangeSymbolDOM());\r\n\t\tvar x2 = (this.useCommas(renderer) ? TerminusClient.FrameHelper.numberWithCommas(vals[1]) : vals[1]);\r\n\t\tvar t2node = document.createTextNode(x2);\r\n\t\tsvals.appendChild(t2node);\r\n\t\td.appendChild(svals);\t\r\n\t}\r\n\treturn d;\r\n}\r\n\r\nHTMLRangeViewer.prototype.useCommas = function(){\r\n\tif([\"xdd:gYearRange\", \"xdd:dateRange\"].indexOf(this.type) != -1) return false;\r\n\treturn this.commas;\r\n}\r\n\r\nfunction getRangeSymbolDOM(){\r\n\tvar d = document.createElement(\"span\");\r\n\td.setAttribute(\"class\", \"terminus-range-indicator\");\r\n\td.setAttribute(\"title\", \"The value is uncertain, it lies somewhere in this range\");\r\n\td.appendChild(document.createTextNode(\" ... \"));\r\n\treturn d;\r\n}\r\n\r\nmodule.exports={HTMLRangeViewer}\r\n","const TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction HTMLRangeEditor(options){\r\n\tthis.commas = (options && options.commas ? options.commas : true);\r\n\tthis.css = \"terminus-literal-value terminus-literal-value-range \" + ((options && options.css) ?  options.css : \"\");\r\n\tthis.delimiter = (options && options.delimiter ? options.delimiter : false);\r\n}\r\n\r\nHTMLRangeEditor.prototype.renderFrame = function(frame, dataviewer){\r\n\tvar value = frame.get();\r\n\tvar vals = TerminusClient.FrameHelper.parseRangeValue(value, this.delimiter);\r\n\tvar d = document.createElement(\"span\");\r\n\td.setAttribute(\"class\", this.css);\r\n\tvar rvals = document.createElement(\"span\");\r\n\tvar svals = document.createElement(\"span\");\r\n\tvar data1 = (vals.length > 0 ? vals[0] : \"\");\r\n\tvar data2 = (vals.length > 1 ? vals[1] : \"\");\r\n\tvar firstip = document.createElement(\"input\");\r\n\tfirstip.setAttribute('type', \"text\");\r\n\tfirstip.setAttribute('size', 16);\r\n\tif(data1){\r\n\t\tfirstip.value = data1;\r\n\t}\r\n\tvar secondip = document.createElement(\"input\");\r\n\tsecondip.setAttribute('type', \"text\");\r\n\tsecondip.setAttribute('size', 16);\r\n\tif(data2){\r\n\t\tthis.showing_range = true;\r\n\t\tsecondip.value = data2;\r\n\t}\r\n\trvals.appendChild(firstip);\r\n\td.appendChild(rvals);\t\r\n\tif(this.showing_range){\r\n\t\tsvals.appendChild(getRangeSymbolDOM());\r\n\t\tsvals.appendChild(secondip);\r\n\t}\r\n\td.appendChild(svals);\t\r\n\tvar but = document.createElement(\"button\");\r\n\tbut.setAttribute(\"class\", \"terminus-change-range\");\r\n\tvar txt = this.showing_range ? \"Change to Simple Value\" : \"Change to Uncertain Range\";\r\n\tbut.appendChild(document.createTextNode(txt));\r\n\td.appendChild(but);\t\r\n\tvar self = this;\r\n\tbut.addEventListener(\"click\", function(){\r\n\t\tif(self.showing_range){\r\n\t\t\tself.showing_range = false;\r\n\t\t\tsecondip.value = \"\";\t\t\t\t\r\n\t\t\tTerminusClient.FrameHelper.removeChildren(svals);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tself.showing_range = true;\r\n\t\t\tsecondip.value = \"\";\t\t\t\t\r\n\t\t\tsvals.appendChild(getRangeSymbolDOM());\r\n\t\t\tsvals.appendChild(secondip);\r\n\t\t}\r\n\t\tvar txt = self.showing_range ? \"Change to Simple Value\" : \"Change to Uncertain Range\";\r\n\t\tbut.innerText = txt;\r\n\t\tchangeHandler();\r\n\t});\r\n\tvar changeHandler = function(){\r\n\t\tif(self.showing_range && secondip.value){\r\n\t\t\tif(firstip.value) frame.set(\"[\" + firstip.value + \",\" + secondip.value + \"]\");\t\t\t\t\r\n\t\t\telse frame.set(secondip.value);\t\t\t\t\r\n\t\t}\r\n\t\telse {\r\n\t\t\tframe.set(firstip.value);\r\n\t\t}\r\n\t}\r\n\tfirstip.addEventListener(\"change\", changeHandler);\r\n\tsecondip.addEventListener(\"change\", changeHandler);\r\n\treturn d;\r\n}\r\n\r\nfunction getRangeSymbolDOM(){\r\n\tvar d = document.createElement(\"span\");\r\n\td.setAttribute(\"class\", \"terminus-range-indicator\");\r\n\td.setAttribute(\"title\", \"The value is uncertain, it lies somewhere in this range\");\r\n\td.appendChild(document.createTextNode(\" ... \"));\r\n\treturn d;\r\n}\r\n\r\nmodule.exports={HTMLRangeEditor}\r\n","function SantizedHTMLViewer(options){\r\n\tthis.css = ((options && options.css) ? \"literal-value \" + options.css : \"literal-value\");\r\n}\r\n\r\nSantizedHTMLViewer.prototype.render = function(value){\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', this.css);\r\n\tinput.setAttribute('data-value', value);\r\n\tinput.innerHTML = value;\r\n\treturn input;\r\n}\r\n\r\nSantizedHTMLViewer.prototype.renderFrame = function(frame, dataviewer){\r\n\tvar value = frame.get();\r\n\treturn this.render(value);\r\n}\r\n\r\nSantizedHTMLViewer.prototype.renderValue = function(dataviewer){\r\n\treturn this.render(dataviewer.value());\r\n}\r\n\r\nmodule.exports={SantizedHTMLViewer}\r\n","const GoogleMapHelper = require(\"./GoogleMapHelper\")\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\nfunction GoogleMapEditor(options){}\r\n\r\nGoogleMapEditor.prototype.renderFrame = function(frame, dataviewer){\r\n\tvar mapcontainer = document.createElement(\"div\");\r\n\tmapcontainer.setAttribute('class', \"gmap-window gmap-editor\");\r\n\tvar self = this;\r\n\tvar ghelper = new GoogleMapHelper();\r\n\tvar map = ghelper.initMap(mapcontainer, value, this.type);\r\n    if(ty == \"xdd:coordinate\"){\r\n\t    google.maps.event.addListener(map, 'click', function(event) {\r\n\t    \tvar position = event.latLng;\r\n\t    \tvar coo = \"[\" + position.lat() + \",\" + position.lng() + \"]\";\r\n\t    \trenderer.set(coo);\r\n\t        ghelper.clearMarkers();\r\n\t        var init = {\r\n\t    \t\tposition: position, \r\n\t    \t\tmap: map\r\n\t    \t}\r\n\t    \tvar marker = new google.maps.Marker(init);\r\n\t    \tghelper.markers.push(marker);\r\n\t  \t});\r\n\t}\r\n    else {\r\n    \tgoogle.maps.event.addListener(map, 'click', function(event) {\r\n        \tvar path = ghelper.polyline.getPath();\r\n        \tpath.push(event.latLng);\r\n      \t    var position = event.latLng;\r\n      \t    ghelper.addMarker(position, map, frame, '#' + path.getLength(), this.type);\r\n      \t});\r\n    }\r\n    return mapcontainer;\r\n}\r\n\r\nmodule.exports={GoogleMapEditor};","function GoogleMapHelper(options){\r\n\tthis.polygon = false;\r\n\tthis.polyline = false;\r\n\tthis.markers = [];\r\n\tthis.init(options);\r\n}\r\n\r\nGoogleMapHelper.prototype.init = function(config){\r\n\tthis.type = ((config && config.type) ? config.type: 'Shape'); \r\n\tthis.width = ((config && config.width) ? config.width : '400px'); \r\n\tthis.height = ((config && config.height ) ? config.height : '400px'); \r\n\tthis.mapLat = ((config && config.mapLat) ? config.mapLat : '41.9010004'); \r\n\tthis.mapLong = ((config && config.mapLong ) ? config.mapLong : '12.500061500000015');\r\n\tthis.zoom = ((config && config.zoom) ? config.zoom : 3);\r\n\tthis.stroke = ((config && config.stroke) ? config.stroke : { color: '#FF0000', opacity: 0.3, weight: 3});\r\n\tthis.fill = ((config && config.fill) ? config.fill : { color: '#FF0000', opacity: 0.1});\r\n\tthis.line = ((config && config.line) ? config.line : { color: '#000000', opacity: 0.9, weight: 3});\r\n}\r\n\r\nGoogleMapHelper.prototype.destroy = function(){\r\n    this.clear();\r\n} \r\n\r\nGoogleMapHelper.prototype.translatePolygonToArray = function(polygon){\r\n   var data = \"[\";\r\n   var vertices = polygon.getPath();\r\n   var seenValue = false;\r\n   for (var j=0; j<vertices.getLength(); j++){\r\n       if(seenValue){\r\n           data = data + \",\";\r\n       }\r\n       var xy = vertices.getAt(j);\r\n       data = data + \"[\" + xy.lat() + \",\" + xy.lng() + \"]\"\r\n       seenValue = true;\r\n   }\r\n   data = data + \"]\";\r\n   return data;\r\n};\r\n\r\nGoogleMapHelper.prototype.translateArrayToPolygon = function(array){\r\n   var jsonified = JSON.parse(array);\r\n   var output = [];\r\n   for(var i=0;i<jsonified.length;i++){\r\n       var latlong = {}\r\n       latlong.lat = jsonified[i][0];\r\n       latlong.lng = jsonified[i][1];\r\n       output.push(latlong);\r\n   }\r\n   return output;\r\n}\r\n\r\nGoogleMapHelper.prototype.createPolygon = function(coords, map) {\r\n\tvar polygon = new google.maps.Polygon({\r\n        paths: coords,\r\n        strokeColor: this.stroke.color,\r\n        strokeOpacity: this.stroke.opacity,\r\n        strokeWeight: this.stroke.weight,\r\n        fillColor: this.fill.color,\r\n        fillOpacity: this.fill.opacity\r\n\t});\r\n    polygon.setMap(map);\r\n\treturn polygon;\r\n}\r\n\r\nGoogleMapHelper.prototype.createPolyline = function(coords){\r\n\tvar init = {\r\n\t      strokeColor: this.line.color,\r\n\t      strokeOpacity: this.line.opacity,\r\n\t      strokeWeight: this.line.weight\r\n\t};\r\n\tif(coords){\r\n\t\tinit.paths = coords;\r\n\t}\r\n\tvar poly = new google.maps.Polyline(init);\r\n\treturn poly;\r\n}\r\n\r\nGoogleMapHelper.prototype.clearMarkers = function() {\r\n\tfor (var i = 0; i < this.markers.length; i++ ) {\r\n\t\tthis.markers[i].setMap(null);\r\n\t}\r\n\tthis.markers.length = 0;\r\n}\r\n\r\n\r\nGoogleMapHelper.prototype.addMarker = function(position, map, frame, title, ty) {\r\n\tvar init = {\r\n\t\tposition: position, \r\n\t\tmap: map\r\n\t}\r\n\tif(title){\r\n\t\tinit.title = title;\r\n\t}\r\n\tvar marker = new google.maps.Marker(init);\r\n\tvar self = this;\r\n\tif(this.markers.length == 0 && ty == \"xdd:coordinatePolygon\"){\r\n     \tmarker.addListener('click', function() {\r\n\t\t\tvar coords = self.getCoordsFromMarkers();\r\n    \t\tself.polygon = self.createPolygon(coords, map);\r\n            self.clearMarkers();\r\n            self.polyline.setMap(null);\r\n            frame.set(self.translatePolygonToArray(self.polygon));\r\n        });                \t\r\n    }\r\n\tthis.markers.push(marker);\r\n\tif(ty == \"xdd:coordinatePolyline\"){\r\n\t\tvar x = this.translatePolygonToArray(this.polyline);\r\n\t\tframe.set(x);\r\n\t}\r\n\treturn marker;\r\n}\r\n\r\nGoogleMapHelper.prototype.getCoordsFromMarkers = function(){\r\n\treturn this.polyline.getPath();\r\n}\r\n\r\nGoogleMapHelper.prototype.clear = function(){\r\n\tif(this.polygon) {\r\n\t\tthis.polygon.setMap(null);\r\n\t\tthis.polygon = false;\r\n\t}\r\n\tif(this.polyline) {\r\n\t\tthis.clearMarkers();\r\n\t\tthis.polyline.setMap(null);\r\n\t}\r\n}\r\n\r\nGoogleMapHelper.prototype.initMap = function(mapContainer, value, type){\r\n\tmapContainer.style.width = this.width;\r\n\tmapContainer.style.height = this.height;\r\n\tif(typeof google == \"undefined\"){\r\n\t\talert(\"google is not effing loaded\");\r\n\t\treturn false;\r\n\t}\r\n\tvar map = new google.maps.Map(mapContainer, {\r\n\t    zoom: this.zoom,\r\n\t\tcenter: {lat: parseFloat(this.mapLat), lng: parseFloat(this.mapLong)}  \r\n\t});\r\n\tif(type == \"xdd:coordinatePolygon\"){\r\n\t    this.polyline = this.createPolyline();\r\n\t\tthis.polyline.setMap(map);\r\n\t\tvar coords = (value ? this.translateArrayToPolygon(value) : []);\r\n\t\tif(value){\r\n\t    \tthis.polygon = this.createPolygon(coords, map);\r\n\t    }\r\n\t}\r\n\telse if(type == \"xdd:coordinatePolyline\"){\r\n\t\tvar coords = (value ? this.translateArrayToPolygon(value) : []);\r\n\t    this.polyline = this.createPolyline();\r\n\t\tthis.polyline.setMap(map);\t\t\r\n\t\tif(value){\r\n\t    \tthis.polyline.setPath(coords);\r\n\t    }\r\n\t}\t\r\n\telse if(type == \"xdd:coordinate\"){\r\n\t\tif(value){\r\n\t\t\tthis.clearMarkers();\r\n            var lat = parseFloat(value.substring(1, value.indexOf(\",\")));\r\n\t\t\tvar long = parseFloat(value.substring(value.indexOf(\",\")+1, value.length-1));\r\n            var init = {\r\n            \tposition: {lat: lat, lng: long},\r\n        \t\tmap: map\r\n\t        }\r\n\t        var marker = new google.maps.Marker(init);\r\n\t        this.markers.push(marker);\r\n\t\t}\r\n\t}\r\n    google.maps.event.trigger(map, 'resize');\r\n    return map;\r\n}\r\n\r\nmodule.exports=GoogleMapHelper;","const GoogleMapHelper = require(\"./GoogleMapHelper\")\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction GoogleMapViewer(options){}\r\n\r\nGoogleMapViewer.prototype.renderFrame = function(frame, dataviewer){\r\n\treturn this.render(frame.get());\r\n}\r\n\r\nGoogleMapViewer.prototype.renderValue = function(dataviewer){\r\n\treturn this.render(dataviewer.value());\r\n}\r\n\t\r\nGoogleMapViewer.prototype.render = function(value){\r\n\tvar map = document.createElement(\"div\");\r\n\tmap.setAttribute('class', \"gmap-window gmap-viewer\");\r\n\tvar self = this;\r\n\tvar ghelper = new GoogleMapHelper();\r\n\tghelper.initMap(map, value, this.type);\t\t\r\n    return map;\r\n}\r\n\r\nmodule.exports={GoogleMapViewer};","const TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction HTMLMarkupEditor(options){}\r\n\r\nHTMLMarkupEditor.prototype.renderFrame = function(frame, dataviewer){\r\n\tvar value = frame.get();\r\n\tvar input = document.createElement(\"div\");\r\n\tinput.setAttribute('class', \"html-wysiwyg\");\r\n\tvar inner = document.createElement(\"span\");\r\n\tinner.setAttribute('class', \"html-literal literal-value\");\r\n\tinner.innerHTML=value;\r\n\tinput.appendChild(inner);\r\n\tif(typeof Quill != \"undefined\"){\r\n\t\tvar quill = new Quill(inner, { theme: 'snow' });\r\n\t\tquill.on(\"text-change\", function(){\r\n\t\t\tframe.set(quill.root.innerHTML);\r\n\t\t});\r\n\t}\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={HTMLMarkupEditor}","function S2EntityEditor(options){}\r\n\r\nS2EntityEditor.prototype.renderFrame = function(frame, dataviewer){\r\n\tvar value = frame.get();\r\n\tvar cls = frame.range();\r\n\tvar cback = frame.set;\r\n\tvar ctl = dataviewer.getClient();\r\n\tvar d2ch = new TerminusDocumentChooser(ctl, cls, value);\r\n\td2ch.change = function(val){\r\n\t\tframe.set(val);\r\n\t}\r\n\td2ch.view = \"label\";\r\n\tvar d2dom = d2ch.getAsDOM();\r\n\treturn d2dom;\r\n}\r\n\r\n\r\nmodule.exports={S2EntityEditor}","/*\r\n * User Interface elements dealing with database level functions - view, delete, create, db\r\n * view document etc\r\n */\r\nconst WOQLResultsViewer = require('./client/WOQLResultsViewer');\r\nconst TerminusClassChooser = require('./client/TerminusClassChooser');\r\nconst TerminusDocumentChooser = require('./client/TerminusDocumentChooser');\r\nconst WOQLQuery=require('./client/WOQLQuery');\r\nconst UTILS=require('./Utils');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\nconst TerminusHTMLViewer = require(\"./TerminusHTMLViewer\");\r\n\r\n/*\r\n * User Interface elements dealing with database level functions - view, delete, create, db\r\n * view document etc\r\n */\r\nfunction TerminusDBController(ui){\r\n\t this.ui = ui;\r\n}\r\n\r\n/*\r\n * Controller provides access to the server level functions (create/delete db) and db-level functions (schema, query, document)\r\n */\r\nTerminusDBController.prototype.getAsDOM = function(){\r\n\tvar self = this;\r\n\tvar dbc = document.createElement(\"div\");\r\n\tdbc.setAttribute(\"class\", \"terminus-db-controller\");\r\n\tif(this.ui && this.ui.db()){\r\n\t\tvar scd = document.createElement(\"div\");\r\n\t\tscd.setAttribute(\"class\", \"terminus-field terminus-db-connection\");\r\n\t\tvar lab = document.createElement(\"span\");\r\n\t\tlab.setAttribute(\"class\", \"terminus-label terminus-db-label terminus-control-panel-label\");\r\n\t\tlab.appendChild(document.createTextNode(\"DB \"));\r\n\t\tvar val = document.createElement(\"span\");\r\n\t\tval.setAttribute(\"class\", \"terminus-value terminus-db-value terminus-control-panel-value\");\r\n\t\tvar dbrec = this.ui.client.connection.getDBRecord();\r\n\t\tvar nm = (dbrec && dbrec[\"rdfs:label\"] && dbrec[\"rdfs:label\"][\"@value\"] ? dbrec[\"rdfs:label\"][\"@value\"] : this.ui.db());\r\n\t\tval.appendChild(document.createTextNode(nm));\r\n\t\tscd.appendChild(lab);\r\n\t\tscd.appendChild(val);\r\n\t\t//dbc.appendChild(scd);\r\n\t\tvar nav = document.createElement('div');\r\n\t\tnav.setAttribute('class', 'span3');\r\n\t\tdbc.appendChild(nav);\r\n\t\tvar ul = document.createElement('ul');\r\n\t\tul.setAttribute('class','terminus-ul' );\r\n\t\tnav.appendChild(ul);\r\n\t\t// connected to db\r\n\t\tvar a = document.createElement('a');\r\n        a.setAttribute('class', 'terminus-dashboard-info terminus-list-group-a terminus-nav-width');\r\n        var txt = 'Database: ' + nm;\r\n        a.appendChild(document.createTextNode(txt));\r\n        ul.appendChild(a);\r\n\t\tif(this.ui.showControl(\"db\")){\r\n\t\t\tvar item = this.getControlHTML(\"Database Home\", \"fa-home\");\r\n\t\t\titem.classList.add(\"terminus-selected\");\r\n\t\t    item.addEventListener(\"click\", function(){\r\n\t\t\t\tUTILS.activateSelectedNav(this, self);\r\n\t\t\t\tself.ui.showDBMainPage();\r\n\t\t\t });\r\n\t        ul.appendChild(item);\r\n\t    }\r\n\t\tif(this.ui.showControl(\"delete_database\")){\r\n\t\t\tvar item = this.getControlHTML(\"Delete Database\", \"fa-trash-alt\");\r\n\t\t    item.addEventListener(\"click\", function(){\r\n\t\t\t\tUTILS.activateSelectedNav(this, self);\r\n\t\t\t\tself.ui.deleteDatabase();\r\n\t\t\t });\r\n\t        ul.appendChild(item);\r\n\t\t}\r\n\t\tif(this.ui.showControl(\"woql_select\")){\r\n\t\t\tvar item = this.getControlHTML(\"Query\", \"fa-search\");\r\n\t\t    item.addEventListener(\"click\", function(){\r\n\t\t\t\tUTILS.activateSelectedNav(this, self);\r\n\t\t\t\tself.ui.showQueryPage();\r\n\t\t\t});\r\n\t        ul.appendChild(item);\r\n\t\t}\r\n\t\tif(this.ui.showControl(\"woql_update\")){\r\n\t\t\tvar item = this.getControlHTML(\"Mapping\", \"fa-file-import\");\r\n\t        item.addEventListener(\"click\", function(){\r\n\t\t\t\tUTILS.activateSelectedNav(this, self);\r\n\t\t\t\tself.ui.showMappingPage();\r\n\t\t\t})\r\n\t        ul.appendChild(item);\r\n\t\t}\r\n\t\tif(this.ui.showControl(\"get_schema\")){\r\n\t\t\tvar item = this.getControlHTML(\"Schema\", \"fa-cog\");\r\n\t        item.addEventListener(\"click\", function(){\r\n\t\t\t\tUTILS.activateSelectedNav(this, self);\r\n\t\t\t\tself.ui.showSchemaPage();\r\n\t\t\t})\r\n\t        ul.appendChild(item);\r\n\t\t}\r\n\t\tif((this.ui.showControl(\"get_document\") || this.ui.showControl(\"create_document\"))){\r\n\t\t\tvar item = this.getControlHTML(\"Document\", \"fa-book\");\r\n\t\t\titem.classList.add('terminus-document-nav');\r\n\t        item.addEventListener(\"click\", function(){\r\n\t\t\t\tUTILS.activateSelectedNav(this, self);\r\n\t\t\t\tself.ui.showDocumentPage();\r\n\t\t\t\t//UTILS.removeSelectedNavClass(\"terminus-selected\");\r\n                //this.classList.add(\"terminus-selected\");\r\n\t\t\t\t//UTILS.displayDocumentSubMenus(self.ui);\r\n\t\t\t})\r\n\t        ul.appendChild(item);\r\n\t\t}\r\n\t\t// hidden submenus\r\n\t\t/*if(this.ui.showControl(\"get_document\")) {\r\n\t\t\tvar a = document.createElement('a');\r\n\t\t\ta.setAttribute('class', 'terminus-hide terminus-get-doc');\r\n\t\t\ta.appendChild(self.getDocumentChooserDOM());\r\n\t\t\ta.classList.add();\r\n\t\t\tul.appendChild(a);\r\n\t\t}\r\n\t\t// hidden submenus\r\n\t\tif(this.ui.showControl(\"create_document\")) {\r\n\t\t\tvar a = document.createElement('a');\r\n\t\t\ta.setAttribute('class', 'terminus-hide terminus-create-doc');\r\n\t\t\ta.appendChild(self.getDocumentCreatorDOM());\r\n\t\t\tul.appendChild(a);\r\n\t\t} */\r\n\t}\r\n\treturn dbc;\r\n}\r\n\r\n\r\nTerminusDBController.prototype.getControlHTML = function(text, ic, css){\r\n    var self = this;\r\n    var a = document.createElement('a');\r\n\ta.setAttribute('class', 'terminus-a terminus-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\r\n    var icon = document.createElement('i');\r\n    icon.setAttribute('class', 'terminus-menu-icon fa ' + ic);\r\n    a.appendChild(icon);\r\n    var txt = document.createTextNode(text);\r\n    a.appendChild(txt);\r\n    return a;\r\n}\r\n\r\nTerminusDBController.prototype.getDocumentChooserDOM = function(){\r\n\tvar self = this;\r\n\tvar scd = document.createElement(\"span\");\r\n\tscd.setAttribute(\"class\", \"terminus-document-chooser terminus-form-horizontal terminus-control-group terminus-choose-by-id\");\r\n\tvar lab = document.createElement(\"span\");\r\n\tlab.setAttribute(\"class\", \"terminus-document-chooser-label terminus-control-label terminus-control-label-padding\");\r\n\t//lab.appendChild(document.createTextNode(\"ID \"));\r\n\tvar dcip = document.createElement(\"input\");\r\n\tdcip.setAttribute(\"class\", \"terminus-form-doc-value terminus-document-chooser terminus-doc-input-text\");\r\n\tdcip.setAttribute(\"placeholder\", \"Enter Document ID\");\r\n\tvar nbut = document.createElement(\"button\");\r\n\tnbut.setAttribute('class', \"terminus-control-button terminus-document-button terminus-doc-btn\")\r\n\tnbut.appendChild(document.createTextNode(\"View\"));\r\n\tnbut.addEventListener(\"click\", function(){\r\n\t\tif(dcip.value) self.ui.showDocument(dcip.value);\r\n\t})\r\n\tif(this.ui.client.connectionConfig.platformEndpoint() && this.ui.pluginAvailable(\"select2\")){\r\n\r\n\t\tvar mcls = TerminusClient.FrameHelper.unshorten(\"tcs:Document\");\r\n\t\tvar d2ch = new TerminusDocumentChooser(this.ui, mcls);\r\n\t\td2ch.change = function(val){\r\n\t\t\tself.ui.showDocument(val);\r\n\t\t}\r\n\t\td2ch.view = \"label\";\r\n\t\tvar sdom = d2ch.getAsDOM('terminus-class-select');\r\n\t\tjQuery(dcip).hide();\r\n\t\tjQuery(nbut).hide();\r\n\t\tvar nlab = document.createElement(\"a\");\r\n\t\tnlab.setAttribute(\"href\", \"#\");\r\n\t\tnlab.setAttribute(\"class\", \"terminus-document-which-chooser\");\r\n\t\tnlab.appendChild(document.createTextNode(\"Choose by ID\"));\r\n\t\tvar show = \"label\";\r\n\t\tjQuery(nlab).click(function(){\r\n\t\t\tif(show == \"label\"){\r\n\t\t\t\tshow = \"id\";\r\n\t\t\t\tjQuery(dcip).show();\r\n\t\t\t\tjQuery(nbut).show();\r\n\t\t\t\tjQuery(sdom).hide();\r\n\t\t\t\tjQuery(nlab).text(\"Choose by Label\");\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tshow = \"label\";\r\n\t\t\t\tjQuery(dcip).hide();\r\n\t\t\t\tjQuery(nbut).hide();\r\n\t\t\t\tjQuery(sdom).show();\r\n\t\t\t\tjQuery(nlab).text(\"Choose by ID\");\r\n\t\t\t}\r\n\t\t})\r\n\t\tscd.appendChild(sdom);\r\n\t\tscd.prepend(nlab);\r\n\t}\r\n\tvar nbuts = document.createElement(\"span\");\r\n\tnbuts.setAttribute(\"class\", \"terminus-control-buttons terminus-document-chooser-buttons\");\r\n\tnbuts.appendChild(nbut);\r\n\tscd.appendChild(lab);\r\n\tscd.appendChild(dcip);\r\n\tscd.appendChild(nbuts);\r\n\treturn scd;\r\n};\r\n\r\nTerminusDBController.prototype.getDocumentCreatorDOM = function(){\r\n\tvar self = this;\r\n\tvar scd = document.createElement(\"div\");\r\n\tscd.setAttribute(\"class\", \"terminus-document-creator terminus-form-horizontal terminus-control-group terminus-choose-by-id\");\r\n\r\n\tvar dcip = document.createElement(\"input\");\r\n\tdcip.setAttribute(\"class\", \"terminus-form-doc-value terminus-document-creator terminus-doc-input-text\");\r\n\tdcip.setAttribute(\"placeholder\", \"Enter Document Type\");\r\n\tvar nbut = document.createElement(\"button\");\r\n\tvar lab = document.createElement(\"span\");\r\n\tlab.setAttribute(\"class\", \"document-creator-label terminus-control-label terminus-control-label-padding\");\r\n\t//lab.appendChild(document.createTextNode(\"Type \"));\r\n\tnbut.setAttribute('class', \"terminus-control-button create-document-button terminus-doc-btn\")\r\n\tnbut.appendChild(document.createTextNode(\"Create\"));\r\n\tnbut.addEventListener(\"click\", function(){\r\n\t\tif(dcip.value) self.ui.showCreateDocument(dcip.value);\r\n\t})\r\n\tvar nbuts = document.createElement(\"div\");\r\n\tnbuts.setAttribute(\"class\", \"terminus-control-buttons terminus-document-creator-buttons\");\r\n\tvar wq = new WOQLQuery(this.ui.client, {}, this.ui);\r\n\tvar filter = wq.getConcreteDocumentClassPattern(\"v:Element\");\r\n\tvar termcc = new TerminusClassChooser(this.ui, filter);\r\n\ttermcc.empty_choice = \"Create Document of Type\";\r\n\tvar self = this;\r\n\ttermcc.change = function(new_class){\r\n\t\tif(new_class){\r\n\t\t\tself.ui.showCreateDocument(new_class);\r\n\t\t\ttermcc.choice = false;\r\n\t\t}\r\n\t}\r\n\tvar tcdom = termcc.getAsDOM('terminus-class-select');\r\n\r\n\tvar gb = document.createElement('div');\r\n\tgb.setAttribute('class', 'terminus-doc-btn-group');\r\n\tvar bi = document.createElement('button');\r\n\tbi.setAttribute('class', 'terminus-doc-btn-selected terminus-doc-toggle-btn');\r\n\tbi.appendChild((document.createTextNode('D')));\r\n\tvar tds = document.createElement('span');\r\n\ttds.setAttribute('class', 'terminus-tooltiptext');\r\n\ttds.appendChild(document.createTextNode('Dropdown List'));\r\n\tbi.appendChild(tds);\r\n\tvar bt = document.createElement('button');\r\n\tbt.setAttribute('class', 'terminus-doc-toggle-btn');\r\n\tbt.appendChild((document.createTextNode('T')));\r\n\tvar tts = document.createElement('span');\r\n\ttts.setAttribute('class', 'terminus-tooltiptext');\r\n\ttts.appendChild(document.createTextNode('Text Input'));\r\n\tbt.appendChild(tts);\r\n\tgb.appendChild(bt);\r\n\tgb.appendChild(bi);\r\n\tvar nlabs = document.createElement(\"div\");\r\n\tnlabs.setAttribute('class', 'terminus-doc-btn-gp-align');\r\n\tnlabs.appendChild(gb);\r\n\tscd.appendChild(nlabs);\r\n\tvar ccDOM = document.createElement(\"span\");\r\n\tnlabs.appendChild(ccDOM);\r\n\tccDOM.setAttribute(\"class\", \"create-document-list\");\r\n\tccDOM.appendChild(tcdom);\r\n\tvar which = \"select\";\r\n\tbt.addEventListener(\"click\", function(){\r\n\t\t// create document of TerminusClient.FrameHelper.removeChildren(nlabs);\r\n\t\tTerminusClient.FrameHelper.removeChildren(ccDOM);\r\n\t\tUTILS.removeSelectedNavClass(\"terminus-doc-btn-selected\");\r\n\t\tthis.classList.add(\"terminus-doc-btn-selected\");\r\n\t\tccDOM.appendChild(dcip);\r\n\t\tccDOM.appendChild(nbut);\r\n\t});\r\n\r\n\tbi.addEventListener(\"click\", function(){\r\n\t\t// create document from dropdown\r\n\t\tTerminusClient.FrameHelper.removeChildren(ccDOM);\r\n\t\tUTILS.removeSelectedNavClass(\"terminus-doc-btn-selected\");\r\n\t\tthis.classList.add(\"terminus-doc-btn-selected\");\r\n\t\tccDOM.appendChild(tcdom);\r\n\t});\r\n\treturn scd;\r\n};\r\n\r\nfunction TerminusDBViewer(ui){\r\n\tthis.ui = ui;\r\n\tthis.wquery = new WOQLQuery(ui.client, this.options, ui);\r\n}\r\n\r\nTerminusDBViewer.prototype.getAsDOM = function(selected){\r\n\tvar pd = document.createElement(\"span\");\r\n\tpd.setAttribute(\"class\", \"terminus-db-home-page\");\r\n\tvar sth = document.createElement('div');\r\n\tvar banner = document.createElement('div');\r\n\t//pd.appendChild(banner);\r\n\tbanner.setAttribute('class', 'terminus-banner');\r\n\tvar dhp = document.createElement(\"span\");\r\n\tdhp.setAttribute('class', 'terminus-home-heading');\r\n\tdhp.appendChild(document.createTextNode(\"DB Home Page - \"));\r\n\tsth.appendChild(dhp);\r\n\tvar scd = document.createElement(\"span\");\r\n\tscd.setAttribute(\"class\", \"terminus-db-details\");\r\n\tvar scs = document.createElement(\"span\");\r\n\tscs.setAttribute(\"class\", \"terminus-db-details-value \");\r\n\tvar dbrec = this.ui.getDBRecord();\r\n\tif(dbrec){\r\n\t\tvar nm = (dbrec[\"rdfs:label\"] && dbrec[\"rdfs:label\"][\"@value\"] ? dbrec[\"rdfs:label\"][\"@value\"] : this.db);\r\n\t\tscs.appendChild(document.createTextNode(nm));\r\n\t\tscs.setAttribute('class', 'terminus-home-heading');\r\n\t}\r\n\tscd.appendChild(scs);\r\n\tsth.appendChild(scd);\r\n\tbanner.appendChild(sth);\r\n\t//pd.appendChild(sth);\r\n\t//pd.appendChild(UTILS.getHeaderDom('Summary'));\r\n\tthis.getDeleteOnHomePage(pd);\r\n\t//this.getDBSummary(pd);\r\n\tvar lod = document.createElement('div');\r\n\tlod.setAttribute('class', 'terminus-list-of-doc');\r\n\tlod.appendChild(UTILS.getHeaderDom('List of Documents'))\r\n\tpd.appendChild(lod);\r\n\tlet query = TerminusClient.WOQL.limit(25).start(0).getEverything();\r\n\tlet test = query.prettyPrint();\r\n\tpd.appendChild(document.createTextNode(JSON.stringify(test)));\r\n\t//this.getClassesDOM(pd); // un comment this later on ...\r\n\treturn pd;\r\n}\r\n\r\nTerminusDBViewer.prototype.getDbInfoBox = function(r, module){\r\n\tvar sp = document.createElement('span');\r\n    sp.setAttribute('class', 'terminus-db-info-box');\r\n\tvar info = document.createElement('div');\r\n\tinfo.appendChild(document.createTextNode(module.charAt(0).toUpperCase() + module.slice(1)));\r\n\tinfo.setAttribute('class', 'terminus-db-info');\r\n\tsp.appendChild(info);\r\n\r\n    var i = document.createElement('i');\r\n\tswitch(module){\r\n\t\tcase 'size':\r\n\t\t\ti.setAttribute('class', 'terminus-icon fa fa-balance-scale');\r\n\t\t    var txt = document.createTextNode('2 Gb');\r\n\t\tbreak;\r\n\t\tcase 'created':\r\n\t\t\ti.setAttribute('class', 'terminus-icon fa fa-calendar');\r\n\t\t    var txt = document.createTextNode('16 July 2015');\r\n\t\tbreak;\r\n\t\tcase 'modified':\r\n\t\t\ti.setAttribute('class', 'terminus-icon fa fa-clock');\r\n\t\t    var txt = document.createTextNode('22 Dec 2019');\r\n\t\tbreak;\r\n\t}\r\n    sp.appendChild(i);\r\n\tif(txt) sp.appendChild(txt);\r\n    r.appendChild(sp);\r\n}\r\n\r\nTerminusDBViewer.prototype.getDeleteOnHomePage = function(d){\r\n\t// delete database\r\n\tif(this.ui.db() == \"terminus\") return;\r\n    var del = document.createElement('button');\r\n    del.setAttribute('class', 'terminus-btn terminus-btn-float-right terminus-home-del');\r\n    del.setAttribute('type', 'button');\r\n    del.innerHTML = 'Delete Database';\r\n\tvar dbrec = this.ui.getDBRecord();\r\n\tif(dbrec)\r\n\t\tvar nm = (dbrec[\"rdfs:label\"] && dbrec[\"rdfs:label\"][\"@value\"] ? dbrec[\"rdfs:label\"][\"@value\"] : this.ui.db());\r\n    var self = this;\r\n    var dbdel = this.ui.db();\r\n\r\n    del.addEventListener(\"click\", function(){\r\n      \tvar deleteConfirm = confirm(`Do you want to delete ${dbdel} Database?`);\r\n\t\tif (deleteConfirm == true) {\r\n\t\t\tself.ui.deleteDatabase(dbdel);\r\n\t\t}\r\n    });\r\n    d.appendChild(del);\r\n}\r\n\r\nTerminusDBViewer.prototype.getDBSummary = function(d){\r\n    var r = document.createElement('span');\r\n    r.setAttribute('class', 'terminus-db-info-box-display');\r\n    d.appendChild(r);\r\n\r\n    /* getDbInfoBox() calls can change according to further requirments */\r\n    this.getDbInfoBox(r, 'size');\r\n    this.getDbInfoBox(r, 'created');\r\n    this.getDbInfoBox(r, 'modified');\r\n}\r\n\r\nTerminusDBViewer.prototype.getDocumentTableConfig = function(nq){\r\n\tvar self = this;\r\n\tvar rowClick = function(row){\r\n\t\tself.ui.showDocument(row['v:ID']);\r\n\t};\r\n\tvar cellClick = function(key, value){\r\n\t\tself.ui.showDocument(value);\r\n\t}\r\n\r\n\tvar opts = {\r\n\t\t//cellClick: cellClick,\r\n\t\trowClick: rowClick,\r\n\t\t\"v:ID\": {\r\n\t\t\thidden: true\r\n\t\t},\r\n\t\t\"v:Class\": {hidden: true },\r\n\t\t\"v:Type_Comment\": {hidden: true },\r\n\t\t\"v:Label\": {\r\n\t\t\theader: \"Document\",\r\n\t\t\trenderer: function(dataviewer){\r\n\t\t\t\treturn dataviewer.annotateValue(dataviewer.value(),\r\n\t\t\t\t\t{ ID: dataviewer.binding('v:ID')});\r\n\t\t\t},\r\n\t\t},\r\n\t\t\"v:Type\": {\r\n\t\t\trenderer: function(dataviewer){\r\n\t\t\t\treturn dataviewer.annotateValue(dataviewer.value(),\r\n\t\t\t\t\t\t{ Class: dataviewer.binding('v:Class'), Description: dataviewer.binding('v:Type_Comment')}\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t},\r\n\t\t\"v:Comment\": {\theader: \"Description\", renderer: \"HTMLStringViewer\", args: {max_cell_size: 40, max_word_size: 10} },\r\n\t\t\"column_order\" : [\"v:Label\", \"v:Type\", \"v:Comment\"]\r\n\t}\r\n\t//return {};\r\n\treturn opts;\r\n}\r\n\r\n\r\n\r\nTerminusDBViewer.prototype.getClassesDOM = function(d){\r\n\t/*var q = TerminusClient.WOQL\r\n\t\t\t\t.limit(25)\r\n\t\t\t\t.start(0)\r\n\t\t\t\t.documentMetadata();*/\r\n\tvar self = this;\r\n\tvar rowClick = function(row){\r\n\t\tself.ui.showDocument(row['v:ID']);\r\n\t};\r\n\tvar cellClick = function(key, value){\r\n\t\tself.ui.showDocument(value);\r\n\t}\r\n\r\n\tvar showLabel = function(value, key, row){\r\n\t\tif(value) return document.createTextNode(value['@value'] + \" aa\");\r\n\t\treturn document.createElement(\"span\");\r\n\t}\r\n\tlet nq = new TerminusHTMLViewer(this.ui.client);//should specify default renderers here....\r\n\tlet WOQL = TerminusClient.WOQL;\r\n\tlet query = WOQL.from(this.ui.client.connectionConfig.dbURL()).limit(25).start(0).documentMetadata();\r\n\t//TerminusClient.FrameHelper.loadDynamicCSS(\"myfa\", \"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0-11/css/all.css\");\r\n\tquery.execute(this.ui.client).then((results) => {\r\n\t\t/*let qres = new TerminusClient.WOQLResult(results, query);\r\n\t\tvar nt = nq.showResult(qres, WOQL.table());\r\n\t\td.appendChild(nt);\r\n\t\tqres.first()\r\n\t\tvar n = nq.showResult(qres, WOQL.chooser());\r\n\t\td.appendChild(n);\r\n\t\tqres.first();\r\n\t\tvar lg = WOQL.graph();\r\n\t\tlg.source(\"v:Subject\");\r\n\t\tvar licon2 = { color: [255,255,25], weight: 100, unicode: \"\\uf2bb\", size:2 };\r\n\t\tlg.edge(\"v:Subject\", \"v:Object\").icon(licon2);\r\n\t\tvar ng = nq.showResult(qres, lg);\r\n\t\td.appendChild(ng);\r\n\t\tqres.first();\r\n\t\t//var sg = nq.showResult(qres, WOQL.stream());\r\n\t\t//d.appendChild(sg);\r\n\t\t//d.appendChild(nc);\r\n\t\t//var ng = nq.displayResults(false, WOQL.graph());\r\n\t\t//d.appendChild(ng);\r\n\t\tlet t = WOQL.table().pager(false);\r\n\t\tt.column(\"Class\", \"Type_Comment\", \"ID\").hidden(true);\r\n\t\tt.column(\"Label\").header(\"Document\");\r\n\t\tt.column(\"Comment\").header(\"Description\");\r\n\t\tt.column(\"Comment\").renderer(\"HTMLStringViewer\").args({max_cell_size: 20, max_word_size: 10});\r\n\t\t//t.column_order(\"Subject\", \"Predicate\", \"Object\");\r\n\t\tt.column(\"Label\").render(showLabel);\r\n\t\tt.row().click(rowClick);\r\n\t\tqres.first();\r\n\t\tvar dt2 = nq.showResult(qres, t);\r\n\t\td.appendChild(dt2);\r\n\r\n\t\tqres.first();\r\n\t\tvar w = WOQL.chooser().values(\"ID\").labels(\"Comment\").titles(\"Class\").sort(\"Comment\").direction(\"asc\");\r\n\t\tw.change(function(x){\r\n\t\t\talert(x);\r\n\t\t}).show_empty(\"Choose something\");\r\n\t\tvar n2 = nq.showResult(qres, w);\r\n\t\td.appendChild(n2);\r\n\t\tvar licon2 = { color: [255,255,25], weight: 100, unicode: \"\\uf2bb\", size:2 };\r\n\t\tvar licon = { color: [255,255,255], weight: 100, unicode: \"\\uf1c2\"};\r\n\t\tvar licon3 = { color: [23,3,34], weight: 100, unicode: \"\\uf1c2\"};\r\n\t\tvar lborder = { color: [10,255,0], weight: 100, unicode: \"\\uf2bb\", size:2 };\r\n\t\tvar g = WOQL.graph();\r\n\t\tg.source(\"ID\").width(\"1000\").height(1000);//.literals(false);\r\n\t\t//g.node(\"Id\").size(20).color([220, 202, 230]).collisionRadius(100).icon(licon3);\r\n\t\tg.node(\"Object\").size(24).color([20, 20, 20]).icon(licon2);\r\n\t\tg.node().literal(true).color([200, 200, 220]).size(10).icon(licon);\r\n\t\tg.node(\"Predicate\").hidden(true);\r\n\t\t//var e = g.rule().edge(\"ID\", \"Class\").label(x).icon(y).color();\r\n\t\t//var n = g.rule().node(\"ID\").label(x).icon(y).color();\r\n\t\tg.edges([\"Subject\", \"Object\"]);\r\n\t\tg.edge().color([150, 200, 250]);\r\n\t\tqres.first()\r\n\t\tvar ng3 = nq.showResult(qres, g);\r\n\t\td.appendChild(ng3);*/\r\n\t\tvar x = \"doc:access_all_areas\";\r\n\t\tvar nd = WOQL.document();\r\n\t\tnd.show_all(\"SimpleFrameViewer\");\r\n\t\tnd.object().features(\"id\", \"type\", \"comment\", \"delete\", \"reset\", \"hide\", \"show\", \"clone\", \"update\", \"view\", \"add\", \"value\");//\"summary\", \"viewer\", \"status\",\r\n\t\tnd.property().features(\"value\");//features(\"id\", \"cardinality\", \"type\", \"comment\", \"delete\", \"reset\", \"hide\", \"show\", \"clone\", \"update\", \"view\", \"add\", \"value\");//\"summary\", \"status\",\r\n\t\tnd.data().features(\"value\");//.dataviewer(\"HTMLStringViewer\").args({max_cell_size: 20, max_word_size: 10});\r\n\t\tvar d1 = nq.document(x, nd);\r\n\t\td.appendChild(d1);\r\n\t});\r\n\t//let c = WOQL.chooser();\r\n\r\n\t//t.display(query);\r\n\t//t.column(\"Label\").header(\"Document\").render(showLabel).click(cellClick);\r\n\t//t.column(\"ID\").header(\"l\").renderer(\"MyRenderer\");\r\n\t//should specify default renderers here....\r\n\t//var qp = nq.querypane(woql, this.getDocumentTableConfig());\r\n\r\n\t//let nquery = WOQL.from(this.ui.client.connectionConfig.dbURL()).limit(1000).simpleGraphQuery();\r\n\t//let g = WOQL.graph();\r\n\t//g.edge(\"v:Source\", \"v:Edge\", \"v:Target\").label(\"bla\").color([23,23,45]).weight(\"v:Account\")\r\n\t//t.column(\"Class\", \"Type_Comment\", \"ID\").hidden(true);\r\n\t//t.column(\"Label\").header(\"Document\").render(showLabel).click(cellClick);\r\n\t//t.column(\"Comment\").header(\"Description\").renderer(\"HTMLStringViewer\").args({max_cell_size: 20, max_word_size: 10});\r\n\t//t.column(\"ID\").header(\"l\").renderer(\"MyRenderer\");\r\n\t//t.order(\"Label\", \"Type\", \"Comment\");\r\n\t//var ng = nq.displayResults(nquery, g);\r\n\t//d.appendChild(ng);\r\n\r\n\r\n\treturn d;\r\n\t/*var q = this.wquery.getClassesQuery(25, 0);\r\n\tvar self = this;\r\n\t//this.wquery.execute(q)\r\n\tq.execute(this.ui.client)\r\n\t.then(function(result){\r\n\t\tvar wqRes = new TerminusClient.WOQLResult(result, q);\r\n\t\tself.result = new WOQLResultsViewer.WOQLResultsViewer(self.ui, result, wqRes, {}, {}, false);\r\n\t\tif(self.result){\r\n\t\t\tvar nd = self.result.getAsDOM(d, false);\r\n\t\t\tif(nd){\r\n\t\t\t\tnd.setAttribute('class', 'terminus-margin-box');\r\n\t        }\r\n\t\t\telse{\r\n\t\t\t\tnor = document.createElement('div');\r\n\t\t\t\tnor.setAttribute('class', 'terminus-no-res-alert');\r\n\t\t\t\tnor.appendChild(document.createTextNode(\"No results available, create new ones to view them here...\"));\r\n\t\t\t\td.appendChild(nor);\r\n\t\t\t}\r\n\t\t}\r\n\t})\r\n\t.catch(function(err){\r\n\t\tconsole.error(err);\r\n\t\tself.ui.showError(err);\r\n\t});\r\n\treturn d;*/\r\n}\r\n\r\n\r\nfunction TerminusDBCreator(ui){\r\n\tthis.ui = ui;\r\n}\r\n\r\nTerminusDBCreator.prototype.getAsDOM = function(selected){\r\n\tvar scd = document.createElement(\"div\");\r\n\t/* test delete when over var txtHolder = document.createElement(\"div\");\r\n\ttxtHolder.appendChild(document.createTextNode('expecting laoder herer'));\r\n\tscd.appendChild(txtHolder);\r\n\tthis.ui.getLoader(scd);*/\r\n\tscd.setAttribute(\"class\", \"terminus-db-creator\");\r\n\tvar sct = document.createElement(\"h3\");\r\n\tsct.setAttribute(\"class\", \"terminus-db-creator-title terminus-module-head\");\r\n\tsct.appendChild(document.createTextNode(\"Create New Database\"));\r\n\tscd.appendChild(sct);\r\n\tvar mfd = document.createElement('div');\r\n\tmfd.setAttribute('class', 'terminus-form-border');\r\n\tscd.appendChild(mfd);\r\n\tvar sci = document.createElement(\"div\");\r\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-form-field-spacing terminus-form-horizontal terminus-control-group\");\r\n\tvar slab = document.createElement(\"span\");\r\n\tslab.setAttribute(\"class\", \"terminus-id-label terminus-form-label terminus-control-label\");\r\n\tslab.appendChild(document.createTextNode(\"ID\"));\r\n\tsci.appendChild(slab);\r\n\tvar idip = document.createElement(\"input\");\r\n\tidip.setAttribute(\"type\", \"text\");\r\n\tidip.setAttribute(\"class\", \"terminus-form-value terminus-input-text\");\r\n\tidip.setAttribute(\"placeholder\", \"No spaces or special characters allowed in IDs\");\r\n\tsci.appendChild(idip);\r\n\tmfd.appendChild(sci);\r\n\tvar sci = document.createElement(\"div\");\r\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-form-field-spacing terminus-form-horizontal terminus-control-group\");\r\n\tvar slab = document.createElement(\"span\");\r\n\tslab.setAttribute(\"class\", \"terminus-title-label terminus-form-label terminus-control-label\");\r\n\tslab.appendChild(document.createTextNode(\"Title\"));\r\n\tvar titip = document.createElement(\"input\");\r\n\ttitip.setAttribute(\"type\", \"text\");\r\n\ttitip.setAttribute(\"placeholder\", \"A brief title for the Database\");\r\n\ttitip.setAttribute(\"class\", \"terminus-form-value terminus-input-text\");\r\n\tsci.appendChild(slab);\r\n\tsci.appendChild(titip);\r\n\tmfd.appendChild(sci);\r\n\tvar sci = document.createElement(\"div\");\r\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-form-field-spacing terminus-form-horizontal terminus-control-group\");\r\n\tvar slab = document.createElement(\"span\");\r\n\tslab.setAttribute(\"class\", \"terminus-title-label terminus-form-label terminus-control-label\");\r\n\tslab.appendChild(document.createTextNode(\"Description\"));\r\n\tsci.appendChild(slab);\r\n\tvar descip = document.createElement(\"textarea\");\r\n\tdescip.setAttribute(\"class\", \"terminus-textarea terminus-db-description terminus-textarea \");\r\n\tdescip.setAttribute(\"placeholder\", \"A short text describing the database and its purpose\");\r\n\tsci.appendChild(descip);\r\n\tmfd.appendChild(sci);\r\n\tvar sci = document.createElement(\"div\");\r\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-form-field-spacing terminus-form-horizontal terminus-control-group\");\r\n\tvar slab = document.createElement(\"span\");\r\n\tslab.setAttribute(\"class\", \"terminus-schema-label terminus-form-label terminus-control-label\");\r\n\tslab.appendChild(document.createTextNode(\"Import Schema\"));\r\n\tsci.appendChild(slab);\r\n\tvar schem = document.createElement(\"input\");\r\n\tschem.setAttribute(\"placeholder\", \"Terminus DB URL\");\r\n\tschem.setAttribute(\"type\", \"text\");\r\n\tschem.setAttribute(\"class\", \"terminus-form-value terminus-form-url terminus-input-text\");\r\n\tsci.appendChild(schem);\r\n\tmfd.appendChild(sci);\r\n\r\n\tvar sci = document.createElement(\"div\");\r\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-form-field-spacing terminus-form-horizontal terminus-control-group\");\r\n\tvar slab = document.createElement(\"span\");\r\n\tslab.setAttribute(\"class\", \"terminus-schema-label terminus-form-label terminus-control-label\");\r\n\tslab.appendChild(document.createTextNode(\"Key\"));\r\n\tsci.appendChild(slab);\r\n\tvar kip = document.createElement(\"input\");\r\n\tkip.setAttribute(\"placeholder\", \"Server API Key\");\r\n\tkip.setAttribute(\"type\", \"text\");\r\n\tkip.setAttribute(\"class\", \"terminus-form-value terminus-form-url terminus-input-text\");\r\n\tsci.appendChild(kip);\r\n\tmfd.appendChild(sci);\r\n\r\n\tvar sci = document.createElement(\"div\");\r\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-form-field-spacing terminus-form-horizontal terminus-control-group\");\r\n\tvar slab = document.createElement(\"span\");\r\n\tslab.setAttribute(\"class\", \"terminus-data-label terminus-form-label terminus-control-label\");\r\n\tslab.appendChild(document.createTextNode(\"Import Data\"));\r\n\tsci.appendChild(slab);\r\n\tvar datip = document.createElement(\"input\");\r\n\tdatip.setAttribute(\"type\", \"text\");\r\n\tdatip.setAttribute(\"placeholder\", \"Terminus DB URL\");\r\n\tdatip.setAttribute(\"class\", \"terminus-form-value terminus-form-url terminus-input-text\");\r\n\tsci.appendChild(datip);\r\n\t//mfd.appendChild(sci);\r\n\tvar butfield = document.createElement(\"div\");\r\n\tbutfield.setAttribute(\"class\", \"terminus-control-buttons\");\r\n\tvar cancbut = document.createElement(\"button\");\r\n\tcancbut.setAttribute(\"class\", \"terminus-control-button terminus-cancel-db-button terminus-btn\");\r\n\tcancbut.appendChild(document.createTextNode(\"Cancel\"));\r\n\tvar loadbut = document.createElement(\"button\");\r\n\tloadbut.setAttribute(\"class\", \"terminus-control-button terminus-create-db-button terminus-btn\");\r\n\tloadbut.appendChild(document.createTextNode(\"Create\"));\r\n\tvar self = this;\r\n\tvar gatherips = function(){\r\n\t\tvar input = {};\r\n\t\tinput.id = idip.value;\r\n\t\tinput.title = titip.value;\r\n\t\tinput.description = descip.value;\r\n\t\tinput.schema = schem.value;\r\n\t\tinput.key = kip.value;\r\n\t\tinput.data = datip.value;\r\n\t\treturn input;\r\n\t}\r\n\tvar self = this;\r\n\tloadbut.addEventListener(\"click\", function(){\r\n\t\tvar input = gatherips();\r\n\t\tself.ui.createDatabase(input);\r\n\t})\r\n\tcancbut.addEventListener(\"click\", function(){\r\n\t\tself.ui.showServerMainPage();\r\n\t})\r\n\tbutfield.appendChild(cancbut);\r\n\tbutfield.appendChild(loadbut);\r\n\tmfd.appendChild(butfield);\r\n\r\n\treturn scd;\r\n}\r\n\r\nmodule.exports={TerminusDBViewer:TerminusDBViewer,\r\n\t            TerminusDBController:TerminusDBController,\r\n\t            TerminusDBCreator:TerminusDBCreator}\r\n","const TerminusClient = require('@terminusdb/terminus-client');\r\nconst WOQLRule = require(\"./viewer/WOQLRule\");\r\nconst WOQLTable = require(\"./viewer/WOQLTable\");\r\nconst WOQLChooser = require(\"./viewer/WOQLChooser\");\r\n//const WOQLQueryViewer = require(\"./viewer/WOQLQueryView\");\r\nconst WOQLGraph = require(\"./viewer/WOQLGraph\");\r\nconst WOQLStream = require(\"./viewer/WOQLStream\");\r\nconst TerminusFrame = require(\"./viewer/TerminusFrame\");\r\nconst Datatypes = require(\"./html/Datatypes\");\r\nconst QueryPane = require(\"./html/QueryPane\");\r\nconst SimpleTable = require(\"./html/table/SimpleTable\");\r\nconst SimpleGraph = require(\"./html/graph/SimpleGraph\");\r\n//const SimpleStream = require(\"./html/stream/SimpleStream\");\r\n//const SimpleTextbox = require(\"./html/query/SimpleTextbox\");\r\nconst SimpleChooser = require(\"./html/chooser/SimpleChooser\");\r\nconst SimpleDocument = require(\"./html/document/SimpleDocument\");\r\nconst DocumentTable = require(\"./html/document/DocumentTable\");\r\nconst SimpleFrameViewer = require(\"./html/document/SimpleFrameViewer\");\r\nconst HTMLObjectViewer = require(\"./html/document/ObjectViewer\");\r\nconst HTMLPropertyViewer = require(\"./html/document/PropertyViewer\");\r\nconst HTMLDataViewer = require(\"./html/document/DataViewer\");\r\nconst TerminusCodeSnippet = require('./html/query/TerminusCodeSnippet');\r\nconst UTILS = require('./Utils');\r\n\r\n/*\r\n * Simple wrapper functions for initialising\r\n * table, stream, graph, chooser, woql and documents\r\n */\r\n\r\nfunction TerminusHTMLViewer(ui, client, config){\r\n\tthis.ui = ui;\r\n\tthis.client = ui.client;\r\n\tthis.config = config;\r\n}\r\n\r\nTerminusHTMLViewer.prototype.setRenderers = function(config){\r\n}\r\n\r\nTerminusHTMLViewer.prototype.getEditor = function(width, height, placeholder){\r\n    var woql = TerminusClient.WOQL;\r\n\tvar tcs = new TerminusCodeSnippet({}, width, height, placeholder, this.mode);\r\n\tvar snippet = tcs.getAsDOM();\r\n\tvar dimensions = {};\r\n\tdimensions.width = width;\r\n\tdimensions.height = height;\r\n\tUTILS.stylizeEditor(this.ui, snippet.snippetText, dimensions, 'javascript');\r\n\treturn snippet;\r\n}\r\n\r\nTerminusHTMLViewer.prototype.showConfigEditor = function(result, config, span){\r\n    var cSnippet = this.getEditor(300, 250,\r\n                        JSON.stringify(config, undefined, 2));\r\n    var self = this;\r\n    cSnippet.actionButton.addEventListener('click', function(){\r\n        try{\r\n            //self.submitConfigRules(woql, cSnippet, qSnippet, rSnippet);\r\n\t\t\tvar cObj = UTILS.getqObjFromInput(cSnippet.snippetText.value);\r\n\t\t\tTerminusClient.FrameHelper.removeChildren(span);\r\n\t\t\tspan.appendChild(self.showResult(result, cObj));\r\n        }\r\n        catch(e){\r\n            //self.ui.showError('Error in config editor: ' + e);\r\n\t\t\tconsole.log('Error in config editor: ' + e);\r\n        }\r\n    })\r\n    return cSnippet;\r\n}\r\n\r\nTerminusHTMLViewer.prototype.submitConfig = function(result, config, span, cdom){\r\n\tvar cSnippet = this.showConfigEditor(result, config, span);\r\n\tcdom.appendChild(cSnippet.dom);\r\n}\r\n\r\nTerminusHTMLViewer.prototype.showConfig = function(result, config, span, cdom){\r\n\tvar cbtn = document.createElement('button');\r\n    //cbtn.setAttribute('style', 'margin-top: 10px;');\r\n    cbtn.setAttribute('class', 'terminus-btn terminus-query-config-btn');\r\n    cbtn.appendChild(document.createTextNode('Config'));\r\n    //rSnippet.dom.appendChild(cbtn);\r\n    //qSnippet.dom.appendChild(cbtn);\r\n    var self = this;\r\n    cbtn.addEventListener('click', function(){\r\n\t\tTerminusClient.FrameHelper.removeChildren(cdom);\r\n        self.submitConfig(result, config, span, cdom);\r\n    })\r\n    return cbtn;\r\n}\r\n\r\nTerminusHTMLViewer.prototype.showResult = function(result, config){\r\n\tlet span = document.createElement(\"span\");\r\n\tspan.setAttribute(\"class\", \"terminus-query-results\");\r\n\tresult.first();\r\n\tlet renderers = {\r\n\t\ttable: new SimpleTable(),\r\n\t\tgraph: new SimpleGraph(),\r\n\t\t//stream: new SimpleStream(),\r\n\t\tchooser: new SimpleChooser()\r\n\t}\r\n\tlet viewer = config.create(this.client, renderers, Datatypes.initialiseDataRenderers);\r\n\tviewer.setResult(result);\r\n\tspan.appendChild(viewer.render());\r\n\tvar cdom = document.createElement('div');\r\n\tspan.appendChild(cdom);\r\n\tspan.appendChild(this.showConfig(result, config, span, cdom));\r\n\treturn span;\r\n}\r\n\r\nTerminusHTMLViewer.prototype.displayResults = function(query, config){\r\n\tlet span = document.createElement(\"span\");\r\n\tspan.setAttribute(\"class\", \"terminus-results\");\r\n\tlet renderers = {\r\n\t\t\ttable: new SimpleTable(),\r\n\t\t\tgraph: new SimpleGraph(),\r\n\t\t//\tstream: [new SimpleStream()],\r\n\t\t\tchoice: new SimpleChooser()\r\n\t}\r\n\tlet viewer = config.create(this.client, renderers, Datatypes.initialiseDataRenderers);\r\n\tif(query){\r\n\t\tthis.loadResults(query, viewer, function(){ span.appendChild(viewer.render()); })\r\n\t}\r\n\telse {\r\n\t\tif(this.last_result){\r\n\t\t\tviewer.setResult(this.last_result);\r\n\t\t\tspan.appendChild(viewer.render());\r\n\t\t}\r\n\t}\r\n\treturn span;\r\n}\r\n\r\nTerminusHTMLViewer.prototype.loadResults = function(query, viewer, then){\r\n\tvar self = this;\r\n\treturn query.execute(this.client).then((results) => {\r\n\t\tself.last_result = new TerminusClient.WOQLResult(results, query);\r\n\t\tviewer.setResult(self.last_result);\r\n\t\tconsole.log('self.last_result', self.last_result);\r\n\t});\r\n}\r\n\r\nTerminusHTMLViewer.prototype.table = function(query, config){\r\n\tvar span = document.createElement(\"span\");\r\n\tspan.setAttribute(\"class\", \"terminus-table\");\r\n\tvar wqt = new WOQLTable(this.client).options(config);\r\n\twqt.setDatatypes(Datatypes.initialiseDataRenderers);\r\n\twqt.setRenderer(new SimpleTable());\r\n\tquery.execute(this.client).then((results) => {\r\n\t\tvar result = new TerminusClient.WOQLResult(results, query);\r\n\t\twqt.setResult(result);\r\n\t\tspan.appendChild(wqt.render());\r\n\t});\r\n\treturn span;\r\n}\r\n\r\nTerminusHTMLViewer.prototype.stream = function(query, config){\r\n\tvar span = document.createElement(\"span\");\r\n\tspan.setAttribute(\"class\", \"terminus-stream\");\r\n\tvar wqt = new WOQLStream(this.client).options(config);\r\n\twqt.setDatatypes(Datatypes.initialiseDataRenderers);\r\n\treturn query.execute(this.client).then((results) => {\r\n\t\tvar result = new WOQLResult(results, query);\r\n\t\tspan.appendChild(wqt.render());\r\n\t});\r\n\treturn span;\r\n}\r\n\r\nTerminusHTMLViewer.prototype.woql = function(query, config){\r\n\tvar span = document.createElement(\"span\");\r\n\tspan.setAttribute(\"class\", \"terminus-woql\");\r\n\tvar wqt = new WOQLQueryViewer(this.client).options(config);\r\n\tspan.appendChild(wqt.render());\r\n\tif(query){\r\n\t\twqt.setQuery(query, true);\r\n\t}\r\n\treturn span;\r\n}\r\n\r\nTerminusHTMLViewer.prototype.ruleEditor = function(){\r\n\r\n}\r\n\r\nTerminusHTMLViewer.prototype.getAddRuleButton = function(cont){\r\n\tvar rbtn = document.createElement('button');\r\n\trbtn.appendChild(document.createTextNode('Add another rule'));\r\n\tvar self = this;\r\n\trbtn.addEventListener('click', function(){\r\n\t\t//self.QueryPane.addResultViewer(\"Choice\", wqc);\r\n\t\t//qp.addResultViewer(\"Choice\", wqc);\r\n\t\t//addResultViewer = function(label, rule, ruleviewer){\r\n\t})\r\n\tcont.appendChild(rbtn);\r\n}\r\n\r\nTerminusHTMLViewer.prototype.getConfigButton = function(cont){\r\n\tvar cbtn = document.createElement('button');\r\n\tcbtn.appendChild(document.createTextNode('Rule'));\r\n\tvar self = this;\r\n\tcbtn.addEventListener('click', function(){\r\n\t\tcont.appendChild(self.ruleEditor());\r\n\t\tself.getAddRuleButton(cont);\r\n\t})\r\n\tcont.appendChild(cbtn);\r\n}\r\n\r\nTerminusHTMLViewer.prototype.querypane = function(query, config){\r\n\tvar span = document.createElement(\"span\");\r\n\tspan.setAttribute(\"class\", \"terminus-woql-pane\");\r\n\tvar qp = new QueryPane(this.client, query);\r\n\tqp.options(config);\r\n\tthis.queryPane = qp;\r\n\tvar wqv = new WOQLQueryViewer(this.client).options(config);\r\n\tthis.queryViewer = wqv;\r\n\r\n\t// Query Viewer\r\n/*\tvar tcs = new TerminusCodeSnippet({}, 800, 250, 'Enter Query', 'edit');\r\n\tvar snippet = tcs.getAsDOM();\r\n\tspan.appendChild(snippet.dom);\r\n\t//span.appendChild(this.ruleEditor());\r\n\tvar abtn = snippet.actionButton;\r\n\tvar self = this; */\r\n\t// On submit query\r\n\t/*abtn.addEventListener('click', function(){\r\n\t\tvar qObj = wqv.getqObjFromInput(snippet.snippetText.value);\r\n\t\tlet t = TerminusClient.WOQL.table();\r\n\t\tconsole.log('t', t);\r\n\r\n\r\n\t\tspan.appendChild(self.displayResults(qObj, t));\r\n\t\tself.getConfigButton(span);\r\n\r\n\t\t/*qObj.execute(self.client).then(function(response){\r\n\t\t\t// default result in table format\r\n\t\t\tlet t = TerminusClient.WOQL.table();\r\n\t\t\tlet res = TerminusClient.WOQLResult(response, qObj, t);\r\n\t\t\t/*t.column(\"Label\").header(\"Document\");\r\n\t\t\tt.column(\"Range\").header(\"Range\");\r\n\t\t\tt.column(\"Domain\").header(\"Domain\");\r\n\t\t\tt.column(\"Comment\").header(\"Description\");\r\n\t\t\tt.column(\"Comment\").renderer(\"HTMLStringViewer\").args({max_cell_size: 20, max_word_size: 10});\r\n\t\t    t.column_order(\"Label\", \"Type\", \"Comment\");*/\r\n\t\t/*\tspan.appendChild(self.displayResults(res, t));\r\n\t\t\tself.getConfigButton(span);\r\n\t\t}) */\r\n\t\t//wqv.submitQuery(qObj);\r\n\t/*})\r\n\t*/\r\n\r\n\t//console.log('wqv', wqv);\r\n\t//var wqc = new WOQLChoice(this.client).options(config);\r\n\t//var wqs = new WOQLStream(this.client).options(config);\r\n\t//var wqg = new WOQLGraph(this.client).options(config);\r\n\t//var wqt = new WOQLTable(this.client).options(config)\r\n\t//wqv.setRenderer(new SimpleTextbox(wqv, 1000, 600));\r\n\t//wqt.setRenderer(new SimpleTable());\r\n\t//wqg.setRenderer(new SimpleGraph());\r\n\t//wqt.setDatatypes(Datatypes.initialiseDataRenderers);\r\n\t//wqs.setDatatypes(Datatypes.initialiseDataRenderers);\r\n\t//qp.addQueryViewer(wqv);\r\n\t//qp.addResultViewer(\"Choice\", wqc);\r\n\t//qp.addResultViewer(\"Stream\", wqs);\r\n\t//qp.addResultViewer(\"Graph\", wqg);\r\n\t//qp.addResultViewer(\"Table\", wqt);\r\n\r\n\t//qp.addResultViewer(\"ABC\", config, new SimpleTextbox(wqv, 1000, 600));\r\n\t//span.appendChild(qp.render());\r\n\r\n\treturn span;\r\n}\r\n\r\n\r\nTerminusHTMLViewer.prototype.chooser = function(query, config){\r\n\tvar span = document.createElement(\"span\");\r\n\tspan.setAttribute(\"class\", \"terminus-chooser\");\r\n\tvar wqt = new WOQLChoice(this.client).options(config);\r\n\treturn query.execute(this.client).then((results) => {\r\n\t\tvar result = new WOQLResult(results, query);\r\n\t\tspan.appendChild(wqt.render(result));\r\n\t});\r\n\treturn span;\r\n}\r\n\r\nTerminusHTMLViewer.prototype.graph = function(query, config){\r\n\tvar span = document.createElement(\"span\");\r\n\tspan.setAttribute(\"class\", \"terminus-graph terminus-graph-holder\");\r\n\tvar wqt = new WOQLGraph(this.client).options(config);\r\n\treturn query.execute(this.client).then((results) => {\r\n\t\tvar result = new WOQLResult(results, query);\r\n\t\tspan.appendChild(wqt.render(result));\r\n\t});\r\n\treturn span;\r\n}\r\n\r\nTerminusHTMLViewer.prototype.document = function(id, config){\r\n\tvar holder = document.createElement(\"span\");\r\n\tholder.setAttribute(\"class\", \"terminus-document terminus-document-holder\");\r\n\t//config.renderer(new DocumentTable());\r\n\t//config.show_all(\"SimpleFrameViewer\");\r\n\tvar tdv = new TerminusFrame(this.client).options(config);\r\n\ttdv.owner = this;\r\n\ttdv.setDatatypes(Datatypes.initialiseDataRenderers);\r\n\ttdv.loadDocument(id).then(() => {\r\n\t\tlet dom = tdv.render();\r\n\t\tif(dom) holder.appendChild(dom);\r\n\t});\r\n\treturn holder;\r\n}\r\n\r\nTerminusHTMLViewer.prototype.loadRenderer = function(rendname, frame, args, termframe){\r\n\tvar evalstr = \"new \" + rendname + \"(\";\r\n\tif(args) evalstr += JSON.stringify(args);\r\n\tevalstr += \");\";\r\n\ttry {\r\n\t\tvar nr = eval(evalstr);\r\n\t\tnr.terminus = termframe;\r\n\t\treturn nr;\r\n\t}\r\n\tcatch(e){\r\n\t\tconsole.log(\"Failed to load \" + rendname + e.toString());\r\n\t\treturn false;\r\n\t}\r\n}\r\n\r\n\r\nmodule.exports = TerminusHTMLViewer;\r\n","const TerminusClient = require('@terminusdb/terminus-client');\r\nconst WOQLChooser = require(\"./WOQLChooser\");\r\nconst WOQLTable = require(\"./WOQLTable\");\r\nconst WOQLQueryViewer = require(\"./WOQLQueryView\");\r\nconst WOQLGraph = require(\"./WOQLGraph\");\r\nconst WOQLStream = require(\"./WOQLStream\");\r\nconst TerminusFrame = require(\"./TerminusFrame\");\r\n\r\nTerminusClient.WOQL.table = function(){ return new WOQLTableConfig(); }\r\nTerminusClient.WOQL.graph = function(){ return new WOQLGraphConfig(); }\r\nTerminusClient.WOQL.chooser = function(){ return new WOQLChooserConfig(); }\r\nTerminusClient.WOQL.stream = function(){ return new WOQLStreamConfig(); }\r\nTerminusClient.WOQL.document = function(){ return new FrameConfig(); }\r\n//the below are aspirational...\r\n//TerminusClient.WOQL.map = function(){ return new WOQLMapConfig(); }\r\n//TerminusClient.WOQL.chart = function(){ return new WOQLChartConfig(); }\r\n\r\n//Class for expressing and matching rules about WOQL results\r\n//especially for efficiently expressing rules about how they should be rendered\r\n//const TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction FrameConfig(){\r\n\tthis.rules = [];\r\n}\r\n\r\nFrameConfig.prototype.prettyPrint = function(){\r\n\tvar str = \"view = WOQL.graph();\\n\";\r\n\tif(this.renderer()){\r\n\t\tstr += \"view.renderer('\" + this.renderer() + \"')\\n\";\r\n\t}\r\n\tif(typeof this.load_schema() != \"undefined\"){\r\n\t\tstr += \"view.load_schema('\" + this.load_schema() + \"')\\n\";\t\t\r\n\t}\r\n\tfor(var i = 0; i<this.rules.length ; i++){\r\n\t\tstr += \"view.\" + this.rules[i].prettyPrint(\"frame\") + \"\\n\";\r\n\t}\r\n\treturn str;\r\n}\r\n\r\nFrameConfig.prototype.create = function(client, renderers){\r\n\tvar tf = new TerminusFrame(client, this);\r\n\tif(this.trenderer) tf.setRenderer(this.trenderer);\r\n\telse if(renderers && renderers['frame']){\r\n\t\ttf.setRenderer(renderers['frame']);\r\n\t}\r\n\treturn tf;\r\n}\r\n\r\nFrameConfig.prototype.renderer = function(rend){\r\n\tif(typeof rend == \"undefined\") return this.trenderer;\r\n\tthis.trenderer = rend;\r\n\treturn this;\r\n}\r\n\r\nFrameConfig.prototype.json_rules = function(){\r\n\tlet jr = [];\r\n\tfor(var i = 0; i<this.rules.length; i++){\r\n\t\tjr.push(this.rules[i].json());\r\n\t}\r\n\treturn jr;\r\n}\r\n\r\nFrameConfig.prototype.load_schema = function(tf){\r\n\tif(typeof tf == \"undefined\") return this.get_schema;\r\n\tthis.get_schema = tf;\r\n\treturn this;\r\n}\r\n\r\nFrameConfig.prototype.show_all = function(r){\r\n\tthis.all().renderer(r);\r\n\treturn this;\r\n}\r\n\r\nFrameConfig.prototype.show_parts = function(o, p, d){\r\n\tthis.object().renderer(o);\r\n\tthis.property().renderer(p);\r\n\tthis.data().renderer(d);\r\n\treturn this;\r\n}\r\n\r\nFrameConfig.prototype.object = function(){\r\n\tlet fp = TerminusClient.WOQL.rule();\r\n\tfp.scope(\"object\")\r\n\tthis.rules.push(fp);\r\n\treturn fp;\r\n}\r\n\r\nFrameConfig.prototype.property = function(){\r\n\tlet fp = TerminusClient.WOQL.rule();\r\n\tfp.scope(\"property\");\r\n\tthis.rules.push(fp);\r\n\treturn fp;\t\r\n}\r\n\r\nFrameConfig.prototype.data = function(){\r\n\tlet fp = TerminusClient.WOQL.rule();\r\n\tfp.scope(\"data\")\r\n\tthis.rules.push(fp);\r\n\treturn fp;\t\r\n}\r\n\r\nFrameConfig.prototype.all = function(){\r\n\tlet fp = TerminusClient.WOQL.rule();\r\n\tfp.scope(\"*\")\r\n\tthis.rules.push(fp);\r\n\treturn fp;\t\r\n}\r\n\r\n\r\nFrameConfig.prototype.setFrameDisplayOptions = function(frame, rule){\r\n\tif(typeof frame.display_options == \"undefined\") frame.display_options = {};\r\n\tif(typeof rule.mode() != \"undefined\") frame.display_options.mode = rule.mode();\r\n\tif(typeof rule.view() != \"undefined\") frame.display_options.view = rule.view();\r\n\t//if(typeof rule.facets() != \"undefined\") frame.display_options.facets = rule.facets();\r\n\t//if(typeof rule.facet() != \"undefined\") frame.display_options.facet = rule.facet();\r\n\tif(typeof rule.showDisabledButtons() != \"undefined\") frame.display_options.show_disabled_buttons = rule.showDisabledButtons();\r\n\tif(typeof rule.features() != \"undefined\") {\r\n\t\tframe.display_options.features = rule.features();\r\n\t}\r\n\tif(typeof rule.header() != \"undefined\") frame.display_options.header = rule.header();\r\n\tif(typeof rule.hidden() != \"undefined\") frame.display_options.hidden = rule.hidden();\r\n\tif(typeof rule.collapse() != \"undefined\") frame.display_options.collapse = rule.collapse();\r\n\tif(typeof rule.headerFeatures() != \"undefined\") frame.display_options.header_features = rule.headerFeatures();\r\n\tif(typeof rule.showEmpty() != \"undefined\") frame.display_options.show_empty = rule.showEmpty();\r\n\tif(typeof rule.featureRenderers() != \"undefined\") frame.display_options.feature_renderers = rule.featureRenderers();\r\n\tif(typeof rule.dataviewer() != \"undefined\") {\r\n\t\tframe.display_options.dataviewer = rule.dataviewer();\r\n\t\tif(typeof rule.args() != \"undefined\")\r\n\t\t\tframe.display_options.args = rule.args();\r\n\t}\r\n}\t\r\n\r\n\r\n\r\n//WOQL.rule().renderer(\"object\").json(),\r\n//WOQL.rule().renderer(\"property\").json(),\r\n//WOQL.rule().renderer(\"data\").json(),\r\n//WOQL.rule().renderer(\"data\").property(\"rdfs:comment\").render(false).json()\r\n\r\n\r\nfunction WOQLStreamConfig(){\r\n\tthis.rules = [];\r\n}\r\n\r\nWOQLStreamConfig.prototype.prettyPrint = function(){\r\n\tvar str = \"view = WOQL.stream();\\n\";\r\n\tfor(var i = 0; i<this.rules.length ; i++){\r\n\t\tstr += \"view.\" + this.rules[i].prettyPrint(\"stream\") + \"\\n\";\r\n\t}\r\n\treturn str;\r\n}\r\n\r\n\r\nWOQLStreamConfig.prototype.getMatchingRules = function(row, key, context, action){\r\n\treturn getMatchingRules(this.rules, row, key, context, action);\r\n}\r\n\r\nWOQLStreamConfig.prototype.create = function(client, renderers){\r\n\tvar wqt = new WOQLStream(client, this);\r\n\tif(this.trenderer) wqt.setRenderer(this.trenderer);\r\n\telse if(renderers && renderers['stream']){\r\n\t\twqt.setRenderer(renderers['stream']);\r\n\t}\r\n\treturn wqt;\r\n}\r\n\r\n\r\nfunction WOQLChooserConfig(){\r\n\tthis.rules = [];\r\n}\r\n\r\nWOQLChooserConfig.prototype.getMatchingRules = function(row, key, context, action){\r\n\treturn getMatchingRules(this.rules, row, key, context, action);\r\n}\r\n\r\nWOQLChooserConfig.prototype.create = function(client, renderers){\r\n\tvar wqt = new WOQLChooser(client, this);\r\n\tif(this.trenderer) wqt.setRenderer(this.trenderer);\r\n\telse if(renderers && renderers['chooser']){\r\n\t\twqt.setRenderer(renderers['chooser']);\r\n\t}\r\n\treturn wqt;\r\n}\r\n\r\nWOQLChooserConfig.prototype.prettyPrint = function(){\r\n\tvar str = \"view = WOQL.chooser();\\n\";\r\n\tif(typeof this.change() != \"undefined\"){\r\n\t\tstr += \"view.change(\" + this.change() + \")\\n\";\t\t\r\n\t}\r\n\tif(typeof this.show_empty() != \"undefined\"){\r\n\t\tstr += \"view.show_empty('\" + this.show_empty() + \"')\\n\";\t\t\r\n\t}\r\n\tif(typeof this.values() != \"undefined\"){\r\n\t\tstr += \"view.values('\" + removeNamespaceFromVariable(this.values()) + \"')\\n\";\t\t\r\n\t}\r\n\tif(typeof this.labels() != \"undefined\"){\r\n\t\tstr += \"view.labels('\" + removeNamespaceFromVariable(this.labels()) + \"')\\n\";\t\t\r\n\t}\r\n\tif(typeof this.titles() != \"undefined\"){\r\n\t\tstr += \"view.titles('\" + removeNamespaceFromVariable(this.titles()) + \"')\\n\";\t\t\r\n\t}\r\n\tif(typeof this.sort() != \"undefined\"){\r\n\t\tstr += \"view.sort(\" + this.sort() + \")\\n\";\t\t\r\n\t}\r\n\tif(typeof this.direction() != \"undefined\"){\r\n\t\tstr += \"view.direction('\" + this.direction() + \"')\\n\";\t\t\r\n\t}\r\n\tfor(var i = 0; i<this.rules.length ; i++){\r\n\t\tstr += \"view.\" + this.rules[i].prettyPrint(\"chooser\") + \"\\n\";\r\n\t}\r\n\treturn str;\r\n}\r\n\r\n\r\nWOQLChooserConfig.prototype.change = function(v){\r\n\tif(typeof v != \"undefined\"){\r\n\t\tthis.onChange = v;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.onChange;\t\r\n}\r\n\r\nWOQLChooserConfig.prototype.show_empty = function(p){\r\n\tif(typeof p != \"undefined\"){\r\n\t\tthis.placeholder = p;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.placeholder;\t\r\n}\r\n\r\nWOQLChooserConfig.prototype.rule = function(v){\r\n\tlet nr = new WOQLRule(\"row\");\r\n\tthis.rules.push(nr);\r\n\treturn nr.v(v);\t\r\n}\r\n\r\nWOQLChooserConfig.prototype.values = function(v){\r\n\tif(typeof v != \"undefined\"){\r\n\t\tif(v.substring(0, 2) != \"v:\") v = \"v:\" + v;\r\n\t\tthis.value_variable = v;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.value_variable;\r\n}\r\n\r\nWOQLChooserConfig.prototype.labels = function(v){\r\n\tif(v){\r\n\t\tif(v.substring(0, 2) != \"v:\") v = \"v:\" + v;\r\n\t\tthis.label_variable = v;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.label_variable;\r\n}\r\n\r\nWOQLChooserConfig.prototype.titles = function(v){\r\n\tif(v){\r\n\t\tif(v.substring(0, 2) != \"v:\") v = \"v:\" + v;\r\n\t\tthis.title_variable = v;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.title_variable;\r\n}\r\n\r\nWOQLChooserConfig.prototype.sort = function(v){\r\n\tif(v){\r\n\t\tif(v.substring(0, 2) != \"v:\") v = \"v:\" + v;\r\n\t\tthis.sort_variable = v;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.sort_variable;\r\n}\r\n\r\nWOQLChooserConfig.prototype.direction = function(v){\r\n\tif(v){\r\n\t\tthis.sort_direction = v;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.sort_direction;\r\n}\r\n\r\n\r\n//this.choice = (config && config.choice ? config.choice : false);\r\n\r\n\r\nfunction WOQLTableConfig(){\r\n\tthis.rules = [];\r\n\tthis.show_pager = true;\r\n\tthis.show_pagesize = true;\t\r\n\tthis.change_pagesize = true;\r\n\tthis.show_pagenumber = true;\r\n}\r\n\r\nWOQLTableConfig.prototype.getMatchingRules = function(row, key, context, action){\r\n\treturn getMatchingRules(this.rules, row, key, context, action);\r\n}\r\n\r\nWOQLTableConfig.prototype.create = function(client, renderers, dtypes){\r\n\tvar wqt = new WOQLTable(client, this);\r\n\twqt.setDatatypes(dtypes);\r\n\tif(this.trenderer) wqt.setRenderer(this.trenderer);\r\n\telse if(renderers && renderers['table']){\r\n\t\twqt.setRenderer(renderers['table']);\r\n\t}\r\n\treturn wqt;\r\n}\r\n\r\nWOQLTableConfig.prototype.prettyPrint = function(){\r\n\tvar str = \"view = WOQL.table();\\n\";\r\n\tif(typeof this.column_order() != \"undefined\"){\r\n\t\tstr += \"view.column_order('\" + this.column_order() + \"')\\n\";\t\t\r\n\t}\r\n\tif(typeof this.pagesize() != \"undefined\"){\r\n\t\tstr += \"view.pagesize('\" + this.pagesize() + \"')\\n\";\t\t\r\n\t}\r\n\tif(typeof this.renderer() != \"undefined\"){\r\n\t\tstr += \"view.renderer('\" + this.renderer() + \"')\\n\";\t\t\r\n\t}\r\n\tif(typeof this.pager() != \"undefined\"){\r\n\t\tstr += \"view.pager('\" + this.pager() + \"')\\n\";\t\t\r\n\t}\r\n\tif(typeof this.page() != \"undefined\"){\r\n\t\tstr += \"view.page('\" + this.page() + \"')\\n\";\t\t\r\n\t}\r\n\tfor(var i = 0; i<this.rules.length ; i++){\r\n\t\tstr += \"view.\" + this.rules[i].prettyPrint(\"table\") + \"\\n\";\r\n\t}\r\n\treturn str;\r\n}\r\n\r\nWOQLTableConfig.prototype.renderer = function(rend){\r\n\tif(!rend) return this.trenderer;\r\n\tthis.trenderer = rend;\r\n\treturn this;\r\n}\r\n\r\nWOQLTableConfig.prototype.column_order = function(...val){\r\n\tif(typeof val == \"undefined\" || val.length == 0){\r\n\t\treturn this.order;\r\n\t}\r\n\tthis.order = addNamespacesToVariables(val);\r\n\treturn this;\t\t\r\n}\r\n\r\nWOQLTableConfig.prototype.pager = function(val){\r\n\tif(typeof val == \"undefined\"){\r\n\t\treturn this.show_pager;\r\n\t}\r\n\tthis.show_pager = val;\r\n\treturn this;\t\r\n}\r\n\r\nWOQLTableConfig.prototype.pagesize = function(val, editable){\r\n\tif(typeof val == \"undefined\"){\r\n\t\treturn this.show_pagesize;\r\n\t}\r\n\tthis.show_pagesize = val;\t\r\n\tthis.change_pagesize = editable;\r\n\treturn this;\r\n}\r\n\r\nWOQLTableConfig.prototype.page = function(val){\r\n\tif(typeof val == \"undefined\"){\r\n\t\treturn this.show_pagenumber;\r\n\t}\r\n\tthis.show_pagenumber = val;\r\n\treturn this;\r\n}\r\n\r\nWOQLTableConfig.prototype.column = function(...cols){\r\n\tlet nr = new WOQLRule(\"column\");\r\n\tnr.setVariables(cols);\r\n\tthis.rules.push(nr);\r\n\treturn nr;\r\n}\r\n\r\nWOQLTableConfig.prototype.row = function(){\r\n\tlet nr = new WOQLRule(\"row\");\r\n\tthis.rules.push(nr);\r\n\treturn nr;\r\n}\r\n\r\nWOQLGraphConfig = function(){\r\n\tthis.rules = [];\t\r\n}\r\n\r\nWOQLGraphConfig.prototype.create = function(client, renderers){\r\n\tvar wqt = new WOQLGraph(client, this);\r\n\tif(this.trenderer) wqt.setRenderer(this.trenderer);\r\n\telse if(renderers && renderers['graph']){\r\n\t\twqt.setRenderer(renderers['graph']);\r\n\t}\r\n\treturn wqt;\r\n}\r\n\r\nWOQLGraphConfig.prototype.getMatchingRules = function(row, key, context, action){\r\n\treturn getMatchingRules(this.rules, row, key, context, action);\r\n}\r\n\r\nWOQLGraphConfig.prototype.prettyPrint = function(){\r\n\tvar str = \"view = WOQL.graph();\\n\";\r\n\tif(typeof this.literals() != \"undefined\"){\r\n\t\tstr += \"view.literals('\" + this.literals() + \"')\\n\";\t\t\r\n\t}\r\n\tif(typeof this.source() != \"undefined\"){\r\n\t\tstr += \"view.source('\" + removeNamespaceFromVariable(this.source()) + \"')\\n\";\t\t\r\n\t}\r\n\tif(typeof this.fontfamily() != \"undefined\"){\r\n\t\tstr += \"view.fontfamily('\" + this.fontfamily() + \"')\\n\";\t\t\r\n\t}\r\n\tif(typeof this.show_force() != \"undefined\"){\r\n\t\tstr += \"view.show_force('\" + this.show_force() + \"')\\n\";\t\t\r\n\t}\r\n\tif(typeof this.fix_nodes() != \"undefined\"){\r\n\t\tstr += \"view.fix_nodes('\" + this.fix_nodes() + \"')\\n\";\t\t\r\n\t}\r\n\tif(typeof this.explode_out() != \"undefined\"){\r\n\t\tstr += \"view.explode_out('\" + this.explode_out() + \"')\\n\";\t\t\r\n\t}\r\n\tif(typeof this.selected_grows() != \"undefined\"){\r\n\t\tstr += \"view.selected_grows('\" + this.selected_grows() + \"')\\n\";\t\t\r\n\t}\r\n\tif(typeof this.width() != \"undefined\"){\r\n\t\tstr += \"view.width('\" + this.width() + \"')\\n\";\t\t\r\n\t}\r\n\tif(typeof this.height() != \"undefined\"){\r\n\t\tstr += \"view.height('\" + this.height() + \"')\\n\";\t\t\r\n\t}\r\n\tif(typeof this.edges() != \"undefined\"){\r\n\t\tvar nedges = this.edges();\r\n\t\tvar estrs = [];\r\n\t\tfor(var i = 0; i<nedges.length; i++){\r\n\t\t\testrs.push(\"['\" + nedges[i][0] + \", \" + nedges[i][1] + \"']\");\r\n\t\t}\r\n\t\tstr += \"view.edges('\" + estrs.join(\", \") + \"')\\n\";\t\t\r\n\t}\r\n\tfor(var i = 0; i<this.rules.length ; i++){\r\n\t\tstr += \"view.\" + this.rules[i].prettyPrint(\"graph\") + \"\\n\";\r\n\t}\r\n\treturn str;\r\n}\r\n\r\nWOQLGraphConfig.prototype.literals = function(v){\r\n\tif(typeof v != \"undefined\"){\r\n\t\tthis.show_literals = v;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.show_literals;\r\n}\r\n\r\nWOQLGraphConfig.prototype.source = function(v){\r\n\tif(v){\r\n\t\tif(v.substring(0, 2) != \"v:\") v = \"v:\" + v;\r\n\t\tthis.source_variable = v;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.source_variable;\r\n}\r\n\r\nWOQLGraphConfig.prototype.fontfamily = function(v){\r\n\tif(typeof v != \"undefined\"){\r\n\t\tthis.fontfam = v;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.fontfam;\r\n}\r\n\r\nWOQLGraphConfig.prototype.show_force = function(v){\r\n\tif(typeof v != \"undefined\"){\r\n\t\tthis.force = v;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.force;\r\n}\r\n\r\nWOQLGraphConfig.prototype.fix_nodes = function(v){\r\n\tif(typeof v != \"undefined\"){\r\n\t\tthis.fixed = v;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.fixed;\r\n}\r\n\r\nWOQLGraphConfig.prototype.explode_out = function(v){\r\n\tif(typeof v != \"undefined\"){\r\n\t\tthis.explode = v;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.explode;\r\n}\r\n\r\nWOQLGraphConfig.prototype.selected_grows = function(v){\r\n\tif(typeof v != \"undefined\"){\r\n\t\tthis.bigsel = v;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.bigsel;\r\n}\r\n\r\nWOQLGraphConfig.prototype.width = function(v){\r\n\tif(typeof v != \"undefined\"){\r\n\t\tthis.gwidth = v;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.gwidth;\r\n}\r\n\r\nWOQLGraphConfig.prototype.height = function(v){\r\n\tif(typeof v != \"undefined\"){\r\n\t\tthis.gheight = v;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.gheight;\r\n}\r\n\r\nWOQLGraphConfig.prototype.edges = function(...edges){\r\n\tif(edges && edges.length){\r\n\t\tvar nedges = [];\r\n\t\tfor(var i = 0; i<edges.length; i++){\r\n\t\t\tnedges.push(addNamespacesToVariables(edges[i]));\r\n\t\t}\r\n\t\tthis.show_edges = nedges;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.show_edges;\r\n}\r\n\r\nWOQLGraphConfig.prototype.edge = function(source, target){\r\n\tlet nr = new WOQLRule(\"edge\");\r\n\tif(source && target) nr.setVariables([source, target]);\r\n\telse if(source) nr.setVariables([source]);\r\n\telse if(target) nr.setVariables([target]);\r\n\tif(source) nr.source = source;\r\n\tif(target) nr.target = target;\r\n\tthis.rules.push(nr);\r\n\treturn nr;\r\n}\r\n\r\nWOQLGraphConfig.prototype.node = function(...cols){\r\n\tlet nr = new WOQLRule(\"node\");\r\n\tnr.setVariables(cols);\r\n\tthis.rules.push(nr);\r\n\treturn nr;\r\n}\r\n\r\n\r\nfunction WOQLRule(s){\r\n\tthis.rule = { scope: s };\r\n}\r\n\r\nWOQLRule.prototype.prettyPrint = function(type){\r\n\t//starts with obj. ...\r\n\tvar str = \".\"+ this.rule.scope + \"('\" + this.rule.variables.join(\"', '\") + \"')\";\r\n\tif(typeof this.literal() != \"undefined\"){\r\n\t\tstr += \".literal(\" + this.literal() + \")\";\r\n\t}\r\n\tif(typeof this.type() != \"undefined\"){\r\n\t\tstr += \".type(\" + JSON.stringify(removeNamespacesFromVariables(this.type())) + \")\";\r\n\t}\r\n\tif(typeof this.selected() != \"undefined\"){\r\n\t\tstr += \".selected(\" + this.selected() + \")\";\r\n\t}\r\n\tif(typeof this.label() != \"undefined\"){\r\n\t\tstr += \".label(\" + this.label() + \")\";\r\n\t}\r\n\tif(typeof this.size() != \"undefined\"){\r\n\t\tstr += \".size('\" + this.size() + \"')\";\r\n\t}\r\n\tif(typeof this.color() != \"undefined\"){\r\n\t\tstr += \".color([\" + this.color().join(\",\") + \"])\";\r\n\t}\r\n\tif(typeof this.charge() != \"undefined\"){\r\n\t\tstr += \".charge('\" + this.charge() + \"')\";\r\n\t}\r\n\tif(typeof this.distance() != \"undefined\"){\r\n\t\tstr += \".distance('\" + this.distance() + \"')\";\r\n\t}\r\n\tif(typeof this.weight() != \"undefined\"){\r\n\t\tstr += \".distance('\" + this.weight() + \"')\";\r\n\t}\r\n\tif(typeof this.symmetric() != \"undefined\"){\r\n\t\tstr += \".symmetric(\" + this.symmetric() + \")\";\r\n\t}\r\n\tif(typeof this.collisionRadius() != \"undefined\"){\r\n\t\tstr += \".collisionRadius(\" + this.collisionRadius() + \")\";\r\n\t}\r\n\tif(typeof this.icon() != \"undefined\"){\r\n\t\tstr += \".icon(\" + JSON.stringify(this.icon()) + \")\";\r\n\t}\r\n\tif(typeof this.text() != \"undefined\"){\r\n\t\tstr += \".text(\" + JSON.stringify(this.text()) + \")\";\r\n\t}\r\n\tif(typeof this.arrow() != \"undefined\"){\r\n\t\tstr += \".arrow(\" + JSON.stringify(this.arrow()) + \")\";\r\n\t}\r\n\tif(typeof this.border() != \"undefined\"){\r\n\t\tstr += \".border(\" + JSON.stringify(this.border()) + \")\";\r\n\t}\r\n\tif(typeof this.args() != \"undefined\"){\r\n\t\tstr += \".args(\" + JSON.stringify(this.args()) + \")\";\r\n\t}\r\n\tif(typeof this.renderer() != \"undefined\"){\r\n\t\tstr += \".renderer('\" + this.renderer() + \"')\";\r\n\t}\r\n\tif(typeof this.render() != \"undefined\"){\r\n\t\tstr += \".render(\" + this.render() + \")\";\r\n\t}\r\n\tif(typeof this.header() != \"undefined\"){\r\n\t\tstr += \".header('\" + this.header() + \"')\";\r\n\t}\r\n\tif(typeof this.click() != \"undefined\"){\r\n\t\tstr += \".click(\" + this.click() + \")\";\r\n\t}\r\n\tif(typeof this.hover() != \"undefined\"){\r\n\t\tstr += \".hover(\" + this.hover() + \")\";\r\n\t}\r\n\tfor(var v in this.rule.constraints){\r\n\t\tstr += \".v('\" + v + \"')\";\r\n\t\tfor(var i = 0; i<this.rule.constraints[v].length; i++){\r\n\t\t\tif(typeof(this.rule.constraints[v][i]) == \"function\"){\r\n\t\t\t\tstr += \".filter(\" + this.rule.constraints[v][i] + \")\";\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tstr += \".in(\" + JSON.stringify(this.rule.constraints[v][i]) + \")\";\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn str;\r\n}\r\n\r\n/*\r\n * Graph\r\n */\r\n\r\nWOQLRule.prototype.size = function(size){\r\n\tif(typeof size == \"undefined\"){\r\n\t\treturn this.rule.size;\r\n\t}\r\n\tthis.rule.size = size;\r\n\treturn this;\r\n}\r\n\r\nWOQLRule.prototype.color = function(color){\r\n\tif(typeof color == \"undefined\"){\r\n\t\treturn this.rule.color;\r\n\t}\r\n\tthis.rule.color = color;\r\n\treturn this;\r\n}\r\n\r\nWOQLRule.prototype.charge = function(v){\r\n\tif(typeof v == \"undefined\"){\r\n\t\treturn this.rule.charge;\r\n\t}\r\n\tthis.rule.charge = v;\r\n\treturn this;\r\n}\r\n\r\nWOQLRule.prototype.collisionRadius = function(v){\r\n\tif(typeof v == \"undefined\"){\r\n\t\treturn this.rule.collisionRadius;\r\n\t}\r\n\tthis.rule.collisionRadius = v;\r\n\treturn this;\r\n}\r\n\r\nWOQLRule.prototype.icon = function(json){\r\n\tif(json){\r\n\t\tthis.rule.icon = json;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.rule.icon;\r\n}\r\n\r\nWOQLRule.prototype.text = function(json){\r\n\tif(json){\r\n\t\tthis.rule.text = json;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.rule.text;\r\n}\r\n\r\nWOQLRule.prototype.border = function(json){\r\n\tif(json){\r\n\t\tthis.rule.border = json;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.rule.border;\r\n}\r\n\r\nWOQLRule.prototype.arrow = function(json){\r\n\tif(json){\r\n\t\tthis.rule.arrow = json;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.rule.arrow;\r\n}\r\n\r\nWOQLRule.prototype.distance = function(d){\r\n\tif(typeof d != \"undefined\"){\r\n\t\tthis.rule.distance = d;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.rule.distance;\r\n}\r\n\r\nWOQLRule.prototype.symmetric = function(d){\r\n\tif(typeof d != \"undefined\"){\r\n\t\tthis.rule.symmetric = d;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.rule.symmetric ;\r\n}\r\n\r\n\r\nWOQLRule.prototype.weight = function(w){\r\n\tif(typeof w != \"undefined\"){\r\n\t\tthis.rule.weight = w;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.rule.weight;\r\n}\r\n\r\n/*\r\n * Table \r\n */\r\n\r\nWOQLRule.prototype.renderer = function(rend){\r\n\tif(typeof rend == \"undefined\"){\r\n\t\treturn this.rule.renderer;\r\n\t}\r\n\tthis.rule.renderer = rend;\r\n\treturn this;\r\n}\r\n\r\nWOQLRule.prototype.header = function(hdr){\r\n\tif(typeof hdr == \"undefined\"){\r\n\t\treturn this.rule.header;\r\n\t}\r\n\tthis.rule.header = hdr;\r\n\treturn this;\r\n}\r\n\r\n\r\nWOQLRule.prototype.render = function(func){\r\n\tif(typeof func == \"undefined\"){\r\n\t\treturn this.rule.render;\r\n\t}\r\n\tthis.rule.render = func;\r\n\treturn this;\r\n}\r\n\r\nWOQLRule.prototype.click = function(onClick){\r\n\tif(onClick){\r\n\t\tthis.rule.click = onClick;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.rule.click;\r\n}\r\n\r\nWOQLRule.prototype.hover = function(onHover){\r\n\tif(onHover){\r\n\t\tthis.rule.hover = onHover;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.rule.hover;\r\n}\r\n\r\n/*\r\n * All\r\n */\r\n\r\n\r\nWOQLRule.prototype.hidden = function(hidden){\r\n\tif(typeof hidden == \"undefined\"){\r\n\t\treturn this.rule.hidden;\r\n\t}\r\n\tthis.rule.hidden = hidden;\r\n\treturn this;\r\n}\r\n\r\nWOQLRule.prototype.args = function(args){\r\n\tif(typeof args == \"undefined\"){\r\n\t\treturn this.rule.args;\r\n\t}\r\n\tthis.rule.args = args;\r\n\treturn this;\r\n}\r\n\r\n/*\r\n * The below are conditions\r\n */\r\nWOQLRule.prototype.literal = function(tf){\r\n\tif(typeof tf == \"undefined\"){\r\n\t\treturn this.rule.literal;\r\n\t}\r\n\tthis.rule.literal = tf;\r\n\treturn this;\r\n}\r\n\r\nWOQLRule.prototype.type = function(...list){\r\n\tif(typeof list == \"undefined\"){\r\n\t\treturn this.rule.type;\r\n\t}\r\n\tthis.rule.type = list;\r\n\treturn this;\r\n}\r\n\r\nWOQLRule.prototype.setVariables = function(vars){\r\n\tif(vars && vars.length){\r\n\t\tthis.rule.variables = addNamespacesToVariables(vars);\r\n\t\tthis.current_variable = this.rule.variables[this.rule.variables.length - 1];\r\n\t}\r\n\treturn this;\r\n}\r\n\r\nWOQLRule.prototype.v = function(v){\r\n\tif(v){\r\n\t\tif(v.substring(0, 2) != \"v:\") v = \"v:\" + v;\r\n\t\tthis.current_variable = v;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.current_variable;\r\n}\r\n\r\nWOQLRule.prototype.in = function(...list){\r\n\tif(this.current_variable){\r\n\t\tif(!this.rule.constraints) this.rule.constraints = {};\r\n\t\tif(!this.rule.constraints[this.current_variable]) this.rule.constraints[this.current_variable] = [];\r\n\t\tthis.rule.constraints[this.current_variable].push(list);\r\n\t}\r\n\treturn this;\r\n}\r\n\r\nWOQLRule.prototype.filter = function(tester){\r\n\tif(this.current_variable){\r\n\t\tif(!this.rule.constraints) this.rule.constraints = {};\r\n\t\tif(!this.rule.constraints[this.current_variable]) this.rule.constraints[this.current_variable] = [];\r\n\t\tthis.rule.constraints[this.current_variable].push(tester);\r\n\t}\r\n\treturn this;\r\n}\r\n\r\nWOQLRule.prototype.label = function(l){\r\n\tif(l){\r\n\t\tthis.rule.label = l;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.rule.label;\r\n}\r\n\r\nWOQLRule.prototype.title = function(l){\r\n\tif(l){\r\n\t\tthis.rule.title = l;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.rule.title;\r\n}\r\n\r\n/*\r\n * This is for chooser\r\n */\r\n\r\nWOQLRule.prototype.selected = function(s){\r\n\tif(typeof s != \"undefined\"){\r\n\t\tthis.rule.selected = s;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.rule.selected;\r\n}\r\n\r\n\r\n/*\r\n * Matches on\r\n * 1. scope (row, cell, column)\r\n * 2. variables - only match certain ones\r\n * 3. type - only match datatype\r\n * 4. constraints - on values of variables\r\n */\r\n\r\nWOQLRule.prototype.match = function(data, key, context, action){\r\n\tif(context && this.rule.scope != context) return false;\r\n\tif(key){\r\n\t\tif(this.rule.variables && this.rule.variables.length){\r\n\t\t\tif(typeof key == \"object\"){\r\n\t\t\t\tif(this.rule.variables.indexOf(key[0]) == -1) return false;\r\n\t\t\t\tif(this.rule.variables.indexOf(key[1]) == -1) return false;\r\n\t\t\t}\r\n\t\t\telse if(this.rule.variables.indexOf(key) == -1) return false;\r\n\t\t}\r\n\t\tif(this.rule && this.rule.type){\r\n\t\t\tif(typeof key == \"object\"){\r\n\t\t\t\tif(!(data[key][0][\"@type\"] && this.rule.type.indexOf(data[key][0][\"@type\"]) != -1)){\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse if(!(data[key][\"@type\"] && this.rule.type.indexOf(data[key][\"@type\"]) != -1)){\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(this.rule && typeof this.rule.literal != \"undefined\"){\r\n\t\t\tif(typeof key == \"object\"){\r\n\t\t\t\tif(data[key[0]]['@value']) {\r\n\t\t\t\t\tif(!this.rule.literal) return false; \r\n\t\t\t\t}\r\n\t\t\t\telse if(this.rule.literal) return false;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tif(data[key]['@value']) {\r\n\t\t\t\t\tif(!this.rule.literal) return false; \r\n\t\t\t\t}\r\n\t\t\t\telse if(this.rule.literal) return false;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(typeof key == \"object\"){\r\n\t\t\tif(this.rule.constraints && this.rule.constraints[key[0]]){\r\n\t\t\t\tfor(var i = 0; i<this.rule.constraints[key[0]].length; i++){\r\n\t\t\t\t\tif(!this.test(row[key[0]], this.rule.constraints[key][0])){\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\t\t\t\r\n\t\t\t}\r\n\t\t\tif(this.rule.constraints && this.rule.constraints[key[1]]){\r\n\t\t\t\tfor(var i = 0; i<this.rule.constraints[key[1]].length; i++){\r\n\t\t\t\t\tif(!this.test(row[key[1]], this.rule.constraints[key][1])){\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\t\t\t\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if(this.rule.constraints && this.rule.constraints[key]){\r\n\t\t\tfor(var i = 0; i<this.rule.constraints[key].length; i++){\r\n\t\t\t\tif(!this.test(row[key], this.rule.constraints[key])){\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t}\t\t\t\r\n\t\t}\r\n\t\tif(context == \"edge\"){\r\n\t\t\tif(this.rule.source && this.rule.source != key[0]) return false;\r\n\t\t\tif(this.rule.target && this.rule.target != key[1]) return false;\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tfor(var k in this.rule.constraints){\r\n\t\t\tfor(var i = 0; i<this.rule.constraints[k].length; i++){\r\n\t\t\t\tif(!this.test(data[k], this.rule.constraints[k])){\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t}\t\t\t\t\t\t\r\n\t\t}\r\n\t}\r\n\tif(action && typeof this.rule[action] == \"undefined\") return false;\r\n\treturn true;\r\n}\r\n\r\nWOQLRule.prototype.test = function(value, constraint){\r\n\tif(typeof constraint == \"object\" && constraint.length){\r\n\t\tvar vundertest = (value['@value'] ? value['@value'] : value);\r\n\t\treturn (constraint.indexOf(vundertest) != -1);\r\n\t}\r\n\tif(typeof constraint == \"function\"){\r\n\t\treturn constraint(value);\r\n\t}\t\r\n}\r\n\r\n\r\n/*\r\n * Utility function adds v: to variables...\r\n */\r\nfunction addNamespacesToVariables(vars){\r\n\tvar nvars = [];\r\n\tfor(var i = 0; i<vars.length; i++){\r\n\t\tvar nvar = (vars[i].substring(0, 2) == \"v:\") ? vars[i] : \"v:\" + vars[i];\r\n\t\tnvars.push(nvar);\r\n\t}\t\r\n\treturn nvars;\r\n}\r\n\r\nfunction removeNamespaceFromVariable(mvar){\r\n\tif(mvar.substring(0, 2) == \"v:\") return mvar.substring(2) \r\n\treturn mvar;\r\n}\r\n\r\n\r\nfunction removeNamespacesFromVariables(vars){\r\n\tvar nvars = [];\r\n\tfor(var i = 0; i<vars.length; i++){\r\n\t\tnvars.push(removeNamespaceFromVariable(vars[i]));\r\n\t}\t\r\n\treturn nvars;\r\n}\r\n\r\n\r\nfunction getMatchingRules(rules, row, key, context, action){\r\n\tvar matches = [];\r\n\tfor(var i = 0; i<rules.length; i++){\r\n\t\tif(rules[i].match(row, key, context, action)){\r\n\t\t\tmatches.push(rules[i].rule);\r\n\t\t}\r\n\t}\t\r\n\treturn matches;\r\n}\r\n\r\n\r\n/*\r\n * \r\nvar x = WOQL.schema();\r\nx.addClass(\"my:Class\").label(\"A class\").comment(\"A comment\").abstract().relationship();\r\nx.addProperty(\"my:prop\", \"xsd:string\").domain(\"my:Class\").label(\"x\").comment(\"x\").max(2).min(1);\r\nx.execute(client).then ...\r\n */\r\n\r\n\r\n","const TerminusClient = require('@terminusdb/terminus-client');\r\n\r\n/*\r\n * Very simple implementation of a WOQL backed chooser\r\n * Makes a drop down from a WOQL query - configuration tells it which columns to use...\r\n */\r\n\r\nfunction WOQLChooser(client, options){\r\n\tthis.client = client;\r\n\tthis.selected = false;\r\n\treturn this.options(options);\r\n}\r\n\r\nWOQLChooser.prototype.options = function(config){\r\n\tthis.config = config || TerminusClient.WOQL.chooser();\t\r\n\treturn this;\r\n}\r\n\r\nWOQLChooser.prototype.set = function(id){\r\n\tif(this.selected != id){\r\n\t\tthis.selected = id;\r\n\t\tlet ch = this.config.change();\r\n\t\tif(ch) ch(id);\r\n\t}\r\n}\r\n\r\nWOQLChooser.prototype.render = function(){\r\n\tif(this.renderer) return this.renderer.render(this);\r\n}\r\n\r\nWOQLChooser.prototype.setRenderer = function(rend){\r\n\tthis.renderer = rend;\r\n\treturn this;\r\n}\r\n\r\n/*\r\n * Sets up the required variables from the result / config\r\n */\r\nWOQLChooser.prototype.setResult = function(result){\r\n\tthis.result = result;\r\n\tthis.choices = [];\r\n\tthis.cursor = 0;\r\n\tconst variables = result.getVariableList();\r\n\tif(!this.config.values() && variables.length){\r\n\t\tthis.config.values(variables[0]);\r\n\t}\r\n\t//sort it \r\n\tif(this.config.sort()){\r\n\t\tthis.result.sort(this.config.sort(), this.config.direction());\r\n\t}\r\n\twhile(row = this.result.next()){\r\n\t\tif(row && this.includeRow(row)){\r\n\t\t\tthis.choices.push(this.rowToChoice(row, this.result.cursor));\r\n\t\t}\r\n\t}\r\n\treturn this;\r\n}\r\n\r\nWOQLChooser.prototype.includeRow = function(row){\r\n\tconst matched_rules = this.config.getMatchingRules(row, false, \"row\", \"hidden\");\r\n\tfor(var i = 0; i<matched_rules.length; i++){\r\n\t\tif(matched_rules[i].hidden) return false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nWOQLChooser.prototype.rowToChoice = function(binding, rownum){\r\n\tvar choice = { \r\n\t\tid: this.getRowID(binding) \r\n\t};\r\n\tchoice.label = this.getLabelFromBinding(binding, rownum);\r\n\tchoice.title = this.getTitleFromBinding(binding, rownum);\r\n\tchoice.selected = this.getSelectedFromBinding(binding, rownum);\r\n\treturn choice;\r\n}\r\n\r\nWOQLChooser.prototype.getRowID = function(binding){\r\n\tvar rval = binding[this.config.values()];\r\n\tif(rval['@value']) return rval['@value'];\r\n\treturn rval;\r\n}\r\n\r\nWOQLChooser.prototype.getLabelFromBinding = function(binding, rownum){\r\n\tlet sp = this.getSpecialRenderer(binding, \"label\");\r\n\tif(sp) return this.renderSpecial(sp, binding, rownum);\r\n\tif(this.config.labels()){\r\n\t\tif(binding[this.config.labels()]){\r\n\t\t\tvar lab = binding[this.config.labels()];\r\n\t\t\tif(lab[\"@value\"]) lab = lab[\"@value\"];\r\n\t\t\tif(lab != \"unknown\") return lab;\r\n\t\t}\r\n\t}\r\n\treturn TerminusClient.FrameHelper.labelFromURL(this.getRowID(binding));\r\n}\r\n\r\nWOQLChooser.prototype.getTitleFromBinding = function(binding, rownum){\r\n\tlet sp = this.getSpecialRenderer(binding, \"title\");\r\n\tif(sp) return this.renderSpecial(sp, binding, rownum);\r\n\tif(this.config.titles()){\r\n\t\tif(binding[this.config.titles()]){\r\n\t\t\tvar lab = binding[this.config.titles()];\r\n\t\t\tif(lab[\"@value\"]) lab = lab[\"@value\"];\r\n\t\t\tif(lab != \"unknown\") return lab;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nWOQLChooser.prototype.getSelectedFromBinding = function(binding){\r\n\tconst matched_rules = this.config.getMatchingRules(row, false, \"row\", \"selected\");\r\n\tif(matched_rules && matched_rules.length){\r\n\t\treturn matched_rules[matched_rules.length - 1].selected;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nWOQLChooser.prototype.getSpecialRenderer = function(row, type){\r\n\tconst matched_rules = this.config.getMatchingRules(row, false, \"row\", type);\r\n\tfor(var i = 0; i<matched_rules.length; i++){\r\n\t\tif(matched_rules[i][type]) return matched_rules[i][type];\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nWOQLChooser.prototype.renderSpecial = function(rule, row, rownum){\r\n\tif(rule && typeof rule == \"function\"){\r\n\t\treturn render(row);\r\n\t}\r\n\tif(rule && typeof rule == \"string\"){\r\n\t\treturn rule;\r\n\t}\r\n}\r\n\r\nWOQLChooser.prototype.count = function(){\r\n\treturn this.result.count();\r\n}\r\n\r\nWOQLChooser.prototype.first = function(){\r\n\tthis.cursor = 0;\r\n\treturn this.choices[this.cursor];\r\n}\r\n\r\nWOQLChooser.prototype.prev = function(){\r\n\tif(this.cursor > 0) {\r\n\t\treturn this.choices[--this.cursor];\r\n\t}\r\n}\r\n\r\nWOQLChooser.prototype.next = function(){\r\n\treturn this.choices[this.cursor++];\r\n}\r\n\r\n\r\nmodule.exports = WOQLChooser;","const TerminusClient = require('@terminusdb/terminus-client');\r\nconst DatatypeRenderers = require(\"./DatatypeRenderers\");\r\n\r\nfunction WOQLTable(client, config){\r\n\tthis.client = client;\r\n\tif(config) this.options(config);\r\n\treturn this;\r\n}\r\n\r\nWOQLTable.prototype.setResult = function(res){\r\n\tthis.result = res;\r\n\treturn this;\r\n}\r\n\r\nWOQLTable.prototype.setRenderer = function(rend){\r\n\tthis.renderer = rend;\r\n\treturn this;\r\n}\r\n\r\nWOQLTable.prototype.render = function(){\r\n\tif(this.renderer) return this.renderer.render(this);\r\n}\r\n\r\nWOQLTable.prototype.count = function(){\r\n\treturn this.result.count();\r\n}\r\n\r\nWOQLTable.prototype.first = function(){\r\n\treturn this.result.first();\r\n}\r\n\r\nWOQLTable.prototype.prev = function(){\r\n\treturn this.result.prev();\r\n}\r\n\r\nWOQLTable.prototype.next = function(){\r\n\treturn this.result.next();\r\n}\r\n\r\n\r\nWOQLTable.prototype.options = function(config){\r\n\tthis.config = config || TerminusClient.WOQL.table();\t\r\n\treturn this;\r\n}\r\n\r\nWOQLTable.prototype.setDatatypes = function(func){\r\n\tthis.datatypes = new DatatypeRenderers();\r\n\tif(this.config.datatypes) this.datatypes.options(this.config.datatypes);\r\n\tif(func) func(this.datatypes);\r\n\treturn this;\r\n}\r\n\r\nWOQLTable.prototype.canAdvancePage = function(){\r\n\treturn (this.result.count() == this.result.query.getLimit()); \r\n}\r\n\r\nWOQLTable.prototype.canChangePage = function(){\r\n\treturn this.canAdvancePage() || this.canRetreatPage();\r\n}\r\n\r\nWOQLTable.prototype.canRetreatPage = function(){\r\n\treturn (this.result.query.getPage() > 1);\r\n}\r\n\r\nWOQLTable.prototype.getPageSize = function(){\r\n\treturn this.result.query.getLimit() ;\t\r\n}\r\n\r\nWOQLTable.prototype.setPage = function(l){\r\n\treturn this.result.query.setPage(l);\t\r\n}\r\n\r\n\r\nWOQLTable.prototype.getPage = function(){\r\n\treturn this.result.query.getPage();\t\r\n}\r\n\r\nWOQLTable.prototype.setPageSize = function(l){\r\n\treturn this.update(this.result.query.setPageSize(l));\r\n}\r\n\r\nWOQLTable.prototype.nextPage = function(){\r\n\treturn this.update(this.result.query.nextPage());\r\n}\r\n\r\nWOQLTable.prototype.previousPage = function(){\r\n\treturn this.update(this.result.query.previousPage());\r\n}\r\n\r\nWOQLTable.prototype.getColumnsToRender = function(){\r\n\tif(this.hasColumnOrder()){\r\n\t\tvar cols = this.getColumnOrder();\r\n\t}\r\n\telse if(this.result.query.hasSelect()){\r\n\t\tvar cols = this.result.query.getSelectVariables();\r\n\t}\r\n\telse {\r\n\t\tvar cols = this.result.getVariableList();\r\n\t}\r\n\tvar self = this;\r\n\treturn cols.filter(col => !self.hidden(col));\r\n}\r\n\r\nWOQLTable.prototype.getColumnHeaderContents = function(colid){\r\n\tlet hr = this.config.getMatchingRules(false, colid, \"column\", \"header\");\r\n\tif(hr && hr.length){\r\n\t\tlet h = hr[hr.length-1].header;\r\n\t\tif(typeof h == \"string\"){\r\n\t\t\treturn document.createTextNode(h);\t\t\t\r\n\t\t}\r\n\t\telse if(typeof h == \"function\"){\r\n\t\t\treturn h(colid);\r\n\t\t}\r\n\t\telse return h;\r\n\t}\r\n\tif(colid.indexOf(\"v:\") === 0) colid = colid.substring(2);\r\n\tvar clab = (colid.indexOf(\"http\") != -1) ? TerminusClient.FrameHelper.labelFromURL(colid) : colid;\r\n\tclab = clab.replace(\"_\", \" \");\r\n\treturn document.createTextNode(clab);\r\n}\r\n\r\n\r\nWOQLTable.prototype.hidden = function(col){\r\n\tconst matched_rules = this.config.getMatchingRules(false, col, \"column\", \"hidden\");\r\n\tif(matched_rules.length){\r\n\t\treturn matched_rules[matched_rules.length-1].hidden;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\n/**\r\n * Called when you want to change the query associated with the table. \r\n */\r\nWOQLTable.prototype.update = function(nquery){\r\n\treturn nquery.execute(this.client).then((results) => {\r\n\t\tvar nresult = new TerminusClient.WOQLResult(results, nquery);\r\n\t\tthis.setResult(nresult);\r\n\t\treturn nresult;\r\n\t});\t\r\n}\r\n\r\nWOQLTable.prototype.hasDefinedEvent = function(row, key, context, action){\r\n\tconst matched_rules = this.config.getMatchingRules(row, key, context, action);\r\n\tif(matched_rules && matched_rules.length) return true;\r\n\treturn false;\r\n}\r\n\r\nWOQLTable.prototype.getDefinedEvent = function(row, key, context, action){\r\n\tconst matched_rules = this.config.getMatchingRules(row, key, context, action);\r\n\tif(matched_rules && matched_rules.length) {\r\n\t\tvar l = (matched_rules.length - 1);\r\n\t\treturn matched_rules[l][action];\r\n\t}\r\n}\r\n\r\n\r\nWOQLTable.prototype.getRowClick = function(row){\r\n\tlet re = this.getDefinedEvent(row, false, \"row\", \"click\");\r\n\treturn re;\r\n}\r\n\r\nWOQLTable.prototype.getCellClick = function(row, col){\r\n\tlet cc = this.getDefinedEvent(row, col, \"column\", \"click\");\r\n\treturn cc;\r\n}\r\n\r\nWOQLTable.prototype.getRowHover = function(row){\r\n\treturn this.getDefinedEvent(row, false, \"row\", \"hover\");\r\n}\r\n\r\nWOQLTable.prototype.getCellHover = function(row, key){\r\n\treturn this.getDefinedEvent(row, key, \"column\", \"hover\");\r\n}\r\n\r\nWOQLTable.prototype.getColumnOrder = function(){\r\n\treturn this.config.column_order();\r\n}\r\n\r\nWOQLTable.prototype.hasColumnOrder = WOQLTable.prototype.getColumnOrder;\r\nWOQLTable.prototype.hasCellClick = WOQLTable.prototype.getCellClick;\r\nWOQLTable.prototype.hasRowClick = WOQLTable.prototype.getRowClick;\r\nWOQLTable.prototype.hasCellHover = WOQLTable.prototype.getCellHover;\r\nWOQLTable.prototype.hasRowHover = WOQLTable.prototype.getRowHover;\r\n\r\nWOQLTable.prototype.getRenderer = function(key, row){\r\n\tvar rend = this.getSpecificRender(key, row);\r\n\tif(rend) return rend;\r\n\tlet renderer = this.getDefinedEvent(row, key, \"column\", \"renderer\");\r\n\tlet args =  this.getDefinedEvent(row, key, \"column\", \"args\");\r\n\tif(!renderer){\r\n\t\tlet r = this.getRendererForDatatype(row[key]);\r\n\t\trenderer = r.name;\r\n\t\tif(!args) args = r.args;\r\n\t}\r\n\tif(renderer){\r\n\t\treturn this.datatypes.createRenderer(renderer, args);\t\t\r\n\t}\r\n}\r\n\r\nWOQLTable.prototype.renderValue = function(renderer, val, key, row){\r\n\tif(val && val['@type']){\r\n\t\trenderer.type = val['@type'];\r\n\t\tvar dv = new DataValue(val['@value'], val['@type'], key, row);\r\n\t}\t\r\n\telse if(val && val['@language']){\r\n\t\trenderer.type = \"xsd:string\";\r\n\t\tvar dv = new DataValue(val['@value'], renderer.type, key, row);\r\n\t}\r\n\telse if(val && typeof val == \"string\"){\r\n\t\trenderer.type = \"id\";\r\n\t\tvar dv = new DataValue(val['@value'], \"id\", key, row);\r\n\t}\r\n\tif(dv) return renderer.renderValue(dv);\r\n}\r\n\r\nfunction DataValue(val, type){\r\n\tthis.datavalue = val;\r\n\tthis.datatype = type;\r\n}\r\n\r\nDataValue.prototype.value = function(nvalue){\r\n\tif(nvalue) {\r\n\t\tthis.datavalue = nvalue; \r\n\t\treturn this;\r\n\t}\r\n\treturn this.datavalue;\r\n}\r\n\r\n\r\nWOQLTable.prototype.getRendererForDatatype = function(val){\r\n\tif(val && val['@type']){\r\n\t\treturn this.datatypes.getRenderer(val['@type'], val['@value']);\r\n\t}\r\n\telse if(val && val['@language']){\r\n\t\treturn this.datatypes.getRenderer(\"xsd:string\", val['@value']);\r\n\t}\r\n\telse if(val && typeof val == \"string\"){\r\n\t\treturn this.datatypes.getRenderer(\"id\", val);\t\t\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nWOQLTable.prototype.getSpecificRender = function(key, row){\r\n\tlet rend = this.getDefinedEvent(row, key, \"column\", \"render\");\r\n\treturn rend;\r\n}\r\n\r\nmodule.exports = WOQLTable;","/*\r\n * Maintains a list of renderers that are available for rendering \r\n * datatype values - also covers choice values and id values\r\n */\r\n\r\nfunction DatatypeRenderers(options){\r\n\tthis.registeredDataViewers = {},\r\n\tthis.registeredDataEditors = {},\r\n\tthis.defaultViewers = {};\r\n\tthis.defaultEditors = {};\r\n\tthis.universalViewer = false;\r\n\tthis.universalEditor = false;\r\n\tif(options) this.options(options);\r\n\t//links to other documents, choices, id field, id fields of contained objects, ids of structural elements: properties, etc\r\n\tthis.specials = ['document', 'oneOf', 'id', 'contained', 'structural'];\r\n}\r\n\r\nDatatypeRenderers.prototype.options = function (options){\r\n\tthis.universalViewer = (options && options.universalViewer ? options.universalViewer : false);\r\n\tthis.universalEditor = (options && options.universalEditor ? options.universalEditor : false);\r\n\tthis.editor = (options && options.editor ? options.editor : false);\r\n}\r\n\r\nDatatypeRenderers.prototype.getValidDataViewerList = function(datatype){\r\n\tlet valids = [];\r\n\tif(datatype && typeof this.registeredDataViewers[datatype] != \"undefined\"){\r\n\t\tvalids = valids.concat(this.registeredDataViewers[datatype]);\r\n\t}\r\n\tif(this.universalViewer && valids.indexOf(this.universalViewer) == -1){\r\n\t\tvalids.push(this.universalViewer);\r\n\t}\r\n\treturn valids;\r\n};\r\n\r\nDatatypeRenderers.prototype.getValidDataEditorList = function(datatype){\r\n\tlet valids = [];\r\n\tif(datatype && typeof this.registeredDataEditors[datatype] != \"undefined\"){\r\n\t\tvar nftypes = this.registeredDataEditors[datatype];\r\n\t\tif(nftypes){\r\n\t\t\tfor(var i = 0; i<nftypes.length; i++){\r\n\t\t\t\tif(valids.indexOf(nftypes[i]) == -1) valids.push(nftypes[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tif(typeof this.registeredDataEditors[datatype] != \"undefined\"){\r\n\t\tvalids = valids.concat(this.registeredDataEditors[datatype]);\r\n\t}\r\n\tif(this.universalEditor && valids.indexOf(this.universalEditor) == -1){\r\n\t\tvalids.push(this.universalEditor);\r\n\t}\r\n\treturn valids;\r\n}\r\n\r\nDatatypeRenderers.prototype.getEditorForDataFrame = function(datatype){\r\n\tvar vals = this.getValidDataEditorList(datatype);\r\n\tif(this.defaultEditors[datatype] && vals[this.defaultEditors[datatype]]){\r\n\t\treturn vals[this.defaultEditors[datatype]];\r\n\t}\r\n\t//last added is default if no explicit default is set\r\n\tif(vals){\r\n\t\treturn vals[Object.keys(vals)[vals.length-1]];\r\n\t}\r\n\telse {\r\n\t\tif(this.universalEditor) return this.universalEditor;\r\n\t}\r\n}\r\n\r\nDatatypeRenderers.prototype.getViewerForDataFrame = function(datatype){\r\n\tvar vals = this.getValidDataViewerList(datatype);\r\n\tif(this.defaultViewers[datatype] && vals[this.defaultViewers[datatype]]){\r\n\t\treturn vals[this.defaultViewers[datatype]];\r\n\t}\r\n\tif(vals){\r\n\t\treturn vals[Object.keys(vals)[0]];\r\n\t}\r\n\telse {\r\n\t\tif(this.universalViewer) return this.universalViewer;\r\n\t}\r\n\r\n}\r\n\r\nDatatypeRenderers.prototype.registerViewerForTypes = function(viewer, record, types){\r\n\tfor(var i = 0; i < types.length; i++){\r\n\t\tif(typeof this.registeredDataViewers[types[i]] == \"undefined\"){\r\n\t\t\tthis.registeredDataViewers[types[i]] = {};\r\n\t\t}\r\n\t\tif(!this.registeredDataViewers[types[i]][viewer]){\r\n\t\t\tthis.registeredDataViewers[types[i]][viewer] = record;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nDatatypeRenderers.prototype.registerEditorForTypes = function(viewer, record, types){\r\n\tfor(var i = 0; i < types.length; i++){\r\n\t\tif(typeof this.registeredDataEditors[types[i]] == \"undefined\"){\r\n\t\t\tthis.registeredDataEditors[types[i]] = {};\r\n\t\t}\r\n\t\tif(!this.registeredDataEditors[types[i]][viewer]){\r\n\t\t\tthis.registeredDataEditors[types[i]][viewer] = record;\r\n\t\t}\t\t\t\r\n\t}\r\n}\r\n\r\nDatatypeRenderers.prototype.getRenderer = function(type, value){\r\n\tvar r = {};\r\n\tlet v = this.getViewerForDataFrame(type);\r\n\tif(v){\r\n\t\tr.name = Object.keys(v)[0];\r\n\t\tif(v[r.name].label){\r\n\t\t\tr.label = v[r.name].label;\r\n\t\t}\r\n\t\tif(v[r.name].args){\r\n\t\t\tr.args = v[r.name].args;\r\n\t\t}\r\n\t\treturn r;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nmodule.exports=DatatypeRenderers;\r\n\r\n\r\n","const TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction WOQLGraph(client, options){\r\n\tthis.client = client;\r\n\tthis.options(options);\r\n\tthis.nodes = [];\r\n\tthis.node_ids = [];\r\n\tthis.edges = [];\r\n\treturn this;\r\n}\r\n\r\nWOQLGraph.prototype.setResult = function(result){\r\n\tthis.result = result;\r\n\tthis.calculateVariableTypes(result);\r\n}\r\n\r\nWOQLGraph.prototype.setRenderer = function(rend){\r\n\tthis.renderer = rend;\r\n\treturn this;\r\n}\r\n\r\nWOQLGraph.prototype.render = function(){\r\n\tif(this.renderer) return this.renderer.render(this);\r\n}\r\n\r\nWOQLGraph.prototype.options = function(config){\r\n\tthis.config = config || TerminusClient.WOQL.graph();\t\r\n\treturn this;\r\n}\r\n\r\nWOQLGraph.prototype.getEdges = function(){\r\n\tif(this.edges) return this.edges;\r\n\tthis.edges = [];\r\n\tvar bindings = this.result.getBindings();\r\n\tfor(var i = 0; i<bindings.length; i++){\r\n\t\tif(this.rowIncludesEdge(bindings[i])){\r\n\t\t\tthis.edges = this.edges.concat(this.makeEdgesFromRow(bindings[i]))\r\n\t\t}\r\n\t}\r\n\treturn this.edges;\r\n}\r\n\r\nWOQLGraph.prototype.getNodes = function(){\r\n\tif(this.nodes) return this.nodes;\r\n\tthis.nodes = [];\r\n\t//get column names first...\r\n\tvar bindings = this.result.getBindings();\r\n\tvar nodes = [];\r\n\tfor(var i = 0; i<bindings.length; i++){\r\n\t\tfor(var k in bindings[i]){\r\n\t\t\tif(this.source_variables.indexOf(k) != -1 && nodes.indexOf(bindings[i][k]) == -1){\r\n\t\t\t\tnodes.push(bindings[i][k]);\r\n\t\t\t\tthis.nodes.push(this.makeNodeFromSource(bindings[i][k], k, bindings[i]));\r\n\t\t\t}\r\n\t\t\tif(this.target_variables.indexOf(k) != -1 && nodes.indexOf(bindings[i][k]) == -1){\r\n\t\t\t\tnodes.push(bindings[i][k]);\r\n\t\t\t\tthis.nodes.push(this.makeNodeFromTarget(bindings[i][k], k, bindings[i]));\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn this.nodes;\r\n}\r\n\r\nWOQLGraph.prototype.makeNodeFromSource = function(sid, k, row) {\r\n\tvar node = {type: \"node\", id: sid};\r\n\treturn this.adornNode(node, row);\r\n}\r\n\r\nWOQLGraph.prototype.makeNodeFromTarget = WOQLGraph.prototype.makeNodeFromSource ;\r\n\r\nWOQLGraph.prototype.adornNode = function(node){\r\n\treturn node;\r\n}\r\n\r\nWOQLGraph.prototype.adornEdge = function(edge){\r\n\treturn edge;\r\n}\r\n\r\nWOQLGraph.prototype.makeEdgeFromRow = function(eid, k, row){\r\n\tvar target = false;\r\n\tvar source = false;\r\n\tfor(var i = 0; i<this.target_variables.length; i++){\r\n\t\tif(row[this.target_variables[i]]){\r\n\t\t\ttarget = row[this.target_variables[i]];\r\n\t\t\tcontinue;\r\n\t\t}\r\n\t}\r\n\tif(target){\r\n\t\tfor(var i = 0; i<this.source_variables.length; i++){\r\n\t\t\tif(row[this.source_variables[i]]){\r\n\t\t\t\tsource = row[this.source_variables[i]];\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t}\t\t\r\n\t}\r\n\tif(source && target){\r\n\t\tvar edge = { type: \"link\", id: eid, target: target, source: source };\r\n\t\treturn this.adornEdge(edge, row);\r\n\t}\r\n}\r\n\r\nWOQLGraph.prototype.calculateVariableTypes = function(){\r\n\tvar bindings = this.result.getBindings();\r\n\tif(bindings && bindings.length){\r\n\t\tfor(var i = 0; i<bindings.length; i++){\r\n\t\t\tthis.extractFromBinding(bindings[i]);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nWOQLGraph.prototype.extractFromBinding = function(row){\r\n\t//\r\n\tif(this.includeRow(row)){\r\n\t\t//get all the nodes (ids - non literals) //\r\n\t\t//see which nodes are excluded ...\r\n\t\tvar nodes = [];\r\n\t\tvar lits = [];\r\n\t\tfor(var k in row){\r\n\t\t\tif(typeof row[k] == \"string\"){\r\n\t\t\t\tif(row[k] && row[k] != \"unknown\" && this.includeNode(k, row)) nodes.push(k);\r\n\t\t\t}\r\n\t\t\telse if(typeof row[k][\"@value\"] == \"string\" && this.includeLiteralNode(k, row)){\r\n\t\t\t\tlits.push(k);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(nodes.length == 0) return;\r\n\t\t//first of all we need to make the literal nodes targets of \r\n\t\tfor(var i = 0; i<lits.length; i++){\r\n\t\t\t//make an edge and put the lit in as a node...\r\n\t\t\tvar nid = TerminusClient.FrameHelper.genBNID().substring(2);\r\n\t\t\tlet source = this.getLiteralOwner(nodes, lits[i], row);\r\n\t\t\tif(source) {\r\n\t\t\t\tthis.addAdornedNode(nid, lits[i], row);\r\n\t\t\t\tthis.addAdornedEdge(row[source], nid, source, lits[i], row);\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.createEdgesFromIDs(nodes, row);\r\n\t\tfor(var i = 0; i<nodes.length; i++){\r\n\t\t\tvar ndid = row[nodes[i]];\r\n\t\t\tvar node = { type: \"node\", id: ndid, nodetype: nodes[i], text: row[nodes[i]] };\r\n\t\t\tthis.addAdornedNode(ndid, nodes[i], row);\r\n\t\t}\t\r\n\t}\r\n}\r\n\r\nWOQLGraph.prototype.addAdornedEdge = function(source, target, ks, kt, row){\r\n\tvar edge = { type: \"link\", target: target, source: source, text: kt};\r\n\tconst matched_rules = this.config.getMatchingRules(row, [ks, kt], \"edge\");\r\n\tfor(var i = 0; i<matched_rules.length; i++){\r\n\t\tif(matched_rules[i].size){\r\n\t\t\tif(typeof matched_rules[i].size == \"string\" && matched_rules[i].size.substring(0, 2) == \"v:\"){\r\n\t\t\t\tvar w = row[matched_rules[i].size];\r\n\t\t\t\tif(w && w['@value']) edge.size = w['@value'];\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tedge.size = matched_rules[i].size;\r\n\t\t\t}\t\t\t\r\n\t\t}\r\n\t\tif(matched_rules[i].color){\r\n\t\t\tedge.color = matched_rules[i].color;\t\t\t\r\n\t\t}\r\n\t\tif(matched_rules[i].distance){\r\n\t\t\tif(typeof matched_rules[i].distance == \"string\" && matched_rules[i].distance.substring(0, 2) == \"v:\"){\r\n\t\t\t\tvar w = row[matched_rules[i].distance];\r\n\t\t\t\tif(w && w['@value']) edge.distance = w['@value'];\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tedge.distance = matched_rules[i].distance;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(matched_rules[i].arrow){\r\n\t\t\tedge.arrow = matched_rules[i].arrow;\r\n\t\t}\r\n\t\tif(typeof matched_rules[i].symmetric != \"undefined\"){\r\n\t\t\tedge.symmetric = matched_rules[i].symmetric;\r\n\t\t}\r\n\t\tif(matched_rules[i].weight){\r\n\t\t\tif(typeof matched_rules[i].weight == \"string\" && matched_rules[i].weight.substring(0, 2) == \"v:\"){\r\n\t\t\t\tvar w = row[matched_rules[i].weight];\r\n\t\t\t\tif(w && w['@value']) edge.weight = w['@value'];\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tedge.weight = matched_rules[i].weight;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tthis.edges.push(edge);\t\r\n}\r\n\r\nWOQLGraph.prototype.addAdornedNode = function(nid, k, row){\r\n\tvar node = { type: \"node\", id: nid, nodetype: k };\r\n\tconst matched_rules = this.config.getMatchingRules(row, k, \"node\");\r\n\tfor(var i = 0; i<matched_rules.length; i++){\r\n\t\tif(matched_rules[i].size){\r\n\t\t\tif(typeof matched_rules[i].size == \"string\" && matched_rules[i].size.substring(0, 2) == \"v:\"){\r\n\t\t\t\tvar rad = row[matched_rules[i].size];\r\n\t\t\t\tif(rad && rad['@value']) node.radius = rad['@value'];\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tnode.radius = matched_rules[i].size;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(matched_rules[i].color){\r\n\t\t\tnode.color = matched_rules[i].color;\r\n\t\t}\r\n\t\tif(matched_rules[i].charge){\r\n\t\t\tif(typeof matched_rules[i].charge == \"string\" && matched_rules[i].charge.substring(0, 2) == \"v:\"){\r\n\t\t\t\tvar rad = row[matched_rules[i].charge];\r\n\t\t\t\tif(rad && rad['@value']) node.charge = rad['@value'];\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tnode.charge = matched_rules[i].charge;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(matched_rules[i].collisionRadius ){\r\n\t\t\tif(typeof matched_rules[i].collisionRadius == \"string\" && matched_rules[i].collisionRadius.substring(0, 2) == \"v:\"){\r\n\t\t\t\tvar rad = row[matched_rules[i].collisionRadius];\r\n\t\t\t\tif(rad && rad['@value']) node.collisionRadius = rad['@value'];\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tnode.collisionRadius= matched_rules[i].collisionRadius;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(matched_rules[i].icon ){\r\n\t\t\tnode.icon = matched_rules[i].icon;\r\n\t\t}\r\n\t\tif(matched_rules[i].text){\r\n\t\t\tnode.text = matched_rules[i].text;\r\n\t\t}\r\n\t\tif(matched_rules[i].border){\r\n\t\t\tnode.border = matched_rules[i].border;\r\n\t\t}\r\n\t}\r\n\tif(!node.text){\r\n\t\tif(typeof row[k] == \"string\") node.text = row[k];\r\n\t\telse if(row[k]['@value']) node.text = row[k]['@value'];\r\n\t}\r\n\tthis.nodes.push(node);\r\n}\r\n\r\nWOQLGraph.prototype.getLiteralOwner = function(nodes, v, row){\r\n\tvar cs = this.config.source();\r\n\tif(cs && row[cs]){\r\n\t\treturn cs;\r\n\t}\r\n\tvar edges = this.config.edges();\r\n\tif(edges){\r\n\t\tfor(var i = 0; i < edges.length; i++){\r\n\t\t\tif(edges[i][1] == v){\r\n\t\t\t\treturn edges[i][0];\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\treturn nodes[0];\r\n}\r\n\r\nWOQLGraph.prototype.createEdgesFromIDs = function(nodes, row){\r\n\tif(nodes.length < 2) return;\r\n\tvar cs = this.config.source();\r\n\tlet es = this.config.edges();\r\n\tif(!cs && es && es.length){\r\n\t\tfor(var i = 0; i< es.length; i++){\r\n\t\t\tif(nodes.indexOf(es[i][0]) != -1 && nodes.indexOf(es[i][1]) != -1 ){\r\n\t\t\t\tthis.addAdornedEdge(row[es[i][0]], row[es[i][1]], es[i][0], es[i][1], row);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn;\r\n\t}\r\n\tvar s = (cs && nodes.indexOf(cs) != -1) ? cs : nodes[0];\r\n\tfor(var i = 0; i<nodes.length; i++){\r\n\t\tif(nodes[i] == s) continue;\r\n\t\tthis.addAdornedEdge(row[s], row[nodes[i]], s, nodes[i], row);\r\n\t}\r\n}\r\n\r\nWOQLGraph.prototype.includeNode = function(v, row){\r\n\tconst matched_rules = this.config.getMatchingRules(row, v, \"node\", \"hidden\");\r\n\tfor(var i = 0; i<matched_rules.length; i++){\r\n\t\tif(matched_rules[i].hidden) return false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nWOQLGraph.prototype.includeLiteralNode = function(v, row){\r\n\tlet l = this.config.literals();\r\n\tif(typeof l != \"undefined\" && !l) return false;\r\n\tconst matched_rules = this.config.getMatchingRules(row, v, \"node\", \"hidden\");\r\n\tfor(var i = 0; i<matched_rules.length; i++){\r\n\t\tif(matched_rules[i].hidden) return false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\n\r\nWOQLGraph.prototype.includeRow = function(row){\r\n\tconst matched_rules = this.config.getMatchingRules(row, false, \"row\", \"hidden\");\r\n\tfor(var i = 0; i<matched_rules.length; i++){\r\n\t\tif(matched_rules[i].hidden) return false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\n\r\n\r\nmodule.exports = WOQLGraph;","/*\r\n * Maps a woql query to a stream of results...\r\n */\r\n\r\nfunction WOQLStream(client){\r\n\tthis.client = client;\r\n}\r\n\r\nWOQLStream.prototype.options = function(opts){\r\n\tthis.page_size = 10;\r\n\treturn this;\r\n}\r\n\r\nWOQLStream.prototype.setResult = function(wqrs){\r\n\tthis.result = wqrs;\r\n}\r\n\r\nWOQLStream.prototype.setRenderer = function(rend){\r\n\tthis.renderer = rend;\r\n\treturn this;\r\n}\r\n\r\nWOQLStream.prototype.render = function(){\r\n\tif(this.renderer) return this.renderer.render(this);\r\n}\r\n\r\nmodule.exports = WOQLStream;","const DatatypeRenderers = require(\"./DatatypeRenderers\");\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction TerminusFrame(client){\r\n\tthis.client = client;\r\n\tthis.load_schema = false;\r\n}\r\n\r\nTerminusFrame.prototype.options = function(opts){\r\n\tthis.config = opts || TerminusClient.WOQL.document();\r\n\treturn this;\r\n}\r\n\r\nTerminusFrame.prototype.setDatatypes = function(func){\r\n\tthis.datatypes = new DatatypeRenderers();\r\n\tif(this.config.datatypes) this.datatypes.options(this.config.datatypes);\r\n\tif(func) func(this.datatypes);\r\n\treturn this;\r\n}\r\n\r\nTerminusFrame.prototype.loadDocument = function(url, cls){\r\n\tif(!url) return false;\r\n\tvar self = this;\r\n\tif(url.substring(0,4) == \"doc:\"){\r\n\t\turl = url.substring(4);\r\n\t}\r\n\treturn this.client.getDocument(url, {\"terminus:encoding\": \"terminus:frame\"})\r\n\t.then(function(response){\r\n\t\tself.loadDataFrames(response);\r\n\t\tif(self.config.load_schema()){\r\n\t\t\tself.loadDocumentSchema(self.document.cls);\r\n\t\t}\r\n\t\treturn response;\r\n\t});\r\n}\r\n\r\nTerminusFrame.prototype.loadDocumentSchema = function(cls){\r\n\tvar self = this;\r\n\tvar ncls = TerminusClient.FrameHelper.unshorten(cls);\r\n\treturn this.client.getClassFrame(false, ncls)\r\n\t.then(function(response){\r\n\t\treturn self.loadSchemaFrames(response, cls);\r\n\t});\r\n}\r\n\r\nTerminusFrame.prototype.loadDataFrames = function(dataframes, cls){\r\n\tif(!cls){\r\n\t\tif(this.document) cls = this.document.cls;\r\n\t\telse {\r\n\t\t\tif(dataframes && dataframes.length && dataframes[0] && dataframes[0].domain){\r\n\t\t\t\tcls = dataframes[0].domain;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tif(cls){\r\n\t\tif(!this.document){\r\n\t\t\tthis.document = new TerminusClient.ObjectFrame(cls, dataframes);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.document.loadDataFrames(dataframes);\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tconsole.log(\"Missing Class\" + \" \" + \"Failed to add dataframes due to missing class\");\r\n\t}\r\n}\r\n\r\nTerminusFrame.prototype.loadSchemaFrames = function(classframes, cls){\r\n\tif(!cls){\r\n\t\tif(classframes && classframes.length && classframes[0] && classframes[0].domain){\r\n\t\t\tcls = classframes[0].domain;\r\n\t\t}\r\n\t}\r\n\tif(cls){\r\n\t\tif(!this.document){\r\n\t\t\tthis.document = new TerminusClient.ObjectFrame(cls);\r\n\t\t}\r\n\t\tif(classframes){\r\n\t\t\tthis.document.loadClassFrames(classframes);\r\n\t\t\tif(!this.document.subjid){\r\n\t\t\t\tthis.document.newDoc = true;\r\n\t\t\t\tthis.document.fillFromSchema(\"_:\");\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tconsole.log(\"Missing Class\", \"Failed to add class frames due to missing class\");\r\n\t}\r\n}\r\n\r\nTerminusFrame.prototype.render = function(){\r\n\tif(!this.renderer && this.document){\r\n\t\tif(this.config.renderer()){\r\n\t\t\tthis.renderer = this.config.renderer();\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.applyRulesToDocument(this.document, this.config);\r\n\t\t\tthis.renderer = this.document;\r\n\t\t}\r\n\t}\r\n\tif(this.renderer && this.renderer.render){\r\n\t\t//this.renderer.world();\r\n\t\treturn this.renderer.render(this.document);\r\n\t}\r\n\telse if(typeof this.renderer == \"function\"){\r\n\t\tvar x = this.renderer(this.document);\r\n\t\treturn x;\r\n\t}\r\n\telse {\r\n\t\tconsole.log(\"didna make it \");\r\n\t}\r\n}\r\n\r\n/*\r\n * adds render and compare functions to object frames\r\n */\r\nTerminusFrame.prototype.applyRulesToDocument = function(doc, config){\r\n\tvar self = this;\r\n\tfunction onmatch(frame, rule){\r\n\t\tif(typeof rule.render() != \"undefined\"){\r\n\t\t\tframe.render = rule.render();\r\n\t\t}\r\n\t\telse {\r\n\t\t\tif(rule.renderer()){\r\n\t\t\t\tvar renderer = self.loadRenderer(rule.renderer(), frame, rule.args);\t\t\r\n\t\t\t}\r\n\t\t\tif(renderer && renderer.render){\r\n\t\t\t\tframe.render = function(frame){\r\n\t\t\t\t\treturn renderer.render(frame);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(rule.compare()){\r\n\t\t\tframe.compare = rule.compare();\r\n\t\t}\r\n\t\tconfig.setFrameDisplayOptions(frame, rule);\r\n\t}\r\n\tthis.document.filter(config.rules, onmatch);\r\n}\r\n\r\nTerminusFrame.prototype.loadRenderer = function(rendname, frame, args){\r\n\tif(this.owner){\r\n\t\treturn this.owner.loadRenderer(rendname, frame, args, this);\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nmodule.exports = TerminusFrame ;\r\n","const TerminusClient = require('@terminusdb/terminus-client');\r\nconst TerminusCodeSnippet = require('./query/TerminusCodeSnippet');\r\nconst WOQLRule = require(\"../viewer/WOQLRule\");\r\nconst UTILS = require('../Utils');\r\n\r\nfunction QueryPane(client, query, result){\r\n\tthis.client = client;\r\n\tthis.query = query;\r\n\tthis.result = result;\t\r\n    this.input = new TerminusCodeSnippet(\"woql\", \"edit\");\r\n    this.views = [];\r\n    if(this.query){\r\n    \tthis.input.setQuery(this.query);\r\n    }\r\n    this.container = document.createElement('div');\r\n    this.container.setAttribute('class', 'terminus-query-pane-cont');\r\n}\r\n\r\nQueryPane.prototype.addView = function(config){\r\n\tthis.views.push(config);\r\n}\r\n\r\nQueryPane.prototype.getAsDOM = function(ui){\r\n\tthis.container.appendChild(UTILS.getHeaderDom('Enter New Query'));\r\n\tthis.container.appendChild(this.input.getAsDOM()); \r\n\tvar form = (this.input.format == \"js\" ? \"javascript\" : \"json\");\r\n\tUTILS.stylizeEditor(ui, this.input.snippet, {width: this.input.width, height: this.input.height}, form);\r\n\tif(this.views.length){\r\n\t\tfor(var i = 0; i<this.views.length; i++){\r\n\t\t\tvar vdom = this.getViewDOM(this.views[i], ui);\r\n\t\t\tif(vdom){\r\n\t\t\t\tthis.container.appendChild(vdom); \r\n\t\t\t}\t\t\t\t\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tvar nview = TerminusClient.WOQL.table();\r\n\t\tvar vdom = this.getViewDOM(nview, ui);\r\n\t\tif(vdom){\r\n\t\t\tthis.container.appendChild(vdom); \r\n\t\t}\r\n\t\tthis.views.push(nview);\r\n\t}\r\n\treturn this.container;\r\n}\r\n\r\nQueryPane.prototype.options = function(options){\r\n\tthis.options = options;\r\n\treturn this;\r\n}\r\n\r\n/*\r\ndescr: Returns Add View button\r\nparams: query object, query snippet\r\n*/\r\nQueryPane.prototype.getViewDOM = function(config, ui){\r\n\tlet editor = new TerminusCodeSnippet(\"rule\", \"edit\");\r\n\tvar self = this;\r\n\teditor.submit = function(qObj){\r\n\t\tself.submitQuery(qObj, ui);\r\n\t}\r\n\tif(editor.setQuery(config)){\r\n\t\tconfig.editor = editor;\r\n\t}\r\n\telse {\r\n\t\t//if(config.)\r\n\t}\r\n\tif(this.result){\r\n\t\t\r\n\t}\r\n\treturn editor.getAsDOM();\r\n}\r\n\r\nQueryPane.prototype.submitQuery = function(qObj, ui){\r\n    if(ui) ui.clearMessages();\r\n    this.query = qObj;\r\n    qObj.execute(self.client).then((results) => {\r\n        self.processResults(qObj, WOQL, self.thv, results, qSnippet);\r\n        self.addView(WOQL, qSnippet);\r\n        self.generateResultsFromRules(WOQL, qSnippet);\r\n    })\r\n}\r\n\r\n\r\n/*\r\ndescr: Show results editor on click of Add View\r\nparams: query object, query snippet\r\nQueryPane.prototype.showRuleEditor = function(woql, vd, qSnippet){\r\nvar cancel = document.createElement('icon');\r\n//cancel.appendChild(document.createTextNode('cancel'));\r\ncancel.setAttribute('class', 'fa fa-times terminus-pointer terminus-cancel-rule-editor');\r\nvd.appendChild(cancel);\r\nvar rSnippet = this.thv.getEditor(1350, 250, 'Enter Rules ...');\r\n//var rEditor = document.createElement('div');\r\nvd.setAttribute('class', 'terminus-rule-editor');\r\n//vd.setAttribute('style', 'border: 1px solid orange');\r\nthis.qpane.addRuleDom = rSnippet.actionButton;\r\nvd.appendChild(UTILS.getHeaderDom('Rule Editor:'));\r\nvd.appendChild(rSnippet.dom);\r\nqSnippet.dom.appendChild(vd);\r\nvar self = this;\r\ncancel.addEventListener('click', function(){\r\n    TerminusClient.FrameHelper.removeChildren(vd);\r\n    self.addView(woql, qSnippet);\r\n})\r\nthis.qpane.addRuleDom.addEventListener('click', function(){\r\n    try{\r\n        self.submitView(woql, qSnippet, rSnippet);\r\n        self.hideAddViewEditor(vd);\r\n    }\r\n    catch(e){\r\n        self.ui.showError('Error in rule editor: ' + e);\r\n    }\r\n})\r\nreturn rSnippet;\r\n}\r\n*/\r\n\r\n\r\nQueryPane.prototype.getAddViewControl = function(){ \r\n\tvar vd = document.createElement('div');\r\n\tvd.setAttribute('class', 'terminus-add-view-editor');\r\n\tvar cbtn = document.createElement('button');\r\n\tvd.appendChild(cbtn);\r\n\tcbtn.setAttribute('style', 'margin-top: 10px;');\r\n\tcbtn.setAttribute('class', 'terminus-btn');\r\n\tcbtn.appendChild(document.createTextNode('Add View'));\r\n\tqSnippet.result.appendChild(vd);\r\n\tvar self = this;\r\n\tcbtn.addEventListener('click', function(){\r\n\t    let editor = self.showRuleEditor(woql, vd, qSnippet);\r\n\t})\r\n\treturn vd;\r\n}\r\n\r\n\r\nQueryPane.prototype.getWOQLEditor = function(){\r\n    var tcs = new TerminusCodeSnippet(\"woql\", \"edit\");\r\n\tvar snippet = tcs.getAsDOM();\r\n\tvar dimensions = {};\r\n\tdimensions.width = width;\r\n\tdimensions.height = height;\r\n\tUTILS.stylizeEditor(this.ui, snippet.snippetText, dimensions, 'javascript');\r\n\treturn snippet;\r\n}\r\n\r\nQueryPane.prototype.showConfigEditor = function(result, config, span){\r\n    var cSnippet = this.getEditor(300, 250,\r\n                        JSON.stringify(config, undefined, 2));\r\n    var self = this;\r\n    cSnippet.actionButton.addEventListener('click', function(){\r\n        try{\r\n            //self.submitConfigRules(woql, cSnippet, qSnippet, rSnippet);\r\n\t\t\tvar cObj = UTILS.getqObjFromInput(cSnippet.snippetText.value);\r\n\t\t\tTerminusClient.FrameHelper.removeChildren(span);\r\n\t\t\tspan.appendChild(self.showResult(result, cObj));\r\n        }\r\n        catch(e){\r\n            //self.ui.showError('Error in config editor: ' + e);\r\n\t\t\tconsole.log('Error in config editor: ' + e);\r\n        }\r\n    })\r\n    return cSnippet;\r\n}\r\n\r\nQueryPane.prototype.submitConfig = function(result, config, span, cdom){\r\n\tvar cSnippet = this.showConfigEditor(result, config, span);\r\n\tcdom.appendChild(cSnippet.dom);\r\n}\r\n\r\nQueryPane.prototype.showConfig = function(result, config, span, cdom){\r\n\tvar cbtn = document.createElement('button');\r\n    //cbtn.setAttribute('style', 'margin-top: 10px;');\r\n    cbtn.setAttribute('class', 'terminus-btn terminus-query-config-btn');\r\n    cbtn.appendChild(document.createTextNode('Config'));\r\n    //rSnippet.dom.appendChild(cbtn);\r\n    //qSnippet.dom.appendChild(cbtn);\r\n    var self = this;\r\n    cbtn.addEventListener('click', function(){\r\n\t\tTerminusClient.FrameHelper.removeChildren(cdom);\r\n        self.submitConfig(result, config, span, cdom);\r\n    })\r\n    return cbtn;\r\n}\r\n\r\n\r\n/*QueryPane.prototype.addResultViewerOLD = function(label, rule, ruleviewer){\r\n\tlet rv = new ResultViewer(rule);\r\n\tif(ruleviewer) rv.setRuleViewer(ruleviewer);\r\n\tthis.result_viewers[label] = rv;\r\n\treturn this;\r\n} */\r\n\r\nQueryPane.prototype.addResultViewer = function(rule){\r\n\talert(\"rule \" + JSON.stringify(rule));\r\n\tthis.result_viewers.push(rule);\r\n\treturn this;\r\n}\r\n\r\n\r\n\r\nQueryPane.prototype.addLibrary = function(lib){\r\n\tthis.libraries.push(lib);\r\n\treturn this;\r\n}\r\n\r\nQueryPane.prototype.render = function(lib){\r\n\tvar qps = document.createElement(\"span\");\r\n\tfor(var i = 0; i<this.query_viewers.length; i++){\r\n\t\tvar qv = this.query_viewers[i];\r\n\t\tif(qv){\r\n\t\t\tlet v = qv.render();\r\n\t\t\tif(v) qps.appendChild(v);\r\n\t\t}\r\n\t}\r\n\r\n\tfor(var k in this.result_viewers){\r\n\t\tvar rv = this.result_viewers[k];\r\n\t\tif(rv){\r\n\t\t\tvar x = rv.render();\r\n\t\t\tif(x) qps.appendChild(x);\r\n\t\t}\r\n\t}\r\n\treturn qps;\r\n}\r\n\r\nfunction ResultViewer(rule){\r\n\tthis.rules = [];\r\n\tif(rule) this.rules.push(rule);\r\n}\r\n\r\nResultViewer.prototype.render = function(){\r\n\talert(\"rv\");\r\n\tvar span = document.createElement(\"span\");\r\n\tif(this.ruleviewer){\r\n\t\tlet r = this.ruleviewer.render();\r\n\t\tif(r) span.appendChild(r);\r\n\t}\r\n\treturn span;\r\n}\r\n\r\nResultViewer.prototype.setRuleViewer = function(rv){\r\n\tthis.ruleviewer = rv;\r\n}\r\n\r\n\r\n\r\nmodule.exports = QueryPane;\r\n","const TerminusClient = require('@terminusdb/terminus-client');\r\nconst UTILS= require('../../Utils');\r\n\r\n/*\r\nqObj: WOQL object\r\nwidth: width of snippet in px\r\nheight: height of snippet in px\r\n*/\r\nfunction TerminusCodeSnippet(language, mode, format, width, height, placeholder){\r\n\tthis.language = (language ? language : \"woql\");//woql / rule\r\n\tthis.mode = (mode ? mode : \"view\");\r\n    this.width = (width ? width : 800);\r\n\tthis.height = (height ? height : 300);\r\n\tthis.placeholder = (placeholder ? placeholder : \"\");\r\n    this.format = (format ? format : \"js\");\r\n    this.formats = {'js': \"WOQL.js\", 'jsonld': \"JSON-LD\"};\r\n    this.view_types = {'table': \"Table\", \"graph\": \"Graph\", \"chooser\": \"Drop-down List\", \"stream\": \"Result Stream\" };\r\n    if(this.mode == 'view')\r\n        this.snippet = document.createElement('pre');\r\n    else {\r\n    \tthis.snippet = document.createElement('textarea');\r\n    \tthis.snippet.setAttribute(\"spellcheck\", \"false\");\r\n    }\r\n}\r\n\r\nTerminusCodeSnippet.prototype.setQuery = function(q){\r\n\tthis.qObj = q;\r\n\tthis.refreshContents();\r\n}\r\n\r\nTerminusCodeSnippet.prototype.serialise = function(query, format){\r\n\tif(format == \"js\"){\r\n\t\treturn query.prettyPrint(4);\r\n\t}\r\n\telse {\r\n\t\treturn JSON.stringify(query.json(), 0, 2);\r\n\t}\r\n}\r\n\r\n//parses a string encoding a woql in either json or js notation\r\nTerminusCodeSnippet.prototype.parseText = function(text, format){\r\n\ttry {\r\n\t\tvar WOQL = TerminusClient.WOQL;\r\n\t\tif(format == \"js\"){\r\n\t\t\tvar nw = eval(text);\r\n\t\t\treturn nw;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tvar qval = JSON.parse(text);\r\n\t\t\treturn WOQL.json(qval);\r\n\t\t}\r\n\t}\r\n\tcatch(e){\r\n\t\tthis.error = \"Failed to parse Query \" + e.toString();\r\n\t\tconsole.error(this.error);\r\n\t\treturn false;\r\n\t}\r\n}\r\n\r\nTerminusCodeSnippet.prototype.getInputElement = function(){\r\n\treturn this.snippet;\r\n}\r\n\r\nTerminusCodeSnippet.prototype.readInput = function(){\r\n\tif(this.mode == \"edit\") {\r\n\t\tthis.qObj = this.parseText(this.snippet.value, this.format);\r\n\t\treturn this.qObj;\r\n\t}\r\n\treturn this.qObj;\r\n}\r\n\r\nTerminusCodeSnippet.prototype.get = function(){\r\n\treturn this.readInput();\r\n}\r\n\r\nTerminusCodeSnippet.prototype.getAsDOM = function(){\r\n    var scont = document.createElement('div');\r\n    // query\r\n    var snpc = document.createElement('div');\r\n    snpc.setAttribute('style', 'display:table-caption; margin: 20px');\r\n    if(this.placeholder)\r\n\t\tthis.snippet.setAttribute(\"placeholder\", this.placeholder);\r\n    if(this.width && this.height)\r\n\t\tthis.snippet.setAttribute(\"style\", \"width: \"+ this.width +\"px; height: \"+ this.height + \"px;\");\r\n    if(this.language == \"woql\"){\r\n    \tsnpc.appendChild(this.getFormatButtons());\r\n    }\r\n    else {\r\n    \tsnpc.appendChild(this.getViewTypeButtons());\r\n    }\r\n    if(this.qObj){\r\n    \tvar serial = this.serialise(this.qObj, this.format);\r\n    \tif(this.mode == \"edit\"){\r\n    \t\tthis.snippet.value = serial;\r\n    \t}\r\n    \telse {\r\n    \t\tthis.snippet.appendChild(document.createTextNode(serial));\r\n    \t}\r\n    }\r\n    snpc.appendChild(this.snippet);\r\n    if(this.mode == \"edit\"){\r\n    \tvar actbtn = this.getSubmitButton();\r\n    \tsnpc.appendChild(actbtn);\r\n    }\r\n    scont.appendChild(snpc);\r\n    return scont;\r\n}\r\n\r\n\r\nTerminusCodeSnippet.prototype.getViewTypeButtons = function(){\r\n    var bsp = document.createElement('span');\r\n    bsp.setAttribute('class', 'terminus-snippet-panel');\r\n    //if(this.width) bsp.setAttribute(\"style\", \"width: \"+ this.width +\"px;\");\r\n    for(f in this.view_types){\r\n        var btn = document.createElement('button');\r\n        btn.setAttribute('value', f);\r\n        btn.setAttribute('class', 'terminus-snippet-button');\r\n        btn.appendChild(document.createTextNode(this.view_types[f]));\r\n        var self = this;\r\n        btn.addEventListener('click', function(){\r\n        \tif(self.readInput()){\r\n        \t\tself.view = this.value;\r\n        \t\tself.refreshContents();\r\n        \t}\r\n        \telse {\r\n        \t\talert(self.error);\r\n        \t}\r\n        })\r\n        bsp.appendChild(btn);\r\n    }\r\n    return bsp;\r\n}\r\n\r\nTerminusCodeSnippet.prototype.getFormatButtons = function(){\r\n    var bsp = document.createElement('span');\r\n    bsp.setAttribute('class', 'terminus-snippet-panel');\r\n    //if(this.width) bsp.setAttribute(\"style\", \"width: \"+ this.width +\"px;\");\r\n    for(f in this.formats){\r\n        var btn = document.createElement('button');\r\n        btn.setAttribute('value', f);\r\n        btn.setAttribute('class', 'terminus-snippet-button');\r\n        btn.appendChild(document.createTextNode(this.formats[f]));\r\n        var self = this;\r\n        btn.addEventListener('click', function(){\r\n        \tif(self.readInput()){\r\n        \t\tself.format = this.value;\r\n        \t\tself.refreshContents();\r\n        \t}\r\n        \telse {\r\n        \t\talert(self.error);\r\n        \t}\r\n        })\r\n        bsp.appendChild(btn);\r\n    }\r\n    return bsp;\r\n}\r\n\r\n\r\nTerminusCodeSnippet.prototype.getSubmitButton = function(){\r\n    var actbtn = document.createElement('button');\r\n    actbtn.setAttribute('class', 'terminus-btn');\r\n    actbtn.setAttribute('type', 'submit');\r\n    actbtn.appendChild(document.createTextNode('Submit Query'));\r\n    actbtn.addEventListener('click', () => {\r\n    \tthis.readInput();\r\n    \tthis.submit(this.qObj);\r\n    });\r\n    return actbtn;\r\n}\r\n\r\nTerminusCodeSnippet.prototype.submit = function(){\r\n\talert(\"Submitted \" + JSON.stringify(this.qObj));\r\n}\r\n\r\n\r\nTerminusCodeSnippet.prototype.refreshContents = function(){\r\n    TerminusClient.FrameHelper.removeChildren(this.snippet);\r\n    if(!this.qObj) return;\r\n\tvar serial = this.serialise(this.qObj, this.format);\r\n\tif(this.mode == \"edit\"){\r\n\t\tthis.snippet.value = serial;\r\n\t}\r\n\telse {\r\n\t\tthis.snippet.appendChild(document.createTextNode(serial));\r\n\t}\r\n}\r\n\r\nmodule.exports = TerminusCodeSnippet;\r\n","const TerminusUI = require('./TerminusUI');\r\nconst RenderingMap = require('./client/RenderingMap');\r\nmodule.exports={TerminusUI:TerminusUI,\r\n                RenderingMap:RenderingMap}\r\n","/**\r\n * Terminus UI object\r\n *\r\n * Traffic control of messages going between different Terminus UI pages and features\r\n *\r\n * @param opts - options array\r\n */\r\nconst ApiExplorer = require('./ApiExplorer');\r\nconst TerminusDocumentViewer = require('./TerminusDocument');\r\nconst TerminusDBsdk = require('./TerminusDB');\r\nconst TerminusViolations = require('./html/TerminusViolation');\r\nconst TerminusQueryViewer = require('./TerminusQuery');\r\nconst TerminusSchemaViewer = require('./TerminusSchema');\r\nconst TerminusServersdk = require('./TerminusServer');\r\nconst TerminusURLLoader = require('./TerminusURL');\r\nconst TerminusPluginManager = require('./plugins/TerminusPlugin');\r\nconst UTILS = require('./Utils');\r\nconst RenderingMap = require('./client/RenderingMap');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction TerminusUI(opts){\r\n\tthis.client = new TerminusClient.WOQLClient();\r\n\tthis.controls = [];\r\n\tthis.setOptions(opts);\r\n}\r\n\r\n/*\r\n * Client connects to specified server and specified part\r\n * opts is a json with the following fields:\r\n * server: mandatory URL of the server to connect to\r\n * key: optional client API key\r\n * dbid: id of the database to connect to\r\n * schema: if set, the UI will load the schema page after connecting\r\n * query: if set, the query will be sent to the server and the results will be loaded on the query page\r\n * document: if set, the document page corresponding to this document will be loaded after connecting\r\n *\r\n * (note: schema, query, document are mutually exclusive and must also have a dbid set)\r\n */\r\nTerminusUI.prototype.connect = function(opts){\r\n\tvar self = this;\r\n\tthis.client.connectionConfig.server = false;\r\n\tvar key = ((opts && opts.key) ? opts.key : false);\r\n\tthis.showBusy(\"Connecting to server at \" + opts.server);\r\n\treturn this.client.connect(opts.server, key)\r\n\t.then( function(response) {\r\n\t\tself.clearBusy();\r\n\t\tif(opts && opts.db && self.getDBRecord(opts.db)){\r\n\t\t\tself.connectToDB(opts.db);\r\n\t\t\tif(opts.document && self.showView(\"get_document\")){\r\n\t\t\t\tresponse = self.showDocument(opts.document);\r\n\t\t\t}\r\n\t\t\telse if(opts.schema && self.showView(\"get_schema\")){\r\n\t\t\t\tresponse = self.showSchemaPage(opts.schema);\r\n\t\t\t}\r\n\t\t\telse if(opts.query && self.showView(\"woql_select\")){\r\n\t\t\t\tself.showQueryPage(opts.query);\r\n\t\t\t}\r\n\t\t\telse if(opts.explorer && self.showView(\"api_explorer\")){\r\n\t\t\t\tself.showExplorer(opts.explorer);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tself.showDBMainPage();\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tself.showServerMainPage();\r\n\t\t}\r\n\t\tself.redraw();\r\n\t\treturn response;\r\n\t})\r\n\t.catch(function(err) {\r\n\t\tself.clearBusy();\r\n\t\tself.showError(err);\r\n\t\tthrow(err);\r\n\t});\r\n}\r\n\r\n/**\r\n * Sends a request to create a new database to the server and interprets the response\r\n *\r\n * dbdets is a json object with the following fields:\r\n * id: the id of the new database (alphanumeric, no spaces, url friendly) mandatory\r\n * title: the text name of the new database for tables, etc. mandatory\r\n * description: text description of the database (optional)\r\n * key: a API client key for server auth\r\n * schema: the url of another Terminus DB from which to import schema\r\n * instance: the url of another Terminus DB from which to import data\r\n *\r\n */\r\nTerminusUI.prototype.createDatabase = function(dbdets){\r\n\tvar self = this;\r\n\tif(!dbdets.id || !dbdets.title){\r\n        return Promise.reject(new Error(self.getBadArguments(\"createDatabase\", \"ID and title are mandatory fields\")));\r\n\t}\r\n\tvar dbid = dbdets.id;\r\n\tvar myserver = this.client.connectionConfig.server;\r\n\tself.showBusy(\"Creating Database \" + dbdets.title + \" with id \" + dbid);\r\n\tvar dbdoc = this.generateNewDatabaseDocument(dbdets);\r\n\treturn this.client.createDatabase(dbid, dbdoc)\r\n\t.then(function(response){ //import schema into newly created DB\r\n\t\tif(dbdets.schema){\r\n\t\t\tself.showBusy(\"Fetching imported schema from \" + dbdets.schema);\r\n\t\t\tvar opts = (dbdets.key ?  {\"terminus:user_key\": dbdets.key } : {});\r\n\t\t\topts['terminus:encoding'] = \"terminus:turtle\";\r\n\t\t\treturn self.client.getSchema(dbdets.schema, opts)\r\n\t\t\t.then(function(response){\r\n\t\t\t\tself.showBusy(\"Updating database with new schema\");\r\n\t\t\t\tself.client.connectionConfig.server = myserver;\r\n\t\t\t\tself.client.connectionConfig.dbid = dbid;\r\n\t\t\t\tvar nopts = {'terminus:encoding':  \"terminus:turtle\"};\r\n\t\t\t\treturn self.client.updateSchema(false, response, nopts);\r\n\t\t\t})\r\n\t\t\t.then(function(response){\r\n\t\t\t\tself.clearBusy();\r\n\t\t\t\tself.redraw();\r\n\t\t\t\treturn response;\r\n\t\t\t});\r\n\t\t}\r\n\t\telse {\r\n\t\t\tself.clearBusy();\r\n\t\t}\r\n\t\treturn response;\r\n\t})\r\n\t.then(function(response){ //reload list of databases in background..\r\n\t\treturn self.refreshDBList()\r\n\t\t.then(function(response){\r\n\t\t\tif(crec = self.client.connection.getDBRecord(dbid)){\r\n\t\t\t\tself.client.connectionConfig.dbid = dbid;\r\n\t\t\t\tself.showDBMainPage();\r\n\t\t\t\tself.showMessage(\"Successfully Created Database \" + dbid, \"success\");\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t        return Promise.reject(new Error(self.getCrashString(\"createDatabase\", \"Failed to retrieve record of created database \" + dbid)));\r\n\t\t\t}\r\n\t\t})\r\n\t})\r\n\t.catch(function(error){\r\n\t\tself.clearBusy();\r\n\t\tself.showError(error);\r\n\t});\r\n}\r\n\r\n/**\r\n * Deletes the database with the passed id from the currently connected server\r\n */\r\nTerminusUI.prototype.deleteDatabase = function(dbid){\r\n\tvar self = this;\r\n\tvar delrec = this.client.connection.getDBRecord();\r\n\tvar lid = (dbid ? dbid : this.db());\r\n\tvar dbn = (delrec && delrec['rdfs:label'] && delrec['rdfs:label'][\"@value\"] ? delrec['rdfs:label'][\"@value\"] + \" (id: \" + lid + \")\" : lid);\r\n\tthis.showBusy(\"Deleting database \" + dbn);\r\n\treturn this.client.deleteDatabase(dbid)\r\n\t.then(function(response){\r\n\t\tself.clearBusy();\r\n\t\tself.client.connectionConfig.dbid = false;\r\n\t\tself.removeDB(dbid);\r\n\t\tself.showServerMainPage();\r\n\t\tself.showMessage(\"Successfully Deleted Database \" + dbn, \"success\");\r\n\t\tself.refreshDBList();\r\n\t\treturn response;\r\n\t})\r\n\t.catch(function(error){\r\n\t\tself.clearBusy();\r\n\t\tself.showError(error);\r\n\t});\r\n}\r\n\r\n/*\r\n * Transforms a details (id, title, description) array into  json-ld document\r\n */\r\nTerminusUI.prototype.generateNewDatabaseDocument = function(dets){\r\n\tvar doc = {\r\n\t\t\"@context\" : {\r\n\t\t\trdfs: \"http://www.w3.org/2000/01/rdf-schema#\",\r\n\t\t\tterminus: \"http://terminusdb.com/schema/terminus#\"\r\n\t\t},\r\n\t\t\"@type\": \"terminus:Database\"\r\n\t}\r\n\tif(dets.title){\r\n\t\tdoc['rdfs:label'] = {\r\n\t\t\t\"@language\":  \"en\",\r\n\t\t\t\"@value\": dets.title\r\n\t\t};\r\n\t}\r\n\tif(dets.description){\r\n\t\tdoc['rdfs:comment'] = {\r\n\t\t\t\"@language\":  \"en\",\r\n\t\t\t\"@value\": dets.description\r\n\t\t};\r\n\t}\r\n\tdoc['terminus:allow_origin'] = { \"@type\" : \"xsd:string\", \"@value\" : \"*\" };\r\n\treturn doc;\r\n}\r\n\r\nTerminusUI.prototype.getBadArguments = function(fname, str){\r\n\treturn \"Bad arguments to \" + fname + \": \" + str;\r\n}\r\n\r\nTerminusUI.prototype.getCrashString = function(fname, str){\r\n\treturn \"Results from \" + fname + \" indicate the possibility of a system failure \" + str;\r\n}\r\n\r\n/*\r\n * Parses the passed URL and turns it into a call to the connect function - loads the appropriate endpoing\r\n */\r\nTerminusUI.prototype.load = function(url, key){\r\n\tvar args = {};\r\n\tif(url && url.indexOf(\"/document/\") != -1){\r\n\t\turl = url.substring(0, url.indexOf(\"/document/\"));\r\n\t\targs.document = url.substring(url.indexOf(\"/document/\")+10);\r\n\t}\r\n\telse if(url && url.indexOf(\"/schema\") != -1){\r\n\t\turl = url.substring(0, url.indexOf(\"/schema\"));\r\n\t\targs.schema = {};\r\n\t}\r\n\telse if(url && url.indexOf(\"/woql\") != -1){\r\n\t\turl = url.substring(0, url.indexOf(\"/query\"));\r\n\t\targs.query = url.substring(url.indexOf(\"/query\")+7);\r\n\t}\r\n\targs.server = url;\r\n\tif(key) args.key = key;\r\n\treturn this.connect(args);\r\n}\r\n\r\n/**\r\n * Fetches the DB URL from the url by chopping off the extra bits\r\n */\r\nTerminusUI.prototype.getConnectionEndpoint = function(url){\r\n\tif(url && url.lastIndexOf(\"/schema\") != -1){\r\n\t\treturn url.substring(0, url.lastIndexOf(\"/schema\"));\r\n\t}\r\n\tif(url && url.lastIndexOf(\"/document\") != -1){\r\n\t\treturn url.substring(0, url.lastIndexOf(\"/document\"));\r\n\t}\r\n\tif(url && url.lastIndexOf(\"/frame\") != -1){\r\n\t\treturn url.substring(0, url.lastIndexOf(\"/frame\"));\r\n\t}\r\n\tif(url && url.lastIndexOf(\"/woql\") != -1){\r\n\t\treturn url.substring(0, url.lastIndexOf(\"/woql\"));\r\n\t}\r\n\treturn url;\r\n}\r\n\r\nTerminusUI.prototype.server = function(){\r\n\treturn this.client.connectionConfig.server;\r\n}\r\n\r\nTerminusUI.prototype.db = function(){\r\n\treturn this.client.connectionConfig.dbid;\r\n}\r\n\r\nTerminusUI.prototype.clearServer = function(){\r\n\tthis.client.connectionConfig.server = false;\r\n}\r\n\r\nTerminusUI.prototype.connectToDB = function(dbid){\r\n\tthis.client.connectionConfig.dbid = dbid;\r\n\tTerminusClient.FrameHelper.standard_urls['doc'] = this.client.connectionConfig.dbURL() + \"/document/\";\r\n\tTerminusClient.FrameHelper.standard_urls['scm'] = this.client.connectionConfig.dbURL() + \"/schema#\";\r\n}\r\n\r\nTerminusUI.prototype.clearDB = function(){\r\n\tthis.client.connectionConfig.dbid = false;\r\n}\r\n\r\nTerminusUI.prototype.removeDB = function(db, url){\r\n\tthis.client.connection.removeDB(db, url);\r\n}\r\n\r\nTerminusUI.prototype.getDBRecord = function(db, url){\r\n\treturn this.client.connection.getDBRecord(db, url);\r\n}\r\n\r\nTerminusUI.prototype.refreshDBList = function(){\r\n\tvar self = this;\r\n\treturn this.client.connect();\r\n}\r\n\r\nTerminusUI.prototype.showServerMainPage = function(){\r\n\tthis.viewer = new TerminusServersdk.TerminusServerViewer(this);\r\n\tthis.redrawMainPage();\r\n}\r\n\r\nTerminusUI.prototype.showLoadURLPage = function(val){\r\n\tthis.viewer = new TerminusURLLoader(this, val);\r\n\tthis.redrawMainPage();\r\n}\r\n\r\nTerminusUI.prototype.showDBMainPage = function(){\r\n\tthis.viewer = new TerminusDBsdk.TerminusDBViewer(this);\r\n\tthis.redraw();\r\n}\r\n\r\nTerminusUI.prototype.showCreateDBPage = function(){\r\n\tthis.viewer = new TerminusDBsdk.TerminusDBCreator(this);\r\n\tthis.redrawMainPage();\r\n}\r\n\r\nTerminusUI.prototype.showSchemaPage = function(durl){\r\n\tthis.viewer = new TerminusSchemaViewer(this);\r\n\tthis.redrawMainPage();\r\n}\r\n\r\nTerminusUI.prototype.showQueryPage = function(query){\r\n\tthis.viewer = new TerminusQueryViewer(this, query, this.options);\r\n\tthis.redrawMainPage();\r\n}\r\n\r\nTerminusUI.prototype.showDocumentPage = function(durl){\r\n    var opts = {};\r\n    opts.page_config = 'home';\r\n    this.viewer = new TerminusDocumentViewer(this, \"view\", opts);\r\n\tthis.redrawMainPage();\r\n}\r\n\r\nTerminusUI.prototype.showDocument = function(durl){\r\n\tthis.viewer = new TerminusDocumentViewer(this, \"view\", this.getDocViewerOptions());\r\n\tconst promise = this.viewer.loadDocument(durl);\r\n\tthis.redrawMainPage();\r\n\treturn promise;\r\n}\r\n\r\nTerminusUI.prototype.showCreateDocument = function(durl){\r\n\tthis.viewer = new TerminusDocumentViewer(this, \"create\", this.getDocCreatorOptions());\r\n\tconst promise = this.viewer.loadCreateDocument(durl);\r\n\tthis.redrawMainPage();\r\n\treturn promise;\r\n}\r\n\r\nTerminusUI.prototype.redrawMainPage = function(){\r\n\tTerminusClient.FrameHelper.removeChildren(this.mainDOM);\r\n\tif(this.viewer && this.mainDOM){\r\n\t\tvar x = this.viewer.getAsDOM();\r\n\t\tthis.mainDOM.appendChild(x);\r\n\t}\r\n}\r\n\r\nTerminusUI.prototype.showResult = function(response){\r\n\tthis.showMessage(response, \"success\");\r\n};\r\n\r\nTerminusUI.prototype.showError = function(response){\r\n\tthis.showMessage(response, \"error\");\r\n};\r\n\r\nTerminusUI.prototype.clearMessages = function(response){\r\n\tif(this.messages) TerminusClient.FrameHelper.removeChildren(this.messages);\r\n};\r\n\r\nTerminusUI.prototype.clearMainPage = function(){\r\n\tif(this.main) TerminusClient.FrameHelper.removeChildren(this.main);\r\n}\r\n\r\nTerminusUI.prototype.setMessageDOM = function(dom){\r\n\tthis.messages = dom;\r\n}\r\n\r\nTerminusUI.prototype.setbuttonControls = function(dom){\r\n\tthis.buttons = dom;\r\n}\r\n\r\nTerminusUI.prototype.setControllerDOM = function(dom){\r\n\tthis.controller = dom;\r\n}\r\n\r\nTerminusUI.prototype.setExplorerDOM = function(dom){\r\n\tthis.explorer = dom;\r\n}\r\n\r\nTerminusUI.prototype.setPluginsDOM = function(dom){\r\n\tthis.plugins = dom;\r\n}\r\n\r\nTerminusUI.prototype.setViewerDOM = function(dom){\r\n\tthis.mainDOM = dom;\r\n}\r\n\r\nTerminusUI.prototype.draw = function(comps, slocation){\r\n\tif(comps && comps.viewer) this.setViewerDOM(comps.viewer);\r\n\tif(comps && comps.buttons) this.setbuttonControls(comps.buttons);\r\n\tif(comps && comps.messages) this.setMessageDOM(comps.messages);\r\n\tif(comps && comps.controller) this.setControllerDOM(comps.controller);\r\n\tif(comps && comps.explorer) this.setExplorerDOM(comps.explorer);\r\n\tif(comps && comps.plugins) this.setPluginsDOM(comps.plugins);\r\n\tif(this.plugins){\r\n\t\tthis.drawPlugins();\r\n\t}\r\n\tif(this.buttons){\r\n\t\tthis.toggleControl();\r\n\t}\r\n\tvar self = this;\r\n\tvar cdrawn = false;\r\n\tif(slocation && slocation.server){\r\n\t\tif(typeof this.client.connection.connection[slocation.server] == \"undefined\") {\r\n\t\t\treturn this.connect(slocation)\r\n\t\t\t.catch(function(error){\r\n\t\t\t\tself.showLoadURLPage();\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tthis.showLoadURLPage();\r\n\t};\r\n}\r\n\r\n\r\n\r\nTerminusUI.prototype.redraw = function(msg){\r\n\tthis.clearMessages();\r\n\tif(this.controller){\r\n\t\tTerminusClient.FrameHelper.removeChildren(this.controller);\r\n\t\tthis.drawControls();\r\n\t}\r\n\tif(this.explorer){\r\n\t\tTerminusClient.FrameHelper.removeChildren(this.explorer);\r\n\t\t//this.drawExplorer();\r\n\t}\r\n\tif(this.viewer){\r\n\t\tthis.redrawMainPage();\r\n\t}\r\n\tif(msg) this.showMessage(msg);\r\n};\r\n\r\n\r\nTerminusUI.prototype.toggleDashboardWidget = function(widget){\r\n    TerminusClient.FrameHelper.removeChildren(this.controller);\r\n    TerminusClient.FrameHelper.removeChildren(this.explorer);\r\n    UTILS.removeSelectedNavClass('terminus-dashboard-selected');\r\n    widget.classList.add('terminus-dashboard-selected');\r\n}\r\n\r\nTerminusUI.prototype.toggleControl = function(){\r\n  var self = this;\r\n  this.buttons.client.addEventListener('click', function(){\r\n    self.toggleDashboardWidget(this);\r\n    self.drawControls();\r\n    self.showServerMainPage();\r\n  })\r\n  this.buttons.explorer.addEventListener('click', function(){\r\n    self.toggleDashboardWidget(this);\r\n    self.drawExplorer();\r\n  })\r\n}\r\n\r\nTerminusUI.prototype.drawControls = function(){\r\n\tthis.controls = [];\r\n\tthis.loadControls();\r\n\tfor(var i = 0; i<this.controls.length; i++){\r\n\t\tvar ncontrol = this.controls[i];\r\n\t\tif(ncontrol && (nd = ncontrol.getAsDOM())){\r\n\t\t\tthis.controller.appendChild(nd);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nTerminusUI.prototype.drawExplorer = function(){\r\n\tif(this.explorer){\r\n\t\tif(this.showControl(\"api_explorer\")){\r\n\t\t\tvar exp = new ApiExplorer(this);\r\n\t\t\tae = exp.getAsDOM();\r\n\t\t\tthis.explorer.appendChild(ae);\r\n\t\t\tthis.explorer.style.display = 'block';\r\n\t\t}\r\n\t}\r\n}\r\n\r\nTerminusUI.prototype.loadControls = function(){\r\n\tif(this.showControl('server')){\r\n\t\tvar sc = new TerminusServersdk.TerminusServerController(this);\r\n\t\tif(sc) {\r\n\t\t\tthis.controls.push(sc);\r\n\t\t}\r\n\t\tif(this.db() && this.showControl(\"db\")){\r\n\t\t\tvar sc = new TerminusDBsdk.TerminusDBController(this);\r\n\t\t\tif(sc) this.controls.push(sc);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nTerminusUI.prototype.showControl = function(el){\r\n\tif(this.show_controls.indexOf(el) == -1) return false;\r\n\tif(this.pseudoCapability(el)) return true;\r\n\tif(this.client.connection.capabilitiesPermit(el)) {\r\n\t\treturn true;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nTerminusUI.prototype.showView = function(el){\r\n\tif(this.show_views.indexOf(el) == -1) return false;\r\n\tif(this.pseudoCapability(el)) return true;\r\n\tif(this.client.connection.capabilitiesPermit(el)) {\r\n\t\treturn true;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nTerminusUI.prototype.clearBusy = function(response){\r\n\tthis.clearMessages();\r\n\tif(this.viewer && typeof this.viewer.busy == \"function\") this.viewer.busy(false);\r\n}\r\n\r\nTerminusUI.prototype.getBusyLoader = function(bsyDom){\r\n     var pd = document.createElement('div');\r\n     var pbc = document.createElement('div');\r\n     pbc.setAttribute('class', 'term-progress-bar-container');\r\n     pd.appendChild(pbc);\r\n\r\n     var pbsa = document.createElement('div');\r\n     pbsa.setAttribute('class', 'term-progress-bar term-stripes animated reverse slower');\r\n     pbc.appendChild(pbsa);\r\n     var pbia = document.createElement('span');\r\n     pbia.setAttribute('class', 'term-progress-bar-inner');\r\n     pbsa.appendChild(pbia);\r\n\r\n     bsyDom.appendChild(pd);\r\n}\r\n\r\nTerminusUI.prototype.showMessage = function(msg, type){\r\n\tif(this.messages){\r\n\t\tTerminusClient.FrameHelper.removeChildren(this.messages);\r\n\t\tvar md = document.createElement('div');\r\n        switch(type){\r\n            case 'busy':\r\n                var msgHolder = document.createElement('div');\r\n                msgHolder.setAttribute('class', 'terminus-busy-msg')\r\n                msgHolder.appendChild(document.createTextNode(msg));\r\n                md.appendChild(msgHolder);\r\n                this.getBusyLoader(md);\r\n            break;\r\n            case 'success':\r\n                md.setAttribute('class', 'terminus-show-msg-success');\r\n                md.appendChild(document.createTextNode(msg));\r\n            break;\r\n            case 'error':\r\n                md.setAttribute('class', 'terminus-show-msg-error');\r\n                md.appendChild(document.createTextNode(msg));\r\n            break;\r\n        }\r\n\t\tthis.messages.appendChild(md);\r\n\t}\r\n};\r\n\r\nTerminusUI.prototype.showViolations = function(vios, type){\r\n\tvar nvios = new TerminusViolations(vios, this);\r\n\tif(this.messages){\r\n\t\tvar cmsg = (type == \"schema\" ? \" in Schema\" : \" in Document\");\r\n\t\tTerminusClient.FrameHelper.removeChildren(this.messages);\r\n\t\tthis.messages.appendChild(nvios.getAsDOM(cmsg));\r\n\t}\r\n}\r\n\r\nTerminusUI.prototype.showBusy = function(msg){\r\n\tthis.showMessage(msg, \"busy\");\r\n\tif(this.viewer && typeof this.viewer.busy == \"function\") this.viewer.busy(msg);\r\n};\r\n\r\nTerminusUI.prototype.pseudoCapability = function(el){\r\n\tvar pseuds = [\"server\", \"db\", \"change-server\", \"api_explorer\", \"import_schema\", \"schema_format\"];\r\n\tif(pseuds.indexOf(el) == -1) return false;\r\n\treturn true;\r\n}\r\n\r\nTerminusUI.prototype.setOptions = function(opts){\r\n\tthis.show_controls = opts && opts.controls ? opts.controls :\r\n\t\t[\"server\", \"db\", \"change-server\", \"schema_format\",\r\n\t\t\t\"import_schema\", \"class_frame\", \"create_database\",\r\n\t\t\t\"create_document\", \"get_document\", \"update_schema\",\r\n\t\t\t\"get_schema\", \"woql_select\"\r\n\t\t];\r\n\tthis.show_views = opts && opts.views ? opts.views : this.show_controls;\r\n\tif(opts.document){\r\n\t\tthis.document_options = opts.document;\r\n\t}\r\n\tif(opts.schema){\r\n\t\tthis.schema_options = opts.schema;\r\n\t}\r\n\tthis.piman = new TerminusPluginManager();\r\n\tvar self = this;\r\n\tthis.piman.init(opts.plugins, function(){\r\n\t\tvar pins = [\"gmaps\", \"quill\", \"select2\"];\r\n\t\tfor(var i = 0; i<pins.length; i++){\r\n\t\t\tif(self.piman.pluginAvailable(pins[i])){\r\n\t\t\t\tRenderingMap.addPlugin(pins[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t\tself.redraw();\r\n\t});\r\n\tif(opts.css && this.piman){\r\n\t\tthis.piman.loadPageCSS(opts.css);\r\n\t}\r\n\tthis.loadControls();\r\n}\r\n\r\nTerminusUI.prototype.pluginAvailable = function(p){\r\n\treturn this.piman.pluginAvailable(p);\r\n}\r\n\r\nTerminusUI.prototype.drawPlugins = function(){\r\n\tif(!this.piman) {\r\n\t\tconsole.log(new Error(\"No plugin manager initialised in UI object\"));\r\n\t\treturn false;\r\n\t}\r\n\tthis.plugins.appendChild(this.piman.getAsDOM(this));\r\n}\r\n\r\nTerminusUI.prototype.getDocViewerOptions = function(){\r\n\tif(this.document_options && this.document_options['view']){\r\n\t\treturn this.document_options['view'];\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nTerminusUI.prototype.getDocCreatorOptions = function(){\r\n\tif(this.document_options && this.document_options['view']){\r\n\t\treturn this.document_options['view'];\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nTerminusUI.prototype.getClassFrameOptions = function(){\r\n\treturn this.viewdoc_options;\r\n}\r\n\r\nmodule.exports=TerminusUI\r\n","/**\r\n * @file Javascript Api explorer tool\r\n * @author Kitty Jose\r\n * @license Copyright 2018-2019 Data Chemist Limited, All Rights Reserved. See LICENSE file for more\r\n *\r\n * @summary Displays a demo and description of api calls from WOQLCLient and what happens under the hood of api calls\r\n */\r\nconst TerminusPluginManager = require('./plugins/TerminusPlugin');\r\nconst UTILS = require('./Utils');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nlet apiNavConfig = {\r\n    mainNav: {\r\n        connect: {\r\n    \t\tnavText: 'Connect API',\r\n            action : 'connect',\r\n            icon   : 'link',\r\n            defaultSelected: true\r\n    \t},\r\n        database: {\r\n            navText: 'Database API',\r\n            action : 'create',\r\n            icon   : 'database'\r\n        },\r\n        schema: {\r\n            navText: 'Schema API',\r\n            action : 'schema',\r\n            icon   : 'cog'\r\n        },\r\n        document: {\r\n            navText: 'Document API',\r\n            action : 'document',\r\n            icon   : 'file'\r\n        },\r\n        query: {\r\n            navText: 'Query API',\r\n            action : 'query',\r\n            icon   : 'search'\r\n        }\r\n    },\r\n    subNav: {\r\n        database: {\r\n            createDatabase: {\r\n                navText: 'Create database',\r\n                action : 'create',\r\n                icon   : 'plus',\r\n                defaultSelected: true\r\n            },\r\n            deleteDatabase: {\r\n                navText: 'Delete database',\r\n                action : 'delete',\r\n                icon   : 'trash-alt'\r\n            }\r\n        },\r\n        schema: {\r\n            getSchema: {\r\n                navText: 'View Schema',\r\n                action : 'getSchema',\r\n                icon   : 'eye',\r\n                defaultSelected: true\r\n            },\r\n            updateSchema: {\r\n                navText: 'Update Schema',\r\n                action : 'updateSchema',\r\n                icon   : 'arrow-up'\r\n            },\r\n            getClassFrames: {\r\n                navText: 'Get Class Frames',\r\n                action : 'getClassFrames',\r\n                icon   : 'share-alt'\r\n            }\r\n        },\r\n        document: {\r\n            viewDocument: {\r\n        \t\tnavText: 'View Document',\r\n                action : 'viewDocument',\r\n                icon   : 'eye',\r\n                defaultSelected: true\r\n        \t},\r\n            createDocument: {\r\n                navText: 'Create Document',\r\n                action : 'createDocument',\r\n                icon   : 'plus'\r\n            },\r\n            updateDocument: {\r\n                navText: 'Update Document',\r\n                action : 'updateDocument',\r\n                icon   : 'arrow-up'\r\n            },\r\n            deleteDocument:{\r\n                navText: 'Delete Document',\r\n                action : 'deleteDocument',\r\n                icon   : 'trash-alt'\r\n            }\r\n        },\r\n        query: {\r\n            select: {\r\n                navText: 'Select',\r\n                action : 'select',\r\n                icon   : 'mouse-pointer',\r\n                defaultSelected: true\r\n            },\r\n            update: {\r\n                navText: 'Update',\r\n                action : 'update',\r\n                icon   : 'arrow-up'\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nfunction ApiExplorer(ui){\r\n    this.ui = ui;\r\n    this.viewer = ui.main;\r\n    this.client = new TerminusClient.WOQLClient();\r\n    this.client.use_fetch = true;\r\n    this.client.return_full_response = true;\r\n    this.pman = new TerminusPluginManager();\r\n}\r\n\r\n// Controller provides access to Api explorer functions\r\nApiExplorer.prototype.getAsDOM = function(){\r\n \tvar aec = document.createElement(\"div\");\r\n    aec.setAttribute(\"class\", \"terminus-db-controller\");\r\n    if(this.ui){\r\n       this.getApiNav(aec, this.viewer); // nav\r\n       this.getApiExplorerDom('connect', this.viewer); // content dom\r\n    } // if this.ui\r\n    return aec;\r\n }\r\n\r\n/***** Api Nav bar *****/\r\n// Toggle selected nav bars\r\nApiExplorer.prototype.setSelectedNavMenu = function(a){\r\n    UTILS.removeSelectedNavClass(\"terminus-selected\");\r\n    a.classList.add(\"terminus-selected\");\r\n}\r\n\r\nApiExplorer.prototype.navOnSelect = function(action, nav, viewer){\r\n    UTILS.removeSelectedNavClass(\"terminus-selected\");\r\n    nav.classList.add(\"terminus-selected\");\r\n    this.getApiExplorerDom(action, viewer);\r\n}\r\n\r\n// create nav bars\r\nApiExplorer.prototype.createNavs = function(navConfig, viewer, ul){\r\n    var a = document.createElement('a');\r\n    a.setAttribute('class', 'terminus-a terminus-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\r\n    if(navConfig.defaultSelected) a.classList.add('terminus-selected');\r\n    var self = this;\r\n    a.addEventListener(\"click\", function(){\r\n        self.navOnSelect(navConfig.action, this, viewer);\r\n    })\r\n    var icon = document.createElement('i');\r\n    icon.setAttribute('class', 'terminus-menu-icon fa fa-' + navConfig.icon);\r\n    a.appendChild(icon);\r\n    var txt = document.createTextNode(navConfig.navText);\r\n    a.appendChild(txt);\r\n    ul.appendChild(a);\r\n}\r\n\r\n// gets api nav bar\r\nApiExplorer.prototype.getApiNav = function(navDom, viewer){\r\n    // list view of apis\r\n    var nav = document.createElement('div');\r\n    navDom.appendChild(nav);\r\n    // connect to server api\r\n    var ul = document.createElement('ul');\r\n    ul.setAttribute('class', 'terminus-ul');\r\n    nav.appendChild(ul);\r\n    // loop over apiNavConfig\r\n    for (var key in apiNavConfig.mainNav){\r\n        if (apiNavConfig.mainNav.hasOwnProperty(key)) {\r\n            this.createNavs(apiNavConfig.mainNav[key], viewer, ul);\r\n        }\r\n    } // for apiNavConfig\r\n    return navDom;\r\n} // getApiNav()\r\n\r\n/***** Api sub navs  *****/\r\n// get schema api explorer - nav bar, alert msg, headers ...\r\nApiExplorer.prototype.getApiExplorerDom = function(view, viewer){\r\n    // clear of viewer\r\n    TerminusClient.FrameHelper.removeChildren(viewer);\r\n    // wrapper\r\n    var wrap = document.createElement('div');\r\n    //wrap.setAttribute('class', 'terminus-wrapper terminus-wrapper-height');\r\n    viewer.appendChild(wrap);\r\n    var cont = document.createElement('div');\r\n    cont.setAttribute('class', 'container-fluid');\r\n    wrap.appendChild(cont);\r\n    var row = document.createElement('div');\r\n    row.setAttribute('class', 'row-fluid');\r\n    cont.appendChild(row);\r\n    var body = document.createElement('div');\r\n    body.setAttribute('class', 'terminus-module-body');\r\n    row.appendChild(body);\r\n    var api = document.createElement('div');\r\n    api.setAttribute('class', 'terminus-module-body terminus-module-body-white-bg terminus-module-body-width');\r\n    body.appendChild(api);\r\n    // body\r\n    var cont = document.createElement('div');\r\n    var self = this;\r\n    switch(view){\r\n        case 'connect':\r\n            var apiCont = self.getConnectExplorer(cont);\r\n            api.appendChild(apiCont);\r\n        break;\r\n        case 'create':\r\n            var apiCont = self.getDatabaseExplorer(cont);\r\n            api.appendChild(apiCont);\r\n        break;\r\n        case 'schema':\r\n            var apiCont = self.getSchemaApi(cont);\r\n            api.appendChild(apiCont);\r\n        break;\r\n        case 'document':\r\n            var apiCont = self.getDocumentApi(cont);\r\n            api.appendChild(apiCont);\r\n        break;\r\n        case 'query':\r\n            var apiCont = self.getQueryApi(cont);\r\n            api.appendChild(apiCont);\r\n        break;\r\n    }// switch(api)\r\n    return wrap;\r\n} // getApiExplorerDom\r\n\r\n// on trigger of click event - change dom\r\nApiExplorer.prototype.changeSubApiDom = function(curSubMenu, action, cont, body){\r\n    TerminusClient.FrameHelper.removeChildren(body);\r\n    switch(curSubMenu){\r\n        case 'database':\r\n            var dom = this.getDatabaseDom(action, body);\r\n        break;\r\n        case 'schema':  // getShowApiDom() deals with schema and document\r\n             var dom = this.getShowApiDom(action, body);\r\n        break;\r\n        case 'document': // getShowApiDom() deals with schema and document\r\n             var dom = this.getShowApiDom(action, body);\r\n        break;\r\n        case 'query':\r\n            var dom = this.getQueryApiDom(action, body);\r\n        break;\r\n        default:\r\n            console.log('Invalid Api Config');\r\n        break;\r\n    }\r\n    cont.appendChild(dom);\r\n}\r\n\r\nApiExplorer.prototype.subNavOnSelect = function(curSubMenu, subMenuConfig, subNav, cont, body){\r\n    UTILS.setSelectedSubMenu(subNav);\r\n    this.changeSubApiDom(curSubMenu, subMenuConfig.action, cont, body);\r\n}\r\n\r\n// create sub nav bars\r\nApiExplorer.prototype.createSubNavs = function(curSubMenu, subMenuConfig, cont, body, ul){\r\n    // comment getclassframes for api explorer time being\r\n    if(subMenuConfig.action == 'getClassFrames') return;\r\n    var a = document.createElement('a');\r\n    a.setAttribute('class', 'terminus-a terminus-hz-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\r\n    if(subMenuConfig.defaultSelected) a.classList.add('terminus-submenu-selected');\r\n    var self = this;\r\n    a.addEventListener(\"click\", function() {\r\n        self.subNavOnSelect(curSubMenu, subMenuConfig, this, cont, body);\r\n    })\r\n    var icon = document.createElement('i');\r\n    icon.setAttribute('class', 'terminus-menu-icon fa fa-' + subMenuConfig.icon);\r\n    a.appendChild(icon);\r\n    var txt = document.createTextNode(subMenuConfig.navText);\r\n    a.appendChild(txt);\r\n    ul.appendChild(a);\r\n}\r\n\r\n// get connect to server api calls - on click of connectAPI nav bar\r\nApiExplorer.prototype.getConnectExplorer = function(body){\r\n    var self = this;\r\n    var br = document.createElement('BR');\r\n    body.appendChild(br);\r\n    // get signature\r\n    var b = this.getSignature('connect');\r\n    body.appendChild(b);\r\n    // get header Parameter\r\n    body.appendChild(UTILS.getHeaderDom('Parameters'));\r\n    var br = document.createElement('BR');\r\n    body.appendChild(br);\r\n    //form to get server url\r\n    this.getForm( '', body, true, 'connect', 'URL : server_url');\r\n    //body.appendChild(form);\r\n    return body;\r\n} // getConnectExplorer\r\n\r\n// get database api calls - on click of databaseAPI nav bar - submenus of database Api defined here\r\nApiExplorer.prototype.getDatabaseExplorer = function(cont){\r\n    var body = document.createElement('div');\r\n    // list view of Databse tools\r\n    var ul = document.createElement('ul');\r\n    ul.setAttribute('class','terminus-ul-horizontal');\r\n    // loop over apiNavConfig\r\n    for (var key in apiNavConfig.subNav.database){\r\n        if (apiNavConfig.subNav.database.hasOwnProperty(key))\r\n            this.createSubNavs('database', apiNavConfig.subNav.database[key], cont, body, ul);\r\n    } // for apiNavConfig\r\n    cont.appendChild(ul);\r\n    // landing page\r\n    var dom = this.getDatabaseDom(apiNavConfig.subNav.database.createDatabase.action, body);\r\n    cont.appendChild(dom);\r\n    return cont;\r\n} // getDatabaseExplorer\r\n\r\n// get schema api calls - on click of SchemaAPI nav bar - submenus of schema Api defined here\r\nApiExplorer.prototype.getSchemaApi = function(cont){\r\n    var body = document.createElement('div');\r\n    // list view of Databse tools\r\n    var ul = document.createElement('ul');\r\n    ul.setAttribute('class','terminus-ul-horizontal');\r\n    // loop over apiNavConfig\r\n    for (var key in apiNavConfig.subNav.schema){\r\n        if (apiNavConfig.subNav.schema.hasOwnProperty(key)) {\r\n            this.createSubNavs('schema', apiNavConfig.subNav.schema[key], cont, body, ul);\r\n        }\r\n    } // for apiNavConfig\r\n    cont.appendChild(ul);\r\n    var dom = this.getShowApiDom(apiNavConfig.subNav.schema.getSchema.action, body);\r\n    cont.appendChild(dom);\r\n    return cont;\r\n} // getSchemaApi\r\n\r\n// get document api calls - on click of DocumentAPI nav bar\r\nApiExplorer.prototype.getDocumentApi = function(cont){\r\n    var body = document.createElement('div');\r\n    // list view of Databse tools\r\n    var ul = document.createElement('ul');\r\n    ul.setAttribute('class','terminus-ul-horizontal');\r\n    // loop over apiNavConfig\r\n    for (var key in apiNavConfig.subNav.document){\r\n        if (apiNavConfig.subNav.document.hasOwnProperty(key)) {\r\n            this.createSubNavs('document', apiNavConfig.subNav.document[key], cont, body, ul);\r\n        }\r\n    } // for apiNavConfig\r\n    cont.appendChild(ul);\r\n    var dom = this.getShowApiDom(apiNavConfig.subNav.document.viewDocument.action, body);\r\n    cont.appendChild(dom);\r\n    return cont;\r\n} // getDocumentApi\r\n\r\n// get query api calls - on click of QueryAPI nav bar - submenus of Query Api defined here\r\nApiExplorer.prototype.getQueryApi  = function(cont){\r\n    var body = document.createElement('div');\r\n    // list view of Databse tools\r\n    var ul = document.createElement('ul');\r\n    ul.setAttribute('class','terminus-ul-horizontal');\r\n    // loop over apiNavConfig\r\n    for (var key in apiNavConfig.subNav.query){\r\n        if (apiNavConfig.subNav.query.hasOwnProperty(key)) {\r\n            this.createSubNavs('query', apiNavConfig.subNav.query[key], cont, body, ul);\r\n        }\r\n    } // for apiNavConfig\r\n    cont.appendChild(ul);\r\n    var dom = this.getQueryApiDom(apiNavConfig.subNav.query.select.action, body);\r\n    cont.appendChild(dom);\r\n    return cont;\r\n} //getQueryApi\r\n\r\n/***** Api Content view  *****/\r\n// get database dom\r\nApiExplorer.prototype.getDatabaseDom = function(mode, body){\r\n    var self = this;\r\n    var br = document.createElement('BR');\r\n    body.appendChild(br);\r\n    // get signature\r\n    var b = this.getSignature(mode);\r\n    body.appendChild(b);\r\n    // get header Parameter\r\n    body.appendChild(UTILS.getHeaderDom('Parameters'));\r\n    var br = document.createElement('BR');\r\n    body.appendChild(br);\r\n    //form to get database id\r\n    if(mode == 'create') this.getForm( null, body, false, mode, 'URL : server/database_id');\r\n    else this.getForm( null, body, true, mode, 'URL : server/database_id');\r\n    return body;\r\n} // getConnectExplorer\r\n\r\n//get create & delete db form\r\nApiExplorer.prototype.getServerForm = function(){\r\n  // form\r\n  var form = document.createElement('form');\r\n  form.setAttribute('class', 'terminus-form-horizontal row-fluid');\r\n\r\n  var fd = document.createElement('div');\r\n  fd.setAttribute('class', 'terminus-control-group');\r\n  form.appendChild(fd);\r\n  var inpLabel = document.createElement('label');\r\n  inpLabel.setAttribute('class', 'terminus-control-label');\r\n  inpLabel.setAttribute('for', 'basicinput');\r\n  inpLabel.innerHTML = 'Url:';\r\n  fd.appendChild(inpLabel);\r\n  var cd = document.createElement('div');\r\n  cd.setAttribute('class', 'terminus-controls');\r\n  fd.appendChild(cd);\r\n  var inpId = document.createElement('input');\r\n  inpId.setAttribute('type', 'text');\r\n  inpId.setAttribute('id', 'basicinput');\r\n  inpId.setAttribute('class', 'terminus-input-text');\r\n  inpId.setAttribute('placeholder', 'URL : server_url');\r\n  if(this.val) inpId.value = this.val;\r\n  cd.appendChild(inpId);\r\n\r\n  var fd = document.createElement('div');\r\n  fd.setAttribute('class', 'terminus-control-group');\r\n  form.appendChild(fd);\r\n  var keyLabel = document.createElement('label');\r\n  keyLabel.setAttribute('class', 'terminus-control-label');\r\n  keyLabel.setAttribute('for', 'basicinput');\r\n  keyLabel.innerHTML = 'Key:';\r\n  fd.appendChild(keyLabel);\r\n  var cd = document.createElement('div');\r\n  cd.setAttribute('class', 'terminus-controls');\r\n  fd.appendChild(cd);\r\n  var key = document.createElement('input');\r\n  key.setAttribute('type', 'text');\r\n  key.setAttribute('id', 'basicinput');\r\n  key.setAttribute('class', 'span8 terminus-input-text');\r\n  key.setAttribute('placeholder', 'Key : key');\r\n  if(this.val) key.value = this.val;\r\n  cd.appendChild(key);\r\n\r\n  var button = document.createElement('button');\r\n  button.setAttribute('class', 'terminus-btn terminus-send-api-btn');\r\n  button.setAttribute('type', 'button');\r\n  button.innerHTML = 'Send Api';\r\n  var gatherips = function(){\r\n    var input = {};\r\n    input.url = inpId.value;\r\n    input.key = key.value;\r\n    return input;\r\n  }\r\n  var resd = document.createElement('div');\r\n  form.appendChild(button);\r\n  form.appendChild(resd);\r\n  var self = this;\r\n  button.addEventListener(\"click\", function(){\r\n    var buttonSelf = this;\r\n    //opts = {};\r\n    var input = gatherips();\r\n    self.client.connect(input.url, input.key)\r\n    .then(function(response){\r\n      TerminusClient.FrameHelper.removeChildren(resd);\r\n      var resultDom = UTILS.showHttpResult(response, 'connect', resd, self.ui);\r\n    });\r\n  }) // button click\r\n  return form;\r\n} // getServerForm()\r\n\r\n// get database api calls - on click of databaseAPI nav bar - submenus of database Api defined here\r\nApiExplorer.prototype.getDatabaseExplorer = function(cont){\r\n  var body = document.createElement('div');\r\n  // list view of Databse tools\r\n  var ul = document.createElement('ul');\r\n  ul.setAttribute('class','terminus-ul-horizontal');\r\n  // loop over apiNavConfig\r\n  for (var key in apiNavConfig.subNav.database){\r\n      if (apiNavConfig.subNav.database.hasOwnProperty(key)) {\r\n          this.createSubNavs('database', apiNavConfig.subNav.database[key], cont, body, ul);\r\n      }\r\n  } // for apiNavConfig\r\n  cont.appendChild(ul);\r\n  // landing page\r\n  var dom = this.getDatabaseDom(apiNavConfig.subNav.database.createDatabase.action, body);\r\n  cont.appendChild(dom);\r\n  return cont;\r\n} // getDatabaseExplorer\r\n\r\n\r\n// get schema & document dom\r\nApiExplorer.prototype.getShowApiDom = function(action, body){\r\n    var self = this;\r\n    var br = document.createElement('BR');\r\n    body.appendChild(br);\r\n    // signature\r\n    var b = this.getSignature(action);\r\n    body.appendChild(b);\r\n    // get header Parameter\r\n    body.appendChild(UTILS.getHeaderDom('Parameters'));\r\n    var br = document.createElement('BR');\r\n    body.appendChild(br);\r\n    // get input\r\n    switch(action){\r\n        case 'getSchema':\r\n            this.getForm( 'schema', body, true, action, 'URL : server/database_id');\r\n        break;\r\n        case 'getClassFrames':\r\n            this.getForm( 'getClassFrames', body, true, action, 'URL : server/database_id');\r\n        break;\r\n        case 'updateSchema':\r\n            this.getForm( 'schema', body, false, action, 'URL : server/database_id');\r\n        break;\r\n        case 'viewDocument':\r\n            this.getForm('document', body, true, action, 'URL : server/database_id/document/document_id');\r\n        break;\r\n        case 'deleteDocument':\r\n            this.getForm('document', body, true, action, 'URL : server/database_id/document/document_id');\r\n        break;\r\n        case 'createDocument':\r\n            this.getForm('document', body, false, action, 'URL : server/database_id/document/document_id');\r\n        break;\r\n        case 'updateDocument':\r\n            this.getForm('document', body, false, action, 'URL : server/database_id/document/document_id');\r\n        break;\r\n        default:\r\n            console.log('Invalid Api Call on form');\r\n        break;\r\n   }// switch(action)\r\n\r\n   return body;\r\n } // getShowApiDom()\r\n\r\n// get query api dom\r\nApiExplorer.prototype.getQueryApiDom = function(action, body){\r\n    var br = document.createElement('BR');\r\n    body.appendChild(br);\r\n    // signature\r\n    var b = this.getSignature(action);\r\n    body.appendChild(b);\r\n    // get header Parameter\r\n    body.appendChild(UTILS.getHeaderDom('Parameters'));\r\n    var br = document.createElement('BR');\r\n    body.appendChild(br);\r\n    this.getForm( 'query', body, false, action, 'URL : server/database_id');\r\n    return body;\r\n} // getQueryApiDom\r\n\r\n/*ApiExplorer.prototype.getClassFramesForm = function(){\r\n    // form\r\n    var form = document.createElement('form');\r\n    form.setAttribute('class', 'terminus-form-horizontal row-fluid');\r\n    var fd = document.createElement('div');\r\n    fd.setAttribute('class', 'terminus-control-group');\r\n    form.appendChild(fd);\r\n    var inpLabel = document.createElement('label');\r\n    inpLabel.setAttribute('class', 'terminus-control-label');\r\n    inpLabel.setAttribute('for', 'basicinput');\r\n    inpLabel.innerHTML = 'Url:';\r\n    fd.appendChild(inpLabel);\r\n    var cd = document.createElement('div');\r\n    cd.setAttribute('class', 'terminus-controls');\r\n    fd.appendChild(cd);\r\n    var inpUrl = document.createElement('input');\r\n    inpUrl.setAttribute('type', 'text');\r\n    inpUrl.setAttribute('id', 'basicinput');\r\n    inpUrl.setAttribute('class', 'span8 terminus-input-text');\r\n    inpUrl.setAttribute('placeholder', 'URL : database_url');\r\n    if(this.val) inpUrl.value = this.val;\r\n    cd.appendChild(inpUrl);\r\n    var fd = document.createElement('div');\r\n    fd.setAttribute('class', 'terminus-control-group');\r\n    form.appendChild(fd);\r\n    var inpLabel = document.createElement('label');\r\n    inpLabel.setAttribute('class', 'terminus-control-label');\r\n    inpLabel.setAttribute('for', 'basicinput');\r\n    inpLabel.innerHTML = 'Url/ ID:';\r\n    fd.appendChild(inpLabel);\r\n    var cd = document.createElement('div');\r\n    cd.setAttribute('class', 'terminus-controls');\r\n    fd.appendChild(cd);\r\n    var inpDocUrl = document.createElement('input');\r\n    inpDocUrl.setAttribute('type', 'text');\r\n    inpDocUrl.setAttribute('id', 'basicinput');\r\n    inpDocUrl.setAttribute('class', 'span8 terminus-input-text');\r\n    inpDocUrl.setAttribute('placeholder', 'Url or ID of document class');\r\n    cd.appendChild(inpDocUrl);\r\n    var fd = document.createElement('div');\r\n    fd.setAttribute('class', 'terminus-control-group');\r\n    form.appendChild(fd);\r\n    var optLabel = document.createElement('label');\r\n    optLabel.setAttribute('class', 'terminus-control-label');\r\n    optLabel.setAttribute('for', 'basicinput');\r\n    optLabel.innerHTML = 'Options:';\r\n    fd.appendChild(optLabel);\r\n    var cd = document.createElement('div');\r\n    cd.setAttribute('class', 'terminus-controls');\r\n    fd.appendChild(cd);\r\n    var optInp = document.createElement('input');\r\n    optInp.setAttribute('type', 'text');\r\n    optInp.setAttribute('id', 'basicinput');\r\n    optInp.setAttribute('class', 'span8 terminus-input-text');\r\n    optInp.setAttribute('placeholder', 'options');\r\n    cd.appendChild(optInp);\r\n    var button = document.createElement('button');\r\n    button.setAttribute('class', 'terminus-btn terminus-send-api-btn');\r\n    button.setAttribute('type', 'button');\r\n    button.innerHTML = 'Send Api';\r\n    var gatherips = function(){\r\n        var input = {};\r\n        input.url = inpUrl.value;\r\n        input.docUrl = inpDocUrl.value;\r\n        input.options = optInp.value;\r\n        return input;\r\n    }\r\n    var self = this;\r\n    button.addEventListener(\"click\", function(form){\r\n      var input = gatherips();\r\n      var buttonSelf = this;\r\n      opts = {};\r\n      opts.explorer = true;\r\n      self.client.getClassFrame(input.url, input.docUrl, opts)\r\n      .then(function(response){\r\n          var currForm = buttonSelf.parentNode;\r\n          var resultDom = UTILS.showHttpResult(response, 'getClassFrames', currForm, self.ui);\r\n      });\r\n    }) // button click\r\n    form.appendChild(button);\r\n    return form;\r\n}   */\r\n\r\n// get form for all Apis\r\nApiExplorer.prototype.getForm = function(curApi, body, view, action, urlPlaceholder){\r\n    // form\r\n    var formDoc = document.createElement('form');\r\n    formDoc.setAttribute('class', 'terminus-form-horizontal row-fluid');\r\n    var fd = document.createElement('div');\r\n    fd.setAttribute('class', 'terminus-control-group');\r\n    formDoc.appendChild(fd);\r\n    var urlLabel = document.createElement('label');\r\n    urlLabel.setAttribute('class', 'terminus-control-label');\r\n    urlLabel.setAttribute('for', 'basicinput');\r\n    urlLabel.innerHTML = 'Url:';\r\n    fd.appendChild(urlLabel);\r\n    var cd = document.createElement('div');\r\n    cd.setAttribute('class', 'terminus-controls');\r\n    fd.appendChild(cd);\r\n    var inpUrl = document.createElement('input');\r\n    inpUrl.setAttribute('type', 'text');\r\n    inpUrl.setAttribute('id', 'basicinput');\r\n    inpUrl.setAttribute('class', 'span8 terminus-input-text');\r\n    inpUrl.setAttribute('placeholder', urlPlaceholder);\r\n    cd.appendChild(inpUrl);\r\n    // add extra form fields based on current api chosen\r\n    switch(curApi){\r\n        case 'getClassFrames':\r\n            var fd = document.createElement('div');\r\n            fd.setAttribute('class', 'terminus-control-group');\r\n            formDoc.appendChild(fd);\r\n            var docUrlLabel = document.createElement('label');\r\n            docUrlLabel.setAttribute('class', 'terminus-control-label');\r\n            docUrlLabel.setAttribute('for', 'basicinput');\r\n            docUrlLabel.innerHTML = 'Url/ ID:';\r\n            fd.appendChild(docUrlLabel);\r\n            var cd = document.createElement('div');\r\n            cd.setAttribute('class', 'terminus-controls');\r\n            fd.appendChild(cd);\r\n            var inpDocUrl = document.createElement('input');\r\n            inpDocUrl.setAttribute('type', 'text');\r\n            inpDocUrl.setAttribute('id', 'basicinput');\r\n            inpDocUrl.setAttribute('class', 'span8 terminus-input-text');\r\n            inpDocUrl.setAttribute('placeholder', 'Url or ID of document class');\r\n            cd.appendChild(inpDocUrl);\r\n        break;\r\n        case 'schema':\r\n            //encoding\r\n           /* var fd = document.createElement('div');\r\n            fd.setAttribute('class', 'terminus-control-group');\r\n            formDoc.appendChild(fd);\r\n            var encLabel = document.createElement('label');\r\n            encLabel.setAttribute('class', 'terminus-control-label');\r\n            encLabel.setAttribute('for', 'basicinput');\r\n            encLabel.innerHTML = 'Encoding:';\r\n            fd.appendChild(encLabel);\r\n            var cd = document.createElement('div');\r\n            cd.setAttribute('class', 'terminus-controls');\r\n            fd.appendChild(cd);\r\n            var inpEnc = document.createElement('select');\r\n            inpEnc.setAttribute('style', 'height: 50px;width: 300px;padding: 10px;');\r\n            inpEnc.setAttribute('placeholder', 'turtle');\r\n            var optTurt = document.createElement('option');\r\n            optTurt.setAttribute('value', 'terminus:turtle');\r\n            optTurt.appendChild(document.createTextNode('turtle'));\r\n            inpEnc.appendChild(optTurt);\r\n            var optJld = document.createElement('option');\r\n            optJld.setAttribute('value', 'terminus:jsonld');\r\n            optJld.appendChild(document.createTextNode('jsonLD'));\r\n            inpEnc.appendChild(optJld);\r\n            cd.appendChild(inpEnc); */\r\n        break;\r\n    }\r\n    var fd = document.createElement('div');\r\n    fd.setAttribute('class', 'terminus-control-group');\r\n    formDoc.appendChild(fd);\r\n    var keyLabel = document.createElement('label');\r\n    keyLabel.setAttribute('class', 'terminus-control-label');\r\n    keyLabel.setAttribute('for', 'basicinput');\r\n    keyLabel.innerHTML = 'Key:';\r\n    fd.appendChild(keyLabel);\r\n    var cd = document.createElement('div');\r\n    cd.setAttribute('class', 'terminus-controls');\r\n    fd.appendChild(cd);\r\n    var inpKey = document.createElement('input');\r\n    inpKey.setAttribute('type', 'text');\r\n    inpKey.setAttribute('id', 'basicinput');\r\n    inpKey.setAttribute('class', 'span8 terminus-input-text');\r\n    inpKey.setAttribute('placeholder', 'Key');\r\n    cd.appendChild(inpKey);\r\n    if(!view){\r\n        // include text area only if call is type post\r\n        var fd = document.createElement('div');\r\n        fd.setAttribute('class', 'terminus-control-group');\r\n        formDoc.appendChild(fd);\r\n        var docLabel = document.createElement('label');\r\n        docLabel.setAttribute('class', 'terminus-control-label');\r\n        docLabel.setAttribute('for', 'basicinput');\r\n        if(curApi == 'query') docLabel.innerHTML = 'Query:';\r\n        docLabel.innerHTML = 'Document:';\r\n        fd.appendChild(docLabel);\r\n        var cd = document.createElement('div');\r\n        cd.setAttribute('class', 'terminus-controls');\r\n        fd.appendChild(cd);\r\n        var inpDoc = document.createElement('textarea');\r\n        cd.appendChild(inpDoc);\r\n        inpDoc.setAttribute('class', 'terminus-api-explorer-text-area');\r\n        UTILS.stylizeEditor(this.ui, inpDoc, 'api-doc', 'javascript');\r\n    }\r\n    body.appendChild(formDoc);\r\n    // gather inputs\r\n    var inp ={};\r\n    inp.url = inpUrl;\r\n    inp.key = inpKey;\r\n    if(curApi == 'getClassFrames') inp.docUrl = inpDocUrl;\r\n    //if(curApi == 'schema') inp.enc = inpEnc;\r\n    if(!view) inp.doc = inpDoc;\r\n    var form = this.getApiSendButton(action, inp);\r\n    body.appendChild(form);\r\n}\r\n\r\n// define event listeners on send api of schema & documents\r\n\r\nApiExplorer.prototype.getApiForm = function(action, input){\r\n  // form\r\n  var form = document.createElement('form');\r\n  form.setAttribute('class', 'terminus-form-horizontal row-fluid');\r\n\r\n  var button = document.createElement('button');\r\n  button.setAttribute('class', 'terminus-btn terminus-send-api-btn');\r\n  button.setAttribute('type', 'button');\r\n  button.innerHTML = 'Send Api';\r\n  form.appendChild(button);\r\n  var resd = document.createElement('div');\r\n  form.appendChild(resd);\r\n  var self = this;\r\n  switch(action){\r\n    case 'getSchema':\r\n      button.addEventListener(\"click\", function(){\r\n        var opts = {};\r\n        opts['terminus:encoding'] = input.enc.value;\r\n        opts['terminus:user_key'] = 'terminus:turtle';\r\n        var schurl = input.url.value;\r\n        var buttonSelf = this;\r\n        self.client.getSchema(schurl, opts)\r\n        .then(function(response){\r\n          TerminusClient.FrameHelper.removeChildren(resd);\r\n          var resultDom = UTILS.showHttpResult(response, 'getSchema', resd, self.ui);\r\n        });\r\n      }) // button click\r\n    break;\r\n    case 'updateSchema':\r\n      button.addEventListener(\"click\", function(){\r\n        var buttonSelf = this;\r\n        opts = {};\r\n        opts['terminus:encoding'] = input.enc.value;\r\n        opts['terminus:user_key'] = 'terminus:turtle';\r\n        var schurl = input.url.value;\r\n        self.client.connectionConfig.connected_mode = false;\r\n        self.client.updateSchema(schurl, input.doc.value, opts)\r\n        .then(function(response){\r\n          var gtxtar = document.createElement('textarea');\r\n          gtxtar.setAttribute('readonly', true);\r\n          gtxtar.innerHTML = response;\r\n          var currForm = buttonSelf.parentNode;\r\n          currForm.appendChild(gtxtar);\r\n          UTILS.stylizeEditor(this.ui, txtar, 'schema', 'turtle');\r\n        });\r\n      }) // button click\r\n    break;\r\n    case 'viewDocument':\r\n      button.addEventListener(\"click\", function(){\r\n      var dcurl = input.value;\r\n      var buttonSelf = this;\r\n      var opts = {};\r\n      opts.format = 'turtle';\r\n      self.client.getDocument(dcurl, opts)\r\n      .then(function(response){\r\n        TerminusClient.FrameHelper.removeChildren(resd);\r\n        var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n      });\r\n    }) // button click\r\n    break;\r\n    case 'deleteDocument':\r\n      button.addEventListener(\"click\", function(){\r\n      var dcurl = input.value;\r\n      var buttonSelf = this;\r\n      var opts = {};\r\n      self.client.deleteDocument(dcurl, opts)\r\n      .then(function(response){\r\n        TerminusClient.FrameHelper.removeChildren(resd);\r\n        var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n      });\r\n    }) // button click\r\n    break;\r\n    case 'createDocument':\r\n      button.addEventListener(\"click\", function(){\r\n        var dcurl = input.schemaUrlDom.value;\r\n        var payload = input.htmlEditor.getValue();\r\n        var buttonSelf = this;\r\n        opts = {};\r\n        self.client.createDocument(dcurl, payload, opts)\r\n        .then(function(response){\r\n          TerminusClient.FrameHelper.removeChildren(resd);\r\n          var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n        });\r\n      }) // button click\r\n    break;\r\n    case 'updateDocument':\r\n      button.addEventListener(\"click\", function(){\r\n        var dcurl = input.schemaUrlDom.value;\r\n        var payload = input.htmlEditor.getValue();\r\n        var buttonSelf = this;\r\n        opts = {};\r\n        opts.editmode = 'replace';\r\n        opts.format = 'json';\r\n        self.client.updateDocument(dcurl, payload, opts)\r\n        .then(function(response){\r\n          TerminusClient.FrameHelper.removeChildren(resd);\r\n          var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n        });\r\n      }) // button click\r\n    break;\r\n  } // switch(action)\r\n\r\n  var br = document.createElement('BR');\r\n  form.appendChild(br);\r\n  var br = document.createElement('BR');\r\n  form.appendChild(br);\r\n\r\n  return form;\r\n} // getApiForm()\r\n\r\n\r\n// define event listeners on send api of schema & documents\r\nApiExplorer.prototype.getApiSendButton = function(action, input){\r\n    // form\r\n    var form = document.createElement('form');\r\n    form.setAttribute('class', 'terminus-form-horizontal row-fluid');\r\n    var button = document.createElement('button');\r\n    button.setAttribute('class', 'terminus-btn terminus-send-api-btn');\r\n    button.setAttribute('type', 'button');\r\n    button.innerHTML = 'Send Api';\r\n    form.appendChild(button);\r\n    var resd = document.createElement('div');\r\n    form.appendChild(resd);\r\n    var self = this;\r\n    switch(action){\r\n        case 'connect':\r\n            button.addEventListener(\"click\", function(){\r\n                self.client.connect(input.url.value, input.key.value)\r\n                .then(function(response){\r\n                \tTerminusClient.FrameHelper.removeChildren(resd);\r\n                    var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n               });\r\n            }) // button click\r\n        break;\r\n        case 'create':\r\n            button.addEventListener(\"click\", function(form){\r\n              self.client.createDatabase(input.url.value, JSON.parse(input.doc.value), input.key.value)\r\n              .then(function(response){\r\n            \t  TerminusClient.FrameHelper.removeChildren(resd);\r\n                  var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n              });\r\n            }) // button click\r\n        break;\r\n        case 'delete':\r\n            button.addEventListener(\"click\", function(){\r\n              var opts ={}\r\n              self.client.deleteDatabase(input.url.value, input.key.value)\r\n              .then(function(response){\r\n            \t  TerminusClient.FrameHelper.removeChildren(resd);\r\n                  var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n              });\r\n            }) // button click\r\n        break\r\n        case 'getSchema':\r\n            button.addEventListener(\"click\", function(){\r\n                var opts = {};\r\n                opts['terminus:encoding'] = 'terminus:turtle';\r\n                opts['terminus:user_key'] = input.key.value;\r\n                var schurl = input.url.value;\r\n                self.client.getSchema(schurl, opts)\r\n                .then(function(response){\r\n                \tTerminusClient.FrameHelper.removeChildren(resd);\r\n                    var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n                });\r\n            }) // button click\r\n        break;\r\n        case 'updateSchema':\r\n            button.addEventListener(\"click\", function(){\r\n                opts = {};\r\n                opts['terminus:encoding'] = 'terminus:turtle';\r\n                opts['terminus:user_key'] = input.key.value;\r\n                var payload = input.doc.value;\r\n                var schurl = input.url.value;\r\n                self.client.connectionConfig.connected_mode = false;\r\n                self.client.updateSchema(schurl, input.doc.value, opts)\r\n                //self.client.updateSchema(schurl, input.doc.value, opts)\r\n                .then(function(response){\r\n                \tTerminusClient.FrameHelper.removeChildren(resd);\r\n                    var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n                });\r\n            }) // button click\r\n        break;\r\n        case 'getClassFrames':\r\n            button.addEventListener(\"click\", function(form){\r\n                var schurl = input.url.value;\r\n                opts = {};\r\n                opts.explorer = true;\r\n                self.client.getClassFrame(input.url, JSON.parse(input.docUrl.value), opts)\r\n                .then(function(response){\r\n                    var currForm = buttonSelf.parentNode;\r\n                    var resultDom = UTILS.showHttpResult(response, action, currForm, self.ui);\r\n                });\r\n            }) // button click\r\n        break;\r\n        case 'viewDocument':\r\n          button.addEventListener(\"click\", function(){\r\n              var dcurl = input.url.value;\r\n              var opts = {};\r\n              opts['terminus:encoding'] = \"jsonld\";\r\n              opts['terminus:user_key'] = input.key.value;\r\n              self.client.getDocument(dcurl, opts)\r\n              .then(function(response){\r\n            \t    TerminusClient.FrameHelper.removeChildren(resd);\r\n                    var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n              });\r\n        }) // button click\r\n        break;\r\n        case 'deleteDocument':\r\n          button.addEventListener(\"click\", function(){\r\n              var dcurl = input.url.value;\r\n              var opts = {};\r\n              opts.key = input.key.value;\r\n              self.client.deleteDocument(dcurl, opts)\r\n              .then(function(response){\r\n            \t  TerminusClient.FrameHelper.removeChildren(resd);\r\n                  var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n              });\r\n          }) // button click\r\n        break;\r\n        case 'createDocument':\r\n          button.addEventListener(\"click\", function(){\r\n              var dcurl = input.url.value;\r\n              var payload = input.doc.value;\r\n              opts = {};\r\n              opts['terminus:encoding'] = \"jsonld\";\r\n              opts['terminus:user_key'] = input.key.value;\r\n              self.client.createDocument(dcurl, JSON.parse(payload), opts)\r\n              .then(function(response){\r\n            \t   TerminusClient.FrameHelper.removeChildren(resd);\r\n                   var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n               });\r\n          }) // button click\r\n        break;\r\n        case 'updateDocument':\r\n          button.addEventListener(\"click\", function(){\r\n            var dcurl = input.url.value;\r\n            var payload = input.doc.value;\r\n            var buttonSelf = this;\r\n            opts = {};\r\n            opts['terminus:encoding'] = \"jsonld\";\r\n            opts['terminus:user_key'] = input.key.value;\r\n            self.client.updateDocument(dcurl, JSON.parse(payload), opts)\r\n            .then(function(response){\r\n            \tTerminusClient.FrameHelper.removeChildren(resd);\r\n                var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n            });\r\n          }) // button click\r\n        break;\r\n        case 'select':\r\n            button.addEventListener(\"click\", function(){\r\n                var opts = {};\r\n                opts.key = input.key.value;\r\n                var doc = JSON.parse(input.doc.value);\r\n                self.client.select(input.url.value, doc, opts)\r\n                .then(function(response){\r\n                \tTerminusClient.FrameHelper.removeChildren(resd);\r\n                    var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n                });\r\n            }) // button click\r\n        break;\r\n        case 'update':\r\n            button.addEventListener(\"click\", function(){\r\n              var opts = {};\r\n              opts.key = input.key.value;\r\n              var doc = JSON.parse(input.doc.value);\r\n              self.client.update(input.url.value, doc, opts)\r\n              .then(function(response){\r\n            \t  TerminusClient.FrameHelper.removeChildren(resd);\r\n                  var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n              });\r\n            }) // button click\r\n        break;\r\n        default:\r\n            console.log('Invalid Api call on button');\r\n        break;\r\n    } // switch(action)\r\n    var br = document.createElement('BR');\r\n    form.appendChild(br);\r\n    var br = document.createElement('BR');\r\n    form.appendChild(br);\r\n    return form;\r\n} // getApiSendButton()\r\n\r\n// get signature of api calls\r\nApiExplorer.prototype.getSignature = function(action){\r\n    var api = document.createElement('div');\r\n    // get header signature\r\n    var sg = document.createElement('button');\r\n    sg.appendChild(document.createTextNode('Click to read API Signature'));\r\n    sg.setAttribute('class', 'terminus-collapsible');\r\n    ic = document.createElement('i');\r\n    ic.setAttribute('class', 'terminus-cheveron-float fa fa-chevron-down');\r\n    sg.appendChild(ic);\r\n    api.appendChild(sg);\r\n    var br = document.createElement('BR');\r\n    api.appendChild(br);\r\n    var cl = document.createElement('div');\r\n    cl.setAttribute('class', 'terminus-collapsible-content content');\r\n    var sig = UTILS.getFunctionSignature(action);\r\n    var txt = document.createTextNode(sig.spec);\r\n    var pre = document.createElement('pre');\r\n    pre.setAttribute('class', 'terminus-api-signature-pre');\r\n    pre.appendChild(txt);\r\n    var txt =  document.createTextNode(sig.descr);\r\n    pre.appendChild(txt);\r\n    var br = document.createElement('BR');\r\n    pre.appendChild(br);\r\n    var br = document.createElement('BR');\r\n    pre.appendChild(br);\r\n    var txt = document.createTextNode(sig.result);\r\n    pre.appendChild(txt);\r\n    cl.appendChild(pre);\r\n    api.appendChild(cl);\r\n    var br = document.createElement('BR');\r\n    api.appendChild(br);\r\n    sg.addEventListener('click', function(){\r\n        UTILS.tolggleContent(ic, cl);\r\n    });\r\n    return api;\r\n} // getSignature()\r\n\r\n// displays signature only on click\r\nfunction tolggleSignatureContent(content){\r\n    if (content.style.display === \"block\")\r\n        content.style.display = \"none\";\r\n    else content.style.display = \"block\";\r\n}\r\n\r\nmodule.exports=ApiExplorer\r\n","\r\nconst CONST = require('./const');\r\nconst DispatchRequest = require('./dispatchRequest');\r\nconst ErrorMessage = require('./errorMessage');\r\nconst ConnectionCapabilities = require('./connectionCapabilities');\r\nconst ConnectionConfig = require('./connectionConfig');\r\nconst UTILS = require('./utils.js');\r\n\r\n/**\r\n * @file Javascript WOQL client object\r\n * @license Apache Version 2\r\n * @summary Simple Javascript Client for accessing the Terminus DB API\r\n */\r\n\r\n/**\r\n  * @param {Object} params\r\n  */\r\nfunction WOQLClient(params) {\r\n\t// current connection context variables\r\n\tconst key = params ? params.key : undefined;\r\n\tthis.use_fetch = false;\r\n\tthis.return_full_response = false;\r\n\tthis.connectionConfig = new ConnectionConfig(params);\r\n\tthis.connection = new ConnectionCapabilities(this.connectionConfig, key);\r\n}\r\n\r\nWOQLClient.CONST = CONST;\r\n\r\n/**\r\n * Connect to a Terminus server at the given URI with an API key\r\n * Stores the terminus:ServerCapability document returned\r\n * in the connection register which stores, the url, key, capabilities,\r\n * and database meta-data for the connected server\r\n *\r\n * If the curl argument is false or null,\r\n * this.connectionConfig.server will be used if present,\r\n * or the promise will be rejected.\r\n\r\n * @param  {string} curl Terminus server URI\r\n * @param  {string} API  key\r\n * @return {Promise}\r\n * @public\r\n */\r\nWOQLClient.prototype.connect = function (curl, key) {\r\n\tif (curl && !this.connectionConfig.setServer(curl)) {\r\n\t\treturn Promise.reject(\r\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(curl, CONST.CONNECT))\r\n\t\t);\r\n\t}\r\n\tconst serverURL = this.connectionConfig.serverURL();\r\n\tif (key) {\r\n\t\tthis.connection.setClientKey(serverURL, key);\r\n\t}\r\n\t// unset the current server setting until successful connect\r\n\tthis.connectionConfig.server = false;\r\n\tconst self = this;\r\n\treturn this.dispatch(serverURL, CONST.CONNECT).then((response) => {\r\n\t\tself.connectionConfig.server = serverURL;\r\n\t\tself.connection.addConnection(serverURL, response);\r\n\t\treturn response;\r\n\t});\r\n};\r\n\r\n/**\r\n * Create a Terminus Database by posting\r\n * a terminus:Database document to the Terminus API\r\n *\r\n * The dburl argument can be\r\n *    1) a valid URL of a terminus database or\r\n *    2) a valid Terminus database id or\r\n *    3) can be omitted\r\n * \t\tin case 2) the current server will be used,\r\n * \t\tin case 3) the database id will be set from the @id field of the terminuse:Database document.\r\n *\r\n * The second (details) argument contains a terminus:Database document\r\n * with a mandatory rdfs:label field and an optional rdfs:comment field.\r\n * The third (key) argument contains an optional API key\r\n *\r\n * @param {string} dburl Terminus server URI or a TerminusID\r\n * @param {object} details\r\n * @param {string} key\r\n * @return {Promise}\r\n * @public\r\n */\r\nWOQLClient.prototype.createDatabase = function (dburl, details, key) {\r\n\tif (dburl && !this.connectionConfig.setDB(dburl)) {\r\n\t\treturn Promise.reject(\r\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(dburl, 'Create Database'))\r\n\t\t);\r\n\t}\r\n\tif (\r\n\t\tdetails\r\n    && details['@id']\r\n    && !this.connectionConfig.setDB(details['@id'], details['@context'])\r\n\t) {\r\n\t\treturn Promise.reject(\r\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(details['@id'], 'Create Database'))\r\n\t\t);\r\n\t}\r\n\tdetails = this.makeDocumentConsistentWithURL(details, this.connectionConfig.dbURL());\r\n\r\n\tconst opts = {};\r\n\tif (key) {\r\n\t\topts.key = key;\r\n\t}\r\n\tconst doc = this.addOptionsToDocument(details, opts);\r\n\treturn this.dispatch(this.connectionConfig.dbURL('create'), CONST.CREATE_DATABASE, doc);\r\n};\r\n\r\n/**\r\n * Delete a Database\r\n * @param {String} dburl it is a terminusDB Url or a terminusDB Id\r\n * @param {String} key an optional API key\r\n * @return {Promise}\r\n *\r\n * if dburl is omitted, the current server and database will be used\r\n */\r\nWOQLClient.prototype.deleteDatabase = function (dburl, key) {\r\n\tif (dburl && !this.connectionConfig.setDB(dburl)) {\r\n\t\treturn Promise.reject(\r\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(dburl, 'Delete Database'))\r\n\t\t);\r\n\t}\r\n\tconst opts = {};\r\n\r\n\tif (key) {\r\n\t\topts.key = key;\r\n\t}\r\n\r\n\tconst self = this;\r\n\treturn this.dispatch(`${this.connectionConfig.dbURL()}`, CONST.DELETE_DATABASE, opts).then(\r\n\t\t(response) => {\r\n\t\t\tself.connection.removeDB();\r\n\t\t\treturn response;\r\n\t\t}\r\n\t);\r\n};\r\n\r\n/**\r\n * Retrieves the schema of the specified database\r\n *\r\n * @param {string} schurl TerminusDB server URL or a valid TerminusDB Id or omitted\r\n * @param {object} opts is an options object\r\n * @return {Promise}\r\n *\r\n * opts.format is optional and defines which format is requested (*json / turtle)\r\n * opts.key is an optional API key\r\n */\r\nWOQLClient.prototype.getSchema = function (schurl, opts) {\r\n\tif (schurl && !this.connectionConfig.setSchemaURL(schurl)) {\r\n\t\treturn Promise.reject(\r\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(schurl, 'Get Schema'))\r\n\t\t);\r\n\t}\r\n\t// consoleco.log('schemaURL', this.connectionConfig.schemaURL());\r\n\treturn this.dispatch(this.connectionConfig.schemaURL(), CONST.GET_SCHEMA, opts);\r\n};\r\n\r\n/**\r\n * Updates the Schema of the specified database\r\n *\r\n * @param {string} schurl TerminusDB server URL or a valid TerminusDB Id or omitted\r\n * @param {object} doc is a valid owl ontology in json-ld or turtle format\r\n * @param {object} opts is an options object\r\n * @return {Promise}\r\n *\r\n * if omitted the current server and database will be used\r\n * opts.format is used to specify which format is being used (*json / turtle)\r\n * opts.key is an optional API key\r\n */\r\nWOQLClient.prototype.updateSchema = function (schurl, doc, opts) {\r\n\tif (schurl && !this.connectionConfig.setSchemaURL(schurl)) {\r\n\t\treturn Promise.reject(\r\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(schurl, 'Update Schema'))\r\n\t\t);\r\n\t}\r\n\tdoc = this.addOptionsToDocument(doc, opts);\r\n\treturn this.dispatch(this.connectionConfig.schemaURL(), 'update_schema', doc);\r\n};\r\n\r\n/**\r\n * Creates a new document in the specified database\r\n *\r\n * The first (docurl) argument can be\r\n * 1) a valid URL of a terminus database (an id will be randomly assigned) or\r\n * 2) a valid URL or of a terminus document (the document will be given the passed URL) or\r\n * 3) a valid terminus document id (the current server and database will be used)\r\n * 4) can be omitted (the URL will be taken from the document if present)\r\n * The second argument (doc) is a valid document in json-ld\r\n * the third argument (opts) is an options json - opts.key is an optional API key\r\n */\r\nWOQLClient.prototype.createDocument = function (docurl, doc, opts) {\r\n\tif (docurl && !this.connectionConfig.setDocument(docurl)) {\r\n\t\treturn Promise.reject(\r\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(docurl, 'Create Document'))\r\n\t\t);\r\n\t} if (\r\n\t\tdoc\r\n    && doc['@id']\r\n    && !this.connectionConfig.setDocument(doc['@id'], doc['@context'])\r\n\t) {\r\n\t\treturn Promise.reject(\r\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(doc['@id'], 'Create Document'))\r\n\t\t);\r\n\t}\r\n\tdoc = this.addOptionsToDocument(\r\n\t\tthis.makeDocumentConsistentWithURL(doc, this.connectionConfig.docURL()),\r\n\t\topts\r\n\t);\r\n\treturn this.dispatch(this.connectionConfig.docURL(), 'create_document', doc);\r\n};\r\n\r\n/**\r\n * Retrieves a document from the specified database\r\n *\r\n * The first (docurl) argument can be\r\n * 1) a valid URL of a terminus document or\r\n * 2) a valid ID of a terminus document in the current database\r\n * the second argument (opts) is an options json -\r\n * \t\topts.key is an optional API key\r\n * \t\topts.shape is frame | *document\r\n */\r\nWOQLClient.prototype.getDocument = function (docurl, opts) {\r\n\tif (docurl && (!this.connectionConfig.setDocument(docurl) || !this.connectionConfig.docid)) {\r\n\t\treturn Promise.reject(\r\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(docurl, 'Get Document'))\r\n\t\t);\r\n\t}\r\n\treturn this.dispatch(this.connectionConfig.docURL(), 'get_document', opts);\r\n};\r\n\r\n/**\r\n * Updates a document in the specified database with a new version\r\n *\r\n * The first (docurl) argument can be\r\n * 1) a valid URL of a terminus document or\r\n * 2) a valid ID of a terminus document in the current database or\r\n * 3) omitted in which case the id will be taken from the document @id field\r\n * the second argument (doc) is a document in json-ld format\r\n * the third argument (opts) is an options json - opts.key is an optional API key\r\n */\r\nWOQLClient.prototype.updateDocument = function (docurl, doc, opts) {\r\n\tif (docurl && !this.connectionConfig.setDocument(docurl)) {\r\n\t\treturn Promise.reject(\r\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(docurl, 'Update Document'))\r\n\t\t);\r\n\t}\r\n\tif (doc && doc['@id']\r\n    && !this.connectionConfig.setDocument(doc['@id'], doc['@context'])\r\n\t) {\r\n\t\treturn Promise.reject(\r\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(doc['@id'], 'Update Document'))\r\n\t\t);\r\n\t}\r\n\tdoc = this.addOptionsToDocument(\r\n\t\tthis.makeDocumentConsistentWithURL(doc, this.connectionConfig.docURL()),\r\n\t\topts\r\n\t);\r\n\treturn this.dispatch(this.connectionConfig.docURL(), 'update_document', doc);\r\n};\r\n\r\n/**\r\n * Deletes a document from the specified database\r\n *\r\n * The first (docurl) argument can be\r\n * 1) a valid URL of a terminus document or\r\n * 2) a valid ID of a terminus document in the current database\r\n * 3) omitted - the current document will be used\r\n * the second argument (opts) is an options json - opts.key is an optional API key\r\n */\r\nWOQLClient.prototype.deleteDocument = function (docurl, opts) {\r\n\tif (docurl && (!this.connectionConfig.setDocument(docurl) || !this.connectionConfig.docid)) {\r\n\t\treturn Promise.reject(\r\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(docurl, 'Delete Document'))\r\n\t\t);\r\n\t}\r\n\treturn this.dispatch(this.connectionConfig.docURL(), 'delete_document', opts);\r\n};\r\n\r\n/**\r\n * Executes a read-only WOQL query on the specified database and returns the results\r\n *\r\n * @param {string} qurl TerminusDB server URL or omitted (the current DB will be used)\r\n * @param {string} woql is a \"woql query select statement\"\r\n * @param {object} opts it can contents the API key (opts.key)\r\n *\r\n */\r\nWOQLClient.prototype.select = function (qurl, woql, opts) {\r\n\tif (qurl && !this.connectionConfig.setQueryURL(qurl)) {\r\n\t\treturn Promise.reject(\r\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(qurl, 'Select'))\r\n\t\t);\r\n\t}\r\n\tlet q = { 'terminus:query': JSON.stringify(woql) };\r\n\tq = this.addOptionsToWOQL(q, opts);\r\n\treturn this.dispatch(this.connectionConfig.queryURL(), CONST.WOQL_SELECT, q);\r\n};\r\n\r\n/**\r\n * Executes a WOQL query on the specified database which updates the state and returns the results\r\n *\r\n * The first (qurl) argument can be\r\n * 1) a valid URL of a terminus database or\r\n * 2) omitted - the current database will be used\r\n * the second argument (woql) is a woql select statement encoded as a string\r\n * the third argument (opts) is an options json - opts.key is an optional API key\r\n */\r\nWOQLClient.prototype.update = function (qurl, woql, opts) {\r\n\tif (qurl && !this.connectionConfig.setQueryURL(qurl)) {\r\n\t\treturn Promise.reject(\r\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(qurl, 'Update'))\r\n\t\t);\r\n\t}\r\n\twoql = this.addOptionsToWOQL(woql, opts);\r\n\treturn this.dispatch(this.connectionConfig.queryURL(), 'woql_update', woql);\r\n};\r\n\r\n/**\r\n * Retrieves a WOQL query on the specified database which updates the state and returns the results\r\n *\r\n * The first (cfurl) argument can be\r\n * 1) a valid URL of a terminus database or\r\n * 2) omitted - the current database will be used\r\n * the second argument (cls) is the URL / ID of a document class that exists in the database schema\r\n * the third argument (opts) is an options json - opts.key is an optional API key\r\n */\r\nWOQLClient.prototype.getClassFrame = function (cfurl, cls, opts) {\r\n\tif (cfurl && !this.connectionConfig.setClassFrameURL(cfurl)) {\r\n\t\treturn Promise.reject(\r\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(cfurl, 'Get Class Frame'))\r\n\t\t);\r\n\t}\r\n\tif (!opts) opts = {};\r\n\topts['terminus:class'] = cls;\r\n\treturn this.dispatch(this.connectionConfig.frameURL(), 'class_frame', opts);\r\n};\r\n\r\n/*\r\n * Utility functions for adding standard fields to API arguments\r\n */\r\nWOQLClient.prototype.addOptionsToWOQL = function (woql, opts) {\r\n\tif (opts && opts.key) {\r\n\t\twoql.key = opts.key;\r\n\t}\r\n\treturn woql;\r\n};\r\n\r\nWOQLClient.prototype.addOptionsToDocument = function (doc, opts) {\r\n\tconst pdoc = {};\r\n\tpdoc['@context'] = doc['@context'];\r\n\tif (pdoc['@context'] && doc['@id']) { // add blank node prefix as document base url\r\n\t\tpdoc['@context']._ = `${doc['@id']}/`;\r\n\t}\r\n\tif (opts && opts['terminus:encoding'] && opts['terminus:encoding'] === 'terminus:turtle') {\r\n\t\tpdoc['terminus:turtle'] = doc;\r\n\t\tpdoc['terminus:schema'] = this.connectionConfig.schemaURL();\r\n\t\tdelete pdoc['terminus:turtle']['@context'];\r\n\t} else {\r\n\t\tpdoc['terminus:document'] = doc;\r\n\t\tdelete pdoc['terminus:document']['@context'];\r\n\t}\r\n\tpdoc['@type'] = 'terminus:APIUpdate';\r\n\tif (opts && opts['terminus:user_key']) {\r\n\t\tpdoc['terminus:user_key'] = opts['terminus:user_key'];\r\n\t}\r\n\tif (opts && opts.key) {\r\n\t\tpdoc['terminus:user_key'] = opts.key;\r\n\t}\r\n\treturn pdoc;\r\n};\r\n\r\nWOQLClient.prototype.addKeyToPayload = function (payload, url) {\r\n\tif (typeof payload !== 'object')payload = {};\r\n\tif (payload.key) {\r\n\t\tpayload['terminus:user_key'] = payload.key;\r\n\t\tdelete payload.key;\r\n\t} else if (this.connection.getClientKey()) {\r\n\t\tpayload['terminus:user_key'] = this.connection.getClientKey();\r\n\t} else if (this.connection.getClientKey(url)) {\r\n\t\tpayload['terminus:user_key'] = this.connection.getClientKey(url);\r\n\t}\r\n\treturn payload;\r\n};\r\n\r\nWOQLClient.prototype.makeDocumentConsistentWithURL = function (doc, dburl) {\r\n\tdoc['@id'] = dburl;\r\n\treturn doc;\r\n};\r\n\r\nWOQLClient.prototype.dispatch = function (url, action, payload) {\r\n\tif (this.connectionConfig.includeKey()) {\r\n\t\tpayload = this.addKeyToPayload(payload, url);\r\n\t}\r\n\tif (this.use_fetch) {\r\n\t\treturn this.dispatchFetch(url, action, payload);\r\n\t}\r\n\treturn DispatchRequest(url, action, payload);\r\n};\r\n\r\n\r\nWOQLClient.prototype.dispatchFetch = function (url, action, payload) {\r\n\tconst api = {\r\n\t\tmode: 'cors', // no-cors, cors, *same-origin\r\n\t\tredirect: 'follow', // manual, *follow, error\r\n\t\treferrer: 'client', // no-referrer, *client\r\n\t};\r\n\tlet hdrs = {};\r\n\tif (this.connectionConfig.platformEndpoint()) {\r\n\t\tapi.credentials = 'include'; // include, *same-origin, omit\r\n\t}\r\n\tif (payload && payload['terminus:user_key']) {\r\n\t\thdrs = { Authorization: `Basic ${btoa(`:${payload['terminus:user_key']}`)}` };\r\n\t\tdelete (payload['terminus:user_key']);\r\n\t}\r\n\t// read only API calls - use GET\r\n\tswitch (action) {\r\n\tcase CONST.DELETE_DATABASE:\r\n\tcase CONST.DELETE_DOCUMENT:\r\n\t\tif (Object.keys(payload).length > 0) url += `?${UTILS.URIEncodePayload(payload)}`;\r\n\t\tapi.method = 'DELETE';\r\n\t\tapi.cache = 'no-cache';\r\n\t\tbreak;\r\n\tcase CONST.CREATE_DATABASE:\r\n\tcase CONST.UPDATE_SCHEMA:\r\n\tcase CONST.CREATE_DOCUMENT:\r\n\tcase CONST.UPDATE_DOCUMENT:\r\n\tcase CONST.WOQL_UPDATE:\r\n\t\tapi.method = 'POST';\r\n\t\tapi.cache = 'no-cache';\r\n\t\thdrs['Content-Type'] = 'application/json';\r\n\t\tapi.body = JSON.stringify(payload);\r\n\t\tbreak;\r\n\tcase CONST.GET_SCHEMA:\r\n\tcase CONST.CONNECT:\r\n\tcase CONST.CLASS_FRAME:\r\n\tcase CONST.WOQL_SELECT:\r\n\tcase CONST.GET_DOCUMENT:\r\n\tdefault:\r\n\t\tapi.method = 'GET';\r\n\t\tif (Object.keys(payload).length > 0) url += `?${UTILS.URIEncodePayload(payload)}`;\r\n\t}\r\n\tconst self = this;\r\n\tif (Object.keys(hdrs).length > 0) {\r\n\t\tapi.headers = new Headers(hdrs);\r\n\t}\r\n\treturn fetch(url, api).then((response) => {\r\n\t\tif (self.return_full_response) return response;\r\n\t\tif (response.ok) {\r\n\t\t\treturn response.json();\r\n\t\t}\r\n\t\tself.error = self.parseAPIError(response);\r\n\t\treturn Promise.reject(new Error(self.getAPIErrorMessage(url, api, self.error)));\r\n\t});\r\n};\r\n\r\nmodule.exports = WOQLClient;\r\n","const axios = require('axios');\r\nconst UTILS = require('./utils.js');\r\nconst CONST = require('./const.js');\r\nconst ErrorMessage = require('./errorMessage');\r\n/*\r\nAccess-Control-Allow-Credentials   true\r\nAccess-Control-Allow-Headers  X-PINGOTHER, Content-Type\r\nAccess-Control-Allow-Methods GET, POST, PUT, PATCH, DELETE, HEAD, OPTIONS\r\nAccess-Control-Allow-Origin: http://localhost:3000 // WILD CARD WILL NOT WORK WHEN POSTING\r\n*/\r\n\r\nfunction btoaImplementation(str) {\r\n\ttry {\r\n\t\treturn btoa(str);\r\n\t} catch (err) {\r\n\t\t// console.log('in buffer')\r\n\t\treturn Buffer.from(str).toString('base64');\r\n\t}\r\n}\r\n\r\nfunction DispatchRequest(url, action, payload) {\r\n\t/*\r\n\t*CORS is only required when trying to fetch data from a browser, \r\n\t*as browsers by default will block requests to different origins \r\n\t*/\r\n\tconst options = {\r\n\t\tmode: 'cors', // no-cors, cors, *same-origin\r\n\t\tredirect: 'follow', // manual, *follow, error\r\n\t\treferrer: 'client',\r\n\t\t// url:url,\r\n\t\t// no-referrer, *client\r\n\t};\r\n\tif (payload && payload['terminus:user_key']) {\r\n\t\toptions.headers = { Authorization: `Basic ${btoaImplementation(`:${payload['terminus:user_key']}`)}` };\r\n\t\tdelete (payload['terminus:user_key']);\r\n\t}\r\n\r\n\tswitch (action) {\r\n\tcase CONST.DELETE_DATABASE:\r\n\tcase CONST.DELETE_DOCUMENT:\r\n\t\tif (payload) {\r\n\t\t\tconst ext = UTILS.URIEncodePayload(payload);\r\n\t\t\tif (ext) url += `?${ext}`;\r\n\t\t}\r\n\t\treturn axios.delete(url, options)\r\n\t\t\t.then(response => response.data)\r\n\t\t\t.catch((err) => {\r\n\t\t\t\tthrow new Error(ErrorMessage.getAPIErrorMessage(url, options, err));\r\n\t\t\t});\r\n\tcase CONST.CREATE_DATABASE:\r\n\tcase CONST.UPDATE_SCHEMA:\r\n\tcase CONST.CREATE_DOCUMENT:\r\n\tcase CONST.UPDATE_DOCUMENT:\r\n\tcase CONST.WOQL_UPDATE:\r\n\t\toptions.headers = options.headers ? options.headers : {};\r\n\t\toptions.headers['Content-Type'] = 'application/json';\r\n\t\treturn axios.post(url, JSON.stringify(payload), options)\r\n\t\t\t.then(response => response.data)\r\n\t\t\t.catch((err) => {\r\n\t\t\t\tconst e = new Error(ErrorMessage.getAPIErrorMessage(url, options, err));\r\n\t\t\t\tif (err.response && err.response.data) e.data = err.response.data;\r\n\t\t\t\tthrow e;\r\n\t\t\t});\r\n\tcase CONST.GET_SCHEMA:\r\n\tcase CONST.CONNECT:\r\n\tcase CONST.CLASS_FRAME:\r\n\tcase CONST.WOQL_SELECT:\r\n\tcase CONST.GET_DOCUMENT:\r\n\tdefault:\r\n\t\tif (payload) {\r\n\t\t\tconst ext = UTILS.URIEncodePayload(payload);\r\n\t\t\tif (ext) url += `?${ext}`;\r\n\t\t}\r\n\t\treturn axios.get(url, options)\r\n\t\t\t.then((response => response.data))\r\n\t\t\t.catch((err) => {\r\n\t\t\t\tthrow new Error(ErrorMessage.getAPIErrorMessage(url, options, err));\r\n\t\t\t});\r\n\t}\r\n}\r\n\r\nmodule.exports = DispatchRequest;\r\n","/*!\n * The buffer module from node.js, for the browser.\n *\n * @author   Feross Aboukhadijeh <http://feross.org>\n * @license  MIT\n */\n/* eslint-disable no-proto */\n\n'use strict'\n\nvar base64 = require('base64-js')\nvar ieee754 = require('ieee754')\nvar isArray = require('isarray')\n\nexports.Buffer = Buffer\nexports.SlowBuffer = SlowBuffer\nexports.INSPECT_MAX_BYTES = 50\n\n/**\n * If `Buffer.TYPED_ARRAY_SUPPORT`:\n *   === true    Use Uint8Array implementation (fastest)\n *   === false   Use Object implementation (most compatible, even IE6)\n *\n * Browsers that support typed arrays are IE 10+, Firefox 4+, Chrome 7+, Safari 5.1+,\n * Opera 11.6+, iOS 4.2+.\n *\n * Due to various browser bugs, sometimes the Object implementation will be used even\n * when the browser supports typed arrays.\n *\n * Note:\n *\n *   - Firefox 4-29 lacks support for adding new properties to `Uint8Array` instances,\n *     See: https://bugzilla.mozilla.org/show_bug.cgi?id=695438.\n *\n *   - Chrome 9-10 is missing the `TypedArray.prototype.subarray` function.\n *\n *   - IE10 has a broken `TypedArray.prototype.subarray` function which returns arrays of\n *     incorrect length in some situations.\n\n * We detect these buggy browsers and set `Buffer.TYPED_ARRAY_SUPPORT` to `false` so they\n * get the Object implementation, which is slower but behaves correctly.\n */\nBuffer.TYPED_ARRAY_SUPPORT = global.TYPED_ARRAY_SUPPORT !== undefined\n  ? global.TYPED_ARRAY_SUPPORT\n  : typedArraySupport()\n\n/*\n * Export kMaxLength after typed array support is determined.\n */\nexports.kMaxLength = kMaxLength()\n\nfunction typedArraySupport () {\n  try {\n    var arr = new Uint8Array(1)\n    arr.__proto__ = {__proto__: Uint8Array.prototype, foo: function () { return 42 }}\n    return arr.foo() === 42 && // typed array instances can be augmented\n        typeof arr.subarray === 'function' && // chrome 9-10 lack `subarray`\n        arr.subarray(1, 1).byteLength === 0 // ie10 has broken `subarray`\n  } catch (e) {\n    return false\n  }\n}\n\nfunction kMaxLength () {\n  return Buffer.TYPED_ARRAY_SUPPORT\n    ? 0x7fffffff\n    : 0x3fffffff\n}\n\nfunction createBuffer (that, length) {\n  if (kMaxLength() < length) {\n    throw new RangeError('Invalid typed array length')\n  }\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    // Return an augmented `Uint8Array` instance, for best performance\n    that = new Uint8Array(length)\n    that.__proto__ = Buffer.prototype\n  } else {\n    // Fallback: Return an object instance of the Buffer class\n    if (that === null) {\n      that = new Buffer(length)\n    }\n    that.length = length\n  }\n\n  return that\n}\n\n/**\n * The Buffer constructor returns instances of `Uint8Array` that have their\n * prototype changed to `Buffer.prototype`. Furthermore, `Buffer` is a subclass of\n * `Uint8Array`, so the returned instances will have all the node `Buffer` methods\n * and the `Uint8Array` methods. Square bracket notation works as expected -- it\n * returns a single octet.\n *\n * The `Uint8Array` prototype remains unmodified.\n */\n\nfunction Buffer (arg, encodingOrOffset, length) {\n  if (!Buffer.TYPED_ARRAY_SUPPORT && !(this instanceof Buffer)) {\n    return new Buffer(arg, encodingOrOffset, length)\n  }\n\n  // Common case.\n  if (typeof arg === 'number') {\n    if (typeof encodingOrOffset === 'string') {\n      throw new Error(\n        'If encoding is specified then the first argument must be a string'\n      )\n    }\n    return allocUnsafe(this, arg)\n  }\n  return from(this, arg, encodingOrOffset, length)\n}\n\nBuffer.poolSize = 8192 // not used by this implementation\n\n// TODO: Legacy, not needed anymore. Remove in next major version.\nBuffer._augment = function (arr) {\n  arr.__proto__ = Buffer.prototype\n  return arr\n}\n\nfunction from (that, value, encodingOrOffset, length) {\n  if (typeof value === 'number') {\n    throw new TypeError('\"value\" argument must not be a number')\n  }\n\n  if (typeof ArrayBuffer !== 'undefined' && value instanceof ArrayBuffer) {\n    return fromArrayBuffer(that, value, encodingOrOffset, length)\n  }\n\n  if (typeof value === 'string') {\n    return fromString(that, value, encodingOrOffset)\n  }\n\n  return fromObject(that, value)\n}\n\n/**\n * Functionally equivalent to Buffer(arg, encoding) but throws a TypeError\n * if value is a number.\n * Buffer.from(str[, encoding])\n * Buffer.from(array)\n * Buffer.from(buffer)\n * Buffer.from(arrayBuffer[, byteOffset[, length]])\n **/\nBuffer.from = function (value, encodingOrOffset, length) {\n  return from(null, value, encodingOrOffset, length)\n}\n\nif (Buffer.TYPED_ARRAY_SUPPORT) {\n  Buffer.prototype.__proto__ = Uint8Array.prototype\n  Buffer.__proto__ = Uint8Array\n  if (typeof Symbol !== 'undefined' && Symbol.species &&\n      Buffer[Symbol.species] === Buffer) {\n    // Fix subarray() in ES2016. See: https://github.com/feross/buffer/pull/97\n    Object.defineProperty(Buffer, Symbol.species, {\n      value: null,\n      configurable: true\n    })\n  }\n}\n\nfunction assertSize (size) {\n  if (typeof size !== 'number') {\n    throw new TypeError('\"size\" argument must be a number')\n  } else if (size < 0) {\n    throw new RangeError('\"size\" argument must not be negative')\n  }\n}\n\nfunction alloc (that, size, fill, encoding) {\n  assertSize(size)\n  if (size <= 0) {\n    return createBuffer(that, size)\n  }\n  if (fill !== undefined) {\n    // Only pay attention to encoding if it's a string. This\n    // prevents accidentally sending in a number that would\n    // be interpretted as a start offset.\n    return typeof encoding === 'string'\n      ? createBuffer(that, size).fill(fill, encoding)\n      : createBuffer(that, size).fill(fill)\n  }\n  return createBuffer(that, size)\n}\n\n/**\n * Creates a new filled Buffer instance.\n * alloc(size[, fill[, encoding]])\n **/\nBuffer.alloc = function (size, fill, encoding) {\n  return alloc(null, size, fill, encoding)\n}\n\nfunction allocUnsafe (that, size) {\n  assertSize(size)\n  that = createBuffer(that, size < 0 ? 0 : checked(size) | 0)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) {\n    for (var i = 0; i < size; ++i) {\n      that[i] = 0\n    }\n  }\n  return that\n}\n\n/**\n * Equivalent to Buffer(num), by default creates a non-zero-filled Buffer instance.\n * */\nBuffer.allocUnsafe = function (size) {\n  return allocUnsafe(null, size)\n}\n/**\n * Equivalent to SlowBuffer(num), by default creates a non-zero-filled Buffer instance.\n */\nBuffer.allocUnsafeSlow = function (size) {\n  return allocUnsafe(null, size)\n}\n\nfunction fromString (that, string, encoding) {\n  if (typeof encoding !== 'string' || encoding === '') {\n    encoding = 'utf8'\n  }\n\n  if (!Buffer.isEncoding(encoding)) {\n    throw new TypeError('\"encoding\" must be a valid string encoding')\n  }\n\n  var length = byteLength(string, encoding) | 0\n  that = createBuffer(that, length)\n\n  var actual = that.write(string, encoding)\n\n  if (actual !== length) {\n    // Writing a hex string, for example, that contains invalid characters will\n    // cause everything after the first invalid character to be ignored. (e.g.\n    // 'abxxcd' will be treated as 'ab')\n    that = that.slice(0, actual)\n  }\n\n  return that\n}\n\nfunction fromArrayLike (that, array) {\n  var length = array.length < 0 ? 0 : checked(array.length) | 0\n  that = createBuffer(that, length)\n  for (var i = 0; i < length; i += 1) {\n    that[i] = array[i] & 255\n  }\n  return that\n}\n\nfunction fromArrayBuffer (that, array, byteOffset, length) {\n  array.byteLength // this throws if `array` is not a valid ArrayBuffer\n\n  if (byteOffset < 0 || array.byteLength < byteOffset) {\n    throw new RangeError('\\'offset\\' is out of bounds')\n  }\n\n  if (array.byteLength < byteOffset + (length || 0)) {\n    throw new RangeError('\\'length\\' is out of bounds')\n  }\n\n  if (byteOffset === undefined && length === undefined) {\n    array = new Uint8Array(array)\n  } else if (length === undefined) {\n    array = new Uint8Array(array, byteOffset)\n  } else {\n    array = new Uint8Array(array, byteOffset, length)\n  }\n\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    // Return an augmented `Uint8Array` instance, for best performance\n    that = array\n    that.__proto__ = Buffer.prototype\n  } else {\n    // Fallback: Return an object instance of the Buffer class\n    that = fromArrayLike(that, array)\n  }\n  return that\n}\n\nfunction fromObject (that, obj) {\n  if (Buffer.isBuffer(obj)) {\n    var len = checked(obj.length) | 0\n    that = createBuffer(that, len)\n\n    if (that.length === 0) {\n      return that\n    }\n\n    obj.copy(that, 0, 0, len)\n    return that\n  }\n\n  if (obj) {\n    if ((typeof ArrayBuffer !== 'undefined' &&\n        obj.buffer instanceof ArrayBuffer) || 'length' in obj) {\n      if (typeof obj.length !== 'number' || isnan(obj.length)) {\n        return createBuffer(that, 0)\n      }\n      return fromArrayLike(that, obj)\n    }\n\n    if (obj.type === 'Buffer' && isArray(obj.data)) {\n      return fromArrayLike(that, obj.data)\n    }\n  }\n\n  throw new TypeError('First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.')\n}\n\nfunction checked (length) {\n  // Note: cannot use `length < kMaxLength()` here because that fails when\n  // length is NaN (which is otherwise coerced to zero.)\n  if (length >= kMaxLength()) {\n    throw new RangeError('Attempt to allocate Buffer larger than maximum ' +\n                         'size: 0x' + kMaxLength().toString(16) + ' bytes')\n  }\n  return length | 0\n}\n\nfunction SlowBuffer (length) {\n  if (+length != length) { // eslint-disable-line eqeqeq\n    length = 0\n  }\n  return Buffer.alloc(+length)\n}\n\nBuffer.isBuffer = function isBuffer (b) {\n  return !!(b != null && b._isBuffer)\n}\n\nBuffer.compare = function compare (a, b) {\n  if (!Buffer.isBuffer(a) || !Buffer.isBuffer(b)) {\n    throw new TypeError('Arguments must be Buffers')\n  }\n\n  if (a === b) return 0\n\n  var x = a.length\n  var y = b.length\n\n  for (var i = 0, len = Math.min(x, y); i < len; ++i) {\n    if (a[i] !== b[i]) {\n      x = a[i]\n      y = b[i]\n      break\n    }\n  }\n\n  if (x < y) return -1\n  if (y < x) return 1\n  return 0\n}\n\nBuffer.isEncoding = function isEncoding (encoding) {\n  switch (String(encoding).toLowerCase()) {\n    case 'hex':\n    case 'utf8':\n    case 'utf-8':\n    case 'ascii':\n    case 'latin1':\n    case 'binary':\n    case 'base64':\n    case 'ucs2':\n    case 'ucs-2':\n    case 'utf16le':\n    case 'utf-16le':\n      return true\n    default:\n      return false\n  }\n}\n\nBuffer.concat = function concat (list, length) {\n  if (!isArray(list)) {\n    throw new TypeError('\"list\" argument must be an Array of Buffers')\n  }\n\n  if (list.length === 0) {\n    return Buffer.alloc(0)\n  }\n\n  var i\n  if (length === undefined) {\n    length = 0\n    for (i = 0; i < list.length; ++i) {\n      length += list[i].length\n    }\n  }\n\n  var buffer = Buffer.allocUnsafe(length)\n  var pos = 0\n  for (i = 0; i < list.length; ++i) {\n    var buf = list[i]\n    if (!Buffer.isBuffer(buf)) {\n      throw new TypeError('\"list\" argument must be an Array of Buffers')\n    }\n    buf.copy(buffer, pos)\n    pos += buf.length\n  }\n  return buffer\n}\n\nfunction byteLength (string, encoding) {\n  if (Buffer.isBuffer(string)) {\n    return string.length\n  }\n  if (typeof ArrayBuffer !== 'undefined' && typeof ArrayBuffer.isView === 'function' &&\n      (ArrayBuffer.isView(string) || string instanceof ArrayBuffer)) {\n    return string.byteLength\n  }\n  if (typeof string !== 'string') {\n    string = '' + string\n  }\n\n  var len = string.length\n  if (len === 0) return 0\n\n  // Use a for loop to avoid recursion\n  var loweredCase = false\n  for (;;) {\n    switch (encoding) {\n      case 'ascii':\n      case 'latin1':\n      case 'binary':\n        return len\n      case 'utf8':\n      case 'utf-8':\n      case undefined:\n        return utf8ToBytes(string).length\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return len * 2\n      case 'hex':\n        return len >>> 1\n      case 'base64':\n        return base64ToBytes(string).length\n      default:\n        if (loweredCase) return utf8ToBytes(string).length // assume utf8\n        encoding = ('' + encoding).toLowerCase()\n        loweredCase = true\n    }\n  }\n}\nBuffer.byteLength = byteLength\n\nfunction slowToString (encoding, start, end) {\n  var loweredCase = false\n\n  // No need to verify that \"this.length <= MAX_UINT32\" since it's a read-only\n  // property of a typed array.\n\n  // This behaves neither like String nor Uint8Array in that we set start/end\n  // to their upper/lower bounds if the value passed is out of range.\n  // undefined is handled specially as per ECMA-262 6th Edition,\n  // Section 13.3.3.7 Runtime Semantics: KeyedBindingInitialization.\n  if (start === undefined || start < 0) {\n    start = 0\n  }\n  // Return early if start > this.length. Done here to prevent potential uint32\n  // coercion fail below.\n  if (start > this.length) {\n    return ''\n  }\n\n  if (end === undefined || end > this.length) {\n    end = this.length\n  }\n\n  if (end <= 0) {\n    return ''\n  }\n\n  // Force coersion to uint32. This will also coerce falsey/NaN values to 0.\n  end >>>= 0\n  start >>>= 0\n\n  if (end <= start) {\n    return ''\n  }\n\n  if (!encoding) encoding = 'utf8'\n\n  while (true) {\n    switch (encoding) {\n      case 'hex':\n        return hexSlice(this, start, end)\n\n      case 'utf8':\n      case 'utf-8':\n        return utf8Slice(this, start, end)\n\n      case 'ascii':\n        return asciiSlice(this, start, end)\n\n      case 'latin1':\n      case 'binary':\n        return latin1Slice(this, start, end)\n\n      case 'base64':\n        return base64Slice(this, start, end)\n\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return utf16leSlice(this, start, end)\n\n      default:\n        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)\n        encoding = (encoding + '').toLowerCase()\n        loweredCase = true\n    }\n  }\n}\n\n// The property is used by `Buffer.isBuffer` and `is-buffer` (in Safari 5-7) to detect\n// Buffer instances.\nBuffer.prototype._isBuffer = true\n\nfunction swap (b, n, m) {\n  var i = b[n]\n  b[n] = b[m]\n  b[m] = i\n}\n\nBuffer.prototype.swap16 = function swap16 () {\n  var len = this.length\n  if (len % 2 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 16-bits')\n  }\n  for (var i = 0; i < len; i += 2) {\n    swap(this, i, i + 1)\n  }\n  return this\n}\n\nBuffer.prototype.swap32 = function swap32 () {\n  var len = this.length\n  if (len % 4 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 32-bits')\n  }\n  for (var i = 0; i < len; i += 4) {\n    swap(this, i, i + 3)\n    swap(this, i + 1, i + 2)\n  }\n  return this\n}\n\nBuffer.prototype.swap64 = function swap64 () {\n  var len = this.length\n  if (len % 8 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 64-bits')\n  }\n  for (var i = 0; i < len; i += 8) {\n    swap(this, i, i + 7)\n    swap(this, i + 1, i + 6)\n    swap(this, i + 2, i + 5)\n    swap(this, i + 3, i + 4)\n  }\n  return this\n}\n\nBuffer.prototype.toString = function toString () {\n  var length = this.length | 0\n  if (length === 0) return ''\n  if (arguments.length === 0) return utf8Slice(this, 0, length)\n  return slowToString.apply(this, arguments)\n}\n\nBuffer.prototype.equals = function equals (b) {\n  if (!Buffer.isBuffer(b)) throw new TypeError('Argument must be a Buffer')\n  if (this === b) return true\n  return Buffer.compare(this, b) === 0\n}\n\nBuffer.prototype.inspect = function inspect () {\n  var str = ''\n  var max = exports.INSPECT_MAX_BYTES\n  if (this.length > 0) {\n    str = this.toString('hex', 0, max).match(/.{2}/g).join(' ')\n    if (this.length > max) str += ' ... '\n  }\n  return '<Buffer ' + str + '>'\n}\n\nBuffer.prototype.compare = function compare (target, start, end, thisStart, thisEnd) {\n  if (!Buffer.isBuffer(target)) {\n    throw new TypeError('Argument must be a Buffer')\n  }\n\n  if (start === undefined) {\n    start = 0\n  }\n  if (end === undefined) {\n    end = target ? target.length : 0\n  }\n  if (thisStart === undefined) {\n    thisStart = 0\n  }\n  if (thisEnd === undefined) {\n    thisEnd = this.length\n  }\n\n  if (start < 0 || end > target.length || thisStart < 0 || thisEnd > this.length) {\n    throw new RangeError('out of range index')\n  }\n\n  if (thisStart >= thisEnd && start >= end) {\n    return 0\n  }\n  if (thisStart >= thisEnd) {\n    return -1\n  }\n  if (start >= end) {\n    return 1\n  }\n\n  start >>>= 0\n  end >>>= 0\n  thisStart >>>= 0\n  thisEnd >>>= 0\n\n  if (this === target) return 0\n\n  var x = thisEnd - thisStart\n  var y = end - start\n  var len = Math.min(x, y)\n\n  var thisCopy = this.slice(thisStart, thisEnd)\n  var targetCopy = target.slice(start, end)\n\n  for (var i = 0; i < len; ++i) {\n    if (thisCopy[i] !== targetCopy[i]) {\n      x = thisCopy[i]\n      y = targetCopy[i]\n      break\n    }\n  }\n\n  if (x < y) return -1\n  if (y < x) return 1\n  return 0\n}\n\n// Finds either the first index of `val` in `buffer` at offset >= `byteOffset`,\n// OR the last index of `val` in `buffer` at offset <= `byteOffset`.\n//\n// Arguments:\n// - buffer - a Buffer to search\n// - val - a string, Buffer, or number\n// - byteOffset - an index into `buffer`; will be clamped to an int32\n// - encoding - an optional encoding, relevant is val is a string\n// - dir - true for indexOf, false for lastIndexOf\nfunction bidirectionalIndexOf (buffer, val, byteOffset, encoding, dir) {\n  // Empty buffer means no match\n  if (buffer.length === 0) return -1\n\n  // Normalize byteOffset\n  if (typeof byteOffset === 'string') {\n    encoding = byteOffset\n    byteOffset = 0\n  } else if (byteOffset > 0x7fffffff) {\n    byteOffset = 0x7fffffff\n  } else if (byteOffset < -0x80000000) {\n    byteOffset = -0x80000000\n  }\n  byteOffset = +byteOffset  // Coerce to Number.\n  if (isNaN(byteOffset)) {\n    // byteOffset: it it's undefined, null, NaN, \"foo\", etc, search whole buffer\n    byteOffset = dir ? 0 : (buffer.length - 1)\n  }\n\n  // Normalize byteOffset: negative offsets start from the end of the buffer\n  if (byteOffset < 0) byteOffset = buffer.length + byteOffset\n  if (byteOffset >= buffer.length) {\n    if (dir) return -1\n    else byteOffset = buffer.length - 1\n  } else if (byteOffset < 0) {\n    if (dir) byteOffset = 0\n    else return -1\n  }\n\n  // Normalize val\n  if (typeof val === 'string') {\n    val = Buffer.from(val, encoding)\n  }\n\n  // Finally, search either indexOf (if dir is true) or lastIndexOf\n  if (Buffer.isBuffer(val)) {\n    // Special case: looking for empty string/buffer always fails\n    if (val.length === 0) {\n      return -1\n    }\n    return arrayIndexOf(buffer, val, byteOffset, encoding, dir)\n  } else if (typeof val === 'number') {\n    val = val & 0xFF // Search for a byte value [0-255]\n    if (Buffer.TYPED_ARRAY_SUPPORT &&\n        typeof Uint8Array.prototype.indexOf === 'function') {\n      if (dir) {\n        return Uint8Array.prototype.indexOf.call(buffer, val, byteOffset)\n      } else {\n        return Uint8Array.prototype.lastIndexOf.call(buffer, val, byteOffset)\n      }\n    }\n    return arrayIndexOf(buffer, [ val ], byteOffset, encoding, dir)\n  }\n\n  throw new TypeError('val must be string, number or Buffer')\n}\n\nfunction arrayIndexOf (arr, val, byteOffset, encoding, dir) {\n  var indexSize = 1\n  var arrLength = arr.length\n  var valLength = val.length\n\n  if (encoding !== undefined) {\n    encoding = String(encoding).toLowerCase()\n    if (encoding === 'ucs2' || encoding === 'ucs-2' ||\n        encoding === 'utf16le' || encoding === 'utf-16le') {\n      if (arr.length < 2 || val.length < 2) {\n        return -1\n      }\n      indexSize = 2\n      arrLength /= 2\n      valLength /= 2\n      byteOffset /= 2\n    }\n  }\n\n  function read (buf, i) {\n    if (indexSize === 1) {\n      return buf[i]\n    } else {\n      return buf.readUInt16BE(i * indexSize)\n    }\n  }\n\n  var i\n  if (dir) {\n    var foundIndex = -1\n    for (i = byteOffset; i < arrLength; i++) {\n      if (read(arr, i) === read(val, foundIndex === -1 ? 0 : i - foundIndex)) {\n        if (foundIndex === -1) foundIndex = i\n        if (i - foundIndex + 1 === valLength) return foundIndex * indexSize\n      } else {\n        if (foundIndex !== -1) i -= i - foundIndex\n        foundIndex = -1\n      }\n    }\n  } else {\n    if (byteOffset + valLength > arrLength) byteOffset = arrLength - valLength\n    for (i = byteOffset; i >= 0; i--) {\n      var found = true\n      for (var j = 0; j < valLength; j++) {\n        if (read(arr, i + j) !== read(val, j)) {\n          found = false\n          break\n        }\n      }\n      if (found) return i\n    }\n  }\n\n  return -1\n}\n\nBuffer.prototype.includes = function includes (val, byteOffset, encoding) {\n  return this.indexOf(val, byteOffset, encoding) !== -1\n}\n\nBuffer.prototype.indexOf = function indexOf (val, byteOffset, encoding) {\n  return bidirectionalIndexOf(this, val, byteOffset, encoding, true)\n}\n\nBuffer.prototype.lastIndexOf = function lastIndexOf (val, byteOffset, encoding) {\n  return bidirectionalIndexOf(this, val, byteOffset, encoding, false)\n}\n\nfunction hexWrite (buf, string, offset, length) {\n  offset = Number(offset) || 0\n  var remaining = buf.length - offset\n  if (!length) {\n    length = remaining\n  } else {\n    length = Number(length)\n    if (length > remaining) {\n      length = remaining\n    }\n  }\n\n  // must be an even number of digits\n  var strLen = string.length\n  if (strLen % 2 !== 0) throw new TypeError('Invalid hex string')\n\n  if (length > strLen / 2) {\n    length = strLen / 2\n  }\n  for (var i = 0; i < length; ++i) {\n    var parsed = parseInt(string.substr(i * 2, 2), 16)\n    if (isNaN(parsed)) return i\n    buf[offset + i] = parsed\n  }\n  return i\n}\n\nfunction utf8Write (buf, string, offset, length) {\n  return blitBuffer(utf8ToBytes(string, buf.length - offset), buf, offset, length)\n}\n\nfunction asciiWrite (buf, string, offset, length) {\n  return blitBuffer(asciiToBytes(string), buf, offset, length)\n}\n\nfunction latin1Write (buf, string, offset, length) {\n  return asciiWrite(buf, string, offset, length)\n}\n\nfunction base64Write (buf, string, offset, length) {\n  return blitBuffer(base64ToBytes(string), buf, offset, length)\n}\n\nfunction ucs2Write (buf, string, offset, length) {\n  return blitBuffer(utf16leToBytes(string, buf.length - offset), buf, offset, length)\n}\n\nBuffer.prototype.write = function write (string, offset, length, encoding) {\n  // Buffer#write(string)\n  if (offset === undefined) {\n    encoding = 'utf8'\n    length = this.length\n    offset = 0\n  // Buffer#write(string, encoding)\n  } else if (length === undefined && typeof offset === 'string') {\n    encoding = offset\n    length = this.length\n    offset = 0\n  // Buffer#write(string, offset[, length][, encoding])\n  } else if (isFinite(offset)) {\n    offset = offset | 0\n    if (isFinite(length)) {\n      length = length | 0\n      if (encoding === undefined) encoding = 'utf8'\n    } else {\n      encoding = length\n      length = undefined\n    }\n  // legacy write(string, encoding, offset, length) - remove in v0.13\n  } else {\n    throw new Error(\n      'Buffer.write(string, encoding, offset[, length]) is no longer supported'\n    )\n  }\n\n  var remaining = this.length - offset\n  if (length === undefined || length > remaining) length = remaining\n\n  if ((string.length > 0 && (length < 0 || offset < 0)) || offset > this.length) {\n    throw new RangeError('Attempt to write outside buffer bounds')\n  }\n\n  if (!encoding) encoding = 'utf8'\n\n  var loweredCase = false\n  for (;;) {\n    switch (encoding) {\n      case 'hex':\n        return hexWrite(this, string, offset, length)\n\n      case 'utf8':\n      case 'utf-8':\n        return utf8Write(this, string, offset, length)\n\n      case 'ascii':\n        return asciiWrite(this, string, offset, length)\n\n      case 'latin1':\n      case 'binary':\n        return latin1Write(this, string, offset, length)\n\n      case 'base64':\n        // Warning: maxLength not taken into account in base64Write\n        return base64Write(this, string, offset, length)\n\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return ucs2Write(this, string, offset, length)\n\n      default:\n        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)\n        encoding = ('' + encoding).toLowerCase()\n        loweredCase = true\n    }\n  }\n}\n\nBuffer.prototype.toJSON = function toJSON () {\n  return {\n    type: 'Buffer',\n    data: Array.prototype.slice.call(this._arr || this, 0)\n  }\n}\n\nfunction base64Slice (buf, start, end) {\n  if (start === 0 && end === buf.length) {\n    return base64.fromByteArray(buf)\n  } else {\n    return base64.fromByteArray(buf.slice(start, end))\n  }\n}\n\nfunction utf8Slice (buf, start, end) {\n  end = Math.min(buf.length, end)\n  var res = []\n\n  var i = start\n  while (i < end) {\n    var firstByte = buf[i]\n    var codePoint = null\n    var bytesPerSequence = (firstByte > 0xEF) ? 4\n      : (firstByte > 0xDF) ? 3\n      : (firstByte > 0xBF) ? 2\n      : 1\n\n    if (i + bytesPerSequence <= end) {\n      var secondByte, thirdByte, fourthByte, tempCodePoint\n\n      switch (bytesPerSequence) {\n        case 1:\n          if (firstByte < 0x80) {\n            codePoint = firstByte\n          }\n          break\n        case 2:\n          secondByte = buf[i + 1]\n          if ((secondByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0x1F) << 0x6 | (secondByte & 0x3F)\n            if (tempCodePoint > 0x7F) {\n              codePoint = tempCodePoint\n            }\n          }\n          break\n        case 3:\n          secondByte = buf[i + 1]\n          thirdByte = buf[i + 2]\n          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0xF) << 0xC | (secondByte & 0x3F) << 0x6 | (thirdByte & 0x3F)\n            if (tempCodePoint > 0x7FF && (tempCodePoint < 0xD800 || tempCodePoint > 0xDFFF)) {\n              codePoint = tempCodePoint\n            }\n          }\n          break\n        case 4:\n          secondByte = buf[i + 1]\n          thirdByte = buf[i + 2]\n          fourthByte = buf[i + 3]\n          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80 && (fourthByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0xF) << 0x12 | (secondByte & 0x3F) << 0xC | (thirdByte & 0x3F) << 0x6 | (fourthByte & 0x3F)\n            if (tempCodePoint > 0xFFFF && tempCodePoint < 0x110000) {\n              codePoint = tempCodePoint\n            }\n          }\n      }\n    }\n\n    if (codePoint === null) {\n      // we did not generate a valid codePoint so insert a\n      // replacement char (U+FFFD) and advance only 1 byte\n      codePoint = 0xFFFD\n      bytesPerSequence = 1\n    } else if (codePoint > 0xFFFF) {\n      // encode to utf16 (surrogate pair dance)\n      codePoint -= 0x10000\n      res.push(codePoint >>> 10 & 0x3FF | 0xD800)\n      codePoint = 0xDC00 | codePoint & 0x3FF\n    }\n\n    res.push(codePoint)\n    i += bytesPerSequence\n  }\n\n  return decodeCodePointsArray(res)\n}\n\n// Based on http://stackoverflow.com/a/22747272/680742, the browser with\n// the lowest limit is Chrome, with 0x10000 args.\n// We go 1 magnitude less, for safety\nvar MAX_ARGUMENTS_LENGTH = 0x1000\n\nfunction decodeCodePointsArray (codePoints) {\n  var len = codePoints.length\n  if (len <= MAX_ARGUMENTS_LENGTH) {\n    return String.fromCharCode.apply(String, codePoints) // avoid extra slice()\n  }\n\n  // Decode in chunks to avoid \"call stack size exceeded\".\n  var res = ''\n  var i = 0\n  while (i < len) {\n    res += String.fromCharCode.apply(\n      String,\n      codePoints.slice(i, i += MAX_ARGUMENTS_LENGTH)\n    )\n  }\n  return res\n}\n\nfunction asciiSlice (buf, start, end) {\n  var ret = ''\n  end = Math.min(buf.length, end)\n\n  for (var i = start; i < end; ++i) {\n    ret += String.fromCharCode(buf[i] & 0x7F)\n  }\n  return ret\n}\n\nfunction latin1Slice (buf, start, end) {\n  var ret = ''\n  end = Math.min(buf.length, end)\n\n  for (var i = start; i < end; ++i) {\n    ret += String.fromCharCode(buf[i])\n  }\n  return ret\n}\n\nfunction hexSlice (buf, start, end) {\n  var len = buf.length\n\n  if (!start || start < 0) start = 0\n  if (!end || end < 0 || end > len) end = len\n\n  var out = ''\n  for (var i = start; i < end; ++i) {\n    out += toHex(buf[i])\n  }\n  return out\n}\n\nfunction utf16leSlice (buf, start, end) {\n  var bytes = buf.slice(start, end)\n  var res = ''\n  for (var i = 0; i < bytes.length; i += 2) {\n    res += String.fromCharCode(bytes[i] + bytes[i + 1] * 256)\n  }\n  return res\n}\n\nBuffer.prototype.slice = function slice (start, end) {\n  var len = this.length\n  start = ~~start\n  end = end === undefined ? len : ~~end\n\n  if (start < 0) {\n    start += len\n    if (start < 0) start = 0\n  } else if (start > len) {\n    start = len\n  }\n\n  if (end < 0) {\n    end += len\n    if (end < 0) end = 0\n  } else if (end > len) {\n    end = len\n  }\n\n  if (end < start) end = start\n\n  var newBuf\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    newBuf = this.subarray(start, end)\n    newBuf.__proto__ = Buffer.prototype\n  } else {\n    var sliceLen = end - start\n    newBuf = new Buffer(sliceLen, undefined)\n    for (var i = 0; i < sliceLen; ++i) {\n      newBuf[i] = this[i + start]\n    }\n  }\n\n  return newBuf\n}\n\n/*\n * Need to make sure that buffer isn't trying to write out of bounds.\n */\nfunction checkOffset (offset, ext, length) {\n  if ((offset % 1) !== 0 || offset < 0) throw new RangeError('offset is not uint')\n  if (offset + ext > length) throw new RangeError('Trying to access beyond buffer length')\n}\n\nBuffer.prototype.readUIntLE = function readUIntLE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var val = this[offset]\n  var mul = 1\n  var i = 0\n  while (++i < byteLength && (mul *= 0x100)) {\n    val += this[offset + i] * mul\n  }\n\n  return val\n}\n\nBuffer.prototype.readUIntBE = function readUIntBE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    checkOffset(offset, byteLength, this.length)\n  }\n\n  var val = this[offset + --byteLength]\n  var mul = 1\n  while (byteLength > 0 && (mul *= 0x100)) {\n    val += this[offset + --byteLength] * mul\n  }\n\n  return val\n}\n\nBuffer.prototype.readUInt8 = function readUInt8 (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 1, this.length)\n  return this[offset]\n}\n\nBuffer.prototype.readUInt16LE = function readUInt16LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  return this[offset] | (this[offset + 1] << 8)\n}\n\nBuffer.prototype.readUInt16BE = function readUInt16BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  return (this[offset] << 8) | this[offset + 1]\n}\n\nBuffer.prototype.readUInt32LE = function readUInt32LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return ((this[offset]) |\n      (this[offset + 1] << 8) |\n      (this[offset + 2] << 16)) +\n      (this[offset + 3] * 0x1000000)\n}\n\nBuffer.prototype.readUInt32BE = function readUInt32BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset] * 0x1000000) +\n    ((this[offset + 1] << 16) |\n    (this[offset + 2] << 8) |\n    this[offset + 3])\n}\n\nBuffer.prototype.readIntLE = function readIntLE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var val = this[offset]\n  var mul = 1\n  var i = 0\n  while (++i < byteLength && (mul *= 0x100)) {\n    val += this[offset + i] * mul\n  }\n  mul *= 0x80\n\n  if (val >= mul) val -= Math.pow(2, 8 * byteLength)\n\n  return val\n}\n\nBuffer.prototype.readIntBE = function readIntBE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var i = byteLength\n  var mul = 1\n  var val = this[offset + --i]\n  while (i > 0 && (mul *= 0x100)) {\n    val += this[offset + --i] * mul\n  }\n  mul *= 0x80\n\n  if (val >= mul) val -= Math.pow(2, 8 * byteLength)\n\n  return val\n}\n\nBuffer.prototype.readInt8 = function readInt8 (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 1, this.length)\n  if (!(this[offset] & 0x80)) return (this[offset])\n  return ((0xff - this[offset] + 1) * -1)\n}\n\nBuffer.prototype.readInt16LE = function readInt16LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  var val = this[offset] | (this[offset + 1] << 8)\n  return (val & 0x8000) ? val | 0xFFFF0000 : val\n}\n\nBuffer.prototype.readInt16BE = function readInt16BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  var val = this[offset + 1] | (this[offset] << 8)\n  return (val & 0x8000) ? val | 0xFFFF0000 : val\n}\n\nBuffer.prototype.readInt32LE = function readInt32LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset]) |\n    (this[offset + 1] << 8) |\n    (this[offset + 2] << 16) |\n    (this[offset + 3] << 24)\n}\n\nBuffer.prototype.readInt32BE = function readInt32BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset] << 24) |\n    (this[offset + 1] << 16) |\n    (this[offset + 2] << 8) |\n    (this[offset + 3])\n}\n\nBuffer.prototype.readFloatLE = function readFloatLE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n  return ieee754.read(this, offset, true, 23, 4)\n}\n\nBuffer.prototype.readFloatBE = function readFloatBE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n  return ieee754.read(this, offset, false, 23, 4)\n}\n\nBuffer.prototype.readDoubleLE = function readDoubleLE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 8, this.length)\n  return ieee754.read(this, offset, true, 52, 8)\n}\n\nBuffer.prototype.readDoubleBE = function readDoubleBE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 8, this.length)\n  return ieee754.read(this, offset, false, 52, 8)\n}\n\nfunction checkInt (buf, value, offset, ext, max, min) {\n  if (!Buffer.isBuffer(buf)) throw new TypeError('\"buffer\" argument must be a Buffer instance')\n  if (value > max || value < min) throw new RangeError('\"value\" argument is out of bounds')\n  if (offset + ext > buf.length) throw new RangeError('Index out of range')\n}\n\nBuffer.prototype.writeUIntLE = function writeUIntLE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    var maxBytes = Math.pow(2, 8 * byteLength) - 1\n    checkInt(this, value, offset, byteLength, maxBytes, 0)\n  }\n\n  var mul = 1\n  var i = 0\n  this[offset] = value & 0xFF\n  while (++i < byteLength && (mul *= 0x100)) {\n    this[offset + i] = (value / mul) & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeUIntBE = function writeUIntBE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    var maxBytes = Math.pow(2, 8 * byteLength) - 1\n    checkInt(this, value, offset, byteLength, maxBytes, 0)\n  }\n\n  var i = byteLength - 1\n  var mul = 1\n  this[offset + i] = value & 0xFF\n  while (--i >= 0 && (mul *= 0x100)) {\n    this[offset + i] = (value / mul) & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeUInt8 = function writeUInt8 (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 1, 0xff, 0)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)\n  this[offset] = (value & 0xff)\n  return offset + 1\n}\n\nfunction objectWriteUInt16 (buf, value, offset, littleEndian) {\n  if (value < 0) value = 0xffff + value + 1\n  for (var i = 0, j = Math.min(buf.length - offset, 2); i < j; ++i) {\n    buf[offset + i] = (value & (0xff << (8 * (littleEndian ? i : 1 - i)))) >>>\n      (littleEndian ? i : 1 - i) * 8\n  }\n}\n\nBuffer.prototype.writeUInt16LE = function writeUInt16LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n  } else {\n    objectWriteUInt16(this, value, offset, true)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeUInt16BE = function writeUInt16BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 8)\n    this[offset + 1] = (value & 0xff)\n  } else {\n    objectWriteUInt16(this, value, offset, false)\n  }\n  return offset + 2\n}\n\nfunction objectWriteUInt32 (buf, value, offset, littleEndian) {\n  if (value < 0) value = 0xffffffff + value + 1\n  for (var i = 0, j = Math.min(buf.length - offset, 4); i < j; ++i) {\n    buf[offset + i] = (value >>> (littleEndian ? i : 3 - i) * 8) & 0xff\n  }\n}\n\nBuffer.prototype.writeUInt32LE = function writeUInt32LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset + 3] = (value >>> 24)\n    this[offset + 2] = (value >>> 16)\n    this[offset + 1] = (value >>> 8)\n    this[offset] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, true)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeUInt32BE = function writeUInt32BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 24)\n    this[offset + 1] = (value >>> 16)\n    this[offset + 2] = (value >>> 8)\n    this[offset + 3] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, false)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeIntLE = function writeIntLE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) {\n    var limit = Math.pow(2, 8 * byteLength - 1)\n\n    checkInt(this, value, offset, byteLength, limit - 1, -limit)\n  }\n\n  var i = 0\n  var mul = 1\n  var sub = 0\n  this[offset] = value & 0xFF\n  while (++i < byteLength && (mul *= 0x100)) {\n    if (value < 0 && sub === 0 && this[offset + i - 1] !== 0) {\n      sub = 1\n    }\n    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeIntBE = function writeIntBE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) {\n    var limit = Math.pow(2, 8 * byteLength - 1)\n\n    checkInt(this, value, offset, byteLength, limit - 1, -limit)\n  }\n\n  var i = byteLength - 1\n  var mul = 1\n  var sub = 0\n  this[offset + i] = value & 0xFF\n  while (--i >= 0 && (mul *= 0x100)) {\n    if (value < 0 && sub === 0 && this[offset + i + 1] !== 0) {\n      sub = 1\n    }\n    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeInt8 = function writeInt8 (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 1, 0x7f, -0x80)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)\n  if (value < 0) value = 0xff + value + 1\n  this[offset] = (value & 0xff)\n  return offset + 1\n}\n\nBuffer.prototype.writeInt16LE = function writeInt16LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n  } else {\n    objectWriteUInt16(this, value, offset, true)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeInt16BE = function writeInt16BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 8)\n    this[offset + 1] = (value & 0xff)\n  } else {\n    objectWriteUInt16(this, value, offset, false)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeInt32LE = function writeInt32LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n    this[offset + 2] = (value >>> 16)\n    this[offset + 3] = (value >>> 24)\n  } else {\n    objectWriteUInt32(this, value, offset, true)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeInt32BE = function writeInt32BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)\n  if (value < 0) value = 0xffffffff + value + 1\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 24)\n    this[offset + 1] = (value >>> 16)\n    this[offset + 2] = (value >>> 8)\n    this[offset + 3] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, false)\n  }\n  return offset + 4\n}\n\nfunction checkIEEE754 (buf, value, offset, ext, max, min) {\n  if (offset + ext > buf.length) throw new RangeError('Index out of range')\n  if (offset < 0) throw new RangeError('Index out of range')\n}\n\nfunction writeFloat (buf, value, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    checkIEEE754(buf, value, offset, 4, 3.4028234663852886e+38, -3.4028234663852886e+38)\n  }\n  ieee754.write(buf, value, offset, littleEndian, 23, 4)\n  return offset + 4\n}\n\nBuffer.prototype.writeFloatLE = function writeFloatLE (value, offset, noAssert) {\n  return writeFloat(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeFloatBE = function writeFloatBE (value, offset, noAssert) {\n  return writeFloat(this, value, offset, false, noAssert)\n}\n\nfunction writeDouble (buf, value, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    checkIEEE754(buf, value, offset, 8, 1.7976931348623157E+308, -1.7976931348623157E+308)\n  }\n  ieee754.write(buf, value, offset, littleEndian, 52, 8)\n  return offset + 8\n}\n\nBuffer.prototype.writeDoubleLE = function writeDoubleLE (value, offset, noAssert) {\n  return writeDouble(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeDoubleBE = function writeDoubleBE (value, offset, noAssert) {\n  return writeDouble(this, value, offset, false, noAssert)\n}\n\n// copy(targetBuffer, targetStart=0, sourceStart=0, sourceEnd=buffer.length)\nBuffer.prototype.copy = function copy (target, targetStart, start, end) {\n  if (!start) start = 0\n  if (!end && end !== 0) end = this.length\n  if (targetStart >= target.length) targetStart = target.length\n  if (!targetStart) targetStart = 0\n  if (end > 0 && end < start) end = start\n\n  // Copy 0 bytes; we're done\n  if (end === start) return 0\n  if (target.length === 0 || this.length === 0) return 0\n\n  // Fatal error conditions\n  if (targetStart < 0) {\n    throw new RangeError('targetStart out of bounds')\n  }\n  if (start < 0 || start >= this.length) throw new RangeError('sourceStart out of bounds')\n  if (end < 0) throw new RangeError('sourceEnd out of bounds')\n\n  // Are we oob?\n  if (end > this.length) end = this.length\n  if (target.length - targetStart < end - start) {\n    end = target.length - targetStart + start\n  }\n\n  var len = end - start\n  var i\n\n  if (this === target && start < targetStart && targetStart < end) {\n    // descending copy from end\n    for (i = len - 1; i >= 0; --i) {\n      target[i + targetStart] = this[i + start]\n    }\n  } else if (len < 1000 || !Buffer.TYPED_ARRAY_SUPPORT) {\n    // ascending copy from start\n    for (i = 0; i < len; ++i) {\n      target[i + targetStart] = this[i + start]\n    }\n  } else {\n    Uint8Array.prototype.set.call(\n      target,\n      this.subarray(start, start + len),\n      targetStart\n    )\n  }\n\n  return len\n}\n\n// Usage:\n//    buffer.fill(number[, offset[, end]])\n//    buffer.fill(buffer[, offset[, end]])\n//    buffer.fill(string[, offset[, end]][, encoding])\nBuffer.prototype.fill = function fill (val, start, end, encoding) {\n  // Handle string cases:\n  if (typeof val === 'string') {\n    if (typeof start === 'string') {\n      encoding = start\n      start = 0\n      end = this.length\n    } else if (typeof end === 'string') {\n      encoding = end\n      end = this.length\n    }\n    if (val.length === 1) {\n      var code = val.charCodeAt(0)\n      if (code < 256) {\n        val = code\n      }\n    }\n    if (encoding !== undefined && typeof encoding !== 'string') {\n      throw new TypeError('encoding must be a string')\n    }\n    if (typeof encoding === 'string' && !Buffer.isEncoding(encoding)) {\n      throw new TypeError('Unknown encoding: ' + encoding)\n    }\n  } else if (typeof val === 'number') {\n    val = val & 255\n  }\n\n  // Invalid ranges are not set to a default, so can range check early.\n  if (start < 0 || this.length < start || this.length < end) {\n    throw new RangeError('Out of range index')\n  }\n\n  if (end <= start) {\n    return this\n  }\n\n  start = start >>> 0\n  end = end === undefined ? this.length : end >>> 0\n\n  if (!val) val = 0\n\n  var i\n  if (typeof val === 'number') {\n    for (i = start; i < end; ++i) {\n      this[i] = val\n    }\n  } else {\n    var bytes = Buffer.isBuffer(val)\n      ? val\n      : utf8ToBytes(new Buffer(val, encoding).toString())\n    var len = bytes.length\n    for (i = 0; i < end - start; ++i) {\n      this[i + start] = bytes[i % len]\n    }\n  }\n\n  return this\n}\n\n// HELPER FUNCTIONS\n// ================\n\nvar INVALID_BASE64_RE = /[^+\\/0-9A-Za-z-_]/g\n\nfunction base64clean (str) {\n  // Node strips out invalid characters like \\n and \\t from the string, base64-js does not\n  str = stringtrim(str).replace(INVALID_BASE64_RE, '')\n  // Node converts strings with length < 2 to ''\n  if (str.length < 2) return ''\n  // Node allows for non-padded base64 strings (missing trailing ===), base64-js does not\n  while (str.length % 4 !== 0) {\n    str = str + '='\n  }\n  return str\n}\n\nfunction stringtrim (str) {\n  if (str.trim) return str.trim()\n  return str.replace(/^\\s+|\\s+$/g, '')\n}\n\nfunction toHex (n) {\n  if (n < 16) return '0' + n.toString(16)\n  return n.toString(16)\n}\n\nfunction utf8ToBytes (string, units) {\n  units = units || Infinity\n  var codePoint\n  var length = string.length\n  var leadSurrogate = null\n  var bytes = []\n\n  for (var i = 0; i < length; ++i) {\n    codePoint = string.charCodeAt(i)\n\n    // is surrogate component\n    if (codePoint > 0xD7FF && codePoint < 0xE000) {\n      // last char was a lead\n      if (!leadSurrogate) {\n        // no lead yet\n        if (codePoint > 0xDBFF) {\n          // unexpected trail\n          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n          continue\n        } else if (i + 1 === length) {\n          // unpaired lead\n          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n          continue\n        }\n\n        // valid lead\n        leadSurrogate = codePoint\n\n        continue\n      }\n\n      // 2 leads in a row\n      if (codePoint < 0xDC00) {\n        if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n        leadSurrogate = codePoint\n        continue\n      }\n\n      // valid surrogate pair\n      codePoint = (leadSurrogate - 0xD800 << 10 | codePoint - 0xDC00) + 0x10000\n    } else if (leadSurrogate) {\n      // valid bmp char, but last char was a lead\n      if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n    }\n\n    leadSurrogate = null\n\n    // encode utf8\n    if (codePoint < 0x80) {\n      if ((units -= 1) < 0) break\n      bytes.push(codePoint)\n    } else if (codePoint < 0x800) {\n      if ((units -= 2) < 0) break\n      bytes.push(\n        codePoint >> 0x6 | 0xC0,\n        codePoint & 0x3F | 0x80\n      )\n    } else if (codePoint < 0x10000) {\n      if ((units -= 3) < 0) break\n      bytes.push(\n        codePoint >> 0xC | 0xE0,\n        codePoint >> 0x6 & 0x3F | 0x80,\n        codePoint & 0x3F | 0x80\n      )\n    } else if (codePoint < 0x110000) {\n      if ((units -= 4) < 0) break\n      bytes.push(\n        codePoint >> 0x12 | 0xF0,\n        codePoint >> 0xC & 0x3F | 0x80,\n        codePoint >> 0x6 & 0x3F | 0x80,\n        codePoint & 0x3F | 0x80\n      )\n    } else {\n      throw new Error('Invalid code point')\n    }\n  }\n\n  return bytes\n}\n\nfunction asciiToBytes (str) {\n  var byteArray = []\n  for (var i = 0; i < str.length; ++i) {\n    // Node's code seems to be doing this and not & 0x7F..\n    byteArray.push(str.charCodeAt(i) & 0xFF)\n  }\n  return byteArray\n}\n\nfunction utf16leToBytes (str, units) {\n  var c, hi, lo\n  var byteArray = []\n  for (var i = 0; i < str.length; ++i) {\n    if ((units -= 2) < 0) break\n\n    c = str.charCodeAt(i)\n    hi = c >> 8\n    lo = c % 256\n    byteArray.push(lo)\n    byteArray.push(hi)\n  }\n\n  return byteArray\n}\n\nfunction base64ToBytes (str) {\n  return base64.toByteArray(base64clean(str))\n}\n\nfunction blitBuffer (src, dst, offset, length) {\n  for (var i = 0; i < length; ++i) {\n    if ((i + offset >= dst.length) || (i >= src.length)) break\n    dst[i + offset] = src[i]\n  }\n  return i\n}\n\nfunction isnan (val) {\n  return val !== val // eslint-disable-line no-self-compare\n}\n","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","'use strict'\n\nexports.byteLength = byteLength\nexports.toByteArray = toByteArray\nexports.fromByteArray = fromByteArray\n\nvar lookup = []\nvar revLookup = []\nvar Arr = typeof Uint8Array !== 'undefined' ? Uint8Array : Array\n\nvar code = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'\nfor (var i = 0, len = code.length; i < len; ++i) {\n  lookup[i] = code[i]\n  revLookup[code.charCodeAt(i)] = i\n}\n\n// Support decoding URL-safe base64 strings, as Node.js does.\n// See: https://en.wikipedia.org/wiki/Base64#URL_applications\nrevLookup['-'.charCodeAt(0)] = 62\nrevLookup['_'.charCodeAt(0)] = 63\n\nfunction getLens (b64) {\n  var len = b64.length\n\n  if (len % 4 > 0) {\n    throw new Error('Invalid string. Length must be a multiple of 4')\n  }\n\n  // Trim off extra bytes after placeholder bytes are found\n  // See: https://github.com/beatgammit/base64-js/issues/42\n  var validLen = b64.indexOf('=')\n  if (validLen === -1) validLen = len\n\n  var placeHoldersLen = validLen === len\n    ? 0\n    : 4 - (validLen % 4)\n\n  return [validLen, placeHoldersLen]\n}\n\n// base64 is 4/3 + up to two characters of the original data\nfunction byteLength (b64) {\n  var lens = getLens(b64)\n  var validLen = lens[0]\n  var placeHoldersLen = lens[1]\n  return ((validLen + placeHoldersLen) * 3 / 4) - placeHoldersLen\n}\n\nfunction _byteLength (b64, validLen, placeHoldersLen) {\n  return ((validLen + placeHoldersLen) * 3 / 4) - placeHoldersLen\n}\n\nfunction toByteArray (b64) {\n  var tmp\n  var lens = getLens(b64)\n  var validLen = lens[0]\n  var placeHoldersLen = lens[1]\n\n  var arr = new Arr(_byteLength(b64, validLen, placeHoldersLen))\n\n  var curByte = 0\n\n  // if there are placeholders, only get up to the last complete 4 chars\n  var len = placeHoldersLen > 0\n    ? validLen - 4\n    : validLen\n\n  var i\n  for (i = 0; i < len; i += 4) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 18) |\n      (revLookup[b64.charCodeAt(i + 1)] << 12) |\n      (revLookup[b64.charCodeAt(i + 2)] << 6) |\n      revLookup[b64.charCodeAt(i + 3)]\n    arr[curByte++] = (tmp >> 16) & 0xFF\n    arr[curByte++] = (tmp >> 8) & 0xFF\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  if (placeHoldersLen === 2) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 2) |\n      (revLookup[b64.charCodeAt(i + 1)] >> 4)\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  if (placeHoldersLen === 1) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 10) |\n      (revLookup[b64.charCodeAt(i + 1)] << 4) |\n      (revLookup[b64.charCodeAt(i + 2)] >> 2)\n    arr[curByte++] = (tmp >> 8) & 0xFF\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  return arr\n}\n\nfunction tripletToBase64 (num) {\n  return lookup[num >> 18 & 0x3F] +\n    lookup[num >> 12 & 0x3F] +\n    lookup[num >> 6 & 0x3F] +\n    lookup[num & 0x3F]\n}\n\nfunction encodeChunk (uint8, start, end) {\n  var tmp\n  var output = []\n  for (var i = start; i < end; i += 3) {\n    tmp =\n      ((uint8[i] << 16) & 0xFF0000) +\n      ((uint8[i + 1] << 8) & 0xFF00) +\n      (uint8[i + 2] & 0xFF)\n    output.push(tripletToBase64(tmp))\n  }\n  return output.join('')\n}\n\nfunction fromByteArray (uint8) {\n  var tmp\n  var len = uint8.length\n  var extraBytes = len % 3 // if we have 1 byte left, pad 2 bytes\n  var parts = []\n  var maxChunkLength = 16383 // must be multiple of 3\n\n  // go through the array every three bytes, we'll deal with trailing stuff later\n  for (var i = 0, len2 = len - extraBytes; i < len2; i += maxChunkLength) {\n    parts.push(encodeChunk(\n      uint8, i, (i + maxChunkLength) > len2 ? len2 : (i + maxChunkLength)\n    ))\n  }\n\n  // pad the end with zeros, but make sure to not forget the extra bytes\n  if (extraBytes === 1) {\n    tmp = uint8[len - 1]\n    parts.push(\n      lookup[tmp >> 2] +\n      lookup[(tmp << 4) & 0x3F] +\n      '=='\n    )\n  } else if (extraBytes === 2) {\n    tmp = (uint8[len - 2] << 8) + uint8[len - 1]\n    parts.push(\n      lookup[tmp >> 10] +\n      lookup[(tmp >> 4) & 0x3F] +\n      lookup[(tmp << 2) & 0x3F] +\n      '='\n    )\n  }\n\n  return parts.join('')\n}\n","exports.read = function (buffer, offset, isLE, mLen, nBytes) {\n  var e, m\n  var eLen = (nBytes * 8) - mLen - 1\n  var eMax = (1 << eLen) - 1\n  var eBias = eMax >> 1\n  var nBits = -7\n  var i = isLE ? (nBytes - 1) : 0\n  var d = isLE ? -1 : 1\n  var s = buffer[offset + i]\n\n  i += d\n\n  e = s & ((1 << (-nBits)) - 1)\n  s >>= (-nBits)\n  nBits += eLen\n  for (; nBits > 0; e = (e * 256) + buffer[offset + i], i += d, nBits -= 8) {}\n\n  m = e & ((1 << (-nBits)) - 1)\n  e >>= (-nBits)\n  nBits += mLen\n  for (; nBits > 0; m = (m * 256) + buffer[offset + i], i += d, nBits -= 8) {}\n\n  if (e === 0) {\n    e = 1 - eBias\n  } else if (e === eMax) {\n    return m ? NaN : ((s ? -1 : 1) * Infinity)\n  } else {\n    m = m + Math.pow(2, mLen)\n    e = e - eBias\n  }\n  return (s ? -1 : 1) * m * Math.pow(2, e - mLen)\n}\n\nexports.write = function (buffer, value, offset, isLE, mLen, nBytes) {\n  var e, m, c\n  var eLen = (nBytes * 8) - mLen - 1\n  var eMax = (1 << eLen) - 1\n  var eBias = eMax >> 1\n  var rt = (mLen === 23 ? Math.pow(2, -24) - Math.pow(2, -77) : 0)\n  var i = isLE ? 0 : (nBytes - 1)\n  var d = isLE ? 1 : -1\n  var s = value < 0 || (value === 0 && 1 / value < 0) ? 1 : 0\n\n  value = Math.abs(value)\n\n  if (isNaN(value) || value === Infinity) {\n    m = isNaN(value) ? 1 : 0\n    e = eMax\n  } else {\n    e = Math.floor(Math.log(value) / Math.LN2)\n    if (value * (c = Math.pow(2, -e)) < 1) {\n      e--\n      c *= 2\n    }\n    if (e + eBias >= 1) {\n      value += rt / c\n    } else {\n      value += rt * Math.pow(2, 1 - eBias)\n    }\n    if (value * c >= 2) {\n      e++\n      c /= 2\n    }\n\n    if (e + eBias >= eMax) {\n      m = 0\n      e = eMax\n    } else if (e + eBias >= 1) {\n      m = ((value * c) - 1) * Math.pow(2, mLen)\n      e = e + eBias\n    } else {\n      m = value * Math.pow(2, eBias - 1) * Math.pow(2, mLen)\n      e = 0\n    }\n  }\n\n  for (; mLen >= 8; buffer[offset + i] = m & 0xff, i += d, m /= 256, mLen -= 8) {}\n\n  e = (e << mLen) | m\n  eLen += mLen\n  for (; eLen > 0; buffer[offset + i] = e & 0xff, i += d, e /= 256, eLen -= 8) {}\n\n  buffer[offset + i - d] |= s * 128\n}\n","var toString = {}.toString;\n\nmodule.exports = Array.isArray || function (arr) {\n  return toString.call(arr) == '[object Array]';\n};\n","module.exports = require('./lib/axios');","'use strict';\n\nvar utils = require('./utils');\nvar bind = require('./helpers/bind');\nvar Axios = require('./core/Axios');\nvar mergeConfig = require('./core/mergeConfig');\nvar defaults = require('./defaults');\n\n/**\n * Create an instance of Axios\n *\n * @param {Object} defaultConfig The default config for the instance\n * @return {Axios} A new instance of Axios\n */\nfunction createInstance(defaultConfig) {\n  var context = new Axios(defaultConfig);\n  var instance = bind(Axios.prototype.request, context);\n\n  // Copy axios.prototype to instance\n  utils.extend(instance, Axios.prototype, context);\n\n  // Copy context to instance\n  utils.extend(instance, context);\n\n  return instance;\n}\n\n// Create the default instance to be exported\nvar axios = createInstance(defaults);\n\n// Expose Axios class to allow class inheritance\naxios.Axios = Axios;\n\n// Factory for creating new instances\naxios.create = function create(instanceConfig) {\n  return createInstance(mergeConfig(axios.defaults, instanceConfig));\n};\n\n// Expose Cancel & CancelToken\naxios.Cancel = require('./cancel/Cancel');\naxios.CancelToken = require('./cancel/CancelToken');\naxios.isCancel = require('./cancel/isCancel');\n\n// Expose all/spread\naxios.all = function all(promises) {\n  return Promise.all(promises);\n};\naxios.spread = require('./helpers/spread');\n\nmodule.exports = axios;\n\n// Allow use of default import syntax in TypeScript\nmodule.exports.default = axios;\n","/*!\n * Determine if an object is a Buffer\n *\n * @author   Feross Aboukhadijeh <https://feross.org>\n * @license  MIT\n */\n\nmodule.exports = function isBuffer (obj) {\n  return obj != null && obj.constructor != null &&\n    typeof obj.constructor.isBuffer === 'function' && obj.constructor.isBuffer(obj)\n}\n","'use strict';\n\nvar utils = require('./../utils');\nvar buildURL = require('../helpers/buildURL');\nvar InterceptorManager = require('./InterceptorManager');\nvar dispatchRequest = require('./dispatchRequest');\nvar mergeConfig = require('./mergeConfig');\n\n/**\n * Create a new instance of Axios\n *\n * @param {Object} instanceConfig The default config for the instance\n */\nfunction Axios(instanceConfig) {\n  this.defaults = instanceConfig;\n  this.interceptors = {\n    request: new InterceptorManager(),\n    response: new InterceptorManager()\n  };\n}\n\n/**\n * Dispatch a request\n *\n * @param {Object} config The config specific for this request (merged with this.defaults)\n */\nAxios.prototype.request = function request(config) {\n  /*eslint no-param-reassign:0*/\n  // Allow for axios('example/url'[, config]) a la fetch API\n  if (typeof config === 'string') {\n    config = arguments[1] || {};\n    config.url = arguments[0];\n  } else {\n    config = config || {};\n  }\n\n  config = mergeConfig(this.defaults, config);\n  config.method = config.method ? config.method.toLowerCase() : 'get';\n\n  // Hook up interceptors middleware\n  var chain = [dispatchRequest, undefined];\n  var promise = Promise.resolve(config);\n\n  this.interceptors.request.forEach(function unshiftRequestInterceptors(interceptor) {\n    chain.unshift(interceptor.fulfilled, interceptor.rejected);\n  });\n\n  this.interceptors.response.forEach(function pushResponseInterceptors(interceptor) {\n    chain.push(interceptor.fulfilled, interceptor.rejected);\n  });\n\n  while (chain.length) {\n    promise = promise.then(chain.shift(), chain.shift());\n  }\n\n  return promise;\n};\n\nAxios.prototype.getUri = function getUri(config) {\n  config = mergeConfig(this.defaults, config);\n  return buildURL(config.url, config.params, config.paramsSerializer).replace(/^\\?/, '');\n};\n\n// Provide aliases for supported request methods\nutils.forEach(['delete', 'get', 'head', 'options'], function forEachMethodNoData(method) {\n  /*eslint func-names:0*/\n  Axios.prototype[method] = function(url, config) {\n    return this.request(utils.merge(config || {}, {\n      method: method,\n      url: url\n    }));\n  };\n});\n\nutils.forEach(['post', 'put', 'patch'], function forEachMethodWithData(method) {\n  /*eslint func-names:0*/\n  Axios.prototype[method] = function(url, data, config) {\n    return this.request(utils.merge(config || {}, {\n      method: method,\n      url: url,\n      data: data\n    }));\n  };\n});\n\nmodule.exports = Axios;\n","'use strict';\n\nvar utils = require('./../utils');\n\nfunction InterceptorManager() {\n  this.handlers = [];\n}\n\n/**\n * Add a new interceptor to the stack\n *\n * @param {Function} fulfilled The function to handle `then` for a `Promise`\n * @param {Function} rejected The function to handle `reject` for a `Promise`\n *\n * @return {Number} An ID used to remove interceptor later\n */\nInterceptorManager.prototype.use = function use(fulfilled, rejected) {\n  this.handlers.push({\n    fulfilled: fulfilled,\n    rejected: rejected\n  });\n  return this.handlers.length - 1;\n};\n\n/**\n * Remove an interceptor from the stack\n *\n * @param {Number} id The ID that was returned by `use`\n */\nInterceptorManager.prototype.eject = function eject(id) {\n  if (this.handlers[id]) {\n    this.handlers[id] = null;\n  }\n};\n\n/**\n * Iterate over all the registered interceptors\n *\n * This method is particularly useful for skipping over any\n * interceptors that may have become `null` calling `eject`.\n *\n * @param {Function} fn The function to call for each interceptor\n */\nInterceptorManager.prototype.forEach = function forEach(fn) {\n  utils.forEach(this.handlers, function forEachHandler(h) {\n    if (h !== null) {\n      fn(h);\n    }\n  });\n};\n\nmodule.exports = InterceptorManager;\n","'use strict';\n\nvar utils = require('./../utils');\nvar transformData = require('./transformData');\nvar isCancel = require('../cancel/isCancel');\nvar defaults = require('../defaults');\nvar isAbsoluteURL = require('./../helpers/isAbsoluteURL');\nvar combineURLs = require('./../helpers/combineURLs');\n\n/**\n * Throws a `Cancel` if cancellation has been requested.\n */\nfunction throwIfCancellationRequested(config) {\n  if (config.cancelToken) {\n    config.cancelToken.throwIfRequested();\n  }\n}\n\n/**\n * Dispatch a request to the server using the configured adapter.\n *\n * @param {object} config The config that is to be used for the request\n * @returns {Promise} The Promise to be fulfilled\n */\nmodule.exports = function dispatchRequest(config) {\n  throwIfCancellationRequested(config);\n\n  // Support baseURL config\n  if (config.baseURL && !isAbsoluteURL(config.url)) {\n    config.url = combineURLs(config.baseURL, config.url);\n  }\n\n  // Ensure headers exist\n  config.headers = config.headers || {};\n\n  // Transform request data\n  config.data = transformData(\n    config.data,\n    config.headers,\n    config.transformRequest\n  );\n\n  // Flatten headers\n  config.headers = utils.merge(\n    config.headers.common || {},\n    config.headers[config.method] || {},\n    config.headers || {}\n  );\n\n  utils.forEach(\n    ['delete', 'get', 'head', 'post', 'put', 'patch', 'common'],\n    function cleanHeaderConfig(method) {\n      delete config.headers[method];\n    }\n  );\n\n  var adapter = config.adapter || defaults.adapter;\n\n  return adapter(config).then(function onAdapterResolution(response) {\n    throwIfCancellationRequested(config);\n\n    // Transform response data\n    response.data = transformData(\n      response.data,\n      response.headers,\n      config.transformResponse\n    );\n\n    return response;\n  }, function onAdapterRejection(reason) {\n    if (!isCancel(reason)) {\n      throwIfCancellationRequested(config);\n\n      // Transform response data\n      if (reason && reason.response) {\n        reason.response.data = transformData(\n          reason.response.data,\n          reason.response.headers,\n          config.transformResponse\n        );\n      }\n    }\n\n    return Promise.reject(reason);\n  });\n};\n","'use strict';\n\nvar utils = require('./../utils');\n\n/**\n * Transform the data for a request or a response\n *\n * @param {Object|String} data The data to be transformed\n * @param {Array} headers The headers for the request or response\n * @param {Array|Function} fns A single function or Array of functions\n * @returns {*} The resulting transformed data\n */\nmodule.exports = function transformData(data, headers, fns) {\n  /*eslint no-param-reassign:0*/\n  utils.forEach(fns, function transform(fn) {\n    data = fn(data, headers);\n  });\n\n  return data;\n};\n","'use strict';\n\nvar utils = require('../utils');\n\nmodule.exports = function normalizeHeaderName(headers, normalizedName) {\n  utils.forEach(headers, function processHeader(value, name) {\n    if (name !== normalizedName && name.toUpperCase() === normalizedName.toUpperCase()) {\n      headers[normalizedName] = value;\n      delete headers[name];\n    }\n  });\n};\n","'use strict';\n\nvar createError = require('./createError');\n\n/**\n * Resolve or reject a Promise based on response status.\n *\n * @param {Function} resolve A function that resolves the promise.\n * @param {Function} reject A function that rejects the promise.\n * @param {object} response The response.\n */\nmodule.exports = function settle(resolve, reject, response) {\n  var validateStatus = response.config.validateStatus;\n  if (!validateStatus || validateStatus(response.status)) {\n    resolve(response);\n  } else {\n    reject(createError(\n      'Request failed with status code ' + response.status,\n      response.config,\n      null,\n      response.request,\n      response\n    ));\n  }\n};\n","'use strict';\n\n/**\n * Update an Error with the specified config, error code, and response.\n *\n * @param {Error} error The error to update.\n * @param {Object} config The config.\n * @param {string} [code] The error code (for example, 'ECONNABORTED').\n * @param {Object} [request] The request.\n * @param {Object} [response] The response.\n * @returns {Error} The error.\n */\nmodule.exports = function enhanceError(error, config, code, request, response) {\n  error.config = config;\n  if (code) {\n    error.code = code;\n  }\n\n  error.request = request;\n  error.response = response;\n  error.isAxiosError = true;\n\n  error.toJSON = function() {\n    return {\n      // Standard\n      message: this.message,\n      name: this.name,\n      // Microsoft\n      description: this.description,\n      number: this.number,\n      // Mozilla\n      fileName: this.fileName,\n      lineNumber: this.lineNumber,\n      columnNumber: this.columnNumber,\n      stack: this.stack,\n      // Axios\n      config: this.config,\n      code: this.code\n    };\n  };\n  return error;\n};\n","'use strict';\n\nvar utils = require('./../utils');\n\n// Headers whose duplicates are ignored by node\n// c.f. https://nodejs.org/api/http.html#http_message_headers\nvar ignoreDuplicateOf = [\n  'age', 'authorization', 'content-length', 'content-type', 'etag',\n  'expires', 'from', 'host', 'if-modified-since', 'if-unmodified-since',\n  'last-modified', 'location', 'max-forwards', 'proxy-authorization',\n  'referer', 'retry-after', 'user-agent'\n];\n\n/**\n * Parse headers into an object\n *\n * ```\n * Date: Wed, 27 Aug 2014 08:58:49 GMT\n * Content-Type: application/json\n * Connection: keep-alive\n * Transfer-Encoding: chunked\n * ```\n *\n * @param {String} headers Headers needing to be parsed\n * @returns {Object} Headers parsed into an object\n */\nmodule.exports = function parseHeaders(headers) {\n  var parsed = {};\n  var key;\n  var val;\n  var i;\n\n  if (!headers) { return parsed; }\n\n  utils.forEach(headers.split('\\n'), function parser(line) {\n    i = line.indexOf(':');\n    key = utils.trim(line.substr(0, i)).toLowerCase();\n    val = utils.trim(line.substr(i + 1));\n\n    if (key) {\n      if (parsed[key] && ignoreDuplicateOf.indexOf(key) >= 0) {\n        return;\n      }\n      if (key === 'set-cookie') {\n        parsed[key] = (parsed[key] ? parsed[key] : []).concat([val]);\n      } else {\n        parsed[key] = parsed[key] ? parsed[key] + ', ' + val : val;\n      }\n    }\n  });\n\n  return parsed;\n};\n","'use strict';\n\nvar utils = require('./../utils');\n\nmodule.exports = (\n  utils.isStandardBrowserEnv() ?\n\n  // Standard browser envs have full support of the APIs needed to test\n  // whether the request URL is of the same origin as current location.\n    (function standardBrowserEnv() {\n      var msie = /(msie|trident)/i.test(navigator.userAgent);\n      var urlParsingNode = document.createElement('a');\n      var originURL;\n\n      /**\n    * Parse a URL to discover it's components\n    *\n    * @param {String} url The URL to be parsed\n    * @returns {Object}\n    */\n      function resolveURL(url) {\n        var href = url;\n\n        if (msie) {\n        // IE needs attribute set twice to normalize properties\n          urlParsingNode.setAttribute('href', href);\n          href = urlParsingNode.href;\n        }\n\n        urlParsingNode.setAttribute('href', href);\n\n        // urlParsingNode provides the UrlUtils interface - http://url.spec.whatwg.org/#urlutils\n        return {\n          href: urlParsingNode.href,\n          protocol: urlParsingNode.protocol ? urlParsingNode.protocol.replace(/:$/, '') : '',\n          host: urlParsingNode.host,\n          search: urlParsingNode.search ? urlParsingNode.search.replace(/^\\?/, '') : '',\n          hash: urlParsingNode.hash ? urlParsingNode.hash.replace(/^#/, '') : '',\n          hostname: urlParsingNode.hostname,\n          port: urlParsingNode.port,\n          pathname: (urlParsingNode.pathname.charAt(0) === '/') ?\n            urlParsingNode.pathname :\n            '/' + urlParsingNode.pathname\n        };\n      }\n\n      originURL = resolveURL(window.location.href);\n\n      /**\n    * Determine if a URL shares the same origin as the current location\n    *\n    * @param {String} requestURL The URL to test\n    * @returns {boolean} True if URL shares the same origin, otherwise false\n    */\n      return function isURLSameOrigin(requestURL) {\n        var parsed = (utils.isString(requestURL)) ? resolveURL(requestURL) : requestURL;\n        return (parsed.protocol === originURL.protocol &&\n            parsed.host === originURL.host);\n      };\n    })() :\n\n  // Non standard browser envs (web workers, react-native) lack needed support.\n    (function nonStandardBrowserEnv() {\n      return function isURLSameOrigin() {\n        return true;\n      };\n    })()\n);\n","'use strict';\n\nvar utils = require('./../utils');\n\nmodule.exports = (\n  utils.isStandardBrowserEnv() ?\n\n  // Standard browser envs support document.cookie\n    (function standardBrowserEnv() {\n      return {\n        write: function write(name, value, expires, path, domain, secure) {\n          var cookie = [];\n          cookie.push(name + '=' + encodeURIComponent(value));\n\n          if (utils.isNumber(expires)) {\n            cookie.push('expires=' + new Date(expires).toGMTString());\n          }\n\n          if (utils.isString(path)) {\n            cookie.push('path=' + path);\n          }\n\n          if (utils.isString(domain)) {\n            cookie.push('domain=' + domain);\n          }\n\n          if (secure === true) {\n            cookie.push('secure');\n          }\n\n          document.cookie = cookie.join('; ');\n        },\n\n        read: function read(name) {\n          var match = document.cookie.match(new RegExp('(^|;\\\\s*)(' + name + ')=([^;]*)'));\n          return (match ? decodeURIComponent(match[3]) : null);\n        },\n\n        remove: function remove(name) {\n          this.write(name, '', Date.now() - 86400000);\n        }\n      };\n    })() :\n\n  // Non standard browser env (web workers, react-native) lack needed support.\n    (function nonStandardBrowserEnv() {\n      return {\n        write: function write() {},\n        read: function read() { return null; },\n        remove: function remove() {}\n      };\n    })()\n);\n","'use strict';\n\n/**\n * Determines whether the specified URL is absolute\n *\n * @param {string} url The URL to test\n * @returns {boolean} True if the specified URL is absolute, otherwise false\n */\nmodule.exports = function isAbsoluteURL(url) {\n  // A URL is considered absolute if it begins with \"<scheme>://\" or \"//\" (protocol-relative URL).\n  // RFC 3986 defines scheme name as a sequence of characters beginning with a letter and followed\n  // by any combination of letters, digits, plus, period, or hyphen.\n  return /^([a-z][a-z\\d\\+\\-\\.]*:)?\\/\\//i.test(url);\n};\n","'use strict';\n\n/**\n * Creates a new URL by combining the specified URLs\n *\n * @param {string} baseURL The base URL\n * @param {string} relativeURL The relative URL\n * @returns {string} The combined URL\n */\nmodule.exports = function combineURLs(baseURL, relativeURL) {\n  return relativeURL\n    ? baseURL.replace(/\\/+$/, '') + '/' + relativeURL.replace(/^\\/+/, '')\n    : baseURL;\n};\n","'use strict';\n\nvar Cancel = require('./Cancel');\n\n/**\n * A `CancelToken` is an object that can be used to request cancellation of an operation.\n *\n * @class\n * @param {Function} executor The executor function.\n */\nfunction CancelToken(executor) {\n  if (typeof executor !== 'function') {\n    throw new TypeError('executor must be a function.');\n  }\n\n  var resolvePromise;\n  this.promise = new Promise(function promiseExecutor(resolve) {\n    resolvePromise = resolve;\n  });\n\n  var token = this;\n  executor(function cancel(message) {\n    if (token.reason) {\n      // Cancellation has already been requested\n      return;\n    }\n\n    token.reason = new Cancel(message);\n    resolvePromise(token.reason);\n  });\n}\n\n/**\n * Throws a `Cancel` if cancellation has been requested.\n */\nCancelToken.prototype.throwIfRequested = function throwIfRequested() {\n  if (this.reason) {\n    throw this.reason;\n  }\n};\n\n/**\n * Returns an object that contains a new `CancelToken` and a function that, when called,\n * cancels the `CancelToken`.\n */\nCancelToken.source = function source() {\n  var cancel;\n  var token = new CancelToken(function executor(c) {\n    cancel = c;\n  });\n  return {\n    token: token,\n    cancel: cancel\n  };\n};\n\nmodule.exports = CancelToken;\n","'use strict';\n\n/**\n * Syntactic sugar for invoking a function and expanding an array for arguments.\n *\n * Common use case would be to use `Function.prototype.apply`.\n *\n *  ```js\n *  function f(x, y, z) {}\n *  var args = [1, 2, 3];\n *  f.apply(null, args);\n *  ```\n *\n * With `spread` this example can be re-written.\n *\n *  ```js\n *  spread(function(x, y, z) {})([1, 2, 3]);\n *  ```\n *\n * @param {Function} callback\n * @returns {Function}\n */\nmodule.exports = function spread(callback) {\n  return function wrap(arr) {\n    return callback.apply(null, arr);\n  };\n};\n","/**\r\n * Represents a frame for programmatic access to object frame, anywhere within a document\r\n * Recursive data structure where this.children contains an indexed array of object frames\r\n * and this.dataframes contains a property indexed array of data frames\r\n * Every object frame carries a reference to its classframe\r\n * This gives us instructions as to how to create new frames according to the schema\r\n * After that it's turtles all the way down.\r\n * @param cls - ID of the class (URL)\r\n * @param classframe - an array of frames representing a class\r\n * @param archetypes list of class frames\r\n * @param parent parent object\r\n * @returns\r\n */\r\nconst FrameHelper = require('./frameHelper');\r\nconst FramePattern = require('./framePattern');\r\n\r\nfunction ObjectFrame(cls, dataframes, classframes, parent, parentframe) {\r\n\t// the class of the frame - mandatory\r\n\tthis.empty();\r\n\tthis.cls = cls;\r\n\r\n\t// array of frames representing the full class frame\r\n\t// (optional - required to be able to safely add missing properties)\r\n\tif (classframes && typeof classframes === 'object') {\r\n\t\tthis.loadClassFrames(classframes);\r\n\t}\r\n\tif (dataframes && typeof dataframes === 'object') {\r\n\t\tthis.originalFrames = dataframes;\r\n\t\tthis.loadDataFrames(dataframes);\r\n\t} else {\r\n\t\tthis.originalFrames = false;\r\n\t}\r\n\t// parent object frame\r\n\tthis.parent = parent;\r\n\t// original frame used by parent to create me\r\n\tthis.parentframe = parentframe;\r\n\t// set to true if this is a newly created document\r\n\tthis.newDoc = false;\r\n}\r\n\r\n/**\r\n * Loads class frames for the object's class - the instructions about how to put an object together\r\n */\r\nObjectFrame.prototype.loadClassFrames = function (classframes) {\r\n\tfor (let j = 0; j < classframes.length; j += 1) {\r\n\t\tif (classframes[j]['@context']) this.jsonld_context = classframes[j]['@context'];\r\n\r\n\t\tconst cf = new ClassFrame(classframes[j]);\r\n\t\tif (cf.isValid()) {\r\n\t\t\tif (typeof this.classframes[classframes[j].property] === 'undefined') {\r\n\t\t\t\tthis.classframes[classframes[j].property] = [];\r\n\t\t\t}\r\n\t\t\tthis.classframes[classframes[j].property] = cf;\r\n\t\t\tif (cf.isObject() && this.properties[classframes[j].property]) {\r\n\t\t\t\tfor (let i = 0; i < this.properties[classframes[j].property].values.length; i += 1) {\r\n\t\t\t\t\tthis.properties[classframes[j].property].values[i].loadClassFrames(classframes[j].frame);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn this;\r\n};\r\n\r\n/**\r\n * Does this object have a schema loaded?\r\n */\r\nObjectFrame.prototype.hasSchema = function () {\r\n\treturn !FrameHelper.empty(this.classframes);\r\n};\r\n\r\n/*\r\n * Loads an array of data frames into the object's internal index\r\n * {property: [frames]}\r\n */\r\nObjectFrame.prototype.loadDataFrames = function (frames) {\r\n\tif (typeof frames !== 'object' || !frames.length) return undefined;\r\n\tif (!this.originalFrames) this.originalFrames = frames;\r\n\tif (!this.subjid && frames[0].domainValue) this.subjid = frames[0].domainValue;\r\n\tfor (let i = 0; i < frames.length; i += 1) {\r\n\t\tif (frames[i]['@context']) this.jsonld_context = frames[i]['@context'];\r\n\t\tlet cframe = this.getPropertyClassFrame(frames[i].property, frames[i]);\r\n\t\tif (cframe.isClassChoice()) {\r\n\t\t\tcframe = cframe.getChosenClassFrame(frames[i].range);\r\n\t\t\tif (!cframe) {\r\n\t\t\t\tconsole.log(`no choice frame ${frames[i].range}`);\r\n\t\t\t}\r\n\t\t} else if (cframe.isLogic()) {\r\n\t\t\tcframe = cframe.getChosenFrame(frames[i]);\r\n\t\t}\r\n\t\tif(cframe){\r\n\t\t\tif (typeof this.properties[frames[i].property] === 'undefined') {\r\n\t\t\t\tthis.properties[frames[i].property] = new PropertyFrame(frames[i].property, cframe, this);\r\n\t\t\t}\r\n\t\t\tthis.properties[frames[i].property].addFrame(frames[i])\r\n\t\t}\r\n\t}\r\n\treturn this;\r\n};\r\n\r\n/*\r\n * Serialises the javascript object as an array of frames\r\n */\r\nObjectFrame.prototype.getAsFrame = function (prop, parent) {\r\n\tif (this.parentframe) return this.parentframe;\r\n\tconst ff = { type: 'objectProperty', property: prop };\r\n\tff.range = this.cls;\r\n\tff.domain = parent.cls;\r\n\tff.domainValue = parent.subjid;\r\n\tff.frame = [];\r\n\tfor (const prop of Object.keys(this.properties)) {\r\n\t\tff.frame = ff.frame.concat(ff.frame, this.properties[prop].getAsFrames())\r\n\t}\r\n\treturn ff;\r\n};\r\n\r\nObjectFrame.prototype.isnew = function () {\r\n\treturn this.newDoc;\r\n};\r\n\r\n/**\r\n * Cleans out object and sets everything empty\r\n */\r\nObjectFrame.prototype.empty = function () {\r\n\t// all indexed by property\r\n\tthis.properties = {};\r\n\tthis.restrictions = {};\r\n\tthis.subjid = false;\r\n\tthis.cls = false;\r\n};\r\n\r\n/*\r\n * Resets object state to original state\r\n */\r\nObjectFrame.prototype.reset = function (prop) {\r\n\tif (prop) {\r\n\t\tconst props = [];\r\n\t\tfor (let i = 0; i < this.originalFrames.length; i += 1) {\r\n\t\t\tif (this.originalFrames[i].property === prop) {\r\n\t\t\t\tprops.push(this.originalFrames[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (this.properties[prop]) this.properties[prop] = [];\r\n\t\tthis.loadDataFrames(props);\r\n\t} else {\r\n\t\tthis.restrictions = {};\r\n\t\tthis.properties = {};\r\n\t\tthis.loadDataFrames(this.originalFrames);\r\n\t}\r\n};\r\n\r\n/*\r\n * Clears out any specific information from a tree\r\n */\r\nObjectFrame.prototype.clear = function () {\r\n\tfor (const prop of Object.keys(this.properties)) {\r\n\t\tthis.properties[prop].clear();\r\n\t}\r\n\treturn this;\r\n};\r\n\r\n/*\r\n * Filters the frame and its children\r\n */\r\nObjectFrame.prototype.filter = function (rules, onmatch, options) {\r\n\tconst cascading = (options && options.ignore_failure ? true : false);\r\n\tvar hits = FramePattern.FramePatternMatcher.testRules(rules, this, onmatch);\r\n\tif(hits.length || cascading){\r\n\t\tfor (const prop of Object.keys(this.properties)) {\r\n\t\t\tthis.properties[prop].filter(rules, onmatch, options);\r\n\t\t}\t\r\n\t}\r\n\treturn this;\r\n};\r\n\r\n\r\n\r\n/**\r\n * If a class frame is present, it is returned for the given property\r\n * If no class frame is present and an instance frame is passed in the\r\n * this enables make it up as you go along editing\r\n * second argument a class frame will be created from the instance frame.\r\n */\r\nObjectFrame.prototype.getPropertyClassFrame = function (prop, instance) {\r\n\tif (this.classframes && typeof this.classframes === 'object' && typeof this.classframes[prop] === 'object') {\r\n\t\treturn this.classframes[prop];\r\n\t}\r\n\tif (instance) {\r\n\t\tconst cf = new ClassFrame(instance);\r\n\t\treturn cf;\r\n\t}\r\n\tif(this.properties[prop]){\r\n\t\treturn new ClassFrame(this.properties[prop].values[0]);\r\n\t}\r\n\treturn false;\r\n};\r\n\r\n/*\r\n * Returns a list of properties - type can be filled|missing|all\r\n */\r\nObjectFrame.prototype.getProperties = function (type) {\r\n\tif(type == \"filled\" || !this.classframes){\r\n\t\treturn Object.keys(this.properties);\r\n\t}\r\n\tif(type == \"missing\"){\r\n\t\tvar filled = Object.keys(this.properties);\r\n\t\tvar all = Object.keys(this.classframes);\r\n\t\tvar missing = [];\r\n\t\tfor(var i = 0; i<all.length; i++){\r\n\t\t\tif(filled.indexOf(all[i]) == -1 && missing.indexOf(all[i]) ==-1){\r\n\t\t\t\tmissing.push(all[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn missing;\r\n\t}\r\n\treturn Object.keys(this.classframes);\r\n}\r\n\r\n/**\r\n * Missing properties are those that are present in the classframe,\r\n * but not instantiated in the current object frame\r\n * for this to work we need to load the frame with the associated classframe\r\n */\r\nObjectFrame.prototype.getMissingPropertyList = function () {\r\n\tvar missing = this.getProperties(\"missing\");\r\n\tconst nmissing = [];\r\n\tfor(var i = 0; i<missing.length; i++){\r\n\t\tconst cframe = this.getPropertyClassFrame(missing[i]);\r\n\t\tconst newb = { label: cframe.getLabel(), value: missing[i]};\r\n\t\tnmissing.push(newb);\r\n\t}\r\n\treturn nmissing;\r\n};\r\n\r\n/**\r\n * List of properties that are filled in the object\r\n */\r\nObjectFrame.prototype.getFilledPropertyList = function () {\r\n\tvar props = this.getProperties(\"filled\");\r\n\tconst filled = [];\r\n\tfor(var i = 0; i<props.length; i++){\r\n\t\tconst cframe = this.getPropertyClassFrame(props[i]);\r\n\t\tconst newb = { label: cframe.getLabel(), value: props[i]};\r\n\t\tfilled.push(newb);\r\n\t}\r\n\treturn filled;\r\n};\r\n\r\n/*\r\n * Fills the object frame from the schema - adding all the necessary property frames, etc to make it complete\r\n */\r\nObjectFrame.prototype.fillFromSchema = function (newid) {\r\n\tif (newid) this.subjid = newid;\r\n\tnewid = (newid ? newid : FrameHelper.genBNID());\r\n\tlet properties = {};\r\n\tfor (const prop of Object.keys(this.classframes)) {\r\n\t\tconst pf = this.getPropertyClassFrame(prop);\r\n\t\tproperties[prop] = new PropertyFrame(prop, pf);\r\n\t\tproperties[prop].fillFromSchema(newid);\r\n\t}\r\n\tthis.properties = properties;\r\n\tthis.originalFrames = [];\r\n\tfor (const prop of Object.keys(this.properties)) {\r\n\t\tthis.originalFrames.push(this.properties[prop].getAsFrames());\r\n\t}\r\n\treturn this;\r\n};\r\n\r\n/*\r\n * Clones an object frame to be a copy of the current frame\r\n */\r\nObjectFrame.prototype.clone = function (newid) {\r\n\tconst properties = {};\r\n\tconst cloned = new ObjectFrame(this.cls, false, false, this.parent);\r\n\tcloned.classframes = this.classframes;\r\n\tcloned.subjid = newid;\r\n\tfor (const prop of Object.keys(this.properties)) {\r\n\t\tproperties[prop] = this.properties[prop].clone();\r\n\t}\r\n\tcloned.properties = properties;\r\n\treturn cloned;\r\n};\r\n\r\n\r\n/**\r\n * Returns a child frame with a particular id\r\n * If the second parameter is included, it will only look in that specific property\r\n * Otherwise searches all properties for the child\r\n */\r\nObjectFrame.prototype.getChild = function (childid, prop) {\r\n\tvar pframe = this.getProperty(prop);\r\n\tfor(var i = 0; i<pframe.values.length; pframe++){\r\n\t\tif(pframe.values[i].isObject() && pframe.values[i].subject === childid) return pframe.values[i];\r\n\t}\r\n\tif (!prop) {\r\n\t\tfor (const key of Object.keys(this.properties)) {\r\n\t\t\tfor (let i = 0; i < this.properties[key].values.length; i += 1) {\r\n\t\t\t\tif (this.properties[key].values[i].subject() === childid) return this.properties[key].values[i];\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nObjectFrame.prototype.addProperty = function (prop, cls) {\r\n\tconst cframe = this.getPropertyClassFrame(prop);\r\n\tconst nprop = new PropertyFrame(prop, cframe);\r\n\tif (nprop.isData()) {\r\n\t\tconst df = cframe.copy();\r\n\t\tdf.set('');\r\n\t}\r\n\tif (cframe.isObject()) {\r\n\t\tif (!cframe.isClassChoice()) {\r\n\t\t\tconst df = cframe.createEmpty(FrameHelper.genBNID());\r\n\t\t}\r\n\t\tif (cls) {\r\n\t\t\tconst df = cframe.createEmptyChoice(cls, FrameHelper.genBNID());\r\n\t\t}\r\n\t\tconst clss = cframe.getClassChoices();\r\n\t\tif (clss && clss.length) {\r\n\t\t\tconst df = cframe.createEmptyChoice(clss[0], FrameHelper.genBNID());\r\n\t\t}\r\n\t}\r\n\tif(typeof this.properties[prop] == \"undefined\"){\r\n\t\tthis.properties[prop] = [];\r\n\t}\r\n\tthis.properties[prop].push(df);\r\n\treturn df;\r\n};\r\n\r\nObjectFrame.prototype.addPropertyValue = function (prop, value) {\r\n\tconst pframe = this.properties[prop];\r\n\treturn pframe.addValue(value);\r\n};\r\n\r\nObjectFrame.prototype.removeProperty = function (prop) {\r\n\tif (typeof this.properties[prop] !== 'undefined') {\r\n\t\tdelete (this.properties[prop]);\r\n\t}\r\n};\r\n\r\nObjectFrame.prototype.removePropertyValue = function (prop, value, index) {\r\n\tconst pframe = this.properties[prop];\r\n\tpframe.removeValue(value, index);\r\n\tif(pframe.values.length == 0){\r\n\t\tthis.removeProperty(prop);\r\n\t}\r\n};\r\n\r\nObjectFrame.prototype.error = function (msg) {\r\n\tconsole.error(msg);\r\n};\r\n\r\n\r\nObjectFrame.prototype.subject = function(){\r\n\treturn this.subjid;\r\n}\r\n\r\nObjectFrame.prototype.get = ObjectFrame.prototype.subject;\r\n\r\nObjectFrame.prototype.isObject = function () { return true; };\r\nObjectFrame.prototype.isProperty = function () { return false; };\r\nObjectFrame.prototype.isData = function () { return false; };\r\n\r\n\r\nObjectFrame.prototype.subjectClass = function(){\r\n\treturn this.cls;\r\n}\r\n\r\nObjectFrame.prototype.depth = function(){\r\n\tif(this.parent) return (this.parent.depth() + 1);\r\n\treturn 0;\r\n}\r\n\r\nObjectFrame.prototype.getProperty = function(prop){\r\n\treturn this.properties[prop];\r\n}\r\n\r\nObjectFrame.prototype.first = function(prop){\r\n\tif(this.properties && this.properties[prop]){\r\n\t\treturn this.properties[prop].first();\r\n\t}\r\n}\r\n\r\nObjectFrame.prototype.property = function(prop){\r\n\tif(this.parent) return this.parent.property();\r\n\treturn false;\r\n}\r\n\r\nObjectFrame.prototype.parentObject = function(){\r\n\tif(this.parent && this.parent.parent){\r\n\t\treturn this.parent.parent;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nObjectFrame.prototype.root = function(){\r\n\tif(this.parent) return false;\r\n\treturn true;\r\n}\r\n\r\nObjectFrame.prototype.renderProperties = function(){\r\n\tvar props = this.sortProperties();\r\n\tvar nprops = [];\r\n\tfor(var i = 0; i<props.length; i++){\r\n\t\tif(this.properties[props[i]].render){\r\n\t\t\tvar rend = this.properties[props[i]].render(this.properties[props[i]]);\r\n\t\t\tif(rend) nprops.push(rend);\r\n\t\t}\r\n\t}\r\n\treturn nprops;\r\n}\r\n\r\nObjectFrame.prototype.sortProperties = function(){\r\n\tconst unsorted = Object.keys(this.properties);\r\n\tif(this.compare){\r\n\t\treturn unsorted.sort((a, b) => {\r\n\t\t\treturn this.compare(a, b, this)\r\n\t\t});\r\n\t}\r\n\treturn unsorted.sort((a, b) => {\r\n\t\treturn this.standardCompare(a, b, this);\r\n\t})\r\n}\r\n\r\n/*\r\n * Label first, then datatype properties, then object properties\r\n */\r\nObjectFrame.prototype.standardCompare = function(a, b, doc){\r\n\tif(a == \"rdfs:label\") return -1;\r\n\tif(b == \"rdfs:label\") return 1;\r\n\tif(a == \"rdfs:comment\") return -1;\r\n\tif(b == \"rdfs:comment\") return 1;\r\n\tif(doc.properties[a].isData() && doc.properties[b].isObject() ) return -1;\r\n\tif(doc.properties[b].isData() && doc.properties[a].isObject() ) return 1;\r\n\treturn 0;\r\n}\r\n\r\nObjectFrame.prototype.cardControlAllows = function(action){\r\n\tif(!this.parent) return true;\r\n\tif(this.parent.cframe.hasRestriction()){\r\n\t\tvar rest = this.parent.cframe.restriction;\r\n\t\tvar currentnum = this.parent.values.length;\r\n\t\tif(action == \"add\" || action == \"clone\"){\r\n\t\t\tif(rest.max && currentnum >= rest.max){\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(action == \"delete\" && (rest.min && currentnum <= rest.min)){\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nObjectFrame.prototype.isUpdated = function(){\r\n\tvar i = 0;\r\n\tfor(var prop in this.properties){\r\n\t\tif(this.originalFrames[i] != prop) return true;\r\n\t\tif(this.properties[prop].isUpdated()) return true;\r\n\t\ti++;\r\n\t}\r\n\tif(i != this.originalFrames.length) return true;\r\n\treturn false;\r\n}\r\n\r\n\r\nObjectFrame.prototype.getSummary = function(){\r\n\tvar ret = { status: \"ok\" };\r\n\tif(this.isUpdated()) ret.status = \"updated\";\r\n\tif(this.isNew()) ret.status = \"new\";\r\n\tret.propcount = 0;\r\n\tfor(var prop in this.properties){\r\n\t\tret.propcount++;\r\n\t}\r\n\tret.long = ret.propcount + \" properties\";\r\n\treturn ret;\r\n}\r\n\r\nfunction PropertyFrame(property, cframe, parent){\r\n\tthis.predicate = property;\r\n\tthis.cframe = cframe;\r\n\tthis.parent = parent;\r\n\tthis.values = [];\r\n}\r\n\r\nPropertyFrame.prototype.addFrame = function (frame) {\r\n\tif(this.cframe.isData()){\r\n\t\tvar df = new DataFrame(frame, this, this.values.length);\r\n\t\tthis.values.push(df);\r\n\t}\r\n\telse {\r\n\t\tconst kid = new ObjectFrame(this.range(), cframe.frame, frame.frame, this, frame);\r\n\t\tthis.values.push(kid);\r\n\t}\r\n}\r\n\r\nPropertyFrame.prototype.fillFromSchema = function(newid){\r\n\tif (this.isData() || (this.isObject() && !this.isClassChoice())) {\r\n\t\tif (this.hasRestriction() && this.restriction.min) {\r\n\t\t\tvalues = [];\r\n\t\t\tfor (let i = 0; i < this.restriction.min; i += 1) {\r\n\t\t\t\tvalues.push(this.createEmpty(newid));\r\n\t\t\t}\r\n\t\t} \r\n\t\telse {\r\n\t\t\tvalues = [this.createEmpty(newid)];\r\n\t\t}\r\n\t} \r\n\telse if (this.isClassChoice()) {\r\n\t\tconst clss = this.getClassChoices();\r\n\t\tif (clss && clss.length) {\r\n\t\t\tconst empty = this.createEmptyChoice(clss[0], FrameHelper.genBNID());\r\n\t\t\tvalues = [empty];\r\n\t\t}\r\n\t}\r\n\tthis.values = values;\r\n}\r\n\r\nPropertyFrame.prototype.isData = function(){\r\n\treturn this.cframe.isData();\r\n}\r\n\r\nPropertyFrame.prototype.isObject = function () { \r\n\treturn this.cframe.isObject() \r\n};\r\n\r\nPropertyFrame.prototype.isProperty = function () { \r\n\treturn true; \r\n};\r\n\r\nPropertyFrame.prototype.property = function(){\r\n\treturn this.predicate;\r\n}\r\n\r\nPropertyFrame.prototype.extract = function(){\r\n \tvar extracts = [];\r\n \tfor(var i = 0; i<this.values.length; i++){\r\n \t\tvar val = this.values[i].extract();\r\n \t\tif(val !== \"\" && val !== false && typeof val != \"undefined\") extracts.push(val);\r\n \t}\r\n\treturn extracts;\r\n}\r\n\r\nPropertyFrame.prototype.subject = function(){\r\n\treturn (this.parent ? this.parent.subject() : false);\r\n}\r\nPropertyFrame.prototype.subjectClass = function(){\r\n\treturn (this.parent ? this.parent.subjectClass() : false);\r\n}\r\nPropertyFrame.prototype.depth = function(){\r\n\treturn (this.parent ? this.parent.depth() : false);\r\n}\r\nPropertyFrame.prototype.updated = function(){ \r\n\treturn (this.parent ? this.parent.childUpdated() : false);\r\n}\r\nPropertyFrame.prototype.range = function(){\t\r\n\treturn (this.cframe ? this.cframe.range : \"\");\r\n}\r\nPropertyFrame.prototype.getLabel = function(){ return (\r\n\t\tthis.cframe ? this.cframe.getLabel() : \"\" );\r\n}\r\nPropertyFrame.prototype.getComment = function(){ \r\n\treturn (this.cframe ? this.cframe.getComment() : false);\r\n}\r\nPropertyFrame.prototype.hasCardinalityRestriction = function(){\r\n\treturn (this.cframe ? this.cframe.hasRestriction() : false);\r\n}\r\nPropertyFrame.prototype.getRestriction = function(){\r\n\treturn (this.cframe ? this.cframe.restriction : false);\r\n}\r\nPropertyFrame.prototype.isClassChoice = function(){\t\r\n\treturn (this.cframe ? this.cframe.isClassChoice() : false);\r\n}\r\n\r\nPropertyFrame.prototype.deletePropertyValue = function(value, index){\r\n\tthis.parent.removePropertyValue(this.property(), value, index);\r\n}\r\n\r\nPropertyFrame.prototype.get = function(){\r\n\tvar gets = [];\r\n\tfor(var i = 0; i<this.values.length; i++){\r\n\t\tgets.push(this.values[i].get());\r\n\t}\r\n\treturn get;\r\n}\r\n\r\n\r\nPropertyFrame.prototype.clear = function(){\r\n\talert(\"need clear\");\r\n}\r\nPropertyFrame.prototype.clone = function(){\r\n\talert(\"need clone\");\r\n}\r\n\r\nPropertyFrame.prototype.getAsFrames = function(){\r\n\talert(\"need gaf\");\r\n}\r\n\r\nPropertyFrame.prototype.createEmpty = function(){\r\n\talert(\"creatempty\");\r\n}\r\n\r\nPropertyFrame.prototype.filter = function (rules, onmatch, options) {\r\n\tconst cascading = (options && options.ignore_failure ? true : false);\r\n\tvar hits = FramePattern.FramePatternMatcher.testRules(rules, this, onmatch);\r\n\tif(hits.length || cascading){\r\n\t\tfor (var i = 0; i<this.values.length; i++){\r\n\t\t\tthis.values[i].filter(rules, onmatch, options);\r\n\t\t}\t\r\n\t}\r\n\treturn this;\t\r\n}\r\n\r\n/*\r\n * Shorthand functions to make it easier to access the underlying data\r\n */\r\n\r\nPropertyFrame.prototype.first = function(){\r\n\tif(this.values && this.values[0]){\r\n\t\treturn this.values[0].get();\r\n\t}\r\n}\r\n\r\nPropertyFrame.prototype.renderValues = function(){\r\n\tvar sortedVals = this.sortValues();\r\n\tvar vals = [];\r\n\tfor(var i = 0; i<sortedVals.length; i++){\r\n\t\tif(sortedVals[i].render){\r\n\t\t\tvar rend = sortedVals[i].render(sortedVals[i]);\r\n\t\t\tif(rend) vals.push(rend);\r\n\t\t}\r\n\t}\r\n\treturn vals;\r\n}\r\n\r\nPropertyFrame.prototype.sortValues = function(){\r\n\tif(this.compare){\r\n\t\treturn this.values.sort((a, b) => {\r\n\t\t\treturn this.compare(a, b, this)\r\n\t\t});\r\n\t}\r\n\treturn this.values;\r\n}\r\n\r\nPropertyFrame.prototype.cardControlAllows = function(action){\r\n\tif(this.cframe.hasRestriction()){\r\n\t\tvar rest = this.cframe.restriction;\r\n\t\tvar currentnum = this.values.length;\r\n\t\tif(action == \"add\" || action == \"clone\"){\r\n\t\t\tif(rest.max && currentnum >= rest.max){\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(action == \"delete\" && (rest.min)){\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nPropertyFrame.prototype.isUpdated = function(){\r\n\treturn true;\t\r\n\tif(this.values.length != this.originalValues.length) return true;\r\n\tfor(var i = 0 ; i < this.values.length; i++){\r\n\t\tif(this.cframe && this.cframe.isData()){\r\n\t\t\tif(this.values[i].value() != this.originalValues[i]){\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tif(this.values[i].subject() != this.originalValues[i]) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\tif(this.values[i].isUpdated()) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\n\r\nfunction DataFrame(frame, parent, index) {\r\n\tthis.err = false;\r\n\tthis.parent = parent;\r\n\t// the id of the object that owns this dataframe\r\n\tthis.subjid = (parent ? parent.subjid : false);\r\n\tthis.index = index;\r\n\tif (frame) {\r\n\t\tthis.load(frame);\r\n\t}\r\n}\r\n\r\nDataFrame.prototype.load = function (frame) {\r\n\tif (typeof frame !== 'object') {\r\n\t\tthis.error('No frame passed to load');\r\n\t\treturn;\r\n\t}\r\n\t// all the meta-data carried in frames:\r\n\tthis.type = frame.type;\r\n\tthis.predicate = frame.property;\r\n\tthis.range = frame.range;\r\n\tthis.rangeValue = frame.rangeValue;\r\n\tthis.domain = frame.domain;\r\n\tthis.domainValue = frame.domainValue;\r\n\tthis.frame = frame.frame;\r\n\tthis.label = frame.label;\r\n\tthis.comment = frame.comment;\r\n\tconst { restriction } = frame;\r\n\tthis.restriction = false;\r\n\tif (restriction && typeof restriction === 'object') {\r\n\t\tthis.restriction = new Restriction(restriction);\r\n\t}\r\n};\r\n\r\nDataFrame.prototype.filter = function (rules, onmatch) {\r\n\tFramePattern.FramePatternMatcher.testRules(rules, this, onmatch);\r\n\treturn this;\t\r\n}\r\n\r\nDataFrame.prototype.delete = function(){\r\n\tthis.parent.deletePropertyValue(this.get(), this.index);\r\n}\r\n\r\nDataFrame.prototype.save = function(){\r\n\tif(this.parent) {\r\n\t\tthis.parent.save();\r\n\t}\r\n}\r\n\r\nDataFrame.prototype.reset = function(){\r\n\tthis.set(this.originalValue);\r\n\t//this.redraw();\r\n}\r\n\r\nDataFrame.prototype.clone = function(){\r\n\tvar newb = this.parent.addPropertyValue(this.get());\r\n\tvar nrend = this.copy(newb);\r\n\tnrend.setNew();\r\n\tnrend.mode = \"edit\";\r\n\tnrend.index = this.parent.values.length;\r\n\tthis.parent.values.push(nrend);\r\n}\r\n\r\n\r\nDataFrame.prototype.depth = function(){return (this.parent ? this.parent.depth() : false);};\r\nDataFrame.prototype.property = function(){ return (this.parent ? this.parent.property() : false);};\r\nDataFrame.prototype.subject = function(){ return (this.parent ? this.parent.subject() : false);};\r\nDataFrame.prototype.subjectClass = function(){ return (this.parent ? this.parent.subjectClass() : false);};\r\nDataFrame.prototype.range = function(){\treturn (this.frame ? this.frame.range : false);};\r\n\r\nDataFrame.prototype.isValidType = function (dt) {\r\n\tconst vtypes = ['datatypeProperty', 'objectProperty', 'restriction '];\r\n\tif (vtypes.indexOf(dt) === -1) return false;\r\n\treturn true;\r\n};\r\n\r\n\r\nDataFrame.prototype.getAsFrame = function () {\r\n\t const ff = { type: this.type, property: this.property() };\r\n\t if (this.range) ff.range = this.range;\r\n\t if (this.rangeValue) ff.rangeValue = this.rangeValue;\r\n\t if (this.domain) ff.domain = this.domain;\r\n\t if (this.domainValue) ff.domainValue = this.domainValue;\r\n\t if (this.frame) ff.frame = this.frame;\r\n\t if (this.label) ff.label = this.label;\r\n\t if (this.comment) ff.comment = this.comment;\r\n\t return ff;\r\n};\r\n\r\nDataFrame.prototype.hasRestriction = function () {\r\n\t if (this.restriction) {\r\n\t\t return this.restriction.hasCardRestriction();\r\n\t }\r\n\t return false;\r\n};\r\n\r\nDataFrame.prototype.copy = function (newid) {\r\n\tconst copy = new DataFrame(this, this.parent);\r\n\tif (newid) copy.domainValue = newid;\r\n\treturn copy;\r\n};\r\n\r\nDataFrame.prototype.getLabel = function () {\r\n\tlet lab = '';\r\n\tif(this.predicate == \"rdfs:label\") return \"Label\";\r\n\tif(this.predicate == \"rdfs:comment\") return \"Comment\";\r\n\tif (this.label && typeof this.label === 'object') lab = this.label['@value'];\r\n\tif (this.label && typeof this.label === 'string') lab = this.label;\r\n\t// always return something\r\n\tif (!lab && this.property()) lab = FrameHelper.labelFromURL(this.property());\r\n\tif (!lab) lab = FrameHelper.labelFromURL(this.cls);\r\n\treturn lab;\r\n};\r\n\r\nDataFrame.prototype.getType = function () {\r\n\tif (this.range) return this.range;\r\n\tif (this.rangeValue && this.rangeValue.type) return this.rangeValue.type;\r\n\treturn false;\r\n};\r\n\r\nObjectFrame.prototype.getLabel = DataFrame.prototype.getLabel;\r\n\r\nDataFrame.prototype.getComment = function () {\r\n\tlet comment = '';\r\n\tif (this.comment && typeof this.comment === 'object') comment = this.comment['@value'];\r\n\tif (this.comment && typeof this.comment === 'string') comment = this.comment;\r\n\treturn comment;\r\n};\r\n\r\nObjectFrame.prototype.getComment = DataFrame.prototype.getComment;\r\n\r\n\r\nDataFrame.prototype.error = function (msg) {\r\n\tif (msg)\tthis.err = msg;\r\n\treturn this.err;\r\n};\r\n\r\nDataFrame.prototype.isValid = function () {\r\n\tif (!(this.type && this.isValidType(this.type))) {\r\n\t\tthis.error(`Missing or Illegal Frame Type ${this.type}`);\r\n\t\treturn false;\r\n\t}\r\n\tif (!(this.predicate)) {\r\n\t\tthis.error('Missing Frame Property');\r\n\t\treturn false;\r\n\t}\r\n\tif (!(this.domain)) {\r\n\t\tthis.error('Missing Frame Domain');\r\n\t\treturn false;\r\n\t}\r\n\tif (!(this.range)) {\r\n\t\tthis.error('Missing Frame Range');\r\n\t\treturn false;\r\n\t}\r\n\tif (this.isObjectProperty() && !(this.frame && typeof this.frame === 'object')) {\r\n\t\tthis.error('Missing Object Frame');\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n};\r\n\r\nDataFrame.prototype.isObjectProperty = function () {\r\n\treturn this.type === 'objectProperty';\r\n};\r\n\r\nDataFrame.prototype.isDatatypeProperty = function () {\r\n\treturn this.type === 'datatypeProperty';\r\n};\r\n\r\nDataFrame.prototype.isLogic = function () {\r\n\tif (this.type === 'and' || this.type === 'or' || this.type === 'xor') {\r\n\t\treturn true;\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nDataFrame.prototype.isRestriction = function () {\r\n\treturn this.type === 'restriction';\r\n};\r\n\r\nDataFrame.prototype.ftype = function () {\r\n\tif (this.isDocument()) return 'document';\r\n\tif (this.isDatatypeProperty()) return 'data';\r\n\tif (this.isChoice()) return 'oneOf';\r\n\tif (this.isObject()) return 'object';\r\n\tif (this.isLogic()) return 'logic';\r\n\tif (this.isClassChoice()) return 'class_choice';\r\n\treturn undefined;\r\n};\r\n\r\n\r\nDataFrame.prototype.isClassChoice = function () {\r\n\treturn (this.frame && this.frame.type === 'class_choice');\r\n};\r\n\r\nDataFrame.prototype.isString = function () {\r\n\tif (this.range === FrameHelper.getStdURL('xsd', 'string')) {\r\n\t\treturn true;\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nDataFrame.prototype.getChoiceOptions = function () {\r\n\tconst opts = [];\r\n\tfor (let i = 0; i < this.frame.elements.length; i += 1) {\r\n\t\tconst option = {};\r\n\t\tif (this.frame.elements[i].label) {\r\n\t\t\toption.label = this.frame.elements[i].label['@value'];\r\n\t\t} else {\r\n\t\t\toption.label = FrameHelper.labelFromURL(this.frame.elements[i].class);\r\n\t\t}\r\n\t\toption.value = this.frame.elements[i].class;\r\n\t\topts.push(option);\r\n\t}\r\n\treturn opts;\r\n};\r\n\r\nDataFrame.prototype.lang = function () {\r\n\treturn 'en';\r\n};\r\n\r\nDataFrame.prototype.isChoice = function () {\r\n\treturn (this.frame && this.frame.type === 'oneOf');\r\n};\r\n\r\nDataFrame.prototype.isDocument = function () {\r\n\treturn (this.frame && this.frame.type === 'document');\r\n};\r\n\r\nDataFrame.prototype.isData = function () {\r\n\treturn (this.isDocument() || this.isChoice() || this.isDatatypeProperty());\r\n};\r\n\r\nDataFrame.prototype.isObject = function () {\r\n\treturn (this.isObjectProperty() && this.frame && !(this.isChoice() || this.isDocument()));\r\n};\r\n\r\nDataFrame.prototype.isProperty = function () {\r\n\treturn false;\r\n};\r\n\r\nDataFrame.prototype.getTypeShorthand = function () {\r\n\tif (this.isDocument()) return 'document';\r\n\tif (this.isChoice()) return 'choice';\r\n\tconst sh = FrameHelper.getShorthand(this.getType());\r\n\treturn (sh || this.getType());\r\n};\r\n\r\nDataFrame.prototype.get = function () {\r\n\tif (this.contents) {\r\n\t\treturn this.contents;\r\n\t}\r\n\tif (this.isDatatypeProperty() && this.rangeValue && typeof this.rangeValue['@value'] !== 'undefined') {\r\n\t\treturn this.rangeValue['@value'];\r\n\t}\r\n\tif (this.isChoice() || this.isDocument()) {\r\n\t\treturn this.frame.domainValue;\r\n\t}\r\n\treturn '';\r\n};\r\n\r\nDataFrame.prototype.set = function (value, normalizer) {\r\n\tif (normalizer) value = normalizer(value, this);\r\n\tthis.contents = value;\r\n\tif (this.isChoice() || this.isDocument()) {\r\n\t\tthis.frame.domainValue = value;\r\n\t}\r\n\tif (this.isDatatypeProperty() && this.rangeValue) {\r\n\t\tthis.rangeValue['@value'] = value;\r\n\t}\r\n};\r\n\r\nDataFrame.prototype.clear = function () {\r\n\tif (this.isDocument() || this.isChoice() || this.isDatatypeProperty()) {\r\n\t\tthis.set('');\r\n\t}\r\n};\r\n\r\nDataFrame.prototype.cardControlAllows = function(action){\r\n\tif(this.parent.cframe.hasRestriction()){\r\n\t\tvar rest = this.parent.cframe.restriction;\r\n\t\tvar currentnum = this.parent.values.length;\r\n\t\tif(action == \"add\" || action == \"clone\"){\r\n\t\t\tif(rest.max && currentnum >= rest.max){\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(action == \"delete\" && (rest.min && currentnum <= rest.min)){\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\treturn true;\r\n}\r\n\r\n\r\n/*\r\n * Class frames represent the archetypal version of a property frame as returned by the class frame api\r\n */\r\nfunction ClassFrame(frame, parent) {\r\n\tthis.err = false;\r\n\tthis.parent = parent;\r\n\t// the id of the object that owns this dataframe\r\n\tthis.subjid = (parent ? parent.subjid : false);\r\n\tif (frame) {\r\n\t\tthis.load(frame);\r\n\t}\r\n}\r\n\r\nClassFrame.prototype = DataFrame.prototype;\r\n\r\nClassFrame.prototype.loadFromObjectFrame = function (par, child) {\r\n\t// all the meta-data carried in frames:\r\n\tthis.type = 'objectProperty';\r\n\tthis.predicate = par.property;\r\n\tthis.range = par.range;\r\n\tthis.rangeValue = child.subjid;\r\n\tthis.domain = par.cls;\r\n\tthis.domainValue = par.subjid;\r\n\tthis.label = par.getLabel();\r\n\tthis.comment = par.getComment();\r\n\tthis.restriction = par.restriction;\r\n};\r\n\r\nClassFrame.prototype.createEmptyChoice = function (cls, newid) {\r\n\tconst cf = this.getChosenClassFrames(cls);\r\n\tconst objframe = new ObjectFrame(cls);\r\n\tif (newid) objframe.subjid = newid;\r\n\tobjframe.loadClassFrames(cf);\r\n\tconst fframe = objframe.fillFromSchema();\r\n\treturn fframe;\r\n};\r\n\r\nClassFrame.prototype.getChosenClassFrames = function (chosen) {\r\n\tlet nc = [];\r\n\tfor (let i = 0; i < this.frame.operands.length; i += 1) {\r\n\t\tfor (let j = 0; j < this.frame.operands[i].length; j += 1) {\r\n\t\t\tif (chosen === this.frame.operands[i][j].domain) {\r\n\t\t\t\tnc = nc.concat(this.frame.operands[i][j]);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn nc;\r\n};\r\n\r\nClassFrame.prototype.createEmpty = function (newid) {\r\n\tif (this.isObject()) {\r\n\t\tconst objframe = new ObjectFrame(this.range);\r\n\t\tif (newid) objframe.subjid = newid;\r\n\t\tobjframe.loadClassFrames(this.frame);\r\n\t\tconst fframe = objframe.fillFromSchema();\r\n\t\treturn fframe;\r\n\t}\r\n\tif (this.isData()) {\r\n\t\tconst dataframe = this.copy();\r\n\t\tdataframe.set('');\r\n\t\treturn dataframe;\r\n\t}\r\n\treturn undefined;\r\n};\r\n\r\nClassFrame.prototype.cloneDataFrame = function (newid, other) {\r\n\treturn other;\r\n};\r\n\r\nClassFrame.prototype.clone = function (newid, other) {\r\n\tif (this.isObject()) {\r\n\t\tconsole.log('cannot clone class frame');\r\n\t} else if (this.isData()) {\r\n\t\treturn this.cloneDataFrame(newid, other);\r\n\t}\r\n\treturn undefined;\r\n};\r\n\r\nClassFrame.prototype.getClassChoices = function () {\r\n\tconst choices = [];\r\n\tif (this.frame.operands) {\r\n\t\tfor (let i = 0; i < this.frame.operands.length; i += 1) {\r\n\t\t\tfor (let j = 0; j < this.frame.operands[i].length; j += 1) {\r\n\t\t\t\tconst domcls = this.frame.operands[i][j].domain;\r\n\t\t\t\tif (domcls && choices.indexOf(domcls) === -1) {\r\n\t\t\t\t\tchoices.push(domcls);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn choices;\r\n};\r\n\r\nClassFrame.prototype.getChosenClassFrame = function (chosen) {\r\n\tfor (let i = 0; i < this.frame.operands.length; i += 1) {\r\n\t\tconst operand = this.frame.operands[i];\r\n\t\tif (operand.length) {\r\n\t\t\tfor (let j = 0; j < operand.length; j += 1) {\r\n\t\t\t\tif (operand[j] && (chosen === operand[j].domain)) {\r\n\t\t\t\t\tconst cf = new ClassFrame(operand);\r\n\t\t\t\t\treturn cf;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else if (operand.range && chosen === operand.range) {\r\n\t\t\tconst cf = new ClassFrame(operand);\r\n\t\t\treturn cf;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nClassFrame.prototype.getChosenFrame = function (dataframe) {\r\n\treturn dataframe;\r\n};\r\n\r\n\r\nfunction Restriction(restriction) {\r\n\tthis.min = 0;\r\n\tthis.max = 0;\r\n\tif (restriction) this.loadRestriction(restriction);\r\n}\r\n\r\nRestriction.prototype.hasCardRestriction = function () {\r\n\tif (this.min === 0 && this.max === 0) return false;\r\n\treturn true;\r\n};\r\n\r\nRestriction.prototype.loadRestriction = function (restriction) {\r\n\tif (typeof restriction.cardinality !== 'undefined') {\r\n\t\tthis.max = restriction.cardinality;\r\n\t\tthis.min = restriction.cardinality;\r\n\t} else if (typeof restriction.maxCardinality !== 'undefined') {\r\n\t\tthis.max = restriction.maxCardinality;\r\n\t} else if (typeof restriction.minCardinality !== 'undefined') {\r\n\t\tthis.min = restriction.minCardinality;\r\n\t} else if (typeof restriction.type !== 'undefined' && restriction.type === 'and' && typeof restriction.operands === 'object') {\r\n\t\tfor (let i = 0; i < restriction.operands.length; i += 1) {\r\n\t\t\tconst nrest = new Restriction(restriction.operands[i]);\r\n\t\t\tif (this.max === 0 && nrest.max > 0) this.max = nrest.max;\r\n\t\t\telse if (this.max > 0 && nrest.max > 0 && nrest.max < this.max) this.max = nrest.max;\r\n\t\t\tif (this.min === 0 && nrest.min > 0) this.min = nrest.min;\r\n\t\t\telse if (this.min > 0 && nrest.min > 0 && nrest.min > this.min) this.min = nrest.min;\r\n\t\t}\r\n\t}\r\n};\r\n\r\nmodule.exports = ObjectFrame;\r\n","const FrameHelper = require(\"./frameHelper\");\r\n\r\nfunction WOQLResult(results, query, config){\r\n\tthis.bindings = results.bindings;\r\n\tthis.query = query;\r\n\tthis.cursor = 0;\r\n\tif(!(config && config.no_compress)){\r\n\t\tvar context = (config && config.context ? config.context : false);\r\n\t\tthis.compress(context);\r\n\t}\r\n}\r\n\r\nWOQLResult.prototype.compress = function(context){\r\n\tcontext = (context ? context : this.query.getContext());\r\n\tfor(var i = 0; i<this.bindings.length; i++){\r\n\t\tfor (const prop of Object.keys(this.bindings[i])) {\r\n\t\t\tconst nprop = FrameHelper.shorten(prop, context);\r\n\t\t\tconst nval = ((typeof this.bindings[i][prop] == \"string\") \r\n\t\t\t\t? FrameHelper.shorten(this.bindings[i][prop], context) \r\n\t\t\t\t: this.bindings[i][prop]\t\r\n\t\t\t);\r\n\t\t\tdelete(this.bindings[i][prop]);\r\n\t\t\tthis.bindings[i][nprop] = nval;\r\n\t\t}\t\r\n\t}\r\n}\r\n\r\nWOQLResult.prototype.first = function(){\r\n\tthis.cursor = 0;\r\n\treturn this.bindings[0];\r\n}\r\n\r\nWOQLResult.prototype.last = function(){\r\n\tthis.curor = this.bindings.length-1;\r\n\treturn this.bindings[this.bindings.length-1];\r\n}\r\n\r\nWOQLResult.prototype.next = function(){\r\n\tvar res = this.bindings[this.cursor];\t\r\n\tthis.cursor++;\r\n\treturn res;\r\n}\r\n\r\nWOQLResult.prototype.prev = function(){\r\n\tif(this.cursor > 0){\r\n\t\tthis.cursor--;\r\n\t\treturn this.bindings[this.cursor];\t\r\n\t}\r\n}\r\n\r\nWOQLResult.prototype.compareValues = function(a, b, asc_or_desc){\r\n\tif(!a || !b) return 0;\r\n\tif(typeof a['@value'] != \"undefined\" && typeof b['@value'] != \"undefined\"){\r\n\t\ta = a['@value'];\r\n\t\tb = b['@value'];\r\n\t}\r\n\tif(a > b ) {\r\n\t\treturn (asc_or_desc && asc_or_desc == \"asc\" ? 1 : -1);\r\n\t}\r\n\tif(b > a) {\r\n\t\treturn (asc_or_desc && asc_or_desc == \"asc\" ? -1 : 1);\r\n\t}\r\n}\r\n\r\n\r\nWOQLResult.prototype.sort = function(key, asc_or_desc){\r\n\tthis.bindings.sort((a, b) => {\r\n\t\treturn this.compareValues(a[key], b[key], asc_or_desc);\r\n\t});\r\n}\r\n\r\nWOQLResult.prototype.getVariableList = function(){\r\n\tif(this.bindings && this.bindings[0]){\r\n\t\treturn Object.keys(this.bindings[0]);\r\n\t}\r\n}\r\n\r\nWOQLResult.prototype.count = function(){\r\n\treturn this.bindings.length;\r\n}\r\n\r\nWOQLResult.prototype.hasBindings = function(result){\r\n\treturn (this.bindings && this.bindings.count());\r\n}\r\n\r\nWOQLResult.prototype.getBindings = function(){\r\n\treturn this.bindings;\r\n}\r\n\r\nmodule.exports = WOQLResult;","/**\r\n * The WOQL object is a wrapper around the WOQL query object\r\n * Syntactic sugar to allow you to write WOQL.triple()... instead of new WOQLQuery().triple()\r\n * Every function matches one of the public api functions of the woql query object\r\n */\r\nconst FrameHelper = require('./frameHelper');\r\nconst Pattern = require('./framePattern');\r\n\r\nconst WOQL = {};\r\n\r\n/*\r\n * We expose all the real woql predicates via the WOQL object, \r\n * for ease of typing - all return a WOQL query object\r\n */\r\nWOQL.when = function(Query, Update){ return new WOQLQuery().when(Query, Update);}\r\nWOQL.opt = function(query){ return new WOQLQuery().opt(query); }\r\nWOQL.from = function(dburl, query){ return new WOQLQuery().from(dburl, query); }\r\nWOQL.limit = function(limit, query){ return new WOQLQuery().limit(limit, query); }\r\nWOQL.select = function(...list){ return new WOQLQuery().select(...list); }\r\nWOQL.or = function(...queries){\treturn new WOQLQuery().or(...queries); }\r\nWOQL.and = function(...queries){ return new WOQLQuery().and(...queries); }\r\nWOQL.not = function(query){ return new WOQLQuery().not(query); }\r\nWOQL.triple = function(a, b, c){ return new WOQLQuery().triple(a, b, c); }\r\nWOQL.quad = function(a, b, c, d){ return new WOQLQuery().quad(a, b, c, d); }\r\nWOQL.eq = function(a, b){ return new WOQLQuery().eq(a, b);}\r\nWOQL.sub = function(a, b){ return new WOQLQuery().sub(a, b); }\r\nWOQL.isa = function(a, b){\treturn new WOQLQuery().isa(a, b);\t}\r\nWOQL.trim = function(a, b){\treturn new WOQLQuery().trim(a, b);\t}\r\nWOQL.delete = function(JSON_or_IRI){ return new WOQLQuery().delete(JSON_or_IRI);\t}\r\nWOQL.delete_triple = function( S, P, O ){ return new WOQLQuery().delete_triple (S, P, O);\t}\r\nWOQL.add_triple = function( S, P, O ){ return new WOQLQuery().add_triple (S, P, O); }\r\nWOQL.delete_quad = function( S, P, O, G ){ return new WOQLQuery().delete_triple (S, P, O, G); }\r\nWOQL.add_quad = function( S, P, O, G ){ \treturn new WOQLQuery().add_triple (S, P, O, G);}\r\nWOQL.eval = function(arith, v){\treturn new WOQLQuery().eval(arith, v);}\r\nWOQL.plus = function(...args){\treturn new WOQLQuery().plus(...args);}\r\nWOQL.minus = function(...args){\treturn new WOQLQuery().minus(...args); }\r\nWOQL.times = function(...args){\treturn new WOQLQuery().times(...args); }\r\nWOQL.divide = function(...args){ return new WOQLQuery().divide(...args); }\r\nWOQL.exp = function(a, b){\treturn new WOQLQuery().exp(a, b); }\r\n\r\nWOQL.get = function(map, target){\treturn new WOQLQuery().get(map, target); }\r\nWOQL.as = function(map, vari){\treturn new WOQLQuery().as(map, vari); }\r\nWOQL.remote = function(url){\treturn new WOQLQuery().remote(url); }\r\nWOQL.unique = function(prefix, vari){\treturn new WOQLQuery().unique(prefix, vari); }\r\nWOQL.list = function(vars){\treturn new WOQLQuery().list(vars); }\r\n//WOQL.value = function(vars){\treturn new WOQLQuery().list(vars); }\r\n\r\n/*\r\n * Beneath here are pseudo predicates - they belong to the javascript object\r\n * but not to the WOQL language\r\n */\r\n//returns empty query object\r\nWOQL.query = function(){\treturn new WOQLQuery(); }\r\n//loads query from json\r\nWOQL.json = function(json){\treturn new WOQLQuery().json(json); }\r\n//returns a special schema object for terse schema updates\r\nWOQL.schema = function(){\treturn new WOQLSchema(); }\r\n\r\nWOQL.rule = function(){ return new Pattern.FrameRule(); }\r\n//Simple utility function for typechecking\r\nWOQL.isLiteralType = function(t){\r\n\tif(t){\r\n\t\tvar pref = t.split(\":\");\r\n\t\tif(pref[0] == \"xdd\" || pref[0] == \"xsd\") return true;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\n/**\r\n * The WOQL Query object implements the WOQL language via the fluent style\r\n * @param query - json version of query\r\n * @returns WOQLQuery object\r\n */\r\nfunction WOQLQuery(query){\r\n\tthis.query = (query ? query : {});\r\n\tthis.cursor = this.query;\r\n\tthis.chain_ended = false;\r\n\tthis.contains_update = false;\r\n\t//operators which preserve global paging\r\n\tthis.paging_transitive_properties = ['select', 'from', 'start', 'when', 'opt', 'limit'];\r\n\treturn this;\r\n}\r\n\r\n/*\r\n * Control Functions \r\n */\r\n\r\n/**\r\n * Advances internal cursor to support chaining of calls: limit(50).start(50). rather than (limit, [50, (start, [50, (lisp-style (encapsulation)))))\r\n */\r\nWOQLQuery.prototype.advanceCursor = function(action, value){\r\n\tthis.cursor[action] = [value];\r\n\tthis.cursor[action][1] = {};\r\n\tthis.cursor = this.cursor[action][1];\t\r\n} \r\n\r\n/** \r\n * Called to indicate that this is the last call that is chainable - for example triple pattern matching..\r\n * \r\n */\r\nWOQLQuery.prototype.last = function(){\r\n\tthis.chain_ended = true;\r\n\treturn this;\r\n}\r\n\r\nWOQLQuery.prototype.isPaged = function(q){\r\n\tq = (q ? q : this.query);\r\n\tfor (const prop of Object.keys(q)) {\r\n\t\tif(prop == \"limit\") return true;\r\n\t\telse if(this.paging_transitive_properties.indexOf(prop) !== -1){\r\n\t\t\treturn this.isPaged(q[prop][q[prop].length-1])\r\n\t\t}\r\n\t}\r\n}\r\n\r\nWOQLQuery.prototype.getPagingProperty = function(pageprop, q){\r\n\tq = (q ? q : this.query);\t\r\n\tfor (const prop of Object.keys(q)) {\r\n\t\tif(prop == pageprop) return q[prop][0];\r\n\t\telse if(this.paging_transitive_properties.indexOf(prop) !== -1){\r\n\t\t\tvar val = this.getPagingProperty(pageprop, q[prop][q[prop].length-1]);\r\n\t\t\tif(typeof val != \"undefined\"){\r\n\t\t\t\treturn val;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\nWOQLQuery.prototype.setPagingProperty = function(pageprop, val, q){\r\n\tq = (q ? q : this.query);\t\r\n\tfor (const prop of Object.keys(q)) {\r\n\t\tif(prop == pageprop) {\r\n\t\t\tq[prop][0] = val;\r\n\t\t}\r\n\t\telse if(this.paging_transitive_properties.indexOf(prop) !== -1){\r\n\t\t\tthis.setPagingProperty(pageprop, val, q[prop][q[prop].length-1]);\r\n\t\t}\r\n\t}\r\n\treturn this;\r\n}\r\n\r\nWOQLQuery.prototype.addStart = function(val, q){\r\n\tq = (q ? q : this.query);\t\r\n\tfor (const prop of Object.keys(q)) {\r\n\t\tif(prop == \"limit\") {\r\n\t\t\tvar nval = { \"start\": [0, q[prop][1]]}\r\n\t\t\tq[prop][1] = nval;\r\n\t\t}\r\n\t\telse if(this.paging_transitive_properties.indexOf(prop) !== -1){\r\n\t\t\tthis.addStart(val, q[prop][q[prop].length-1]);\r\n\t\t}\r\n\t}\r\n\treturn this;\r\n}\r\n\r\nWOQLQuery.prototype.getContext = function(q){\r\n\tq = (q ? q : this.query);\r\n\tfor (const prop of Object.keys(q)) {\r\n\t\tif(prop == \"@context\") return q[prop];\r\n\t\tif(this.paging_transitive_properties.indexOf(prop) !== -1){\r\n\t\t\tvar nq = q[prop][1];\r\n\t\t\tvar nc = this.getContext(nq);\r\n\t\t\tif(nc) return nc;\r\n\t\t}\t\r\n\t}\t\r\n}\r\n\r\nWOQLQuery.prototype.nspaces = function(n){\r\n\tlet spaces = \"\";\r\n\tfor(var i = 0; i<n; i++){\r\n\t\tspaces += \" \";\r\n\t}\r\n\treturn spaces;\r\n}\r\n\r\n\r\nWOQLQuery.prototype.prettyPrint = function(indent, show_context, q, embed){\r\n\tif(!embed) this.indent = indent;\r\n\tq = (q ? q : this.query);\r\n\tvar str = \"\";\r\n\tfor(var key in q){\r\n\t\tif(key == \"@context\"){\r\n\t\t\t//ignore context\r\n\t\t}\r\n\t\telse {\r\n\t\t\tstr += (embed ? key : \"WOQL.\"+key);\r\n\t\t\tvar val = q[key];\r\n\t\t\tif(key == \"and\" || key == \"or\"){\r\n\t\t\t\tvar clauses = []\r\n\t\t\t\tfor(var i = 0; i<val.length; i++){\t\r\n\t\t\t\t\tvar nxt = this.prettyPrint(this.indent+indent, show_context, val[i], true);\r\n\t\t\t\t\tclauses.push(nxt)\r\n\t\t\t\t}\r\n\t\t\t\tstr += \"(\\n\" + this.nspaces(indent) + \"WOQL.\" + clauses.join(\",\\n\"+ this.nspaces(indent) + \"WOQL.\") + \"\\n\" + this.nspaces(indent - this.indent) + \")\";\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t\telse if(typeof val[val.length-1] == \"object\" ){\r\n\t\t\t\tvar nvals = []\r\n\t\t\t\tfor(var i = 0; i<val.length-1; i++){\r\n\t\t\t\t\tif(key == \"limit\" || key == \"start\"){\r\n\t\t\t\t\t\tnvals.push(val[i]);\t\t\t\t\t\t\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tnvals.push('\"'+val[i]+'\"');\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif(nvals.length){\r\n\t\t\t\t\tstr += \"(\" + nvals.join(\",\");\r\n\t\t\t\t\tif(key == \"from\") str += \")\\n.\";\r\n\t\t\t\t\telse str +=\").\";\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tstr += \"().\";\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t\tstr += this.prettyPrint(indent, show_context, val[val.length-1], true);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tstr += '(\"' + val.join('\", \"') + '\")';\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn str;\r\n}\r\n\r\nWOQLQuery.prototype.setLimit = function(limit){\r\n\treturn this.setPagingProperty(\"limit\", limit); \r\n}\r\n\r\nWOQLQuery.prototype.getLimit = function(){\r\n\treturn this.getPagingProperty(\"limit\");\r\n}\r\n\r\nWOQLQuery.prototype.getPage = function(){\r\n\tif(this.isPaged()){\r\n\t\tvar psize = this.getLimit();\r\n\t\tif(this.hasStart()){\r\n\t\t\tvar s = this.getStart();\r\n\t\t\treturn (parseInt(s / psize) + 1);\r\n\t\t}\r\n\t\telse return 1;\r\n\t}\r\n\telse return false;\r\n}\r\n\r\nWOQLQuery.prototype.setPage = function(pagenum){\r\n\tvar pstart = (this.getLimit() * (pagenum - 1));\r\n\tif(this.hasStart()){\r\n\t\tthis.setStart(pstart);\r\n\t}\r\n\telse {\r\n\t\tthis.addStart(pstart);\r\n\t}\r\n\treturn this;\r\n}\r\n\r\n\r\nWOQLQuery.prototype.hasStart = function(){\r\n\treturn (typeof this.getPagingProperty(\"start\") != \"undefined\");\r\n}\r\n\r\nWOQLQuery.prototype.getStart = function(){\r\n\treturn this.getPagingProperty(\"start\");\r\n}\r\n\r\nWOQLQuery.prototype.nextPage = function(){\r\n\treturn this.setPage(this.getPage() + 1);\r\n}\r\n\t\r\nWOQLQuery.prototype.firstPage = function(){\r\n\treturn this.setPage(1);\r\n}\r\n\r\nWOQLQuery.prototype.previousPage = function(){\r\n\tconst npage = this.getPage() - 1;\r\n\tif(npage > 0) this.setPage(npage);\r\n\treturn this;\r\n}\r\n\r\nWOQLQuery.prototype.hasSelect = function(){\r\n\treturn this.getPagingProperty(\"select\"); \r\n}\r\n\r\nWOQLQuery.prototype.getSelectVariables = function(q){\r\n\tq = (q ? q : this.query);\t\r\n\tfor (const prop of Object.keys(q)) {\r\n\t\tif(prop == \"select\") {\r\n\t\t\tvar vars = q[prop].slice(0, q[prop].length - 1);\r\n\t\t\treturn vars;\r\n\t\t}\r\n\t\telse if(this.paging_transitive_properties.indexOf(prop) !== -1){\r\n\t\t\tvar val = this.getSelectVariables(q[prop][q[prop].length-1]);\r\n\t\t\tif(typeof val != \"undefined\"){\r\n\t\t\t\treturn val;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\nWOQLQuery.prototype.setStart = function(start){\r\n\treturn this.setPagingProperty(\"start\", start); \r\n}\r\n\r\nWOQLQuery.prototype.setPageSize = function(size){\r\n\tthis.setPagingProperty(\"limit\", size); \r\n\tif(this.hasStart()){\r\n\t\tthis.setStart(0);\r\n\t}\r\n\telse {\r\n\t\tthis.addStart(0);\r\n\t}\r\n\treturn this;\r\n}\r\n\r\n/*\r\n * Called to indicate an update that is the last chainable element in a query\r\n */\r\nWOQLQuery.prototype.lastUpdate = function(){\r\n\tthis.last();\r\n\tthis.contains_update = true;\r\n\treturn this;\r\n}\r\n\r\n/*\r\n * JSON context specifying prefixes\r\n */\r\nWOQLQuery.prototype.context = function(Context){\r\n\tthis.cursor[\"@context\"] = Context;\r\n}\r\n\r\nWOQLQuery.prototype.defaultContext = function(DB_IRI){\r\n\tlet def = {}\r\n\tfor(var pref in FrameHelper.standard_urls){\r\n\t\tdef[pref] = FrameHelper.standard_urls[pref];\r\n\t}\r\n\tdef.scm = DB_IRI + \"/schema#\"\r\n\tdef.doc = DB_IRI + \"/document/\"\r\n\tdef.db = DB_IRI + \"/\";\r\n\treturn def;\r\n}\r\n\r\n\r\n/**\r\n * Executes the query using the passed client to connect to a server\r\n */\r\nWOQLQuery.prototype.execute = function(client){\r\n\tif(!this.query[\"@context\"]){\r\n\t\tthis.query[\"@context\"] = this.defaultContext(client.connectionConfig.dbURL());\r\n\t\tvar json = this.json();\r\n\t}\r\n\telse {\r\n\t\tvar json = this.json();\r\n\t}\r\n\tif(this.contains_update){\r\n\t\treturn client.update(false, json);\r\n\t}\r\n\telse {\r\n\t\treturn client.select(false, json);\t\t\r\n\t}\r\n}\r\n\r\n/*\r\n * json version of query for passing to api\r\n */\r\nWOQLQuery.prototype.json = function(json){\r\n\tif(json){\r\n\t\tthis.query = json;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.query;\r\n}\r\n\r\n/*\r\n * Functions which take a query as an argument advance the cursor to make the chaining of queries fall \r\n * into the corrent place in the encompassing json \r\n */\r\nWOQLQuery.prototype.when = function(Query, Update){\r\n\tthis.advanceCursor(\"when\", Query);\t\r\n\tif(Update){\r\n\t\tthis.cursor = Update.json();\r\n\t}\r\n\treturn this;\r\n}\r\n\r\nWOQLQuery.prototype.opt = function(query){\r\n\tif(query){\r\n\t\tthis.cursor[\"opt\"] = [query];\r\n\t}\r\n\telse {\r\n\t\tthis.cursor['opt'] = [{}];\t\t\r\n\t\tthis.cursor = this.cursor[\"opt\"][0];\t\r\n\t}\r\n\treturn this;\r\n}\r\n\r\nWOQLQuery.prototype.from = function(dburl, query){\r\n\tthis.advanceCursor(\"from\", dburl);\r\n\tif(query){\r\n\t\tthis.cursor = query.json();\r\n\t}\r\n\treturn this;\r\n}\r\n\r\nWOQLQuery.prototype.limit = function(limit, query){\r\n\tthis.advanceCursor(\"limit\", limit);\r\n\tif(query){\r\n\t\tthis.cursor = query.json();\r\n\t}\r\n\treturn this;\r\n}\r\n\r\nWOQLQuery.prototype.start = function(start, query){\r\n\tthis.advanceCursor(\"start\", start);\r\n\tif(query){\r\n\t\tthis.cursor = query.json();\r\n\t}\r\n\treturn this;\r\n}\r\n\r\nWOQLQuery.prototype.select = function(...list){\r\n\tthis.cursor[\"select\"] = list;\r\n\tvar index = list.length;\r\n\tif(typeof this.cursor['select'][index-1] == \"object\"){\r\n\t\tthis.cursor['select'][index-1] = this.cursor['select'][index-1].json(); \r\n\t}\r\n\telse {\r\n\t\tthis.cursor[\"select\"][index] = {};\r\n\t\tthis.cursor = this.cursor[\"select\"][index];\t\r\n\t}\r\n\treturn this;\r\n}\r\n\r\nWOQLQuery.prototype.and = function(...queries){\r\n\tthis.cursor[\"and\"] = [];\r\n\tfor(var i = 0; i<queries.length; i++){\r\n\t\tif(queries[i].contains_update) this.contains_update = true;\r\n\t\tthis.cursor['and'].push(queries[i].json());\r\n\t}\r\n\treturn this;\r\n}\r\n\r\nWOQLQuery.prototype.or = function(...queries){\r\n\tthis.cursor[\"or\"] = [];\r\n\tfor(var i = 0; i<queries.length; i++){\r\n\t\tif(queries[i].contains_update) this.contains_update = true;\r\n\t\tthis.cursor['or'].push(queries[i].json());\r\n\t}\r\n\treturn this;\r\n}\r\n\r\nWOQLQuery.prototype.not = function(query){\r\n\tif(query){\r\n\t\tif(query.contains_update) this.contains_update = true;\r\n\t\tthis.cursor[\"not\"] = [query.json()];\r\n\t}\r\n\telse {\r\n\t\tthis.cursor['not'] = [{}];\t\t\r\n\t\tthis.cursor = this.cursor[\"not\"][0];\t\r\n\t}\r\n\treturn this;\r\n}\r\n\r\nWOQLQuery.prototype.triple = function(a, b, c){\r\n\tthis.cursor[\"triple\"] = [a,b,c];\r\n\treturn this.last();\r\n}\r\n\r\nWOQLQuery.prototype.quad = function(a, b, c, g){\r\n\tthis.cursor[\"quad\"] = [a,b,c,g];\r\n\treturn this.last();\r\n}\r\n\r\nWOQLQuery.prototype.eq = function(a, b){\r\n\tthis.cursor[\"eq\"] = [a,b];\r\n\treturn this.last();\r\n}\r\n\r\nWOQLQuery.prototype.sub = function(a, b){\r\n\tthis.cursor[\"sub\"] = [a,b];\r\n\treturn this.last();\r\n}\r\n\r\nWOQLQuery.prototype.isa = function(a, b){\r\n\tthis.cursor[\"isa\"] = [a,b];\r\n\treturn this.last();\r\n}\r\n\r\nWOQLQuery.prototype.trim = function(a, b){\r\n\tthis.cursor['trim'] = [a, b];\r\n\treturn this.last();\r\n}\r\n\r\nWOQLQuery.prototype.eval = function(arith, v){\r\n\tthis.cursor['eval'] = [arith, v];\r\n\treturn this.last();\r\n}\r\n\r\nWOQLQuery.prototype.plus = function(...args){\r\n\tthis.cursor['plus'] = args;\r\n\treturn this.last();\r\n}\r\n\r\nWOQLQuery.prototype.minus = function(...args){\r\n\tthis.cursor['minus'] = args;\r\n\treturn this.last();\r\n}\r\n\r\nWOQLQuery.prototype.times = function(...args){\r\n\tthis.cursor['times'] = args;\r\n\treturn this.last();\r\n}\r\n\r\nWOQLQuery.prototype.divide = function(...args){\r\n\tthis.cursor['divide'] = args;\r\n\treturn this.last();\r\n}\r\n\r\nWOQLQuery.prototype.exp = function(a, b){\r\n\tthis.cursor['exp'] = [a, b];\r\n\treturn this.last();\r\n}\r\n\r\nWOQLQuery.prototype.delete = function(JSON_or_IRI){\r\n\tthis.cursor['delete'] = [JSON_or_IRI];\r\n\treturn this.lastUpdate();\r\n}\r\n\r\nWOQLQuery.prototype.delete_triple = function( Subject, Predicate, Object_or_Literal ){\r\n\tthis.cursor['delete_triple'] = [ Subject, Predicate, Object_or_Literal ];\r\n\treturn this.lastUpdate();\r\n}\r\n\r\nWOQLQuery.prototype.add_triple = function( Subject, Predicate, Object_or_Literal ){\r\n\tthis.cursor['add_triple'] = [ Subject, Predicate, Object_or_Literal ];\r\n\treturn this.lastUpdate();\t\r\n}\r\n\r\nWOQLQuery.prototype.delete_quad = function( Subject, Predicate, Object_or_Literal, Graph ){\r\n\tthis.cursor['delete_quad'] = [ Subject, Predicate, Object_or_Literal, Graph ];\r\n\treturn this.lastUpdate();\t\r\n}\r\n\r\nWOQLQuery.prototype.add_quad = function( Subject, Predicate, Object_or_Literal, Graph){\r\n\tthis.cursor['add_quad'] = [ Subject, Predicate, Object_or_Literal, Graph ];\r\n\treturn this.lastUpdate();\t\t\r\n}\r\n\r\nWOQLQuery.prototype.update = function(json){\r\n\tthis.cursor['update'] = [ json ];\r\n\treturn this.lastUpdate();\t\t\r\n}\r\n\r\n/*\r\n * higher level composite queries\r\n */\r\n\r\nWOQLQuery.prototype.abstract = function(varname){\r\n\tvarname = (varname ? varname : \"v:\".FrameHelper.genBNID());\r\n\treturn this.quad(varname, \"tcs:tag\", \"tcs:abstract\", \"db:schema\");\r\n}\r\n\r\nWOQLQuery.prototype.getEverything = function(GraphIRI){\r\n\tif(GraphIRI){\r\n\t\treturn this.quad(\"v:Subject\", \"v:Predicate\", \"v:Object\", GraphIRI);\r\n\t}\r\n\telse {\r\n\t\treturn this.triple(\"v:Subject\", \"v:Predicate\", \"v:Object\");\r\n\t}\r\n}\r\n\r\nWOQLQuery.prototype.getAllDocuments = function(){\r\n\treturn this.and(\r\n\t\tWOQL.triple(\"v:Document\", \"rdf:type\", \"v:Type\"),\r\n\t\tWOQL.sub(\"v:Type\", \"tcs:Document\")\r\n\t);\r\n}\r\n\t\r\nWOQLQuery.prototype.documentMetadata = function(){\r\n\treturn this.and(\r\n\t\tWOQL.triple(\"v:ID\", \"rdf:type\", \"v:Class\"),\r\n\t\tWOQL.sub(\"v:Class\", \"tcs:Document\"),\r\n\t\tWOQL.opt().triple(\"v:ID\", \"rdfs:label\", \"v:Label\"),\r\n\t\tWOQL.opt().triple(\"v:ID\", \"rdfs:comment\", \"v:Comment\"),\r\n\t\tWOQL.opt().quad(\"v:Class\", \"rdfs:label\", \"v:Type\", \"db:schema\"),\r\n\t\tWOQL.opt().quad(\"v:Class\", \"rdfs:comment\", \"v:Type_Comment\", \"db:schema\")\r\n\t);\r\n}\r\n\r\n\r\n\r\n\r\nWOQLQuery.prototype.propertyMetadata = function(){\r\n\treturn this.and(\r\n\t\tWOQL.or(\r\n\t\t\tWOQL.quad(\"v:Property\", \"rdf:type\", \"owl:DatatypeProperty\", \"db:schema\"),\r\n\t\t\tWOQL.quad(\"v:Property\", \"rdf:type\", \"owl:ObjectProperty\", \"db:schema\")\r\n\t\t),\r\n\t\tWOQL.opt().quad(\"v:Property\", \"rdfs:range\", \"v:Range\", \"db:schema\"),\r\n\t\tWOQL.opt().quad(\"v:Property\", \"rdf:type\", \"v:Type\", \"db:schema\"),\r\n\t\tWOQL.opt().quad(\"v:Property\", \"rdfs:label\", \"v:Label\", \"db:schema\"),\r\n\t\tWOQL.opt().quad(\"v:Property\", \"rdfs:comment\", \"v:Comment\", \"db:schema\"),\r\n\t\tWOQL.opt().quad(\"v:Property\", \"rdfs:domain\", \"v:Domain\", \"db:schema\")\r\n\t);\r\n}\r\n\r\nWOQLQuery.prototype.elementMetadata = function(){\r\n\treturn this.and(\r\n\t\tWOQL.quad(\"v:Element\", \"rdf:type\", \"v:Type\", \"db:schema\"),\r\n\t\tWOQL.opt().quad(\"v:Element\", \"tcs:tag\", \"v:Abstract\", \"db:schema\"),\r\n\t\tWOQL.opt().quad(\"v:Element\", \"rdfs:label\", \"v:Label\", \"db:schema\"),\r\n\t\tWOQL.opt().quad(\"v:Element\", \"rdfs:comment\", \"v:Comment\", \"db:schema\"),\r\n\t\tWOQL.opt().quad(\"v:Element\", \"rdfs:domain\", \"v:Domain\", \"db:schema\"),\r\n\t\tWOQL.opt().quad(\"v:Element\", \"rdfs:range\", \"v:Range\", \"db:schema\")\r\n\t);\r\n}\r\n\r\nWOQLQuery.prototype.classMetadata = function(){\r\n\treturn this.and(\r\n\t\tWOQL.quad(\"v:Element\", \"rdf:type\", \"owl:Class\", \"db:schema\"),\r\n\t\tWOQL.opt().quad(\"v:Element\", \"rdfs:label\", \"v:Label\", \"db:schema\"),\r\n\t\tWOQL.opt().quad(\"v:Element\", \"rdfs:comment\", \"v:Comment\", \"db:schema\"),\r\n\t\tWOQL.opt().quad(\"v:Element\", \"tcs:tag\", \"v:Abstract\", \"db:schema\")\r\n\t);\r\n}\r\n\r\nWOQLQuery.prototype.getDataOfClass = function(chosen){\r\n\treturn this.and(\r\n\t\tWOQL.triple(\"v:Document\", \"rdf:type\", chosen),\r\n\t\tWOQL.opt().triple(\"v:Document\", \"v:Property\", \"v:Value\")\r\n\t);\r\n}\r\n\r\nWOQLQuery.prototype.getDataOfProperty = function(chosen){\r\n\treturn this.and(\r\n\t\tWOQL.triple(\"v:Document\", chosen, \"v:Value\"),\r\n\t\tWOQL.opt().triple(\"v:Document\", \"rdfs:label\", \"v:Label\")\r\n\t);\r\n}\r\n\r\nWOQLQuery.prototype.documentProperties = function(id){\r\n\treturn this.and(\r\n\t\tWOQL.triple(id, \"v:Property\", \"v:Property_Value\"),\r\n\t\tWOQL.opt().quad(\"v:Property\", \"rdfs:label\", \"v:Property_Label\", \"db:schema\"),\r\n\t\tWOQL.opt().quad(\"v:Property\", \"rdf:type\", \"v:Property_Type\", \"db:schema\")\r\n\t);\r\n}\r\n\r\nWOQLQuery.prototype.getInstanceMeta = function(url){\r\n\treturn this.and(\r\n\t\tWOQL.triple(url, \"rdf:type\", \"v:InstanceType\"),\r\n\t\tWOQL.opt().triple(url, \"rdfs:label\", \"v:InstanceLabel\"),\r\n\t\tWOQL.opt().triple(url, \"rdfs:comment\", \"v:InstanceComment\"),\r\n\t\tWOQL.opt().quad(\"v:InstanceType\", \"rdfs:label\", \"v:ClassLabel\", \"db:schema\")\r\n\t);\r\n}\r\n\r\nWOQLQuery.prototype.simpleGraphQuery = function(){\r\n\treturn this.and(\r\n\t    WOQL.triple(\"v:Source\", \"v:Edge\", \"v:Target\"),\r\n\t    WOQL.isa(\"v:Source\", \"v:Source_Class\"),\r\n\t    WOQL.sub(\"v:Source_Class\", \"tcs:Document\"),\r\n\t    WOQL.isa(\"v:Target\", \"v:Target_Class\"),\r\n\t    WOQL.sub(\"v:Target_Class\", \"tcs:Document\"),\r\n\t    WOQL.opt().triple(\"v:Source\", \"rdfs:label\", \"v:Source_Label\"),\r\n\t    WOQL.opt().triple(\"v:Source\", \"rdfs:comment\", \"v:Source_Comment\"),\r\n\t    WOQL.opt().quad(\"v:Source_Class\", \"rdfs:label\", \"v:Source_Type\", \"db:schema\"),\r\n\t    WOQL.opt().quad(\"v:Source_Class\", \"rdfs:comment\", \"v:Source_Type_Comment\", \"db:schema\"),\r\n\t    WOQL.opt().triple(\"v:Target\", \"rdfs:label\", \"v:Target_Label\"),\r\n\t    WOQL.opt().triple(\"v:Target\", \"rdfs:comment\", \"v:Target_Comment\"),\r\n\t    WOQL.opt().quad(\"v:Target_Class\", \"rdfs:label\", \"v:Target_Type\", \"db:schema\"),\r\n\t    WOQL.opt().quad(\"v:Target_Class\", \"rdfs:comment\", \"v:Target_Type_Comment\", \"db:schema\"),\r\n\t    WOQL.opt().quad(\"v:Edge\", \"rdfs:label\", \"v:Edge_Type\", \"db:schema\"),\r\n\t    WOQL.opt().quad(\"v:Edge\", \"rdfs:comment\", \"v:Edge_Type_Comment\", \"db:schema\")\r\n\t);\r\n}\r\n\r\nfunction WOQLSchema(){\r\n\tthis.triples = [];\r\n\tthis.subject = false;\r\n}\r\n\r\nWOQLSchema.prototype.execute = function(client){\r\n\tvar subs = [];\r\n\tfor(var i = 0; i<this.triples.length; i++){\r\n\t\tsubs.push(WOQL.add_quad(...this.triples[i], \"db:schema\"));\r\n\t}\r\n\treturn WOQL.and(subs).execute(client);\r\n}\r\n\r\nWOQLSchema.prototype.getO = function(s, p){\r\n\tfor(var i = 0; i<this.triples.length; i++){\r\n\t\tif(this.triples[i][0] == s && this.triples[i][1] == p ) return this.triples[i][2];\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nWOQLSchema.prototype.addPO = function(p, o){\r\n\tthis.triples.push([this.subject, p, o]);\r\n\treturn this;\r\n}\r\n\r\nWOQLSchema.prototype.addClass = function(c){\r\n\tthis.subject = c;\r\n\treturn this.addPO(\"rdf:type\", \"owl:Class\");\r\n}\r\n\r\nWOQLSchema.prototype.addProperty = function(p, t){\r\n\tthis.subject = p;\r\n\tthis.addPO(\"rdfs:range\", t);\r\n\tif(WOQL.isLiteralType(t)){\r\n\t\treturn this.addPO(\"rdf:type\", \"owl:DatatypeProperty\");\r\n\t}\r\n\telse {\r\n\t\treturn this.addPO(\"rdf:type\", \"owl:ObjectProperty\");\t\t\r\n\t}\r\n}\r\n\r\nWOQLSchema.prototype.label = function(l, lang){\r\n\tlang = (lang ? lang : \"en\");\r\n\treturn this.addPO('rdfs:label', {\"@value\": l, \"@language\": \"en\"});\r\n}\r\n\r\nWOQLSchema.prototype.comment = function(c, lang){\r\n\tlang = (lang ? lang : \"en\");\r\n\treturn this.addPO('rdfs:comment', {\"@value\": c, \"@language\": \"en\"});\r\n}\r\n\r\nWOQLSchema.prototype.parent = function(...p){\r\n\treturn this.addPO('rdfs:subClassOf', p);\r\n}\r\n\r\nWOQLSchema.prototype.abstract = function(){\r\n\treturn this.addPO('tcs:tag', \"tcs:abstract\");\r\n}\r\n\r\nWOQLSchema.prototype.entity = function(){\r\n\treturn this.parent(\"tcs:Entity\");\r\n}\r\n\r\nWOQLSchema.prototype.relationship = function(){\r\n\treturn this.parent(\"tcs:Relationship\");\r\n}\r\n\r\nWOQLSchema.prototype.card = function(n, which){\r\n\tlet os = this.subject;\r\n\tthis.subject += \"_\" + which;\r\n\tthis.addPO('rdf:type', \"owl:Restriction\");\r\n\tthis.addPO(\"owl:onProperty\", os);\r\n\tswitch(which){\r\n\t\tcase \"max\": this.addPO(\"owl:maxCardinality\", n);\r\n\t\t\tbreak;\r\n\t\tcase \"min\": this.addPO(\"owl:minCardinality\", n);\r\n\t\t\tbreak;\r\n\t\tdefault: this.addPO(\"owl:cardinality\", n);\t\t\t\r\n\t}\r\n\tlet od = this.getO(os, \"rdfs:domain\");\r\n\tif(od){\r\n\t\tthis.triples.push([od, \"rdfs:subClassOf\", this.subject]);\r\n\t}\r\n\tthis.subject = os;\r\n\treturn this;\r\n}\r\n\r\nWOQLSchema.prototype.max = function(m){\r\n\treturn this.card(m, \"max\");\r\n}\r\n\r\nWOQLSchema.prototype.min = function(m){\r\n\treturn this.card(m, \"min\");\t\r\n}\r\n\r\nWOQLSchema.prototype.cardinality = function(m){\r\n\treturn this.card(m, \"cardinality\");\t\r\n}\r\n\r\nWOQLSchema.prototype.domain = function(d){\r\n\treturn this.addPO('rdfs:domain', d);\r\n}\r\n/*\r\n * \r\n\r\n let s = WOQL.schema();\r\n s.addClass(\"myclass\").label(\"whatever\").comment(\"yo\").entity();\r\n s.addProperty(\"myprop\", \"string\").label(\"whatever\").comment(\"yo\").domain(\"myclass\").max(1);\r\n s.execute(client).then()\r\n \r\n WOQL.when(WQOL.query().get(mytwitterfriends).column(\"adfa\").as(\"v:X\").update(triple(v:X));\r\n \r\n WOQL.select(\"fadfadf\").execute().done()\r\n g = WOQL.graph()....\r\n show(result, g);\r\n \r\n * \r\n *\r\n *\r\n *\r\n \r\n \r\n * \r\n */\r\n\r\n\r\nmodule.exports = WOQL;","function Codemirror(text, format, config){\r\n  this.textdom = text;\r\n  this.mode = format;\r\n  this.darkMode = config.darkMode;\r\n  if(this.jsonldCheck(format)) this.mode = 'javascript';\r\n}\r\n// checks if a json object is empty\r\nfunction isEmpty(arg) {\r\n  for (var item in arg) {\r\n    return false;\r\n  }\r\n  return true;\r\n}\r\n\r\n/*\r\ntxtar    : editor is attached to textar\r\nmode     : format for highlighting, ex: json, html etc.\r\neditable : readOnly false/ nocursor is special value in code editor to set readonly true */\r\nCodemirror.prototype.colorizeTextArea = function(mode){\r\n    //initize auto complete\r\n    /*CodeMirror.commands.autocomplete = function(cm) {\r\n    cm.showHint({hint: CodeMirror.hint.anyword});\r\n    }*/\r\n\r\n    // initialise code editor on text area\r\n    var editor = CodeMirror.fromTextArea(this.textdom, {\r\n        mode                : this.mode,\r\n        firstLineNumber     : 1,\r\n        lineNumbers         : true,\r\n        styleActiveLine     : true,\r\n        lineWrapping        : true,\r\n        smartIndent         : true,\r\n        indentWithTabs      : true,\r\n        newlineAndIndent    : true,\r\n        autoCloseBrackets   : true,\r\n        matchBrackets       : {afterCursor: true},\r\n        extraKeys           : {\"Ctrl-F\": \"find\", \"Tab\": \"autocomplete\" },\r\n        refresh             : true\r\n    });\r\n    if(!(isEmpty(mode)))\r\n        editor.setSize(mode.width, mode.height);\r\n    else this.setCodemirrorSize(editor, mode);\r\n    editor.defaultCharWidth('20px');\r\n    if(this.darkMode) editor.setOption(\"theme\", 'erlang-dark');\r\n    else editor.setOption(\"theme\", 'neo');\r\n    return editor;\r\n} // colorizeTextArea()\r\n\r\n/*\r\n  set editor size according to screens\r\n  editor : code mirror editor Object\r\n  mode   : editor being viewed from schema/ doc/ query page*/\r\nCodemirror.prototype.setCodemirrorSize = function(editor, mode){\r\n  switch(mode){\r\n    case 'query':\r\n      editor.setSize('800', '400');\r\n    break;\r\n    case 'schema':\r\n      editor.setSize('auto', '1550');\r\n    break;\r\n    case 'document':\r\n     editor.setSize('765', '500');\r\n    break;\r\n    case 'api-doc':\r\n        editor.setSize('800', '500');\r\n    break;\r\n    case 'doc-json':\r\n        editor.setSize('1410', 'auto');\r\n    break;\r\n    case 'doc-json-create':\r\n        editor.setSize('1410', '500');\r\n    break;\r\n  } // switch(mode)\r\n} // setCodemirrorSize()\r\n\r\n// updateTextArea(): highlights new changes on editor\r\nCodemirror.prototype.updateTextArea = function(editor){\r\n  editor.save();\r\n  setTimeout(function() {\r\n      editor.refresh();\r\n  },1);\r\n  // save changes of code mirror editor\r\n  editor.on('change', function(){\r\n    editor.save();\r\n  });\r\n} //updateTextArea()\r\n\r\n/*\r\ncolorizePre() to colorise pre tags (read only mode)\r\ntext (string)    : The document to run through the highlighter.\r\nmode (mode spec) : format to highlight color\r\noutput (DOM node): The tokens will be converted to spans as in an editor,\r\n                   and inserted into the node (through innerHTML).*/\r\nCodemirror.prototype.colorizePre = function(){\r\n  CodeMirror.runMode(this.textdom.innerText, this.mode, this.textdom);\r\n  if(this.darkMode)\r\n      var theme = 'cm-s-erlang-dark';\r\n  else var theme = 'cm-s-neo';\r\n  this.textdom.setAttribute('class', 'CodeMirror CodeMirror-wrap ' + theme + ' terminus-wrap-text terminus-wrapper-height ');\r\n  return this.textdom;\r\n} // colorizePre()\r\n\r\nCodemirror.prototype.jsonldCheck = function(format){\r\n  if(format == 'jsonld') return true;\r\n}\r\n\r\nmodule.exports=Codemirror\r\n","/**\r\n * object renderer binds to object frame - provides filters, sorts and manipulations of underlying object frame\r\n * and coordinates viewer to draw updates\r\n\r\n * Object Renderer - provides sorting / filtering / state management of objects\r\n * @param obj ObjectFrame object - contains underlying data and frame structure\r\n * @param parent PropertyRenderer - property that owns this object (if any)\r\n * @param options options json\r\n * @returns\r\n */\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\nconst RenderingMap = require('./RenderingMap');\r\nconst ValueRenderer = require('./ValueRenderer');\r\nconst ObjectViewer = require('../html/document/ObjectViewer');\r\nconst PropertyViewer = require('../html/document/PropertyViewer');\r\nconst HTMLDataViewer = require('../html/document/DataViewer');\r\nconst HTMLFrameHelper = require('../html/HTMLFrameHelper');\r\n\r\nfunction PropertyRenderer(prop, parent, options){\r\n\tthis.predicate = prop;\r\n\tthis.parent = parent;\r\n\tthis.cframe = this.parent.objframe.getPropertyClassFrame(this.predicate);\r\n\tthis.originalValues = false;\r\n\tthis.changed = false;\r\n\tthis.values = [];\r\n\tthis.renderer_type = \"property\";\r\n\tthis.options = this.setOptions(options);\r\n}\r\n\r\nPropertyRenderer.prototype.setOptions = function(options){\r\n\treturn TerminusDashboard.RenderingMap.decorateRenderer(options, this);\r\n}\r\n\r\nPropertyRenderer.prototype.getOptionsForChild = function(){\r\n\tvar opts = {};\r\n\tif(this.options.features){ opts.features = this.options.features };\r\n\tif(this.options.controls){ opts.controls = this.options.controls};\r\n\treturn this.options;\r\n}\r\n\r\nPropertyRenderer.prototype.getOptionsForValue = function(df, index){\r\n\treturn this.getOptionsForChild();\r\n}\r\n\r\nPropertyRenderer.prototype.getOptionsForObject = function(objframe){\r\n\treturn this.getOptionsForChild();\r\n}\r\n\r\n\r\nPropertyRenderer.prototype.render = function(viewer){\r\n \tthis.buildValueRenderers();\r\n \tif(this.cframe && this.cframe.property){\r\n \t\tthis.viewer = (viewer ? viewer : this.getViewerForProperty());\r\n \t\tfor(var i = 0; i<this.values.length; i++){\r\n \t\t\tvar renderedval = this.values[i].render();\r\n \t\t\tif(renderedval && this.showFeature(\"body\")) this.viewer.addRenderedValue(renderedval);\r\n \t\t}\r\n \t\treturn this.viewer.render();\r\n \t}\r\n}\r\n\r\n/*\r\n * Creates the array of object renderer or value renderer objects corresponding to the property values.\r\n */\r\nPropertyRenderer.prototype.buildValueRenderers = function(){\r\n \tvar adorig = (this.originalValues === false ? true : false);\r\n \tthis.cframe = this.parent.objframe.getPropertyClassFrame(this.predicate);\r\n \tif(!this.cframe){\r\n \t\tconsole.error(\"No frame for \" + this.property() + \" id: \" + this.subject());\r\n \t\treturn false;\r\n \t}\r\n \tif(this.cframe && this.cframe.isData()){\r\n \t\tvar dataframes = this.getDataFramesToRender();\r\n \t\tif(dataframes.length == 0){\r\n \t\t\talert(this.predicate);\r\n \t\t}\r\n \t\tvar vals = [];\r\n \t\tfor(var i = this.values.length; i<dataframes.length; i++){\r\n \t\t\tvar vr = new ValueRenderer(dataframes[i], i, this, this.getOptionsForValue(dataframes[i], i));\r\n \t\t\tthis.values.push(vr);\r\n \t\t\tvals.push(vr.value());\r\n \t\t}\r\n \t\tif(adorig) this.originalValues = vals;\r\n \t}\r\n \telse {\r\n \t\tif(adorig) this.originalValues = [];\r\n \t\tvar kids = this.getChildrenToRender();\r\n \t\tif(kids && kids.length){\r\n \t\t\tfor(var i = this.values.length; i<kids.length; i++){\r\n \t\t\t\tvar kidf = new ObjectRenderer(kids[i], this, this.getOptionsForObject(kids[i]));\r\n \t\t\t\tif(adorig) this.originalValues.push(kidf.subject());\r\n \t\t\t\tthis.values.push(kidf);\r\n \t\t\t}\r\n \t\t}\r\n \t}\r\n}\r\n\r\n/*\r\n * Returns the array of values that should be rendered (enables value filtering)\r\n */\r\nPropertyRenderer.prototype.getDataFramesToRender = function(options){\r\n \tvar allvals = this.parent.objframe.getDataFrames(this.property());\r\n \treturn allvals;\r\n}\r\n\r\n/*\r\n * Returns the array of child / objects that should be rendered (enables value filtering)\r\n */\r\nPropertyRenderer.prototype.getChildrenToRender = function(options){\r\n \tif(TerminusClient.FrameHelper.viewIncludesChildren(this.view, \"property\")){\r\n \t\tvar allkids = this.parent.objframe.getChildren(this.property());\r\n \t}\r\n \telse {\r\n \t\tvar allkids = [];\r\n \t}\r\n \treturn allkids;\r\n}\r\n\r\nPropertyRenderer.prototype.redraw = function(){\r\n \tthis.viewer.clear();\r\n \tthis.render(this.viewer, \"x\");\r\n \t//alert(this.values.length);\r\n}\r\n\r\nPropertyRenderer.prototype.extract = function(){\r\n \tvar extracts = [];\r\n \tfor(var i = 0; i<this.values.length; i++){\r\n \t\tvar val = this.values[i].extract();\r\n \t\tif(val !== \"\" && val !== false && typeof val != \"undefined\") extracts.push(val);\r\n \t}\r\n \tif(this.cframe.isData()){\r\n \t\treturn extracts;\r\n \t}\r\n \telse {\r\n \t\treturn extracts;\r\n \t\tvar extr = {};\r\n \t\tfor(var i = 0; i<extracts.length; i++){\r\n \t\t\tfor(var subjid in extracts[i]){\r\n \t\t\t\textr[subjid] = extracts[i][subjid];\r\n \t\t\t}\r\n \t\t}\r\n \t\treturn extr;\r\n \t}\r\n}\r\n\r\n/*\r\n * simple wrapper functions\r\n */\r\nPropertyRenderer.prototype.currentViewer = function(){return this.viewerType;}\r\nPropertyRenderer.prototype.property = function(){return this.predicate;}\r\nPropertyRenderer.prototype.subject = function(){return (this.parent ? this.parent.subject() : false);};\r\nPropertyRenderer.prototype.depth = function(){return (this.parent ? this.parent.depth() : false);};\r\nPropertyRenderer.prototype.subjectClass = function(){return (this.parent ? this.parent.subjectClass() : false);};\r\nPropertyRenderer.prototype.updated = function(){ return (this.parent ? this.parent.childUpdated() : false);};\r\nPropertyRenderer.prototype.range = function(){\treturn (this.cframe ? this.cframe.range : \"\");};\r\nPropertyRenderer.prototype.getLabel = function(){ return (this.cframe ? this.cframe.getLabel() : \"\" );};\r\nPropertyRenderer.prototype.getComment = function(){ return (this.cframe ? this.cframe.getComment() : false);}\r\nPropertyRenderer.prototype.load = function(link){ return (this.parent ? this.parent.load(link) : false);}\r\nPropertyRenderer.prototype.hasCardinalityRestriction = function(){return (this.cframe ? this.cframe.hasRestriction() : false);};\r\nPropertyRenderer.prototype.getRestriction = function(){return (this.cframe ? this.cframe.restriction : false);};\r\nPropertyRenderer.prototype.isClassChoice = function(){\treturn (this.cframe ? this.cframe.isClassChoice() : false);};\r\nPropertyRenderer.prototype.currentFacet = function(){\treturn this.facet;} ;\r\nPropertyRenderer.prototype.save = function(){ return (this.parent ? this.parent.save() : false);};\r\n\r\nPropertyRenderer.prototype.cancel = function(){\r\n\tthis.reset();\r\n\tthis.setMode(\"view\");\r\n}\r\n\r\nPropertyRenderer.prototype.getAvailableClassChoices = function(){\r\n\tif(this.cframe){\r\n\t\tvar cf = this.cframe.getClassChoices();\r\n\t\tif(this.parent){\r\n\t\t\tvar choices = [];\r\n\t\t\tfor(var i = 0; i < cf.length; i++){\r\n\t\t\t\tvar clsmeta = this.parent.getClassMeta(cf[i]);\r\n\t\t\t\tvar lab = (clsmeta ? HTMLFrameHelper.getVariableValueFromBinding(\"Label\", clsmeta) : false);\r\n\t\t\t\tvar lab = (lab ? lab : TerminusClient.FrameHelper.labelFromURL(cf[i]));\r\n\t\t\t\tchoices.push({value: cf[i], label: lab});\r\n\t\t\t}\r\n\t\t\treturn choices;\r\n\t\t}\r\n\t\treturn cf;\r\n\r\n\t}\r\n\treturn false;\r\n};\r\n\r\n\r\nPropertyRenderer.prototype.delete = function(){\r\n\tvar prop = this.predicate;\r\n\tif(prop){\r\n\t\tthis.reset();\r\n\t\tthis.parent.deleteProperty(prop);\r\n\t\tthis.parent.redraw();\r\n\t}\r\n}\r\n\r\nPropertyRenderer.prototype.add = function(view){\r\n\tthis.parent.addProperty(this.property(), view);\r\n\tthis.updated();\r\n\tif(view) {\r\n\t\tthis.values[this.values.length-1].setMode(view);\r\n\t\tthis.values[this.values.length-1].setNew();\r\n\t}\r\n\tthis.redraw();\r\n}\r\n\r\nPropertyRenderer.prototype.goToValue = function(index){\r\n\tthis.viewer.goTo(this.subject(), this.property(), index);\r\n}\r\n\r\nPropertyRenderer.prototype.addClass = function(cls){\r\n\tthis.parent.addPropertyClass(this.property(), cls);\r\n\tthis.updated();\r\n\tvar newb = this.values[this.values.length-1];\r\n\tif(newb){\r\n\t\tnewb.setNew();\r\n\t\tnewb.setMode(\"edit\");\r\n\t}\r\n\tthis.redraw();\r\n\tif(newb) this.viewer.goTo(newb.subject());\r\n}\r\n\r\nPropertyRenderer.prototype.reset = function(){\r\n\tthis.parent.objframe.reset(this.predicate);\r\n\tif(this.cframe && this.cframe.isData()){\r\n\t\tfor(var i = 0; i<this.values.length; i++){\r\n\t\t\tthis.values[i].reset();\r\n\t\t}\r\n\t\tthis.values = [];\r\n\t}\r\n\telse {\r\n\t\tvar nvals = [];\r\n\t\tfor(var i = 0; i<this.originalValues.length; i++){\r\n\t\t\tfor(var j = 0; j<this.values.length; j++){\r\n\t\t\t\tthis.values[j].reset();\r\n\t\t\t\tif(this.values[j].subject() == this.originalValues[i]){\r\n\t\t\t\t\tnvals.push(this.values[j]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.values = nvals;\r\n\t}\r\n\tthis.redraw();\r\n\tthis.parent.childUpdated();\r\n}\r\n\r\nPropertyRenderer.prototype.deletePropertyValue = function(value, index){\r\n\tthis.parent.objframe.removePropertyValue(this.property(), value, index);\r\n\tvar nvals = [];\r\n\tfor(var i = 0; i<this.values.length; i++){\r\n\t\tif(typeof index == \"undefined\"){\r\n\t\t\tif(this.values[i].subject() == value){\r\n\t\t\t\tthis.values[i].reset();\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tnvals.push(this.values[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if(i != index){\r\n\t\t\tthis.values[i].index = nvals.length;\r\n\t\t\tnvals.push(this.values[i]);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.values[i].reset();\r\n\t\t}\r\n\t}\r\n\tthis.values = nvals;\r\n\tthis.parent.childUpdated();\r\n\tthis.parent.redraw();\r\n}\r\n\r\nPropertyRenderer.prototype.addPropertyValue = function(value){\r\n\tthis.updated();\r\n\treturn this.parent.objframe.addPropertyValue(this.property(), value);\r\n}\r\n\r\n/*\r\n * Checks to see if an action (add, clone, delete) which affects the cardinality of the property is allowed by cardinality rules.\r\n */\r\nPropertyRenderer.prototype.cardControlAllows = function(action){\r\n\tif(this.cframe.hasRestriction()){\r\n\t\tvar rest = this.cframe.restriction;\r\n\t\tvar currentnum = this.values.length;\r\n\t\tif(action == \"add\" || action == \"clone\"){\r\n\t\t\tif(rest.max && currentnum >= rest.max){\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(action == \"delete\" && (rest.min)){\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nPropertyRenderer.prototype.isNew = function(){\r\n\tif(this.new_property){\r\n\t\treturn true;\r\n\t}\r\n\treturn this.parent.isNew();\r\n}\r\n\r\nPropertyRenderer.prototype.setNew = function(){\r\n\tthis.new_property = true;\r\n}\r\n\r\n\r\nPropertyRenderer.prototype.isUpdated = function(){\r\n\tif(this.values.length != this.originalValues.length) return true;\r\n\tfor(var i = 0 ; i < this.values.length; i++){\r\n\t\tif(this.cframe && this.cframe.isData()){\r\n\t\t\tif(this.values[i].value() != this.originalValues[i]){\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tif(this.values[i].subject() != this.originalValues[i]) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\tif(this.values[i].isUpdated()) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nPropertyRenderer.prototype.childUpdated = function(){\r\n\tthis.viewer.redrawHeader();\r\n\tif(this.parent) this.parent.childUpdated();\r\n}\r\n\r\n\r\n/**\r\n * Sets mode of viewer to either \"view\" or \"edit\"\r\n */\r\nPropertyRenderer.prototype.setMode = function(mode){\r\n\tthis.mode = mode;\r\n\tfor(var i = 0; i<this.values.length; i++){\r\n\t\tthis.values[i].setMode(mode);\r\n\t}\r\n\tthis.redraw();\r\n}\r\n\r\n/*\r\n * Jump to property value\r\n */\r\nPropertyRenderer.prototype.getViewableValues = function(){\r\n\tvar viewables = [];\r\n\tif(this.cframe && this.cframe.isData())\r\n\tfor(var i = 0; i<this.values.length; i++){\r\n\t\tvar sum = this.values[i].getSummary();\r\n\t\tvar lab = sum.long;\r\n\t\tviewables.push({label: lab, value: i});\r\n\t}\r\n\treturn viewables;\r\n}\r\n\r\nPropertyRenderer.prototype.hideDisabledControls = function(){\r\n\treturn this.hide_disabled_controls;\r\n}\r\n\r\nPropertyRenderer.prototype.setFacet = function(facet, nocascade){\r\n\tthis.facet = facet;\r\n\tif(!nocascade){\r\n\t\tfor(var i = 0; i<this.values.length; i++){\r\n\t\t\tthis.values[i].parentFacetChange(facet);\r\n\t\t}\r\n\t}\r\n\tthis.redraw();\r\n}\r\n\r\nPropertyRenderer.prototype.parentFacetChange = function(facet){\r\n\tif(facet == 'page'){\r\n\t\tif(!(this.facet == \"page\" || this.facet == \"multiline\")){\r\n\t\t\tthis.setFacet('multiline');\r\n\t\t}\r\n\t}\r\n\tif(facet == 'line'){\r\n\t\tthis.setFacet(\"label\");\r\n\t}\r\n\r\n}\r\n\r\n\r\n\r\nPropertyRenderer.prototype.getDefaultFacets = function(){\r\n\tvar defs = {\r\n\t\tpage: {\r\n\t\t\tlabel: \"Full Page\", value: \"page\",\r\n\t\t\tfeatures: [\"facet\", \"label\", \"comment\", \"id\", \"control\", \"type\", \"cardinality\", \"body\", \"status\", \"facet\", \"view\", \"viewer\"],\r\n\t\t\tcontrols: [\"delete\", \"clone\", \"add\", \"reset\", \"cancel\", \"update\", \"mode\", \"show\", \"hide\"]\r\n\t\t},\r\n\t\tmultiline: {\r\n\t\t\tlabel: \"Multiple Lines\", value: \"multiline\",\r\n\t\t\tfeatures: [\"facet\", \"label\", \"comment\", \"id\", \"control\", \"type\", \"cardinality\", \"body\", \"status\", \"facet\", \"view\", \"viewer\"],\r\n\t\t\tcontrols: [\"delete\", \"clone\", \"add\", \"reset\", \"cancel\", \"update\", \"mode\", \"show\", \"hide\"]\r\n\t\t},\r\n\t\tline: {\r\n\t\t\tlabel: \"Single Line\", value: \"line\",\r\n\t\t\tfeatures: [\"facet\", \"label\", \"comment\", \"id\", \"control\", \"type\", \"cardinality\", \"body\", \"status\", \"facet\", \"viewer\"],\r\n\t\t\tcontrols: [\"delete\", \"clone\", \"add\", \"reset\", \"cancel\", \"update\", \"mode\", \"show\", \"hide\"]\r\n\t\t},\r\n\t\tsummary: {\r\n\t\t\tlabel: \"Summary\", value: \"summary\",\r\n\t\t\tfeatures: [\"facet\", \"satus\", \"label\", \"type\", \"cardinality\", \"body\", \"status\", \"facet\", \"viewer\"],\r\n\t\t\tcontrols: []\r\n\t\t},\r\n\t\tlabel: {\r\n\t\t\tlabel: \"Label\", value: \"label\",\r\n\t\t\tfeatures: [\"facet\", \"status\", \"label\", \"summary\"],\r\n\t\t\tcontrols: []\r\n\t\t},\r\n\t\ticon: {\r\n\t\t\tlabel: \"Snippet\", value: \"icon\",\r\n\t\t\tfeatures: [\"facet\", \"summary\"],\r\n\t\t\tcontrols: []\r\n\t\t}\r\n\t}\r\n\treturn defs;\r\n}\r\n\r\nPropertyRenderer.prototype.getAvailableFacets = function(){\r\n\treturn Object.values(this.facets);\r\n\tvar facets = [];\r\n\tfacets.push({label: \"Full Page\", value: \"page\"});\r\n\tfacets.push({label: \"Multiple Lines\", value: \"multiline\"});\r\n\tfacets.push({label: \"Single Line\", value: \"line\"});\r\n\tfacets.push({label: \"Summary\", value: \"summary\"});\r\n\tfacets.push({label: \"Label\", value: \"label\"});\r\n\tfacets.push({label: \"Snippet\", value: \"icon\"});\r\n\treturn facets;\r\n}\r\n\r\nPropertyRenderer.prototype.getContentOrientation = function(facet){\r\n\tif(this.currentFacet() == \"page\" || this.containsPage()){\r\n\t\treturn \"page\";\r\n\t}\r\n\tif(this.currentFacet() == \"line\" || this.currentFacet() == \"multiline\" || this.currentFacet() == \"summary\"){\r\n\t\treturn \"line\";\r\n\t}\r\n\treturn \"label\";\r\n}\r\n\r\n\r\nPropertyRenderer.prototype.getDefaultFacet = function(){\r\n\tif(this.cframe && this.cframe.isObject()){\r\n\t\treturn \"page\";\r\n\t}\r\n\treturn \"multiline\";\r\n}\r\n\r\n/*\r\n * Viewers for specific properties\r\n */\r\n\r\nPropertyRenderer.prototype.hide = function(){\r\n\tthis.setView(\"hidden\");\r\n}\r\n\r\nPropertyRenderer.prototype.show = function(){\r\n\tthis.setView(\"full\");\r\n}\r\n\r\nPropertyRenderer.prototype.setView = function(view){\r\n\tthis.view = view;\r\n\tthis.redraw();\r\n}\r\n\r\nPropertyRenderer.prototype.getAvailableViewers = function(){\r\n\tif(this.mode == \"view\"){\r\n\t\treturn TerminusDashboard.RenderingMap.getAvailablePropertyViewers(this);\r\n\t}\r\n\treturn TerminusDashboard.RenderingMap.getAvailablePropertyEditors(this);\r\n}\r\n\r\nPropertyRenderer.prototype.nukeViewer = function(){\r\n\tthis.viewer.remove();\r\n}\r\n\r\nPropertyRenderer.prototype.containsPage = function(){\r\n\t//collapsed facets do not show their values\r\n\tif(this.currentFacet() == \"icon\" || this.currentFacet() == \"label\") return false;\r\n\tfor(var i = 0; i<this.values.length; i++){\r\n\t\tif(this.values[i].facet == \"page\") {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nPropertyRenderer.prototype.getViewerForProperty = function(ptype){\r\n\tif(this.mode == \"edit\"){\r\n\t\treturn new PropertyViewer.HTMLPropertyViewer(this);\r\n\t}\r\n\treturn new PropertyViewer.HTMLPropertyViewer(this);\r\n}\r\n\r\nPropertyRenderer.prototype.getPropertyHeaderViewer = function(){\r\n\treturn new PropertyViewer.HTMLPropertyHeaderViewer();\r\n}\r\n\r\nPropertyRenderer.prototype.getSummary = function(){\r\n\tvar status = \"ok\";\r\n\tif(this.isNew()) status = \"new\";\r\n\telse if(this.isUpdated()) status = \"updated\";\r\n\tvar ret = {\r\n\t\tstatus: status,\r\n\t\tvalcount: this.values.length\r\n\t};\r\n\tret.long = ((ret.valcount != 1) ? \"(\" + ret.valcount + \") \" : \"\");\r\n\tfor(var i = 0; i<this.values.length; i++){\r\n\t\tvsum = this.values[i].getSummary();\r\n\t\tret.long += vsum.long;\r\n\t\tif(i < this.values.length-1) ret.long += \", \";\r\n\t}\r\n\treturn ret;\r\n}\r\n\r\nPropertyRenderer.prototype.getFeaturesForFacet = function(facet){\r\n\treturn this.facets[facet].features.concat(this.facets[facet].controls);\r\n}\r\n\r\nPropertyRenderer.prototype.showFeature = function(which){\r\n\tif(this.features.indexOf(which) == -1 && this.controls.indexOf(which) == -1) {\r\n\t\treturn false;\r\n\t}\r\n\tvar cardcontrols = [\"delete\", \"clone\", \"add\"];\r\n\tif(cardcontrols.indexOf(which) != -1){\r\n\t\tif(!this.cardControlAllows(which)) return false;\r\n\t}\r\n\tvar updcontrols = [\"update\", \"reset\"];\r\n\tif(this.hideDisabledControls() && updcontrols.indexOf(which) != -1 ){\r\n\t\tif(!this.isUpdated()){\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\tif(which == 'hide' && this.view == \"hidden\") return false;\r\n\tif(which == 'show' && this.view != \"hidden\") return false;\r\n\tvar fets = this.getFeaturesForFacet(this.facet);\r\n\treturn (fets.indexOf(which) != -1);\r\n}\r\n\r\nfunction ObjectRenderer(obj, parent, options){\r\n\tthis.objframe = obj;\r\n\tthis.parent = parent;\r\n\tthis.properties = {};\r\n\tthis.originalProperties = false;\r\n\tthis.newProperties = [];\r\n\tthis.renderer_type = \"object\";\r\n\tthis.options = this.setOptions(options);\r\n}\r\n\r\n//options has to include mode, viewer, facet, controls, features, hide_disabled_controls\r\n\r\nObjectRenderer.prototype.setOptions = function(options){\r\n\treturn TerminusDashboard.RenderingMap.decorateRenderer(options, this);\r\n}\r\n\r\nObjectRenderer.prototype.getOptionsForProperty = function(prop){\r\n\treturn this.options;\r\n}\r\n\r\nObjectRenderer.prototype.render = function(viewer){\r\n\tthis.buildPropertyRenderers();\r\n\tthis.viewer = (viewer ? viewer: this.getViewerForObject());\r\n\tfor(var prop in this.properties){\r\n\t\tvar renderedprop = this.properties[prop].render();\r\n\t\tif(renderedprop && this.showFeature(\"body\")) this.viewer.addRenderedProperty(prop, renderedprop);\r\n\t}\r\n\treturn this.viewer.render(this.view);\r\n}\r\n\r\nObjectRenderer.prototype.buildPropertyRenderers = function(){\r\n\tvar props = this.getPropertiesToRender();\r\n\tif(this.originalProperties === false) this.originalProperties = props;\r\n\tvar renders = {};\r\n\tfor(var j = 0; j<props.length; j++){\r\n\t\tif(typeof this.properties[props[j]] == \"undefined\"){\r\n\t\t\trenders[props[j]] = new PropertyRenderer(props[j], this, this.getOptionsForProperty(props[j]));\r\n\t\t}\r\n\t\telse {\r\n\t\t\trenders[props[j]] = this.properties[props[j]];\r\n\t\t}\r\n\t\tif(this.newProperties.indexOf(props[j]) != -1) {\r\n\t\t\trenders[props[j]].setNew();\r\n\t\t\trenders[props[j]].mode = \"edit\";\r\n\t\t}\r\n\t}\r\n\tthis.properties = renders;\r\n}\r\n\r\nObjectRenderer.prototype.subject = function(){\r\n\tif(this.objframe) return this.objframe.subjid;\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.subjectClass = function(){\r\n\tif(this.objframe) return this.objframe.cls;\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.getAvailableViewers = function(){\r\n\t//if(this.mode == \"view\"){\r\n\t//\treturn RenderingMap.getAvailableObjectViewers(this);\r\n\t//}\r\n\t//return RenderingMap.getAvailableObjectEditors(this);\r\n\treturn [\"html\", \"json\"];\r\n}\r\n\r\nObjectRenderer.prototype.depth = function(){\r\n\tif(this.parent) return (this.parent.depth() + 1);\r\n\treturn 0;\r\n}\r\n\r\n\r\nObjectRenderer.prototype.property = function(){\r\n\tif(this.parent) return this.parent.property();\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.parentObject = function(){\r\n\tif(this.parent && this.parent.parent && this.parent.parent.objframe){\r\n\t\treturn this.parent.parent.objframe;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.root = function(){\r\n\tif(this.parent) return false;\r\n\treturn true;\r\n}\r\n\r\nObjectRenderer.prototype.load = function(link){\r\n\tvar self = this;\r\n\tif(this.controller){\r\n\t\tthis.controller.ui.showDocument(link);\r\n\t}\r\n\telse if(this.parent) {\r\n\t\tthis.parent.load(link);\r\n\t}\r\n}\r\n\r\nObjectRenderer.prototype.copy = function(nkid){\r\n\tnkid = (nkid ? nkid : this.objframe);\r\n\tvar other = new ObjectRenderer(nkid, this.parent, this.options);\r\n\treturn other;\r\n}\r\n\r\nObjectRenderer.prototype.clone = function(){\r\n\tif(this.root()){\r\n\t\tthis.objframe = this.objframe.clone(\"_:\");\r\n\t\tthis.objframe.newDoc = true;\r\n\t\tthis.setMode(\"edit\");\r\n\t}\r\n\telse {\r\n\t\tvar nkid = this.objframe.clone(TerminusClient.FrameHelper.genBNID());\r\n\t\tvar parentobj = this.parentObject();\r\n\t\tvar prop = this.property();\r\n\t\tif(parentobj && prop){\r\n\t\t\tif(typeof parentobj.children[prop] == \"undefined\"){\r\n\t\t\t\tparentobj.children[prop] = [];\r\n\t\t\t}\r\n\t\t\tparentobj.children[prop].push(nkid);\r\n\t\t\tvar newrend = this.copy(nkid);\r\n\t\t\tthis.parent.values.push(newrend);\r\n\t\t}\r\n\t\tthis.parent.redraw();\r\n\t}\r\n}\r\n\r\nObjectRenderer.prototype.cancel = function(){\r\n\tthis.reset();\r\n\tthis.setMode(\"view\");\r\n}\r\n\r\nObjectRenderer.prototype.save = function(){\r\n\tif(this.controller){\r\n\t\tif(this.isNewDocument()){\r\n\t\t\tvar demandid = this.inputID();\r\n\t\t\tif(demandid == \"_:\") demandid = \"\";\r\n            var extr = this.extract();\r\n\t\t\tthis.controller.createDocument(demandid, extr);\r\n\t\t}\r\n\t\telse {\r\n            var extr = this.extract();\r\n\t\t\tthis.controller.updateDocument(extr);\r\n\t\t}\r\n\t}\r\n\telse if(this.parent) {\r\n\t\tthis.parent.save();\r\n\t}\r\n}\r\n\r\nObjectRenderer.prototype.delete = function(){\r\n\tvar dval = this.subject();\r\n\tif(this.controller && this.root()){\r\n\t\tif(!this.isNewDocument()){\r\n\t\t\tthis.controller.deleteDocument(dval);\r\n\t\t}\r\n\t\tthis.nukeViewer();\r\n\t}\r\n\telse {\r\n\t\tif(this.parent){\r\n\t\t\tthis.parent.deletePropertyValue(dval);\r\n\t\t\tthis.parent.redraw();\r\n\t\t}\r\n\t}\r\n}\r\n\r\nObjectRenderer.prototype.reset = function(){\r\n\tthis.objframe.reset();\r\n\tvar nprops = {};\r\n\tfor(var i = 0; i<this.originalProperties.length; i++){\r\n\t\tvar prop = this.originalProperties[i];\r\n\t\tif(typeof this.properties[prop] == \"object\"){\r\n\t\t\tthis.properties[prop].reset();\r\n\t\t\tnprops[prop] = this.properties[prop];\r\n\t\t}\r\n\t}\r\n\tthis.properties = nprops;\r\n\tthis.redraw();\r\n}\r\n\r\nObjectRenderer.prototype.deleteProperty = function(prop){\r\n\tthis.objframe.removeProperty(prop);\r\n\tdelete(this.properties[prop]);\r\n\tthis.updated();\r\n}\r\n\r\nObjectRenderer.prototype.addProperty = function(prop){\r\n\tthis.objframe.addProperty(prop);\r\n\tthis.updated();\r\n\tthis.redraw();\r\n}\r\n\r\nObjectRenderer.prototype.addNewProperty = function(prop){\r\n\tthis.objframe.addProperty(prop);\r\n\tthis.updated();\r\n\tthis.newProperties.push(prop);\r\n\tthis.redraw();\r\n\tthis.goToProperty(prop);\r\n}\r\n\r\nObjectRenderer.prototype.addPropertyClass = function(prop, cls){\r\n\tthis.objframe.addProperty(prop, cls);\r\n\tthis.updated();\r\n}\r\n\r\nObjectRenderer.prototype.changeClass = function(cls){\r\n\tif(this.parent){\r\n\t\tthis.parent.addClass(cls);\r\n\t\tthis.parent.deletePropertyValue(this.subject());\r\n\t}\r\n}\r\n\r\nObjectRenderer.prototype.getClassMeta = function(cls){\r\n\tvar ctl = this.getController();\r\n\tif(ctl && ctl.classmeta && ctl.classmeta[cls]){\r\n\t\treturn ctl.classmeta[cls];\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.getController = function(){\r\n\tif(this.controller){\r\n\t\treturn this.controller;\r\n\t}\r\n\tif(this.parent && this.parent.parent){\r\n\t\treturn this.parent.parent.getController();\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.getClient = function(){\r\n\tif(this.controller){\r\n\t\treturn this.controller.getClient();\r\n\t}\r\n\telse {\r\n\t\tif(this.parent && this.parent.parent){\r\n\t\t\treturn(this.parent.parent.getClient())\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.inputID = function(){\r\n\tif(this.idDOM){\r\n\t\treturn this.idDOM.value;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.isNew = function(){\r\n\tif(this.new_object){\r\n\t\treturn true;\r\n\t}\r\n\tif(this.isPartOfNewDocument()){\r\n\t\treturn true;\r\n\t}\r\n\tif(this.parent) return this.parent.isNew();\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.setNew = function(){\r\n\tthis.new_object = true;\r\n}\r\n\r\nObjectRenderer.prototype.isUpdated = function(){\r\n\tvar i = 0;\r\n\tfor(var prop in this.properties){\r\n\t\tif(this.originalProperties[i] != prop) return true;\r\n\t\tif(this.properties[prop].isUpdated()) return true;\r\n\t\ti++;\r\n\t}\r\n\tif(i != this.originalProperties.length) return true;\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.childUpdated = function(){\r\n\tthis.viewer.redrawHeader();\r\n\tif(this.parent) this.parent.childUpdated();\r\n}\r\n\r\nObjectRenderer.prototype.updated = ObjectRenderer.prototype.childUpdated;\r\n\r\nObjectRenderer.prototype.isNewDocument = function(){\r\n\tif(this.root() && this.objframe.isnew()) return true;\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.isPartOfNewDocument = function(){\r\n\tif(this.isNewDocument()) return true;\r\n\tif(this.parent && this.parent.parent){\r\n\t\treturn this.parent.parent.isPartOfNewDocument();\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.setFacet = function(facet, nocascade){\r\n\tthis.facet = facet;\r\n\tif(!nocascade){\r\n\t\tfor(var prop in this.properties){\r\n\t\t\tthis.properties[prop].parentFacetChange(facet);\r\n\t\t}\r\n\t}\r\n\tif(this.parent){\r\n\t\tthis.parent.redraw();\r\n\t}\r\n\telse {\r\n\t\tthis.redraw();\r\n\t}\r\n}\r\n\r\nObjectRenderer.prototype.getDefaultFacets = function(){\r\n\tvar defs = {\r\n\t\tpage: {\r\n\t\t\tlabel: \"Full Page\", value: \"page\",\r\n\t\t\tfeatures: [\"facet\", \"label\", \"comment\", \"id\", \"control\", \"type\", \"body\", \"status\", \"facet\", \"view\", \"viewer\"],\r\n\t\t\tcontrols: [\"delete\", \"clone\", \"add\", \"reset\", \"cancel\", \"update\", \"mode\", \"show\", \"hide\"]\r\n\t\t},\r\n\t\tline: {\r\n\t\t\tlabel: \"Single Line\", value: \"line\",\r\n\t\t\tfeatures: [\"facet\", \"label\", \"comment\", \"id\", \"type\", \"body\", \"status\", \"facet\"],\r\n\t\t\tcontrols: []\r\n\t\t},\r\n\t\tsummary: {\r\n\t\t\tlabel: \"Summary\", value: \"summary\",\r\n\t\t\tfeatures: [\"facet\", \"satus\", \"label\", \"type\", \"summary\", \"status\", \"facet\"],\r\n\t\t\tcontrols: []\r\n\t\t},\r\n\t\tlabel: {\r\n\t\t\tlabel: \"Label\", value: \"label\",\r\n\t\t\tfeatures: [\"facet\", \"status\", \"label\"],\r\n\t\t\tcontrols: []\r\n\t\t}\r\n\t}\r\n\treturn defs;\r\n}\r\n\r\nObjectRenderer.prototype.getAvailableFacets = function(){\r\n\treturn Object.keys(this.facets);\r\n}\r\n\r\nObjectRenderer.prototype.currentFacet = function(){\r\n\treturn this.facet;\r\n}\r\n\r\nObjectRenderer.prototype.getDefaultFacet = function(){\r\n\tif(!this.parent) return \"page\";\r\n\tvar pfacet = this.parent.currentFacet();\r\n\tif(pfacet == \"page\"){\r\n\t\treturn \"page\";\r\n\t}\r\n\tif(pfacet == \"multiline\") return \"line\";\r\n\tif(pfacet == \"line\") return \"summary\";\r\n\treturn \"label\";\r\n}\r\n\r\nObjectRenderer.prototype.parentFacetChange = function(pfacet){\r\n\tif(pfacet == \"page\") this.setFacet(\"page\");\r\n\tif(pfacet == \"multiline\") this.setFacet(\"summary\");\r\n\tif(pfacet == \"line\") this.setFacet(\"summary\");\r\n\tif(pfacet == \"summary\") this.setFacet(\"summary\");\r\n}\r\n\r\nObjectRenderer.prototype.getContentOrientation = function(){\r\n\tif(this.currentFacet() == \"page\"){\r\n\t\treturn \"page\";\r\n\t}\r\n\tif(this.currentFacet() == \"line\"){\r\n\t\treturn \"line\";\r\n\t}\r\n\treturn \"label\";\r\n}\r\n\r\nObjectRenderer.prototype.getLabel = function(){\r\n\tfor(var prop in this.properties){\r\n\t\tif(TerminusClient.FrameHelper.getShorthand(prop) == \"rdfs:label\" || prop == \"rdfs:label\"){\r\n\t\t\tvar prend = this.properties[prop];\r\n\t\t\tvar vrend = prend.values[0];\r\n\t\t\tif(vrend){\r\n\t\t\t\tvar sum = vrend.getSummary();\r\n\t\t\t\tif(sum.long != \"empty\") return sum.long;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tvar s = this.subject();\r\n\tif(s && s.substring(0, 2) == \"_:\"){\r\n\t\tvar ty = this.subjectClass();\r\n\t\tvar sh = TerminusClient.FrameHelper.getShorthand(ty);\r\n\t\tif(!sh) sh = ty;\r\n\t\tvar b = sh.split(\":\");\r\n\t\tif(b.length > 1){\r\n\t\t\treturn \"New \" + b[1];\r\n\t\t}\r\n\t\treturn \"New Object\";\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.getSummary = function(){\r\n\tvar ret = { status: \"ok\" };\r\n\tif(this.isUpdated()) ret.status = \"updated\";\r\n\tif(this.isNew()) ret.status = \"new\";\r\n\tret.propcount = 0;\r\n\tfor(var prop in this.properties){\r\n\t\tret.propcount++;\r\n\t}\r\n\tret.long = ret.propcount + \" properties\";\r\n\treturn ret;\r\n}\r\n\r\nObjectRenderer.prototype.getObjectHeaderViewer = function(){\r\n\treturn this.header_viewer;\r\n}\r\n\r\nObjectRenderer.prototype.getViewerForObject = function(format){\r\n\tif(format == \"json\"){\r\n\t\treturn new ObjectViewer.JSONObjectViewer(this);\r\n\t}\r\n\treturn new ObjectViewer.HTMLObjectViewer(this);\r\n}\r\n\r\nObjectRenderer.prototype.getFeaturesForFacet = function(facet){\r\n\treturn this.facets[facet].features.concat(this.facets[facet].controls);\r\n}\r\n\r\nObjectRenderer.prototype.hideDisabledControls = function(){\r\n\treturn this.hide_disabled_controls;\r\n}\r\n\r\nObjectRenderer.prototype.showFeature = function(which){\r\n\tif(this.features.indexOf(which) == -1 && this.controls.indexOf(which) == -1) {\r\n\t\treturn false;\r\n\t}\r\n\tvar cardcontrols = [\"delete\", \"clone\", \"add\"];\r\n\tif(cardcontrols.indexOf(which) != -1){\r\n\t\tif(!this.cardControlAllows(which)) return false;\r\n\t}\r\n\tvar updcontrols = [\"update\", \"reset\"];\r\n\tif(this.hideDisabledControls() && updcontrols.indexOf(which) != -1 ){\r\n\t\tif(!this.isUpdated()){\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\tif(this.isNewDocument() && which == \"clone\") return false;\r\n\tif(which == 'hide' && this.view == \"hidden\") return false;\r\n\tif(which == 'show' && this.view != \"hidden\") return false;\r\n\tvar fets = this.getFeaturesForFacet(this.facet);\r\n\tif (fets.indexOf(which) != -1){\r\n\t\treturn true;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.cardControlAllows = function(action){\r\n\tif(!this.parent) return true;\r\n\tif(this.parent.cframe.hasRestriction()){\r\n\t\tvar rest = this.parent.cframe.restriction;\r\n\t\tvar currentnum = this.parent.values.length;\r\n\t\tif(action == \"add\" || action == \"clone\"){\r\n\t\t\tif(rest.max && currentnum >= rest.max){\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(action == \"delete\" && (rest.min && currentnum <= rest.min)){\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nObjectRenderer.prototype.goToProperty = function(prop){\r\n\tthis.viewer.goTo(this.subject(), prop);\r\n}\r\n\r\nObjectRenderer.prototype.setMode = function(mode){\r\n\tthis.mode = mode;\r\n\tfor(var prop in this.properties){\r\n\t\tthis.properties[prop].setMode(mode);\r\n\t}\r\n\tthis.viewer.redraw();\r\n}\r\n\r\nObjectRenderer.prototype.currentViewer = function(){return this.viewerType;}\r\n\r\n\r\nObjectRenderer.prototype.setViewer = function(viewer){\r\n\tvar nviewer = this.getViewerForObject(viewer);\r\n\tif(nviewer){\r\n\t\tthis.viewerType = viewer;\r\n\t\tthis.viewer = nviewer;\r\n\t\tthis.viewer.redraw();\r\n\t}\r\n}\r\n\r\n\r\nObjectRenderer.prototype.setView = function(view){\r\n\tvar views = {\r\n\t\t\"full\": {\r\n\r\n\t\t},\r\n\t\t\"hidden\": {\r\n\r\n\t\t}\r\n\t};\r\n\tthis.view = view;\r\n\tthis.viewer.redraw();\r\n}\r\n\r\n\r\nObjectRenderer.prototype.hide = function(){\r\n\tthis.setView(\"hidden\");\r\n}\r\n\r\nObjectRenderer.prototype.show = function(){\r\n\tthis.setView(\"full\");\r\n}\r\n\r\nObjectRenderer.prototype.nukeViewer = function(){\r\n\tthis.viewer.remove();\r\n}\r\n\r\nObjectRenderer.prototype.getViewableProperties = function(){\r\n\treturn this.objframe.getFilledPropertyList();\r\n}\r\n\r\nObjectRenderer.prototype.getAddableProperties = function(){\r\n\tvar props = this.objframe.getMissingPropertyList();\r\n\treturn props;\r\n}\r\n\r\nObjectRenderer.prototype.getPropertiesToRender = function(options){\r\n\tvar sort = this.standardSort;\r\n\tvar filter = function(){return true};\r\n\tif(options && options.map && options.map.patterns){\r\n\t\t/*for(var i = 0; i<options.map.patterns.length; i++){\r\n\t\t\tif(this.objframe.matchesPattern({property: this.property(), action: \"sort\"}, options.map.patterns[i])){\r\n\t\t\t\tsort = options.map.patterns[i].sort;\r\n\t\t\t}\r\n\t\t\tif(this.objframe.matchesPattern({property: this.property(), action: \"filter\"}, options.map.patterns[i])){\r\n\t\t\t\tfilter = options.map.patterns[i].filter;\r\n\t\t\t}\r\n\t\t}*/\r\n\t}\r\n\treturn sort(this.objframe, filter);\r\n}\r\n\r\nObjectRenderer.prototype.standardSort = function(objframe, filter){\r\n\tvar sorted = [];\r\n\tvar rdft = TerminusClient.FrameHelper.getStdURL(\"rdfs\", \"label\");\r\n\tif(objframe.dataframes[rdft] && filter(objframe, rdft, objframe.dataframes[rdft])){\r\n\t\tsorted.push(rdft);\r\n\t}\r\n\tvar rdfc = TerminusClient.FrameHelper.getStdURL(\"rdfs\", \"comment\");\r\n\tif(objframe.dataframes[rdfc]){\r\n\t\tsorted.push(rdfc);\r\n\t}\r\n\tfor(var prop in objframe.dataframes){\r\n\t\tif(sorted.indexOf(prop) == -1) sorted.push(prop);\r\n\t}\r\n\tfor(var prop in objframe.children){\r\n\t\tif(sorted.indexOf(prop) == -1) sorted.push(prop);\r\n\t}\r\n\treturn sorted;\r\n}\r\n\r\n\r\nObjectRenderer.prototype.redraw = function(){\r\n\tthis.viewer.clear();\r\n\tthis.render(this.viewer);\r\n}\r\n\r\nObjectRenderer.prototype.extractLDO = function(extracts){\r\n\textracts[\"rdf:type\"] = this.objframe.cls;\r\n\tvar full = {};\r\n\tfull[this.subject()] = extracts;\r\n\treturn full;\r\n}\r\n\r\nObjectRenderer.prototype.extractJSONLD = function(extracts){\r\n\textracts[\"@type\"] = this.objframe.cls;\r\n\tif(this.subject() != \"_:\")\textracts[\"@id\"] = this.subject();\r\n\tif(this.objframe.jsonld_context) extracts['@context'] = this.objframe.jsonld_context;\r\n\treturn extracts;\r\n}\r\n\r\nObjectRenderer.prototype.extract = function(){\r\n\tvar extracts = {};\r\n\tfor(var i in this.properties){\r\n\t\tvar extracted = this.properties[i].extract();\r\n\t\tif(!TerminusClient.FrameHelper.empty(extracted)){\r\n\t\t\textracts[i] = extracted;\r\n\t\t}\r\n\t}\r\n\tif(TerminusClient.FrameHelper.empty(extracts) && this.parent){\r\n\t\treturn false;\r\n\t}\r\n\telse {\r\n\t\tvar ext = this.extractJSONLD(extracts);\r\n\t\treturn ext;\r\n\t\t//return this.extractLDO(extracts);\r\n\t}\r\n}\r\n\r\nmodule.exports={ObjectRenderer,PropertyRenderer}\r\n","const HTMLPropertyViewer = require('../html/document/PropertyViewer');\r\nconst RenderingMap = require('./RenderingMap');\r\nconst HTMLDataViewer = require('../html/document/DataViewer');\r\n\r\nfunction ValueRenderer(dataframe, index, parent, options){\r\n\tthis.frame = dataframe;\r\n\tthis.index = index;\r\n\tthis.parent = parent;\r\n\tthis.originalValue = this.value();\r\n\tthis.renderer_type = \"value\";\r\n\tthis.options = this.setOptions(options);\r\n}\r\n\r\nValueRenderer.prototype.depth = () => this.parent ? this.parent.depth() : false;\r\nValueRenderer.prototype.property = () => this.parent ? this.parent.property() : false;\r\nValueRenderer.prototype.subject = () => this.parent ? this.parent.subject() : false;\r\nValueRenderer.prototype.subjectClass = () => this.parent ? this.parent.subjectClass() : false;\r\nValueRenderer.prototype.type = () => this.frame ? this.frame.range : false;\r\nValueRenderer.prototype.range = () => this.frame ? this.frame.range : false;\r\nValueRenderer.prototype.value = () => this.frame ? this.frame.get() : false;\r\nValueRenderer.prototype.isDocument = () => this.frame ? this.frame.isDocument() : false;\r\nValueRenderer.prototype.currentViewer = () => this.viewerType;\r\n\r\nValueRenderer.prototype.copy = function(nf){\r\n\tvar nvr = new ValueRenderer(nf, false, this.parent, this.options);\r\n\tnvr.mode = this.mode;\r\n\tnvr.view = this.view;\r\n\treturn nvr;\r\n}\r\n\r\nValueRenderer.prototype.setFacet = function(facet){\r\n\tthis.facet = facet;\r\n\tthis.parent.redraw();\r\n}\r\n\r\nValueRenderer.prototype.parentFacetChange = function(pfacet){\r\n\tif(pfacet == \"page\") this.setFacet(\"page\");\r\n\tif(pfacet == \"multiline\") this.setFacet(\"line\");\r\n\tif(pfacet == \"line\") this.setFacet(\"inline\");\r\n\tif(pfacet == \"summary\") this.setFacet(\"icon\");\r\n}\r\n\r\nValueRenderer.prototype.getDefaultFacet = function(){\r\n\tif(this.parent.currentFacet() == \"page\" || this.parent.currentFacet() == \"multiline\"){\r\n\t\treturn \"line\";\r\n\t}\r\n\treturn \"inline\";\r\n}\r\n\r\nValueRenderer.prototype.getAvailableFacets = function(){\r\n\treturn Object.values(this.facets);\r\n}\r\n\r\nValueRenderer.prototype.getDefaultFacets = function(){\r\n\tvar defs = {\r\n\t\tpage: {\r\n\t\t\tlabel: \"Full Page\", value: \"page\",\r\n\t\t\tfeatures: [\"facet\", \"type\", \"cardinality\", \"body\", \"status\", \"facet\", \"viewer\", \"control\"],\r\n\t\t\tcontrols: [\"delete\", \"clone\", \"add\", \"reset\", \"cancel\", \"update\", \"mode\", \"show\", \"hide\"]\r\n\t\t},\r\n\t\tline: {\r\n\t\t\tlabel: \"Single Line\", value: \"line\",\r\n\t\t\tfeatures: [\"facet\", \"type\", \"cardinality\", \"body\", \"status\", \"facet\", \"viewer\", \"control\"],\r\n\t\t\tcontrols: [\"delete\", \"clone\", \"add\", \"reset\", \"cancel\", \"update\", \"mode\", \"show\", \"hide\"]\r\n\t\t},\r\n\t\tinline: {\r\n\t\t\tlabel: \"Inline\", value: \"inline\",\r\n\t\t\tfeatures: [\"facet\", \"type\", \"cardinality\", \"body\", \"status\", \"facet\", \"viewer\", \"control\"],\r\n\t\t\tcontrols: [\"delete\", \"clone\", \"add\", \"reset\", \"cancel\", \"update\", \"mode\", \"show\", \"hide\"]\r\n\t\t},\r\n\t\tlabel: {\r\n\t\t\tlabel: \"Label\", value: \"label\",\r\n\t\t\tfeatures: [\"facet\", \"status\", \"body\"],\r\n\t\t\tcontrols: []\r\n\t\t},\r\n\t\ticon: {\r\n\t\t\tlabel: \"Snippet\", value: \"icon\",\r\n\t\t\tfeatures: [\"facet\", \"summary\"],\r\n\t\t\tcontrols: []\r\n\t\t}\r\n\t}\r\n\treturn defs;\r\n}\r\n\r\nValueRenderer.prototype.currentFacet = function(){\r\n\treturn this.facet;\r\n}\r\n\r\nValueRenderer.prototype.setOptions = function(options){\r\n\treturn TerminusDashboard.RenderingMap.decorateRenderer(options, this);\r\n}\r\n\r\nValueRenderer.prototype.hideDisabledControls = function(){\r\n\treturn this.hide_disabled_controls;\r\n}\r\n\r\nValueRenderer.prototype.setMode = function(mode){\r\n\tthis.mode = mode;\r\n\tthis.options.mode = mode;\r\n\tthis.viewerType = false;\r\n\tthis.redraw();\r\n}\r\n\r\nValueRenderer.prototype.setView = function(view){\r\n\tthis.view = view;\r\n\tthis.options.view = view;\r\n\tthis.redraw();\r\n}\r\n\r\nValueRenderer.prototype.getAPIURL = function(a, b){\r\n\tif(this.parent && this.parent.parent){\r\n\t\tif(client = this.parent.parent.getClient()){\r\n\t\t\tvar apiurl = client.dbURL() + a + \"/\" + b;\r\n\t\t\treturn apiurl;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nValueRenderer.prototype.getClient = function(){\r\n\tif(this.parent && this.parent.parent){\r\n\t\treturn this.parent.parent.getClient();\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nValueRenderer.prototype.getController = function(){\r\n\tif(this.parent && this.parent.parent){\r\n\t\treturn this.parent.parent.getController();\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nValueRenderer.prototype.DBURL = function(){\r\n\tif(this.parent && this.parent.parent){\r\n\t\tif(client = this.parent.parent.getClient()){\r\n\t\t\treturn client.dbURL();\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nValueRenderer.prototype.getEntityReference = function(url, cls, entities, opts){\r\n\tif(this.parent && this.parent.parent){\r\n\t\tif(client = this.parent.parent.getClient()){\r\n\t\t\treturn client.getEntityReference(url, cls, entities, opts);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nValueRenderer.prototype.badData = function(bd){\r\n\talert(\"bad data \" + bd);\r\n}\r\n\r\nValueRenderer.prototype.setNew = function(){\r\n\tthis.new_value = true;\r\n}\r\n\r\nValueRenderer.prototype.isNew = function(){\r\n\tif(this.new_value){\r\n\t\treturn true;\r\n\t}\r\n\treturn this.parent.isNew();\r\n}\r\n\r\n\r\nValueRenderer.prototype.isUpdated = function(){\r\n\tif(this.frame.get() != this.originalValue){\r\n\t\treturn true;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nValueRenderer.prototype.getSummary = function(){\r\n\tvar ret = { status: \"ok\" };\r\n\tif(this.isNew()) ret.status = \"new\";\r\n\telse if(this.isUpdated()) ret.status = \"updated\";\r\n\tvar val = this.frame.get();\r\n\tif(val){\r\n\t\tif(val.length && val.length > this.text_summary_length){\r\n\t\t\tret.long = val.substring(0, this.text_summary_length) + \"...\" + \" (\" + val.length + \" characters)\";\r\n\t\t}\r\n\t\telse {\r\n\t\t\tret.long = val;\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tret.long = \"empty\";\r\n\t}\r\n\treturn ret;\r\n}\r\n\r\nValueRenderer.prototype.cardControlAllows = function(action){\r\n\tif(this.parent.cframe.hasRestriction()){\r\n\t\tvar rest = this.parent.cframe.restriction;\r\n\t\tvar currentnum = this.parent.values.length;\r\n\t\tif(action == \"add\" || action == \"clone\"){\r\n\t\t\tif(rest.max && currentnum >= rest.max){\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(action == \"delete\" && (rest.min && currentnum <= rest.min)){\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nValueRenderer.prototype.set = function(v){\r\n\tthis.frame.set(v);\r\n\tthis.viewer.redrawHeader();\r\n\tthis.parent.childUpdated();\r\n}\r\n\r\nValueRenderer.prototype.delete = function(){\r\n\tthis.parent.deletePropertyValue(this.value(), this.index);\r\n\tthis.parent.parent.redraw();\r\n}\r\n\r\nValueRenderer.prototype.load = function(link){\r\n\tthis.parent.load(link);\r\n}\r\n\r\nValueRenderer.prototype.hide = function(){\r\n\tthis.setView(\"hidden\");\r\n}\r\n\r\nValueRenderer.prototype.show = function(){\r\n\tthis.setView(\"full\");\r\n}\r\n\r\nValueRenderer.prototype.cancel = function(){\r\n\tthis.reset();\r\n\tthis.setMode(\"view\");\r\n}\r\n\r\nValueRenderer.prototype.save = function(){\r\n\tif(this.parent) {\r\n\t\tthis.parent.save();\r\n\t}\r\n}\r\n\r\nValueRenderer.prototype.reset = function(){\r\n\tthis.set(this.originalValue);\r\n\tthis.redraw();\r\n}\r\n\r\nValueRenderer.prototype.clone = function(){\r\n\tvar newb = this.parent.addPropertyValue(this.value());\r\n\tvar nrend = this.copy(newb);\r\n\tnrend.setNew();\r\n\tnrend.mode = \"edit\";\r\n\tnrend.index = this.parent.values.length;\r\n\tthis.parent.values.push(nrend);\r\n\tthis.parent.childUpdated();\r\n\tthis.parent.redraw();\r\n\tthis.parent.goToValue(this.parent.values.length-1);\r\n}\r\n\r\nValueRenderer.prototype.getViewerForValue = function(){\r\n\treturn new HTMLDataViewer.HTMLDataViewer(this);\r\n}\r\n\r\nValueRenderer.prototype.getFeaturesForFacet = function(facet){\r\n\treturn this.facets[facet].features.concat(this.facets[facet].controls);\r\n}\r\n\r\nValueRenderer.prototype.showFeature = function(which){\r\n\tif(this.features.indexOf(which) == -1 && this.controls.indexOf(which) == -1) {\r\n\t\treturn false;\r\n\t}\r\n\tvar cardcontrols = [\"delete\", \"clone\", \"add\"];\r\n\tif(cardcontrols.indexOf(which) != -1){\r\n\t\tif(!this.cardControlAllows(which)) return false;\r\n\t}\r\n\tvar updcontrols = [\"update\", \"reset\"];\r\n\tif(this.hideDisabledControls() && updcontrols.indexOf(which) != -1 ){\r\n\t\tif(!this.isUpdated()){\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\tif(which == 'hide' && this.view == \"hidden\") return false;\r\n\tif(which == 'show' && this.view != \"hidden\") return false;\r\n\tvar fets = this.getFeaturesForFacet(this.facet);\r\n\treturn (fets.indexOf(which) != -1);\r\n}\r\n\r\n\r\nValueRenderer.prototype.render = function(viewer){\r\n\tthis.viewer = (viewer ? viewer : this.getViewerForValue());\r\n\treturn this.viewer.render();\r\n}\r\n\r\nValueRenderer.prototype.extract = function(){\r\n\tvar val = this.value();\r\n\tif(val !== \"\" && val !== false){\r\n\t\tif(this.frame.isDatatypeProperty()){\r\n\t\t\tvar objlit = { \"@value\": this.value()}\r\n\t\t\t//var objlit = { data: this.value()}\r\n\t\t\tif(this.frame.isString()) objlit[\"@language\"] = this.frame.lang();\r\n\t\t\telse objlit[\"@type\"] = this.type();\r\n\t\t\treturn objlit;\r\n\t\t}\r\n\t\telse if(this.frame.isChoice() || this.frame.isDocument()){\r\n\t\t\treturn {\"@id\": val}\r\n\t\t}\r\n\t}\r\n\telse return val;\r\n}\r\n\r\nValueRenderer.prototype.getValueHeaderViewer = function(){\r\n\treturn new HTMLDataViewer.HTMLDataHeaderViewer();\r\n}\r\n\r\nValueRenderer.prototype.getDataValueViewer = function(){\r\n\tif(!this.viewerType) {\r\n\t\tthis.viewerType = this.getViewerForDataValue();\r\n\t}\r\n\treturn TerminusDashboard.RenderingMap.getViewer(this.viewerType, this.viewerOptions);\r\n}\r\n\r\nValueRenderer.prototype.getAvailableViewers = function(){\r\n\tvar dt = this.frame.getTypeShorthand();\r\n\tvar ft = this.frame.ftype();\r\n\tif(this.mode == \"view\"){\r\n\t\treturn TerminusDashboard.RenderingMap.getAvailableDataViewers(dt, ft);\r\n\t}\r\n\treturn TerminusDashboard.RenderingMap.getAvailableDataEditors(dt, ft);\r\n}\r\n\r\nValueRenderer.prototype.setViewer = function(viewer){\r\n\tthis.viewerType = viewer;\r\n\tthis.redraw();\r\n}\r\n\r\nValueRenderer.prototype.getViewerForDataValue = function(){\r\n\tvar dt = this.frame.getTypeShorthand();\r\n\tvar ft = this.frame.ftype();\r\n\tif(this.mode == \"edit\"){\r\n\t\treturn TerminusDashboard.RenderingMap.getEditorForDataFrame(dt, ft);\r\n\t}\r\n\treturn TerminusDashboard.RenderingMap.getViewerForDataFrame(dt, ft);\r\n}\r\n\r\nValueRenderer.prototype.redraw = function(){\r\n\tthis.viewer.clear();\r\n\tthis.render(this.viewer);\r\n}\r\n\r\n\r\n\r\n\r\n\r\nmodule.exports=ValueRenderer\r\n","const WOQLQuery = require('./WOQLQuery');\r\nconst TerminusClassChooser = require('./TerminusClassChooser');\r\n/*\r\n * Utility class which allows the user to choose a document by id or by label (if select2 and full text indexing is turned on)\r\n */\r\n\r\nTerminusDocumentChooser = function(ui, root, value, view){\r\n\tthis.ui = ui;\r\n\tthis.root = root;\r\n\tthis.choice = value;\r\n\tthis.view = (view ? view : \"id\");\r\n\tthis.show_button = true;\r\n}\r\n\r\nTerminusDocumentChooser.prototype.setRoot = function(root){\r\n\tthis.root = root;\r\n}\r\n\r\nTerminusDocumentChooser.prototype.setFilter = function(filter){\r\n\tthis.filter = filter;\r\n}\r\n\r\nTerminusDocumentChooser.prototype.change = function(docid){\r\n\talert(\"Need to specify doc chooser function (\" + docid + \")\");\r\n}\r\n\r\nTerminusDocumentChooser.prototype.getAsDOM = function(style){\r\n\tif(this.view == \"label\" && \tthis.ui.client.connectionConfig.platformEndpoint() && this.ui.pluginAvailable(\"select2\")){\r\n\t\treturn this.getS2DOM(style);\r\n\t}\r\n\treturn this.getIDDOM();\r\n}\r\n\r\nTerminusDocumentChooser.prototype.getS2DOM = function(style){\r\n\tvar docchooser = document.createElement(\"span\");\r\n\tdocchooser.setAttribute(\"class\", \"terminus-document-chooser terminus-doc-holder\");\r\n\tvar wq = new WOQLQuery(this.ui.client, {}, this.ui);\r\n\tvar cfilter = wq.getSubclassQueryPattern(\"v:Class\", \"'\"+this.root+\"'\");\r\n\tvar termcc = new TerminusClassChooser(this.ui, cfilter);\r\n\ttermcc.empty_choice = \"Filter by Type\";\r\n\ttermcc.show_single = false;\r\n\tvar self = this;\r\n\ttermcc.change = function(new_class){\r\n\t\tif(new_class){\r\n\t\t\tself.filter = new_class;\r\n\t\t}\r\n\t}\r\n\ttdom = termcc.getAsDOM(style);\r\n\tif(tdom) docchooser.appendChild(tdom);\r\n\tvar holder = document.createElement(\"span\");\r\n\tholder.setAttribute(\"class\", \"terminus-entity-reference-value\");\r\n\tvar sel = document.createElement(\"select\");\r\n\tsel.setAttribute(\"class\", \"terminus-entity-class-input\");\r\n\tholder.appendChild(sel);\r\n\tvar opt = document.createElement(\"option\");\r\n\tvar lookup = function (params) {\r\n\t\tparams.class = self.filter;\r\n\t\treturn JSON.stringify(params);\r\n    }\r\n\tvar searchurl = this.ui.client.dbURL() + \"/search\";\r\n\tvar s2config = {\r\n\t\tajax: {\r\n\t\t    url: searchurl,\r\n\t\t    dataType: 'json',\r\n\t\t    data: lookup,\r\n\t\t    type: \"POST\",\r\n\t\t\tcontentType: \"application/json; charset=utf-8\",\r\n\t\t    delay: 250,\r\n\t\t    cache: true\r\n\t\t},\r\n\t\tplaceholder: \"Enter Document Name\",\r\n\t\twidth: 200\r\n\t};\r\n\tjQuery(sel).select2(s2config).change(function(){\r\n\t\tcallback(this.value);\r\n\t});\r\n\tdocchooser.appendChild(holder);\r\n\treturn docchooser;\r\n}\r\n\r\nTerminusDocumentChooser.prototype.getIDDOM = function(){\r\n\tvar docchooser = document.createElement(\"span\");\r\n\tdocchooser.setAttribute(\"class\", \"terminus-document-chooser terminus-doc-holder\");\r\n\tvar dcip = document.createElement(\"input\");\r\n\tdcip.setAttribute(\"class\", \"terminus-document-chooser terminus-query-text\");\r\n\t//11092019 dcip.setAttribute(\"class\", \"terminus-form-value terminus-document-chooser\");\r\n\tdcip.setAttribute(\"placeholder\", \"Enter Document ID\");\r\n\tdcip.addEventListener('keypress', function(e){\r\n\t\tvar key = e.which || e.keyCode;\r\n\t\t// on enter\r\n\t\tif (key === 13 && dcip.value) {\r\n\t\t\tself.choice = dcip.value;\r\n\t\t\tself.change(dcip.value);\r\n\t\t}\r\n\t});\r\n\tdocchooser.appendChild(dcip);\r\n\tif(this.show_button){\r\n\t\tvar dbut = document.createElement(\"button\");\r\n\t\tdbut.setAttribute(\"class\", \"terminus-control-button terminus-btn\");\r\n\t\tvar self = this;\r\n\t\tdbut.addEventListener(\"click\", function(){\r\n\t\t\tif(dcip.value) {\r\n\t\t\t\tself.choice = dcip.value;\r\n\t\t\t\tself.change(dcip.value);\r\n\t\t\t}\r\n\t\t});\r\n\t\t//11092019 dbut.appendChild(document.createTextNode(\"View Document Properties\"));\r\n\t\tdbut.appendChild(document.createTextNode(\"Go\"));\r\n\t\tdocchooser.appendChild(dbut);\r\n\t}\r\n\treturn docchooser;\r\n}\r\n\r\nTerminusDocumentChooser.prototype.toggleView = function(){\r\n\tif(this.view == \"id\") this.view = \"label\";\r\n\telse this.view = \"id\";\r\n}\r\n\r\nTerminusDocumentChooser.prototype.getChangeViewText = function(){\r\n\tif(this.view == \"id\"){\r\n\t\treturn \"Document Lookup\";\r\n\t}\r\n\treturn \"Load Document ID\";\r\n}\r\n\r\nmodule.exports=TerminusDocumentChooser\r\n","const TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction WOQLQueryView(client){\r\n\tthis.client = client;\r\n}\r\n\r\nWOQLQueryView.prototype.options = function(options){\r\n\tthis.options = options;\r\n\treturn this;\r\n}\r\n\r\nWOQLQueryView.prototype.setQuery = function(query){\r\n\tthis.query = query;\r\n\treturn this;\r\n}\r\n\r\nWOQLQueryView.prototype.setRenderer = function(rend){\r\n\tthis.renderer = rend;\r\n\treturn this;\r\n}\r\n\r\nWOQLQueryView.prototype.render = function(){\r\n\tif(this.renderer){\r\n\t\tif(this.query){\r\n\t\t\tthis.renderer.set(this.query);\r\n\t\t}\r\n\t\treturn this.renderer.render(this);\r\n\t}\r\n}\r\n\r\n//parses a string encoding a woql in either json or js notation\r\nWOQLQueryView.prototype.parseText = function(text, format){\r\n\ttry {\r\n\t\tvar WOQL = TerminusClient.WOQL;\r\n\t\tif(format == \"json\"){\r\n\t\t\tvar qval = JSON.parse(text);\r\n\t\t\treturn WOQL.json(qval);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tvar nw = eval(\"WOQL.\" + text);\r\n\t\t\treturn nw;\r\n\t\t}\r\n\t}\r\n\tcatch(e){\r\n\t\tthis.error(\"Failed to parse Query \" + e.toString());\r\n\t}\r\n}\r\n\r\nWOQLQueryView.prototype.submitQuery = function(qObj){\r\n\r\n}\r\n\r\nWOQLQueryView.prototype.error = function(msg){\r\n\tconsole.log(msg);\r\n}\r\n\r\nWOQLQueryView.prototype.serialise = function(query, format){\r\n\tif(format == \"json\"){\r\n\t\treturn JSON.stringify(query.json(), 0, 2);\r\n\t}\r\n\telse {\r\n\t\treturn query.prettyPrint(4);\r\n\t}\r\n}\r\n\r\nmodule.exports = WOQLQueryView;\r\n","const HTMLStringViewer = require('./datatypes/String');\r\nconst HTMLStringEditor = require('./datatypes/StringEditor');\r\nconst HTMLBooleanViewer = require('./datatypes/Boolean');\r\nconst HTMLBooleanEditor = require('./datatypes/BooleanEditor');\r\nconst HTMLChoiceViewer = require('./datatypes/Choice');\r\nconst HTMLChoiceEditor = require('./datatypes/ChoiceEditor');\r\nconst HTMLCoordinateViewer = require('./datatypes/Coordinate');\r\nconst HTMLCoordinateEditor = require('./datatypes/CoordinateEditor');\r\nconst HTMLDateViewer = require('./datatypes/Date');\r\nconst HTMLDateEditor = require('./datatypes/DateEditor');\r\nconst HTMLEntityViewer = require('./datatypes/Entity');\r\nconst HTMLEntityEditor = require('./datatypes/EntityEditor');\r\nconst HTMLImageViewer = require('./datatypes/Image');\r\nconst HTMLImageEditor = require('./datatypes/ImageEditor');\r\nconst HTMLLinkViewer = require('./datatypes/Link');\r\nconst HTMLNumberViewer = require('./datatypes/Number');\r\nconst HTMLRangeViewer = require('./datatypes/Range');\r\nconst HTMLRangeEditor = require('./datatypes/RangeEditor');\r\nconst SantizedHTMLViewer = require('./datatypes/SanitizedHTML');\r\nconst GoogleMapEditor = require('./datatypes/GoogleMapEditor');\r\nconst GoogleMapViewer = require('./datatypes/GoogleMapViewer');\r\nconst HTMLMarkupEditor = require('./datatypes/HTMLMarkupEditor');\r\nconst S2EntityEditor = require('./datatypes/S2EntityEditor');\r\n\r\n\r\nfunction initialiseDataRenderers(RenderingMap, plugins){\r\n\tRenderingMap.registerViewerForTypes(\"HTMLBooleanViewer\", {label: \"Checkbox Viewer\"}, [\"xsd:boolean\"]);\r\n\tRenderingMap.registerEditorForTypes(\"HTMLBooleanEditor\", {label: \"Checkbox Editor\"}, [\"xsd:boolean\"]);\r\n\tRenderingMap.registerViewerForTypes(\"HTMLChoiceViewer\", {label: \"Choice Viewer\"}, [\"oneOf\"]);\r\n\tRenderingMap.registerEditorForTypes(\"HTMLChoiceEditor\", {label: \"Choice Selector\"}, [\"oneOf\"]);\r\n\tRenderingMap.registerViewerForTypes(\"HTMLCoordinateViewer\", {label: \"Coordinate Viewer\"}, [\"xdd:coordinate\", \"xdd:coordinatePolyline\", \"xdd:coordinatePolygon\"]);\r\n\tRenderingMap.registerEditorForTypes(\"HTMLCoordinateEditor\", {label: \"Coordinate Editor\"}, [\"xdd:coordinate\", \"xdd:coordinatePolyline\", \"xdd:coordinatePolygon\"]);\r\n\tRenderingMap.registerViewerForTypes(\"HTMLDateViewer\", {label: \"Date Viewer\"}, [\"xsd:time\", \"xsd:date\", \"xsd:dateTime\", \"xsd:gYear\", \r\n\t\t\"xsd:gYearRange\", \"xsd:gMonth\", \"xsd:gDay\", \"xsd:gYearMonth\", \"xsd:gMonthDay\", \"xsd:dateTimeStamp\"]);\r\n\tRenderingMap.registerEditorForTypes(\"HTMLDateEditor\", {label: \"Date Editor\"}, [\"xsd:time\", \"xsd:date\", \"xsd:dateRange\" ,\"xsd:dateTime\", \"xsd:gYear\", \r\n\t\t\"xsd:gYearRange\", \"xsd:gMonth\", \"xsd:gDay\", \"xsd:gYearMonth\", \"xsd:gMonthDay\", \"xsd:dateTimeStamp\"]);\r\n\tRenderingMap.registerViewerForTypes(\"HTMLEntityViewer\", {label: \"Document Viewer\"}, [\"document\"]);\r\n\tRenderingMap.registerEditorForTypes(\"HTMLEntityEditor\", {label: \"Document Selector\"}, [\"document\"]);\r\n\tRenderingMap.registerViewerForTypes(\"HTMLImageViewer\", {label: \"Image Viewer\"}, [\"xdd:url\", \"xsd:anyURI\", \"xsd:base64Binary\"]);\r\n\tRenderingMap.registerEditorForTypes(\"HTMLImageEditor\", {label: \"Image Editor\"}, [\"xsd:base64Binary\"]);\r\n\tRenderingMap.registerViewerForTypes(\"HTMLImageViewer\", {label: \"Image Viewer\"}, [\"xdd:url\", \"xsd:anyURI\", \"xsd:base64Binary\"]);\r\n\tRenderingMap.registerEditorForTypes(\"HTMLImageEditor\", {label: \"Image Editor\"}, [\"xsd:base64Binary\"]);\r\n\tRenderingMap.registerViewerForTypes(\"HTMLLinkViewer\", {label: \"Link Viewer\"}, [\"xdd:url\", \"xsd:anyURI\"]);\r\n\tRenderingMap.registerViewerForTypes(\"HTMLNumberViewer\", {label: \"Number with commas\"}, \r\n\t\t\t[\"xsd:decimal\", \"xsd:double\", \"xsd:float\", \"xsd:short\", \"xsd:integer\", \"xsd:long\", \r\n\t\t\t\t\"xsd:nonNegativeInteger\", \"xsd:positiveInteger\", \"xsd:negativeInteger\", \"xsd:nonPositiveInteger\"]);\r\n\tRenderingMap.registerViewerForTypes(\"HTMLRangeViewer\", {label: \"Range Viewer\"}, [\"xdd:gYearRange\", \"xdd:dateRange\", \"xdd:integerRange\", \"xdd:decimalRange\"]);\r\n\tRenderingMap.registerEditorForTypes(\"HTMLRangeEditor\", {label: \"Range Editor\"}, [\"xdd:gYearRange\", \"xdd:dateRange\", \"xdd:integerRange\", \"xdd:decimalRange\"]);\r\n\tRenderingMap.registerViewerForTypes(\"SantizedHTMLViewer\", {label: \"Sanitized HTML\"}, [\"xsd:string\", \"xdd:html\"]);\r\n\tRenderingMap.universalEditor = \"HTMLStringEditor\";\r\n\tRenderingMap.universalViewer = \"HTMLStringViewer\";\r\n\taddPlugins(RenderingMap, plugins);\r\n\tRenderingMap.createRenderer = function(type, args){\r\n\t\tlet r = createDataRenderer(type, args);\r\n\t\treturn r;\r\n\t}\r\n}\r\n\r\nfunction createDataRenderer(type, options){\r\n\ttry {\r\n\t\tvar viewer = eval(\"new \" + type + \".\" + type + \"(\" + JSON.stringify(options) + \")\");\r\n\t}\r\n\tcatch(e){\r\n\t\treturn false;\r\n\t}\r\n\treturn viewer;\r\n}\r\n\r\nfunction addPlugins(RenderingMap, plugins){\r\n\tif(plugins && plugins.indexOf(\"gmaps\") != -1){\r\n\t\tRenderingMap.registerEditorForTypes(\"GoogleMapEditor\", {label: \"Google Map Editor\"}, [\"xdd:coordinate\", \"xdd:coordinatePolyline\", \"xdd:coordinatePolygon\"]);\r\n\t\tRenderingMap.registerViewerForTypes(\"GoogleMapViewer\", {label: \"Google Map Editor\"}, [\"xdd:coordinate\", \"xdd:coordinatePolyline\", \"xdd:coordinatePolygon\"]);\r\n\t}\r\n\tif(plugins && plugins.indexOf(\"quill\") != -1){\r\n\t\tRenderingMap.registerEditorForTypes(\"HTMLMarkupEditor\", {label: \"Quill WYSIWIG HTML Editor\"}, [\"xdd:html\"]);\r\n\t}\r\n\tif(plugins && plugins.indexOf(\"select2\") != -1){\r\n\t\tRenderingMap.registerEditorForFrameType(\"S2EntityEditor\", {label: \"S2 Autocomplete Selector\"}, \"document\");\r\n\t}\r\n}\r\n\r\nmodule.exports = {createDataRenderer, initialiseDataRenderers};","const TerminusClient = require('@terminusdb/terminus-client');\r\n\r\n\r\nfunction SimpleTable(){\r\n\tthis.holder = document.createElement(\"div\");\r\n}\r\n\r\nSimpleTable.prototype.options = function(options){\r\n\tfor(var k in options){\r\n\t\tthis[k] = options[k];\r\n\t}\r\n\treturn this;\r\n}\r\n\r\n\r\nSimpleTable.prototype.render = function(woqltable){\r\n\tif(woqltable) this.woqltable = woqltable;\r\n\tTerminusClient.FrameHelper.removeChildren(this.holder);\r\n\tvar ctls = this.getControlsDOM();\r\n\tvar tab = this.getTableDOM();\r\n\tif(ctls) this.holder.appendChild(ctls)\r\n\tthis.holder.appendChild(tab);\r\n\treturn this.holder;\r\n}\r\n\r\nSimpleTable.prototype.getControlsDOM = function(result){\r\n\tvar ctrls = document.createElement(\"span\");\r\n\tif(this.woqltable.config.pager()){\r\n\t\tvar paging = this.getPaging(result);\r\n\t\tif(paging) ctrls.appendChild(paging);\r\n\t}\r\n\treturn ctrls;\r\n}\r\n\r\nSimpleTable.prototype.getTableDOM = function(){\r\n\tconst columns = this.woqltable.getColumnsToRender();\r\n\tvar tab = document.createElement(\"table\");\r\n\ttab.setAttribute(\"class\", \"terminus-hover-table\");\r\n\tvar thead = this.getTableHeader(columns);\r\n\ttab.appendChild(thead);\r\n\tvar tbody = this.getTableBody(columns);\r\n\ttab.appendChild(tbody);\r\n\treturn tab;\r\n}\r\n\r\nSimpleTable.prototype.getTableHeader = function(cols){\r\n\tvar thead = document.createElement(\"thead\");\r\n\tvar thr = document.createElement(\"tr\");\r\n\tfor(var i = 0; i<cols.length; i++){\r\n\t\tvar th = this.getColumnHeader(cols[i]);\r\n\t\tthr.appendChild(th);\r\n\t}\r\n\tthead.appendChild(thr);\r\n\treturn thead;\r\n}\r\n\r\nSimpleTable.prototype.getColumnHeader = function(colid){\r\n\tvar th = document.createElement(\"th\");\r\n\tth.setAttribute('class', 'terminus-table-header-full-css');\r\n\tvar clab = this.woqltable.getColumnHeaderContents(colid);\r\n\tth.appendChild(clab);\r\n\treturn th;\r\n}\r\n\r\nSimpleTable.prototype.getTableBody = function(cols){\r\n\tvar tbody = document.createElement(\"tbody\");\r\n\twhile(row = this.woqltable.next()){\r\n\t\tvar tr = this.getHTMLRow(row, cols);\r\n\t\tif(tr) tbody.appendChild(tr);\r\n\t}\r\n\treturn tbody;\r\n}\r\n\r\nSimpleTable.prototype.getHTMLRow = function(row, cols){\r\n\tvar tr = document.createElement(\"tr\");\r\n\tfor(var i = 0; i<cols.length; i++){\r\n\t\tvar td = this.getCell(cols[i], row);\r\n\t\ttr.appendChild(td);\r\n\t}\r\n\tvar self = this;\r\n\tif(this.woqltable.hasRowClick(row)){\r\n\t\tvar rc = this.woqltable.getRowClick(row);\r\n\t\ttr.addEventListener(\"click\", function(){\r\n\t\t\trc(row);\r\n\t\t});\r\n\t\ttr.addEventListener(\"mouseover\", function(){\r\n\t\t\tthis.style.cursor = \"pointer\";\r\n\t\t});\r\n\t}\r\n\tif(this.woqltable.hasRowHover(row)){\r\n\t\tvar rc = this.woqltable.getRowHover(row);\r\n\t\ttr.addEventListener(\"mouseover\", function(){\r\n\t\t\trc(row);\r\n\t\t});\r\n\t}\r\n\treturn tr;\r\n}\r\n\r\nSimpleTable.prototype.getCell = function(key, row){\r\n\tvar td = document.createElement(\"td\");\r\n\tif(this.woqltable.hasCellClick(row, key)){\r\n\t\tvar rc = this.woqltable.getCellClick(row, key);\r\n\t\ttd.addEventListener(\"click\", function(){\r\n\t\t\trc(row);\r\n\t\t});\r\n\t\ttd.addEventListener(\"mouseover\", function(){\r\n\t\t\tthis.style.cursor = \"pointer\";\r\n\t\t});\r\n\t}\r\n\tif(this.woqltable.hasCellHover(row, key)){\r\n\t\tvar rc = this.woqltable.getCellHover(row, key);\r\n\t\ttr.addEventListener(\"mouseover\", function(){\r\n\t\t\trc(row);\r\n\t\t});\r\n\t}\r\n\tvar c = this.getCellData(key, row);\r\n\tif(c) td.appendChild(c);\r\n\treturn td;\r\n}\r\n\r\nSimpleTable.prototype.getCellData = function(key, row){\r\n\tvar renderer = this.woqltable.getRenderer(key, row);\r\n\tif(renderer && typeof renderer == \"function\"){\r\n\t\treturn renderer(row[key], key, row);\r\n\t}\r\n\telse if(renderer && typeof renderer == \"object\"){\r\n\t\treturn this.woqltable.renderValue(renderer, row[key], key, row);\r\n\t}\r\n\tvar val = row[key]\r\n\tif(val && val['@value']) val = val['@value'];\r\n\treturn document.createTextNode(val);\r\n}\r\n\r\nSimpleTable.prototype.getPaging = function(){\r\n\tif(this.woqltable.result.query.isPaged()){\r\n\t\tvar pdom = document.createElement(\"div\");\r\n\t\tpdom.setAttribute(\"class\", \"table-page-size\");\r\n\t\tif(this.woqltable.config.pagesize()) pdom.appendChild(this.getPageSize());\r\n\t\tif(this.woqltable.canChangePage()){\r\n\t\t\tvar pn = this.woqltable.result.query.getPage();\r\n\t\t\tif(pn > 2){\r\n\t\t\t\tpdom.appendChild(this.getFirst());\r\n\t\t\t}\r\n\t\t\tif(pn > 1){\r\n\t\t\t\tpdom.appendChild(this.getPrev(pn));\r\n\t\t\t}\r\n\t\t\tif(this.woqltable.config.page()) pdom.appendChild(this.getPageNumber(pn));\r\n\t\t\tpdom.appendChild(this.getNext(this.woqltable.result));\r\n\t\t}\r\n\t\treturn pdom;\r\n\t}\r\n}\r\n\r\nSimpleTable.prototype.getPageSize = function(){\r\n\tvar chunk = document.createElement(\"span\");\r\n\tchunk.setAttribute(\"class\", \"woql-table-pagesize\");\r\n\tclabel = document.createElement(\"span\");\r\n\tclabel.appendChild(document.createTextNode(\"Page Size\"));\r\n\tchunk.appendChild(clabel);\r\n\tif(this.woqltable.config.change_pagesize){\r\n\t\tvar ctl = document.createElement(\"input\");\r\n\t\tctl.setAttribute(\"size\", 6);\r\n\t\tvar self = this;\r\n\t\tctl.value = this.woqltable.getPageSize();\r\n\t\tctl.addEventListener(\"blur\", function(){\r\n\t\t\tvar pval = (this.value ? parseInt(this.value) : false);\r\n\t\t\tself.woqltable.setPageSize(pval).then(() => self.render());\r\n\t\t});\r\n\t\tchunk.appendChild(ctl);\r\n\t}\r\n\telse {\r\n\t\tchunk.appendChild(document.createTextNode(this.woqltable.getPageSize()));\r\n\t}\r\n\treturn chunk;\r\n}\r\n\r\nSimpleTable.prototype.getPageNumber = function(){\r\n\tvar ctl = document.createElement(\"input\");\r\n\tctl.setAttribute(\"size\", 4);\r\n\tctl.value = this.woqltable.result.query.getPage();\r\n\tvar self = this;\r\n\tctl.addEventListener(\"blur\", function(){\r\n\t\tvar pval = (this.value ? parseInt(this.value) : false);\r\n\t\tself.woqltable.setPage(pval).then(() => self.render());\r\n\t});\r\n\treturn ctl;\r\n}\r\n\r\nSimpleTable.prototype.getNext = function(result){\r\n\tvar ctl = document.createElement(\"button\");\r\n\tvar self = this;\r\n\tctl.appendChild(document.createTextNode(\"next\"));\r\n\tif(!this.woqltable.canAdvancePage(result)){\r\n\t\tctl.setAttribute(\"disabled\", \"disabled\");\r\n\t}\r\n\telse {\r\n\t\tctl.addEventListener(\"click\", function(){\r\n\t\t\tself.woqltable.nextPage().then(() => self.render());\r\n\t\t});\r\n\t}\r\n\treturn ctl;\r\n}\r\n\r\nSimpleTable.prototype.getPrev = function(result){\r\n\tvar ctl = document.createElement(\"button\");\r\n\tctl.appendChild(document.createTextNode(\"previous\"));\r\n\tvar self = this;\r\n\tif(!this.woqltable.canRetreatPage(result)){\r\n\t\tctl.setAttribute(\"disabled\", \"disabled\");\r\n\t}\r\n\telse {\r\n\t\tctl.addEventListener(\"click\", function(){\r\n\t\t\tself.woqltable.previousPage().then(() => self.render());\r\n\t\t});\r\n\t}\r\n\treturn ctl;\r\n}\r\n\r\nSimpleTable.prototype.getFirst = function(result){\r\n\tvar ctl = document.createElement(\"button\");\r\n\tctl.appendChild(document.createTextNode(\"first\"));\r\n\tvar self = this;\r\n\tif(!this.woqltable.canRetreatPage(result) || this.woqltable.getPage() <= 2){\r\n\t\tctl.setAttribute(\"disabled\", \"disabled\");\r\n\t}\r\n\telse {\r\n\t\tctl.addEventListener(\"click\", function(){\r\n\t\t\tself.woqltable.firstPage().then(() => self.render());\r\n\t\t});\r\n\t}\r\n\treturn ctl;\r\n}\r\n\r\nmodule.exports = SimpleTable;\r\n","const TerminusClient = require('@terminusdb/terminus-client');\r\nconst GraphResultsViewer = require('./GraphResultsViewer');\r\n\r\n\r\nfunction SimpleGraph(){\r\n\tthis.holder = document.createElement(\"div\");\t\r\n}\r\n\r\nSimpleGraph.prototype.setResult = function(result){\r\n\tthis.result = result;\r\n}\r\n\r\nSimpleGraph.prototype.render = function(wgraph){\r\n\tthis.graph = wgraph;\r\n\tTerminusClient.FrameHelper.removeChildren(this.holder);\r\n\t//var ctls = this.getControlsDOM(result);\r\n\tvar tab = this.getGraphDOM(this.result);\r\n\t//if(ctls) this.holder.appendChild(ctls)\r\n\tthis.holder.appendChild(tab);\r\n\treturn this.holder;\r\n}\r\n\r\n\r\nSimpleGraph.prototype.getGraphDOM = function(){\r\n\tthis.gviz = new GraphResultsViewer(this.graph.config); \r\n\tvar gdom = this.gviz.getAsDOM();\r\n\tvar h = this.graph.config.height() ? this.graph.config.height() : 800;\r\n\tvar w = this.graph.config.width() ? this.graph.config.width() : 800;\r\n\tgdom.setAttribute(\"style\", \"border: 1px solid #aaa; width: \" + w + \"px; height: \" + h + \"px; \" + this.graph.config.width() + \"px\");\r\n\tthis.gviz.setData(this.graph);\r\n\tthis.gviz.initDOM(gdom);\r\n\treturn gdom;\r\n}\r\n\r\nmodule.exports = SimpleGraph;","function GraphResultsViewer(config) {\t\r\n\tthis.svg;\r\n\tthis.visid = randomString(8);\r\n\tthis.currentDate = Date.now() / 1000; // nowish\r\n\t// Individual links, nodes and text graphical elements\r\n\tthis.link_elements;\r\n\tthis.node_elements;\r\n\t// DOM object that this this is directly drawn into\r\n\tthis.container = false;\r\n\t// Map of ids to loaded nodes for ease\r\n\tthis.loadedNodes = {};\r\n\tthis.focusNodes = [];\r\n\t// Currently displayed nodes and links\r\n\tthis.nodes;\r\n\tthis.links;\r\n\t// Var for selecting and deselecting elements \r\n\tthis.selected_id;\t\r\n\tthis.setConfigOptions(config);\r\n}\r\n\r\n/*\r\n * Loads the graph with new data and optionally starts the animation\r\n */\r\nGraphResultsViewer.prototype.load = function(show) {\r\n\tthis.initD3(this.d3DOM);\r\n\tthis.loadNewData();\r\n\tthis.updateGraph();\r\n\tif(show){\r\n\t\tthis.updateSimulation(\"init\");\r\n\t}\r\n}\r\n\r\n/*\r\n * Called to issue a new set of datapoints \r\n */\r\nGraphResultsViewer.prototype.setData = function(dqr, show){\r\n\t//this.setFocusNodeFromResult(dqr);\r\n\tif(this.result){\r\n\t\tthis.clear();\r\n\t}\r\n\tthis.result = dqr;\r\n\t//if(this.svg){\r\n\t\tthis.load(show);\r\n\t//}\r\n}\r\n\r\nGraphResultsViewer.prototype.loadNewData = function(){\r\n\tthis.nodes = jQuery.extend(true, [], this.result.getNodes());\r\n\tfor(var i = 0 ; i<this.nodes.length; i++){\r\n\t\tthis.loadedNodes[this.nodes[i].id] = this.nodes[i];\r\n\t}\r\n\tthis.links = this.result.getEdges();\r\n\t//this.browser.rebuildController();\r\n}\r\n\r\n\r\n/*\r\n * Called to indicate that the current set of datapoints has been updated\r\n */\r\nGraphResultsViewer.prototype.updateData = function(dqr, show) {\r\n\tthis.setFocusNodeFromResult(dqr);\r\n\tthis.result = dqr;\r\n\tthis.reload(show, \"update\", this.fix_nodes);\r\n}\r\n\r\nGraphResultsViewer.prototype.setFocusNodeFromResult = function(dqr) {\r\n\tvar fn = dqr.getFocusNode();\r\n\tif(fn){\r\n\t\tthis.selected_id = fn;\r\n\t\tthis.focusNodes.push(fn);\r\n\t}\r\n}\r\n\r\n/*\r\n * Called to indicate that the filter setting has been changed on the current datapoints \r\n */\r\nGraphResultsViewer.prototype.setFilter = function(dqr, show){\r\n\tthis.simulation.stop();\r\n\tthis.reload(show, \"filter\", true);\r\n}\r\n\r\nGraphResultsViewer.prototype.wake = function() {\r\n\tif(this.simulation)\tthis.updateSimulation(\"wake\");\r\n}\r\n\r\nGraphResultsViewer.prototype.hibernate = function() {\r\n\tthis.simulation.stop();\r\n}\r\n\r\n/*\r\n * Called when more data is added to the result but the query remains the same\r\n */\r\nGraphResultsViewer.prototype.reload = function(show, mode, no_animate) {\r\n\tfor(var i = 0 ; i<this.nodes.length; i++){\r\n\t\tthis.loadedNodes[this.nodes[i].id] = this.nodes[i];\r\n\t}\t\r\n\tvar nnodes = jQuery.extend(true, [], this.result.getNodesAndFringes());\r\n\tthis.nodes = [];\r\n\tvar snode = this.loadedNodes[this.selected_id];\r\n\tfor(var i = 0 ; i<nnodes.length; i++){\r\n\t\tvar nnode = nnodes[i];\r\n\t\tif(this.loadedNodes[nnode.id]){\r\n\t\t\tif(nnode.id == this.selected_id){\r\n\t\t\t\tthis.loadedNodes[nnode.id].fx = this.loadedNodes[nnode.id].x;\r\n\t\t\t\tthis.loadedNodes[nnode.id].fy = this.loadedNodes[nnode.id].y;\r\n\t\t\t}\r\n\t\t\telse if(!no_animate) {\r\n\t\t\t\tthis.loadedNodes[nnode.id].fx = null;\r\n\t\t\t\tthis.loadedNodes[nnode.id].fy = null;\r\n\t\t\t}\r\n\t\t\telse if(this.loadedNodes[nnode.id].x){\r\n\t\t\t\tthis.loadedNodes[nnode.id].fx = this.loadedNodes[nnode.id].x;\r\n\t\t\t\tthis.loadedNodes[nnode.id].fy = this.loadedNodes[nnode.id].y;\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tif(this.explode_out && snode.x){\r\n\t\t\t\tnnode.x = snode.x;\r\n\t\t\t\tnnode.y = snode.y;\r\n\t\t\t}\r\n\t\t\tthis.loadedNodes[nnode.id] = nnode;\r\n\t\t}\r\n\t\tthis.nodes.push(this.loadedNodes[nnode.id]);\r\n\t}\r\n\tthis.links = this.result.getLinks();\r\n\tthis.updateGraph();\r\n\tif(show){\r\n\t\t//this.browser.rebuildController();\r\n\t\tthis.updateSimulation(mode);\r\n\t}\r\n}\r\n\r\nGraphResultsViewer.prototype.clear = function() {\r\n\tthis.nodes = [];\r\n\tthis.loadedNodes = {};\r\n\tthis.links = [];\r\n\tthis.updateGraph();\r\n\tjQuery(this.d3DOM).empty();\t\r\n\tthis.scale_factor = 1;\r\n}\r\n\r\n/*\r\n * Called to initialise the DOM when it is first loaded (called after setData)\r\n */\r\nGraphResultsViewer.prototype.initDOM = function(vdom) {\r\n\tif(!this.width) this.width = this.setWidth();\r\n\tif(!this.height) this.height = this.setHeight();\r\n\tthis.d3DOM = vdom;\r\n\tif(this.result){\r\n\t\tthis.load(true);\r\n\t}\r\n}\r\n\r\n/*\r\n * Generate the div that contains the visualisation panel\r\n */\r\nGraphResultsViewer.prototype.getAsDOM = function() {\r\n\tvar vdom = document.createElement(\"div\");\r\n\tvdom.setAttribute(\"class\", \"terminus-gviz-panel\");\r\n\tvdom.setAttribute(\"id\", this.visid);\r\n\tvdom.setAttribute(\"width\", \"100%\");\r\n\tthis.container = vdom;\r\n\treturn vdom;\r\n}\r\n\r\n/*\r\n * Calculates the width of the container area available for the SVG\r\n */\r\nGraphResultsViewer.prototype.setWidth = function() {\r\n\tif(this.container && this.container.clientWidth){\r\n\t\tthis.width = this.container.clientWidth;\r\n\t}\r\n\telse if(this.container.parentNode && this.container.parentNode.clientWidth){\r\n\t\tthis.width = this.container.parentNode.clientWidth;\r\n\t}\r\n\telse {\r\n\t\tvar w = jQuery(this.container).width();\r\n\t\tif(w == 0){\r\n\t\t\tw = jQuery(this.container.parentNode).width();\r\n\t\t}\r\n\t\tif(w == 0) {\r\n\t\t\tw = 800;\r\n\t\t}\r\n\t\tthis.width = w;\r\n\t}\r\n\treturn this.width;\r\n}\r\n\r\nGraphResultsViewer.prototype.setHeight = function() {\r\n\tif(this.container && this.container.clientHeight){\r\n\t\tthis.height = this.container.clientHeight;\r\n\t}\r\n\telse if(this.container.parentNode && this.container.parentNode.clientHeight){\r\n\t\tthis.height = this.container.parentNode.clientHeight;\r\n\t}\r\n\telse {\r\n\t\tvar w = jQuery(this.container).height();\r\n\t\tif(w == 0){\r\n\t\t\tw = jQuery(this.container.parentNode).height();\r\n\t\t}\r\n\t\tif(w == 0) {\r\n\t\t\tw = 400;\r\n\t\t}\r\n\t\tthis.height = w;\r\n\t}\r\n\treturn this.height;\r\n}\r\n\r\n\r\nGraphResultsViewer.prototype.initD3 = function(jqid) {\r\n\tvar self = this;\r\n\r\n\t/********************* Seed the data **************************/\r\n\tthis.svg = d3.select(jqid).append(\"svg\")\r\n\t\t.attr(\"width\", this.width)\r\n\t\t.attr(\"height\", this.height);\r\n\r\n\tvar distanceFun = function(link){\r\n\t\treturn self.getLinkDistance(link); \r\n\t}\r\n\t\r\n\t// create the force object \r\n\tthis.simulation  = d3.forceSimulation()\r\n\t\t//link distance varies with link type\r\n\t    .force(\"link\", d3.forceLink().distance(distanceFun).id(function(link) { return link.id; }))\r\n\t    //charge is the same for all nodes\r\n\t    .force('charge', d3.forceManyBody().strength(function(node){ return self.getCharge(node)}))\r\n\t    //collision radius changes with node type\r\n\t    .force('collision', d3.forceCollide().radius(function(node) {\r\n\t    \treturn (self.getCollisionRadius(node));\r\n\t    }))\r\n\t\t.force(\"center\", d3.forceCenter(this.width / 2, this.height / 2));\r\n\t\r\n\t// node drag \r\n\tthis.drag_drop = d3.drag()\r\n\t\t.on('start', function(node) {\r\n\t\t\tnode.fx = node.x\r\n\t\t\tnode.fy = node.y\r\n\t\t})\r\n\t\t.on('drag', function(node) {\r\n\t\t\tself.simulation.restart()\r\n\t\t\tnode.fx = d3.event.x;\r\n\t\t\tnode.fy = d3.event.y;\r\n\t\t})\r\n\t\t.on('end', function(node) {\r\n\t\t\tnode.fx = null;\r\n\t\t\tnode.fx = null;\r\n\t\t\tself.simulation.stop()\r\n\t\t});\r\n\t\r\n\tthis.svg.append(\"rect\")\r\n\t   .attr(\"width\", this.width)\r\n\t   .attr(\"height\", this.height)\r\n\t   .style(\"fill\", \"none\")\r\n\t   .style(\"pointer-events\", \"all\")\r\n\t   .call(d3.zoom().on(\"zoom\", function(){self.zoomed()}));\r\n\t\r\n\t// Append graphic element to svg which are groups for graph elements\r\n\tthis.link_group = this.svg.append(\"g\").classed(\"links\", true);\r\n\tthis.node_group = this.svg.append(\"g\").classed(\"nodes\", true);\r\n}\r\n\r\nGraphResultsViewer.prototype.zoomed = function() {\r\n\tthis.current_transform = d3.event.transform;\r\n\tif(this.node_elements)\r\n\t\tthis.node_elements.attr(\"transform\", d3.event.transform);\r\n    if(this.link_elements)\r\n    \tthis.link_elements.attr(\"transform\", d3.event.transform);    \r\n}\r\n\r\n/***\r\n * updates the svg with the current nodes and links\r\n */\r\nGraphResultsViewer.prototype.updateGraph = function(nodes, links) {\r\n\tvar self = this;\r\n\t   \r\n\tvar follow_node_wrapper = function(graph_node){\r\n\t\tself.nodeSelected(graph_node);\r\n\t}\r\n\tvar zoomed = function(){\r\n\t\tself.zoomed();\r\n\t} \r\n\t\r\n\tnodes = (typeof nodes != \"undefined\" ? nodes : this.nodes);\r\n\tlinks = (typeof links != \"undefined\" ? links : this.links);\r\n\tthis.node_elements  = this.node_group.selectAll(\"g\").data(nodes);\r\n\tthis.node_elements.exit().remove();\r\n\t\r\n\t/*Create and place the \"blocks\" containing the circle and the text */  \r\n    var node_enter = this.node_elements.enter().append(\"g\");\r\n\r\n\t// enter and create new ones\r\n\tnode_enter.append(\"circle\")\r\n\t\t.style('opacity', 0.99)\r\n\t\t.attr('r', function(node){return self.getRadius(node)})\r\n\t\t.attr(\"cx\",  function(node){ return node.x})\r\n\t\t.attr(\"cy\",  function(node){ return node.y})\r\n\t\t.attr(\"type\", function(node) {return self.isFringe(node) ? \"fringe\" : \"node\"})\r\n\t\t.call(self.drag_drop)\r\n\t\t.on(\"mouseover\", function(d){ d3.select(this).style(\"cursor\", \"pointer\"); })\r\n\t\t.on(\"mouseout\", function(d){ d3.select(this).style(\"cursor\", \"default\"); })\r\n\t\t.on('click', follow_node_wrapper);\r\n\t\r\n    node_enter.append(\"text\")\r\n\t\t.attr(\"x\",  function(node){ return node.x})\r\n\t\t.attr(\"y\",  function(node){ return node.y})\r\n\t\t.text(function(node) { return self.getNodeIconUnicode(node)})\r\n\t\t.call(self.drag_drop)\r\n\t\t.on(\"mouseover\", function(d){ d3.select(this).style(\"cursor\", \"pointer\"); })\r\n\t\t.on(\"mouseout\", function(d){ d3.select(this).style(\"cursor\", \"default\"); })\r\n\t\t.on('click', follow_node_wrapper);\r\n\r\n\t// merge new and old nodes\t\r\n\tthis.node_elements = node_enter.merge(this.node_elements);\r\n\t\r\n\tthis.styleNodeElements();\r\n\r\n\t// update LINKS ********************************************\r\n\tthis.link_elements  = this.link_group.selectAll(\"line\").data(links);\r\n\r\n\t// remove old links\r\n\tthis.link_elements.exit().remove();\r\n\t// enter and create new ones\r\n\tvar link_enter = this.link_elements.enter().append(\"line\");\r\n\r\n\t// merge new and old links \r\n\tthis.link_elements = link_enter.merge(this.link_elements)\r\n\t\r\n\tthis.styleLinkElements();\r\n\t\r\n\t//execute the current state of the pan-zoom transform\r\n\tif(this.current_transform){\r\n\t\tif(this.node_elements)\r\n\t\t\tthis.node_elements.attr(\"transform\", this.current_transform);\r\n\t    if(this.link_elements)\r\n\t    \tthis.link_elements.attr(\"transform\", this.current_transform);\r\n\t}\r\n}\r\n\r\nGraphResultsViewer.prototype.updateSimulation = function(mode) {\r\n\tvar self = this;\r\n\t//move all of the graphical elements corresponding to the nodes with each tick\r\n\tvar ticker = function(){\r\n\t\tself.node_elements.selectAll(\"circle\")\r\n\t\t\t.attr(\"cx\",  function(node){ return node.x})\r\n\t\t\t.attr(\"cy\",  function(node){ return node.y});\r\n\t\tself.node_elements.selectAll(\"text\")\r\n\t\t\t.attr(\"x\",  function(node){ return node.x})\r\n\t\t\t.attr(\"y\",  function(node){ return node.y});\r\n\t\tself.link_elements\r\n\t\t\t.attr('x1', function(link){ return link.source.x})\r\n\t\t\t.attr('y1', function(link){ return link.source.y})\r\n\t\t\t.attr('x2', function(link){ return link.target.x})\r\n\t\t\t.attr('y2', function(link){ return link.target.y});\r\n\t}\r\n\tif(this.show_force){\r\n\t\tthis.simulation.nodes(this.nodes).on('tick', ticker).force('link').links(this.links);\r\n\t}\r\n\telse {\r\n\t\tthis.simulation.nodes(this.nodes).on('end', ticker).force('link').links(this.links);\t\t\r\n\t}\r\n\tif(this.nodes.length){\r\n\t\tif(mode == \"wake\" || mode == \"init\"){\r\n\t\t\tthis.simulation.restart();\r\n\t\t}\r\n\t\telse if(mode == \"filter\"){\r\n\t\t\tthis.simulation.restart();\t\t\t\t\t\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.simulation.alpha(1).restart();\r\n\t\t}\r\n\t}\r\n}\r\n\r\nGraphResultsViewer.prototype.styleNodeElements = function() {\r\n\tvar self = this;\r\n\tif(this.node_elements){\r\n\t\tthis.node_elements.each(function(node){\r\n\t\t\tvar g = d3.select(this);\r\n\t\t\tvar sel = g.select(\"circle\");\r\n\t\t\tsel.select(\"title\").remove();\r\n\t\t\tsel.style(\"fill\", self.getNodeColour(node));\r\n\t\t\tsel.attr('r', self.getRadius(node));\t\r\n\t\t\tsel.classed(\"highlighted\", function(node) { return self.focusNodes.indexOf(node.id) != -1});\t\r\n\t\t\tsel.append(\"title\")\r\n\t\t\t\t.classed(\"terminus-gnode-title\", true)\r\n\t\t\t\t.text(self.getNodeText(node));\r\n\t\t\tvar txt = g.select(\"text\");\r\n\t\t\ttxt.select(\"title\").remove();\r\n\t\t\ttxt.attr('text-anchor', 'middle')\r\n\t\t\t\t.attr(\"title\", self.getNodeText(node))\r\n\t\t\t\t.attr('dominant-baseline', 'central')\r\n\t\t\t\t.style('font-family', \"'\" + self.fontfam + \"'\")\r\n\t\t\t\t.style('font-weight', self.getNodeIconWeight(node))\r\n\t\t\t\t.style('font-size', self.getNodeIconSize(node))\r\n\t\t\t\t.style(\"fill\", self.getNodeIconColour(node))\r\n\t\t\t\t.text(self.getNodeIconUnicode(node))\r\n\t\t\t\t.append(\"title\")\r\n\t\t\t\t\t.classed(\"terminus-gnode-title\", true)\r\n\t\t\t\t\t.text(self.getNodeText(node));\r\n\t\t});\r\n\t}\t\r\n}\r\n\r\nGraphResultsViewer.prototype.styleLinkElements = function() {\r\n\tvar self = this;\r\n\tif(this.link_elements){\r\n\t\tthis.link_elements.each(function(link){\r\n\t\t\tvar sel = d3.select(this);\r\n\t\t\tsel.select(\"title\").remove();\r\n\t\t\tsel.attr(\"stroke-width\", self.getLineWidth(link));\r\n\t\t\tsel.attr(\"marker-end\", self.getEdgeArrow(link));\r\n\t\t\tsel.style(\"stroke\", self.getEdgeColour(link));\r\n\t\t\tsel.append(\"title\")\r\n\t\t\t\t.classed(\"terminus-glink-title\", true)\r\n\t\t\t\t.text(self.getLinkText(link));\r\n\t\t});\r\n\t}\r\n}\r\n\r\nGraphResultsViewer.prototype.getEdgeArrow = function(edge) {\r\n\tif(edge){\r\n\t\tvar dir = this.getEdgeDirection(edge);\r\n\t\t//if(dir){\r\n\t\t\tvar col = this.getEdgeColour(edge);\r\n\t\t\tvar reference;\r\n\t\t\tthis.svg.append(\"svg:defs\").selectAll(\"marker\")\r\n\t\t\t\t.data([reference])\r\n\t\t\t\t.enter().append(\"svg:marker\")\r\n\t\t\t\t.attr(\"id\", String)\r\n\t\t\t\t.attr(\"viewBox\", \"0 -5 10 10\")\r\n\t\t\t\t.attr(\"refX\", 22)  // This sets how far back it sits, kinda\r\n\t\t\t\t.attr(\"refY\", 0)\r\n\t\t\t\t.attr(\"markerWidth\", this.getArrowWidth(edge))\r\n\t\t\t\t.attr(\"markerHeight\", this.getArrowHeight(edge))\r\n\t\t\t\t.attr(\"orient\", \"auto\")\r\n\t\t\t\t.attr(\"markerUnits\", \"userSpaceOnUse\")\r\n\t\t\t\t.append(\"svg:path\")\r\n\t\t\t\t\t.attr(\"d\", dir)\r\n\t\t\t\t\t.style(\"fill\", col);\r\n\t\t\t\treturn \"url(#\" + reference + \")\";\r\n\t\t//}\r\n\t}\r\n\treturn \"\";\r\n}\r\n\r\n\r\nGraphResultsViewer.prototype.nodeSelected = function(selected_node) {\r\n\tvar self = this;\r\n\tif(this.selected_id == selected_node.id && this.selection_grows){\r\n\t\tthis.selection_grows = false;\r\n\t\tthis.styleNodeElements();\r\n\t}\r\n\telse {\r\n\t\tthis.selection_grows = true;\r\n\t\tthis.selected_id = selected_node.id;\r\n\t\tthis.styleNodeElements();\r\n\t\t//this.browser.nodeSelected(selected_node);\r\n\t\tif(this.isFringe(selected_node)){\r\n\t\t\t//this.browser.followNode(selected_node);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nGraphResultsViewer.prototype.getScaleTransform = function(x, y, scale_factor){\r\n\treturn \"scale(\"+ scale_factor + \") translate(\" + x + \",\" + y + \")\";\r\n} \r\n\r\nGraphResultsViewer.prototype.scale = function(min_ratio) {\r\n    // the new dimensions of the molecule\r\n    new_mol_width = this.width * min_ratio;\r\n    new_mol_height = this.height * min_ratio;\r\n    \r\n    var y_trans = (this.height - new_mol_height) ; \r\n    \r\n    var x_trans = (this.width - new_mol_width); \r\n    // do the actual moving\r\n    var self = this;\r\n    if(this.node_elements)\r\n    \tthis.node_elements.transition()\r\n        .duration(750).attr(\"transform\", function(node){ return self.getScaleTransform(x_trans, y_trans, min_ratio)});\r\n    if(this.link_elements)\r\n        this.link_elements.transition()\r\n        .duration(750).attr(\"transform\", function(node){ return self.getScaleTransform(x_trans, y_trans, min_ratio)});\r\n\tthis.scale_factor = min_ratio;\r\n\tthis.svg.selectAll(\"marker\").attr(\"markerWidth\", this.getArrowWidth())\r\n\t\t\t.attr(\"markerHeight\", this.getArrowHeight());\r\n}\r\n\r\n\r\nGraphResultsViewer.prototype.scaleToFit = function() {\r\n    // Center the view on the molecule(s) and scale it so that everything\r\n    // fits in the window\r\n    //no molecules, nothing to do\r\n    if (this.nodes.length === 0)\r\n        return;\r\n\r\n    // Get the bounding box\r\n    min_x = d3.min(this.nodes.map(function(d) {return d.x;}));\r\n    min_y = d3.min(this.nodes.map(function(d) {return d.y;}));\r\n    max_x = d3.max(this.nodes.map(function(d) {return d.x;}));\r\n    max_y = d3.max(this.nodes.map(function(d) {return d.y;}));\r\n\r\n    // The width and the height of the graph\r\n    mol_width = max_x - min_x;\r\n    mol_height = max_y - min_y;\r\n    \r\n    mol_width = mol_width * 1.05;\r\n    mol_height = mol_height * 1.05;\r\n    // how much larger the drawing area is than the width and the height\r\n    width_ratio = this.width / mol_width;\r\n    height_ratio = this.height / mol_height;\r\n\r\n    // we need to fit it in both directions, so we scale according to\r\n    // the direction in which we need to scale the most\r\n    min_ratio = Math.min(width_ratio, height_ratio);\r\n    if(min_ratio < 1){\r\n    \tthis.scale(min_ratio);\r\n    }    \r\n};\r\n\r\n// recentre graph\r\nGraphResultsViewer.prototype.recentre = function(graph_node) {\r\n\tthis.translated = true;\r\n\t// get the x and y you need to transform the nodes by \r\n\tthis.dcx = (this.width/2-graph_node.x);\r\n\tthis.dcy = (this.height/2-graph_node.y);\r\n\t//zoom.translate([dcx,dcy]); If we do zooming we'll need to do something here\r\n\tthis.node_elements.attr(\"transform\", \"translate(\"+ this.dcx + \",\" + this.dcy  + \")\");\r\n\tthis.link_elements.attr(\"transform\", \"translate(\"+ this.dcx + \",\" + this.dcy  + \")\");\r\n\tthis.text_elements.attr(\"transform\", \"translate(\"+ this.dcx + \",\" + this.dcy  + \")\");\r\n}\r\n\r\n\r\nGraphResultsViewer.prototype.setConfigOptions = function(config) {\r\n\t//configuration options for different types of behaviour\r\n\t// Need to explicitly know font family name for unicode glyphs\r\n\tthis.fontfam = (config && config.fontfamily ? config.fontfamily() : 'Font Awesome\\ 5 Free'); \r\n\tthis.selected_grows = (config && typeof config.selected_grows() != \"undefined\" ? config.selected_grows() : true);\r\n\tthis.show_force = (config && typeof config.show_force() != \"undefined\" ? config.show_force() : true);\r\n\tthis.fix_nodes = (config && typeof config.fix_nodes() != \"undefined\" ? config.fix_nodes() : false);\r\n\tthis.explode_out = (config && typeof config.explode_out() != \"undefined\" ? config.explode_out(): false);\r\n\tthis.width = (config && config.width() ? config.width(): false);\r\n\tthis.height = (config && config.height() ? config.height(): false);\r\n\tthis.defaults = {\r\n\t\tedge: {\r\n\t\t\ttype: \"edge\",\r\n\t\t\tdistance: (config && config.edge && config.edge.distance ? config.edge.distance : 70),\r\n\t\t\tarrow: (config && config.edge && config.edge.arrow ? config.edge.arrow : { width: 36, height: 16}),\r\n\t\t\tsymmetric: (config && config.edge && config.edge.symmetric ? config.edge.symmetric : true),\r\n\t\t\tcolor: (config && config.edge && config.edge.color ? config.edge.color : [150,150,255]),\r\n\t\t\tweight: (config && config.edge && config.edge.weight ? config.edge.weight : 0.3),\r\n\t\t\tsize: (config && config.edge && config.edge.size ? config.edge.size : 4)\r\n\t\t},\r\n\t\tnode: {\r\n\t\t\ttype: \"node\",\r\n\t\t\tradius: (config && config.node && config.node.radius ? config.node.radius : 14),\r\n\t\t\tcharge: (config && config.node && config.node.charge ? config.node.charge : -60),\r\n\t\t\tcollisionRadius: (config && config.node && config.node.collisionRadius ? config.node.collisionRadius : 20),\r\n\t\t\tcolor: (config && config.node && config.node.color ? config.node.color : [0,255,255]),\r\n\t\t\ticon: {\r\n\t\t\t\tweight: (config && config.node && config.node.icon && config.node.icon.weight ? config.node.icon.weight : 900),\r\n\t\t\t\tcolor: (config && config.node && config.node.icon && config.node.icon.color ? config.node.icon.color : [0,0,255]),\r\n\t\t\t\tunicode: (config && config.node && config.node.icon && config.node.icon.unicode ? config.node.icon.unicode : \"\\uf4fb\"),\r\n\t\t\t\tsize: (config && config.node && config.node.icon && config.node.icon.size ? config.node.icon.size : 10),\r\n\t\t\t\tfaclass: (config && config.node && config.node.icon && config.node.icon.faclass ? config.node.icon.faclass : \"fas fa-user-astronaut\")\r\n\t\t\t},\r\n\t\t\ttext: {\r\n\t\t\t\tcolor: (config && config.node && config.node.text && config.node.text.color ? config.node.text.color : [0,0,0]),\r\n\t\t\t\tsize: (config && config.node && config.node.icon && config.node.text.size ? config.node.text.size : 10)\r\n\t\t\t},\r\n\t\t\tborder: {\r\n\t\t\t\tcolor: (config && config.node && config.node.border && config.node.border.color ? config.node.border.color : [0,0,0]),\r\n\t\t\t\tsize: (config && config.node && config.node.border && config.node.border.size ? config.node.border.size : 10)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\n/*\r\n * Dimensions / forces / etc all settable with a scale factor - for zooming\r\n */\r\nGraphResultsViewer.prototype.getMultiplier = function(node) {\r\n\tvar mult = (node && node.size ? node.size : 1);\r\n\tif(node.id == this.selected_id && this.selection_grows){\r\n\t\tmult = mult * 2;\r\n\t}\r\n\treturn mult;\r\n}\r\n\r\nGraphResultsViewer.prototype.getRadius = function(node) {\r\n\tvar radius = (node && node.radius ? node.radius : this.defaults.node.radius);\r\n\tvar r = (this.scale_factor ? Math.min(this.scale_factor * radius, radius) : radius);\r\n\tr = r * this.getMultiplier(node);\r\n\treturn r;\r\n}\r\n\r\nGraphResultsViewer.prototype.getCollisionRadius = function(node) {\r\n\tvar colrad = (node && node.collisionRadius ? node.collisionRadius : this.defaults.node.collisionRadius );\r\n\tvar v = (this.scale_factor ? Math.min(this.scale_factor * colrad, colrad) : colrad);\r\n\treturn v * this.getMultiplier(node);\r\n}\r\n\r\nGraphResultsViewer.prototype.getCharge = function(node) {\r\n\tvar charge = (node && node.charge ? node.charge : this.defaults.node.charge);\r\n\tif(charge < 0){\r\n\t\tvar v = (this.scale_factor ? Math.max(this.scale_factor * charge, charge) : charge);\r\n\t}\r\n\telse {\r\n\t\tvar v = (this.scale_factor ? Math.min(this.scale_factor * charge, charge) : charge);\r\n\t}\r\n\treturn v * this.getMultiplier(node);\r\n}\r\n\r\nGraphResultsViewer.prototype.getLinkDistance = function(link) {\r\n\tvar linkDistance = (link && link.distance ? link.distance : this.defaults.edge.distance);\r\n\tvar x = (this.scale_factor ? Math.min(this.scale_factor * linkDistance, linkDistance) : linkDistance);\r\n\treturn x;\r\n}\r\n\r\nGraphResultsViewer.prototype.getNodeIconSize = function(node) {\r\n\tif(node && node.icon && node.icon.size){\r\n\t\treturn node.icon.size + \"em\";\r\n\t}\r\n\treturn (this.getMultiplier(node) + \"em\");\r\n}\t\r\n\r\nGraphResultsViewer.prototype.getNodeColour = function(node) {\r\n\tvar col = (node && node.color ? node.color : this.defaults.node.color);\r\n\tif(this.isFringe(node)){\r\n\t\treturn \"rgba(\"+col.join(\",\")+\",0.25)\";\r\n\t}\r\n\telse {\r\n\t\treturn \"rgb(\"+col.join(\",\")+\")\";\r\n\t}\r\n}\r\n\r\nGraphResultsViewer.prototype.getNodeIcon = function(node) {\r\n\tvar fac = (node && node.icon && node.icon.faclass ? node.icon.faclass : this.defaults.node.icon.faclass);\r\n\treturn fac;\r\n}\r\n\r\nGraphResultsViewer.prototype.getNodeIconUnicode= function(node) {\r\n\treturn (node && node.icon && node.icon.unicode ? node.icon.unicode : this.defaults.node.icon.unicode);\r\n}\r\n\r\nGraphResultsViewer.prototype.getNodeIconWeight = function(node) {\r\n\treturn (node && node.icon && node.icon.weight ? node.icon.weight : this.defaults.node.icon.weight );\r\n}\r\n\r\nGraphResultsViewer.prototype.getNodeIconColour = function(node) {\r\n\tvar col = (node && node.icon && node.icon.color ? node.icon.color : this.defaults.node.icon.color );\r\n\tif(this.isFringe(node)){\r\n\t\treturn \"rgba(\"+col.join(\",\")+\",0.25)\";\r\n\t}\r\n\telse {\r\n\t\treturn \"rgb(\"+col.join(\",\")+\")\";\r\n\t}\r\n}\r\n\r\nGraphResultsViewer.prototype.getEdgeColour = function(edge) {\r\n\tvar col = (edge && edge.color ? edge.color : this.defaults.edge.color );\r\n\tvar weight = (edge && edge.weight ? edge.weight : this.defaults.edge.weight);\r\n\tvar nc = col.concat([weight]);\r\n\treturn \"rgba(\"+nc.join(\",\")+\")\";\r\n}\r\n\r\nGraphResultsViewer.prototype.getEdgeDirection = function(edge) {\r\n\tif(edge && edge.symmetric){\r\n\t\treturn \"M10,-5 L0,0 L10,5\";\r\n\t}\r\n\treturn \"M0,-5 L10,0 L0,5\";\r\n\treturn false;\r\n}\r\n\r\nGraphResultsViewer.prototype.getLineWidth = function(link) {\r\n\tvar x = (link && link.size ? link.size : this.defaults.edge.size);\r\n\treturn x;\r\n}\r\n\r\n\r\nGraphResultsViewer.prototype.getNodeText = function(node) {\r\n\tif(node && node.text) return node.text;\r\n\treturn node.id; \r\n}\r\n\r\nGraphResultsViewer.prototype.getLinkText = function(edge) {\r\n\tif(edge && edge.text) return edge.text;\r\n\tif(edge && edge.id) return edge.id;\r\n\treturn \"\";\r\n}\r\n\r\nGraphResultsViewer.prototype.getArrowWidth = function(edge) {\r\n\tvar w = (edge && edge.arrow && edge.arrow.width ? edge.arrow.width : this.defaults.edge.arrow.width);\r\n\treturn (this.scale_factor ? Math.min(this.scale_factor * w, w) : w);\r\n}\r\n\r\nGraphResultsViewer.prototype.getArrowHeight = function(edge) {\r\n\tvar w = (edge && edge.arrow && edge.arrow.height ? edge.arrow.height : this.defaults.edge.arrow.height );\r\n\treturn (this.scale_factor ? Math.min(this.scale_factor * w, w) : w);\r\n}\r\n\r\nGraphResultsViewer.prototype.isNeighbourLink = function(node, link) { \r\n\treturn link.target.id === node.id || link.source.id === node.id;  \r\n}\r\n\r\nGraphResultsViewer.prototype.isFringe = function(node){\r\n\tif(this.result && this.result.added && this.result.added.upgraded){\r\n\t\tif(this.result.added.upgraded.indexOf(node.id) != -1){\r\n\t\t\tnode.type = \"node\";\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\treturn node.type && node.type == \"fringe\";\r\n}\r\n\r\nfunction randomString(length) {\r\n    var chars = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz'.split('');\r\n    if (! length) {\r\n        length = Math.floor(Math.random() * chars.length);\r\n    }\r\n    var str = '';\r\n    for (var i = 0; i < length; i++) {\r\n        str += chars[Math.floor(Math.random() * chars.length)];\r\n    }\r\n    return str;\r\n}\r\n\r\nmodule.exports = GraphResultsViewer;\r\n","function SimpleChooser(){}\r\n\r\nSimpleChooser.prototype.options = function(options){\r\n\tthis.options = options;\r\n\treturn this;\r\n}\r\n\r\nSimpleChooser.prototype.render = function(chooser){\r\n\tif(chooser) this.chooser = chooser;\r\n\tif(this.chooser.config.show_empty() == false && this.chooser.count() < 1) return false;\r\n\tvar ccdom = document.createElement(\"span\");\r\n\tccdom.setAttribute(\"class\", \"woql-chooser\");\r\n\tvar ccsel = document.createElement(\"select\");\r\n\tccsel.setAttribute(\"class\", \" woql-chooser\");\r\n\tvar self = this;\r\n\tccsel.addEventListener(\"change\", function(){\r\n\t\tself.chooser.set(this.value);\r\n\t});\r\n\tvar opts = [];\r\n\tif(this.chooser.config.show_empty()){\r\n\t\topts.push(this.getEmptyOption())\r\n\t}\r\n\twhile(choice = this.chooser.next()){\r\n\t\tvar opt = this.createOptionFromChoice(choice);\r\n\t\topts.push(opt);\r\n\t}\r\n\tfor(var i = 0; i<opts.length; i++){\r\n\t\tccsel.appendChild(opts[i]);\r\n\t}\r\n\tccdom.appendChild(ccsel);\r\n\treturn ccdom;\r\n}\r\n\r\nSimpleChooser.prototype.getEmptyOption = function(){\r\n\tvar choice = { id: \"\", label: this.chooser.config.show_empty()};\r\n\treturn this.createOptionFromChoice(choice);\r\n}\r\n\r\nSimpleChooser.prototype.createOptionFromChoice = function(choice){\r\n\tvar opt = document.createElement(\"option\");\r\n\topt.setAttribute(\"class\", \"terminus-woql-chooser-choice\");\r\n\topt.value = choice.id;\r\n\tif(choice.selected) opt.selected = true;\r\n\tif(typeof choice.label == \"string\"){\r\n\t\topt.appendChild(document.createTextNode(choice.label));\r\n\t}\r\n\telse if(choice.label){\r\n\t\topt.appendChild(choice.label);\r\n\t}\r\n\tif(choice.title){\r\n\t\topt.setAttribute(\"title\", choice.title);\r\n\t}\r\n\treturn opt;\r\n}\r\n\r\nmodule.exports = SimpleChooser;","function SimpleDocument(){}\r\n\r\nSimpleDocument.prototype.render = function(frame){\r\n\tvar s = document.createElement(\"div\");\r\n\tfor(var p in frame.properties){\r\n\t\tvar pr = this.renderProperty(frame.properties[p])\r\n\t\tif(pr) s.appendChild(pr);\r\n\t}\r\n\treturn s;\r\n}\r\n\r\nSimpleDocument.prototype.renderProperty = function(frame){\r\n\tvar s = document.createElement(\"div\");\r\n\ts.appendChild(document.createTextNode(frame.getLabel() + \": \"));\r\n\tfor(var i = 0 ; i < frame.values.length; i++){\r\n\t\tif(frame.values[i].isData()){\r\n\t\t\tvar pr = this.renderValue(frame.values[i]);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tvar pr = this.render(frame.values[i]);\t\t\t\r\n\t\t}\r\n\t\tif(pr) s.appendChild(pr);\r\n\t}\r\n\treturn s;\r\n}\r\n\r\nSimpleDocument.prototype.renderValue = function(frame){\r\n\tvar s = document.createElement(\"span\");\r\n\ts.appendChild(document.createTextNode(frame.get() + \" \"));\r\n\treturn s;\r\n}\r\n\r\nmodule.exports = SimpleDocument;","function DocumentTable(){}\r\n\r\nDocumentTable.prototype.render = function(frame){\r\n\tvar t = this.getTableDOM(frame);\r\n\tvar tbody = document.createElement(\"tbody\");\r\n\tfor(var p in frame.properties){\r\n\t\t//s.appendChild(document.createTextNode(p));\r\n\t\tvar pr = this.renderProperty(tbody, frame.properties[p]);\r\n\t\t//if(pr) tbody.appendChild(pr);\r\n\t}\r\n\tt.appendChild(tbody);\r\n\treturn t;\r\n}\r\n\r\nDocumentTable.prototype.getTableDOM = function(frame){\r\n\t//const columns = this.woqltable.getColumnsToRender();\r\n\tvar tab = document.createElement(\"table\");\r\n\ttab.setAttribute(\"class\", \"terminus-hover-table\");\r\n\tvar thead = document.createElement(\"thead\");\r\n\tvar thr = document.createElement(\"tr\");\r\n\tvar th = document.createElement(\"th\");\r\n\tth.setAttribute('class', 'terminus-table-header-full-css');\r\n\tth.setAttribute('colspan', 2);\r\n\tth.appendChild(document.createTextNode(frame.subject() + \", \" + frame.subjectClass()));\r\n\tthr.appendChild(th);\r\n\tthead.appendChild(thr);\t\r\n\ttab.appendChild(thead);\r\n\treturn tab;\r\n}\r\n\r\nDocumentTable.prototype.renderProperty = function(tbody, frame){\r\n\tfor(var i = 0 ; i < frame.values.length; i++){\r\n\t\tvar thr = document.createElement(\"tr\");\r\n\t\tvar td = document.createElement(\"td\");\r\n\t\ttd.appendChild(document.createTextNode(frame.getLabel()));\r\n\t\tvar td2 = document.createElement(\"td\");\r\n\t\tif(frame.values[i].isData()){\r\n\t\t\ttd2.appendChild(this.renderValue(frame.values[i]));\r\n\t\t}\r\n\t\telse {\r\n\t\t\ttd2.appendChild(this.render(frame.values[i]));\t\t\t\r\n\t\t}\r\n\t\tthr.appendChild(td);\t\r\n\t\tthr.appendChild(td2);\t\r\n\t\ttbody.appendChild(thr);\t\r\n\t}\r\n}\r\n\r\nDocumentTable.prototype.renderValue = function(frame){\r\n\treturn document.createTextNode(frame.get());\r\n}\r\n\r\nmodule.exports = DocumentTable;","const HTMLFrameHelper = require(\"../HTMLFrameHelper\");\r\n\r\nfunction SimpleFrameViewer(){\r\n}\r\n\r\nSimpleFrameViewer.prototype.getScope = function(frame){\r\n\tif(frame.isProperty()) return \"property\";\r\n\tif(frame.isObject()) return \"object\";\r\n\tif(frame.isData()) return \"data\";\r\n}\r\n\r\nSimpleFrameViewer.prototype.getDatatypeViewer = function(frame){\r\n\tif(this.terminus){\r\n\t\tvar dv = frame.display_options.dataviewer;\r\n\t\tif(!dv){\r\n\t\t\tif(frame.isChoice()) var t = \"oneOf\";\r\n\t\t\telse if(frame.isDocument()) var t = \"document\";\r\n\t\t\telse t = frame.getType();\r\n\t\t\tvar r = this.terminus.datatypes.getRenderer(t);\r\n\t\t\tdv = r.name;\r\n\t\t}\r\n\t\tif(frame.display_options.args){\r\n\t\t\tvar args = frame.display_options.args ;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tif(r && r.args) args = r.args;\r\n\t\t\telse args = false;\r\n\t\t}\r\n\t\treturn this.terminus.datatypes.createRenderer(dv, args);\r\n\t}\r\n}\r\n\r\nSimpleFrameViewer.prototype.render = function(frame){\r\n\tvar scope = this.getScope(frame);\r\n\tif(frame.display_options.header_features){\r\n\t\tvar hfeatures = this.getFeaturesDOM(frame.display_options.header_features, frame.display_options.feature_renderers, scope, frame)\r\n\t}\r\n\telse var hfeatures = false;\r\n\tif(frame.display_options.features){\r\n\t\tvar features = this.getFeaturesDOM(frame.display_options.features, frame.display_options.feature_renderers, scope, frame);\r\n\t}\r\n\telse var features = false;\r\n\tvar orient = (scope == \"object\" || scope == \"property\") ? \"page\" : \"line\";\r\n\tvar ndom = HTMLFrameHelper.getFrameDOM(scope, frame, orient, hfeatures, features);\r\n\tif(!ndom) return false;\r\n\tif(this.framedom){\r\n\t\tthis.framedom.replaceWith(ndom);\r\n\t}\r\n\tthis.framedom = ndom;\r\n\treturn this.framedom;\r\n}\t\r\n\r\nSimpleFrameViewer.prototype.getFeaturesDOM = function(flist, renderers, scope, frame){\r\n\tvar features = document.createElement(\"span\");\r\n\tfeatures.setAttribute(\"class\", featuresToCSS(flist));\r\n\tfor(var i = 0; i<flist.length; i++){\r\n\t\tif(typeof flist[i] == \"object\"){\r\n\t\t\tfeatures.appendChild(this.getFeaturesDOM(flist[i], renderers, scope, frame));\r\n\t\t}\r\n\t\telse {\r\n\t\t\tif(renderers && renderers[flist[i]]){\r\n\t\t\t\tvar dom = renderers[flist[i]](frame, flist[i]);\r\n\t\t\t\tif(dom)\tfeatures.appendChild(dom);\r\n\t\t\t}\t\t\t\t\r\n\t\t\telse {\r\n\t\t\t\tif(flist[i] == \"value\" && scope == \"data\"){\r\n\t\t\t\t\tvar dv = this.getDatatypeViewer(frame);\r\n\t\t\t\t\tif(dv) {\r\n\t\t\t\t\t\tvar dom = dv.renderFrame(frame, this);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tvar dom = document.createTextNode(frame.get());\t\t\t\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(dom)\tfeatures.appendChild(dom);\r\n\t\t\t\t}\r\n\t\t\t\telse if(flist[i] == \"value\"){\r\n\t\t\t\t\tif(scope == 'object'){\r\n\t\t\t\t\t\tvar vals = frame.renderProperties();\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tvar vals = frame.renderValues();\t\t    \r\n\t\t\t\t\t}\r\n\t\t\t\t    for(var j = 0; j<vals.length; j++){\r\n\t\t\t\t\t\tfeatures.appendChild(vals[j]);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tvar dom = HTMLFrameHelper.getFeatureDOM(flist[i], scope, frame);\r\n\t\t\t\t\tif(dom)\tfeatures.appendChild(dom);\r\n\t\t\t\t\telse alert(\"No dom\");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn features;\r\n}\r\n\r\nfunction featuresToCSS(flist){\r\n\tvar s = \"\";\r\n\tfor(var i = 0; i<flist.length; i++){\r\n\t\tif(typeof flist[i] == \"object\"){\r\n\t\t\ts += featuresToCSS(flist[i]) + \"-\";\r\n\t\t}\r\n\t\telse {\r\n\t\t\ts += flist[i] + \"-\";\r\n\t\t}\r\n\t}\r\n\treturn s.substring(0, s.length-1);\r\n}\r\n\r\n\r\n\r\nmodule.exports = SimpleFrameViewer;","function TerminusViolations(vios, ui){\r\n\tthis.ui = ui;\r\n\tthis.vios = [];\r\n\tvar nvios = [];\r\n\tfor(var i = 0; i<vios.length; i++){\r\n\t\tfor(var j = 0; j<nvios.length; j++){\r\n\t\t\tif(JSON.stringify(vios[i]) == JSON.stringify(nvios[j])) continue;\r\n\t\t}\r\n\t\tnvios.push(vios[i]);\r\n\t}\r\n\tfor(var i = 0; i<nvios.length; i++){\r\n\t\tthis.vios.push(new TerminusViolation(nvios[i], this.ui));\r\n\t}\r\n}\r\n\r\nTerminusViolations.prototype.getAsDOM = function(context_msg){\r\n\tvar vdom = document.createElement(\"div\");\r\n\tvdom.setAttribute(\"class\", \"terminus-violations terminus-show-msg-vio\");\r\n\tvar vioHeading = document.createElement(\"div\");\r\n\tvioHeading.setAttribute('class', 'terminus-violations-heading');\r\n\tvdom.appendChild(vioHeading);\r\n\tvar msg = this.vios.length + (this.vios.length > 1 ? \" Violations Detected\" : \" Violation Detected\");\r\n\tif(context_msg) msg += \" \" + context_msg;\r\n\tvioHeading.appendChild(document.createTextNode(msg));\r\n\tfor(var i = 0; i<this.vios.length; i++){\r\n\t\tvdom.appendChild(this.vios[i].getAsDOM());\r\n\t}\r\n\treturn vdom;\r\n}\r\n\r\n/*\r\n * Class for displaying violation reports as HTML\r\n */\r\nfunction TerminusViolation(vio, ui){\r\n\tthis.ui = ui;\r\n\tthis.vio = vio;\r\n}\r\n\r\nTerminusViolation.prototype.getAsDOM = function(){\r\n\tvar vdom = document.createElement(\"div\");\r\n\tvdom.setAttribute(\"class\", \"terminus-violation\");\r\n\tif(this.vio['@type']){\r\n\t\tvar msg = this.vio['vio:message'] || {\"@value\": \"\"};\r\n\t\tvdom.appendChild(this.getPropertyAsDOM(this.vio[\"@type\"], msg));\r\n\t}\r\n\tfor(var prop in this.vio){\r\n\t\tif(prop != \"vio:message\" && prop != \"@type\"){\r\n\t\t\tvdom.appendChild(this.getPropertyAsDOM(prop, this.vio[prop]));\r\n\t\t}\r\n\t}\r\n\treturn vdom;\r\n}\r\n\r\nTerminusViolation.prototype.getPropertyAsDOM = function(prop, val){\r\n\tvar pdom = document.createElement(\"div\");\r\n\tpdom.setAttribute(\"class\", \"terminus-violation-property\");\r\n\tvar ldom = document.createElement(\"span\");\r\n\tldom.setAttribute(\"class\", \"terminus-label terminus-violation-property-label\");\r\n\tldom.appendChild(document.createTextNode(prop));\r\n\tvar vdom = document.createElement(\"span\");\r\n\tvdom.setAttribute(\"class\", \"terminus-violation-property-value\");\r\n\tvdom.appendChild(document.createTextNode(val[\"@value\"]));\r\n\tpdom.appendChild(ldom);\r\n\tpdom.appendChild(vdom);\r\n\treturn pdom;\r\n}\r\n\r\nmodule.exports=TerminusViolations\r\n","const HTMLFrameHelper = require('./html/HTMLFrameHelper');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\nconst QueryPane = require(\"./html/QueryPane\");\r\n\r\nfunction TerminusQueryViewer(ui, options){\r\n\tthis.ui = ui;\r\n\tthis.options = options;\r\n\tthis.panes = [];\r\n\tthis.meta = {};\r\n\tthis.container = document.createElement(\"div\");\r\n\tthis.container.setAttribute(\"class\", \"terminus-query-page\");    \r\n\tthis.newPaneButton = document.createElement('button');\r\n\tthis.newPaneButton.setAttribute('class', 'terminus-btn terminus-new-query-btn');\r\n\tthis.newPaneButton.appendChild(document.createTextNode('New Query'));\r\n\tthis.newPaneButton.addEventListener('click', () => this.getAsDOM());\t    \r\n}\r\n\r\nTerminusQueryViewer.prototype.getAsDOM = function(q){\r\n\tlet qpane = new QueryPane(this.ui.client, q);\r\n\tthis.panes.push(qpane);\r\n\tthis.container.appendChild(qpane.getAsDOM(this.ui));\r\n\tthis.container.appendChild(this.newPaneButton);\r\n\treturn this.container;\r\n}\r\n\r\nmodule.exports=TerminusQueryViewer\r\n","/*\r\n * Draws the screen for viewing and updating the schema\r\n * and provides wrappers around the client's schema API\r\n */\r\nconst TerminusClassChooser = require('./client/TerminusClassChooser');\r\nconst TerminusDocumentViewer = require('./TerminusDocument');\r\nconst UTILS=require('./Utils')\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction TerminusSchemaViewer(ui){\r\n\tthis.ui = ui;\r\n\tthis.mode = \"view\";\r\n\tthis.format = \"turtle\";\r\n\tthis.confirm_before_update = false;\r\n}\r\n\r\n/*\r\n * Retrieves schema from API and writes the response into the page\r\n */\r\nTerminusSchemaViewer.prototype.getAsDOM = function(){\r\n\tthis.holder = document.createElement(\"div\");\r\n\tthis.controldom = document.createElement(\"div\");\r\n\tthis.controldom.setAttribute(\"class\", \"terminus-schema-controls\");\r\n\tthis.pagedom = document.createElement(\"div\");\r\n\tthis.pagedom.setAttribute(\"class\", \"terminus-schema-viewer\");\r\n\tthis.loadSchema();\r\n\tthis.holder.appendChild(this.controldom);\r\n\tthis.holder.appendChild(this.pagedom);\r\n\treturn this.holder;\r\n}\r\n\r\nTerminusSchemaViewer.prototype.loadSchema = function(msg, msgtype){\r\n\tvar self = this;\r\n\tthis.ui.showBusy(\"Fetching Database Schema\");\r\n\tthis.ui.client.getSchema(false, {\"terminus:encoding\": \"terminus:\" + this.format})\r\n\t.then(function(response){\r\n\t\tself.ui.clearBusy();\r\n\t\tself.schema = response;\r\n\t\tself.refreshPage(msg, msgtype);\r\n\t})\r\n\t.catch(function(error){\r\n\t\tself.ui.clearBusy();\r\n\t\tself.ui.showError(error);\r\n\t});\r\n}\r\n\r\nTerminusSchemaViewer.prototype.resetControlDOM = function(){\r\n\tTerminusClient.FrameHelper.removeChildren(this.controldom);\r\n\tif(this.mode == \"edit\"){\r\n\t\tthis.controldom.appendChild(this.getSchemaSaveButtons());\r\n\t}\r\n\telse if(this.mode == \"import\"){\r\n\t\tthis.controldom.appendChild(this.getSchemaImportActionButtons());\r\n\t}\r\n\telse if(this.mode == \"class_frame\"){\r\n\t\tif(this.ui.showControl(\"get_schema\")){\r\n\t\t\tthis.controldom.appendChild(this.getShowSchemaButton());\r\n\t\t}\r\n\t\tif(this.ui.showControl(\"class_frame\")){\r\n\t\t\tthis.controldom.appendChild(this.getClassFrameChooser());\r\n\t\t}\r\n\t}\r\n\telse if(this.mode == \"view\"){\r\n\t\tif(this.ui.showControl(\"update_schema\")){\r\n\t\t\tthis.controldom.appendChild(this.getSchemaEditButton());\r\n\t\t}\r\n\t\tif(this.ui.showControl(\"import_schema\")){\r\n\t\t\tthis.controldom.appendChild(this.getImportButton());\r\n\t\t}\r\n\t\tif(this.ui.showControl(\"schema_format\")){\r\n\t\t\tthis.controldom.appendChild(this.getFormatChoices());\r\n\t\t}\r\n\t\tif(this.ui.showControl(\"class_frame\")){\r\n\t\t\tthis.controldom.appendChild(this.getClassFrameChooser());\r\n\t\t}\r\n\t}\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getFormatChoices = function(){\r\n\tvar fc = document.createElement(\"select\");\r\n\tfc.setAttribute(\"class\", \"terminus-form-select terminus-schema-format terminus-type-select\");\r\n\tvar tc = document.createElement(\"option\");\r\n\ttc.setAttribute(\"class\", \"terminus-schema-turtle\");\r\n\ttc.value = \"turtle\";\r\n\ttc.appendChild(document.createTextNode(\"Turtle\"));\r\n\tif(this.format == \"turtle\") tc.selected = true;\r\n\tfc.appendChild(tc);\r\n\tvar tj = document.createElement(\"option\");\r\n\ttj.setAttribute(\"class\", \"terminus-schema-jsonld\");\r\n\ttj.value = \"jsonld\";\r\n\ttj.appendChild(document.createTextNode(\"Json LD\"));\r\n\tif(this.format == \"jsonld\") tj.selected = true;\r\n\tfc.appendChild(tj);\r\n\tvar self = this;\r\n\tfc.addEventListener(\"change\", function(e){\r\n\t\tself.format = this.value;\r\n\t\tself.loadSchema();\r\n\t});\r\n\treturn fc;\r\n}\r\n\r\n\r\nTerminusSchemaViewer.prototype.refreshPage = function(msg, msgtype){\r\n\tif(this.controldom) this.resetControlDOM();\r\n\tif(this.pagedom) this.refreshMainPage(msg, msgtype);\r\n}\r\n\r\nTerminusSchemaViewer.prototype.refreshMainPage = function(msg, msgtype){\r\n\tTerminusClient.FrameHelper.removeChildren(this.pagedom);\r\n\tif(this.mode == 'view'){\r\n\t\tthis.pagedom.appendChild(this.getSchemaViewDOM());\r\n\t}\r\n\telse if(this.mode == \"edit\"){\r\n\t\tthis.pagedom.appendChild(this.getSchemaEditDOM());\r\n\t}\r\n\telse if(this.mode == \"import\"){\r\n\t\tthis.pagedom.appendChild(this.getSchemaImportDOM());\r\n\t}\r\n\telse if(this.mode == \"class_frame\"){\r\n\t\tthis.pagedom.appendChild(this.getClassFrameDOM());\r\n\t}\r\n\tif(msg){\r\n\t\tthis.ui.showMessage(msg, msgtype);\r\n\t}\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getSchemaSaveButtons = function(){\r\n\tvar ssb = document.createElement(\"span\");\r\n\tssb.setAttribute(\"class\", \"terminus-schema-save-buttons\");\r\n\tssb.appendChild(this.getCancelButton());\r\n\tssb.appendChild(this.getSaveButton());\r\n\treturn ssb;\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getSchemaImportActionButtons = function(){\r\n\tvar ssb = document.createElement(\"span\");\r\n\tssb.setAttribute(\"class\", \"terminus-schema-import-buttons\");\r\n\tssb.appendChild(this.getCancelButton(true));\r\n\tssb.appendChild(this.getImportSaveButton());\r\n\treturn ssb;\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getShowSchemaButton = function(){\r\n\tvar self = this;\r\n\tvar func = function(){\r\n\t\tself.ui.clearMessages();\r\n\t\tself.mode = \"view\";\r\n\t\tself.refreshPage();\r\n\t}\r\n\treturn this.getSchemaButton(\"View Schema\", \"get_schema\", func);\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getImportPreviewButton = function(){\r\n\tvar self = this;\r\n\tvar func = function(){\r\n\t\tself.ui.clearMessages();\r\n\t\tself.mode = \"preview\";\r\n\t\tself.refreshPage();\r\n\t}\r\n\treturn this.getSchemaButton(\"Preview\", \"preview\", func);\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getCancelButton = function(is_import){\r\n\tvar self = this;\r\n\tvar func = function(){\r\n\t\tself.ui.clearMessages();\r\n\t\tself.mode = \"view\";\r\n\t\tif(is_import){\r\n\t\t\tself.ui.redraw();\r\n\t\t}\r\n\t\telse {\r\n\t\t\tself.refreshPage();\r\n\t\t}\r\n\t}\r\n\treturn this.getSchemaButton(\"Cancel\", \"cancel_update\", func);\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getImportSaveButton = function(){\r\n\tvar self = this;\r\n\tvar func = function(){\r\n\t\tself.ui.clearMessages();\r\n\t\tif(typeof self.doImport == \"function\"){\r\n\t\t\tself.doImport();\r\n\t\t}\r\n\t}\r\n\treturn this.getSchemaButton(\"Import\", \"import_schema\", func)\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getSaveButton = function(){\r\n\tvar self = this;\r\n\tvar func = function(){\r\n\t\tself.ui.clearMessages();\r\n\t\tvar text = self.schema_edit_dom.value;\r\n\t\tif(typeof(self.schema) == \"object\"){\r\n\t\t\ttext = JSON.parse(text);\r\n\t\t}\r\n\t\treturn self.updateSchema(text, {\"terminus:encoding\": \"terminus:\" + self.format});\r\n\t}\r\n\treturn this.getSchemaButton(\"Save\", \"update_schema\", func);\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getSchemaEditButton = function(){\r\n\tvar self = this;\r\n\tvar func = function(){\r\n\t\tself.mode = \"edit\";\r\n\t\tself.refreshPage();\r\n\t}\r\n\treturn this.getSchemaButton(\"Edit\", \"update_schema\", func);\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getImportButton = function(){\r\n\tvar self = this;\r\n\tvar func = function(){\r\n\t\tself.ui.clearMessages();\r\n\t\tself.mode = \"import\";\r\n\t\tself.refreshPage();\r\n\t}\r\n\treturn this.getSchemaButton(\"Import New Schema\", \"import_schema\", func);\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getSchemaButton = function(label, action, func){\r\n\tvar opt = document.createElement(\"button\");\r\n\topt.appendChild(document.createTextNode(label));\r\n\topt.setAttribute(\"class\", \"terminus-btn terminus-control-button terminus-schema-\" + action);\r\n\topt.addEventListener(\"click\", func);\r\n\treturn opt;\r\n}\r\n\r\n/*\r\n * Updates schema, then fetches updated version and updates the page with it\r\n */\r\nTerminusSchemaViewer.prototype.updateSchema  = function(text, opts){\r\n\tthis.ui.showBusy(\"Updating Database Schema\");\r\n\tvar self = this;\r\n\treturn this.ui.client.updateSchema(false, text, opts)\r\n\t.then(function(response){\r\n\t\tif(response['terminus:status'] && response['terminus:status'] == \"terminus:success\"){\r\n\t\t\tself.ui.showBusy(\"Retrieving updated schema\");\r\n\t\t\tself.mode = \"view\";\r\n\t\t\tself.loadSchema(\"Successfully Updated Schema\");\r\n\t\t\tself.ui.redraw();\r\n\t\t}\r\n\t\telse if(response['terminus:status'] && response['terminus:status'] == \"terminus:failure\"){\r\n\t\t\tself.ui.clearBusy();\r\n\t\t\tself.ui.showViolations(response['terminus:witnesses'], \"schema\");\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthrow new Error(\"Update Schema returned no terminus:status code\");\r\n\t\t}\r\n\t})\r\n\t.catch(function(error){\r\n\t\tself.ui.clearBusy();\r\n\t\tif(error.data && error.data['terminus:witnesses']){\r\n\t\t\tself.ui.showViolations(error.data['terminus:witnesses'], \"schema\");\t\t\t\r\n\t\t}\r\n\t\telse {\r\n\t\t\tself.ui.showError(error);\r\n\t\t}\r\n\t});\r\n}\r\n\r\n/*\r\n * Imports a schema from the passed url\r\n * mode: replace | append\r\n */\r\nTerminusSchemaViewer.prototype.load  = function(url, key, mode){\r\n\tvar self = this;\r\n\tmode = (mode ? mode : \"replace\");\r\n\tthis.ui.showBusy(\"Loading schema from \" + url);\r\n\tvar origurl = this.ui.client.connectionConfig.schemaURL();\r\n\treturn this.ui.client.getSchema(url, {\"terminus:user_key\": key, \"terminus:encoding\" : \"terminus:\" + this.format})\r\n\t.then(function(response){\r\n\t\tvar newschema = (mode == \"append\") ? self.appendSchema(response) : response;\r\n\t\tif(self.confirm_before_update){\r\n\t\t\t//reconnect to original db\r\n\t\t\tself.ui.showResult(\"Schema retrieved - click save to deploy\");\r\n\t\t\tself.ui.client.connectionConfig.setSchemaURL(origurl);\r\n\t\t\tself.showConfirmPage(newschema);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tself.ui.showBusy(\"Updating schema\");\r\n\t\t\tself.ui.client.connectionConfig.setSchemaURL(origurl);\r\n\t\t\tself.updateSchema(newschema, {\"terminus:encoding\": \"terminus:\" + self.format}).then(function(response){\r\n\t\t\t\tself.mode = \"view\";\r\n\t\t\t\tself.ui.clearBusy();\r\n\t\t\t\tself.ui.redraw();\r\n\t\t\t\tself.ui.showResult(\"Successfully deployed new schema from \" + url);\r\n\t\t\t\treturn response;\r\n\t\t\t});\r\n\t\t}\r\n\t}).catch(function(error){\r\n\t\tself.ui.clearBusy();\r\n\t\tself.ui.showError(error);\r\n\t});\r\n}\r\n\r\nTerminusSchemaViewer.prototype.appendSchema = function(s2){\r\n\tvar nschema = this.schema;\r\n\tif(this.format == 'turtle'){\r\n\t\tnschema = this.schema + s2;\r\n\t}\r\n\telse if(this.format == 'jsonld'){\r\n\t\tfor(var i in s2){\r\n\t\t\tnschema[i] = s2[i];\r\n\t\t}\r\n\t}\r\n\treturn nschema;\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getClassFrameChooser = function(){\r\n\tvar np = document.createElement(\"span\");\r\n\tnp.setAttribute(\"class\", \"terminus-class frame-chooser\");\r\n\tvar termcc = new TerminusClassChooser(this.ui);\r\n\ttermcc.empty_choice = \"View Individual Class Frames\";\r\n\tvar self = this;\r\n\ttermcc.change = function(new_class){\r\n\t\tif(new_class){\r\n\t\t\tself.cls = new_class;\r\n\t\t\tif(self.mode != \"class_frame\"){\r\n\t\t\t\tself.mode = \"class_frame\";\r\n\t\t\t\tself.refreshPage();\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tself.refreshMainPage();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tvar tcdom = termcc.getAsDOM();\r\n\tnp.appendChild(tcdom);\r\n\treturn np;\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getClassFrameDOM = function(){\r\n\tvar np = document.createElement(\"div\");\r\n\tnp.setAttribute(\"class\", \"terminus-schema-page terminus-schema-classframe-page\");\r\n\tvar docviewer = new TerminusDocumentViewer(this.ui, \"model\");\r\n\tdocviewer.loadCreateDocument(this.cls);\r\n\tdocviewer.page_config = \"model\";\r\n\tnp.appendChild(docviewer.getAsDOM());\r\n\treturn np;\r\n}\r\n\r\nTerminusSchemaViewer.prototype.showConfirmPage = function(newschema){\r\n\tthis.schema = newschema;\r\n\tthis.confirm_before_update = false;\r\n\tthis.mode = \"edit\";\r\n\tthis.refreshPage(\"Confirm new schema\");\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getSchemaEditDOM = function(){\r\n\tvar np = document.createElement(\"div\");\r\n\tnp.setAttribute(\"class\", \"terminus-schema-page terminus-schema-edit-page\");\r\n\tvar ipval = document.createElement(\"textarea\");\r\n\tipval.setAttribute(\"class\", \"terminus-schema-edit terminus-schema-textarea\");\r\n\tipval.setAttribute(\"width\", \"100%\");\r\n\tipval.setAttribute(\"style\", \"min-width: 400px; min-height: 400px;\");\r\n\tif(typeof(this.schema) == \"string\"){\r\n\t\tipval.innerHTML = this.schema;\r\n\t}\r\n\telse if(typeof (this.schema) == \"object\") {\r\n\t\tipval.innerHTML = JSON.stringify(this.schema, 0, 4);\r\n\t}\r\n\tthis.schema_edit_dom = ipval;\r\n\tnp.appendChild(ipval);\r\n\tUTILS.stylizeEditor(this.ui, ipval, 'schema', 'turtle');\r\n\treturn np;\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getSchemaViewDOM = function(){\r\n\tvar self = this;\r\n\tvar np = document.createElement(\"div\");\r\n\tnp.setAttribute(\"class\", \"terminus-schema-page terminus-schema-view-page\");\r\n\tvar ipval = document.createElement(\"pre\");\r\n\tipval.setAttribute(\"class\", \"terminus-schema-view terminus-scheme-pre\");\r\n\tif(typeof(this.schema) == \"string\"){\r\n\t\tvar txt = this.schema.replace(/&/g, \"&amp;\")\r\n         .replace(/</g, \"&lt;\")\r\n         .replace(/>/g, \"&gt;\")\r\n         .replace(/\"/g, \"&quot;\")\r\n         .replace(/'/g, \"&#039;\");\r\n\t\tipval.innerHTML = txt;\r\n\t}\r\n\telse if(typeof (this.schema) == \"object\") {\r\n\t\tipval.innerHTML = JSON.stringify(this.schema, 0, 4);\r\n\t}\r\n\tvar cm = UTILS.stylizeCodeDisplay(this.ui, ipval, np, 'turtle');\r\n\tif(!cm) np.appendChild(ipval);\r\n\treturn np;\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getSchemaImportDOM = function(){\r\n\tvar scd = document.createElement(\"div\");\r\n\tscd.setAttribute(\"class\", \"terminus-form-border terminus-schema-page terminus-schema-import-page\");\r\n\r\n\r\n\tvar sci = document.createElement(\"div\");\r\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-form-field-spacing terminus-form-horizontal terminus-control-group\");\r\n\tvar slab = document.createElement(\"span\");\r\n\tslab.setAttribute(\"class\", \"terminus-url-loader-input terminus-form-label terminus-control-label\");\r\n\tslab.appendChild(document.createTextNode(\"URL\"));\r\n\tsci.appendChild(slab);\r\n\tvar inpUrl  = document.createElement(\"input\");\r\n\tinpUrl.setAttribute(\"type\", \"text\");\r\n\tinpUrl.setAttribute(\"class\", \"terminus-form-value terminus-input-text terminus-form-url terminus-url-connect\");\r\n\tinpUrl.setAttribute(\"placeholder\", \"Enter URL of DB to import from\");\r\n\tsci.appendChild(inpUrl);\r\n\tscd.appendChild(sci);\r\n\r\n\tvar sci = document.createElement(\"div\");\r\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-form-field-spacing terminus-form-horizontal terminus-control-group\");\r\n\tvar klab = document.createElement(\"span\");\r\n\tklab.setAttribute(\"class\", \"terminus-url-loader-input terminus-form-label  terminus-control-label terminus-import_mode-input\");\r\n\tklab.appendChild(document.createTextNode(\"Import Mode\"));\r\n\tsci.appendChild(klab);\r\n\tvar modes = document.createElement(\"select\");\r\n\tmodes.setAttribute(\"class\", \"terminus-form-select\");\r\n\r\n\tvar overwrite = document.createElement(\"option\");\r\n\toverwrite.value = \"replace\";\r\n\toverwrite.appendChild(document.createTextNode(\"Replace Mode\"))\r\n\tmodes.appendChild(overwrite);\r\n\tvar append = document.createElement(\"option\");\r\n\tappend.value = \"append\";\r\n\tappend.appendChild(document.createTextNode(\"Append Mode\"))\r\n\tmodes.appendChild(append);\r\n\tmodes.setAttribute(\"class\", \"terminus-form-select terminus-import-mode\");\r\n\tsci.appendChild(klab);\r\n\tsci.appendChild(modes);\r\n\tscd.appendChild(sci);\r\n\r\n\tvar sci = document.createElement(\"div\");\r\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-form-field-spacing terminus-form-horizontal terminus-control-group\");\r\n\tvar klab = document.createElement(\"span\");\r\n\tklab.setAttribute(\"class\", \"terminus-form-label terminus-url-key-input terminus-control-label\");\r\n\tklab.appendChild(document.createTextNode(\"Key\"))\r\n\tvar key = document.createElement(\"input\");\r\n\tkey.setAttribute(\"type\", \"text\");\r\n\tkey.setAttribute(\"class\", \"terminus-form-value terminus-input-text terminus-url-key\");\r\n\tsci.appendChild(klab);\r\n\tsci.appendChild(key);\r\n\tscd.appendChild(sci);\r\n\tvar self = this;\r\n\tthis.doImport = function(){\r\n\t\tif(inpUrl.value){\r\n\t\t\tself.load(inpUrl.value, key.value, modes.value);\r\n\t\t}\r\n\t}\r\n\treturn scd;\r\n}\r\n\r\nmodule.exports=TerminusSchemaViewer\r\n","/* User interface elements that relate to server context\r\n *\r\n * TerminusServerController is a control widget that invokes server actions\r\n * TerminusServerViewer is a window that displays server actions and server screens\r\n *\r\n */\r\n const Datatables = require('./plugins/datatables.terminus');\r\n const UTILS =require('./Utils');\r\n const HTMLFrameHelper = require('./html/HTMLFrameHelper');\r\n const TerminusHTMLViewer = require(\"./TerminusHTMLViewer\");\r\n const TerminusClient = require('@terminusdb/terminus-client');\r\n\r\n function TerminusServerController(ui){\r\n\t this.ui = ui;\r\n }\r\n\r\nTerminusServerController.prototype.getAsDOM = function(){\r\n\tvar rsc = document.createElement(\"div\");\r\n\trsc.setAttribute(\"class\", \"terminus-server-controller\");\r\n\tvar self = this;\r\n\tif(this.ui && this.ui.server()){\r\n\t\tvar scd = document.createElement(\"div\");\r\n\t\tscd.setAttribute(\"class\", \"terminus-server-connection\");\r\n        var nav = document.createElement('div');\r\n        nav.setAttribute('class', 'span3');\r\n        var ul = document.createElement('ul');\r\n        ul.setAttribute('class', 'terminus-ul');\r\n        nav.appendChild(ul);\r\n        rsc.appendChild(nav);\r\n        // connected to server\r\n        var a = document.createElement('a');\r\n        a.setAttribute('class', 'terminus-dashboard-info terminus-list-group-a terminus-nav-width');\r\n        var txt = 'Server: ' + this.ui.server();\r\n        a.appendChild(document.createTextNode(txt));\r\n        ul.appendChild(a);\r\n        // change server\r\n        if(this.ui.showControl(\"change-server\")){\r\n            var a = document.createElement('a');\r\n            a.setAttribute('class', 'terminus-a terminus-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\r\n            var self = this;\r\n            a.addEventListener(\"click\", function(){\r\n                UTILS.activateSelectedNav(this, self);\r\n                self.ui.showLoadURLPage();\r\n            })\r\n            var icon = document.createElement('i');\r\n            icon.setAttribute('class', 'terminus-menu-icon fa fa-link');\r\n            a.appendChild(icon);\r\n            var txt = document.createTextNode('Change Server');\r\n            a.appendChild(txt);\r\n            ul.appendChild(a);\r\n        }\r\n        // view databases\r\n        if(this.ui.showControl(\"db\")){\r\n            var a = document.createElement('a');\r\n            a.setAttribute('class', 'terminus-a terminus-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\r\n            var self = this;\r\n            a.addEventListener(\"click\", function(){\r\n                UTILS.activateSelectedNav(this, self);\r\n                if(self.ui.db()){\r\n                    //self.ui.clearDB();\r\n                }\r\n                self.ui.showServerMainPage();\r\n            })\r\n            var icon = document.createElement('i');\r\n            icon.setAttribute('class', 'terminus-menu-icon fa fa-eye');\r\n            a.appendChild(icon);\r\n            var txt = document.createTextNode('View Databases');\r\n            a.appendChild(txt);\r\n            ul.appendChild(a);\r\n        }\r\n        if(this.ui.showControl(\"create_database\")){\r\n            var a = document.createElement('a');\r\n            a.setAttribute('class', 'terminus-a terminus-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\r\n            var self = this;\r\n            a.addEventListener(\"click\", function(){\r\n               UTILS.activateSelectedNav(this, self);\r\n                if(self.ui.db()){\r\n                    //self.ui.clearDB();\r\n                }\r\n                self.ui.showCreateDBPage();\r\n            })\r\n            var icon = document.createElement('i');\r\n            icon.setAttribute('class', 'terminus-menu-icon fa fa-plus');\r\n            a.appendChild(icon);\r\n            var txt = document.createTextNode('Create New Database');\r\n            a.appendChild(txt);\r\n            ul.appendChild(a);\r\n        }\r\n\t}\r\n\treturn rsc;\r\n}\r\n\r\nTerminusServerController.prototype.getServerLabelDOM = function(){\r\n\tvar srec = this.ui.client.connection.getServerRecord();\r\n\tvar lab = (srec && srec['rdfs:label'] && srec['rdfs:label'][\"@value\"] ? srec['rdfs:label'][\"@value\"] : this.ui.server());\r\n\tvar desc = (srec && srec['rdfs:comment'] && srec['rdfs:comment'][\"@value\"] ? srec['rdfs:comment'][\"@value\"] : \"\");\r\n\tdesc += \" Server URL: \"+ this.ui.server();\r\n\tvar val = document.createElement(\"span\");\r\n\tval.setAttribute(\"class\", \"terminus-server-value\");\r\n\tval.setAttribute(\"title\", desc);\r\n\tval.appendChild(document.createTextNode(lab));\r\n    val =  document.createElement('div');\r\n\treturn val;\r\n}\r\n\r\nfunction TerminusServerViewer(ui){\r\n\tthis.ui = ui;\r\n\tthis.server = this.ui.server();\r\n\tthis.max_cell_size = 500;\r\n\tthis.max_word_size = 40;\r\n}\r\n\r\nTerminusServerViewer.prototype.getAsDOM = function(selected){\r\n\tvar self = this;\r\n\tvar pd = document.createElement(\"span\");\r\n\tpd.setAttribute(\"class\", \"terminus-server-home-page\");\r\n\tif(this.ui.server()){\r\n\t\tvar scd = document.createElement(\"span\");\r\n\t\tscd.setAttribute(\"class\", \"terminus-server-home\");\r\n\t\tif(this.ui.showView(\"server\")){\r\n\t\t\t// 11092019 scd.appendChild(this.getServerDetailsDOM());\r\n\t\t}\r\n\t\tif(this.ui.showView(\"change-server\")){\r\n\t\t\tvar csbut = document.createElement(\"button\");\r\n\t\t\tcsbut.setAttribute(\"class\", \"terminus-control-button terminus-change-server-button terminus-btn\")\r\n\t\t\tcsbut.appendChild(document.createTextNode(\"Disconnect\"));\r\n\t\t\tcsbut.addEventListener(\"click\", function(){\r\n\t\t\t\t//self.ui.clearDB();\r\n\t\t\t\t//self.ui.clearServer();\r\n\t\t\t\tself.ui.showLoadURLPage();\r\n\t\t\t})\r\n\t\t\t// 11092019 scd.appendChild(csbut);\r\n\t\t}\r\n\t\tif(this.ui.showView(\"create_database\")){\r\n\t\t\tvar crbut = document.createElement(\"button\");\r\n\t\t\tcrbut.setAttribute(\"class\", \"terminus-control-button terminus-create-db-button terminus-btn\")\r\n\t\t\tcrbut.appendChild(document.createTextNode(\"Create New Database\"));\r\n\t\t\tcrbut.addEventListener(\"click\", function(){\r\n\t\t\t\tif(self.ui.db()){\r\n\t\t\t\t\t//self.ui.clearDB();\r\n\t\t\t\t}\r\n\t\t\t\tself.ui.clearMessages();\r\n\t\t\t\tself.ui.showCreateDBPage();\r\n\t\t\t})\r\n\t\t\t// 11092019 scd.appendChild(crbut);\r\n\t\t}\r\n\t\tif(this.ui.showView(\"db\")){\r\n\t\t\t//scd.appendChild(this.getNDBListDOM());\r\n\t\t\tscd.appendChild(this.getDBListDOM());\r\n\t\t}\r\n\t\tpd.appendChild(scd);\r\n\t}\r\n\telse {\r\n\t\tself.ui.showLoadURLPage();\r\n\r\n\t\t//pd.appendChild(this.getLoadURLPage());\r\n\t}\r\n\treturn pd;\r\n}\r\n\r\nTerminusServerViewer.prototype.getServerDetailsDOM = function(){\r\n\tvar scd = document.createElement(\"span\");\r\n\tscd.setAttribute(\"class\", \"terminus-server-details terminus-server-banner\");\r\n\tvar scl = document.createElement(\"span\");\r\n\tscl.setAttribute(\"class\", \"terminus-label terminus-server-info\");\r\n\tscl.appendChild(document.createTextNode(\"Connected to Server - \"))\r\n\tvar scs = document.createElement(\"span\");\r\n\tscs.setAttribute(\"class\", \"terminus-value terminus-server-info\");\r\n\tscs.appendChild(document.createTextNode(this.ui.server()))\r\n\tscd.appendChild(scl);\r\n\tscd.appendChild(scs);\r\n\treturn scd;\r\n}\r\n\r\nTerminusServerViewer.prototype.wrapTableLinkCell = function(tdElement,dbid, text){\r\n\tvar self = this;\r\n\tvar wrap = document.createElement(\"p\");\r\n//\twrap.setAttribute(\"href\", \"#\");\r\n\twrap.setAttribute(\"class\", \"terminus-table-content\");\r\n\tHTMLFrameHelper.wrapShortenedText(wrap, text, this.max_cell_size, this.max_word_size);\r\n\ttdElement.addEventListener(\"click\", function(){\r\n\t\tself.ui.connectToDB(dbid);\r\n\t\tself.ui.showDBMainPage();\r\n\t});\r\n\treturn wrap;\r\n}\r\n\r\nTerminusServerViewer.prototype.getNDBListDOM = function(){\r\n\tvar whtml = new TerminusHTMLViewer(this.ui.client);\r\n\tvar dbrecs = this.ui.client.connection.getServerDBRecords();\r\n\t\r\n\t//var tab = whtml.table(); \r\n}\r\n\r\nTerminusServerViewer.prototype.getDBListDOM = function(){\r\n\tvar self = this;\r\n\tvar sec = document.createElement(\"div\");\r\n\tvar lihed = document.createElement(\"h3\");\r\n\tlihed.setAttribute(\"class\", \"terminus-db-list-title terminus-module-head\");\r\n\tlihed.appendChild(document.createTextNode(\"Available Databases\"));\r\n\tsec.appendChild(lihed);\r\n\tvar scd = document.createElement(\"table\");\r\n\tscd.setAttribute(\"class\", \"terminus-db-list terminus-db-size terminus-hover-table\");\r\n\tvar thead = document.createElement(\"thead\");\r\n\tvar thr = document.createElement(\"tr\");\r\n\tvar th1 = document.createElement(\"th\");\r\n\tth1.appendChild(document.createTextNode(\"ID\"));\r\n\tth1.setAttribute(\"class\", \"terminus-db-id terminus-table-header-full-css\");\r\n\tvar th2 = document.createElement(\"th\");\r\n\tth2.appendChild(document.createTextNode(\"Title\"));\r\n\tth2.setAttribute(\"class\", \"terminus-db-title terminus-table-header-full-css\");\r\n\tvar th3 = document.createElement(\"th\");\r\n\tth3.appendChild(document.createTextNode(\"Description\"));\r\n\tth3.setAttribute(\"class\", \"terminus-db-description terminus-table-header-full-css\");\r\n\tvar th4 = document.createElement(\"th\");\r\n\tth4.setAttribute(\"class\", \"terminus-db-size terminus-table-header-full-css\");\r\n\tth4.appendChild(document.createTextNode(\"Size\"));\r\n\tvar th5 = document.createElement(\"th\");\r\n\tth5.setAttribute(\"class\", \"terminus-db-created terminus-table-header-full-css\");\r\n\tth5.appendChild(document.createTextNode(\"Created\"));\r\n\tvar th6 = document.createElement(\"th\");\r\n\tth6.appendChild(document.createTextNode(\"Delete\"));\r\n\tth6.setAttribute(\"class\", \"terminus-db-delete terminus-table-header-full-css\");\r\n\tthr.appendChild(th1);\r\n\tthr.appendChild(th2);\r\n\tthr.appendChild(th3);\r\n\t//thr.appendChild(th4);\r\n\t//thr.appendChild(th5);\r\n\tthr.appendChild(th6);\r\n\tthead.appendChild(thr);\r\n\tscd.appendChild(thead);\r\n\tvar tbody = document.createElement(\"tbody\");\r\n\tvar dbrecs = this.ui.client.connection.getServerDBRecords();\r\n\tfor(let fullid in dbrecs){\r\n\t\tlet dbrec = dbrecs[fullid];\r\n\t\tconst dbid = fullid.split(\":\")[1];\r\n\t\tlet tr = document.createElement(\"tr\");\r\n\t\tvar td1 = document.createElement(\"td\");\r\n\t\ttd1.appendChild(this.wrapTableLinkCell(td1,dbid, dbid));\r\n\t\ttd1.setAttribute(\"class\", \"terminus-db-id terminus-db-pointer\");\r\n\t\tvar td2 = document.createElement(\"td\");\r\n\t\ttd2.setAttribute(\"class\", \"terminus-db-title terminus-db-pointer\");\r\n\t\tvar txt = (dbrec && dbrec['rdfs:label'] && dbrec['rdfs:label']['@value'] ? dbrec['rdfs:label']['@value'] : \"\");\r\n\t\ttd2.appendChild(this.wrapTableLinkCell(td2,dbid, txt));\r\n\t\tvar td3 = document.createElement(\"td\");\r\n\t\ttd3.setAttribute(\"class\", \"terminus-db-description terminus-db-pointer\");\r\n\t\tvar txt = (dbrec && dbrec['rdfs:comment'] && dbrec['rdfs:comment']['@value'] ? dbrec['rdfs:comment']['@value'] : \"\");\r\n\t\ttd3.appendChild(this.wrapTableLinkCell(td3,dbid, txt));\r\n\t\tvar td4 = document.createElement(\"td\");\r\n\t\ttd4.setAttribute(\"class\", \"terminus-db-size terminus-db-pointer\");\r\n\t\tvar txt = (dbrec && dbrec['terminus:size'] && dbrec['terminus:size']['@value'] ? dbrec['terminus:size']['@value'] : \"\");\r\n\t\ttd4.appendChild(this.wrapTableLinkCell(td4,dbid, txt));\r\n\t\tvar td5 = document.createElement(\"td\");\r\n\t\ttd5.setAttribute(\"class\", \"terminus-db-created terminus-db-pointer\");\r\n\t\tvar txt = (dbrec && dbrec['terminus:last_updated'] && dbrec['terminus:last_updated']['@value'] ? dbrec['terminus:last_updated']['@value'] : \"\");\r\n\t\ttd5.appendChild(this.wrapTableLinkCell(td5,dbid, txt));\r\n\t\tvar td6 = document.createElement(\"td\");\r\n\t\ttd6.setAttribute(\"class\", \"db-delete\");\r\n        if(this.deleteDBPermitted(dbid)){\r\n            if(this.ui.pluginAvailable(\"font-awesome\")){\r\n                var delbut = document.createElement('i');\r\n        \t\tdelbut.setAttribute(\"class\", \"terminus-db-list-del-icon fa fa-times-circle\");\r\n        \t}\r\n            else{\r\n                var delbut = document.createElement(\"button\");\r\n    \t\t\tdelbut.appendChild(document.createTextNode(\"Delete\"));\r\n    \t\t\tdelbut.setAttribute(\"class\", \"terminus-control-button terminus-delete-db-button\");\r\n            }\r\n\t\t\t// function to fix db in a closure\r\n\t\t\tvar delDB = function(db){\r\n\t\t\t\treturn function(){\r\n\t\t\t\t\tlet deleteConfirm = confirm(`Do you want to delete ${db} Database?`);\r\n\t\t\t\t\tif (deleteConfirm == true) {\r\n\t\t\t  \t\t\tself.ui.deleteDatabase(db);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t//self.ui.deleteDatabase(db);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tdelbut.addEventListener(\"click\", delDB(dbid));\r\n\t\t\ttd6.appendChild(delbut);\r\n\t\t}\r\n\r\n\t\ttr.appendChild(td1);\r\n\t\ttr.appendChild(td2);\r\n\t\ttr.appendChild(td3);\r\n\t\t//tr.appendChild(td4);\r\n\t\t//tr.appendChild(td5);\r\n\t\ttr.appendChild(td6);\r\n\t\ttbody.appendChild(tr);\r\n\t}\r\n\tscd.appendChild(tbody);\r\n\tsec.appendChild(scd);\r\n\r\n\tif(this.ui.pluginAvailable(\"datatables\")){\r\n        var dt = new Datatables.CspDatatables(this.ui);\r\n\t\tvar tab = dt.draw(scd);\r\n\t}\r\n\treturn sec;\r\n}\r\n\r\nTerminusServerViewer.prototype.deleteDBPermitted = function(dbid){\r\n\tif(dbid == \"terminus\") return false;\r\n\tif(this.ui.client.connection.capabilitiesPermit(\"delete_database\", dbid)) return true;\r\n\treturn false;\r\n}\r\n\r\nmodule.exports = {TerminusServerViewer,TerminusServerController}\r\n","function TerminusURLLoader(ui, val){\r\n\tthis.ui = ui;\r\n\tthis.val = val;\r\n\tthis.url_input = false;\r\n\tthis.key_input = false;\r\n}\r\n\r\nTerminusURLLoader.prototype.getLabelDOM = function(){\r\n\treturn document.createTextNode(\"Connect\");\r\n}\r\n\r\nTerminusURLLoader.prototype.getFormFieldDOM = function(ip, fname, ltxt, pholder){\r\n\tvar sci = document.createElement(\"div\");\r\n\tsci.setAttribute(\"class\", \"terminus-form-horizontal terminus-control-group terminus-form-field-spacing terminus-form-field terminus-field-\"+fname);\r\n\tvar lab = document.createElement(\"span\");\r\n\tlab.setAttribute(\"class\", \"terminus-control-label terminus-form-label terminus-form-field-label terminus-label-\"+fname);\r\n\tlab.appendChild(document.createTextNode(ltxt))\r\n\tip.setAttribute(\"type\", \"text\");\r\n\tip.setAttribute(\"placeholder\", pholder);\r\n\tsci.appendChild(lab);\r\n\tsci.appendChild(ip);\r\n\treturn sci;\r\n}\r\n\r\nTerminusURLLoader.prototype.getAsDOM = function(){\r\n\tvar scd = document.createElement(\"div\");\r\n\tscd.setAttribute(\"class\", \"terminus-form terminus-url-loader\");\r\n\tvar stit = document.createElement(\"h3\");\r\n\tstit.setAttribute(\"class\", \"terminus-form-header terminus-connect-header terminus-module-head\");\r\n\tstit.appendChild(document.createTextNode(\"Connect To Terminus Server\"));\r\n\tscd.appendChild(stit);\r\n\tvar mfd = document.createElement('div');\r\n\tmfd.setAttribute('class', 'terminus-form-border');\r\n\tscd.appendChild(mfd);\r\n\tthis.url_input = document.createElement(\"input\");\r\n\tthis.url_input.setAttribute(\"class\", \"terminus-form-value terminus-form-url terminus-form-field-input terminus-input-text\");\r\n\tif(this.val){\r\n\t\tthis.url_input.value = this.val;\r\n\t}\r\n\tmfd.appendChild(this.getFormFieldDOM(this.url_input, \"connect\", \"URL\", \"Terminus DB URL\"));\r\n\tthis.key_input = document.createElement(\"input\");\r\n\tthis.key_input.setAttribute(\"class\", \"terminus-form-value terminus-value terminus-input-text\");\r\n\tmfd.appendChild(this.getFormFieldDOM(this.key_input, \"connect\", \"Key\", \"Server API Key\"));\r\n\tvar loadbuts = document.createElement(\"div\");\r\n\tloadbuts.setAttribute(\"class\", \"terminus-control-buttons\");\r\n\tvar loadbut = document.createElement(\"button\");\r\n\tloadbut.setAttribute(\"class\", \"terminus-control-button terminus-url-load terminus-btn\");\r\n\tloadbut.appendChild(document.createTextNode(\"Connect\"));\r\n\tvar self = this;\r\n\tloadbut.addEventListener(\"click\", function(){\r\n\t\tif(self.url_input.value){\r\n\t\t\tself.ui.load(self.url_input.value, self.key_input.value);\r\n\t\t}\r\n\t});\r\n\tloadbuts.appendChild(loadbut);\r\n\tmfd.appendChild(loadbuts);\r\n\treturn scd;\r\n}\r\n\r\n\r\nmodule.exports=TerminusURLLoader\r\n"],"sourceRoot":""}
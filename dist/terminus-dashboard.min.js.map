{"version":3,"sources":["webpack://TerminusDashboard/webpack/bootstrap","webpack://TerminusDashboard/./src/Utils.js","webpack://TerminusDashboard/./src/query/WOQLQuery.js","webpack://TerminusDashboard/./src/plugins/TerminusPlugin.js","webpack://TerminusDashboard/./src/query/WOQLResultsViewer.js","webpack://TerminusDashboard/./src/client/HTMLFrameHelper.js","webpack://TerminusDashboard/./src/client/RenderingMap.js","webpack://TerminusDashboard/./src/client/TerminusClassChooser.js","webpack://TerminusDashboard/./src/client/PropertyViewer.js","webpack://TerminusDashboard/./src/client/viewers/String.js","webpack://TerminusDashboard/./src/client/TerminusDocument.js","webpack://TerminusDashboard/./src/plugins/datatables.terminus.js","webpack://TerminusDashboard/./src/client/viewers/DateHelper.js","webpack://TerminusDashboard/./src/client/TerminusDocumentChooser.js","webpack://TerminusDashboard/./src/index.js","webpack://TerminusDashboard/./src/TerminusUI.js","webpack://TerminusDashboard/./src/ApiExplorer.js","webpack://TerminusDashboard/./src/plugins/codemirror.terminus.js","webpack://TerminusDashboard/./src/FrameHelper.js","webpack://TerminusDashboard/./src/client/ObjectRenderer.js","webpack://TerminusDashboard/./src/client/ValueRenderer.js","webpack://TerminusDashboard/./src/client/ObjectViewer.js","webpack://TerminusDashboard/./src/client/viewers/StringEditor.js","webpack://TerminusDashboard/./src/client/viewers/Boolean.js","webpack://TerminusDashboard/./src/client/viewers/BooleanEditor.js","webpack://TerminusDashboard/./src/client/viewers/Choice.js","webpack://TerminusDashboard/./src/client/viewers/ChoiceEditor.js","webpack://TerminusDashboard/./src/client/viewers/Coordinate.js","webpack://TerminusDashboard/./src/client/viewers/CoordinateEditor.js","webpack://TerminusDashboard/./src/client/viewers/Date.js","webpack://TerminusDashboard/./src/client/viewers/DateEditor.js","webpack://TerminusDashboard/./src/client/viewers/Entity.js","webpack://TerminusDashboard/./src/client/viewers/EntityEditor.js","webpack://TerminusDashboard/./src/client/viewers/Image.js","webpack://TerminusDashboard/./src/client/viewers/ImageEditor.js","webpack://TerminusDashboard/./src/client/viewers/Link.js","webpack://TerminusDashboard/./src/client/viewers/Number.js","webpack://TerminusDashboard/./src/client/viewers/Range.js","webpack://TerminusDashboard/./src/client/viewers/RangeEditor.js","webpack://TerminusDashboard/./src/client/viewers/SanitizedHTML.js","webpack://TerminusDashboard/./src/client/DataViewer.js","webpack://TerminusDashboard/./src/client/TerminusDB.js","webpack://TerminusDashboard/./src/client/TerminusViolation.js","webpack://TerminusDashboard/./src/client/TerminusQuery.js","webpack://TerminusDashboard/./src/query/WOQLTextboxGenerator.js","webpack://TerminusDashboard/./src/client/TerminusPropertyChooser.js","webpack://TerminusDashboard/./src/query/WOQLGraphBrowserGenerator.js","webpack://TerminusDashboard/./src/query/WOQLTimePicker.js","webpack://TerminusDashboard/./src/client/TerminusMapping.js","webpack://TerminusDashboard/./src/client/TerminusSchema.js","webpack://TerminusDashboard/./src/client/TerminusServer.js","webpack://TerminusDashboard/./src/client/TerminusURL.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","Codemirror","require","getHeaderDom","text","hd","document","createElement","setAttribute","h","innerHTML","appendChild","stylizeCodeDisplay","ui","txt","dom","cmConfig","pluginAvailable","pr","colorizePre","removeSelectedNavClass","el","getElementsByClassName","length","classList","remove","hideDocumentSubMenus","contains","add","tolggleContent","icon","content","style","display","stylizeEditor","view","cm","ar","colorizeTextArea","updateTextArea","deleteStylizedEditor","qip","nextElementSibling","TerminusClient","FrameHelper","removeChildren","showHttpResult","response","action","currForm","terminator","br","retHttpHeaders","headers","hdres","createTextNode","json","then","rd","data","JSON","stringify","pre","getResponse","getInfoAlertDom","type","label","msg","ald","str","getFunctionSignature","which","sigs","spec","descr","result","args","server_url","options","title","description","database_url","details","format","editmode","document_url","fail_on_id_denied","woql","class","term","source","target","toggleVisibility","extractValueFromCell","cellValue","DOMParser","parseFromString","firstChild","activateSelectedNav","nav","showControl","checkDocumentSubMenus","WOQLResult","WOQLQuery","client","this","default_limit","prefixes","connectionConfig","platformEndpoint","sid","server","substring","lastIndexOf","colid","dbid","serverURL","schemaURL","dbURL","docURL","pref","standard_urls","setPrefixes","shorten","url","execute","wrapped","wrap","self","select","getConcreteDocumentClassPattern","varc","and","getSubclassQueryPattern","not","getAbstractQueryPattern","varname","quad","clsname","sub","queryWrappedWithLimit","query","limit","start","getAllDocumentQuery","constraint","triple","push","getEverythingQuery","wjson","getPropertyListQuery","opt","getElementMetaDataQuery","getClassListMetaDataQuery","getClassMetaDataQuery","getDataOfChosenClassQuery","chosen","getDataOfChosenPropertyQuery","getInstanceMeta","getDocumentQuery","id","getClassesQuery","TerminusPluginManager","preloaded","loaded","loading","precluded","plugins","css","js","plugin","requires","setPluginOptions","opts","k","init","calculatePreloaded","toload","calculateRequiredInitPlugins","loadPlugins","pins","pid","indexOf","getDefaultPlugins","needed_pins","loading_order","getAvailablePlugins","pl","version_check","pluginmeta","version","jQuery","isFunction","fn","slider","Quill","JSONEditor","CodeMirror","fontAwesomeCheck","dataTable","select2","google","maps","ol","Map","d3","console","log","Error","span","className","body","insertBefore","element","window","getComputedStyle","getPropertyValue","replace","removeChild","ticker","cback","loadPlugin","pug","cssid","loadDynamicCSS","scripts","splice","loadDynamicScript","loadPluginScripts","loadPageCSS","cssfid","cssdom","getElementById","parentNode","cssurl","pluginLoadable","pluginLoadedOrLoading","disabled","obj","getPluginDOM","plugid","a","cl","cbox","checked","clab","addEventListener","togglePlugin","redraw","unloadPlugin","drawPlugins","num","getAsDOM","dm","clh","showPlugins","Datatables","res","bindings","WOQLResultsViewer","wresult","settings","pman","count","hasBindings","showTable","show_table","orderColumns","sample","ordered","unshift","resultDOM","displayResultHeader","rs","rh","getTableDOM","dtResult","getTable","tab","draw","formatResultsForDatatableDisplay","columns","colDataData","formattedResult","ordered_headings","validURL","labelFromURL","j","lab","getDocumentLocalLink","recordsTotal","getTableBody","tbody","tr","td","showDocument","dtPlugin","thead","thr","th","HTMLFrameHelper","control","callback","dpropDOM","button","selected","sel","renderer","viewsDOM","setMode","getActionControl","isNew","cancel","location","href","loc","split","sh","getShorthand","bits","htmlid","prop","help","input","infoDOM","linfo","lspacer","lval","PropertyViewer","ObjectViewer","HTMLStringViewer","HTMLStringEditor","HTMLBooleanViewer","HTMLBooleanEditor","HTMLChoiceViewer","HTMLChoiceEditor","HTMLCoordinateViewer","HTMLCoordinateEditor","HTMLDateViewer","HTMLDateEditor","HTMLEntityViewer","HTMLEntityEditor","HTMLImageViewer","HTMLImageEditor","HTMLLinkViewer","HTMLNumberViewer","HTMLRangeViewer","HTMLRangeEditor","SantizedHTMLViewer","RenderingMap","registeredDataViewers","registeredDataEditors","registeredPropertyViewers","registeredPropertyEditors","registeredObjectViewers","registeredObjectEditors","getValidDataViewerList","frametype","valids","concat","getValidDataEditorList","nftypes","getValidPropertyViewerList","proptype","proprange","propdom","getValidPropertyEditorList","getViewer","vi","renderers","viewer","eval","e","alert","toString","getAvailablePropertyViewers","viewers","nviewers","sets","getAvailablePropertyEditors","getAvailableDataViewers","getAvailableDataEditors","getViewerForDataFrame","vals","getEditorForDataFrame","registerViewerForTypes","types","registerEditorForTypes","registerEditorForFrameType","registerViewerForFrameType","registerViewerForProperties","properties","registerEditorForProperties","HTMLPropertyViewer","patternMatchesRenderer","pattern","FramePattern","checkRenderer","JSONObjectViewer","HTMLObjectViewer","getEditorForObject","getViewerForObject","getAvailableObjectViewers","decorateRenderer","compiled_options","compileOptions","parent","facets","getDefaultFacets","facet","deffacet","getDefaultFacet","hide_disabled_buttons","features","controls","viewerType","viewerOptions","header","header_viewer","HTMLObjectHeaderViewer","filter","sort","rules","output","frame_type","subject","subjectClass","range","children","depth","index","status","rtype","getRendererType","illegalRuleType","checkFrameType","checkLabel","checkSubject","checkSubjectClass","checkProperty","checkDepth","checkRange","checkValue","checkParent","checkChildren","checkIndex","checkStatus","rsubj","IDsMatch","found","values","isUpdated","numberMatch","propertyIDsMatch","valuesMatch","rangeIDsMatch","rcls","classIDsMatch","frame","ftype","renderder","getLabel","stringMatch","ida","idb","compareIDs","vala","valb","RegExp","test","constructor","TerminusClassChooser","choice","show_single","setRoot","root","setFilter","change","cls","ccdom","ccsel","wq","getResultsAsOptions","clist","choices","empty_choice","opt1","added","bclass","getVariableValueFromBinding","headerViewer","getPropertyHeaderViewer","HTMLPropertyHeaderViewer","render","block","propDOM","npropDOM","getPropertyDOM","replaceWith","getPropertyIDMarker","getPropertyBodyDOM","orientation","getContentOrientation","pcls","sp","vholder","addRenderedValue","renderedval","clear","redrawHeader","nheader","redrawBody","nbody","idm","subj","goTo","goToName","objDOM","wrapper","showFeature","expModeMenu","getPropertyControlsDOM","sumDOM","getPropertyLabelDOM","statDOM","getPropertyStatusDOM","prepend","getPropertySummaryDOM","prelude","currentFacet","facetDOM","getPropertyFacetDOM","viewDOM","getViewValueDOM","idDOM","getPropertyIDDOM","typeDOM","getPropertyRangeDOM","hasCardinalityRestriction","hideDOM","getPropertyCardinalityDOM","getPropertyCommentDOM","viewables","getAvailableFacets","mpropDOM","getSelectionControl","val","setFacet","getInfoboxDOM","sum","getSummary","getComment","restriction","getRestriction","min","max","getActionControlDOM","settingsDOM","getModeSelectorDOM","getPropertyDeleteDOM","addDOM","isClassChoice","getAddValueDOM","rpropDOM","getPropertyResetDOM","upropDOM","getPropertyUpdateDOM","showDOM","getPropertyShowDOM","getPropertyHideDOM","getViewerSelectorDOM","getSettingsControlDOM","controlsDOM","sControl","getSettingsControl","menu","srcElement","textContent","innerText","nodeName","cardControlAllows","cs","getAvailableClassChoices","addClass","getViewableValues","goToValue","hide","reset","show","save","getAvailableViewers","currentViewer","setViewer","showValue","size","getDOM","dataviewer","ObjectRenderer","TerminusDocumentViewer","db","editor","load_schema","config_options","getBuiltInViewerOptions","classmeta","instancemeta","Class","refreshPage","elid","getClassMeta","loadCreateDocument","showBusy","page_config","loadDocumentSchema","clearBusy","setLabel","error","showError","loadDocument","getDocument","loadDataFrames","getClassFrame","loadSchemaFrames","deleteDocument","URL","createDocument","extr","extract","updateDocument","durl","subjid","dataframes","domain","ObjectFrame","classframes","loadClassFrames","newDoc","fillFromSchema","getOptionsFromPageConfig","controller","FrameConfig","pageconf","getClient","docid","labdom","dfs","getDataFrames","getStdURL","pagedom","rends","holder","controldom","getDocumentPageControls","dpc","UTILS","convertToDatatable","table","DataTable","searching","pageLength","lengthMenu","paging","columnDefs","targets","createdRow","row","$","find","attr","html","on","cell","column","showDBMainPage","dbInfo","parents","dbId","deleteDatabase","executeQuery","dcb","dt","pageInfo","wquery","rtab","getDataFromServer","err","getQueryOnPagination","sqp","chosenValue","generateNewQueryOnPageChange","qTextDom","getCallbackSettings","len","setUp","dtdom","processing","buttons","colReorder","addFixed","liveDrag","scrollX","drawCallback","info","page","serverside","HTMLDateHelper","months","getMonthName","TerminusDocumentChooser","show_button","getS2DOM","getIDDOM","docchooser","cfilter","termcc","new_class","tdom","s2config","ajax","dataType","params","contentType","delay","cache","placeholder","width","dcip","keyCode","dbut","toggleView","getChangeViewText","TerminusUI","TerminusConfig","pconfig","messages","explorer","nlocation","ApiExplorer","TerminusDBsdk","TerminusViolations","TerminusQueryViewer","TerminusMappingViewer","TerminusSchemaViewer","TerminusServersdk","TerminusURLLoader","WOQLClient","setOptions","connect","getDBRecord","connectToDB","showView","schema","showSchemaPage","showQueryPage","showExplorer","showServerMainPage","createDatabase","dbdets","Promise","reject","getBadArguments","myserver","dbdoc","generateNewDatabaseDocument","getSchema","updateSchema","refreshDBList","crec","connection","getCrashString","showMessage","delrec","lid","dbn","removeDB","dets","doc","rdfs","terminus","fname","load","getConnectionEndpoint","clearServer","clearDB","removeDBFromConnection","TerminusServerViewer","redrawMainPage","showLoadURLPage","TerminusDBViewer","showCreateDBPage","TerminusDBCreator","showMappingPage","mapping","getDocViewerOptions","showCreateDocument","getDocCreatorOptions","main","showResult","clearMessages","clearMainPage","setMessageDOM","setbuttonControls","setControllerDOM","setExplorerDOM","setPluginsDOM","setViewerDOM","comps","slocation","drawControls","toggleControl","toggleDashboardWidget","widget","drawExplorer","loadControls","ncontrol","nd","exp","ae","sc","TerminusServerController","TerminusDBController","show_controls","pseudoCapability","capabilitiesPermit","show_views","busy","getBusyLoader","bsyDom","pd","pbc","pbsa","pbia","md","msgHolder","showViolations","vios","nvios","cmsg","views","document_options","schema_options","piman","getClassFrameOptions","viewdoc_options","apiNavConfig","mainNav","navText","defaultSelected","database","subNav","getClassFrames","viewDocument","update","use_fetch","return_full_response","aec","getApiNav","getApiExplorerDom","setSelectedNavMenu","setSelectedSubMenu","navOnSelect","createNavs","navConfig","ul","navDom","cont","api","apiCont","getConnectExplorer","getDatabaseExplorer","getSchemaApi","getDocumentApi","getQueryApi","changeSubApiDom","curSubMenu","getDatabaseDom","getShowApiDom","getQueryApiDom","subNavOnSelect","subMenuConfig","createSubNavs","b","getSignature","getForm","getServerForm","form","fd","inpLabel","cd","inpId","keyLabel","resd","gatherips","curApi","urlPlaceholder","formDoc","urlLabel","inpUrl","docUrlLabel","inpDocUrl","encLabel","inpEnc","optTurt","optJld","inpKey","docLabel","inpDoc","inp","docUrl","enc","getApiSendButton","getApiForm","schurl","buttonSelf","connected_mode","gtxtar","txtar","dcurl","schemaUrlDom","payload","htmlEditor","getValue","sg","ic","sig","config","textdom","darkMode","jsonldCheck","fromTextArea","firstLineNumber","lineNumbers","styleActiveLine","lineWrapping","smartIndent","indentWithTabs","newlineAndIndent","autoCloseBrackets","matchBrackets","afterCursor","extraKeys","refresh","setCodemirrorSize","defaultCharWidth","setOption","setSize","setTimeout","runMode","theme","prefix","node","hasChildNodes","childNodes","Math","random","Date","getTime","link","full","unshorten","sha","shb","nurl","urlFragment","charAt","toUpperCase","slice","stype","ext","viewIncludesProperties","parts","join","ty","parsed","parseXsdDate","parseXsdDateTime","year","month","day","tz","extractXsdTimezone","abs","toNumber","timezone","nparsed","hour","minute","second","xparsed","addXsdPadding","ret","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","convertTimestampToXsd","datetime","ptime","paseXsdTime","dividor","scriptid","src","existingScript","script","onload","rel","ValueRenderer","PropertyRenderer","predicate","cframe","objframe","getPropertyClassFrame","originalValues","changed","originalProperties","newProperties","getOptionsForChild","getOptionsForValue","df","getOptionsForObject","buildValueRenderers","getViewerForProperty","adorig","isData","getDataFramesToRender","vr","kids","getChildrenToRender","kidf","viewIncludesChildren","allkids","getChildren","extracts","updated","childUpdated","hasRestriction","cf","getClassChoices","clsmeta","Label","deleteProperty","addProperty","setNew","addPropertyClass","newb","nvals","deletePropertyValue","removePropertyValue","addPropertyValue","rest","currentnum","new_property","hideDisabledControls","hide_disabled_controls","nocascade","parentFacetChange","multiline","line","summary","containsPage","isObject","setView","nukeViewer","ptype","getEditorForProperty","valcount","vsum","getFeaturesForFacet","getOptionsForProperty","buildPropertyRenderers","renderedprop","addRenderedProperty","props","getPropertiesToRender","renders","parentObject","copy","nkid","clone","genBNID","parentobj","newrend","isNewDocument","demandid","inputID","dval","nprops","removeProperty","addNewProperty","goToProperty","changeClass","ctl","getController","new_object","isPartOfNewDocument","isnew","keys","pfacet","vrend","propcount","getObjectHeaderViewer","nviewer","getViewableProperties","getFilledPropertyList","getAddableProperties","getMissingPropertyList","standardSort","map","patterns","matchesPattern","sorted","rdft","rdfc","extractLDO","extractJSONLD","jsonld_context","extracted","empty","HTMLDataViewer","dataframe","originalValue","isDocument","nf","nvr","inline","getAPIURL","DBURL","getEntityReference","entities","badData","bd","new_value","text_summary_length","set","v","nrend","getViewerForValue","isDatatypeProperty","objlit","isString","lang","getValueHeaderViewer","HTMLDataHeaderViewer","getDataValueViewer","getViewerForDataValue","getTypeShorthand","ft","renderedDOM","getObjectDOM","getObjectIDMarker","getObjectBodyDOM","getFeatureDOM","feature","hasFeatureViewer","featureViewer","getObjectFacetDOM","getObjectLabelDOM","getObjectIDDOM","getObjectTypeDOM","getObjectStatusDOM","getViewPropertyDOM","getAddPropertyDOM","getObjectControlsDOM","getObjectSummaryDOM","getObjectDeleteDOM","cpropDOM","getObjectCloneDOM","getObjectResetDOM","getObjectUpdateDOM","getObjectShowDOM","getObjectHideDOM","mlabDOM","cmt","Comment","addables","big","isBigType","getTypeSize","vallab","els","elements","foptions","getChoiceOptions","inputs","parse","lldom","getInputDOMs","lat","long","latdom","longdom","getLatLongDOM","firstcol","delbut","updateValueFromForm","op","lldoms","butspan","addbut","ipdoms","DateHelper","allowbce","date_spacer","time_spacer","datetime_separator","helper","parseDate","datepart","getDateComponentDOM","timepart","getTimeComponentDOM","hdom","mdom","mlab","sdom","slab","dadom","ydom","ddom","part","xsd","xsdFromParsed","opdom","getEntityViewHTML","internalLink","getEntityLabel","dv","nspan","InstanceLabel","tit","InstanceType","InstanceComment","img","commas","numberWithCommas","delimiter","parseRangeValue","rvals","svals","x","tnode","getRangeSymbolDOM","x2","t2node","data1","data2","firstip","secondip","showing_range","but","changeHandler","valDOM","nvalDOM","getValueDOM","getValueIDMarker","getValueBodyDOM","vdom","getSummaryDOM","HTMLTerminusClient","onclick","preventDefault","onClick","getValueFacetDOM","getValueTypeDOM","getValueStatusDOM","getValueControlsDOM","getValueDeleteDOM","getValueCloneDOM","getValueResetDOM","getValueUpdateDOM","getValueShowDOM","getValueHideDOM","dbc","scd","dbrec","nm","item","getControlHTML","displayDocumentSubMenus","getDocumentChooserDOM","getDocumentCreatorDOM","showSubMenus","gd","nbut","mcls","d2ch","nlab","click","nbuts","tcdom","gb","bi","bt","nlabs","ccDOM","sth","banner","dhp","scs","getDeleteOnHomePage","getDBSummary","getClassesDOM","getDbInfoBox","del","q","sct","mfd","sci","idip","titip","descip","schem","datip","butfield","cancbut","loadbut","TerminusViolation","vio","context_msg","getPropertyAsDOM","pdom","ldom","WOQLTextboxGenerator","WOQLGraphBrowserGenerator","meta","generator","gentype","generators","gbrowse","loadGenerator","hasGeneratorOptions","changeGenerator","ng","redrawGenerator","inputDOM","getQueryButtonsDOM","nquery","Element","getResultViewDom","qbox","getQueryCreatorChoiceDOM","qtHolder","qTextBox","getQueryTextAreaDOM","buttonsDOM","qcc","gen","box","TerminusPropertyChooser","tq","qman","datatable","gatherDatatableSettings","txtArea","queryName","getQueryButtonGroups","qGroupQueries","qrow","g","qeb","ch","setDatatableSettings","eqh","qbut","qval","qbuts","qexs","qh","qcGroup","nqbut","aqbut","qvalue","ebut","pbut","prbut","qdGroup","termpc","qdocGroup","docch","docdom","d2dom","clGroup","dtGroup","docGroup","cprop","Property","WOQLTimePicker","DCOGBrowser","model","myowner","default_viewport","current_viewport","viewports","viewportDOMs","browserid","randomString","query_timeslice","current_result","focus_node","show_filter","entity_count","default_display","icon_unicode","color","forward","backward","getSliderDOM","DCOGQueryFilter","DCOGTimePicker","getViewportAsDOM","vpdom","newQuery","success","getQuery","setBusy","untell","DCOGQueryResult","containsData","setViewportData","getNodeOrFringe","from_node","nodeCount","fillInfoBoxes","nodeSelected","rebuildController","tellUser","moreResults","nfocus","addMoreResults","updateViewportData","showBusyOverlay","insert_patterns","browser","dqr","qstruct","to_node","source_node","target_node","current_relationships","relationships","current_depth","max_path_length","current_threshold","filters","shareholding_threshold","server_side","timeslice","date","wake","initData","qstr","groupID","initDOM","setData","updateData","setViewportFilter","sections","getNodeInfoSections","followNode","setFocusNode","setPathSearch","node_from","node_to","changeTimeSlice","valto","force","isTemporalSuperset","setFilterTimeslice","setQueryTimeslice","getTimeslice","getControllerAsDOM","cdom","getControllerViewButtonsAsDOM","toolboxDOM","getUserToolboxDOM","filterDOM","legendDOM","getControllerFilterAsDOM","fdom","getRelationshipFilterAsDOM","ndom","getQueryParameterDOM","ipfield","getSliderTypeDOM","gobut","toggleFilterVisibility","getLegendAsDOM","userMessageDOM","msgdom","dlc","bdoms","bdom","legend","getNodeRelativeSize","nconf","getNodeDisplaySettings","getLineWidth","getModelElementDisplaySettings","elt","modeldisplay","extend","isBidirectional","edge","typeID","conf","getRelationshipClass","nick","getGraphElementDisplaySettings","nds","getLinkDisplaySettings","getElementIcon","getClassIcon","getElementIconUnicode","getElementColour","setUpIPGSpecials","reldisptypes","entdisptypes","rid","disptype","eid","slidertype","from","to","ss","years","toggleServerSideFiltering","getSliderParameters","end","pointInit","slide","event","tt","tickToTime","rangeInit","val2","noshow","showCurrentPick","ticknum","nval","seconds_ago","timeToTick","timeval","y","thisy","changeSliderType","ntype","updateSliderDOM","dcd","cb","lb","slideDOM","TopAxisDOM","curdate","cursdate","curedate","LabelDOM","PayloadDOM","L2DOM","getSliderAxisDOM","sconfig","getTimesliceAsTicks","vtf","vtt","fy","adjustOffset","tval","tick","unit","offsetWidth","off","sd","Y2Time","tsel","o1","o2","ff","getFormFieldDOM","getFormField","queries","submit","jsonip","map_source","map_target","confirm_before_update","loadSchema","msgtype","resetControlDOM","getSchemaSaveButtons","getSchemaImportActionButtons","getShowSchemaButton","getClassFrameChooser","getSchemaEditButton","getImportButton","getFormatChoices","fc","tc","tj","refreshMainPage","getSchemaViewDOM","getSchemaEditDOM","getSchemaImportDOM","getClassFrameDOM","ssb","getCancelButton","getSaveButton","getImportSaveButton","getSchemaButton","getImportPreviewButton","doImport","schema_edit_dom","func","newschema","appendSchema","showConfirmPage","s2","nschema","np","docviewer","ipval","klab","modes","overwrite","append","rsc","getServerLabelDOM","srec","getServerRecord","desc","csbut","crbut","getDBListDOM","getServerDetailsDOM","scl","wrapTableLinkCell","sec","lihed","th1","th2","th3","th4","th5","th6","dbrecs","getServerDBRecords","fullid","td1","td2","td3","td4","td5","td6","deleteDBPermitted","delDB","url_input","key_input","getLabelDOM","ip","ltxt","pholder","stit","loadbuts"],"mappings":"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","file":"terminus-dashboard.min.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 13);\n","/**\r\n * @file Javascript Api explorer tool\r\n * @author Kitty Jose\r\n * @license Copyright 2018-2019 Data Chemist Limited, All Rights Reserved. See LICENSE file for more\r\n *\r\n * @summary Set of functions used across scripts\r\n */\r\nconst Codemirror= require('./plugins/codemirror.terminus');\r\n// function to read Files\r\nfunction readFile(file){\r\n  if (window.XMLHttpRequest){\r\n    // code for IE7+, Firefox, Chrome, Opera, Safari\r\n    xmlhttp=new XMLHttpRequest();\r\n  }\r\n  else{\r\n    // code for IE6, IE5\r\n    xmlhttp=new ActiveXObject(\"Microsoft.XMLHTTP\");\r\n  }\r\n  xmlhttp.open(\"GET\",file,false);\r\n  xmlhttp.send();\r\n  xmlDoc=xmlhttp.responseText;\r\n  return xmlDoc;\r\n} // readFile()\r\n\r\n// function to write api call signatures from woql client\r\nfunction getFunctionSignature(which){\r\n  var sigs = {};\r\n  sigs.connect = {\r\n    spec   : \"WOQLClient.connect(server_url, key)\",\r\n    descr  : \"\\n\\nConnect to a Terminus server at the given URI with an API key\"\r\n                + \"Stores the terminus:ServerCapability document returned in the connection register\"\r\n                + \"which stores, the url, key, capabilities, and database meta-data for the connected server\"\r\n                + \"If the curl argument is false or null, the this.server will be used if present,\"\r\n                + \" or the promise will be rejected.\",\r\n    result : \"HTTP 200 on success, 409 for already existing database, otherwise error code\",\r\n    args   : {server_url : 'url', key: 'Api key'},\r\n    options: { title: \"\", description: \"\" }\r\n  };\r\n  sigs.create = {\r\n    spec    : \"WOQLClient.createDatabase(database_url, details, key)\",\r\n    descr   : \"\\n\\nCreate a Terminus Database by posting a terminus:\"\r\n                + \"The dburl argument can be \\n1) a valid URL of a terminus database or \\n2) a valid Terminus \"\r\n                + \"database id or \\n3) can be omitted\"\r\n                + \"\\nin case 2) the current server will be used, \"\r\n    \t\t        + \"\\nin case 3) the database id will be set from the @id field of the terminuse:Database document.\"\r\n                + \"\\nThe second (details) argument contains a \\nterminus:Database document with a mandatory \"\r\n                + \"\\nrdfs:label field and an optional rdfs:comment field.\"\r\n                +  \"\\nThe third (key) argument contains an optional API key \",\r\n    result : \"HTTP 200 on success, 409 for already existing database, otherwise error code\",\r\n    args   : {database_url : 'url', details: '', key: ' Api key'},\r\n    options: { title: \"\", description: \"\" }\r\n  };\r\n  sigs.delete = {\r\n      spec  : \"WOQLClient.deleteDatabase(database_url, options)\",\r\n      descr : \"\\n\\nDeletes a Database\"\r\n                + \"\\nThe first (dburl) argument can \\n1) a valid URL of a terminus database or \\n2) a valid database id\"\r\n                + \" or \\n3) ommitted in case \\n2) the current server will be used, and in case \\n3) the current server \"\r\n                + \"and database will be used. \\nThe second argument (opts) is an options json - no options are\"\r\n                + \" currently supported for this function\",\r\n      result: \"HTTP 200 on success, otherwise error code\",\r\n  };\r\n  sigs.getSchema = {\r\n    spec   : \"WOQLClient.getSchema(schema_url, options)\",\r\n    descr  : \"\\n\\nGets the schema of a database. \\nThe first (schurl) argument can be \"\r\n              + \"\\n1) a valid URL of a terminus database or \\n2) a valid database id or \"\r\n              + \"\\n3) omitted, \\nin case 2) the current server will be used, and \\nin case 3) the current server and\"\r\n              + \"database will be used the second argument (opts) is an options json - \"\r\n              + \"\\nopts.format is optional and defines which format is requested (*json / turtle)\"\r\n              + \"\\nopts.key is an optional API key\",\r\n    result : \"Ontology Document on success (HTTP 200), 409 for already existing database, otherwise error code\",\r\n    options: { format: \"turtle\" }\r\n  };\r\n  sigs.getClassFrames = {\r\n    spec   : \"WOQLClient.getClassFrame = function(cfurl, cls, opts)\",\r\n    descr  : \"\\n\\nRetrieves a WOQL query on the specified database which updates the state and returns the results\"\r\n              +  \"\\nThe first (cfurl) argument can be\"\r\n              + \"\\n1) a valid URL of a terminus database or\"\r\n              +  \"\\n2) omitted - the current database will be used\"\r\n              +  \"\\nthe second argument (cls) is the URL / ID of a document class that exists in the database schema\"\r\n              +  \"\\nthe third argument (opts) is an options json - opts.key is an optional API key\",\r\n    result : \"Ontology Document on success (HTTP 200), 409 for already existing database, otherwise error code\",\r\n    options: { format: \"turtle\" }\r\n  };\r\n  sigs.updateSchema = {\r\n    spec    : \"WOQLClient.updateSchema(schema_url, docs, options)\",\r\n    descr   : \"\\n\\nUpdates the Schema of the specified database\"\r\n              + \"\\nThe first (schurl) argument can be \\n1) a valid URL of a terminus database or \\n2)\"\r\n              + \" a valid database id or \\n3) omitted, \\nin case 2) the current server will be used,\"\r\n              + \" and \\nin case 3) the current server and database will be used\"\r\n              + \"\\nThe second argument (doc) is a valid owl ontology in json-ld or turtle format\"\r\n              + \"\\nthe third argument (opts) is an options json - \"\r\n     \t\t      + \"opts.format is used to specify which format is being used (*json / turtle)\"\r\n     \t\t      + \"opts.key is an optional API key\",\r\n    result : \"Ontology Document on success (HTTP 200), 409 for already existing database, otherwise error code\",\r\n    args   : {document : 'doc'},\r\n    options: { format: \"turtle\", editmode: \"replace\"}\r\n  };\r\n  sigs.createDocument = {\r\n    spec   : \"WOQLClient.createDocument(document_url, document, options)\",\r\n    descr  : \"\\n\\nCreates a new document in the specified database\"\r\n              + \"\\nThe first (docurl) argument can be\"\r\n              + \"\\n1) a valid URL of a terminus database (an id will be randomly assigned) or\"\r\n              + \"\\n2) a valid URL or of a terminus document (the document will be given the passed URL) or\"\r\n              + \"\\n3) a valid terminus document id (the current server and database will be used)\"\r\n              + \"\\n4) can be ommitted (the URL will be taken from the document if present)\"\r\n              + \"\\nThe second argument (doc) is a valid document in json-ld\"\r\n              + \"\\nthe third argument (opts) is an options json - opts.key is an optional API key\",\r\n    result : \"Created Document on success (HTTP 200), Violation Report Otherwise (HTTP 400+)\",\r\n    args   : {document_url : 'url', document: \"doc\"},\r\n    options: { format: \"turtle\", fail_on_id_denied: false}\r\n  };\r\n  sigs.viewDocument = {\r\n    spec    : \"WOQLClient.getDocument(document_url, options)\",\r\n    descr   : \"\\n\\nRetrieves a document from the specified database\"\r\n              + \"\\nThe first (docurl) argument can be\"\r\n              + \"\\n1) a valid URL of a terminus document or\"\r\n              + \"\\n2) a valid ID of a terminus document in the current database\"\r\n              + \"\\nthe second argument (opts) is an options json - \"\r\n              + \"\\nopts.key is an optional API key\"\r\n              + \"\\nopts.shape is frame | *document \",\r\n    result : \"Document (HTTP 200), Violation Report Otherwise (HTTP 400+)\",\r\n    args   : {document_url : 'url'},\r\n    options: { format: \"turtle\"}\r\n  };\r\n  sigs.updateDocument = {\r\n    spec   : \"WOQLClient.updateDocument(document_url, document, options)\",\r\n    descr  : \"\\n\\nUpdates a document in the specified database with a new version\"\r\n              + \"\\nThe first (docurl) argument can be\"\r\n              + \"\\n1) a valid URL of a terminus document or \"\r\n              + \"\\n2) a valid ID of a terminus document in the current database or\"\r\n              + \"\\n3) ommitted in which case the id will be taken from the document @id field\"\r\n              + \"\\nthe second argument (doc) is a document in json-ld format\"\r\n              + \"\\nthe third argument (opts) is an options json - opts.key is an optional API key\",\r\n    result : \"Ontology Document on success (HTTP 200), 409 for already existing database, otherwise error code\",\r\n    args   : {document_url : 'url', document: \"doc\"},\r\n    options: { format: \"turtle\", editmode: \"replace\"}\r\n  };\r\n  sigs.deleteDocument = {\r\n    spec  : \"WOQLClient.deleteDocument(document_url, options)\",\r\n    descr : \"\\n\\nDeletes a document from the specified database\"\r\n            + \"\\nThe first (docurl) argument can be\"\r\n            + \"\\n1) a valid URL of a terminus document or\"\r\n            + \"\\n2) a valid ID of a terminus document in the current database\"\r\n            + \"\\n3) omitted - the current document will be used\"\r\n            + \"\\nthe second argument (opts) is an options json - opts.key is an optional API key\",\r\n    result: \"Ontology Document on success (HTTP 200), 409 for already existing database, otherwise error code\",\r\n    args  : {document_url : 'url'},\r\n  };\r\n  sigs.select = {\r\n    spec: \"WOQLClient.select(database_url, woql, options)\",\r\n    descr: \"\\n\\nExecutes a read-only WOQL query on the specified database and returns the results\"\r\n              + \"\\nThe first (qurl) argument can be \"\r\n              + \"\\n1) a valid URL of a terminus database or \"\r\n              + \"\\n2) omitted - the current database will be used \"\r\n              + \"\\nthe second argument (woql) is a woql select statement encoded as a string\"\r\n              + \"\\nthe third argument (opts) is an options json - opts.key is an optional API key\",\r\n    result: \"WOQL Result (HTTP 200), otherwise error code\",\r\n    args: {woql: 'woql'},\r\n  };\r\n  sigs.update = {\r\n    spec  : \"WOQLClient.update(database_url, woql, options)\",\r\n    descr : \"\\n\\nExecutes a WOQL query on the specified database which updates the state and returns the results\"\r\n            + \"\\nThe first (qurl) argument can be \"\r\n            + \"\\n1) a valid URL of a terminus database or \"\r\n            + \"\\n2) omitted - the current database will be used \"\r\n            + \"\\nthe second argument (woql) is a woql select statement encoded as a string\"\r\n            + \"\\nthe third argument (opts) is an options json - opts.key is an optional API key\",\r\n    result: \"WOQL Result (HTTP 200), otherwise error code\",\r\n    args  : {woql: 'woql'},\r\n  };\r\n  sigs.lookup = {\r\n    spec: \"WOQLClient.lookup(database_url, woql, options)\",\r\n    result: \"WOQL Result (HTTP 200), otherwise error code\",\r\n    args: {class: 'url', term: 'string'},\r\n  };\r\n  sigs.map = {\r\n    spec: \"WOQLClient.lookup(source, target, woql, options)\",\r\n    result: \"WOQL Result (HTTP 200), otherwise error code\",\r\n    args: {source: 'json', target: \"json\", woql: 'json'},\r\n  };\r\n  sigs.getClassFrame = {\r\n    spec: \"WOQLClient.getClassFrame(class, options)\",\r\n    result: \"WOQL Result (HTTP 200), otherwise error code\",\r\n    args: {class: 'url'},\r\n  };\r\n  sigs.getPropertyFrame = {\r\n    spec: \"WOQLClient.getPropertyFrame(class, property, options)\",\r\n    result: \"WOQL Result (HTTP 200), otherwise error code\",\r\n    args: {class: 'url', property: 'url'},\r\n  };\r\n  sigs.getFilledPropertyFrame = {\r\n    spec: \"WOQLClient.getPropertyFrame(document_url, property, options)\",\r\n    result: \"WOQL Result (HTTP 200), otherwise error code\",\r\n    args: {document_url: 'url', property: 'url'},\r\n  };\r\n  sigs.getSubClasses = {\r\n    spec: \"WOQLClient.getSubClasses(class, options)\",\r\n    result: \"WOQL Result (HTTP 200), otherwise error code\",\r\n    args: {class: 'url'},\r\n  };\r\n  return sigs[which];\r\n}//getFunctionSignature\r\n\r\n// returns dom element for header text\r\nfunction getHeaderDom(text){\r\n  var hd = document.createElement('div');\r\n  hd.setAttribute('class', 'terminus-module-head');\r\n  var h = document.createElement('h3');\r\n  h.innerHTML = text;\r\n  hd.appendChild(h);\r\n  return hd;\r\n} // getHeaderTextDom\r\n\r\n// returns dom for alert banner\r\nfunction getInfoAlertDom(type, label, msg){\r\n  var ald = document.createElement('div');\r\n  if(type == 'info') ald.setAttribute('class', 'terminus-alert terminus-alert-success');\r\n  else ald.setAttribute('class', 'alert');\r\n  var str = document.createElement('STRONG');\r\n  str.innerHTML = label;\r\n  ald.appendChild(str);\r\n  var txt = document.createTextNode(msg);\r\n  ald.appendChild(txt);\r\n  return ald;\r\n} // getInfoAlertDom()\r\n\r\n// formats response results from platform\r\nfunction getResponse(currForm, action, response, terminator){\r\n\r\n  var rd = document.createElement('div');\r\n\r\n  // get header result\r\n  rd.appendChild(getHeaderDom('Result'));\r\n  var br = document.createElement('BR');\r\n  rd.appendChild(br);\r\n\r\n  var data = JSON.stringify(response, 0, 4);\r\n\r\n  var pre = document.createElement('pre');\r\n  pre.setAttribute('class', 'terminus-api-view terminus-scheme-pre');\r\n  pre.innerHTML = data;\r\n\r\n  var cm = stylizeCodeDisplay(terminator, pre, rd, 'javascript');\r\n  if(!cm) rd.appendChild(pre);\r\n\r\n  var br = document.createElement('BR');\r\n  rd.appendChild(br);\r\n\r\n  currForm.appendChild(rd);\r\n\r\n  return currForm;\r\n}\r\n\r\n// formats the response from fetch call and spits out Http header and result\r\nfunction showHttpResult(response, action, currForm, terminator){\r\n    //var currForm = document.createElement('div');\r\n\r\n    var br = document.createElement('BR');\r\n    currForm.appendChild(br);\r\n    var br = document.createElement('BR');\r\n    currForm.appendChild(br);\r\n\r\n    // get header result\r\n    currForm.appendChild(getHeaderDom('HTTP Header'));\r\n\r\n    var br = document.createElement('BR');\r\n    currForm.appendChild(br);\r\n\r\n     var retHttpHeaders  = '';\r\n\r\n     // iterate over all headers\r\n     for (let [key, value] of response.headers) {\r\n       retHttpHeaders = retHttpHeaders +  `${key} = ${value}` + '\\n';\r\n     }\r\n\r\n    // http header result\r\n    var hdres = document.createElement('pre');\r\n    hdres.setAttribute('class', 'terminus-api-signature-pre');\r\n    var txt = document.createTextNode(retHttpHeaders);\r\n    hdres.appendChild(txt);\r\n\r\n    var cm = stylizeCodeDisplay(terminator, hdres, currForm, 'message/http');\r\n    if(!cm) currForm.appendChild(hdres);\r\n\r\n    return response.json()\r\n    .then(function(response){\r\n      getResponse(currForm, action, response, terminator); // get return response\r\n    })\r\n\r\n} // UTILS.showHttpResult()\r\n\r\n\r\nfunction deleteStylizedEditor(ui, qip){\r\n    if(ui.pluginAvailable(\"codemirror\")){\r\n\t\tvar cm = qip.nextElementSibling;\r\n\t\tcm.setAttribute('class', 'terminus-hide');\r\n\t\tTerminusClient.FrameHelper.removeChildren(cm);\r\n\t}\r\n}\r\n\r\n/* ui: terminus ui reference\r\n   txt: text area to be stylized\r\n   view: defines the size of editor to appear in pages (schema/ query)\r\n   mode: format to be displayed in\r\n*/\r\nfunction stylizeEditor(ui, txt, view, mode){\r\n    var cmConfig = ui.pluginAvailable(\"codemirror\");\r\n    if(!(cmConfig)) return;\r\n\tvar cm = new Codemirror(txt, mode, cmConfig);\r\n\tvar ar = cm.colorizeTextArea(view);\r\n\tcm.updateTextArea(ar);\r\n}\r\n\r\n/* ui: terminus ui reference\r\n   txt: text area to be stylized\r\n   dom: stylized pre area is appended to dom\r\n   mode: format to be displayed in\r\n*/\r\nfunction stylizeCodeDisplay(ui, txt, dom, mode){\r\n    var cmConfig = ui.pluginAvailable(\"codemirror\");\r\n    if(!(cmConfig)) return false;\r\n    var cm = new Codemirror(txt, mode, cmConfig);\r\n    var pr = cm.colorizePre();\r\n    dom.appendChild(pr);\r\n    return true;\r\n}\r\n\r\n/* name: classname to find and remove classes from elements\r\n*/\r\nfunction removeSelectedNavClass(name){\r\n    var el = document.getElementsByClassName(name);\r\n    for(var i=0; i<el.length; i++){\r\n        el[i].classList.remove(name);\r\n    }\r\n}\r\n\r\n// toggles between contents\r\nfunction tolggleContent(icon, content){\r\n    if (content.style.display === \"block\"){\r\n        removeSelectedNavClass(\"fa-chevron-up\");\r\n        icon.classList.add(\"fa-chevron-down\");\r\n        content.style.display = \"none\";\r\n    }\r\n    else{\r\n        removeSelectedNavClass(\"fa-chevron-down\");\r\n        icon.classList.add(\"fa-chevron-up\");\r\n        content.style.display = \"block\";\r\n    }\r\n}\r\n\r\n// controls current selected nav bar\r\nfunction activateSelectedNav(nav, terminator){\r\n    removeSelectedNavClass(\"terminus-selected\");\r\n\tcheckDocumentSubMenus(terminator);\r\n\tnav.classList.add(\"terminus-selected\");\r\n}\r\n\r\nfunction hideDocumentSubMenus(el){\r\n\tif(el.classList.contains('terminus-display')){\r\n\t\tel.classList.remove('terminus-display');\r\n\t\tel.classList.add('terminus-hide');\r\n\t}\r\n}\r\n\r\nfunction checkDocumentSubMenus(terminator){\r\n\tif(terminator.ui.showControl(\"get_document\")) {\r\n\t\tvar gd = document.getElementsByClassName('terminus-get-doc');\r\n\t\thideDocumentSubMenus(gd[0]);\r\n\t}\r\n\tif(terminator.ui.showControl(\"create_document\")) {\r\n\t\tvar cd = document.getElementsByClassName('terminus-create-doc');\r\n\t\thideDocumentSubMenus(cd[0]);\r\n\t}\r\n}\r\n\r\nfunction toggleVisibility(el){\r\n\tif(el.classList.contains('terminus-display')){\r\n\t\tel.classList.remove('terminus-display');\r\n\t\tel.classList.add('terminus-hide');\r\n\t}\r\n    else if(el.classList.contains('terminus-hide')){\r\n        el.classList.remove('terminus-hide');\r\n\t\tel.classList.add('terminus-display');\r\n\t}\r\n}\r\n\r\nfunction extractValueFromCell(cellValue){\r\n    var ihtml = new DOMParser().parseFromString(cellValue, \"text/xml\");\r\n    return ihtml.firstChild.innerHTML;\r\n}\r\n\r\nmodule.exports={tolggleContent,\r\n               removeSelectedNavClass,\r\n               stylizeCodeDisplay,\r\n               stylizeEditor,\r\n               deleteStylizedEditor,\r\n               showHttpResult,\r\n               getHeaderDom,\r\n               getInfoAlertDom,\r\n               getFunctionSignature,\r\n               toggleVisibility,\r\n               extractValueFromCell,\r\n               activateSelectedNav}\r\n","const WOQLResult = require('./WOQLResultsViewer');\r\n\r\nfunction WOQLQuery(client, options, ui){\r\n\tthis.client = client;\r\n\tthis.options = options;\r\n\tthis.ui = ui;\r\n\tthis.default_limit = 1000;\r\n\tthis.prefixes = {};\r\n\tif(client.connectionConfig.platformEndpoint()){\r\n\t\tvar sid = client.connectionConfig.server.substring(0, client.connectionConfig.server.lastIndexOf(\"platform\"));\r\n\t\tthis.sid = sid;\r\n\t\tvar colid = client.connectionConfig.server.substring(0, client.connectionConfig.server.lastIndexOf(\"platform\")) + client.connectionConfig.dbid;\r\n\t\tthis.prefixes['s'] = colid + \"/ontology/main#\";\r\n\t\tthis.prefixes['g'] = sid;\r\n\t\tthis.prefixes['db'] = colid + \"/\";\r\n\t\tthis.prefixes['doc'] = colid + \"/candidate/\";\r\n\t\tthis.prefixes['dg'] = colid + \"/graph/main/\";\r\n\t}\r\n\telse {\r\n\t\tthis.sid = client.connectionConfig.serverURL();\r\n\t\tthis.prefixes['s'] = client.connectionConfig.schemaURL() + \"#\";\r\n\t\tthis.prefixes['dg'] = client.connectionConfig.dbURL() + \"/schema\";\r\n\t\tthis.prefixes['doc'] = client.connectionConfig.docURL();\r\n\t\tthis.prefixes['db'] = client.connectionConfig.dbURL() + \"/\";\r\n\t\tthis.prefixes['g'] = client.connectionConfig.serverURL();\r\n\t}\r\n\tfor(var pref in TerminusClient.FrameHelper.standard_urls){\r\n\t\tthis.prefixes[pref] = TerminusClient.FrameHelper.standard_urls[pref];\r\n\t}\r\n}\r\n\r\nWOQLQuery.prototype.setPrefixes = function(prefixes){\r\n\tthis.prefixes = prefixes;\r\n}\r\n\r\n\r\nWOQLQuery.prototype.shorten = function(url){\r\n\tfor(var pref in this.prefixes){\r\n\t\tif(this.prefixes[pref] == url.substring(0, this.prefixes[pref].length)){\r\n\t\t\treturn ( pref + \":\" + url.substring(this.prefixes[pref].length));\r\n\t\t}\r\n\t}\r\n\treturn url;\r\n}\r\n\r\nWOQLQuery.prototype.execute = function(woql){\r\n\tvar wrapped = this.wrap(woql);\r\n\tvar self = this;\r\n\treturn this.client.select(false, wrapped)\r\n\t.then(function(response){\r\n\t\tvar res = new WOQLResult.WOQLResult(response, self, self.options, self.ui);\r\n\t\treturn res;\r\n\t});\r\n}\r\n\r\nWOQLQuery.prototype.wrap = function(woql){\r\n\tvar wjson = {\r\n\t\t\"@context\" : this.prefixes,\r\n\t\t\"from\": [ \r\n\t\t\tthis.client.connectionConfig.dbURL(),\r\n\t\t\twoql\r\n\t\t]\r\n\t};\r\n\treturn wjson;\r\n}\r\n\r\nWOQLQuery.prototype.getConcreteDocumentClassPattern = function(varc){\r\n\tvar varc = varc || \"v:Class\";\r\n\tvar pat = {\r\n\t\tand: [\r\n\t\t\tthis.getSubclassQueryPattern(varc, \"tcs:Document\"), \r\n\t\t\t{\r\n\t\t\t\tnot: [this.getAbstractQueryPattern(varc)] \r\n\t\t\t}\r\n\t\t]\r\n\t}\r\n\treturn pat;\r\n}\r\n\r\nWOQLQuery.prototype.getAbstractQueryPattern = function(varname){\r\n\tvar qp = {\r\n\t\tquad: [varname, \"tcs:tag\", \"tcs:abstract\", \"db:schema\"] \r\n\t}\r\n\treturn qp;\r\n}\r\n\r\nWOQLQuery.prototype.getSubclassQueryPattern = function(varname, clsname){\r\n\tvar sqp = {sub: [varname, clsname]};\r\n\treturn sqp;\r\n}\r\n\r\nWOQLQuery.prototype.queryWrappedWithLimit = function(query, limit, start){\r\n\tlimit = limit ? limit : this.default_limit ;\r\n\tstart = start ? start : 0;\r\n\tvar wjson = {\r\n\t\tlimit: [limit, {\r\n\t\t\tstart: [start, query]\r\n\t\t}]\r\n\t};\r\n\treturn wjson;\r\n}\r\n\r\n\r\nWOQLQuery.prototype.getAllDocumentQuery = function(constraint, limit, start){\r\n\tvar query = {\r\n\t\tand: [\r\n\t\t\t{\r\n\t\t\t\ttriple: [\"v:Document\", \"rdf:type\", \"v:Type\"]\r\n\t\t\t},\r\n\t\t\tthis.getSubclassQueryPattern(\"v:Type\", \"tcs:Document\") \r\n\t\t]\r\n\t}\r\n\tif(constraint){\r\n\t\tquery.and.push(constraint);\r\n\t}\r\n\treturn this.queryWrappedWithLimit(query, limit, start);\r\n}\r\n\r\nWOQLQuery.prototype.getEverythingQuery = function(constraint, limit, start){\r\n\tvar wjson = {triple: [\"v:Subject\", \"v:Predicate\", \"v:Object\"]};\r\n\tif(constraint){\r\n\t\twjson = {and: [wjson, constraint]};\r\n\t}\r\n\treturn this.queryWrappedWithLimit(wjson, limit, start);\r\n}\r\n\r\nWOQLQuery.prototype.getPropertyListQuery = function(constraint, limit, start){\r\n\tvar wjson = {\r\n\t\tand: [{quad: [\"v:Property\", \"rdfs:range\", \"v:Range\", \"db:schema\"]},\r\n\t\t\t{ \r\n\t\t\t\topt: [{quad: [\"v:Property\", \"rdf:type\", \"v:Type\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t\t{ \r\n\t\t\t\topt: [{quad: [\"v:Property\", \"rdfs:label\", \"v:Label\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t\t{ \r\n\t\t\t\topt: [{quad: [\"v:Property\", \"rdfs:comment\", \"v:Comment\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t\t{ \r\n\t\t\t\topt: [{quad: [\"v:Property\", \"rdfs:domain\", \"v:Domain\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t]\r\n\t}\r\n\tif(constraint){\r\n\t\twjson = {and: [wjson, constraint]};\r\n\t}\r\n\treturn this.queryWrappedWithLimit(wjson, limit, start);\r\n}\r\n\r\n\r\nWOQLQuery.prototype.getElementMetaDataQuery = function(constraint, limit, start){\r\n\tvar wjson = {\r\n\t\tand: [{quad: [\"v:Element\", \"rdf:type\", \"v:Type\", \"db:schema\"]},\r\n\t\t\t{ \r\n\t\t\t\topt: [{quad: [\"v:Element\", \"rdfs:label\", \"v:Label\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t\t{ \r\n\t\t\t\topt: [{quad: [\"v:Element\", \"rdfs:comment\", \"v:Comment\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t\t{ \r\n\t\t\t\topt: [{quad: [\"v:Element\", \"tcs:tag\", \"v:Abstract\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t\t{ \r\n\t\t\t\topt: [{quad: [\"v:Element\", \"rdfs:domain\", \"v:Domain\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t\t{ \r\n\t\t\t\topt: [{quad: [\"v:Element\", \"rdfs:range\", \"v:Range\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t]\r\n\t}\r\n\tif(constraint){\r\n\t\twjson = {and: [wjson, constraint]};\r\n\t}\r\n\treturn this.queryWrappedWithLimit(wjson, limit, start);\r\n}\r\n\r\nWOQLQuery.prototype.getClassListMetaDataQuery = function(constraint, limit, start){\r\n\tvar wjson = {\r\n\t\tand: [{quad: [\"v:Element\", \"rdf:type\", \"owl:Class\", \"db:schema\"]},\r\n\t\t\t{ \r\n\t\t\t\topt: [{quad: [\"v:Element\", \"rdfs:label\", \"v:Label\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t\t{ \r\n\t\t\t\topt: [{quad: [\"v:Element\", \"rdfs:comment\", \"v:Comment\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t\t{ \r\n\t\t\t\topt: [{quad: [\"v:Element\", \"tcs:tag\", \"v:Abstract\", \"db:schema\"]}]\r\n\t\t\t}\r\n\t\t]\r\n\t}\r\n\tif(constraint){\r\n\t\twjson = {and: [wjson, constraint]};\r\n\t}\r\n\treturn this.queryWrappedWithLimit(wjson, limit, start);\r\n}\r\n\r\nWOQLQuery.prototype.getClassMetaDataQuery = WOQLQuery.prototype.getClassListMetaDataQuery;\r\n\r\nWOQLQuery.prototype.getDataOfChosenClassQuery = function(chosen, limit, start){\r\n\tvar wjson = {\r\n\t\tand: [{triple: [\"v:Document\", \"rdf:type\", chosen]},\r\n\t\t\t{ \r\n\t\t\t\topt: [{triple: [\"v:Document\", \"v:Property\", \"v:Value\"]}]\r\n\t\t\t}\r\n\t\t]\r\n\t}\r\n\treturn this.queryWrappedWithLimit(wjson, limit, start);\r\n}\r\n\r\nWOQLQuery.prototype.getDataOfChosenPropertyQuery = function(chosen, limit, start){\r\n\tvar wjson = {\r\n\t\tand: [{triple: [\"v:Document\", chosen, \"v:Value\"]},\r\n\t\t\t{ \r\n\t\t\t\topt: [{triple: [\"v:Document\", \"rdfs:label\", \"v:Label\"]}]\r\n\t\t\t}\r\n\t\t]\r\n\t}\r\n\treturn this.queryWrappedWithLimit(wjson, limit, start);\r\n}\r\n\r\nWOQLQuery.prototype.getInstanceMeta = function(url, limit, start){\r\n\tvar wjson = {\r\n\t\tand: [\r\n\t\t\t{triple: [url, \"rdfs:label\", \"v:InstanceLabel\"]},\r\n\t\t\t{triple: [url, \"rdf:type\", \"v:InstanceType\"]},\r\n\t\t\t{ \r\n\t\t\t\topt: [{triple: [url, \"rdfs:comment\", \"v:InstanceComment\"]}]\r\n\t\t\t},\r\n\t\t\t{ \r\n\t\t\t\topt: [{quad: [\"v:InstanceType\", \"rdfs:label\", \"v:ClassLabel\", \"db:schema\"]}]\r\n\t\t\t}\r\n\t\t]\r\n\t}\r\n\treturn this.queryWrappedWithLimit(wjson, limit, start);\r\n}\r\n\r\n\r\nWOQLQuery.prototype.getDocumentQuery = function(id, limit, start){\r\n\tvar wjson = {\r\n\t\tand: [\r\n\t\t\t{triple: [id, \"v:Property\", \"v:Property_Value\"]},\r\n\t\t\t{ \r\n\t\t\t\topt: [{quad: [\"v:Property\", \"rdfs:label\", \"v:Property_Label\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t\t{ \r\n\t\t\t\topt: [{quad: [\"v:Property\", \"rdf:type\", \"v:Property_Type\", \"db:schema\"]}]\r\n\t\t\t}\r\n\t\t]\r\n\t}\r\n\treturn this.queryWrappedWithLimit(wjson, limit, start);\r\n}\r\n\r\nWOQLQuery.prototype.getClassesQuery = function(){\r\n\tvar wjson = {\r\n\t\tand: [\r\n\t\t\t{triple: [\"v:ID\", \"rdf:type\", \"v:Class\"]},\r\n\t\t\t{ \r\n\t\t\t\topt: [{triple: [\"v:ID\", \"rdfs:label\", \"v:Label\"]}]\r\n\t\t\t},\r\n\t\t\t{ \r\n\t\t\t\topt: [{triple: [\"v:ID\", \"rdfs:comment\", \"v:Comment\"]}]\r\n\t\t\t},\r\n\t\t\t{ \r\n\t\t\t\topt: [{quad: [\"v:Class\", \"rdfs:label\", \"v:Type\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tsub: ['v:Class', 'tcs:Document']\r\n\t\t\t}\r\n\t\t]\r\n\t}\r\n\treturn wjson;\r\n}\r\n\r\nmodule.exports=WOQLQuery\r\n","//const FrameHelper = require('../FrameHelper');\r\n\r\nfunction TerminusPluginManager(){\r\n\tthis.preloaded = [];\r\n\tthis.loaded = [];\r\n\tthis.loading = [];\r\n\tthis.precluded = [];\r\n\tthis.plugins = {};\r\n\tthis.plugins[\"font-awesome\"] = {\r\n\t\tlabel: \"Font Awesome\",\r\n\t\tcss: [\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0-11/css/all.css\"]\r\n\t};\r\n\tthis.plugins[\"quill\"] = {\r\n\t\tlabel: \"Quill\",\r\n\t\tjs: [\"https://cdn.quilljs.com/1.3.6/quill.min.js\"],\r\n\t\tcss: [\"https://cdn.quilljs.com/1.3.6/quill.snow.css\"],\r\n\t\tplugin: \"quill.terminus.js\",\r\n\t};\r\n\tthis.plugins[\"codemirror\"] = {\r\n\t\tlabel : \"Code Mirror\",\r\n\t\tjs: [\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/codemirror.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/mode/xml/xml.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/mode/css/css.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/mode/turtle/turtle.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/mode/javascript/javascript.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/addon/hint/anyword-hint.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/addon/hint/show-hint.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/addon/runmode/runmode.js\",\r\n\t\t  \t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/mode/http/http.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/addon/edit/closebrackets.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/addon/edit/matchbrackets.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/addon/display/placeholder.js\"\r\n\t  ],\r\n\t\tcss: [\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/codemirror.css\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/addon/hint/show-hint.css\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/theme/neo.css\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/theme/erlang-dark.css\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/theme/eclipse.css\"\r\n\t\t]\r\n\t};\r\n\tthis.plugins[\"jquery\"] = {\r\n\t\tlabel: \"jQuery\",\r\n\t\tjs: [\"https://code.jquery.com/jquery-2.2.4.min.js\"]\r\n\t};\r\n\tthis.plugins[\"jqueryui\"] = {\r\n\t\tlabel: \"jQuery UI\",\r\n\t\tcss: [\"https://code.jquery.com/ui/1.12.0/themes/smoothness/jquery-ui.css\"],\r\n\t\tjs: [\"https://code.jquery.com/ui/1.12.0/jquery-ui.js\"],\r\n\t\trequires: ['jquery']\r\n\t};\r\n\tthis.plugins[\"datatables\"] = {\r\n\t\tlabel: \"Data Tables\",\r\n\t\tjs: [\"https://cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js\",\r\n\t\t\t \"https://cdn.datatables.net/v/dt/jszip-2.5.0/dt-1.10.16/b-1.5.1/b-html5-1.5.1/datatables.min.js\"],\r\n\t\tcss: [\"https://cdn.datatables.net/1.10.19/css/jquery.dataTables.min.css\"],\r\n\t\trequires: ['jquery']\r\n\t};\r\n\t/*this.plugins[\"prettify\"] = {\r\n\t\tlabel: \"Prettify\",\r\n\t\tjs: [\"https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.js\"],\r\n\t\tcss: [\"https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.css\"],\r\n\t\trequires: ['jquery']\r\n\t};*/\r\n\tthis.plugins[\"gmaps\"] = {\r\n\t\tlabel: \"Google Maps\",\r\n\t\tjs: [\"https://maps.googleapis.com/maps/api/js\"],\r\n\t\tplugin: \"gmaps.terminus.js\"\r\n\t};\r\n\tthis.plugins[\"d3\"] = {\r\n\t\tlabel: \"d3\",\r\n\t\tjs: [\"https://code.jquery.com/jquery-2.2.4.min.js\"],\r\n\t\trequires: ['jquery']\r\n\t};\r\n\tthis.plugins[\"select2\"] = {\r\n\t\tlabel: \"Select 2\",\r\n\t\tjs: [\"https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.7/js/select2.min.js\"],\r\n\t\tcss: [\"https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.7/css/select2.min.css\"],\r\n\t\tplugin: \"select2.terminus.js\",\r\n\t\trequires: ['jquery']\r\n\t};\r\n\tthis.plugins[\"jsoneditor\"] = {\r\n\t\tlabel: \"JSON Editor\",\r\n\t\tjs: [\"plugins/libs/jsoneditor.min.js\"],\r\n\t\tcss: [\"plugins/libs/jsoneditor.min.css\"],\r\n\t\tplugin: \"jsoneditor.terminus.js\"\r\n\t};\r\n\t/*this.plugins[\"bootstrap\"] = {\r\n\t\tlabel: \"Bootstrap\",\r\n\t\tjs: [\"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js\"],\r\n\t\tcss: [\"https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/2.2.2/css/bootstrap.min.css\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/2.2.2/css/bootstrap-responsive.min.css\"]\r\n\t};\r\n\tthis.plugins[\"flot\"] = {\r\n\t\tlabel: \"Flot\",\r\n\t\tjs: [\"https://cdnjs.cloudflare.com/ajax/libs/flot/0.8.3/jquery.flot.min.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/flot/0.8.3/jquery.flot.resize.min.js\"],\r\n\t\trequires: [\"jquery\"]\r\n\t};*/\r\n}\r\n\r\nTerminusPluginManager.prototype.setPluginOptions = function(opts){\r\n\tfor(var p in opts){\r\n\t\tif(!this.plugins[p]) continue;\r\n\t\tfor(var k in opts[p]){\r\n\t\t\tthis.plugins[p][k] = opts[p][k];\r\n\t\t}\r\n\t}\r\n}\r\n\r\nTerminusPluginManager.prototype.init = function(opts, then){\r\n\tif(opts) this.setPluginOptions(opts);\r\n\tthis.calculatePreloaded();\r\n\tvar toload = this.calculateRequiredInitPlugins(opts);\r\n\tif(toload && toload[0].length) {\r\n\t\tif(toload[1].length){\r\n\t\t\tvar self = this;\r\n\t\t\tvar nthen = function(){\r\n\t\t\t\tself.loadPlugins(toload[1], then);\r\n\t\t\t}\r\n\t\t\tthis.loadPlugins(toload[0], nthen);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.loadPlugins(toload[0], then);\r\n\t\t}\r\n\t}\r\n\telse if(then){\r\n\t\tthen();\r\n\t}\r\n}\r\n\r\nTerminusPluginManager.prototype.calculateRequiredInitPlugins = function(opts){\r\n\tif(opts){\r\n\t\tvar pins = [];\r\n\t\tfor(var pid in opts){\r\n\t\t\tif(opts[pid] && pins.indexOf(pid) == -1){\r\n\t\t\t\tif(typeof opts[pid] != \"object\" && opts[pid]){\r\n\t\t\t\t\tpins.push(pid);\r\n\t\t\t\t}\r\n\t\t\t\telse if(typeof opts[pid] == \"object\"){\r\n\t\t\t\t\tif(!(typeof opts[pid].loaded != \"undefined\" && !opts[pid].loaded)){\r\n\t\t\t\t\t\tpins.push(pid);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tvar pins = this.getDefaultPlugins();\r\n\t}\r\n\tvar needed_pins = [];\r\n\tfor(var i = 0; i<pins.length; i++){\r\n\t\tif(this.loaded.indexOf(pins[i]) == -1 && this.preloaded.indexOf(pins[i]) == -1 ){\r\n\t\t\tneeded_pins.push(pins[i])\r\n\t\t}\r\n\t}\r\n\tvar loading_order = [[], []];\r\n\tfor(var i = 0; i<needed_pins.length; i++){\r\n\t\tif(this.plugins[needed_pins[i]].requires && this.plugins[needed_pins[i]].requires.length){\r\n\t\t\tloading_order[1].push(needed_pins[i]);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tloading_order[0].push(needed_pins[i]);\r\n\t\t}\r\n\t}\r\n\treturn loading_order;\r\n}\r\n\r\nTerminusPluginManager.prototype.getAvailablePlugins = function(){\r\n\treturn this.plugins;\r\n}\r\n\r\nTerminusPluginManager.prototype.calculatePreloaded = function(){\r\n\tfor(var pl in this.plugins){\r\n\t\tif(this.pluginAvailable(pl)){\r\n\t\t\tthis.preloaded.push(pl);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nTerminusPluginManager.prototype.pluginAvailable = function(plugin, version_check){\r\n\tif(typeof this.plugins[plugin] == \"object\"){\r\n\t\tvar pluginmeta = this.plugins[plugin];\r\n\t\tif(pluginmeta.requires && pluginmeta.requires.length){\r\n\t\t\tfor(var i =0 ; i < pluginmeta.requires.length; i++){\r\n\t\t\t\tif(!this.pluginAvailable(pluginmeta.requires[i], version_check)) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar required_version = (pluginmeta.version ? pluginmeta.version : false);\r\n\t\tswitch(plugin){\r\n\t\t\tcase \"jquery\": {\r\n\t\t\t\tif(typeof jQuery == \"undefined\") return false;\r\n\t\t\t\tif(version_check && required_version){}\r\n\t\t\t\treturn true;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tcase \"jqueryui\": {\r\n\t\t\t\tif(typeof jQuery != \"undefined\" && jQuery.isFunction( jQuery.fn.slider )) return true;\r\n\t\t\t\treturn false;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tcase \"quill\": {\r\n\t\t\t\tif(typeof Quill == \"undefined\") return false;\r\n\t\t\t\treturn true;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tcase \"jsoneditor\": {\r\n\t\t\t\tif(typeof JSONEditor == \"undefined\") return false;\r\n\t\t\t\treturn true;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tcase \"codemirror\": {\r\n\t\t\t\tif(typeof CodeMirror == \"undefined\") return false;\r\n\t\t\t\treturn this.plugins[plugin];  // sent plugin config with darkmode true/ false\r\n\t\t\t}\r\n\t\t\tcase \"font-awesome\": {\r\n\t\t\t\t//if(typeof CodeMirror != \"undefined\") return true;\r\n\t\t\t\treturn this.fontAwesomeCheck();\r\n\t\t\t}\r\n\t\t\tcase \"datatables\": {\r\n\t\t\t\t if(typeof jQuery != \"undefined\" && jQuery.isFunction( jQuery.fn.dataTable)) return true;\r\n\t\t\t\t return false;\r\n\t\t\t}\r\n\t\t\tcase \"select2\": {\r\n\t\t\t\t if(typeof jQuery != \"undefined\" && jQuery.isFunction( jQuery.fn.select2 )) return true;\r\n\t\t\t\t return false;\r\n\t\t\t}\r\n\t\t\tcase \"gmaps\": {\r\n\t\t\t\tif(typeof google == \"undefined\" || typeof google.maps == \"undefined\") return false;\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\tcase \"openlayers\": {\r\n\t\t\t\tif(typeof ol == \"undefined\" || typeof ol.Map == \"undefined\") return false;\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\tcase \"d3\": {\r\n\t\t\t\tif(typeof d3 == \"undefined\") return false;\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tconsole.log(new Error(plugin + \" is not a supported plugin ID\"));\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nTerminusPluginManager.prototype.fontAwesomeCheck = function(){\r\n\tvar span = document.createElement('span');\r\n\tspan.className = 'fa';\r\n\tspan.style.display = 'none';\r\n\tdocument.body.insertBefore(span, document.body.firstChild);\r\n\tfunction css(element, property) {\r\n\t  return window.getComputedStyle(element, null).getPropertyValue(property);\r\n\t}\r\n\tvar loaded = false;\r\n\tvar fontAwsm = css(span, 'font-family');\r\n\tif (fontAwsm.replace(/\"/g, \"\") == 'Font Awesome 5 Free') { // remove double quotes\r\n\t\tloaded = true;\r\n\t}\r\n\tdocument.body.removeChild(span);\r\n\treturn loaded;\r\n}\r\n\r\nTerminusPluginManager.prototype.getDefaultPlugins = function(){\r\n\tvar defplugs = [\"font-awesome\"];\r\n\treturn defplugs;\r\n}\r\n\r\nTerminusPluginManager.prototype.loadPlugins = function(plugins, then){\r\n\tvar ticker = plugins.length;\r\n\tvar cback = function(){\r\n\t\tif(--ticker <= 1 && then){\r\n\t\t\tthen();\r\n\t\t}\r\n\t};\r\n\tfor(var i = 0; i < plugins.length; i++){\r\n\t\tthis.loadPlugin(plugins[i], cback);\r\n\t}\r\n}\r\n\r\nTerminusPluginManager.prototype.loadPlugin = function(plugin, then){\r\n\tvar pug = this.plugins[plugin];\r\n\tif(pug.css){\r\n\t\tfor(var i=0; i<pug.css.length; i++){\r\n\t\t\tvar cssid = plugin + \"_css_\" + i;\r\n\t\t\tTerminusClient.FrameHelper.loadDynamicCSS(cssid, pug.css[i]);\r\n\t\t}\r\n\t}\r\n\tvar scripts = (pug.js ? pug.js : []);\r\n\tif(plugin == \"gmaps\" && pug.key){\r\n\t\tscripts[0] += \"?key=\" + pug.key;\r\n\t}\r\n\tif(pug.plugin){\r\n\t\tscripts.push(\"plugins/\" + pug.plugin);\r\n\t}\r\n\tif(plugin == \"codemirror\"){\r\n\t\tvar cm = scripts[0];\r\n\t\tvar sid = plugin + \"_js_\" + (scripts.length -1);\r\n\t\tscripts.splice(0, 1);\r\n\t\tvar self = this;\r\n\t\tvar cback = function(){\r\n\t\t\tself.loadPluginScripts(plugin, scripts, then);\r\n\t\t}\r\n\t\tTerminusClient.FrameHelper.loadDynamicScript(sid, cm, cback);\r\n\t}\r\n\telse {\r\n\t\tthis.loadPluginScripts(plugin, scripts, then);\r\n\t}\r\n}\r\n\r\nTerminusPluginManager.prototype.loadPluginScripts = function(plugin, scripts, then){\r\n\tvar ticker = scripts.length - 1;\r\n\tvar self = this;\r\n\tvar cback = function(){\r\n\t\tif(ticker == 0) {\r\n\t\t\tif(self.loaded.indexOf(plugin) == -1){\r\n\t\t\t\tself.loaded.push(plugin);\r\n\t\t\t}\r\n\t\t\tif(self.loading.indexOf(plugin) != -1){\r\n\t\t\t\tself.loading.splice(self.loading.indexOf(plugin), 1);\r\n\t\t\t}\r\n\t\t\tthen();\r\n\t\t}\r\n\t\tticker--;\r\n\t};\r\n\tif(scripts.length == 0){\r\n\t\tthis.loaded.push(plugin);\r\n\t}\r\n\telse {\r\n\t\tthis.loading.push(plugin);\r\n\t}\r\n\tfor(var i = 0; i<scripts.length; i++){\r\n\t\tvar sid = plugin + \"_js_\" + i;\r\n\t\tTerminusClient.FrameHelper.loadDynamicScript(sid, scripts[i], cback);\r\n\t}\r\n}\r\n\r\nTerminusPluginManager.prototype.loadPageCSS = function(css){\r\n\tcssfid = \"terminus_client_css\";\r\n\tvar cssdom = document.getElementById(cssfid);\r\n\tif(cssdom){\r\n\t\tcssdom.parentNode.removeChild(cssdom);\r\n\t}\r\n\tif(css){\r\n\t\tcssurl = \"css/\" + css + \".css\";\r\n\t\tTerminusClient.FrameHelper.loadDynamicCSS(cssfid, cssurl);\r\n\t}\r\n}\r\n\r\nTerminusPluginManager.prototype.pluginLoadable = function(pid){\r\n\treturn (this.precluded.indexOf(pid) !== -1 || this.pluginLoadedOrLoading(pid));\r\n}\r\n\r\nTerminusPluginManager.prototype.pluginLoadedOrLoading = function(pid){\r\n\tif(this.loaded.indexOf(pid) != -1) return true;\r\n\tif(this.preloaded.indexOf(pid) != -1) return true;\r\n\tif(this.loading.indexOf(pid) != -1) return true;\r\n\treturn false;\r\n}\r\n\r\nTerminusPluginManager.prototype.disabled = function(pid, obj){\r\n\tif(this.precluded.indexOf(pid) != -1) return true;\r\n\tif(obj.requires){\r\n\t\tfor(var i = 0; i<obj.requires.length; i++){\r\n\t\t\tif(!this.pluginLoadedOrLoading(obj.requires[i])) return true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nTerminusPluginManager.prototype.getPluginDOM = function(plugid, obj, ui){\r\n\tvar a = document.createElement(\"a\");\r\n\tvar cl = document.createElement(\"span\");\r\n\ta.appendChild(cl);\r\n\tcl.setAttribute(\"class\", \"terminus-plugin-control\");\r\n\tvar cbox = document.createElement(\"input\");\r\n\tcbox.id = \"terminus-plugin-control-\" + plugid;\r\n\tcbox.type = \"checkbox\";\r\n\tif(this.preloaded.indexOf(plugid) != -1){\r\n\t\tcbox.checked = true;\r\n\t\tcbox.disabled = true;\r\n\t}\r\n\telse if(this.loaded.indexOf(plugid) != -1){\r\n\t\tcbox.checked = true;\r\n\t}\r\n\telse if(this.loading.indexOf(plugid) != -1){\r\n\t\tcbox.checked = true;\r\n\t}\r\n\telse if(this.disabled(plugid, obj)){\r\n\t\tcbox.disabled = true;\r\n\t}\r\n\tvar clab = document.createElement(\"label\");\r\n\tclab.setAttribute(\"class\", \"terminus-plugin-label terminus-pointer\");\r\n\tclab.setAttribute(\"for\", cbox.id);\r\n\tclab.appendChild(document.createTextNode(obj.label));\r\n\tcl.appendChild(clab);\r\n\tcl.appendChild(cbox);\r\n\tvar self = this;\r\n\tcbox.addEventListener(\"change\", function(){\r\n\t\tself.togglePlugin(plugid, ui);\r\n\t});\r\n\treturn a;\r\n}\r\n\r\nTerminusPluginManager.prototype.togglePlugin = function(plugid, ui){\r\n\tif(this.loaded.indexOf(plugid) == -1){\r\n\t\tvar then = function(){\r\n\t\t\tui.redraw();\r\n\t\t}\r\n\t\tthis.loadPlugin(plugid, then);\r\n\t}\r\n\telse {\r\n\t\tthis.unloadPlugin(plugid);\r\n\t}\r\n\tTerminusClient.FrameHelper.removeChildren(ui.plugins);\r\n\tui.drawPlugins();\r\n}\r\n\r\nTerminusPluginManager.prototype.unloadPlugin = function(plugid){\r\n\tif(!this.plugins[plugid] || this.loaded.indexOf(plugid) == -1) {\r\n\t\tconsole.log(new Error(plugid + \" plugin unload request when it is not loaded\"));\r\n\t\treturn false;\r\n\t}\r\n\tvar pug = this.plugins[plugid];\r\n\tvar num = (pug.js) ? pug.js.length : 0;\r\n\tif(pug.plugin) num++;\r\n\tfor(var i=0; i< num; i++){\r\n\t\tvar cssfid = plugid + \"_js_\" + i;\r\n\t\tvar cssdom = document.getElementById(cssfid);\r\n\t\tif(cssdom){\r\n\t\t\tcssdom.parentNode.removeChild(cssdom);\r\n\t\t}\r\n\t}\r\n\tnum = (pug.css ? pug.css.length : 0);\r\n\tfor(var i=0; i< num; i++){\r\n\t\tvar cssfid = plugid + \"_css_\" + i;\r\n\t\tvar cssdom = document.getElementById(cssfid);\r\n\t\tif(cssdom){\r\n\t\t\tcssdom.parentNode.removeChild(cssdom);\r\n\t\t}\r\n\t}\r\n\tthis.loaded.splice(this.loaded.indexOf(plugid), 1);\r\n}\r\n\r\nTerminusPluginManager.prototype.getAsDOM = function(ui){\r\n\tvar dm = document.createElement(\"span\");\r\n\tdm.setAttribute(\"class\", \"terminus-plugin-manager\");\r\n\tvar clh = document.createElement(\"span\");\r\n\tclh.setAttribute(\"class\", \"terminus-plugin-control-header terminus-plugin-nav terminus-pointer\");\r\n\tclh.appendChild(document.createTextNode(\"Plugins\"));\r\n\tdm.appendChild(clh);\r\n\tvar a = document.createElement('a');\r\n\tthis.showPlugins(a, ui);\r\n\tclh.appendChild(a);\r\n\ta.style.display = 'none';\r\n\tclh.addEventListener('click', function(){\r\n\t\tif(a.style.display == 'none')\r\n\t\t\ta.style.display = 'block';\r\n\t\telse a.style.display = 'none';\r\n\t})\r\n\treturn dm;\r\n}\r\n\r\nTerminusPluginManager.prototype.showPlugins = function(a, ui){\r\n\ta.setAttribute('style', 'background-color: #111;');\r\n\tfor(var pid in this.plugins){\r\n\t\ta.appendChild(this.getPluginDOM(pid, this.plugins[pid], ui));\r\n\t}\r\n}\r\n\r\nmodule.exports=TerminusPluginManager\r\n","const TerminusPluginManager = require('../plugins/TerminusPlugin');\r\nconst Datatables = require('../plugins/datatables.terminus');\r\nconst FrameHelper = require('../FrameHelper');\r\n\r\nfunction WOQLResult(res, query, options, ui){\r\n\tthis.ui = ui;\r\n\tthis.query = query;\r\n\tthis.bindings = ((res && res.bindings) ? res.bindings : []);\r\n}\r\n\r\nWOQLResult.prototype.count = function(){\r\n\treturn this.bindings.length;\r\n}\r\n\r\nWOQLResult.prototype.shorten = function(url){\r\n\treturn this.query.shorten(url);\r\n}\r\n\r\nWOQLResult.prototype.hasBindings = function(result){\r\n\tif(result) return (result.bindings && result.bindings.length);\r\n\telse return (this.bindings && this.bindings.length);\r\n}\r\n\r\n\r\n\r\nfunction WOQLResultsViewer(ui, wresult, options, settings){\r\n\t//this.ui = ui;\r\n\tthis.result = wresult;\r\n\tthis.options = options;\r\n\t//this.wqlRes = new WOQLResult();\r\n\tthis.pman = new TerminusPluginManager();\r\n\tthis.settings = settings;\r\n}\r\n\r\nWOQLResultsViewer.prototype.showTable = function(){\r\n\tif(this.options && typeof this.options.show_table != \"undefined\") return this.options.show_table;\r\n\treturn true;\r\n}\r\n\r\nWOQLResultsViewer.prototype.orderColumns = function(sample){\r\n\tvar ordered = [];\r\n\tfor(var h in sample){\r\n\t\tif(ordered.indexOf(h) == -1){\r\n\t\t\tordered.unshift(h);\r\n\t\t}\r\n\t}\r\n\treturn ordered;\r\n}\r\n\r\nWOQLResultsViewer.prototype.getAsDOM = function(resultDOM, displayResultHeader){\r\n\tvar rs = document.createElement('div');\r\n\tresultDOM.appendChild(rs);\r\n\tif(displayResultHeader){\r\n\t\tvar rh = document.createElement('div');\r\n\t\trh.setAttribute(\"class\", \"terminus-margin-top-bottom terminus-module-head\");\r\n\t\trh.appendChild(document.createTextNode(\"Results\"));\r\n\t\trs.appendChild(rh);\r\n\t}\r\n\tif(this.result && this.result.hasBindings() && this.showTable()){\r\n\t\tthis.getTableDOM(this.result.bindings, rs);\r\n\t\treturn rs;\r\n\t}\r\n\telse {\r\n\t\tconsole.log(\"no bindings for query\");\r\n\t}\r\n}\r\n\r\nWOQLResultsViewer.prototype.getTableDOM = function(bindings, resultDOM){\r\n\tif(this.pman.pluginAvailable(\"datatables\")){\r\n\t\tvar dtResult = this.getTable(bindings, true);\r\n\t\tresultDOM.appendChild(dtResult.tab);\r\n    \tvar dt = new Datatables();\r\n\t\tdt.draw(true, dtResult, this.settings, this.ui, resultDOM);\r\n\t\tresultDOM.classList.add('terminus-expandable');\r\n\t\tresultDOM.classList.add('terminus-dt-result-cont');\r\n\t\treturn tab;\r\n    }\r\n\telse{\r\n\t\tvar tab = this.getTable(bindings, false);\r\n\t\tresultDOM.appendChild(tab);\r\n\t}\r\n}\r\n\r\nWOQLResultsViewer.prototype.formatResultsForDatatableDisplay = function(bindings){\r\n    var columns = [], colDataData = {}, data = [], formattedResult = {};\r\n\tvar dtResult = {};\r\n    var ordered_headings = this.orderColumns(bindings[0]);\r\n\t// get columns\r\n\tfor(var i = 0; i<ordered_headings.length; i++){\r\n\t\tvar clab = FrameHelper.validURL(ordered_headings[i]) ? FrameHelper.labelFromURL(ordered_headings[i]) : ordered_headings[i];\r\n        columns.push({data: clab});\r\n\t}\r\n\t// get data for respective columns\r\n\tfor(var i = 0; i<bindings.length; i++){\r\n\t\tcolDataData = {};\r\n\t\tfor(var j = 0; j<ordered_headings.length; j++){\r\n\t\t\tif(typeof bindings[i][ordered_headings[j]] == \"object\"){\r\n\t\t\t\tvar lab = (bindings[i][ordered_headings[j]]['@value'] ? bindings[i][ordered_headings[j]]['@value'] : \"Object?\");\r\n\t\t\t}\r\n\t\t\telse if(typeof bindings[i][ordered_headings[j]] == \"string\") {\r\n\t\t\t\tvar lab = this.result.shorten(bindings[i][ordered_headings[j]]);\r\n\t\t\t\tif(lab == \"unknown\") lab = \"\";\r\n\t\t\t\tif(lab.substring(0, 4) == \"doc:\"){\r\n\t\t\t\t\tlab = this.getDocumentLocalLink(lab);\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tcolDataData[ordered_headings[j]] = lab;\r\n\t\t}\r\n\t\tdata.push(colDataData);\r\n\t}\r\n\tdtResult.columns = columns;\r\n\tformattedResult.data = data;\r\n\tformattedResult.recordsTotal = '65';\r\n\tdtResult.data = formattedResult;\r\n\treturn dtResult;\r\n}\r\n\r\nWOQLResultsViewer.prototype.getTableBody = function(bindings, ordered_headings){\r\n\tvar tbody = document.createElement(\"tbody\");\r\n\tvar self = this;\r\n\tfor(var i = 0; i<bindings.length; i++){\r\n\t\tvar tr = document.createElement(\"tr\");\r\n\t\tfor(var j = 0; j<ordered_headings.length; j++){\r\n\t\t\tvar td = document.createElement(\"td\");\r\n\t\t\tif(typeof bindings[i][ordered_headings[j]] == \"object\"){\r\n\t\t\t\tvar lab = (bindings[i][ordered_headings[j]]['@value'] ? bindings[i][ordered_headings[j]]['@value'] : \"Object?\");\r\n\t\t\t\ttd.appendChild(document.createTextNode(lab));\r\n\t\t\t}\r\n\t\t\telse if(typeof bindings[i][ordered_headings[j]] == \"string\") {\r\n\t\t\t\tvar lab = this.result.shorten(bindings[i][ordered_headings[j]]);\r\n\t\t\t\tif(lab == \"unknown\") lab = \"\";\r\n\t\t\t\tif(lab.substring(0, 4) == \"doc:\"){\r\n\t\t\t\t\tvar a = this.getDocumentLocalLink(lab);\r\n\t\t\t\t\ttd.appendChild(a);\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\ttd.appendChild(document.createTextNode(lab));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\ttr.appendChild(td);\r\n\t\t}\r\n\t\ttbody.appendChild(tr);\r\n\t}\r\n\treturn tbody;\r\n}\r\n\r\nWOQLResultsViewer.prototype.getDocumentLocalLink = function(lab){\r\n\tvar a = document.createElement(\"a\");\r\n\ta.setAttribute(\"title\", lab);\r\n\ta.setAttribute(\"href\", '#');\r\n\tvar self = this;\r\n\ta.addEventListener(\"click\", function(){\r\n\t\tif(self.result.ui) {\r\n\t\t\tself.result.ui.showDocument(this.title);\r\n\t\t\tself.result.ui.redraw();\r\n\t\t}\r\n\t});\r\n\ta.appendChild(document.createTextNode(lab));\r\n\treturn a;\r\n}\r\n\r\nWOQLResultsViewer.prototype.getTable = function(bindings, dtPlugin){\r\n\tvar tab = document.createElement(\"table\");\r\n\ttab.setAttribute(\"class\", \"terminus-query-results-table\");\r\n\tvar thead = document.createElement(\"thead\");\r\n\tvar thr = document.createElement(\"tr\");\r\n\tvar ordered_headings = this.orderColumns(bindings[0]);\r\n\tfor(var i = 0; i<ordered_headings.length; i++){\r\n\t\tvar th = document.createElement(\"th\");\r\n\t\tth.setAttribute('class', 'terminus-table-header-full-css');\r\n\t\tvar clab = (ordered_headings[i].indexOf(\"http\") != -1) ? FrameHelper.labelFromURL(ordered_headings[i]) : ordered_headings[i];\r\n\t\tth.appendChild(document.createTextNode(clab));\r\n\t\tthr.appendChild(th);\r\n\t}\r\n\tthead.appendChild(thr);\r\n\ttab.appendChild(thead);\r\n\tif(dtPlugin){\r\n\t\tvar tbody = document.createElement(\"tbody\");\r\n\t\ttab.appendChild(tbody);\r\n\t\tvar dtResult ={};\r\n\t\tdtResult.result = this.formatResultsForDatatableDisplay(bindings);\r\n\t\tdtResult.tab = tab;\r\n\t\treturn dtResult;\r\n\t}\r\n\telse {\r\n\t\tvar tbody = this.getTableBody(bindings , ordered_headings);\r\n\t\ttab.appendChild(tbody);\r\n\t\treturn tab;\r\n\t}\r\n}\r\n\r\n\r\nmodule.exports={WOQLResultsViewer, WOQLResult}\r\n","const TerminusPluginManager = require('../plugins/TerminusPlugin');\r\n\r\nlet HTMLFrameHelper = {};\r\n\r\nHTMLFrameHelper.getActionControl = function(type, control, label, callback, disabled){\r\n\tvar pman = new TerminusPluginManager();\r\n\tvar dpropDOM = document.createElement(\"span\");\r\n\tdpropDOM.setAttribute(\"class\", \"terminus-action-control \" + type + \"-\" + control);\r\n\tvar pman = new TerminusPluginManager();\r\n    /*if(pman.pluginAvailable(\"font-awesome\")){\r\n\t\tvar icon = document.createElement('icon');\r\n\t\tvar faic = this.getControlIcon(control);\r\n\t\tif(disabled){\r\n\t\t\ticon.setAttribute(\"class\", \"terminus-frame-control frame-control-action action-disabled fa fa\" + faic + \" \" + type + \"-\" + control + \"-disabled terminus-font-align\");\r\n\t\t\ticon.setAttribute(\"title\", disabled);\r\n\t\t}\r\n\t\telse {\r\n\t\t\ticon.setAttribute(\"class\", \"terminus-frame-control frame-control-action frame-control-action fa fa\" + faic + \" \" + type + \"-\" + control + \" terminus-font-align\");\r\n\t\t\ticon.addEventListener(\"click\", function(){\r\n\t\t\t\tcallback(control);\r\n\t\t\t});\r\n\t\t}\r\n\t\tdpropDOM.appendChild(icon);\r\n\t}\r\n\telse{*/\r\n\t\tvar button = document.createElement(\"button\");\r\n\t\tbutton.appendChild(document.createTextNode(label));\r\n\t\tif(disabled){\r\n\t\t\tbutton.setAttribute(\"class\", \"terminus-frame-control terminus-btn frame-control-action action-disabled \" + type + \"-\" + control + \"-disabled\");\r\n\t\t\tbutton.setAttribute(\"title\", disabled);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tbutton.setAttribute(\"class\", \"terminus-frame-control terminus-btn frame-control-action \" + type + \"-\" + control);\r\n\t\t\tbutton.addEventListener(\"click\", function(){\r\n\t\t\t\tcallback(control);\r\n\t\t\t});\r\n\t\t}\r\n\t\tdpropDOM.appendChild(button);\r\n\t//}\r\n\treturn dpropDOM;\r\n}\r\n\r\nHTMLFrameHelper.getSettingsControl = function(view){\r\n\tvar pman = new TerminusPluginManager();\r\n\tif(pman.pluginAvailable(\"font-awesome\")){\r\n\t\tvar icon = document.createElement('icon');\r\n\t\tif(view == 'property') icon.setAttribute('class', 'fa fa-cog terminus-pointer');\r\n\t\telse if(view == 'data') icon.setAttribute('class', 'fa fa-edit terminus-pointer');\r\n\t\ticon.setAttribute('style', 'margin: 10px;')\r\n\t\treturn icon;\r\n\t}\r\n\telse{\r\n\t\tvar button = document.createElement(\"button\");\r\n\t\tbutton.setAttribute('class', 'terminus-btn');\r\n\t\tbutton.appendChild(document.createTextNode('Settings'));\r\n\t\treturn button;\r\n\t}\r\n}\r\n\r\nHTMLFrameHelper.getControlIcon = function(control){\r\n\tvar icon;\r\n\tswitch(control){\r\n\t\tcase 'delete':\r\n\t\t\ticon = '-alt-delete';\r\n\t\tbreak;\r\n\t\tcase 'add':\r\n\t\t\ticon = '-plus';\r\n\t\tbreak;\r\n\t\tcase 'reset':\r\n\t\t\ticon = '-undo';\r\n\t\tbreak;\r\n\t\tcase 'save':\r\n\t\t\ticon = '-save';\r\n\t\tbreak;\r\n\t\tcase 'hide':\r\n\t\t\ticon = '-eye-slash';\r\n\t\tbreak;\r\n\t}\r\n\treturn icon;\r\n}\r\n\r\nHTMLFrameHelper.getSelectionControl = function(type, options, selected, callback){\r\n\tvar sel = document.createElement(\"select\");\r\n\tsel.setAttribute(\"class\", \"terminus-frame-selector frame-control-selection \" + type);\r\n\tfor(var i = 0; i < options.length; i++){\r\n\t\tvar opt = document.createElement(\"option\");\r\n\t\tif(typeof options[i] == \"object\"){\r\n\t\t\topt.value = options[i].value;\r\n\t\t\tvar label = (options[i].label ?  document.createTextNode(options[i].label) : document.createTextNode(TerminusClient.FrameHelper.labelFromURL(options[i].value)));\r\n\t\t\topt.appendChild(label);\r\n\t\t}\r\n\t\telse {\r\n\t\t\topt.value = options[i];\r\n\t\t\tlabel = TerminusClient.FrameHelper.labelFromURL(opt.value);\r\n\t\t\topt.appendChild(document.createTextNode(label));\r\n\t\t}\r\n\t\tif(selected == opt.value){\r\n\t\t\topt.setAttribute(\"selected\", \"selected\");\r\n\t\t}\r\n\t\tsel.appendChild(opt);\r\n\t}\r\n\tsel.addEventListener(\"change\", function(){\r\n\t\tcallback(this.value);\r\n\t});\r\n\treturn sel;\r\n}\r\n\r\nHTMLFrameHelper.getModeSelectorDOM = function(which, renderer){\r\n\tvar viewsDOM = document.createElement(\"span\");\r\n\tviewsDOM.setAttribute(\"class\", \"terminus-mode terminus-\"+which+\"-mode\");\r\n\tif(renderer.mode == \"view\"){\r\n\t\tvar callback = function(){ renderer.setMode(\"edit\");}\r\n\t\tviewsDOM.appendChild(HTMLFrameHelper.getActionControl(\"terminus-mode terminus-\"+which+\"-mode\", \"edit\", \" Edit \", callback));\r\n\t}\r\n\telse if(renderer.isNew()){\r\n\t\treturn false;\r\n\t}\r\n\telse {\r\n\t\tvar callback = function(){ renderer.cancel();}\r\n\t\tviewsDOM.appendChild(HTMLFrameHelper.getActionControl(which, \"cancel\", \"Cancel\", callback));\r\n\t}\r\n\treturn viewsDOM;\r\n}\r\n\r\nHTMLFrameHelper.goToName = function(s, p, i){\r\n\tvar url = window.location.href;\r\n\tif(url){\r\n\t\tvar wbits = url.split(\"#\");\r\n\t\tvar loc = wbits[0];\r\n\t\tvar sh = TerminusClient.FrameHelper.getShorthand(s);\r\n\t    if(!sh) sh = s;\r\n\t\tvar bits = sh.split(\":\");\r\n\t\tif(bits.length > 1) sh = bits[1];\r\n\t\tvar htmlid = sh;\r\n\t\tif(p){\r\n\t\t\tvar prop = TerminusClient.FrameHelper.getShorthand(p);\r\n\t\t\tif(!prop ) prop = p;\r\n\t\t\tvar bits = prop.split(\":\");\r\n\t\t\tif(bits.length > 1) prop = bits[1];\r\n\t\t\thtmlid += \"_\" + prop;\r\n\t\t\tif(i){\r\n\t\t\t\thtmlid += \"_\" + i;\r\n\t\t\t}\r\n\t\t}\r\n\t\twindow.location = loc + \"#\" + htmlid;\r\n\t}\r\n}\r\n\r\n\r\n\r\n/*HTMLFrameHelper.getFrameRow = function(){\r\n\tvar row = document.createElement('div');\r\n\trow.setAttribute('class', 'terminus-frame-row');\r\n\treturn row;\r\n}\r\n\r\nHTMLFrameHelper.getFrameGroup = function(frow){\r\n\tvar fl = document.createElement('div');\r\n\tfl.setAttribute('class', 'terminus-frame-length');\r\n\tfrow.appendChild(fl);\r\n\r\n\tvar fg = document.createElement('div');\r\n\tfg.setAttribute('class', 'terminus-frame-group');\r\n\tfl.appendChild(fg);\r\n\treturn fl;\r\n}*/\r\n\r\nHTMLFrameHelper.getInfoboxDOM = function(type, label, value, help, input){\r\n\t/*var frow = this.getFrameRow();\r\n\tvar fgroup = this.getFrameGroup(frow);*/\r\n\tvar infoDOM = document.createElement(\"span\");\r\n\tinfoDOM.setAttribute(\"class\", \"terminus-frame-infobox-box \" + \"terminus-\" +type );\r\n\t//fgroup.appendChild(infoDOM);\r\n\tif(help){\r\n\t\tinfoDOM.setAttribute(\"title\", help);\r\n\t}\r\n\tif(label){\r\n\t\tvar linfo = document.createElement(\"span\");\r\n\t\tlinfo.setAttribute(\"class\", \"terminus-frame-infobox-label \" + \"terminus-\" +type + \"-label\");\r\n\t\tlinfo.appendChild(document.createTextNode(label));\r\n\t\tinfoDOM.appendChild(linfo);\r\n\t}\r\n\tvar lspacer = document.createElement(\"span\");\r\n\tlspacer.setAttribute(\"class\", \"terminus-frame-infobox-spacer \" + \"terminus-\" +type + \"-spacer\");\r\n\tlspacer.appendChild(document.createTextNode(\" \"));\r\n\tinfoDOM.appendChild(lspacer);\r\n\tvar lval = document.createElement(\"span\");\r\n\tlval.setAttribute(\"class\", \"terminus-frame-infobox-value \" + \"terminus-\" +type + \"-value terminus-property-label-align\");\r\n\tif(input){\r\n\t\tinput.value = value;\r\n\t\tlval.appendChild(input);\r\n\t}\r\n\telse if(value) {\r\n\t\tvar sh = TerminusClient.FrameHelper.getShorthand(value);\r\n        if(sh){\r\n    \t   \tvar bits = sh.split(\":\");\r\n            sh = bits[1];\r\n   \t\t\tlval.setAttribute(\"title\", value);\r\n\t\t\tlval.appendChild(document.createTextNode(sh));\r\n\t\t}\r\n\t\telse {\r\n\t\t\tlval.appendChild(document.createTextNode(value));\r\n\t\t}\r\n\t}\r\n\tinfoDOM.appendChild(lval);\r\n\treturn infoDOM;\r\n}\r\n\r\nmodule.exports=HTMLFrameHelper\r\n","const PropertyViewer = require('./PropertyViewer');\r\nconst ObjectViewer= require(\"./ObjectViewer\")\r\nconst HTMLStringViewer = require('./viewers/String');\r\nconst HTMLStringEditor = require('./viewers/StringEditor');\r\nconst HTMLBooleanViewer = require('./viewers/Boolean');\r\nconst HTMLBooleanEditor = require('./viewers/BooleanEditor');\r\nconst HTMLChoiceViewer = require('./viewers/Choice');\r\nconst HTMLChoiceEditor = require('./viewers/ChoiceEditor');\r\nconst HTMLCoordinateViewer = require('./viewers/Coordinate');\r\nconst HTMLCoordinateEditor = require('./viewers/CoordinateEditor');\r\nconst HTMLDateViewer = require('./viewers/Date');\r\nconst HTMLDateEditor = require('./viewers/DateEditor');\r\nconst HTMLEntityViewer = require('./viewers/Entity');\r\nconst HTMLEntityEditor = require('./viewers/EntityEditor');\r\nconst HTMLImageViewer = require('./viewers/Image');\r\nconst HTMLImageEditor = require('./viewers/ImageEditor');\r\nconst HTMLLinkViewer = require('./viewers/Link');\r\nconst HTMLNumberViewer = require('./viewers/Number');\r\nconst HTMLRangeViewer = require('./viewers/Range');\r\nconst HTMLRangeEditor = require('./viewers/RangeEditor');\r\nconst SantizedHTMLViewer = require('./viewers/SanitizedHTML');\r\n\r\nlet RenderingMap = {\r\n\tregisteredDataViewers: {},\r\n\tregisteredDataEditors: {},\t\r\n\tregisteredPropertyViewers: {},\r\n\tregisteredPropertyEditors: {},\r\n\tregisteredObjectViewers: {},\r\n\tregisteredObjectEditors: {},\r\n\tgetValidDataViewerList: function(type, frametype){\r\n\t\tvar valids = ['HTMLStringViewer'];\r\n\t\tif(frametype && typeof this.registeredDataViewers[frametype] != \"undefined\"){\r\n\t\t\tvalids = valids.concat(this.registeredDataViewers[frametype]);\r\n\t\t}\r\n\t\tif(typeof this.registeredDataViewers[type] != \"undefined\"){\r\n\t\t\tvalids = valids.concat(this.registeredDataViewers[type]);\r\n\t\t}\r\n\t\treturn valids;\r\n\t},\r\n\tgetValidDataEditorList: function(type, frametype){\r\n\t\tvar valids = ['HTMLStringEditor'];\r\n\t\tif(frametype && typeof this.registeredDataEditors[frametype] != \"undefined\"){\r\n\t\t\tvar nftypes = this.registeredDataEditors[frametype];\r\n\t\t\tif(nftypes){\r\n\t\t\t\tfor(var i = 0; i<nftypes.length; i++){\r\n\t\t\t\t\tif(valids.indexOf(nftypes[i]) == -1) valids.push(nftypes[i]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(typeof this.registeredDataEditors[type] != \"undefined\"){\r\n\t\t\tvalids = valids.concat(this.registeredDataEditors[type]);\r\n\t\t}\r\n\t\treturn valids;\r\n\t},\r\n\tgetValidPropertyViewerList: function(property, proptype, proprange, propdom){\r\n\t\tvar valids = ['HTMLPropertyViewer'];\r\n\t\tif(property && typeof this.registeredPropertyViewers[property] != \"undefined\"){\r\n\t\t\tvalids = valids.concat(this.registeredPropertyViewers[property]);\r\n\t\t}\r\n\t\tif(proprange && typeof this.registeredPropertyViewers[proprange] != \"undefined\"){\r\n\t\t\tvalids = valids.concat(this.registeredPropertyViewers[proprange]);\r\n\t\t}\r\n\t\tif(propdom && typeof this.registeredPropertyViewers[propdom] != \"undefined\"){\r\n\t\t\tvalids = valids.concat(this.registeredPropertyViewers[propdom]);\r\n\t\t}\r\n\t\tif(proptype && typeof this.registeredPropertyViewers[proptype] != \"undefined\"){\r\n\t\t\tvalids = valids.concat(this.registeredPropertyViewers[proptype]);\r\n\t\t}\r\n\t\treturn valids;\r\n\t},\r\n\tgetValidPropertyEditorList: function(property, proptype, proprange, propdom){\r\n\t\tvar valids = ['HTMLPropertyViewer'];\r\n\t\tif(property && typeof this.registeredPropertyEditors[property] != \"undefined\"){\r\n\t\t\tvalids = valids.concat(this.registeredPropertyEditors[property]);\r\n\t\t}\r\n\t\tif(proprange && typeof this.registeredPropertyEditors[proprange] != \"undefined\"){\r\n\t\t\tvalids = valids.concat(this.registeredPropertyEditors[proprange]);\r\n\t\t}\r\n\t\tif(propdom && typeof this.registeredPropertyEditors[propdom] != \"undefined\"){\r\n\t\t\tvalids = valids.concat(this.registeredPropertyEditors[propdom]);\r\n\t\t}\r\n\t\tif(proptype && typeof this.registeredPropertyEditors[proptype] != \"undefined\"){\r\n\t\t\tvalids = valids.concat(this.registeredPropertyEditors[proptype]);\r\n\t\t}\r\n\t\treturn valids;\r\n\t},\r\n\tgetViewer: function(type, options){\r\n\t\tvar vi = this.renderers[type];\r\n\t\toptions = (options ? options: {});\r\n\t\ttry {\r\n\t\t\tvar viewer = eval(\"new \" + type + \".\" + type + \"(\" + JSON.stringify(options) + \")\");\t\r\n\t\t\treturn viewer;\r\n\t\t}\r\n\t\tcatch(e){\r\n\t\t\talert(\"failed on create \" + e.toString());\r\n\t\t}\r\n\t},\r\n\tgetAvailablePropertyViewers: function(type, renderer) {\r\n\t\tvar viewers = [];\r\n\t\tvar nviewers = []\r\n\t\tvar opts = this.getValidPropertyViewerList(type);\r\n\t\tfor(var i = 0; i<opts.length; i++){\r\n\t\t\tif(nviewers.indexOf(opts[i]) == -1) {\r\n\t\t\t\tnviewers.push(opts[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor(var i = 0; i<nviewers.length; i++){\r\n\t\t\tif(this.renderers[nviewers[i]]){\r\n\t\t\t\tvar sets = this.renderers[nviewers[i]];\r\n\t\t\t\tviewers.push({value: nviewers[i], label: sets.label});\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn viewers;\r\n\t},\r\n\tgetAvailablePropertyEditors: function(type, renderer) {\r\n\t\tvar viewers = [];\r\n\t\tvar nviewers = []\r\n\t\tvar opts = this.getValidPropertyEditorList();\r\n\t\tfor(var i = 0; i<opts.length; i++){\r\n\t\t\tif(nviewers.indexOf(opts[i]) == -1) {\r\n\t\t\t\tnviewers.push(opts[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor(var i = 0; i<nviewers.length; i++){\r\n\t\t\tif(this.renderers[nviewers[i]]){\r\n\t\t\t\tvar sets = this.renderers[nviewers[i]];\r\n\t\t\t\tviewers.push({value: nviewers[i], label: sets.label});\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn viewers;\r\n\t\t\r\n\t},\r\n\tgetAvailableDataViewers: function(type, frametype){\r\n\t\tvar viewers = [];\r\n\t\tvar nviewers = []\r\n\t\tvar opts = this.getValidDataViewerList(type, frametype);\r\n\t\tfor(var i = 0; i<opts.length; i++){\r\n\t\t\tif(nviewers.indexOf(opts[i]) == -1) {\r\n\t\t\t\tnviewers.push(opts[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor(var i = 0; i<nviewers.length; i++){\r\n\t\t\tif(this.renderers[nviewers[i]]){\r\n\t\t\t\tvar sets = this.renderers[nviewers[i]];\r\n\t\t\t\tviewers.push({value: nviewers[i], label: sets.label});\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn viewers;\r\n\t},\r\n\tgetAvailableDataEditors: function(type, frametype){\r\n\t\tvar viewers = [];\r\n\t\tvar nviewers = []\r\n\t\tvar opts = this.getValidDataEditorList(type, frametype);\r\n\t\tfor(var i = 0; i<opts.length; i++){\r\n\t\t\tif(nviewers.indexOf(opts[i]) == -1) {\r\n\t\t\t\tnviewers.push(opts[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor(var i = 0; i<nviewers.length; i++){\r\n\t\t\tif(this.renderers[nviewers[i]]){\r\n\t\t\t\tvar sets = this.renderers[nviewers[i]];\r\n\t\t\t\tviewers.push({value: nviewers[i], label: sets.label});\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn viewers;\r\n\t},\r\n\tgetViewerForDataFrame: function(type, frametype){\r\n\t\tvar vals = this.getValidDataViewerList(type, frametype);\r\n\t\treturn vals[vals.length-1];\r\n\t},\r\n\tgetEditorForDataFrame: function(type, frametype){\r\n\t\tvar vals = this.getValidDataEditorList(type, frametype);\r\n\t\treturn vals[vals.length-1];\r\n\t},\r\n\tregisterViewerForTypes: function(viewer, label, types){\r\n\t\tfor(var i = 0; i < types.length; i++){\r\n\t\t\tif(typeof this.registeredDataViewers[types[i]] == \"undefined\"){\r\n\t\t\t\tthis.registeredDataViewers[types[i]] = [];\r\n\t\t\t}\r\n\t\t\tif(this.registeredDataViewers[types[i]].indexOf(viewer) == -1){\r\n\t\t\t\tthis.registeredDataViewers[types[i]].push(viewer);\r\n\t\t\t\tthis.renderers[viewer] = {label: label};\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tregisterEditorForTypes: function(viewer, label, types){\r\n\t\tfor(var i = 0; i < types.length; i++){\r\n\t\t\tif(typeof this.registeredDataEditors[types[i]] == \"undefined\"){\r\n\t\t\t\tthis.registeredDataEditors[types[i]] = [];\r\n\t\t\t}\r\n\t\t\tif(this.registeredDataEditors[types[i]].indexOf(viewer) == -1){\r\n\t\t\t\tthis.registeredDataEditors[types[i]].push(viewer);\r\n\t\t\t\tthis.renderers[viewer] = {label: label};\r\n\t\t\t}\t\t\t\r\n\t\t}\r\n\t},\r\n\tregisterEditorForFrameType: function(viewer, label, frametype){\r\n\t\tthis.renderers[viewer] = {label: label};\r\n\t\tif(typeof this.registeredDataEditors[frametype] == \"undefined\") this.registeredDataEditors[frametype] = [];\r\n\t\tif(this.registeredDataEditors[frametype].indexOf(viewer) == -1){\r\n\t\t\tthis.registeredDataEditors[frametype].push(viewer);\r\n\t\t}\r\n\t},\r\n\tregisterViewerForFrameType: function(viewer, label, frametype){\r\n\t\tthis.renderers[viewer] = {label: label};\r\n\t\tif(typeof this.registeredDataViewers[frametype] == \"undefined\") this.registeredDataViewers[frametype] = [];\r\n\t\tif(this.registeredDataViewers[frametype].indexOf(viewer) == -1){\r\n\t\t\tthis.registeredDataViewers[frametype].push(viewer);\r\n\t\t}\r\n\t},\r\n\tregisterViewerForProperties: function(viewer, label, properties){\r\n\t\tfor(var i = 0; i < properties.length; i++){\r\n\t\t\tif(typeof this.registeredPropertyViewers[properties[i]] == \"undefined\"){\r\n\t\t\t\tthis.registeredPropertyViewers[properties[i]] = [];\r\n\t\t\t}\r\n\t\t\tif(this.registeredPropertyViewers[properties[i]].indexOf(viewer) == -1){\r\n\t\t\t\tthis.registeredPropertyViewers[properties[i]].push(viewer);\r\n\t\t\t\tthis.renderers[viewer] = {label: label};\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tregisterEditorForProperties: function(viewer, label, properties){\r\n\t\tfor(var i = 0; i < properties.length; i++){\r\n\t\t\tif(typeof this.registeredPropertyEditors[properties[i]] == \"undefined\"){\r\n\t\t\t\tthis.registeredPropertyEditors[properties[i]] = [];\r\n\t\t\t}\r\n\t\t\tif(this.registeredPropertyEditors[properties[i]].indexOf(viewer) == -1){\r\n\t\t\t\tthis.registeredPropertyEditors[properties].push(viewer);\r\n\t\t\t\tthis.renderers[viewer] = {label: label};\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\trenderers: {\r\n\t\tHTMLStringViewer: { label: \"String Viewer\"},\r\n\t\tHTMLStringEditor: { label: \"String Editor\"},\r\n\t\tHTMLPropertyViewer: { label: \"HTML Property Viewer\"}\r\n\t},\r\n\tpatternMatchesRenderer: function(pattern, renderer){\r\n\t\tif(typeof pattern == \"object\" && pattern.length){ //multiple patterns are ANDed\r\n\t\t\tfor(var i = 0 ; i<pattern.length; i++){\r\n\t\t\t\tvar fp = new FramePattern(pattern[i]);\r\n\t\t\t\tif(!fp.checkRenderer(renderer)) return false;\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tvar fp = new FramePattern(pattern);\r\n\t\t\treturn fp.checkRenderer(renderer);\r\n\t\t}\r\n\t}\r\n}\r\n\r\n\r\nRenderingMap.getViewerForProperty = function(target, renderer){\r\n\treturn new PropertyViewer.HTMLPropertyViewer(renderer);\r\n}\r\n\r\nRenderingMap.getEditorForProperty = function(target, renderer){\r\n\treturn new PropertyViewer.HTMLPropertyViewer(renderer);\r\n}\r\n\r\n\r\nRenderingMap.getViewerForObject = function(target, renderer){\r\n\tif(target == \"json\"){\r\n\t\treturn new JSONObjectViewer(renderer);\r\n\t}\r\n\treturn new ObjectViewer.HTMLObjectViewer(renderer);\r\n}\r\n\r\nRenderingMap.getEditorForObject = RenderingMap.getViewerForObject;\r\n\r\nRenderingMap.getAvailableObjectViewers = function(renderer){\r\n\tvar entries = ['html', 'json'];\r\n\treturn entries;\r\n}\r\n\r\nRenderingMap.decorateRenderer = function(options, renderer){\r\n\tvar compiled_options = this.compileOptions(options, renderer);\r\n\tif(compiled_options && compiled_options.mode){\r\n\t\trenderer.mode = compiled_options.mode;\r\n\t}\r\n\telse {\r\n\t\tif(renderer.parent && renderer.parent.mode) renderer.mode = renderer.parent.mode;\r\n\t\telse renderer.mode = \"view\";\r\n\t}\r\n\tif(compiled_options && compiled_options.view){\r\n\t\trenderer.view = compiled_options.view;\r\n\t}\r\n\telse {\r\n\t\tif(renderer.parent && renderer.parent.view) renderer.view = renderer.parent.view;\r\n\t\telse renderer.view = \"full\";\r\n\t}\r\n\tif(compiled_options && compiled_options.facets){\r\n\t\trenderer.facets = compiled_options.facets;\r\n\t}\r\n\telse {\r\n\t\trenderer.facets = renderer.getDefaultFacets();\r\n\t}\r\n\tif(compiled_options && compiled_options.facet && typeof renderer.facets[compiled_options.facet] == \"object\"){\r\n\t\trenderer.facet = compiled_options.facet;\r\n\t}\t\r\n\telse {\r\n\t\tvar deffacet = renderer.getDefaultFacet();\r\n\t\tif(typeof renderer.facets[deffacet] == \"object\"){\r\n\t\t\trenderer.facet = deffacet;\r\n\t\t}\r\n\t\telse {\r\n\t\t\trenderer.facet = key(renderer.facets);\r\n\t\t}\r\n\t}\r\n\tif(compiled_options && compiled_options.hide_disabled_buttons){\r\n\t\trenderer.hide_disabled_buttons = compiled_options.hide_disabled_buttons;\r\n\t}\r\n\telse if(renderer.parent) renderer.hide_disabled_buttons = parent.hide_disabled_buttons;\r\n\telse renderer.hide_disabled_buttons = true;\r\n\tif(compiled_options && typeof compiled_options.features == \"object\"){\r\n\t\trenderer.features = compiled_options.features;\r\n\t}\r\n\telse {\r\n\t\trenderer.features = renderer.facets[renderer.facet].features;\r\n\t\t//renderer.features = renderer.getDefaultFeatures(renderer.facet);\r\n\t}\r\n\tif(compiled_options && typeof compiled_options.controls == \"object\"){\r\n\t\trenderer.controls = compiled_options.controls;\r\n\t}\r\n\telse {\r\n\t\trenderer.controls = renderer.facets[renderer.facet].controls;\r\n\t\t//renderer.controls = renderer.getDefaultControls();\r\n\t}\r\n\tif(compiled_options && typeof compiled_options.viewerType != \"undefined\"){\r\n\t\trenderer.viewerType = compiled_options.viewerType;\r\n\t\tif(compiled_options.viewerOptions)\r\n\t\t\trenderer.viewerOptions = compiled_options.viewerOptions;\r\n\t}\r\n\tif(compiled_options && typeof compiled_options.header != \"undefined\"){}\r\n\telse {\r\n\t\trenderer.header_viewer = new ObjectViewer.HTMLObjectHeaderViewer();\r\n\t}\r\n\tif(compiled_options && typeof compiled_options.filter != \"undefined\"){}\r\n\telse {}\r\n\tif(compiled_options && typeof compiled_options.sort != \"undefined\"){}\r\n\telse {}\r\n\treturn options;\r\n}\t\r\n\r\nRenderingMap.compileOptions = function(options, renderer){\r\n\tvar compiled_options = {};\r\n\tvar rules = [];\r\n\tfor(var key in options){\r\n\t\tif(key != \"rules\"){\r\n\t\t\tcompiled_options[key] = options[key];\r\n\t\t}\r\n\t}\r\n\tif(options.rules){\r\n\t\tfor(var i = 0; i<options.rules.length; i++){\r\n\t\t\tvar match = (!options.rules[i].pattern || this.patternMatchesRenderer(options.rules[i].pattern, renderer));\r\n\t\t\tif(match && options.rules[i].output){\r\n\t\t\t\tfor(var k in options.rules[i].output){\r\n\t\t\t\t\tcompiled_options[k] = options.rules[i].output[k];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn compiled_options;\r\n}\r\n\r\nFramePattern = function(pattern){\r\n\tthis.renderer = (pattern.renderer ? pattern.renderer : false);\r\n\tthis.label = (pattern.value ? pattern.value : false);\r\n\tthis.frame_type = (pattern.frame_type ? pattern.frame_type : false);\r\n\tthis.subject = (pattern.subject ? pattern.subject : false);\r\n\tthis.subjectClass = (pattern.subjectClass ? pattern.subjectClass : false);\r\n\tthis.range = (pattern.range ? pattern.range : false);\r\n\tthis.property = (pattern.property ? pattern.property : false);\r\n\tthis.value = (pattern.value ? pattern.value : false);\r\n\tthis.parent = (pattern.parent ? new FramePattern(pattern.parent) : false);\r\n\tthis.children = [];\r\n\tif(pattern.children){\r\n\t\tfor(var i = 0 ; i < pattern.children.length ; i++){\r\n\t\t\tthis.children.push(new FramePattern(pattern.children[i]));\r\n\t\t}\r\n\t}\r\n\tthis.depth = (typeof pattern.depth != \"undefined\" ? pattern.depth : false);\r\n\tthis.index = (pattern.index ? pattern.index : false);\r\n\tthis.status = (pattern.status ? pattern.status : false);\r\n}\r\n\r\nFramePattern.prototype.checkRenderer = function(renderer){\r\n\tvar rtype = this.getRendererType(renderer);\r\n\tif(!rtype) return false;\r\n\tif(this.renderer && this.renderer != rtype) return false;\r\n\tif(this.illegalRuleType(rtype)) return false;\r\n\tif(this.frame_type && !this.checkFrameType(rtype, renderer)) return false;\r\n\tif(this.label && !this.checkLabel(rtype, renderer)) return false;\r\n\tif(this.subject && !this.checkSubject(rtype, renderer)) return false;\r\n\tif(this.subjectClass && !this.checkSubjectClass(rtype, renderer)) return false;\r\n\tif(this.property && !this.checkProperty(rtype, renderer)) return false;\r\n\tif(this.depth !== false && !this.checkDepth(rtype, renderer)) return false;\r\n\tif(this.range && !this.checkRange(rtype, renderer)) return false;\r\n\tif(this.value && !this.checkValue(rtype, renderer)) return false;\r\n\tif(this.parent && !this.checkParent(rtype, renderer)) return false;\r\n\tif(this.children && this.children.length && !this.checkChildren(rtype, renderer)) return false;\r\n\tif(this.index && !this.checkIndex(rtype, renderer)) return false;\r\n\tif(this.status && !this.checkStatus(rtype, renderer)) return false;\r\n\treturn true;\r\n} \r\n\r\nFramePattern.prototype.illegalRuleType = function(rtype){\r\n\tif(rtype == 'value' && (this.children.length || this.label)) return true;\r\n\tif(rtype == 'object' && this.range ) return true;\r\n\treturn false;\r\n}\r\n\r\n/* subject is an id or an array of ids, \r\n/* match is positive if the renderer's subject appears in the array or is the id\r\n */\r\nFramePattern.prototype.checkSubject = function(subject, renderer){\r\n\tif(typeof this.subject != \"object\" || !this.subject.length) this.subject = [this.subject];\r\n\tvar rsubj = renderer.subject();\r\n\tfor(var i = 0 ; i<this.subject.length; i++){\r\n\t\tif(this.IDsMatch(subject[i], rsubj)){\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\n//at least one child must match all child rules\r\nFramePattern.prototype.checkChildren = function(rtype, renderer){\r\n\tfor(var i = 0 ; i<this.children.length; i++){\r\n\t\tvar found = false;\r\n\t\tif(rtype == \"object\"){\r\n\t\t\tfor(var prop in renderer.properties){\r\n\t\t\t\tif(this.children[i].checkRenderer(renderer.properties[prop])) {\r\n\t\t\t\t\tfound = true;\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if(rtype == \"property\"){\r\n\t\t\tfor(var j = 0; j <= renderer.values.length; j++){\r\n\t\t\t\tif(this.children[j].checkRenderer(renderer.values[j])) {\r\n\t\t\t\t\tfound = true;\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(!found) return false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nFramePattern.prototype.checkStatus = function(rtype, renderer){\r\n\tif(typeof this.status != \"object\" || this.status.length == 0) this.status = [this.status];\r\n\tfor(var i = 0; i<this.status.length; i++){\r\n\t\tif(this.status[i] == \"updated\" && !renderer.isUpdated()) return false;\r\n\t\tif(this.status[i] == \"new\" && !renderer.isNew()) return false;\r\n\t\tif(this.status[i] == \"unchanged\" && renderer.isUpdated()) return false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nFramePattern.prototype.checkDepth = function(rtype, renderer){\r\n\treturn this.numberMatch(this.depth, renderer.depth());\r\n}\r\n\r\nFramePattern.prototype.checkParent = function(rtype, renderer){\r\n\treturn this.parent.checkRenderer(renderer.parent);\r\n}\r\n\r\nFramePattern.prototype.checkIndex = function(rtype, renderer){\r\n\tif(rtype == 'value'){\r\n\t\treturn this.index == renderer.index;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nFramePattern.prototype.checkProperty  = function(rtype, renderer){\r\n\tif(typeof this.property != \"object\" || !this.property.length) this.property = [this.property];\r\n\tfor(var i = 0 ; i<this.property.length; i++){\r\n\t\tif(this.propertyIDsMatch(renderer.property(), this.property[i])){\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\n//returns true if any of the values are found\r\nFramePattern.prototype.checkValue = function(rtype, renderer){\r\n\tif(typeof this.value != \"object\" || !this.value.length) this.value = [this.value];\r\n\tfor(var i = 0 ; i<this.value.length; i++){\r\n\t\tif(rtype == \"value\"){\r\n\t\t\tif(this.valuesMatch(renderer.value(), this.value[i])){\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if(rtype == \"property\"){\r\n\t\t\tfor(var j = 0; j<= renderer.values.length;  j++){\r\n\t\t\t\tif(this.getRendererType(renderer.values[i]) == 'value' &&\r\n\t\t\t\t\t\tthis.valuesMatch(renderer.values[i].value(), this.value[i])){\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if(rtype == \"object\"){\r\n\t\t\tfor(var prop in renderer.properties){\r\n\t\t\t\tif(this.checkValue(this.getRendererType(renderer.properties[prop]), renderer.properties[prop])){\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nFramePattern.prototype.checkRange  = function(rtype, renderer){\r\n\tif(typeof this.range != \"object\" || !this.range.length) this.range = [this.range];\r\n\tfor(var i = 0 ; i<this.range.length; i++){\r\n\t\tif(this.rangeIDsMatch(renderer.range(), this.range[i])){ \r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nFramePattern.prototype.checkSubjectClass = function(rtype, renderer){\r\n\tif(typeof this.subjectClass != \"object\" || !this.subjectClass.length) this.subjectClass = [this.subjectClass];\r\n\tvar rcls = renderer.subjectClass();\r\n\tfor(var i = 0 ; i<this.subjectClass.length; i++){\r\n\t\tif(this.classIDsMatch(this.subjectClass[i], rcls)){\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nFramePattern.prototype.checkFrameType = function (rtype, renderer){\r\n\tif(rtype == \"object\") return this.frame_type == \"object\";\r\n\tif(rtype == \"value\") {\r\n\t\tif(renderer.frame){\r\n\t\t\treturn this.frame_type == renderer.frame.ftype();\r\n\t\t}\r\n\t\telse {\r\n\t\t\talert(JSON.stringify(renderer));\r\n\t\t\talert(\"No frame\");\r\n\t\t}\r\n\t}\r\n\tif(rtype == \"property\") return false;\r\n}\r\n\r\nFramePattern.prototype.checkLabel = function(rtype, renderer){\r\n\tif(typeof renderder.getLabel != \"function\"){\r\n\t\tconsole.log(new Error(\"Rule passed to check label with broken renderer object - no getLabel\"));\r\n\t\treturn false;\r\n\t}\r\n\treturn this.stringMatch(this.label, renderer.getLabel());\r\n}\r\n\r\nFramePattern.prototype.IDsMatch = function(ida, idb){\r\n\treturn TerminusClient.FrameHelper.compareIDs(ida, idb);\r\n}\r\n\r\nFramePattern.prototype.classIDsMatch = function(ida, idb){\r\n\treturn this.IDsMatch(ida, idb);\r\n}\r\nFramePattern.prototype.propertyIDsMatch = function(ida, idb){\r\n\tvar match = this.IDsMatch(ida, idb);\r\n\treturn match;\r\n}\r\nFramePattern.prototype.rangeIDsMatch = function(ida, idb){\r\n\treturn this.IDsMatch(ida, idb);\r\n}\r\nFramePattern.prototype.valuesMatch = function(vala, valb){\r\n\treturn vala == valb;\r\n}\r\nFramePattern.prototype.numberMatch = function(vala, valb){\r\n\tif(typeof vala == \"string\"){\r\n\t\ttry {\r\n\t\t\treturn eval(valb + vala);\r\n\t\t}\r\n\t\tcatch(e){\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\treturn vala === valb;\r\n}\r\n\r\nFramePattern.prototype.stringMatch = function(vala, valb){\r\n\tvar pat = new RegExp(vala);\r\n\treturn pat.test(valb);\r\n}\r\n\r\nFramePattern.prototype.getRendererType = function(renderer){\r\n\tif(renderer.constructor.name == \"ValueRenderer\") return \"value\";\r\n\tif(renderer.constructor.name == \"PropertyRenderer\") return \"property\";\r\n\tif(renderer.constructor.name == \"ObjectRenderer\") return \"object\";\r\n\tconsole.log(new Error(\"frame configuration passed non-renderer type: \" + renderer.constructor.name));\r\n\treturn false;\r\n}\r\n\r\nRenderingMap.registerViewerForTypes(\"HTMLBooleanViewer\", \"Checkbox Viewer\", [\"xsd:boolean\"]);\r\nRenderingMap.registerEditorForTypes(\"HTMLBooleanEditor\", \"Checkbox Editor\", [\"xsd:boolean\"]);\r\nRenderingMap.registerViewerForFrameType(\"HTMLChoiceViewer\", \"Choice Viewer\", \"oneOf\");\r\nRenderingMap.registerEditorForFrameType(\"HTMLChoiceEditor\", \"Choice Selector\", \"oneOf\");\r\nRenderingMap.registerViewerForTypes(\"HTMLCoordinateViewer\", \"Coordinate Viewer\", [\"xdd:coordinate\", \"xdd:coordinatePolyline\", \"xdd:coordinatePolygon\"]);\r\nRenderingMap.registerEditorForTypes(\"HTMLCoordinateEditor\", \"Coordinate Editor\", [\"xdd:coordinate\", \"xdd:coordinatePolyline\", \"xdd:coordinatePolygon\"]);\r\nRenderingMap.registerViewerForTypes(\"HTMLDateViewer\", \"Date Viewer\", [\"xsd:date\", \"xsd:dateTime\", \"xsd:gYear\", \r\n\t\"xsd:gYearRange\", \"xsd:gMonth\", \"xsd:gDay\", \"xsd:gYearMonth\", \"xsd:gMonthDay\", \"xsd:dateTimeStamp\"]);\r\nRenderingMap.registerEditorForTypes(\"HTMLDateEditor\", \"Date Editor\", [\"xsd:date\", \"xsd:dateRange\" ,\"xsd:dateTime\", \"xsd:gYear\", \r\n\t\"xsd:gYearRange\", \"xsd:gMonth\", \"xsd:gDay\", \"xsd:gYearMonth\", \"xsd:gMonthDay\", \"xsd:dateTimeStamp\"]);\r\nRenderingMap.registerViewerForFrameType(\"HTMLEntityViewer\", \"Document Viewer\", \"document\");\r\nRenderingMap.registerEditorForFrameType(\"HTMLEntityEditor\", \"Document Selector\", \"document\");\r\nRenderingMap.registerViewerForTypes(\"HTMLImageViewer\", \"Image Viewer\", [\"xdd:url\", \"xsd:anyURI\", \"xsd:base64Binary\"]);\r\nRenderingMap.registerEditorForTypes(\"HTMLImageEditor\", \"Image Editor\", [\"xsd:base64Binary\"]);\r\nRenderingMap.registerViewerForTypes(\"HTMLImageViewer\", \"Image Viewer\", [\"xdd:url\", \"xsd:anyURI\", \"xsd:base64Binary\"]);\r\nRenderingMap.registerEditorForTypes(\"HTMLImageEditor\", \"Image Editor\", [\"xsd:base64Binary\"]);\r\nRenderingMap.registerViewerForTypes(\"HTMLLinkViewer\", \"Link Viewer\", [\"xdd:url\", \"xsd:anyURI\"]);\r\nRenderingMap.registerViewerForTypes(\"HTMLNumberViewer\", \"Number with commas\", \r\n\t\t[\"xsd:decimal\", \"xsd:double\", \"xsd:float\", \"xsd:short\", \"xsd:integer\", \"xsd:long\", \r\n\t\t\t\"xsd:nonNegativeInteger\", \"xsd:positiveInteger\", \"xsd:negativeInteger\", \"xsd:nonPositiveInteger\"]);\r\nRenderingMap.registerViewerForTypes(\"HTMLRangeViewer\", \"Range Viewer\", [\"xdd:integerRange\", \"xdd:decimalRange\"]);\r\nRenderingMap.registerEditorForTypes(\"HTMLRangeEditor\", \"Range Editor\", [\"xdd:integerRange\", \"xdd:decimalRange\"]);\r\nRenderingMap.registerViewerForTypes(\"SantizedHTMLViewer\", \"Sanitized HTML\", [\"xsd:string\", \"xdd:html\"]);\r\n\r\n\r\nmodule.exports=RenderingMap\r\n\r\n\r\n","/*\r\n * Utility class which runs a query against the schema and presents the returned classes as a drop-down / class filter list\r\n */\r\n//const FrameHelper = require('../FrameHelper');\r\nconst WOQLQuery = require('../query/WOQLQuery');\r\n\r\nTerminusClassChooser = function(ui, filter, chosen){\r\n\tthis.ui = ui;\r\n\tthis.choice = (chosen ? chosen : false);\r\n\tthis.filter = filter;\r\n\tthis.show_single = true;\r\n}\r\n\r\nTerminusClassChooser.prototype.setRoot = function(root){\r\n\tthis.root = root;\r\n}\r\n\r\nTerminusClassChooser.prototype.setFilter = function(filter){\r\n\tthis.filter = filter;\r\n}\r\n\r\nTerminusClassChooser.prototype.change = function(cls){\r\n\talert(\"Need to specify class chooser function (\" + cls + \")\");\r\n}\r\n\r\nTerminusClassChooser.prototype.getAsDOM = function(style){\r\n\tvar ccdom = document.createElement(\"span\");\r\n\tccdom.setAttribute(\"class\", \"terminus-class-chooser\");\r\n\tvar ccsel = document.createElement(\"select\");\r\n\tccsel.setAttribute(\"class\", style + \" terminus-type-select terminus-class-select\");\r\n\t// ccsel.setAttribute(\"class\", \"terminus-class-select terminus-type-select terminus-query-select\");\r\n\tvar self = this;\r\n\tccsel.addEventListener(\"change\", function(){\r\n\t\tif(this.value != this.choice){\r\n\t\t\tthis.choice = this.value;\r\n\t\t\tself.change(this.value);\r\n\t\t}\r\n\t});\r\n\tccdom.appendChild(ccsel);\r\n\tvar wq = new WOQLQuery(this.ui.client, {}, this.ui);\r\n\tvar woql = wq.getClassListMetaDataQuery(this.filter);\r\n\tvar self = this;\r\n\twq.execute(woql)\r\n\t.then(function(response){\r\n\t\tvar opts = self.getResultsAsOptions(response);\r\n\t\tif(opts){\r\n\t\t\tfor(var i = 0; i<opts.length; i++){\r\n\t\t\t\tccsel.appendChild(opts[i]);\r\n\t\t\t}\r\n\t\t\tself.options = opts;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tccdom.removeChild(ccsel);\r\n\t\t}\r\n\t});\r\n\treturn ccdom;\r\n}\r\n\r\nTerminusClassChooser.prototype.getResultsAsOptions = function(clist){\r\n\tvar choices = [];\r\n\tif(clist.bindings){\r\n\t\tif(this.show_single == false && clist.bindings.length < 2) return false;\r\n\t\tif(this.empty_choice){\r\n\t\t\tvar opt1 = document.createElement(\"option\");\r\n\t\t\topt1.setAttribute(\"class\", \"terminus-class-choice terminus-empty-choice\");\r\n\t\t\topt1.value = \"\";\r\n\t\t\topt1.appendChild(document.createTextNode(this.empty_choice));\r\n\t\t\tchoices.push(opt1);\r\n\t\t}\r\n\t\tvar added = [];\r\n\t\tfor(var i = 0; i<clist.bindings.length; i++){\r\n\t\t\tvar bclass = this.getVariableValueFromBinding(\"Element\", clist.bindings[i]);\r\n\t\t\tif(!bclass) bclass = this.getVariableValueFromBinding(\"Class\", clist.bindings[i]);\r\n\t\t\tif(bclass && added.indexOf(bclass) == -1){\r\n\t\t\t\tadded.push(bclass);\r\n\t\t\t\tvar opt = document.createElement(\"option\");\r\n\t\t\t\topt.setAttribute(\"class\", \"terminus-class-choice\");\r\n\t\t\t\topt.value = bclass;\r\n\t\t\t\tif(opt.value == this.choice){\r\n\t\t\t\t\topt.selected = true;\r\n\t\t\t\t}\r\n\t\t\t\tvar lab = this.getVariableValueFromBinding(\"Label\", clist.bindings[i]);\r\n\t\t\t\tif(!lab || lab == \"unknown\"){\r\n\r\n\t\t\t\t\tlab = TerminusClient.FrameHelper.labelFromURL(bclass);\r\n\r\n\t\t\t\t}\r\n\t\t\t\tif(lab[\"@value\"]) lab = lab[\"@value\"];\r\n\t\t\t\topt.appendChild(document.createTextNode(lab));\r\n\t\t\t\tchoices.push(opt);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn choices;\r\n}\r\n\r\nTerminusClassChooser.prototype.getVariableValueFromBinding = function(varname, bind){\r\n\tfor(var key in bind){\r\n\t\tvar skey = key.substring(key.lastIndexOf(\"/\")+1);\r\n\t\tif(skey == varname){\r\n\t\t\treturn bind[key];\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nmodule.exports=TerminusClassChooser\r\n","//const FrameHelper = require('../FrameHelper');\r\nconst HTMLFrameHelper = require('./HTMLFrameHelper');\r\n\r\n/**\r\n * Property Viewer\r\n */\r\nfunction HTMLPropertyViewer(renderer){\r\n\tthis.renderer = renderer;\r\n\tthis.values = [];\r\n\tthis.headerViewer = renderer.getPropertyHeaderViewer();\r\n}\r\n\r\n\r\n/**\r\n * Draws the property as header and body components\r\n */\r\nHTMLPropertyViewer.prototype.render = function(){\r\n\tvar block = document.createElement('div');\r\n\tblock.setAttribute('style', 'display: flex; margin: 10px 10px 0px 0px;');\r\n\tvar br = document.createElement('br');\r\n\tblock.appendChild(br);\r\n\tif(this.propDOM){\r\n\t\tvar npropDOM = this.getPropertyDOM();\r\n\t\tblock.appendChild(npropDOM);\r\n\t\tthis.propDOM.replaceWith(npropDOM);\r\n\t\t//11092019 this.propDOM = npropDOM;\r\n\t\tthis.propDOM = block;\r\n\t}\r\n\telse {\r\n\t\tblock.appendChild(this.getPropertyDOM());\r\n\t\tthis.propDOM = block;\r\n\t\t//11092019 this.propDOM = this.getPropertyDOM();\r\n\t}\r\n\tthis.propDOM.appendChild(this.getPropertyIDMarker(this.renderer));\r\n\tif(this.headerViewer){\r\n\t\tthis.header = this.headerViewer.getAsDOM(this.renderer);\r\n\t\tif(this.header) this.propDOM.appendChild(this.header);\r\n\t}\r\n\tthis.body = this.getPropertyBodyDOM();\r\n\tif(this.body) this.propDOM.appendChild(this.body);\r\n\treturn this.propDOM;\r\n}\r\n\r\nHTMLPropertyViewer.prototype.getPropertyDOM = function(){\r\n\tvar orientation = this.renderer.getContentOrientation();\r\n\tvar pcls = \" terminus-property-frame-display terminus-property-frame-\" + orientation;\r\n\tif(orientation == \"label\"){\r\n\t\tvar sp = document.createElement(\"span\");\r\n\t}\r\n\telse {\r\n\t\tvar sp = document.createElement(\"div\");\r\n\t}\r\n\t//terminus-property-frame-spacer\r\n\r\n\tsp.setAttribute(\"class\", \"WHATER terminus-property-frame \"+ sp + \" terminus-property-frame-\" + this.renderer.mode + \" \" + pcls);\r\n\tsp.setAttribute('data-property', this.renderer.property());\r\n\treturn sp;\r\n}\r\n\r\nHTMLPropertyViewer.prototype.getPropertyBodyDOM = function(){\r\n\tvar orientation = this.renderer.getContentOrientation();\r\n\tvar pcls = \"terminus-property-values-\" + orientation;\r\n\tif(orientation == \"page\"){\r\n\t\tvar vholder = document.createElement(\"div\");\r\n\t}\r\n\telse {\r\n\t\tvar vholder = document.createElement(\"span\");\r\n\t}\r\n    vholder.setAttribute('class', 'terminus-property-values ' + pcls + ' terminus-property-values-align');\r\n\tfor(var i =0; i<this.values.length; i++){\r\n\t\tvholder.appendChild(this.values[i]);\r\n\t}\r\n\treturn vholder;\r\n}\r\n\r\nHTMLPropertyViewer.prototype.addRenderedValue = function(renderedval){\r\n\tthis.values.push(renderedval);\r\n}\r\n\r\nHTMLPropertyViewer.prototype.clear = function(){\r\n\tTerminusClient.FrameHelper.removeChildren(this.propDOM);\r\n\tthis.values = [];\r\n}\r\n\r\n\r\n/**\r\n * Removes the property from the dom\r\n */\r\nHTMLPropertyViewer.prototype.remove = function(){\r\n\tthis.propDOM.parentNode.removeChild(this.propDOM);\r\n}\r\n\r\n/**\r\n * Redraws the property to reflect an updated state\r\n */\r\nHTMLPropertyViewer.prototype.redraw = function(){\r\n\tvar npropDOM = this.getPropertyDOM();\r\n\tthis.propDOM.replaceWith(npropDOM);\r\n\tthis.propDOM = npropDOM;\r\n\tthis.values = [];\r\n\tthis.renderer.render(this);\r\n}\r\n\r\nHTMLPropertyViewer.prototype.redrawHeader = function(){\r\n\tif(this.headerViewer && this.header) {\r\n\t\tvar nheader = this.headerViewer.getAsDOM(this.renderer);\r\n\t\tthis.header.replaceWith(nheader);\r\n\t\tthis.header = nheader;\r\n\t}\r\n}\r\n\r\nHTMLPropertyViewer.prototype.redrawBody = function(){\r\n\tif(this.body){\r\n\t\tvar nbody = this.getPropertyBodyDOM();\r\n\t\tthis.body.replaceWith(nbody);\r\n\t\tthis.body = nbody;\r\n\t}\r\n}\r\n\r\n/**\r\n * Generates a html anchor element to use as a marker to find the property on the page\r\n */\r\nHTMLPropertyViewer.prototype.getPropertyIDMarker = function(renderer){\r\n\tvar idm = document.createElement(\"a\");\r\n\tidm.setAttribute(\"class\", \"terminus-property-idmarker\");\r\n\tvar subj = TerminusClient.FrameHelper.getShorthand(renderer.subject());\r\n\tif(!subj ) subj = renderer.subject();\r\n\tvar bits = subj .split(\":\");\r\n\tif(bits.length > 1) subj = bits[1];\r\n\tvar prop = TerminusClient.FrameHelper.getShorthand(renderer.property());\r\n\tif(!prop ) prop = renderer.property();\r\n\tvar bits = prop.split(\":\");\r\n\tif(bits.length > 1) prop = bits[1];\r\n\tidm.setAttribute(\"name\", subj + \"_\" + prop);\r\n\treturn idm;\r\n}\r\n\r\nHTMLPropertyViewer.prototype.goTo = function(subj, property, index){\r\n\tHTMLFrameHelper.goToName(subj, property, index);\r\n}\r\n\r\nfunction HTMLPropertyHeaderViewer(){}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getAsDOM = function(renderer){\r\n\tvar orientation = renderer.getContentOrientation();\r\n\tvar pcls = \"terminus-property-header-\" + orientation;\r\n\tif(orientation == \"page\"){\r\n\t\tvar objDOM = document.createElement(\"div\");\r\n\t}\r\n\telse {\r\n\t\tvar objDOM = document.createElement(\"span\");\r\n\t}\r\n\tobjDOM.setAttribute(\"class\", \"terminus-text terminus-property-header \" + pcls);\r\n\tvar wrapper = document.createElement(\"span\");\r\n\twrapper.setAttribute(\"class\", \"terminus-property-header-wrapper\");\r\n\tif(renderer.showFeature(\"control\")){\r\n\t\tvar expModeMenu = this.getPropertyControlsDOM(wrapper, renderer);\r\n\t\tif(orientation == 'page') this.expModeMenu = expModeMenu;\r\n\t\telse this.expModeMenu = null;\r\n\t}\r\n\tif(renderer.showFeature(\"label\")){\r\n\t\tvar sumDOM = this.getPropertyLabelDOM(renderer);\r\n\t\tif(renderer.showFeature(\"status\")){\r\n\t\t\tvar statDOM = this.getPropertyStatusDOM(renderer);\r\n\t\t\tif(statDOM) sumDOM.prepend(statDOM);\r\n\t\t}\r\n\t\tif(sumDOM) wrapper.appendChild(sumDOM);\r\n\t}\r\n\telse if(renderer.showFeature(\"status\")){\r\n\t\tvar statDOM = this.getPropertyStatusDOM(renderer);\r\n\t\tif(statDOM) wrapper.appendChild(statDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"summary\")){\r\n\t\tvar sumDOM = this.getPropertySummaryDOM(renderer);\r\n\t\tif(sumDOM) wrapper.appendChild(sumDOM);\r\n\t}\r\n\r\n\tvar prelude = document.createElement(\"span\");\r\n\tprelude.setAttribute(\"class\", \"terminus-property-header-info terminus-property-header-info-\"+renderer.currentFacet());\r\n\r\n\tif(renderer.showFeature(\"facet\")){\r\n\t\tvar facetDOM = this.getPropertyFacetDOM(renderer);\r\n\t\tif(facetDOM && this.expModeMenu) this.expModeMenu.appendChild(facetDOM);//prelude.appendChild(facetDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"view\")){\r\n\t\tvar viewDOM = this.getViewValueDOM(renderer);\r\n\t\tif(viewDOM && this.expModeMenu) this.expModeMenu.appendChild(viewDOM); //prelude.appendChild(viewDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"id\")){\r\n\t\tvar idDOM = this.getPropertyIDDOM(renderer);\r\n\t\tif(idDOM && this.expModeMenu) this.expModeMenu.appendChild(idDOM); //prelude.appendChild(idDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"type\")){\r\n\t\tvar typeDOM = this.getPropertyRangeDOM(renderer);\r\n\t\tif(typeDOM && this.expModeMenu){\r\n\t\t\tthis.expModeMenu.appendChild(typeDOM);//prelude.appendChild(typeDOM);\r\n\t\t\ttypeDOM.style.display = 'block';\r\n\t\t}\r\n\t}\r\n\tif(renderer.showFeature(\"cardinality\") && renderer.hasCardinalityRestriction()){\r\n\t\tvar hideDOM = this.getPropertyCardinalityDOM(renderer);\r\n\t\tif(hideDOM){\r\n\t\t\tthis.expModeMenu.appendChild(hideDOM); //prelude.appendChild(hideDOM);\r\n\t\t\thideDOM.style.display = 'block';\r\n\t\t}\r\n\t}\r\n\tif(renderer.showFeature(\"comment\")){\r\n\t\tvar sumDOM = this.getPropertyCommentDOM(renderer);\r\n\t\tif(sumDOM && this.expModeMenu){\r\n\t\t\tthis.expModeMenu.appendChild(sumDOM); //prelude.appendChild(sumDOM);\r\n\t\t\tsumDOM.style.display = 'block';\r\n\t\t}\r\n\t}\r\n\twrapper.appendChild(prelude);\r\n\tobjDOM.appendChild(wrapper);\r\n\treturn objDOM;\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyFacetDOM = function(renderer){\r\n\tvar viewables = renderer.getAvailableFacets();\r\n\tvar self = this;\r\n\tif(viewables && viewables.length){\r\n\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-property-facet\");\r\n\t\tvar callback = function(val){\r\n\t\t\tif(val){\r\n\t\t\t\trenderer.setFacet(val);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"property-facet\", viewables, renderer.currentFacet(), callback);\r\n\t\tmpropDOM.appendChild(sel);\r\n\t\treturn mpropDOM;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyIDDOM = function(renderer){\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"property-id\", \"Property\", renderer.property(), \"This property is identified by this unique URL: \" + renderer.property());\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyRangeDOM = function(renderer){\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"property-type\", \"Type\", renderer.range(), \"The type of arguments that this property accepts\");\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertySummaryDOM = function(renderer){\r\n\tvar sum = renderer.getSummary();\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"property-summary\", false, sum.long, sum.status);\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyStatusDOM = function(renderer){\r\n\tvar sum = renderer.getSummary();\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"status-\"+sum.status, false, sum.status, sum.status);\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyLabelDOM = function(renderer){\r\n\tvar lab = renderer.getLabel();\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"property-label\", false, lab);\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyCommentDOM = function(renderer){\r\n\tvar lab = renderer.getComment();\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"property-comment\", false, lab);\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyCardinalityDOM = function(renderer){\r\n\tvar restriction = renderer.getRestriction();\r\n\tif(restriction.min && restriction.max){\r\n\t\tif(restriction.min == restriction.max){\r\n\t\t\tvar lab = restriction.min;\r\n\t\t\tvar help = \"Cardinality: \" + restriction.min;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tvar lab = restriction.min + \"-\" + restriction.max;\r\n\t\t\tvar help = \"Minimum Cardinality: \" + restriction.min;\r\n\t\t\thelp += \", Maximum Cardinality: \" + restriction.max;\r\n\t\t}\r\n\t}\r\n\telse if(restriction.min){\r\n\t\tvar lab = \">\"+(restriction.min-1);\r\n\t\tvar help = \"Minimum Cardinality: \" + restriction.min;\r\n\t}\r\n\telse if(restriction.max){\r\n\t\tvar lab = \"<\"+(restriction.max+1);\r\n\t\tvar help = \"Maximum Cardinality: \" + restriction.max;\r\n\t}\r\n\telse {\r\n\t\treturn false;\r\n\t}\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"property-cardinality\", \"Cardinality\", lab, help);\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getActionControlDOM = function(settingsDOM, renderer){\r\n\tif(renderer.showFeature(\"mode\")){\r\n\t\tvar viewsDOM = HTMLFrameHelper.getModeSelectorDOM(\"property\", renderer);\r\n\t\tif (viewsDOM) settingsDOM.appendChild(viewsDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"delete\")){\r\n\t\tvar dpropDOM = this.getPropertyDeleteDOM(renderer);\r\n\t\tif (dpropDOM) settingsDOM.appendChild(dpropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"add\") && !renderer.isClassChoice()){\r\n\t\tvar addDOM = this.getAddValueDOM(renderer);\r\n\t\tif(addDOM) settingsDOM.appendChild(addDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"reset\")){\r\n\t\tvar rpropDOM = this.getPropertyResetDOM(renderer);\r\n\t\tif(rpropDOM) settingsDOM.appendChild(rpropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"update\")){\r\n\t\tvar upropDOM = this.getPropertyUpdateDOM(renderer);\r\n\t\tif(upropDOM) settingsDOM.appendChild(upropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"show\")){\r\n\t\tvar showDOM = this.getPropertyShowDOM(renderer);\r\n\t\tif(showDOM) settingsDOM.appendChild(showDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"hide\")){\r\n\t\tvar hideDOM = this.getPropertyHideDOM(renderer);\r\n\t\tif(hideDOM) settingsDOM.appendChild(hideDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"viewer\")){\r\n\t\tvar hideDOM = this.getViewerSelectorDOM(renderer);\r\n\t\tif(hideDOM) settingsDOM.appendChild(hideDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"add\") && renderer.isClassChoice()){\r\n\t\tvar addDOM = this.getAddValueDOM(renderer);\r\n\t\tif(addDOM) settingsDOM.appendChild(addDOM);\r\n\t}\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getSettingsControlDOM = function(controlsDOM, renderer){\r\n\tvar settings = document.createElement(\"div\");\r\n\tcontrolsDOM.appendChild(settings);\r\n\tvar orientation = renderer.getContentOrientation();\r\n\tif(orientation == 'page'){ // expert mode\r\n\t\tvar sControl = HTMLFrameHelper.getSettingsControl('property');\r\n\t\tvar menu = document.createElement('div');\r\n\t\tmenu.setAttribute('class', 'terminus-hide terminus-popup');\r\n\t\tmenu.appendChild(document.createTextNode('Edit property'));\r\n\t\tmenu.appendChild(document.createElement('BR'));\r\n\t\tsControl.appendChild(menu);\r\n\t\tsControl.addEventListener('click', function(e){\r\n\t\t\tvar target = e.target || e.srcElement,\r\n        \ttext = target.textContent || target.innerText;\r\n\t\t\tif((target.nodeName == 'ICON') || (target.nodeName == 'BUTTON')){\r\n\t\t\t\tif(this.children[0].style.display == 'none') this.children[0].style.display = 'block';\r\n\t\t\t\telse this.children[0].style.display = 'none';\r\n\t\t\t}\r\n\t\t});\r\n\t\tthis.getActionControlDOM(menu, renderer);\r\n\t    settings.appendChild(sControl);\r\n\t\treturn menu;\r\n\t}\r\n\telse this.getActionControlDOM(controlsDOM, renderer);\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyControlsDOM = function(wrapper, renderer){\r\n\tvar controlsDOM = document.createElement(\"span\");\r\n\tcontrolsDOM.setAttribute(\"class\", \"terminus-property-controls\");\r\n\tcontrolsDOM.setAttribute(\"style\", \"display: table-cell;\");\r\n\t// get settings icon or button\r\n\tvar expModeMenu = this.getSettingsControlDOM(controlsDOM, renderer);\r\n\twrapper.appendChild(controlsDOM);\r\n\treturn expModeMenu;\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getAddValueDOM = function(renderer){\r\n\tif(renderer.isClassChoice()){\r\n\t\tvar cs = renderer.getAvailableClassChoices();\r\n\t\tif(cs && cs.length){\r\n\t\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\t\tmpropDOM.setAttribute(\"class\", \"terminus-property-add-class\");\r\n\t\t\tcs.unshift({ value: \"\", label: \"Add Type\"});\r\n\t\t\tvar callback = function(cls){\r\n\t\t\t\tif(cls){\r\n\t\t\t\t\trenderer.addClass(cls);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"add-property\", cs, \"\", callback);\r\n\t\t\tmpropDOM.appendChild(sel);\r\n\t\t\treturn mpropDOM;\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tvar callback = function(){renderer.add(\"edit\")};\r\n\t\tvar disabled = (renderer.cardControlAllows(\"add\") ? false : \"Cardinality Rules Forbid Add\");\r\n\t\treturn HTMLFrameHelper.getActionControl(\"property\", \"add\", \"Add\", callback, disabled);\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getViewValueDOM = function(renderer){\r\n\tvar viewables = renderer.getViewableValues();\r\n\tvar self = this;\r\n\tif(viewables && viewables.length){\r\n\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-property-view-value\");\r\n\t\tviewables.unshift({ value: \"\", label: \"View Value\"});\r\n\t\tvar callback = function(val){\r\n\t\t\trenderer.goToValue(val);\r\n\t\t}\r\n\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"view-values\", viewables, \"\", callback);\r\n\t\tmpropDOM.appendChild(sel);\r\n\t\treturn mpropDOM;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyDeleteDOM = function(renderer){\r\n\tvar callback = function(){renderer.delete()};\r\n\tvar disabled = (renderer.cardControlAllows(\"delete\") ? false : \"Cardinality Rules Forbid Delete\");\r\n\treturn HTMLFrameHelper.getActionControl(\"property\", \"delete\", \"Delete\", callback, disabled);\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyHideDOM = function(renderer){\r\n\tvar callback = function(){renderer.hide()};\r\n\treturn HTMLFrameHelper.getActionControl(\"property\", \"hide\", \"Hide\", callback);\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyResetDOM = function(renderer){\r\n\tvar callback = function(){renderer.reset()};\r\n\tvar disabled = (renderer.isUpdated() ? false : \"Nothing to reset\");\r\n\treturn HTMLFrameHelper.getActionControl(\"property\", \"reset\", \"Reset\", callback, disabled);\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyShowDOM = function(renderer){\r\n\tvar callback = function(){renderer.show()};\r\n\treturn HTMLFrameHelper.getActionControl(\"property\", \"show\", \"Show\", callback);\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyUpdateDOM = function(renderer){\r\n\tvar dpropDOM = document.createElement(\"span\");\r\n\tdpropDOM.setAttribute(\"class\", \"terminus-property-update\");\r\n\tvar disabled = (renderer.isUpdated() ? false : \"No Change\");\r\n\tvar saveback = function(){renderer.save()};\r\n\tdpropDOM.appendChild(HTMLFrameHelper.getActionControl(\"property\", \"save\", \"Save\", saveback, disabled));\r\n\treturn dpropDOM;\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getViewerSelectorDOM = function(renderer){\r\n\tvar viewers = renderer.getAvailableViewers();\r\n\tif(viewers && viewers.length){\r\n\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-property-viewer\");\r\n\t\tvar callback = function(viewer){\r\n\t\t\tif(viewer){\r\n\t\t\t\trenderer.setViewer(viewer);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar selected = renderer.currentViewer();\r\n\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"property-viewers\", viewers, selected, callback);\r\n\t\tmpropDOM.appendChild(sel);\r\n\t\treturn mpropDOM;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.showValue = function(renderer, index){\r\n\tvar htmlid = renderer.subject() + \"->\" + renderer.property() + \"_\" + index;\r\n\twindow.location = (\"\"+window.location).replace(/#[A-Za-z0-9_]*$/,'') + \"#\" + htmlid;\r\n}\r\n\r\nfunction HTMLDataViewer(renderer){\r\n\tthis.renderer = renderer;\r\n\tthis.headerViewer = renderer.getValueHeaderViewer();\r\n}\r\n\r\nmodule.exports={HTMLPropertyViewer,HTMLPropertyHeaderViewer}\r\n","function HTMLStringViewer(options){\r\n\tthis.size = ((options && options.size) ? options.size : false);\r\n\tthis.css = ((options && options.css) ? \"terminus-literal-value \" + options.css : \"terminus-literal-value\");\r\n}\r\n\r\nHTMLStringViewer.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar value = renderer.value();\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', this.css);\r\n\tinput.setAttribute('data-value', value);\r\n\tvalue = document.createTextNode(value);\r\n\tinput.appendChild(value);\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={HTMLStringViewer}\r\n\r\n\r\n","const WOQLQuery = require('../query/WOQLQuery');\r\nconst ObjectRenderer = require('./ObjectRenderer');\r\n\r\nfunction TerminusDocumentViewer(ui, action, options){\r\n\tthis.ui = ui;\r\n\tthis.server = this.ui.server();\r\n\tthis.db = this.ui.db();\r\n\tthis.init();\r\n\tthis.mode = (options && options.mode ? options.mode : \"view\");\r\n\tthis.editor = (options && options.editor ? options.editor : false);\r\n\tthis.load_schema = (options && options.load_schema ? options.load_schema : true);\r\n\tthis.config_options = this.getBuiltInViewerOptions();\r\n\tthis.options = (options ? options : this.config_options[action]);\r\n\tthis.action = action;\r\n\tthis.document = false;\r\n}\r\n\r\nTerminusDocumentViewer.prototype.init = function(){\r\n\tvar wq = new WOQLQuery(this.ui.client, this.options, this.ui);\r\n\tvar woql = wq.getClassMetaDataQuery();\r\n\tvar self = this;\r\n\tself.classmeta = {};\r\n\tself.instancemeta = {};\r\n\twq.execute(woql).then(function(wresult){\r\n\t\tif(wresult && wresult.hasBindings()){\r\n\t\t\tfor(var i = 0; i<wresult.bindings.length; i++){\r\n\t\t\t\tvar cls = wresult.bindings[i].Class;\r\n\t\t\t\tif(cls && typeof self.classmeta[cls] == \"undefined\"){\r\n\t\t\t\t\tself.classmeta[cls] = wresult.bindings[i];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tself.refreshPage();\r\n\t\t}\r\n\t})\r\n\t.catch(function(e){\r\n\t\tconsole.log(e);\r\n\t});\r\n}\r\n\r\nTerminusDocumentViewer.prototype.getInstanceMeta = function(elid){\r\n\tvar self = this;\r\n\tif(self.instancemeta && typeof self.instancemeta[elid] != \"undefined\") return self.instancemeta[elid] ;\r\n\tvar wq = new WOQLQuery(this.ui.client, this.options, this.ui);\r\n\tvar woql = wq.getInstanceMeta(elid);\r\n\treturn wq.execute(woql).then(function(wresult){\r\n\t\tif(wresult && wresult.hasBindings()){\r\n\t\t\tvar res = wresult.bindings[0];\r\n\t\t\treturn res;\r\n\t\t}\r\n\t\treturn false;\r\n\t})\r\n\t.catch(function(e){\r\n\t\tconsole.log(e);\r\n\t});\r\n}\r\n\r\nTerminusDocumentViewer.prototype.getClassMeta = function(cls){\r\n\tif(typeof this.classmeta[cls]){\r\n\t\treturn this.classmeta[cls];\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nTerminusDocumentViewer.prototype.loadCreateDocument = function(url){\r\n\tif(url){\r\n\t\tthis.ui.showBusy(\"Fetching frame for document class \" + url);\r\n\t\tvar self = this;\r\n\t\tthis.mode = \"edit\";\r\n\t\tthis.page_config = \"create\";\r\n\t\tif(url.indexOf(\"/\") == -1 && url.indexOf(\":\") == -1) {\r\n\t\t\turl = \"schema:\" + url;\r\n\t\t}\r\n\t\treturn this.loadDocumentSchema(url)\r\n\t\t.then(function(response){\r\n\t\t\tself.ui.clearBusy();\r\n\t\t\tself.setLabel();\r\n\t\t})\r\n\t\t.catch(function(error) {\r\n\t\t\tconsole.error(error);\r\n\t\t\tself.ui.clearBusy();\r\n\t\t\tself.ui.showError(error);\r\n\t\t});\r\n\t}\r\n}\r\n\r\nTerminusDocumentViewer.prototype.loadDocument = function(url, cls){\r\n\tif(!url) return false;\r\n\tvar self = this;\r\n\tif(url.substring(0,4) == \"doc:\"){\r\n\t\turl = url.substring(4);\r\n\t}\r\n\tthis.page_config = \"view\";\r\n\turl = url.replace(\"/candidate\", \"/platform/document\");\r\n\tthis.ui.showBusy(\"Loading Document from \" + url);\r\n\treturn this.ui.client.getDocument(url, {\"terminus:encoding\": \"terminus:frame\"})\r\n\t.then(function(response){\r\n\t\tself.ui.clearBusy();\r\n\t\tself.loadDataFrames(response);\r\n\t\tself.setLabel();\r\n\t\tself.refreshPage();\r\n\t\tif(self.load_schema){\r\n\t\t\treturn self.loadDocumentSchema(self.document.cls).then(function(){ self.refreshPage()}).catch(function(e){console.error(e)});\r\n\t\t}\r\n\t\treturn response;\r\n\t})\r\n\t.catch(function(error) {\r\n\t\tconsole.error(error);\r\n\t\tself.ui.clearBusy();\r\n\t\tself.ui.showError(error);\r\n\t});\r\n}\r\n\r\nTerminusDocumentViewer.prototype.loadDocumentSchema = function(cls){\r\n\tvar self = this;\r\n\treturn this.ui.client.getClassFrame(false, cls)\r\n\t.then(function(response){\r\n\t\tself.loadSchemaFrames(response, cls);\r\n\t\tself.refreshPage();\r\n\t});\r\n}\r\n\r\nTerminusDocumentViewer.prototype.deleteDocument = function(URL){\r\n\tthis.document = false;\r\n\tvar self = this;\r\n\tthis.ui.showBusy(\"Deleting Document \" + URL);\r\n\treturn this.ui.client.deleteDocument(URL)\r\n\t.then(function(response){\r\n\t\tself.ui.clearBusy();\r\n\t}).catch(function(error){\r\n\t\tself.ui.clearBusy();\r\n\t\tself.ui.showError(error);\r\n\t});\r\n}\r\n\r\nTerminusDocumentViewer.prototype.createDocument = function(id){\r\n\tvar self = this;\r\n\tvar extr = this.renderer.extract();\r\n\tvar opts = { \"terminus:encoding\": \"jsonld\" };\r\n\tthis.ui.showBusy(\"Creating document\");\r\n\treturn this.ui.client.createDocument(id, extr, opts)\r\n\t.then(function(response){\r\n\t\tself.ui.clearBusy();\r\n\t\tself.ui.showDocument(id);\r\n\t}).catch(function(error){\r\n\t\tself.ui.clearBusy();\r\n\t\tself.ui.showError(error);\r\n\t});\r\n}\r\n\r\nTerminusDocumentViewer.prototype.updateDocument = function(){\r\n\tvar durl = this.document.subjid;\r\n\tvar extr = this.renderer.extract();\r\n\tvar self = this;\r\n\tvar opts = { \"terminus:encoding\": \"jsonld\" };\r\n\tthis.ui.showBusy(\"Updating document \" + durl);\r\n\treturn this.ui.client.updateDocument(durl, extr, opts)\r\n\t.then(function(response){\r\n\t\tself.ui.clearBusy();\r\n\t\tself.ui.showDocument(durl);\r\n\t}).catch(function(error){\r\n\t\tself.ui.clearBusy();\r\n\t\tself.ui.showError(error);\r\n\t});\r\n}\r\n\r\nTerminusDocumentViewer.prototype.loadDataFrames = function(dataframes, cls){\r\n\tif(!cls){\r\n\t\tif(this.document) cls = this.document.cls;\r\n\t\telse {\r\n\t\t\tif(dataframes && dataframes.length && dataframes[0] && dataframes[0].domain){\r\n\t\t\t\tcls = dataframes[0].domain;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tif(cls){\r\n\t\tif(!this.document){\r\n\t\t\tthis.document = new TerminusClient.ObjectFrame(cls, dataframes);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.document.loadDataFrames(dataframes);\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\talert(\"Missing Class\" + \" \" + \"Failed to add dataframes due to missing class\");\r\n\t}\r\n}\r\n\r\n\r\nTerminusDocumentViewer.prototype.loadSchemaFrames = function(classframes, cls){\r\n\tif(!cls){\r\n\t\tif(classframes && classframes.length && classframes[0] && classframes[0].domain){\r\n\t\t\tcls = classframes[0].domain;\r\n\t\t}\r\n\t}\r\n\tif(cls){\r\n\t\tif(!this.document){\r\n\t\t\tthis.document = new TerminusClient.ObjectFrame(cls);\r\n\t\t}\r\n\t\tif(classframes){\r\n\t\t\tthis.document.loadClassFrames(classframes);\r\n\t\t\tif(!this.document.subjid){\r\n\t\t\t\tthis.document.newDoc = true;\r\n\t\t\t\tthis.document.fillFromSchema(\"_:\");\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tthis.error(\"Missing Class\", \"Failed to add class frames due to missing class\");\r\n\t}\r\n}\r\n\r\nTerminusDocumentViewer.prototype.render = function(){\r\n\tif(!this.renderer && this.document){\r\n\t\tif(this.page_config){\r\n\t\t\tthis.options = this.getOptionsFromPageConfig(this.page_config);\r\n\t\t}\r\n\t\ttry{\r\n\t\t\tthis.renderer = new ObjectRenderer(this.document, false, this.options);\r\n\t\t\tthis.renderer.mode = this.mode;\r\n\t\t\tthis.renderer.controller = this;\r\n\t\t\t//this.renderer.setPropertyRenderer(PropertyRenderer)\r\n\t\t}catch(e){\r\n\t \t\tconsole.error('TerminusDocumentViewer render',e.toString())\r\n\t \t}\r\n\t}\r\n\tif(this.renderer){\r\n\t\treturn this.renderer.render();\r\n\t}\r\n}\r\n\r\nTerminusDocumentViewer.prototype.getBuiltInViewerOptions = function(){\r\n\treturn FrameConfig;\r\n}\r\n\r\nTerminusDocumentViewer.prototype.getOptionsFromPageConfig = function(pageconf){\r\n\tif(typeof this.config_options[pageconf] == \"object\") {\r\n\t\treturn this.config_options[pageconf];\r\n\t}\r\n\treturn this.options;\r\n}\r\n\r\n\r\nTerminusDocumentViewer.prototype.getClient = function(){\r\n\treturn this.ui.client;\r\n}\r\n\r\nTerminusDocumentViewer.prototype.extract = function(options){\r\n\treturn this.renderer.extract();\r\n}\r\n\r\nTerminusDocumentViewer.prototype.getLabel = function(){\r\n\tvar lab = (this.cls ? this.cls : false);\r\n\tif(!lab) lab = (this.docid ? this.docid : \"Void\");\r\n\treturn lab;\r\n}\r\n\r\nTerminusDocumentViewer.prototype.setLabel = function(){\r\n\tif(this.document && this.labdom){\r\n\t\tTerminusClient.FrameHelper.removeChildren(this.labdom);\r\n\t\tvar dfs = this.document.getDataFrames(TerminusClient.FrameHelper.getStdURL(\"rdfs\", \"label\"));\r\n\t\tfor(var i = 0; i< dfs.length; i++){\r\n\t\t\tvar lab = dfs[i].get();\r\n\t\t\tif(lab) {\r\n\t\t\t\tthis.labdom.appendChild(document.createTextNode(lab));\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\nTerminusDocumentViewer.prototype.refreshPage = function(){\r\n\tif(this.pagedom){\r\n\t\tTerminusClient.FrameHelper.removeChildren(this.pagedom);\r\n\t\tvar rends = this.render();\r\n\t\tif(rends){\r\n\t\t\tthis.pagedom.appendChild(rends);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nTerminusDocumentViewer.prototype.getAsDOM = function(){\r\n\tvar holder = document.createElement(\"div\");\r\n\tholder.setAttribute(\"class\", \"terminus-document-holder\");\r\n\tif(this.mode !== 'edit'){ // dont provide drop down on create mode\r\n\t\tthis.controldom = document.createElement(\"div\");\r\n\t\tthis.controldom.setAttribute(\"class\", \"terminus-document-controller\");\r\n\t\tthis.controldom.appendChild(this.getDocumentPageControls());\r\n\t\tholder.appendChild(this.controldom);\r\n\t}\r\n\tthis.pagedom = document.createElement(\"div\");\r\n\tthis.pagedom.setAttribute(\"class\", \"terminus-document-page\");\r\n\tvar rends = this.render();\r\n\tif(rends){\r\n\t\tthis.pagedom.appendChild(rends);\r\n\t}\r\n\tholder.appendChild(this.pagedom);\r\n\treturn holder;\r\n}\r\n\r\nTerminusDocumentViewer.prototype.getDocumentPageControls = function(){\r\n\tvar dpc = document.createElement(\"select\");\r\n\tdpc.setAttribute(\"class\", \"terminus-form-select terminus-document-config\");\r\n\tfor(var i in this.config_options){\r\n\t\tif(i === 'create') continue; // create docuemnt option from config is not taken in edit mode \r\n\t\tvar opt = document.createElement(\"option\");\r\n\t\topt.value = i;\r\n\t\tif(this.page_config == i){\r\n\t\t\topt.selected = true;\r\n\t\t}\r\n\t\topt.appendChild(document.createTextNode(this.config_options[i].label));\r\n\t\tdpc.appendChild(opt);\r\n\t}\r\n\tvar self = this;\r\n\tdpc.addEventListener(\"change\", function(){\r\n\t\tself.page_config = this.value;\r\n\t\tself.renderer = false;\r\n\t\tself.refreshPage();\r\n\t})\r\n\treturn dpc;\r\n}\r\n\r\nmodule.exports=TerminusDocumentViewer\r\n","const WOQLResultsViewer = require('../query/WOQLResultsViewer');\r\nconst UTILS= require('../Utils')\r\n\r\nfunction Datatables(){}\r\n\r\nDatatables.prototype.convertToDatatable = function(tab, ui){\r\n    var table = jQuery(tab).DataTable({\r\n         searching : false,\r\n         pageLength: 25,\r\n         lengthMenu: [10, 25, 50, 75, 100],\r\n         paging    : true,\r\n         select    : true,\r\n         columnDefs:[{targets:'_all',className:\"truncate\"}],\r\n         createdRow: function(row) {\r\n                            var td = $(row).find(\".truncate\");\r\n                            td.attr(\"title\", td.html());}\r\n    }); //jQuery(tab)\r\n\r\n    // on click of row connect to db, on click of 5th column delete db\r\n    jQuery(tab, 'tbody').on('click', 'td', function(){\r\n        if(table.cell(this).index().column == 5){\r\n            var dbInfo = table.row(jQuery(this).parents('tr')).data();\r\n            var dbId = UTILS.extractValueFromCell(dbInfo[0]);\r\n            ui.deleteDatabase(dbId);\r\n            return;\r\n        }\r\n        else ui.showDBMainPage();\r\n     }); // on click\r\n\r\n    tab.setAttribute('class'      , 'stripe dataTable terminus-db-size');\r\n    tab.setAttribute('cellpadding', '1');\r\n    tab.setAttribute('cellspacing', '0');\r\n    tab.setAttribute('border'     , '0');\r\n    return tab;\r\n}\r\n\r\n/*\r\n    dcb: datatable drawCallBack reference\r\n    ui: terminus ui reference\r\n    dt: datatable reference\r\n    query: new woqlquery with current pagination changes\r\n    pageInfo: current drawCallBack page change info\r\n    resultDOM: result dom on veiwer page\r\n*/\r\nDatatables.prototype.executeQuery = function(dcb, ui, dt, query, pageInfo, resultDOM){\r\n    var self = this;\r\n    dcb.wquery.execute(query)\r\n      .then(function(result){\r\n          if(true || !self.result){\r\n              self.result = new WOQLResultsViewer.WOQLResultsViewer(ui, result, null, pageInfo);\r\n          }\r\n          var rtab = self.result.getTable(result.bindings);\r\n          if(rtab){\r\n              self.getDataFromServer(rtab, pageInfo, ui, resultDOM);\r\n          }\r\n      })\r\n      .catch(function(err){\r\n          console.error(err);\r\n          self.ui.showError(err);\r\n      });\r\n}\r\n\r\n/* get query string based on datatable pagination and current query */\r\nDatatables.prototype.getQueryOnPagination = function(wq, settings){\r\n    switch(settings.query){\r\n        case 'Show_All_Documents':\r\n            return wq.getAllDocumentQuery(null, settings.pageLength, settings.start);\r\n        break;\r\n        case 'Show_All_Data':\r\n            return wq.getEverythingQuery(null, settings.pageLength, settings.start);\r\n        break;\r\n        case 'Show_All_Schema_Elements':\r\n            return wq.getElementMetaDataQuery(null, settings.pageLength, settings.start);\r\n        break;\r\n        case 'Show_Document_Classes':\r\n        \tvar sqp = wq.getConcreteDocumentClassPattern(\"Class\");\r\n            return wq.getClassMetaDataQuery(sqp);\r\n        break;\r\n        case 'Show_All_Properties':\r\n            return wq.getPropertyListQuery(null, settings.pageLength, settings.start);\r\n        break;\r\n        case 'Show_All_Classes':\r\n            return wq.getClassMetaDataQuery(null, settings.pageLength, settings.start);\r\n        break;\r\n        case 'Show_Data_Class':\r\n            return  wq.getDataOfChosenClassQuery(settings.chosenValue, settings.pageLength, settings.start);\r\n        break;\r\n        case 'Show_Property_Class':\r\n            return wq.getDataOfChosenPropertyQuery(settings.chosenValue, settings.pageLength, settings.start);\r\n        break;\r\n        case 'Show_Document_Info_by_Id':\r\n            return wq.getDocumentQuery(settings.chosenValue, settings.pageLength, settings.start);\r\n        break;\r\n        default:\r\n            console.log('Invalid woql option passed');\r\n        break;\r\n\r\n    }\r\n}\r\n\r\n/*\r\n    dcb: datatable drawCallBack reference\r\n    ui: terminus ui reference\r\n    dt: datatable reference\r\n    pageInfo: current drawCallBack page change info\r\n*/\r\nDatatables.prototype.generateNewQueryOnPageChange = function(dcb, ui, dt, pageInfo){\r\n    dcb.wquery = new WOQLQuery(ui.client, null);\r\n    UTILS.deleteStylizedEditor(ui, pageInfo.qTextDom);\r\n    var query = dt.getQueryOnPagination(dcb.wquery, pageInfo)\r\n    pageInfo.qTextDom.value = JSON.stringify(query);\r\n    UTILS.stylizeEditor(ui, pageInfo.qTextDom, 'query', 'javascript');\r\n    return query;\r\n}\r\n\r\n/*\r\n    dt: Datatable reference\r\n    len : current number of records to display\r\n*/\r\nDatatables.prototype.getCallbackSettings = function(dt, len, start){\r\n    var pageInfo = {};\r\n    pageInfo.pageLength = len;\r\n    pageInfo.start      = start;\r\n    pageInfo.qTextDom   = dt.qTextDom;\r\n    pageInfo.query      = dt.query;\r\n    pageInfo.chosenValue = dt.chosenValue;\r\n    return pageInfo;\r\n}\r\n\r\n/*\r\n    tab: datatable table dom\r\n    settings : settings from woql txt generator\r\n    resultDOM: result dom of viewer\r\n*/\r\nDatatables.prototype.setUp = function(tab, settings, resultDOM){\r\n    // delete previous datatable\r\n    TerminusClient.FrameHelper.removeChildren(this.dtdom);\r\n    this.dtdom = document.createElement('div');\r\n    this.dtdom.appendChild(tab);\r\n    resultDOM.appendChild(this.dtdom);\r\n    // saving query text box dom to change limit value on change of datatable page length\r\n    this.qTextDom = settings.qTextDom;\r\n    this.query = settings.query;\r\n    this.chosenValue = settings.chosenValue;\r\n}\r\n\r\nDatatables.prototype.getDataFromServer = function(dtResult, settings, ui, resultDOM){\r\n    var dt = this;\r\n    var tab = dtResult.tab;\r\n    this.setUp(tab, settings, resultDOM);\r\n    // initialize datatables\r\n    var table = jQuery(tab).DataTable({\r\n         searching   : false,\r\n         pageLength  : settings.pageLength,\r\n         processing  : true,\r\n         lengthMenu  : [5, 10, 25, 50, 75, 100],\r\n         dom         : 'Blfrtip',\r\n         columns     : dtResult.result.columns,\r\n         paging      : true,\r\n         select      : true,\r\n         data        : dtResult.result.data.data,\r\n         buttons     : ['copy', 'excel'],\r\n         columnDefs  :[{targets:'_all',className:\"truncate\"}],\r\n         createdRow  : function(row){\r\n                            var td = $(row).find(\".truncate\");\r\n                            td.attr(\"title\", td.html());},\r\n         colReorder  : {addFixed : true, liveDrag:true},\r\n         scrollX     : true,\r\n         drawCallback: function(settings) {\r\n                             //console.log('draw call back ', this.api().page.info());\r\n                             // on change of page length\r\n                             $(this).on( 'length.dt', function (e, settings, len){\r\n                                  var info = table.page.info();\r\n                                  var pageInfo = dt.getCallbackSettings(dt, len, info.start);\r\n                                  var query = dt.generateNewQueryOnPageChange(this, ui, dt, pageInfo);\r\n                                  return dt.executeQuery(this, ui, dt, query, pageInfo, resultDOM);\r\n                             });\r\n                             // pagination\r\n                             $(this).on( 'page.dt', function () {\r\n                                var info = table.page.info();\r\n                                var pageInfo = dt.getCallbackSettings(dt, info.length, info.start);\r\n                                var query = dt.generateNewQueryOnPageChange(this, ui, dt, pageInfo);\r\n                                return dt.executeQuery(this, ui, dt, query, pageInfo, resultDOM);\r\n                             });\r\n        }\r\n    }); //jQuery(tab)\r\n\r\n    //styling\r\n    tab.setAttribute('class'      , 'stripe dataTable');\r\n    //tab.setAttribute('style'       , 'table-layout: fixed;')\r\n    tab.setAttribute('cellpadding', '1');\r\n    tab.setAttribute('cellspacing', '1');\r\n    tab.setAttribute('border'     , '0');\r\n\r\n    return tab;\r\n}\r\n\r\n/*\r\nserverside: true or false\r\n*/\r\nDatatables.prototype.draw = function(serverside, dtResult, settings, ui, resultDOM){\r\n    if(serverside)\r\n        return(this.getDataFromServer(dtResult, settings, ui, resultDOM));\r\n    else return(this.convertToDatatable(dtResult, ui));\r\n}\r\n\r\nmodule.exports=Datatables\r\n","function HTMLDateHelper(){\r\n\tthis.months = [\"January\", \"Februrary\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"];\r\n}\r\n\r\nHTMLDateHelper.prototype.getMonthName = function(num){\r\n\treturn this.months[num-1];\r\n}\r\n\r\nmodule.exports={HTMLDateHelper}","const WOQLQuery = require('../query/WOQLQuery');\r\nconst TerminusClassChooser = require('./TerminusClassChooser');\r\n/*\r\n * Utility class which allows the user to choose a document by id or by label (if select2 and full text indexing is turned on)\r\n */\r\n\r\nTerminusDocumentChooser = function(ui, root, value, view){\r\n\tthis.ui = ui;\r\n\tthis.root = root;\r\n\t//this.filter = (currentcls ? TerminusClient.FrameHelper.unshorten(currentcls) : false);\r\n\r\n\tthis.choice = value;\r\n\tthis.view = (view ? view : \"id\");\r\n\tthis.show_button = true;\r\n}\r\n\r\nTerminusDocumentChooser.prototype.setRoot = function(root){\r\n\tthis.root = root;\r\n}\r\n\r\nTerminusDocumentChooser.prototype.setFilter = function(filter){\r\n\tthis.filter = filter;\r\n}\r\n\r\nTerminusDocumentChooser.prototype.change = function(docid){\r\n\talert(\"Need to specify doc chooser function (\" + docid + \")\");\r\n}\r\n\r\nTerminusDocumentChooser.prototype.getAsDOM = function(style){\r\n\tif(this.view == \"label\" && \tthis.ui.client.connectionConfig.platformEndpoint() && this.ui.pluginAvailable(\"select2\")){\r\n\t\treturn this.getS2DOM(style);\r\n\t}\r\n\treturn this.getIDDOM();\r\n}\r\n\r\nTerminusDocumentChooser.prototype.getS2DOM = function(style){\r\n\tvar docchooser = document.createElement(\"span\");\r\n\tdocchooser.setAttribute(\"class\", \"terminus-document-chooser terminus-doc-holder\");\r\n\tvar wq = new WOQLQuery(this.ui.client, {}, this.ui);\r\n\tvar cfilter = wq.getSubclassQueryPattern(\"v:Class\", \"'\"+this.root+\"'\");\r\n\tvar termcc = new TerminusClassChooser(this.ui, cfilter);\r\n\ttermcc.empty_choice = \"Filter by Type\";\r\n\ttermcc.show_single = false;\r\n\tvar self = this;\r\n\ttermcc.change = function(new_class){\r\n\t\tif(new_class){\r\n\t\t\tself.filter = new_class;\r\n\t\t}\r\n\t}\r\n\ttdom = termcc.getAsDOM(style);\r\n\tif(tdom) docchooser.appendChild(tdom);\r\n\tvar holder = document.createElement(\"span\");\r\n\tholder.setAttribute(\"class\", \"terminus-entity-reference-value\");\r\n\tvar sel = document.createElement(\"select\");\r\n\tsel.setAttribute(\"class\", \"terminus-entity-class-input\");\r\n\tholder.appendChild(sel);\r\n\tvar opt = document.createElement(\"option\");\r\n\tvar lookup = function (params) {\r\n\t\tparams.class = self.filter;\r\n\t\treturn JSON.stringify(params);\r\n    }\r\n\tvar searchurl = this.ui.client.dbURL() + \"/search\";\r\n\tvar s2config = {\r\n\t\tajax: {\r\n\t\t    url: searchurl,\r\n\t\t    dataType: 'json',\r\n\t\t    data: lookup,\r\n\t\t    type: \"POST\",\r\n\t\t\tcontentType: \"application/json; charset=utf-8\",\r\n\t\t    delay: 250,\r\n\t\t    cache: true\r\n\t\t},\r\n\t\tplaceholder: \"Enter Document Name\",\r\n\t\twidth: 200\r\n\t};\r\n\tjQuery(sel).select2(s2config).change(function(){\r\n\t\tcallback(this.value);\r\n\t});\r\n\tdocchooser.appendChild(holder);\r\n\treturn docchooser;\r\n}\r\n\r\nTerminusDocumentChooser.prototype.getIDDOM = function(){\r\n\tvar docchooser = document.createElement(\"span\");\r\n\tdocchooser.setAttribute(\"class\", \"terminus-document-chooser terminus-doc-holder\");\r\n\tvar dcip = document.createElement(\"input\");\r\n\tdcip.setAttribute(\"class\", \"terminus-document-chooser terminus-query-text\");\r\n\t//11092019 dcip.setAttribute(\"class\", \"terminus-form-value terminus-document-chooser\");\r\n\tdcip.setAttribute(\"placeholder\", \"Enter Document ID\");\r\n\tdcip.addEventListener('keypress', function(e){\r\n\t\tvar key = e.which || e.keyCode;\r\n\t\t// on enter\r\n\t\tif (key === 13 && dcip.value) {\r\n\t\t\tself.choice = dcip.value;\r\n\t\t\tself.change(dcip.value);\r\n\t\t}\r\n\t});\r\n\tdocchooser.appendChild(dcip);\r\n\tif(this.show_button){\r\n\t\tvar dbut = document.createElement(\"button\");\r\n\t\tdbut.setAttribute(\"class\", \"terminus-control-button terminus-btn\");\r\n\t\tvar self = this;\r\n\t\tdbut.addEventListener(\"click\", function(){\r\n\t\t\tif(dcip.value) {\r\n\t\t\t\tself.choice = dcip.value;\r\n\t\t\t\tself.change(dcip.value);\r\n\t\t\t}\r\n\t\t});\r\n\t\t//11092019 dbut.appendChild(document.createTextNode(\"View Document Properties\"));\r\n\t\tdbut.appendChild(document.createTextNode(\"Go\"));\r\n\t\tdocchooser.appendChild(dbut);\r\n\t}\r\n\treturn docchooser;\r\n}\r\n\r\nTerminusDocumentChooser.prototype.toggleView = function(){\r\n\tif(this.view == \"id\") this.view = \"label\";\r\n\telse this.view = \"id\";\r\n}\r\n\r\nTerminusDocumentChooser.prototype.getChangeViewText = function(){\r\n\tif(this.view == \"id\"){\r\n\t\treturn \"Document Lookup\";\r\n\t}\r\n\treturn \"Load Document ID\";\r\n}\r\n\r\nmodule.exports=TerminusDocumentChooser\r\n","const TerminusUI = require('./TerminusUI');\r\nconst RenderingMap = require('./client/RenderingMap');\r\n\r\nvar terminator = new TerminusUI(TerminusConfig);\r\nvar pconfig = {};\r\npconfig.buttons = {'client'   : document.getElementById(\"terminus-client-btn\"),\r\n\t\t\t\t   'explorer' : document.getElementById(\"terminus-explorer-btn\")}\r\npconfig.controller \t= document.getElementById(\"terminus-control-panel\");\r\npconfig.messages = document.getElementById(\"terminus-user-messages\");\r\npconfig.plugins = document.getElementById(\"terminus-plugin-loader\");\r\npconfig.explorer = document.getElementById(\"terminus-explorer\");\r\npconfig.viewer = document.getElementById(\"terminus-content-viewer\");\r\nvar nlocation = (TerminusConfig && TerminusConfig.location) ? TerminusConfig.location : false;\r\nterminator.draw(pconfig, nlocation);\r\n\r\nfunction showPanel(mode){\r\n\ttoggleHeaders(mode, document.getElementById(\"terminus-content-viewer\"));\r\n}\r\n\r\nmodule.exports={TerminusUI:TerminusUI,\r\n                RenderingMap:RenderingMap}","/**\r\n * Terminus UI object\r\n *\r\n * Traffic control of messages going between different Terminus UI pages and features\r\n *\r\n * @param opts - options array\r\n */\r\nconst ApiExplorer = require('./ApiExplorer');\r\nconst TerminusDocumentViewer = require('./client/TerminusDocument');\r\nconst TerminusDBsdk = require('./client/TerminusDB');\r\nconst TerminusViolations = require('./client/TerminusViolation');\r\nconst TerminusQueryViewer = require('./client/TerminusQuery');\r\nconst TerminusMappingViewer = require('./client/TerminusMapping');\r\nconst TerminusSchemaViewer = require('./client/TerminusSchema');\r\nconst TerminusServersdk = require('./client/TerminusServer');\r\nconst TerminusURLLoader = require('./client/TerminusURL');\r\nconst TerminusPluginManager = require('./plugins/TerminusPlugin');\r\nconst UTILS=require('./Utils');\r\n\r\nfunction TerminusUI(opts){\r\n\tthis.client = new TerminusClient.WOQLClient();\r\n\tthis.controls = [];\r\n\tthis.setOptions(opts);\r\n}\r\n\r\n/*\r\n * Client connects to specified server and specified part\r\n * opts is a json with the following fields:\r\n * server: mandatory URL of the server to connect to\r\n * key: optional client API key\r\n * dbid: id of the database to connect to\r\n * schema: if set, the UI will load the schema page after connecting\r\n * query: if set, the query will be sent to the server and the results will be loaded on the query page\r\n * document: if set, the document page corresponding to this document will be loaded after connecting\r\n *\r\n * (note: schema, query, document are mutually exclusive and must also have a dbid set)\r\n */\r\nTerminusUI.prototype.connect = function(opts){\r\n\tvar self = this;\r\n\tthis.client.connectionConfig.server = false;\r\n\tvar key = ((opts && opts.key) ? opts.key : false);\r\n\tthis.showBusy(\"Connecting to server at \" + opts.server);\r\n\treturn this.client.connect(opts.server, key)\r\n\t.then( function(response) {\r\n\t\tself.clearBusy();\r\n\t\tif(opts && opts.db && self.getDBRecord(opts.db)){\r\n\t\t\tself.connectToDB(opts.db);\r\n\t\t\tif(opts.document && self.showView(\"get_document\")){\r\n\t\t\t\tself.showDocument(opts.document);\r\n\t\t\t}\r\n\t\t\telse if(opts.schema && self.showView(\"get_schema\")){\r\n\t\t\t\tself.showSchemaPage(opts.schema);\r\n\t\t\t}\r\n\t\t\telse if(opts.query && self.showView(\"woql_select\")){\r\n\t\t\t\tself.showQueryPage(opts.query);\r\n\t\t\t}\r\n\t\t\telse if(opts.explorer && self.showView(\"api_explorer\")){\r\n\t\t\t\tself.showExplorer(opts.explorer);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tself.showDBMainPage();\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tself.showServerMainPage();\r\n\t\t}\r\n\t\tself.redraw();\r\n\t})\r\n\t.catch(function(err) {\r\n\t\tself.clearBusy();\r\n\t\tself.showError(err);\r\n\t});\r\n}\r\n\r\n/**\r\n * Sends a request to create a new database to the server and interprets the response\r\n *\r\n * dbdets is a json object with the following fields:\r\n * id: the id of the new database (alphanumeric, no spaces, url friendly) mandatory\r\n * title: the text name of the new database for tables, etc. mandatory\r\n * description: text description of the database (optional)\r\n * key: a API client key for server auth\r\n * schema: the url of another Terminus DB from which to import schema\r\n * instance: the url of another Terminus DB from which to import data\r\n *\r\n */\r\nTerminusUI.prototype.createDatabase = function(dbdets){\r\n\tvar self = this;\r\n\tif(!dbdets.id || !dbdets.title){\r\n        return Promise.reject(new Error(self.getBadArguments(\"createDatabase\", \"ID and title are mandatory fields\")));\r\n\t}\r\n\tvar dbid = dbdets.id;\r\n\tvar myserver = this.client.connectionConfig.server;\r\n\tself.showBusy(\"Creating Database \" + dbdets.title + \" with id \" + dbid);\r\n\tvar dbdoc = this.generateNewDatabaseDocument(dbdets);\r\n\treturn this.client.createDatabase(dbid, dbdoc)\r\n\t.then(function(response){ //import schema into newly created DB\r\n\t\tif(dbdets.schema){\r\n\t\t\tself.showBusy(\"Fetching imported schema from \" + dbdets.schema);\r\n\t\t\tvar opts = (dbdets.key ?  {\"terminus:user_key\": dbdets.key } : {});\r\n\t\t\topts['terminus:encoding'] = \"terminus:turtle\";\r\n\t\t\treturn self.client.getSchema(dbdets.schema, opts)\r\n\t\t\t.then(function(response){\r\n\t\t\t\tself.showBusy(\"Updating database with new schema\");\r\n\t\t\t\tself.client.connectionConfig.server = myserver;\r\n\t\t\t\tself.client.connectionConfig.dbid = dbid;\r\n\t\t\t\tvar nopts = {'terminus:encoding':  \"terminus:turtle\"};\r\n\t\t\t\treturn self.client.updateSchema(false, response, nopts);\r\n\t\t\t})\r\n\t\t\t.then(function(response){\r\n\t\t\t\tself.clearBusy();\r\n\t\t\t\tself.redraw();\r\n\t\t\t\treturn response;\r\n\t\t\t});\r\n\t\t}\r\n\t\telse {\r\n\t\t\tself.clearBusy();\r\n\t\t}\r\n\t\treturn response;\r\n\t})\r\n\t.then(function(response){ //reload list of databases in background..\r\n\t\treturn self.refreshDBList()\r\n\t\t.then(function(response){\r\n\t\t\tif(crec = self.client.connection.getDBRecord(dbid)){\r\n\t\t\t\tself.client.connectionConfig.dbid = dbid;\r\n\t\t\t\tself.showDBMainPage();\r\n\t\t\t\tself.showMessage(\"Successfully Created Database \" + dbid, \"success\");\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t        return Promise.reject(new Error(self.getCrashString(\"createDatabase\", \"Failed to retrieve record of created database \" + dbid)));\r\n\t\t\t}\r\n\t\t})\r\n\t})\r\n\t.catch(function(error){\r\n\t\tself.clearBusy();\r\n\t\tself.showError(error);\r\n\t});\r\n}\r\n\r\n/**\r\n * Deletes the database with the passed id from the currently connected server\r\n */\r\nTerminusUI.prototype.deleteDatabase = function(dbid){\r\n\tvar self = this;\r\n\tvar delrec = this.client.connection.getDBRecord();\r\n\tvar lid = (dbid ? dbid : this.db());\r\n\tvar dbn = (delrec && delrec['rdfs:label'] && delrec['rdfs:label'][\"@value\"] ? delrec['rdfs:label'][\"@value\"] + \" (id: \" + lid + \")\" : lid);\r\n\tthis.showBusy(\"Deleting database \" + dbn);\r\n\treturn this.client.deleteDatabase(dbid)\r\n\t.then(function(response){\r\n\t\tself.clearBusy();\r\n\t\tself.client.connectionConfig.dbid = false;\r\n\t\tself.removeDB(dbid);\r\n\t\tself.showServerMainPage();\r\n\t\tself.showMessage(\"Successfully Deleted Database \" + dbn, \"success\");\r\n\t\tself.refreshDBList();\r\n\t\treturn response;\r\n\t})\r\n\t.catch(function(error){\r\n\t\tself.clearBusy();\r\n\t\tself.showError(error);\r\n\t});\r\n}\r\n\r\n/*\r\n * Transforms a details (id, title, description) array into  json-ld document\r\n */\r\nTerminusUI.prototype.generateNewDatabaseDocument = function(dets){\r\n\tvar doc = {\r\n\t\t\"@context\" : {\r\n\t\t\trdfs: \"http://www.w3.org/2000/01/rdf-schema#\",\r\n\t\t\tterminus: \"http://terminusdb.com/schema/terminus#\"\r\n\t\t},\r\n\t\t\"@type\": \"terminus:Database\"\r\n\t}\r\n\tif(dets.title){\r\n\t\tdoc['rdfs:label'] = {\r\n\t\t\t\"@language\":  \"en\",\r\n\t\t\t\"@value\": dets.title\r\n\t\t};\r\n\t}\r\n\tif(dets.description){\r\n\t\tdoc['rdfs:comment'] = {\r\n\t\t\t\"@language\":  \"en\",\r\n\t\t\t\"@value\": dets.description\r\n\t\t};\r\n\t}\r\n\tdoc['terminus:allow_origin'] = { \"@type\" : \"xsd:string\", \"@value\" : \"*\" };\r\n\treturn doc;\r\n}\r\n\r\nTerminusUI.prototype.getBadArguments = function(fname, str){\r\n\treturn \"Bad arguments to \" + fname + \": \" + str;\r\n}\r\n\r\nTerminusUI.prototype.getCrashString = function(fname, str){\r\n\treturn \"Results from \" + fname + \" indicate the possibility of a system failure \" + str;\r\n}\r\n\r\n/*\r\n * Parses the passed URL and turns it into a call to the connect function - loads the appropriate endpoing\r\n */\r\nTerminusUI.prototype.load = function(url, key){\r\n\tvar args = {};\r\n\tif(url && url.indexOf(\"/document/\") != -1){\r\n\t\turl = url.substring(0, url.indexOf(\"/document/\"));\r\n\t\targs.document = url.substring(url.indexOf(\"/document/\")+10);\r\n\t}\r\n\telse if(url && url.indexOf(\"/schema\") != -1){\r\n\t\turl = url.substring(0, url.indexOf(\"/schema\"));\r\n\t\targs.schema = {};\r\n\t}\r\n\telse if(url && url.indexOf(\"/woql\") != -1){\r\n\t\turl = url.substring(0, url.indexOf(\"/query\"));\r\n\t\targs.query = url.substring(url.indexOf(\"/query\")+7);\r\n\t}\r\n\targs.server = url;\r\n\tif(key) args.key = key;\r\n\treturn this.connect(args);\r\n}\r\n\r\n/**\r\n * Fetches the DB URL from the url by chopping off the extra bits\r\n */\r\nTerminusUI.prototype.getConnectionEndpoint = function(url){\r\n\tif(url && url.lastIndexOf(\"/schema\") != -1){\r\n\t\treturn url.substring(0, url.lastIndexOf(\"/schema\"));\r\n\t}\r\n\tif(url && url.lastIndexOf(\"/document\") != -1){\r\n\t\treturn url.substring(0, url.lastIndexOf(\"/document\"));\r\n\t}\r\n\tif(url && url.lastIndexOf(\"/frame\") != -1){\r\n\t\treturn url.substring(0, url.lastIndexOf(\"/frame\"));\r\n\t}\r\n\tif(url && url.lastIndexOf(\"/woql\") != -1){\r\n\t\treturn url.substring(0, url.lastIndexOf(\"/woql\"));\r\n\t}\r\n\treturn url;\r\n}\r\n\r\nTerminusUI.prototype.server = function(){\r\n\treturn this.client.connectionConfig.server;\r\n}\r\n\r\nTerminusUI.prototype.db = function(){\r\n\treturn this.client.connectionConfig.dbid;\r\n}\r\n\r\nTerminusUI.prototype.clearServer = function(){\r\n\tthis.client.connectionConfig.server = false;\r\n}\r\n\r\nTerminusUI.prototype.connectToDB = function(dbid){\r\n\tthis.client.connectionConfig.dbid = dbid;\r\n\tTerminusClient.FrameHelper.standard_urls['doc'] = this.client.connectionConfig.dbURL() + \"/document/\";\r\n}\r\n\r\nTerminusUI.prototype.clearDB = function(){\r\n\tthis.client.connectionConfig.dbid = false;\r\n}\r\n\r\nTerminusUI.prototype.removeDB = function(db, url){\r\n\tthis.client.connection.removeDBFromConnection(db, url);\r\n}\r\n\r\nTerminusUI.prototype.getDBRecord = function(db, url){\r\n\treturn this.client.connection.getDBRecord(db, url);\r\n}\r\n\r\nTerminusUI.prototype.refreshDBList = function(){\r\n\tvar self = this;\r\n\treturn this.client.connect();\r\n}\r\n\r\nTerminusUI.prototype.showServerMainPage = function(){\r\n\tthis.viewer = new TerminusServersdk.TerminusServerViewer(this);\r\n\tthis.redrawMainPage();\r\n}\r\n\r\nTerminusUI.prototype.showLoadURLPage = function(val){\r\n\tthis.viewer = new TerminusURLLoader(this, val);\r\n\tthis.redrawMainPage();\r\n}\r\n\r\nTerminusUI.prototype.showDBMainPage = function(){\r\n\tthis.viewer = new TerminusDBsdk.TerminusDBViewer(this);\r\n\tthis.redraw();\r\n}\r\n\r\nTerminusUI.prototype.showCreateDBPage = function(){\r\n\tthis.viewer = new TerminusDBsdk.TerminusDBCreator(this);\r\n\tthis.redrawMainPage();\r\n}\r\n\r\nTerminusUI.prototype.showSchemaPage = function(durl){\r\n\tthis.viewer = new TerminusSchemaViewer(this);\r\n\tthis.redrawMainPage();\r\n}\r\n\r\nTerminusUI.prototype.showQueryPage = function(query){\r\n\tthis.viewer = new TerminusQueryViewer(this, query, this.options);\r\n\tthis.redrawMainPage();\r\n}\r\n\r\nTerminusUI.prototype.showMappingPage = function(mapping){\r\n\tthis.viewer = new TerminusMappingViewer(this, mapping, this.options);\r\n\tthis.redrawMainPage();\r\n}\r\n\r\nTerminusUI.prototype.showDocument = function(durl){\r\n\tthis.viewer = new TerminusDocumentViewer(this, \"view\", this.getDocViewerOptions());\r\n\tthis.viewer.loadDocument(durl);\r\n\tthis.redrawMainPage();\r\n}\r\n\r\nTerminusUI.prototype.showCreateDocument = function(durl){\r\n\tthis.viewer = new TerminusDocumentViewer(this, \"create\", this.getDocCreatorOptions());\r\n\tthis.viewer.loadCreateDocument(durl);\r\n\tthis.redrawMainPage();\r\n}\r\n\r\nTerminusUI.prototype.redrawMainPage = function(){\r\n\tTerminusClient.FrameHelper.removeChildren(this.main);\r\n\tif(this.viewer){\r\n\t\tthis.main.appendChild(this.viewer.getAsDOM());\r\n\t}\r\n}\r\n\r\nTerminusUI.prototype.showResult = function(response){\r\n\tthis.showMessage(response, \"success\");\r\n};\r\n\r\nTerminusUI.prototype.showError = function(response){\r\n\tthis.showMessage(response, \"error\");\r\n};\r\n\r\nTerminusUI.prototype.clearMessages = function(response){\r\n\tif(this.messages) TerminusClient.FrameHelper.removeChildren(this.messages);\r\n};\r\n\r\nTerminusUI.prototype.clearMainPage = function(){\r\n\tif(this.main) TerminusClient.FrameHelper.removeChildren(this.main);\r\n}\r\n\r\nTerminusUI.prototype.setMessageDOM = function(dom){\r\n\tthis.messages = dom;\r\n}\r\n\r\nTerminusUI.prototype.setbuttonControls = function(dom){\r\n\tthis.buttons = dom;\r\n}\r\n\r\nTerminusUI.prototype.setControllerDOM = function(dom){\r\n\tthis.controller = dom;\r\n}\r\n\r\nTerminusUI.prototype.setExplorerDOM = function(dom){\r\n\tthis.explorer = dom;\r\n}\r\n\r\nTerminusUI.prototype.setPluginsDOM = function(dom){\r\n\tthis.plugins = dom;\r\n}\r\n\r\nTerminusUI.prototype.setViewerDOM = function(dom){\r\n\tthis.main = dom;\r\n}\r\n\r\nTerminusUI.prototype.draw = function(comps, slocation){\r\n\tif(comps && comps.buttons) this.setbuttonControls(comps.buttons);\r\n\tif(comps && comps.messages) this.setMessageDOM(comps.messages);\r\n\tif(comps && comps.controller) this.setControllerDOM(comps.controller);\r\n\tif(comps && comps.explorer) this.setExplorerDOM(comps.explorer);\r\n\tif(comps && comps.viewer) this.setViewerDOM(comps.viewer);\r\n\tif(comps && comps.plugins) this.setPluginsDOM(comps.plugins);\r\n\tif(this.plugins){\r\n\t\tthis.drawPlugins();\r\n\t}\r\n\tvar self = this;\r\n\tvar cdrawn = false;\r\n\tif(slocation && slocation.server){\r\n\t\tif(typeof this.client.connection.connection[slocation.server] == \"undefined\") {\r\n\t\t\tthis.connect(slocation)\r\n\t\t\t.catch(function(error){\r\n\t\t\t\tthis.showLoadURLPage();\r\n\t\t\t\tthis.showError(error);\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tif(this.controller){\r\n\t\t\tthis.drawControls();\r\n\t\t}\r\n\t\tthis.showLoadURLPage();\r\n\t};\r\n\tif(this.buttons){\r\n\t\tthis.toggleControl();\r\n\t}\r\n}\r\n\r\n\r\n\r\nTerminusUI.prototype.redraw = function(msg){\r\n\tthis.clearMessages();\r\n\tif(this.controller){\r\n\t\tTerminusClient.FrameHelper.removeChildren(this.controller);\r\n\t\tthis.drawControls();\r\n\t}\r\n\tif(this.explorer){\r\n\t\tTerminusClient.FrameHelper.removeChildren(this.explorer);\r\n\t\t//this.drawExplorer();\r\n\t}\r\n\tif(this.viewer){\r\n\t\tthis.redrawMainPage();\r\n\t}\r\n\tif(msg) this.showMessage(msg);\r\n};\r\n\r\n\r\nTerminusUI.prototype.toggleDashboardWidget = function(widget){\r\n    TerminusClient.FrameHelper.removeChildren(this.controller);\r\n    TerminusClient.FrameHelper.removeChildren(this.explorer);\r\n    UTILS.removeSelectedNavClass('terminus-dashboard-selected');\r\n    widget.classList.add('terminus-dashboard-selected');\r\n}\r\n\r\nTerminusUI.prototype.toggleControl = function(){\r\n  var self = this;\r\n  this.buttons.client.addEventListener('click', function(){\r\n    self.toggleDashboardWidget(this);\r\n    self.drawControls();\r\n    self.showServerMainPage();\r\n  })\r\n  this.buttons.explorer.addEventListener('click', function(){\r\n    self.toggleDashboardWidget(this);\r\n    self.drawExplorer();\r\n  })\r\n}\r\n\r\nTerminusUI.prototype.drawControls = function(){\r\n\tthis.controls = [];\r\n\tthis.loadControls();\r\n\tfor(var i = 0; i<this.controls.length; i++){\r\n\t\tvar ncontrol = this.controls[i];\r\n\t\tif(ncontrol && (nd = ncontrol.getAsDOM())){\r\n\t\t\tthis.controller.appendChild(nd);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nTerminusUI.prototype.drawExplorer = function(){\r\n\tif(this.explorer){\r\n\t\tif(this.showControl(\"api_explorer\")){\r\n\t\t\tvar exp = new ApiExplorer(this);\r\n\t\t\tae = exp.getAsDOM();\r\n\t\t\tthis.explorer.appendChild(ae);\r\n\t\t\tthis.explorer.style.display = 'block';\r\n\t\t}\r\n\t}\r\n}\r\n\r\nTerminusUI.prototype.loadControls = function(){\r\n\tif(this.showControl('server')){\r\n\t\tvar sc = new TerminusServersdk.TerminusServerController(this);\r\n\t\tif(sc) {\r\n\t\t\tthis.controls.push(sc);\r\n\t\t}\r\n\t\tif(this.db() && this.showControl(\"db\")){\r\n\t\t\tvar sc = new TerminusDBsdk.TerminusDBController(this);\r\n\t\t\tif(sc) this.controls.push(sc);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nTerminusUI.prototype.showControl = function(el){\r\n\tif(this.show_controls.indexOf(el) == -1) return false;\r\n\tif(this.pseudoCapability(el)) return true;\r\n\tif(this.client.connection.capabilitiesPermit(el)) {\r\n\t\treturn true;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nTerminusUI.prototype.showView = function(el){\r\n\tif(this.show_views.indexOf(el) == -1) return false;\r\n\tif(this.pseudoCapability(el)) return true;\r\n\tif(this.client.connection.capabilitiesPermit(el)) {\r\n\t\treturn true;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nTerminusUI.prototype.clearBusy = function(response){\r\n\tthis.clearMessages();\r\n\tif(this.viewer && typeof this.viewer.busy == \"function\") this.viewer.busy(false);\r\n}\r\n\r\nTerminusUI.prototype.getBusyLoader = function(bsyDom){\r\n     var pd = document.createElement('div');\r\n     var pbc = document.createElement('div');\r\n     pbc.setAttribute('class', 'term-progress-bar-container');\r\n     pd.appendChild(pbc);\r\n\r\n     var pbsa = document.createElement('div');\r\n     pbsa.setAttribute('class', 'term-progress-bar term-stripes animated reverse slower');\r\n     pbc.appendChild(pbsa);\r\n     var pbia = document.createElement('span');\r\n     pbia.setAttribute('class', 'term-progress-bar-inner');\r\n     pbsa.appendChild(pbia);\r\n\r\n     bsyDom.appendChild(pd);\r\n}\r\n\r\nTerminusUI.prototype.showMessage = function(msg, type){\r\n\tif(this.messages){\r\n        console.log('type **', type);\r\n\t\tTerminusClient.FrameHelper.removeChildren(this.messages);\r\n\r\n\t\tvar md = document.createElement('div');\r\n        //var clsstr = ' terminus-show-msg';\r\n        //if(type) clsstr += ' terminus-msg-' + type;\r\n        switch(type){\r\n            case 'busy':\r\n                var msgHolder = document.createElement('div');\r\n                msgHolder.setAttribute('class', 'terminus-busy-msg')\r\n                msgHolder.appendChild(document.createTextNode(msg));\r\n                md.appendChild(msgHolder);\r\n                this.getBusyLoader(md);\r\n            break;\r\n            case 'success':\r\n                md.setAttribute('class', 'terminus-show-msg-success');\r\n                md.appendChild(document.createTextNode(msg));\r\n            break;\r\n            case 'error':\r\n                md.setAttribute('class', 'terminus-show-msg-error');\r\n                md.appendChild(document.createTextNode(msg));\r\n            break;\r\n        }\r\n\t\tthis.messages.appendChild(md);\r\n\t}\r\n};\r\n\r\nTerminusUI.prototype.showViolations = function(vios, type){\r\n\tvar nvios = new TerminusViolations(vios, this);\r\n\tif(this.messages){\r\n\t\tvar cmsg = (type == \"schema\" ? \" in Schema\" : \" in Document\");\r\n\t\tTerminusClient.FrameHelper.removeChildren(this.messages);\r\n\t\tthis.messages.appendChild(nvios.getAsDOM(cmsg));\r\n\t}\r\n}\r\n\r\nTerminusUI.prototype.showBusy = function(msg){\r\n\tthis.showMessage(msg, \"busy\");\r\n\tif(this.viewer && typeof this.viewer.busy == \"function\") this.viewer.busy(msg);\r\n};\r\n\r\nTerminusUI.prototype.pseudoCapability = function(el){\r\n\tvar pseuds = [\"server\", \"db\", \"change-server\", \"api_explorer\", \"import_schema\", \"schema_format\"];\r\n\tif(pseuds.indexOf(el) == -1) return false;\r\n\treturn true;\r\n}\r\n\r\nTerminusUI.prototype.setOptions = function(opts){\r\n\tthis.show_controls = opts && opts.controls ? opts.controls :\r\n\t\t[\"server\", \"db\", \"change-server\", \"schema_format\",\r\n\t\t\t\"import_schema\", \"class_frame\", \"create_database\",\r\n\t\t\t\"create_document\", \"get_document\", \"update_schema\",\r\n\t\t\t\"get_schema\", \"woql_select\"\r\n\t\t];\r\n\tthis.show_views = opts && opts.views ? opts.views : this.show_controls;\r\n\tif(opts.document){\r\n\t\tthis.document_options = opts.document;\r\n\t}\r\n\tif(opts.schema){\r\n\t\tthis.schema_options = opts.schema;\r\n\t}\r\n\tthis.piman = new TerminusPluginManager();\r\n\tvar self = this;\r\n\tthis.piman.init(opts.plugins, function(){\r\n\t\tself.redraw();\r\n\t});\r\n\tif(opts.css && this.piman){\r\n\t\tthis.piman.loadPageCSS(opts.css);\r\n\t}\r\n\tthis.loadControls();\r\n}\r\n\r\nTerminusUI.prototype.pluginAvailable = function(p){\r\n\treturn this.piman.pluginAvailable(p);\r\n}\r\n\r\nTerminusUI.prototype.drawPlugins = function(){\r\n\tif(!this.piman) {\r\n\t\tconsole.log(new Error(\"No plugin manager initialised in UI object\"));\r\n\t\treturn false;\r\n\t}\r\n\tthis.plugins.appendChild(this.piman.getAsDOM(this));\r\n}\r\n\r\nTerminusUI.prototype.getDocViewerOptions = function(){\r\n\tif(this.document_options && this.document_options['view']){\r\n\t\treturn this.document_options['view'];\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nTerminusUI.prototype.getDocCreatorOptions = function(){\r\n\tif(this.document_options && this.document_options['view']){\r\n\t\treturn this.document_options['view'];\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nTerminusUI.prototype.getClassFrameOptions = function(){\r\n\treturn this.viewdoc_options;\r\n}\r\n\r\nmodule.exports=TerminusUI\r\n","/**\r\n * @file Javascript Api explorer tool\r\n * @author Kitty Jose\r\n * @license Copyright 2018-2019 Data Chemist Limited, All Rights Reserved. See LICENSE file for more\r\n *\r\n * @summary Displays a demo and description of api calls from WOQLCLient and what happens under the hood of api calls\r\n */\r\nconst TerminusPluginManager = require('./plugins/TerminusPlugin');\r\nconst UTILS = require('./Utils')\r\n\r\nlet apiNavConfig = {\r\n    mainNav: {\r\n        connect: {\r\n    \t\tnavText: 'Connect Server Api',\r\n            action : 'connect',\r\n            icon   : 'link',\r\n            defaultSelected: true\r\n    \t},\r\n        database: {\r\n            navText: 'Database Api',\r\n            action : 'create',\r\n            icon   : 'database'\r\n        },\r\n        schema: {\r\n            navText: 'Schema Api',\r\n            action : 'schema',\r\n            icon   : 'cog'\r\n        },\r\n        document: {\r\n            navText: 'Document Api',\r\n            action : 'document',\r\n            icon   : 'file'\r\n        },\r\n        query: {\r\n            navText: 'Query Api',\r\n            action : 'query',\r\n            icon   : 'search'\r\n        }\r\n    },\r\n    subNav: {\r\n        database: {\r\n            createDatabase: {\r\n                navText: 'Create database',\r\n                action : 'create',\r\n                icon   : 'plus',\r\n                defaultSelected: true\r\n            },\r\n            deleteDatabase: {\r\n                navText: 'Delete database',\r\n                action : 'delete',\r\n                icon   : 'trash-alt'\r\n            }\r\n        },\r\n        schema: {\r\n            getSchema: {\r\n                navText: 'View Schema',\r\n                action : 'getSchema',\r\n                icon   : 'eye',\r\n                defaultSelected: true\r\n            },\r\n            updateSchema: {\r\n                navText: 'Update Schema',\r\n                action : 'updateSchema',\r\n                icon   : 'arrow-up'\r\n            },\r\n            getClassFrames: {\r\n                navText: 'Get Class Frames',\r\n                action : 'getClassFrames',\r\n                icon   : 'share-alt'\r\n            }\r\n        },\r\n        document: {\r\n            viewDocument: {\r\n        \t\tnavText: 'View Document',\r\n                action : 'viewDocument',\r\n                icon   : 'eye',\r\n                defaultSelected: true\r\n        \t},\r\n            createDocument: {\r\n                navText: 'Create Document',\r\n                action : 'createDocument',\r\n                icon   : 'plus'\r\n            },\r\n            updateDocument: {\r\n                navText: 'Update Document',\r\n                action : 'updateDocument',\r\n                icon   : 'arrow-up'\r\n            },\r\n            deleteDocument:{\r\n                navText: 'Delete Document',\r\n                action : 'deleteDocument',\r\n                icon   : 'trash-alt'\r\n            }\r\n        },\r\n        query: {\r\n            select: {\r\n                navText: 'Select',\r\n                action : 'select',\r\n                icon   : 'mouse-pointer',\r\n                defaultSelected: true\r\n            },\r\n            update: {\r\n                navText: 'Update',\r\n                action : 'update',\r\n                icon   : 'arrow-up'\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nfunction ApiExplorer(ui){\r\n    this.ui = ui;\r\n    this.viewer = ui.main;\r\n    this.client = new TerminusClient.WOQLClient();\r\n    this.client.use_fetch = true;\r\n    this.client.return_full_response = true;\r\n    this.pman = new TerminusPluginManager();\r\n}\r\n\r\n// Controller provides access to Api explorer functions\r\nApiExplorer.prototype.getAsDOM = function(){\r\n \tvar aec = document.createElement(\"div\");\r\n    aec.setAttribute(\"class\", \"terminus-db-controller\");\r\n    if(this.ui){\r\n       this.getApiNav(aec, this.viewer); // nav\r\n       this.getApiExplorerDom('connect', this.viewer); // content dom\r\n    } // if this.ui\r\n    return aec;\r\n }\r\n\r\n/***** Api Nav bar *****/\r\n// Toggle selected nav bars\r\nApiExplorer.prototype.setSelectedNavMenu = function(a){\r\n    UTILS.removeSelectedNavClass(\"terminus-selected\");\r\n    a.classList.add(\"terminus-selected\");\r\n}\r\n\r\nApiExplorer.prototype.setSelectedSubMenu = function(a){\r\n    UTILS.removeSelectedNavClass(\"terminus-submenu-selected\");\r\n    a.classList.add(\"terminus-submenu-selected\");\r\n}\r\n\r\nApiExplorer.prototype.navOnSelect = function(action, nav, viewer){\r\n    UTILS.removeSelectedNavClass(\"terminus-selected\");\r\n    nav.classList.add(\"terminus-selected\");\r\n    this.getApiExplorerDom(action, viewer);\r\n}\r\n\r\n// create nav bars\r\nApiExplorer.prototype.createNavs = function(navConfig, viewer, ul){\r\n    var a = document.createElement('a');\r\n    a.setAttribute('class', 'terminus-a terminus-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\r\n    if(navConfig.defaultSelected) a.classList.add('terminus-selected');\r\n    var self = this;\r\n    a.addEventListener(\"click\", function(){\r\n        self.navOnSelect(navConfig.action, this, viewer);\r\n    })\r\n    var icon = document.createElement('i');\r\n    icon.setAttribute('class', 'terminus-menu-icon fa fa-' + navConfig.icon);\r\n    a.appendChild(icon);\r\n    var txt = document.createTextNode(navConfig.navText);\r\n    a.appendChild(txt);\r\n    ul.appendChild(a);\r\n}\r\n\r\n// gets api nav bar\r\nApiExplorer.prototype.getApiNav = function(navDom, viewer){\r\n    // list view of apis\r\n    var nav = document.createElement('div');\r\n    navDom.appendChild(nav);\r\n    // connect to server api\r\n    var ul = document.createElement('ul');\r\n    ul.setAttribute('class', 'terminus-ul');\r\n    nav.appendChild(ul);\r\n    // loop over apiNavConfig\r\n    for (var key in apiNavConfig.mainNav){\r\n        if (apiNavConfig.mainNav.hasOwnProperty(key)) {\r\n            this.createNavs(apiNavConfig.mainNav[key], viewer, ul);\r\n        }\r\n    } // for apiNavConfig\r\n    return navDom;\r\n} // getApiNav()\r\n\r\n/***** Api sub navs  *****/\r\n// get schema api explorer - nav bar, alert msg, headers ...\r\nApiExplorer.prototype.getApiExplorerDom = function(view, viewer){\r\n    // clear of viewer\r\n    TerminusClient.FrameHelper.removeChildren(viewer);\r\n    // wrapper\r\n    var wrap = document.createElement('div');\r\n    //wrap.setAttribute('class', 'terminus-wrapper terminus-wrapper-height');\r\n    viewer.appendChild(wrap);\r\n    var cont = document.createElement('div');\r\n    cont.setAttribute('class', 'container-fluid');\r\n    wrap.appendChild(cont);\r\n    var row = document.createElement('div');\r\n    row.setAttribute('class', 'row-fluid');\r\n    cont.appendChild(row);\r\n    var body = document.createElement('div');\r\n    body.setAttribute('class', 'terminus-module-body');\r\n    row.appendChild(body);\r\n    var api = document.createElement('div');\r\n    api.setAttribute('class', 'terminus-module-body terminus-module-body-white-bg terminus-module-body-width');\r\n    body.appendChild(api);\r\n    // body\r\n    var cont = document.createElement('div');\r\n    var self = this;\r\n    switch(view){\r\n        case 'connect':\r\n            var apiCont = self.getConnectExplorer(cont);\r\n            api.appendChild(apiCont);\r\n        break;\r\n        case 'create':\r\n            var apiCont = self.getDatabaseExplorer(cont);\r\n            api.appendChild(apiCont);\r\n        break;\r\n        case 'schema':\r\n            var apiCont = self.getSchemaApi(cont);\r\n            api.appendChild(apiCont);\r\n        break;\r\n        case 'document':\r\n            var apiCont = self.getDocumentApi(cont);\r\n            api.appendChild(apiCont);\r\n        break;\r\n        case 'query':\r\n            var apiCont = self.getQueryApi(cont);\r\n            api.appendChild(apiCont);\r\n        break;\r\n    }// switch(api)\r\n    return wrap;\r\n} // getApiExplorerDom\r\n\r\n// on trigger of click event - change dom\r\nApiExplorer.prototype.changeSubApiDom = function(curSubMenu, action, cont, body){\r\n    TerminusClient.FrameHelper.removeChildren(body);\r\n    switch(curSubMenu){\r\n        case 'database':\r\n            var dom = this.getDatabaseDom(action, body);\r\n        break;\r\n        case 'schema':  // getShowApiDom() deals with schema and document\r\n             var dom = this.getShowApiDom(action, body);\r\n        break;\r\n        case 'document': // getShowApiDom() deals with schema and document\r\n             var dom = this.getShowApiDom(action, body);\r\n        break;\r\n        case 'query':\r\n            var dom = this.getQueryApiDom(action, body);\r\n        break;\r\n        default:\r\n            console.log('Invalid Api Config');\r\n        break;\r\n    }\r\n    cont.appendChild(dom);\r\n}\r\n\r\nApiExplorer.prototype.subNavOnSelect = function(curSubMenu, subMenuConfig, subNav, cont, body){\r\n    this.setSelectedSubMenu(subNav);\r\n    this.changeSubApiDom(curSubMenu, subMenuConfig.action, cont, body);\r\n}\r\n\r\n// create sub nav bars\r\nApiExplorer.prototype.createSubNavs = function(curSubMenu, subMenuConfig, cont, body, ul){\r\n    var a = document.createElement('a');\r\n    a.setAttribute('class', 'terminus-a terminus-hz-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\r\n    if(subMenuConfig.defaultSelected) a.classList.add('terminus-submenu-selected');\r\n    var self = this;\r\n    a.addEventListener(\"click\", function() {\r\n        self.subNavOnSelect(curSubMenu, subMenuConfig, this, cont, body);\r\n    })\r\n    var icon = document.createElement('i');\r\n    icon.setAttribute('class', 'terminus-menu-icon fa fa-' + subMenuConfig.icon);\r\n    a.appendChild(icon);\r\n    var txt = document.createTextNode(subMenuConfig.navText);\r\n    a.appendChild(txt);\r\n    ul.appendChild(a);\r\n}\r\n\r\n// get connect to server api calls - on click of connectAPI nav bar\r\nApiExplorer.prototype.getConnectExplorer = function(body){\r\n    var self = this;\r\n    var br = document.createElement('BR');\r\n    body.appendChild(br);\r\n    // get signature\r\n    var b = this.getSignature('connect');\r\n    body.appendChild(b);\r\n    // get header Parameter\r\n    body.appendChild(UTILS.getHeaderDom('Parameters'));\r\n    var br = document.createElement('BR');\r\n    body.appendChild(br);\r\n    //form to get server url\r\n    this.getForm( '', body, true, 'connect', 'URL : server_url');\r\n    //body.appendChild(form);\r\n    return body;\r\n} // getConnectExplorer\r\n\r\n// get database api calls - on click of databaseAPI nav bar - submenus of database Api defined here\r\nApiExplorer.prototype.getDatabaseExplorer = function(cont){\r\n    var body = document.createElement('div');\r\n    // list view of Databse tools\r\n    var ul = document.createElement('ul');\r\n    ul.setAttribute('class','terminus-ul-horizontal');\r\n    // loop over apiNavConfig\r\n    for (var key in apiNavConfig.subNav.database){\r\n        if (apiNavConfig.subNav.database.hasOwnProperty(key))\r\n            this.createSubNavs('database', apiNavConfig.subNav.database[key], cont, body, ul);\r\n    } // for apiNavConfig\r\n    cont.appendChild(ul);\r\n    // landing page\r\n    var dom = this.getDatabaseDom(apiNavConfig.subNav.database.createDatabase.action, body);\r\n    cont.appendChild(dom);\r\n    return cont;\r\n} // getDatabaseExplorer\r\n\r\n// get schema api calls - on click of SchemaAPI nav bar - submenus of schema Api defined here\r\nApiExplorer.prototype.getSchemaApi = function(cont){\r\n    var body = document.createElement('div');\r\n    // list view of Databse tools\r\n    var ul = document.createElement('ul');\r\n    ul.setAttribute('class','terminus-ul-horizontal');\r\n    // loop over apiNavConfig\r\n    for (var key in apiNavConfig.subNav.schema){\r\n        if (apiNavConfig.subNav.schema.hasOwnProperty(key)) {\r\n            this.createSubNavs('schema', apiNavConfig.subNav.schema[key], cont, body, ul);\r\n        }\r\n    } // for apiNavConfig\r\n    cont.appendChild(ul);\r\n    var dom = this.getShowApiDom(apiNavConfig.subNav.schema.getSchema.action, body);\r\n    cont.appendChild(dom);\r\n    return cont;\r\n} // getSchemaApi\r\n\r\n// get document api calls - on click of DocumentAPI nav bar\r\nApiExplorer.prototype.getDocumentApi = function(cont){\r\n    var body = document.createElement('div');\r\n    // list view of Databse tools\r\n    var ul = document.createElement('ul');\r\n    ul.setAttribute('class','terminus-ul-horizontal');\r\n    // loop over apiNavConfig\r\n    for (var key in apiNavConfig.subNav.document){\r\n        if (apiNavConfig.subNav.document.hasOwnProperty(key)) {\r\n            this.createSubNavs('document', apiNavConfig.subNav.document[key], cont, body, ul);\r\n        }\r\n    } // for apiNavConfig\r\n    cont.appendChild(ul);\r\n    var dom = this.getShowApiDom(apiNavConfig.subNav.document.viewDocument.action, body);\r\n    cont.appendChild(dom);\r\n    return cont;\r\n} // getDocumentApi\r\n\r\n// get query api calls - on click of QueryAPI nav bar - submenus of Query Api defined here\r\nApiExplorer.prototype.getQueryApi  = function(cont){\r\n    var body = document.createElement('div');\r\n    // list view of Databse tools\r\n    var ul = document.createElement('ul');\r\n    ul.setAttribute('class','terminus-ul-horizontal');\r\n    // loop over apiNavConfig\r\n    for (var key in apiNavConfig.subNav.query){\r\n        if (apiNavConfig.subNav.query.hasOwnProperty(key)) {\r\n            this.createSubNavs('query', apiNavConfig.subNav.query[key], cont, body, ul);\r\n        }\r\n    } // for apiNavConfig\r\n    cont.appendChild(ul);\r\n    var dom = this.getQueryApiDom(apiNavConfig.subNav.query.select.action, body);\r\n    cont.appendChild(dom);\r\n    return cont;\r\n} //getQueryApi\r\n\r\n/***** Api Content view  *****/\r\n// get database dom\r\nApiExplorer.prototype.getDatabaseDom = function(mode, body){\r\n    var self = this;\r\n    var br = document.createElement('BR');\r\n    body.appendChild(br);\r\n    // get signature\r\n    var b = this.getSignature(mode);\r\n    body.appendChild(b);\r\n    // get header Parameter\r\n    body.appendChild(UTILS.getHeaderDom('Parameters'));\r\n    var br = document.createElement('BR');\r\n    body.appendChild(br);\r\n    //form to get database id\r\n    if(mode == 'create') this.getForm( null, body, false, mode, 'URL : server/database_id');\r\n    else this.getForm( null, body, true, mode, 'URL : server/database_id');\r\n    return body;\r\n} // getConnectExplorer\r\n\r\n//get create & delete db form\r\nApiExplorer.prototype.getServerForm = function(){\r\n  // form\r\n  var form = document.createElement('form');\r\n  form.setAttribute('class', 'terminus-form-horizontal row-fluid');\r\n\r\n  var fd = document.createElement('div');\r\n  fd.setAttribute('class', 'terminus-control-group');\r\n  form.appendChild(fd);\r\n  var inpLabel = document.createElement('label');\r\n  inpLabel.setAttribute('class', 'terminus-control-label');\r\n  inpLabel.setAttribute('for', 'basicinput');\r\n  inpLabel.innerHTML = 'Url:';\r\n  fd.appendChild(inpLabel);\r\n  var cd = document.createElement('div');\r\n  cd.setAttribute('class', 'terminus-controls');\r\n  fd.appendChild(cd);\r\n  var inpId = document.createElement('input');\r\n  inpId.setAttribute('type', 'text');\r\n  inpId.setAttribute('id', 'basicinput');\r\n  inpId.setAttribute('class', 'terminus-input-text');\r\n  inpId.setAttribute('placeholder', 'URL : server_url');\r\n  if(this.val) inpId.value = this.val;\r\n  cd.appendChild(inpId);\r\n\r\n  var fd = document.createElement('div');\r\n  fd.setAttribute('class', 'terminus-control-group');\r\n  form.appendChild(fd);\r\n  var keyLabel = document.createElement('label');\r\n  keyLabel.setAttribute('class', 'terminus-control-label');\r\n  keyLabel.setAttribute('for', 'basicinput');\r\n  keyLabel.innerHTML = 'Key:';\r\n  fd.appendChild(keyLabel);\r\n  var cd = document.createElement('div');\r\n  cd.setAttribute('class', 'terminus-controls');\r\n  fd.appendChild(cd);\r\n  var key = document.createElement('input');\r\n  key.setAttribute('type', 'text');\r\n  key.setAttribute('id', 'basicinput');\r\n  key.setAttribute('class', 'span8 terminus-input-text');\r\n  key.setAttribute('placeholder', 'Key : key');\r\n  if(this.val) key.value = this.val;\r\n  cd.appendChild(key);\r\n\r\n  var button = document.createElement('button');\r\n  button.setAttribute('class', 'terminus-btn terminus-send-api-btn');\r\n  button.setAttribute('type', 'button');\r\n  button.innerHTML = 'Send Api';\r\n  var gatherips = function(){\r\n    var input = {};\r\n    input.url = inpId.value;\r\n    input.key = key.value;\r\n    return input;\r\n  }\r\n  var resd = document.createElement('div');\r\n  form.appendChild(button);\r\n  form.appendChild(resd);\r\n  var self = this;\r\n  button.addEventListener(\"click\", function(){\r\n    var buttonSelf = this;\r\n    //opts = {};\r\n    var input = gatherips();\r\n    self.client.connect(input.url, input.key)\r\n    .then(function(response){\r\n      TerminusClient.FrameHelper.removeChildren(resd);\r\n      var resultDom = UTILS.showHttpResult(response, 'connect', resd, self.ui);\r\n    });\r\n  }) // button click\r\n  return form;\r\n} // getServerForm()\r\n\r\n// get database api calls - on click of databaseAPI nav bar - submenus of database Api defined here\r\nApiExplorer.prototype.getDatabaseExplorer = function(cont){\r\n  var body = document.createElement('div');\r\n  // list view of Databse tools\r\n  var ul = document.createElement('ul');\r\n  ul.setAttribute('class','terminus-ul-horizontal');\r\n  // loop over apiNavConfig\r\n  for (var key in apiNavConfig.subNav.database){\r\n      if (apiNavConfig.subNav.database.hasOwnProperty(key)) {\r\n          this.createSubNavs('database', apiNavConfig.subNav.database[key], cont, body, ul);\r\n      }\r\n  } // for apiNavConfig\r\n  cont.appendChild(ul);\r\n  // landing page\r\n  var dom = this.getDatabaseDom(apiNavConfig.subNav.database.createDatabase.action, body);\r\n  cont.appendChild(dom);\r\n  return cont;\r\n} // getDatabaseExplorer\r\n\r\n\r\n// get schema & document dom\r\nApiExplorer.prototype.getShowApiDom = function(action, body){\r\n    var self = this;\r\n    var br = document.createElement('BR');\r\n    body.appendChild(br);\r\n    // signature\r\n    var b = this.getSignature(action);\r\n    body.appendChild(b);\r\n    // get header Parameter\r\n    body.appendChild(UTILS.getHeaderDom('Parameters'));\r\n    var br = document.createElement('BR');\r\n    body.appendChild(br);\r\n    // get input\r\n    switch(action){\r\n        case 'getSchema':\r\n            this.getForm( 'schema', body, true, action, 'URL : server/database_id');\r\n        break;\r\n        case 'getClassFrames':\r\n            this.getForm( 'getClassFrames', body, true, action, 'URL : server/database_id');\r\n        break;\r\n        case 'updateSchema':\r\n            this.getForm( 'schema', body, false, action, 'URL : server/database_id');\r\n        break;\r\n        case 'viewDocument':\r\n            this.getForm('document', body, true, action, 'URL : server/database_id/document/document_id');\r\n        break;\r\n        case 'deleteDocument':\r\n            this.getForm('document', body, true, action, 'URL : server/database_id/document/document_id');\r\n        break;\r\n        case 'createDocument':\r\n            this.getForm('document', body, false, action, 'URL : server/database_id/document/document_id');\r\n        break;\r\n        case 'updateDocument':\r\n            this.getForm('document', body, false, action, 'URL : server/database_id/document/document_id');\r\n        break;\r\n        default:\r\n            console.log('Invalid Api Call on form');\r\n        break;\r\n   }// switch(action)\r\n\r\n   return body;\r\n } // getShowApiDom()\r\n\r\n// get query api dom\r\nApiExplorer.prototype.getQueryApiDom = function(action, body){\r\n    var br = document.createElement('BR');\r\n    body.appendChild(br);\r\n    // signature\r\n    var b = this.getSignature(action);\r\n    body.appendChild(b);\r\n    // get header Parameter\r\n    body.appendChild(UTILS.getHeaderDom('Parameters'));\r\n    var br = document.createElement('BR');\r\n    body.appendChild(br);\r\n    this.getForm( 'query', body, false, action, 'URL : server/database_id');\r\n    return body;\r\n} // getQueryApiDom\r\n\r\n/*ApiExplorer.prototype.getClassFramesForm = function(){\r\n    // form\r\n    var form = document.createElement('form');\r\n    form.setAttribute('class', 'terminus-form-horizontal row-fluid');\r\n    var fd = document.createElement('div');\r\n    fd.setAttribute('class', 'terminus-control-group');\r\n    form.appendChild(fd);\r\n    var inpLabel = document.createElement('label');\r\n    inpLabel.setAttribute('class', 'terminus-control-label');\r\n    inpLabel.setAttribute('for', 'basicinput');\r\n    inpLabel.innerHTML = 'Url:';\r\n    fd.appendChild(inpLabel);\r\n    var cd = document.createElement('div');\r\n    cd.setAttribute('class', 'terminus-controls');\r\n    fd.appendChild(cd);\r\n    var inpUrl = document.createElement('input');\r\n    inpUrl.setAttribute('type', 'text');\r\n    inpUrl.setAttribute('id', 'basicinput');\r\n    inpUrl.setAttribute('class', 'span8 terminus-input-text');\r\n    inpUrl.setAttribute('placeholder', 'URL : database_url');\r\n    if(this.val) inpUrl.value = this.val;\r\n    cd.appendChild(inpUrl);\r\n    var fd = document.createElement('div');\r\n    fd.setAttribute('class', 'terminus-control-group');\r\n    form.appendChild(fd);\r\n    var inpLabel = document.createElement('label');\r\n    inpLabel.setAttribute('class', 'terminus-control-label');\r\n    inpLabel.setAttribute('for', 'basicinput');\r\n    inpLabel.innerHTML = 'Url/ ID:';\r\n    fd.appendChild(inpLabel);\r\n    var cd = document.createElement('div');\r\n    cd.setAttribute('class', 'terminus-controls');\r\n    fd.appendChild(cd);\r\n    var inpDocUrl = document.createElement('input');\r\n    inpDocUrl.setAttribute('type', 'text');\r\n    inpDocUrl.setAttribute('id', 'basicinput');\r\n    inpDocUrl.setAttribute('class', 'span8 terminus-input-text');\r\n    inpDocUrl.setAttribute('placeholder', 'Url or ID of document class');\r\n    cd.appendChild(inpDocUrl);\r\n    var fd = document.createElement('div');\r\n    fd.setAttribute('class', 'terminus-control-group');\r\n    form.appendChild(fd);\r\n    var optLabel = document.createElement('label');\r\n    optLabel.setAttribute('class', 'terminus-control-label');\r\n    optLabel.setAttribute('for', 'basicinput');\r\n    optLabel.innerHTML = 'Options:';\r\n    fd.appendChild(optLabel);\r\n    var cd = document.createElement('div');\r\n    cd.setAttribute('class', 'terminus-controls');\r\n    fd.appendChild(cd);\r\n    var optInp = document.createElement('input');\r\n    optInp.setAttribute('type', 'text');\r\n    optInp.setAttribute('id', 'basicinput');\r\n    optInp.setAttribute('class', 'span8 terminus-input-text');\r\n    optInp.setAttribute('placeholder', 'options');\r\n    cd.appendChild(optInp);\r\n    var button = document.createElement('button');\r\n    button.setAttribute('class', 'terminus-btn terminus-send-api-btn');\r\n    button.setAttribute('type', 'button');\r\n    button.innerHTML = 'Send Api';\r\n    var gatherips = function(){\r\n        var input = {};\r\n        input.url = inpUrl.value;\r\n        input.docUrl = inpDocUrl.value;\r\n        input.options = optInp.value;\r\n        return input;\r\n    }\r\n    var self = this;\r\n    button.addEventListener(\"click\", function(form){\r\n      var input = gatherips();\r\n      var buttonSelf = this;\r\n      opts = {};\r\n      opts.explorer = true;\r\n      self.client.getClassFrame(input.url, input.docUrl, opts)\r\n      .then(function(response){\r\n          var currForm = buttonSelf.parentNode;\r\n          var resultDom = UTILS.showHttpResult(response, 'getClassFrames', currForm, self.ui);\r\n      });\r\n    }) // button click\r\n    form.appendChild(button);\r\n    return form;\r\n}   */\r\n\r\n// get form for all Apis\r\nApiExplorer.prototype.getForm = function(curApi, body, view, action, urlPlaceholder){\r\n    // form\r\n    var formDoc = document.createElement('form');\r\n    formDoc.setAttribute('class', 'terminus-form-horizontal row-fluid');\r\n    var fd = document.createElement('div');\r\n    fd.setAttribute('class', 'terminus-control-group');\r\n    formDoc.appendChild(fd);\r\n    var urlLabel = document.createElement('label');\r\n    urlLabel.setAttribute('class', 'terminus-control-label');\r\n    urlLabel.setAttribute('for', 'basicinput');\r\n    urlLabel.innerHTML = 'Url:';\r\n    fd.appendChild(urlLabel);\r\n    var cd = document.createElement('div');\r\n    cd.setAttribute('class', 'terminus-controls');\r\n    fd.appendChild(cd);\r\n    var inpUrl = document.createElement('input');\r\n    inpUrl.setAttribute('type', 'text');\r\n    inpUrl.setAttribute('id', 'basicinput');\r\n    inpUrl.setAttribute('class', 'span8 terminus-input-text');\r\n    inpUrl.setAttribute('placeholder', urlPlaceholder);\r\n    cd.appendChild(inpUrl);\r\n    // add extra form fields based on current api chosen\r\n    switch(curApi){\r\n        case 'getClassFrames':\r\n            var fd = document.createElement('div');\r\n            fd.setAttribute('class', 'terminus-control-group');\r\n            formDoc.appendChild(fd);\r\n            var docUrlLabel = document.createElement('label');\r\n            docUrlLabel.setAttribute('class', 'terminus-control-label');\r\n            docUrlLabel.setAttribute('for', 'basicinput');\r\n            docUrlLabel.innerHTML = 'Url/ ID:';\r\n            fd.appendChild(docUrlLabel);\r\n            var cd = document.createElement('div');\r\n            cd.setAttribute('class', 'terminus-controls');\r\n            fd.appendChild(cd);\r\n            var inpDocUrl = document.createElement('input');\r\n            inpDocUrl.setAttribute('type', 'text');\r\n            inpDocUrl.setAttribute('id', 'basicinput');\r\n            inpDocUrl.setAttribute('class', 'span8 terminus-input-text');\r\n            inpDocUrl.setAttribute('placeholder', 'Url or ID of document class');\r\n            cd.appendChild(inpDocUrl);\r\n        break;\r\n        case 'schema':\r\n            //encoding\r\n            var fd = document.createElement('div');\r\n            fd.setAttribute('class', 'terminus-control-group');\r\n            formDoc.appendChild(fd);\r\n            var encLabel = document.createElement('label');\r\n            encLabel.setAttribute('class', 'terminus-control-label');\r\n            encLabel.setAttribute('for', 'basicinput');\r\n            encLabel.innerHTML = 'Encoding:';\r\n            fd.appendChild(encLabel);\r\n            var cd = document.createElement('div');\r\n            cd.setAttribute('class', 'terminus-controls');\r\n            fd.appendChild(cd);\r\n            var inpEnc = document.createElement('select');\r\n            inpEnc.setAttribute('style', 'height: 50px;width: 300px;padding: 10px;');\r\n            inpEnc.setAttribute('placeholder', 'turtle');\r\n            var optTurt = document.createElement('option');\r\n            optTurt.setAttribute('value', 'terminus:turtle');\r\n            optTurt.appendChild(document.createTextNode('turtle'));\r\n            inpEnc.appendChild(optTurt);\r\n            var optJld = document.createElement('option');\r\n            optJld.setAttribute('value', 'terminus:jsonld');\r\n            optJld.appendChild(document.createTextNode('jsonLD'));\r\n            inpEnc.appendChild(optJld);\r\n            cd.appendChild(inpEnc);\r\n        break;\r\n    }\r\n    var fd = document.createElement('div');\r\n    fd.setAttribute('class', 'terminus-control-group');\r\n    formDoc.appendChild(fd);\r\n    var keyLabel = document.createElement('label');\r\n    keyLabel.setAttribute('class', 'terminus-control-label');\r\n    keyLabel.setAttribute('for', 'basicinput');\r\n    keyLabel.innerHTML = 'Key:';\r\n    fd.appendChild(keyLabel);\r\n    var cd = document.createElement('div');\r\n    cd.setAttribute('class', 'terminus-controls');\r\n    fd.appendChild(cd);\r\n    var inpKey = document.createElement('input');\r\n    inpKey.setAttribute('type', 'text');\r\n    inpKey.setAttribute('id', 'basicinput');\r\n    inpKey.setAttribute('class', 'span8 terminus-input-text');\r\n    inpKey.setAttribute('placeholder', 'Key');\r\n    cd.appendChild(inpKey);\r\n    if(!view){\r\n        // include text area only if call is type post\r\n        var fd = document.createElement('div');\r\n        fd.setAttribute('class', 'terminus-control-group');\r\n        formDoc.appendChild(fd);\r\n        var docLabel = document.createElement('label');\r\n        docLabel.setAttribute('class', 'terminus-control-label');\r\n        docLabel.setAttribute('for', 'basicinput');\r\n        if(curApi == 'query') docLabel.innerHTML = 'Query:';\r\n        docLabel.innerHTML = 'Document:';\r\n        fd.appendChild(docLabel);\r\n        var cd = document.createElement('div');\r\n        cd.setAttribute('class', 'terminus-controls');\r\n        fd.appendChild(cd);\r\n        var inpDoc = document.createElement('textarea');\r\n        cd.appendChild(inpDoc);\r\n        inpDoc.setAttribute('class', 'terminus-api-explorer-text-area');\r\n        UTILS.stylizeEditor(this.ui, inpDoc, 'document', 'javascript');\r\n    }\r\n    body.appendChild(formDoc);\r\n    // gather inputs\r\n    var inp ={};\r\n    inp.url = inpUrl;\r\n    inp.key = inpKey;\r\n    if(curApi == 'getClassFrames') inp.docUrl = inpDocUrl;\r\n    if(curApi == 'schema') inp.enc = inpEnc;\r\n    if(!view) inp.doc = inpDoc;\r\n    var form = this.getApiSendButton(action, inp);\r\n    body.appendChild(form);\r\n}\r\n\r\n// define event listeners on send api of schema & documents\r\n\r\nApiExplorer.prototype.getApiForm = function(action, input){\r\n  // form\r\n  var form = document.createElement('form');\r\n  form.setAttribute('class', 'terminus-form-horizontal row-fluid');\r\n\r\n  var button = document.createElement('button');\r\n  button.setAttribute('class', 'terminus-btn terminus-send-api-btn');\r\n  button.setAttribute('type', 'button');\r\n  button.innerHTML = 'Send Api';\r\n  form.appendChild(button);\r\n  var resd = document.createElement('div');\r\n  form.appendChild(resd);\r\n  var self = this;\r\n  switch(action){\r\n    case 'getSchema':\r\n      button.addEventListener(\"click\", function(){\r\n        var opts = {};\r\n        opts['terminus:encoding'] = input.enc.value;\r\n        opts['terminus:user_key'] = input.key.value;\r\n        var schurl = input.url.value;\r\n        var buttonSelf = this;\r\n        self.client.getSchema(schurl, opts)\r\n        .then(function(response){\r\n          TerminusClient.FrameHelper.removeChildren(resd);\r\n          var resultDom = UTILS.showHttpResult(response, 'getSchema', resd, self.ui);\r\n        });\r\n      }) // button click\r\n    break;\r\n    case 'updateSchema':\r\n      button.addEventListener(\"click\", function(){\r\n        var buttonSelf = this;\r\n        opts = {};\r\n        opts['terminus:encoding'] = input.enc.value;\r\n        opts['terminus:user_key'] = input.key.value;\r\n        var schurl = input.url.value;\r\n        self.client.connectionConfig.connected_mode = false;\r\n        self.client.updateSchema(schurl, input.doc.value, opts)\r\n        .then(function(response){\r\n          var gtxtar = document.createElement('textarea');\r\n          gtxtar.setAttribute('readonly', true);\r\n          gtxtar.innerHTML = response;\r\n          var currForm = buttonSelf.parentNode;\r\n          currForm.appendChild(gtxtar);\r\n          UTILS.stylizeEditor(this.ui, txtar, 'schema', 'turtle');\r\n        });\r\n      }) // button click\r\n    break;\r\n    case 'viewDocument':\r\n      button.addEventListener(\"click\", function(){\r\n      var dcurl = input.value;\r\n      var buttonSelf = this;\r\n      var opts = {};\r\n      opts.format = 'turtle';\r\n      self.client.getDocument(dcurl, opts)\r\n      .then(function(response){\r\n        TerminusClient.FrameHelper.removeChildren(resd);\r\n        var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n      });\r\n    }) // button click\r\n    break;\r\n    case 'deleteDocument':\r\n      button.addEventListener(\"click\", function(){\r\n      var dcurl = input.value;\r\n      var buttonSelf = this;\r\n      var opts = {};\r\n      self.client.deleteDocument(dcurl, opts)\r\n      .then(function(response){\r\n        TerminusClient.FrameHelper.removeChildren(resd);\r\n        var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n      });\r\n    }) // button click\r\n    break;\r\n    case 'createDocument':\r\n      button.addEventListener(\"click\", function(){\r\n        var dcurl = input.schemaUrlDom.value;\r\n        var payload = input.htmlEditor.getValue();\r\n        var buttonSelf = this;\r\n        opts = {};\r\n        self.client.createDocument(dcurl, payload, opts)\r\n        .then(function(response){\r\n          TerminusClient.FrameHelper.removeChildren(resd);\r\n          var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n        });\r\n      }) // button click\r\n    break;\r\n    case 'updateDocument':\r\n      button.addEventListener(\"click\", function(){\r\n        var dcurl = input.schemaUrlDom.value;\r\n        var payload = input.htmlEditor.getValue();\r\n        var buttonSelf = this;\r\n        opts = {};\r\n        opts.editmode = 'replace';\r\n        opts.format = 'json';\r\n        self.client.updateDocument(dcurl, payload, opts)\r\n        .then(function(response){\r\n          TerminusClient.FrameHelper.removeChildren(resd);\r\n          var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n        });\r\n      }) // button click\r\n    break;\r\n  } // switch(action)\r\n\r\n  var br = document.createElement('BR');\r\n  form.appendChild(br);\r\n  var br = document.createElement('BR');\r\n  form.appendChild(br);\r\n\r\n  return form;\r\n} // getApiForm()\r\n// define event listeners on send api of schema & documents\r\nApiExplorer.prototype.getApiSendButton = function(action, input){\r\n    // form\r\n    var form = document.createElement('form');\r\n    form.setAttribute('class', 'terminus-form-horizontal row-fluid');\r\n    var button = document.createElement('button');\r\n    button.setAttribute('class', 'terminus-btn terminus-send-api-btn');\r\n    button.setAttribute('type', 'button');\r\n    button.innerHTML = 'Send Api';\r\n    form.appendChild(button);\r\n    var resd = document.createElement('div');\r\n    form.appendChild(resd);\r\n    var self = this;\r\n    switch(action){\r\n        case 'connect':\r\n            button.addEventListener(\"click\", function(){\r\n                var buttonSelf = this;\r\n                self.client.connect(input.url.value, input.key.value)\r\n                .then(function(response){\r\n                    FrameHelper.removeChildren(resd);\r\n                    var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n               });\r\n            }) // button click\r\n        break;\r\n        case 'create':\r\n            button.addEventListener(\"click\", function(form){\r\n              self.client.createDatabase(input.url.value, input.doc.value, input.key.value)\r\n              .then(function(response){\r\n                FrameHelper.removeChildren(resd);\r\n                var resultDom = UTILS.showHttpResult(response, action, currForm, self.ui);\r\n              });\r\n            }) // button click\r\n        break;\r\n        case 'delete':\r\n            button.addEventListener(\"click\", function(){\r\n              opts = {};\r\n              opts.key = input.key.value;\r\n              self.client.deleteDatabase(input.url.value, opts)\r\n              .then(function(response){\r\n                  FrameHelper.removeChildren(resd);\r\n                  var resultDom = UTILS.showHttpResult(response, action, currForm, self.ui);\r\n              });\r\n            }) // button click\r\n        break\r\n        case 'getSchema':\r\n            button.addEventListener(\"click\", function(){\r\n                var opts = {};\r\n                opts['terminus:encoding'] = input.enc.value;\r\n                opts['terminus:user_key'] = input.key.value;\r\n                var schurl = input.url.value;\r\n                self.client.getSchema(schurl, opts)\r\n                .then(function(response){\r\n                    FrameHelper.removeChildren(resd);\r\n                    var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n                });\r\n            }) // button click\r\n        break;\r\n        case 'updateSchema':\r\n            button.addEventListener(\"click\", function(){\r\n                opts = {};\r\n                opts['terminus:encoding'] = input.enc.value;\r\n                opts['terminus:user_key'] = input.key.value;\r\n                var payload = input.doc.value;\r\n                var schurl = input.url.value;\r\n                self.client.connectionConfig.connected_mode = false;\r\n                self.client.updateSchema(schurl, payload, opts)\r\n                .then(function(response){\r\n                    FrameHelper.removeChildren(resd);\r\n                    var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n                });\r\n            }) // button click\r\n        break;\r\n        case 'getClassFrames':\r\n            button.addEventListener(\"click\", function(form){\r\n                var schurl = input.url.value;\r\n                opts = {};\r\n                opts.explorer = true;\r\n                self.client.getClassFrame(input.url, input.docUrl.value, opts)\r\n                .then(function(response){\r\n                    var currForm = buttonSelf.parentNode;\r\n                    var resultDom = UTILS.showHttpResult(response, action, currForm, self.ui);\r\n                });\r\n            }) // button click\r\n        break;\r\n        case 'viewDocument':\r\n          button.addEventListener(\"click\", function(){\r\n              var dcurl = input.url.value;\r\n              var opts = {};\r\n              opts.key = input.key.value\r\n              self.client.getDocument(dcurl, opts)\r\n              .then(function(response){\r\n                    FrameHelper.removeChildren(resd);\r\n                    var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n              });\r\n        }) // button click\r\n        break;\r\n        case 'deleteDocument':\r\n          button.addEventListener(\"click\", function(){\r\n              var dcurl = input.value;\r\n              var buttonSelf = this;\r\n              var opts = {};\r\n              self.client.deleteDocument(dcurl, opts)\r\n              .then(function(response){\r\n                  FrameHelper.removeChildren(resd);\r\n                  var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n              });\r\n          }) // button click\r\n        break;\r\n        case 'createDocument':\r\n          button.addEventListener(\"click\", function(){\r\n              var dcurl = input.url.value;\r\n              var payload = input.doc.value;\r\n              opts = {};\r\n              opts.key = input.key.value;\r\n              self.client.createDocument(dcurl, payload, opts)\r\n              .then(function(response){\r\n                   FrameHelper.removeChildren(resd);\r\n                   var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n               });\r\n          }) // button click\r\n        break;\r\n        case 'updateDocument':\r\n          button.addEventListener(\"click\", function(){\r\n            var dcurl = input.url.value;\r\n            var payload = input.doc.value;\r\n            var buttonSelf = this;\r\n            opts = {};\r\n            opts.editmode = 'replace';\r\n            opts.format = 'json';\r\n            opts.key = input.key.value;\r\n            self.client.updateDocument(dcurl, payload, opts)\r\n            .then(function(response){\r\n              FrameHelper.removeChildren(resd);\r\n              var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n            });\r\n          }) // button click\r\n        break;\r\n        case 'select':\r\n            button.addEventListener(\"click\", function(){\r\n                var opts = {};\r\n                opts.key = input.key.value;\r\n                self.client.select(input.url.value, input.doc.value, opts)\r\n                .then(function(response){\r\n                   FrameHelper.removeChildren(resd);\r\n                   var resultDom = UTILS.showHttpResult(response, action, currForm, self.ui);\r\n                });\r\n            }) // button click\r\n        break;\r\n        case 'update':\r\n            button.addEventListener(\"click\", function(){\r\n              var opts = {};\r\n              opts.key = input.key.value;\r\n              self.client.update(input.url.value, input.doc.value, opts)\r\n              .then(function(response){\r\n                FrameHelper.removeChildren(resd);\r\n                var resultDom = UTILS.showHttpResult(response, action, currForm, self.ui);\r\n              });\r\n            }) // button click\r\n        break;\r\n        default:\r\n            console.log('Invalid Api call on button');\r\n        break;\r\n    } // switch(action)\r\n    var br = document.createElement('BR');\r\n    form.appendChild(br);\r\n    var br = document.createElement('BR');\r\n    form.appendChild(br);\r\n    return form;\r\n} // getApiSendButton()\r\n\r\n// get signature of api calls\r\nApiExplorer.prototype.getSignature = function(action){\r\n    var api = document.createElement('div');\r\n    // get header signature\r\n    var sg = document.createElement('button');\r\n    sg.appendChild(document.createTextNode('Click to read Api Signature'));\r\n    sg.setAttribute('class', 'terminus-collapsible');\r\n    ic = document.createElement('i');\r\n    ic.setAttribute('class', 'terminus-cheveron-float fa fa-chevron-down');\r\n    sg.appendChild(ic);\r\n    api.appendChild(sg);\r\n    var br = document.createElement('BR');\r\n    api.appendChild(br);\r\n    var cl = document.createElement('div');\r\n    cl.setAttribute('class', 'terminus-collapsible-content content');\r\n    var sig = UTILS.getFunctionSignature(action);\r\n    var txt = document.createTextNode(sig.spec);\r\n    var pre = document.createElement('pre');\r\n    pre.setAttribute('class', 'terminus-api-signature-pre');\r\n    pre.appendChild(txt);\r\n    var txt =  document.createTextNode(sig.descr);\r\n    pre.appendChild(txt);\r\n    var br = document.createElement('BR');\r\n    pre.appendChild(br);\r\n    var br = document.createElement('BR');\r\n    pre.appendChild(br);\r\n    var txt = document.createTextNode(sig.result);\r\n    pre.appendChild(txt);\r\n    cl.appendChild(pre);\r\n    api.appendChild(cl);\r\n    var br = document.createElement('BR');\r\n    api.appendChild(br);\r\n    sg.addEventListener('click', function(){\r\n        UTILS.tolggleContent(ic, cl);\r\n    });\r\n    return api;\r\n} // getSignature()\r\n\r\n// displays signature only on click\r\nfunction tolggleSignatureContent(content){\r\n    if (content.style.display === \"block\")\r\n        content.style.display = \"none\";\r\n    else content.style.display = \"block\";\r\n}\r\n\r\nmodule.exports=ApiExplorer\r\n","function Codemirror(text, format, config){\r\n  this.textdom = text;\r\n  this.mode = format;\r\n  this.darkMode = config.darkMode;\r\n  if(this.jsonldCheck(format)) this.mode = 'javascript';\r\n}\r\n\r\n/*\r\ntxtar    : editor is attached to textar\r\nmode     : format for highlighting, ex: json, html etc.\r\neditable : readOnly false/ nocursor is special value in code editor to set readonly true */\r\nCodemirror.prototype.colorizeTextArea = function(mode){\r\n  //initize auto complete\r\n  /*CodeMirror.commands.autocomplete = function(cm) {\r\n    cm.showHint({hint: CodeMirror.hint.anyword});\r\n  }*/\r\n\r\n  // initialise code editor on text area\r\n  var editor = CodeMirror.fromTextArea(this.textdom, {\r\n    mode                : this.mode,\r\n    firstLineNumber     : 1,\r\n    lineNumbers         : true,\r\n    styleActiveLine     : true,\r\n    lineWrapping        : true,\r\n    smartIndent         : true,\r\n    indentWithTabs      : true,\r\n    newlineAndIndent    : true,\r\n    autoCloseBrackets   : true,\r\n    matchBrackets       : {afterCursor: true},\r\n    extraKeys           : {\"Ctrl-F\": \"find\", \"Tab\": \"autocomplete\" },\r\n    refresh             : true\r\n   });\r\n\r\n   this.setCodemirrorSize(editor, mode);\r\n   editor.defaultCharWidth('20px');\r\n   if(this.darkMode) editor.setOption(\"theme\", 'erlang-dark');\r\n   else editor.setOption(\"theme\", 'neo');\r\n\r\n   return editor;\r\n} // colorizeTextArea()\r\n\r\n/*\r\n  set editor size according to screens\r\n  editor : code mirror editor Object\r\n  mode   : editor being viewed from schema/ doc/ query page*/\r\nCodemirror.prototype.setCodemirrorSize = function(editor, mode){\r\n  switch(mode){\r\n    case 'query':\r\n      editor.setSize('800', '300');\r\n    break;\r\n    case 'schema':\r\n      editor.setSize('1200', '1550');\r\n    break;\r\n    case 'document':\r\n     editor.setSize('765', 'auto');\r\n    break;\r\n    case 'api-doc':\r\n        editor.setSize('800', 'auto');\r\n    break;\r\n  } // switch(mode)\r\n} // setCodemirrorSize()\r\n\r\n// updateTextArea(): highlights new changes on editor\r\nCodemirror.prototype.updateTextArea = function(editor){\r\n  editor.save();\r\n  setTimeout(function() {\r\n      editor.refresh();\r\n  },1);\r\n  // save changes of code mirror editor\r\n  editor.on('change', function(){\r\n    editor.save();\r\n  });\r\n} //updateTextArea()\r\n\r\n/*\r\ncolorizePre() to colorise pre tags (read only mode)\r\ntext (string)    : The document to run through the highlighter.\r\nmode (mode spec) : format to highlight color\r\noutput (DOM node): The tokens will be converted to spans as in an editor,\r\n                   and inserted into the node (through innerHTML).*/\r\nCodemirror.prototype.colorizePre = function(){\r\n  CodeMirror.runMode(this.textdom.innerText, this.mode, this.textdom);\r\n  if(this.darkMode)\r\n      var theme = 'cm-s-erlang-dark';\r\n  else var theme = 'cm-s-neo';\r\n  this.textdom.setAttribute('class', 'CodeMirror CodeMirror-wrap ' + theme + ' terminus-wrap-text terminus-wrapper-height ');\r\n  return this.textdom;\r\n} // colorizePre()\r\n\r\nCodemirror.prototype.jsonldCheck = function(format){\r\n  if(format == 'jsonld') return true;\r\n}\r\n\r\nmodule.exports=Codemirror\r\n","/**\r\n * Helper functions for dealing with frames and linked data documents\r\n */\r\nlet FrameHelper = {\r\n\tstandard_urls: {\r\n\t\t\"rdf\": \"http://www.w3.org/1999/02/22-rdf-syntax-ns#\",\r\n\t\t\"rdfs\": \"http://www.w3.org/2000/01/rdf-schema#\",\r\n\t\t\"xsd\": \"http://www.w3.org/2001/XMLSchema#\",\r\n\t\t\"owl\": \"http://www.w3.org/2002/07/owl#\",\r\n\t\t\"tcs\": \"http://terminusdb.com/schema/tcs#\",\r\n\t\t\"tbs\": \"http://terminusdb.com/schema/tbs#\",\r\n\t\t\"xdd\": \"http://terminusdb.com/schema/xdd#\",\r\n\t\t\"terminus\": \"http://terminusdb.com/schema/terminus#\",\r\n\t\t\"vio\": \"http://terminusdb.com/schema/vio#\",\r\n\t\t\"docs\": \"http://terminusdb.com/schema/documentation#\"\r\n\t}\r\n};\r\n\r\nFrameHelper.addURLPrefix = function(prefix, url){\r\n\tthis.standard_urls[prefix] = url;\r\n}\r\n\r\n\r\nFrameHelper.removeChildren = function(node){\r\n\tif(node) { while(node.hasChildNodes()){\r\n\t\tnode.removeChild(node.childNodes[0]);\r\n\t}}\r\n}\r\n\r\nFrameHelper.empty = function(obj){\r\n\t   // null and undefined are \"empty\"\r\n    if (obj == null) return true;\r\n    // Assume if it has a length property with a non-zero value\r\n    // that that property is correct.\r\n    if (obj.length > 0)    return false;\r\n    if (obj.length === 0)  return true;\r\n    // Otherwise, does it have any properties of its own?\r\n    // Note that this doesn't handle\r\n    // toString and valueOf enumeration bugs in IE < 9\r\n    for (var key in obj) {\r\n        if (Object.prototype.hasOwnProperty.call(obj, key)) return false;\r\n    }\r\n    return true;\r\n}\r\n\r\nFrameHelper.genBNID = function(dom){\r\n\tlet r = Math.random().toString(36).substring(7);\r\n\tvar d = new Date();\r\n\tlet bnid = \"_:\" + r + d.getTime();\r\n\treturn bnid;\r\n}\r\n\r\nFrameHelper.getShorthand = function(link){\r\n\tif(link && typeof link == \"string\"){\r\n\t\tfor(var pref in this.standard_urls){\r\n\t\t\tvar full = this.standard_urls[pref];\r\n\t\t\tif(link.substring(0, full.length) == full){\r\n\t\t\t\tvar sh = pref + \":\" + link.substring(full.length);\r\n\t\t\t\treturn sh;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nFrameHelper.compareIDs = function(ida, idb){\r\n\tif(ida == idb) return true;\r\n\tif(this.unshorten(ida) == idb) return true;\r\n\tif(this.unshorten(ida) == this.unshorten(idb)) return true;\r\n\tvar sha = this.getShorthand(ida);\r\n\tvar shb = this.getShorthand(idb);\r\n\tif(sha && ((sha == idb) || (sha == shb))) return true;\r\n\tif(shb && shb == ida) return true;\r\n\treturn false;\r\n}\r\n\r\nFrameHelper.unshorten = function(url){\r\n\tif(this.validURL(url)) return url;\r\n\tif(!url) return url;\r\n\tvar bits = url.split(\":\");\r\n\tif(bits[1]){\r\n\t\tif(this.standard_urls[bits[0]]){\r\n\t\t\treturn this.standard_urls[bits[0]] + bits[1];\r\n\t\t}\r\n\t}\r\n\treturn url;\r\n}\r\n\r\nFrameHelper.validURL = function(str) {\r\n\tvar pattern = new RegExp('^(https?:\\\\/\\\\/)?'+ // protocol\r\n    'localhost|((([a-z\\\\d]([a-z\\\\d-]*[a-z\\\\d])*)\\\\.)+[a-z]{2,}|'+ // domain name\r\n    '((\\\\d{1,3}\\\\.){3}\\\\d{1,3}))'+ // OR ip (v4) address\r\n    '(\\\\:\\\\d+)?(\\\\/[-a-z\\\\d%_.~+]*)*'+ // port and path\r\n    '(\\\\?[;&a-z\\\\d%_.~+=-]*)?'+ // query string\r\n    '(\\\\#[-a-z\\\\d_]*)?$','i'); // fragment locator\r\n\treturn !!pattern.test(str);\r\n}\r\n\r\nFrameHelper.labelFromURL = function(url){\r\n\tvar nurl = this.urlFragment(url);\r\n\tnurl = (nurl ? nurl : url.substring(url.lastIndexOf(\"/\")+1));\r\n\tnurl = nurl.replace(\"_\", \" \");\r\n\tnurl = nurl.charAt(0).toUpperCase() + nurl.slice(1);\r\n\treturn nurl;\r\n}\r\n\r\nFrameHelper.urlFragment = function(url){\r\n\turl = (typeof url != \"string\") ? window.location.href : url;\r\n\tbits = url.split('#');\r\n\tif(bits.length <= 1 && url.indexOf(\"http\") == -1){\r\n\t\tbits = url.split(\":\");\r\n\t}\r\n\tif(bits.length >= 1){\r\n\t\turl = bits[1];\r\n\t\tif(url) url = url.split(\"?\")[0];\r\n\t}\r\n\treturn url;\r\n}\r\n\r\nFrameHelper.isStringType = function(stype){\r\n\tif(stype == \"http://www.w3.org/2001/XMLSchema#string\") return true;\r\n\tif(stype == \"xsd:string\") return true;\r\n\treturn false;\r\n}\r\n\r\nFrameHelper.lastURLBit = function(url){\r\n\turl = (typeof url == \"undefined\") ? window.location.href : url;\r\n\turl = url.split('#')[0];\r\n\turl = url.split(\"?\")[0];\r\n\turl = url.substring(url.lastIndexOf(\"/\")+1);\r\n\treturn url;\r\n}\r\n\r\n\r\nFrameHelper.getStdURL = function(pref, ext, url){\r\n\tif(this.standard_urls[pref]) {\r\n\t\tif(url) {\r\n\t\t\tif(url == this.standard_urls[pref] + ext) return url;\r\n\t\t}\r\n\t\telse {\r\n\t\t\treturn this.standard_urls[pref] + ext;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nFrameHelper.viewIncludesProperties = function(view, type){\r\n\tif(view == \"full\" || view == \"production\" || view == \"terse\"){\r\n\t\treturn true;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nFrameHelper.viewIncludesChildren = function(view, type){\r\n\treturn this.viewIncludesProperties(view, type);\r\n}\r\n\r\nFrameHelper.viewIncludesValue = function(view, type){\r\n\treturn this.viewIncludesProperties(view, type);\r\n}\r\n\r\nFrameHelper.numberWithCommas = function(value){\r\n\tif(value >= 1000 || value <= -1000){\r\n\t    var parts = value.toString().split(\".\");\r\n\t    if(value <= -1000) parts[0] = parts[0].substring(1);\r\n\t    parts[0] = parts[0].replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\");\r\n\t    if(value <= -1000) value = \"-\" + parts.join(\".\");\r\n\t    else value = parts.join(\".\");\r\n\t}\r\n\treturn value;\r\n}\r\n\r\nFrameHelper.datatypes = [\r\n\t\"xdd:coordinate\", \"xdd:coordinatePolyline\",\r\n\t\"xdd:coordinatePolygon\", \"xdd:dateRange\", \"xdd:gYearRange\", \"xdd:integerRange\",\r\n\t\"xdd:decimalRange\",\"xdd:cc\", \"xdd:email\",\"xdd:html\", \"xdd:url\", \"xsd:anySimpleType\",\r\n\t\"xsd:string\", \"xsd:boolean\", \"xsd:decimal\", \"xsd:double\", \"xsd:float\", \"xsd:time\", \"xsd:date\",\r\n\t\"xsd:dateTime\", \"xsd:dateTimeStamp\", \"xsd:gYear\", \"xsd:gMonth\", \"xsd:gDay\", \"xsd:gYearMonth\",\r\n\t\"xsd:gMonthDay\", \"xsd:duration\", \"xsd:yearMonthDuration\", \"xsd:dayTimeDuration\",\r\n\t\"xsd:byte\", \"xsd:short\", \"xsd:integer\", \"xsd:long\", \"xsd:unsignedByte\",\t\"xsd:unsignedInt\",\r\n\t\"xsd:unsignedLong\",\t\"xsd:nonNegativeInteger\", \"xsd:positiveInteger\", \"xsd:negativeInteger\",\r\n\t\"xsd:nonPositiveInteger\", \"xsd:base64Binary\", \"xsd:anyURI\", \"xsd:language\", \"xsd:normalizedString\",\r\n\t\"xsd:token\", \"xsd:NMTOKEN\",\t\"xsd:Name\",\t\"xsd:NCName\",\"xsd:NOTATION\", \"xsd:QName\", \"xsd:ID\",\r\n\t\"xsd:IDREF\", \"xsd:ENTITY\", \"rdf:XMLLiteral\",\"rdf:PlainLiteral\",\"rdfs:Literal\", \"xdd:json\"\r\n];\r\n\r\nFrameHelper.parseDate = function(ty, value){\r\n\tif(ty == \"xsd:date\"){\r\n\t\tvar parsed = this.parseXsdDate(value);\r\n\t}\r\n\telse if(ty == \"xsd:dateTime\"){\r\n\t\tvar parsed = this.parseXsdDateTime(value);\r\n\t}\r\n\telse if(ty == \"xsd:gYear\"){\r\n\t\tvar parsed = { year: value };\r\n\t}\r\n\telse if(ty == \"xsd:gYearRange\"){\r\n\t\tvar parsed = { year: value };\r\n\t}\r\n\telse if(ty == \"xsd:gMonth\"){\r\n\t\tvar parsed = { month: value };\r\n\t}\r\n\telse if(ty == \"xsd:gDay\"){\r\n\t\tvar parsed = { day: value };\r\n\t}\r\n\telse if(ty == \"xsd:gYearMonth\"){\r\n\t\tvar bits = value.split(\"-\");\r\n\t\twhile (bits.length < 2) bits.push(\"\");\r\n\t\tvar parsed = { year: bits[0], month: bits[1]};\r\n\t}\r\n\telse if(ty == \"xsd:gMonthDay\"){\r\n\t\tvar bits = value.split(\"-\");\r\n\t\twhile (bits.length < 2) bits.push(\"\");\r\n\t\tvar parsed = { month: bits[0], day: bits[1]};\r\n\t}\r\n\telse if(ty == \"xsd:dateTimeStamp\"){\r\n\t\tvar bits = value.split(\"-\");\r\n\t\twhile (bits.length < 2) bits.push(\"\");\r\n\t\tvar parsed = { month: bits[0], day: bits[1]};\r\n\t}\r\n\treturn parsed;\r\n}\r\n\r\nFrameHelper.parseXsdDate = function(val){\r\n\tvar tz = this.extractXsdTimezone(val);\r\n\tif(tz){\r\n\t\tval = val.substring(0, val.length - tz.length);\r\n\t}\r\n\tif(val.substring(0, 1) == '-'){\r\n\t\tvar year = val.substring(0,5);\r\n\t}\r\n\telse {\r\n\t\tvar year = val.substring(0,4);\r\n\t}\r\n\tif(year && Math.abs(year) < 10000){\r\n\t\tvar month = val.substring(year.length+1, year.length+3);\r\n\t\tif(month) month = month.toNumber();\r\n\t\telse return false;\r\n\t\tvar day = val.substring(year.length+4);\r\n\t\tif(day) day = day.toNumber();\r\n\t\telse return false;\r\n\t\tvar parsed = {\r\n\t\t\tyear: year,\r\n\t\t\tmonth: month,\r\n\t\t\tday: day,\r\n\t\t\ttimezone: tz\r\n\t\t}\r\n\t}\r\n\treturn parsed;\r\n}\r\n\r\nFrameHelper.addXsdPadding = function(parsed){\r\n\tvar nparsed = {};\r\n\tif(typeof parsed.year != \"undefined\" && parsed.year !== false && parsed.year < 1000){\r\n\t\tif(Math.abs(parsed.year) < 10) nparsed.year = (parsed.year < 0 ? \"-000\" + Math.abs(parsed.year) : \"000\" + parsed.year);\r\n\t\telse if(Math.abs(parsed.year) < 100) nparsed.year = (parsed.year < 0 ? \"-00\" + Math.abs(parsed.year) : \"00\" + parsed.year);\r\n\t\telse nparsed.year = (parsed.year < 0 ? \"-0\" + Math.abs(parsed.year) : \"0\" + parsed.year);\r\n\t}\r\n\telse if(parsed.year){\r\n\t\tnparsed.year = parsed.year;\r\n\t}\r\n\tif(typeof parsed.month != \"undefined\" && parsed.month !== false && parsed.month < 10){\r\n\t\tnparsed.month = \"0\" + parsed.month;\r\n\t}\r\n\telse if(parsed.month){\r\n\t\tnparsed.month = parsed.month;\r\n\t}\r\n\tif(typeof parsed.day != \"undefined\" && parsed.day !== false && parsed.day < 10){\r\n\t\tnparsed.day = \"0\" + parsed.day\r\n\t}\r\n\telse if(parsed.day){\r\n\t\tnparsed.day = parsed.day;\r\n\t}\r\n\tif(typeof parsed.hour != \"undefined\" && parsed.hour !== false && parsed.hour < 10){\r\n\t\tnparsed.hour = \"0\" + parsed.hour;\r\n\t}\r\n\telse if(parsed.hour){\r\n\t\tnparsed.hour = parsed.hour;\r\n\t}\r\n\tif(typeof parsed.minute != \"undefined\" && parsed.minute !== false && parsed.minute < 10){\r\n\t\tnparsed.minute = \"0\" + parsed.minute;\r\n\t}\r\n\telse if(parsed.minute){\r\n\t\tnparsed.minute = parsed.minute;\r\n\t}\r\n\tif(typeof parsed.second != \"undefined\" && parsed.second !== false && parsed.second < 10){\r\n\t\tnparsed.second= \"0\" + parsed.second;\r\n\t}\r\n\telse if(parsed.second){\r\n\t\tnparsed.second = parsed.second;\r\n\t}\r\n\treturn nparsed;\r\n}\r\n\r\n\r\nFrameHelper.xsdFromParsed = function(parsed, ty){\r\n\tvar xparsed = this.addXsdPadding(parsed);\r\n\tif(ty == \"xsd:gYear\"){\r\n\t\tvar ret = (xparsed.year ? xparsed.year : false);\r\n\t}\r\n\telse if(ty == \"xsd:date\"){\r\n\t\treturn (xparsed.year && xparsed.month && xparsed.day) ? xparsed.year + \"-\" + xparsed.month + \"-\" + xparsed.day : false;\r\n\t}\r\n\telse if(ty == \"xsd:dateTime\" || ty == \"xsd:dateTimeStamp\"){\r\n\t\tvar ret = (xparsed.year && xparsed.month && xparsed.day) ? xparsed.year + \"-\" + xparsed.month + \"-\" + xparsed.day + \"T\" : false;\r\n\t\tif(ret) ret += (xparsed.hour ? xparsed.hour : \"12\") + \":\" + (xparsed.minute ? xparsed.minute : \"00\") + \":\" + (xparsed.second ? xparsed.second : \"00\");\r\n\t}\r\n\telse if(ty == \"xsd:gMonth\"){\r\n\t\tvar ret = (xparsed.month ? \"--\" + xparsed.month : false);\r\n\t}\r\n\telse if(ty == \"xsd:gDay\"){\r\n\t\tvar ret = (xparsed.day ? \"---\" + xparsed.day : false) ;\r\n\t}\r\n\telse if(ty == \"xsd:gYearMonth\"){\r\n\t\tvar ret = (xparsed.year && xparsed.month) ? xparsed.year + \"-\" + xparsed.month : false;\r\n\t}\r\n\telse if(ty == \"xsd:gMonthDay\"){\r\n\t\tvar ret = (xparsed.day && xparsed.month) ? \"--\" + xparsed.month + \"-\" + xparsed.day : false;\r\n\t}\r\n\tif(xparsed.timezone){\r\n\t\tret += xparsed.timezone;\r\n\t}\r\n\treturn ret;\r\n}\r\n\r\n\r\nFrameHelper.parseXsdTime = function(val){\r\n\tif(!val)return {};\r\n\tvar tz = this.extractXsdTimezone(val);\r\n\tif(tz){\r\n\t\tval = val.substring(0, val.length - tz.length);\r\n\t}\r\n\tvar parsed = {\r\n\t\thour: val.substring(0,2),\r\n\t\tminute: val.substring(3,5),\r\n\t\tsecond: val.substring(6),\r\n\t\ttimezone: tz\r\n\t}\r\n\treturn parsed;\r\n}\r\n\r\nFrameHelper.convertTimestampToXsd = function(val){\r\n\t  var a = new Date(val * 1000);\r\n\t  var parsed = {\r\n\t\t\tyear: a.getFullYear(),\r\n\t\t\tmonth: a.getMonth() + 1,\r\n\t\t\tday: a.getDate(),\r\n\t\t\thour: a.getHours(),\r\n\t\t\tminute: a.getMinutes(),\r\n\t\t\tsecond: a.getSeconds()\r\n\t  }\r\n\t  return parsed;\r\n}\r\n\r\nFrameHelper.parseXsdDateTime = function(val){\r\n\tif(!val)return {};\r\n\tif(typeof val == \"number\"){\r\n\t\treturn this.convertTimestampToXsd(val);\r\n\t}\r\n\tvar tz = this.extractXsdTimezone(val);\r\n\tif(tz){\r\n\t\tval = val.substring(0, val.length - tz.length);\r\n\t}\r\n\tvar datetime = this.parseXsdDate(val);\r\n\tvar ptime = this.paseXsdTime(val.substring(val.indexOf(\"T\")));\r\n\tfor(var i in ptime){\r\n\t\tdatetime[i] = ptime[i];\r\n\t}\r\n\tdatetime.timezone = tz;\r\n\treturn datetime;\r\n}\r\n\r\nFrameHelper.extractXsdTimezone = function(val){\r\n\tif(val && val.charAt(val.length-1) == \"Z\"){\r\n\t\treturn \"Z\";\r\n\t}\r\n\tif(val && val.charAt(val.length-6) == \"+\" || val.charAt(val.length-6) == \"-\" ){\r\n\t\tval.substring(val.length-6);\r\n\t}\r\n\treturn false;\r\n\r\n}\r\n\r\nFrameHelper.parseRangeValue = function(val, dividor){\r\n\tdividor = (dividor ? dividor : \",\");\r\n\tvar vals = [];\r\n\tif(typeof val == \"object\" && val.length){\r\n\t\tvals = val;\r\n\t}\r\n\telse if(val){\r\n\t\tif(typeof val != \"string\"){\r\n\t\t\tval = \"\" + val;\r\n\t\t}\r\n\t\tif(val.length && (val.charAt(0) == \"[\") && val.charAt(val.length -1) == \"]\"){\r\n\t\t\tvals.push(val.substring(1, val.indexOf(dividor)));\r\n\t\t\tvals.push(val.substring(val.indexOf(dividor) + 1, val.length -1));\r\n\t\t}\r\n\t\telse {\r\n\t\t\tvals.push(val);\r\n\t\t}\r\n\t}\r\n\treturn vals;\r\n}\r\n\r\nFrameHelper.loadDynamicScript = function(scriptid, src, callback) {\r\n\tconst existingScript = document.getElementById(scriptid);\r\n\tif (!existingScript) {\r\n\t\tconst script = document.createElement('script');\r\n\t\tscript.src = src; // URL for the third-party library being loaded.\r\n\t\tdocument.body.appendChild(script);\r\n\t\tscript.onload = function(){\r\n\t\t\tscript.id = scriptid; //do it here so it doesn't trigger the callback below on multiple calls\r\n\t\t\tif (callback) callback(scriptid);\r\n\t\t};\r\n\t}\r\n\tif (existingScript && callback) {\r\n\t\tcallback(scriptid);\r\n\t}\r\n};\r\n\r\nFrameHelper.loadDynamicCSS = function(cssid, src, callback) {\r\n\tconst existingScript = document.getElementById(cssid);\r\n\tif (!existingScript) {\r\n\t\tconst link = document.createElement('link');\r\n\t\tlink.href = src; // URL for the third-party library being loaded.\r\n\t\tlink.id = cssid; // e.g., googleMaps or stripe\r\n\t\tlink.rel = \"stylesheet\";\r\n\t\tdocument.body.appendChild(link);\r\n\t\tlink.onload = function(){\r\n\t\t\tif (callback) callback(cssid);\r\n\t\t};\r\n\t}\r\n\tif (existingScript && callback) callback(cssid);\r\n};\r\n\r\nmodule.exports=FrameHelper\r\n","/**\r\n * object renderer binds to object frame - provides filters, sorts and manipulations of underlying object frame\r\n * and coordinates viewer to draw updates\r\n\r\n * Object Renderer - provides sorting / filtering / state management of objects\r\n * @param obj ObjectFrame object - contains underlying data and frame structure\r\n * @param parent PropertyRenderer - property that owns this object (if any)\r\n * @param options options json\r\n * @returns\r\n */\r\n\r\nconst ValueRenderer = require('./ValueRenderer');\r\nconst RenderingMap = require('./RenderingMap');\r\nconst PropertyViewer = require('./PropertyViewer');\r\n\r\nfunction PropertyRenderer(prop, parent, options){\r\n\tthis.predicate = prop;\r\n\tthis.parent = parent;\r\n\tthis.cframe = this.parent.objframe.getPropertyClassFrame(this.predicate);\r\n\tthis.options = this.setOptions(options);\r\n\tthis.originalValues = false;\r\n\tthis.changed = false;\r\n\tthis.values = [];\r\n}\r\n\r\nPropertyRenderer.prototype.setOptions = function(options){\r\n\treturn RenderingMap.decorateRenderer(options, this);\r\n}\r\n\r\n\r\nPropertyRenderer.prototype.getOptionsForChild = function(){\r\n\tvar opts = {};\r\n\tif(this.options.features){ opts.features = this.options.features };\r\n\tif(this.options.controls){ opts.controls = this.options.controls};\r\n\treturn this.options;\r\n}\r\n\r\nPropertyRenderer.prototype.getOptionsForValue = function(df, index){\r\n\treturn this.getOptionsForChild();\r\n}\r\n\r\nPropertyRenderer.prototype.getOptionsForObject = function(objframe){\r\n\treturn this.getOptionsForChild();\r\n}\r\n\r\n\r\nPropertyRenderer.prototype.render = function(viewer){\r\n \tthis.buildValueRenderers();\r\n \tif(this.cframe && this.cframe.property){\r\n \t\tthis.viewer = (viewer ? viewer : this.getViewerForProperty());\r\n \t\tfor(var i = 0; i<this.values.length; i++){\r\n \t\t\tvar renderedval = this.values[i].render();\r\n \t\t\tif(renderedval && this.showFeature(\"body\")) this.viewer.addRenderedValue(renderedval);\r\n \t\t}\r\n \t\treturn this.viewer.render();\r\n \t}\r\n} \r\n\r\n/*\r\n * Creates the array of object renderer or value renderer objects corresponding to the property values. \r\n */\r\nPropertyRenderer.prototype.buildValueRenderers = function(){\r\n \tvar adorig = (this.originalValues === false ? true : false);\r\n \tthis.cframe = this.parent.objframe.getPropertyClassFrame(this.predicate);\r\n \tif(!this.cframe){\r\n \t\tconsole.error(\"No frame for \" + this.property() + \" id: \" + this.subject());\r\n \t\treturn false;\r\n \t}\r\n \tif(this.cframe && this.cframe.isData()){\r\n \t\tvar dataframes = this.getDataFramesToRender();\r\n \t\tif(dataframes.length == 0){\r\n \t\t\talert(this.predicate);\r\n \t\t}\r\n \t\tvar vals = [];\r\n \t\tfor(var i = this.values.length; i<dataframes.length; i++){\r\n \t\t\tvar vr = new ValueRenderer(dataframes[i], i, this, this.getOptionsForValue(dataframes[i], i));\r\n \t\t\tthis.values.push(vr);\r\n \t\t\tvals.push(vr.value());\r\n \t\t}\r\n \t\tif(adorig) this.originalValues = vals;\r\n \t}\r\n \telse {\r\n \t\tif(adorig) this.originalValues = [];\r\n \t\tvar kids = this.getChildrenToRender();\r\n \t\tif(kids && kids.length){\r\n \t\t\tfor(var i = this.values.length; i<kids.length; i++){\r\n \t\t\t\ttry {\r\n\t \t\t\t\tvar kidf = new ObjectRenderer(kids[i], this, this.getOptionsForObject(kids[i]));\r\n\t \t\t\t\tif(adorig) this.originalValues.push(kidf.subject());\r\n\t \t\t\t\tthis.values.push(kidf);\r\n \t\t\t\t}\r\n \t\t\t\tcatch(e){\r\n \t\t\t\t\talert(JSON.stringify(ObjectRenderer));\r\n \t\t\t\t\talert(e.toString() + \" \" + i);\r\n \t\t\t\t\talert(typeof ObjectRenderer);\r\n \t\t\t\t}\r\n \t\t\t}\r\n \t\t}\r\n \t}\r\n}\r\n\r\n/*\r\n * Returns the array of values that should be rendered (enables value filtering)\r\n */\r\nPropertyRenderer.prototype.getDataFramesToRender = function(options){\r\n \tvar allvals = this.parent.objframe.getDataFrames(this.property());\r\n \treturn allvals;\r\n}\r\n\r\n/*\r\n * Returns the array of child / objects that should be rendered (enables value filtering)\r\n */\r\nPropertyRenderer.prototype.getChildrenToRender = function(options){\r\n \t/*var sort = this.standardSort;\r\n \tvar filter = function(){return true};\r\n \tfor(var i = 0; i<options.map.patterns.length; i++){\r\n \t\tif(this.objframe.matchesPattern(\"sort\", options.map.patterns[i])){\r\n \t\t\tsort = options.map.patterns[i].sort;\r\n \t\t}\r\n \t\tif(this.objframe.matchesPattern(\"filter\", options.map.patterns[i])){\r\n \t\t\tfilter = options.map.patterns[i].filter;\r\n \t\t}\r\n \t}\r\n \treturn sort(this.values, filter);*/\r\n \tif(TerminusClient.FrameHelper.viewIncludesChildren(this.view, \"property\")){\r\n \t\tvar allkids = this.parent.objframe.getChildren(this.property());\r\n \t}\r\n \telse {\r\n \t\tvar allkids = [];\r\n \t}\r\n \treturn allkids;\r\n}\r\n\r\nPropertyRenderer.prototype.redraw = function(){\r\n \tthis.viewer.clear();\r\n \tthis.render(this.viewer);\r\n}\r\n\r\nPropertyRenderer.prototype.extract = function(){\r\n \tvar extracts = [];\r\n \tfor(var i = 0; i<this.values.length; i++){\r\n \t\tvar val = this.values[i].extract();\r\n \t\tif(val !== \"\" && val !== false && typeof val != \"undefined\") extracts.push(val);\r\n \t}\r\n \tif(this.cframe.isData()){\r\n \t\treturn extracts;\r\n \t}\r\n \telse {\r\n \t\treturn extracts;\r\n \t\tvar extr = {};\r\n \t\tfor(var i = 0; i<extracts.length; i++){\r\n \t\t\tfor(var subjid in extracts[i]){\r\n \t\t\t\textr[subjid] = extracts[i][subjid];\r\n \t\t\t}\r\n \t\t}\r\n \t\treturn extr;\r\n \t}\r\n}\r\n\r\n/*\r\n * simple wrapper functions\r\n */\r\nPropertyRenderer.prototype.currentViewer = function(){return this.viewerType;}\r\nPropertyRenderer.prototype.property = function(){return this.predicate;}\r\nPropertyRenderer.prototype.subject = function(){return (this.parent ? this.parent.subject() : false);};\r\nPropertyRenderer.prototype.depth = function(){return (this.parent ? this.parent.depth() : false);};\r\nPropertyRenderer.prototype.subjectClass = function(){return (this.parent ? this.parent.subjectClass() : false);};\r\nPropertyRenderer.prototype.updated = function(){ return (this.parent ? this.parent.childUpdated() : false);};\r\nPropertyRenderer.prototype.range = function(){\treturn (this.cframe ? this.cframe.range : \"\");};\r\nPropertyRenderer.prototype.getLabel = function(){ return (this.cframe ? this.cframe.getLabel() : \"\" );};\r\nPropertyRenderer.prototype.getComment = function(){ return (this.cframe ? this.cframe.getComment() : false);}\r\nPropertyRenderer.prototype.load = function(link){ return (this.parent ? this.parent.load(link) : false);}\r\nPropertyRenderer.prototype.hasCardinalityRestriction = function(){return (this.cframe ? this.cframe.hasRestriction() : false);};\r\nPropertyRenderer.prototype.getRestriction = function(){return (this.cframe ? this.cframe.restriction : false);};\r\nPropertyRenderer.prototype.isClassChoice = function(){\treturn (this.cframe ? this.cframe.isClassChoice() : false);};\r\nPropertyRenderer.prototype.currentFacet = function(){\treturn this.facet;} ;\r\nPropertyRenderer.prototype.save = function(){ return (this.parent ? this.parent.save() : false);};\r\n\r\nPropertyRenderer.prototype.cancel = function(){\r\n\tthis.reset();\r\n\tthis.setMode(\"view\");\r\n}\r\n\r\nPropertyRenderer.prototype.getAvailableClassChoices = function(){ \r\n\tif(this.cframe){\r\n\t\tvar cf = this.cframe.getClassChoices();\r\n\t\tif(this.parent){\r\n\t\t\tvar choices = [];\r\n\t\t\tfor(var i = 0; i < cf.length; i++){\r\n\t\t\t\tvar clsmeta = this.parent.getClassMeta(cf[i]);\r\n\t\t\t\tvar lab = ((clsmeta && clsmeta.Label && clsmeta.Label[\"@value\"]) ? clsmeta.Label[\"@value\"] : TerminusClient.FrameHelper.labelFromURL(cf[i]));\r\n\t\t\t\tchoices.push({value: cf[i], label: lab});\r\n\t\t\t}\r\n\t\t\treturn choices;\r\n\t\t}\r\n\t\treturn cf;\r\n\t\t\r\n\t}\r\n\treturn false;\r\n};\r\n\r\n\r\nPropertyRenderer.prototype.delete = function(){\r\n\tvar prop = this.predicate;\r\n\tif(prop){\r\n\t\tthis.reset();\r\n\t\tthis.parent.deleteProperty(prop);\t\r\n\t\tthis.parent.redraw();\r\n\t}\r\n}\r\n\r\nPropertyRenderer.prototype.add = function(view){\r\n\tthis.parent.addProperty(this.property(), view);\r\n\tthis.updated();\r\n\tif(view) {\r\n\t\tthis.values[this.values.length-1].setMode(view);\r\n\t\tthis.values[this.values.length-1].setNew();\r\n\t}\r\n\tthis.redraw();\r\n\tthis.goToValue(this.values.length-1);\r\n}\r\n\r\nPropertyRenderer.prototype.goToValue = function(index){\r\n\tthis.viewer.goTo(this.subject(), this.property(), index);\r\n}\r\n\r\nPropertyRenderer.prototype.addClass = function(cls){\r\n\tthis.parent.addPropertyClass(this.property(), cls);\r\n\tthis.updated();\r\n\tvar newb = this.values[this.values.length-1];\r\n\tif(newb){\r\n\t\tnewb.setNew();\r\n\t\tnewb.setMode(\"edit\");\r\n\t}\r\n\tthis.redraw();\r\n\tif(newb) this.viewer.goTo(newb.subject());\r\n}\r\n\r\nPropertyRenderer.prototype.reset = function(){\r\n\tthis.parent.objframe.reset(this.predicate);\r\n\tif(this.cframe && this.cframe.isData()){\r\n\t\tfor(var i = 0; i<this.values.length; i++){\r\n\t\t\tthis.values[i].reset();\r\n\t\t}\r\n\t\tthis.values = [];\r\n\t}\r\n\telse {\r\n\t\tvar nvals = [];\r\n\t\tfor(var i = 0; i<this.originalValues.length; i++){\r\n\t\t\tfor(var j = 0; j<this.values.length; j++){\r\n\t\t\t\tthis.values[j].reset();\r\n\t\t\t\tif(this.values[j].subject() == this.originalValues[i]){\r\n\t\t\t\t\tnvals.push(this.values[j]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.values = nvals;\r\n\t}\r\n\tthis.redraw();\t\r\n\tthis.parent.childUpdated();\r\n}\r\n\r\nPropertyRenderer.prototype.deletePropertyValue = function(value, index){\r\n\tthis.parent.objframe.removePropertyValue(this.property(), value, index);\r\n\tvar nvals = [];\r\n\tfor(var i = 0; i<this.values.length; i++){\r\n\t\tif(typeof index == \"undefined\"){\r\n\t\t\tif(this.values[i].subject() == value){\r\n\t\t\t\tthis.values[i].reset();\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tnvals.push(this.values[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if(i != index){\r\n\t\t\tthis.values[i].index = nvals.length;\r\n\t\t\tnvals.push(this.values[i]);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.values[i].reset();\r\n\t\t}\r\n\t}\r\n\tthis.values = nvals;\r\n\tthis.parent.childUpdated();\r\n\tthis.parent.redraw();\r\n}\r\n\r\nPropertyRenderer.prototype.addPropertyValue = function(value){\r\n\tthis.updated();\r\n\treturn this.parent.objframe.addPropertyValue(this.property(), value);\r\n}\r\n\r\n/*\r\n * Checks to see if an action (add, clone, delete) which affects the cardinality of the property is allowed by cardinality rules.\r\n */\r\nPropertyRenderer.prototype.cardControlAllows = function(action){\r\n\tif(this.cframe.hasRestriction()){\r\n\t\tvar rest = this.cframe.restriction;\r\n\t\tvar currentnum = this.values.length;\r\n\t\tif(action == \"add\" || action == \"clone\"){\r\n\t\t\tif(rest.max && currentnum >= rest.max){\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(action == \"delete\" && (rest.min)){\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nPropertyRenderer.prototype.isNew = function(){\r\n\tif(this.new_property){\r\n\t\treturn true;\r\n\t}\r\n\treturn this.parent.isNew();\r\n}\r\n\r\nPropertyRenderer.prototype.setNew = function(){\r\n\tthis.new_property = true;\r\n}\r\n\r\n\r\nPropertyRenderer.prototype.isUpdated = function(){\r\n\tif(this.values.length != this.originalValues.length) return true;\r\n\tfor(var i = 0 ; i < this.values.length; i++){\r\n\t\tif(this.cframe && this.cframe.isData()){\r\n\t\t\tif(this.values[i].value() != this.originalValues[i]){\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tif(this.values[i].subject() != this.originalValues[i]) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\tif(this.values[i].isUpdated()) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nPropertyRenderer.prototype.childUpdated = function(){\r\n\tthis.viewer.redrawHeader();\r\n\tif(this.parent) this.parent.childUpdated();\r\n}\r\n\r\n\r\n/**\r\n * Sets mode of viewer to either \"view\" or \"edit\"\r\n */\r\nPropertyRenderer.prototype.setMode = function(mode){\r\n\tthis.mode = mode;\r\n\tfor(var i = 0; i<this.values.length; i++){\r\n\t\tthis.values[i].setMode(mode);\r\n\t}\r\n\tthis.redraw();\r\n}\r\n\r\n/*\r\n * Jump to property value\r\n */\r\nPropertyRenderer.prototype.getViewableValues = function(){\r\n\tvar viewables = [];\r\n\tif(this.cframe && this.cframe.isData())\r\n\tfor(var i = 0; i<this.values.length; i++){\r\n\t\tvar sum = this.values[i].getSummary();\r\n\t\tvar lab = sum.long;\r\n\t\tviewables.push({label: lab, value: i});\r\n\t}\r\n\treturn viewables;\r\n}\r\n\r\nPropertyRenderer.prototype.hideDisabledControls = function(){\r\n\treturn this.hide_disabled_controls;\r\n}\r\n\r\nPropertyRenderer.prototype.setFacet = function(facet, nocascade){\r\n\tthis.facet = facet;\r\n\tif(!nocascade){\r\n\t\tfor(var i = 0; i<this.values.length; i++){\r\n\t\t\tthis.values[i].parentFacetChange(facet);\r\n\t\t}\r\n\t}\r\n\tthis.redraw();\r\n}\r\n\r\nPropertyRenderer.prototype.parentFacetChange = function(facet){\r\n\tif(facet == 'page'){\r\n\t\tif(!(this.facet == \"page\" || this.facet == \"multiline\")){\r\n\t\t\tthis.setFacet('multiline');\r\n\t\t}\r\n\t}\r\n\tif(facet == 'line'){\r\n\t\tthis.setFacet(\"label\");\r\n\t}\r\n\t\t\r\n}\r\n\r\n\r\n\r\nPropertyRenderer.prototype.getDefaultFacets = function(){\r\n\tvar defs = {\r\n\t\tpage: {\r\n\t\t\tlabel: \"Full Page\", value: \"page\", \r\n\t\t\tfeatures: [\"facet\", \"label\", \"comment\", \"id\", \"control\", \"type\", \"cardinality\", \"body\", \"status\", \"facet\", \"view\", \"viewer\"], \r\n\t\t\tcontrols: [\"delete\", \"clone\", \"add\", \"reset\", \"cancel\", \"update\", \"mode\", \"show\", \"hide\"]\r\n\t\t},\r\n\t\tmultiline: {\r\n\t\t\tlabel: \"Multiple Lines\", value: \"multiline\",\r\n\t\t\tfeatures: [\"facet\", \"label\", \"comment\", \"id\", \"control\", \"type\", \"cardinality\", \"body\", \"status\", \"facet\", \"view\", \"viewer\"], \r\n\t\t\tcontrols: [\"delete\", \"clone\", \"add\", \"reset\", \"cancel\", \"update\", \"mode\", \"show\", \"hide\"]\r\n\t\t},\r\n\t\tline: {\r\n\t\t\tlabel: \"Single Line\", value: \"line\",\r\n\t\t\tfeatures: [\"facet\", \"label\", \"comment\", \"id\", \"control\", \"type\", \"cardinality\", \"body\", \"status\", \"facet\", \"viewer\"], \r\n\t\t\tcontrols: [\"delete\", \"clone\", \"add\", \"reset\", \"cancel\", \"update\", \"mode\", \"show\", \"hide\"]\r\n\t\t},\r\n\t\tsummary: {\r\n\t\t\tlabel: \"Summary\", value: \"summary\",\r\n\t\t\tfeatures: [\"facet\", \"satus\", \"label\", \"type\", \"cardinality\", \"body\", \"status\", \"facet\", \"viewer\"], \r\n\t\t\tcontrols: [] \r\n\t\t},\r\n\t\tlabel: {\r\n\t\t\tlabel: \"Label\", value: \"label\",\r\n\t\t\tfeatures: [\"facet\", \"status\", \"label\", \"summary\"],\r\n\t\t\tcontrols: []\r\n\t\t},\r\n\t\ticon: {\r\n\t\t\tlabel: \"Snippet\", value: \"icon\",\r\n\t\t\tfeatures: [\"facet\", \"summary\"],\r\n\t\t\tcontrols: []\r\n\t\t}\r\n\t}\r\n\treturn defs;\t\r\n}\r\n\r\nPropertyRenderer.prototype.getAvailableFacets = function(){\r\n\treturn Object.values(this.facets);\r\n\tvar facets = [];\r\n\tfacets.push({label: \"Full Page\", value: \"page\"});\r\n\tfacets.push({label: \"Multiple Lines\", value: \"multiline\"});\r\n\tfacets.push({label: \"Single Line\", value: \"line\"});\r\n\tfacets.push({label: \"Summary\", value: \"summary\"});\r\n\tfacets.push({label: \"Label\", value: \"label\"});\r\n\tfacets.push({label: \"Snippet\", value: \"icon\"});\r\n\treturn facets;\r\n}\r\n\r\nPropertyRenderer.prototype.getContentOrientation = function(facet){\r\n\tif(this.currentFacet() == \"page\" || this.containsPage()){\r\n\t\treturn \"page\";\r\n\t}\r\n\tif(this.currentFacet() == \"line\" || this.currentFacet() == \"multiline\" || this.currentFacet() == \"summary\"){\r\n\t\treturn \"line\";\r\n\t}\r\n\treturn \"label\";\r\n}\r\n\r\n\r\nPropertyRenderer.prototype.getDefaultFacet = function(){\r\n\tif(this.cframe && this.cframe.isObject()){\r\n\t\treturn \"page\";\r\n\t}\r\n\treturn \"multiline\";\r\n}\r\n\r\n/*\r\n * Viewers for specific properties\r\n */\r\n\r\nPropertyRenderer.prototype.hide = function(){\r\n\tthis.setView(\"hidden\");\r\n}\r\n\r\nPropertyRenderer.prototype.show = function(){\r\n\tthis.setView(\"full\");\r\n}\r\n\r\nPropertyRenderer.prototype.setView = function(view){\r\n\tthis.view = view;\r\n\tthis.redraw();\r\n}\r\n\r\nPropertyRenderer.prototype.getAvailableViewers = function(){\r\n\tif(this.mode == \"view\"){\r\n\t\treturn RenderingMap.getAvailablePropertyViewers(this);\t\t\r\n\t}\r\n\treturn RenderingMap.getAvailablePropertyEditors(this);\t\t\t\t\r\n}\r\n\r\nPropertyRenderer.prototype.nukeViewer = function(){\r\n\tthis.viewer.remove();\r\n}\r\n\r\nPropertyRenderer.prototype.containsPage = function(){\r\n\t//collapsed facets do not show their values\r\n\tif(this.currentFacet() == \"icon\" || this.currentFacet() == \"label\") return false;\r\n\tfor(var i = 0; i<this.values.length; i++){\r\n\t\tif(this.values[i].facet == \"page\") {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nPropertyRenderer.prototype.getViewerForProperty = function(ptype){\r\n\tif(this.mode == \"edit\"){\r\n\t\treturn RenderingMap.getEditorForProperty(ptype, this);\t\t\t\t\r\n\t}\r\n\treturn RenderingMap.getViewerForProperty(ptype, this);\t\r\n}\r\n\r\nPropertyRenderer.prototype.getPropertyHeaderViewer = function(){\r\n\treturn new PropertyViewer.HTMLPropertyHeaderViewer();\r\n}\r\n\r\nPropertyRenderer.prototype.getSummary = function(){\r\n\tvar status = \"ok\";\r\n\tif(this.isNew()) status = \"new\";\r\n\telse if(this.isUpdated()) status = \"updated\";\r\n\tvar ret = {\r\n\t\tstatus: status,\r\n\t\tvalcount: this.values.length\r\n\t};\r\n\tret.long = ((ret.valcount != 1) ? \"(\" + ret.valcount + \") \" : \"\");\r\n\tfor(var i = 0; i<this.values.length; i++){\r\n\t\tvsum = this.values[i].getSummary();\r\n\t\tret.long += vsum.long;\r\n\t\tif(i < this.values.length-1) ret.long += \", \";\r\n\t}\r\n\treturn ret;\t\r\n}\r\n\r\nPropertyRenderer.prototype.getFeaturesForFacet = function(facet){\r\n\treturn this.facets[facet].features.concat(this.facets[facet].controls);\r\n}\r\n \r\nPropertyRenderer.prototype.showFeature = function(which){\r\n\tif(this.features.indexOf(which) == -1 && this.controls.indexOf(which) == -1) {\r\n\t\treturn false;\r\n\t}\r\n\tvar cardcontrols = [\"delete\", \"clone\", \"add\"];\r\n\tif(cardcontrols.indexOf(which) != -1){\r\n\t\tif(!this.cardControlAllows(which)) return false;\r\n\t}\r\n\tvar updcontrols = [\"update\", \"reset\"];\r\n\tif(this.hideDisabledControls() && updcontrols.indexOf(which) != -1 ){\r\n\t\tif(!this.isUpdated()){\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\tif(which == 'hide' && this.view == \"hidden\") return false;\r\n\tif(which == 'show' && this.view != \"hidden\") return false;\r\n\tvar fets = this.getFeaturesForFacet(this.facet);\r\n\treturn (fets.indexOf(which) != -1);\r\n}\r\n\r\nfunction ObjectRenderer(obj, parent, options){\r\n\tthis.objframe = obj;\r\n\tthis.parent = parent;\r\n\tthis.options = this.setOptions(options);\r\n\tthis.properties = {};\r\n\tthis.originalProperties = false;\r\n\tthis.newProperties = [];\r\n}\r\n\r\n//options has to include mode, viewer, facet, controls, features, hide_disabled_controls\r\n\r\nObjectRenderer.prototype.setOptions = function(options){\r\n\treturn RenderingMap.decorateRenderer(options, this);\r\n}\r\n\r\nObjectRenderer.prototype.getOptionsForProperty = function(prop){\r\n\treturn this.options;\r\n}\r\n\r\nObjectRenderer.prototype.render = function(viewer){\r\n\tthis.buildPropertyRenderers();\r\n\tthis.viewer = (viewer ? viewer: this.getViewerForObject());\r\n\tfor(var prop in this.properties){\r\n\t\tvar renderedprop = this.properties[prop].render();\r\n\t\tif(renderedprop && this.showFeature(\"body\")) this.viewer.addRenderedProperty(prop, renderedprop);\r\n\t}\r\n\treturn this.viewer.render(this.view);\r\n}\r\n\r\nObjectRenderer.prototype.buildPropertyRenderers = function(){\r\n\tvar props = this.getPropertiesToRender();\r\n\tif(this.originalProperties === false) this.originalProperties = props;\r\n\tvar renders = {};\r\n\tfor(var j = 0; j<props.length; j++){\r\n\t\tif(typeof this.properties[props[j]] == \"undefined\"){\r\n\t\t\trenders[props[j]] = new PropertyRenderer(props[j], this, this.getOptionsForProperty(props[j]));\r\n\t\t}\r\n\t\telse {\r\n\t\t\trenders[props[j]] = this.properties[props[j]];\r\n\t\t}\r\n\t\tif(this.newProperties.indexOf(props[j]) != -1) {\r\n\t\t\trenders[props[j]].setNew(); \r\n\t\t\trenders[props[j]].mode = \"edit\"; \r\n\t\t}\r\n\t}\r\n\tthis.properties = renders;\r\n}\r\n\r\nObjectRenderer.prototype.subject = function(){\r\n\tif(this.objframe) return this.objframe.subjid;\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.subjectClass = function(){\r\n\tif(this.objframe) return this.objframe.cls;\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.getAvailableViewers = function(){\r\n\t//if(this.mode == \"view\"){\r\n\t//\treturn RenderingMap.getAvailableObjectViewers(this);\t\t\r\n\t//}\r\n\t//return RenderingMap.getAvailableObjectEditors(this);\t\t\t\t\r\n\treturn [\"html\", \"json\"];\r\n}\r\n\r\nObjectRenderer.prototype.depth = function(){\r\n\tif(this.parent) return (this.parent.depth() + 1);\r\n\treturn 0;\r\n}\r\n\r\n\r\nObjectRenderer.prototype.property = function(){\r\n\tif(this.parent) return this.parent.property();\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.parentObject = function(){\r\n\tif(this.parent && this.parent.parent && this.parent.parent.objframe){\r\n\t\treturn this.parent.parent.objframe;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.root = function(){\r\n\tif(this.parent) return false;\r\n\treturn true;\r\n}\r\n\r\nObjectRenderer.prototype.load = function(link){\r\n\tvar self = this;\r\n\tif(this.controller){\r\n\t\tthis.controller.ui.showDocument(link);\r\n\t}\r\n\telse if(this.parent) {\r\n\t\tthis.parent.load(link);\r\n\t}\r\n}\r\n\r\nObjectRenderer.prototype.copy = function(nkid){\r\n\tnkid = (nkid ? nkid : this.objframe);\r\n\tvar other = new ObjectRenderer(nkid, this.parent, this.options);\r\n\treturn other;\r\n}\r\n\r\nObjectRenderer.prototype.clone = function(){\r\n\tif(this.root()){\r\n\t\tthis.objframe = this.objframe.clone(\"_:\");\r\n\t\tthis.objframe.newDoc = true;\r\n\t\tthis.setMode(\"edit\");\r\n\t}\r\n\telse {\r\n\t\tvar nkid = this.objframe.clone(TerminusClient.FrameHelper.genBNID());\r\n\t\tvar parentobj = this.parentObject();\r\n\t\tvar prop = this.property();\r\n\t\tif(parentobj && prop){\r\n\t\t\tif(typeof parentobj.children[prop] == \"undefined\"){\r\n\t\t\t\tparentobj.children[prop] = [];\r\n\t\t\t}\r\n\t\t\tparentobj.children[prop].push(nkid);\r\n\t\t\tvar newrend = this.copy(nkid);\r\n\t\t\tthis.parent.values.push(newrend);\r\n\t\t}\r\n\t\tthis.parent.redraw();\r\n\t}\r\n}\r\n\r\nObjectRenderer.prototype.cancel = function(){\r\n\tthis.reset();\r\n\tthis.setMode(\"view\");\r\n}\r\n\r\nObjectRenderer.prototype.save = function(){\r\n\tif(this.controller){\r\n\t\tif(this.isNewDocument()){\r\n\t\t\tvar demandid = this.inputID();\r\n\t\t\tif(demandid == \"_:\") demandid = \"\";\r\n\t\t\tthis.controller.createDocument(demandid);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.controller.updateDocument();\r\n\t\t}\r\n\t}\r\n\telse if(this.parent) {\r\n\t\tthis.parent.save();\r\n\t}\r\n}\r\n\r\nObjectRenderer.prototype.delete = function(){\r\n\tvar dval = this.subject();\r\n\tif(this.controller && this.root()){\r\n\t\tif(!this.isNewDocument()){\r\n\t\t\tthis.controller.deleteDocument(dval);\r\n\t\t}\r\n\t\tthis.nukeViewer();\r\n\t}\r\n\telse {\r\n\t\tif(this.parent){\r\n\t\t\tthis.parent.deletePropertyValue(dval);\t\t\r\n\t\t\tthis.parent.redraw();\r\n\t\t}\r\n\t}\r\n}\r\n\r\nObjectRenderer.prototype.reset = function(){\r\n\tthis.objframe.reset();\r\n\tvar nprops = {};\r\n\tfor(var i = 0; i<this.originalProperties.length; i++){\r\n\t\tvar prop = this.originalProperties[i];\r\n\t\tif(typeof this.properties[prop] == \"object\"){\r\n\t\t\tthis.properties[prop].reset();\r\n\t\t\tnprops[prop] = this.properties[prop];\r\n\t\t}\r\n\t}\r\n\tthis.properties = nprops;\r\n\tthis.redraw();\r\n}\r\n\r\nObjectRenderer.prototype.deleteProperty = function(prop){\r\n\tthis.objframe.removeProperty(prop);\r\n\tdelete(this.properties[prop]);\r\n\tthis.updated();\r\n}\r\n\r\nObjectRenderer.prototype.addProperty = function(prop){\r\n\tthis.objframe.addProperty(prop);\r\n\tthis.updated();\r\n\tthis.redraw();\r\n}\r\n\r\nObjectRenderer.prototype.addNewProperty = function(prop){\r\n\tthis.objframe.addProperty(prop);\r\n\tthis.updated();\r\n\tthis.newProperties.push(prop);\r\n\tthis.redraw();\r\n\tthis.goToProperty(prop);\r\n}\r\n\r\nObjectRenderer.prototype.addPropertyClass = function(prop, cls){\r\n\tthis.objframe.addProperty(prop, cls);\r\n\tthis.updated();\r\n}\r\n\r\nObjectRenderer.prototype.changeClass = function(cls){\r\n\tif(this.parent){\r\n\t\tthis.parent.addClass(cls);\t\t\r\n\t\tthis.parent.deletePropertyValue(this.subject());\t\t\r\n\t}\r\n}\r\n\r\nObjectRenderer.prototype.getClassMeta = function(cls){\r\n\tvar ctl = this.getController();\r\n\tif(ctl && ctl.classmeta && ctl.classmeta[cls]){\r\n\t\treturn ctl.classmeta[cls];\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.getController = function(){\r\n\tif(this.controller){\r\n\t\treturn this.controller;\r\n\t}\r\n\tif(this.parent && this.parent.parent){\r\n\t\treturn this.parent.parent.getController();\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.getClient = function(){\r\n\tif(this.controller){\r\n\t\treturn this.controller.getClient();\r\n\t}\r\n\telse {\r\n\t\tif(this.parent && this.parent.parent){\r\n\t\t\treturn(this.parent.parent.getClient())\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.inputID = function(){\r\n\tif(this.idDOM){\r\n\t\treturn this.idDOM.value;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.isNew = function(){\r\n\tif(this.new_object){\r\n\t\treturn true;\r\n\t}\r\n\tif(this.isPartOfNewDocument()){\r\n\t\treturn true;\r\n\t}\r\n\tif(this.parent) return this.parent.isNew();\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.setNew = function(){\r\n\tthis.new_object = true;\r\n}\r\n\r\nObjectRenderer.prototype.isUpdated = function(){\r\n\tvar i = 0;\r\n\tfor(var prop in this.properties){\r\n\t\tif(this.originalProperties[i] != prop) return true;\r\n\t\tif(this.properties[prop].isUpdated()) return true;\r\n\t\ti++;\t\t\r\n\t}\r\n\tif(i != this.originalProperties.length) return true;\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.childUpdated = function(){\r\n\tthis.viewer.redrawHeader();\r\n\tif(this.parent) this.parent.childUpdated();\r\n}\r\n\r\nObjectRenderer.prototype.updated = ObjectRenderer.prototype.childUpdated;\r\n\r\nObjectRenderer.prototype.isNewDocument = function(){\r\n\tif(this.root() && this.objframe.isnew()) return true;\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.isPartOfNewDocument = function(){\r\n\tif(this.isNewDocument()) return true;\r\n\tif(this.parent && this.parent.parent){\r\n\t\treturn this.parent.parent.isPartOfNewDocument();\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.setFacet = function(facet, nocascade){\r\n\tthis.facet = facet;\r\n\tif(!nocascade){\r\n\t\tfor(var prop in this.properties){\r\n\t\t\tthis.properties[prop].parentFacetChange(facet);\r\n\t\t}\r\n\t}\r\n\tif(this.parent){\r\n\t\tthis.parent.redraw();\r\n\t}\r\n\telse {\r\n\t\tthis.redraw();\r\n\t}\r\n}\r\n\r\nObjectRenderer.prototype.getDefaultFacets = function(){\r\n\tvar defs = {\r\n\t\tpage: {\r\n\t\t\tlabel: \"Full Page\", value: \"page\", \r\n\t\t\tfeatures: [\"facet\", \"label\", \"comment\", \"id\", \"control\", \"type\", \"body\", \"status\", \"facet\", \"view\", \"viewer\"],\r\n\t\t\tcontrols: [\"delete\", \"clone\", \"add\", \"reset\", \"cancel\", \"update\", \"mode\", \"show\", \"hide\"] \r\n\t\t},\r\n\t\tline: {\r\n\t\t\tlabel: \"Single Line\", value: \"line\",\r\n\t\t\tfeatures: [\"facet\", \"label\", \"comment\", \"id\", \"type\", \"body\", \"status\", \"facet\"], \r\n\t\t\tcontrols: [] \r\n\t\t},\r\n\t\tsummary: {\r\n\t\t\tlabel: \"Summary\", value: \"summary\",\r\n\t\t\tfeatures: [\"facet\", \"satus\", \"label\", \"type\", \"summary\", \"status\", \"facet\"], \r\n\t\t\tcontrols: [] \r\n\t\t},\r\n\t\tlabel: {\r\n\t\t\tlabel: \"Label\", value: \"label\",\r\n\t\t\tfeatures: [\"facet\", \"status\", \"label\"],\r\n\t\t\tcontrols: []\r\n\t\t}\r\n\t}\r\n\treturn defs;\r\n}\r\n\r\nObjectRenderer.prototype.getAvailableFacets = function(){\r\n\treturn Object.keys(this.facets);\r\n}\r\n\r\nObjectRenderer.prototype.currentFacet = function(){\r\n\treturn this.facet;\r\n}\r\n\r\nObjectRenderer.prototype.getDefaultFacet = function(){\r\n\tif(!this.parent) return \"page\";\r\n\tvar pfacet = this.parent.currentFacet();\r\n\tif(pfacet == \"page\"){\r\n\t\treturn \"page\";\r\n\t}\r\n\tif(pfacet == \"multiline\") return \"line\";\r\n\tif(pfacet == \"line\") return \"summary\";\r\n\treturn \"label\";\r\n}\r\n\r\nObjectRenderer.prototype.parentFacetChange = function(pfacet){\r\n\tif(pfacet == \"page\") this.setFacet(\"page\");\r\n\tif(pfacet == \"multiline\") this.setFacet(\"summary\");\r\n\tif(pfacet == \"line\") this.setFacet(\"summary\");\r\n\tif(pfacet == \"summary\") this.setFacet(\"summary\");\r\n}\r\n\r\nObjectRenderer.prototype.getContentOrientation = function(){\r\n\tif(this.currentFacet() == \"page\"){\r\n\t\treturn \"page\";\r\n\t}\r\n\tif(this.currentFacet() == \"line\"){\r\n\t\treturn \"line\";\r\n\t}\r\n\treturn \"label\";\r\n}\r\n\r\nObjectRenderer.prototype.getLabel = function(){\r\n\tfor(var prop in this.properties){\r\n\t\tif(TerminusClient.FrameHelper.getShorthand(prop) == \"rdfs:label\"){\r\n\t\t\tvar prend = this.properties[prop];\r\n\t\t\tvar vrend = prend.values[0];\r\n\t\t\tif(vrend){\r\n\t\t\t\tvar sum = vrend.getSummary();\r\n\t\t\t\tif(sum.long != \"empty\") return sum.long;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tvar s = this.subject();\r\n\tif(s && s.substring(0, 2) == \"_:\"){\r\n\t\tvar ty = this.subjectClass();\r\n\t\tvar sh = TerminusClient.FrameHelper.getShorthand(ty);\r\n\t\tif(sh){\r\n\t\t\tvar b = sh.split(\":\");\r\n\t\t\tif(b.length > 1){\r\n\t\t\t\treturn \"New \" + b[1];\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn \"New Object\";\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.getSummary = function(){\r\n\tvar ret = { status: \"ok\" };\r\n\tif(this.isUpdated()) ret.status = \"updated\";\r\n\tif(this.isNew()) ret.status = \"new\";\r\n\tret.propcount = 0;\r\n\tfor(var prop in this.properties){\r\n\t\tret.propcount++;\r\n\t}\r\n\tret.long = ret.propcount + \" properties\";\r\n\treturn ret;\t\r\n}\r\n\r\nObjectRenderer.prototype.getObjectHeaderViewer = function(){\r\n\treturn this.header_viewer;\r\n}\r\n\r\nObjectRenderer.prototype.getViewerForObject = function(format){\r\n\treturn RenderingMap.getViewerForObject(format, this);\t\r\n}\r\n\r\nObjectRenderer.prototype.getFeaturesForFacet = function(facet){\r\n\treturn this.facets[facet].features.concat(this.facets[facet].controls);\r\n}\r\n \r\nObjectRenderer.prototype.hideDisabledControls = function(){\r\n\treturn this.hide_disabled_controls;\r\n}\r\n\r\nObjectRenderer.prototype.showFeature = function(which){\r\n\tif(this.features.indexOf(which) == -1 && this.controls.indexOf(which) == -1) {\r\n\t\treturn false;\r\n\t}\r\n\tvar cardcontrols = [\"delete\", \"clone\", \"add\"];\r\n\tif(cardcontrols.indexOf(which) != -1){\r\n\t\tif(!this.cardControlAllows(which)) return false;\r\n\t}\r\n\tvar updcontrols = [\"update\", \"reset\"];\r\n\tif(this.hideDisabledControls() && updcontrols.indexOf(which) != -1 ){\r\n\t\tif(!this.isUpdated()){\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\tif(this.isNewDocument() && which == \"clone\") return false;\r\n\tif(which == 'hide' && this.view == \"hidden\") return false;\r\n\tif(which == 'show' && this.view != \"hidden\") return false;\r\n\tvar fets = this.getFeaturesForFacet(this.facet);\r\n\tif (fets.indexOf(which) != -1){\r\n\t\treturn true;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.cardControlAllows = function(action){\r\n\tif(!this.parent) return true;\r\n\tif(this.parent.cframe.hasRestriction()){\r\n\t\tvar rest = this.parent.cframe.restriction;\r\n\t\tvar currentnum = this.parent.values.length;\r\n\t\tif(action == \"add\" || action == \"clone\"){\r\n\t\t\tif(rest.max && currentnum >= rest.max){\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(action == \"delete\" && (rest.min && currentnum <= rest.min)){\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nObjectRenderer.prototype.goToProperty = function(prop){\r\n\tthis.viewer.goTo(this.subject(), prop);\r\n}\r\n\r\nObjectRenderer.prototype.setMode = function(mode){\r\n\tthis.mode = mode;\r\n\tfor(var prop in this.properties){\r\n\t\tthis.properties[prop].setMode(mode);\r\n\t}\r\n\tthis.viewer.redraw();\r\n}\r\n\r\nObjectRenderer.prototype.currentViewer = function(){return this.viewerType;}\r\n\r\n\r\nObjectRenderer.prototype.setViewer = function(viewer){\r\n\tvar nviewer = this.getViewerForObject(viewer);\r\n\tif(nviewer){\r\n\t\tthis.viewerType = viewer;\r\n\t\tthis.viewer = nviewer;\r\n\t\tthis.viewer.redraw();\r\n\t}\r\n}\r\n\r\n\r\nObjectRenderer.prototype.setView = function(view){\r\n\tvar views = {\r\n\t\t\"full\": {\r\n\t\t\t\r\n\t\t},\r\n\t\t\"hidden\": {\r\n\t\t\t\r\n\t\t}\r\n\t};\r\n\tthis.view = view;\r\n\tthis.viewer.redraw();\r\n}\r\n\r\n\r\nObjectRenderer.prototype.hide = function(){\r\n\tthis.setView(\"hidden\");\r\n}\r\n\r\nObjectRenderer.prototype.show = function(){\r\n\tthis.setView(\"full\");\r\n}\r\n\r\nObjectRenderer.prototype.nukeViewer = function(){\r\n\tthis.viewer.remove();\r\n}\r\n\r\nObjectRenderer.prototype.getViewableProperties = function(){\r\n\treturn this.objframe.getFilledPropertyList();\t\r\n}\r\n\r\nObjectRenderer.prototype.getAddableProperties = function(){\r\n\tvar props = this.objframe.getMissingPropertyList();\t\r\n\treturn props;\r\n}\r\n\r\nObjectRenderer.prototype.getPropertiesToRender = function(options){\r\n\tvar sort = this.standardSort;\r\n\tvar filter = function(){return true};\r\n\tif(options && options.map && options.map.patterns){\r\n\t\tfor(var i = 0; i<options.map.patterns.length; i++){\r\n\t\t\tif(this.objframe.matchesPattern({property: this.property(), action: \"sort\"}, options.map.patterns[i])){\r\n\t\t\t\tsort = options.map.patterns[i].sort;\r\n\t\t\t}\r\n\t\t\tif(this.objframe.matchesPattern({property: this.property(), action: \"filter\"}, options.map.patterns[i])){\r\n\t\t\t\tfilter = options.map.patterns[i].filter;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn sort(this.objframe, filter);\r\n}\r\n\r\nObjectRenderer.prototype.standardSort = function(objframe, filter){\r\n\tvar sorted = [];\r\n\tvar rdft = TerminusClient.FrameHelper.getStdURL(\"rdfs\", \"label\");\r\n\tif(objframe.dataframes[rdft] && filter(objframe, rdft, objframe.dataframes[rdft])){\r\n\t\tsorted.push(rdft);\r\n\t}\r\n\tvar rdfc = TerminusClient.FrameHelper.getStdURL(\"rdfs\", \"comment\");\r\n\tif(objframe.dataframes[rdfc]){\r\n\t\tsorted.push(rdfc);\r\n\t}\r\n\tfor(var prop in objframe.dataframes){\r\n\t\tif(sorted.indexOf(prop) == -1) sorted.push(prop);\r\n\t}\r\n\tfor(var prop in objframe.children){\r\n\t\tif(sorted.indexOf(prop) == -1) sorted.push(prop);\t\t\r\n\t}\r\n\treturn sorted;\r\n}\r\n\r\n\r\nObjectRenderer.prototype.redraw = function(){\r\n\tthis.viewer.clear();\r\n\tthis.render(this.viewer);\r\n}\r\n\r\nObjectRenderer.prototype.extractLDO = function(extracts){\r\n\textracts[\"rdf:type\"] = this.objframe.cls;\r\n\tvar full = {};\r\n\tfull[this.subject()] = extracts;\r\n\treturn full;\t\r\n}\r\n\r\nObjectRenderer.prototype.extractJSONLD = function(extracts){\r\n\textracts[\"@type\"] = this.objframe.cls;\r\n\tif(this.subject() != \"_:\")\textracts[\"@id\"] = this.subject();\r\n\tif(this.objframe.jsonld_context) extracts['@context'] = this.objframe.jsonld_context;\r\n\treturn extracts;\r\n}\r\n\r\nObjectRenderer.prototype.extract = function(){\r\n\tvar extracts = {};\r\n\tfor(var i in this.properties){\r\n\t\tvar extracted = this.properties[i].extract();\r\n\t\tif(!TerminusClient.FrameHelper.empty(extracted)){\r\n\t\t\textracts[i] = extracted;\r\n\t\t}\r\n\t}\r\n\tif(TerminusClient.FrameHelper.empty(extracts) && this.parent){\r\n\t\treturn false;\r\n\t}\r\n\telse {\r\n\t\tvar ext = this.extractJSONLD(extracts);\r\n\t\treturn ext;\r\n\t\t//return this.extractLDO(extracts);\r\n\t}\r\n}\r\n\r\nmodule.exports=ObjectRenderer\r\n\r\n","const HTMLPropertyViewer = require('./PropertyViewer');\r\nconst RenderingMap = require('./RenderingMap');\r\nconst HTMLDataViewer = require('./DataViewer');\r\nconst HTMLStringViewer = require('./viewers/String');\r\n\r\n\r\nfunction ValueRenderer(dataframe, index, parent, options){\r\n\tthis.frame = dataframe;\r\n\tthis.index = index;\r\n\tthis.parent = parent;\r\n\tthis.options = this.setOptions(options);\r\n\tthis.originalValue = this.value();\r\n}\r\n\r\nValueRenderer.prototype.depth = function(){return (this.parent ? this.parent.depth() : false);};\r\nValueRenderer.prototype.property = function(){ return (this.parent ? this.parent.property() : false);};\r\nValueRenderer.prototype.subject = function(){ return (this.parent ? this.parent.subject() : false);};\r\nValueRenderer.prototype.subjectClass = function(){ return (this.parent ? this.parent.subjectClass() : false);};\r\nValueRenderer.prototype.type = function(){\treturn (this.frame ? this.frame.range : false);};\r\nValueRenderer.prototype.range = function(){\treturn (this.frame ? this.frame.range : false);};\r\nValueRenderer.prototype.value = function(){\treturn (this.frame ? this.frame.get() : false);};\r\nValueRenderer.prototype.isDocument = function(){\treturn (this.frame ? this.frame.isDocument() : false);};\r\nValueRenderer.prototype.currentViewer = function(){\treturn this.viewerType;}\r\n\r\nValueRenderer.prototype.copy = function(nf){\r\n\tvar nvr = new ValueRenderer(nf, false, this.parent, this.options);\r\n\tnvr.mode = this.mode;\r\n\tnvr.view = this.view;\r\n\treturn nvr;\r\n}\r\n\r\nValueRenderer.prototype.setFacet = function(facet){\r\n\tthis.facet = facet;\r\n\tthis.parent.redraw();\r\n}\r\n\r\nValueRenderer.prototype.parentFacetChange = function(pfacet){\r\n\tif(pfacet == \"page\") this.setFacet(\"page\");\r\n\tif(pfacet == \"multiline\") this.setFacet(\"line\");\r\n\tif(pfacet == \"line\") this.setFacet(\"inline\");\r\n\tif(pfacet == \"summary\") this.setFacet(\"icon\");\r\n}\r\n\r\nValueRenderer.prototype.getDefaultFacet = function(){\r\n\tif(this.parent.currentFacet() == \"page\" || this.parent.currentFacet() == \"multiline\"){\r\n\t\treturn \"line\";\r\n\t}\r\n\treturn \"inline\";\r\n}\r\n\r\nValueRenderer.prototype.getAvailableFacets = function(){\r\n\treturn Object.values(this.facets);\r\n}\r\n\r\nValueRenderer.prototype.getDefaultFacets = function(){\r\n\tvar defs = {\r\n\t\tpage: {\r\n\t\t\tlabel: \"Full Page\", value: \"page\",\r\n\t\t\tfeatures: [\"facet\", \"type\", \"cardinality\", \"body\", \"status\", \"facet\", \"viewer\", \"control\"],\r\n\t\t\tcontrols: [\"delete\", \"clone\", \"add\", \"reset\", \"cancel\", \"update\", \"mode\", \"show\", \"hide\"]\r\n\t\t},\r\n\t\tline: {\r\n\t\t\tlabel: \"Single Line\", value: \"line\",\r\n\t\t\tfeatures: [\"facet\", \"type\", \"cardinality\", \"body\", \"status\", \"facet\", \"viewer\", \"control\"],\r\n\t\t\tcontrols: [\"delete\", \"clone\", \"add\", \"reset\", \"cancel\", \"update\", \"mode\", \"show\", \"hide\"]\r\n\t\t},\r\n\t\tinline: {\r\n\t\t\tlabel: \"Inline\", value: \"inline\",\r\n\t\t\tfeatures: [\"facet\", \"type\", \"cardinality\", \"body\", \"status\", \"facet\", \"viewer\", \"control\"],\r\n\t\t\tcontrols: [\"delete\", \"clone\", \"add\", \"reset\", \"cancel\", \"update\", \"mode\", \"show\", \"hide\"]\r\n\t\t},\r\n\t\tlabel: {\r\n\t\t\tlabel: \"Label\", value: \"label\",\r\n\t\t\tfeatures: [\"facet\", \"status\", \"body\"],\r\n\t\t\tcontrols: []\r\n\t\t},\r\n\t\ticon: {\r\n\t\t\tlabel: \"Snippet\", value: \"icon\",\r\n\t\t\tfeatures: [\"facet\", \"summary\"],\r\n\t\t\tcontrols: []\r\n\t\t}\r\n\t}\r\n\treturn defs;\r\n}\r\n\r\nValueRenderer.prototype.currentFacet = function(){\r\n\treturn this.facet;\r\n}\r\n\r\nValueRenderer.prototype.setOptions = function(options){\r\n\treturn RenderingMap.decorateRenderer(options, this);\r\n}\r\n\r\nValueRenderer.prototype.hideDisabledControls = function(){\r\n\treturn this.hide_disabled_controls;\r\n}\r\n\r\nValueRenderer.prototype.setMode = function(mode){\r\n\tthis.mode = mode;\r\n\tthis.options.mode = mode;\r\n\tthis.viewerType = false;\r\n\tthis.redraw();\r\n}\r\n\r\nValueRenderer.prototype.setView = function(view){\r\n\tthis.view = view;\r\n\tthis.options.view = view;\r\n\tthis.redraw();\r\n}\r\n\r\nValueRenderer.prototype.getAPIURL = function(a, b){\r\n\tif(this.parent && this.parent.parent){\r\n\t\tif(client = this.parent.parent.getClient()){\r\n\t\t\tvar apiurl = client.dbURL() + a + \"/\" + b;\r\n\t\t\treturn apiurl;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nValueRenderer.prototype.getClient = function(){\r\n\tif(this.parent && this.parent.parent){\r\n\t\treturn this.parent.parent.getClient();\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nValueRenderer.prototype.getController = function(){\r\n\tif(this.parent && this.parent.parent){\r\n\t\treturn this.parent.parent.getController();\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nValueRenderer.prototype.DBURL = function(){\r\n\tif(this.parent && this.parent.parent){\r\n\t\tif(client = this.parent.parent.getClient()){\r\n\t\t\treturn client.dbURL();\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nValueRenderer.prototype.getEntityReference = function(url, cls, entities, opts){\r\n\tif(this.parent && this.parent.parent){\r\n\t\tif(client = this.parent.parent.getClient()){\r\n\t\t\treturn client.getEntityReference(url, cls, entities, opts);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nValueRenderer.prototype.badData = function(bd){\r\n\talert(\"bad data \" + bd);\r\n}\r\n\r\nValueRenderer.prototype.setNew = function(){\r\n\tthis.new_value = true;\r\n}\r\n\r\nValueRenderer.prototype.isNew = function(){\r\n\tif(this.new_value){\r\n\t\treturn true;\r\n\t}\r\n\treturn this.parent.isNew();\r\n}\r\n\r\n\r\nValueRenderer.prototype.isUpdated = function(){\r\n\tif(this.frame.get() != this.originalValue){\r\n\t\treturn true;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nValueRenderer.prototype.getSummary = function(){\r\n\tvar ret = { status: \"ok\" };\r\n\tif(this.isNew()) ret.status = \"new\";\r\n\telse if(this.isUpdated()) ret.status = \"updated\";\r\n\tvar val = this.frame.get();\r\n\tif(val){\r\n\t\tif(val.length && val.length > this.text_summary_length){\r\n\t\t\tret.long = val.substring(0, this.text_summary_length) + \"...\" + \" (\" + val.length + \" characters)\";\r\n\t\t}\r\n\t\telse {\r\n\t\t\tret.long = val;\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tret.long = \"empty\";\r\n\t}\r\n\treturn ret;\r\n}\r\n\r\nValueRenderer.prototype.cardControlAllows = function(action){\r\n\tif(this.parent.cframe.hasRestriction()){\r\n\t\tvar rest = this.parent.cframe.restriction;\r\n\t\tvar currentnum = this.parent.values.length;\r\n\t\tif(action == \"add\" || action == \"clone\"){\r\n\t\t\tif(rest.max && currentnum >= rest.max){\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(action == \"delete\" && (rest.min && currentnum <= rest.min)){\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nValueRenderer.prototype.set = function(v){\r\n\tthis.frame.set(v);\r\n\tthis.viewer.redrawHeader();\r\n\tthis.parent.childUpdated();\r\n}\r\n\r\nValueRenderer.prototype.delete = function(){\r\n\tthis.parent.deletePropertyValue(this.value(), this.index);\r\n\tthis.parent.parent.redraw();\r\n}\r\n\r\nValueRenderer.prototype.load = function(link){\r\n\tthis.parent.load(link);\r\n}\r\n\r\nValueRenderer.prototype.hide = function(){\r\n\tthis.setView(\"hidden\");\r\n}\r\n\r\nValueRenderer.prototype.show = function(){\r\n\tthis.setView(\"full\");\r\n}\r\n\r\nValueRenderer.prototype.cancel = function(){\r\n\tthis.reset();\r\n\tthis.setMode(\"view\");\r\n}\r\n\r\nValueRenderer.prototype.save = function(){\r\n\tif(this.parent) {\r\n\t\tthis.parent.save();\r\n\t}\r\n}\r\n\r\nValueRenderer.prototype.reset = function(){\r\n\tthis.set(this.originalValue);\r\n\tthis.redraw();\r\n}\r\n\r\nValueRenderer.prototype.clone = function(){\r\n\tvar newb = this.parent.addPropertyValue(this.value());\r\n\tvar nrend = this.copy(newb);\r\n\tnrend.setNew();\r\n\tnrend.mode = \"edit\";\r\n\tnrend.index = this.parent.values.length;\r\n\tthis.parent.values.push(nrend);\r\n\tthis.parent.childUpdated();\r\n\tthis.parent.redraw();\r\n\tthis.parent.goToValue(this.parent.values.length-1);\r\n}\r\n\r\nValueRenderer.prototype.getViewerForValue = function(){\r\n\treturn new HTMLDataViewer.HTMLDataViewer(this);\r\n}\r\n\r\nValueRenderer.prototype.getFeaturesForFacet = function(facet){\r\n\treturn this.facets[facet].features.concat(this.facets[facet].controls);\r\n}\r\n\r\nValueRenderer.prototype.showFeature = function(which){\r\n\tif(this.features.indexOf(which) == -1 && this.controls.indexOf(which) == -1) {\r\n\t\treturn false;\r\n\t}\r\n\tvar cardcontrols = [\"delete\", \"clone\", \"add\"];\r\n\tif(cardcontrols.indexOf(which) != -1){\r\n\t\tif(!this.cardControlAllows(which)) return false;\r\n\t}\r\n\tvar updcontrols = [\"update\", \"reset\"];\r\n\tif(this.hideDisabledControls() && updcontrols.indexOf(which) != -1 ){\r\n\t\tif(!this.isUpdated()){\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\tif(which == 'hide' && this.view == \"hidden\") return false;\r\n\tif(which == 'show' && this.view != \"hidden\") return false;\r\n\tvar fets = this.getFeaturesForFacet(this.facet);\r\n\treturn (fets.indexOf(which) != -1);\r\n}\r\n\r\n\r\nValueRenderer.prototype.render = function(viewer){\r\n\tthis.viewer = (viewer ? viewer : this.getViewerForValue());\r\n\treturn this.viewer.render();\r\n}\r\n\r\nValueRenderer.prototype.extract = function(){\r\n\tvar val = this.value();\r\n\tif(val !== \"\" && val !== false && this.frame.isDatatypeProperty()){\r\n\t\tvar objlit = { \"@value\": this.value()}\r\n\r\n\t\t//var objlit = { data: this.value()}\r\n\t\tif(this.frame.isString()) objlit[\"@language\"] = this.frame.lang();\r\n\t\telse objlit[\"@type\"] = this.type();\r\n\t\treturn objlit;\r\n\t}\r\n\telse return val;\r\n}\r\n\r\nValueRenderer.prototype.getValueHeaderViewer = function(){\r\n\treturn new HTMLDataViewer.HTMLDataHeaderViewer();\r\n}\r\n\r\nValueRenderer.prototype.getDataValueViewer = function(){\r\n\tif(!this.viewerType) {\r\n\t\tthis.viewerType = this.getViewerForDataValue();\r\n\t}\r\n\treturn RenderingMap.getViewer(this.viewerType, this.viewerOptions);\r\n}\r\n\r\nValueRenderer.prototype.getAvailableViewers = function(){\r\n\tvar dt = this.frame.getTypeShorthand();\r\n\tif(!dt){\r\n\t\t//alert(\"here\");\r\n\t}\r\n\tvar ft = this.frame.ftype();\r\n\tif(this.mode == \"view\"){\r\n\t\treturn RenderingMap.getAvailableDataViewers(dt, ft);\r\n\t}\r\n\treturn RenderingMap.getAvailableDataEditors(dt, ft);\r\n}\r\n\r\nValueRenderer.prototype.setViewer = function(viewer){\r\n\tthis.viewerType = viewer;\r\n\tthis.redraw();\r\n}\r\n\r\nValueRenderer.prototype.getViewerForDataValue = function(){\r\n\tvar dt = this.frame.getTypeShorthand();\r\n\tvar ft = this.frame.ftype();\r\n\tif(this.mode == \"edit\"){\r\n\t\treturn RenderingMap.getEditorForDataFrame(dt, ft);\r\n\t}\r\n\treturn RenderingMap.getViewerForDataFrame(dt, ft);\r\n}\r\n\r\nValueRenderer.prototype.redraw = function(){\r\n\tthis.viewer.clear();\r\n\tthis.render(this.viewer);\r\n}\r\n\r\nmodule.exports=ValueRenderer\r\n","/**\r\n * Object for producing a HTML view of a given object in a frame\r\n */\r\nconst HTMLFrameHelper = require('./HTMLFrameHelper');\r\n//const FrameHelper = require('../FrameHelper');\r\nfunction HTMLObjectViewer(renderer){\r\n\tthis.renderer = renderer;\r\n\tthis.properties = [];\r\n\tthis.headerViewer = renderer.getObjectHeaderViewer();\r\n\t//this.featureViewers = {};\r\n}\r\n\r\n/**\r\n * Functions for rendering / re-rendering the object as header and body components\r\n */\r\nHTMLObjectViewer.prototype.render = function(){\r\n\tif(this.renderedDOM){\r\n\t\tvar renderedDOM = this.getObjectDOM();\r\n\t\tthis.renderedDOM.replaceWith(renderedDOM);\r\n\t\tthis.renderedDOM = renderedDOM;\r\n\t}\r\n\telse {\r\n\t\tthis.renderedDOM = this.getObjectDOM();\r\n\t}\r\n\tthis.renderedDOM.appendChild(this.getObjectIDMarker(this.renderer));\r\n\tif(this.headerViewer){\r\n\t\tthis.header = this.headerViewer.getAsDOM(this.renderer);\r\n\t\tif(this.header) this.renderedDOM.appendChild(this.header);\r\n\t}\r\n\tthis.body = this.getObjectBodyDOM();\r\n\tif(this.body) this.renderedDOM.appendChild(this.body);\r\n\treturn this.renderedDOM;\r\n}\r\n\r\nHTMLObjectViewer.prototype.getObjectDOM = function(){\r\n\tvar orientation = this.renderer.getContentOrientation();\r\n\tvar pcls = \"terminus-object-frame-\" + orientation;\r\n\tif(orientation == \"page\"){\r\n\t\tvar sp = document.createElement(\"div\");\r\n\t}\r\n\telse {\r\n\t\tvar sp = document.createElement(\"span\");\r\n\t}\r\n\tvar css = \"terminus-object-frame \" + pcls + (this.renderer.parent ? \"\" : \" terminus-root-frame\") + \" terminus-object-frame-\" + this.renderer.mode;\r\n\tsp.setAttribute(\"class\", css);\r\n\tsp.setAttribute(\"data-class\", this.renderer.subjectClass());\r\n\tsp.setAttribute(\"data-id\", this.renderer.subject());\r\n\treturn sp;\r\n}\r\n\r\nHTMLObjectViewer.prototype.getObjectBodyDOM = function(){\r\n\tvar orientation = this.renderer.getContentOrientation();\r\n\tvar pcls = \"terminus-object-properties-\" + orientation;\r\n\tif(orientation == \"page\"){\r\n\t\tvar vholder = document.createElement(\"div\");\r\n\t}\r\n\telse {\r\n\t\tvar vholder = document.createElement(\"span\");\r\n\t}\r\n    vholder.setAttribute('class', 'terminus-object-properties ' + pcls);\r\n    for(var prop in this.properties){\r\n\t\tif(this.properties[prop]) vholder.appendChild(this.properties[prop]);\r\n\t}\r\n\treturn vholder;\r\n}\r\n\r\nHTMLObjectViewer.prototype.getFeatureDOM = function(feature){\r\n\tif(this.hasFeatureViewer(feature)){\r\n\t\treturn this.featureViewer[feature](this.renderer, this);\r\n\t}\r\n}\r\n\r\nHTMLObjectViewer.prototype.redraw = function(){\r\n\tTerminusClient.FrameHelper.removeChildren(this.renderedDOM);\r\n\tthis.properties = [];\r\n\tthis.renderer.render(this);\r\n}\r\n\r\nHTMLObjectViewer.prototype.redrawHeader = function(){\r\n\tif(this.headerViewer && this.header) {\r\n\t\tvar nheader = this.headerViewer.getAsDOM(this.renderer);\r\n\t\tthis.header.replaceWith(nheader);\r\n\t\tthis.header = nheader;\r\n\t}\r\n}\r\n\r\nHTMLObjectViewer.prototype.redrawBody = function(){\r\n\tif(this.body){\r\n\t\tvar nbody = this.getObjectBodyDOM();\r\n\t\tthis.body.replaceWith(nbody);\r\n\t\tthis.body = nbody;\r\n\t}\r\n}\r\n\r\n/**\r\n * Adds a rendered version of a property to the internal properties array\r\n */\r\nHTMLObjectViewer.prototype.addRenderedProperty = function(prop, renderedprop){\r\n\tthis.properties[prop] = renderedprop;\r\n}\r\n\r\nHTMLObjectViewer.prototype.clear = function(){\r\n\tTerminusClient.FrameHelper.removeChildren(this.renderedDOM);\r\n\tthis.properties = {};\r\n}\r\n\r\n/**\r\n * Removes the object from the dom\r\n */\r\nHTMLObjectViewer.prototype.remove = function(){\r\n\tthis.renderedDOM.parentNode.removeChild(this.renderedDOM);\r\n}\r\n\r\nHTMLObjectViewer.prototype.goTo = function(subj, property){\r\n\tHTMLFrameHelper.goToName(subj, property);\r\n}\r\n\r\n/**\r\n * Generates a html anchor element to use as a marker to find the object on the page\r\n */\r\nHTMLObjectViewer.prototype.getObjectIDMarker = function(renderer){\r\n\tvar idm = document.createElement(\"a\");\r\n\tidm.setAttribute(\"class\", \"terminus-object-idmarker\");\r\n\tvar sh = TerminusClient.FrameHelper.getShorthand(renderer.subject());\r\n    if(!sh) sh = renderer.subject();\r\n    if(sh){\r\n\t\tvar bits = sh.split(\":\");\r\n\t\tif(bits.length > 1) sh = bits[1];\r\n\t\tidm.setAttribute(\"name\", sh);\r\n    }\r\n\treturn idm;\r\n}\r\n\r\nfunction HTMLObjectHeaderViewer(){}\r\n\r\nHTMLObjectHeaderViewer.prototype.getAsDOM = function(renderer){\r\n\tvar orientation = renderer.getContentOrientation();\r\n\tvar pcls = \"terminus-object-frame-btn terminus-object-header-\" + orientation;\r\n\tif(orientation == \"page\"){\r\n\t\tvar objDOM = document.createElement(\"div\");\r\n\t}\r\n\telse {\r\n\t\tvar objDOM = document.createElement(\"span\");\r\n\t}\r\n\tobjDOM.setAttribute(\"class\", \"terminus-object-header \" + pcls);\r\n\tif(renderer.showFeature(\"facet\")){\r\n\t\tvar facetDOM = this.getObjectFacetDOM(renderer);\r\n\t\tif(facetDOM) objDOM.appendChild(facetDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"label\")){\r\n\t\tvar sumDOM = this.getObjectLabelDOM(renderer);\r\n\t\tif(sumDOM) objDOM.appendChild(sumDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"id\")){\r\n\t\tvar idDOM = this.getObjectIDDOM(renderer);\r\n\t\tif(idDOM) objDOM.appendChild(idDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"type\")){\r\n\t\tvar typeDOM = this.getObjectTypeDOM(renderer);\r\n\t\tif(typeDOM) objDOM.appendChild(typeDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"status\")){\r\n\t\tvar sumDOM = this.getObjectStatusDOM(renderer);\r\n\t\tif(sumDOM) objDOM.appendChild(sumDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"view\")){\r\n\t\tvar viewDOM = this.getViewPropertyDOM(renderer);\r\n\t\tif(viewDOM) objDOM.appendChild(viewDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"viewer\")){\r\n\t\tvar hideDOM = this.getViewerSelectorDOM(renderer);\r\n\t\tif(hideDOM) objDOM.appendChild(hideDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"add\")){\r\n\t\tvar addDOM = this.getAddPropertyDOM(renderer);\r\n\t\tif(addDOM) objDOM.appendChild(addDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"control\")){\r\n\t\tvar controlsDOM = this.getObjectControlsDOM(renderer);\r\n\t\tif(controlsDOM) objDOM.appendChild(controlsDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"summary\")){\r\n\t\tvar controlsDOM = this.getObjectSummaryDOM(renderer);\r\n\t\tif(controlsDOM) objDOM.appendChild(controlsDOM);\r\n\t}\r\n\t/*objDOM.addEventListener('click', function(){\r\n\t\tif((this.nextSibling.style.display == 'block') || (this.nextSibling.style.display == ''))\r\n\t\t\tthis.nextSibling.style.display = 'none';\r\n\t\telse this.nextSibling.style.display = 'block';\r\n\t});*/\r\n\treturn objDOM;\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectSummaryDOM = function(renderer){\r\n\tvar sum = renderer.getSummary();\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"object-summary\", false, sum.long, sum.status);\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectControlsDOM = function(renderer){\r\n\tvar controlsDOM = document.createElement(\"span\");\r\n\tcontrolsDOM.setAttribute(\"class\", \"terminus-object-controls\");\r\n\tif(renderer.showFeature(\"mode\")){\r\n\t\tvar viewsDOM = HTMLFrameHelper.getModeSelectorDOM(\"object\", renderer);\r\n\t\tif(viewsDOM) controlsDOM.appendChild(viewsDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"delete\")){\r\n\t\tvar dpropDOM = this.getObjectDeleteDOM(renderer);\r\n\t\tif(dpropDOM) controlsDOM.appendChild(dpropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"clone\")){\r\n\t\tvar cpropDOM = this.getObjectCloneDOM(renderer);\r\n\t\tif(cpropDOM) controlsDOM.appendChild(cpropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"reset\")){\r\n\t\tvar rpropDOM = this.getObjectResetDOM(renderer);\r\n\t\tif(rpropDOM) controlsDOM.appendChild(rpropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"update\")){\r\n\t\tvar upropDOM = this.getObjectUpdateDOM(renderer);\r\n\t\tif(upropDOM) controlsDOM.appendChild(upropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"show\")){\r\n\t\tvar showDOM = this.getObjectShowDOM(renderer);\r\n\t\tif(showDOM) controlsDOM.appendChild(showDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"hide\")){\r\n\t\tvar hideDOM = this.getObjectHideDOM(renderer);\r\n\t\tif(hideDOM) controlsDOM.appendChild(hideDOM);\r\n\t}\r\n\treturn controlsDOM;\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectFacetDOM = function(renderer){\r\n\tvar viewables = renderer.getAvailableFacets();\r\n\tvar self = this;\r\n\tif(viewables && viewables.length){\r\n\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-object-facet\");\r\n\t\tvar callback = function(val){\r\n\t\t\tif(val){\r\n\t\t\t\trenderer.setFacet(val);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"object-facet\", viewables, renderer.currentFacet(), callback);\r\n\t\tmpropDOM.appendChild(sel);\r\n\t\treturn mpropDOM;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectLabelDOM = function(renderer){\r\n\tvar lab = renderer.getLabel();\r\n\tif(lab){\r\n\t\treturn HTMLFrameHelper.getInfoboxDOM(\"object-label\", false, lab);\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectIDDOM = function(renderer){\r\n\tvar val = renderer.subject();\r\n\tvar input = false;\r\n\tif(renderer.mode == \"edit\" && renderer.isNewDocument()){\r\n\t\tif(renderer.idDOM) val = renderer.idDOM.value;\r\n\t\tinput = document.createElement(\"input\");\r\n\t\tinput.setAttribute(\"class\", \"terminus-object-id-input\");\r\n\t\tif(val == \"_:\") val = \"\";\r\n\t\trenderer.idDOM = input;\r\n\t}\r\n\telse {\r\n\t\tif(renderer.isNewDocument() && val == \"_:\") val = \"New Document\";\r\n\t}\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"object-id\", \"ID\", val, \"Every fragment of data is identified by a unique URL\", input);\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectTypeDOM = function(renderer){\r\n\tif(renderer.mode == \"edit\" && renderer.parent && renderer.parent.isClassChoice() && renderer.isNew()){\r\n\t\tvar cs = renderer.parent.getAvailableClassChoices();\r\n\t\tif(cs && cs.length){\r\n\t\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\t\tmpropDOM.setAttribute(\"class\", \"terminus-property-change-class\");\r\n\t\t\tvar mlabDOM = document.createElement(\"span\");\r\n\t\t\tmlabDOM.setAttribute(\"class\", \"terminus-property-change-label\");\r\n\t\t\tmlabDOM.appendChild(document.createTextNode(\"Type\"));\r\n\t\t\tmpropDOM.appendChild(mlabDOM);\r\n\t\t\tvar callback = function(cls){\r\n\t\t\t\tif(cls){\r\n\t\t\t\t\trenderer.changeClass(cls);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"change-class\", cs, renderer.subjectClass(), callback);\r\n\t\t\tmpropDOM.appendChild(sel);\r\n\t\t\treturn mpropDOM;\r\n\t\t}\r\n\t}\r\n\tvar cm = renderer.getClassMeta(renderer.subjectClass());\r\n\tvar lab = renderer.subjectClass();\r\n\tvar cmt = \"All objects have types, identified by a unique URL\";\r\n\tif(cm){\r\n\t\tlab = (cm.Label && cm.Label[\"@value\"] ? cm.Label[\"@value\"]: lab);\r\n\t\tcmt = (cm.Comment && cm.Comment[\"@value\"] ? renderer.subjectClass() + \" \" + cm.Comment[\"@value\"] : cmt);\r\n\t}\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"object-type\", \"Type\", lab, cmt);\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectStatusDOM = function(renderer){\r\n\tvar sum = renderer.getSummary();\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"status-\"+sum.status, false, sum.status, sum.status);\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getAddPropertyDOM = function(renderer){\r\n\tvar addables = renderer.getAddableProperties();\r\n\tif(addables && addables.length){\r\n\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-object-add-property\");\r\n\t\taddables.unshift({ value: \"\", label: \"Add New Property\"});\r\n\t\tvar callback = function(add){\r\n\t\t\tif(add){\r\n\t\t\t\trenderer.addNewProperty(add);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar disabled = (renderer.cardControlAllows(\"add\") ? false : \"Cardinality Rules Forbid Add\");\r\n\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"add-property\", addables, \"\", callback, disabled);\r\n\t\tmpropDOM.appendChild(sel);\r\n\t\treturn mpropDOM;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getViewPropertyDOM = function(renderer){\r\n\tvar viewables = renderer.getViewableProperties();\r\n\tvar self = this;\r\n\tif(viewables && viewables.length){\r\n\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-object-view-property\");\r\n\t\tviewables.unshift({ value: \"\", label: \"View Property\"});\r\n\t\tvar callback = function(add){\r\n\t\t\tif(add){\r\n\t\t\t\trenderer.goToProperty(add);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"view-property\", viewables, \"\", callback);\r\n\t\tmpropDOM.appendChild(sel);\r\n\t\treturn mpropDOM;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectDeleteDOM = function(renderer){\r\n\tvar callback = function(){renderer.delete()};\r\n\tvar disabled = (renderer.cardControlAllows(\"delete\") ? false : \"Cardinality Rules Forbid Delete\");\r\n\treturn HTMLFrameHelper.getActionControl(\"object\", \"delete\", \"Delete\", callback, disabled);\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectCloneDOM = function(renderer){\r\n\tvar callback = function(){renderer.clone()};\r\n\tvar disabled = (renderer.cardControlAllows(\"clone\") ? false : \"Cardinality Rules Forbid Clone\");\r\n\treturn HTMLFrameHelper.getActionControl(\"object\", \"clone\", \"Clone\", callback, disabled);\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectResetDOM = function(renderer){\r\n\tvar callback = function(){renderer.reset()};\r\n\tvar disabled = (renderer.isUpdated() ? false : \"Nothing to reset\");\r\n\treturn HTMLFrameHelper.getActionControl(\"object\", \"reset\", \"Reset\", callback, disabled);\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getViewerSelectorDOM = function(renderer){\r\n\tvar viewers = renderer.getAvailableViewers();\r\n\tif(viewers && viewers.length){\r\n\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-object-viewer\");\r\n\t\tvar callback = function(viewer){\r\n\t\t\tif(viewer){\r\n\t\t\t\trenderer.setViewer(viewer);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar selected = renderer.currentViewer();\r\n\t\tvar sel = HTMLFrameHelper.getSelectionControl('object-viewer', viewers, selected, callback);\r\n\t\tmpropDOM.appendChild(sel);\r\n\t\treturn mpropDOM;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectHideDOM = function(renderer){\r\n\tvar callback = function(){renderer.hide()};\r\n\treturn HTMLFrameHelper.getActionControl(\"object\", \"hide\", \"Hide\", callback);\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectShowDOM = function(renderer){\r\n\tvar callback = function(){renderer.show()};\r\n\treturn HTMLFrameHelper.getActionControl(\"object\", \"show\", \"Show\", callback);\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectUpdateDOM = function(renderer){\r\n\tvar dpropDOM = document.createElement(\"span\");\r\n\tdpropDOM.setAttribute(\"class\", \"terminus-object-update\");\r\n\tif(renderer.isNewDocument()){\r\n\t\tvar disabled = false;//(renderer.isUpdated() ? false : \"No changes\");\r\n\t}\r\n\telse {\r\n\t\tvar disabled = (renderer.isUpdated() ? false : \"No changes\");\r\n\t}\r\n\tvar saveback = function(){renderer.save()};\r\n\tdpropDOM.appendChild(HTMLFrameHelper.getActionControl(\"object\", \"save\", \"Save\", saveback, disabled));\r\n\treturn dpropDOM;\r\n}\r\n\r\nmodule.exports={HTMLObjectViewer,HTMLObjectHeaderViewer}\r\n","\r\n\r\nfunction HTMLStringEditor(options){\r\n\tthis.css = ((options && options.css) ? \"terminus-literal-value \" + options.css : \"terminus-literal-value\");\r\n\tthis.options = options; \r\n}\r\n\r\nHTMLStringEditor.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar ty = TerminusClient.FrameHelper.getShorthand(renderer.frame.range);\r\n\tvar value = renderer.value();\r\n\tvar big = ((this.options && typeof this.options.big != \"undefined\") ? this.options.big : this.isBigType(ty, value));\r\n\tif(big){\r\n\t\tvar input = document.createElement(\"textarea\");\r\n\t\tthis.css += \" terminus-literal-big-value\";\t\t\r\n\t}\r\n\telse {\r\n\t\tvar size = ((this.options && typeof this.options.size != \"undefined\") ? this.options.size : this.getTypeSize(ty, value));\r\n\t\tvar input = document.createElement(\"input\");\r\n\t\tinput.setAttribute('type', \"text\");\r\n\t\tinput.setAttribute('size', size);\r\n\t}\r\n\tinput.setAttribute('class', this.css);\r\n\tinput.value = value;\r\n\tvar self = this;\r\n\tinput.addEventListener(\"input\", function(){\r\n\t\trenderer.set(this.value);\r\n\t});\r\n\treturn input;\r\n}\r\n\r\nHTMLStringEditor.prototype.isBigType = function(ty, value){\r\n\tif(value && value.length && value.length > 100) return true;\r\n\tvar longs = [\"xdd:coordinatePolyline\", \"xdd:coordinatePolygon\", \"xsd:base64Binary\", \"xdd:html\", \"xdd:json\", \"rdf:XMLLiteral\"];\r\n\tif(longs.indexOf(ty) == -1) return false;\r\n\treturn true;\r\n}\r\n\r\nHTMLStringEditor.prototype.getTypeSize = function(ty, value){\r\n\tif(value && value.length && value.length > 40) return 80;\r\n\tvar bigs = [\"xdd:url\", \"xdd:coordinate\", \"xsd:anyURI\"];\r\n\tvar smalls = [\"xsd:gYearMonth\", \"xdd:gYearRange\", \"xsd:decimal\", \"xsd:float\", \"xsd:time\", \"xsd:date\", \r\n\t\t\"xsd:dateTimeStamp\",\"xsd:gYearMonth\", \"xsd:gMonthDay\", \"xsd:duration\", \"xsd:yearMonthDuration\", \"xsd:dayTimeDuration\", \r\n\t\t\"xsd:nonNegativeInteger\", \"xsd:positiveInteger\", \"xsd:negativeInteger\",\t\"xsd:nonPositiveInteger\", \"xsd:integer\",\"xsd:unsignedInt\"];\r\n\tvar tinys = [\"xsd:boolean\", \"xsd:gYear\", \"xsd:gMonth\", \"xsd:gDay\", \"xsd:byte\", \"xsd:short\", \"xsd:unsignedByte\", \"xsd:language\"];\r\n\tif(bigs.indexOf(ty) != -1) return 80;\r\n\tif(smalls.indexOf(ty) != -1) return 16;\r\n\tif(tinys.indexOf(ty) != -1) return 8;\r\n\treturn 32;\r\n}\r\n\r\nmodule.exports={HTMLStringEditor}\r\n\r\n\r\n","function HTMLBooleanViewer(options){\r\n\tthis.css = \"terminus-literal-value terminus-literal-value-range \" + ((options && options.css) ?  options.css : \"\");\r\n}\r\n\r\nHTMLBooleanViewer.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar value = renderer.value();\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', this.css);\r\n\tif(value){\r\n\t\tvar vallab = document.createTextNode(value);\r\n\t\tinput.appendChild(vallab);\r\n\t}\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={HTMLBooleanViewer}\r\n\r\n","function HTMLBooleanEditor(options){\r\n\tthis.css = \"terminus-literal-value terminus-literal-value-range \" + ((options && options.css) ?  options.css : \"\");\r\n}\r\n\r\nHTMLBooleanEditor.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar value = renderer.value();\r\n\tvar input = document.createElement(\"input\");\r\n\tinput.setAttribute('type', \"checkbox\");\r\n\tif(value){\r\n\t\tinput.setAttribute(\"checked\", \"checked\");\t\t\t\t\t\r\n\t}\r\n\tinput.addEventListener(\"change\", function(){\r\n\t\tif(value){\r\n\t\t\trenderer.set(\"\");\r\n\t\t}\r\n\t\telse {\r\n\t\t\trenderer.set(\"true\");\r\n\t\t}\r\n\t});\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={HTMLBooleanEditor}\r\n\r\n","function HTMLChoiceViewer(options){};\r\n\r\nHTMLChoiceViewer.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar value = renderer.value();\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', \"terminus-literal-value terminus-choice-value\");\r\n\tinput.setAttribute('data-value', value);\r\n\tif(value){\r\n\t\tvar els = renderer.frame.frame.elements;\r\n\t\tfor(var i = 0; i<els.length; i++){\r\n\t\t\tif(els[i].class == value){\r\n\t\t\t\tif(els[i].label && els[i].label[\"@value\"]){\r\n\t\t\t\t\tinput.appendChild(document.createTextNode(els[i].label[\"@value\"]));\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tinput.appendChild(FrameHelper.labelFromURL(value));\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t\tcontinue;\r\n\t\t\t}\t\t\t\t\r\n\t\t}\r\n\t}\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={HTMLChoiceViewer}\r\n\r\n\r\n","const HTMLFrameHelper = require('../HTMLFrameHelper');\r\nconst RenderingMap = require('../RenderingMap');\r\n\r\nfunction HTMLChoiceEditor(options){};\r\n\r\nHTMLChoiceEditor.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar value = renderer.value();\r\n\tvar optInput = document.createElement(\"select\");\r\n\toptInput.setAttribute('class', \"terminus-choice-picker\");\r\n\tvar foptions = renderer.frame.getChoiceOptions();\r\n\tfoptions.unshift({ value: \"\", label: \"Not Specified\"});\r\n\tvar callback = function(val){\r\n\t\trenderer.set(val);\r\n\t}\r\n\tvar sel = HTMLFrameHelper.getSelectionControl(\"select-choice\", foptions, value, callback);\r\n\treturn sel;\r\n}\r\n\r\nmodule.exports={HTMLChoiceEditor}\r\n\r\n","\r\nfunction HTMLCoordinateViewer(options){\r\n\tthis.inputs = [];\r\n}\r\n\r\nHTMLCoordinateViewer.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar ty = TerminusClient.FrameHelper.getShorthand(renderer.frame.range);\r\n\tvar value = renderer.value();\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', \"terminus-literal-value terminus-literal-coordinate\");\r\n\tinput.setAttribute('data-value', value);\r\n\ttry {\r\n\t\tvar parsed = (value ? JSON.parse(value) : false);\r\n\t}\r\n\tcatch(e){\r\n\t\trenderer.badData(ty + \" failed to parse as json\", e.toString());\r\n\t\tvar parsed = false;\r\n\t\tvalue = false;\r\n\t}\r\n\tif(value){\r\n\t\tif(ty == \"xdd:coordinate\"){\r\n\t\t\tparsed = [parsed];\r\n\t\t}\r\n\t\tfor(var i = 0; i < parsed.length; i++){\r\n\t\t\tvar lldom = document.createElement(\"span\");\r\n\t\t\tlldom.setAttribute(\"class\", \"latlong\");\r\n\t\t\tlldom.appendChild(document.createTextNode(\"Latitude: \"));\r\n\t\t\tlldom.appendChild(document.createTextNode(parsed[i][0] + \" °\" + \" \"));\r\n\t\t\tlldom.appendChild(document.createTextNode(\"Longitude: \"));\r\n\t\t\tlldom.appendChild(document.createTextNode(parsed[i][1] + \" °\" ));\r\n\t\t\tinput.appendChild(lldom);\r\n\t\t}\r\n\t}\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={HTMLCoordinateViewer}\r\n\r\n","function HTMLCoordinateEditor(options){\r\n\tthis.inputs = [];\r\n}\r\n\r\nHTMLCoordinateEditor.prototype.getInputDOMs = function(lat, long, change){\r\n\tvar latdom = document.createElement(\"input\");\r\n\tlatdom.setAttribute(\"type\", \"text\");\r\n\tlatdom.value = lat;\r\n\tvar longdom = document.createElement(\"input\");\r\n\tlongdom.setAttribute(\"type\", \"text\");\r\n\tlongdom.value = long;\r\n\tlatdom.addEventListener(\"change\", change);\r\n\tlongdom.addEventListener(\"change\", change);\r\n\treturn [latdom, longdom];\r\n}\r\n\r\nHTMLCoordinateEditor.prototype.getLatLongDOM = function(lat, long, ty, index, parent){\r\n\tvar lldom = document.createElement(\"span\");\r\n\tlldom.setAttribute(\"class\", \"terminus-lat-long\");\r\n\tvar firstcol = document.createElement(\"span\");\r\n\tfirstcol.setAttribute(\"class\", \"terminus-lat-long-col\");\r\n\tlldom.appendChild(firstcol);\r\n\tif(index > 2 || (ty == \"xdd:coordinatePolyline\" && index > 1)){\r\n\t\tvar delbut = document.createElement(\"button\");\r\n\t\tdelbut.setAttribute(\"class\", \"delete-coordinate\");\r\n\t\tdelbut.appendChild(document.createTextNode(\"Remove\"));\r\n\t\tdelbut.addEventListener(\"click\", function(){\r\n\t\t\tlong.value = \"\";\r\n\t\t\tlat.value = \"\";\r\n\t\t\tparent.removeChild(lldom);\r\n\t\t});\r\n\t\tfirstcol.appendChild(delbut);\r\n\t}\r\n\tlldom.appendChild(document.createTextNode(\"Latitude: \"));\r\n\tlldom.appendChild(lat);\r\n\tlldom.appendChild(document.createTextNode(\" °\" + \" \"));\r\n\tlldom.appendChild(document.createTextNode(\"  Longitude: \"));\r\n\tlldom.appendChild(long);\r\n\tlldom.appendChild(document.createTextNode(\" ° \" ));\r\n\treturn lldom;\r\n}\r\n\r\n\r\nHTMLCoordinateEditor.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar ty = TerminusClient.FrameHelper.getShorthand(renderer.frame.range);\r\n\tvar value = renderer.value();\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', \"terminus-literal-value terminus-literal-coordinate\");\r\n\tinput.setAttribute('data-value', value);\r\n\ttry {\r\n\t\tvar parsed = (value ? JSON.parse(value) : false);\r\n\t}\r\n\tcatch(e){\r\n\t\trenderer.badData(ty + \" failed to parse as json\", e.toString());\r\n\t\tvar parsed = false;\r\n\t\tvalue = false;\r\n\t}\r\n\tvar self = this;\r\n\tvar updateValueFromForm = function(){\r\n\t\tvar vals = [];\r\n\t\tfor(var i = 0; i<self.inputs.length; i++){\r\n\t\t\tif(self.inputs[i][0].value && self.inputs[i][1].value){\r\n\t\t\t\tvar val = \"[\" + self.inputs[i][0].value + \",\" + self.inputs[i][1].value + \"]\";\r\n\t\t\t\tvals.push(val);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(vals.length == 0){\r\n\t\t\trenderer.set(\"\");\r\n\t\t}\r\n\t\telse if(ty == \"xdd:coordinate\"){\r\n\t\t\trenderer.set(vals[0]);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tvar op = \"[\";\r\n\t\t\tfor(var i = 0; i<vals.length; i++){\r\n\t\t\t\top += vals[i];\r\n\t\t\t\tif(i+1 < vals.length) op += \",\";\r\n\t\t\t}\r\n\t\t\top += \"]\";\r\n\t\t\trenderer.set(op);\r\n\t\t}\r\n\t};\r\n\tif(!parsed){\r\n\t\tif(ty == \"xdd:coordinate\") parsed = [\"\",\"\"];\r\n\t\telse {\r\n\t\t\tparsed = [[\"\",\"\"],[\"\",\"\"]];\r\n\t\t\tif(ty == \"xdd:coordinatePolygon\") parsed.push([\"\",\"\"]);\r\n\t\t}\r\n\t}\r\n\tif(ty == \"xdd:coordinate\"){\r\n\t\tparsed = [parsed];\r\n\t}\r\n\tfor(var i = 0; i < parsed.length; i++){\r\n\t\tthis.inputs.push(this.getInputDOMs(parsed[i][0], parsed[i][1], updateValueFromForm))\r\n\t}\r\n\tvar lldoms = document.createElement(\"span\");\r\n\tfor(var i = 0; i < this.inputs.length; i++){\r\n\t\tvar lldom = this.getLatLongDOM(this.inputs[i][0], this.inputs[i][1], ty, i, lldoms);\r\n\t\tlldoms.appendChild(lldom);\r\n\t}\r\n\tinput.appendChild(lldoms);\r\n\tvar self = this;\r\n\tif(ty != \"xdd:coordinate\"){\r\n\t\tvar butspan = document.createElement(\"span\");\r\n\t\tbutspan.setAttribute(\"class\", \"terminus-add-coordinate\")\r\n\t\tvar addbut = document.createElement(\"button\");\r\n\t\taddbut.setAttribute(\"class\", \"terminus-add-coordinate\");\r\n\t\taddbut.appendChild(document.createTextNode(\"Add\"));\r\n\t\taddbut.addEventListener(\"click\", function(){\r\n\t\t\tvar ipdoms = self.getInputDOMs(\"\", \"\", updateValueFromForm);\r\n\t\t\tvar lldom = self.getLatLongDOM(ipdoms[0], ipdoms[1], ty, self.inputs.length, lldoms);\r\n\t\t\tlldoms.appendChild(lldom);\r\n\t\t\tself.inputs.push(ipdoms);\r\n\t\t});\r\n\t\tbutspan.appendChild(addbut);\r\n\t\tinput.appendChild(butspan);\t\t\t\r\n\t}\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={HTMLCoordinateEditor}","const DateHelper = require('./DateHelper');\r\n\r\nfunction HTMLDateViewer(options){\r\n\tthis.max = (options && options.max ? options.max : false);\r\n\tthis.min = (options && options.min ? options.min : false);\r\n\tthis.allowbce = (options && options.allowbce ? options.allowbce : false);\r\n\tthis.date_spacer = \"/\";\r\n\tthis.time_spacer = \":\";\r\n\tthis.datetime_separator = \", \";\r\n\tthis.helper = new DateHelper.HTMLDateHelper();\r\n}\r\n\r\nHTMLDateViewer.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar ty = TerminusClient.FrameHelper.getShorthand(renderer.frame.range);\r\n\tvar value = renderer.value();\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', \"terminus-literal-value terminus-literal-date\");\r\n\tinput.setAttribute('data-value', value);\r\n\tif(value){\r\n\t\tvar parsed = TerminusClient.FrameHelper.parseDate(ty, value);\r\n\t\tvar datepart = this.getDateComponentDOM(parsed);\r\n\t\tvar timepart = this.getTimeComponentDOM(parsed);\r\n\t\tif(timepart) input.appendChild(timepart);\r\n\t\tif(timepart && datepart) input.appendChild(document.createTextNode(this.datetime_separator));\r\n\t\tif(datepart) input.appendChild(datepart);\r\n\t}\r\n\treturn input;\r\n}\r\n\r\nHTMLDateViewer.prototype.getTimeComponentDOM = function(parsed, ty){\r\n\tvar hdom = (parsed.hour ? document.createElement(\"span\") : false);\r\n\tif(hdom){\r\n\t\thdom.setAttribute(\"class\", \"terminus-time-hour\");\r\n\t\thdom.appendChild(document.createTextNode(parsed.hour));\r\n\t}\r\n\tvar mdom = (typeof parsed.minute != \"undefined\" ? document.createElement(\"span\") : false);\r\n\tif(mdom){\r\n\t\tmdom.setAttribute(\"class\", \"terminus-time-minute\");\r\n\t\tvar mlab = (parsed.minute < 10 ? \"0\" + parsed.minute : parsed.minute);\r\n\t\tmdom.appendChild(document.createTextNode(mlab));\r\n\t}\r\n\tvar sdom = (typeof parsed.second != \"undefined\" ? document.createElement(\"span\") : false);\r\n\tif(sdom){\r\n\t\tsdom.setAttribute(\"class\", \"terminus-time-second\");\r\n\t\tvar slab = (parsed.second < 10 ? \"0\" + parsed.second : parsed.second);\r\n\t\tsdom.appendChild(document.createTextNode(slab));\r\n\t}\r\n\tvar tz = (parsed.timezone ? document.createElement(\"span\") : false);\r\n\tif(tz){\r\n\t\tsdom.setAttribute(\"class\", \"terminus-time-timezone\");\r\n\t\tsdom.appendChild(document.createTextNode(parsed.timezone));\r\n\t}\r\n\tif(hdom || mdom || sdom || tz){\r\n\t\tvar dadom = document.createElement(\"span\");\r\n\t\tdadom.setAttribute(\"class\", \"terminus-time-components time-\"+ty);\r\n\t\tif(hdom) dadom.appendChild(hdom); \r\n\t\tif(mdom) {\r\n\t\t\tif(hdom) dadom.appendChild(document.createTextNode(this.time_spacer));\r\n\t\t\tdadom.appendChild(mdom); \r\n\t\t}\r\n\t\tif(sdom) {\r\n\t\t\tif(mdom || hdom) dadom.appendChild(document.createTextNode(this.time_spacer));\r\n\t\t\tdadom.appendChild(sdom); \r\n\t\t}\r\n\t\tif(tz){\r\n\t\t\tdadom.appendChild(document.createTextNode(\" (Timezone: \")); \r\n\t\t\tdadom.appendChild(sdom); \r\n\t\t\tdadom.appendChild(document.createTextNode(\")\")); \t\t\t\r\n\t\t}\r\n\t\treturn dadom;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLDateViewer.prototype.getDateComponentDOM = function(parsed, ty){\r\n\tvar ydom = (parsed.year ? document.createElement(\"span\") : false);\r\n\tif(ydom){\r\n\t\tydom.setAttribute(\"class\", \"terminus-date-year\");\r\n\t\tydom.appendChild(document.createTextNode(parsed.year));\r\n\t}\r\n\tvar mdom = (parsed.month ? document.createElement(\"span\") : false);\r\n\tif(mdom){\r\n\t\tmdom.setAttribute(\"class\", \"terminus-date-month\");\r\n\t\tmdom.appendChild(document.createTextNode(this.helper.getMonthName(parsed.month)));\t\t\r\n\t}\r\n\tvar ddom = (parsed.day ? document.createElement(\"span\") : false );\r\n\tif(ddom){\r\n\t\tddom.setAttribute(\"class\", \"terminus-date-day\");\r\n\t\tddom.appendChild(document.createTextNode(parsed.day));\t\t\r\n\t}\r\n\tif(ydom || mdom || ddom){\r\n\t\tvar dadom = document.createElement(\"span\");\r\n\t\tif(ddom) dadom.appendChild(ddom); \r\n\t\tif(mdom) {\r\n\t\t\tif(ddom) dadom.appendChild(document.createTextNode(this.date_spacer));\r\n\t\t\tdadom.appendChild(mdom); \r\n\t\t}\r\n\t\tif(ydom) {\r\n\t\t\tif(mdom || ddom) dadom.appendChild(document.createTextNode(this.date_spacer));\r\n\t\t\tdadom.appendChild(ydom); \r\n\t\t}\r\n\t\treturn dadom;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nmodule.exports={HTMLDateViewer}","const DateHelper = require('./DateHelper');\r\n\r\nfunction HTMLDateEditor(options){\r\n\tthis.max = (options && options.max ? options.max : false);\r\n\tthis.min = (options && options.min ? options.min : false);\r\n\tthis.allowbce = (options && options.allowbce ? options.allowbce : false);\r\n\tthis.date_spacer = \"/\";\r\n\tthis.time_spacer = \":\";\r\n\tthis.datetime_separator = \", \";\r\n\tthis.helper = new DateHelper.HTMLDateHelper();\r\n}\r\n\r\nHTMLDateEditor.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar ty = TerminusClient.FrameHelper.getShorthand(renderer.frame.range);\r\n\tvar value = renderer.value();\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', \"terminus-literal-value terminus-literal-date\");\r\n\tinput.setAttribute('data-value', value);\r\n\tif(value){\r\n\t\tthis.parsed = TerminusClient.FrameHelper.parseDate(ty, value);\r\n\t}\r\n\telse this.parsed = {};\r\n\tvar datepart = this.getDateComponentDOM(this.parsed, ty, renderer);\r\n\tvar timepart = this.getTimeComponentDOM(this.parsed, ty, renderer);\r\n\tif(timepart) input.appendChild(timepart);\r\n\tif(timepart && datepart) input.appendChild(document.createTextNode(this.datetime_separator));\r\n\tif(datepart) input.appendChild(datepart);\r\n\treturn input;\r\n}\r\n\r\nHTMLDateEditor.prototype.set = function(part, val, renderer, ty){\r\n\tthis.parsed[part] = val;\r\n\tvar xsd = TerminusClient.FrameHelper.xsdFromParsed(this.parsed, ty);\r\n\tif(xsd){\r\n\t\trenderer.set(xsd);\r\n\t}\r\n}\r\n\r\nHTMLDateEditor.prototype.getTimeComponentDOM = function(parsed, ty, renderer){\r\n\t\r\n}\r\n\r\nHTMLDateEditor.prototype.getDateComponentDOM = function(parsed, ty, renderer){\r\n\tvar self = this;\r\n\tif([\"xsd:date\", \"xsd:dateTime\", \"xsd:gYear\", \"xsd:gYearMonth\", \"xsd:dateTimeStamp\"].indexOf(ty) != -1){\r\n\t\tvar ydom = document.createElement(\"input\");\r\n\t\tydom.setAttribute(\"class\", \"terminus-year-input terminus-year-\"+ty);\r\n\t\tydom.setAttribute(\"size\", 6);\r\n\t\tydom.setAttribute(\"placeholder\", \"YYYY\");\r\n\t\tydom.value = (parsed.year ? parsed.year : \"\");\r\n\t\tydom.addEventListener(\"input\", function(){\r\n\t\t\tself.set(\"year\", this.value, renderer, ty);\r\n\t\t})\r\n\t}\r\n\tif([\"xsd:date\", \"xsd:dateTime\", \"xsd:gYearMonth\", \"xsd:dateTimeStamp\", \"xsd:gMonth\", \"xsd:gMonthDay\"].indexOf(ty) != -1){\r\n\t\tvar mdom = document.createElement(\"select\");\r\n\t\tmdom.setAttribute(\"class\", \"terminus-month-input terminus-month-\"+ty);\r\n\t\tfor(var i = 0; i<this.helper.months.length; i++){\r\n\t\t\tvar opdom = document.createElement(\"option\");\r\n\t\t\topdom.value = i+1;\r\n\t\t\topdom.appendChild(document.createTextNode(this.helper.months[i]));\r\n\t\t\tif(parsed.month && parsed.month == i+1){\r\n\t\t\t\topdom.selected = true;\r\n\t\t\t}\r\n\t\t\tmdom.appendChild(opdom);\r\n\t\t}\r\n\t\tmdom.addEventListener(\"change\", function(){\r\n\t\t\tself.set(\"month\", this.value, renderer, ty);\r\n\t\t})\r\n\t}\t\r\n\tif([\"xsd:date\", \"xsd:dateTime\", \"xsd:dateTimeStamp\", \"xsd:gMonth\", \"xsd:gDay\", \"xsd:gMonthDay\"].indexOf(ty) != -1){\r\n\t\tvar ddom = document.createElement(\"input\");\r\n\t\tddom.setAttribute(\"class\", \"terminus-day-input terminus-day-\"+ty);\r\n\t\tddom.setAttribute(\"size\", 2);\r\n\t\tddom.setAttribute(\"placeholder\", \"DD\");\r\n\t\tddom.value = (parsed.day ? parsed.day : \"\");\t\r\n\t\tddom.addEventListener(\"input\", function(){\r\n\t\t\tself.set(\"day\", this.value, renderer, ty);\r\n\t\t})\r\n\t}\t\r\n\tif(ydom || mdom || ddom){\r\n\t\tvar dadom = document.createElement(\"span\");\r\n\t\tif(ddom) dadom.appendChild(ddom); \r\n\t\tif(mdom) {\r\n\t\t\tif(ddom) dadom.appendChild(document.createTextNode(this.date_spacer));\r\n\t\t\tdadom.appendChild(mdom); \r\n\t\t}\r\n\t\tif(ydom) {\r\n\t\t\tif(mdom || ddom) dadom.appendChild(document.createTextNode(this.date_spacer));\r\n\t\t\tdadom.appendChild(ydom); \r\n\t\t}\r\n\t\treturn dadom;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nmodule.exports={HTMLDateEditor}","function HTMLEntityViewer(options){}\r\nHTMLEntityViewer.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar value = renderer.value();\r\n\tvar value = TerminusClient.FrameHelper.unshorten(value);\r\n\tvar holder = document.createElement(\"span\");\r\n\tholder.setAttribute(\"class\", \"terminus-literal-value terminus-entity-reference-value\");\r\n\tvar self = this;\r\n\tif(this.holder){\r\n\t\treturn this.holder;\r\n\t}\r\n\tif(value){\r\n\t\tvar dom = this.getEntityViewHTML(value, renderer, dataviewer);\t\t\r\n\t\tholder.appendChild(dom);\r\n\t}\r\n\treturn holder;\r\n}\r\n\r\nHTMLEntityViewer.prototype.getEntityViewHTML = function(value, renderer, dataviewer){\r\n\tvar span = document.createElement(\"span\");\r\n\tvar self = this;\r\n\tspan.setAttribute(\"class\", \"terminus-internal-link\");\r\n\tspan.appendChild(dataviewer.internalLink(value));\r\n\tif(controller = renderer.getController()){\r\n\t\tcontroller.getInstanceMeta(value).then(function(response){\r\n\t\t\tvar lab = self.getEntityLabel(value, response, dataviewer);\r\n\t\t\tif(lab){ \r\n\t\t\t\tTerminusClient.FrameHelper.removeChildren(span);\r\n\t\t\t\tspan.appendChild(lab);\r\n\t\t\t}\t\r\n\t\t});\r\n\t}\r\n\treturn span;\r\n}\r\n\r\nHTMLEntityViewer.prototype.getEntityLabel = function(url, response, dv){\r\n\tvar nspan = document.createElement(\"span\");\r\n\tif(response && typeof response.InstanceLabel == \"object\" && response.InstanceLabel[\"@value\"]){\r\n\t\tnspan.appendChild(dv.internalLink(url, response.InstanceLabel[\"@value\"]));\r\n\t\tvar tit = url + \" Type: \" + response.InstanceType;\r\n\t\tif(typeof response.InstanceComment == \"object\" && response.InstanceComment[\"@value\"]){\r\n\t\t\ttit += \" \" + response.InstanceComment[\"@value\"];\r\n\t\t}\r\n\t\tnspan.setAttribute(\"title\", tit);\r\n\t\treturn nspan;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nmodule.exports={HTMLEntityViewer}","function HTMLEntityEditor(options){}\r\nHTMLEntityEditor.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar value = renderer.value();\r\n\tvar input = document.createElement(\"input\");\r\n\tinput.setAttribute(\"class\", \"terminus-literal-value terminus-entity-reference-value\");\r\n\tinput.setAttribute(\"type\", \"text\");\r\n\tinput.setAttribute('size', 80);\r\n\tinput.value = value;\r\n\tvar self = this;\r\n\tinput.addEventListener(\"change\", function(){\r\n\t\tvar url = this.value;\r\n\t\tif(url.indexOf(\"/\") == -1 && url.indexOf(\":\") == -1){\r\n\t\t\turl = \"doc:\" + url;\r\n\t\t}\r\n\t\trenderer.set(url);\r\n\t});\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={HTMLEntityEditor}","function HTMLImageViewer(options){}\r\nHTMLImageViewer.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar value = renderer.value();\r\n\tvar ty = TerminusClient.FrameHelper.getShorthand(renderer.frame.range);\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', \"terminus-literal-value terminus-literal-image-value\");\r\n\tinput.setAttribute('data-value', value);\r\n\tif(value){\r\n\t\tvar img = document.createElement(\"a\");\r\n\t\timg.setAttribute('src', value);\r\n\t\tinput.appendChild(img);\r\n\t}\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={HTMLImageViewer}\r\n\r\n\r\n","\r\n\r\nfunction HTMLImageEditor(options){}\r\nHTMLImageEditor.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar value = renderer.value();\r\n\tvar ty = TerminusClient.FrameHelper.getShorthand(renderer.frame.range);\r\n\tif(ty == \"xsd:base64Binary\"){\r\n\t\tvar input = document.createElement(\"textarea\");\r\n\t\tinput.setAttribute('class', \"terminus-literal-value terminus-literal-b64image-value\");\r\n\t\tinput.value = value;\r\n\t\tinput.addEventListener(\"change\", function(){\r\n\t\t\trenderer.set(this.value);\r\n\t\t});\r\n\t\treturn input;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nmodule.exports={HTMLImageEditor}","function HTMLLinkViewer(options){\r\n\tthis.css = \"terminus-literal-value terminus-literal-value-range \" + ((options && options.css) ?  options.css : \"\");\r\n}\r\n\r\nHTMLLinkViewer.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar value = renderer.value();\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', this.css);\r\n\tinput.setAttribute('size', 80);\r\n\tinput.setAttribute('data-value', value);\r\n\tif(value){\r\n\t\tvar a = document.createElement(\"a\");\r\n\t\ta.setAttribute('href', value);\r\n\t\ta.appendChild(document.createTextNode(value));\r\n\t\tinput.appendChild(a);\r\n\t}\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={HTMLLinkViewer}\r\n\r\n","function HTMLNumberViewer(options){\r\n\tthis.commas = (options && options.commas ? options.commas : true);\r\n}\r\n\r\nHTMLNumberViewer.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar value = renderer.value();\r\n\tif(value === 0) value = \"0\";\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', 'terminus-number-value terminus-literal-value');\r\n\tinput.setAttribute('data-value', value);\r\n\tvalue = (this.commas ? TerminusClient.FrameHelper.numberWithCommas(value) : value);\r\n\tinput.appendChild(document.createTextNode(value));\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={HTMLNumberViewer}\r\n","function HTMLRangeViewer(options){\r\n\tthis.commas = (options && options.commas ? options.commas : true);\r\n\tthis.css = \"terminus-literal-value terminus-literal-value-range \" + ((options && options.css) ?  options.css : \"\");\r\n\tthis.delimiter = (options && options.delimiter ? options.delimiter : false);\r\n}\r\n\r\nHTMLRangeViewer.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar value = renderer.value();\r\n\tvar vals = TerminusClient.FrameHelper.parseRangeValue(value, this.delimiter);\r\n\tvar d = document.createElement(\"span\");\r\n\td.setAttribute(\"class\", this.css);\r\n\tvar rvals = document.createElement(\"span\");\r\n\trvals.setAttribute(\"class\", \"terminus-range-value-left\");\r\n\tvar svals = document.createElement(\"span\");\r\n\tsvals.setAttribute(\"class\", \"terminus-range-value-right\");\r\n\tvar x = (this.commas ? TerminusClient.FrameHelper.numberWithCommas(vals[0]) : vals[0]);\r\n\tvar tnode = document.createTextNode(x);\r\n\trvals.appendChild(tnode);\r\n\td.appendChild(rvals);\t\r\n\tif(vals.length == 2){\r\n\t\td.appendChild(getRangeSymbolDOM());\r\n\t\tvar x2 = (this.commas ? TerminusClient.FrameHelper.numberWithCommas(vals[1]) : vals[1]);\r\n\t\tvar t2node = document.createTextNode(x2);\r\n\t\tsvals.appendChild(t2node);\r\n\t\td.appendChild(svals);\t\r\n\t}\r\n\treturn d;\r\n}\r\n\r\nfunction getRangeSymbolDOM(){\r\n\tvar d = document.createElement(\"span\");\r\n\td.setAttribute(\"class\", \"terminus-range-indicator\");\r\n\td.setAttribute(\"title\", \"The value is uncertain, it lies somewhere in this range\");\r\n\td.appendChild(document.createTextNode(\" ... \"));\r\n\treturn d;\r\n}\r\n\r\nmodule.exports={HTMLRangeViewer}\r\n","function HTMLRangeEditor(options){\r\n\tthis.commas = (options && options.commas ? options.commas : true);\r\n\tthis.css = \"terminus-literal-value terminus-literal-value-range \" + ((options && options.css) ?  options.css : \"\");\r\n\tthis.delimiter = (options && options.delimiter ? options.delimiter : false);\r\n}\r\n\r\nHTMLRangeEditor.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar value = renderer.value();\r\n\tvar vals = TerminusClient.FrameHelper.parseRangeValue(value, this.delimiter);\r\n\tvar d = document.createElement(\"span\");\r\n\td.setAttribute(\"class\", this.css);\r\n\tvar rvals = document.createElement(\"span\");\r\n\tvar svals = document.createElement(\"span\");\r\n\tvar data1 = (vals.length > 0 ? vals[0] : \"\");\r\n\tvar data2 = (vals.length > 1 ? vals[1] : \"\");\r\n\tvar firstip = document.createElement(\"input\");\r\n\tfirstip.setAttribute('type', \"text\");\r\n\tfirstip.setAttribute('size', 16);\r\n\tif(data1){\r\n\t\tfirstip.value = data1;\r\n\t}\r\n\tvar secondip = document.createElement(\"input\");\r\n\tsecondip.setAttribute('type', \"text\");\r\n\tsecondip.setAttribute('size', 16);\r\n\tif(data2){\r\n\t\tthis.showing_range = true;\r\n\t\tsecondip.value = data2;\r\n\t}\r\n\trvals.appendChild(firstip);\r\n\td.appendChild(rvals);\t\r\n\tif(this.showing_range){\r\n\t\tsvals.appendChild(getRangeSymbolDOM());\r\n\t\tsvals.appendChild(secondip);\r\n\t}\r\n\td.appendChild(svals);\t\r\n\tvar but = document.createElement(\"button\");\r\n\tbut.setAttribute(\"class\", \"terminus-change-range\");\r\n\tvar txt = this.showing_range ? \"Change to Simple Value\" : \"Change to Uncertain Range\";\r\n\tbut.appendChild(document.createTextNode(txt));\r\n\td.appendChild(but);\t\r\n\tvar self = this;\r\n\tbut.addEventListener(\"click\", function(){\r\n\t\tif(self.showing_range){\r\n\t\t\tself.showing_range = false;\r\n\t\t\tsecondip.value = \"\";\t\t\t\t\r\n\t\t\tTerminusClient.FrameHelper.removeChildren(svals);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tself.showing_range = true;\r\n\t\t\tsecondip.value = \"\";\t\t\t\t\r\n\t\t\tsvals.appendChild(getRangeSymbolDOM());\r\n\t\t\tsvals.appendChild(secondip);\r\n\t\t}\r\n\t\tvar txt = self.showing_range ? \"Change to Simple Value\" : \"Change to Uncertain Range\";\r\n\t\tbut.innerText = txt;\r\n\t\tchangeHandler();\r\n\t});\r\n\tvar changeHandler = function(){\r\n\t\tif(self.showing_range && secondip.value){\r\n\t\t\tif(firstip.value) renderer.set(\"[\" + firstip.value + \",\" + secondip.value + \"]\");\t\t\t\t\r\n\t\t\telse renderer.set(secondip.value);\t\t\t\t\r\n\t\t}\r\n\t\telse {\r\n\t\t\trenderer.set(firstip.value);\r\n\t\t}\r\n\t}\r\n\tfirstip.addEventListener(\"change\", changeHandler);\r\n\tsecondip.addEventListener(\"change\", changeHandler);\r\n\treturn d;\r\n}\r\n\r\nfunction getRangeSymbolDOM(){\r\n\tvar d = document.createElement(\"span\");\r\n\td.setAttribute(\"class\", \"terminus-range-indicator\");\r\n\td.setAttribute(\"title\", \"The value is uncertain, it lies somewhere in this range\");\r\n\td.appendChild(document.createTextNode(\" ... \"));\r\n\treturn d;\r\n}\r\n\r\nmodule.exports={HTMLRangeEditor}\r\n","function SantizedHTMLViewer(options){\r\n\tthis.css = ((options && options.css) ? \"literal-value \" + options.css : \"literal-value\");\r\n}\r\n\r\nSantizedHTMLViewer.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar val = renderer.value();\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', this.css);\r\n\tinput.setAttribute('data-value', val);\r\n\tinput.innerHTML = val;\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={SantizedHTMLViewer}\r\n","/**\r\n * Draws the property as header and body components\r\n */\r\nconst HTMLFrameHelper = require('./HTMLFrameHelper');\r\nconst HTMLStringViewer = require('./viewers/String');\r\n\r\nfunction HTMLDataViewer(renderer){\r\n\tthis.renderer = renderer;\r\n\tthis.headerViewer = renderer.getValueHeaderViewer();\r\n}\r\n\r\nHTMLDataViewer.prototype.render = function(){\r\n\tif(this.valDOM){\r\n\t\tvar nvalDOM = this.getValueDOM();\r\n\t\tthis.valDOM.replaceWith(nvalDOM);\r\n\t\tthis.valDOM = nvalDOM;\r\n\t}\r\n\telse {\r\n\t\tthis.valDOM = this.getValueDOM();\r\n\t}\r\n\tthis.valDOM.appendChild(this.getValueIDMarker(this.renderer));\r\n\tthis.body = this.getValueBodyDOM();\r\n\tif(this.body) this.valDOM.appendChild(this.body);\r\n\tif(this.headerViewer){\r\n\t\tthis.header = this.headerViewer.getAsDOM(this.renderer);\r\n\t\tif(this.renderer.facet == 'page'){ //expert mode\r\n\t\t\tif(this.header && this.expModeMenu) {\r\n\t\t\t\tthis.expModeMenu.appendChild(this.header);\r\n\t\t\t\t//this.valDOM.appendChild(this.expModeMenu);\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if(this.header) this.valDOM.appendChild(this.header);\r\n\t}\r\n\treturn this.valDOM;\r\n}\r\n\r\nHTMLDataViewer.prototype.getValueDOM = function(){\r\n\tif(this.renderer.currentFacet() == \"page\"){\r\n\t\tvar sp = document.createElement(\"div\");\r\n\t}\r\n\telse {\r\n\t\tvar sp = document.createElement(\"span\");\r\n\t}\r\n\tsp.setAttribute(\"class\", \"terminus-property-value property-value-\" + this.renderer.currentFacet() + \" property-value-\" + this.renderer.mode);\r\n\tif(this.renderer.mode == \"view\"){\r\n\t\tsp.setAttribute('data-value', this.renderer.value());\r\n\t}\r\n\treturn sp;\r\n}\r\n\r\nHTMLDataViewer.prototype.getValueBodyDOM = function(){\r\n\tif(this.renderer.currentFacet() == \"page\"){\r\n\t\tvar vholder = document.createElement(\"div\");\r\n\t}\r\n\telse {\r\n\t\tvar vholder = document.createElement(\"span\");\r\n\t}\r\n    vholder.setAttribute('class', ' terminus-property-body property-value-body property-value-body-'+this.renderer.currentFacet() + ' terminus-property-body-align');\r\n\tvholder.setAttribute('style', 'display: flex;');\r\n\tif(this.renderer.showFeature(\"body\")){\r\n        var valueViewer = this.renderer.getDataValueViewer();\r\n    \tvar vdom = valueViewer.getDOM(this.renderer, this);\r\n    }\r\n    else if(this.renderer.showFeature(\"summary\")){\r\n\t\tvar vdom = this.getSummaryDOM();\r\n    }\r\n    else {\r\n    \treturn false;\r\n    }\r\n    if(vdom) vholder.appendChild(vdom);\r\n\tif(this.renderer.currentFacet() == \"page\"){\r\n\t\tvar sControl = HTMLFrameHelper.getSettingsControl('data');\r\n\t\tvar menu = document.createElement('div');\r\n\t\tmenu.setAttribute('class', 'terminus-hide terminus-popup');\r\n\t\tmenu.appendChild(document.createTextNode('Edit property value'));\r\n\t\tmenu.appendChild(document.createElement('BR'));\r\n\t\tsControl.appendChild(menu);\r\n\t\tsControl.addEventListener('click', function(e){\r\n\t\t\tvar target = e.target || e.srcElement,\r\n\t\t\ttext = target.textContent || target.innerText;\r\n\t\t\tif((target.nodeName == 'ICON') || (target.nodeName == 'BUTTON')){\r\n\t\t\t\tif(this.children[0].style.display == 'none') this.children[0].style.display = 'block';\r\n\t\t\t\telse this.children[0].style.display = 'none';\r\n\t\t\t}\r\n\t\t});\r\n\t\tthis.expModeMenu = menu;\r\n\t\tvholder.appendChild(sControl);\r\n\t}\r\n\treturn vholder;\r\n}\r\n\r\n/**\r\n * Removes the value from the dom\r\n */\r\nHTMLDataViewer.prototype.remove = function(){\r\n\tthis.valDOM.parentNode.removeChild(this.valDOM);\r\n}\r\n\r\nHTMLDataViewer.prototype.redrawHeader = function(){\r\n\tif(this.headerViewer && this.header) {\r\n\t\tvar nheader = this.headerViewer.getAsDOM(this.renderer);\r\n\t\tthis.header.replaceWith(nheader);\r\n\t\tthis.header = nheader;\r\n\t}\r\n}\r\n\r\nHTMLDataViewer.prototype.redrawBody = function(){\r\n\tif(this.body){\r\n\t\tvar nbody = this.getValueBodyDOM();\r\n\t\tthis.body.replaceWith(nbody);\r\n\t\tthis.body = nbody;\r\n\t}\r\n}\r\n\r\n/**\r\n * Generates a html anchor element to use as a marker to find the property on the page\r\n */\r\nHTMLDataViewer.prototype.getValueIDMarker = function(renderer){\r\n\tvar idm = document.createElement(\"a\");\r\n\tidm.setAttribute(\"class\", \"terminus-value-idmarker\");\r\n\tvar subj = TerminusClient.FrameHelper.getShorthand(renderer.subject());\r\n\tif(!subj ) subj = renderer.subject();\r\n\tvar bits = subj .split(\":\");\r\n\tif(bits.length > 1) subj = bits[1];\r\n\tvar prop = TerminusClient.FrameHelper.getShorthand(renderer.property());\r\n\tif(!prop ) prop = renderer.property();\r\n\tvar bits = prop.split(\":\");\r\n\tif(bits.length > 1) prop = bits[1];\r\n\tidm.setAttribute(\"name\", subj + \"_\" + prop + \"_\" + renderer.index);\r\n\treturn idm;\r\n}\r\n\r\nHTMLDataViewer.prototype.getSummaryDOM = function(){\r\n\tvar sum = this.renderer.getSummary();\r\n\treturn HTMLTerminusClient.FrameHelper.getInfoboxDOM(\"value-summary\", false, sum.long, sum.long);\r\n}\r\n\r\nHTMLDataViewer.prototype.internalLink = function(link, label){\r\n\tvar self = this;\r\n\r\n\tvar onclick = function(e){\r\n\t\te.preventDefault();\r\n\t\tself.renderer.load(link);\r\n\t}\r\n\tvar a = document.createElement(\"a\");\r\n\ta.onClick = onclick;\r\n\ta.href=\"\";\r\n\ta.addEventListener(\"click\", onclick);\r\n\tif(label){\r\n\t\ta.appendChild(document.createTextNode(label));\r\n\t}\r\n\telse {\r\n\t\tvar sh = TerminusClient.FrameHelper.getShorthand(link);\r\n\t\tif(sh){\r\n\t\t\ta.setAttribute(\"title\", link);\r\n\t\t\ta.appendChild(document.createTextNode(sh));\r\n\t\t}\r\n\t\telse {\r\n\t\t\ta.appendChild(document.createTextNode(link));\r\n\t\t}\r\n\t}\r\n\treturn a;\r\n}\r\n\r\nHTMLDataViewer.prototype.clear = function(){\r\n\tTerminusClient.FrameHelper.removeChildren(this.valDOM);\r\n}\r\n\r\n\r\nfunction HTMLDataHeaderViewer(){}\r\n\r\nHTMLDataHeaderViewer.prototype.getAsDOM = function(renderer){\r\n\tif(renderer.currentFacet() == \"page\"){\r\n\t\tvar objDOM = document.createElement(\"div\");\r\n\t}\r\n\telse {\r\n\t\tvar objDOM = document.createElement(\"span\");\r\n\t}\r\n\tobjDOM.setAttribute(\"class\", \"terminus-value-header terminus-value-header-\" + renderer.currentFacet());\r\n\tif(renderer.showFeature(\"facet\")){\r\n\t\tvar facetDOM = this.getValueFacetDOM(renderer);\r\n\t\tif(facetDOM) objDOM.appendChild(facetDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"viewer\")){\r\n\t\tvar hideDOM = this.getViewerSelectorDOM(renderer);\r\n\t\tif(hideDOM) objDOM.appendChild(hideDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"type\")){\r\n\t\tvar typeDOM = this.getValueTypeDOM(renderer);\r\n\t\tif(typeDOM) objDOM.appendChild(typeDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"status\")){\r\n\t\tvar sumDOM = this.getValueStatusDOM(renderer);\r\n\t\tif(sumDOM) objDOM.appendChild(sumDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"control\")){\r\n\t\tvar controlsDOM = this.getValueControlsDOM(renderer);\r\n\t\tif(controlsDOM) objDOM.appendChild(controlsDOM);\r\n\t}\r\n\treturn objDOM;\r\n}\r\n\r\nHTMLDataHeaderViewer.prototype.getValueFacetDOM = function(renderer){\r\n\tvar viewables = renderer.getAvailableFacets();\r\n\tvar self = this;\r\n\tif(viewables && viewables.length){\r\n\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-value-facet\");\r\n\t\tvar callback = function(val){\r\n\t\t\tif(val){\r\n\t\t\t\trenderer.setFacet(val);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"value-facet\", viewables, renderer.currentFacet(), callback);\r\n\t\tmpropDOM.appendChild(sel);\r\n\t\treturn mpropDOM;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\n\r\nHTMLDataHeaderViewer.prototype.getValueTypeDOM = function(renderer){\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"value-type\", \"Type\", renderer.type(), \"All data values have types, identified by a unique URL\");\r\n}\r\n\r\nHTMLDataHeaderViewer.prototype.getValueStatusDOM = function(renderer){\r\n\tvar sum = renderer.getSummary();\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"status-\"+sum.status, false, sum.status, sum.status);\r\n}\r\n\r\n\r\nHTMLDataHeaderViewer.prototype.getValueControlsDOM = function(renderer){\r\n\tvar controlsDOM = document.createElement(\"span\");\r\n\tcontrolsDOM.setAttribute(\"class\", \"terminus-value-controls\");\r\n\tif(renderer.showFeature(\"mode\")){\r\n\t\tvar viewsDOM = HTMLFrameHelper.getModeSelectorDOM(\"value\", renderer);\r\n\t\tif(viewsDOM) controlsDOM.appendChild(viewsDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"delete\")){\r\n\t\tvar dpropDOM = this.getValueDeleteDOM(renderer);\r\n\t\tif(dpropDOM) controlsDOM.appendChild(dpropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"clone\")){\r\n\t\tvar cpropDOM = this.getValueCloneDOM(renderer);\r\n\t\tif(cpropDOM) controlsDOM.appendChild(cpropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"reset\")){\r\n\t\tvar rpropDOM = this.getValueResetDOM(renderer);\r\n\t\tif(rpropDOM) controlsDOM.appendChild(rpropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"update\")){\r\n\t\tvar upropDOM = this.getValueUpdateDOM(renderer);\r\n\t\tif(upropDOM) controlsDOM.appendChild(upropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"show\")){\r\n\t\tvar showDOM = this.getValueShowDOM(renderer);\r\n\t\tif(showDOM) controlsDOM.appendChild(showDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"hide\")){\r\n\t\tvar hideDOM = this.getValueHideDOM(renderer);\r\n\t\tif(hideDOM) controlsDOM.appendChild(hideDOM);\r\n\t}\r\n\treturn controlsDOM;\r\n}\r\n\r\nHTMLDataHeaderViewer.prototype.getValueDeleteDOM = function(renderer){\r\n\tvar callback = function(){renderer.delete()};\r\n\tvar disabled = (renderer.cardControlAllows(\"delete\") ? false : \"Cardinality Rules Forbid Delete\");\r\n\treturn HTMLFrameHelper.getActionControl(\"value\", \"delete\", \"Delete\", callback, disabled);\r\n}\r\n\r\nHTMLDataHeaderViewer.prototype.getValueResetDOM = function(renderer){\r\n\tvar callback = function(){renderer.reset()};\r\n\tvar disabled = (renderer.isUpdated() ? false : \"Nothing to reset\");\r\n\treturn HTMLFrameHelper.getActionControl(\"value\", \"reset\", \"Reset\", callback, disabled);\r\n}\r\n\r\nHTMLDataHeaderViewer.prototype.getValueShowDOM = function(renderer){\r\n\tvar callback = function(){renderer.show()};\r\n\treturn HTMLFrameHelper.getActionControl(\"value\", \"show\", \"Show\", callback);\r\n}\r\n\r\nHTMLDataHeaderViewer.prototype.getValueHideDOM = function(renderer){\r\n\tvar callback = function(){renderer.hide()};\r\n\treturn HTMLFrameHelper.getActionControl(\"value\", \"hide\", \"Hide\", callback);\r\n}\r\n\r\nHTMLDataHeaderViewer.prototype.getValueCloneDOM = function(renderer){\r\n\tvar callback = function(){renderer.clone()};\r\n\tvar disabled = (renderer.cardControlAllows(\"clone\") ? false : \"Cardinality Rules Forbid Clone\");\r\n\treturn HTMLFrameHelper.getActionControl(\"value\", \"clone\", \"Clone\", callback, disabled);\r\n}\r\n\r\nHTMLDataHeaderViewer.prototype.getValueUpdateDOM = function(renderer){\r\n\tvar dpropDOM = document.createElement(\"span\");\r\n\tdpropDOM.setAttribute(\"class\", \"terminus-value-update\");\r\n\tvar saveback = function(){renderer.save()};\r\n\tvar disabled = (renderer.isUpdated() ? false : \"Nothing to save - no change\");\r\n\tdpropDOM.appendChild(HTMLFrameHelper.getActionControl(\"value\", \"save\", \"Save\", saveback, disabled));\r\n\treturn dpropDOM;\r\n}\r\n\r\nHTMLDataHeaderViewer.prototype.getViewerSelectorDOM = function(renderer){\r\n\tvar viewers = renderer.getAvailableViewers();\r\n\tif(viewers && viewers.length){\r\n\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-value-viewer\");\r\n\t\tvar callback = function(viewer){\r\n\t\t\tif(viewer){\r\n\t\t\t\trenderer.setViewer(viewer);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar selected = renderer.currentViewer();\r\n\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"data-viewer\", viewers, selected, callback);\r\n\t\tmpropDOM.appendChild(sel);\r\n\t\treturn mpropDOM;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nfunction JSONObjectViewer(renderer){\r\n\tthis.renderer = renderer;\r\n\tthis.properties = [];\r\n}\r\n\r\n/**\r\n * Functions for rendering / re-rendering the object as header and body components\r\n */\r\nJSONObjectViewer.prototype.render = function(){\r\n\talert(\"render json tbd\");\r\n}\r\nJSONObjectViewer.prototype.redraw = function(){\r\n\talert('redraw json tbd');\r\n}\r\n\r\nmodule.exports={HTMLDataViewer,HTMLDataHeaderViewer,JSONObjectViewer}\r\n","/*\r\n * User Interface elements dealing with database level functions - view, delete, create, db\r\n * view document etc\r\n */\r\nconst WOQLResultsViewer = require('../query/WOQLResultsViewer');\r\nconst TerminusClassChooser = require('./TerminusClassChooser');\r\nconst TerminusDocumentChooser = require('./TerminusDocumentChooser');\r\nconst WOQLQuery=require('../query/WOQLQuery')\r\nconst UTILS=require('../Utils')\r\n\r\n/*\r\n * User Interface elements dealing with database level functions - view, delete, create, db\r\n * view document etc\r\n */\r\nfunction TerminusDBController(ui){\r\n\t this.ui = ui;\r\n}\r\n\r\n/*\r\n * Controller provides access to the server level functions (create/delete db) and db-level functions (schema, query, document)\r\n */\r\nTerminusDBController.prototype.getAsDOM = function(){\r\n\tvar self = this;\r\n\tvar dbc = document.createElement(\"div\");\r\n\tdbc.setAttribute(\"class\", \"terminus-db-controller\");\r\n\tif(this.ui && this.ui.db()){\r\n\t\tvar scd = document.createElement(\"div\");\r\n\t\tscd.setAttribute(\"class\", \"terminus-field terminus-db-connection\");\r\n\t\tvar lab = document.createElement(\"span\");\r\n\t\tlab.setAttribute(\"class\", \"terminus-label terminus-db-label terminus-control-panel-label\");\r\n\t\tlab.appendChild(document.createTextNode(\"DB \"));\r\n\t\tvar val = document.createElement(\"span\");\r\n\t\tval.setAttribute(\"class\", \"terminus-value terminus-db-value terminus-control-panel-value\");\r\n\t\tvar dbrec = this.ui.client.connection.getDBRecord();\r\n\t\tvar nm = (dbrec && dbrec[\"rdfs:label\"] && dbrec[\"rdfs:label\"][\"@value\"] ? dbrec[\"rdfs:label\"][\"@value\"] : this.ui.db());\r\n\t\tval.appendChild(document.createTextNode(nm));\r\n\t\tscd.appendChild(lab);\r\n\t\tscd.appendChild(val);\r\n\t\t//dbc.appendChild(scd);\r\n\t\tvar nav = document.createElement('div');\r\n\t\tnav.setAttribute('class', 'span3');\r\n\t\tdbc.appendChild(nav);\r\n\t\tvar ul = document.createElement('ul');\r\n\t\tul.setAttribute('class','terminus-ul' );\r\n\t\tnav.appendChild(ul);\r\n\t\t// connected to db\r\n\t\tvar a = document.createElement('a');\r\n        a.setAttribute('class', 'terminus-dashboard-info terminus-list-group-a terminus-nav-width');\r\n        var txt = 'Database: ' + nm;\r\n        a.appendChild(document.createTextNode(txt));\r\n        ul.appendChild(a);\r\n\t\tif(this.ui.showControl(\"db\")){\r\n\t\t\tvar item = this.getControlHTML(\"Database Home\", \"fa-home\");\r\n\t\t\titem.classList.add(\"terminus-selected\");\r\n\t\t    item.addEventListener(\"click\", function(){\r\n\t\t\t\tUTILS.activateSelectedNav(this, self);\r\n\t\t\t\tself.ui.showDBMainPage();\r\n\t\t\t });\r\n\t        ul.appendChild(item);\r\n\t    }\r\n\t\tif(this.ui.showControl(\"delete_database\")){\r\n\t\t\tvar item = this.getControlHTML(\"Delete Database\", \"fa-trash-alt\");\r\n\t\t    item.addEventListener(\"click\", function(){\r\n\t\t\t\tUTILS.activateSelectedNav(this, self);\r\n\t\t\t\tself.ui.deleteDatabase();\r\n\t\t\t });\r\n\t        ul.appendChild(item);\r\n\t\t}\r\n\t\tif(this.ui.showControl(\"woql_select\")){\r\n\t\t\tvar item = this.getControlHTML(\"Query\", \"fa-search\");\r\n\t\t    item.addEventListener(\"click\", function(){\r\n\t\t\t\tUTILS.activateSelectedNav(this, self);\r\n\t\t\t\tself.ui.showQueryPage();\r\n\t\t\t});\r\n\t        ul.appendChild(item);\r\n\t\t}\r\n\t\tif(this.ui.showControl(\"woql_update\")){\r\n\t\t\tvar item = this.getControlHTML(\"Mapping\", \"fa-file-import\");\r\n\t        item.addEventListener(\"click\", function(){\r\n\t\t\t\tUTILS.activateSelectedNav(this, self);\r\n\t\t\t\tself.ui.showMappingPage();\r\n\t\t\t})\r\n\t        ul.appendChild(item);\r\n\t\t}\r\n\t\tif(this.ui.showControl(\"get_schema\")){\r\n\t\t\tvar item = this.getControlHTML(\"Schema\", \"fa-cog\");\r\n\t        item.addEventListener(\"click\", function(){\r\n\t\t\t\tUTILS.activateSelectedNav(this, self);\r\n\t\t\t\tself.ui.showSchemaPage();\r\n\t\t\t})\r\n\t        ul.appendChild(item);\r\n\t\t}\r\n\t\tif((this.ui.showControl(\"get_document\") || this.ui.showControl(\"create_document\"))){\r\n\t\t\tvar item = this.getControlHTML(\"Document\", \"fa-book\");\r\n\t        item.addEventListener(\"click\", function(){\r\n\t\t\t\tUTILS.removeSelectedNavClass(\"terminus-selected\");\r\n                this.classList.add(\"terminus-selected\");\r\n\t\t\t\tself.displayDocumentSubMenus();\r\n\t\t\t})\r\n\t        ul.appendChild(item);\r\n\t\t}\r\n\t\t// hidden submenus\r\n\t\tif(this.ui.showControl(\"get_document\")) {\r\n\t\t\tvar a = document.createElement('a');\r\n\t\t\ta.setAttribute('class', 'terminus-hide terminus-get-doc');\r\n\t\t\ta.appendChild(self.getDocumentChooserDOM());\r\n\t\t\ta.classList.add();\r\n\t\t\tul.appendChild(a);\r\n\t\t}\r\n\t\t// hidden submenus\r\n\t\tif(this.ui.showControl(\"create_document\")) {\r\n\t\t\tvar a = document.createElement('a');\r\n\t\t\ta.setAttribute('class', 'terminus-hide terminus-create-doc');\r\n\t\t\ta.appendChild(self.getDocumentCreatorDOM());\r\n\t\t\tul.appendChild(a);\r\n\t\t}\r\n\t}\r\n\treturn dbc;\r\n}\r\n\r\n\r\nTerminusDBController.prototype.getControlHTML = function(text, ic, css){\r\n    var self = this;\r\n    var a = document.createElement('a');\r\n\ta.setAttribute('class', 'terminus-a terminus-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\r\n    var icon = document.createElement('i');\r\n    icon.setAttribute('class', 'terminus-menu-icon fa ' + ic);\r\n    a.appendChild(icon);\r\n    var txt = document.createTextNode(text);\r\n    a.appendChild(txt);\r\n    return a;\r\n}\r\n\r\nTerminusDBController.prototype.showSubMenus = function(el){\r\n\tel.classList.remove('terminus-hide');\r\n\tel.classList.add('terminus-display');\r\n}\r\n\r\nTerminusDBController.prototype.displayDocumentSubMenus = function(){\r\n\t//display submenus on click of documents\r\n\tif(this.ui.showControl(\"get_document\")) {\r\n\t\tvar gd = document.getElementsByClassName('terminus-get-doc');\r\n\t\tthis.showSubMenus(gd[0]);\r\n\t}\r\n\tif(this.ui.showControl(\"create_document\")) {\r\n\t\tvar cd = document.getElementsByClassName('terminus-create-doc');\r\n\t\tthis.showSubMenus(cd[0]);\r\n\t}\r\n}\r\n\r\n\r\nTerminusDBController.prototype.getDocumentChooserDOM = function(){\r\n\tvar self = this;\r\n\tvar scd = document.createElement(\"span\");\r\n\tscd.setAttribute(\"class\", \"terminus-document-chooser terminus-form-horizontal terminus-control-group terminus-choose-by-id\");\r\n\tvar lab = document.createElement(\"span\");\r\n\tlab.setAttribute(\"class\", \"terminus-document-chooser-label terminus-control-label terminus-control-label-padding\");\r\n\t//lab.appendChild(document.createTextNode(\"ID \"));\r\n\tvar dcip = document.createElement(\"input\");\r\n\tdcip.setAttribute(\"class\", \"terminus-form-doc-value terminus-document-chooser terminus-doc-input-text\");\r\n\tdcip.setAttribute(\"placeholder\", \"Enter Document ID\");\r\n\tvar nbut = document.createElement(\"button\");\r\n\tnbut.setAttribute('class', \"terminus-control-button terminus-document-button terminus-doc-btn\")\r\n\tnbut.appendChild(document.createTextNode(\"View\"));\r\n\tnbut.addEventListener(\"click\", function(){\r\n\t\tif(dcip.value) self.ui.showDocument(dcip.value);\r\n\t})\r\n\tif(this.ui.client.connectionConfig.platformEndpoint() && this.ui.pluginAvailable(\"select2\")){\r\n\r\n\t\tvar mcls = TerminusClient.FrameHelper.unshorten(\"tcs:Document\");\r\n\t\tvar d2ch = new TerminusDocumentChooser(this.ui, mcls);\r\n\t\td2ch.change = function(val){\r\n\t\t\tself.ui.showDocument(val);\r\n\t\t}\r\n\t\td2ch.view = \"label\";\r\n\t\tvar sdom = d2ch.getAsDOM('terminus-class-select');\r\n\t\tjQuery(dcip).hide();\r\n\t\tjQuery(nbut).hide();\r\n\t\tvar nlab = document.createElement(\"a\");\r\n\t\tnlab.setAttribute(\"href\", \"#\");\r\n\t\tnlab.setAttribute(\"class\", \"terminus-document-which-chooser\");\r\n\t\tnlab.appendChild(document.createTextNode(\"Choose by ID\"));\r\n\t\tvar show = \"label\";\r\n\t\tjQuery(nlab).click(function(){\r\n\t\t\tif(show == \"label\"){\r\n\t\t\t\tshow = \"id\";\r\n\t\t\t\tjQuery(dcip).show();\r\n\t\t\t\tjQuery(nbut).show();\r\n\t\t\t\tjQuery(sdom).hide();\r\n\t\t\t\tjQuery(nlab).text(\"Choose by Label\");\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tshow = \"label\";\r\n\t\t\t\tjQuery(dcip).hide();\r\n\t\t\t\tjQuery(nbut).hide();\r\n\t\t\t\tjQuery(sdom).show();\r\n\t\t\t\tjQuery(nlab).text(\"Choose by ID\");\r\n\t\t\t}\r\n\t\t})\r\n\t\tscd.appendChild(sdom);\r\n\t\tscd.prepend(nlab);\r\n\t}\r\n\tvar nbuts = document.createElement(\"span\");\r\n\tnbuts.setAttribute(\"class\", \"terminus-control-buttons terminus-document-chooser-buttons\");\r\n\tnbuts.appendChild(nbut);\r\n\tscd.appendChild(lab);\r\n\tscd.appendChild(dcip);\r\n\tscd.appendChild(nbuts);\r\n\treturn scd;\r\n};\r\n\r\nTerminusDBController.prototype.getDocumentCreatorDOM = function(){\r\n\tvar self = this;\r\n\tvar scd = document.createElement(\"div\");\r\n\tscd.setAttribute(\"class\", \"terminus-document-creator terminus-form-horizontal terminus-control-group terminus-choose-by-id\");\r\n\r\n\tvar dcip = document.createElement(\"input\");\r\n\tdcip.setAttribute(\"class\", \"terminus-form-doc-value terminus-document-creator terminus-doc-input-text\");\r\n\tdcip.setAttribute(\"placeholder\", \"Enter Document Type\");\r\n\tvar nbut = document.createElement(\"button\");\r\n\tvar lab = document.createElement(\"span\");\r\n\tlab.setAttribute(\"class\", \"document-creator-label terminus-control-label terminus-control-label-padding\");\r\n\t//lab.appendChild(document.createTextNode(\"Type \"));\r\n\tnbut.setAttribute('class', \"terminus-control-button create-document-button terminus-doc-btn\")\r\n\tnbut.appendChild(document.createTextNode(\"Create\"));\r\n\tnbut.addEventListener(\"click\", function(){\r\n\t\tif(dcip.value) self.ui.showCreateDocument(dcip.value);\r\n\t})\r\n\tvar nbuts = document.createElement(\"div\");\r\n\tnbuts.setAttribute(\"class\", \"terminus-control-buttons terminus-document-creator-buttons\");\r\n\tvar wq = new WOQLQuery(this.ui.client, {}, this.ui);\r\n\tvar filter = wq.getConcreteDocumentClassPattern(\"v:Element\");\r\n\tvar termcc = new TerminusClassChooser(this.ui, filter);\r\n\ttermcc.empty_choice = \"Create Document of Type\";\r\n\tvar self = this;\r\n\ttermcc.change = function(new_class){\r\n\t\tif(new_class){\r\n\t\t\tself.ui.showCreateDocument(new_class);\r\n\t\t\ttermcc.choice = false;\r\n\t\t}\r\n\t}\r\n\tvar tcdom = termcc.getAsDOM('terminus-class-select');\r\n\r\n\tvar gb = document.createElement('div');\r\n\tgb.setAttribute('class', 'terminus-doc-btn-group');\r\n\tvar bi = document.createElement('button');\r\n\tbi.setAttribute('class', 'terminus-doc-btn-selected');\r\n\tbi.appendChild((document.createTextNode('D')));\r\n\tvar bt = document.createElement('button');\r\n\tbt.appendChild((document.createTextNode('T')));\r\n\tgb.appendChild(bt);\r\n\tgb.appendChild(bi);\r\n\tvar nlabs = document.createElement(\"div\");\r\n\tnlabs.setAttribute('class', 'terminus-doc-btn-gp-align');\r\n\tnlabs.appendChild(gb);\r\n\tscd.appendChild(nlabs);\r\n\tvar ccDOM = document.createElement(\"span\");\r\n\tnlabs.appendChild(ccDOM);\r\n\tccDOM.setAttribute(\"class\", \"create-document-list\");\r\n\tccDOM.appendChild(tcdom);\r\n\tvar which = \"select\";\r\n\tbt.addEventListener(\"click\", function(){\r\n\t\t// create document of TerminusClient.FrameHelper.removeChildren(nlabs);\r\n\t\tTerminusClient.FrameHelper.removeChildren(ccDOM);\r\n\t\tUTILS.removeSelectedNavClass(\"terminus-doc-btn-selected\");\r\n\t\tthis.classList.add(\"terminus-doc-btn-selected\");\r\n\t\tccDOM.appendChild(dcip);\r\n\t\tccDOM.appendChild(nbut);\r\n\t});\r\n\r\n\tbi.addEventListener(\"click\", function(){\r\n\t\t// create document from dropdown\r\n\t\tTerminusClient.FrameHelper.removeChildren(ccDOM);\r\n\t\tUTILS.removeSelectedNavClass(\"terminus-doc-btn-selected\");\r\n\t\tthis.classList.add(\"terminus-doc-btn-selected\");\r\n\t\tccDOM.appendChild(tcdom);\r\n\t});\r\n\treturn scd;\r\n};\r\n\r\nfunction TerminusDBViewer(ui){\r\n\tthis.ui = ui;\r\n\tthis.wquery = new WOQLQuery(ui.client, this.options, ui);\r\n}\r\n\r\nTerminusDBViewer.prototype.getAsDOM = function(selected){\r\n\tvar pd = document.createElement(\"span\");\r\n\tpd.setAttribute(\"class\", \"terminus-db-home-page\");\r\n\tvar sth = document.createElement('div');\r\n\tvar banner = document.createElement('div');\r\n\t//pd.appendChild(banner);\r\n\tbanner.setAttribute('class', 'terminus-banner');\r\n\tvar dhp = document.createElement(\"span\");\r\n\tdhp.setAttribute('class', 'terminus-home-heading');\r\n\tdhp.appendChild(document.createTextNode(\"DB Home Page - \"));\r\n\tsth.appendChild(dhp);\r\n\tvar scd = document.createElement(\"span\");\r\n\tscd.setAttribute(\"class\", \"terminus-db-details\");\r\n\tvar scs = document.createElement(\"span\");\r\n\tscs.setAttribute(\"class\", \"terminus-db-details-value \");\r\n\tvar dbrec = this.ui.getDBRecord();\r\n\tif(dbrec){\r\n\t\tvar nm = (dbrec[\"rdfs:label\"] && dbrec[\"rdfs:label\"][\"@value\"] ? dbrec[\"rdfs:label\"][\"@value\"] : this.db);\r\n\t\tscs.appendChild(document.createTextNode(nm));\r\n\t\tscs.setAttribute('class', 'terminus-home-heading');\r\n\t}\r\n\tscd.appendChild(scs);\r\n\tsth.appendChild(scd);\r\n\tbanner.appendChild(sth);\r\n\t//pd.appendChild(sth);\r\n\t//pd.appendChild(UTILS.getHeaderDom('Summary'));\r\n\tthis.getDeleteOnHomePage(pd);\r\n\tthis.getDBSummary(pd);\r\n\tpd.appendChild(pd.appendChild(UTILS.getHeaderDom('List of Documents')));\r\n\tthis.getClassesDOM(pd);\r\n\treturn pd;\r\n}\r\n\r\nTerminusDBViewer.prototype.getDbInfoBox = function(r, module){\r\n\tvar sp = document.createElement('span');\r\n    sp.setAttribute('class', 'terminus-db-info-box');\r\n\tvar info = document.createElement('div');\r\n\tinfo.appendChild(document.createTextNode(module.charAt(0).toUpperCase() + module.slice(1)));\r\n\tinfo.setAttribute('class', 'terminus-db-info');\r\n\tsp.appendChild(info);\r\n\r\n    var i = document.createElement('i');\r\n\tswitch(module){\r\n\t\tcase 'size':\r\n\t\t\ti.setAttribute('class', 'terminus-icon fa fa-balance-scale');\r\n\t\t    var txt = document.createTextNode('2 Gb');\r\n\t\tbreak;\r\n\t\tcase 'created':\r\n\t\t\ti.setAttribute('class', 'terminus-icon fa fa-calendar');\r\n\t\t    var txt = document.createTextNode('16 July 2015');\r\n\t\tbreak;\r\n\t\tcase 'modified':\r\n\t\t\ti.setAttribute('class', 'terminus-icon fa fa-clock');\r\n\t\t    var txt = document.createTextNode('22 Dec 2019');\r\n\t\tbreak;\r\n\t}\r\n    sp.appendChild(i);\r\n\tif(txt) sp.appendChild(txt);\r\n    r.appendChild(sp);\r\n}\r\n\r\nTerminusDBViewer.prototype.getDeleteOnHomePage = function(d){\r\n\t// delete database\r\n    var del = document.createElement('button');\r\n    del.setAttribute('class', 'terminus-del-btn');\r\n    del.setAttribute('type', 'button');\r\n    del.innerHTML = 'Delete Database';\r\n\tvar dbrec = this.ui.getDBRecord();\r\n\tif(dbrec)\r\n\t\tvar nm = (dbrec[\"rdfs:label\"] && dbrec[\"rdfs:label\"][\"@value\"] ? dbrec[\"rdfs:label\"][\"@value\"] : this.db);\r\n    var self = this;\r\n    del.addEventListener(\"click\", function(){\r\n      self.ui.deleteDatabase(nm);\r\n    });\r\n    d.appendChild(del);\r\n}\r\n\r\nTerminusDBViewer.prototype.getDBSummary = function(d){\r\n    var r = document.createElement('span');\r\n    r.setAttribute('class', 'terminus-db-info-box-display');\r\n    d.appendChild(r);\r\n\r\n    /* getDbInfoBox() calls can change according to further requirments */\r\n    this.getDbInfoBox(r, 'size');\r\n    this.getDbInfoBox(r, 'created');\r\n    this.getDbInfoBox(r, 'modified');\r\n}\r\n\r\nTerminusDBViewer.prototype.getClassesDOM = function(d){\r\n\tvar q = this.wquery.getClassesQuery();\r\n\tvar self = this;\r\n\tthis.wquery.execute(q)\r\n\t.then(function(result){\r\n\t\tself.result = new WOQLResultsViewer.WOQLResultsViewer(this.ui, result, {}, {});\r\n\t\tif(self.result){\r\n\t\t\tvar nd = self.result.getAsDOM(d, false);\r\n\t\t\tif(nd){\r\n\t\t\t\tnd.setAttribute('class', 'terminus-margin-box');\r\n\t        }\r\n\t\t\telse d.appendChild(document.createTextNode(\"No results returned\"));\r\n\t\t}\r\n\t})\r\n\t.catch(function(err){\r\n\t\tconsole.error(err);\r\n\t\tself.ui.showError(err);\r\n\t});\r\n\treturn d;\r\n}\r\n\r\n\r\nfunction TerminusDBCreator(ui){\r\n\tthis.ui = ui;\r\n}\r\n\r\nTerminusDBCreator.prototype.getAsDOM = function(selected){\r\n\tvar scd = document.createElement(\"div\");\r\n\t/* test delete when over var txtHolder = document.createElement(\"div\");\r\n\ttxtHolder.appendChild(document.createTextNode('expecting laoder herer'));\r\n\tscd.appendChild(txtHolder);\r\n\tthis.ui.getLoader(scd);*/\r\n\tscd.setAttribute(\"class\", \"terminus-db-creator\");\r\n\tvar sct = document.createElement(\"h3\");\r\n\tsct.setAttribute(\"class\", \"terminus-db-creator-title terminus-module-head\");\r\n\tsct.appendChild(document.createTextNode(\"Create New Database\"));\r\n\tscd.appendChild(sct);\r\n\tvar mfd = document.createElement('div');\r\n\tmfd.setAttribute('class', 'terminus-form-border');\r\n\tscd.appendChild(mfd);\r\n\tvar sci = document.createElement(\"div\");\r\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-form-field-spacing terminus-form-horizontal terminus-control-group\");\r\n\tvar slab = document.createElement(\"span\");\r\n\tslab.setAttribute(\"class\", \"terminus-id-label terminus-form-label terminus-control-label\");\r\n\tslab.appendChild(document.createTextNode(\"ID\"));\r\n\tsci.appendChild(slab);\r\n\tvar idip = document.createElement(\"input\");\r\n\tidip.setAttribute(\"type\", \"text\");\r\n\tidip.setAttribute(\"class\", \"terminus-form-value terminus-input-text\");\r\n\tidip.setAttribute(\"placeholder\", \"No spaces or special characters allowed in IDs\");\r\n\tsci.appendChild(idip);\r\n\tmfd.appendChild(sci);\r\n\tvar sci = document.createElement(\"div\");\r\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-form-field-spacing terminus-form-horizontal terminus-control-group\");\r\n\tvar slab = document.createElement(\"span\");\r\n\tslab.setAttribute(\"class\", \"terminus-title-label terminus-form-label terminus-control-label\");\r\n\tslab.appendChild(document.createTextNode(\"Title\"));\r\n\tvar titip = document.createElement(\"input\");\r\n\ttitip.setAttribute(\"type\", \"text\");\r\n\ttitip.setAttribute(\"placeholder\", \"A brief title for the Database\");\r\n\ttitip.setAttribute(\"class\", \"terminus-form-value terminus-input-text\");\r\n\tsci.appendChild(slab);\r\n\tsci.appendChild(titip);\r\n\tmfd.appendChild(sci);\r\n\tvar sci = document.createElement(\"div\");\r\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-form-field-spacing terminus-form-horizontal terminus-control-group\");\r\n\tvar slab = document.createElement(\"span\");\r\n\tslab.setAttribute(\"class\", \"terminus-title-label terminus-form-label terminus-control-label\");\r\n\tslab.appendChild(document.createTextNode(\"Description\"));\r\n\tsci.appendChild(slab);\r\n\tvar descip = document.createElement(\"textarea\");\r\n\tdescip.setAttribute(\"class\", \"terminus-textarea terminus-db-description terminus-textarea \");\r\n\tdescip.setAttribute(\"placeholder\", \"A short text describing the database and its purpose\");\r\n\tsci.appendChild(descip);\r\n\tmfd.appendChild(sci);\r\n\tvar sci = document.createElement(\"div\");\r\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-form-field-spacing terminus-form-horizontal terminus-control-group\");\r\n\tvar slab = document.createElement(\"span\");\r\n\tslab.setAttribute(\"class\", \"terminus-schema-label terminus-form-label terminus-control-label\");\r\n\tslab.appendChild(document.createTextNode(\"Import Schema\"));\r\n\tsci.appendChild(slab);\r\n\tvar schem = document.createElement(\"input\");\r\n\tschem.setAttribute(\"placeholder\", \"Terminus DB URL\");\r\n\tschem.setAttribute(\"type\", \"text\");\r\n\tschem.setAttribute(\"class\", \"terminus-form-value terminus-form-url terminus-input-text\");\r\n\r\n\tsci.appendChild(schem);\r\n\tmfd.appendChild(sci);\r\n\tvar sci = document.createElement(\"div\");\r\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-form-field-spacing terminus-form-horizontal terminus-control-group\");\r\n\tvar slab = document.createElement(\"span\");\r\n\tslab.setAttribute(\"class\", \"terminus-data-label terminus-form-label terminus-control-label\");\r\n\tslab.appendChild(document.createTextNode(\"Import Data\"));\r\n\tsci.appendChild(slab);\r\n\tvar datip = document.createElement(\"input\");\r\n\tdatip.setAttribute(\"type\", \"text\");\r\n\tdatip.setAttribute(\"placeholder\", \"Terminus DB URL\");\r\n\tdatip.setAttribute(\"class\", \"terminus-form-value terminus-form-url terminus-input-text\");\r\n\tsci.appendChild(datip);\r\n\t//mfd.appendChild(sci);\r\n\tvar butfield = document.createElement(\"div\");\r\n\tbutfield.setAttribute(\"class\", \"terminus-control-buttons\");\r\n\tvar cancbut = document.createElement(\"button\");\r\n\tcancbut.setAttribute(\"class\", \"terminus-control-button terminus-cancel-db-button terminus-btn\");\r\n\tcancbut.appendChild(document.createTextNode(\"Cancel\"));\r\n\tvar loadbut = document.createElement(\"button\");\r\n\tloadbut.setAttribute(\"class\", \"terminus-control-button terminus-create-db-button terminus-btn\");\r\n\tloadbut.appendChild(document.createTextNode(\"Create\"));\r\n\tvar self = this;\r\n\tvar gatherips = function(){\r\n\t\tvar input = {};\r\n\t\tinput.id = idip.value;\r\n\t\tinput.title = titip.value;\r\n\t\tinput.description = descip.value;\r\n\t\tinput.schema = schem.value;\r\n\t\tinput.data = datip.value;\r\n\t\treturn input;\r\n\t}\r\n\tvar self = this;\r\n\tloadbut.addEventListener(\"click\", function(){\r\n\t\tvar input = gatherips();\r\n\t\tself.ui.createDatabase(input);\r\n\t})\r\n\tcancbut.addEventListener(\"click\", function(){\r\n\t\tself.ui.showServerMainPage();\r\n\t})\r\n\tbutfield.appendChild(cancbut);\r\n\tbutfield.appendChild(loadbut);\r\n\tmfd.appendChild(butfield);\r\n\r\n\treturn scd;\r\n}\r\nmodule.exports={TerminusDBViewer:TerminusDBViewer,\r\n\t            TerminusDBController:TerminusDBController,\r\n\t            TerminusDBCreator:TerminusDBCreator}\r\n","function TerminusViolations(vios, ui){\r\n\tthis.ui = ui;\r\n\tthis.vios = [];\r\n\tvar nvios = [];\r\n\tfor(var i = 0; i<vios.length; i++){\r\n\t\tfor(var j = 0; j<nvios.length; j++){\r\n\t\t\tif(JSON.stringify(vios[i]) == JSON.stringify(nvios[j])) continue;\r\n\t\t}\r\n\t\tnvios.push(vios[i]);\r\n\t}\r\n\tfor(var i = 0; i<nvios.length; i++){\r\n\t\tthis.vios.push(new TerminusViolation(nvios[i], this.ui));\r\n\t}\t\r\n} \r\n\r\nTerminusViolations.prototype.getAsDOM = function(context_msg){\r\n\tvar vdom = document.createElement(\"div\");\r\n\tvdom.setAttribute(\"class\", \"terminus-violations\");\r\n\tvar msg = this.vios.length + (this.vios.length > 1 ? \" Violations Detected\" : \" Violation Detected\");\r\n\tif(context_msg) msg += \" \" + context_msg;\r\n\tvdom.appendChild(document.createTextNode(msg));\r\n\tfor(var i = 0; i<this.vios.length; i++){\r\n\t\tvdom.appendChild(this.vios[i].getAsDOM());\r\n\t}\r\n\treturn vdom;\r\n}\r\n\r\n/*\r\n * Class for displaying violation reports as HTML\r\n */\r\nfunction TerminusViolation(vio, ui){\r\n\tthis.ui = ui;\r\n\tthis.vio = vio;\r\n} \r\n\r\nTerminusViolation.prototype.getAsDOM = function(){\r\n\tvar vdom = document.createElement(\"div\");\r\n\tvdom.setAttribute(\"class\", \"terminus-violation\");\r\n\tif(this.vio['@type']){\r\n\t\tvar msg = this.vio['vio:message'] || {\"@value\": \"\"};\r\n\t\tvdom.appendChild(this.getPropertyAsDOM(this.vio[\"@type\"], msg));\r\n\t}\r\n\tfor(var prop in this.vio){\r\n\t\tif(prop != \"vio:message\" && prop != \"@type\"){\r\n\t\t\tvdom.appendChild(this.getPropertyAsDOM(prop, this.vio[prop]));\r\n\t\t}\r\n\t}\r\n\treturn vdom;\r\n}\r\n\r\nTerminusViolation.prototype.getPropertyAsDOM = function(prop, val){\r\n\tvar pdom = document.createElement(\"div\");\r\n\tpdom.setAttribute(\"class\", \"terminus-violation-property\");\r\n\tvar ldom = document.createElement(\"span\");\r\n\tldom.setAttribute(\"class\", \"terminus-label terminus-violation-property-label\");\r\n\tldom.appendChild(document.createTextNode(prop));\r\n\tvar vdom = document.createElement(\"span\");\r\n\tvdom.setAttribute(\"class\", \"terminus-violation-property-value\");\r\n\tvdom.appendChild(document.createTextNode(val[\"@value\"]));\r\n\tpdom.appendChild(ldom);\r\n\tpdom.appendChild(vdom);\r\n\treturn pdom;\r\n}\r\n\r\nmodule.exports=TerminusViolations\r\n","const WOQLQuery = require('../query/WOQLQuery');\r\nconst WOQLResultsViewer = require('../query/WOQLResultsViewer');\r\nconst WOQLTextboxGenerator = require('../query/WOQLTextboxGenerator');\r\nconst WOQLGraphBrowserGenerator = require('../query/WOQLGraphBrowserGenerator');\r\nconst TerminusPluginManager = require('../plugins/TerminusPlugin');\r\n\r\nfunction TerminusQueryViewer(ui, options){\r\n\tthis.ui = ui;\r\n\tthis.options = options;\r\n\tthis.meta = {};\r\n\tthis.init();\r\n\tthis.generator = false;\r\n\tthis.result = false;\r\n\tthis.wquery = new WOQLQuery(ui.client, this.options, this.ui);\r\n\tthis.pman = new TerminusPluginManager();\r\n\tthis.gentype = (options && options.generator ? options.generator : \"textbox\");\r\n\tthis.generators = {\r\n\t\t\"textbox\" : { label: \"Simple Text Box\", value: \"textbox\"},\r\n\t}\r\n\tif(ui.pluginAvailable(\"jqueryui\")){\r\n\t\tthis.generators.gbrowse = { label: \"Graph Browser\", value: \"gbrowse\"};\r\n\t}\r\n\tthis.loadGenerator();\r\n}\r\n\r\nTerminusQueryViewer.prototype.hasGeneratorOptions = function(){\r\n\treturn false;\r\n\tvar yup = false;\r\n\tfor(var gen in this.generators){\r\n\t\tif(yup) return true;\r\n\t\telse yup = true;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nTerminusQueryViewer.prototype.changeGenerator = function(ng){\r\n\tif(this.gentype != ng){\r\n\t\tthis.gentype = ng;\r\n\t\tthis.loadGenerator();\r\n\t\tthis.redrawGenerator();\r\n\t}\r\n}\r\nTerminusQueryViewer.prototype.redrawGenerator = function(q){\r\n\tTerminusClient.FrameHelper.removeChildren(this.inputDOM);\r\n\tthis.inputDOM.appendChild(this.getQueryButtonsDOM(q));\r\n}\r\n\r\nTerminusQueryViewer.prototype.loadGenerator = function(){\r\n\tvar self = this;\r\n\tvar nquery = function(q, settings){\r\n\t\tself.query(q, settings)\r\n\t}\r\n\tif(this.gentype == \"textbox\"){\r\n\t\tthis.generator = new WOQLTextboxGenerator(nquery, this, this.ui);\r\n\t}\r\n\telse if(this.gentype == \"gbrowse\"){\r\n\t\tthis.generator = new WOQLGraphBrowserGenerator(nquery, this, this.ui);\r\n\t}\r\n}\r\n\r\nTerminusQueryViewer.prototype.init = function(){\r\n\tvar wq = new WOQLQuery(this.ui.client, this.options, this.ui);\r\n\tvar woql = wq.getElementMetaDataQuery();\r\n\tvar self = this;\r\n\tself.meta = {};\r\n\twq.execute(woql).then(function(wresult){\r\n\t\tvar wqlR = new WOQLResultsViewer.WOQLResult(wresult, null ,null, self.ui);\r\n\t\tif(wqlR.hasBindings(wresult)){\r\n\t\t\tfor(var i = 0; i<wresult.bindings.length; i++){\r\n\t\t\t\tvar el = wresult.bindings[i].Element;\r\n\t\t\t\tif(el && typeof self.meta[el] == \"undefined\"){\r\n\t\t\t\t\tself.meta[el] = wresult.bindings[i];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t})\r\n\t.catch(function(e){\r\n\t\tconsole.error(e);\r\n\t});\r\n}\r\n\r\n\r\nTerminusQueryViewer.prototype.query = function(val, settings, tab){\r\n\tvar self = this;\r\n\tTerminusClient.FrameHelper.removeChildren(this.resultDOM);\r\n\tthis.wquery.execute(val)\r\n\t.then(function(result){\r\n\t\tself.result = new WOQLResultsViewer.WOQLResultsViewer(self.ui, result, self.options, settings);\r\n\t\tvar nd = self.result.getAsDOM(self.resultDOM, true);\r\n\t\tif(nd){\r\n\t\t\t self.resultDOM.appendChild(nd);\r\n\t\t}\r\n\t})\r\n\t.catch(function(err){\r\n\t\tself.ui.showError(err);\r\n\t});\r\n}\r\n\r\nTerminusQueryViewer.prototype.getResultViewDom = function(){\r\n\tthis.resultDOM = document.createElement(\"div\");\r\n\tthis.resultDOM.setAttribute(\"class\", \"terminus-query-results\");\r\n}\r\n\r\nTerminusQueryViewer.prototype.getAsDOM = function(q){\r\n\tvar qbox = document.createElement(\"div\");\r\n\tqbox.setAttribute(\"class\", \"terminus-query-page\");\r\n\tif(this.hasGeneratorOptions()){\r\n\t\tqbox.appendChild(this.getQueryCreatorChoiceDOM(q));\r\n\t}\r\n\tthis.resultDOM = document.createElement(\"div\");\r\n\tthis.resultDOM.setAttribute(\"class\", \"terminus-query-results terminus-query-section\");\r\n\r\n\tvar qtHolder = document.createElement('span');\r\n\tqtHolder.setAttribute('style', 'display: flex;');\r\n\r\n\tthis.qTextBox = this.getQueryTextAreaDOM(q, qtHolder);\r\n\tthis.buttonsDOM = document.createElement(\"span\");\r\n\tthis.buttonsDOM.setAttribute(\"class\", \"terminus-query-input\");\r\n\tthis.buttonsDOM.appendChild(this.getQueryButtonsDOM(q, this.qTextBox));\r\n\r\n\tqtHolder.appendChild(this.buttonsDOM);\r\n\r\n\tqbox.appendChild(qtHolder);\r\n\tqbox.appendChild(this.resultDOM);\r\n\treturn qbox;\r\n}\r\n\r\nTerminusQueryViewer.prototype.getQueryCreatorChoiceDOM = function(){\r\n\tvar qcc = document.createElement(\"select\");\r\n\tqcc.setAttribute(\"class\", \"terminus-query-generator-selector\");\r\n\tfor(var c in this.generators){\r\n\t\tvar gen = this.generators[c];\r\n\t\tvar opt = document.createElement(\"option\");\r\n\t\topt.value = (gen.value ? gen.value : c);\r\n\t\tvar lab = (gen.label ? gen.label : c);\r\n\t\topt.appendChild(document.createTextNode(lab));\r\n\t\tqcc.appendChild(opt);\r\n\t}\r\n\tvar self = this;\r\n\tqcc.addEventListener(\"change\", function(){\r\n\t\tself.changeGenerator(this.value);\r\n\t});\r\n\treturn qcc;\r\n}\r\n\r\nTerminusQueryViewer.prototype.getQueryButtonsDOM = function(q, qip){\r\n\treturn this.generator.getAsDOM(q, qip);\r\n}\r\n\r\nTerminusQueryViewer.prototype.getQueryTextAreaDOM = function(q, box){\r\n\treturn this.generator.getQueryTextAreaDOM(q, box);\r\n}\r\n\r\nmodule.exports=TerminusQueryViewer\r\n","const TerminusClassChooser = require('../client/TerminusClassChooser');\r\nconst TerminusPropertyChooser = require('../client/TerminusPropertyChooser');\r\nconst TerminusDocumentChooser = require('../client/TerminusDocumentChooser');\r\nconst UTILS= require('../Utils')\r\n\r\nfunction WOQLTextboxGenerator(tq, qman, ui){\r\n\tthis.query = tq;\r\n\tthis.wquery = qman.wquery;\r\n\tthis.ui = ui;\r\n\t// default datatable settings if datatable plug in available\r\n\tthis.datatable = {};\r\n\tthis.datatable.pageLength = 25;\r\n\tthis.datatable.start = 0;\r\n}\r\n\r\nWOQLTextboxGenerator.prototype.gatherDatatableSettings = function(txtArea, queryName){\r\n\tthis.datatable.qTextDom =  txtArea;\r\n\tthis.datatable.query =  queryName;\r\n\tthis.datatable.chosenValue = null;\r\n}\r\n\r\nWOQLTextboxGenerator.prototype.getQueryButtonGroups = function(qbox){\r\n\tvar row = document.createElement('div');\r\n\trow.setAttribute('class', 'terminus-query-group-row');\r\n\tqbox.appendChild(row);\r\n\treturn row;\r\n}\r\n\r\nWOQLTextboxGenerator.prototype.qGroupQueries = function(qrow, header, descr){\r\n\tvar g = document.createElement('button');\r\n\tvar self = this;\r\n\tg.addEventListener('click', function(e){\r\n\t\tself.ui.clearMessages();\r\n\t\tif(header == 'Data Queries'){ // to ensure click event is not on button but on select instead so no need to hide\r\n\t\t\tvar target = e.target || e.srcElement,\r\n        \ttext = target.textContent || target.innerText;\r\n\t\t\tif(target.nodeName == 'SELECT') return;\r\n\t\t}\r\n\t\tfor(var i=0; i<this.children.length ; i++){\r\n\t\t\tUTILS.toggleVisibility(this.children[i]);\r\n\t\t}\r\n\t\tvar qeb = document.getElementsByClassName('query-example-buttons');\r\n\t\tfor(var i=0; i<qeb.length ; i++){\r\n\t\t\tif(this != qeb[i]){\r\n\t\t\t\tfor(var j=0; j<qeb[i].children.length ; j++){\r\n\t\t\t\t\tif(qeb[i].children[j].classList.contains('terminus-display')){\r\n\t\t\t\t\t\tqeb[i].children[j].classList.remove('terminus-display');\r\n\t\t\t\t\t\tqeb[i].children[j].classList.add('terminus-hide');\r\n\t\t\t\t    }\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t})\r\n\r\n\tg.setAttribute('class', 'terminus-group-box terminus-pointer query-example-buttons');\r\n\r\n\tvar cd = document.createElement('div');\r\n\tcd.setAttribute('class', 'terminus-group');\r\n\tg.appendChild(cd);\r\n\r\n\tvar ch = document.createElement('div');\r\n\tch.setAttribute('class', 'terminus-group-header');\r\n\tcd.appendChild(ch);\r\n\r\n\tvar d = document.createElement('div');\r\n\td.setAttribute('class', 'terminus-query-block-headers')\r\n\td.appendChild(document.createTextNode(header));\r\n\tch.appendChild(d);\r\n\tic = document.createElement('i');\r\n    ic.setAttribute('class', 'terminus-cheveron-float fa fa-chevron-down');\r\n\td.appendChild(ic);\r\n\r\n\tvar t = document.createElement('h5');\r\n\tt.setAttribute('class', 'terminus-group-sub-title terminus-hide');\r\n\tt.appendChild(document.createTextNode(descr));\r\n\tg.appendChild(t);\r\n\r\n\tqrow.appendChild(g);\r\n\r\n\treturn g;\r\n}\r\n\r\nWOQLTextboxGenerator.prototype.setDatatableSettings = function(query){\r\n\tif(query.limit){\r\n\t\tthis.datatable.pageLength = query.limit[0];\r\n\t\tthis.datatable.start = query.limit[1].start[0];\r\n\t}\r\n\t/*\r\n\tvar newQuery = query.replace(/\\s/g,'');  // remove spaces\r\n\tvar searchStr = 'limit(';\r\n\tif(newQuery.indexOf(searchStr) !== -1){\r\n\t\tvar remString = newQuery.substring(searchStr.length, newQuery.length);\r\n\t\tvar limit = remString.substr(0, remString.indexOf(','));\r\n\t\tthis.datatable.pageLength = limit;\r\n\t\tthis.datatable.start = 0;\r\n\t}*/\r\n}\r\n\r\nWOQLTextboxGenerator.prototype.getQueryTextAreaDOM = function(q, box){\r\n\tvar qbox = document.createElement(\"span\");\r\n\tqbox.setAttribute(\"class\", \"terminus-query-textbox-input terminus-query-section\");\r\n\r\n\tvar eqh = document.createElement(\"H3\");\r\n\teqh.appendChild(document.createTextNode(\"Enter Query\"));\r\n\teqh.setAttribute('class', 'terminus-full-css-margin-top terminus-module-head');\r\n\tqbox.appendChild(eqh);\r\n\r\n\tvar qip = document.createElement(\"textarea\");\r\n\tqip.setAttribute(\"class\", \"terminus-query-box\");\r\n\tqip.setAttribute(\"placeholder\", \"Enter new query or load queries from example buttons provided below ...\");\r\n\tqip.setAttribute(\"style\", \"min-width: 400px; min-height: 60px;\");\r\n\tif(q) qip.value = JSON.stringify(q);\r\n\tqbox.appendChild(qip);\r\n\tUTILS.stylizeEditor(this.ui, qip, 'query', 'javascript');\r\n\tvar self = this;\r\n\tvar qbut = document.createElement(\"button\");\r\n\tqbut.setAttribute(\"class\", \"terminus-control-button terminus-btn\")\r\n\tqbut.appendChild(document.createTextNode(\"Send Query\"));\r\n\tqbut.addEventListener(\"click\", function(){\r\n\t\tself.ui.clearMessages();\r\n\t\ttry {\r\n\t\t\tvar qval = JSON.parse(qip.value);\r\n\t\t\tif(self.ui.pluginAvailable(\"datatables\")){\r\n\t\t\t\t// pass current Example query scope while editing the text editor\r\n\t\t\t\tself.gatherDatatableSettings(qip, self.datatable.query);\r\n\t\t\t\tself.setDatatableSettings(qval);\r\n\t\t\t\tself.query(qval, self.datatable);\r\n\t\t\t}\r\n\t\t\telse self.query(qval);\r\n\t\t}\r\n\t\tcatch(e){\r\n\t\t\talert(\"Failed to parse Query \" + e.toString());\r\n\t\t}\r\n\t})\r\n\tqbox.appendChild(qbut);\r\n\tbox.appendChild(qbox);\r\n\treturn qip;\r\n}\r\n\r\nWOQLTextboxGenerator.prototype.getAsDOM = function(q, qip){\r\n\tvar qbox = document.createElement(\"div\");\r\n\tqbox.setAttribute(\"class\", \"terminus-query-textbox-input\");\r\n\tvar qbuts = document.createElement(\"div\");\r\n\tqbuts.setAttribute(\"class\", \"terminus-control-buttons\");\r\n\t//qbuts.appendChild(qbut);\r\n\tqbox.appendChild(qbuts);\r\n\tvar qexs = document.createElement(\"div\");\r\n\tqexs.setAttribute(\"class\", \"terminus-query-examples terminus-db-list-title\");\r\n\tvar qh = document.createElement(\"H3\");\r\n\tqh.appendChild(document.createTextNode(\"Saved Queries\"));\r\n\tqh.setAttribute('class', 'terminus-full-css-margin-top terminus-module-head');\r\n\tqexs.appendChild(qh);\r\n\r\n\tvar qrow = this.getQueryButtonGroups(qexs);\r\n\tqexs.appendChild(qrow);\r\n\r\n\t/* grouping class queries */\r\n\tvar qcGroup = this.qGroupQueries(qrow, 'Schema Queries', '');\r\n\r\n\tvar nqbut = document.createElement(\"button\");\r\n\tnqbut.appendChild(document.createTextNode(\"Show All Classes\"));\r\n\tnqbut.setAttribute(\"class\", \"terminus-control-button terminus-q-btn\");\r\n\tnqbut.addEventListener(\"click\", function(){\r\n\t\tself.ui.clearMessages();\r\n\t\tUTILS.deleteStylizedEditor(self.ui, qip);\r\n\t\tvar qval = self.wquery.getClassMetaDataQuery(null, self.datatable.pageLength, self.datatable.start);\r\n\t\tqip.value = JSON.stringify(qval);\r\n\t\tUTILS.stylizeEditor(self.ui, qip, 'query', 'javascript');\r\n\t\tif(self.ui.pluginAvailable(\"datatables\")){\r\n\t\t\tself.gatherDatatableSettings(qip, 'Show_All_Classes');\r\n\t\t\tself.query(qval, self.datatable);\r\n\t\t}\r\n\t\telse self.query(qval);\r\n\t})\r\n\r\n\tvar aqbut = document.createElement(\"button\");\r\n\taqbut.appendChild(document.createTextNode(\"Show Document Classes\"));\r\n\taqbut.setAttribute(\"class\", \"terminus-control-button terminus-q-btn\");\r\n\taqbut.addEventListener(\"click\", function(){\r\n\t\tself.ui.clearMessages();\r\n\t\tUTILS.deleteStylizedEditor(self.ui, qip);\r\n\t\tvar qvalue = self.wquery.getClassMetaDataQuery(self.wquery.getConcreteDocumentClassPattern(),\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tself.datatable.pageLength, self.datatable.start);\r\n\t\tqip.value = JSON.stringify(qvalue);\r\n\t\tUTILS.stylizeEditor(self.ui, qip, 'query', 'javascript');\r\n\t\tif(self.ui.pluginAvailable(\"datatables\")){\r\n\t\t\tself.gatherDatatableSettings(qip, 'Show_Document_Classes');\r\n\t\t\tself.query(qvalue, self.datatable);\r\n\t\t}\r\n\t\telse self.query(qvalue);\r\n\t})\r\n\r\n\tvar ebut = document.createElement(\"button\");\r\n\tebut.appendChild(document.createTextNode(\"Show All Schema Elements\"));\r\n\tebut.setAttribute(\"class\", \"terminus-control-button terminus-q-btn\");\r\n\tvar self = this;\r\n\tebut.addEventListener(\"click\", function(){\r\n\t\tself.ui.clearMessages();\r\n\t\tUTILS.deleteStylizedEditor(self.ui, qip);\r\n\t\tvar qval = self.wquery.getElementMetaDataQuery(null, self.datatable.pageLength, self.datatable.start);\r\n\t\tqip.value = JSON.stringify(qval);\r\n\t\tUTILS.stylizeEditor(self.ui, qip, 'query', 'javascript');\r\n\t\tif(self.ui.pluginAvailable(\"datatables\")){\r\n\t\t\tself.gatherDatatableSettings(qip, 'Show_All_Schema_Elements');\r\n\t\t\tself.query(qval, self.datatable);\r\n\t\t}\r\n\t\telse self.query(qval);\r\n\t})\r\n\tvar dbut = document.createElement(\"button\");\r\n\tdbut.appendChild(document.createTextNode(\"Show All Documents\"));\r\n\tdbut.setAttribute(\"class\", \"terminus-control-button terminus-q-btn\");\r\n\tdbut.addEventListener(\"click\", function(){\r\n\t\tself.ui.clearMessages();\r\n\t\tUTILS.deleteStylizedEditor(self.ui, qip);\r\n\t\tvar qvalue = self.wquery.getAllDocumentQuery(null, self.datatable.pageLength, self.datatable.start);\r\n\t\tqip.value = JSON.stringify(qvalue);\r\n\t\tUTILS.stylizeEditor(self.ui, qip, 'query', 'javascript');\r\n\t\tif(self.ui.pluginAvailable(\"datatables\")){\r\n\t\t\tself.gatherDatatableSettings(qip, 'Show_All_Documents');\r\n\t\t\tself.query(qvalue, self.datatable);\r\n\t\t}\r\n\t\telse self.query(qvalue);\r\n\t})\r\n\tvar pbut = document.createElement(\"button\");\r\n\tpbut.appendChild(document.createTextNode(\"Show All Data\"));\r\n\tpbut.setAttribute(\"class\", \"terminus-control-button terminus-q-btn\");\r\n\tpbut.addEventListener(\"click\", function(){\r\n\t\tself.ui.clearMessages();\r\n\t\tUTILS.deleteStylizedEditor(self.ui, qip);\r\n\t\tvar qvalue = self.wquery.getEverythingQuery(null, self.datatable.pageLength, self.datatable.start);\r\n\t\tqip.value = JSON.stringify(qvalue);\r\n\t\tUTILS.stylizeEditor(self.ui, qip, 'query', 'javascript');\r\n\t\tif(self.ui.pluginAvailable(\"datatables\")){\r\n\t\t\tself.gatherDatatableSettings(qip, 'Show_All_Data');\r\n\t\t\tself.query(qvalue, self.datatable);\r\n\t\t}\r\n\t\telse self.query(qvalue);\r\n\t})\r\n\r\n\tvar prbut = document.createElement(\"button\");\r\n\tprbut.appendChild(document.createTextNode(\"Show All Properties\"));\r\n\tprbut.setAttribute(\"class\", \"terminus-control-button terminus-q-btn\");\r\n\tprbut.addEventListener(\"click\", function(){\r\n\t\tself.ui.clearMessages();\r\n\t\tUTILS.deleteStylizedEditor(self.ui, qip);\r\n\t\tvar qvalue = self.wquery.getPropertyListQuery(null, self.datatable.pageLength, self.datatable.start);\r\n\t\tqip.value = JSON.stringify(qvalue);\r\n\t\tUTILS.stylizeEditor(self.ui, qip, 'query', 'javascript');\r\n\t\tif(self.ui.pluginAvailable(\"datatables\")){\r\n\t\t\tself.gatherDatatableSettings(qip, 'Show_All_Properties');\r\n\t\t\tself.query(qvalue, self.datatable);\r\n\t\t}\r\n\t\telse self.query(qvalue);\r\n\t})\r\n\r\n\t/* grouping data queries */\r\n\tvar qdGroup = this.qGroupQueries(qrow, 'Data Queries', '');\r\n\r\n\tvar termcc = new TerminusClassChooser(this.ui);\r\n\ttermcc.empty_choice = \"Show data of type\";\r\n\tvar self = this;\r\n\ttermcc.change = function(new_class){\r\n\t\tself.ui.clearMessages();\r\n\t\tif(new_class){\r\n\t\t\tUTILS.deleteStylizedEditor(self.ui, qip);\r\n\t\t\tvar qvalue = self.wquery.getDataOfChosenClassQuery(new_class, self.datatable.pageLength, self.datatable.start);\r\n\t\t\tqip.value = JSON.stringify(qvalue);\r\n\t\t\tUTILS.stylizeEditor(self.ui, qip, 'query', 'javascript');\r\n\t\t\tif(self.ui.pluginAvailable(\"datatables\")){\r\n\t\t\t\tself.gatherDatatableSettings(qip, 'Show_Data_Class');\r\n\t\t\t\tself.datatable.chosenValue = new_class; // set chosen val from drop down\r\n\t\t\t\tself.query(qvalue, self.datatable);\r\n\t\t\t}\r\n\t\t\telse self.query(qvalue);\r\n\t\t}\r\n\t}\r\n\tvar tcdom = termcc.getAsDOM('terminus-query-select');\r\n\r\n\tvar termpc = new TerminusPropertyChooser(this.ui);\r\n\ttermpc.empty_choice = \"Show property data\";\r\n\tvar self = this;\r\n\ttermpc.change = function(new_property){\r\n\t\tif(new_property){\r\n\t\t\tUTILS.deleteStylizedEditor(self.ui, qip);\r\n\t\t\tvar qvalue = self.wquery.getDataOfChosenPropertyQuery(new_property, self.datatable.pageLength, self.datatable.start);\r\n\t\t\tqip.value = JSON.stringify(qvalue);\r\n\t\t\tUTILS.stylizeEditor(self.ui, qip, 'query', 'javascript');\r\n\t\t\tif(self.ui.pluginAvailable(\"datatables\")){\r\n\t\t\t\tself.gatherDatatableSettings(qip, 'Show_Property_Class');\r\n\t\t\t\tself.datatable.chosenValue = new_property; // set chosen val from drop down\r\n\t\t\t\tself.query(qvalue, self.datatable);\r\n\t\t\t}\r\n\t\t\telse self.query(qvalue);\r\n\t\t}\r\n\t}\r\n\r\n\t/* grouping document queries */\r\n\tvar qdocGroup = this.qGroupQueries(qrow, 'Document Queries', '');\r\n\r\n\tvar pdom = termpc.getAsDOM();\r\n\r\n\tvar docch = new TerminusDocumentChooser(this.ui);\r\n\tdocch.change = function(val){\r\n\t\tself.ui.clearMessages();\r\n\t\tUTILS.deleteStylizedEditor(self.ui, qip);\r\n\t\tvar qvalue = self.wquery.getDocumentQuery(val, self.datatable.pageLength, self.datatable.start);\r\n\t\tqip.value = JSON.stringify(qvalue);\r\n\t\tUTILS.stylizeEditor(self.ui, qip, 'query', 'javascript');\r\n\t\tif(self.ui.pluginAvailable(\"datatables\")){\r\n\t\t\tself.gatherDatatableSettings(qip, 'Show_Document_Info_by_Id');\r\n\t\t\tself.datatable.chosenValue = val;\r\n\t\t\tself.query(qvalue, self.datatable);\r\n\t\t}\r\n\t\telse self.query(qvalue);\r\n\t}\r\n\tvar docdom = docch.getAsDOM('terminus-query-select');\r\n\r\n\tvar d2ch = new TerminusDocumentChooser(this.ui, TerminusClient.FrameHelper.unshorten(\"tcs:Document\"));\r\n\td2ch.view = \"label\";\r\n\td2ch.change = docch.change;\r\n\tvar d2dom = d2ch.getAsDOM('terminus-query-select');\r\n\tvar p = document.createElement(\"p\");\r\n\tp.appendChild(d2dom);\r\n\r\n\t/* class queries */\r\n\tvar clGroup = document.createElement('div');\r\n\tclGroup.setAttribute('class', 'terminus-hide ');\r\n\tclGroup.appendChild(ebut);\r\n\tvar br = document.createElement('BR');\r\n\tclGroup.appendChild(br);\r\n\tclGroup.appendChild(nqbut);\r\n\tvar br = document.createElement('BR');\r\n\tclGroup.appendChild(br);\r\n\tclGroup.appendChild(aqbut);\r\n\tvar br = document.createElement('BR');\r\n\tclGroup.appendChild(br);\r\n\tclGroup.appendChild(prbut);\r\n\tvar br = document.createElement('BR');\r\n\tclGroup.appendChild(br);\r\n\tqcGroup.appendChild(clGroup);\r\n\r\n\tqbox.appendChild(qexs);\r\n\r\n\t/* data queries */\r\n\tvar dtGroup = document.createElement('div');\r\n\tdtGroup.setAttribute('class', 'terminus-hide');\r\n\tdtGroup.appendChild(tcdom);\r\n\tdtGroup.appendChild(pdom);\r\n\r\n\tvar br = document.createElement('BR');\r\n\tdtGroup.appendChild(br);\r\n\tdtGroup.appendChild(pbut);\r\n\tqdGroup.appendChild(dtGroup);\r\n\r\n\r\n\t/* document queries */\r\n\tvar docGroup = document.createElement('div');\r\n\tdocGroup.setAttribute('class', 'terminus-hide');\r\n\tdocGroup.appendChild(docdom);\r\n\tdocGroup.appendChild(dbut);\r\n\tdocGroup.appendChild(p);\r\n\tqdocGroup.appendChild(docGroup);\r\n\r\n\treturn qbox;\r\n}\r\n\r\nmodule.exports=WOQLTextboxGenerator\r\n","/*\r\n * Utility Property which runs a query against the schema and presents the returned Propertyes as a drop-down / Property filter list\r\n */\r\nconst WOQLQuery = require('../query/WOQLQuery');\r\n\r\nTerminusPropertyChooser = function(ui, filter){\r\n\tthis.ui = ui;\r\n\tthis.choice = false;\r\n\tthis.filter = filter;\r\n}\r\n\r\nTerminusPropertyChooser.prototype.setRoot = function(root){\r\n\tthis.root = root;\r\n}\r\n\r\nTerminusPropertyChooser.prototype.setFilter = function(filter){\r\n\tthis.filter = filter;\r\n}\r\n\r\nTerminusPropertyChooser.prototype.change = function(cls){\r\n\talert(\"Need to specify Property chooser function (\" + cls + \")\");\r\n}\r\n\r\nTerminusPropertyChooser.prototype.getAsDOM = function(){\r\n\tvar ccdom = document.createElement(\"span\");\r\n\tccdom.setAttribute(\"Class\", \"terminus-Class-chooser\");\r\n\tvar ccsel = document.createElement(\"select\");\r\n\tccsel.setAttribute(\"Class\", \" terminus-type-select terminus-query-select\");\r\n\tvar self = this;\r\n\tccsel.addEventListener(\"change\", function(){\r\n\t\tif(this.value != this.choice){\r\n\t\t\tthis.choice = this.value;\r\n\t\t\tself.change(this.value);\r\n\t\t}\r\n\t});\r\n\tccdom.appendChild(ccsel);\r\n\tvar wq = new WOQLQuery(this.ui.client, false, this.ui);\r\n\tvar woql = wq.getPropertyListQuery(this.filter);\r\n\tvar self = this;\r\n\twq.execute(woql)\r\n\t.then(function(response){\r\n\t\tvar opts = self.getResultsAsOptions(response);\r\n\t\tfor(var i = 0; i<opts.length; i++){\r\n\t\t\tccsel.appendChild(opts[i]);\r\n\t\t}\r\n\t});\r\n\treturn ccdom;\r\n}\r\n\r\nTerminusPropertyChooser.prototype.getResultsAsOptions = function(clist){\r\n\tvar choices = [];\r\n\tif(this.empty_choice){\r\n\t\tvar opt1 = document.createElement(\"option\");\r\n\t\topt1.setAttribute(\"Class\", \"terminus-class-choice terminus-empty-choice\");\r\n\t\topt1.value = \"\";\r\n\t\topt1.appendChild(document.createTextNode(this.empty_choice));\r\n\t\tchoices.push(opt1);\r\n\t}\r\n\tif(clist.bindings){\r\n\t\tvar added = [];\r\n\t\tfor(var i = 0; i<clist.bindings.length; i++){\r\n\t\t\tvar cprop = this.getVariableValueFromBinding(\"Property\", clist.bindings[i]);\r\n\t\t\tif(cprop && added.indexOf(cprop) == -1){\r\n\t\t\t\tadded.push(cprop);\r\n\t\t\t\tvar opt = document.createElement(\"option\");\r\n\t\t\t\topt.setAttribute(\"Class\", \"terminus-class-choice\");\r\n\t\t\t\topt.value = cprop;\r\n\t\t\t\tvar lab = this.getVariableValueFromBinding(\"Label\", clist.bindings[i]);\r\n\t\t\t\tif(!lab || lab == \"unknown\"){\r\n\t\t\t\t\tlab = TerminusClient.FrameHelper.labelFromURL(clist.bindings[i].Property);\r\n\t\t\t\t}\r\n\t\t\t\tif(lab[\"@value\"]) lab = lab[\"@value\"];\r\n\t\t\t\topt.appendChild(document.createTextNode(lab));\r\n\t\t\t\tchoices.push(opt);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn choices;\r\n}\r\n\r\nTerminusPropertyChooser.prototype.getVariableValueFromBinding = function(varname, bind){\r\n\tfor(var key in bind){\r\n\t\tvar skey = key.substring(key.lastIndexOf(\"/\")+1);\r\n\t\tif(skey == varname){\r\n\t\t\treturn bind[key];\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\n\r\nmodule.exports=TerminusPropertyChooser\r\n","const WOQLQuery = require('./WOQLQuery');\r\nconst WOQLTimePicker = require('./WOQLTimePicker');\r\n\r\nfunction WOQLGraphBrowserGenerator(tq, qman, ui){\r\n\tthis.query = tq;\r\n\tthis.wquery = qman.wquery;\r\n\t//this.filter = new WOQLQueryFilter(this);\r\n\tthis.slider = new WOQLTimePicker();\r\n}\r\n\r\nWOQLGraphBrowserGenerator.prototype.getAsDOM = function(q){\r\n\tvar qbox = document.createElement(\"div\");\r\n\tqbox.setAttribute(\"class\", \"terminus-query-textbox-input\");\r\n\tqbox.appendChild(document.createTextNode(\"afsdfa\"));\r\n\tqbox.appendChild(this.slider.getSliderDOM());\r\n\treturn qbox;\r\n}\r\n\r\n\r\nfunction DCOGBrowser(controller, model, config){\r\n\tthis.myowner = controller;\r\n\tthis.model = model;\r\n\tthis.config = config;\r\n\tthis.default_viewport = (config && config.view ? config.view : \"graph\");\r\n\tthis.current_viewport = false;\r\n\r\n\t//internal state\r\n\tthis.viewports = {};\r\n\tthis.viewportDOMs = {};\r\n\tthis.browserid = randomString(8);\r\n\tthis.query_timeslice = false;\r\n\tthis.current_result = false;\r\n\tthis.focus_node = false;\r\n\tthis.show_filter = false;\r\n\t//this.relationships = model.mgraphs['main'].elements.relationships;\r\n\t//this.entities = model.mgraphs['main'].elements.entities;\r\n\t\t\r\n\t//this.setUpIPGSpecials();\r\n\t\r\n\tthis.entity_count = false;\r\n\r\n\tthis.config.default_display = {\r\n\t\ticon: \"fas fa-question\",\r\n\t\ticon_unicode: \"\\uf128\",\r\n\t\tcolor: [255,125,125],\r\n\t\tforward: \"Unknown\",\r\n\t\tbackward: \"Unknown\",\r\n\t\ttext: \"Unknown\"\r\n\t};\r\n}\r\n\r\n\r\nDCOGBrowser.prototype.init = function(){\r\n\tthis.filter = new DCOGQueryFilter(this, this.config, this.model);\r\n\tthis.slider = new DCOGTimePicker(this, this.config);\r\n\t//this.viewports['graph'] = new DCOGGVis(this, this.config);\r\n\t//this.viewports['table'] = new DCOGTable(this, this.config);\r\n\t//this.viewports['map'] = new DCOGMap(this, this.config);\r\n\t//this.viewports['api'] = new DCOGAPIView(this, this.config);\r\n\t//this.viewports['timeline'] = new DCOGTimeline(this, this.config);\r\n};\r\n\r\nDCOGBrowser.prototype.getViewportAsDOM = function(){\r\n\tvar vpdom = document.createElement(\"div\");\r\n\tvpdom.setAttribute(\"class\", \"dcog-viewport\");\r\n\tfor(var k in this.viewports){\r\n\t\tif(typeof this.viewportDOMs[k] == \"undefined\"){\r\n\t\t\tthis.viewportDOMs[k] = this.viewports[k].getAsDOM();\r\n\t\t}\r\n\t\tvpdom.appendChild(this.viewportDOMs[k]);\r\n\t}\r\n\treturn vpdom;\r\n}\r\n\r\nDCOGBrowser.prototype.newQuery = function(query, success, error){\r\n\tquery = (query ? query : this.getQuery());\r\n\tvar self = this;\r\n\tvar busy = this.setBusy(\"Fetching Results from Data Chemist Server\");\r\n\tvar handle = function(data){\r\n\t\tself.clearBusy(busy);\r\n\t\tself.current_result = new DCOGQueryResult(data, query);\r\n\t\tif(self.current_result.containsData()){\r\n\t\t\tself.setViewportData(self.current_result);\r\n\t\t\tif(self.focus_node){\r\n\t\t\t\tvar node = self.current_result.getNodeOrFringe(query.focus_node);\r\n\t\t\t}\r\n\t\t\telse if(query.from_node){\r\n\t\t\t\tvar node = self.current_result.getNodeOrFringe(query.from_node);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tself.entity_count = data.nodeCount;\r\n\t\t\t\tself.myowner.fillInfoBoxes();\r\n\t\t\t}\r\n\t\t\tif(node){\r\n\t\t\t\tself.nodeSelected(node);\r\n\t\t\t}\r\n\t\t\tself.rebuildController();\t\t\t\r\n\t\t}\r\n\t\telse {\r\n\t\t\tself.tellUser(\"No results returned\", \"warning\");\r\n\t\t}\r\n\t\tif(typeof success == \"function\") {\r\n\t\t\tsuccess(self.current_result);\r\n\t\t}\r\n\t};\r\n\tvar ehandle = function(a){\r\n\t\tvar msg = {title: \"Results Overload\", body: \"Your query was terminated because it would have returned too many records - please reduce the depth of your search or add extra constraints and try again\"};\r\n\t\tself.tellUser(msg, \"error\");\r\n\t\tself.clearBusy(busy);\r\n\t}\r\n\tthis.untell();\r\n\tthis.model.client.query(query, handle, ehandle);\r\n}\r\n\r\nDCOGBrowser.prototype.moreResults = function(nfocus, success){\r\n\tvar busy = this.setBusy(\"Fetching Results from Data Chemist Server\");\r\n\tvar ehandle = function(a){\r\n\t\tvar msg = {title: \"Results Overload\", body: \"Your query was terminated because it would have returned too many records - please reduce the depth of your search or add extra constraints and try again\"};\r\n\t\tself.tellUser(msg, \"error\");\r\n\t\tself.clearBusy(busy);\r\n\t}\r\n\tthis.focus_node = nfocus;\r\n\tvar self = this;\r\n\tvar handle = function(data){\r\n\t\tself.clearBusy(busy);\r\n\t\tself.current_result.addMoreResults(data, self.getQuery());\r\n\t\tself.updateViewportData(self.current_result);\r\n\t\tself.rebuildController();\r\n\t\tif(typeof success == \"function\"){\r\n\t\t\tsuccess(self.current_result);\r\n\t\t}\r\n\t};\r\n\tthis.untell();\r\n\tthis.model.client.query(this.getQuery(), handle, ehandle);\r\n}\r\n\r\nDCOGBrowser.prototype.setBusy = function(msg){\r\n\tvar busy = showBusyOverlay(this.myowner.insert_patterns.browser, msg);\r\n\tthis.busy = busy;\r\n\treturn busy;\r\n}\r\n\r\nDCOGBrowser.prototype.getQuery = function(dqr){\r\n\tvar qstruct = {};\r\n\tif(this.focus_node){\r\n\t\tqstruct.focus_node = this.focus_node;\r\n\t}\r\n\telse if(this.from_node && this.to_node){\r\n\t\tqstruct.source_node = this.from_node;\r\n\t\tqstruct.target_node = this.to_node;\r\n\t}\r\n\tif(this.filter && this.filter.current_relationships){\r\n\t\tqstruct.relationships = this.filter.current_relationships;\r\n\t}\r\n\tif(this.filter && this.filter.current_depth){\r\n\t\tqstruct.max_path_length = this.filter.current_depth;\r\n\t}\r\n\tif(this.filter && this.filter.current_threshold && this.filter.current_threshold > 0 && qstruct.relationships.indexOf(\"share\") != -1){\r\n\t\tqstruct.filters = {shareholding_threshold: this.filter.current_threshold};\r\n\t}\r\n\tif(this.slider && this.slider.server_side && this.slider.timeslice){\r\n\t\tthis.query_timeslice = this.slider.timeslice;\r\n\t}\r\n\telse {\r\n\t\tthis.query_timeslice = false;\r\n\t}\r\n\tif(this.query_timeslice){\r\n\t\tqstruct.date = this.query_timeslice;\r\n\t}\r\n\treturn qstruct;\r\n}\r\n\r\nDCOGBrowser.prototype.setView = function(which){\r\n\tif(which != this.current_viewport){\r\n\t\tthis.current_viewport = which;\r\n\t\tfor(var k in this.viewports){\r\n\t\t\tif(k != this.current_viewport) {\r\n\t\t\t\tif(typeof this.viewports[k][\"hibernate\"] == \"function\"){\r\n\t\t\t\t\t//this.viewports[k].hiberate();\r\n\t\t\t\t}\r\n\t\t\t\tjQuery(this.viewportDOMs[k]).hide();\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tif(typeof this.viewports[k][\"wake\"] == \"function\"){\r\n\t\t\t\t\tthis.viewports[k].wake();\r\n\t\t\t\t}\r\n\t\t\t\tjQuery(this.viewportDOMs[k]).show();\r\n\t\t\t}\r\n\t\t\tthis.rebuildController();\r\n\t\t}\r\n\t}\r\n}\r\n\r\n\r\n/**\r\n * @summary Initialises the viewports by firing off a starter query and loading it into the contained viewports\r\n */\r\nDCOGBrowser.prototype.initData = function(which){\r\n\tthis.current_viewport = (which ? which : this.default_viewport);\r\n\tvar self = this;\r\n\tvar setInitNodes = function(dqr){\r\n\t\tif(self.focus_node){\r\n\t\t\tvar node = dqr.getNodeOrFringe(self.focus_node);\r\n\t\t\tif(node && node.groupID){\r\n\t\t\t\tself.nodeSelected(node);\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\t\r\n\t\t}\r\n\t\tfor(var k in self.viewports){\r\n\t\t\tif(typeof self.viewports[k].initDOM == \"function\"){\r\n\t\t\t\tself.viewports[k].initDOM(self.viewportDOMs[k]);\r\n\t\t\t}\r\n\t\t\tif(k != self.current_viewport) jQuery(self.viewportDOMs[k]).hide();\r\n\t\t\telse if(typeof self.viewportDOMs[k].wake == \"function\") self.viewportDOMs[k].wake()\r\n\t\t}\r\n\t}\r\n\tvar qstr = this.getQuery();\r\n\tif(qstr){\r\n\t\tthis.newQuery(qstr, setInitNodes);\r\n\t}\r\n\telse {\r\n\t\talert(\"No query string - must set filter and focus node before initialisation\");\r\n\t}\r\n}\r\n\r\nDCOGBrowser.prototype.setViewportData = function(dqr){\r\n\tfor(var k in this.viewports){\r\n\t\tthis.viewports[k].setData(dqr, k == this.current_viewport);\r\n\t}\r\n}\r\n\r\nDCOGBrowser.prototype.updateViewportData = function(dqr){\r\n\tfor(var k in this.viewports){\r\n\t\tthis.viewports[k].updateData(dqr, k == this.current_viewport);\r\n\t}\r\n}\r\nDCOGBrowser.prototype.setViewportFilter = function(dqr){\r\n\tfor(var k in this.viewports){\r\n\t\tif(typeof this.viewports[k].setFilter == \"function\"){\r\n\t\t\tthis.viewports[k].setFilter(dqr, k == this.current_viewport);\r\n\t\t}\r\n\t\telse {\r\n\t\t\talert(k + \" does not implement set filter browser function\");\r\n\t\t}\r\n\t}\r\n}\r\n\r\nDCOGBrowser.prototype.nodeSelected = function(node){\r\n\tif(this.focus_node != node.id){\r\n\t\tthis.focus_node = node.id;\r\n\t}\r\n\tvar sections = this.getNodeInfoSections(node);\r\n\tthis.myowner.nodeSelected(node, sections);\r\n}\r\n\r\nDCOGBrowser.prototype.getNodeInfoSections = function(node){\r\n\treturn [];\r\n}\r\n\r\nDCOGBrowser.prototype.followNode = function(node, success){\r\n\tthis.moreResults(node.id, success);\r\n}\r\n\r\nDCOGBrowser.prototype.setFocusNode = function(id){\r\n\tvar self = this;\r\n\tthis.focus_node = id;\r\n\tthis.newQuery(this.getQuery());\r\n}\r\n\r\nDCOGBrowser.prototype.setPathSearch = function(node_from, node_to){\r\n\tthis.focus_node = false;\r\n\tthis.from_node = node_from;\r\n\tthis.to_node = node_to;\r\n\tthis.newQuery(this.getQuery());\r\n}\r\n\r\nDCOGBrowser.prototype.changeTimeSlice = function(val, valto, force){\r\n\tif(this.current_result){\r\n\t\tif(!this.current_result.isTemporalSuperset(this.query_timeslice, val, valto)){\r\n\t\t\tthis.current_result.setQueryTimeslice(val, valto);\r\n\t\t\tthis.query_timeslice = this.current_result.getTimeslice()\r\n\t\t\tthis.newQuery(this.getQuery());\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.current_result.setFilterTimeslice(val, valto);\r\n\t\t\tthis.setViewportFilter(this.current_result);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nDCOGBrowser.prototype.getControllerAsDOM = function(){\r\n\tvar cdom = document.createElement(\"div\");\r\n\tcdom.setAttribute(\"class\", \"dcog-browser-controller-wrapper\");\r\n\tcdom.appendChild(this.getControllerViewButtonsAsDOM());\r\n\tcdom.appendChild(this.slider.getSliderDOM());\r\n\tthis.toolboxDOM = this.getUserToolboxDOM();\r\n\tcdom.appendChild(this.toolboxDOM);\r\n\tthis.rebuildController();\r\n\tcdom.appendChild(this.filterDOM);\r\n\tcdom.appendChild(this.legendDOM);\r\n\treturn cdom;\r\n}\r\n\r\nDCOGBrowser.prototype.getControllerFilterAsDOM = function(){\r\n\tif(this.filterDOM) {\r\n\t\tjQuery(this.filterDOM).empty();\r\n\t}\r\n\telse {\r\n\t\tvar cdom = document.createElement(\"div\");\r\n\t\tcdom.setAttribute(\"class\", \"dcog-browser-controller-filter\");\r\n\t\tthis.filterDOM = cdom;\r\n\t}\r\n\tvar fdom = this.filter.getRelationshipFilterAsDOM();\r\n\tvar ndom = this.filter.getQueryParameterDOM();\r\n\tvar ipfield = this.slider.getSliderTypeDOM();\r\n\tndom.appendChild(ipfield);\r\n\tvar self = this;\r\n\tvar gobut = document.createElement(\"button\");\r\n\tgobut.setAttribute(\"class\", \"dcog-filter-submit dcog-dashboard-button\");\r\n\tgobut.appendChild(document.createTextNode(\"Go\"));\r\n\tgobut.addEventListener(\"click\", function(){\r\n\t\tself.newQuery();\r\n\t});\r\n\t\r\n\tthis.filterDOM.appendChild(fdom);\r\n\tthis.filterDOM.appendChild(ndom);\r\n\tndom.appendChild(gobut);\r\n\t\r\n\tif(!this.show_filter){\r\n\t\tjQuery(this.filterDOM).hide();\r\n\t}\r\n\treturn this.filterDOM;\r\n}\r\n\r\nDCOGBrowser.prototype.toggleFilterVisibility = function(){\r\n\tif(this.show_filter){\r\n\t\tjQuery(this.filterDOM).hide();\r\n\t}\r\n\telse {\r\n\t\tjQuery(this.filterDOM).show();\r\n\t}\r\n\tthis.show_filter = !this.show_filter;\r\n}\r\n\r\n\r\nDCOGBrowser.prototype.rebuildController = function(){\r\n\tthis.getControllerFilterAsDOM();\r\n\tthis.legendDOM = this.getLegendAsDOM();\r\n}\r\n\r\nDCOGBrowser.prototype.untell = function(){\r\n\tjQuery(this.userMessageDOM).empty(); \r\n}\r\n\r\n\r\nDCOGBrowser.prototype.tellUser = function(msg, type){\r\n\tif(typeof msg == \"undefined\") {\r\n\t\tjQuery(this.userMessageDOM).empty(); \r\n\t}\r\n\telse {\r\n\t\ttype = (type ? type : \"info\");\r\n\t\tvar msgdom = document.createElement(\"span\");\r\n\t\tmsgdom.setAttribute(\"class\", \"dcog-browser-message dcog-message-\" + type);\r\n\t\tif(typeof msg == \"object\"){\r\n\t\t\tmsg = \"<b>\" + msg.title + \"</b> \" + msg.body;\r\n\t\t}\r\n\t\tmsgdom.innerHTML = msg;\r\n\t\tjQuery(this.userMessageDOM).html(msgdom);\r\n\t}\r\n}\r\n\r\nDCOGBrowser.prototype.clearBusy = function(busy){\r\n\tbusy = (busy ? busy : this.busy);\r\n\tif(busy){\t\r\n\t\tjQuery(busy).remove();\r\n\t}\r\n}\r\n\r\nDCOGBrowser.prototype.getUserToolboxDOM = function(){\r\n\tvar cdom = document.createElement(\"div\");\r\n\tcdom.setAttribute(\"class\", \"dcog-browser-toolbox\");\r\n\tvar msgdom = document.createElement(\"span\");\r\n\tmsgdom.setAttribute(\"class\", \"dcog-browser-message-container\");\r\n\tthis.userMessageDOM = msgdom;\r\n\tcdom.appendChild(msgdom);\r\n\tvar tdom = document.createElement(\"span\");\r\n\ttdom.setAttribute(\"class\", \"dcog-browser-tools\");\r\n\t//var dld = document.createElement(\"i\");\r\n\t//dld.setAttribute(\"class\", \"fas fa-download dcog-browser-tool-icon\");\r\n\tvar self = this;\r\n\t/*dld.addEventListener(\"click\", function(){\r\n\t\tif(typeof told == \"undefined\" || !told){\r\n\t\t\tself.tellUser(\"this is the user dialogue box - it will tell the user how to download the data\");\r\n\t\t\ttold = true;\r\n\t\t}\r\n\t\telse {\r\n\t\t\ttold = false;\r\n\t\t\tself.tellUser();\r\n\t\t}\r\n\t});*/\r\n\t//tdom.appendChild(dld);\r\n\tvar dlc = document.createElement(\"i\");\r\n\tdlc.setAttribute(\"class\", \"fas fa-cog dcog-browser-tool-icon\");\r\n\tdlc.addEventListener(\"click\", function(){\r\n\t\tself.toggleFilterVisibility();\r\n\t});\r\n\ttdom.appendChild(dlc);\r\n\tcdom.appendChild(tdom);\r\n\treturn cdom;\r\n}\r\n\r\nDCOGBrowser.prototype.getControllerViewButtonsAsDOM = function(){\r\n\tvar self = this;\r\n\tvar bdoms = [];\r\n\tvar cdom = document.createElement(\"div\");\r\n\tcdom.setAttribute(\"class\", \"dcog-browser-view-buttons\");\r\n\tfor(var k in this.viewports){\r\n\t\tvar bdom = document.createElement(\"button\");\r\n\t\tbdom.appendChild(document.createTextNode(k));\r\n\t\tvar i = document.createElement(\"i\");\r\n\t\tif(k == \"graph\"){\r\n\t\t\ti.setAttribute(\"class\", \"dcog-viewer-icon fas fa-code-branch\")\r\n\t\t}\r\n\t\telse if(k == \"map\"){\r\n\t\t\ti.setAttribute(\"class\", \"dcog-viewer-icon fas fa-globe\")\t\t\t\r\n\t\t}\r\n\t\telse if(k == \"table\"){\r\n\t\t\ti.setAttribute(\"class\", \"dcog-viewer-icon fas fa-list\")\t\t\t\r\n\t\t}\r\n\t\telse if(k == \"api\"){\r\n\t\t\ti.setAttribute(\"class\", \"dcog-viewer-icon fas fa-robot\")\t\t\t\r\n\t\t}\r\n\t\tbdom.appendChild(i);\r\n\t\tbdom.setAttribute(\"id\", this.browserid + k);\r\n\t\tif(k == this.current_viewport){\r\n\t\t\tbdom.setAttribute(\"class\", \"selected\");\r\n\t\t}\r\n\t\telse {\r\n\t\t\tbdom.setAttribute(\"class\", \"not-selected\");\r\n\t\t}\r\n\t\tbdom.addEventListener(\"click\", function(){\r\n\t\t\tfor(var i=0; i<bdoms.length; i++){\r\n\t\t\t\tbdoms[i].setAttribute(\"class\", \"not-selected\");\r\n\t\t\t}\r\n\t\t\tthis.setAttribute(\"class\", \"selected\");\r\n\t\t\tself.setView(this.id.substring(self.browserid.length));\r\n\t\t});\r\n\t\tbdoms.push(bdom);\r\n\t\tcdom.appendChild(bdom);\r\n\t}\r\n\treturn cdom;\t\r\n}\r\n\r\nDCOGBrowser.prototype.getLegendAsDOM = function(){\r\n\tif(this.legendDOM) {\r\n\t\tjQuery(this.legendDOM).empty();\r\n\t}\r\n\telse {\r\n\t\tthis.legendDOM = document.createElement(\"div\");\r\n\t\tthis.legendDOM.setAttribute(\"class\", \"dcog-viewport-legend\");\r\n\t}\r\n\tif(typeof this.viewports[this.current_viewport].legend == \"function\"){\r\n\t\tvar dom = this.viewports[this.current_viewport].legend();\r\n\t\tif(dom){\r\n\t\t\tthis.legendDOM.appendChild(dom);\r\n\t\t\tjQuery(this.legendDOM).show();\r\n\t\t}\r\n\t\telse {\r\n\t\t\tjQuery(this.legendDOM).hide();\r\n\t\t}\r\n\t}\r\n\treturn this.legendDOM;\r\n}\r\n\r\n/*\r\n * Display settings for shared look and field between different views - eventually to be kicked back to model \r\n */\r\n\r\nDCOGBrowser.prototype.getNodeRelativeSize = function(node){\r\n\tvar nconf = this.getNodeDisplaySettings(node);\r\n\tif(nconf.size) return nconf.size;\r\n\treturn 1;\r\n}\r\n\r\nDCOGBrowser.prototype.getLineWidth = function(node){\r\n\tvar nconf = this.getNodeDisplaySettings(node);\r\n\tif(nconf.size) return nconf.size;\r\n\treturn 4;\r\n}\r\n\r\nDCOGBrowser.prototype.getModelElementDisplaySettings = function(elt){\r\n\tif(typeof this.config.modeldisplay[elt] != \"undefined\"){\r\n\t\treturn jQuery.extend(true, {}, this.config.modeldisplay[elt]);\r\n\t}\r\n\talert(elt);\r\n\treturn jQuery.extend(true, {}, this.config.default_display);\r\n}\r\n\r\nDCOGBrowser.prototype.isBidirectional = function(edge){\r\n\tif(edge.typeID){\r\n\t\tvar conf = this.config.modeldisplay[edge.typeID];\r\n\t\tif(!conf){\r\n\t\t\t//jpr(edge);\r\n\t\t}\r\n\t\telse if(conf.forward && conf.backward){\r\n\t\t\tvar s = this.current_result.getNodeOrFringe(edge.source);\r\n\t\t\tvar t = this.current_result.getNodeOrFringe(edge.target);\r\n\t\t\tif((t && s && t.groupID && s.groupID) && (s.groupID.indexOf(\"Person\") == -1 && t.groupID.indexOf(\"Person\") == -1) )\r\n\t\t\t\treturn true;\t\t\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\n\r\nDCOGBrowser.prototype.getRelationshipClass = function(nick){\r\n\treturn nick;\r\n\t//if(this.config.cmap[nick]) return this.config.cmap[nick];\r\n\t//return false;\r\n}\r\n\r\nDCOGBrowser.prototype.getGraphElementDisplaySettings = function(node){\r\n\tif(node){\r\n\t\tvar nds = this.getNodeDisplaySettings(node);\r\n\t\tif(!nds){\r\n\t\t\tnds = this.getLinkDisplaySettings(node);\r\n\t\t}\r\n\t\treturn nds;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nDCOGBrowser.prototype.getNodeDisplaySettings = function(node){\r\n\tif(typeof node.groupID != \"undefined\"){\r\n\t\treturn this.getModelElementDisplaySettings(node.groupID);\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nDCOGBrowser.prototype.getLinkDisplaySettings = function(link){\r\n\tif(typeof link.typeID != \"undefined\"){\r\n\t\treturn this.getModelElementDisplaySettings(link.typeID);\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nDCOGBrowser.prototype.getElementIcon = function(elt){\r\n\tvar settings = this.getGraphElementDisplaySettings(elt);\r\n\tif(!settings) settings = this.config.default_display;\r\n\treturn settings.icon;\r\n}\r\n\r\nDCOGBrowser.prototype.getClassIcon = function(cls){\r\n\tvar settings = this.getModelElementDisplaySettings(cls);\r\n\tif(!settings) settings = this.config.default_display;\r\n\treturn settings.icon;\r\n}\r\n\r\nDCOGBrowser.prototype.getElementIconUnicode = function(elt){\r\n\tvar settings = this.getGraphElementDisplaySettings(elt);\r\n\tif(!settings) settings = this.config.default_display;\r\n\treturn settings.icon_unicode;\r\n}\r\n\r\nDCOGBrowser.prototype.getElementColour = function(elt){\r\n\tvar settings = this.getGraphElementDisplaySettings(elt);\r\n\tif(!settings) settings = this.config.default_display;\r\n\treturn jQuery.extend(true, [], settings.color);\r\n}\r\n\r\n\r\nDCOGBrowser.prototype.setUpIPGSpecials = function(){\r\n\tthis.config.modeldisplay = {};\r\n\tvar reldisptypes = [\r\n\t\t{\r\n\t\t\ticon: \"fas fa-caret-right\",\r\n\t\t\ticon_unicode: \"\\uf0d6\",\r\n\t\t\tsize: 6,\r\n\t\t\tcolor: [125,125,255],\r\n\t\t},\r\n\t\t{\r\n\t\t\ticon: \"fab fa-creative-commons-by\",\r\n\t\t\ticon_unicode: \"\\uf4e7\",\r\n\t\t\tsize: 5,\r\n\t\t\tcolor: [255,125,125],\r\n\t\t},\r\n\t\t{\r\n\t\t\ticon: \"fas fa-handshake\",\r\n\t\t\tcolor: [125,255,125],\r\n\t\t\tsize: 7,\r\n\t\t\ticon_unicode: \"\\uf2b5\",\r\n\t\t},\r\n\t\t{\r\n\t\t\ticon: \"fas fa-creative-commons-nc-eu\",\r\n\t\t\ticon_unicode: \"\\uf4e9\",\r\n\t\t\tsize: 4,\r\n\t\t\tcolor: [50,50,50],\r\n\t\t},\r\n\t\t{\r\n\t\t\ticon: \"fas fa-sitemap\",\r\n\t\t\ticon_unicode: \"\\uf0e8\",\r\n\t\t\tsize: 8,\r\n\t\t\tcolor: [125,255,255],\r\n\t\t}\r\n\t];\r\n\tvar entdisptypes = [ \r\n\t\t {\r\n\t\t    \ticon: \"fas fa-users\",\r\n\t\t\t\tsize: 1,\r\n\t\t\t\ticon_unicode: \"\\uf0c0\",\r\n\t\t\t\tcolor: [255,125,125],\r\n\t\t\t},\r\n\t\t{\r\n\t\t\ticon: \"fas fa-industry\",\r\n\t\t\tsize: 1.5,\r\n\t\t\ticon_unicode: \"\\uf275\",\r\n\t\t\tcolor: [100,125,255],\r\n\t    },\r\n\t\t{\r\n\t\t\ticon: \"fas fa-user\",\r\n\t\t\tsize: 0.9,\r\n\t\t\ticon_unicode: \"\\uf007\",\r\n\t\t\tcolor: [125,255,125],\r\n\t\t},\r\n\t   {\r\n\t\t\ticon: \"fas fa-building\",\r\n\t\t\ticon_unicode: \"\\uf1ad\",\r\n\t\t\tsize: 1.4,\r\n\t\t\tcolor: [125,125,225],\r\n\t\t},\r\n\t\t{\r\n\t\t\ticon: \"fas fa-briefcase\",\r\n\t\t\ticon_unicode: \"\\uf0b1\",\r\n\t\t\tcolor: [125,125,200],\r\n\t\t\tsize: 1.2,\r\n\t\t},\r\n\t\t{\r\n\t\t\ticon: \"fas fa-user-astronaut\",\r\n\t\t\ticon_unicode: \"\\uf4fb\",\r\n\t\t\tsize: 0.9,\r\n\t\t\tcolor: [125,220,125],\r\n\t\t}\r\n\t];\r\n\t\r\n\tvar i = 0;\r\n\tfor(var rid in this.relationships){\r\n\t\tif(i >= reldisptypes.length) i = 0;\r\n\t\tvar disptype = reldisptypes[i];\r\n\t\tdisptype['forward'] = this.relationships[rid].label;\r\n\t\tthis.config.modeldisplay[rid] = disptype;\r\n\t\ti++;\r\n\t}\r\n\ti = 0;\r\n\tfor(var eid in this.entities){\r\n\t\tif(i >= reldisptypes.length) i = 0;\r\n\t\tvar disptype = entdisptypes[i];\r\n\t\tdisptype['text'] = this.entities[eid].label;\r\n\t\tthis.config.modeldisplay[eid] = disptype;\r\n\t\ti++;\r\n\t}\r\n}\r\n\r\nmodule.exports=WOQLGraphBrowserGenerator\r\n\r\n","WOQLTimePicker = function(config){\r\n\tthis.type = (config && config.slidertype ? config.slidertype : \"range\");\r\n\tthis.timeslice = false;\r\n\tvar defch = function(from, to, ss){\r\n\t\talert(\"changed to: (from) \" + from + \" ... (to) \" + to + \" (\" + ss + \")\");\r\n\t};\r\n\tthis.change = config && config.change ? config.change : defch;  \r\n\tthis.years = (config && config.years ? config.years : 20);\r\n\tthis.server_side = false;\r\n}\r\n\r\nWOQLTimePicker.prototype.toggleServerSideFiltering = function(val){\r\n\tthis.server_side = !this.server_side;\r\n}\r\n\r\nWOQLTimePicker.prototype.getSliderParameters = function(val){\r\n\tstart = 0;\r\n\tend = this.years;\r\n\tvar self = this;\r\n\tvar pointInit = {\r\n\t\t\tmin: start, \r\n\t\t\tmax: end, \r\n\t\t\tvalue: val,\r\n\t\t\tslide: function(event, ui){\r\n\t\t\t\tvar tt = self.tickToTime(ui.value);\r\n\t\t\t\tself.changeTimeSlice(tt);\r\n\t\t\t}\r\n\t}\r\n\tvar rangeInit = {\r\n\t\t\trange: true,\r\n\t\t\tmin: start, \r\n\t\t\tmax: end, \r\n\t\t\tvalues: val,\r\n\t\t\tslide: function(event, ui){\r\n\t\t\t\tself.changeTimeSlice(self.tickToTime(ui.values[0]), self.tickToTime(ui.values[1]));\r\n\t\t\t}\r\n\t}\r\n\tvar sconfig = (this.type == \"range\" ? rangeInit : pointInit);\r\n\treturn sconfig;\r\n}\r\n\r\nWOQLTimePicker.prototype.changeTimeSlice = function(val, val2, noshow){\r\n\tif(this.type == \"range\"){\r\n\t\tthis.timeslice = {};\r\n\t\tthis.timeslice.from = val;\r\n\t\tthis.timeslice.to = val2;\r\n\t\tthis.change(val, val2, this.server_side);\r\n\t}\r\n\telse {\r\n\t\tthis.timeslice = val;\r\n\t\tthis.change(val, false, this.server_side);\r\n\t}\r\n\tif(!noshow){\t\r\n\t\tthis.showCurrentPick();\r\n\t}\r\n}\r\n\r\nWOQLTimePicker.prototype.tickToTime = function(ticknum){\r\n\tif(ticknum == 0){\r\n\t\tvar nval = 0;\r\n\t}\r\n\telse {\r\n\t\tvar year = 31622400 ;\r\n\t\tvar seconds_ago = year * (this.years - ticknum);\r\n\t\tvar now = new Date().getTime()/1000;\r\n\t\tvar nval = now - seconds_ago;\r\n\t}\r\n\treturn nval;\r\n}\r\n\r\n\r\nWOQLTimePicker.prototype.timeToTick = function(timeval){\r\n\tif(timeval){\r\n\t\tvar y = (new Date(timeval * 1000)).getFullYear();\r\n\t\tvar thisy = (new Date()).getFullYear();\r\n\t\treturn this.years - (thisy -y);\r\n\t}\r\n\treturn 0;\r\n}\r\n\r\nWOQLTimePicker.prototype.changeSliderType = function(ntype){\r\n\tvar val, val2;\r\n\tif(this.type == \"point\" && ntype == \"range\"){\r\n\t\tif(this.timeslice){\r\n\t\t\tval = this.timeslice\r\n\t\t\tval2 = this.timeslice;\r\n\t\t}\r\n\t}\r\n\telse if(this.type == \"range\" && ntype == \"point\"){\r\n\t\tif(this.timeslice){\r\n\t\t\tif(this.timeslice.from == 0 && this.timeslice.to == 0) val = false;\r\n\t\t\telse if(this.timeslice.from == 0) val = this.timeslice.to;\r\n\t\t\telse if(this.timeslice.to == 0) val = this.timeslice.from;\r\n\t\t\telse val = (this.timeslice.from + this.timeslice.to) / 2;\r\n\t\t\tval2 = false;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tval = 0;\r\n\t\t}\r\n\t\t\r\n\t}\r\n\tthis.type = ntype;\r\n\tthis.changeTimeSlice(val, val2, true);\r\n\tthis.updateSliderDOM();\r\n}\r\n\r\nWOQLTimePicker.prototype.getSliderTypeDOM = function(){\r\n\tvar dcd = document.createElement(\"span\");\r\n\tdcd.setAttribute(\"class\", \"terminus-parameter\");\r\n\tvar lab = document.createElement(\"label\");\r\n\tlab.appendChild(document.createTextNode(\"Dates\"));\r\n\tdcd.appendChild(lab);\r\n\tvar self = this;\r\n\tvar sel = document.createElement(\"select\");\r\n\tvar opt = document.createElement(\"option\");\r\n\topt.value = \"\";\r\n\topt.appendChild(document.createTextNode(\"None\"));\r\n\tif(this.type == \"\"){\r\n\t\topt.setAttribute(\"selected\", \"selected\");\r\n\t}\r\n\tsel.appendChild(opt);\r\n\topt = document.createElement(\"option\");\r\n\topt.value = \"point\";\r\n\topt.appendChild(document.createTextNode(\"Point\"));\r\n\tif(this.type == \"point\"){\r\n\t\topt.setAttribute(\"selected\", \"selected\");\r\n\t}\r\n\tsel.appendChild(opt);\r\n\topt = document.createElement(\"option\");\r\n\topt.value = \"range\";\r\n\topt.appendChild(document.createTextNode(\"Range\"));\r\n\tif(this.type == \"range\"){\r\n\t\topt.setAttribute(\"selected\", \"selected\");\r\n\t}\r\n\tsel.appendChild(opt);\r\n\tvar self = this;\r\n\tsel.addEventListener(\"change\", function(){\r\n\t\tif(this.value != self.type){\r\n\t\t\tself.changeSliderType(this.value);\r\n\t\t}\r\n\t});\r\n\tdcd.appendChild(sel);\r\n\t\r\n\tvar cb = document.createElement(\"input\");\r\n\tcb.setAttribute(\"type\", \"checkbox\");\r\n\tvar elid = this.browserid + \"-ssp\";\r\n\tif(this.server_side){\r\n\t\tcb.setAttribute(\"checked\", true);\r\n\t}\r\n\tvar self = this;\r\n\tcb.addEventListener(\"change\", function(){\r\n\t\tself.toggleServerSideFiltering();\r\n\t});\r\n\tvar lb = document.createElement(\"label\");\r\n\tlb.setAttribute(\"for\", elid);\r\n\tlb.appendChild(document.createTextNode(\"Server Side\"));\r\n\tdcd.appendChild(lb);\r\n\tdcd.appendChild(cb);\r\n\treturn dcd;\r\n\t\r\n}\r\n\r\nWOQLTimePicker.prototype.updateSliderDOM = function(){\r\n\tthis.slideDOM = this.getSliderDOM();\r\n}\r\n\r\nWOQLTimePicker.prototype.getSliderDOM = function(start, end){\r\n\tif(this.slideDOM){\r\n\t\tjQuery(this.slideDOM).empty();\r\n\t}\r\n\telse {\r\n\t\tthis.slideDOM = document.createElement(\"div\");\r\n\t\tthis.slideDOM.setAttribute(\"class\", \"terminus-controller-slider\");\r\n\t}\r\n\tif(this.type == \"\"){\r\n\t\tthis.changeTimeSlice(false);\r\n\t\treturn this.slideDOM;\r\n\t}\r\n\tvar TopAxisDOM = document.createElement(\"div\");\r\n\tTopAxisDOM.setAttribute(\"class\", \"terminus-controller-slider-panel terminus-controller-slider-topaxis\");\r\n\tif(this.type == \"point\"){\r\n\t\tthis.curdate = document.createElement(\"span\");\r\n\t\tthis.curdate.setAttribute(\"class\", \"terminus-slider-current terminus-slider-current-date\");\r\n\t\tTopAxisDOM.appendChild(this.curdate);\r\n\t}\r\n\telse if(this.type == \"range\") {\r\n\t\tthis.cursdate = document.createElement(\"span\");\r\n\t\tthis.cursdate.setAttribute(\"class\", \"terminus-slider-current terminus-slider-current-date-start\");\r\n\t\tTopAxisDOM.appendChild(this.cursdate);\r\n\t\tthis.curedate = document.createElement(\"span\");\t\t\r\n\t\tthis.curedate.setAttribute(\"class\", \"terminus-slider-current terminus-slider-current-date-end\");\r\n\t\tTopAxisDOM.appendChild(this.curedate);\r\n\t}\r\n\tthis.slideDOM.appendChild(TopAxisDOM);\r\n\tthis.showCurrentPick();\r\n\tvar LabelDOM = document.createElement(\"span\");\r\n\tLabelDOM.setAttribute(\"class\", \"terminus-controller-slider-label terminus-controller-slider-startlabel\");\r\n\tthis.slideDOM.appendChild(LabelDOM);\r\n\tvar PayloadDOM = document.createElement(\"div\");\r\n\tPayloadDOM.setAttribute(\"class\", \"terminus-controller-slider-payload\");\r\n\tthis.slideDOM.appendChild(PayloadDOM);\r\n\tvar L2DOM = document.createElement(\"span\");\r\n\tL2DOM.setAttribute(\"class\", \"terminus-controller-slider-label terminus-controller-slider-endlabel\");\r\n\tthis.slideDOM.appendChild(L2DOM);\r\n\tL2DOM.appendChild(this.getSliderAxisDOM());\r\n\tvar sconfig = this.getSliderParameters(this.getTimesliceAsTicks());\r\n\tjQuery(PayloadDOM).slider(sconfig);\r\n\treturn this.slideDOM;\r\n}\r\n\r\nWOQLTimePicker.prototype.getTimesliceAsTicks = function(){\r\n\tif(this.timeslice){\r\n\t\tif(this.type == \"range\"){\r\n\t\t\tvtf = (this.timeslice.from ? this.timeToTick(this.timeslice.from) : 0);\r\n\t\t\tvtt = (this.timeslice.to ? this.timeToTick(this.timeslice.to) : 0);\r\n\t\t\tvar val = [vtf, vtt];\r\n\t\t}\r\n\t\telse {\r\n\t\t\tvar val = this.timeToTick(this.timeslice)\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tvar val = (this.type == \"range\" ? [0, this.years] : 0);\r\n\t}\r\n\treturn val;\r\n}\r\n\r\nWOQLTimePicker.prototype.showCurrentPick = function(){\r\n\tif(this.type == \"range\"){\r\n\t\tif(!this.timeslice.from) {\r\n\t\t\tvar nd  = new Date();\r\n\t\t\tvar fy = nd.getFullYear() - this.years;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tvar nd = new Date(this.timeslice.from * 1000);\r\n\t\t\tvar fy = nd.getFullYear(); \r\n\t\t}\r\n\t\tthis.cursdate.innerHTML = fy;\r\n\t\tthis.adjustOffset(this.cursdate, this.timeslice.from);\r\n\t\tif(!this.timeslice.to) {\r\n\t\t\tvar ty = new Date().getFullYear();\r\n\t\t}\r\n\t\telse {\r\n\t\t\tvar ty = new Date(this.timeslice.to * 1000).getFullYear(); \r\n\t\t}\r\n\t\tif(ty != fy){\r\n\t\t\tthis.curedate.innerHTML = ty;\r\n\t\t\tthis.adjustOffset(this.curedate, this.timeslice.to, true);\r\n\t\t\t//jQuery(this.curedate).show();\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.curedate.innerHTML = \"\";\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tif(this.timeslice){\r\n\t\t\tvar nd = new Date(this.timeslice * 1000);\r\n\t\t\tfy = nd.getFullYear(); \r\n\t\t}\r\n\t\telse {\r\n\t\t\tfy = \"off\";\r\n\t\t}\r\n\t\tthis.curdate.innerHTML = fy;\r\n\t\tthis.adjustOffset(this.curdate, this.timeslice);\r\n\t}\r\n}\r\n\r\nWOQLTimePicker.prototype.adjustOffset = function(dom, tval, r){\r\n\tvar tick = this.timeToTick(tval);\r\n\tvar totwidth = 50 + (this.slideDOM.offsetWidth ? this.slideDOM.offsetWidth : 0);\r\n\tvar unit = totwidth / (this.years + 1);\r\n\tvar box = -25;\r\n\tvar which = (r ? \"margin-right\" : \"margin-left\");\r\n\tif(r){\r\n\t\tif(tick){\r\n\t\t\tvar off = ((this.years - tick) * unit) + box;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tvar off = box;\r\n\t\t}\r\n\t\tdom.setAttribute(\"style\", \"margin-right: \" + off + \"px\");\r\n\t}\r\n\telse {\r\n\t\tvar off = unit * tick + box;\r\n\t\tdom.setAttribute(\"style\", \"margin-left: \" + off + \"px\");\r\n\t}\r\n}\r\n\r\nWOQLTimePicker.prototype.getSliderAxisDOM = function(){\r\n\tvar cdom = document.createElement(\"div\");\r\n\tcdom.setAttribute(\"class\", \"terminus-slider-axis-wrapper\");\r\n\tvar fy = new Date().getFullYear();\r\n\tvar sd = fy%5;\r\n\tvar vals = [];\r\n\tfor(var i = this.years; i>0; i-=5){\r\n\t\tvar val = (fy-i) - sd + 5;\r\n\t\tvals.push(val);\r\n\t}\r\n\tfor(var i = 0; i<vals.length; i++){\r\n\t\tvar ldom = document.createElement(\"label\");\r\n\t\tldom.setAttribute(\"class\", \"terminus-axis-label\");\r\n\t\tldom.innerHTML = \"<div class='terminus-tick'>|</div>\"+ vals[i];\r\n\t\tcdom.appendChild(ldom);\r\n\t}\r\n\tndom = document.createElement(\"label\");\r\n\tndom.setAttribute(\"class\", \"terminus-axis-label terminus-axis-now-label\");\r\n\tcdom.appendChild(ndom);\r\n\treturn cdom;\r\n}\r\n\r\nWOQLTimePicker.prototype.Y2Time = function(y){\r\n\treturn (new Date(y+ \"-12-31T12:00:00.000Z\").getTime() / 1000);\r\n}\r\n\r\nmodule.exports=WOQLTimePicker\r\n","function TerminusMappingViewer(ui, mode){\r\n\tthis.ui = ui;\r\n\tthis.mode = (mode ? mode : \"data\");\r\n}\r\n\r\nTerminusMappingViewer.prototype.getAsDOM = function(){\r\n\tvar scd = document.createElement(\"div\");\r\n\tscd.setAttribute(\"class\", \"terminus-mapping-page terminus-page\");\r\n\tvar tsel = document.createElement(\"select\");\r\n\tvar o1 = document.createElement(\"option\");\r\n\to1.value = \"data\";\r\n\to1.appendChild(document.createTextNode(\"Data Map\"))\r\n\ttsel.appendChild(o1);\r\n\tvar o2 = document.createElement(\"option\");\r\n\to2.value = \"model\";\r\n\to2.appendChild(document.createTextNode(\"Model Map\"))\r\n\ttsel.appendChild(o2);\r\n\tvar ff = this.getFormFieldDOM(\"Map Type\");\r\n\tff.appendChild(tsel);\r\n\tscd.appendChild(ff);\r\n\tvar source = this.getFormField(scd, \"Map Source\");\r\n\tvar target = this.getFormField(scd, \"Map Target\");\r\n\tvar queries = this.getFormField(scd, \"Queries\");\r\n\tvar options = this.getFormField(scd, \"Options\");\r\n\t\r\n\tvar mdom = this.getFormFieldDOM(\"Existing Mapping\");\r\n\tvar mapping = document.createElement(\"input\");\r\n\tmapping.setAttribute(\"type\", \"text\");\r\n\tmapping.setAttribute(\"size\", 80);\r\n\tmdom.appendChild(mapping);\r\n\tscd.appendChild(mdom);\r\n\t\r\n\tvar submit = document.createElement(\"button\");\r\n\tsubmit.setAttribute(\"class\", \"terminus-btn terminus-control-button\");\r\n\tsubmit.appendChild(document.createTextNode(\"Execute Mapping\"));\r\n\tvar self = this;\r\n\tsubmit.addEventListener(\"click\", function(){\r\n\t\tvar jsonip = {\r\n\t\t\tmap_source: JSON.parse(source.value),\r\n\t\t};\r\n\t\tif(tsel.value == \"data\"){\r\n\t\t\tjsonip[\"rdf:type\"] = \"dcogmodel:DataMap\";\r\n\t\t}\r\n\t\telse {\r\n\t\t\tjsonip[\"rdf:type\"] = \"dcogmodel:ModelMap\";\t\t\t\r\n\t\t}\r\n\t\tif(target.value) jsonip.map_target = target.value;\r\n\t\tif(queries.value) jsonip.queries = queries.value;\r\n\t\tif(options.value) jsonip.options = options.value;\r\n\t\tif(mapping.value) jsonip.mapping = mapping.value;\r\n\t\tself.ui.client.update(false, jsonip);\r\n\t})\r\n\tscd.appendChild(submit);\r\n\treturn scd;\r\n}\r\n\r\nTerminusMappingViewer.prototype.getFormFieldDOM = function(label){\r\n\tvar sci = document.createElement(\"div\");\r\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-mapping-field\");\r\n\tvar lab = document.createElement(\"span\");\r\n\tlab.setAttribute(\"class\", \"terminus-form-label terminus-mapping-label\");\r\n\tlab.appendChild(document.createTextNode(label));\r\n\tsci.appendChild(lab);\r\n\treturn sci;\r\n}\r\n\r\nTerminusMappingViewer.prototype.getFormField = function(holder, label){\r\n\tvar ff = this.getFormFieldDOM(label);\r\n\tvar source = document.createElement(\"textarea\");\r\n\tsource.setAttribute(\"class\", \"terminus-form-value terminus-textarea\");\r\n\tff.appendChild(source);\r\n\tholder.appendChild(ff);\r\n\treturn source;\r\n}\r\n\r\nmodule.exports=TerminusMappingViewer\r\n","/*\r\n * Draws the screen for viewing and updating the schema\r\n * and provides wrappers around the client's schema API\r\n */\r\nconst TerminusClassChooser = require('./TerminusClassChooser');\r\nconst TerminusDocumentViewer = require('./TerminusDocument');\r\nconst UTILS=require('../Utils')\r\n\r\nfunction TerminusSchemaViewer(ui){\r\n\tthis.ui = ui;\r\n\tthis.mode = \"view\";\r\n\tthis.format = \"turtle\";\r\n\tthis.confirm_before_update = true;\r\n}\r\n\r\n/*\r\n * Retrieves schema from API and writes the response into the page\r\n */\r\nTerminusSchemaViewer.prototype.getAsDOM = function(){\r\n\tthis.holder = document.createElement(\"div\");\r\n\tthis.controldom = document.createElement(\"div\");\r\n\tthis.controldom.setAttribute(\"class\", \"terminus-schema-controls\");\r\n\tthis.pagedom = document.createElement(\"div\");\r\n\tthis.pagedom.setAttribute(\"class\", \"terminus-schema-viewer\");\r\n\tthis.loadSchema();\r\n\tthis.holder.appendChild(this.controldom);\r\n\tthis.holder.appendChild(this.pagedom);\r\n\treturn this.holder;\r\n}\r\n\r\nTerminusSchemaViewer.prototype.loadSchema = function(msg, msgtype){\r\n\tvar self = this;\r\n\tthis.ui.showBusy(\"Fetching Database Schema\");\r\n\tthis.ui.client.getSchema(false, {\"terminus:encoding\": \"terminus:\" + this.format})\r\n\t.then(function(response){\r\n\t\tself.ui.clearBusy();\r\n\t\tself.schema = response;\r\n\t\tself.refreshPage(msg, msgtype);\r\n\t})\r\n\t.catch(function(error){\r\n\t\tself.ui.clearBusy();\r\n\t\tself.ui.showError(error);\r\n\t});\r\n}\r\n\r\nTerminusSchemaViewer.prototype.resetControlDOM = function(){\r\n\tTerminusClient.FrameHelper.removeChildren(this.controldom);\r\n\tif(this.mode == \"edit\"){\r\n\t\tthis.controldom.appendChild(this.getSchemaSaveButtons());\r\n\t}\r\n\telse if(this.mode == \"import\"){\r\n\t\tthis.controldom.appendChild(this.getSchemaImportActionButtons());\r\n\t}\r\n\telse if(this.mode == \"class_frame\"){\r\n\t\tif(this.ui.showControl(\"get_schema\")){\r\n\t\t\tthis.controldom.appendChild(this.getShowSchemaButton());\r\n\t\t}\r\n\t\tif(this.ui.showControl(\"class_frame\")){\r\n\t\t\tthis.controldom.appendChild(this.getClassFrameChooser());\r\n\t\t}\r\n\t}\r\n\telse if(this.mode == \"view\"){\r\n\t\tif(this.ui.showControl(\"update_schema\")){\r\n\t\t\tthis.controldom.appendChild(this.getSchemaEditButton());\r\n\t\t}\r\n\t\tif(this.ui.showControl(\"import_schema\")){\r\n\t\t\tthis.controldom.appendChild(this.getImportButton());\r\n\t\t}\r\n\t\tif(this.ui.showControl(\"schema_format\")){\r\n\t\t\tthis.controldom.appendChild(this.getFormatChoices());\r\n\t\t}\r\n\t\tif(this.ui.showControl(\"class_frame\")){\r\n\t\t\tthis.controldom.appendChild(this.getClassFrameChooser());\r\n\t\t}\r\n\t}\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getFormatChoices = function(){\r\n\tvar fc = document.createElement(\"select\");\r\n\tfc.setAttribute(\"class\", \"terminus-form-select terminus-schema-format terminus-type-select\");\r\n\tvar tc = document.createElement(\"option\");\r\n\ttc.setAttribute(\"class\", \"terminus-schema-turtle\");\r\n\ttc.value = \"turtle\";\r\n\ttc.appendChild(document.createTextNode(\"Turtle\"));\r\n\tif(this.format == \"turtle\") tc.selected = true;\r\n\tfc.appendChild(tc);\r\n\tvar tj = document.createElement(\"option\");\r\n\ttj.setAttribute(\"class\", \"terminus-schema-jsonld\");\r\n\ttj.value = \"jsonld\";\r\n\ttj.appendChild(document.createTextNode(\"Json LD\"));\r\n\tif(this.format == \"jsonld\") tj.selected = true;\r\n\tfc.appendChild(tj);\r\n\tvar self = this;\r\n\tfc.addEventListener(\"change\", function(e){\r\n\t\tself.format = this.value;\r\n\t\tself.loadSchema();\r\n\t});\r\n\treturn fc;\r\n}\r\n\r\n\r\nTerminusSchemaViewer.prototype.refreshPage = function(msg, msgtype){\r\n\tif(this.controldom) this.resetControlDOM();\r\n\tif(this.pagedom) this.refreshMainPage(msg, msgtype);\r\n}\r\n\r\nTerminusSchemaViewer.prototype.refreshMainPage = function(msg, msgtype){\r\n\tTerminusClient.FrameHelper.removeChildren(this.pagedom);\r\n\tif(this.mode == 'view'){\r\n\t\tthis.pagedom.appendChild(this.getSchemaViewDOM());\r\n\t}\r\n\telse if(this.mode == \"edit\"){\r\n\t\tthis.pagedom.appendChild(this.getSchemaEditDOM());\r\n\t}\r\n\telse if(this.mode == \"import\"){\r\n\t\tthis.pagedom.appendChild(this.getSchemaImportDOM());\r\n\t}\r\n\telse if(this.mode == \"class_frame\"){\r\n\t\tthis.pagedom.appendChild(this.getClassFrameDOM());\r\n\t}\r\n\tif(msg){\r\n\t\tthis.ui.showMessage(msg, msgtype);\r\n\t}\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getSchemaSaveButtons = function(){\r\n\tvar ssb = document.createElement(\"span\");\r\n\tssb.setAttribute(\"class\", \"terminus-schema-save-buttons\");\r\n\tssb.appendChild(this.getCancelButton());\r\n\tssb.appendChild(this.getSaveButton());\r\n\treturn ssb;\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getSchemaImportActionButtons = function(){\r\n\tvar ssb = document.createElement(\"span\");\r\n\tssb.setAttribute(\"class\", \"terminus-schema-import-buttons\");\r\n\tssb.appendChild(this.getCancelButton());\r\n\t//ssb.appendChild(this.getImportPreviewButton());\r\n\tssb.appendChild(this.getImportSaveButton());\r\n\treturn ssb;\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getShowSchemaButton = function(){\r\n\tvar self = this;\r\n\tvar func = function(){\r\n\t\tself.ui.clearMessages();\r\n\t\tself.mode = \"view\";\r\n\t\tself.refreshPage();\r\n\t}\r\n\treturn this.getSchemaButton(\"View Schema\", \"get_schema\", func);\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getImportPreviewButton = function(){\r\n\tvar self = this;\r\n\tvar func = function(){\r\n\t\tself.ui.clearMessages();\r\n\t\tself.mode = \"preview\";\r\n\t\tself.refreshPage();\r\n\t}\r\n\treturn this.getSchemaButton(\"Preview\", \"preview\", func);\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getCancelButton = function(){\r\n\tvar self = this;\r\n\tvar func = function(){\r\n\t\tself.ui.clearMessages();\r\n\t\tself.mode = \"view\";\r\n\t\tself.refreshPage();\r\n\t}\r\n\treturn this.getSchemaButton(\"Cancel\", \"cancel_update\", func);\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getImportSaveButton = function(){\r\n\tvar self = this;\r\n\tvar func = function(){\r\n\t\tself.ui.clearMessages();\r\n\t\tif(typeof self.doImport == \"function\"){\r\n\t\t\tself.doImport();\r\n\t\t}\r\n\t}\r\n\treturn this.getSchemaButton(\"Import\", \"import_schema\", func)\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getSaveButton = function(){\r\n\tvar self = this;\r\n\tvar func = function(){\r\n\t\tself.ui.clearMessages();\r\n\t\tvar text = self.schema_edit_dom.value;\r\n\t\tif(typeof(self.schema) == \"object\"){\r\n\t\t\ttext = JSON.parse(text);\r\n\t\t}\r\n\t\treturn self.updateSchema(text, {\"terminus:encoding\": \"terminus:\" + self.format});\r\n\t}\r\n\treturn this.getSchemaButton(\"Save\", \"update_schema\", func);\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getSchemaEditButton = function(){\r\n\tvar self = this;\r\n\tvar func = function(){\r\n\t\tself.mode = \"edit\";\r\n\t\tself.refreshPage();\r\n\t}\r\n\treturn this.getSchemaButton(\"Edit\", \"update_schema\", func);\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getImportButton = function(){\r\n\tvar self = this;\r\n\tvar func = function(){\r\n\t\tself.ui.clearMessages();\r\n\t\tself.mode = \"import\";\r\n\t\tself.refreshPage();\r\n\t}\r\n\treturn this.getSchemaButton(\"Import New Schema\", \"import_schema\", func);\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getSchemaButton = function(label, action, func){\r\n\tvar opt = document.createElement(\"button\");\r\n\topt.appendChild(document.createTextNode(label));\r\n\topt.setAttribute(\"class\", \"terminus-btn terminus-control-button terminus-schema-\" + action);\r\n\topt.addEventListener(\"click\", func);\r\n\treturn opt;\r\n}\r\n\r\n/*\r\n * Updates schema, then fetches updated version and updates the page with it\r\n */\r\nTerminusSchemaViewer.prototype.updateSchema  = function(text, opts){\r\n\tthis.ui.showBusy(\"Updating Database Schema\");\r\n\tvar self = this;\r\n\treturn this.ui.client.updateSchema(false, text, opts)\r\n\t.then(function(response){\r\n\t\tif(response['terminus:status'] && response['terminus:status'] == \"terminus:success\"){\r\n\t\t\tself.ui.showBusy(\"Retrieving updated schema\");\r\n\t\t\tself.mode = \"view\";\r\n\t\t\tself.loadSchema(\"Successfully Updated Schema\");\r\n\t\t}\r\n\t\telse if(response['terminus:status'] && response['terminus:status'] == \"terminus:failure\"){\r\n\t\t\tself.ui.clearBusy();\r\n\t\t\tself.ui.showViolations(response['terminus:witnesses'], \"schema\");\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthrow new Error(\"Update Schema returned no terminus:status code\");\r\n\t\t}\r\n\t})\r\n\t.catch(function(error){\r\n\t\tself.ui.clearBusy();\r\n\t\tself.ui.showError(error);\r\n\t});\r\n}\r\n\r\n/*\r\n * Imports a schema from the passed url\r\n * mode: replace | append\r\n */\r\nTerminusSchemaViewer.prototype.load  = function(url, key, mode){\r\n\tvar self = this;\r\n\tmode = (mode ? mode : \"replace\");\r\n\tthis.ui.showBusy(\"Loading schema from \" + url);\r\n\treturn this.ui.client.getSchema(url, {\"terminus:user_key\": key, \"terminus:encoding\" : \"terminus:\" + this.format})\r\n\t.then(function(response){\r\n\t\tvar newschema = (mode == \"append\") ? self.appendSchema(response) : response;\r\n\t\tif(self.confirm_before_update){\r\n\t\t\tself.showConfirmPage(newschema);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tself.ui.showBusy(\"Updating schema\");\r\n\t\t\tself.updateSchema(false, newschema).then(function(response){\r\n\t\t\t\tself.ui.clearBusy();\r\n\t\t\t\tself.ui.redraw();\r\n\t\t\t\tself.ui.showResult(\"Successfully deployed new schema from \" + url);\r\n\t\t\t\treturn response;\r\n\t\t\t});\r\n\t\t}\r\n\t}).catch(function(error){\r\n\t\tself.ui.clearBusy();\r\n\t\tself.ui.showError(error);\r\n\t});\r\n}\r\n\r\nTerminusSchemaViewer.prototype.appendSchema = function(s2){\r\n\tvar nschema = this.schema;\r\n\tif(this.format == 'turtle'){\r\n\t\tnschema = this.schema + s2;\r\n\t}\r\n\telse if(this.format == 'jsonld'){\r\n\t\tfor(var i in s2){\r\n\t\t\tnschema[i] = s2[i];\r\n\t\t}\r\n\t}\r\n\treturn nschema;\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getClassFrameChooser = function(){\r\n\tvar np = document.createElement(\"span\");\r\n\tnp.setAttribute(\"class\", \"terminus-class frame-chooser\");\r\n\tvar termcc = new TerminusClassChooser(this.ui);\r\n\ttermcc.empty_choice = \"View Individual Class Frames\";\r\n\tvar self = this;\r\n\ttermcc.change = function(new_class){\r\n\t\tif(new_class){\r\n\t\t\tself.cls = new_class;\r\n\t\t\tif(self.mode != \"class_frame\"){\r\n\t\t\t\tself.mode = \"class_frame\";\r\n\t\t\t\tself.refreshPage();\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tself.refreshMainPage();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tvar tcdom = termcc.getAsDOM();\r\n\tnp.appendChild(tcdom);\r\n\treturn np;\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getClassFrameDOM = function(){\r\n\tvar np = document.createElement(\"div\");\r\n\tnp.setAttribute(\"class\", \"terminus-schema-page terminus-schema-classframe-page\");\r\n\tvar docviewer = new TerminusDocumentViewer(this.ui, \"model\");\r\n\tdocviewer.loadCreateDocument(this.cls);\r\n\tdocviewer.page_config = \"model\";\r\n\tnp.appendChild(docviewer.getAsDOM());\r\n\treturn np;\r\n}\r\n\r\nTerminusSchemaViewer.prototype.showConfirmPage = function(newschema){\r\n\tthis.schema = newschema;\r\n\tthis.confirm_before_update = false;\r\n\tthis.mode = \"edit\";\r\n\tthis.refreshPage(\"Confirm new schema\");\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getSchemaEditDOM = function(){\r\n\tvar np = document.createElement(\"div\");\r\n\tnp.setAttribute(\"class\", \"terminus-schema-page terminus-schema-edit-page\");\r\n\tvar ipval = document.createElement(\"textarea\");\r\n\tipval.setAttribute(\"class\", \"terminus-schema-edit terminus-schema-textarea\");\r\n\tipval.setAttribute(\"width\", \"100%\");\r\n\tipval.setAttribute(\"style\", \"min-width: 400px; min-height: 400px;\");\r\n\tif(typeof(this.schema) == \"string\"){\r\n\t\tipval.innerHTML = this.schema;\r\n\t}\r\n\telse if(typeof (this.schema) == \"object\") {\r\n\t\tipval.innerHTML = JSON.stringify(this.schema, 0, 4);\r\n\t}\r\n\tthis.schema_edit_dom = ipval;\r\n\tnp.appendChild(ipval);\r\n\tUTILS.stylizeEditor(this.ui, ipval, 'schema', 'turtle');\r\n\treturn np;\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getSchemaViewDOM = function(){\r\n\tvar self = this;\r\n\tvar np = document.createElement(\"div\");\r\n\tnp.setAttribute(\"class\", \"terminus-schema-page terminus-schema-view-page\");\r\n\tvar ipval = document.createElement(\"pre\");\r\n\tipval.setAttribute(\"class\", \"terminus-schema-view terminus-scheme-pre\");\r\n\tif(typeof(this.schema) == \"string\"){\r\n\t\tvar txt = this.schema.replace(/&/g, \"&amp;\")\r\n         .replace(/</g, \"&lt;\")\r\n         .replace(/>/g, \"&gt;\")\r\n         .replace(/\"/g, \"&quot;\")\r\n         .replace(/'/g, \"&#039;\");\r\n\t\tipval.innerHTML = txt;\r\n\t}\r\n\telse if(typeof (this.schema) == \"object\") {\r\n\t\tipval.innerHTML = JSON.stringify(this.schema, 0, 4);\r\n\t}\r\n\tvar cm = UTILS.stylizeCodeDisplay(this.ui, ipval, np, 'turtle');\r\n\tif(!cm) np.appendChild(ipval);\r\n\treturn np;\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getSchemaImportDOM = function(){\r\n\tvar scd = document.createElement(\"div\");\r\n\tscd.setAttribute(\"class\", \"terminus-form-border terminus-schema-page terminus-schema-import-page\");\r\n\r\n\r\n\tvar sci = document.createElement(\"div\");\r\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-form-field-spacing terminus-form-horizontal terminus-control-group\");\r\n\tvar slab = document.createElement(\"span\");\r\n\tslab.setAttribute(\"class\", \"terminus-url-loader-input terminus-form-label terminus-control-label\");\r\n\tslab.appendChild(document.createTextNode(\"URL\"));\r\n\tsci.appendChild(slab);\r\n\tvar inpUrl  = document.createElement(\"input\");\r\n\tinpUrl.setAttribute(\"type\", \"text\");\r\n\tinpUrl.setAttribute(\"class\", \"terminus-form-value terminus-input-text terminus-form-url terminus-url-connect\");\r\n\tinpUrl.setAttribute(\"placeholder\", \"Enter url to import schema from\");\r\n\tsci.appendChild(inpUrl);\r\n\tscd.appendChild(sci);\r\n\r\n\tvar sci = document.createElement(\"div\");\r\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-form-field-spacing terminus-form-horizontal terminus-control-group\");\r\n\tvar klab = document.createElement(\"span\");\r\n\tklab.setAttribute(\"class\", \"terminus-url-loader-input terminus-form-label  terminus-control-label terminus-import_mode-input\");\r\n\tklab.appendChild(document.createTextNode(\"Import Mode\"));\r\n\tsci.appendChild(klab);\r\n\tvar modes = document.createElement(\"select\");\r\n\tmodes.setAttribute(\"class\", \"terminus-form-select\");\r\n\r\n\tvar overwrite = document.createElement(\"option\");\r\n\toverwrite.value = \"replace\";\r\n\toverwrite.appendChild(document.createTextNode(\"Replace Mode\"))\r\n\tmodes.appendChild(overwrite);\r\n\tvar append = document.createElement(\"option\");\r\n\tappend.value = \"append\";\r\n\tappend.appendChild(document.createTextNode(\"Append Mode\"))\r\n\tmodes.appendChild(append);\r\n\tmodes.setAttribute(\"class\", \"terminus-form-select terminus-import-mode\");\r\n\tsci.appendChild(klab);\r\n\tsci.appendChild(modes);\r\n\tscd.appendChild(sci);\r\n\r\n\tvar sci = document.createElement(\"div\");\r\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-form-field-spacing terminus-form-horizontal terminus-control-group\");\r\n\tvar klab = document.createElement(\"span\");\r\n\tklab.setAttribute(\"class\", \"terminus-form-label terminus-url-key-input terminus-control-label\");\r\n\tklab.appendChild(document.createTextNode(\"Key\"))\r\n\tvar key = document.createElement(\"input\");\r\n\tkey.setAttribute(\"type\", \"text\");\r\n\tkey.setAttribute(\"class\", \"terminus-form-value terminus-input-text terminus-url-key\");\r\n\tsci.appendChild(klab);\r\n\tsci.appendChild(key);\r\n\tscd.appendChild(sci);\r\n\tvar self = this;\r\n\tthis.doImport = function(){\r\n\t\tif(inpUrl.value){\r\n\t\t\tself.load(inpUrl.value, key.value, modes.value);\r\n\t\t}\r\n\t}\r\n\treturn scd;\r\n}\r\n\r\nmodule.exports=TerminusSchemaViewer\r\n","/**\r\n * User interface elements that relate to server context\r\n *\r\n * TerminusServerController is a control widget that invokes server actions\r\n * TerminusServerViewer is a window that displays server actions and server screens\r\n *\r\n */\r\n const Datatables = require('../plugins/datatables.terminus');\r\n const UTILS =require('../Utils')\r\n function TerminusServerController(ui){\r\n\t this.ui = ui;\r\n }\r\n\r\nTerminusServerController.prototype.getAsDOM = function(){\r\n\tvar rsc = document.createElement(\"div\");\r\n\trsc.setAttribute(\"class\", \"terminus-server-controller\");\r\n\tvar self = this;\r\n\tif(this.ui && this.ui.server()){\r\n\t\tvar scd = document.createElement(\"div\");\r\n\t\tscd.setAttribute(\"class\", \"terminus-server-connection\");\r\n        var nav = document.createElement('div');\r\n        nav.setAttribute('class', 'span3');\r\n        var ul = document.createElement('ul');\r\n        ul.setAttribute('class', 'terminus-ul');\r\n        nav.appendChild(ul);\r\n        rsc.appendChild(nav);\r\n        // connected to server\r\n        var a = document.createElement('a');\r\n        a.setAttribute('class', 'terminus-dashboard-info terminus-list-group-a terminus-nav-width');\r\n        var txt = 'Server: ' + this.ui.server();\r\n        a.appendChild(document.createTextNode(txt));\r\n        ul.appendChild(a);\r\n        // change server\r\n        if(this.ui.showControl(\"change-server\")){\r\n            var a = document.createElement('a');\r\n            a.setAttribute('class', 'terminus-a terminus-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\r\n            var self = this;\r\n            a.addEventListener(\"click\", function(){\r\n                UTILS.activateSelectedNav(this, self);\r\n                self.ui.showLoadURLPage();\r\n            })\r\n            var icon = document.createElement('i');\r\n            icon.setAttribute('class', 'terminus-menu-icon fa fa-link');\r\n            a.appendChild(icon);\r\n            var txt = document.createTextNode('Change Server');\r\n            a.appendChild(txt);\r\n            ul.appendChild(a);\r\n        }\r\n        // view databases\r\n        if(this.ui.showControl(\"db\")){\r\n            var a = document.createElement('a');\r\n            a.setAttribute('class', 'terminus-a terminus-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\r\n            var self = this;\r\n            a.addEventListener(\"click\", function(){\r\n                UTILS.activateSelectedNav(this, self);\r\n                if(self.ui.db()){\r\n                    //self.ui.clearDB();\r\n                }\r\n                self.ui.showServerMainPage();\r\n            })\r\n            var icon = document.createElement('i');\r\n            icon.setAttribute('class', 'terminus-menu-icon fa fa-eye');\r\n            a.appendChild(icon);\r\n            var txt = document.createTextNode('View Databases');\r\n            a.appendChild(txt);\r\n            ul.appendChild(a);\r\n        }\r\n        if(this.ui.showControl(\"create_database\")){\r\n            var a = document.createElement('a');\r\n            a.setAttribute('class', 'terminus-a terminus-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\r\n            var self = this;\r\n            a.addEventListener(\"click\", function(){\r\n               UTILS.activateSelectedNav(this, self);\r\n                if(self.ui.db()){\r\n                    //self.ui.clearDB();\r\n                }\r\n                self.ui.showCreateDBPage();\r\n            })\r\n            var icon = document.createElement('i');\r\n            icon.setAttribute('class', 'terminus-menu-icon fa fa-plus');\r\n            a.appendChild(icon);\r\n            var txt = document.createTextNode('Create New Database');\r\n            a.appendChild(txt);\r\n            ul.appendChild(a);\r\n        }\r\n\t}\r\n\treturn rsc;\r\n}\r\n\r\nTerminusServerController.prototype.getServerLabelDOM = function(){\r\n\tvar srec = this.ui.client.connection.getServerRecord();\r\n\tvar lab = (srec && srec['rdfs:label'] && srec['rdfs:label'][\"@value\"] ? srec['rdfs:label'][\"@value\"] : this.ui.server());\r\n\tvar desc = (srec && srec['rdfs:comment'] && srec['rdfs:comment'][\"@value\"] ? srec['rdfs:comment'][\"@value\"] : \"\");\r\n\tdesc += \" Server URL: \"+ this.ui.server();\r\n\tvar val = document.createElement(\"span\");\r\n\tval.setAttribute(\"class\", \"terminus-server-value\");\r\n\tval.setAttribute(\"title\", desc);\r\n\tval.appendChild(document.createTextNode(lab));\r\n    val =  document.createElement('div');\r\n\treturn val;\r\n}\r\n\r\nfunction TerminusServerViewer(ui){\r\n\tthis.ui = ui;\r\n\tthis.server = this.ui.server();\r\n}\r\n\r\nTerminusServerViewer.prototype.getAsDOM = function(selected){\r\n\tvar self = this;\r\n\tvar pd = document.createElement(\"span\");\r\n\tpd.setAttribute(\"class\", \"terminus-server-home-page\");\r\n\tif(this.ui.server()){\r\n\t\tvar scd = document.createElement(\"span\");\r\n\t\tscd.setAttribute(\"class\", \"terminus-server-home\");\r\n\t\tif(this.ui.showView(\"server\")){\r\n\t\t\t// 11092019 scd.appendChild(this.getServerDetailsDOM());\r\n\t\t}\r\n\t\tif(this.ui.showView(\"change-server\")){\r\n\t\t\tvar csbut = document.createElement(\"button\");\r\n\t\t\tcsbut.setAttribute(\"class\", \"terminus-control-button terminus-change-server-button terminus-btn\")\r\n\t\t\tcsbut.appendChild(document.createTextNode(\"Disconnect\"));\r\n\t\t\tcsbut.addEventListener(\"click\", function(){\r\n\t\t\t\t//self.ui.clearDB();\r\n\t\t\t\t//self.ui.clearServer();\r\n\t\t\t\tself.ui.showLoadURLPage();\r\n\t\t\t})\r\n\t\t\t// 11092019 scd.appendChild(csbut);\r\n\t\t}\r\n\t\tif(this.ui.showView(\"create_database\")){\r\n\t\t\tvar crbut = document.createElement(\"button\");\r\n\t\t\tcrbut.setAttribute(\"class\", \"terminus-control-button terminus-create-db-button terminus-btn\")\r\n\t\t\tcrbut.appendChild(document.createTextNode(\"Create New Database\"));\r\n\t\t\tcrbut.addEventListener(\"click\", function(){\r\n\t\t\t\tif(self.ui.db()){\r\n\t\t\t\t\t//self.ui.clearDB();\r\n\t\t\t\t}\r\n\t\t\t\tself.ui.clearMessages();\r\n\t\t\t\tself.ui.showCreateDBPage();\r\n\t\t\t})\r\n\t\t\t// 11092019 scd.appendChild(crbut);\r\n\t\t}\r\n\t\tif(this.ui.showView(\"db\")){\r\n\t\t\tscd.appendChild(this.getDBListDOM());\r\n\t\t}\r\n\t\tpd.appendChild(scd);\r\n\t}\r\n\telse {\r\n\t\tself.ui.showLoadURLPage();\r\n\r\n\t\t//pd.appendChild(this.getLoadURLPage());\r\n\t}\r\n\treturn pd;\r\n}\r\n\r\nTerminusServerViewer.prototype.getServerDetailsDOM = function(){\r\n\tvar scd = document.createElement(\"span\");\r\n\tscd.setAttribute(\"class\", \"terminus-server-details terminus-server-banner\");\r\n\tvar scl = document.createElement(\"span\");\r\n\tscl.setAttribute(\"class\", \"terminus-label terminus-server-info\");\r\n\tscl.appendChild(document.createTextNode(\"Connected to Server - \"))\r\n\tvar scs = document.createElement(\"span\");\r\n\tscs.setAttribute(\"class\", \"terminus-value terminus-server-info\");\r\n\tscs.appendChild(document.createTextNode(this.ui.server()))\r\n\tscd.appendChild(scl);\r\n\tscd.appendChild(scs);\r\n\treturn scd;\r\n}\r\n\r\nTerminusServerViewer.prototype.wrapTableLinkCell = function(dbid, text){\r\n\tvar self = this;\r\n\tvar wrap = document.createElement(\"a\");\r\n\twrap.setAttribute(\"href\", \"#\");\r\n\twrap.setAttribute(\"class\", \"terminus-table-content\");\r\n\twrap.appendChild(document.createTextNode(text));\r\n\twrap.addEventListener(\"click\", function(){\r\n\t\tself.ui.connectToDB(dbid);\r\n\t\tself.ui.showDBMainPage();\r\n\t});\r\n\treturn wrap;\r\n}\r\n\r\nTerminusServerViewer.prototype.getDBListDOM = function(){\r\n\tvar self = this;\r\n\tvar sec = document.createElement(\"div\");\r\n\tvar lihed = document.createElement(\"h3\");\r\n\tlihed.setAttribute(\"class\", \"terminus-db-list-title terminus-module-head\");\r\n\tlihed.appendChild(document.createTextNode(\"Available Databases\"));\r\n\tsec.appendChild(lihed);\r\n\tvar scd = document.createElement(\"table\");\r\n\tscd.setAttribute(\"class\", \"terminus-db-list terminus-db-size\");\r\n\tvar thead = document.createElement(\"thead\");\r\n\tvar thr = document.createElement(\"tr\");\r\n\tvar th1 = document.createElement(\"th\");\r\n\tth1.appendChild(document.createTextNode(\"ID\"));\r\n\tth1.setAttribute(\"class\", \"terminus-db-id terminus-table-th\");\r\n\tvar th2 = document.createElement(\"th\");\r\n\tth2.appendChild(document.createTextNode(\"Title\"));\r\n\tth2.setAttribute(\"class\", \"terminus-db-title terminus-table-th\");\r\n\tvar th3 = document.createElement(\"th\");\r\n\tth3.appendChild(document.createTextNode(\"Description\"));\r\n\tth3.setAttribute(\"class\", \"terminus-db-description terminus-table-th\");\r\n\tvar th4 = document.createElement(\"th\");\r\n\tth4.setAttribute(\"class\", \"terminus-db-size terminus-table-th\");\r\n\tth4.appendChild(document.createTextNode(\"Size\"));\r\n\tvar th5 = document.createElement(\"th\");\r\n\tth5.setAttribute(\"class\", \"terminus-db-created terminus-table-th\");\r\n\tth5.appendChild(document.createTextNode(\"Created\"));\r\n\tvar th6 = document.createElement(\"th\");\r\n\tth6.appendChild(document.createTextNode(\"Delete\"));\r\n\tth6.setAttribute(\"class\", \"terminus-db-delete terminus-table-th\");\r\n\tthr.appendChild(th1);\r\n\tthr.appendChild(th2);\r\n\tthr.appendChild(th3);\r\n\tthr.appendChild(th4);\r\n\tthr.appendChild(th5);\r\n\tthr.appendChild(th6);\r\n\tthead.appendChild(thr);\r\n\tscd.appendChild(thead);\r\n\tvar tbody = document.createElement(\"tbody\");\r\n\tvar dbrecs = this.ui.client.connection.getServerDBRecords();\r\n\tfor(var fullid in dbrecs){\r\n\t\tvar dbrec = dbrecs[fullid];\r\n\t\tvar dbid = fullid.split(\":\")[1];\r\n\t\tvar tr = document.createElement(\"tr\");\r\n\t\tvar td1 = document.createElement(\"td\");\r\n\t\ttd1.appendChild(this.wrapTableLinkCell(dbid, dbid));\r\n\t\ttd1.setAttribute(\"class\", \"terminus-db-id\");\r\n\t\tvar td2 = document.createElement(\"td\");\r\n\t\ttd2.setAttribute(\"class\", \"terminus-db-title\");\r\n\t\tvar txt = (dbrec && dbrec['rdfs:label'] && dbrec['rdfs:label']['@value'] ? dbrec['rdfs:label']['@value'] : \"\");\r\n\t\ttd2.appendChild(this.wrapTableLinkCell(dbid, txt));\r\n\t\tvar td3 = document.createElement(\"td\");\r\n\t\ttd3.setAttribute(\"class\", \"terminus-db-description\");\r\n\t\tvar txt = (dbrec && dbrec['rdfs:comment'] && dbrec['rdfs:comment']['@value'] ? dbrec['rdfs:comment']['@value'] : \"\");\r\n\t\ttd3.appendChild(this.wrapTableLinkCell(dbid, txt));\r\n\t\tvar td4 = document.createElement(\"td\");\r\n\t\ttd4.setAttribute(\"class\", \"terminus-db-size\");\r\n\t\tvar txt = (dbrec && dbrec['terminus:size'] && dbrec['terminus:size']['@value'] ? dbrec['terminus:size']['@value'] : \"\");\r\n\t\ttd4.appendChild(this.wrapTableLinkCell(dbid, txt));\r\n\t\tvar td5 = document.createElement(\"td\");\r\n\t\ttd5.setAttribute(\"class\", \"terminus-db-created\");\r\n\t\tvar txt = (dbrec && dbrec['terminus:last_updated'] && dbrec['terminus:last_updated']['@value'] ? dbrec['terminus:last_updated']['@value'] : \"\");\r\n\t\ttd5.appendChild(this.wrapTableLinkCell(dbid, txt));\r\n\t\tvar td6 = document.createElement(\"td\");\r\n\t\ttd6.setAttribute(\"class\", \"db-delete\");\r\n\t\tif(this.deleteDBPermitted(dbid)){\r\n            if(this.ui.pluginAvailable(\"font-awesome\")){\r\n                var delbut = document.createElement('i');\r\n        \t\tdelbut.setAttribute(\"class\", \"terminus-db-list-del-icon fa fa-times-circle\");\r\n        \t}\r\n            else{\r\n                var delbut = document.createElement(\"button\");\r\n    \t\t\tdelbut.appendChild(document.createTextNode(\"Delete\"));\r\n    \t\t\tdelbut.setAttribute(\"class\", \"terminus-control-button terminus-delete-db-button\");\r\n            }\r\n\t\t\t// function to fix db in a closure\r\n\t\t\tvar delDB = function(db){ return function(){self.ui.deleteDatabase(db);}};\r\n\t\t\tdelbut.addEventListener(\"click\", delDB(dbid));\r\n\t\t\ttd6.appendChild(delbut);\r\n\t\t}\r\n\t\ttr.appendChild(td1);\r\n\t\ttr.appendChild(td2);\r\n\t\ttr.appendChild(td3);\r\n\t\ttr.appendChild(td4);\r\n\t\ttr.appendChild(td5);\r\n\t\ttr.appendChild(td6);\r\n\t\ttbody.appendChild(tr);\r\n\t}\r\n\tscd.appendChild(tbody);\r\n\tsec.appendChild(scd);\r\n\r\n\tif(this.ui.pluginAvailable(\"datatables\")){\r\n        var dt = new Datatables();\r\n\t\tvar tab = dt.draw(false, scd, null, this.ui, null);\r\n\t}\r\n\treturn sec;\r\n}\r\n\r\nTerminusServerViewer.prototype.deleteDBPermitted = function(dbid){\r\n\tif(this.ui.client.connection.capabilitiesPermit(\"delete_database\", dbid)) return true;\r\n\treturn false;\r\n}\r\n\r\nmodule.exports = {TerminusServerViewer,TerminusServerController}\r\n","function TerminusURLLoader(ui, val){\r\n\tthis.ui = ui;\r\n\tthis.val = val;\r\n\tthis.url_input = false;\r\n\tthis.key_input = false;\r\n}\r\n\r\nTerminusURLLoader.prototype.getLabelDOM = function(){\r\n\treturn document.createTextNode(\"Connect\");\r\n}\r\n\r\nTerminusURLLoader.prototype.getFormFieldDOM = function(ip, fname, ltxt, pholder){\r\n\tvar sci = document.createElement(\"div\");\r\n\tsci.setAttribute(\"class\", \"terminus-form-horizontal terminus-control-group terminus-form-field-spacing terminus-form-field terminus-field-\"+fname);\r\n\tvar lab = document.createElement(\"span\");\r\n\tlab.setAttribute(\"class\", \"terminus-control-label terminus-form-label terminus-form-field-label terminus-label-\"+fname);\r\n\tlab.appendChild(document.createTextNode(ltxt))\r\n\tip.setAttribute(\"type\", \"text\");\r\n\tip.setAttribute(\"placeholder\", pholder);\r\n\tsci.appendChild(lab);\r\n\tsci.appendChild(ip);\r\n\treturn sci;\r\n}\r\n\r\nTerminusURLLoader.prototype.getAsDOM = function(){\r\n\tvar scd = document.createElement(\"div\");\r\n\tscd.setAttribute(\"class\", \"terminus-form terminus-url-loader\");\r\n\tvar stit = document.createElement(\"h3\");\r\n\tstit.setAttribute(\"class\", \"terminus-form-header terminus-connect-header terminus-module-head\");\r\n\tstit.appendChild(document.createTextNode(\"Connect To Terminus Server\"));\r\n\tscd.appendChild(stit);\r\n\tvar mfd = document.createElement('div');\r\n\tmfd.setAttribute('class', 'terminus-form-border');\r\n\tscd.appendChild(mfd);\r\n\tthis.url_input = document.createElement(\"input\");\r\n\tthis.url_input.setAttribute(\"class\", \"terminus-form-value terminus-form-url terminus-form-field-input terminus-input-text\");\r\n\tif(this.val){\r\n\t\tthis.url_input.value = this.val;\r\n\t}\r\n\tmfd.appendChild(this.getFormFieldDOM(this.url_input, \"connect\", \"URL\", \"Terminus DB URL\"));\r\n\tthis.key_input = document.createElement(\"input\");\r\n\tthis.key_input.setAttribute(\"class\", \"terminus-form-value terminus-value terminus-input-text\");\r\n\tmfd.appendChild(this.getFormFieldDOM(this.key_input, \"connect\", \"Key\", \"Server API Key\"));\r\n\tvar loadbuts = document.createElement(\"div\");\r\n\tloadbuts.setAttribute(\"class\", \"terminus-control-buttons\");\r\n\tvar loadbut = document.createElement(\"button\");\r\n\tloadbut.setAttribute(\"class\", \"terminus-control-button terminus-url-load terminus-btn\");\r\n\tloadbut.appendChild(document.createTextNode(\"Connect\"));\r\n\tvar self = this;\r\n\tloadbut.addEventListener(\"click\", function(){\r\n\t\tif(self.url_input.value){\r\n\t\t\tself.ui.load(self.url_input.value, self.key_input.value);\r\n\t\t}\r\n\t});\r\n\tloadbuts.appendChild(loadbut);\r\n\tmfd.appendChild(loadbuts);\r\n\treturn scd;\r\n}\r\n\r\n\r\nmodule.exports=TerminusURLLoader\r\n"],"sourceRoot":""}
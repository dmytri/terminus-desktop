{"version":3,"sources":["webpack://TerminusDashboard/webpack/bootstrap","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/index.js","webpack://TerminusDashboard/./src/html/HTMLFrameHelper.js","webpack://TerminusDashboard/./src/Utils.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/node_modules/axios/lib/utils.js","webpack://TerminusDashboard/./src/html/query/TerminusCodeSnippet.js","webpack://TerminusDashboard/./src/plugins/TerminusPlugin.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/errorMessage.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/frameHelper.js","webpack://TerminusDashboard/./src/client/RenderingMap.js","webpack://TerminusDashboard/./src/viewer/TerminusFrame.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/const.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/utils.js","webpack://TerminusDashboard/./src/html/document/ObjectViewer.js","webpack://TerminusDashboard/./src/html/datatypes/String.js","webpack://TerminusDashboard/./src/html/document/PropertyViewer.js","webpack://TerminusDashboard/./src/html/document/DataViewer.js","webpack://TerminusDashboard/./src/html/Datatypes.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/node_modules/axios/lib/helpers/bind.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/node_modules/axios/lib/helpers/buildURL.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/node_modules/axios/lib/cancel/isCancel.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/node_modules/axios/lib/defaults.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/node_modules/axios/lib/adapters/xhr.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/node_modules/axios/lib/core/createError.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/node_modules/axios/lib/core/mergeConfig.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/node_modules/axios/lib/cancel/Cancel.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/connectionCapabilities.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/connectionConfig.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/terminusIDParser.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/framePattern.js","webpack://TerminusDashboard/./src/TerminusDocument.js","webpack://TerminusDashboard/./src/client/WOQLQuery.js","webpack://TerminusDashboard/./src/plugins/datatables.terminus.js","webpack://TerminusDashboard/./src/html/datatypes/StringEditor.js","webpack://TerminusDashboard/./src/html/datatypes/Boolean.js","webpack://TerminusDashboard/./src/html/datatypes/BooleanEditor.js","webpack://TerminusDashboard/./src/html/datatypes/Choice.js","webpack://TerminusDashboard/./src/html/datatypes/ChoiceEditor.js","webpack://TerminusDashboard/./src/html/datatypes/Coordinate.js","webpack://TerminusDashboard/./src/html/datatypes/CoordinateEditor.js","webpack://TerminusDashboard/./src/html/datatypes/Date.js","webpack://TerminusDashboard/./src/html/datatypes/DateHelper.js","webpack://TerminusDashboard/./src/html/datatypes/DateEditor.js","webpack://TerminusDashboard/./src/html/datatypes/Entity.js","webpack://TerminusDashboard/./src/html/datatypes/EntityEditor.js","webpack://TerminusDashboard/./src/html/datatypes/Image.js","webpack://TerminusDashboard/./src/html/datatypes/ImageEditor.js","webpack://TerminusDashboard/./src/html/datatypes/Link.js","webpack://TerminusDashboard/./src/html/datatypes/Number.js","webpack://TerminusDashboard/./src/html/datatypes/Range.js","webpack://TerminusDashboard/./src/html/datatypes/RangeEditor.js","webpack://TerminusDashboard/./src/html/datatypes/SanitizedHTML.js","webpack://TerminusDashboard/./src/html/datatypes/GoogleMapEditor.js","webpack://TerminusDashboard/./src/html/datatypes/GoogleMapHelper.js","webpack://TerminusDashboard/./src/html/datatypes/GoogleMapViewer.js","webpack://TerminusDashboard/./src/html/datatypes/HTMLMarkupEditor.js","webpack://TerminusDashboard/./src/html/datatypes/S2EntityEditor.js","webpack://TerminusDashboard/./src/TerminusDB.js","webpack://TerminusDashboard/./src/viewer/WOQLRule.js","webpack://TerminusDashboard/./src/viewer/WOQLChooser.js","webpack://TerminusDashboard/./src/viewer/WOQLTable.js","webpack://TerminusDashboard/./src/viewer/DatatypeRenderers.js","webpack://TerminusDashboard/./src/viewer/WOQLGraph.js","webpack://TerminusDashboard/./src/viewer/WOQLStream.js","webpack://TerminusDashboard/./src/html/QueryPane.js","webpack://TerminusDashboard/./src/html/table/SimpleTable.js","webpack://TerminusDashboard/./src/html/graph/SimpleGraph.js","webpack://TerminusDashboard/./src/html/stream/SimpleStream.js","webpack://TerminusDashboard/./src/html/chooser/SimpleChooser.js","webpack://TerminusDashboard/./src/html/DocumentPane.js","webpack://TerminusDashboard/./src/html/document/SimpleFrameViewer.js","webpack://TerminusDashboard/./src/index.js","webpack://TerminusDashboard/./src/TerminusUI.js","webpack://TerminusDashboard/./src/ApiExplorer.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/woqlClient.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/dispatchRequest.js","webpack://TerminusDashboard/./node_modules/buffer/index.js","webpack://TerminusDashboard/(webpack)/buildin/global.js","webpack://TerminusDashboard/./node_modules/base64-js/index.js","webpack://TerminusDashboard/./node_modules/ieee754/index.js","webpack://TerminusDashboard/./node_modules/isarray/index.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/node_modules/axios/index.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/node_modules/axios/lib/axios.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/node_modules/is-buffer/index.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/node_modules/axios/lib/core/Axios.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/node_modules/axios/lib/core/InterceptorManager.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/node_modules/axios/lib/core/dispatchRequest.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/node_modules/axios/lib/core/transformData.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/node_modules/axios/lib/helpers/normalizeHeaderName.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/node_modules/axios/lib/core/settle.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/node_modules/axios/lib/core/enhanceError.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/node_modules/axios/lib/helpers/parseHeaders.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/node_modules/axios/lib/helpers/isURLSameOrigin.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/node_modules/axios/lib/helpers/cookies.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/node_modules/axios/lib/helpers/isAbsoluteURL.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/node_modules/axios/lib/helpers/combineURLs.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/node_modules/axios/lib/cancel/CancelToken.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/node_modules/axios/lib/helpers/spread.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/objectFrame.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/woqlResult.js","webpack://TerminusDashboard/./node_modules/@terminusdb/terminus-client/lib/woql.js","webpack://TerminusDashboard/./src/plugins/codemirror.terminus.js","webpack://TerminusDashboard/./src/client/WOQLResultsViewer.js","webpack://TerminusDashboard/./src/client/ObjectRenderer.js","webpack://TerminusDashboard/./src/client/ValueRenderer.js","webpack://TerminusDashboard/./src/viewer/WOQLQueryView.js","webpack://TerminusDashboard/./src/html/ResultPane.js","webpack://TerminusDashboard/./src/html/graph/GraphResultsViewer.js","webpack://TerminusDashboard/./src/html/TerminusViolation.js","webpack://TerminusDashboard/./src/TerminusQuery.js","webpack://TerminusDashboard/./src/html/ScriptPane.js","webpack://TerminusDashboard/./src/TerminusSchema.js","webpack://TerminusDashboard/./src/client/TerminusClassChooser.js","webpack://TerminusDashboard/./src/html/TerminusHTMLViewer.js","webpack://TerminusDashboard/./src/html/document/SimpleDocument.js","webpack://TerminusDashboard/./src/html/document/DocumentTable.js","webpack://TerminusDashboard/./src/TerminusServer.js","webpack://TerminusDashboard/./src/TerminusURL.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","WOQLClient","ConnectionCapabilities","ConnectionConfig","IDParser","ErrorMessage","FrameHelper","ObjectFrame","WOQLResult","WOQL","TerminusPluginManager","require","TerminusClient","HTMLFrameHelper","type","control","label","callback","disabled","dpropDOM","document","createElement","setAttribute","button","appendChild","createTextNode","addEventListener","this","innerHTML","objId","getElementsByClassName","length","style","background","view","pluginAvailable","icon","options","selected","sel","opt","labelFromURL","which","renderer","viewsDOM","setMode","getActionControl","isNew","cancel","url","window","location","href","loc","split","sh","getShorthand","bits","htmlid","prop","wrap","text","max_cell_size","max_word_size","substring","replacements","words","word","newstr","k","replace","varname","lastIndexOf","obj","help","input","infoDOM","linfo","lspacer","lval","scope","frame","orientation","hfeatures","features","display_options","hidden","framedom","getFrameHolderDOM","header","hd","header_features","getFrameHeaderDOM","getFrameBodyDOM","pcls","sp","css","parent","subjectClass","subject","hid","hash","index","idm","objDOM","vholder","charCodeAt","feature","val","getInfoboxDOM","sum","getSummary","status","lab","getLabel","getComment","isClassChoice","getClassChoiceTypeSelector","range","getType","cardControlAllows","show_disabled_buttons","clone","reset","isUpdated","hide","show","save","getViewerSelectorDOM","getViewEntryDOM","getCardinalityDOM","getAddDOM","viewers","terminus","datatypes","getAvailableViewers","getRenderer","mpropDOM","currentViewer","getSelectionControl","viewer","setViewer","viewables","getFilledPropertyList","unshift","add","goToEntry","restriction","getRestriction","min","max","cs","getAvailableClassChoices","mlabDOM","cls","changeClass","addClass","addables","getMissingPropertyList","addNewProperty","addNewValue","Codemirror","readFile","file","XMLHttpRequest","xmlhttp","ActiveXObject","open","send","xmlDoc","responseText","getFunctionSignature","sigs","spec","descr","result","args","server_url","title","description","database_url","details","format","editmode","document_url","fail_on_id_denied","woql","class","term","source","target","getHeaderDom","h","getButton","getInfoAlertDom","msg","ald","str","txt","getResponse","currForm","action","response","terminator","rd","br","data","JSON","stringify","pre","stylizeCodeDisplay","showHttpResult","retHttpHeaders","headers","hdres","json","then","deleteStylizedEditor","ui","qip","cm","nextElementSibling","removeChildren","stylizeEditor","cmConfig","ar","colorizeTextArea","updateTextArea","dom","pr","colorizePre","removeSelectedNavClass","el","classList","remove","setSelectedSubMenu","a","setSelected","className","par","parentElement","childNodes","contains","tolggleContent","content","display","activateSelectedNav","nav","hideDocumentSubMenus","checkDocumentSubMenus","showControl","toggleVisibility","extractValueFromCell","cellValue","DOMParser","parseFromString","firstChild","displayDocumentSubMenus","showSubMenus","checkForMandatoryId","getCurrentWoqlQueryObject","query","settings","qval","limit","pageLength","start","elementMetadata","classMetadata","getEverything","getAllDocuments","documentMetadata","and","quad","sub","propertyMetadata","console","log","trimValue","getqObjFromInput","q","qObj","eval","e","toString","isBuffer","isArray","isObject","isFunction","forEach","fn","isArrayBuffer","isFormData","FormData","isArrayBufferView","ArrayBuffer","isView","buffer","isString","isNumber","isUndefined","isDate","isFile","isBlob","isStream","pipe","isURLSearchParams","URLSearchParams","isStandardBrowserEnv","navigator","product","merge","assignValue","arguments","deepMerge","extend","b","thisArg","trim","UTILS","TerminusCodeSnippet","language","width","height","placeholder","formats","snippet","setQuery","refreshContents","serialise","prettyPrint","undefined","parseText","nw","parse","loadConfig","error","getInputElement","readInput","getAsDOM","with_buttons","scont","snpc","getFormatButtons","serial","actbtn","getSubmitButton","changeRuleView","nview","submit","getIconsDOM","bsp","view_types","isp","id","self","cursor","f","btn","qobj","alert","removeCodeMirror","nextSibling","removeElement","stylizeSnippet","dimensions","preloaded","loaded","loading","precluded","plugins","js","requires","setPluginOptions","opts","init","calculatePreloaded","toload","calculateRequiredInitPlugins","loadPlugins","pins","pid","indexOf","push","getDefaultPlugins","needed_pins","loading_order","getAvailablePlugins","pl","plugin","version_check","pluginmeta","version","jQuery","slider","Quill","JSONEditor","CodeMirror","fontAwesomeCheck","dataTable","select2","google","maps","ol","Map","d3","Error","element","span","body","insertBefore","getComputedStyle","getPropertyValue","removeChild","ticker","cback","loadPlugin","pug","cssid","loadDynamicCSS","scripts","sid","splice","loadDynamicScript","loadPluginScripts","loadPageCSS","cssfid","cssdom","getElementById","parentNode","cssurl","pluginLoadable","pluginLoadedOrLoading","getPluginDOM","plugid","cl","cbox","checked","clab","togglePlugin","redraw","unloadPlugin","drawPlugins","num","dm","clh","showPlugins","getErrorAsMessage","api","err","formatErrorMessage","method","nmsg","keys","getAPIErrorMessage","getAccessDeniedMessage","accessDenied","db","server","getInvalidURIMessage","parseAPIError","redirected","standard_urls","rdf","rdfs","xsd","owl","tcs","tbs","xdd","v","vio","docs","prefix","node","hasChildNodes","Math","random","Date","getTime","link","pref","full","ida","idb","unshorten","sha","shb","prefixes","validURL","nurl","urlFragment","charAt","toUpperCase","slice","urlStr","baseUrl","stype","urlFirst","urlTmp","ext","viewIncludesProperties","parts","join","ty","parsed","parseXsdDate","parseXsdTime","parseXsdDateTime","year","month","day","tz","extractXsdTimezone","abs","parseInt","timezone","nparsed","hour","minute","second","xparsed","addXsdPadding","ret","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","convertTimestampToXsd","datetime","ptime","dividor","vals","scriptid","src","existingScript","script","onload","rel","ObjectViewer","HTMLStringViewer","HTMLStringEditor","HTMLBooleanViewer","HTMLBooleanEditor","HTMLChoiceViewer","HTMLChoiceEditor","HTMLCoordinateViewer","HTMLCoordinateEditor","HTMLDateViewer","HTMLDateEditor","HTMLEntityViewer","HTMLEntityEditor","HTMLImageViewer","HTMLImageEditor","HTMLLinkViewer","HTMLNumberViewer","HTMLRangeViewer","HTMLRangeEditor","SantizedHTMLViewer","GoogleMapEditor","GoogleMapViewer","HTMLMarkupEditor","S2EntityEditor","RenderingMap","registeredDataViewers","registeredDataEditors","getValidDataViewerList","frametype","valids","concat","getValidDataEditorList","nftypes","getViewer","datatype","vi","renderers","getAvailableDataViewers","nviewers","sets","getAvailableDataEditors","getViewerForDataFrame","getEditorForDataFrame","registerViewerForTypes","types","registerEditorForTypes","registerEditorForFrameType","registerViewerForFrameType","compiled_options","compileOptions","facets","getDefaultFacets","facet","deffacet","getDefaultFacet","hide_disabled_buttons","controls","viewerType","viewerOptions","header_viewer","HTMLObjectHeaderViewer","filter","sort","DatatypeRenderers","TerminusFrame","client","load_schema","config","setDatatypes","func","loadDocument","getDocument","loadDataFrames","loadDocumentSchema","ncls","getClassFrame","loadSchemaFrames","dataframes","domain","classframes","loadClassFrames","subjid","newDoc","fillFromSchema","render","applyRulesToDocument","doc","rules","rule","loadRenderer","compare","setFrameDisplayOptions","rendname","owner","freeze","CONNECT","GET_SCHEMA","UPDATE_SCHEMA","UPDATE_DOCUMENT","CLASS_FRAME","WOQL_SELECT","GET_DOCUMENT","DELETE_DATABASE","DELETE_DOCUMENT","CREATE_DATABASE","CREATE_DOCUMENT","WOQL_UPDATE","authorityActionsToArr","Array","map","item","URIEncodePayload","payload","encodeURIComponent","payloadArr","keyElement","valueElement","HTMLObjectViewer","properties","headerViewer","renderedDOM","getObjectBodyDOM","getObjectDOM","getContentOrientation","getFeatureDOM","hasFeatureViewer","featureViewer","redrawHeader","nheader","replaceWith","redrawBody","nbody","addRenderedProperty","renderedprop","clear","goTo","subj","goToName","getObjectIDMarker","sumDOM","controlsDOM","showFeature","facetDOM","getObjectFacetDOM","getObjectLabelDOM","idDOM","getObjectIDDOM","typeDOM","getObjectTypeDOM","getObjectStatusDOM","viewDOM","getViewPropertyDOM","hideDOM","getObjectControlsDOM","getObjectSummaryDOM","addDOM","getAddPropertyDOM","getModeSelectorDOM","getObjectDeleteDOM","cpropDOM","getObjectCloneDOM","rpropDOM","getObjectResetDOM","upropDOM","getObjectUpdateDOM","showDOM","getObjectShowDOM","getObjectHideDOM","getAvailableFacets","currentFacet","setFacet","isNewDocument","required","getClassMeta","cmt","getVariableValueFromBinding","getAddableProperties","getViewableProperties","goToProperty","size","renderFrame","dataviewer","renderValue","wrapShortenedText","HTMLPropertyViewer","values","HTMLPropertyHeaderViewer","propDOM","npropDOM","getPropertyDOM","getPropertyIDMarker","getPropertyBodyDOM","addRenderedValue","renderedval","wrapper","expModeMenu","getPropertyControlsDOM","getPropertyLabelDOM","statDOM","getPropertyStatusDOM","prepend","getPropertySummaryDOM","prelude","getPropertyFacetDOM","getViewValueDOM","getPropertyIDDOM","getPropertyRangeDOM","hasCardinalityRestriction","getPropertyCardinalityDOM","getPropertyCommentDOM","getActionControlDOM","settingsDOM","getPropertyDeleteDOM","getAddValueDOM","getPropertyResetDOM","getPropertyUpdateDOM","getPropertyShowDOM","getPropertyHideDOM","getSettingsControlDOM","getViewableValues","goToValue","showValue","HTMLDataViewer","HTMLDataHeaderViewer","valDOM","nvalDOM","getValueDOM","getValueIDMarker","getValueBodyDOM","vdom","getDataValueViewer","getDOM","getSummaryDOM","HTMLTerminusClient","fireInternalLink","preventDefault","load","internalLink","onclick","onClick","getValueFacetDOM","getValueTypeDOM","getValueStatusDOM","getValueControlsDOM","getValueDeleteDOM","getValueCloneDOM","getValueResetDOM","getValueUpdateDOM","getValueShowDOM","getValueHideDOM","initialiseDataRenderers","universalEditor","universalViewer","addPlugins","createRenderer","createDataRenderer","apply","utils","encode","params","paramsSerializer","serializedParams","toISOString","hashmarkIndex","__CANCEL__","normalizeHeaderName","DEFAULT_CONTENT_TYPE","setContentTypeIfUnset","adapter","defaults","process","transformRequest","transformResponse","timeout","xsrfCookieName","xsrfHeaderName","maxContentLength","validateStatus","common","settle","buildURL","parseHeaders","isURLSameOrigin","createError","Promise","resolve","reject","requestData","requestHeaders","request","auth","username","password","Authorization","btoa","onreadystatechange","readyState","responseURL","responseHeaders","getAllResponseHeaders","responseType","statusText","onabort","onerror","ontimeout","cookies","xsrfValue","withCredentials","read","toLowerCase","setRequestHeader","onDownloadProgress","onUploadProgress","upload","cancelToken","promise","abort","enhanceError","message","code","config1","config2","Cancel","CONST","connectionConfig","connection","setClientKey","getClientKey","serverURL","curl","addConnection","capabilities","capabilitiesKeys","pred","auths","actions","actionsArr","j","nrec","serverConnected","capabilitiesPermit","dbid","connectionMode","client_checks_capabilities","rec","getServerRecord","getDBRecord","srvr","connectionObj","okeys","oid","dbCapabilityID","getServerDBRecords","dbrecs","removeDB","dbidCap","newParams","docid","setServer","setDB","setDocument","connected_mode","include_key","includeKey","schemaURL","dbURL","queryURL","frameURL","docURL","platformEndpoint","baseURL","inputStr","context","parser","parseServerURL","parseDBID","setSchemaURL","parseSchemaURL","parseDocumentURL","setQueryURL","parseQueryURL","setClassFrameURL","parseClassFrameURL","setContext","validPrefixedURL","expandPrefixed","validIDString","stripOptionalPath","bit","FramePattern","pattern","setPattern","frame_type","children","depth","checkFrame","rtype","getRendererType","illegalRuleType","checkFrameType","checkLabel","checkSubject","checkSubjectClass","checkProperty","checkDepth","checkRange","checkValue","checkParent","checkChildren","checkIndex","checkStatus","rsubj","IDsMatch","found","numberMatch","propertyIDsMatch","valuesMatch","rangeIDsMatch","rcls","classIDsMatch","ftype","stringMatch","compareIDs","vala","valb","RegExp","test","isProperty","isData","renderer_type","constructor","FramePatternMatcher","FrameRule","testRules","onmatch","matched_rules","patternMatchesFrame","unpack","arr","nonstring","frameType","kids","collapse","showDisabledButtons","headerFeatures","showEmpty","show_empty","featureRenderers","feature_renderers","rend","WOQLQuery","Renderers","TerminusDBViewer","TerminusDocumentViewer","page_config","editor","config_options","getBuiltInViewerOptions","dbViewer","wq","getClassMetaDataQuery","classmeta","instancemeta","execute","wresult","hasBindings","bindings","refreshPage","getJsonLdViewer","clearBusy","pagedom","res","document_json_response","ohv","getDocumentJsonldCreateButton","json_editor","getEncodingChooserDOM","scd","nbuts","enc","oframe","ojson","viewMode","ccDOM","getDocumentInput","inp","vbtn","showDocument","showCreateDocument","dType","styleCreateDocumentChooser","select","getCreateDocumentButton","cbtn","getDocumentCreatorSelect","nq","TerminusHTMLViewer","from","concreteClass","results","qres","showResult","chooser","getDocumentCreatorDOM","getListOfDocuments","getClassesDOM","controldom","loadDocumentHome","styleToggleSwitch","hbtn","jbtn","holder","getInstanceMeta","elid","loadCreateDocument","showBusy","setLabel","showError","deleteDocument","URL","createDocument","extr","showViolations","updateDocument","durl","getOptionsFromPageConfig","ObjectRenderer","controller","FrameConfig","pageconf","getClient","extract","labdom","dfs","getDataFrames","getStdURL","rends","getDocumentPageControls","dpc","default_limit","colid","setPrefixes","shorten","wrapped","getConcreteDocumentClassPattern","varc","getSubclassQueryPattern","not","getAbstractQueryPattern","clsname","queryWrappedWithLimit","getAllDocumentQuery","constraint","triple","getEverythingQuery","wjson","getPropertyListQuery","getElementMetaDataQuery","getClassListMetaDataQuery","getDataOfChosenClassQuery","chosen","getDataOfChosenPropertyQuery","getDocumentQuery","getClassesQuery","CspDatatables","Datatables","wResViewer","qPage","wrViewer","wQuery","currDTSettings","convertToDatatable","tab","dt","table","DataTable","searching","lengthMenu","paging","initComplete","oInstance","$","each","html","columnDefs","targets","createdRow","row","td","find","attr","on","cell","column","showDBMainPage","dbInfo","parents","dbId","deleteDatabase","draw","dtResult","executeQuery","pageInfo","resultDOM","formatResultsForDatatableDisplay","generateNewQueryOnPageChange","qTextDom","queryMode","getCallbackSettings","dtAPIChangeSettings","_iDisplayLength","_iDisplayStart","iDraw","chosenValue","setUp","dtdom","updateCurrDTSettings","getNewDataOnChange","drawnTab","aSettings","getDataFromServer","serverSide","processing","columns","autoWidth","ajax","entries","buttons","scrollX","innerText","selectDocumentNavBar","big","isBigType","getTypeSize","set","vallab","elements","elt","foptions","getChoiceOptions","inputs","parseValue","lldom","getInputDOMs","lat","long","change","latdom","longdom","getLatLongDOM","firstcol","delbut","updateValueFromForm","op","lldoms","butspan","addbut","ipdoms","DateHelper","allowbce","date_spacer","time_spacer","datetime_separator","helper","HTMLDateHelper","parseDate","datepart","getDateComponentDOM","timepart","getTimeComponentDOM","hdom","mdom","mlab","sdom","slab","dadom","ydom","getMonthName","ddom","months","part","xsdFromParsed","tdom","opdom","getEntityViewHTML","getController","getEntityLabel","dv","nspan","il","tit","ic","img","commas","numberWithCommas","delimiter","parseRangeValue","rvals","svals","x","useCommas","tnode","getRangeSymbolDOM","x2","t2node","data1","data2","firstip","secondip","showing_range","but","changeHandler","GoogleMapHelper","mapcontainer","ghelper","initMap","event","addListener","position","latLng","coo","lng","clearMarkers","marker","Marker","markers","path","polyline","getPath","addMarker","getLength","polygon","mapLat","mapLong","zoom","stroke","color","opacity","weight","fill","line","destroy","translatePolygonToArray","vertices","seenValue","xy","getAt","translateArrayToPolygon","array","jsonified","output","latlong","createPolygon","coords","Polygon","paths","strokeColor","strokeOpacity","strokeWeight","fillColor","fillOpacity","setMap","createPolyline","Polyline","getCoordsFromMarkers","mapContainer","center","parseFloat","setPath","trigger","inner","quill","theme","root","ctl","d2ch","TerminusDocumentChooser","QueryPane","DocumentPane","TerminusDBController","container","pages","TerminusDBCreator","dbc","dbrec","nm","ul","page","redrawControls","getControlHTML","showDocumentPage","showQueryPage","showSchemaPage","dburl","q2","concreteDocumentClasses","result2","docClasses","bdom","getBodyAsDOM","getRulesForListOfDocuments","getRulesForGraphOfDocuments","graph","getDocumentsDOM","getHomeDOM","showHappyBox","page_actions","count","dchooser","getCreateDataChooser","showQuery","editQuery","showConfig","editConfig","loadCreateDocumentPage","show_doc_action","getShowDocumentControl","dp","addView","g","ddp","g2","getDeleteOnHomePage","del","di","dbdel","confirm","qopts","ropts","pholder","labels","titles","happy","hbox","ispan","htit","df","setClassLoader","show_all","loadClass","getNavigationDOM","pp","pop","dcip","nbut","is","keyCode","getDocumentTableConfig","rowClick","annotateValue","ID","binding","Class","Description","getExplanation","explaination","nt","first","lg","edge","unicode","ng","sct","mfd","dht","sci","idip","titip","descip","schem","kip","datip","butfield","cancbut","loadbut","schema","gatherips","createDatabase","showServerMainPage","WOQLChooser","WOQLTable","WOQLGraph","WOQLStream","WOQLStreamConfig","WOQLChooserConfig","WOQLTableConfig","WOQLRule","addNamespacesToVariables","vars","nvars","nvar","removeNamespaceFromVariable","mvar","getMatchingRules","matches","match","WOQLGraphConfig","stream","loadJSON","jr","conf","nr","tf","trenderer","setRenderer","json_rules","get_schema","all","show_parts","fp","wqt","direction","onChange","value_variable","label_variable","title_variable","sort_variable","sort_direction","dtypes","column_order","pagesize","pager","order","show_pager","editable","show_pagesize","change_pagesize","show_pagenumber","cols","setVariables","literals","show_literals","source_variable","fontfamily","fontfam","show_force","force","fix_nodes","fixed","explode_out","explode","selected_grows","bigsel","gwidth","gheight","edges","nedges","show_edges","getConfigAsJSON","showfix_nodes_force","estrs","variables","literal","removeNamespacesFromVariables","charge","distance","symmetric","collisionRadius","arrow","border","click","hover","constraints","mjson","w","hdr","onHover","list","current_variable","tester","vundertest","ch","setResult","choices","getVariableList","next","includeRow","rowToChoice","rownum","choice","getRowID","getLabelFromBinding","getTitleFromBinding","getSelectedFromBinding","rval","getSpecialRenderer","renderSpecial","prev","DataValue","datavalue","onChangeQuery","canAdvancePage","getLimit","canChangePage","canRetreatPage","getPage","getPageSize","setPage","setPageSize","update","nextPage","firstPage","previousPage","getColumnsToRender","hasColumnOrder","getColumnOrder","hasSelect","getSelectVariables","col","getColumnHeaderContents","hr","nquery","nresult","notify","hasDefinedEvent","getDefinedEvent","getRowClick","getCellClick","getRowHover","getCellHover","hasCellClick","hasRowClick","hasCellHover","hasRowHover","getSpecificRender","getRendererForDatatype","nvalue","defaultViewers","defaultEditors","specials","record","getEditor","nodes","node_ids","calculateVariableTypes","getEdges","getBindings","rowIncludesEdge","makeEdgesFromRow","getNodes","source_variables","makeNodeFromSource","target_variables","makeNodeFromTarget","adornNode","adornEdge","makeEdgeFromRow","eid","extractFromBinding","lits","includeNode","includeLiteralNode","nid","genBNID","getLiteralOwner","addAdornedNode","addAdornedEdge","createEdgesFromIDs","ndid","ks","kt","nodetype","rad","radius","es","page_size","wqrs","ResultPane","views","fireDefaultQueries","qcres","classMetaDataRes","qpres","propertyMetaDataRes","showHeader","addViews","intro","defaultResultView","getSection","sName","clearSubMenus","smenus","getResults","sampleQueryDOM","AddEvents","choosen","getDataOfClass","getDataOfProperty","getQueryMenu","qName","getSubDataMenu","getSchemaSection","section","checkIfDataMenuOpen","isOpen","child","showDataOfTypeEvent","subPar","showPropertyOfTypeEvent","addCheveronIcon","getDataSection","bd","fireDocumentEvent","documentProperties","getEnterDocumentIdDOM","getDocumentSection","getQueryMenuBlock","getSampleQueriesDOM","showQueryConfig","configspan","qicon","ipdom","hideQueryConfig","createInput","showingQuery","closable","qhdr","getResultPaneHeader","getAddViewControl","savePaneButton","closePaneButton","collapsePaneButton","submitQuery","updateQuery","updateResult","refreshViews","nrp","empty","clearMessages","vd","newView","selector","nv","SimpleTable","woqltable","ctls","getControlsDOM","getTableDOM","ctrls","getPaging","thead","getTableHeader","tbody","getTableBody","thr","th","getColumnHeader","tr","getHTMLRow","getCell","rc","getCellData","isPaged","pdom","pn","getFirst","getPrev","getPageNumber","getNext","chunk","clabel","pval","GraphResultsViewer","SimpleGraph","wgraph","getGraphDOM","gviz","gdom","setData","initDOM","SimpleStream","SimpleChooser","ccdom","ccsel","getEmptyOption","createOptionFromChoice","Datatypes","SimpleFrameViewer","clsid","cloader","classLoader","queryPane","documentLoader","getQueryPane","pane","showDocConfig","nc","ndom","hideDocConfig","showingConfig","renderResult","fpt","termframe","evalstr","updateView","docview","tdv","getScope","getDatatypeViewer","isChoice","isDocument","getFeaturesDOM","orient","getFrameDOM","flist","featuresToCSS","renderProperties","renderValues","TerminusUI","ApiExplorer","TerminusDBsdk","TerminusViolations","TerminusQueryViewer","TerminusSchemaViewer","TerminusServersdk","TerminusURLLoader","setOptions","connect","connectToDB","showView","explorer","showExplorer","dbdets","getBadArguments","myserver","dbdoc","generateNewDatabaseDocument","getSchema","updateSchema","refreshDBList","crec","getCrashString","showMessage","delrec","lid","dbn","dets","fname","getConnectionEndpoint","clearServer","clearDB","TerminusServerViewer","redrawMainPage","showCollaboratePage","showLoadURLPage","showCreateDBPage","getDocViewerOptions","getDocCreatorOptions","mainDOM","messages","clearMainPage","main","setMessageDOM","setbuttonControls","setControllerDOM","setExplorerDOM","setPluginsDOM","setViewerDOM","comps","slocation","toggleDashboardWidget","widget","toggleControl","drawControls","loadControls","ncontrol","nd","drawExplorer","exp","ae","sc","TerminusServerController","show_controls","pseudoCapability","show_views","busy","getBusyLoader","bsyDom","pd","pbc","pbsa","pbia","md","msgHolder","vios","nvios","cmsg","document_options","schema_options","piman","addPlugin","getClassFrameOptions","viewdoc_options","apiNavConfig","mainNav","navText","defaultSelected","database","subNav","getClassFrames","viewDocument","use_fetch","return_full_response","pman","aec","getApiNav","getApiExplorerDom","setSelectedNavMenu","navOnSelect","createNavs","navConfig","navDom","cont","apiCont","getConnectExplorer","getDatabaseExplorer","getSchemaApi","getDocumentApi","getQueryApi","changeSubApiDom","curSubMenu","getDatabaseDom","getShowApiDom","getQueryApiDom","subNavOnSelect","subMenuConfig","createSubNavs","getSignature","getForm","getServerForm","form","fd","inpLabel","cd","inpId","keyLabel","resd","curApi","urlPlaceholder","formDoc","urlLabel","inpUrl","docUrlLabel","inpDocUrl","inpKey","docLabel","inpDoc","docUrl","getApiSendButton","getApiForm","schurl","buttonSelf","gtxtar","txtar","dcurl","schemaUrlDom","htmlEditor","getValue","sg","sig","DispatchRequest","URIError","dispatch","makeDocumentConsistentWithURL","addOptionsToDocument","docurl","qurl","addOptionsToWOQL","cfurl","pdoc","_","addKeyToPayload","dispatchFetch","redirect","referrer","hdrs","credentials","cache","Headers","fetch","ok","btoaImplementation","Buffer","axios","delete","catch","post","base64","ieee754","kMaxLength","TYPED_ARRAY_SUPPORT","createBuffer","that","RangeError","Uint8Array","__proto__","arg","encodingOrOffset","allocUnsafe","TypeError","byteOffset","byteLength","fromArrayLike","fromArrayBuffer","string","encoding","isEncoding","actual","write","fromString","len","copy","fromObject","assertSize","loweredCase","utf8ToBytes","base64ToBytes","slowToString","end","hexSlice","utf8Slice","asciiSlice","latin1Slice","base64Slice","utf16leSlice","swap","bidirectionalIndexOf","dir","isNaN","arrayIndexOf","indexSize","arrLength","valLength","String","buf","readUInt16BE","foundIndex","hexWrite","offset","Number","remaining","strLen","substr","utf8Write","blitBuffer","asciiWrite","byteArray","asciiToBytes","latin1Write","base64Write","ucs2Write","units","hi","lo","utf16leToBytes","fromByteArray","secondByte","thirdByte","fourthByte","tempCodePoint","firstByte","codePoint","bytesPerSequence","codePoints","MAX_ARGUMENTS_LENGTH","fromCharCode","decodeCodePointsArray","SlowBuffer","alloc","INSPECT_MAX_BYTES","global","foo","subarray","typedArraySupport","poolSize","_augment","species","configurable","allocUnsafeSlow","_isBuffer","y","pos","swap16","swap32","swap64","equals","inspect","thisStart","thisEnd","thisCopy","targetCopy","includes","isFinite","toJSON","_arr","out","toHex","bytes","checkOffset","checkInt","objectWriteUInt16","littleEndian","objectWriteUInt32","checkIEEE754","writeFloat","noAssert","writeDouble","newBuf","sliceLen","readUIntLE","mul","readUIntBE","readUInt8","readUInt16LE","readUInt32LE","readUInt32BE","readIntLE","pow","readIntBE","readInt8","readInt16LE","readInt16BE","readInt32LE","readInt32BE","readFloatLE","readFloatBE","readDoubleLE","readDoubleBE","writeUIntLE","writeUIntBE","writeUInt8","floor","writeUInt16LE","writeUInt16BE","writeUInt32LE","writeUInt32BE","writeIntLE","writeIntBE","writeInt8","writeInt16LE","writeInt16BE","writeInt32LE","writeInt32BE","writeFloatLE","writeFloatBE","writeDoubleLE","writeDoubleBE","targetStart","INVALID_BASE64_RE","Infinity","leadSurrogate","toByteArray","stringtrim","base64clean","dst","Function","b64","lens","getLens","validLen","placeHoldersLen","tmp","Arr","_byteLength","curByte","revLookup","uint8","extraBytes","len2","encodeChunk","lookup","isLE","mLen","nBytes","eLen","eMax","eBias","nBits","NaN","rt","LN2","Axios","mergeConfig","createInstance","defaultConfig","instance","instanceConfig","CancelToken","isCancel","promises","spread","default","InterceptorManager","dispatchRequest","interceptors","chain","interceptor","fulfilled","rejected","shift","getUri","handlers","use","eject","transformData","isAbsoluteURL","combineURLs","throwIfCancellationRequested","throwIfRequested","reason","fns","normalizedName","isAxiosError","number","fileName","lineNumber","columnNumber","stack","ignoreDuplicateOf","originURL","msie","userAgent","urlParsingNode","resolveURL","protocol","host","search","hostname","port","pathname","requestURL","expires","secure","cookie","toGMTString","decodeURIComponent","now","relativeURL","executor","resolvePromise","token","parentframe","originalFrames","PropertyFrame","cframe","predicate","DataFrame","ClassFrame","Restriction","loadRestriction","jsonld_context","cf","isValid","hasSchema","frames","domainValue","getPropertyClassFrame","getChosenClassFrame","isLogic","getChosenFrame","addFrame","getAsFrame","ff","getAsFrames","isnew","restrictions","props","ignore_failure","getProperties","filled","missing","nmissing","newb","newid","pf","cloned","getChild","childid","pframe","getProperty","addProperty","createEmpty","createEmptyChoice","clss","getClassChoices","addPropertyValue","addValue","removeProperty","removePropertyValue","removeValue","parentObject","sortProperties","nprops","unsorted","standardCompare","hasRestriction","rest","currentnum","propcount","kid","extracts","updated","childUpdated","deletePropertyValue","gets","cvalues","fs","sortedVals","sortValues","rangeValue","comment","originalValue","nrend","setNew","isValidType","hasCardRestriction","isObjectProperty","isDatatypeProperty","isRestriction","option","lang","getTypeShorthand","contents","normalizer","loadFromObjectFrame","getChosenClassFrames","objframe","operands","dataframe","cloneDataFrame","other","domcls","operand","cardinality","maxCardinality","minCardinality","nrest","no_compress","compress","getContext","nprop","nval","last","compareValues","asc_or_desc","Pattern","chain_ended","contains_update","paging_transitive_properties","vocab","loadDefaultVocabulary","tripleBuilder","nspaces","spaces","TripleBuilder","when","Query","Update","into","or","queries","isa","eq","JSON_or_IRI","delete_triple","S","P","O","delete_quad","G","add_triple","add_quad","as","vari","remote","group_by","gvarlist","groupedvar","groupquery","Q","lower","u","pad","unique","idgen","typecast","vara","varb","arith","plus","minus","times","divide","div","star","classid","propid","deleteClass","deleteProperty","nodeid","isLiteralType","arr1","arr2","buildAsClauses","clauses","va","vb","sq","nlist","upd","advanceCursor","cleanSubject","cleanPredicate","cleanObject","cleanGraph","cleanClass","abstract","lastUpdate","Subject","Predicate","Object_or_Literal","Graph","cleanType","asArray","card","addPO","entity","relationship","GraphIRI","Subj","Pred","Obj","getDocumentConnections","simpleGraphQuery","loadVocabulary","spl","setVocabulary","getVocabulary","getPagingProperty","setLimit","setPagingProperty","psize","hasStart","getStart","pagenum","pstart","setStart","addStart","npage","defaultContext","DB_IRI","def","scm","pageprop","indent","show_context","fluent","newlining_operators","operator","getWOQLPrelude","chainable","uncleanArguments","inline","lastArg","hasShortcut","getShortcut","argIsSubQuery","myas","lhs","rhs","uncleanArgument","allArgs","unclean","cstr","oval","uncleanObjectArgument","nstr","suff","printLine","ttype","evstr","unit","addEntry","getO","clause","os","od","tb","textdom","objectIsEmpty","darkMode","jsonldCheck","fromTextArea","firstLineNumber","lineNumbers","styleActiveLine","lineWrapping","smartIndent","indentWithTabs","newlineAndIndent","autoCloseBrackets","matchBrackets","afterCursor","extraKeys","foldCode","getCursor","refresh","foldGutter","gutters","Pos","setCodemirrorSize","setSize","defaultCharWidth","setOption","setTimeout","runMode","WOQLResultsViewer","woqlResult","queryPage","showTable","show_table","orderColumns","sample","ordered","displayResultHeader","rs","rh","nor","getTable","getDtTableDOMOnChange","colDataData","formattedResult","ordered_headings","outerHTML","recordsTotal","recordsFiltered","getDocumentLocalLink","dtPlugin","ValueRenderer","PropertyViewer","PropertyRenderer","originalValues","changed","originalProperties","newProperties","TerminusDashboard","decorateRenderer","getOptionsForChild","getOptionsForValue","getOptionsForObject","buildValueRenderers","getViewerForProperty","adorig","getDataFramesToRender","vr","getChildrenToRender","kidf","viewIncludesChildren","allkids","getChildren","clsmeta","addPropertyClass","nvals","new_property","hideDisabledControls","hide_disabled_controls","nocascade","parentFacetChange","multiline","summary","containsPage","setView","getAvailablePropertyViewers","getAvailablePropertyEditors","nukeViewer","ptype","getPropertyHeaderViewer","valcount","vsum","getFeaturesForFacet","getOptionsForProperty","buildPropertyRenderers","getViewerForObject","getPropertiesToRender","renders","nkid","parentobj","newrend","demandid","inputID","dval","new_object","isPartOfNewDocument","pfacet","vrend","getObjectHeaderViewer","JSONObjectViewer","nviewer","standardSort","patterns","sorted","rdft","rdfc","extractLDO","extractJSONLD","extracted","nf","nvr","getAPIURL","DBURL","getEntityReference","entities","badData","new_value","text_summary_length","getViewerForValue","objlit","getValueHeaderViewer","getViewerForDataValue","ft","WOQLQueryView","querypane","qp","changeViewType","getResultDOM","getViewConfigIconClass","cvicons","getViewTypeIconDOM","getDefaultViewerIcon","getIconForViewer","changeViewerType","wres","svg","visid","chars","randomString","currentDate","link_elements","node_elements","loadedNodes","focusNodes","links","selected_id","setConfigOptions","initD3","d3DOM","loadNewData","updateGraph","updateSimulation","dqr","updateData","setFocusNodeFromResult","reload","getFocusNode","setFilter","simulation","stop","wake","hibernate","no_animate","nnodes","getNodesAndFringes","snode","nnode","fx","fy","getLinks","scale_factor","setWidth","setHeight","clientWidth","clientHeight","jqid","append","forceSimulation","forceLink","getLinkDistance","forceManyBody","strength","getCharge","forceCollide","getCollisionRadius","forceCenter","drag_drop","drag","restart","zoomed","link_group","classed","node_group","current_transform","transform","follow_node_wrapper","graph_node","nodeSelected","selectAll","exit","node_enter","enter","getRadius","isFringe","getNodeIconUnicode","styleNodeElements","link_enter","styleLinkElements","alpha","getNodeColour","getNodeText","getNodeIconWeight","getNodeIconSize","getNodeIconColour","getLineWidth","getEdgeArrow","getEdgeColour","getLinkText","getEdgeDirection","reference","getArrowWidth","getArrowHeight","selected_node","selection_grows","getScaleTransform","scale","min_ratio","new_mol_width","new_mol_height","y_trans","x_trans","transition","duration","scaleToFit","min_x","min_y","max_x","max_y","mol_width","mol_height","width_ratio","height_ratio","recentre","translated","dcx","dcy","text_elements","faclass","getMultiplier","mult","colrad","linkDistance","getNodeIcon","isNeighbourLink","added","upgraded","TerminusViolation","context_msg","vioHeading","getPropertyAsDOM","ldom","ScriptPane","panes","new_pane","new_pane_type","meta","newPaneOptions","addQueryPane","qpane","addScriptPane","addScriptPaneDOM","addNewPaneDOM","addQueryPaneDOM","setNewDocumentPaneDOM","addDocumentPaneDOM","lpane","paneDOM","lastChild","qdom","getPaneHeader","getPanesDOM","controlDOM","panesDOM","npd","nqhdr","getNewPaneHeader","headerDOM","removePane","showPane","hidePane","newPaneButton","newScriptButton","newDocButton","executeScript","showOKMessage","TerminusClassChooser","confirm_before_update","thv","changeHeaders","setGraphSize","getOWLView","loadSchema","appendRuleViews","appendClassViews","appendPropertyViews","qprops","qclasses","getAllProperties","getAllClasses","defineViewAction","getTabs","getSchemaViews","tview","msgtype","resetControlDOM","getSchemaSaveButtons","getSchemaImportActionButtons","getShowSchemaButton","getClassFrameChooser","getSchemaEditButton","getImportButton","getNewLibaryButton","refreshMainPage","getSchemaViewDOM","getSchemaEditDOM","getSchemaImportDOM","getClassFrameDOM","ssb","getCancelButton","getSaveButton","getImportSaveButton","getSchemaButton","getImportPreviewButton","is_import","doImport","schema_edit_dom","schema_edit_dom_name","origurl","newschema","appendSchema","showConfirmPage","s2","nschema","np","termcc","empty_choice","new_class","tcdom","docviewer","getSchemaNameInputDOM","ipval","klab","modes","overwrite","show_single","setRoot","getResultsAsOptions","clist","opt1","bclass","SimpleDocument","DocumentTable","setRenderers","snippetText","showConfigEditor","cSnippet","actionButton","cObj","submitConfig","cdom","cDisplay","displayResults","loadResults","last_result","WOQLQueryViewer","ruleEditor","getAddRuleButton","rbtn","getConfigButton","wqv","queryViewer","WOQLChoice","renderProperty","td2","rsc","getServerLabelDOM","srec","desc","csbut","crbut","getDBListDOM","getServerDetailsDOM","scl","scs","wrapTableLinkCell","tdElement","getNDBListDOM","sec","th1","th2","th3","th4","th5","th6","fullid","td1","td3","td4","td5","td6","deleteDBPermitted","delDB","url_input","key_input","getLabelDOM","getFormFieldDOM","ip","ltxt","loadbuts"],"mappings":"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","file":"terminus-dashboard.min.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 70);\n","'use strict';\r\nmodule.exports = {\r\n\t\t\t\t WOQLClient:require('./lib/woqlClient'),\r\n                  ConnectionCapabilities:require('./lib/connectionCapabilities'),\r\n                  ConnectionConfig:require('./lib/connectionConfig'),\r\n                  IDParser:require('./lib/terminusIDParser'),\r\n                  ErrorMessage:require('./lib/errorMessage'),\r\n                  FrameHelper:require('./lib/frameHelper'),\r\n                  ObjectFrame:require('./lib/objectFrame'),\r\n                  WOQLResult:require('./lib/woqlResult'),\r\n                  WOQL:require('./lib/woql')};","const TerminusPluginManager = require('../plugins/TerminusPlugin');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\nlet HTMLFrameHelper = {};\r\n\r\nHTMLFrameHelper.getActionControl = function(type, control, label, callback, disabled){\r\n\tvar pman = new TerminusPluginManager();\r\n\tvar dpropDOM = document.createElement(\"span\");\r\n\tdpropDOM.setAttribute(\"class\", \"terminus-action-control terminus-save-btn \" + type + \"-\" + control);\r\n\tvar pman = new TerminusPluginManager();\r\n    /*if(pman.pluginAvailable(\"font-awesome\")){\r\n\t\tvar icon = document.createElement('icon');\r\n\t\tvar faic = this.getControlIcon(control);\r\n\t\tif(disabled){\r\n\t\t\ticon.setAttribute(\"class\", \"terminus-frame-control frame-control-action action-disabled fa fa\" + faic + \" \" + type + \"-\" + control + \"-disabled terminus-font-align\");\r\n\t\t\ticon.setAttribute(\"title\", disabled);\r\n\t\t}\r\n\t\telse {\r\n\t\t\ticon.setAttribute(\"class\", \"terminus-frame-control frame-control-action frame-control-action fa fa\" + faic + \" \" + type + \"-\" + control + \" terminus-font-align\");\r\n\t\t\ticon.addEventListener(\"click\", function(){\r\n\t\t\t\tcallback(control);\r\n\t\t\t});\r\n\t\t}\r\n\t\tdpropDOM.appendChild(icon);\r\n\t}\r\n\telse{*/\r\n\t\tvar button = document.createElement(\"button\");\r\n\t\tbutton.appendChild(document.createTextNode(label));\r\n\t\tif(disabled){\r\n\t\t\tbutton.setAttribute(\"class\", \"terminus-frame-control terminus-frame-btn frame-control-action action-disabled \" + type + \"-\" + control + \"-disabled\");\r\n\t\t\tbutton.setAttribute(\"title\", disabled);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tbutton.setAttribute(\"class\", \"terminus-frame-control terminus-frame-btn frame-control-action \" + type + \"-\" + control);\r\n\t\t\tbutton.addEventListener(\"click\", function(){\r\n\t\t\t\tif(this.innerHTML == 'Save'){\r\n\t\t\t\t\tvar objId = document.getElementsByClassName('terminus-object-id-input');\r\n\t\t\t\t\tif(objId.length>0){\r\n\t\t\t\t\t\tif(!objId[0].value){\r\n\t\t\t\t\t\t\tobjId[0].setAttribute('placeholder', 'Required field');\r\n\t\t\t\t\t\t\tobjId[0].style.background = '#f8d7da';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse callback(control);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse callback(control);\r\n\t\t\t\t}\r\n\t\t\t\telse callback(control);\r\n\t\t\t\t//(control);\r\n\t\t\t});\r\n\t\t}\r\n\t\tdpropDOM.appendChild(button);\r\n\t//}\r\n\treturn dpropDOM;\r\n}\r\n\r\nHTMLFrameHelper.getSettingsControl = function(view){\r\n\tvar pman = new TerminusPluginManager();\r\n\tif(pman.pluginAvailable(\"font-awesome\")){\r\n\t\tvar icon = document.createElement('icon');\r\n\t\tif(view == 'property') icon.setAttribute('class', 'fa fa-cog terminus-pointer');\r\n\t\telse if(view == 'data') icon.setAttribute('class', 'fa fa-edit terminus-pointer');\r\n\t\ticon.setAttribute('style', 'margin: 10px;')\r\n\t\treturn icon;\r\n\t}\r\n\telse{\r\n\t\tvar button = document.createElement(\"button\");\r\n\t\tbutton.setAttribute('class', 'terminus-btn');\r\n\t\tbutton.appendChild(document.createTextNode('Settings'));\r\n\t\treturn button;\r\n\t}\r\n}\r\n\r\nHTMLFrameHelper.getControlIcon = function(control){\r\n\tvar icon;\r\n\tswitch(control){\r\n\t\tcase 'delete':\r\n\t\t\ticon = '-alt-delete';\r\n\t\tbreak;\r\n\t\tcase 'add':\r\n\t\t\ticon = '-plus';\r\n\t\tbreak;\r\n\t\tcase 'reset':\r\n\t\t\ticon = '-undo';\r\n\t\tbreak;\r\n\t\tcase 'save':\r\n\t\t\ticon = '-save';\r\n\t\tbreak;\r\n\t\tcase 'hide':\r\n\t\t\ticon = '-eye-slash';\r\n\t\tbreak;\r\n\t}\r\n\treturn icon;\r\n}\r\n\r\nHTMLFrameHelper.getSelectionControl = function(type, options, selected, callback){\r\n\tvar sel = document.createElement(\"select\");\r\n\tsel.setAttribute(\"class\", \"terminus-frame-selector frame-control-selection \" + type);\r\n\tfor(var i = 0; i < options.length; i++){\r\n\t\tvar opt = document.createElement(\"option\");\r\n\t\tif(typeof options[i] == \"object\"){\r\n\t\t\topt.value = options[i].value;\r\n\t\t\tvar label = (options[i].label ?  document.createTextNode(options[i].label) : document.createTextNode(TerminusClient.FrameHelper.labelFromURL(options[i].value)));\r\n\t\t\topt.appendChild(label);\r\n\t\t}\r\n\t\telse {\r\n\t\t\topt.value = options[i];\r\n\t\t\tlabel = TerminusClient.FrameHelper.labelFromURL(opt.value);\r\n\t\t\topt.appendChild(document.createTextNode(label));\r\n\t\t}\r\n\t\tif(selected == opt.value){\r\n\t\t\topt.setAttribute(\"selected\", \"selected\");\r\n\t\t}\r\n\t\tsel.appendChild(opt);\r\n\t}\r\n\tsel.addEventListener(\"change\", function(){\r\n\t\tcallback(this.value);\r\n\t});\r\n\treturn sel;\r\n}\r\n\r\nHTMLFrameHelper.getModeSelectorDOM = function(which, renderer){\r\n\tvar viewsDOM = document.createElement(\"span\");\r\n\tviewsDOM.setAttribute(\"class\", \"terminus-mode terminus-\"+which+\"-mode\");\r\n\tif(renderer.mode == \"view\"){\r\n\t\tvar callback = function(){ renderer.setMode(\"edit\");}\r\n\t\tviewsDOM.appendChild(HTMLFrameHelper.getActionControl(\"terminus-mode terminus-\"+which+\"-mode\", \"edit\", \" Edit \", callback));\r\n\t}\r\n\telse if(renderer.isNew()){\r\n\t\treturn false;\r\n\t}\r\n\telse {\r\n\t\tvar callback = function(){ renderer.cancel();}\r\n\t\tviewsDOM.appendChild(HTMLFrameHelper.getActionControl(which, \"cancel\", \"Cancel\", callback));\r\n\t}\r\n\treturn viewsDOM;\r\n}\r\n\r\nHTMLFrameHelper.goToName = function(s, p, i){\r\n\tvar url = window.location.href;\r\n\tif(url){\r\n\t\tvar wbits = url.split(\"#\");\r\n\t\tvar loc = wbits[0];\r\n\t\tvar sh = TerminusClient.FrameHelper.getShorthand(s);\r\n\t    if(!sh) sh = s;\r\n\t\tvar bits = sh.split(\":\");\r\n\t\tif(bits.length > 1) sh = bits[1];\r\n\t\tvar htmlid = sh;\r\n\t\tif(p){\r\n\t\t\tvar prop = TerminusClient.FrameHelper.getShorthand(p);\r\n\t\t\tif(!prop ) prop = p;\r\n\t\t\tvar bits = prop.split(\":\");\r\n\t\t\tif(bits.length > 1) prop = bits[1];\r\n\t\t\thtmlid += \"_\" + prop;\r\n\t\t\tif(i){\r\n\t\t\t\thtmlid += \"_\" + i;\r\n\t\t\t}\r\n\t\t}\r\n\t\twindow.location = loc + \"#\" + htmlid;\r\n\t}\r\n}\r\n\r\nHTMLFrameHelper.wrapShortenedText = function(wrap, text, max_cell_size, max_word_size){\r\n\tif(max_cell_size && (text.length > max_cell_size)){\r\n\t\twrap.setAttribute(\"title\", text);\r\n\t\ttext = text.substring(0, max_cell_size) + \"...\";\r\n\t}\r\n\tif(max_word_size){\r\n\t\tconst replacements = {}\r\n\t\tconst words = text.split(\" \");\r\n\t\tfor(var i = 0; i < words.length; i++){\r\n\t\t\tvar word = words[i];\r\n\t\t\tif(word.length > max_word_size){\r\n\t\t\t\twrap.setAttribute(\"title\", text);\r\n\t\t\t\tvar newstr = word.substring(0, max_word_size) + \"...\";\r\n\t\t\t\treplacements[word] = newstr;\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor(var k in replacements){\r\n\t\t\ttext = text.replace(k, replacements[k]);\r\n\t\t}\r\n\t}\r\n\twrap.appendChild(document.createTextNode(text));\r\n}\r\n\r\nHTMLFrameHelper.getVariableValueFromBinding = function(varname, bind){\r\n\tfor(var key in bind){\r\n\t\tvar skey = key.substring(key.lastIndexOf(\"/\")+1);\r\n\t\tif(skey == varname){\r\n\t\t\tconst obj = bind[key];\r\n\t\t\tif(typeof obj == \"object\" && obj['@value']) return obj['@value'];\r\n\t\t\treturn obj;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\n\r\nHTMLFrameHelper.getInfoboxDOM = function(type, label, value, help, input){\r\n\t/*var frow = this.getFrameRow();\r\n\tvar fgroup = this.getFrameGroup(frow);*/\r\n\tvar infoDOM = document.createElement(\"span\");\r\n\tinfoDOM.setAttribute(\"class\", \"terminus-frame-infobox-box \" + \"terminus-\" +type );\r\n\t//fgroup.appendChild(infoDOM);\r\n\tif(help){\r\n\t\tinfoDOM.setAttribute(\"title\", help);\r\n\t}\r\n\tif(label){\r\n\t\tvar linfo = document.createElement(\"span\");\r\n\t\tlinfo.setAttribute(\"class\", \"terminus-frame-infobox-label \" + \"terminus-\" +type + \"-label\");\r\n\t\tlinfo.appendChild(document.createTextNode(label));\r\n\t\tinfoDOM.appendChild(linfo);\r\n\t}\r\n\tvar lspacer = document.createElement(\"span\");\r\n\tlspacer.setAttribute(\"class\", \"terminus-frame-infobox-spacer \" + \"terminus-\" +type + \"-spacer\");\r\n\tlspacer.appendChild(document.createTextNode(\" \"));\r\n\tinfoDOM.appendChild(lspacer);\r\n\tvar lval = document.createElement(\"span\");\r\n\tlval.setAttribute(\"class\", \"terminus-frame-infobox-value \" + \"terminus-\" +type + \"-value\");\r\n\tif(input){\r\n\t\tinput.value = value;\r\n\t\tlval.appendChild(input);\r\n\t}\r\n\telse if(value) {\r\n\t\tvar sh = TerminusClient.FrameHelper.getShorthand(value);\r\n        if(sh){\r\n    \t   \tvar bits = sh.split(\":\");\r\n            sh = bits[1];\r\n   \t\t\tlval.setAttribute(\"title\", value);\r\n\t\t\tlval.appendChild(document.createTextNode(sh));\r\n\t\t}\r\n\t\telse {\r\n\t\t\tlval.appendChild(document.createTextNode(value));\r\n\t\t}\r\n\t}\r\n\tinfoDOM.appendChild(lval);\r\n\treturn infoDOM;\r\n}\r\n\r\n/*\r\n * HTML drawing function for document rendering \r\n */\r\n\r\nHTMLFrameHelper.getFrameDOM = function(scope, frame, orientation, hfeatures, features){\r\n\tif(frame.display_options.hidden) return false;\r\n\tvar framedom = HTMLFrameHelper.getFrameHolderDOM(scope, frame, orientation);\r\n\tif(typeof frame.display_options.header != \"undefined\"){\r\n\t\tif(typeof frame.display_options.header == \"function\"){\r\n\t\t\tvar hd = frame.display_options.header(frame.display_options.header_features, hfeatures);\r\n\t\t\tframedom.appendChild(hd);\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tvar hd = HTMLFrameHelper.getFrameHeaderDOM(scope, frame, orientation, hfeatures);\r\n\t\tif(hfeatures) hd.appendChild(hfeatures);\r\n\t\tframedom.appendChild(hd);\r\n\t}\r\n\treturn framedom.appendChild(HTMLFrameHelper.getFrameBodyDOM(scope, frame, orientation, features));\r\n}\r\n\r\nHTMLFrameHelper.getFrameHolderDOM = function(scope, frame, orientation){\r\n\tvar pcls = \"terminus-\" + scope + \"-frame\";\r\n\tif(orientation == \"page\"){\r\n\t\tvar sp = document.createElement(\"div\");\r\n\t}\r\n\telse {\r\n\t\tvar sp = document.createElement(\"span\");\r\n\t}\r\n\tvar css = pcls + \" \" + pcls + \"-\" + orientation + \r\n\t\t(scope == \"object\" && frame.parent ? \"\" : \" terminus-root-frame\") \r\n\t\t+ \" \" + pcls + \"-\" + frame.display_options.mode;\r\n\tsp.setAttribute(\"class\", css);\r\n\tif(scope == \"object\"){\r\n\t\tsp.setAttribute(\"data-class\", frame.subjectClass());\r\n\t\tsp.setAttribute(\"data-id\", frame.subject());\t\t\r\n\t\tvar hid = this.hash(frame.subject());\r\n\t}\r\n\telse if(scope == \"property\"){\r\n\t\tsp.setAttribute('data-property', frame.property());\t\r\n\t\tvar hid = this.hash(frame.subject()+frame.property());\r\n\t}\r\n\telse if(scope == \"data\"){\r\n\t\tsp.setAttribute('data-value', frame.get());\r\n\t\tvar hid = this.hash(frame.subject() + frame.property() + frame.index);\r\n\t}\r\n\tvar idm = document.createElement(\"a\");\r\n\tidm.setAttribute(\"class\", \"terminus-\" + scope + \"-idmarker\");\r\n\tidm.setAttribute(\"name\", hid);\t\t\t\t\r\n    sp.appendChild(idm);\r\n\treturn sp;\r\n}\r\n\r\nHTMLFrameHelper.getFrameHeaderDOM = function(scope, frame, orientation, features){\r\n\tvar css = \"terminus-\" + scope + \"-header\";\r\n\tif(orientation == \"page\"){\r\n\t\tvar objDOM = document.createElement(\"div\");\r\n\t}\r\n\telse {\r\n\t\tvar objDOM = document.createElement(\"span\");\r\n\t}\r\n\tobjDOM.setAttribute(\"class\", css + \" \" + css + \"-\" + orientation);\r\n    if(features) objDOM.appendChild(features);\r\n\treturn objDOM;\r\n}\r\n\r\nHTMLFrameHelper.getFrameBodyDOM = function(scope, frame, orientation, features){\r\n\tvar css = \"terminus-\" + scope + \"-properties\";\r\n\tif(orientation == \"page\"){\r\n\t\tvar vholder = document.createElement(\"div\");\r\n\t}\r\n\telse {\r\n\t\tvar vholder = document.createElement(\"span\");\r\n\t}\r\n    vholder.setAttribute('class', css + \" \" + css + \"-\" + orientation);\r\n    if(features) vholder.appendChild(features);\r\n    return vholder;\r\n}\r\n\r\nHTMLFrameHelper.hash = function(s) {\r\n\tvar hash = 0, i, chr;\r\n\tif (s.length === 0) return hash;\r\n\tfor (i = 0; i < s.length; i++) {\r\n\t    chr   = s.charCodeAt(i);\r\n\t    hash  = ((hash << 5) - hash) + chr;\r\n\t    hash |= 0; // Convert to 32bit integer\r\n\t}\r\n\treturn hash;\r\n};\r\n\r\nHTMLFrameHelper.getFeatureDOM = function(feature, scope, frame){\r\n\tif(feature == \"id\"){\t\r\n\t\tif(scope == \"object\") var val = frame.subject();\r\n\t\telse if(scope == \"property\") var val = frame.property();\r\n\t\tif(val == \"_:\") var val = \"New Document\";\r\n\t\treturn HTMLFrameHelper.getInfoboxDOM(\"object-id\", \"ID\", val, \"The URL that identifies this data object\");\r\n\t}\r\n\telse if(feature == \"summary\"){\r\n\t\tvar sum = frame.getSummary();\r\n\t\treturn HTMLFrameHelper.getInfoboxDOM(scope + \"-summary\", false, sum.long, sum.status);\r\n\t}\r\n\telse if(feature == \"label\"){\r\n\t\tvar lab = frame.getLabel();\r\n\t\tif(lab){\r\n\t\t\treturn HTMLFrameHelper.getInfoboxDOM(scope + \"-type\", false, lab);\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\telse if(feature == \"status\"){\r\n\t\tvar sum = frame.getSummary();\r\n\t\treturn HTMLFrameHelper.getInfoboxDOM(scope + \"-status-\"+sum.status, false, sum.status, sum.status);\r\n\t}\r\n\telse if(feature == \"comment\"){\r\n\t\tvar lab = frame.getComment();\r\n\t\treturn HTMLFrameHelper.getInfoboxDOM(\"property-comment\", false, lab);\r\n\t}\r\n\telse if(feature == \"type\"){\r\n\t\tif(scope == \"property\" && frame.display_options.mode == \"edit\" && frame.parent && frame.parent.isClassChoice() && frame.isNew()){\r\n\t\t\treturn this.getClassChoiceTypeSelector(frame);\r\n\t\t}\r\n\t\tif(scope == \"object\") var lab = frame.subjectClass();\r\n\t\telse if(scope == \"property\") var lab = frame.range();\r\n\t\telse if(scope == \"data\") var lab = frame.getType();\r\n\t\tif(lab){\r\n\t\t\treturn HTMLFrameHelper.getInfoboxDOM(scope + \"-type\", \"Type\", lab);\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\telse if(feature == \"delete\"){\r\n\t\tvar callback = function(){frame.delete()};\r\n\t\tvar disabled = false;\r\n\t\tif(!frame.cardControlAllows(\"delete\", scope)){\r\n\t\t\tif(!frame.display_options.show_disabled_buttons){\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tdisabled = \"Cardinality rules prevent deleting this element\";\r\n\t\t}\r\n\t\treturn HTMLFrameHelper.getActionControl(scope, \"delete\", \"Delete\", callback, disabled);\r\n\t}\r\n\telse if(feature == \"clone\"){\r\n\t\tvar callback = function(){frame.clone()};\r\n\t\tvar disabled = false;\r\n\t\tif(!frame.cardControlAllows(\"clone\", scope)){\r\n\t\t\tif(!frame.display_options.show_disabled_buttons){\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tdisabled = \"Cardinality rules prevent cloning this element\";\r\n\t\t}\r\n\t\treturn HTMLFrameHelper.getActionControl(scope, \"clone\", \"Clone\", callback, disabled);\r\n\t}\r\n\telse if(feature == \"reset\"){\r\n\t\tvar callback = function(){frame.reset()};\r\n\t\tvar disabled = false;\r\n\t\tif(!frame.isUpdated()){\r\n\t\t\tif(!frame.display_options.show_disabled_buttons){\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tdisabled = \"No changes have been made to this element\";\r\n\t\t}\r\n\t\treturn HTMLFrameHelper.getActionControl(scope, \"reset\", \"Reset\", callback, disabled);\r\n\t}\r\n\telse if(feature == \"hide\"){\r\n\t\tvar callback = function(){frame.hide()};\r\n\t\treturn HTMLFrameHelper.getActionControl(scope, \"hide\", \"Hide\", callback);\r\n\t}\r\n\telse if(feature == \"show\"){\r\n\t\tvar callback = function(){frame.show()};\r\n\t\treturn HTMLFrameHelper.getActionControl(scope, \"show\", \"Show\", callback);\r\n\t}\r\n\telse if(feature == \"update\"){\r\n\t\tvar callback = function(){frame.save()};\r\n\t\tif(!frame.isUpdated() && !frame.display_options.show_disabled_buttons){\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tvar disabled = frame.isUpdated() ? false : \"No changes have been made to this element\";\r\n\t\treturn HTMLFrameHelper.getActionControl(scope, \"save\", \"Save\", callback, disabled);\r\n\t}\r\n\telse if(feature == \"viewer\"){\r\n\t\treturn this.getViewerSelectorDOM(scope, frame);\r\n\t}\r\n\telse if(feature == \"view\"){\r\n\t\treturn this.getViewEntryDOM(scope, frame);\r\n\t}\r\n\telse if(feature == \"cardinality\"){\r\n\t\treturn this.getCardinalityDOM(scope, frame);\r\n\t}\r\n\telse if(feature == \"add\"){\r\n\t\treturn this.getAddDOM(scope, frame);\r\n\t}\r\n}\r\n\r\nHTMLFrameHelper.getViewerSelectorDOM = function(scope, frame){\r\n\tvar viewers = frame.terminus.datatypes.getAvailableViewers();\r\n\tvar r = this.terminus.datatypes.getRenderer(t);\r\n\r\n\tif(viewers && viewers.length){\r\n\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-\" + scope + \"-viewer\");\r\n\t\tvar callback = function(viewer){\r\n\t\t\tif(viewer){\r\n\t\t\t\tframe.setViewer(viewer);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar selected = frame.currentViewer();\r\n\t\tvar sel = HTMLFrameHelper.getSelectionControl(scope + '-viewer', viewers, selected, callback);\r\n\t\tmpropDOM.appendChild(sel);\r\n\t\treturn mpropDOM;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\n\r\n/* needs html viewer context for goto */\r\nHTMLFrameHelper.getViewEntryDOM = function(scope, frame){\r\n\tif(scope == \"object\"){\r\n\t\tvar viewables = frame.getFilledPropertyList();\r\n\t}\r\n\telse if(scope == \"property\"){\r\n\t\t\r\n\t}\r\n\tvar self = this;\r\n\tif(viewables && viewables.length){\r\n\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-\"+scope + \"-view-entry\");\r\n\t\tviewables.unshift({ value: \"\", label: \"View \" + scope});\r\n\t\tvar callback = function(add){\r\n\t\t\tif(add){\r\n\t\t\t\tframe.goToEntry(add);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar sel = HTMLFrameHelper.getSelectionControl(scope + \"-view-entry\", viewables, \"\", callback);\r\n\t\tmpropDOM.appendChild(sel);\r\n\t\treturn mpropDOM;\r\n\t}\r\n\treturn false;\r\n\t\r\n}\r\n\r\nHTMLFrameHelper.getCardinalityDOM = function(scope, frame){\r\n\tvar restriction = frame.getRestriction();\r\n\tif(restriction.min && restriction.max){\r\n\t\tif(restriction.min == restriction.max){\r\n\t\t\tvar lab = restriction.min;\r\n\t\t\tvar help = \"Cardinality: \" + restriction.min;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tvar lab = restriction.min + \"-\" + restriction.max;\r\n\t\t\tvar help = \"Minimum Cardinality: \" + restriction.min;\r\n\t\t\thelp += \", Maximum Cardinality: \" + restriction.max;\r\n\t\t}\r\n\t}\r\n\telse if(restriction.min){\r\n\t\tvar lab = \">\"+(restriction.min-1);\r\n\t\tvar help = \"Minimum Cardinality: \" + restriction.min;\r\n\t}\r\n\telse if(restriction.max){\r\n\t\tvar lab = \"<\"+(restriction.max+1);\r\n\t\tvar help = \"Maximum Cardinality: \" + restriction.max;\r\n\t}\r\n\telse {\r\n\t\treturn false;\r\n\t}\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"property-cardinality\", \"Cardinality\", lab, help);\r\n}\r\n\r\nHTMLFrameHelper.getClassChoiceTypeSelector = function(frame){\r\n\tvar cs = frame.parent.getAvailableClassChoices();\r\n\tif(cs && cs.length){\r\n\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-property-change-class\");\r\n\t\tvar mlabDOM = document.createElement(\"span\");\r\n\t\tmlabDOM.setAttribute(\"class\", \"terminus-property-change-label\");\r\n\t\tmlabDOM.appendChild(document.createTextNode(\"Type\"));\r\n\t\tmpropDOM.appendChild(mlabDOM);\r\n\t\tvar callback = function(cls){\r\n\t\t\tif(cls){\r\n\t\t\t\tframe.changeClass(cls);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"change-class\", cs, frame.subjectClass(), callback);\r\n\t\tmpropDOM.appendChild(sel);\r\n\t\treturn mpropDOM;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLFrameHelper.getAddDOM = function(scope, frame){\r\n\tif(scope == \"property\"){\r\n\t\tif(frame.isClassChoice()){\r\n\t\t\tvar cs = frame.getAvailableClassChoices();\r\n\t\t\tif(cs && cs.length){\r\n\t\t\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\t\t\tmpropDOM.setAttribute(\"class\", \"terminus-property-add-class\");\r\n\t\t\t\tcs.unshift({ value: \"\", label: \"Add Type\"});\r\n\t\t\t\tvar callback = function(cls){\r\n\t\t\t\t\tif(cls){\r\n\t\t\t\t\t\tframe.addClass(cls);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"add-property\", cs, \"\", callback);\r\n\t\t\t\tmpropDOM.appendChild(sel);\r\n\t\t\t\treturn mpropDOM;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(frame.cardControlAllows(\"add\") || frame.display_options.show_disabled_buttons){\r\n\t\t\tvar callback = function(){frame.add(\"edit\")};\r\n\t\t\tvar disabled = (frame.cardControlAllows(\"add\") ? false : \"Cardinality Rules Forbid Add\");\r\n\t\t\treturn HTMLFrameHelper.getActionControl(scope + \"-add-entry\", \"add\", \"Add\", callback, disabled);\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tvar addables = frame.getMissingPropertyList();\r\n\t\tif(addables && addables.length){\r\n\t\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\t\tmpropDOM.setAttribute(\"class\", \"terminus-\" + scope + \"-add-entry\");\r\n\t\t\taddables.unshift({ value: \"\", label: \"Add new \" + scope});\r\n\t\t\tvar callback = function(add){\r\n\t\t\t\tif(add){\r\n\t\t\t\t\tif(scope == \"object\") frame.addNewProperty(add);\r\n\t\t\t\t\telse if(scope == \"property\") frame.addNewValue(add);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif(frame.cardControlAllows(\"add\") || frame.display_options.show_disabled_buttons){\r\n\t\t\t\tvar disabled = (frame.cardControlAllows(\"add\") ? false : \"Cardinality rules forbid adding element\");\r\n\t\t\t\tvar sel = HTMLFrameHelper.getSelectionControl(scope + \"-add-entry\", addables, \"\", callback, disabled);\r\n\t\t\t\tmpropDOM.appendChild(sel);\r\n\t\t\t\treturn mpropDOM;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nmodule.exports=HTMLFrameHelper\r\n","/**\r\n * @file Javascript Api explorer tool\r\n * @author Kitty Jose\r\n * @license Copyright 2018-2019 Data Chemist Limited, All Rights Reserved. See LICENSE file for more\r\n *\r\n * @summary Set of functions used across scripts\r\n */\r\nconst Codemirror= require('./plugins/codemirror.terminus');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\n// function to read Files\r\nfunction readFile(file){\r\n    if (window.XMLHttpRequest){\r\n        // code for IE7+, Firefox, Chrome, Opera, Safari\r\n        xmlhttp=new XMLHttpRequest();\r\n    }\r\n    else{\r\n        // code for IE6, IE5\r\n        xmlhttp=new ActiveXObject(\"Microsoft.XMLHTTP\");\r\n    }\r\n    xmlhttp.open(\"GET\",file,false);\r\n    xmlhttp.send();\r\n    xmlDoc=xmlhttp.responseText;\r\n    return xmlDoc;\r\n} // readFile()\r\n\r\n// function to write api call signatures from woql client\r\nfunction getFunctionSignature(which){\r\n  var sigs = {};\r\n  sigs.connect = {\r\n    spec   : \"WOQLClient.connect(surl, key)\",\r\n    descr  : \"\\n\\nConnect to a Terminus server at the given URI with an API key\"\r\n                + \"Stores the terminus:ServerCapability document returned in the connection register\"\r\n                + \"which stores, the url, key, capabilities, and database meta-data for the connected server\"\r\n                + \"If the curl argument is false or null, the this.server will be used if present,\"\r\n                + \" or the promise will be rejected.\"\r\n                + \"\\n1)The first (surl) argument: {string} argument it is the Server Url\"\r\n                + \"\\n2)The second(key) argument: {string} argument contains an API key\",\r\n    result : \"HTTP 200 on success, 409 for already existing database, otherwise error code\",\r\n    args   : {server_url : 'url', key: 'Api key'},\r\n    options: { title: \"\", description: \"\" }\r\n  };\r\n  sigs.create = {\r\n    spec    : \"WOQLClient.createDatabase(dburl, details, key)\",\r\n    descr   : \"\\n\\nCreate a Terminus Database\"\r\n                + \"\\n1)The first (dburl) argument:{string}, it is a terminusDB Url or a terminusDB Id \"\r\n                + \"\\n2)The second(details) argument:{object}, details which is the payload\"\r\n                + \"\\n which included information of the new database to be created\"\r\n                +  \"\\n3)The third (key) argument:{string}, contains an API key \",\r\n    result : \"HTTP 200 on success, 409 for already existing database, otherwise error code\",\r\n    args   : {database_url : 'url', details: '', key: ' Api key'},\r\n    options: { title: \"\", description: \"\" }\r\n  };\r\n  sigs.delete = {\r\n      spec  : \"WOQLClient.deleteDatabase(dburl, key)\",\r\n      descr : \"\\n\\nDeletes a Database\"\r\n                + \"\\n1)The first (dburl) argument: {string}, it is a terminusDB Url or a terminusDB Id \"\r\n                + \"\\n2)The second(key) argument: {string}, contains an API key\",\r\n      result: \"HTTP 200 on success, otherwise error code\",\r\n  };\r\n  sigs.getSchema = {\r\n    spec   : \"WOQLClient.getSchema(surl, options)\",\r\n    descr  : \"\\n\\nGets the schema of a database.\"\r\n             +\"\\n1)The first (surl) argument: {string}, it is a dbUrl/schema\"\r\n             + \"\\n2)The second(key) argument: {string}, contains an API key\",\r\n    result : \"Ontology Document on success (HTTP 200), 409 for already existing database, otherwise error code\",\r\n    options: { format: \"turtle\" }\r\n  };\r\n  sigs.getClassFrames = {\r\n    spec   : \"WOQLClient.getClassFrame = function(cfurl, cls, opts)\",\r\n    descr  : \"\\n\\nRetrieves a WOQL query on the specified database which updates the state and returns the results\"\r\n              +  \"\\nThe first (cfurl) argument can be\"\r\n              + \"\\n1) a valid URL of a terminus database or\"\r\n              +  \"\\n2) omitted - the current database will be used\"\r\n              +  \"\\nthe second argument (cls) is the URL / ID of a document class that exists in the database schema\"\r\n              +  \"\\nthe third argument (opts) is an options json - opts.key is an optional API key\",\r\n    result : \"Ontology Document on success (HTTP 200), 409 for already existing database, otherwise error code\",\r\n    options: { format: \"turtle\" }\r\n  };\r\n  sigs.updateSchema = {\r\n    spec    : \"WOQLClient.updateSchema(schurl, docs, options)\",\r\n    descr   : \"\\n\\nUpdates the Schema of the specified database\"\r\n                +\"\\n1)The first (surl) argument :{string}, is a dbUrl/schema\"\r\n                + \"\\n2)The second(docs) argument:{object}, is a valid owl ontology (new schema to be updated) in turtle format\"\r\n                + \"\\n3)The third (key) argument:{string}, contains an API key\",\r\n    result : \"Ontology Document on success (HTTP 200), 409 for already existing database, otherwise error code\",\r\n    args   : {document : 'doc'},\r\n    options: { format: \"turtle\", editmode: \"replace\"}\r\n  };\r\n  sigs.createDocument = {\r\n    spec   : \"WOQLClient.createDocument(docurl, document, options)\",\r\n    descr  : \"\\n\\nCreates a new document in the specified database\"\r\n              + \"\\n1)The first (docurl) argument: {string}, is a dbUrl/document/document_id\"\r\n              + \"\\n2)The second(document) argument: {object}, is a valid document in json-ld\"\r\n              + \"\\n3)The third (key) argument:{string}, contains an API key\",\r\n    result : \"Created Document on success (HTTP 200), Violation Report Otherwise (HTTP 400+)\",\r\n    args   : {document_url : 'url', document: \"doc\"},\r\n    options: { format: \"turtle\", fail_on_id_denied: false}\r\n  };\r\n  sigs.viewDocument = {\r\n    spec    : \"WOQLClient.getDocument(docurl, options)\",\r\n    descr   : \"\\n\\nRetrieves a document from the specified database\"\r\n              + \"\\n1)The first (docurl) argument: {string}, is a dbUrl/document/document_id\"\r\n              + \"\\n2)The second (key) argument: {string}, contains an API key\",\r\n    result : \"Document (HTTP 200), Violation Report Otherwise (HTTP 400+)\",\r\n    args   : {document_url : 'url'},\r\n    options: { format: \"turtle\"}\r\n  };\r\n  sigs.updateDocument = {\r\n    spec   : \"WOQLClient.updateDocument(docurl, document, options)\",\r\n    descr  : \"\\n\\nUpdates a document in the specified database with a new version\"\r\n                + \"\\n1)The first (docurl) argument: {string}, is a dbUrl/document/document_id\"\r\n                + \"\\n2)The second(document) argument: {object}, is a valid document in json-ld\"\r\n                + \"\\n3)The third (key) argument:{string} argument contains an API key\",\r\n    result : \"Ontology Document on success (HTTP 200), 409 for already existing database, otherwise error code\",\r\n    args   : {document_url : 'url', document: \"doc\"},\r\n    options: { format: \"turtle\", editmode: \"replace\"}\r\n  };\r\n  sigs.deleteDocument = {\r\n    spec  : \"WOQLClient.deleteDocument(docurl, key)\",\r\n    descr : \"\\n\\nDeletes a document from the specified database\"\r\n            + \"\\n1)The first (docurl) argument: {string},is a dbUrl/document/document_id\"\r\n            + \"\\n2)The second (key) argument: {string}, contains an API key\",\r\n    result: \"Ontology Document on success (HTTP 200), 409 for already existing database, otherwise error code\",\r\n    args  : {document_url : 'url'},\r\n  };\r\n  sigs.select = {\r\n    spec: \"WOQLClient.select(dburl, query, options)\",\r\n    descr: \"\\n\\nExecutes a read-only WOQL query on the specified database and returns the results\"\r\n              + \"\\n1)The first (docurl) argument: {string}, is a terminusDB Url or a terminusDB Id\"\r\n              + \"\\n2)The second (query) argument: {object}, a valid query in json-ld format \"\r\n              + \"\\n3)The third (key) argument:{string}, contains an API key\",\r\n    result: \"WOQL Result (HTTP 200), otherwise error code\",\r\n    args: {woql: 'woql'},\r\n  };\r\n  sigs.update = {\r\n    spec  : \"WOQLClient.update(dburl, query, options)\",\r\n    descr : \"\\n\\nExecutes a WOQL query on the specified database which updates the state and returns the results\"\r\n              + \"\\n1)The first (dburl) argument: {string}, is a terminusDB Url or a terminusDB Id\"\r\n              + \"\\n2)The second (query) argument: {object}, a valid query in json-ld format \"\r\n              + \"\\n3)The third (key) argument:{string}, contains an API key\",\r\n    result: \"WOQL Result (HTTP 200), otherwise error code\",\r\n    args  : {woql: 'woql'},\r\n  };\r\n  sigs.lookup = {\r\n    spec: \"WOQLClient.lookup(database_url, woql, options)\",\r\n    result: \"WOQL Result (HTTP 200), otherwise error code\",\r\n    args: {class: 'url', term: 'string'},\r\n  };\r\n  sigs.map = {\r\n    spec: \"WOQLClient.lookup(source, target, woql, options)\",\r\n    result: \"WOQL Result (HTTP 200), otherwise error code\",\r\n    args: {source: 'json', target: \"json\", woql: 'json'},\r\n  };\r\n  sigs.getClassFrame = {\r\n    spec: \"WOQLClient.getClassFrame(class, options)\",\r\n    result: \"WOQL Result (HTTP 200), otherwise error code\",\r\n    args: {class: 'url'},\r\n  };\r\n  sigs.getPropertyFrame = {\r\n    spec: \"WOQLClient.getPropertyFrame(class, property, options)\",\r\n    result: \"WOQL Result (HTTP 200), otherwise error code\",\r\n    args: {class: 'url', property: 'url'},\r\n  };\r\n  sigs.getFilledPropertyFrame = {\r\n    spec: \"WOQLClient.getPropertyFrame(document_url, property, options)\",\r\n    result: \"WOQL Result (HTTP 200), otherwise error code\",\r\n    args: {document_url: 'url', property: 'url'},\r\n  };\r\n  sigs.getSubClasses = {\r\n    spec: \"WOQLClient.getSubClasses(class, options)\",\r\n    result: \"WOQL Result (HTTP 200), otherwise error code\",\r\n    args: {class: 'url'},\r\n  };\r\n  return sigs[which];\r\n}//getFunctionSignature\r\n\r\n// returns dom element for header text\r\nfunction getHeaderDom(text){\r\n  var hd = document.createElement('div');\r\n  hd.setAttribute('class', 'terminus-module-head');\r\n  var h = document.createElement('h3');\r\n  h.innerHTML = text;\r\n  hd.appendChild(h);\r\n  return hd;\r\n} // getHeaderTextDom\r\n\r\nfunction getButton(text){\r\n  var button = document.createElement('button');\r\n  button.setAttribute('class', 'terminus-btn');\r\n  button.setAttribute('value', text);\r\n  button.appendChild(document.createTextNode(text));\r\n  return button;\r\n}\r\n\r\n// returns dom for alert banner\r\nfunction getInfoAlertDom(type, label, msg){\r\n  var ald = document.createElement('div');\r\n  if(type == 'info') ald.setAttribute('class', 'terminus-alert terminus-alert-success');\r\n  else ald.setAttribute('class', 'alert');\r\n  var str = document.createElement('STRONG');\r\n  str.innerHTML = label;\r\n  ald.appendChild(str);\r\n  var txt = document.createTextNode(msg);\r\n  ald.appendChild(txt);\r\n  return ald;\r\n} // getInfoAlertDom()\r\n\r\n// formats response results from platform\r\nfunction getResponse(currForm, action, response, terminator){\r\n\r\n  var rd = document.createElement('div');\r\n\r\n  // get header result\r\n  rd.appendChild(getHeaderDom('Result'));\r\n  var br = document.createElement('BR');\r\n  rd.appendChild(br);\r\n\r\n  var data = JSON.stringify(response, 0, 4);\r\n\r\n  var pre = document.createElement('pre');\r\n  pre.setAttribute('class', 'terminus-api-view terminus-scheme-pre');\r\n  pre.innerHTML = data;\r\n\r\n  var cm = stylizeCodeDisplay(terminator, pre, rd, 'javascript');\r\n  if(!cm) rd.appendChild(pre);\r\n\r\n  var br = document.createElement('BR');\r\n  rd.appendChild(br);\r\n\r\n  currForm.appendChild(rd);\r\n\r\n  return currForm;\r\n}\r\n\r\n// formats the response from fetch call and spits out Http header and result\r\nfunction showHttpResult(response, action, currForm, terminator){\r\n    //var currForm = document.createElement('div');\r\n\r\n    var br = document.createElement('BR');\r\n    currForm.appendChild(br);\r\n    var br = document.createElement('BR');\r\n    currForm.appendChild(br);\r\n\r\n    // get header result\r\n    currForm.appendChild(getHeaderDom('HTTP Header'));\r\n\r\n    var br = document.createElement('BR');\r\n    currForm.appendChild(br);\r\n\r\n     var retHttpHeaders  = '';\r\n\r\n     // iterate over all headers\r\n     for (let [key, value] of response.headers) {\r\n       retHttpHeaders = retHttpHeaders +  `${key} = ${value}` + '\\n';\r\n     }\r\n\r\n    // http header result\r\n    var hdres = document.createElement('pre');\r\n    hdres.setAttribute('class', 'terminus-api-signature-pre');\r\n    var txt = document.createTextNode(retHttpHeaders);\r\n    hdres.appendChild(txt);\r\n\r\n    var cm = stylizeCodeDisplay(terminator, hdres, currForm, 'message/http');\r\n    if(!cm) currForm.appendChild(hdres);\r\n\r\n    return response.json()\r\n    .then(function(response){\r\n      getResponse(currForm, action, response, terminator); // get return response\r\n    })\r\n\r\n} // UTILS.showHttpResult()\r\n\r\n\r\nfunction deleteStylizedEditor(ui, qip){\r\n    if(ui.pluginAvailable(\"codemirror\")){\r\n\t\tvar cm = qip.nextElementSibling;\r\n\t\tcm.setAttribute('class', 'terminus-hide');\r\n\t\tTerminusClient.FrameHelper.removeChildren(cm);\r\n\t}\r\n}\r\n\r\n/* ui: terminus ui reference\r\n   txt: text area to be stylized\r\n   view: defines the size of editor to appear in pages (schema/ query)\r\n   mode: format to be displayed in\r\n*/\r\nfunction stylizeEditor(ui, txt, view, mode){\r\n    if(ui){\r\n        var cmConfig = ui.pluginAvailable(\"codemirror\");\r\n        if(!(cmConfig)) return;\r\n        var cm = new Codemirror(txt, mode, cmConfig);\r\n    }\r\n\telse{\r\n        var cm = new Codemirror(txt, mode, {});\r\n    }\r\n\tvar ar = cm.colorizeTextArea(view);\r\n\tcm.updateTextArea(ar);\r\n}\r\n\r\n/* ui: terminus ui reference\r\n   txt: text area to be stylized\r\n   dom: stylized pre area is appended to dom\r\n   mode: format to be displayed in\r\n*/\r\nfunction stylizeCodeDisplay(ui, txt, dom, mode){\r\n    if(ui){\r\n        var cmConfig = ui.pluginAvailable(\"codemirror\");\r\n        if(!(cmConfig)) return false;\r\n        var cm = new Codemirror(txt, mode, cmConfig);\r\n    }\r\n    else var cm = new Codemirror(txt, mode, {});\r\n    var pr = cm.colorizePre();\r\n    if(dom) dom.appendChild(pr);\r\n    return true;\r\n}\r\n\r\n/* name: classname to find and remove classes from elements\r\n*/\r\nfunction removeSelectedNavClass(name){\r\n    var el = document.getElementsByClassName(name);\r\n    if (el.length < 1) return;\r\n    for(var i=0; i<(el.length + 1); i++){\r\n        el[i].classList.remove(name);\r\n    }\r\n}\r\n\r\nfunction setSelectedSubMenu(a){\r\n    removeSelectedNavClass(\"terminus-submenu-selected\");\r\n    a.classList.add(\"terminus-submenu-selected\");\r\n}\r\n\r\nfunction setSelected(el, className){\r\n    var par = el.parentElement;\r\n    for(var i=0; i<par.childNodes.length; i++){\r\n        if(par.childNodes[i].classList.contains(className))\r\n            par.childNodes[i].classList.remove(className);\r\n    }\r\n    el.classList.add(className);\r\n}\r\n\r\n// toggles between contents\r\nfunction tolggleContent(icon, content){\r\n    if (content.style.display === \"block\"){\r\n        removeSelectedNavClass(\"fa-chevron-up\");\r\n        icon.classList.add(\"fa-chevron-down\");\r\n        content.style.display = \"none\";\r\n    }\r\n    else{\r\n        removeSelectedNavClass(\"fa-chevron-down\");\r\n        icon.classList.add(\"fa-chevron-up\");\r\n        content.style.display = \"block\";\r\n    }\r\n}\r\n\r\n// controls current selected nav bar\r\nfunction activateSelectedNav(nav, terminator){\r\n    removeSelectedNavClass(\"terminus-selected\");\r\n\t//checkDocumentSubMenus(terminator);\r\n\tnav.classList.add(\"terminus-selected\");\r\n}\r\n\r\nfunction hideDocumentSubMenus(el){\r\n\tif(el.classList.contains('terminus-display')){\r\n\t\tel.classList.remove('terminus-display');\r\n\t\tel.classList.add('terminus-hide');\r\n\t}\r\n}\r\n\r\nfunction checkDocumentSubMenus(terminator){\r\n\tif(terminator.ui.showControl(\"get_document\")) {\r\n\t\tvar gd = document.getElementsByClassName('terminus-get-doc');\r\n\t\thideDocumentSubMenus(gd[0]);\r\n\t}\r\n\tif(terminator.ui.showControl(\"create_document\")) {\r\n\t\tvar cd = document.getElementsByClassName('terminus-create-doc');\r\n\t\thideDocumentSubMenus(cd[0]);\r\n\t}\r\n}\r\n\r\nfunction toggleVisibility(el){\r\n\tif(el.classList.contains('terminus-display')){\r\n\t\tel.classList.remove('terminus-display');\r\n\t\tel.classList.add('terminus-hide');\r\n\t}\r\n    else if(el.classList.contains('terminus-hide')){\r\n        el.classList.remove('terminus-hide');\r\n\t\tel.classList.add('terminus-display');\r\n\t}\r\n}\r\n\r\nfunction extractValueFromCell(cellValue){\r\n    var ihtml = new DOMParser().parseFromString(cellValue, \"text/xml\");\r\n    return ihtml.firstChild.innerHTML;\r\n}\r\n\r\nfunction displayDocumentSubMenus(ui) {\r\n\t//display submenus on click of documents\r\n\tif(ui.showControl(\"get_document\")) {\r\n\t\tvar gd = document.getElementsByClassName('terminus-get-doc');\r\n\t\tshowSubMenus(gd[0]);\r\n\t}\r\n\tif(ui.showControl(\"create_document\")) {\r\n\t\tvar cd = document.getElementsByClassName('terminus-create-doc');\r\n\t\tshowSubMenus(cd[0]);\r\n\t}\r\n}\r\n\r\nfunction checkForMandatoryId(){\r\n    var objId = document.getElementsByClassName('terminus-object-id-input');\r\n    if(objId.length>0){\r\n        if(!objId[0].value){\r\n            objId[0].setAttribute('placeholder', 'Required field');\r\n            objId[0].style.background = '#f8d7da';\r\n            return false;\r\n        }\r\n        else return true;\r\n    }\r\n}\r\n\r\nfunction showSubMenus (el){\r\n\tel.classList.remove('terminus-hide');\r\n\tel.classList.add('terminus-display');\r\n}\r\n\r\n// function which generates query based on current settings from different screens of dashboard\r\nfunction getCurrentWoqlQueryObject(query, settings){\r\n\tvar qval;\r\n    if(!query) query = settings.query;\r\n\tswitch(query){\r\n\t\tcase 'Show_All_Schema_Elements':\r\n\t\t\tqval = TerminusClient.WOQL.limit(settings.pageLength)\r\n                        .start(settings.start)\r\n                        .elementMetadata();\r\n\t\tbreak;\r\n\t\tcase 'Show_All_Classes':\r\n\t\t\tqval = TerminusClient.WOQL.limit(settings.pageLength)\r\n                        .start(settings.start)\r\n                        .classMetadata();\r\n\t\tbreak;\r\n\t\tcase 'Show_All_Data':\r\n\t\t\tqval = TerminusClient.WOQL.limit(settings.pageLength)\r\n                        .start(settings.start)\r\n                        .getEverything();\r\n\t\tbreak;\r\n\t\tcase 'Show_All_Documents':\r\n\t\t\tqval = TerminusClient.WOQL.limit(settings.pageLength)\r\n                        .start(settings.start)\r\n                        .getAllDocuments();\r\n\t\tbreak;\r\n        case 'Show_All_Document_classes':\r\n            qval = TerminusClient.WOQL.limit(settings.pageLength)\r\n                        .start(settings.start)\r\n                        .documentMetadata();\r\n        break;\r\n        case 'Show_Document_Classes':\r\n            qval = TerminusClient.WOQL.limit(settings.pageLength)\r\n                        .start(settings.start).and(\r\n                        TerminusClient.WOQL.quad(\"v:Element\", \"rdf:type\", \"owl:Class\", \"db:schema\"),\r\n                        TerminusClient.WOQL.abstract(\"v:Element\"),\r\n                        TerminusClient.WOQL.sub(\"v:Element\", \"tcs:Document\"),\r\n                        TerminusClient.WOQL.opt().quad(\"v:Element\", \"rdfs:label\", \"v:Label\", \"db:schema\"),\r\n                        TerminusClient.WOQL.opt().quad(\"v:Element\", \"rdfs:comment\", \"v:Comment\", \"db:schema\"));\r\n        break;\r\n        case 'Show_All_Properties':\r\n            qval = TerminusClient.WOQL.limit(settings.pageLength)\r\n                        .start(settings.start)\r\n                        .propertyMetadata();\r\n        break;\r\n\t\tdefault:\r\n\t\t\tconsole.log('Invalid query ' + query + ' passed in WOQLTextboxGenerator');\r\n\t\tbreak;\r\n\t}\r\n\treturn qval;\r\n}\r\n\r\n// removes spaces\r\nfunction trimValue(text){\r\n    (text).replace(/[\\s\\t\\r\\n\\f]/g,'');\r\n    return text;\r\n}\r\n\r\n// query string\r\nfunction getqObjFromInput(q){\r\n    const WOQL = TerminusClient.WOQL ;\r\n    //var query = 'WOQL.' + q;\r\n    var query = q;\r\n    try {\r\n        var qObj = eval(query);\r\n        this.qObj = qObj;\r\n        return qObj;\r\n    }\r\n    catch(e){\r\n        console.log('Error in getting woql object ',e.toString());\r\n    }\r\n}\r\n\r\nmodule.exports={tolggleContent,\r\n               removeSelectedNavClass,\r\n               stylizeCodeDisplay,\r\n               stylizeEditor,\r\n               deleteStylizedEditor,\r\n               showHttpResult,\r\n               getHeaderDom,\r\n               getInfoAlertDom,\r\n               getFunctionSignature,\r\n               toggleVisibility,\r\n               extractValueFromCell,\r\n               displayDocumentSubMenus,\r\n               setSelectedSubMenu,\r\n               checkForMandatoryId,\r\n               activateSelectedNav,\r\n               getCurrentWoqlQueryObject,\r\n               getButton,\r\n               trimValue,\r\n               setSelected,\r\n               getqObjFromInput}\r\n","'use strict';\n\nvar bind = require('./helpers/bind');\nvar isBuffer = require('is-buffer');\n\n/*global toString:true*/\n\n// utils is a library of generic helper functions non-specific to axios\n\nvar toString = Object.prototype.toString;\n\n/**\n * Determine if a value is an Array\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is an Array, otherwise false\n */\nfunction isArray(val) {\n  return toString.call(val) === '[object Array]';\n}\n\n/**\n * Determine if a value is an ArrayBuffer\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is an ArrayBuffer, otherwise false\n */\nfunction isArrayBuffer(val) {\n  return toString.call(val) === '[object ArrayBuffer]';\n}\n\n/**\n * Determine if a value is a FormData\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is an FormData, otherwise false\n */\nfunction isFormData(val) {\n  return (typeof FormData !== 'undefined') && (val instanceof FormData);\n}\n\n/**\n * Determine if a value is a view on an ArrayBuffer\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a view on an ArrayBuffer, otherwise false\n */\nfunction isArrayBufferView(val) {\n  var result;\n  if ((typeof ArrayBuffer !== 'undefined') && (ArrayBuffer.isView)) {\n    result = ArrayBuffer.isView(val);\n  } else {\n    result = (val) && (val.buffer) && (val.buffer instanceof ArrayBuffer);\n  }\n  return result;\n}\n\n/**\n * Determine if a value is a String\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a String, otherwise false\n */\nfunction isString(val) {\n  return typeof val === 'string';\n}\n\n/**\n * Determine if a value is a Number\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a Number, otherwise false\n */\nfunction isNumber(val) {\n  return typeof val === 'number';\n}\n\n/**\n * Determine if a value is undefined\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if the value is undefined, otherwise false\n */\nfunction isUndefined(val) {\n  return typeof val === 'undefined';\n}\n\n/**\n * Determine if a value is an Object\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is an Object, otherwise false\n */\nfunction isObject(val) {\n  return val !== null && typeof val === 'object';\n}\n\n/**\n * Determine if a value is a Date\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a Date, otherwise false\n */\nfunction isDate(val) {\n  return toString.call(val) === '[object Date]';\n}\n\n/**\n * Determine if a value is a File\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a File, otherwise false\n */\nfunction isFile(val) {\n  return toString.call(val) === '[object File]';\n}\n\n/**\n * Determine if a value is a Blob\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a Blob, otherwise false\n */\nfunction isBlob(val) {\n  return toString.call(val) === '[object Blob]';\n}\n\n/**\n * Determine if a value is a Function\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a Function, otherwise false\n */\nfunction isFunction(val) {\n  return toString.call(val) === '[object Function]';\n}\n\n/**\n * Determine if a value is a Stream\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a Stream, otherwise false\n */\nfunction isStream(val) {\n  return isObject(val) && isFunction(val.pipe);\n}\n\n/**\n * Determine if a value is a URLSearchParams object\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a URLSearchParams object, otherwise false\n */\nfunction isURLSearchParams(val) {\n  return typeof URLSearchParams !== 'undefined' && val instanceof URLSearchParams;\n}\n\n/**\n * Trim excess whitespace off the beginning and end of a string\n *\n * @param {String} str The String to trim\n * @returns {String} The String freed of excess whitespace\n */\nfunction trim(str) {\n  return str.replace(/^\\s*/, '').replace(/\\s*$/, '');\n}\n\n/**\n * Determine if we're running in a standard browser environment\n *\n * This allows axios to run in a web worker, and react-native.\n * Both environments support XMLHttpRequest, but not fully standard globals.\n *\n * web workers:\n *  typeof window -> undefined\n *  typeof document -> undefined\n *\n * react-native:\n *  navigator.product -> 'ReactNative'\n * nativescript\n *  navigator.product -> 'NativeScript' or 'NS'\n */\nfunction isStandardBrowserEnv() {\n  if (typeof navigator !== 'undefined' && (navigator.product === 'ReactNative' ||\n                                           navigator.product === 'NativeScript' ||\n                                           navigator.product === 'NS')) {\n    return false;\n  }\n  return (\n    typeof window !== 'undefined' &&\n    typeof document !== 'undefined'\n  );\n}\n\n/**\n * Iterate over an Array or an Object invoking a function for each item.\n *\n * If `obj` is an Array callback will be called passing\n * the value, index, and complete array for each item.\n *\n * If 'obj' is an Object callback will be called passing\n * the value, key, and complete object for each property.\n *\n * @param {Object|Array} obj The object to iterate\n * @param {Function} fn The callback to invoke for each item\n */\nfunction forEach(obj, fn) {\n  // Don't bother if no value provided\n  if (obj === null || typeof obj === 'undefined') {\n    return;\n  }\n\n  // Force an array if not already something iterable\n  if (typeof obj !== 'object') {\n    /*eslint no-param-reassign:0*/\n    obj = [obj];\n  }\n\n  if (isArray(obj)) {\n    // Iterate over array values\n    for (var i = 0, l = obj.length; i < l; i++) {\n      fn.call(null, obj[i], i, obj);\n    }\n  } else {\n    // Iterate over object keys\n    for (var key in obj) {\n      if (Object.prototype.hasOwnProperty.call(obj, key)) {\n        fn.call(null, obj[key], key, obj);\n      }\n    }\n  }\n}\n\n/**\n * Accepts varargs expecting each argument to be an object, then\n * immutably merges the properties of each object and returns result.\n *\n * When multiple objects contain the same key the later object in\n * the arguments list will take precedence.\n *\n * Example:\n *\n * ```js\n * var result = merge({foo: 123}, {foo: 456});\n * console.log(result.foo); // outputs 456\n * ```\n *\n * @param {Object} obj1 Object to merge\n * @returns {Object} Result of all merge properties\n */\nfunction merge(/* obj1, obj2, obj3, ... */) {\n  var result = {};\n  function assignValue(val, key) {\n    if (typeof result[key] === 'object' && typeof val === 'object') {\n      result[key] = merge(result[key], val);\n    } else {\n      result[key] = val;\n    }\n  }\n\n  for (var i = 0, l = arguments.length; i < l; i++) {\n    forEach(arguments[i], assignValue);\n  }\n  return result;\n}\n\n/**\n * Function equal to merge with the difference being that no reference\n * to original objects is kept.\n *\n * @see merge\n * @param {Object} obj1 Object to merge\n * @returns {Object} Result of all merge properties\n */\nfunction deepMerge(/* obj1, obj2, obj3, ... */) {\n  var result = {};\n  function assignValue(val, key) {\n    if (typeof result[key] === 'object' && typeof val === 'object') {\n      result[key] = deepMerge(result[key], val);\n    } else if (typeof val === 'object') {\n      result[key] = deepMerge({}, val);\n    } else {\n      result[key] = val;\n    }\n  }\n\n  for (var i = 0, l = arguments.length; i < l; i++) {\n    forEach(arguments[i], assignValue);\n  }\n  return result;\n}\n\n/**\n * Extends object a by mutably adding to it the properties of object b.\n *\n * @param {Object} a The object to be extended\n * @param {Object} b The object to copy properties from\n * @param {Object} thisArg The object to bind function to\n * @return {Object} The resulting value of object a\n */\nfunction extend(a, b, thisArg) {\n  forEach(b, function assignValue(val, key) {\n    if (thisArg && typeof val === 'function') {\n      a[key] = bind(val, thisArg);\n    } else {\n      a[key] = val;\n    }\n  });\n  return a;\n}\n\nmodule.exports = {\n  isArray: isArray,\n  isArrayBuffer: isArrayBuffer,\n  isBuffer: isBuffer,\n  isFormData: isFormData,\n  isArrayBufferView: isArrayBufferView,\n  isString: isString,\n  isNumber: isNumber,\n  isObject: isObject,\n  isUndefined: isUndefined,\n  isDate: isDate,\n  isFile: isFile,\n  isBlob: isBlob,\n  isFunction: isFunction,\n  isStream: isStream,\n  isURLSearchParams: isURLSearchParams,\n  isStandardBrowserEnv: isStandardBrowserEnv,\n  forEach: forEach,\n  merge: merge,\n  deepMerge: deepMerge,\n  extend: extend,\n  trim: trim\n};\n","const TerminusClient = require('@terminusdb/terminus-client');\r\nconst UTILS = require('../../Utils');\r\n/*\r\nqObj: WOQL object\r\nwidth: width of snippet in px\r\nheight: height of snippet in px\r\n*/\r\nfunction TerminusCodeSnippet(language, mode, format, width, height, placeholder){\r\n\tthis.language = (language ? language : \"woql\");//woql / rule\r\n\tthis.mode = (mode ? mode : \"view\");\r\n    this.width = (width ? width : 1200);\r\n\tthis.height = (height ? height : 300);\r\n\tthis.placeholder = (placeholder ? placeholder : \"\");\r\n    this.format = (format ? format : \"js\");\r\n    this.formats = {'js': \"WOQL.js\", 'jsonld': \"JSON-LD\"};\r\n    if(this.mode == 'view')\r\n        this.snippet = document.createElement('pre');\r\n    else {\r\n    \tthis.snippet = document.createElement('textarea');\r\n    \tthis.snippet.setAttribute(\"spellcheck\", \"false\");\r\n\t\tthis.snippet.setAttribute(\"class\", \"terminus-code-snippet\");\r\n    }\r\n}\r\n\r\nTerminusCodeSnippet.prototype.setQuery = function(q){\r\n\tthis.qObj = q;\r\n\tthis.refreshContents();\r\n}\r\n\r\nTerminusCodeSnippet.prototype.serialise = function(query, format){\r\n\tif(format == \"js\"){\r\n\t\treturn query.prettyPrint(4);\r\n\t}\r\n\telse {\r\n\t\treturn JSON.stringify(query.json(), undefined, 2);\r\n\t}\r\n}\r\n\r\n//parses a string encoding a woql in either json or js notation\r\nTerminusCodeSnippet.prototype.parseText = function(text, format){\r\n\ttry {\r\n\t\tvar WOQL = TerminusClient.WOQL;\r\n\t\tif(format == \"js\"){\r\n\t\t\tvar nw = eval(text);\r\n\t\t\tif(this.language == \"rule\"){\r\n\t\t\t\tthis.view = view;\r\n\t\t\t\treturn view;\r\n\t\t\t}\r\n\t\t\treturn nw;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tvar qval = JSON.parse(text);\r\n\t\t\tif(this.language == \"woql\"){\r\n\t\t\t\treturn WOQL.json(qval);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\treturn WOQL.loadConfig(qval);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tcatch(e){\r\n\t\tthis.error = \"Failed to parse Query \" + e.toString() + \" \" + text;\r\n\t\tconsole.error(this.error);\r\n\t\treturn false;\r\n\t}\r\n}\r\n\r\nTerminusCodeSnippet.prototype.getInputElement = function(){\r\n\treturn this.snippet;\r\n}\r\n\r\nTerminusCodeSnippet.prototype.readInput = function(){\r\n\tif(this.mode == \"edit\") {\r\n\t\tthis.qObj = this.parseText(this.snippet.value, this.format);\r\n\t\treturn this.qObj;\r\n\t}\r\n\treturn this.qObj;\r\n}\r\n\r\nTerminusCodeSnippet.prototype.get = function(){\r\n\treturn this.readInput();\r\n}\r\n\r\nTerminusCodeSnippet.prototype.getAsDOM = function(with_buttons){\r\n    var scont = document.createElement('div');\r\n\tscont.setAttribute('class', 'terminus-snippet-container terminus-display-flex')\r\n    // query\r\n    var snpc = document.createElement('div');\r\n    snpc.setAttribute('style', 'display:table-caption; margin: 20px');\r\n    if(this.placeholder)\r\n\t\tthis.snippet.setAttribute(\"placeholder\", this.placeholder);\r\n    if(this.width && this.height)\r\n\t\tthis.snippet.setAttribute(\"style\", \"width: \"+ this.width +\"px; height: \"+ this.height + \"px;\");\r\n    //if(this.language == \"woql\"){\r\n    \tsnpc.appendChild(this.getFormatButtons());\r\n    //}\r\n    //else {\r\n    //\tif(with_buttons) snpc.appendChild(this.getViewTypeButtons());\r\n    //}\r\n    if(this.qObj){\r\n    \tvar serial = this.serialise(this.qObj, this.format);\r\n\t\t//console.log('serial', serial);\r\n    \tif(this.mode == \"edit\"){\r\n    \t\tthis.snippet.value = serial;\r\n    \t}\r\n    \telse {\r\n    \t\tthis.snippet.appendChild(document.createTextNode(serial));\r\n    \t}\r\n\t}\r\n\telse {\r\n\t\tthis.snippet.value = \"\";\r\n\t}\r\n    snpc.appendChild(this.snippet);\r\n    if(this.mode == \"edit\"){\r\n    \tvar actbtn = this.getSubmitButton();\r\n    \tsnpc.appendChild(actbtn);\r\n    }\r\n    scont.appendChild(snpc);\r\n    return scont;\r\n}\r\n\r\nTerminusCodeSnippet.prototype.changeRuleView = function(nview){\r\n\tthis.snippet.value = \"view = WOQL.\"+ nview + \"()\";\r\n\tthis.readInput();\r\n\tthis.submit(this.qObj);\r\n}\r\n\r\n\r\nTerminusCodeSnippet.prototype.getIconsDOM = function(){\r\n    var bsp = document.createElement('span');\r\n    bsp.setAttribute('class', 'terminus-snippet-icons');\r\n    for(var i = 0; i<this.view_types.length; i++){\r\n\t\tvar isp = document.createElement('span');\r\n\t\tvar icon = document.createElement(\"i\");\r\n\t\ticon.title = this.view_types[i].label;\r\n\t\ticon.setAttribute(\"class\", this.view_types[i].icon);\r\n\t\tisp.appendChild(icon);\r\n\t\tisp.name = this.view_types[i].id;\r\n\t\tvar self = this;\r\n\t\tisp.addEventListener('click', function(){\r\n\t\t\tif(!(self.view && self.view.type == this.name)){\r\n\t\t\t\tself.changeRuleView(this.name);\r\n\t\t\t}\r\n\t\t});\r\n\t\tisp.addEventListener('mouseover', function(){\r\n\t\t\tif(!(self.view && self.view.type == this.name)){\r\n\t\t\t\tthis.style.cursor = \"pointer\";\r\n\t\t\t}\r\n\t\t});\r\n\t\tbsp.appendChild(isp);\r\n    }\r\n    return bsp;\r\n}\r\n\r\nTerminusCodeSnippet.prototype.getFormatButtons = function(){\r\n    var bsp = document.createElement('span');\r\n    bsp.setAttribute('class', 'terminus-snippet-panel');\r\n    //if(this.width) bsp.setAttribute(\"style\", \"width: \"+ this.width +\"px;\");\r\n    for(f in this.formats){\r\n        var btn = document.createElement('button');\r\n        btn.setAttribute('value', f);\r\n        btn.setAttribute('class', 'terminus-snippet-button');\r\n\t\tif(f == 'js') btn.classList.add('terminus-snippet-format-selected');\r\n        btn.appendChild(document.createTextNode(this.formats[f]));\r\n        var self = this;\r\n        btn.addEventListener('click', function(){\r\n\t\t\tUTILS.setSelected(this, 'terminus-snippet-format-selected');\r\n\t\t\tvar qobj = self.parseText(self.snippet.value, self.format);\r\n\t\t\tself.format = this.value;\r\n\t\t\tif(qobj) self.qObj = qobj;\r\n\t\t\tself.refreshContents();\r\n        })\r\n        bsp.appendChild(btn);\r\n    }\r\n    return bsp;\r\n}\r\n\r\nTerminusCodeSnippet.prototype.getSubmitButton = function(){\r\n    var actbtn = document.createElement('button');\r\n    actbtn.setAttribute('class', 'terminus-btn');\r\n\tactbtn.setAttribute('type', 'submit');\r\n\tvar txt = \"Submit\";\r\n\tif(this.language == \"WOQL\"){\r\n\t\ttxt = \"Submit Query\";\r\n\t}\r\n\telse if(this.language == \"rule\") {\r\n\t\ttxt = \"Update View\";\r\n\t}\r\n\telse if(this.language == \"code\"){\r\n\t\ttxt = \"Run Script\";\r\n\t}\r\n    actbtn.appendChild(document.createTextNode(txt));\r\n    actbtn.addEventListener('click', () => {\r\n\t\tthis.readInput();\r\n\t\tthis.submit(this.qObj);\r\n    });\r\n    return actbtn;\r\n}\r\n\r\nTerminusCodeSnippet.prototype.submit = function(){\r\n\talert(\"Submitted \" + JSON.stringify(this.qObj));\r\n}\r\n\r\nTerminusCodeSnippet.prototype.removeCodeMirror = function(){\r\n\tvar cm = this.snippet.nextSibling;\r\n\tif(!cm) return;\r\n\tif(cm.classList.contains('CodeMirror')) // remove code mirror\r\n\t\tTerminusClient.FrameHelper.removeElement(cm);\r\n}\r\n\r\nTerminusCodeSnippet.prototype.stylizeSnippet = function(){\r\n\tvar dimensions = {};\r\n\tdimensions.width = this.width;\r\n\tdimensions.height = this.height;\r\n\tthis.removeCodeMirror();\r\n\tif(this.mode == 'view')\r\n\t\tUTILS.stylizeCodeDisplay(null, this.snippet, null, 'javascript');\r\n\telse UTILS.stylizeEditor(null, this.snippet, dimensions, 'javascript'); // default view is js\r\n}\r\n\r\nTerminusCodeSnippet.prototype.refreshContents = function(qObj){\r\n\tqObj = qObj ? qObj : this.qObj;\r\n\tTerminusClient.FrameHelper.removeChildren(this.snippet);\r\n\tif(this.mode == \"edit\") this.snippet.value == \"\";\r\n\tif(!qObj) return;\r\n\tvar serial = this.serialise(this.qObj, this.format);\r\n\tif(this.mode == \"edit\"){\r\n\t\tthis.snippet.value = serial;\r\n\t\tif(this.snippet.nextSibling){\r\n\t\t\tthis.removeCodeMirror();\r\n\t\t\tif(this.format == 'js') var mode = 'javascript';\r\n\t\t\telse var mode = 'application/ld+json';\r\n\t\t\tUTILS.stylizeEditor(null,\r\n\t\t\t\t\t\t\t\tthis.snippet,\r\n\t\t\t\t\t\t\t\t{width: this.width, height: this.height},\r\n\t\t\t\t\t\t\t\tmode);\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tthis.snippet.appendChild(document.createTextNode(serial));\r\n\t\tUTILS.stylizeCodeDisplay(null, this.snippet, null, mode);\r\n\t}\r\n}\r\n\r\nmodule.exports = TerminusCodeSnippet;\r\n","const TerminusClient = require('@terminusdb/terminus-client');\r\nfunction TerminusPluginManager(){\r\n\tthis.preloaded = [];\r\n\tthis.loaded = [];\r\n\tthis.loading = [];\r\n\tthis.precluded = [];\r\n\tthis.plugins = {};\r\n\tthis.plugins[\"font-awesome\"] = {\r\n\t\tlabel: \"Font Awesome\",\r\n\t\tcss: [\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0-11/css/all.css\"]\r\n\t};\r\n\tthis.plugins[\"quill\"] = {\r\n\t\tlabel: \"Quill\",\r\n\t\tjs: [\"https://cdn.quilljs.com/1.3.6/quill.min.js\"],\r\n\t\tcss: [\"https://cdn.quilljs.com/1.3.6/quill.snow.css\"],\r\n\t};\r\n\tthis.plugins[\"codemirror\"] = {\r\n\t\tlabel : \"Code Mirror\",\r\n\t\tjs: [\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/codemirror.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/mode/xml/xml.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/mode/css/css.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/mode/turtle/turtle.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/mode/javascript/javascript.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/addon/hint/anyword-hint.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/addon/hint/show-hint.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/addon/runmode/runmode.js\",\r\n\t\t  \t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/mode/http/http.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/addon/edit/closebrackets.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/addon/edit/matchbrackets.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/addon/display/placeholder.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/addon/fold/foldgutter.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/addon/fold/foldcode.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/addon/fold/indent-fold.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/addon/fold/markdown-fold.js\"\r\n\r\n\r\n\r\n\t  ],\r\n\t\tcss: [\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/codemirror.css\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/addon/hint/show-hint.css\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/theme/neo.css\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/theme/erlang-dark.css\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/addon/fold/foldgutter.css\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/theme/eclipse.css\"\r\n\t\t]\r\n\t};\r\n\tthis.plugins[\"jquery\"] = {\r\n\t\tlabel: \"jQuery\",\r\n\t\tjs: [\"https://code.jquery.com/jquery-2.2.4.min.js\"]\r\n\t};\r\n\tthis.plugins[\"jqueryui\"] = {\r\n\t\tlabel: \"jQuery UI\",\r\n\t\tcss: [\"https://code.jquery.com/ui/1.12.0/themes/smoothness/jquery-ui.css\"],\r\n\t\tjs: [\"https://code.jquery.com/ui/1.12.0/jquery-ui.js\"],\r\n\t\trequires: ['jquery']\r\n\t};\r\n\tthis.plugins[\"datatables\"] = {\r\n\t\tlabel: \"Data Tables\",\r\n\t\tjs: [\"https://cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js\",\r\n\t\t\t \"https://cdn.datatables.net/v/dt/jszip-2.5.0/dt-1.10.16/b-1.5.1/b-html5-1.5.1/datatables.min.js\"],\r\n\t\tcss: [\"https://cdn.datatables.net/1.10.19/css/jquery.dataTables.min.css\"],\r\n\t\trequires: ['jquery']\r\n\t};\r\n\t/*this.plugins[\"prettify\"] = {\r\n\t\tlabel: \"Prettify\",\r\n\t\tjs: [\"https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.js\"],\r\n\t\tcss: [\"https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.css\"],\r\n\t\trequires: ['jquery']\r\n\t};*/\r\n\tthis.plugins[\"gmaps\"] = {\r\n\t\tlabel: \"Google Maps\",\r\n\t\tjs: [\"https://maps.googleapis.com/maps/api/js\"],\r\n\t\t//plugin: \"gmaps.terminus.js\"\r\n\t};\r\n\tthis.plugins[\"d3\"] = {\r\n\t\tlabel: \"d3\",\r\n\t\tjs: [\"https://code.jquery.com/jquery-2.2.4.min.js\"],\r\n\t\trequires: ['jquery']\r\n\t};\r\n\tthis.plugins[\"select2\"] = {\r\n\t\tlabel: \"Select 2\",\r\n\t\tjs: [\"https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.7/js/select2.min.js\"],\r\n\t\tcss: [\"https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.7/css/select2.min.css\"],\r\n\t\trequires: ['jquery']\r\n\t};\r\n\t/*this.plugins[\"jsoneditor\"] = {\r\n\t\tlabel: \"JSON Editor\",\r\n\t\tjs: [\"https://cdnjs.cloudflare.com/ajax/libs/jsoneditor/7.0.4/jsoneditor.min.js\"],\r\n\t\tcss: [\"https://cdnjs.cloudflare.com/ajax/libs/jsoneditor/7.0.4/jsoneditor.min.css\"],\r\n\t\t//plugin: \"jsoneditor.terminus.js\"\r\n\t};\r\n\tthis.plugins[\"bootstrap\"] = {\r\n\t\tlabel: \"Bootstrap\",\r\n\t\tjs: [\"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js\"],\r\n\t\tcss: [\"https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/2.2.2/css/bootstrap.min.css\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/2.2.2/css/bootstrap-responsive.min.css\"]\r\n\t};\r\n\tthis.plugins[\"flot\"] = {\r\n\t\tlabel: \"Flot\",\r\n\t\tjs: [\"https://cdnjs.cloudflare.com/ajax/libs/flot/0.8.3/jquery.flot.min.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/flot/0.8.3/jquery.flot.resize.min.js\"],\r\n\t\trequires: [\"jquery\"]\r\n\t};*/\r\n}\r\n\r\nTerminusPluginManager.prototype.setPluginOptions = function(opts){\r\n\tfor(var p in opts){\r\n\t\tif(!this.plugins[p]) continue;\r\n\t\tfor(var k in opts[p]){\r\n\t\t\tthis.plugins[p][k] = opts[p][k];\r\n\t\t}\r\n\t}\r\n}\r\n\r\nTerminusPluginManager.prototype.init = function(opts, then){\r\n\tif(opts) this.setPluginOptions(opts);\r\n\tthis.calculatePreloaded();\r\n\tvar toload = this.calculateRequiredInitPlugins(opts);\r\n\tif(toload && toload[0].length) {\r\n\t\tif(toload[1].length){\r\n\t\t\tvar self = this;\r\n\t\t\tvar nthen = function(){\r\n\t\t\t\tself.loadPlugins(toload[1], then);\r\n\t\t\t}\r\n\t\t\tthis.loadPlugins(toload[0], nthen);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.loadPlugins(toload[0], then);\r\n\t\t}\r\n\t}\r\n\telse if(then){\r\n\t\tthen();\r\n\t}\r\n}\r\n\r\nTerminusPluginManager.prototype.calculateRequiredInitPlugins = function(opts){\r\n\tif(opts){\r\n\t\tvar pins = [];\r\n\t\tfor(var pid in opts){\r\n\t\t\tif(opts[pid] && pins.indexOf(pid) == -1){\r\n\t\t\t\tif(typeof opts[pid] != \"object\" && opts[pid]){\r\n\t\t\t\t\tpins.push(pid);\r\n\t\t\t\t}\r\n\t\t\t\telse if(typeof opts[pid] == \"object\"){\r\n\t\t\t\t\tif(!(typeof opts[pid].loaded != \"undefined\" && !opts[pid].loaded)){\r\n\t\t\t\t\t\tpins.push(pid);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tvar pins = this.getDefaultPlugins();\r\n\t}\r\n\tvar needed_pins = [];\r\n\tfor(var i = 0; i<pins.length; i++){\r\n\t\tif(this.loaded.indexOf(pins[i]) == -1 && this.preloaded.indexOf(pins[i]) == -1 ){\r\n\t\t\tneeded_pins.push(pins[i])\r\n\t\t}\r\n\t}\r\n\tvar loading_order = [[], []];\r\n\tfor(var i = 0; i<needed_pins.length; i++){\r\n\t\tif(this.plugins[needed_pins[i]]){\r\n\t\t\tif(this.plugins[needed_pins[i]].requires && this.plugins[needed_pins[i]].requires.length){\r\n\t\t\t\tloading_order[1].push(needed_pins[i]);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tloading_order[0].push(needed_pins[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn loading_order;\r\n}\r\n\r\nTerminusPluginManager.prototype.getAvailablePlugins = function(){\r\n\treturn this.plugins;\r\n}\r\n\r\nTerminusPluginManager.prototype.calculatePreloaded = function(){\r\n\tfor(var pl in this.plugins){\r\n\t\tif(this.pluginAvailable(pl)){\r\n\t\t\tthis.preloaded.push(pl);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nTerminusPluginManager.prototype.pluginAvailable = function(plugin, version_check){\r\n\tif(typeof this.plugins[plugin] == \"object\"){\r\n\t\tvar pluginmeta = this.plugins[plugin];\r\n\t\tif(pluginmeta.requires && pluginmeta.requires.length){\r\n\t\t\tfor(var i =0 ; i < pluginmeta.requires.length; i++){\r\n\t\t\t\tif(!this.pluginAvailable(pluginmeta.requires[i], version_check)) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar required_version = (pluginmeta.version ? pluginmeta.version : false);\r\n\t\tswitch(plugin){\r\n\t\t\tcase \"jquery\": {\r\n\t\t\t\tif(typeof jQuery == \"undefined\") return false;\r\n\t\t\t\tif(version_check && required_version){}\r\n\t\t\t\treturn true;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tcase \"jqueryui\": {\r\n\t\t\t\ttry{\r\n\t\t\t\t\tif(typeof jQuery != \"undefined\" && jQuery.isFunction( jQuery.fn.slider )) return true;\r\n\t\t\t\t}\r\n\t\t\t\tcatch(e){}\r\n\t\t\t\treturn false;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tcase \"quill\": {\r\n\t\t\t\tif(typeof Quill == \"undefined\") return false;\r\n\t\t\t\treturn true;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tcase \"jsoneditor\": {\r\n\t\t\t\tif(typeof JSONEditor == \"undefined\") return false;\r\n\t\t\t\treturn true;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tcase \"codemirror\": {\r\n\t\t\t\tif(typeof CodeMirror == \"undefined\") return false;\r\n\t\t\t\treturn this.plugins[plugin];  // sent plugin config with darkmode true/ false\r\n\t\t\t}\r\n\t\t\tcase \"font-awesome\": {\r\n\t\t\t\t//if(typeof CodeMirror != \"undefined\") return true;\r\n\t\t\t\treturn this.fontAwesomeCheck();\r\n\t\t\t}\r\n\t\t\tcase \"datatables\": {\r\n\t\t\t\t if(typeof jQuery != \"undefined\" && jQuery.isFunction( jQuery.fn.dataTable)) return true;\r\n\t\t\t\t return false;\r\n\t\t\t}\r\n\t\t\tcase \"select2\": {\r\n\t\t\t\t if(typeof jQuery != \"undefined\" && jQuery.isFunction( jQuery.fn.select2 )) return true;\r\n\t\t\t\t return false;\r\n\t\t\t}\r\n\t\t\tcase \"gmaps\": {\r\n\t\t\t\tif(typeof google == \"undefined\" || typeof google.maps == \"undefined\") return false;\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\tcase \"openlayers\": {\r\n\t\t\t\tif(typeof ol == \"undefined\" || typeof ol.Map == \"undefined\") return false;\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\tcase \"d3\": {\r\n\t\t\t\tif(typeof d3 == \"undefined\") return false;\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tconsole.log(new Error(plugin + \" is not a supported plugin ID\"));\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nTerminusPluginManager.prototype.fontAwesomeCheck = function(){\r\n\tvar span = document.createElement('span');\r\n\tspan.className = 'fa';\r\n\tspan.style.display = 'none';\r\n\tif(document.body){\r\n\t\tdocument.body.insertBefore(span, document.body.firstChild);\r\n\t\tfunction css(element, property) {\r\n\t\t  return window.getComputedStyle(element, null).getPropertyValue(property);\r\n\t\t}\r\n\t\tvar loaded = false;\r\n\t\tvar fontAwsm = css(span, 'font-family');\r\n\t\tif (fontAwsm.replace(/\"/g, \"\") == 'Font Awesome 5 Free') { // remove double quotes\r\n\t\t\tloaded = true;\r\n\t\t}\r\n\t\tdocument.body.removeChild(span);\r\n\t\treturn loaded;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nTerminusPluginManager.prototype.getDefaultPlugins = function(){\r\n\tvar defplugs = [\"font-awesome\"];\r\n\treturn defplugs;\r\n}\r\n\r\nTerminusPluginManager.prototype.loadPlugins = function(plugins, then){\r\n\tvar ticker = plugins.length;\r\n\tvar cback = function(){\r\n\t\tif(--ticker <= 1 && then){\r\n\t\t\tthen();\r\n\t\t}\r\n\t};\r\n\tfor(var i = 0; i < plugins.length; i++){\r\n\t\tthis.loadPlugin(plugins[i], cback);\r\n\t}\r\n}\r\n\r\nTerminusPluginManager.prototype.loadPlugin = function(plugin, then){\r\n\tvar pug = this.plugins[plugin];\r\n\tif(pug.css){\r\n\t\tfor(var i=0; i<pug.css.length; i++){\r\n\t\t\tvar cssid = plugin + \"_css_\" + i;\r\n\t\t\tTerminusClient.FrameHelper.loadDynamicCSS(cssid, pug.css[i]);\r\n\t\t}\r\n\t}\r\n\tvar scripts = (pug.js ? pug.js : []);\r\n\tif(plugin == \"gmaps\" && pug.key){\r\n\t\tscripts[0] += \"?key=\" + pug.key;\r\n\t}\r\n\tif(pug.plugin){\r\n\t\t//scripts.push(\"plugins/\" + pug.plugin);\r\n\t}\r\n\tif(plugin == \"codemirror\"){\r\n\t\tvar cm = scripts[0];\r\n\t\tvar sid = plugin + \"_js_\" + (scripts.length -1);\r\n\t\tscripts.splice(0, 1);\r\n\t\tvar self = this;\r\n\t\tvar cback = function(){\r\n\t\t\tself.loadPluginScripts(plugin, scripts, then);\r\n\t\t}\r\n\t\tTerminusClient.FrameHelper.loadDynamicScript(sid, cm, cback);\r\n\t}\r\n\telse {\r\n\t\tthis.loadPluginScripts(plugin, scripts, then);\r\n\t}\r\n}\r\n\r\nTerminusPluginManager.prototype.loadPluginScripts = function(plugin, scripts, then){\r\n\tvar ticker = scripts.length - 1;\r\n\tvar self = this;\r\n\tvar cback = function(){\r\n\t\tif(ticker == 0) {\r\n\t\t\tif(self.loaded.indexOf(plugin) == -1){\r\n\t\t\t\tself.loaded.push(plugin);\r\n\t\t\t}\r\n\t\t\tif(self.loading.indexOf(plugin) != -1){\r\n\t\t\t\tself.loading.splice(self.loading.indexOf(plugin), 1);\r\n\t\t\t}\r\n\t\t\tthen();\r\n\t\t}\r\n\t\tticker--;\r\n\t};\r\n\tif(scripts.length == 0){\r\n\t\tthis.loaded.push(plugin);\r\n\t}\r\n\telse {\r\n\t\tthis.loading.push(plugin);\r\n\t}\r\n\tfor(var i = 0; i<scripts.length; i++){\r\n\t\tvar sid = plugin + \"_js_\" + i;\r\n\t\tTerminusClient.FrameHelper.loadDynamicScript(sid, scripts[i], cback);\r\n\t}\r\n}\r\n\r\nTerminusPluginManager.prototype.loadPageCSS = function(css){\r\n\tcssfid = \"terminus_client_css\";\r\n\tvar cssdom = document.getElementById(cssfid);\r\n\tif(cssdom){\r\n\t\tcssdom.parentNode.removeChild(cssdom);\r\n\t}\r\n\tif(css){\r\n\t\tcssurl = \"css/\" + css + \".css\";\r\n\t\tTerminusClient.FrameHelper.loadDynamicCSS(cssfid, cssurl);\r\n\t}\r\n}\r\n\r\nTerminusPluginManager.prototype.pluginLoadable = function(pid){\r\n\treturn (this.precluded.indexOf(pid) !== -1 || this.pluginLoadedOrLoading(pid));\r\n}\r\n\r\nTerminusPluginManager.prototype.pluginLoadedOrLoading = function(pid){\r\n\tif(this.loaded.indexOf(pid) != -1) return true;\r\n\tif(this.preloaded.indexOf(pid) != -1) return true;\r\n\tif(this.loading.indexOf(pid) != -1) return true;\r\n\treturn false;\r\n}\r\n\r\nTerminusPluginManager.prototype.disabled = function(pid, obj){\r\n\tif(this.precluded.indexOf(pid) != -1) return true;\r\n\tif(obj.requires){\r\n\t\tfor(var i = 0; i<obj.requires.length; i++){\r\n\t\t\tif(!this.pluginLoadedOrLoading(obj.requires[i])) return true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nTerminusPluginManager.prototype.getPluginDOM = function(plugid, obj, ui){\r\n\tvar a = document.createElement(\"a\");\r\n\tvar cl = document.createElement(\"span\");\r\n\ta.appendChild(cl);\r\n\tcl.setAttribute(\"class\", \"terminus-plugin-control\");\r\n\tvar cbox = document.createElement(\"input\");\r\n\tcbox.id = \"terminus-plugin-control-\" + plugid;\r\n\tcbox.type = \"checkbox\";\r\n\tif(this.preloaded.indexOf(plugid) != -1){\r\n\t\tcbox.checked = true;\r\n\t\tcbox.disabled = true;\r\n\t}\r\n\telse if(this.loaded.indexOf(plugid) != -1){\r\n\t\tcbox.checked = true;\r\n\t}\r\n\telse if(this.loading.indexOf(plugid) != -1){\r\n\t\tcbox.checked = true;\r\n\t}\r\n\telse if(this.disabled(plugid, obj)){\r\n\t\tcbox.disabled = true;\r\n\t}\r\n\tvar clab = document.createElement(\"label\");\r\n\tclab.setAttribute(\"class\", \"terminus-plugin-label terminus-pointer\");\r\n\tclab.setAttribute(\"for\", cbox.id);\r\n\tclab.appendChild(document.createTextNode(obj.label));\r\n\tcl.appendChild(clab);\r\n\tcl.appendChild(cbox);\r\n\tvar self = this;\r\n\tcbox.addEventListener(\"change\", function(){\r\n\t\tself.togglePlugin(plugid, ui);\r\n\t});\r\n\treturn a;\r\n}\r\n\r\nTerminusPluginManager.prototype.togglePlugin = function(plugid, ui){\r\n\tif(this.loaded.indexOf(plugid) == -1){\r\n\t\tvar then = function(){\r\n\t\t\tui.redraw();\r\n\t\t}\r\n\t\tthis.loadPlugin(plugid, then);\r\n\t}\r\n\telse {\r\n\t\tthis.unloadPlugin(plugid);\r\n\t}\r\n\tTerminusClient.FrameHelper.removeChildren(ui.plugins);\r\n\tui.drawPlugins();\r\n}\r\n\r\nTerminusPluginManager.prototype.unloadPlugin = function(plugid){\r\n\tif(!this.plugins[plugid] || this.loaded.indexOf(plugid) == -1) {\r\n\t\tconsole.log(new Error(plugid + \" plugin unload request when it is not loaded\"));\r\n\t\treturn false;\r\n\t}\r\n\tvar pug = this.plugins[plugid];\r\n\tvar num = (pug.js) ? pug.js.length : 0;\r\n\tif(pug.plugin) num++;\r\n\tfor(var i=0; i< num; i++){\r\n\t\tvar cssfid = plugid + \"_js_\" + i;\r\n\t\tvar cssdom = document.getElementById(cssfid);\r\n\t\tif(cssdom){\r\n\t\t\tcssdom.parentNode.removeChild(cssdom);\r\n\t\t}\r\n\t}\r\n\tnum = (pug.css ? pug.css.length : 0);\r\n\tfor(var i=0; i< num; i++){\r\n\t\tvar cssfid = plugid + \"_css_\" + i;\r\n\t\tvar cssdom = document.getElementById(cssfid);\r\n\t\tif(cssdom){\r\n\t\t\tcssdom.parentNode.removeChild(cssdom);\r\n\t\t}\r\n\t}\r\n\tthis.loaded.splice(this.loaded.indexOf(plugid), 1);\r\n}\r\n\r\nTerminusPluginManager.prototype.getAsDOM = function(ui){\r\n\tvar dm = document.createElement(\"span\");\r\n\tdm.setAttribute(\"class\", \"terminus-plugin-manager\");\r\n\tvar clh = document.createElement(\"span\");\r\n\tclh.setAttribute(\"class\", \"terminus-plugin-control-header terminus-plugin-nav terminus-pointer\");\r\n\tclh.appendChild(document.createTextNode(\"Plugins\"));\r\n\tdm.appendChild(clh);\r\n\tvar a = document.createElement('a');\r\n\tthis.showPlugins(a, ui);\r\n\tclh.appendChild(a);\r\n\ta.style.display = 'none';\r\n\tclh.addEventListener('click', function(){\r\n\t\tif(a.style.display == 'none')\r\n\t\t\ta.style.display = 'block';\r\n\t\telse a.style.display = 'none';\r\n\t})\r\n\treturn dm;\r\n}\r\n\r\nTerminusPluginManager.prototype.showPlugins = function(a, ui){\r\n\ta.setAttribute('style', 'background-color: #111;');\r\n\tfor(var pid in this.plugins){\r\n\t\ta.appendChild(this.getPluginDOM(pid, this.plugins[pid], ui));\r\n\t}\r\n}\r\n\r\nmodule.exports=TerminusPluginManager\r\n","function getErrorAsMessage(url, api, err) {\n\t// console.log('getErrorAsMessage');\n\tlet str = '';\n\tif (err.response) {\n\t\terr = err.response;\n\t\tif (err.data) str += `${formatErrorMessage(err.data)}`;\n\t} else if (err.body) str += `${formatErrorMessage(err.data)}`;\n\n\tif (err.status) str += `Code: ${err.status}`;\n\tif (err.action) str += `, Action: ${err.action}`;\n\tif (err.type) str += `, Type: ${err.type}`;\n\tif (url) str += `, url: ${url}`;\n\tif (api && api.method) str += `, method: ${api.method}`;\n\treturn str;\n}\n\nfunction formatErrorMessage(msg) {\n\tif (typeof msg === 'object') {\n\t\tlet nmsg = '';\n\t\tfor (const key of Object.keys(msg)) {\n\t\t\tnmsg += `${key} ${msg[key]} `;\n\t\t}\n\t\treturn nmsg;\n\t}\n\treturn msg;\n}\n\nfunction accessDenied(action, db, server) {\n\tconst err = {};\n\terr.status = 403;\n\terr.url = (server || '') + (db || '');\n\terr.type = 'client';\n\terr.action = action;\n\terr.body = `${err.action} not permitted for ${err.url}`;\n\treturn err;\n}\n\nfunction getAPIErrorMessage(url, api, err) {\n\treturn `API Error ${getErrorAsMessage(url, api, err)}`;\n}\n\nfunction getAccessDeniedMessage(url, api, err) {\n\treturn `Access Denied ${getErrorAsMessage(url, api, err)}`;\n}\n\nfunction getInvalidURIMessage(url, call) {\n\tconst str = `Invalid argument to\n            ${call}. \n            ${url}\n            is not a valid Terminus DB API endpoint`;\n\treturn str;\n}\n\n/**\n * Utility functions for generating and retrieving error messages\n * and storing error state\n */\n\nfunction parseAPIError(response) {\n\tconst err = {};\n\terr.status = response.status;\n\terr.type = response.type;\n\tif (response.data && typeof response.data === 'object') {\n\t\tlet msg;\n\t\ttry {\n\t\t\tmsg = response.text();\n\t\t} catch (e) {\n\t\t\ttry {\n\t\t\t\tmsg = response.json();\n\t\t\t} catch (error) {\n\t\t\t\tmsg = response.toString();\n\t\t\t}\n\t\t}\n\t\terr.body = msg;\n\t} else if (response.data) err.body = response.data;\n\terr.url = response.url;\n\terr.headers = response.headers;\n\terr.redirected = response.redirected;\n\treturn err;\n}\n\n\nmodule.exports = {\n\tgetErrorAsMessage,\n\tgetAPIErrorMessage,\n\tgetAccessDeniedMessage,\n\taccessDenied,\n\tgetInvalidURIMessage,\n\tparseAPIError\n};\n","/**\r\n * Helper functions for dealing with frames and linked data documents\r\n */\r\nconst FrameHelper = {\r\n\tstandard_urls: {\r\n\t\trdf: 'http://www.w3.org/1999/02/22-rdf-syntax-ns#',\r\n\t\trdfs: 'http://www.w3.org/2000/01/rdf-schema#',\r\n\t\txsd: 'http://www.w3.org/2001/XMLSchema#',\r\n\t\towl: 'http://www.w3.org/2002/07/owl#',\r\n\t\ttcs: 'http://terminusdb.com/schema/tcs#',\r\n\t\ttbs: 'http://terminusdb.com/schema/tbs#',\r\n\t\txdd: 'http://terminusdb.com/schema/xdd#',\r\n\t\tv: 'http://terminusdb.com/woql/variable/',\r\n\t\tterminus: 'http://terminusdb.com/schema/terminus#',\r\n\t\tvio: 'http://terminusdb.com/schema/vio#',\r\n\t\tdocs: 'http://terminusdb.com/schema/documentation#'\r\n\t}\r\n};\r\n\r\nFrameHelper.addURLPrefix = function (prefix, url) {\r\n\tthis.standard_urls[prefix] = url;\r\n};\r\n\r\n\r\nFrameHelper.removeChildren = function (node) {\r\n\tif (node) {\r\n\t\twhile (node.hasChildNodes()) {\r\n\t\t\tnode.removeChild(node.childNodes[0]);\r\n\t\t}\r\n\t}\r\n};\r\n\r\nFrameHelper.removeElement = function (node) {\r\n\tif (node) {\r\n\t\t\tnode.parentNode.removeChild(node);\r\n\t}\r\n}\r\n\r\nFrameHelper.empty = function (obj) {\r\n\t   // null and undefined are \"empty\"\r\n\tif (!obj) return true;\r\n\t// Assume if it has a length property with a non-zero value\r\n\t// that that property is correct.\r\n\tif (obj.length > 0) return false;\r\n\tif (obj.length === 0) return true;\r\n\t// Otherwise, does it have any properties of its own?\r\n\t// Note that this doesn't handle\r\n\t// toString and valueOf enumeration bugs in IE < 9\r\n\t// for (const key in obj) {\r\n\tif (typeof obj === 'object') {\r\n\t\tfor (const key of Object.keys(obj)) {\r\n\t\t\tif (Object.prototype.hasOwnProperty.call(obj, key)) return false;\r\n\t\t}\r\n\t}\r\n\treturn true;\r\n};\r\n\r\nFrameHelper.genBNID = function () {\r\n\tconst r = Math.random().toString(36).substring(7);\r\n\tconst d = new Date();\r\n\tconst bnid = `_:${r}${d.getTime()}`;\r\n\treturn bnid;\r\n};\r\n\r\nFrameHelper.getShorthand = function (link) {\r\n\tif (typeof link === 'object' && link.length) link = link[0];\r\n\tif (link && typeof link === 'string') {\r\n\t\tfor (const pref of Object.keys(this.standard_urls)) {\r\n\t\t\tconst full = this.standard_urls[pref];\r\n\t\t\tif (link.substring(0, full.length) === full) {\r\n\t\t\t\tconst sh = `${pref}:${link.substring(full.length)}`;\r\n\t\t\t\treturn sh;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nFrameHelper.compareIDs = function (ida, idb) {\r\n\tif (ida === idb) return true;\r\n\tif (this.unshorten(ida) === idb) return true;\r\n\tif (this.unshorten(ida) === this.unshorten(idb)) return true;\r\n\tconst sha = this.getShorthand(ida);\r\n\tconst shb = this.getShorthand(idb);\r\n\tif (sha && ((sha === idb) || (sha === shb))) return true;\r\n\tif (shb && shb === ida) return true;\r\n\treturn false;\r\n};\r\n\r\n\r\nFrameHelper.shorten = function (url, prefixes) {\r\n\tfor (const pref in prefixes) {\r\n\t\tif (prefixes[pref] == url.substring(0, prefixes[pref].length)) {\r\n\t\t\treturn (`${pref}:${url.substring(prefixes[pref].length)}`);\r\n\t\t}\r\n\t}\r\n\treturn url;\r\n};\r\n\r\nFrameHelper.unshorten = function (url) {\r\n\tif (this.validURL(url)) return url;\r\n\tif (!url) return url;\r\n\tconst bits = url.split(':');\r\n\tif (bits[1]) {\r\n\t\tif (this.standard_urls[bits[0]]) {\r\n\t\t\treturn this.standard_urls[bits[0]] + bits[1];\r\n\t\t}\r\n\t}\r\n\treturn url;\r\n};\r\n\r\n// Valid URLs are those that start with http:// or https://\r\nFrameHelper.validURL = function (str) {\r\n\tif (str && (str.substring(0, 7) === 'http://' || str.substring(0, 8) === 'https://')) return true;\r\n\treturn false;\r\n};\r\n\r\n\r\nFrameHelper.labelFromURL = function (url) {\r\n\tlet nurl = this.urlFragment(url);\r\n\tnurl = (nurl || url);\r\n\tif (nurl.lastIndexOf('/') < nurl.length - 1) {\r\n\t\tnurl = nurl.substring(nurl.lastIndexOf('/') + 1);\r\n\t}\r\n\tnurl = nurl.replace('_', ' ');\r\n\treturn nurl.charAt(0).toUpperCase() + nurl.slice(1);\r\n};\r\n\r\nFrameHelper.urlFragment = function (url) {\r\n\turl = (typeof url !== 'string') ? window.location.href : url;\r\n\tlet bits = url.split('#');\r\n\tif (bits.length <= 1) {\r\n\t\tif (!this.validURL(url)) {\r\n\t\t\tbits = url.split(':');\r\n\t\t}\r\n\t}\r\n\tif (bits.length >= 1) {\r\n\t\tconst [, urlStr] = bits;\r\n\r\n\t\tif (urlStr) {\r\n\t\t\tconst [baseUrl] = urlStr.split('?');\r\n\t\t\turl = baseUrl;\r\n\t\t}\r\n\t}\r\n\treturn url;\r\n};\r\n\r\nFrameHelper.isStringType = function (stype) {\r\n\tif (stype === 'http://www.w3.org/2001/XMLSchema#string') return true;\r\n\tif (stype === 'xsd:string') return true;\r\n\treturn false;\r\n};\r\n\r\nFrameHelper.lastURLBit = function (url) {\r\n\turl = (typeof url === 'undefined') ? window.location.href : url;\r\n\tconst [urlFirst] = url.split('#');\r\n\tconst [urlTmp] = urlFirst.split('?');\r\n\turl = urlTmp.substring(url.lastIndexOf('/') + 1);\r\n\treturn url;\r\n};\r\n\r\n\r\nFrameHelper.getStdURL = function (pref, ext, url) {\r\n\tif (this.standard_urls[pref]) {\r\n\t\tif (url) {\r\n\t\t\tif (url === this.standard_urls[pref] + ext) return url;\r\n\t\t} else {\r\n\t\t\treturn this.standard_urls[pref] + ext;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nFrameHelper.viewIncludesProperties = function (view) {\r\n\tif (view === 'full' || view === 'production' || view === 'terse') {\r\n\t\treturn true;\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nFrameHelper.viewIncludesChildren = function (view, type) {\r\n\treturn this.viewIncludesProperties(view, type);\r\n};\r\n\r\nFrameHelper.viewIncludesValue = function (view, type) {\r\n\treturn this.viewIncludesProperties(view, type);\r\n};\r\n\r\nFrameHelper.numberWithCommas = function (value) {\r\n\tif (value >= 1000 || value <= -1000) {\r\n\t    const parts = value.toString().split('.');\r\n\t    if (value <= -1000) parts[0] = parts[0].substring(1);\r\n\t    parts[0] = parts[0].replace(/\\B(?=(\\d{3})+(?!\\d))/g, ',');\r\n\t    if (value <= -1000) value = `-${parts.join('.')}`;\r\n\t    else value = parts.join('.');\r\n\t}\r\n\treturn value;\r\n};\r\n\r\nFrameHelper.datatypes = [\r\n\t'xdd:coordinate', 'xdd:coordinatePolyline',\r\n\t'xdd:coordinatePolygon', 'xdd:dateRange', 'xdd:gYearRange', 'xdd:integerRange',\r\n\t'xdd:decimalRange', 'xdd:cc', 'xdd:email', 'xdd:html', 'xdd:url', 'xsd:anySimpleType',\r\n\t'xsd:string', 'xsd:boolean', 'xsd:decimal', 'xsd:double', 'xsd:float', 'xsd:time', 'xsd:date',\r\n\t'xsd:dateTime', 'xsd:dateTimeStamp', 'xsd:gYear', 'xsd:gMonth', 'xsd:gDay', 'xsd:gYearMonth',\r\n\t'xsd:gMonthDay', 'xsd:duration', 'xsd:yearMonthDuration', 'xsd:dayTimeDuration',\r\n\t'xsd:byte', 'xsd:short', 'xsd:integer', 'xsd:long', 'xsd:unsignedByte',\t'xsd:unsignedInt',\r\n\t'xsd:unsignedLong',\t'xsd:nonNegativeInteger', 'xsd:positiveInteger', 'xsd:negativeInteger',\r\n\t'xsd:nonPositiveInteger', 'xsd:base64Binary', 'xsd:anyURI', 'xsd:language', 'xsd:normalizedString',\r\n\t'xsd:token', 'xsd:NMTOKEN',\t'xsd:Name',\t'xsd:NCName', 'xsd:NOTATION', 'xsd:QName', 'xsd:ID',\r\n\t'xsd:IDREF', 'xsd:ENTITY', 'rdf:XMLLiteral', 'rdf:PlainLiteral', 'rdfs:Literal', 'xdd:json'\r\n];\r\n\r\nFrameHelper.parseDate = function (ty, value) {\r\n\tlet parsed;\r\n\tif (ty === 'xsd:date') {\r\n\t\tparsed = this.parseXsdDate(value);\r\n\t} else if (ty === 'xsd:time') {\r\n\t\tparsed = this.parseXsdTime(value);\r\n\t} else if (ty === 'xsd:dateTime') {\r\n\t\tparsed = this.parseXsdDateTime(value);\r\n\t} else if (ty === 'xsd:gYear') {\r\n\t\tparsed = { year: value };\r\n\t} else if (ty === 'xsd:gYearRange') {\r\n\t\tparsed = { year: value };\r\n\t} else if (ty === 'xsd:gMonth') {\r\n\t\tparsed = { month: value.substring(2) };\r\n\t} else if (ty === 'xsd:gDay') {\r\n\t\tparsed = { day: value };\r\n\t} else if (ty === 'xsd:gYearMonth') {\r\n\t\tconst bits = value.split('-');\r\n\t\twhile (bits.length < 2) bits.push('');\r\n\t\tparsed = { year: bits[0], month: bits[1] };\r\n\t} else if (ty === 'xsd:gMonthDay') {\r\n\t\tconst bits = value.split('-');\r\n\t\twhile (bits.length < 2) bits.push('');\r\n\t\tparsed = { month: bits[0], day: bits[1] };\r\n\t} else if (ty === 'xsd:dateTimeStamp') {\r\n\t\tparsed = this.parseXsdDateTime(value);\r\n\t}\r\n\treturn parsed;\r\n};\r\n\r\nFrameHelper.parseXsdDate = function (val) {\r\n\tconst tz = this.extractXsdTimezone(val);\r\n\tif (tz) {\r\n\t\tval = val.substring(0, val.length - tz.length);\r\n\t}\r\n\tlet year;\r\n\tif (val.substring(0, 1) === '-') {\r\n\t\tyear = val.substring(0, 5);\r\n\t} else {\r\n\t\tyear = val.substring(0, 4);\r\n\t}\r\n\tlet parsed;\r\n\tif (year && Math.abs(year) < 10000) {\r\n\t\tlet month = val.substring(year.length + 1, year.length + 3);\r\n\t\tif (month) { month = parseInt(month, 10); } else return false;\r\n\t\tlet day = val.substring(year.length + 4);\r\n\t\tif (day) day = parseInt(day, 10);\r\n\t\telse return false;\r\n\t\tparsed = {\r\n\t\t\tyear,\r\n\t\t\t   month,\r\n\t\t\t   day,\r\n\t\t\t   timezone: tz\r\n\t\t};\r\n\t}\r\n\treturn parsed;\r\n};\r\n\r\nFrameHelper.addXsdPadding = function (parsed) {\r\n\tconst nparsed = {};\r\n\tif (typeof parsed.year !== 'undefined' && parsed.year !== false && parsed.year < 1000) {\r\n\t\tif (Math.abs(parsed.year) < 10) nparsed.year = (parsed.year < 0 ? `-000${Math.abs(parsed.year)}` : `000${parsed.year}`);\r\n\t\telse if (Math.abs(parsed.year) < 100) nparsed.year = (parsed.year < 0 ? `-00${Math.abs(parsed.year)}` : `00${parsed.year}`);\r\n\t\telse nparsed.year = (parsed.year < 0 ? `-0${Math.abs(parsed.year)}` : `0${parsed.year}`);\r\n\t} else if (parsed.year) {\r\n\t\tnparsed.year = parsed.year;\r\n\t}\r\n\tif (typeof parsed.month !== 'undefined' && parsed.month !== false && parsed.month < 10) {\r\n\t\tnparsed.month = `0${parsed.month}`;\r\n\t} else if (parsed.month) {\r\n\t\tnparsed.month = parsed.month;\r\n\t}\r\n\tif (typeof parsed.day !== 'undefined' && parsed.day !== false && parsed.day < 10) {\r\n\t\tnparsed.day = `0${parsed.day}`;\r\n\t} else if (parsed.day) {\r\n\t\tnparsed.day = parsed.day;\r\n\t}\r\n\tif (typeof parsed.hour !== 'undefined' && parsed.hour !== false && parsed.hour < 10) {\r\n\t\tnparsed.hour = `0${parsed.hour}`;\r\n\t} else if (parsed.hour) {\r\n\t\tnparsed.hour = parsed.hour;\r\n\t}\r\n\tif (typeof parsed.minute !== 'undefined' && parsed.minute !== false && parsed.minute < 10) {\r\n\t\tnparsed.minute = `0${parsed.minute}`;\r\n\t} else if (parsed.minute) {\r\n\t\tnparsed.minute = parsed.minute;\r\n\t}\r\n\tif (typeof parsed.second !== 'undefined' && parsed.second !== false && parsed.second < 10) {\r\n\t\tnparsed.second = `0${parsed.second}`;\r\n\t} else if (parsed.second) {\r\n\t\tnparsed.second = parsed.second;\r\n\t}\r\n\treturn nparsed;\r\n};\r\n\r\n\r\nFrameHelper.xsdFromParsed = function (parsed, ty) {\r\n\tconst xparsed = this.addXsdPadding(parsed);\r\n\tlet ret;\r\n\tif (ty === 'xsd:gYear') {\r\n\t\tret = (xparsed.year ? xparsed.year : false);\r\n\t} else if (ty === 'xsd:time') {\r\n\t\treturn (xparsed.hour && xparsed.minute && xparsed.second) ? `${xparsed.hour}:${xparsed.minute}:${xparsed.second}` : false;\r\n\t} else if (ty === 'xsd:date') {\r\n\t\treturn (xparsed.year && xparsed.month && xparsed.day) ? `${xparsed.year}-${xparsed.month}-${xparsed.day}` : false;\r\n\t} else if (ty === 'xsd:dateTime' || ty === 'xsd:dateTimeStamp') {\r\n\t\tret = (xparsed.year && xparsed.month && xparsed.day) ? `${xparsed.year}-${xparsed.month}-${xparsed.day}T` : false;\r\n\t\tif (ret) ret += `${xparsed.hour ? xparsed.hour : '12'}:${xparsed.minute ? xparsed.minute : '00'}:${xparsed.second ? xparsed.second : '00'}`;\r\n\t} else if (ty === 'xsd:gMonth') {\r\n\t\tret = (xparsed.month ? `--${xparsed.month}` : false);\r\n\t} else if (ty === 'xsd:gDay') {\r\n\t\tret = (xparsed.day ? `---${xparsed.day}` : false);\r\n\t} else if (ty === 'xsd:gYearMonth') {\r\n\t\tret = (xparsed.year && xparsed.month) ? `${xparsed.year}-${xparsed.month}` : false;\r\n\t} else if (ty === 'xsd:gMonthDay') {\r\n\t\tret = (xparsed.day && xparsed.month) ? `--${xparsed.month}-${xparsed.day}` : false;\r\n\t}\r\n\tif (xparsed.timezone) {\r\n\t\tret += xparsed.timezone;\r\n\t}\r\n\treturn ret;\r\n};\r\n\r\n\r\nFrameHelper.parseXsdTime = function (val) {\r\n\tif (!val) return {};\r\n\tconst tz = this.extractXsdTimezone(val);\r\n\tif (tz) {\r\n\t\tval = val.substring(0, val.length - tz.length);\r\n\t}\r\n\tconst parsed = {\r\n\t\thour: val.substring(0, 2),\r\n\t\tminute: val.substring(3, 5),\r\n\t\tsecond: val.substring(6),\r\n\t\ttimezone: tz\r\n\t};\r\n\treturn parsed;\r\n};\r\n\r\nFrameHelper.convertTimestampToXsd = function (val) {\r\n\t  const a = new Date(val * 1000);\r\n\t  const parsed = {\r\n\t\tyear: a.getFullYear(),\r\n\t\tmonth: a.getMonth() + 1,\r\n\t\tday: a.getDate(),\r\n\t\thour: a.getHours(),\r\n\t\tminute: a.getMinutes(),\r\n\t\tsecond: a.getSeconds()\r\n\t  };\r\n\t  return parsed;\r\n};\r\n\r\nFrameHelper.parseXsdDateTime = function (val) {\r\n\tif (!val) return {};\r\n\tif (typeof val === 'number') {\r\n\t\treturn this.convertTimestampToXsd(val);\r\n\t}\r\n\tconst tz = this.extractXsdTimezone(val);\r\n\tif (tz) {\r\n\t\tval = val.substring(0, val.length - tz.length);\r\n\t}\r\n\tconst datetime = this.parseXsdDate(val);\r\n\tconst ptime = this.parseXsdTime(val.substring(val.indexOf('T') + 1));\r\n\r\n\tfor (const i of Object.keys(ptime)) {\r\n\t\tdatetime[i] = ptime[i];\r\n\t}\r\n\tdatetime.timezone = tz;\r\n\treturn datetime;\r\n};\r\n\r\nFrameHelper.extractXsdTimezone = function (val) {\r\n\tif (val && val.charAt(val.length - 1) === 'Z') {\r\n\t\treturn 'Z';\r\n\t}\r\n\tif (val && (val.charAt(val.length - 6) === '+' || val.charAt(val.length - 6) === '-')) {\r\n\t\tval.substring(val.length - 6);\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nFrameHelper.parseRangeValue = function (val, dividor) {\r\n\tdividor = (dividor || ',');\r\n\tlet vals = [];\r\n\tif (typeof val === 'object' && val.length) {\r\n\t\tvals = val;\r\n\t} else if (val) {\r\n\t\tif (typeof val !== 'string') {\r\n\t\t\tval = `${val}`;\r\n\t\t}\r\n\t\tif (val.length && (val.charAt(0) === '[') && val.charAt(val.length - 1) === ']') {\r\n\t\t\tvals.push(val.substring(1, val.indexOf(dividor)));\r\n\t\t\tvals.push(val.substring(val.indexOf(dividor) + 1, val.length - 1));\r\n\t\t} else {\r\n\t\t\tvals.push(val);\r\n\t\t}\r\n\t}\r\n\treturn vals;\r\n};\r\n\r\nFrameHelper.loadDynamicScript = function (scriptid, src, callback) {\r\n\tconst existingScript = document.getElementById(scriptid);\r\n\tif (!existingScript) {\r\n\t\tconst script = document.createElement('script');\r\n\t\tscript.src = src; // URL for the third-party library being loaded.\r\n\t\tdocument.body.appendChild(script);\r\n\t\tscript.onload = function () {\r\n\t\t\tscript.id = scriptid; // do it here so it doesn't trigger the callback below on multiple calls\r\n\t\t\tif (callback) callback(scriptid);\r\n\t\t};\r\n\t}\r\n\tif (existingScript && callback) {\r\n\t\tcallback(scriptid);\r\n\t}\r\n};\r\n\r\nFrameHelper.loadDynamicCSS = function (cssid, src, callback) {\r\n\tconst existingScript = document.getElementById(cssid);\r\n\tif (!existingScript) {\r\n\t\tconst link = document.createElement('link');\r\n\t\tlink.href = src; // URL for the third-party library being loaded.\r\n\t\tlink.id = cssid; // e.g., googleMaps or stripe\r\n\t\tlink.rel = 'stylesheet';\r\n\t\tdocument.body.appendChild(link);\r\n\t\tlink.onload = function () {\r\n\t\t\tif (callback) callback(cssid);\r\n\t\t};\r\n\t}\r\n\tif (existingScript && callback) callback(cssid);\r\n};\r\n\r\nmodule.exports = FrameHelper;\r\n","const ObjectViewer= require(\"../html/document/ObjectViewer\")\r\nconst HTMLStringViewer = require('../html/datatypes/String');\r\nconst HTMLStringEditor = require('../html/datatypes/StringEditor');\r\nconst HTMLBooleanViewer = require('../html/datatypes/Boolean');\r\nconst HTMLBooleanEditor = require('../html/datatypes/BooleanEditor');\r\nconst HTMLChoiceViewer = require('../html/datatypes/Choice');\r\nconst HTMLChoiceEditor = require('../html/datatypes/ChoiceEditor');\r\nconst HTMLCoordinateViewer = require('../html/datatypes/Coordinate');\r\nconst HTMLCoordinateEditor = require('../html/datatypes/CoordinateEditor');\r\nconst HTMLDateViewer = require('../html/datatypes/Date');\r\nconst HTMLDateEditor = require('../html/datatypes/DateEditor');\r\nconst HTMLEntityViewer = require('../html/datatypes/Entity');\r\nconst HTMLEntityEditor = require('../html/datatypes/EntityEditor');\r\nconst HTMLImageViewer = require('../html/datatypes/Image');\r\nconst HTMLImageEditor = require('../html/datatypes/ImageEditor');\r\nconst HTMLLinkViewer = require('../html/datatypes/Link');\r\nconst HTMLNumberViewer = require('../html/datatypes/Number');\r\nconst HTMLRangeViewer = require('../html/datatypes/Range');\r\nconst HTMLRangeEditor = require('../html/datatypes/RangeEditor');\r\nconst SantizedHTMLViewer = require('../html/datatypes/SanitizedHTML');\r\nconst GoogleMapEditor = require('../html/datatypes/GoogleMapEditor');\r\nconst GoogleMapViewer = require('../html/datatypes/GoogleMapViewer');\r\nconst HTMLMarkupEditor = require('../html/datatypes/HTMLMarkupEditor');\r\nconst S2EntityEditor = require('../html/datatypes/S2EntityEditor');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nlet RenderingMap = {\r\n\tregisteredDataViewers: {},\r\n\tregisteredDataEditors: {},\r\n\tgetValidDataViewerList: function(type, frametype){\r\n\t\tvar valids = ['HTMLStringViewer'];\r\n\t\tif(frametype && typeof this.registeredDataViewers[frametype] != \"undefined\"){\r\n\t\t\tvalids = valids.concat(this.registeredDataViewers[frametype]);\r\n\t\t}\r\n\t\tif(typeof this.registeredDataViewers[type] != \"undefined\"){\r\n\t\t\tvalids = valids.concat(this.registeredDataViewers[type]);\r\n\t\t}\r\n\t\treturn valids;\r\n\t},\r\n\tgetValidDataEditorList: function(type, frametype){\r\n\t\tvar valids = ['HTMLStringEditor'];\r\n\t\tif(frametype && typeof this.registeredDataEditors[frametype] != \"undefined\"){\r\n\t\t\tvar nftypes = this.registeredDataEditors[frametype];\r\n\t\t\tif(nftypes){\r\n\t\t\t\tfor(var i = 0; i<nftypes.length; i++){\r\n\t\t\t\t\tif(valids.indexOf(nftypes[i]) == -1) valids.push(nftypes[i]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(typeof this.registeredDataEditors[type] != \"undefined\"){\r\n\t\t\tvalids = valids.concat(this.registeredDataEditors[type]);\r\n\t\t}\r\n\t\treturn valids;\r\n\t},\r\n\tgetViewer: function(type, options, datatype){\r\n\t\tvar vi = this.renderers[type];\r\n\t\toptions = (options ? options: {});\r\n\t\ttry {\r\n\t\t\tvar viewer = eval(\"new \" + type + \".\" + type + \"(\" + JSON.stringify(options) + \")\");\r\n\t\t\tif(datatype) viewer.type = datatype;\r\n\t\t\treturn viewer;\r\n\t\t}\r\n\t\tcatch(e){\r\n\t\t\talert(\"failed on create \" + e.toString());\r\n\t\t}\r\n\t},\r\n\tgetAvailableDataViewers: function(type, frametype){\r\n\t\tvar viewers = [];\r\n\t\tvar nviewers = []\r\n\t\tvar opts = this.getValidDataViewerList(type, frametype);\r\n\t\tfor(var i = 0; i<opts.length; i++){\r\n\t\t\tif(nviewers.indexOf(opts[i]) == -1) {\r\n\t\t\t\tnviewers.push(opts[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor(var i = 0; i<nviewers.length; i++){\r\n\t\t\tif(this.renderers[nviewers[i]]){\r\n\t\t\t\tvar sets = this.renderers[nviewers[i]];\r\n\t\t\t\tviewers.push({value: nviewers[i], label: sets.label});\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn viewers;\r\n\t},\r\n\tgetAvailableDataEditors: function(type, frametype){\r\n\t\tvar viewers = [];\r\n\t\tvar nviewers = []\r\n\t\tvar opts = this.getValidDataEditorList(type, frametype);\r\n\t\tfor(var i = 0; i<opts.length; i++){\r\n\t\t\tif(nviewers.indexOf(opts[i]) == -1) {\r\n\t\t\t\tnviewers.push(opts[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor(var i = 0; i<nviewers.length; i++){\r\n\t\t\tif(this.renderers[nviewers[i]]){\r\n\t\t\t\tvar sets = this.renderers[nviewers[i]];\r\n\t\t\t\tviewers.push({value: nviewers[i], label: sets.label});\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn viewers;\r\n\t},\r\n\tgetViewerForDataFrame: function(type, frametype){\r\n\t\tvar vals = this.getValidDataViewerList(type, frametype);\r\n\t\treturn vals[vals.length-1];\r\n\t},\r\n\tgetEditorForDataFrame: function(type, frametype){\r\n\t\tvar vals = this.getValidDataEditorList(type, frametype);\r\n\t\treturn vals[vals.length-1];\r\n\t},\r\n\tregisterViewerForTypes: function(viewer, label, types){\r\n\t\tfor(var i = 0; i < types.length; i++){\r\n\t\t\tif(typeof this.registeredDataViewers[types[i]] == \"undefined\"){\r\n\t\t\t\tthis.registeredDataViewers[types[i]] = [];\r\n\t\t\t}\r\n\t\t\tif(this.registeredDataViewers[types[i]].indexOf(viewer) == -1){\r\n\t\t\t\tthis.registeredDataViewers[types[i]].push(viewer);\r\n\t\t\t\tthis.renderers[viewer] = {label: label};\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tregisterEditorForTypes: function(viewer, label, types){\r\n\t\tfor(var i = 0; i < types.length; i++){\r\n\t\t\tif(typeof this.registeredDataEditors[types[i]] == \"undefined\"){\r\n\t\t\t\tthis.registeredDataEditors[types[i]] = [];\r\n\t\t\t}\r\n\t\t\tif(this.registeredDataEditors[types[i]].indexOf(viewer) == -1){\r\n\t\t\t\tthis.registeredDataEditors[types[i]].push(viewer);\r\n\t\t\t\tthis.renderers[viewer] = {label: label};\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tregisterEditorForFrameType: function(viewer, label, frametype){\r\n\t\tthis.renderers[viewer] = {label: label};\r\n\t\tif(typeof this.registeredDataEditors[frametype] == \"undefined\") this.registeredDataEditors[frametype] = [];\r\n\t\tif(this.registeredDataEditors[frametype].indexOf(viewer) == -1){\r\n\t\t\tthis.registeredDataEditors[frametype].push(viewer);\r\n\t\t}\r\n\t},\r\n\tregisterViewerForFrameType: function(viewer, label, frametype){\r\n\t\tthis.renderers[viewer] = {label: label};\r\n\t\tif(typeof this.registeredDataViewers[frametype] == \"undefined\") this.registeredDataViewers[frametype] = [];\r\n\t\tif(this.registeredDataViewers[frametype].indexOf(viewer) == -1){\r\n\t\t\tthis.registeredDataViewers[frametype].push(viewer);\r\n\t\t}\r\n\t},\r\n\trenderers: {\r\n\t\tHTMLStringViewer: { label: \"String Viewer\"},\r\n\t\tHTMLStringEditor: { label: \"String Editor\"},\r\n\t}\r\n}\r\n\r\nRenderingMap.addPlugin = function(plugin){\r\n\tif(plugin == \"gmaps\"){\r\n\t\tthis.registerEditorForTypes(\"GoogleMapEditor\", \"Google Map Editor\", [\"xdd:coordinate\", \"xdd:coordinatePolyline\", \"xdd:coordinatePolygon\"]);\r\n\t\tthis.registerViewerForTypes(\"GoogleMapViewer\", \"Google Map Editor\", [\"xdd:coordinate\", \"xdd:coordinatePolyline\", \"xdd:coordinatePolygon\"]);\r\n\t}\r\n\tif(plugin == \"quill\"){\r\n\t\tthis.registerEditorForTypes(\"HTMLMarkupEditor\", \"Quill WYSIWIG HTML Editor\", [\"xdd:html\"]);\r\n\t}\r\n\tif(plugin == \"select2\"){\r\n\t\tRenderingMap.registerEditorForFrameType(\"S2EntityEditor\", \"S2 Autocomplete Selector\", \"document\");\r\n\t}\r\n\tif(plugin == \"jsoneditor\"){\r\n\t\tRenderingMap.registerEditorForFrameType(\"S2EntityEditor\", \"S2 Autocomplete Selector\", \"document\");\r\n\t}\r\n}\r\n\r\nRenderingMap.decorateRenderer = function(options, renderer){\r\n\tvar compiled_options = this.compileOptions(options, renderer);\r\n\tif(compiled_options && compiled_options.mode){\r\n\t\trenderer.mode = compiled_options.mode;\r\n\t}\r\n\telse {\r\n\t\tif(renderer.parent && renderer.parent.mode) renderer.mode = renderer.parent.mode;\r\n\t\telse renderer.mode = \"view\";\r\n\t}\r\n\tif(compiled_options && compiled_options.view){\r\n\t\trenderer.view = compiled_options.view;\r\n\t}\r\n\telse {\r\n\t\tif(renderer.parent && renderer.parent.view) renderer.view = renderer.parent.view;\r\n\t\telse renderer.view = \"full\";\r\n\t}\r\n\tif(compiled_options && compiled_options.facets){\r\n\t\trenderer.facets = compiled_options.facets;\r\n\t}\r\n\telse {\r\n\t\trenderer.facets = renderer.getDefaultFacets();\r\n\t}\r\n\tif(compiled_options && compiled_options.facet && typeof renderer.facets[compiled_options.facet] == \"object\"){\r\n\t\trenderer.facet = compiled_options.facet;\r\n\t}\r\n\telse {\r\n\t\tvar deffacet = renderer.getDefaultFacet();\r\n\t\tif(typeof renderer.facets[deffacet] == \"object\"){\r\n\t\t\trenderer.facet = deffacet;\r\n\t\t}\r\n\t\telse {\r\n\t\t\trenderer.facet = key(renderer.facets);\r\n\t\t}\r\n\t}\r\n\tif(compiled_options && compiled_options.hide_disabled_buttons){\r\n\t\trenderer.hide_disabled_buttons = compiled_options.hide_disabled_buttons;\r\n\t}\r\n\telse if(renderer.parent) renderer.hide_disabled_buttons = parent.hide_disabled_buttons;\r\n\telse renderer.hide_disabled_buttons = true;\r\n\tif(compiled_options && typeof compiled_options.features == \"object\"){\r\n\t\trenderer.features = compiled_options.features;\r\n\t}\r\n\telse {\r\n\t\trenderer.features = renderer.facets[renderer.facet].features;\r\n\t\t//renderer.features = renderer.getDefaultFeatures(renderer.facet);\r\n\t}\r\n\tif(compiled_options && typeof compiled_options.controls == \"object\"){\r\n\t\trenderer.controls = compiled_options.controls;\r\n\t}\r\n\telse {\r\n\t\trenderer.controls = renderer.facets[renderer.facet].controls;\r\n\t\t//renderer.controls = renderer.getDefaultControls();\r\n\t}\r\n\tif(compiled_options && typeof compiled_options.viewerType != \"undefined\"){\r\n\t\trenderer.viewerType = compiled_options.viewerType;\r\n\t\tif(compiled_options.viewerOptions)\r\n\t\t\trenderer.viewerOptions = compiled_options.viewerOptions;\r\n\t}\r\n\tif(compiled_options && typeof compiled_options.header != \"undefined\"){}\r\n\telse {\r\n\t\trenderer.header_viewer = new ObjectViewer.HTMLObjectHeaderViewer();\r\n\t}\r\n\tif(compiled_options && typeof compiled_options.filter != \"undefined\"){}\r\n\telse {}\r\n\tif(compiled_options && typeof compiled_options.sort != \"undefined\"){}\r\n\telse {}\r\n\treturn options;\r\n}\r\n\r\n\r\nRenderingMap.compileOptions = function(options, renderer){\r\n\tvar compiled_options = {};\r\n\tvar rules = [];\r\n\tfor(var key in options){\r\n\t\tif(key != \"rules\"){\r\n\t\t\tcompiled_options[key] = options[key];\r\n\t\t}\r\n\t}\r\n\t/*if(options.rules){\r\n\t\tfor(var i = 0; i<options.rules.length; i++){\r\n\t\t\tvar match = (!options.rules[i].pattern || this.patternMatchesRenderer(options.rules[i].pattern, renderer));\r\n\t\t\tif(match && options.rules[i].output){\r\n\t\t\t\tfor(var k in options.rules[i].output){\r\n\t\t\t\t\tcompiled_options[k] = options.rules[i].output[k];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t} */\r\n\treturn compiled_options;\r\n}\r\n\r\nRenderingMap.registerViewerForTypes(\"HTMLBooleanViewer\", \"Checkbox Viewer\", [\"xsd:boolean\"]);\r\nRenderingMap.registerEditorForTypes(\"HTMLBooleanEditor\", \"Checkbox Editor\", [\"xsd:boolean\"]);\r\nRenderingMap.registerViewerForFrameType(\"HTMLChoiceViewer\", \"Choice Viewer\", \"oneOf\");\r\nRenderingMap.registerEditorForFrameType(\"HTMLChoiceEditor\", \"Choice Selector\", \"oneOf\");\r\nRenderingMap.registerViewerForTypes(\"HTMLCoordinateViewer\", \"Coordinate Viewer\", [\"xdd:coordinate\", \"xdd:coordinatePolyline\", \"xdd:coordinatePolygon\"]);\r\nRenderingMap.registerEditorForTypes(\"HTMLCoordinateEditor\", \"Coordinate Editor\", [\"xdd:coordinate\", \"xdd:coordinatePolyline\", \"xdd:coordinatePolygon\"]);\r\nRenderingMap.registerViewerForTypes(\"HTMLDateViewer\", \"Date Viewer\", [\"xsd:time\", \"xsd:date\", \"xsd:dateTime\", \"xsd:gYear\",\r\n\t\"xsd:gYearRange\", \"xsd:gMonth\", \"xsd:gDay\", \"xsd:gYearMonth\", \"xsd:gMonthDay\", \"xsd:dateTimeStamp\"]);\r\nRenderingMap.registerEditorForTypes(\"HTMLDateEditor\", \"Date Editor\", [\"xsd:time\", \"xsd:date\", \"xsd:dateRange\" ,\"xsd:dateTime\", \"xsd:gYear\",\r\n\t\"xsd:gYearRange\", \"xsd:gMonth\", \"xsd:gDay\", \"xsd:gYearMonth\", \"xsd:gMonthDay\", \"xsd:dateTimeStamp\"]);\r\nRenderingMap.registerViewerForFrameType(\"HTMLEntityViewer\", \"Document Viewer\", \"document\");\r\nRenderingMap.registerEditorForFrameType(\"HTMLEntityEditor\", \"Document Selector\", \"document\");\r\nRenderingMap.registerViewerForTypes(\"HTMLImageViewer\", \"Image Viewer\", [\"xdd:url\", \"xsd:anyURI\", \"xsd:base64Binary\"]);\r\nRenderingMap.registerEditorForTypes(\"HTMLImageEditor\", \"Image Editor\", [\"xsd:base64Binary\"]);\r\nRenderingMap.registerViewerForTypes(\"HTMLImageViewer\", \"Image Viewer\", [\"xdd:url\", \"xsd:anyURI\", \"xsd:base64Binary\"]);\r\nRenderingMap.registerEditorForTypes(\"HTMLImageEditor\", \"Image Editor\", [\"xsd:base64Binary\"]);\r\nRenderingMap.registerViewerForTypes(\"HTMLLinkViewer\", \"Link Viewer\", [\"xdd:url\", \"xsd:anyURI\"]);\r\nRenderingMap.registerViewerForTypes(\"HTMLNumberViewer\", \"Number with commas\",\r\n\t\t[\"xsd:decimal\", \"xsd:double\", \"xsd:float\", \"xsd:short\", \"xsd:integer\", \"xsd:long\",\r\n\t\t\t\"xsd:nonNegativeInteger\", \"xsd:positiveInteger\", \"xsd:negativeInteger\", \"xsd:nonPositiveInteger\"]);\r\nRenderingMap.registerViewerForTypes(\"HTMLRangeViewer\", \"Range Viewer\", [\"xdd:gYearRange\", \"xdd:dateRange\", \"xdd:integerRange\", \"xdd:decimalRange\"]);\r\nRenderingMap.registerEditorForTypes(\"HTMLRangeEditor\", \"Range Editor\", [\"xdd:gYearRange\", \"xdd:dateRange\", \"xdd:integerRange\", \"xdd:decimalRange\"]);\r\nRenderingMap.registerViewerForTypes(\"SantizedHTMLViewer\", \"Sanitized HTML\", [\"xsd:string\", \"xdd:html\"]);\r\n\r\nmodule.exports=RenderingMap\r\n","const DatatypeRenderers = require(\"./DatatypeRenderers\");\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction TerminusFrame(client){\r\n\tthis.client = client;\r\n\tthis.load_schema = false;\r\n}\r\n\r\nTerminusFrame.prototype.options = function(opts){\r\n\tthis.config = opts || TerminusClient.WOQL.document();\r\n\treturn this;\r\n}\r\n\r\nTerminusFrame.prototype.setDatatypes = function(func){\r\n\tthis.datatypes = new DatatypeRenderers();\r\n\tif(this.config.datatypes) this.datatypes.options(this.config.datatypes);\r\n\tif(func) func(this.datatypes);\r\n\treturn this;\r\n}\r\n\r\nTerminusFrame.prototype.loadDocument = function(url, cls){\r\n\tif(!url) return false;\r\n\tvar self = this;\r\n\tif(url.substring(0,4) == \"doc:\"){\r\n\t\turl = url.substring(4);\r\n\t}\r\n\treturn this.client.getDocument(url, {\"terminus:encoding\": \"terminus:frame\"})\r\n\t.then(function(response){\r\n\t\tself.loadDataFrames(response);\r\n\t\tif(self.config.load_schema()){\r\n\t\t\tself.loadDocumentSchema(self.document.cls);\r\n\t\t}\r\n\t\treturn response;\r\n\t});\r\n}\r\n\r\nTerminusFrame.prototype.loadDocumentSchema = function(cls){\r\n\tvar self = this;\r\n\tvar ncls = TerminusClient.FrameHelper.unshorten(cls);\r\n\treturn this.client.getClassFrame(false, ncls)\r\n\t.then(function(response){\r\n\t\treturn self.loadSchemaFrames(response, cls);\r\n\t});\r\n}\r\n\r\nTerminusFrame.prototype.loadDataFrames = function(dataframes, cls){\r\n\tif(!cls){\r\n\t\tif(this.document) cls = this.document.cls;\r\n\t\telse {\r\n\t\t\tif(dataframes && dataframes.length && dataframes[0] && dataframes[0].domain){\r\n\t\t\t\tcls = dataframes[0].domain;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tif(cls){\r\n\t\tif(!this.document){\r\n\t\t\tthis.document = new TerminusClient.ObjectFrame(cls, dataframes);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.document.loadDataFrames(dataframes);\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tconsole.log(\"Missing Class\" + \" \" + \"Failed to add dataframes due to missing class\");\r\n\t}\r\n}\r\n\r\nTerminusFrame.prototype.loadSchemaFrames = function(classframes, cls){\r\n\tif(!cls){\r\n\t\tif(classframes && classframes.length && classframes[0] && classframes[0].domain){\r\n\t\t\tcls = classframes[0].domain;\r\n\t\t}\r\n\t}\r\n\tif(cls){\r\n\t\tif(!this.document){\r\n\t\t\tthis.document = new TerminusClient.ObjectFrame(cls);\r\n\t\t}\r\n\t\tif(classframes){\r\n\t\t\tthis.document.loadClassFrames(classframes);\r\n\t\t\tif(!this.document.subjid){\r\n\t\t\t\tthis.document.newDoc = true;\r\n\t\t\t\tthis.document.fillFromSchema(\"_:\");\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tconsole.log(\"Missing Class\", \"Failed to add class frames due to missing class\");\r\n\t}\r\n}\r\n\r\nTerminusFrame.prototype.render = function(){\r\n\tif(!this.renderer && this.document){\r\n\t\tif(this.config.renderer()){\r\n\t\t\tthis.renderer = this.config.renderer();\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.applyRulesToDocument(this.document, this.config);\r\n\t\t\tthis.renderer = this.document;\r\n\t\t}\r\n\t}\r\n\tif(this.renderer && this.renderer.render){\r\n\t\t//this.renderer.world();\r\n\t\treturn this.renderer.render(this.document);\r\n\t}\r\n\telse if(typeof this.renderer == \"function\"){\r\n\t\tvar x = this.renderer(this.document);\r\n\t\treturn x;\r\n\t}\r\n\telse {\r\n\t\tconsole.log(\"didna make it \");\r\n\t}\r\n}\r\n\r\n/*\r\n * adds render and compare functions to object frames\r\n */\r\nTerminusFrame.prototype.applyRulesToDocument = function(doc, config){\r\n\tvar self = this;\r\n\tfunction onmatch(frame, rule){\r\n\t\tif(typeof rule.render() != \"undefined\"){\r\n\t\t\tframe.render = rule.render();\r\n\t\t}\r\n\t\telse {\r\n\t\t\tif(rule.renderer()){\r\n\t\t\t\tvar renderer = self.loadRenderer(rule.renderer(), frame, rule.args);\t\t\r\n\t\t\t}\r\n\t\t\tif(renderer && renderer.render){\r\n\t\t\t\tframe.render = function(frame){\r\n\t\t\t\t\treturn renderer.render(frame);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(rule.compare()){\r\n\t\t\tframe.compare = rule.compare();\r\n\t\t}\r\n\t\tconfig.setFrameDisplayOptions(frame, rule);\r\n\t}\r\n\tthis.document.filter(config.rules, onmatch);\r\n}\r\n\r\nTerminusFrame.prototype.loadRenderer = function(rendname, frame, args){\r\n\tif(this.owner){\r\n\t\treturn this.owner.loadRenderer(rendname, frame, args, this);\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nmodule.exports = TerminusFrame ;\r\n","\nmodule.exports = Object.freeze({\n\tCONNECT: 'connect',\n\tGET_SCHEMA: 'get_schema',\n\tUPDATE_SCHEMA: 'update_schema',\n\tUPDATE_DOCUMENT: 'update_document',\n\tCLASS_FRAME: 'class_frame',\n\tWOQL_SELECT: 'woql_select',\n\tGET_DOCUMENT: 'get_document',\n\tDELETE_DATABASE: 'delete_database',\n\tDELETE_DOCUMENT: 'delete_document',\n\tCREATE_DATABASE: 'create_database',\n\tCREATE_DOCUMENT: 'create_document',\n\tWOQL_UPDATE: 'woql_update'\n});\n\n/*\n{\"extends\": \"strongloop\",\n  \"env\": {\n\t\t\"browser\": true,\n\t\t\"node\": true,\n\t\t\"es6\": true\n  },\n  \"rules\":{\"max-len\": [\"error\", { \"code\": 100 }]},\n \"parserOptions\": { \"ecmaVersion\": 6 }}\n*/\n","function authorityActionsToArr(action) {\n\tif (Array.isArray(action) === false) return [];\n\n\treturn action.map(item => item['@id']);\n}\n\nfunction URIEncodePayload(payload) {\n\tif (typeof payload === 'string') return encodeURIComponent(payload);\n\tconst payloadArr = [];\n\tfor (const key of Object.keys(payload)) {\n\t\tif (typeof payload[key] === 'object') {\n\t\t\tfor (const keyElement of Object.keys(payload[key])) {\n\t\t\t\t const valueElement = payload[key][keyElement];\n\t\t\t\t payloadArr.push(`${encodeURIComponent(keyElement)}=${encodeURIComponent(valueElement)}`);\n\t\t\t}\n\t\t} else {\n\t\t\tpayloadArr.push(`${encodeURIComponent(key)}=${encodeURIComponent(payload[key])}`);\n\t\t}\n\t}\n\treturn payloadArr.join('&');\n}\n\nmodule.exports = { authorityActionsToArr, URIEncodePayload };\n","/**\r\n * Object for producing a HTML view of a given object in a frame\r\n */\r\nconst HTMLFrameHelper = require('../HTMLFrameHelper');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction HTMLObjectViewer(renderer){\r\n\tthis.properties = [];\r\n}\r\n\r\n/**\r\n * Functions for rendering / re-rendering the object as header and body components\r\n */\r\nHTMLObjectViewer.prototype.render = function(renderer){\r\n\tthis.renderer = renderer;\r\n\tthis.headerViewer = new HTMLObjectHeaderViewer();\r\n\tif(this.renderedDOM){\r\n\t\t//var renderedDOM = this.getObjectDOM();\r\n\t\t//this.renderedDOM.replaceWith(renderedDOM);\r\n\t\t//this.renderedDOM = renderedDOM;\r\n\t}\r\n\telse {\r\n\t\t//this.renderedDOM = this.getObjectDOM();\r\n\t}\r\n\t//this.renderedDOM.appendChild(this.getObjectIDMarker(this.renderer));\r\n\tif(this.headerViewer){\r\n\t\tthis.header = this.headerViewer.getAsDOM(this.renderer);\r\n\t\tif(this.header) this.renderedDOM.appendChild(this.header);\r\n\t}\r\n\tthis.body = this.getObjectBodyDOM();\r\n\tif(this.body) this.renderedDOM.appendChild(this.body);\r\n\treturn this.renderedDOM;\r\n}\r\n\r\nHTMLObjectViewer.prototype.getObjectDOM = function(){\r\n\tvar orientation = this.renderer.getContentOrientation();\r\n\tvar pcls = \"terminus-object-frame-\" + orientation;\r\n\tif(orientation == \"page\"){\r\n\t\tvar sp = document.createElement(\"div\");\r\n\t}\r\n\telse {\r\n\t\tvar sp = document.createElement(\"span\");\r\n\t}\r\n\tvar css = \"terminus-object-frame \" + pcls + (this.renderer.parent ? \"\" : \" terminus-root-frame\") + \" terminus-object-frame-\" + this.renderer.mode;\r\n\tsp.setAttribute(\"class\", css);\r\n\tsp.setAttribute(\"data-class\", this.renderer.subjectClass());\r\n\tsp.setAttribute(\"data-id\", this.renderer.subject());\r\n\treturn sp;\r\n}\r\n\r\nHTMLObjectViewer.prototype.getObjectBodyDOM = function(){\r\n\tvar orientation = \"page\";//this.renderer.getContentOrientation();\r\n\tvar pcls = \"terminus-object-properties-\" + orientation;\r\n\tif(orientation == \"page\"){\r\n\t\tvar vholder = document.createElement(\"div\");\r\n\t}\r\n\telse {\r\n\t\tvar vholder = document.createElement(\"span\");\r\n\t}\r\n    vholder.setAttribute('class', 'terminus-object-properties ' + pcls);\r\n    for(var prop in this.properties){\r\n\t\tif(this.properties[prop]) vholder.appendChild(this.properties[prop]);\r\n\t}\r\n\treturn vholder;\r\n}\r\n\r\nHTMLObjectViewer.prototype.getFeatureDOM = function(feature){\r\n\tif(this.hasFeatureViewer(feature)){\r\n\t\treturn this.featureViewer[feature](this.renderer, this);\r\n\t}\r\n}\r\n\r\nHTMLObjectViewer.prototype.redraw = function(){\r\n\tTerminusClient.FrameHelper.removeChildren(this.renderedDOM);\r\n\tthis.properties = [];\r\n\tthis.renderer.render(this);\r\n}\r\n\r\nHTMLObjectViewer.prototype.redrawHeader = function(){\r\n\tif(this.headerViewer && this.header) {\r\n\t\tvar nheader = this.headerViewer.getAsDOM(this.renderer);\r\n\t\tthis.header.replaceWith(nheader);\r\n\t\tthis.header = nheader;\r\n\t}\r\n}\r\n\r\nHTMLObjectViewer.prototype.redrawBody = function(){\r\n\tif(this.body){\r\n\t\tvar nbody = this.getObjectBodyDOM();\r\n\t\tthis.body.replaceWith(nbody);\r\n\t\tthis.body = nbody;\r\n\t}\r\n}\r\n\r\n/**\r\n * Adds a rendered version of a property to the internal properties array\r\n */\r\nHTMLObjectViewer.prototype.addRenderedProperty = function(prop, renderedprop){\r\n\tthis.properties[prop] = renderedprop;\r\n}\r\n\r\nHTMLObjectViewer.prototype.clear = function(){\r\n\tTerminusClient.FrameHelper.removeChildren(this.renderedDOM);\r\n\tthis.properties = {};\r\n}\r\n\r\n/**\r\n * Removes the object from the dom\r\n */\r\nHTMLObjectViewer.prototype.remove = function(){\r\n\tthis.renderedDOM.parentNode.removeChild(this.renderedDOM);\r\n}\r\n\r\nHTMLObjectViewer.prototype.goTo = function(subj, property){\r\n\tHTMLFrameHelper.goToName(subj, property);\r\n}\r\n\r\n/**\r\n * Generates a html anchor element to use as a marker to find the object on the page\r\n */\r\nHTMLObjectViewer.prototype.getObjectIDMarker = function(renderer){\r\n\tvar idm = document.createElement(\"a\");\r\n\tidm.setAttribute(\"class\", \"terminus-object-idmarker\");\r\n\tvar sh = TerminusClient.FrameHelper.getShorthand(renderer.subject());\r\n    if(!sh) sh = renderer.subject();\r\n    if(sh){\r\n\t\tvar bits = sh.split(\":\");\r\n\t\tif(bits.length > 1) sh = bits[1];\r\n\t\tidm.setAttribute(\"name\", sh);\r\n    }\r\n\treturn idm;\r\n}\r\n\r\nfunction HTMLObjectHeaderViewer(){}\r\n\r\nHTMLObjectHeaderViewer.prototype.getAsDOM = function(renderer){\r\n\tvar orientation = renderer.getContentOrientation();\r\n\tvar pcls = \"terminus-object-frame-btn terminus-object-header-\" + orientation;\r\n\tif(orientation == \"page\"){\r\n\t\tvar objDOM = document.createElement(\"div\");\r\n\t}\r\n\telse {\r\n\t\tvar objDOM = document.createElement(\"span\");\r\n\t}\r\n\tobjDOM.setAttribute(\"class\", \"terminus-object-header \" + pcls);\r\n\tif(renderer.showFeature(\"facet\")){\r\n\t\tvar facetDOM = this.getObjectFacetDOM(renderer);\r\n\t\tif(facetDOM) objDOM.appendChild(facetDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"label\")){\r\n\t\tvar sumDOM = this.getObjectLabelDOM(renderer);\r\n\t\tif(sumDOM) objDOM.appendChild(sumDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"id\")){\r\n\t\tvar idDOM = this.getObjectIDDOM(renderer);\r\n\t\tif(idDOM) objDOM.appendChild(idDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"type\")){\r\n\t\tvar typeDOM = this.getObjectTypeDOM(renderer);\r\n\t\tif(typeDOM) objDOM.appendChild(typeDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"status\")){\r\n\t\tvar sumDOM = this.getObjectStatusDOM(renderer);\r\n\t\tif(sumDOM) objDOM.appendChild(sumDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"view\")){\r\n\t\tvar viewDOM = this.getViewPropertyDOM(renderer);\r\n\t\tif(viewDOM) objDOM.appendChild(viewDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"viewer\")){\r\n\t\tvar hideDOM = this.getViewerSelectorDOM(renderer);\r\n\t\tif(hideDOM) objDOM.appendChild(hideDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"control\")){\r\n\t\tvar controlsDOM = this.getObjectControlsDOM(renderer);\r\n\t\tif(controlsDOM) objDOM.appendChild(controlsDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"summary\")){\r\n\t\tvar controlsDOM = this.getObjectSummaryDOM(renderer);\r\n\t\tif(controlsDOM) objDOM.appendChild(controlsDOM);\r\n\t}\r\n\treturn objDOM;\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectSummaryDOM = function(renderer){\r\n\tvar sum = renderer.getSummary();\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"object-summary\", false, sum.long, sum.status);\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectControlsDOM = function(renderer){\r\n\tvar controlsDOM = document.createElement(\"span\");\r\n\tcontrolsDOM.setAttribute(\"class\", \"terminus-object-controls\");\r\n\tif(renderer.showFeature(\"add\")){\r\n\t\tvar addDOM = this.getAddPropertyDOM(renderer);\r\n\t\tif(addDOM) controlsDOM.appendChild(addDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"mode\")){\r\n\t\tvar viewsDOM = HTMLFrameHelper.getModeSelectorDOM(\"object\", renderer);\r\n\t\tif(viewsDOM) controlsDOM.appendChild(viewsDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"delete\")){\r\n\t\tvar dpropDOM = this.getObjectDeleteDOM(renderer);\r\n\t\tif(dpropDOM) controlsDOM.appendChild(dpropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"clone\")){\r\n\t\tvar cpropDOM = this.getObjectCloneDOM(renderer);\r\n\t\tif(cpropDOM) controlsDOM.appendChild(cpropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"reset\")){\r\n\t\tvar rpropDOM = this.getObjectResetDOM(renderer);\r\n\t\tif(rpropDOM) controlsDOM.appendChild(rpropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"update\")){\r\n\t\tvar upropDOM = this.getObjectUpdateDOM(renderer);\r\n\t\tif(upropDOM) controlsDOM.appendChild(upropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"show\")){\r\n\t\tvar showDOM = this.getObjectShowDOM(renderer);\r\n\t\tif(showDOM) controlsDOM.appendChild(showDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"hide\")){\r\n\t\tvar hideDOM = this.getObjectHideDOM(renderer);\r\n\t\tif(hideDOM) controlsDOM.appendChild(hideDOM);\r\n\t}\r\n\treturn controlsDOM;\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectFacetDOM = function(renderer){\r\n\tvar viewables = renderer.getAvailableFacets();\r\n\tvar self = this;\r\n\tif(viewables && viewables.length){\r\n\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-object-facet\");\r\n\t\tvar callback = function(val){\r\n\t\t\tif(val){\r\n\t\t\t\trenderer.setFacet(val);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"object-facet\", viewables, renderer.currentFacet(), callback);\r\n\t\tmpropDOM.appendChild(sel);\r\n\t\treturn mpropDOM;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectLabelDOM = function(renderer){\r\n\tvar lab = renderer.getLabel();\r\n\tif(lab){\r\n\t\treturn HTMLFrameHelper.getInfoboxDOM(\"object-label\", false, lab);\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectIDDOM = function(renderer){\r\n\tvar val = renderer.subject();\r\n\tvar input = false;\r\n\tif(renderer.mode == \"edit\" && renderer.isNewDocument()){\r\n\t\tif(renderer.idDOM) val = renderer.idDOM.value;\r\n\t\tinput = document.createElement(\"input\");\r\n\t\tinput.setAttribute(\"class\", \"terminus-object-id-input\");\r\n\t\tinput.required  = true;\r\n\t\tif(val == \"_:\") val = \"\";\r\n\t\trenderer.idDOM = input;\r\n\t}\r\n\telse {\r\n\t\tif(renderer.isNewDocument() && val == \"_:\") val = \"New Document\";\r\n\t}\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"object-id\", \"ID\", val, \"Every fragment of data is identified by a unique URL\", input);\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectTypeDOM = function(renderer){\r\n\tif(renderer.mode == \"edit\" && renderer.parent && renderer.parent.isClassChoice() && renderer.isNew()){\r\n\t\tvar cs = renderer.parent.getAvailableClassChoices();\r\n\t\tif(cs && cs.length){\r\n\t\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\t\tmpropDOM.setAttribute(\"class\", \"terminus-property-change-class\");\r\n\t\t\tvar mlabDOM = document.createElement(\"span\");\r\n\t\t\tmlabDOM.setAttribute(\"class\", \"terminus-property-change-label\");\r\n\t\t\tmlabDOM.appendChild(document.createTextNode(\"Type\"));\r\n\t\t\tmpropDOM.appendChild(mlabDOM);\r\n\t\t\tvar callback = function(cls){\r\n\t\t\t\tif(cls){\r\n\t\t\t\t\trenderer.changeClass(cls);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"change-class\", cs, renderer.subjectClass(), callback);\r\n\t\t\tmpropDOM.appendChild(sel);\r\n\t\t\treturn mpropDOM;\r\n\t\t}\r\n\t}\r\n\tvar cm = renderer.getClassMeta(renderer.subjectClass());\r\n\tvar lab = renderer.subjectClass();\r\n\tvar cmt = \"All objects have types, identified by a unique URL\";\r\n\tif(cm){\r\n\t\tlab = HTMLFrameHelper.getVariableValueFromBinding(\"Label\", cm);\r\n\t\tcmt = HTMLFrameHelper.getVariableValueFromBinding(\"Comment\", cm);\r\n\t\tcmt = (cmt ? renderer.subjectClass() + \" \" + cmt : renderer.subjectClass());\r\n\t}\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"object-type\", \"Type\", lab, cmt);\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectStatusDOM = function(renderer){\r\n\tvar sum = renderer.getSummary();\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"status-\"+sum.status, false, sum.status, sum.status);\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getAddPropertyDOM = function(renderer){\r\n\tvar addables = renderer.getAddableProperties();\r\n\tif(addables && addables.length){\r\n\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-object-add-property\");\r\n\t\taddables.unshift({ value: \"\", label: \"Add New Property\"});\r\n\t\tvar callback = function(add){\r\n\t\t\tif(add){\r\n\t\t\t\trenderer.addNewProperty(add);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar disabled = (renderer.cardControlAllows(\"add\") ? false : \"Cardinality Rules Forbid Add\");\r\n\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"add-property\", addables, \"\", callback, disabled);\r\n\t\tmpropDOM.appendChild(sel);\r\n\t\treturn mpropDOM;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getViewPropertyDOM = function(renderer){\r\n\tvar viewables = renderer.getViewableProperties();\r\n\tvar self = this;\r\n\tif(viewables && viewables.length){\r\n\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-object-view-property\");\r\n\t\tviewables.unshift({ value: \"\", label: \"View Property\"});\r\n\t\tvar callback = function(add){\r\n\t\t\tif(add){\r\n\t\t\t\trenderer.goToProperty(add);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"view-property\", viewables, \"\", callback);\r\n\t\tmpropDOM.appendChild(sel);\r\n\t\treturn mpropDOM;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectDeleteDOM = function(renderer){\r\n\tvar callback = function(){renderer.delete()};\r\n\tvar disabled = (renderer.cardControlAllows(\"delete\") ? false : \"Cardinality Rules Forbid Delete\");\r\n\treturn HTMLFrameHelper.getActionControl(\"object\", \"delete\", \"Delete\", callback, disabled);\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectCloneDOM = function(renderer){\r\n\tvar callback = function(){renderer.clone()};\r\n\tvar disabled = (renderer.cardControlAllows(\"clone\") ? false : \"Cardinality Rules Forbid Clone\");\r\n\treturn HTMLFrameHelper.getActionControl(\"object\", \"clone\", \"Clone\", callback, disabled);\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectResetDOM = function(renderer){\r\n\tvar callback = function(){renderer.reset()};\r\n\tvar disabled = (renderer.isUpdated() ? false : \"Nothing to reset\");\r\n\treturn HTMLFrameHelper.getActionControl(\"object\", \"reset\", \"Reset\", callback, disabled);\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getViewerSelectorDOM = function(renderer){\r\n\tvar viewers = renderer.getAvailableViewers();\r\n\tif(viewers && viewers.length){\r\n\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-object-viewer\");\r\n\t\tvar callback = function(viewer){\r\n\t\t\tif(viewer){\r\n\t\t\t\trenderer.setViewer(viewer);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar selected = renderer.currentViewer();\r\n\t\tvar sel = HTMLFrameHelper.getSelectionControl('object-viewer', viewers, selected, callback);\r\n\t\tmpropDOM.appendChild(sel);\r\n\t\treturn mpropDOM;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectHideDOM = function(renderer){\r\n\tvar callback = function(){renderer.hide()};\r\n\treturn HTMLFrameHelper.getActionControl(\"object\", \"hide\", \"Hide\", callback);\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectShowDOM = function(renderer){\r\n\tvar callback = function(){renderer.show()};\r\n\treturn HTMLFrameHelper.getActionControl(\"object\", \"show\", \"Show\", callback);\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectUpdateDOM = function(renderer){\r\n\tvar dpropDOM = document.createElement(\"span\");\r\n\tdpropDOM.setAttribute(\"class\", \"terminus-object-update\");\r\n\tif(renderer.isNewDocument()){\r\n\t\tvar disabled = false;//(renderer.isUpdated() ? false : \"No changes\");\r\n\t}\r\n\telse {\r\n\t\tvar disabled = (renderer.isUpdated() ? false : \"No changes\");\r\n\t}\r\n\tvar saveback = function(){renderer.save()};\r\n\tdpropDOM.appendChild(HTMLFrameHelper.getActionControl(\"object\", \"save\", \"Save\", saveback, disabled));\r\n\treturn dpropDOM;\r\n}\r\n\r\nmodule.exports=HTMLObjectViewer;\r\n","const HTMLFrameHelper = require('../HTMLFrameHelper');\r\n\r\nfunction HTMLStringViewer(options){\r\n\tthis.size = ((options && options.size) ? options.size : false);\r\n\tthis.css = ((options && options.css) ? \"terminus-literal-value \" + options.css : \"terminus-literal-value\");\r\n\tthis.max_word_size = (options && options.max_word_size ? options.max_word_size : false);\r\n\tthis.max_cell_size = (options && options.max_cell_size ? options.max_cell_size : false);\r\n}\r\n\r\nHTMLStringViewer.prototype.renderFrame = function(frame, dataviewer){\r\n\tvar value = frame.get();\r\n\treturn this.render(value);\r\n}\r\n\r\nHTMLStringViewer.prototype.renderValue = function(dataviewer){\r\n\treturn this.render(dataviewer.value());\r\n}\r\n\r\nHTMLStringViewer.prototype.render = function(value){\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', this.css);\r\n\tinput.setAttribute('data-value', value);\r\n\tif(this.max_word_size || this.max_cell_size){\r\n\t\tHTMLFrameHelper.wrapShortenedText(input, value, this.max_cell_size, this.max_word_size);\r\n\t}\r\n\telse {\r\n\t\tvalue = document.createTextNode(value);\r\n\t\tinput.appendChild(value);\r\n\t}\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={HTMLStringViewer}\r\n\r\n\r\n","const HTMLFrameHelper = require('../HTMLFrameHelper');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\n/**\r\n * Property Viewer\r\n */\r\nfunction HTMLPropertyViewer(renderer){\r\n\tthis.values = [];\r\n}\r\n\r\n\r\n/**\r\n * Draws the property as header and body components\r\n */\r\nHTMLPropertyViewer.prototype.render = function(renderer){\r\n\tthis.renderer = renderer;\r\n\tthis.headerViewer = new HTMLPropertyHeaderViewer();\r\n\t//var block = document.createElement('div');\r\n\t//block.setAttribute('style', 'display: flex; margin: 10px');\r\n\t//var br = document.createElement('br');\r\n\t//block.appendChild(br);\r\n\tif(this.propDOM){\r\n\t\tvar npropDOM = this.getPropertyDOM();\r\n\t\t//npropDOM.setAttribute('style', 'display: flex; margin: 10px;');\r\n\t\t\t//block.appendChild(npropDOM);\r\n\t\tthis.propDOM.replaceWith(npropDOM);\r\n\t\tthis.propDOM = npropDOM;\r\n\t\t//this.propDOM = block;\r\n\t}\r\n\telse {\r\n\t\t//block.appendChild(this.getPropertyDOM());\r\n\t\t//this.propDOM = block;\r\n\t\tthis.propDOM = this.getPropertyDOM();\r\n\t\t//this.propDOM.setAttribute('style', 'display: flex; margin: 10px;');\r\n\t}\r\n\tthis.propDOM.appendChild(this.getPropertyIDMarker(this.renderer));\r\n\tif(this.headerViewer){\r\n\t\tthis.header = this.headerViewer.getAsDOM(this.renderer);\r\n\t\tif(this.header) this.propDOM.appendChild(this.header);\r\n\t}\r\n\tthis.body = this.getPropertyBodyDOM();\r\n\tif(this.body) this.propDOM.appendChild(this.body);\r\n\treturn this.propDOM;\r\n}\r\n\r\nHTMLPropertyViewer.prototype.getPropertyDOM = function(){\r\n\tvar orientation = this.renderer.getContentOrientation();\r\n\tvar pcls = \" terminus-property-frame-display terminus-property-frame-\" + orientation;\r\n\tif(orientation == \"label\"){\r\n\t\tvar sp = document.createElement(\"span\");\r\n\t}\r\n\telse {\r\n\t\tvar sp = document.createElement(\"div\");\r\n\t}\r\n\t//terminus-property-frame-spacer\r\n\r\n\tsp.setAttribute(\"class\", \"terminus-property-frame terminus-zebra-frame terminus-property-frame-\" + this.renderer.mode + \" \" + pcls);\r\n\tsp.setAttribute('data-property', this.renderer.property());\r\n\treturn sp;\r\n}\r\n\r\nHTMLPropertyViewer.prototype.getPropertyBodyDOM = function(){\r\n\tvar orientation = this.renderer.getContentOrientation();\r\n\tvar pcls = \"terminus-property-values-\" + orientation;\r\n\tif(orientation == \"page\"){\r\n\t\tvar vholder = document.createElement(\"div\");\r\n\t}\r\n\telse {\r\n\t\tvar vholder = document.createElement(\"span\");\r\n\t}\r\n    vholder.setAttribute('class', 'terminus-property-values ' + pcls + ' terminus-property-values-align');\r\n\tfor(var i =0; i<this.values.length; i++){\r\n\t\tvholder.appendChild(this.values[i]);\r\n\t}\r\n\treturn vholder;\r\n}\r\n\r\nHTMLPropertyViewer.prototype.addRenderedValue = function(renderedval){\r\n\tthis.values.push(renderedval);\r\n}\r\n\r\nHTMLPropertyViewer.prototype.clear = function(){\r\n\tTerminusClient.FrameHelper.removeChildren(this.propDOM);\r\n\tthis.values = [];\r\n}\r\n\r\n\r\n/**\r\n * Removes the property from the dom\r\n */\r\nHTMLPropertyViewer.prototype.remove = function(){\r\n\tthis.propDOM.parentNode.removeChild(this.propDOM);\r\n}\r\n\r\n/**\r\n * Redraws the property to reflect an updated state\r\n */\r\nHTMLPropertyViewer.prototype.redraw = function(){\r\n\tvar npropDOM = this.getPropertyDOM();\r\n\tthis.propDOM.replaceWith(npropDOM);\r\n\tthis.propDOM = npropDOM;\r\n\tthis.values = [];\r\n\tthis.renderer.render(this);\r\n}\r\n\r\nHTMLPropertyViewer.prototype.redrawHeader = function(){\r\n\tif(this.headerViewer && this.header) {\r\n\t\tvar nheader = this.headerViewer.getAsDOM(this.renderer);\r\n\t\tthis.header.replaceWith(nheader);\r\n\t\tthis.header = nheader;\r\n\t}\r\n}\r\n\r\nHTMLPropertyViewer.prototype.redrawBody = function(){\r\n\tif(this.body){\r\n\t\tvar nbody = this.getPropertyBodyDOM();\r\n\t\tthis.body.replaceWith(nbody);\r\n\t\tthis.body = nbody;\r\n\t}\r\n}\r\n\r\n/**\r\n * Generates a html anchor element to use as a marker to find the property on the page\r\n */\r\nHTMLPropertyViewer.prototype.getPropertyIDMarker = function(renderer){\r\n\tvar idm = document.createElement(\"a\");\r\n\tidm.setAttribute(\"class\", \"terminus-property-idmarker\");\r\n\tvar subj = TerminusClient.FrameHelper.getShorthand(renderer.subject());\r\n\tif(!subj ) subj = renderer.subject();\r\n\tvar bits = subj .split(\":\");\r\n\tif(bits.length > 1) subj = bits[1];\r\n\tvar prop = TerminusClient.FrameHelper.getShorthand(renderer.property());\r\n\tif(!prop ) prop = renderer.property();\r\n\tvar bits = prop.split(\":\");\r\n\tif(bits.length > 1) prop = bits[1];\r\n\tidm.setAttribute(\"name\", subj + \"_\" + prop);\r\n\treturn idm;\r\n}\r\n\r\nHTMLPropertyViewer.prototype.goTo = function(subj, property, index){\r\n\tHTMLFrameHelper.goToName(subj, property, index);\r\n}\r\n\r\nfunction HTMLPropertyHeaderViewer(){}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getAsDOM = function(renderer){\r\n\tvar orientation = renderer.getContentOrientation();\r\n\tvar pcls = \"terminus-property-header-\" + orientation;\r\n\tif(orientation == \"page\"){\r\n\t\tvar objDOM = document.createElement(\"div\");\r\n\t}\r\n\telse {\r\n\t\tvar objDOM = document.createElement(\"span\");\r\n\t}\r\n\tobjDOM.setAttribute(\"class\", \"terminus-text terminus-property-header \" + pcls);\r\n\tvar wrapper = document.createElement(\"span\");\r\n\twrapper.setAttribute(\"class\", \"terminus-property-header-wrapper\");\r\n\tif(renderer.showFeature(\"control\")){\r\n\t\tvar expModeMenu = this.getPropertyControlsDOM(wrapper, renderer);\r\n\t\tif(orientation == 'page') this.expModeMenu = expModeMenu;\r\n\t\telse this.expModeMenu = null;\r\n\t}\r\n\tif(renderer.showFeature(\"label\")){\r\n\t\tvar sumDOM = this.getPropertyLabelDOM(renderer);\r\n\t\tif(renderer.showFeature(\"status\")){\r\n\t\t\tvar statDOM = this.getPropertyStatusDOM(renderer);\r\n\t\t\tif(statDOM) sumDOM.prepend(statDOM);\r\n\t\t}\r\n\t\tif(sumDOM) wrapper.appendChild(sumDOM);\r\n\t}\r\n\telse if(renderer.showFeature(\"status\")){\r\n\t\tvar statDOM = this.getPropertyStatusDOM(renderer);\r\n\t\tif(statDOM) wrapper.appendChild(statDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"summary\")){\r\n\t\tvar sumDOM = this.getPropertySummaryDOM(renderer);\r\n\t\tif(sumDOM) wrapper.appendChild(sumDOM);\r\n\t}\r\n\r\n\tvar prelude = document.createElement(\"span\");\r\n\tprelude.setAttribute(\"class\", \"terminus-property-header-info terminus-property-header-info-\"+renderer.currentFacet());\r\n\r\n\tif(renderer.showFeature(\"facet\")){\r\n\t\tvar facetDOM = this.getPropertyFacetDOM(renderer);\r\n\t\tif(facetDOM) prelude.appendChild(facetDOM);\r\n\t\t//if(facetDOM && this.expModeMenu) this.expModeMenu.appendChild(facetDOM);//\r\n\t}\r\n\tif(renderer.showFeature(\"view\")){\r\n\t\tvar viewDOM = this.getViewValueDOM(renderer);\r\n\t\tif(viewDOM) prelude.appendChild(viewDOM);\r\n\t\t//if(viewDOM && this.expModeMenu) this.expModeMenu.appendChild(viewDOM); //prelude.appendChild(viewDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"id\")){\r\n\t\tvar idDOM = this.getPropertyIDDOM(renderer);\r\n\t\tif(idDOM) prelude.appendChild(idDOM);\r\n\t\t//if(idDOM && this.expModeMenu) this.expModeMenu.appendChild(idDOM); //\r\n\t}\r\n\tif(renderer.showFeature(\"type\")){\r\n\t\tvar typeDOM = this.getPropertyRangeDOM(renderer);\r\n\t\tif(typeDOM)\tprelude.appendChild(typeDOM);\r\n\t\t/*if(typeDOM && this.expModeMenu){\r\n\t\t\tthis.expModeMenu.appendChild(typeDOM);//\r\n\t\t\ttypeDOM.style.display = 'block';\r\n\t\t}*/\r\n\t}\r\n\tif(renderer.showFeature(\"cardinality\") && renderer.hasCardinalityRestriction()){\r\n\t\tvar hideDOM = this.getPropertyCardinalityDOM(renderer);\r\n\t\tif(hideDOM) prelude.appendChild(hideDOM);\r\n\t\t//\tthis.expModeMenu.appendChild(hideDOM); \t\t\thideDOM.style.display = 'block';\r\n\r\n\t}\r\n\tif(renderer.showFeature(\"comment\")){\r\n\t\tvar sumDOM = this.getPropertyCommentDOM(renderer);\r\n\t\tif(sumDOM) prelude.appendChild(sumDOM);\r\n\t\t/*if(sumDOM && this.expModeMenu){\r\n\t\t\tthis.expModeMenu.appendChild(sumDOM); //\r\n\t\t\tsumDOM.style.display = 'block';\r\n\t\t}*/\r\n\t}\r\n\twrapper.appendChild(prelude);\r\n\tobjDOM.appendChild(wrapper);\r\n\treturn objDOM;\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyFacetDOM = function(renderer){\r\n\tvar viewables = renderer.getAvailableFacets();\r\n\tvar self = this;\r\n\tif(viewables && viewables.length){\r\n\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-property-facet\");\r\n\t\tvar callback = function(val){\r\n\t\t\tif(val){\r\n\t\t\t\trenderer.setFacet(val);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"property-facet\", viewables, renderer.currentFacet(), callback);\r\n\t\tmpropDOM.appendChild(sel);\r\n\t\treturn mpropDOM;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyIDDOM = function(renderer){\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"property-id\", \"Property\", renderer.property(), \"This property is identified by this unique URL: \" + renderer.property());\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyRangeDOM = function(renderer){\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"property-type\", \"Type\", renderer.range(), \"The type of arguments that this property accepts\");\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertySummaryDOM = function(renderer){\r\n\tvar sum = renderer.getSummary();\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"property-summary\", false, sum.long, sum.status);\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyStatusDOM = function(renderer){\r\n\tvar sum = renderer.getSummary();\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"status-\"+sum.status, false, sum.status, sum.status);\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyLabelDOM = function(renderer){\r\n\tvar lab = renderer.getLabel();\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"property-label\", false, lab);\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyCommentDOM = function(renderer){\r\n\tvar lab = renderer.getComment();\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"property-comment\", false, lab);\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyCardinalityDOM = function(renderer){\r\n\tvar restriction = renderer.getRestriction();\r\n\tif(restriction.min && restriction.max){\r\n\t\tif(restriction.min == restriction.max){\r\n\t\t\tvar lab = restriction.min;\r\n\t\t\tvar help = \"Cardinality: \" + restriction.min;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tvar lab = restriction.min + \"-\" + restriction.max;\r\n\t\t\tvar help = \"Minimum Cardinality: \" + restriction.min;\r\n\t\t\thelp += \", Maximum Cardinality: \" + restriction.max;\r\n\t\t}\r\n\t}\r\n\telse if(restriction.min){\r\n\t\tvar lab = \">\"+(restriction.min-1);\r\n\t\tvar help = \"Minimum Cardinality: \" + restriction.min;\r\n\t}\r\n\telse if(restriction.max){\r\n\t\tvar lab = \"<\"+(restriction.max+1);\r\n\t\tvar help = \"Maximum Cardinality: \" + restriction.max;\r\n\t}\r\n\telse {\r\n\t\treturn false;\r\n\t}\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"property-cardinality\", \"Cardinality\", lab, help);\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getActionControlDOM = function(settingsDOM, renderer){\r\n\tif(renderer.showFeature(\"mode\")){\r\n\t\tvar viewsDOM = HTMLFrameHelper.getModeSelectorDOM(\"property\", renderer);\r\n\t\tif (viewsDOM) settingsDOM.appendChild(viewsDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"delete\")){\r\n\t\tvar dpropDOM = this.getPropertyDeleteDOM(renderer);\r\n\t\tif (dpropDOM) settingsDOM.appendChild(dpropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"add\") && !renderer.isClassChoice()){\r\n\t\tvar addDOM = this.getAddValueDOM(renderer);\r\n\t\tif(addDOM) settingsDOM.appendChild(addDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"reset\")){\r\n\t\tvar rpropDOM = this.getPropertyResetDOM(renderer);\r\n\t\tif(rpropDOM) settingsDOM.appendChild(rpropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"update\")){\r\n\t\tvar upropDOM = this.getPropertyUpdateDOM(renderer);\r\n\t\tif(upropDOM) settingsDOM.appendChild(upropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"show\")){\r\n\t\tvar showDOM = this.getPropertyShowDOM(renderer);\r\n\t\tif(showDOM) settingsDOM.appendChild(showDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"hide\")){\r\n\t\tvar hideDOM = this.getPropertyHideDOM(renderer);\r\n\t\tif(hideDOM) settingsDOM.appendChild(hideDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"viewer\")){\r\n\t\tvar hideDOM = this.getViewerSelectorDOM(renderer);\r\n\t\tif(hideDOM) settingsDOM.appendChild(hideDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"add\") && renderer.isClassChoice()){\r\n\t\tvar addDOM = this.getAddValueDOM(renderer);\r\n\t\tif(addDOM) settingsDOM.appendChild(addDOM);\r\n\t}\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getSettingsControlDOM = function(controlsDOM, renderer){\r\n\tvar settings = document.createElement(\"div\");\r\n\tcontrolsDOM.appendChild(settings);\r\n\tvar orientation = renderer.getContentOrientation();\r\n\tif(false && orientation == 'page'){ // expert mode\r\n\t\tvar sControl = HTMLFrameHelper.getSettingsControl('property');\r\n\t\tvar menu = document.createElement('div');\r\n\t\tmenu.setAttribute('class', 'terminus-hide terminus-popup');\r\n\t\tmenu.appendChild(document.createTextNode('Edit property'));\r\n\t\tmenu.appendChild(document.createElement('BR'));\r\n\t\tsControl.appendChild(menu);\r\n\t\tsControl.addEventListener('click', function(e){\r\n\t\t\tvar target = e.target || e.srcElement,\r\n        \ttext = target.textContent || target.innerText;\r\n\t\t\tif((target.nodeName == 'ICON') || (target.nodeName == 'BUTTON')){\r\n\t\t\t\tif(this.children[0].style.display == 'none') this.children[0].style.display = 'block';\r\n\t\t\t\telse this.children[0].style.display = 'none';\r\n\t\t\t}\r\n\t\t});\r\n\t\tthis.getActionControlDOM(menu, renderer);\r\n\t    settings.appendChild(sControl);\r\n\t\treturn menu;\r\n\t}\r\n\telse this.getActionControlDOM(controlsDOM, renderer);\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyControlsDOM = function(wrapper, renderer){\r\n\tvar controlsDOM = document.createElement(\"span\");\r\n\tcontrolsDOM.setAttribute(\"class\", \"terminus-property-controls\");\r\n\t//controlsDOM.setAttribute(\"style\", \"display: table-cell;\");\r\n\t// get settings icon or button\r\n\tvar expModeMenu = this.getSettingsControlDOM(controlsDOM, renderer);\r\n\twrapper.appendChild(controlsDOM);\r\n\treturn expModeMenu;\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getAddValueDOM = function(renderer){\r\n\tif(renderer.isClassChoice()){\r\n\t\tvar cs = renderer.getAvailableClassChoices();\r\n\t\tif(cs && cs.length){\r\n\t\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\t\tmpropDOM.setAttribute(\"class\", \"terminus-property-add-class\");\r\n\t\t\tcs.unshift({ value: \"\", label: \"Add Type\"});\r\n\t\t\tvar callback = function(cls){\r\n\t\t\t\tif(cls){\r\n\t\t\t\t\trenderer.addClass(cls);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"add-property\", cs, \"\", callback);\r\n\t\t\tmpropDOM.appendChild(sel);\r\n\t\t\treturn mpropDOM;\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tvar callback = function(){renderer.add(\"edit\")};\r\n\t\tvar disabled = (renderer.cardControlAllows(\"add\") ? false : \"Cardinality Rules Forbid Add\");\r\n\t\treturn HTMLFrameHelper.getActionControl(\"property\", \"add\", \"Add\", callback, disabled);\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getViewValueDOM = function(renderer){\r\n\tvar viewables = renderer.getViewableValues();\r\n\tvar self = this;\r\n\tif(viewables && viewables.length){\r\n\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-property-view-value\");\r\n\t\tviewables.unshift({ value: \"\", label: \"View Value\"});\r\n\t\tvar callback = function(val){\r\n\t\t\trenderer.goToValue(val);\r\n\t\t}\r\n\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"view-values\", viewables, \"\", callback);\r\n\t\tmpropDOM.appendChild(sel);\r\n\t\treturn mpropDOM;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyDeleteDOM = function(renderer){\r\n\tvar callback = function(){renderer.delete()};\r\n\tvar disabled = (renderer.cardControlAllows(\"delete\") ? false : \"Cardinality Rules Forbid Delete\");\r\n\treturn HTMLFrameHelper.getActionControl(\"property\", \"delete\", \"Delete\", callback, disabled);\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyHideDOM = function(renderer){\r\n\tvar callback = function(){renderer.hide()};\r\n\treturn HTMLFrameHelper.getActionControl(\"property\", \"hide\", \"Hide\", callback);\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyResetDOM = function(renderer){\r\n\tvar callback = function(){renderer.reset()};\r\n\tvar disabled = (renderer.isUpdated() ? false : \"Nothing to reset\");\r\n\treturn HTMLFrameHelper.getActionControl(\"property\", \"reset\", \"Reset\", callback, disabled);\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyShowDOM = function(renderer){\r\n\tvar callback = function(){renderer.show()};\r\n\treturn HTMLFrameHelper.getActionControl(\"property\", \"show\", \"Show\", callback);\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyUpdateDOM = function(renderer){\r\n\tvar dpropDOM = document.createElement(\"span\");\r\n\tdpropDOM.setAttribute(\"class\", \"terminus-property-update\");\r\n\tvar disabled = (renderer.isUpdated() ? false : \"No Change\");\r\n\tvar saveback = function(){renderer.save()};\r\n\tdpropDOM.appendChild(HTMLFrameHelper.getActionControl(\"property\", \"save\", \"Save\", saveback, disabled));\r\n\treturn dpropDOM;\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getViewerSelectorDOM = function(renderer){\r\n\tvar viewers = renderer.getAvailableViewers();\r\n\tif(viewers && viewers.length){\r\n\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-property-viewer\");\r\n\t\tvar callback = function(viewer){\r\n\t\t\tif(viewer){\r\n\t\t\t\trenderer.setViewer(viewer);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar selected = renderer.currentViewer();\r\n\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"property-viewers\", viewers, selected, callback);\r\n\t\tmpropDOM.appendChild(sel);\r\n\t\treturn mpropDOM;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.showValue = function(renderer, index){\r\n\tvar htmlid = renderer.subject() + \"->\" + renderer.property() + \"_\" + index;\r\n\twindow.location = (\"\"+window.location).replace(/#[A-Za-z0-9_]*$/,'') + \"#\" + htmlid;\r\n}\r\n\r\nfunction HTMLDataViewer(){\r\n}\r\n\r\nmodule.exports=HTMLPropertyViewer;\r\n","/**\r\n * Draws the property as header and body components\r\n */\r\nconst HTMLFrameHelper = require('../HTMLFrameHelper');\r\nconst HTMLStringViewer = require('../datatypes/String');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction HTMLDataViewer(){\r\n}\r\n\r\nHTMLDataViewer.prototype.render = function(renderer){\r\n\tthis.headerViewer = new HTMLDataHeaderViewer();\r\n\tif(this.valDOM){\r\n\t\tvar nvalDOM = this.getValueDOM();\r\n\t\tthis.valDOM.replaceWith(nvalDOM);\r\n\t\tthis.valDOM = nvalDOM;\r\n\t}\r\n\telse {\r\n\t\tthis.valDOM = this.getValueDOM();\r\n\t}\r\n\tthis.valDOM.appendChild(this.getValueIDMarker(this.renderer));\r\n\tthis.body = this.getValueBodyDOM();\r\n\tif(this.body) this.valDOM.appendChild(this.body);\r\n\tif(this.headerViewer){\r\n\t\tthis.header = this.headerViewer.getAsDOM(this.renderer);\r\n\t\tif(this.renderer.facet == 'page'){ //expert mode\r\n\t\t\tif(this.header && this.expModeMenu) {\r\n\t\t\t\tthis.expModeMenu.appendChild(this.header);\r\n\t\t\t\t//this.valDOM.appendChild(this.expModeMenu);\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if(this.header) this.valDOM.appendChild(this.header);\r\n\t}\r\n\treturn this.valDOM;\r\n}\r\n\r\nHTMLDataViewer.prototype.getValueDOM = function(){\r\n\tif(this.renderer.currentFacet() == \"page\"){\r\n\t\tvar sp = document.createElement(\"div\");\r\n\t}\r\n\telse {\r\n\t\tvar sp = document.createElement(\"span\");\r\n\t}\r\n\tsp.setAttribute(\"class\", \"terminus-property-value property-value-\" + this.renderer.currentFacet() + \" property-value-\" + this.renderer.mode);\r\n\tif(this.renderer.mode == \"view\"){\r\n\t\tsp.setAttribute('data-value', this.renderer.value());\r\n\t}\r\n\treturn sp;\r\n}\r\n\r\nHTMLDataViewer.prototype.getValueBodyDOM = function(){\r\n\tif(this.renderer.currentFacet() == \"page\"){\r\n\t\tvar vholder = document.createElement(\"div\");\r\n\t}\r\n\telse {\r\n\t\tvar vholder = document.createElement(\"span\");\r\n\t}\r\n    vholder.setAttribute('class', ' terminus-property-body property-value-body property-value-body-'+this.renderer.currentFacet() + ' terminus-property-body-align');\r\n\t//vholder.setAttribute('style', 'display: flex;');\r\n\tif(this.renderer.showFeature(\"body\")){\r\n        var valueViewer = this.renderer.getDataValueViewer();\r\n    \tvar vdom = valueViewer.getDOM(this.renderer, this);\r\n    }\r\n    else if(this.renderer.showFeature(\"summary\")){\r\n\t\tvar vdom = this.getSummaryDOM();\r\n    }\r\n    else {\r\n    \treturn false;\r\n    }\r\n    if(vdom) vholder.appendChild(vdom);\r\n\tif(false && this.renderer.currentFacet() == \"page\"){\r\n\t\tvar sControl = HTMLFrameHelper.getSettingsControl('data');\r\n\t\tvar menu = document.createElement('div');\r\n\t\tmenu.setAttribute('class', 'terminus-hide terminus-popup');\r\n\t\tmenu.appendChild(document.createTextNode('Edit property value'));\r\n\t\tmenu.appendChild(document.createElement('BR'));\r\n\t\tsControl.appendChild(menu);\r\n\t\tsControl.addEventListener('click', function(e){\r\n\t\t\tvar target = e.target || e.srcElement,\r\n\t\t\ttext = target.textContent || target.innerText;\r\n\t\t\tif((target.nodeName == 'ICON') || (target.nodeName == 'BUTTON')){\r\n\t\t\t\tif(this.children[0].style.display == 'none') this.children[0].style.display = 'block';\r\n\t\t\t\telse this.children[0].style.display = 'none';\r\n\t\t\t}\r\n\t\t});\r\n\t\tthis.expModeMenu = menu;\r\n\t\tvholder.appendChild(sControl);\r\n\t}\r\n\treturn vholder;\r\n}\r\n\r\n/**\r\n * Removes the value from the dom\r\n */\r\nHTMLDataViewer.prototype.remove = function(){\r\n\tthis.valDOM.parentNode.removeChild(this.valDOM);\r\n}\r\n\r\nHTMLDataViewer.prototype.redrawHeader = function(){\r\n\tif(this.headerViewer && this.header) {\r\n\t\tvar nheader = this.headerViewer.getAsDOM(this.renderer);\r\n\t\tthis.header.replaceWith(nheader);\r\n\t\tthis.header = nheader;\r\n\t}\r\n}\r\n\r\nHTMLDataViewer.prototype.redrawBody = function(){\r\n\tif(this.body){\r\n\t\tvar nbody = this.getValueBodyDOM();\r\n\t\tthis.body.replaceWith(nbody);\r\n\t\tthis.body = nbody;\r\n\t}\r\n}\r\n\r\n/**\r\n * Generates a html anchor element to use as a marker to find the property on the page\r\n */\r\nHTMLDataViewer.prototype.getValueIDMarker = function(renderer){\r\n\tvar idm = document.createElement(\"a\");\r\n\tidm.setAttribute(\"class\", \"terminus-value-idmarker\");\r\n\tvar subj = TerminusClient.FrameHelper.getShorthand(renderer.subject());\r\n\tif(!subj ) subj = renderer.subject();\r\n\tvar bits = subj .split(\":\");\r\n\tif(bits.length > 1) subj = bits[1];\r\n\tvar prop = TerminusClient.FrameHelper.getShorthand(renderer.property());\r\n\tif(!prop ) prop = renderer.property();\r\n\tvar bits = prop.split(\":\");\r\n\tif(bits.length > 1) prop = bits[1];\r\n\tidm.setAttribute(\"name\", subj + \"_\" + prop + \"_\" + renderer.index);\r\n\treturn idm;\r\n}\r\n\r\nHTMLDataViewer.prototype.getSummaryDOM = function(){\r\n\tvar sum = this.renderer.getSummary();\r\n\treturn HTMLTerminusClient.FrameHelper.getInfoboxDOM(\"value-summary\", false, sum.long, sum.long);\r\n}\r\n\r\nHTMLDataViewer.prototype.fireInternalLink = function(link){\r\n\tvar self = this;\r\n\tvar fire = function(e){\r\n\t\te.preventDefault();\r\n\t\tself.renderer.load(link);\t\t\r\n\t}\r\n\treturn fire;\r\n}\r\n\r\nHTMLDataViewer.prototype.internalLink = function(link, label){\r\n\tvar onclick = this.fireInternalLink(link);\r\n\tvar a = document.createElement(\"a\");\r\n\ta.onClick = onclick;\r\n\ta.href=link;\r\n\ta.addEventListener(\"click\", onclick);\r\n\tif(label){\r\n\t\ta.appendChild(document.createTextNode(label));\r\n\t}\r\n\telse {\r\n\t\tvar sh = TerminusClient.FrameHelper.getShorthand(link);\r\n\t\tif(sh){\r\n\t\t\ta.setAttribute(\"title\", link);\r\n\t\t\ta.appendChild(document.createTextNode(sh));\r\n\t\t}\r\n\t\telse {\r\n\t\t\ta.appendChild(document.createTextNode(link));\r\n\t\t}\r\n\t}\r\n\treturn a;\r\n}\r\n\r\nHTMLDataViewer.prototype.clear = function(){\r\n\tTerminusClient.FrameHelper.removeChildren(this.valDOM);\r\n}\r\n\r\n\r\nfunction HTMLDataHeaderViewer(){}\r\n\r\nHTMLDataHeaderViewer.prototype.getAsDOM = function(renderer){\r\n\tif(renderer.currentFacet() == \"page\"){\r\n\t\tvar objDOM = document.createElement(\"div\");\r\n\t}\r\n\telse {\r\n\t\tvar objDOM = document.createElement(\"span\");\r\n\t}\r\n\tobjDOM.setAttribute(\"class\", \"terminus-value-header terminus-value-header-\" + renderer.currentFacet());\r\n\tif(renderer.showFeature(\"facet\")){\r\n\t\tvar facetDOM = this.getValueFacetDOM(renderer);\r\n\t\tif(facetDOM) objDOM.appendChild(facetDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"viewer\")){\r\n\t\tvar hideDOM = this.getViewerSelectorDOM(renderer);\r\n\t\tif(hideDOM) objDOM.appendChild(hideDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"type\")){\r\n\t\tvar typeDOM = this.getValueTypeDOM(renderer);\r\n\t\tif(typeDOM) objDOM.appendChild(typeDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"status\")){\r\n\t\tvar sumDOM = this.getValueStatusDOM(renderer);\r\n\t\tif(sumDOM) objDOM.appendChild(sumDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"control\")){\r\n\t\tvar controlsDOM = this.getValueControlsDOM(renderer);\r\n\t\tif(controlsDOM) objDOM.appendChild(controlsDOM);\r\n\t}\r\n\treturn objDOM;\r\n}\r\n\r\nHTMLDataHeaderViewer.prototype.getValueFacetDOM = function(renderer){\r\n\tvar viewables = renderer.getAvailableFacets();\r\n\tvar self = this;\r\n\tif(viewables && viewables.length){\r\n\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-value-facet\");\r\n\t\tvar callback = function(val){\r\n\t\t\tif(val){\r\n\t\t\t\trenderer.setFacet(val);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"value-facet\", viewables, renderer.currentFacet(), callback);\r\n\t\tmpropDOM.appendChild(sel);\r\n\t\treturn mpropDOM;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\n\r\nHTMLDataHeaderViewer.prototype.getValueTypeDOM = function(renderer){\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"value-type\", \"Type\", renderer.type(), \"All data values have types, identified by a unique URL\");\r\n}\r\n\r\nHTMLDataHeaderViewer.prototype.getValueStatusDOM = function(renderer){\r\n\tvar sum = renderer.getSummary();\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"status-\"+sum.status, false, sum.status, sum.status);\r\n}\r\n\r\n\r\nHTMLDataHeaderViewer.prototype.getValueControlsDOM = function(renderer){\r\n\tvar controlsDOM = document.createElement(\"span\");\r\n\tcontrolsDOM.setAttribute(\"class\", \"terminus-value-controls\");\r\n\tif(renderer.showFeature(\"mode\")){\r\n\t\tvar viewsDOM = HTMLFrameHelper.getModeSelectorDOM(\"value\", renderer);\r\n\t\tif(viewsDOM) controlsDOM.appendChild(viewsDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"delete\")){\r\n\t\tvar dpropDOM = this.getValueDeleteDOM(renderer);\r\n\t\tif(dpropDOM) controlsDOM.appendChild(dpropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"clone\")){\r\n\t\tvar cpropDOM = this.getValueCloneDOM(renderer);\r\n\t\tif(cpropDOM) controlsDOM.appendChild(cpropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"reset\")){\r\n\t\tvar rpropDOM = this.getValueResetDOM(renderer);\r\n\t\tif(rpropDOM) controlsDOM.appendChild(rpropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"update\")){\r\n\t\tvar upropDOM = this.getValueUpdateDOM(renderer);\r\n\t\tif(upropDOM) controlsDOM.appendChild(upropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"show\")){\r\n\t\tvar showDOM = this.getValueShowDOM(renderer);\r\n\t\tif(showDOM) controlsDOM.appendChild(showDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"hide\")){\r\n\t\tvar hideDOM = this.getValueHideDOM(renderer);\r\n\t\tif(hideDOM) controlsDOM.appendChild(hideDOM);\r\n\t}\r\n\treturn controlsDOM;\r\n}\r\n\r\nHTMLDataHeaderViewer.prototype.getValueDeleteDOM = function(renderer){\r\n\tvar callback = function(){renderer.delete()};\r\n\tvar disabled = (renderer.cardControlAllows(\"delete\") ? false : \"Cardinality Rules Forbid Delete\");\r\n\treturn HTMLFrameHelper.getActionControl(\"value\", \"delete\", \"Delete\", callback, disabled);\r\n}\r\n\r\nHTMLDataHeaderViewer.prototype.getValueResetDOM = function(renderer){\r\n\tvar callback = function(){renderer.reset()};\r\n\tvar disabled = (renderer.isUpdated() ? false : \"Nothing to reset\");\r\n\treturn HTMLFrameHelper.getActionControl(\"value\", \"reset\", \"Reset\", callback, disabled);\r\n}\r\n\r\nHTMLDataHeaderViewer.prototype.getValueShowDOM = function(renderer){\r\n\tvar callback = function(){renderer.show()};\r\n\treturn HTMLFrameHelper.getActionControl(\"value\", \"show\", \"Show\", callback);\r\n}\r\n\r\nHTMLDataHeaderViewer.prototype.getValueHideDOM = function(renderer){\r\n\tvar callback = function(){renderer.hide()};\r\n\treturn HTMLFrameHelper.getActionControl(\"value\", \"hide\", \"Hide\", callback);\r\n}\r\n\r\nHTMLDataHeaderViewer.prototype.getValueCloneDOM = function(renderer){\r\n\tvar callback = function(){renderer.clone()};\r\n\tvar disabled = (renderer.cardControlAllows(\"clone\") ? false : \"Cardinality Rules Forbid Clone\");\r\n\treturn HTMLFrameHelper.getActionControl(\"value\", \"clone\", \"Clone\", callback, disabled);\r\n}\r\n\r\nHTMLDataHeaderViewer.prototype.getValueUpdateDOM = function(renderer){\r\n\tvar dpropDOM = document.createElement(\"span\");\r\n\tdpropDOM.setAttribute(\"class\", \"terminus-value-update\");\r\n\tvar saveback = function(){renderer.save()};\r\n\tvar disabled = (renderer.isUpdated() ? false : \"Nothing to save - no change\");\r\n\tdpropDOM.appendChild(HTMLFrameHelper.getActionControl(\"value\", \"save\", \"Save\", saveback, disabled));\r\n\treturn dpropDOM;\r\n}\r\n\r\nHTMLDataHeaderViewer.prototype.getViewerSelectorDOM = function(renderer){\r\n\tvar viewers = renderer.getAvailableViewers();\r\n\tif(viewers && viewers.length){\r\n\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-value-viewer\");\r\n\t\tvar callback = function(viewer){\r\n\t\t\tif(viewer){\r\n\t\t\t\trenderer.setViewer(viewer);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar selected = renderer.currentViewer();\r\n\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"data-viewer\", viewers, selected, callback);\r\n\t\tmpropDOM.appendChild(sel);\r\n\t\treturn mpropDOM;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nmodule.exports=HTMLDataViewer;\r\n","const HTMLStringViewer = require('./datatypes/String');\r\nconst HTMLStringEditor = require('./datatypes/StringEditor');\r\nconst HTMLBooleanViewer = require('./datatypes/Boolean');\r\nconst HTMLBooleanEditor = require('./datatypes/BooleanEditor');\r\nconst HTMLChoiceViewer = require('./datatypes/Choice');\r\nconst HTMLChoiceEditor = require('./datatypes/ChoiceEditor');\r\nconst HTMLCoordinateViewer = require('./datatypes/Coordinate');\r\nconst HTMLCoordinateEditor = require('./datatypes/CoordinateEditor');\r\nconst HTMLDateViewer = require('./datatypes/Date');\r\nconst HTMLDateEditor = require('./datatypes/DateEditor');\r\nconst HTMLEntityViewer = require('./datatypes/Entity');\r\nconst HTMLEntityEditor = require('./datatypes/EntityEditor');\r\nconst HTMLImageViewer = require('./datatypes/Image');\r\nconst HTMLImageEditor = require('./datatypes/ImageEditor');\r\nconst HTMLLinkViewer = require('./datatypes/Link');\r\nconst HTMLNumberViewer = require('./datatypes/Number');\r\nconst HTMLRangeViewer = require('./datatypes/Range');\r\nconst HTMLRangeEditor = require('./datatypes/RangeEditor');\r\nconst SantizedHTMLViewer = require('./datatypes/SanitizedHTML');\r\nconst GoogleMapEditor = require('./datatypes/GoogleMapEditor');\r\nconst GoogleMapViewer = require('./datatypes/GoogleMapViewer');\r\nconst HTMLMarkupEditor = require('./datatypes/HTMLMarkupEditor');\r\nconst S2EntityEditor = require('./datatypes/S2EntityEditor');\r\n\r\n\r\nfunction initialiseDataRenderers(RenderingMap, plugins){\r\n\tRenderingMap.registerViewerForTypes(\"HTMLBooleanViewer\", {label: \"Checkbox Viewer\"}, [\"xsd:boolean\"]);\r\n\tRenderingMap.registerEditorForTypes(\"HTMLBooleanEditor\", {label: \"Checkbox Editor\"}, [\"xsd:boolean\"]);\r\n\tRenderingMap.registerViewerForTypes(\"HTMLChoiceViewer\", {label: \"Choice Viewer\"}, [\"oneOf\"]);\r\n\tRenderingMap.registerEditorForTypes(\"HTMLChoiceEditor\", {label: \"Choice Selector\"}, [\"oneOf\"]);\r\n\tRenderingMap.registerViewerForTypes(\"HTMLCoordinateViewer\", {label: \"Coordinate Viewer\"}, [\"xdd:coordinate\", \"xdd:coordinatePolyline\", \"xdd:coordinatePolygon\"]);\r\n\tRenderingMap.registerEditorForTypes(\"HTMLCoordinateEditor\", {label: \"Coordinate Editor\"}, [\"xdd:coordinate\", \"xdd:coordinatePolyline\", \"xdd:coordinatePolygon\"]);\r\n\tRenderingMap.registerViewerForTypes(\"HTMLDateViewer\", {label: \"Date Viewer\"}, [\"xsd:time\", \"xsd:date\", \"xsd:dateTime\", \"xsd:gYear\", \r\n\t\t\"xsd:gYearRange\", \"xsd:gMonth\", \"xsd:gDay\", \"xsd:gYearMonth\", \"xsd:gMonthDay\", \"xsd:dateTimeStamp\"]);\r\n\tRenderingMap.registerEditorForTypes(\"HTMLDateEditor\", {label: \"Date Editor\"}, [\"xsd:time\", \"xsd:date\", \"xsd:dateRange\" ,\"xsd:dateTime\", \"xsd:gYear\", \r\n\t\t\"xsd:gYearRange\", \"xsd:gMonth\", \"xsd:gDay\", \"xsd:gYearMonth\", \"xsd:gMonthDay\", \"xsd:dateTimeStamp\"]);\r\n\tRenderingMap.registerViewerForTypes(\"HTMLEntityViewer\", {label: \"Document Viewer\"}, [\"document\"]);\r\n\tRenderingMap.registerEditorForTypes(\"HTMLEntityEditor\", {label: \"Document Selector\"}, [\"document\"]);\r\n\tRenderingMap.registerViewerForTypes(\"HTMLImageViewer\", {label: \"Image Viewer\"}, [\"xdd:url\", \"xsd:anyURI\", \"xsd:base64Binary\"]);\r\n\tRenderingMap.registerEditorForTypes(\"HTMLImageEditor\", {label: \"Image Editor\"}, [\"xsd:base64Binary\"]);\r\n\tRenderingMap.registerViewerForTypes(\"HTMLImageViewer\", {label: \"Image Viewer\"}, [\"xdd:url\", \"xsd:anyURI\", \"xsd:base64Binary\"]);\r\n\tRenderingMap.registerEditorForTypes(\"HTMLImageEditor\", {label: \"Image Editor\"}, [\"xsd:base64Binary\"]);\r\n\tRenderingMap.registerViewerForTypes(\"HTMLLinkViewer\", {label: \"Link Viewer\"}, [\"xdd:url\", \"xsd:anyURI\"]);\r\n\tRenderingMap.registerViewerForTypes(\"HTMLNumberViewer\", {label: \"Number with commas\"}, \r\n\t\t\t[\"xsd:decimal\", \"xsd:double\", \"xsd:float\", \"xsd:short\", \"xsd:integer\", \"xsd:long\", \r\n\t\t\t\t\"xsd:nonNegativeInteger\", \"xsd:positiveInteger\", \"xsd:negativeInteger\", \"xsd:nonPositiveInteger\"]);\r\n\tRenderingMap.registerViewerForTypes(\"HTMLRangeViewer\", {label: \"Range Viewer\"}, [\"xdd:gYearRange\", \"xdd:dateRange\", \"xdd:integerRange\", \"xdd:decimalRange\"]);\r\n\tRenderingMap.registerEditorForTypes(\"HTMLRangeEditor\", {label: \"Range Editor\"}, [\"xdd:gYearRange\", \"xdd:dateRange\", \"xdd:integerRange\", \"xdd:decimalRange\"]);\r\n\tRenderingMap.registerViewerForTypes(\"SantizedHTMLViewer\", {label: \"Sanitized HTML\"}, [\"xsd:string\", \"xdd:html\"]);\r\n\tRenderingMap.universalEditor = \"HTMLStringEditor\";\r\n\tRenderingMap.universalViewer = \"HTMLStringViewer\";\r\n\taddPlugins(RenderingMap, plugins);\r\n\tRenderingMap.createRenderer = function(type, args){\r\n\t\tlet r = createDataRenderer(type, args);\r\n\t\treturn r;\r\n\t}\r\n}\r\n\r\nfunction createDataRenderer(type, options){\r\n\ttry {\r\n\t\tvar viewer = eval(\"new \" + type + \".\" + type + \"(\" + JSON.stringify(options) + \")\");\r\n\t}\r\n\tcatch(e){\r\n\t\treturn false;\r\n\t}\r\n\treturn viewer;\r\n}\r\n\r\nfunction addPlugins(RenderingMap, plugins){\r\n\tif(plugins && plugins.indexOf(\"gmaps\") != -1){\r\n\t\tRenderingMap.registerEditorForTypes(\"GoogleMapEditor\", {label: \"Google Map Editor\"}, [\"xdd:coordinate\", \"xdd:coordinatePolyline\", \"xdd:coordinatePolygon\"]);\r\n\t\tRenderingMap.registerViewerForTypes(\"GoogleMapViewer\", {label: \"Google Map Editor\"}, [\"xdd:coordinate\", \"xdd:coordinatePolyline\", \"xdd:coordinatePolygon\"]);\r\n\t}\r\n\tif(plugins && plugins.indexOf(\"quill\") != -1){\r\n\t\tRenderingMap.registerEditorForTypes(\"HTMLMarkupEditor\", {label: \"Quill WYSIWIG HTML Editor\"}, [\"xdd:html\"]);\r\n\t}\r\n\tif(plugins && plugins.indexOf(\"select2\") != -1){\r\n\t\tRenderingMap.registerEditorForFrameType(\"S2EntityEditor\", {label: \"S2 Autocomplete Selector\"}, \"document\");\r\n\t}\r\n}\r\n\r\nmodule.exports = {createDataRenderer, initialiseDataRenderers};","'use strict';\n\nmodule.exports = function bind(fn, thisArg) {\n  return function wrap() {\n    var args = new Array(arguments.length);\n    for (var i = 0; i < args.length; i++) {\n      args[i] = arguments[i];\n    }\n    return fn.apply(thisArg, args);\n  };\n};\n","'use strict';\n\nvar utils = require('./../utils');\n\nfunction encode(val) {\n  return encodeURIComponent(val).\n    replace(/%40/gi, '@').\n    replace(/%3A/gi, ':').\n    replace(/%24/g, '$').\n    replace(/%2C/gi, ',').\n    replace(/%20/g, '+').\n    replace(/%5B/gi, '[').\n    replace(/%5D/gi, ']');\n}\n\n/**\n * Build a URL by appending params to the end\n *\n * @param {string} url The base of the url (e.g., http://www.google.com)\n * @param {object} [params] The params to be appended\n * @returns {string} The formatted url\n */\nmodule.exports = function buildURL(url, params, paramsSerializer) {\n  /*eslint no-param-reassign:0*/\n  if (!params) {\n    return url;\n  }\n\n  var serializedParams;\n  if (paramsSerializer) {\n    serializedParams = paramsSerializer(params);\n  } else if (utils.isURLSearchParams(params)) {\n    serializedParams = params.toString();\n  } else {\n    var parts = [];\n\n    utils.forEach(params, function serialize(val, key) {\n      if (val === null || typeof val === 'undefined') {\n        return;\n      }\n\n      if (utils.isArray(val)) {\n        key = key + '[]';\n      } else {\n        val = [val];\n      }\n\n      utils.forEach(val, function parseValue(v) {\n        if (utils.isDate(v)) {\n          v = v.toISOString();\n        } else if (utils.isObject(v)) {\n          v = JSON.stringify(v);\n        }\n        parts.push(encode(key) + '=' + encode(v));\n      });\n    });\n\n    serializedParams = parts.join('&');\n  }\n\n  if (serializedParams) {\n    var hashmarkIndex = url.indexOf('#');\n    if (hashmarkIndex !== -1) {\n      url = url.slice(0, hashmarkIndex);\n    }\n\n    url += (url.indexOf('?') === -1 ? '?' : '&') + serializedParams;\n  }\n\n  return url;\n};\n","'use strict';\n\nmodule.exports = function isCancel(value) {\n  return !!(value && value.__CANCEL__);\n};\n","'use strict';\n\nvar utils = require('./utils');\nvar normalizeHeaderName = require('./helpers/normalizeHeaderName');\n\nvar DEFAULT_CONTENT_TYPE = {\n  'Content-Type': 'application/x-www-form-urlencoded'\n};\n\nfunction setContentTypeIfUnset(headers, value) {\n  if (!utils.isUndefined(headers) && utils.isUndefined(headers['Content-Type'])) {\n    headers['Content-Type'] = value;\n  }\n}\n\nfunction getDefaultAdapter() {\n  var adapter;\n  // Only Node.JS has a process variable that is of [[Class]] process\n  if (typeof process !== 'undefined' && Object.prototype.toString.call(process) === '[object process]') {\n    // For node use HTTP adapter\n    adapter = require('./adapters/http');\n  } else if (typeof XMLHttpRequest !== 'undefined') {\n    // For browsers use XHR adapter\n    adapter = require('./adapters/xhr');\n  }\n  return adapter;\n}\n\nvar defaults = {\n  adapter: getDefaultAdapter(),\n\n  transformRequest: [function transformRequest(data, headers) {\n    normalizeHeaderName(headers, 'Accept');\n    normalizeHeaderName(headers, 'Content-Type');\n    if (utils.isFormData(data) ||\n      utils.isArrayBuffer(data) ||\n      utils.isBuffer(data) ||\n      utils.isStream(data) ||\n      utils.isFile(data) ||\n      utils.isBlob(data)\n    ) {\n      return data;\n    }\n    if (utils.isArrayBufferView(data)) {\n      return data.buffer;\n    }\n    if (utils.isURLSearchParams(data)) {\n      setContentTypeIfUnset(headers, 'application/x-www-form-urlencoded;charset=utf-8');\n      return data.toString();\n    }\n    if (utils.isObject(data)) {\n      setContentTypeIfUnset(headers, 'application/json;charset=utf-8');\n      return JSON.stringify(data);\n    }\n    return data;\n  }],\n\n  transformResponse: [function transformResponse(data) {\n    /*eslint no-param-reassign:0*/\n    if (typeof data === 'string') {\n      try {\n        data = JSON.parse(data);\n      } catch (e) { /* Ignore */ }\n    }\n    return data;\n  }],\n\n  /**\n   * A timeout in milliseconds to abort a request. If set to 0 (default) a\n   * timeout is not created.\n   */\n  timeout: 0,\n\n  xsrfCookieName: 'XSRF-TOKEN',\n  xsrfHeaderName: 'X-XSRF-TOKEN',\n\n  maxContentLength: -1,\n\n  validateStatus: function validateStatus(status) {\n    return status >= 200 && status < 300;\n  }\n};\n\ndefaults.headers = {\n  common: {\n    'Accept': 'application/json, text/plain, */*'\n  }\n};\n\nutils.forEach(['delete', 'get', 'head'], function forEachMethodNoData(method) {\n  defaults.headers[method] = {};\n});\n\nutils.forEach(['post', 'put', 'patch'], function forEachMethodWithData(method) {\n  defaults.headers[method] = utils.merge(DEFAULT_CONTENT_TYPE);\n});\n\nmodule.exports = defaults;\n","'use strict';\n\nvar utils = require('./../utils');\nvar settle = require('./../core/settle');\nvar buildURL = require('./../helpers/buildURL');\nvar parseHeaders = require('./../helpers/parseHeaders');\nvar isURLSameOrigin = require('./../helpers/isURLSameOrigin');\nvar createError = require('../core/createError');\n\nmodule.exports = function xhrAdapter(config) {\n  return new Promise(function dispatchXhrRequest(resolve, reject) {\n    var requestData = config.data;\n    var requestHeaders = config.headers;\n\n    if (utils.isFormData(requestData)) {\n      delete requestHeaders['Content-Type']; // Let the browser set it\n    }\n\n    var request = new XMLHttpRequest();\n\n    // HTTP basic authentication\n    if (config.auth) {\n      var username = config.auth.username || '';\n      var password = config.auth.password || '';\n      requestHeaders.Authorization = 'Basic ' + btoa(username + ':' + password);\n    }\n\n    request.open(config.method.toUpperCase(), buildURL(config.url, config.params, config.paramsSerializer), true);\n\n    // Set the request timeout in MS\n    request.timeout = config.timeout;\n\n    // Listen for ready state\n    request.onreadystatechange = function handleLoad() {\n      if (!request || request.readyState !== 4) {\n        return;\n      }\n\n      // The request errored out and we didn't get a response, this will be\n      // handled by onerror instead\n      // With one exception: request that using file: protocol, most browsers\n      // will return status as 0 even though it's a successful request\n      if (request.status === 0 && !(request.responseURL && request.responseURL.indexOf('file:') === 0)) {\n        return;\n      }\n\n      // Prepare the response\n      var responseHeaders = 'getAllResponseHeaders' in request ? parseHeaders(request.getAllResponseHeaders()) : null;\n      var responseData = !config.responseType || config.responseType === 'text' ? request.responseText : request.response;\n      var response = {\n        data: responseData,\n        status: request.status,\n        statusText: request.statusText,\n        headers: responseHeaders,\n        config: config,\n        request: request\n      };\n\n      settle(resolve, reject, response);\n\n      // Clean up request\n      request = null;\n    };\n\n    // Handle browser request cancellation (as opposed to a manual cancellation)\n    request.onabort = function handleAbort() {\n      if (!request) {\n        return;\n      }\n\n      reject(createError('Request aborted', config, 'ECONNABORTED', request));\n\n      // Clean up request\n      request = null;\n    };\n\n    // Handle low level network errors\n    request.onerror = function handleError() {\n      // Real errors are hidden from us by the browser\n      // onerror should only fire if it's a network error\n      reject(createError('Network Error', config, null, request));\n\n      // Clean up request\n      request = null;\n    };\n\n    // Handle timeout\n    request.ontimeout = function handleTimeout() {\n      reject(createError('timeout of ' + config.timeout + 'ms exceeded', config, 'ECONNABORTED',\n        request));\n\n      // Clean up request\n      request = null;\n    };\n\n    // Add xsrf header\n    // This is only done if running in a standard browser environment.\n    // Specifically not if we're in a web worker, or react-native.\n    if (utils.isStandardBrowserEnv()) {\n      var cookies = require('./../helpers/cookies');\n\n      // Add xsrf header\n      var xsrfValue = (config.withCredentials || isURLSameOrigin(config.url)) && config.xsrfCookieName ?\n        cookies.read(config.xsrfCookieName) :\n        undefined;\n\n      if (xsrfValue) {\n        requestHeaders[config.xsrfHeaderName] = xsrfValue;\n      }\n    }\n\n    // Add headers to the request\n    if ('setRequestHeader' in request) {\n      utils.forEach(requestHeaders, function setRequestHeader(val, key) {\n        if (typeof requestData === 'undefined' && key.toLowerCase() === 'content-type') {\n          // Remove Content-Type if data is undefined\n          delete requestHeaders[key];\n        } else {\n          // Otherwise add header to the request\n          request.setRequestHeader(key, val);\n        }\n      });\n    }\n\n    // Add withCredentials to request if needed\n    if (config.withCredentials) {\n      request.withCredentials = true;\n    }\n\n    // Add responseType to request if needed\n    if (config.responseType) {\n      try {\n        request.responseType = config.responseType;\n      } catch (e) {\n        // Expected DOMException thrown by browsers not compatible XMLHttpRequest Level 2.\n        // But, this can be suppressed for 'json' type as it can be parsed by default 'transformResponse' function.\n        if (config.responseType !== 'json') {\n          throw e;\n        }\n      }\n    }\n\n    // Handle progress if needed\n    if (typeof config.onDownloadProgress === 'function') {\n      request.addEventListener('progress', config.onDownloadProgress);\n    }\n\n    // Not all browsers support upload events\n    if (typeof config.onUploadProgress === 'function' && request.upload) {\n      request.upload.addEventListener('progress', config.onUploadProgress);\n    }\n\n    if (config.cancelToken) {\n      // Handle cancellation\n      config.cancelToken.promise.then(function onCanceled(cancel) {\n        if (!request) {\n          return;\n        }\n\n        request.abort();\n        reject(cancel);\n        // Clean up request\n        request = null;\n      });\n    }\n\n    if (requestData === undefined) {\n      requestData = null;\n    }\n\n    // Send the request\n    request.send(requestData);\n  });\n};\n","'use strict';\n\nvar enhanceError = require('./enhanceError');\n\n/**\n * Create an Error with the specified message, config, error code, request and response.\n *\n * @param {string} message The error message.\n * @param {Object} config The config.\n * @param {string} [code] The error code (for example, 'ECONNABORTED').\n * @param {Object} [request] The request.\n * @param {Object} [response] The response.\n * @returns {Error} The created error.\n */\nmodule.exports = function createError(message, config, code, request, response) {\n  var error = new Error(message);\n  return enhanceError(error, config, code, request, response);\n};\n","'use strict';\n\nvar utils = require('../utils');\n\n/**\n * Config-specific merge-function which creates a new config-object\n * by merging two configuration objects together.\n *\n * @param {Object} config1\n * @param {Object} config2\n * @returns {Object} New object resulting from merging config2 to config1\n */\nmodule.exports = function mergeConfig(config1, config2) {\n  // eslint-disable-next-line no-param-reassign\n  config2 = config2 || {};\n  var config = {};\n\n  utils.forEach(['url', 'method', 'params', 'data'], function valueFromConfig2(prop) {\n    if (typeof config2[prop] !== 'undefined') {\n      config[prop] = config2[prop];\n    }\n  });\n\n  utils.forEach(['headers', 'auth', 'proxy'], function mergeDeepProperties(prop) {\n    if (utils.isObject(config2[prop])) {\n      config[prop] = utils.deepMerge(config1[prop], config2[prop]);\n    } else if (typeof config2[prop] !== 'undefined') {\n      config[prop] = config2[prop];\n    } else if (utils.isObject(config1[prop])) {\n      config[prop] = utils.deepMerge(config1[prop]);\n    } else if (typeof config1[prop] !== 'undefined') {\n      config[prop] = config1[prop];\n    }\n  });\n\n  utils.forEach([\n    'baseURL', 'transformRequest', 'transformResponse', 'paramsSerializer',\n    'timeout', 'withCredentials', 'adapter', 'responseType', 'xsrfCookieName',\n    'xsrfHeaderName', 'onUploadProgress', 'onDownloadProgress', 'maxContentLength',\n    'validateStatus', 'maxRedirects', 'httpAgent', 'httpsAgent', 'cancelToken',\n    'socketPath'\n  ], function defaultToConfig2(prop) {\n    if (typeof config2[prop] !== 'undefined') {\n      config[prop] = config2[prop];\n    } else if (typeof config1[prop] !== 'undefined') {\n      config[prop] = config1[prop];\n    }\n  });\n\n  return config;\n};\n","'use strict';\n\n/**\n * A `Cancel` is an object that is thrown when an operation is canceled.\n *\n * @class\n * @param {string=} message The message.\n */\nfunction Cancel(message) {\n  this.message = message;\n}\n\nCancel.prototype.toString = function toString() {\n  return 'Cancel' + (this.message ? ': ' + this.message : '');\n};\n\nCancel.prototype.__CANCEL__ = true;\n\nmodule.exports = Cancel;\n","const UTILS = require('./utils.js');\nconst CONST = require('./const.js');\nconst ErrorMessage = require('./errorMessage');\n/*\n * Creates an entry in the connection registry for the server\n * and all the databases that the client has access to\n * maps the input authorties to a per-db array for internal storage and easy\n * access control checks\n * {doc:dbid => {terminus:authority =>\n * [terminus:woql_select, terminus:create_document, auth3, ...]}}\n *\n */\n\nfunction ConnectionCapabilities(connectionConfig, key) {\n\tthis.connection = {};\n\tthis.connectionConfig = connectionConfig;\n\tif (this.connectionConfig.server && key) {\n\t\tthis.setClientKey(this.connectionConfig.server, key);\n\t}\n}\n\nConnectionCapabilities.prototype.getClientKey = function (serverURL) {\n\tif (!serverURL) serverURL = this.connectionConfig.serverURL();\n\tif (serverURL && this.connection[serverURL]) return this.connection[serverURL].key;\n\treturn false;\n};\n\n\n/*\n * Utility functions for changing the state of connections with Terminus servers\n */\nConnectionCapabilities.prototype.setClientKey = function (curl, key) {\n\tif (typeof key === 'string' && key.trim()) {\n\t\tif (typeof this.connection[curl] === 'undefined') {\n\t\t\tthis.connection[curl] = {};\n\t\t}\n\t\tthis.connection[curl].key = key.trim();\n\t}\n};\n\n\n/**\n * @params {string} curl a valid terminusDB server URL\n * @params {object} capabilities it is the connect call response\n */\nConnectionCapabilities.prototype.addConnection = function (curl, capabilities) {\n\tif (typeof this.connection[curl] === 'undefined') {\n\t\tthis.connection[curl] = {};\n\t}\n\tconst capabilitiesKeys = capabilities ? Object.keys(capabilities) : [];\n\n\tfor (const pred of capabilitiesKeys) {\n\t    if (pred === 'terminus:authority' && capabilities[pred]) {\n\t      const auths = Array.isArray(capabilities[pred]) === true\n\t        ? capabilities[pred]\n\t        : [capabilities[pred]];\n\n\t      for (let i = 0; i < auths.length; i += 1) {\n\t        let scope = auths[i]['terminus:authority_scope'];\n\t        const actions = auths[i]['terminus:action'];\n\n\t        if (Array.isArray(scope) === false) scope = [scope];\n\t        const actionsArr = UTILS.authorityActionsToArr(actions);\n\n\t        for (let j = 0; j < scope.length; j += 1) {\n\t          const nrec = scope[j];\n\t          if (typeof this.connection[curl][nrec['@id']] === 'undefined') {\n\t            this.connection[curl][nrec['@id']] = nrec;\n\t          }\n\t          this.connection[curl][nrec['@id']]['terminus:authority'] = actionsArr;\n\t        }\n\t      }\n\t    } else {\n\t      this.connection[curl][pred] = capabilities[pred];\n\t    }\n\t}\n};\n\nConnectionCapabilities.prototype.serverConnected = function () {\n\treturn typeof this.connection[this.connectionConfig.server] !== 'undefined';\n};\n\nConnectionCapabilities.prototype.capabilitiesPermit = function (action, dbid, server) {\n\tif (!this.connectionConfig.connectionMode()\n         || this.connectionConfig.client_checks_capabilities !== true\n         || action === CONST.CONNECT) { return true; }\n\n\tserver = server || this.connectionConfig.server;\n\tdbid = dbid || this.connectionConfig.dbid;\n\n\tlet rec;\n\n\tif (action === CONST.CREATE_DATABASE) {\n\t\trec = this.getServerRecord(server);\n\t} else if (dbid) rec = this.getDBRecord(dbid);\n\telse console.log('no dbid', server, dbid);\n\tif (rec) {\n\t\tconst auths = rec['terminus:authority'];\n\t\tif (auths && auths.indexOf(`terminus:${action}`) !== -1) return true;\n\t} else {\n\t\tconsole.log('problem with ', this.connection, action, server, dbid);\n\t}\n\tthis.error = ErrorMessage.accessDenied(action, dbid, server);\n\treturn false;\n};\n\nConnectionCapabilities.prototype.getServerRecord = function (srvr) {\n\tconst url = (srvr || this.connectionConfig.server);\n\tconst connectionObj = this.connection[url] || {};\n\tconst okeys = Object.keys(connectionObj);\n\n\tfor (const oid of okeys) {\n\t\tif (this.connection[url][oid]['@type'] === 'terminus:Server') {\n\t\t\treturn this.connection[url][oid];\n\t\t}\n\t}\n\treturn false;\n};\n\nConnectionCapabilities.prototype.getDBRecord = function (dbid, srvr) {\n\tconst url = (srvr || this.connectionConfig.server);\n\tdbid = (dbid || this.connectionConfig.dbid);\n\tif (typeof this.connection[url] !== 'object') {\n\t\treturn false;\n\t}\n\tif (typeof this.connection[url][dbid] !== 'undefined') { return this.connection[url][dbid]; }\n\n\tdbid = this.dbCapabilityID(dbid);\n\n\tif (typeof this.connection[url][dbid] !== 'undefined') { return this.connection[url][dbid]; }\n\n\treturn undefined;\n};\n\nConnectionCapabilities.prototype.getServerDBRecords = function (srvr) {\n\tconst url = (srvr || this.connectionConfig.server);\n\tconst dbrecs = {};\n\tconst connectionObj = this.connection[url] || {};\n\n\tfor (const oid of Object.keys(connectionObj)) {\n\t\tif (this.connection[url][oid]['@type'] === 'terminus:Database') {\n\t\t\tdbrecs[oid] = this.connection[url][oid];\n\t\t}\n\t}\n\treturn dbrecs;\n};\n\n/*\n * removes a database record from the connection registry (after deletion, for example)\n */\nConnectionCapabilities.prototype.removeDB = function (dbid, srvr) {\n\tdbid = dbid || this.connectionConfig.dbid;\n\n\tif (dbid && this.connectionConfig.dbid && this.connectionConfig.dbid === dbid) {\n\t\tthis.connectionConfig.dbid = false;\n\t}\n\n\tconst url = srvr || this.connectionConfig.server;\n\tconst dbidCap = this.dbCapabilityID(dbid);\n\tif (dbidCap && this.connection[url] && this.connection[url][dbidCap]) {\n\t\tdelete this.connection[url][dbidCap];\n\t}\n};\n\n\nConnectionCapabilities.prototype.dbCapabilityID = function (dbid) {\n\treturn `doc:${dbid}`;\n};\n\nConnectionCapabilities.prototype.getDBRecord = function (dbid, srvr) {\n\tconst url = srvr || this.connectionConfig.server;\n\tdbid = dbid || this.connectionConfig.dbid;\n\tif (typeof this.connection[url] !== 'object') {\n\t\treturn false;\n\t}\n\tif (typeof this.connection[url][dbid] !== 'undefined') { return this.connection[url][dbid]; }\n\n\tdbid = this.dbCapabilityID(dbid);\n\n\tif (typeof this.connection[url][dbid] !== 'undefined') { return this.connection[url][dbid]; }\n\n\treturn undefined;\n};\n\nmodule.exports = ConnectionCapabilities;\n","\nconst IDParser = require('./terminusIDParser');\n\nfunction ConnectionConfig(params) {\n\tconst newParams = params || {};\n\tthis.server = false;\n\tthis.dbid = false;\n\tthis.docid = false;\n\tif (newParams.server) this.setServer(newParams.server);\n\tif (newParams.db) this.setDB(newParams.db);\n\tif (newParams.doc) this.setDocument(newParams.doc);\n\t/*\n     * client configuration options - connected_mode = connected\n     * tells the client to first connect to the server before invoking other services\n     */\n\n\tthis.connected_mode = newParams.connected_mode || 'connected';\n\t// include a terminus:user_key API key in the calls\n\tthis.include_key = newParams.include_key || true;\n\t// client side checking of access control (in addition to server-side access control)\n\tthis.client_checks_capabilities = newParams.client_checks_capabilities || true;\n}\n\nConnectionConfig.prototype.serverURL = function () {\n\treturn this.server;\n};\n\n\nConnectionConfig.prototype.connectionMode = function () {\n\treturn this.connected_mode === 'connected';\n};\n\nConnectionConfig.prototype.includeKey = function () {\n\treturn this.include_key === true;\n};\n\nConnectionConfig.prototype.schemaURL = function () {\n\treturn `${this.dbURL()}/schema`;\n};\nConnectionConfig.prototype.queryURL = function () {\n\treturn `${this.dbURL()}/woql`;\n};\nConnectionConfig.prototype.frameURL = function () {\n\treturn `${this.dbURL()}/frame`;\n};\nConnectionConfig.prototype.docURL = function () {\n\treturn `${this.dbURL()}/document/${this.docid ? this.docid : ''}`;\n};\n\nConnectionConfig.prototype.dbURL = function (call) {\n\t// url swizzling to talk to platform using server/dbid/platform/ pattern..\n\tif (this.platformEndpoint()) {\n\t\tconst baseURL = this.server.substring(0, this.server.lastIndexOf('/platform/'));\n\n\t\tif (!call || call !== 'create') {\n\t\t\treturn `${baseURL}/${this.dbid}/platform`;\n\t\t} if (call === 'platform') {\n\t\t\treturn `${baseURL}/${this.dbid}`;\n\t\t}\n\t}\n\treturn this.server + this.dbid;\n};\n\nConnectionConfig.prototype.platformEndpoint = function () {\n\tif (this.server && this.server.lastIndexOf('/platform/') === this.server.length - 10) {\n\t\treturn true;\n\t}\n\treturn false;\n};\n\n/**\n * Utility functions for setting and parsing urls and determining\n * the current server, database and document\n */\nConnectionConfig.prototype.setServer = function (inputStr, context) {\n\tconst parser = new IDParser(context);\n\tif (parser.parseServerURL(inputStr)) {\n\t\tthis.server = parser.server();\n\t\tthis.dbid = false;\n\t\tthis.docid = false;\n\t\treturn true;\n\t}\n\treturn false;\n};\n\nConnectionConfig.prototype.setDB = function (inputStr, context) {\n\tconst parser = new IDParser(context);\n\tif (parser.parseDBID(inputStr)) {\n\t\tif (parser.server()) this.server = parser.server();\n\t\tthis.dbid = parser.dbid();\n\t\tthis.docid = false;\n\t\treturn true;\n\t}\n\treturn false;\n};\n\n// @param {string} inputStr TerminusDB server URL or a valid TerminusDB Id or omitted\n\nConnectionConfig.prototype.setSchemaURL = function (inputStr, context) {\n\tconst parser = new IDParser(context);\n\tif (parser.parseSchemaURL(inputStr)) {\n\t\tif (parser.server()) this.server = parser.server();\n\t\tthis.dbid = parser.dbid();\n\t\tthis.docid = false;\n\t\treturn true;\n\t}\n\treturn false;\n};\n\nConnectionConfig.prototype.setDocument = function (inputStr, context) {\n\tconst parser = new IDParser(context);\n\tif (parser.parseDocumentURL(inputStr)) {\n\t\tif (parser.server()) this.server = parser.server();\n\t\tif (parser.dbid()) this.dbid = parser.dbid();\n\t\tif (parser.docid()) this.docid = parser.docid();\n\t\treturn true;\n\t}\n\treturn false;\n};\n\nConnectionConfig.prototype.setQueryURL = function (inputStr, context) {\n\tconst parser = new IDParser(context);\n\tif (parser.parseQueryURL(inputStr)) {\n\t\tif (parser.server()) this.server = parser.server();\n\t\tthis.dbid = parser.dbid();\n\t\tthis.docid = false;\n\t\treturn true;\n\t}\n\treturn false;\n};\n\nConnectionConfig.prototype.setClassFrameURL = function (inputStr, context) {\n\tconst parser = new IDParser(context);\n\tif (parser.parseClassFrameURL(inputStr)) {\n\t\tif (parser.server()) this.server = parser.server();\n\t\tthis.dbid = parser.dbid();\n\t\tthis.docid = false;\n\t\treturn true;\n\t}\n\treturn false;\n};\n\nmodule.exports = ConnectionConfig;\n","/*\n11.75s$ npm install\n6.39s$ npm test\n*/\n/*\n * Helper class for parsing and decomposing Terminus URLs /\n * and dealing with namespace prefixed URLs\n */\n// const URL = require('url').URL;\n\n/*\n\"@context\": {\n    \"owl\":\"http://www.w3.org/2002/07/owl#\",\n    \"rdf\":\"http://www.w3.org/1999/02/22-rdf-syntax-ns#\",\n    \"xsd\":\"http://www.w3.org/2001/XMLSchema#\"\n  } */\n\n\nfunction IDParser(context) {\n\tthis.context = context;\n\tthis.server_url = false;\n\tthis.db = false;\n\tthis.doc = false;\n}\n\nIDParser.prototype.server = function () {\n\treturn this.server_url;\n};\n\nIDParser.prototype.dbid = function () {\n\treturn this.db;\n};\n\nIDParser.prototype.docid = function () {\n\treturn this.doc;\n};\n\nIDParser.prototype.setContext = function (context) {\n\tthis.context = context;\n};\n\nIDParser.prototype.parseServerURL = function (str) {\n\tthis.server_url = false;\n\n\tif (this.validURL(str)) {\n\t\tthis.server_url = str;\n\t} else if (this.context && this.validPrefixedURL(str, this.context)) {\n\t\tthis.server_url = this.expandPrefixed(str, this.context);\n\t}\n\n\tif (this.server_url && this.server_url.lastIndexOf('/') !== this.server_url.length - 1\n\t) {\n\t\tthis.server_url += '/';\n\t}\n\treturn this.server_url;\n};\n\nIDParser.prototype.parseDBID = function (str) {\n\tthis.db = false;\n\tif (this.context && this.validPrefixedURL(str, this.context)) {\n\t\tstr = this.expandPrefixed(str, this.context);\n\t}\n\tif (this.validURL(str)) {\n\t\tif (str.lastIndexOf('/') === str.length - 1) {\n\t\t\t// trim trailing slash\n\t\t\tstr = str.substring(0, str.length - 1);\n\t\t}\n\t\tconst index = str.lastIndexOf('/');\n\n\t\tconst serverURL = str.substring(0, index);\n\t\t// only dbNamer\n\t\tstr = str.substring(index + 1);\n\n\t\tif (this.parseServerURL(serverURL) === false) return false;\n\t}\n\n\tif (this.validIDString(str)) {\n\t\tthis.db = str;\n\t}\n\treturn this.db;\n};\n\nIDParser.prototype.parseDocumentURL = function (str) {\n\tthis.doc = false;\n\tif (this.context && this.validPrefixedURL(str, this.context)) {\n\t\tstr = this.expandPrefixed(str, this.context);\n\t}\n\n\tif (this.validURL(str)) {\n\t\tlet dbURL = str;\n\t\tif (str.lastIndexOf('/document/') !== -1) {\n\t\t\t// get dbURL\n\t\t\tdbURL = str.substring(0, str.lastIndexOf('/document/'));\n\t\t\tstr = str.substring(str.lastIndexOf('/document/') + 10);\n\t\t}\n\t\tif (this.parseDBID(dbURL) === false) return false;\n\t}\n\tif (str.substring(0, 4) === 'doc:') str = str.substring(4);\n\t// check if the document's name hasn't space or '/'\n\tif (this.validIDString(str)) {\n\t\tthis.doc = str;\n\t}\n\treturn this.doc;\n};\n\nIDParser.prototype.parseSchemaURL = function (str) {\n\tif (this.context && this.validPrefixedURL(str, this.context)) {\n\t\tstr = this.expandPrefixed(str, this.context);\n\t}\n\tif (this.validURL(str)) {\n\t\tstr = this.stripOptionalPath(str, 'schema');\n\t}\n\treturn this.parseDBID(str);\n};\n\nIDParser.prototype.parseQueryURL = function (str) {\n\tif (this.context && this.validPrefixedURL(str, this.context)) {\n\t\tstr = this.expandPrefixed(str, this.context);\n\t}\n\tif (this.validURL(str)) {\n\t\tstr = this.stripOptionalPath(str, 'woql');\n\t\tstr = this.stripOptionalPath(str, 'query');\n\t}\n\treturn this.parseDBID(str);\n};\n\nIDParser.prototype.stripOptionalPath = function (str, bit) {\n\tif (str.indexOf(`/${bit}`) !== -1) str = str.substring(0, str.indexOf(`/${bit}`));\n\treturn str;\n};\n\nIDParser.prototype.parseClassFrameURL = function (str) {\n\tif (this.context && this.validPrefixedURL(str, this.context)) {\n\t\tstr = this.expandPrefixed(str, this.context);\n\t}\n\tif (this.validURL(str)) {\n\t\tstr = this.stripOptionalPath(str, 'frame');\n\t}\n\treturn this.parseDBID(str);\n};\n\n// Valid URLs are those that start with http:// or https://\nIDParser.prototype.validURL = function (str) {\n\tif (str.substring(0, 7) === 'http://' || str.substring(0, 8) === 'https://') return true;\n\treturn false;\n};\n\nIDParser.prototype.validPrefixedURL = function (str, context) {\n\tif (typeof str !== 'string' || typeof context !== 'object') return false;\n\tconst parts = str.split(':');\n\tif (parts.length !== 2) return false;\n\tif (parts[0].length < 1 || parts[1].length < 1) return false;\n\tif (context && context[parts[0]] && this.validIDString(parts[1])) return true;\n\treturn false;\n};\n\nIDParser.prototype.validIDString = function (str) {\n\tif (typeof str !== 'string') return false;\n\tif (str.indexOf(':') !== -1 || str.indexOf(' ') !== -1 || str.indexOf('/') !== -1) return false;\n\treturn true;\n};\n\nIDParser.prototype.expandPrefixed = function (str, context) {\n\tconst parts = str.split(':');\n\treturn context[parts[0]] + parts[1];\n};\n\nmodule.exports = IDParser;\n","/**\r\n * A frame pattern can have the following variables\r\n * renderer : object, property, data, * - matches a specific part of the frame\r\n * label : matches the label of a property\r\n * frame_type: object, data, document, oneOf\r\n * subject: id of the subject\r\n * subjectClass: class of the subject\r\n * range: type of a property (applies to property and data)\r\n * property: property id or list of property ids (parent property if it is an object or data)\r\n * value: value of the property\r\n * parent: a pattern relating to the parent of this frame\r\n * children: patterns for matching on the children of a frame\r\n * depth: how deep are we in the document? starts from 0\r\n * index: the index of a value in an array\r\n * status: updated, error, new, ok,\r\n */\r\n\r\nfunction FramePattern(pattern){\r\n\tif(pattern){\r\n\t\tthis.setPattern(pattern);\r\n\t}\r\n};\r\n\r\nFramePattern.prototype.setPattern = function(pattern){\r\n\tthis.scope = (pattern.scope ? pattern.scope: false);\r\n\tthis.label = (pattern.label ? pattern.label : false);\r\n\tthis.frame_type = (pattern.frame_type ? pattern.frame_type : false);\r\n\tthis.subject = (pattern.subject ? pattern.subject : false);\r\n\tthis.subjectClass = (pattern.subjectClass ? pattern.subjectClass : false);\r\n\tthis.range = (pattern.range ? pattern.range : false);\r\n\tthis.property = (pattern.property ? pattern.property : false);\r\n\tthis.value = (pattern.value ? pattern.value : false);\r\n\tthis.parent = (pattern.parent ? new FramePattern(pattern.parent) : false);\r\n\tthis.children = [];\r\n\tif (pattern.children) {\r\n\t\tfor (let i = 0; i < pattern.children.length; i++) {\r\n\t\t\tthis.children.push(new FramePattern(pattern.children[i]));\r\n\t\t}\r\n\t}\r\n\tthis.depth = (typeof pattern.depth !== 'undefined' ? pattern.depth : false);\r\n\tthis.index = (pattern.index ? pattern.index : false);\r\n\tthis.status = (pattern.status ? pattern.status : false);\r\n}\r\n\r\nFramePattern.prototype.checkFrame = function(frame){\r\n\tvar rtype = this.getRendererType(frame);\r\n\tif(!rtype) return false;\r\n\tif(this.scope && (this.scope != rtype) && (this.scope != \"*\" )) return false;\r\n\tif(this.illegalRuleType(rtype)) return false;\r\n\tif(this.frame_type && !this.checkFrameType(rtype, frame)) return false;\r\n\tif(this.label && !this.checkLabel(rtype, frame)) return false;\r\n\tif(this.subject && !this.checkSubject(rtype, frame)) return false;\r\n\tif(this.subjectClass && !this.checkSubjectClass(rtype, frame)) return false;\r\n\tif(this.property && !this.checkProperty(rtype, frame)) return false;\r\n\tif(this.depth !== false && !this.checkDepth(rtype, frame)) return false;\r\n\tif(this.range && !this.checkRange(rtype, frame)) return false;\r\n\tif(this.value && !this.checkValue(rtype, frame)) return false;\r\n\tif(this.parent && !this.checkParent(rtype, frame)) return false;\r\n\tif(this.children && this.children.length && !this.checkChildren(rtype, frame)) return false;\r\n\tif(this.index && !this.checkIndex(rtype, frame)) return false;\r\n\tif(this.status && !this.checkStatus(rtype, frame)) return false;\r\n\treturn true;\r\n};\r\n\r\nFramePattern.prototype.illegalRuleType = function (rtype) {\r\n\t// data frames have no children\r\n\tif (rtype == 'data' && this.children.length) return true;\r\n\t// object frames have no range\r\n\tif (rtype == 'object' && this.range) return true;\r\n\treturn false;\r\n};\r\n\r\n/* subject is an id or an array of ids,\r\n/* match is positive if the renderer's subject appears in the array or is the id\r\n */\r\nFramePattern.prototype.checkSubject = function (subject, frame) {\r\n\tif (typeof this.subject !== 'object' || !this.subject.length) this.subject = [this.subject];\r\n\tconst rsubj = frame.subject();\r\n\tfor (let i = 0; i < this.subject.length; i++) {\r\n\t\tif (this.IDsMatch(subject[i], rsubj)) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n};\r\n\r\n// at least one child must match all child rules\r\nFramePattern.prototype.checkChildren = function (rtype, frame) {\r\n\tfor (let i = 0; i < this.children.length; i++) {\r\n\t\tlet found = false;\r\n\t\tif (rtype == 'object') {\r\n\t\t\tfor (const prop in frame.properties) {\r\n\t\t\t\tif (this.children[i].checkFrame(frame.properties[prop])) {\r\n\t\t\t\t\tfound = true;\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else if (rtype == 'property') {\r\n\t\t\tfor (let j = 0; j <= renderer.values.length; j++) {\r\n\t\t\t\tif (this.children[j].checkFrame(frame.values[j])) {\r\n\t\t\t\t\tfound = true;\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (!found) return false;\r\n\t}\r\n\treturn true;\r\n};\r\n\r\nFramePattern.prototype.checkStatus = function (rtype, frame) {\r\n\tif (typeof this.status !== 'object' || this.status.length == 0) this.status = [this.status];\r\n\tfor (let i = 0; i < this.status.length; i++) {\r\n\t\tif (this.status[i] == 'updated' && !frame.isUpdated()) return false;\r\n\t\tif (this.status[i] == 'new' && !frame.isNew()) return false;\r\n\t\tif (this.status[i] == 'unchanged' && frame.isUpdated()) return false;\r\n\t}\r\n\treturn true;\r\n};\r\n\r\nFramePattern.prototype.checkDepth = function (rtype, frame) {\r\n\treturn this.numberMatch(this.depth, frame.depth());\r\n};\r\n\r\nFramePattern.prototype.checkParent = function (rtype, frame) {\r\n\treturn this.parent.checkFrame(frame.parent);\r\n};\r\n\r\nFramePattern.prototype.checkIndex = function (rtype, frame) {\r\n\tif (rtype == 'data') {\r\n\t\treturn this.index == frame.index;\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nFramePattern.prototype.checkProperty = function (rtype, frame) {\r\n\tif (typeof this.property !== 'object' || !this.property.length) this.property = [this.property];\r\n\tfor (let i = 0; i < this.property.length; i++) {\r\n\t\tif (this.propertyIDsMatch(frame.property(), this.property[i])) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n};\r\n\r\n// returns true if any of the values are found\r\nFramePattern.prototype.checkValue = function (rtype, frame) {\r\n\tif (typeof this.value !== 'object' || !this.value.length) this.value = [this.value];\r\n\tfor (let i = 0; i < this.value.length; i++) {\r\n\t\tif (rtype == 'data') {\r\n\t\t\tif (this.valuesMatch(frame.value(), this.value[i])) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t} else if (rtype == 'property') {\r\n\t\t\tfor (let j = 0; j <= frame.values.length; j++) {\r\n\t\t\t\tif (this.getRendererType(frame.values[i]) == 'data'\r\n\t\t\t\t\t\t&& this.valuesMatch(frame.values[i].get(), this.value[i])) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else if (rtype == 'object') {\r\n\t\t\tfor (const prop in frame.properties) {\r\n\t\t\t\tif (this.checkValue(this.getRendererType(frame.properties[prop]), frame.properties[prop])) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nFramePattern.prototype.checkRange = function (rtype, frame) {\r\n\tif (typeof this.range !== 'object' || !this.range.length) this.range = [this.range];\r\n\tfor (let i = 0; i < this.range.length; i++) {\r\n\t\tif (this.rangeIDsMatch(frame.range(), this.range[i])) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nFramePattern.prototype.checkSubjectClass = function (rtype, frame) {\r\n\tif (typeof this.subjectClass !== 'object' || !this.subjectClass.length) this.subjectClass = [this.subjectClass];\r\n\tconst rcls = frame.subjectClass();\r\n\tfor (let i = 0; i < this.subjectClass.length; i++) {\r\n\t\tif (this.classIDsMatch(this.subjectClass[i], rcls)) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nFramePattern.prototype.checkFrameType = function (rtype, frame) {\r\n\tif (rtype == 'object') return this.frame_type == 'object';\r\n\tif (rtype == 'data') {\r\n\t\tif (frame.frame) {\r\n\t\t\treturn this.frame_type == frame.frame.ftype();\r\n\t\t}\r\n\t}\r\n\tif (rtype == 'property') return false;\r\n};\r\n\r\nFramePattern.prototype.checkLabel = function (rtype, frame) {\r\n\tif (typeof frame.getLabel !== 'function') {\r\n\t\tconsole.log(new Error('Rule passed to check label with broken renderer object - no getLabel'));\r\n\t\treturn false;\r\n\t}\r\n\treturn this.stringMatch(this.label, frame.getLabel());\r\n};\r\n\r\nFramePattern.prototype.IDsMatch = function (ida, idb) {\r\n\treturn TerminusClient.FrameHelper.compareIDs(ida, idb);\r\n};\r\n\r\nFramePattern.prototype.classIDsMatch = function (ida, idb) {\r\n\treturn this.IDsMatch(ida, idb);\r\n};\r\nFramePattern.prototype.propertyIDsMatch = function (ida, idb) {\r\n\tconst match = this.IDsMatch(ida, idb);\r\n\treturn match;\r\n};\r\nFramePattern.prototype.rangeIDsMatch = function (ida, idb) {\r\n\treturn this.IDsMatch(ida, idb);\r\n};\r\nFramePattern.prototype.valuesMatch = function (vala, valb) {\r\n\treturn vala == valb;\r\n};\r\nFramePattern.prototype.numberMatch = function (vala, valb) {\r\n\tif (typeof vala === 'string') {\r\n\t\ttry {\r\n\t\t\treturn eval(valb + vala);\r\n\t\t} catch (e) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\treturn vala === valb;\r\n};\r\n\r\nFramePattern.prototype.stringMatch = function (vala, valb) {\r\n\tconst pat = new RegExp(vala);\r\n\treturn pat.test(valb);\r\n};\r\n\r\nFramePattern.prototype.getRendererType = function (frame) {\r\n\tif (frame.isProperty()) return 'property';\r\n\tif (frame.isObject()) return 'object';\r\n\tif (frame.isData()) return 'data';\r\n\tif (frame.renderer_type) return frame.renderer_type;\r\n\tconsole.log(new Error(`frame configuration passed non-renderer type ${frame.constructor.name}`));\r\n\tconsole.log(renderer);\r\n\treturn false;\r\n};\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * FramePatternMatcher does pattern matching on frames\r\n * Does a given pattern match a given frame?\r\n */\r\nconst FramePatternMatcher = {}\r\n\r\n/**\r\n * Runs an array of matching rules across a frame and calls the passed onmatch function on each match\r\n * The optional onmatch function is called with each hit and is passed the frame and the rule that hit it.\r\n * A list of the matched rules is returned.\r\n *\r\n */\r\nFramePatternMatcher.testRules = function(rules, frame, onmatch){\r\n\tvar matched_rules = [];\r\n\tif(rules && rules.length){\r\n\t\tfor(var i = 0; i<rules.length; i++){\r\n\t\t\tvar match = (!rules[i].rule.pattern || FramePatternMatcher.patternMatchesFrame(rules[i].rule.pattern, frame));\r\n\t\t\tif(match){\r\n\t\t\t\tmatched_rules.push(rules[i]);\r\n\t\t\t\tif(onmatch && typeof onmatch == \"function\"){\r\n\t\t\t\t\tonmatch(frame, rules[i]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn matched_rules;\r\n}\r\n\r\n/**\r\n * Determines whether a given pattern matches a given frame\r\n */\r\nFramePatternMatcher.patternMatchesFrame = function(pattern, frame){\r\n\tif(typeof pattern == \"object\" && pattern.length){ //multiple patterns are ANDed\r\n\t\tfor(var i = 0 ; i<pattern.length; i++){\r\n\t\t\tvar fp = new FramePattern(pattern[i]);\r\n\t\t\tif(!fp.checkFrame(frame)) return false;\r\n\t\t}\r\n\t\treturn true;\r\n\t}\r\n\telse {\r\n\t\tvar fp = new FramePattern(pattern);\r\n\t\treturn fp.checkFrame(frame);\r\n\t}\r\n}\r\n\r\n\r\n\r\nfunction FrameRule(){\r\n\tthis.rule = { pattern: {} };\r\n\treturn this;\r\n};\r\n\r\n\r\nFrameRule.prototype.unpack = function(arr, nonstring){\r\n\tif(nonstring) var str = arr.join(\",\");\r\n\tvar str = \"'\" + arr.join(\"','\") + \"'\";\r\n\treturn str;\r\n}\r\n\r\nFrameRule.prototype.prettyPrint = function(type){\r\n\t//starts with obj. ...\r\n\tif(this.scope() == \"*\"){\r\n\t\tvar str = \"all()\";\r\n\t}\r\n\telse {\r\n\t\tvar str = this.scope() + \"()\";\r\n\t}\r\n\tif(typeof this.frameType() != \"undefined\"){\r\n\t\tstr += \".frame_type(\" + this.unpack(this.frameType()) + \")\";\r\n\t}\r\n\tif(typeof this.label() != \"undefined\"){\r\n\t\tstr += \".label(\" + this.unpack(this.label()) + \")\";\r\n\t}\r\n\tif(typeof this.subject() != \"undefined\"){\r\n\t\tstr += \".subject(\" + this.unpack(this.subject()) + \")\";\r\n\t}\r\n\tif(typeof this.subjectClass() != \"undefined\"){\r\n\t\tstr += \".subjectClass(\" + this.unpack(this.subjectClass()) + \")\";\r\n\t}\r\n\tif(typeof this.property() != \"undefined\"){\r\n\t\tstr += \".property(\" + this.unpack(this.property()) + \")\";\r\n\t}\r\n\tif(typeof this.range() != \"undefined\"){\r\n\t\tstr += \".range(\" + this.unpack(this.range()) + \")\";\r\n\t}\r\n\tif(typeof this.value() != \"undefined\"){\r\n\t\tstr += \".value(\" + this.unpack(this.value()) + \")\";\r\n\t}\r\n\tif(typeof this.children() != \"undefined\" && this.children.length > 0){\r\n\t\tstr += \".children(\\n\";\r\n\t\tvar kids = this.children();\r\n\t\tfor(var i = 0; i< kids.length; i++){\r\n\t\t\tstr += kids.prettyPrint() + \"\\n\";\r\n\t\t}\r\n\t\tstr += \")\";\r\n\t}\r\n\tif(typeof this.parent() != \"undefined\"){\r\n\t\tstr += \".parent(\" + this.parent.prettyPrint() + \")\";\r\n\t}\r\n\tif(typeof this.depth() != \"undefined\"){\r\n\t\tstr += \".depth('\" + this.depth() + \"')\";\r\n\t}\r\n\tif(typeof this.index() != \"undefined\"){\r\n\t\tstr += \".index(\" + this.unpack(this.index(), true) + \")\";\r\n\t}\r\n\tif(typeof this.status() != \"undefined\"){\r\n\t\tstr += \".status(\" + this.unpack(this.status()) + \")\";\r\n\t}\r\n\tif(typeof this.renderer() != \"undefined\"){\r\n\t\tstr += \".renderer('\" + this.renderer() + \"')\";\r\n\t}\r\n\tif(typeof this.render() != \"undefined\"){\r\n\t\tstr += \".render(\" + this.render() + \")\";\r\n\t}\r\n\tif(typeof this.compare() != \"undefined\"){\r\n\t\tstr += \".compare(\" + this.compare() + \")\";\r\n\t}\r\n\tif(typeof this.mode() != \"undefined\"){\r\n\t\tstr += \".mode('\" + this.mode() + \"')\";\r\n\t}\r\n\tif(typeof this.collapse() != \"undefined\"){\r\n\t\tstr += \".collapse(\" + this.collapse() + \")\";\r\n\t}\r\n\tif(typeof this.hidden() != \"undefined\"){\r\n\t\tstr += \".hidden(\" + this.hidden() + \")\";\r\n\t}\r\n\tif(typeof this.view() != \"undefined\"){\r\n\t\tstr += \".view('\" + this.view() + \"')\";\r\n\t}\r\n\tif(typeof this.showDisabledButtons() != \"undefined\"){\r\n\t\tstr += \".showDisabledButtons(\" + this.showDisabledButtons() + \")\";\r\n\t}\r\n\tif(typeof this.header() != \"undefined\"){\r\n\t\tstr += \".header(\" + this.header() + \")\";\r\n\t}\r\n\tif(typeof this.features() != \"undefined\"){\r\n\t\tstr += \".features(\" + this.unpack(this.features()) + \")\";\r\n\t}\r\n\tif(typeof this.headerFeatures() != \"undefined\"){\r\n\t\tstr += \".headerFeatures(\" + this.unpack(this.headerFeatures()) + \")\";\r\n\t}\r\n\tif(typeof this.showEmpty() != \"undefined\"){\r\n\t\tstr += \".showEmpty(\" + this.show_empty() + \")\";\r\n\t}\r\n\tif(typeof this.dataviewer() != \"undefined\"){\r\n\t\tstr += \".dataviewer('\" + this.dataviewer() + \"')\";\r\n\t}\r\n\tif(typeof this.args() != \"undefined\"){\r\n\t\tstr += \".args(\" + JSON.stringify(this.args()) + \")\";\r\n\t}\r\n\tif(typeof this.featureRenderers() != \"undefined\"){\r\n\t\tstr += \".featureRenderers({\";\r\n\t\tfor(var f in this.featureRenderers()){\r\n\t\t\tstr += JSON.stringify(f) + \":\" + this.rule.feature_renderers[f] + \",\";\r\n\t\t}\r\n\t\tstr = str.substring(0, str.length-1);\r\n\t\tstr += \"})\";\r\n\t}\r\n\treturn str;\r\n}\r\n\r\nFrameRule.prototype.scope = function(scope){\r\n\tif(typeof scope == \"undefined\") return this.rule.pattern.scope;\r\n\tthis.rule.pattern.scope = scope;\r\n\treturn this;\r\n};\r\n\r\nFrameRule.prototype.frameType = function(...frametype){\r\n\tif(typeof frametype == \"undefined\" || frametype.length == 0) return this.rule.pattern.frametype;\r\n\tthis.rule.pattern.frametype = frame_type;\r\n\treturn this;\r\n};\r\n\r\nFrameRule.prototype.label = function(...label){\r\n\tif(typeof label == \"undefined\" || label.length == 0) return this.rule.pattern.label;\r\n\tthis.rule.pattern.label = label;\r\n\treturn this;\r\n};\r\n\r\nFrameRule.prototype.subject = function(...subject){\r\n\tif(typeof subject == \"undefined\" || subject.length == 0) return this.rule.pattern.subject;\r\n\tthis.rule.pattern.subject = subject;\r\n\treturn this;\r\n};\r\n\r\nFrameRule.prototype.subjectClass = function(...subjectClass){\r\n\tif(typeof subjectClass == \"undefined\" || subjectClass.length == 0) return this.rule.pattern.subjectClass;\r\n\tthis.rule.pattern.subjectClass = subjectClass;\r\n\treturn this;\r\n};\r\n\r\nFrameRule.prototype.property = function(...property){\r\n\tif(typeof property == \"undefined\" || property.length == 0) return this.rule.pattern.property;\r\n\tthis.rule.pattern.property = property;\r\n\treturn this;\r\n};\r\n\r\nFrameRule.prototype.depth = function(depth){\r\n\tif(typeof depth == \"undefined\") return this.rule.pattern.depth;\r\n\tthis.rule.pattern.depth = depth;\r\n\treturn this;\r\n};\r\n\r\nFrameRule.prototype.range = function(...range){\r\n\tif(typeof range == \"undefined\" || range.length == 0) return this.rule.pattern.range;\r\n\tthis.rule.pattern.range = range;\r\n\treturn this;\r\n};\r\n\r\nFrameRule.prototype.value = function(...value){\r\n\tif(typeof value == \"undefined\" || value.length == 0) return this.rule.pattern.value;\r\n\tthis.rule.pattern.value = value;\r\n\treturn this;\r\n};\r\n\r\nFrameRule.prototype.pattern = function () {\r\n\treturn this.rule.pattern;\r\n};\r\n\r\nFrameRule.prototype.json = function(json){\r\n\tif(!json) return this.rule;\r\n\tthis.rule = json;\r\n\treturn this;\r\n}\r\n\r\nFrameRule.prototype.parent = function(parent){\r\n\tif(typeof parent == \"undefined\") return this.rule.pattern.parent;\r\n\tthis.rule.pattern.parent = parent.pattern();\r\n\treturn this;\r\n};\r\n\r\nFrameRule.prototype.children = function(...children){\r\n\tif(typeof children == \"undefined\") return this.rule.pattern.children;\r\n\tif(typeof this.rule.pattern.children == \"undefined\"){\r\n\t\tthis.rule.pattern.children = [];\r\n\t}\r\n\tfor (let i = 0; i < children.length; i++) {\r\n\t\tthis.rule.pattern.children.push(children[i].pattern());\r\n\t}\r\n\treturn this;\r\n};\r\n\r\nFrameRule.prototype.index = function(...index){\r\n\tif(typeof index == \"undefined\" || index.length == 0) return this.rule.pattern.index;\r\n\tthis.rule.pattern.index = index;\r\n\treturn this;\r\n};\r\n\r\nFrameRule.prototype.status = function(...status){\r\n\tif(typeof status == \"undefined\" || status.length == 0) return this.rule.pattern.status;\r\n\tthis.rule.pattern.status = status;\r\n\treturn this;\r\n};\r\n\r\nFrameRule.prototype.renderer = function(rend){\r\n\tif(!rend) return this.rule.renderer;\r\n\tthis.rule.renderer = rend;\r\n\treturn this;\r\n}\r\n\r\nFrameRule.prototype.render = function(func){\r\n\tif(func){\r\n\t\tthis.rule.render = func;\r\n\t\treturn this;\r\n\t}\r\n\treturn func;\r\n}\r\n\r\nFrameRule.prototype.args = function(json){\r\n\tif(!json) return this.rule.args;\r\n\tthis.rule.args = json;\r\n\treturn this;\r\n}\r\n\r\nFrameRule.prototype.compare = function(func){\r\n\tif(!func) return this.rule.compare;\r\n\tthis.rule.compare = func;\r\n\treturn this;\r\n}\r\n\r\nFrameRule.prototype.mode = function(m){\r\n\tif(!m) return this.rule.mode;\r\n\tthis.rule.mode = m;\r\n\treturn this;\r\n}\r\n\r\nFrameRule.prototype.collapse = function(m){\r\n\tif(!m) return this.rule.collapse;\r\n\tthis.rule.collapse = m;\r\n\treturn this;\r\n}\r\n\r\n\r\nFrameRule.prototype.hidden = function(m){\r\n\tif(!m) return this.rule.hidden;\r\n\tthis.rule.hidden = m;\r\n\treturn this;\r\n}\r\n\r\nFrameRule.prototype.view = function(m){\r\n\tif(!m) return this.rule.view;\r\n\tthis.rule.view = m;\r\n\treturn this;\r\n}\r\n\r\nFrameRule.prototype.showDisabledButtons = function(m){\r\n\tif(!m) return this.rule.show_disabled_buttons;\r\n\tthis.rule.show_disabled_buttons = m;\r\n\treturn this;\r\n}\r\n\r\nFrameRule.prototype.features = function(...m){\r\n\tif(typeof m == \"undefined\" || m.length == 0) return this.rule.features;\r\n\tthis.rule.features = m;\r\n\treturn this;\r\n}\r\n\r\nFrameRule.prototype.headerFeatures = function(...m){\r\n\tif(typeof m == \"undefined\" || m.length == 0) return this.rule.header_features;\r\n\tthis.rule.header_features = m;\r\n\treturn this;\r\n}\r\n\r\nFrameRule.prototype.header = function(m){\r\n\tif(!m) return this.rule.header;\r\n\tthis.rule.header = m;\r\n\treturn this;\r\n}\r\n\r\nFrameRule.prototype.featureRenderers = function(m){\r\n\tif(!m) return this.rule.feature_renderers;\r\n\tthis.rule.feature_renderers = m;\r\n\treturn this;\r\n}\r\n\r\nFrameRule.prototype.showEmpty = function(m){\r\n\tif(!m) return this.rule.show_empty;\r\n\tthis.rule.show_empty = m;\r\n\treturn this;\r\n}\r\n\r\nFrameRule.prototype.dataviewer = function(m){\r\n\tif(!m) return this.rule.dataviewer;\r\n\tthis.rule.dataviewer = m;\r\n\treturn this;\r\n}\r\n\r\nmodule.exports = {FramePatternMatcher, FramePattern, FrameRule } ;\r\n","const WOQLQuery = require('./client/WOQLQuery');\r\nconst Renderers = require('./client/ObjectRenderer');\r\nconst HTMLFrameHelper = require('./html/HTMLFrameHelper');\r\nconst TerminusDBViewer = require('./TerminusDB');\r\n//const TerminusHTMLViewer = require('./TerminusHTMLViewer');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\nconst UTILS=require('./Utils');\r\n\r\nfunction TerminusDocumentViewer(ui, action, options){\r\n\tthis.ui = ui;\r\n\tthis.server = this.ui.server();\r\n\tthis.db = this.ui.db();\r\n\tthis.init();\r\n\tthis.page_config = (options && options.page_config ? options.page_config : \"view\");\r\n\tthis.mode = (options && options.mode ? options.mode : \"view\");\r\n\tthis.editor = (options && options.editor ? options.editor : false);\r\n\tthis.load_schema = (options && options.load_schema ? options.load_schema : true);\r\n\tthis.config_options = this.getBuiltInViewerOptions();\r\n\tthis.options = (options ? options : this.config_options[action]);\r\n\tthis.action = action;\r\n\tthis.document = false;\r\n\tthis.dbViewer = new TerminusDBViewer.TerminusDBViewer(this.ui);\r\n}\r\n\r\nTerminusDocumentViewer.prototype.init = function(){\r\n\tconst tbv = new TerminusDBViewer.TerminusDBViewer(this.ui);\r\n\tvar wq = new WOQLQuery(this.ui.client, this.options, this.ui);\r\n\tvar woql = wq.getClassMetaDataQuery();\r\n\tvar self = this;\r\n\tself.classmeta = {};\r\n\tself.instancemeta = {};\r\n\twq.execute(woql).then(function(wresult){\r\n\t\tif(wresult && wresult.hasBindings()){\r\n\t\t\tfor(var i = 0; i<wresult.bindings.length; i++){\r\n\t\t\t\tvar cls = HTMLFrameHelper.getVariableValueFromBinding(\"Element\", wresult.bindings[i]);\r\n\t\t\t\tif(cls && typeof self.classmeta[cls] == \"undefined\"){\r\n\t\t\t\t\tself.classmeta[cls] = wresult.bindings[i];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tself.refreshPage();\r\n\t\t}\r\n\t})\r\n\t.catch(function(e){\r\n\t\tconsole.log(e);\r\n\t});\r\n}\r\n\r\nTerminusDocumentViewer.prototype.getJsonLdViewer = function(){\r\n\tswitch(this.page_config){\r\n\t\tcase 'view':\r\n\t\t\tvar self = this;\r\n\t\t\tthis.ui.client.getDocument()\r\n\t\t\t.then(function(response){\r\n\t\t\t\tself.ui.clearBusy();\r\n\t\t\t    TerminusClient.FrameHelper.removeChildren(self.pagedom);\r\n\t\t\t\tvar label = response['@id']; // get doc id\r\n\t\t\t\tvar header = document.createElement('div');\r\n\t\t\t\theader.setAttribute('class', 'terminus-application-header');\r\n\t\t\t\theader.appendChild(document.createTextNode('jsonld format of ' + label));\r\n\t\t\t\tself.pagedom.appendChild(header);\r\n\t\t\t    var res = document.createElement('pre');\r\n\t\t\t\tself.document_json_response = response;\r\n\t\t\t\tres.innerHTML = JSON.stringify(response, undefined, 2);\r\n\t\t\t    res.setAttribute('class', 'terminus-api-explorer-text-area');\r\n\t\t\t\tUTILS.stylizeCodeDisplay(self.ui, res, self.pagedom, 'javascript');\r\n\t\t\t})\r\n\t\t\t.catch(function(e){\r\n\t\t\t\tself.ui.clearBusy();\r\n\t\t\t\tthrow(e);\r\n\t\t\t});\r\n\t\tbreak;\r\n\t\tcase 'create':\r\n\t\t\tTerminusClient.FrameHelper.removeChildren(this.pagedom);\r\n\t\t\tvar header = document.createElement('div');\r\n\t\t\theader.setAttribute('class', 'terminus-application-header');\r\n\t\t \tvar ohv = new ObjectViewer.HTMLObjectHeaderViewer();\r\n\t\t\theader.appendChild(ohv.getObjectIDDOM(this.renderer));\r\n\t\t\t//header.appendChild(document.createTextNode('Create new document in jsonld format'));\r\n\t\t\theader.appendChild(this.getDocumentJsonldCreateButton());\r\n\t\t\tthis.pagedom.appendChild(header);\r\n\t\t\tvar res = document.createElement('textarea');\r\n\t\t\tthis.json_editor = res;\r\n\t\t\tthis.pagedom.appendChild(res);\r\n\t\t\tres.setAttribute('class', 'terminus-api-explorer-text-area');\r\n\t\t\tUTILS.stylizeEditor(this.ui, res, 'doc-json-create', 'javascript');\r\n\t\t\tbreak;\r\n\t}\r\n}\r\n\r\nTerminusDocumentViewer.prototype.getEncodingChooserDOM = function() {\r\n\tvar scd = document.createElement(\"div\");\r\n\tscd.setAttribute(\"class\", \"terminus-document-creator terminus-form-horizontal terminus-control-group\");\r\n\tvar nbuts = document.createElement(\"div\");\r\n\tnbuts.setAttribute(\"class\", \"terminus-control-buttons terminus-document-creator-buttons\");\r\n\tvar enc = document.createElement('select');\r\n\tenc.setAttribute('class', 'terminus-doc-config terminus-enc');\r\n\tvar oframe = document.createElement('option');\r\n\toframe.setAttribute('value', 'frame');\r\n\toframe.appendChild(document.createTextNode('HTML'));\r\n\tenc.appendChild(oframe);\r\n\tvar ojson = document.createElement('option');\r\n\tojson.setAttribute('value', 'jsonld');\r\n\tojson.appendChild(document.createTextNode('JSON-LD'));\r\n\tenc.appendChild(ojson);\r\n\tnbuts.appendChild(enc);\r\n\tvar self = this;\r\n\tenc.addEventListener('change', function(e){\r\n\t\tself.viewMode = this.value;\r\n\t\tswitch(self.page_config){\r\n\t\t\tcase 'view':\r\n\t\t\t\tself.page_config = 'view';\r\n\t\t\t\tif(this.value == 'frame'){\r\n\t\t\t\t\tself.renderer = false;\r\n\t\t\t\t\tself.refreshPage();\r\n\t\t\t\t}\r\n\t\t\t\telse self.getJsonLdViewer();\r\n\t\t\tbreak;\r\n\t\t\tcase 'create':\r\n\t\t\t\tself.page_config = 'create';\r\n\t\t\t\tif(this.value == 'frame'){\r\n\t\t\t\t\tself.renderer = false;\r\n\t\t\t\t\tself.refreshPage();\r\n\t\t\t\t}\r\n\t\t\t\telse self.getJsonLdViewer();\r\n\t\t\tbreak;\r\n\t\t}\r\n\t})\r\n\tvar ccDOM = document.createElement(\"span\");\r\n\tccDOM.setAttribute(\"class\", \"create-document-list\");\r\n\tccDOM.appendChild(nbuts);\r\n\tscd.appendChild(ccDOM);\r\n\treturn scd;\r\n}\r\n/*\r\nTerminusDocumentViewer.prototype.getDocumentChooserDOM = function(holder){\r\n\tvar self = this;\r\n\tvar scd = document.createElement(\"span\");\r\n\tscd.setAttribute(\"class\", \"terminus-get-doc terminus-document-chooser terminus-form-horizontal terminus-control-group\");\r\n\tvar lab = document.createElement(\"span\");\r\n\tlab.setAttribute(\"class\", \"terminus-document-chooser-label terminus-doc-control-label terminus-control-label-padding\");\r\n\tvar dcip = document.createElement(\"input\");\r\n\tdcip.setAttribute(\"class\", \"terminus-form-doc-value terminus-document-chooser terminus-doc-input-text\");\r\n\tdcip.setAttribute(\"placeholder\", \"doc:myDocId\");\r\n\tvar nbut = document.createElement(\"button\");\r\n\tnbut.setAttribute('class', \"terminus-control-button terminus-document-button terminus-btn\");\r\n\tnbut.appendChild(document.createTextNode('View'));\r\n\tnbut.addEventListener(\"click\", function(){\r\n\t\tif(dcip.value) {\r\n\t\t\tself.ui.showDocument(dcip.value);\r\n\t\t}\r\n\t})\r\n\tif(this.ui.client.connectionConfig.platformEndpoint() && this.ui.pluginAvailable(\"select2\")){\r\n\t\tvar mcls = TerminusClient.FrameHelper.unshorten(\"tcs:Document\");\r\n\t\tvar d2ch = new TerminusDocumentChooser(this.ui, mcls);\r\n\t\td2ch.change = function(val){\r\n\t\t\tself.ui.showDocument(val);\r\n\t\t}\r\n\t\td2ch.view = \"label\";\r\n\t\tvar sdom = d2ch.getAsDOM('terminus-class-select');\r\n\t\tjQuery(dcip).hide();\r\n\t\tjQuery(nbut).hide();\r\n\t\tvar nlab = document.createElement(\"a\");\r\n\t\tnlab.setAttribute(\"href\", \"#\");\r\n\t\tnlab.setAttribute(\"class\", \"terminus-document-which-chooser\");\r\n\t\tnlab.appendChild(document.createTextNode(\"Choose by ID\"));\r\n\t\tvar show = \"label\";\r\n\t\tjQuery(nlab).click(function(){\r\n\t\t\tif(show == \"label\"){\r\n\t\t\t\tshow = \"id\";\r\n\t\t\t\tjQuery(dcip).show();\r\n\t\t\t\tjQuery(nbut).show();\r\n\t\t\t\tjQuery(sdom).hide();\r\n\t\t\t\tjQuery(nlab).text(\"Choose by Label\");\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tshow = \"label\";\r\n\t\t\t\tjQuery(dcip).hide();\r\n\t\t\t\tjQuery(nbut).hide();\r\n\t\t\t\tjQuery(sdom).show();\r\n\t\t\t\tjQuery(nlab).text(\"Choose by ID\");\r\n\t\t\t}\r\n\t\t})\r\n\t\tscd.appendChild(sdom);\r\n\t\tscd.prepend(nlab);\r\n\t}\r\n\tvar nbuts = document.createElement(\"span\");\r\n\tnbuts.setAttribute(\"class\", \"terminus-control-buttons terminus-document-chooser-buttons\");\r\n\tnbuts.appendChild(nbut);\r\n\tscd.appendChild(lab);\r\n\tscd.appendChild(dcip);\r\n\tscd.appendChild(nbuts);\r\n\tholder.appendChild(scd);\r\n};\r\n*/\r\n\r\nTerminusDocumentViewer.prototype.getDocumentInput = function(d){\r\n\tvar span = document.createElement('div');\r\n\tspan.setAttribute('class', 'terminus-display-flex')\r\n\tvar inp = document.createElement('input');\r\n\tinp.setAttribute('class', 'terminus-form-doc-value terminus-document-chooser terminus-doc-input-text');\r\n\tinp.setAttribute('placeholder', 'doc:myDocId');\r\n\tvar vbtn = document.createElement('button');\r\n\tvbtn.appendChild(document.createTextNode('Create'));\r\n\tvbtn.setAttribute('class', 'terminus-control-button terminus-document-button terminus-btn');\r\n\tvbtn.addEventListener('click', function(){\r\n\t\tif(this.value) self.ui.showDocument(this.value);\r\n\t})\r\n\tspan.appendChild(inp);\r\n\tspan.appendChild(vbtn);\r\n\td.appendChild(span);\r\n}\r\n\r\nTerminusDocumentViewer.prototype.showCreateDocument = function(dType){\r\n\tthis.ui.showCreateDocument(dType);\r\n}\r\n\r\nTerminusDocumentViewer.prototype.styleCreateDocumentChooser = function(){\r\n\tvar select = document.getElementsByClassName('woql-chooser');\r\n\tfor(i=0; i<select.length; i++){\r\n\t\tif(select[i].type == 'select-one'){\r\n\t\t\tselect[i].classList.add('terminus-form-doc-value');\r\n\t\t\tvar self = this;\r\n\t\t\tselect[i].addEventListener('change', function(){\r\n\t\t\t\tself.showCreateDocument(this.value);\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n}\r\n\r\nTerminusDocumentViewer.prototype.getCreateDocumentButton = function(d){\r\n\tvar cbtn = document.createElement('button');\r\n\tcbtn.setAttribute('class', 'terminus-btn');\r\n\tcbtn.appendChild(document.createTextNode('Create'));\r\n\tvar self = this;\r\n\tcbtn.addEventListener(\"click\", function(){\r\n\t\tif(this.value) self.ui.showCreateDocument(this.value);\r\n\t})\r\n\td.appendChild(cbtn);\r\n}\r\n\r\nTerminusDocumentViewer.prototype.getDocumentCreatorSelect = function(d){\r\n\tlet nq = new TerminusHTMLViewer(this.ui.client);\r\n\tlet WOQL = TerminusClient.WOQL;\r\n\tlet query = WOQL.from(this.ui.client.connectionConfig.dbURL())\r\n\t\t\t\t\t.start(0)\r\n\t\t\t\t\t.concreteClass();\r\n    var self = this;\r\n\tquery.execute(this.ui.client).then((results) => {\r\n\t\tlet qres = new TerminusClient.WOQLResult(results, query);\r\n\t\tvar phr = 'Create Document of Type';\r\n\t\tvar n = nq.showResult(qres, WOQL.chooser().show_empty(phr), false);\r\n\t\td.appendChild(n);\r\n\t\tself.styleCreateDocumentChooser();\r\n\t\tself.getCreateDocumentButton(d);\r\n\t});\r\n}\r\n\r\nTerminusDocumentViewer.prototype.getDocumentCreatorDOM = function(dom){\r\n\tvar span = document.createElement('span');\r\n\tspan.setAttribute('class', 'terminus-display-flex terminus-create-document-align');\r\n\tthis.getDocumentCreatorSelect(span);\r\n\tdom.appendChild(span);\r\n}\r\n\r\nTerminusDocumentViewer.prototype.getListOfDocuments = function(){\r\n\tthis.dbViewer.getClassesDOM(this.controldom);\r\n}\r\n\r\nTerminusDocumentViewer.prototype.loadDocumentHome = function(){\r\n\tvar controls = document.createElement('span');\r\n\tcontrols.setAttribute('class', 'terminus-display-flex');\r\n\tthis.controldom.appendChild(controls);\r\n\tif(this.ui.showControl(\"get_document\")){\r\n\t\tthis.getDocumentInput(controls);\r\n\t\tthis.getListOfDocuments();\r\n\t}\r\n    if(this.ui.showControl(\"create_document\"))\r\n\t\tthis.getDocumentCreatorDOM(controls);\r\n}\r\n\r\nTerminusDocumentViewer.prototype.styleToggleSwitch = function(btn){\r\n\tbtn.classList.remove('terminus-btn');\r\n\tbtn.classList.add('terminus-doc-btn-group');\r\n}\r\n\r\nTerminusDocumentViewer.prototype.getFormatButtons = function(){\r\n\t var span = document.createElement('span');\r\n\t span.setAttribute('class', 'terminus-display-flex terminus-format-button-align');\r\n\t var hbtn = span.appendChild(UTILS.getButton('HTML'));\r\n\t var jbtn = UTILS.getButton('JSON-LD');\r\n\t this.styleToggleSwitch(hbtn);\r\n\t this.styleToggleSwitch(jbtn);\r\n\t hbtn.classList.add('terminus-doc-btn-selected'); // default view is HTML\r\n\t this.format = 'HTML';\r\n\t span.appendChild(hbtn);\r\n\t span.appendChild(jbtn);\r\n\t var self = this;\r\n\t hbtn.addEventListener('click', function(){\r\n\t\t self.format = this.value;\r\n\t })\r\n\t jbtn.addEventListener('click', function(){\r\n\t\t self.format = this.value;\r\n\t })\r\n\t return span;\r\n }\r\n\r\nTerminusDocumentViewer.prototype.getAsDOM = function(){\r\n\tthis.holder = document.createElement(\"div\");\r\n\tthis.controldom = document.createElement(\"div\");\r\n\tthis.controldom.setAttribute(\"class\", \"terminus-document-controls\");\r\n\tthis.holder.appendChild(this.getFormatButtons());\r\n\tthis.pagedom = document.createElement(\"div\");\r\n\tthis.pagedom.setAttribute(\"class\", \"terminus-document-viewer\");\r\n\tthis.loadDocumentHome();\r\n\tthis.holder.appendChild(this.controldom);\r\n\tthis.holder.appendChild(this.pagedom);\r\n\treturn this.holder;\r\n}\r\n\r\nTerminusDocumentViewer.prototype.getInstanceMeta = function(elid){\r\n\tvar self = this;\r\n\tif(self.instancemeta && typeof self.instancemeta[elid] != \"undefined\") return self.instancemeta[elid] ;\r\n\tvar wq = new WOQLQuery(this.ui.client, this.options, this.ui);\r\n\tvar woql = wq.getInstanceMeta(elid);\r\n\treturn wq.execute(woql).then(function(wresult){\r\n\t\tif(wresult && wresult.hasBindings()){\r\n\t\t\tvar res = wresult.bindings[0];\r\n\t\t\treturn res;\r\n\t\t}\r\n\t\treturn false;\r\n\t})\r\n\t.catch(function(e){\r\n\t\tconsole.log(e);\r\n\t});\r\n}\r\n\r\nTerminusDocumentViewer.prototype.getClassMeta = function(cls){\r\n\tif(typeof this.classmeta[cls]){\r\n\t\treturn this.classmeta[cls];\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nTerminusDocumentViewer.prototype.loadCreateDocument = function(url){\r\n\tif(url){\r\n\t\tthis.ui.showBusy(\"Fetching frame for document class \" + url);\r\n\t\tvar self = this;\r\n\t\tthis.mode = \"edit\";\r\n\t\tthis.page_config = \"create\";\r\n\t\tif(url.indexOf(\"/\") == -1 && url.indexOf(\":\") == -1) {\r\n\t\t\turl = \"schema:\" + url;\r\n\t\t}\r\n\t\treturn this.loadDocumentSchema(url)\r\n\t\t.then(function(response){\r\n\t\t\tself.ui.clearBusy();\r\n\t\t\tself.setLabel();\r\n\t\t})\r\n\t\t.catch(function(error) {\r\n\t\t\tconsole.error(error);\r\n\t\t\tself.ui.clearBusy();\r\n\t\t\tself.ui.showError(error);\r\n\t\t});\r\n\t}\r\n}\r\n\r\nTerminusDocumentViewer.prototype.loadDocument = function(url, cls){\r\n\tif(!url) return false;\r\n\tvar self = this;\r\n\tif(url.substring(0,4) == \"doc:\"){\r\n\t\turl = url.substring(4);\r\n\t}\r\n\tthis.page_config = \"view\";\r\n\turl = url.replace(\"/candidate\", \"/platform/document\");\r\n\tthis.ui.showBusy(\"Loading Document from \" + url);\r\n\treturn this.ui.client.getDocument(url, {\"terminus:encoding\": \"terminus:frame\"})\r\n\t.then(function(response){\r\n\t\tself.ui.clearBusy();\r\n\t\tself.loadDataFrames(response);\r\n\t\tself.setLabel();\r\n\t\tself.refreshPage();\r\n\t\tif(self.load_schema){\r\n\t\t\tself.loadDocumentSchema(self.document.cls).then(function(){ self.refreshPage()}).catch(function(e){console.error(e)});\r\n\t\t}\r\n\t\treturn response;\r\n\t})\r\n\t.catch(function(error) {\r\n\t\tconsole.error(error);\r\n\t\tself.ui.clearBusy();\r\n\t\tself.ui.showError(error);\r\n\t});\r\n}\r\n\r\nTerminusDocumentViewer.prototype.loadDocumentSchema = function(cls){\r\n\tvar self = this;\r\n\tvar ncls = TerminusClient.FrameHelper.unshorten(cls);\r\n\treturn this.ui.client.getClassFrame(false, ncls)\r\n\t.then(function(response){\r\n\t\tself.loadSchemaFrames(response, cls);\r\n\t\tself.refreshPage();\r\n\t});\r\n}\r\n\r\nTerminusDocumentViewer.prototype.deleteDocument = function(URL){\r\n\tthis.document = false;\r\n\tvar self = this;\r\n\tthis.ui.showBusy(\"Deleting Document \" + URL);\r\n\treturn this.ui.client.deleteDocument(URL)\r\n\t.then(function(response){\r\n\t\tself.ui.clearBusy();\r\n\t}).catch(function(error){\r\n\t\tself.ui.clearBusy();\r\n\t\tself.ui.showError(error);\r\n\t});\r\n}\r\n\r\nTerminusDocumentViewer.prototype.createDocument = function(id, extr){\r\n\tvar self = this;\r\n\tvar opts = { \"terminus:encoding\": \"jsonld\" };\r\n\tthis.ui.showBusy(\"Creating document\");\r\n\treturn this.ui.client.createDocument(id, extr, opts)\r\n\t.then(function(response){\r\n\t\tself.ui.clearBusy();\r\n\t\tself.ui.showDocument(id);\r\n\t}).catch(function(error){\r\n\t\tself.ui.clearBusy();\r\n\t\tif(error.data && error.data['terminus:witnesses']){\r\n\t\t\tself.ui.showViolations(error.data['terminus:witnesses'], \"instance\");\r\n\t\t}\r\n\t\telse {\r\n\t\t\tself.ui.showError(error);\r\n\t\t}\r\n\t\tself.page_config = 'home';\r\n\t\treturn self.page_config;\r\n\t});\r\n}\r\n\r\nTerminusDocumentViewer.prototype.updateDocument = function(extr){\r\n\tvar durl = this.document.subjid;\r\n\tvar self = this;\r\n\tvar opts = { \"terminus:encoding\": \"jsonld\" };\r\n\tthis.ui.showBusy(\"Updating document \" + durl);\r\n\treturn this.ui.client.updateDocument(durl, extr, opts)\r\n\t.then(function(response){\r\n\t\tself.ui.clearBusy();\r\n\t\tself.ui.showDocument(durl);\r\n\t}).catch(function(error){\r\n\t\tself.ui.clearBusy();\r\n\t\tif(error.data && error.data['terminus:witnesses']){\r\n\t\t\tself.ui.showViolations(error.data['terminus:witnesses'], \"instance\");\r\n\t\t}\r\n\t\telse {\r\n\t\t\tself.ui.showError(error);\r\n\t\t}\r\n\t});\r\n}\r\n\r\nTerminusDocumentViewer.prototype.loadDataFrames = function(dataframes, cls){\r\n\tif(!cls){\r\n\t\tif(this.document) cls = this.document.cls;\r\n\t\telse {\r\n\t\t\tif(dataframes && dataframes.length && dataframes[0] && dataframes[0].domain){\r\n\t\t\t\tcls = dataframes[0].domain;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tif(cls){\r\n\t\tif(!this.document){\r\n\t\t\tthis.document = new TerminusClient.ObjectFrame(cls, dataframes);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.document.loadDataFrames(dataframes);\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tconsole.log(\"Missing Class\" + \" \" + \"Failed to add dataframes due to missing class\");\r\n\t}\r\n}\r\n\r\n\r\nTerminusDocumentViewer.prototype.loadSchemaFrames = function(classframes, cls){\r\n\tif(!cls){\r\n\t\tif(classframes && classframes.length && classframes[0] && classframes[0].domain){\r\n\t\t\tcls = classframes[0].domain;\r\n\t\t}\r\n\t}\r\n\tif(cls){\r\n\t\tif(!this.document){\r\n\t\t\tthis.document = new TerminusClient.ObjectFrame(cls);\r\n\t\t}\r\n\t\tif(classframes){\r\n\t\t\tthis.document.loadClassFrames(classframes);\r\n\t\t\tif(!this.document.subjid){\r\n\t\t\t\tthis.document.newDoc = true;\r\n\t\t\t\tthis.document.fillFromSchema(\"_:\");\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tconsole.log(\"Missing Class\", \"Failed to add class frames due to missing class\");\r\n\t}\r\n}\r\n\r\nTerminusDocumentViewer.prototype.render = function(){\r\n\tif(!this.renderer && this.document){\r\n\t\tif(this.page_config){\r\n\t\t\tthis.options = this.getOptionsFromPageConfig(this.page_config);\r\n\t\t}\r\n\t\ttry{\r\n\t\t\tthis.renderer = new Renderers.ObjectRenderer(this.document, false, this.options);\r\n\t\t\tthis.renderer.mode = this.mode;\r\n\t\t\tthis.renderer.controller = this;\r\n\t\t}catch(e){\r\n\t \t\tconsole.error('TerminusDocumentViewer render',e.toString())\r\n\t \t}\r\n\t}\r\n\tif(this.renderer){\r\n\t\treturn this.renderer.render();\r\n\t}\r\n}\r\n\r\nTerminusDocumentViewer.prototype.getBuiltInViewerOptions = function(){\r\n\treturn FrameConfig;\r\n}\r\n\r\nTerminusDocumentViewer.prototype.getOptionsFromPageConfig = function(pageconf){\r\n\tif(typeof this.config_options[pageconf] == \"object\") {\r\n\t\treturn this.config_options[pageconf];\r\n\t}\r\n\treturn this.options;\r\n}\r\n\r\n\r\nTerminusDocumentViewer.prototype.getClient = function(){\r\n\treturn this.ui.client;\r\n}\r\n\r\nTerminusDocumentViewer.prototype.extract = function(options){\r\n\treturn this.renderer.extract();\r\n}\r\n\r\nTerminusDocumentViewer.prototype.getLabel = function(){\r\n\tvar lab = (this.cls ? this.cls : false);\r\n\tif(!lab) lab = (this.docid ? this.docid : \"Void\");\r\n\treturn lab;\r\n}\r\n\r\nTerminusDocumentViewer.prototype.setLabel = function(){\r\n\tif(this.document && this.labdom){\r\n\t\tTerminusClient.FrameHelper.removeChildren(this.labdom);\r\n\t\tvar dfs = this.document.getDataFrames(TerminusClient.FrameHelper.getStdURL(\"rdfs\", \"label\"));\r\n\t\tfor(var i = 0; i< dfs.length; i++){\r\n\t\t\tvar lab = dfs[i].get();\r\n\t\t\tif(lab) {\r\n\t\t\t\tthis.labdom.appendChild(document.createTextNode(lab));\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\nTerminusDocumentViewer.prototype.refreshPage = function(){\r\n\tif(this.pagedom){\r\n\t\tTerminusClient.FrameHelper.removeChildren(this.pagedom);\r\n\t\tvar rends = this.render();\r\n\t\tif(rends){\r\n\t\t\tthis.pagedom.appendChild(rends);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nTerminusDocumentViewer.prototype.getDocumentPageControls = function(){\r\n\tvar dpc = document.createElement(\"select\");\r\n\tdpc.setAttribute(\"class\", \"terminus-form-select terminus-document-config\");\r\n\tfor(var i in this.config_options){\r\n\t\tif(i === 'create') continue; // create docuemnt option from config is not taken in edit mode\r\n\t\tvar opt = document.createElement(\"option\");\r\n\t\topt.value = i;\r\n\t\tif(this.page_config == i){\r\n\t\t\topt.selected = true;\r\n\t\t}\r\n\t\topt.appendChild(document.createTextNode(this.config_options[i].label));\r\n\t\tdpc.appendChild(opt);\r\n\t}\r\n\tvar self = this;\r\n\tdpc.addEventListener(\"change\", function(){\r\n\t\tself.page_config = this.value;\r\n\t\tself.renderer = false;\r\n\t\tself.refreshPage();\r\n\t})\r\n\treturn dpc;\r\n}\r\n\r\nmodule.exports=TerminusDocumentViewer\r\n","const WOQLResult = require('./WOQLResultsViewer');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\nfunction WOQLQuery(client, options, ui){\r\n\tthis.client = client;\r\n\tthis.options = options;\r\n\tthis.ui = ui;\r\n\tthis.default_limit = 1000;\r\n\tthis.prefixes = {};\r\n\tif(client.connectionConfig.platformEndpoint()){\r\n\t\tvar sid = client.connectionConfig.server.substring(0, client.connectionConfig.server.lastIndexOf(\"platform\"));\r\n\t\tthis.sid = sid;\r\n\t\tvar colid = client.connectionConfig.server.substring(0, client.connectionConfig.server.lastIndexOf(\"platform\")) + client.connectionConfig.dbid;\r\n\t\tthis.prefixes['s'] = colid + \"/ontology/main#\";\r\n\t\tthis.prefixes['g'] = sid;\r\n\t\tthis.prefixes['db'] = colid + \"/\";\r\n\t\tthis.prefixes['doc'] = colid + \"/candidate/\";\r\n\t\tthis.prefixes['dg'] = colid + \"/graph/main/\";\r\n\t}\r\n\telse {\r\n\t\tthis.sid = client.connectionConfig.serverURL();\r\n\t\tthis.prefixes['s'] = client.connectionConfig.schemaURL() + \"#\";\r\n\t\tthis.prefixes['dg'] = client.connectionConfig.dbURL() + \"/schema\";\r\n\t\tthis.prefixes['doc'] = client.connectionConfig.docURL();\r\n\t\tthis.prefixes['db'] = client.connectionConfig.dbURL() + \"/\";\r\n\t\tthis.prefixes['g'] = client.connectionConfig.serverURL();\r\n\t}\r\n\tfor(var pref in TerminusClient.FrameHelper.standard_urls){\r\n\t\tthis.prefixes[pref] = TerminusClient.FrameHelper.standard_urls[pref];\r\n\t}\r\n}\r\n\r\nWOQLQuery.prototype.setPrefixes = function(prefixes){\r\n\tthis.prefixes = prefixes;\r\n}\r\n\r\n\r\nWOQLQuery.prototype.shorten = function(url){\r\n\tfor(var pref in this.prefixes){\r\n\t\tif(this.prefixes[pref] == url.substring(0, this.prefixes[pref].length)){\r\n\t\t\treturn ( pref + \":\" + url.substring(this.prefixes[pref].length));\r\n\t\t}\r\n\t}\r\n\treturn url;\r\n}\r\n\r\nWOQLQuery.prototype.execute = function(woql){\r\n\tvar wrapped = this.wrap(woql);\r\n\tvar self = this;\r\n\treturn this.client.select(false, wrapped)\r\n\t.then(function(response){\r\n\t\tvar res = new WOQLResult.WOQLResult(response, self, self.options, self.ui);\r\n\t\treturn res;\r\n\t});\r\n}\r\n\r\nWOQLQuery.prototype.wrap = function(woql){\r\n\tvar wjson = {\r\n\t\t\"@context\" : this.prefixes,\r\n\t\t\"from\": [\r\n\t\t\tthis.client.connectionConfig.dbURL(),\r\n\t\t\twoql\r\n\t\t]\r\n\t};\r\n\treturn wjson;\r\n}\r\n\r\nWOQLQuery.prototype.getConcreteDocumentClassPattern = function(varc){\r\n\tvar varc = varc || \"v:Class\";\r\n\tvar pat = {\r\n\t\tand: [\r\n\t\t\tthis.getSubclassQueryPattern(varc, \"tcs:Document\"),\r\n\t\t\t{\r\n\t\t\t\tnot: [this.getAbstractQueryPattern(varc)]\r\n\t\t\t}\r\n\t\t]\r\n\t}\r\n\treturn pat;\r\n}\r\n\r\nWOQLQuery.prototype.getAbstractQueryPattern = function(varname){\r\n\tvar qp = {\r\n\t\tquad: [varname, \"tcs:tag\", \"tcs:abstract\", \"db:schema\"]\r\n\t}\r\n\treturn qp;\r\n}\r\n\r\nWOQLQuery.prototype.getSubclassQueryPattern = function(varname, clsname){\r\n\tvar sqp = {sub: [varname, clsname]};\r\n\treturn sqp;\r\n}\r\n\r\nWOQLQuery.prototype.queryWrappedWithLimit = function(query, limit, start){\r\n\tlimit = limit ? limit : this.default_limit ;\r\n\tstart = start ? start : 0;\r\n\tvar wjson = {\r\n\t\tlimit: [limit, {\r\n\t\t\tstart: [start, query]\r\n\t\t}]\r\n\t};\r\n\treturn wjson;\r\n}\r\n\r\n//getAllDocuments\r\nWOQLQuery.prototype.getAllDocumentQuery = function(constraint, limit, start){\r\n\tvar query = {\r\n\t\tand: [\r\n\t\t\t{\r\n\t\t\t\ttriple: [\"v:Document\", \"rdf:type\", \"v:Type\"]\r\n\t\t\t},\r\n\t\t\tthis.getSubclassQueryPattern(\"v:Type\", \"tcs:Document\")\r\n\t\t]\r\n\t}\r\n\tif(constraint){\r\n\t\tquery.and.push(constraint);\r\n\t}\r\n\treturn this.queryWrappedWithLimit(query, limit, start);\r\n}\r\n\r\n//getEverything\r\nWOQLQuery.prototype.getEverythingQuery = function(constraint, limit, start){\r\n\tvar wjson = {triple: [\"v:Subject\", \"v:Predicate\", \"v:Object\"]};\r\n\tif(constraint){\r\n\t\twjson = {and: [wjson, constraint]};\r\n\t}\r\n\treturn this.queryWrappedWithLimit(wjson, limit, start);\r\n}\r\n\r\n// propertyMetadata\r\nWOQLQuery.prototype.getPropertyListQuery = function(constraint, limit, start){\r\n\tvar wjson = {\r\n\t\tand: [{quad: [\"v:Property\", \"rdfs:range\", \"v:Range\", \"db:schema\"]},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Property\", \"rdf:type\", \"v:Type\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Property\", \"rdfs:label\", \"v:Label\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Property\", \"rdfs:comment\", \"v:Comment\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Property\", \"rdfs:domain\", \"v:Domain\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t]\r\n\t}\r\n\tif(constraint){\r\n\t\twjson = {and: [wjson, constraint]};\r\n\t}\r\n\treturn this.queryWrappedWithLimit(wjson, limit, start);\r\n}\r\n\r\n// elementMetadata() in new woql query\r\nWOQLQuery.prototype.getElementMetaDataQuery = function(constraint, limit, start){\r\n\tvar wjson = {\r\n\t\tand: [{quad: [\"v:Element\", \"rdf:type\", \"v:Type\", \"db:schema\"]},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Element\", \"rdfs:label\", \"v:Label\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Element\", \"rdfs:comment\", \"v:Comment\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Element\", \"tcs:tag\", \"v:Abstract\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Element\", \"rdfs:domain\", \"v:Domain\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Element\", \"rdfs:range\", \"v:Range\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t]\r\n\t}\r\n\tif(constraint){\r\n\t\twjson = {and: [wjson, constraint]};\r\n\t}\r\n\treturn this.queryWrappedWithLimit(wjson, limit, start);\r\n}\r\n\r\n// classMetadata in new woql client\r\nWOQLQuery.prototype.getClassListMetaDataQuery = function(constraint, limit, start){\r\n\tvar wjson = {\r\n\t\tand: [{quad: [\"v:Element\", \"rdf:type\", \"owl:Class\", \"db:schema\"]},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Element\", \"rdfs:label\", \"v:Label\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Element\", \"rdfs:comment\", \"v:Comment\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Element\", \"tcs:tag\", \"v:Abstract\", \"db:schema\"]}]\r\n\t\t\t}\r\n\t\t]\r\n\t}\r\n\tif(constraint){\r\n\t\twjson = {and: [wjson, constraint]};\r\n\t}\r\n\treturn this.queryWrappedWithLimit(wjson, limit, start);\r\n}\r\n\r\n// classMetadata\r\nWOQLQuery.prototype.getClassMetaDataQuery = WOQLQuery.prototype.getClassListMetaDataQuery;\r\n\r\nWOQLQuery.prototype.getDataOfChosenClassQuery = function(chosen, limit, start){\r\n\tvar wjson = {\r\n\t\tand: [{triple: [\"v:Document\", \"rdf:type\", chosen]},\r\n\t\t\t{\r\n\t\t\t\topt: [{triple: [\"v:Document\", \"v:Property\", \"v:Value\"]}]\r\n\t\t\t}\r\n\t\t]\r\n\t}\r\n\treturn this.queryWrappedWithLimit(wjson, limit, start);\r\n}\r\n\r\nWOQLQuery.prototype.getDataOfChosenPropertyQuery = function(chosen, limit, start){\r\n\tvar wjson = {\r\n\t\tand: [{triple: [\"v:Document\", chosen, \"v:Value\"]},\r\n\t\t\t{\r\n\t\t\t\topt: [{triple: [\"v:Document\", \"rdfs:label\", \"v:Label\"]}]\r\n\t\t\t}\r\n\t\t]\r\n\t}\r\n\treturn this.queryWrappedWithLimit(wjson, limit, start);\r\n}\r\n\r\nWOQLQuery.prototype.getInstanceMeta = function(url, limit, start){\r\n\tvar wjson = {\r\n\t\tand: [\r\n\t\t\t{triple: [url, \"rdfs:label\", \"v:InstanceLabel\"]},\r\n\t\t\t{triple: [url, \"rdf:type\", \"v:InstanceType\"]},\r\n\t\t\t{\r\n\t\t\t\topt: [{triple: [url, \"rdfs:comment\", \"v:InstanceComment\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:InstanceType\", \"rdfs:label\", \"v:ClassLabel\", \"db:schema\"]}]\r\n\t\t\t}\r\n\t\t]\r\n\t}\r\n\treturn this.queryWrappedWithLimit(wjson, limit, start);\r\n}\r\n\r\n\r\nWOQLQuery.prototype.getDocumentQuery = function(id, limit, start){\r\n\tvar wjson = {\r\n\t\tand: [\r\n\t\t\t{triple: [id, \"v:Property\", \"v:Property_Value\"]},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Property\", \"rdfs:label\", \"v:Property_Label\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Property\", \"rdf:type\", \"v:Property_Type\", \"db:schema\"]}]\r\n\t\t\t}\r\n\t\t]\r\n\t}\r\n\treturn this.queryWrappedWithLimit(wjson, limit, start);\r\n}\r\n\r\n//documentMetadata\r\nWOQLQuery.prototype.getClassesQuery = function(limit, start){\r\n\tvar wjson = {\r\n\t\tand: [\r\n\t\t\t{triple: [\"v:ID\", \"rdf:type\", \"v:Class\"]},\r\n\t\t\t{\r\n\t\t\t\topt: [{triple: [\"v:ID\", \"rdfs:label\", \"v:Label\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\topt: [{triple: [\"v:ID\", \"rdfs:comment\", \"v:Comment\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Class\", \"rdfs:label\", \"v:Type\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tsub: ['v:Class', 'tcs:Document']\r\n\t\t\t}\r\n\t\t]\r\n\t}\r\n\treturn this.queryWrappedWithLimit(wjson, limit, start);\r\n}\r\n\r\nmodule.exports=WOQLQuery\r\n","const TerminusClient = require('@terminusdb/terminus-client');\r\nconst HTMLFrameHelper = require('../html/HTMLFrameHelper');\r\nconst UTILS= require('../Utils')\r\n\r\n/*** client side processing ***/\r\nfunction CspDatatables(ui){\r\n    this.ui = ui;\r\n}\r\n\r\nCspDatatables.prototype.convertToDatatable = function(tab){\r\n    var dt = this;\r\n    var table = jQuery(tab).DataTable({\r\n         searching : false,\r\n         pageLength: 25,\r\n         lengthMenu: [10, 25, 50, 75, 100],\r\n         paging    : true,\r\n         select    : true,\r\n         initComplete: function(settings) {\r\n                        var ict =settings.oInstance.api();\r\n                        ict.$('td').each(function(){\r\n                            this.setAttribute('title', $(this).html())\r\n                        })},\r\n         columnDefs:[{targets:'_all',className:\"truncate\"}],\r\n         createdRow: function(row) {\r\n                            var td = $(row).find(\".truncate\");\r\n                            td.attr(\"title\", td.html());}\r\n    }); //jQuery(tab)\r\n\r\n    // on click of row connect to db, on click of 5th column delete db\r\n    jQuery(tab, 'tbody').on('click', 'td', function(){\r\n        if(table.cell(this).index().column == 5){\r\n            var dbInfo = table.row(jQuery(this).parents('tr')).data();\r\n            var dbId = UTILS.extractValueFromCell(dbInfo[0]);\r\n            dt.ui.deleteDatabase(dbId);\r\n            return;\r\n        }\r\n        else dt.ui.showDBMainPage();\r\n     }); // on click\r\n\r\n    tab.setAttribute('class'      , 'stripe dataTable terminus-db-size');\r\n    tab.setAttribute('cellpadding', '1');\r\n    tab.setAttribute('cellspacing', '0');\r\n    tab.setAttribute('border'     , '0');\r\n    return tab;\r\n}\r\n\r\nCspDatatables.prototype.draw = function(dtResult){\r\n    return(this.convertToDatatable(dtResult));\r\n}\r\n\r\n/*** server side processing ***/\r\nfunction Datatables(wResViewer, qPage){\r\n   this.wrViewer = wResViewer;\r\n   this.wQuery = wResViewer.wQuery;\r\n   this.ui = wResViewer.ui;\r\n   this.qPage = qPage;\r\n   this.currDTSettings = wResViewer.settings;\r\n}\r\n\r\n/*\r\n    query: new woqlquery with current pagination changes\r\n    pageInfo: current drawCallBack page change info\r\n    resultDOM: result dom on veiwer page\r\n*/\r\nDatatables.prototype.executeQuery = function(qObj, pageInfo, resultDOM){\r\n    var self = this;\r\n    // return this.wQuery.execute(query)\r\n    return qObj.execute(this.ui.client)\r\n    .then(function(result){\r\n      var dtResult = {};\r\n      var wqRes = new TerminusClient.WOQLResult(result, qObj);\r\n      dtResult = self.wrViewer.formatResultsForDatatableDisplay(result.bindings, pageInfo)\r\n      return dtResult.data;\r\n    })\r\n    .catch(function(err){\r\n      console.error(err);\r\n      self.ui.showError(err);\r\n    });\r\n}\r\n\r\n/* get query string based on datatable pagination and current query */\r\n/*Datatables.prototype.getQueryOnPagination = function(wq, settings){\r\n    switch(settings.query){\r\n        case 'Show_All_Documents':\r\n            return wq.getAllDocumentQuery(null, settings.pageLength, settings.start);\r\n        break;\r\n        case 'Show_All_Data':\r\n            return wq.getEverythingQuery(null, settings.pageLength, settings.start);\r\n        break;\r\n        case 'Show_All_Schema_Elements':\r\n            return wq.getElementMetaDataQuery(null, settings.pageLength, settings.start);\r\n        break;\r\n        case 'Show_Document_Classes':\r\n        \tvar sqp = wq.getConcreteDocumentClassPattern(\"Class\");\r\n            return wq.getClassMetaDataQuery(sqp);\r\n        break;\r\n        case 'Show_All_Properties':\r\n            return wq.getPropertyListQuery(null, settings.pageLength, settings.start);\r\n        break;\r\n        case 'Show_All_Classes':\r\n            return wq.getClassMetaDataQuery(null, settings.pageLength, settings.start);\r\n        break;\r\n        case 'Show_Data_Class':\r\n            return  wq.getDataOfChosenClassQuery(settings.chosenValue, settings.pageLength, settings.start);\r\n        break;\r\n        case 'Show_Property_Class':\r\n            return wq.getDataOfChosenPropertyQuery(settings.chosenValue, settings.pageLength, settings.start);\r\n        break;\r\n        case 'Show_Document_Info_by_Id':\r\n            return wq.getDocumentQuery(settings.chosenValue, settings.pageLength, settings.start);\r\n        break;\r\n        case 'Show_All_Document_classes':\r\n            return wq.getClassesQuery(settings.pageLength, settings.start);\r\n        break;\r\n        default:\r\n            console.log('Invalid woql option passed');\r\n        break;\r\n\r\n    }\r\n}   */\r\n/*\r\n    pageInfo: current drawCallBack page change info\r\n*/\r\nDatatables.prototype.generateNewQueryOnPageChange = function(pageInfo){\r\n    if(this.qPage) UTILS.deleteStylizedEditor(this.ui, pageInfo.qTextDom);\r\n    var qObj = UTILS.getCurrentWoqlQueryObject(null, pageInfo);\r\n    //var query = this.getQueryOnPagination(this.wQuery, pageInfo)\r\n    if(this.qPage) {\r\n        if(pageInfo.queryMode.value == 'woql')\r\n            pageInfo.qTextDom.value = JSON.stringify(qObj.prettyPrint(), undefined, 2);\r\n        else pageInfo.qTextDom.value = JSON.stringify(qObj, undefined, 2);\r\n        UTILS.stylizeEditor(this.ui, pageInfo.qTextDom, 'query', 'javascript');\r\n    }\r\n    //return query;\r\n    return qObj;\r\n}\r\n\r\n/*\r\n    dt: Datatable reference\r\n    len : current number of records to display\r\n*/\r\nDatatables.prototype.getCallbackSettings = function(dt, dtAPIChangeSettings){\r\n    var pageInfo = {};\r\n    pageInfo.pageLength  = dtAPIChangeSettings._iDisplayLength;\r\n    pageInfo.start       = dtAPIChangeSettings._iDisplayStart;\r\n    pageInfo.draw        = dtAPIChangeSettings.iDraw;\r\n    pageInfo.qTextDom    = dt.qTextDom;\r\n    pageInfo.queryMode   = dt.queryMode;\r\n    if(this.qPage) pageInfo.query = dt.query;\r\n    else pageInfo.query = 'Show_All_Document_classes';\r\n    pageInfo.chosenValue = dt.chosenValue;\r\n    return pageInfo;\r\n}\r\n\r\n/*\r\n    tab: datatable table dom\r\n    settings : settings from woql txt generator\r\n    resultDOM: result dom of viewer\r\n*/\r\nDatatables.prototype.setUp = function(tab, settings, resultDOM){\r\n    // delete previous datatable\r\n    TerminusClient.FrameHelper.removeChildren(this.dtdom);\r\n    this.dtdom = document.createElement('div');\r\n    this.dtdom.appendChild(tab);\r\n    resultDOM.appendChild(this.dtdom);\r\n    // saving query text box dom to change limit value on change of datatable page length\r\n    this.qTextDom = settings.qTextDom;\r\n    this.query = settings.query;\r\n    this.chosenValue = settings.chosenValue;\r\n    this.queryMode = settings.queryMode;\r\n}\r\n\r\n// update datatables settings so it can be reused in WOQLTextboxGenerator to re write query in woql/ jsonld\r\nDatatables.prototype.updateCurrDTSettings = function(pageInfo){\r\n    this.currDTSettings.pageLength = pageInfo.pageLength;\r\n    this.currDTSettings.start      = pageInfo.start;\r\n}\r\n\r\nDatatables.prototype.getNewDataOnChange = function(drawnTab, aSettings, resultDOM){\r\n    var pageInfo = this.getCallbackSettings(this, aSettings);\r\n    this.updateCurrDTSettings(pageInfo);\r\n   // var query = this.generateNewQueryOnPageChange(pageInfo);\r\n    var qObj = this.generateNewQueryOnPageChange(pageInfo);\r\n    return this.executeQuery(qObj, pageInfo, resultDOM);\r\n    //return this.executeQuery(query, pageInfo, resultDOM);\r\n    //return  dtResult.result.data;\r\n}\r\n\r\nDatatables.prototype.getDataFromServer = function(dtResult, resultDOM){\r\n    var dt = this;\r\n    var tab = dtResult.tab;\r\n    this.setUp(tab, this.wrViewer.settings, resultDOM);\r\n    // initialize datatables\r\n    var table = jQuery(tab).DataTable({\r\n         searching   : false,\r\n         pageLength  : dt.wrViewer.settings.pageLength,\r\n         serverSide  : true,\r\n         processing  : true,\r\n         lengthMenu  : [25, 50, 75, 100],\r\n         dom         : 'RBlftip',\r\n         columns     : dtResult.result.columns,\r\n         paging      : true,\r\n         select      : true,\r\n         autoWidth   : true,\r\n         ajax        : function (data, callback, settings) {\r\n                            if(Object.entries(dtResult.result.data).length > 0){\r\n                                // first draw is loaded\r\n                                var res = dtResult.result.data;\r\n                                dtResult.result.data = {};\r\n                                callback(res);\r\n                            }\r\n                            else{\r\n                                dt.getNewDataOnChange(this, settings, resultDOM)\r\n                                    .then(function(result){\r\n                                     callback(result);\r\n                                })\r\n                            }\r\n                       },\r\n         buttons     : [{ extend: 'copy', text: 'Copy to clipboard' },\r\n                        { extend: 'excel', text: 'Export to Excel' }],\r\n         columnDefs  : [{ targets:'_all',\r\n                          className:\"truncate\"}],\r\n         createdRow  : function(row){\r\n                            var td = $(row).find(\".truncate\");\r\n                            td.attr(\"title\", td.html());},\r\n         scrollX     : true\r\n    }); //jQuery(tab)\r\n\r\n    // on click of doc\r\n    jQuery(tab, 'tbody').on('click', 'td', function(){\r\n        if(table.cell(this).data){\r\n            if(this.innerText.substring(0, 4) == \"doc:\"){\r\n                if(dt.wrViewer.result.ui) {\r\n        \t\t\tdt.wrViewer.result.ui.showDocument(this.innerText);\r\n        \t\t\tdt.wrViewer.result.ui.redraw();\r\n        \t\t\tdt.wrViewer.selectDocumentNavBar(dt.ui);\r\n        \t\t}\r\n            }\r\n        }\r\n     }); // on click\r\n\r\n    //styling\r\n    tab.setAttribute('class'      , 'stripe dataTable');\r\n    tab.setAttribute('style'      , 'margin: 0!important');\r\n    tab.setAttribute('cellpadding', '1');\r\n    tab.setAttribute('cellspacing', '1');\r\n    tab.setAttribute('border'     , '0');\r\n\r\n    return tab;\r\n}\r\n\r\n/*\r\nserverside: true or false\r\n*/\r\nDatatables.prototype.draw = function(dtResult, resultDOM){\r\n    return(this.getDataFromServer(dtResult, resultDOM));\r\n}\r\n\r\nmodule.exports={Datatables, CspDatatables}\r\n","const TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction HTMLStringEditor(options){\r\n\tthis.css = ((options && options.css) ? \"terminus-literal-value \" + options.css : \"terminus-literal-value\");\r\n\tthis.options = options; \r\n}\r\n\r\nHTMLStringEditor.prototype.renderFrame = function(frame, dataviewer){\r\n\tvar value = frame.get();\r\n\tvar big = ((this.options && typeof this.options.big != \"undefined\") ? this.options.big : this.isBigType(this.type, value));\r\n\tif(big){\r\n\t\tvar input = document.createElement(\"textarea\");\r\n\t\tthis.css += \" terminus-literal-big-value\";\t\t\r\n\t}\r\n\telse {\r\n\t\tvar size = ((this.options && typeof this.options.size != \"undefined\") ? this.options.size : this.getTypeSize(this.type, value));\r\n\t\tvar input = document.createElement(\"input\");\r\n\t\tinput.setAttribute('type', \"text\");\r\n\t\tinput.setAttribute('size', size);\r\n\t}\r\n\tinput.setAttribute('class', this.css);\r\n\tinput.setAttribute(\"data-value\", value);\r\n\t\r\n\tinput.value = value;\r\n\tvar self = this;\r\n\tinput.addEventListener(\"input\", function(){\r\n\t\tframe.set(this.value);\r\n\t});\r\n\treturn input;\r\n}\r\n\r\nHTMLStringEditor.prototype.isBigType = function(ty, value){\r\n\tif(value && value.length && value.length > 100) return true;\r\n\tvar longs = [\"xdd:coordinatePolyline\", \"xdd:coordinatePolygon\", \"xsd:base64Binary\", \"xdd:html\", \"xdd:json\", \"rdf:XMLLiteral\"];\r\n\tif(longs.indexOf(ty) == -1) return false;\r\n\treturn true;\r\n}\r\n\r\nHTMLStringEditor.prototype.getTypeSize = function(ty, value){\r\n\tif(value && value.length && value.length > 40) return 80;\r\n\tvar bigs = [\"xdd:url\", \"xdd:coordinate\", \"xsd:anyURI\"];\r\n\tvar smalls = [\"xsd:gYearMonth\", \"xdd:gYearRange\", \"xsd:decimal\", \"xsd:float\", \"xsd:time\", \"xsd:date\", \r\n\t\t\"xsd:dateTimeStamp\",\"xsd:gYearMonth\", \"xsd:gMonthDay\", \"xsd:duration\", \"xsd:yearMonthDuration\", \"xsd:dayTimeDuration\", \r\n\t\t\"xsd:nonNegativeInteger\", \"xsd:positiveInteger\", \"xsd:negativeInteger\",\t\"xsd:nonPositiveInteger\", \"xsd:integer\",\"xsd:unsignedInt\"];\r\n\tvar tinys = [\"xsd:boolean\", \"xsd:gYear\", \"xsd:gMonth\", \"xsd:gDay\", \"xsd:byte\", \"xsd:short\", \"xsd:unsignedByte\", \"xsd:language\"];\r\n\tif(bigs.indexOf(ty) != -1) return 80;\r\n\tif(smalls.indexOf(ty) != -1) return 16;\r\n\tif(tinys.indexOf(ty) != -1) return 8;\r\n\treturn 32;\r\n}\r\n\r\nmodule.exports={HTMLStringEditor}\r\n\r\n\r\n","function HTMLBooleanViewer(options){\r\n\tthis.css = \"terminus-literal-value terminus-literal-value-boolean \" + ((options && options.css) ?  options.css : \"\");\r\n}\r\n\r\nHTMLBooleanViewer.prototype.renderFrame = function(frame, dataviewer){\r\n\treturn this.render(frame.get());\r\n}\r\n\r\nHTMLBooleanViewer.prototype.renderValue = function(dataviewer){\r\n\treturn this.render(dataviewer.value());\t\r\n}\r\n\r\nHTMLBooleanViewer.prototype.render = function(value){\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', this.css);\r\n\tif(value){\r\n\t\tvar vallab = document.createTextNode(value);\r\n\t\tinput.appendChild(vallab);\r\n\t}\r\n\treturn input;\r\n}\r\n\r\n\r\nmodule.exports={HTMLBooleanViewer}\r\n\r\n","function HTMLBooleanEditor(options){\r\n\tthis.css = \"terminus-literal-value terminus-literal-value-range \" + ((options && options.css) ?  options.css : \"\");\r\n}\r\n\r\nHTMLBooleanEditor.prototype.renderFrame = function(frame, dataviewer){\r\n\tvar value = frame.get();\r\n\tvar input = document.createElement(\"input\");\r\n\tinput.setAttribute('type', \"checkbox\");\r\n\tif(value){\r\n\t\tinput.setAttribute(\"checked\", \"checked\");\t\t\t\t\t\r\n\t}\r\n\tinput.addEventListener(\"change\", function(){\r\n\t\tif(value){\r\n\t\t\tframe.set(\"\");\r\n\t\t}\r\n\t\telse {\r\n\t\t\tframe.set(\"true\");\r\n\t\t}\r\n\t});\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={HTMLBooleanEditor}\r\n\r\n","const TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction HTMLChoiceViewer(options){};\r\n\r\nHTMLChoiceViewer.prototype.renderFrame = function(frame, dataviewer){\r\n\tvar value = frame.get();\r\n\tif(frame.frame && frame.frame.elements){\r\n\t\tthis.elements = frame.frame.elements;\r\n\t}\r\n\treturn this.render(value);\r\n}\r\n\r\nHTMLChoiceViewer.prototype.renderValue = function(dataviewer){\r\n\treturn this.render(dataviewer.value());\r\n}\r\n\r\nHTMLChoiceViewer.prototype.render = function(value){\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', \"terminus-literal-value terminus-choice-value\");\r\n\tinput.setAttribute('data-value', value);\r\n\tvar lab = false;\r\n\tif(value && this.elements){\r\n\t\tfor(var i = 0; i<this.elements.length; i++){\r\n\t\t\tvar elt = this.elements[i];\r\n\t\t\tif(elt.class == value){\r\n\t\t\t\tif(elt.label && elt.label[\"@value\"]){\r\n\t\t\t\t\tlab = elt.label[\"@value\"];\r\n\t\t\t\t}\r\n\t\t\t\tcontinue;\r\n\t\t\t}\t\t\t\t\r\n\t\t}\r\n\t}\r\n\tif(value && !lab){\r\n\t\tlab = TerminusClient.FrameHelper.labelFromURL(value);\t\t\t\t\t\r\n\t}\r\n\tif(lab){\r\n\t\tinput.appendChild(document.createTextNode(lab));\t\t\r\n\t}\r\n\treturn input\r\n}\r\n\r\nmodule.exports={HTMLChoiceViewer}\r\n\r\n\r\n","const HTMLFrameHelper = require('../HTMLFrameHelper');\r\n\r\nfunction HTMLChoiceEditor(options){};\r\n\r\nHTMLChoiceEditor.prototype.renderFrame = function(frame, dataviewer){\r\n\tvar value = frame.get();\r\n\tvar optInput = document.createElement(\"select\");\r\n\toptInput.setAttribute('class', \"terminus-choice-picker\");\r\n\tvar foptions = frame.getChoiceOptions();\r\n\tfoptions.unshift({ value: \"\", label: \"Not Specified\"});\r\n\tvar callback = function(val){\r\n\t\tframe.set(val);\r\n\t}\r\n\tvar sel = HTMLFrameHelper.getSelectionControl(\"select-choice\", foptions, value, callback);\r\n\treturn sel;\r\n}\r\n\r\nmodule.exports={HTMLChoiceEditor}\r\n\r\n","const TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction HTMLCoordinateViewer(options){\r\n\tthis.inputs = [];\r\n}\r\n\r\nHTMLCoordinateViewer.prototype.parseValue = function(value){\r\n\ttry {\r\n\t\tvar parsed = (value ? JSON.parse(value) : false);\r\n\t\tif(parsed && this.type == \"xdd:coordinate\"){\r\n\t\t\tparsed = [parsed];\r\n\t\t}\r\n\t\treturn parsed;\r\n\t}\r\n\tcatch(e){\r\n\t\tthis.error = this.type + \" value \" + value + \" failed to parse as json\", e.toString();\r\n\t\treturn [];\r\n\t}\r\n}\r\n\r\n\r\nHTMLCoordinateViewer.prototype.renderFrame = function(frame, dataviewer){\r\n\treturn this.render(frame.get());\r\n}\r\n\r\nHTMLCoordinateViewer.prototype.renderValue = function(dataviewer){\r\n\treturn this.render(dataviewer.value());\r\n}\r\n\r\nHTMLCoordinateViewer.prototype.render = function(value){ \r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', \"terminus-literal-value terminus-literal-coordinate\");\r\n\tif(value){\r\n\t\tinput.setAttribute('data-value', value);\t\t\r\n\t\tvar parsed = this.parseValue(value);\r\n\t\tif(parsed){\r\n\t\t\tfor(var i = 0; i < parsed.length; i++){\r\n\t\t\t\tvar lldom = document.createElement(\"span\");\r\n\t\t\t\tlldom.setAttribute(\"class\", \"latlong\");\r\n\t\t\t\tlldom.appendChild(document.createTextNode(\"Latitude: \"));\r\n\t\t\t\tlldom.appendChild(document.createTextNode(parsed[i][0] + \" °\" + \" \"));\r\n\t\t\t\tlldom.appendChild(document.createTextNode(\"Longitude: \"));\r\n\t\t\t\tlldom.appendChild(document.createTextNode(parsed[i][1] + \" °\" ));\r\n\t\t\t\tinput.appendChild(lldom);\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tinput.setAttribute(\"title\", this.error);\r\n\t\t}\r\n\t}\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={HTMLCoordinateViewer}\r\n\r\n","function HTMLCoordinateEditor(options){\r\n\tthis.inputs = [];\r\n}\r\n\r\nHTMLCoordinateEditor.prototype.getInputDOMs = function(lat, long, change){\r\n\tvar latdom = document.createElement(\"input\");\r\n\tlatdom.setAttribute(\"type\", \"text\");\r\n\tlatdom.value = lat;\r\n\tvar longdom = document.createElement(\"input\");\r\n\tlongdom.setAttribute(\"type\", \"text\");\r\n\tlongdom.value = long;\r\n\tlatdom.addEventListener(\"change\", change);\r\n\tlongdom.addEventListener(\"change\", change);\r\n\treturn [latdom, longdom];\r\n}\r\n\r\nHTMLCoordinateEditor.prototype.getLatLongDOM = function(lat, long, ty, index, parent){\r\n\tvar lldom = document.createElement(\"span\");\r\n\tlldom.setAttribute(\"class\", \"terminus-lat-long\");\r\n\tvar firstcol = document.createElement(\"span\");\r\n\tfirstcol.setAttribute(\"class\", \"terminus-lat-long-col\");\r\n\tlldom.appendChild(firstcol);\r\n\tif(index > 2 || (ty == \"xdd:coordinatePolyline\" && index > 1)){\r\n\t\tvar delbut = document.createElement(\"button\");\r\n\t\tdelbut.setAttribute(\"class\", \"delete-coordinate\");\r\n\t\tdelbut.appendChild(document.createTextNode(\"Remove\"));\r\n\t\tdelbut.addEventListener(\"click\", function(){\r\n\t\t\tlong.value = \"\";\r\n\t\t\tlat.value = \"\";\r\n\t\t\tparent.removeChild(lldom);\r\n\t\t});\r\n\t\tfirstcol.appendChild(delbut);\r\n\t}\r\n\tlldom.appendChild(document.createTextNode(\"Latitude: \"));\r\n\tlldom.appendChild(lat);\r\n\tlldom.appendChild(document.createTextNode(\" °\" + \" \"));\r\n\tlldom.appendChild(document.createTextNode(\"  Longitude: \"));\r\n\tlldom.appendChild(long);\r\n\tlldom.appendChild(document.createTextNode(\" ° \" ));\r\n\treturn lldom;\r\n}\r\n\r\n\r\nHTMLCoordinateEditor.prototype.renderFrame = function(frame, dataviewer){\r\n\tvar value = frame.get();\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', \"terminus-literal-value terminus-literal-coordinate\");\r\n\tinput.setAttribute('data-value', value);\r\n\ttry {\r\n\t\tvar parsed = (value ? JSON.parse(value) : false);\r\n\t}\r\n\tcatch(e){\r\n\t\tthis.error = this.type + \" failed to parse as json\", e.toString();\r\n\t\tvar parsed = false;\r\n\t}\r\n\tvar self = this;\r\n\tvar updateValueFromForm = function(){\r\n\t\tvar vals = [];\r\n\t\tfor(var i = 0; i<self.inputs.length; i++){\r\n\t\t\tif(self.inputs[i][0].value && self.inputs[i][1].value){\r\n\t\t\t\tvar val = \"[\" + self.inputs[i][0].value + \",\" + self.inputs[i][1].value + \"]\";\r\n\t\t\t\tvals.push(val);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(vals.length == 0){\r\n\t\t\tframe.set(\"\");\r\n\t\t}\r\n\t\telse if(this.type == \"xdd:coordinate\"){\r\n\t\t\tframe.set(vals[0]);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tvar op = \"[\";\r\n\t\t\tfor(var i = 0; i<vals.length; i++){\r\n\t\t\t\top += vals[i];\r\n\t\t\t\tif(i+1 < vals.length) op += \",\";\r\n\t\t\t}\r\n\t\t\top += \"]\";\r\n\t\t\tframe.set(op);\r\n\t\t}\r\n\t};\r\n\tif(!parsed){\r\n\t\tif(this.type == \"xdd:coordinate\") parsed = [\"\",\"\"];\r\n\t\telse {\r\n\t\t\tparsed = [[\"\",\"\"],[\"\",\"\"]];\r\n\t\t\tif(this.type == \"xdd:coordinatePolygon\") parsed.push([\"\",\"\"]);\r\n\t\t}\r\n\t}\r\n\tif(this.type == \"xdd:coordinate\"){\r\n\t\tparsed = [parsed];\r\n\t}\r\n\tfor(var i = 0; i < parsed.length; i++){\r\n\t\tthis.inputs.push(this.getInputDOMs(parsed[i][0], parsed[i][1], updateValueFromForm))\r\n\t}\r\n\tvar lldoms = document.createElement(\"span\");\r\n\tfor(var i = 0; i < this.inputs.length; i++){\r\n\t\tvar lldom = this.getLatLongDOM(this.inputs[i][0], this.inputs[i][1], this.type, i, lldoms);\r\n\t\tlldoms.appendChild(lldom);\r\n\t}\r\n\tinput.appendChild(lldoms);\r\n\tvar self = this;\r\n\tif(this.type != \"xdd:coordinate\"){\r\n\t\tvar butspan = document.createElement(\"span\");\r\n\t\tbutspan.setAttribute(\"class\", \"terminus-add-coordinate\")\r\n\t\tvar addbut = document.createElement(\"button\");\r\n\t\taddbut.setAttribute(\"class\", \"terminus-add-coordinate\");\r\n\t\taddbut.appendChild(document.createTextNode(\"Add\"));\r\n\t\taddbut.addEventListener(\"click\", function(){\r\n\t\t\tvar ipdoms = self.getInputDOMs(\"\", \"\", updateValueFromForm);\r\n\t\t\tvar lldom = self.getLatLongDOM(ipdoms[0], ipdoms[1], this.type, self.inputs.length, lldoms);\r\n\t\t\tlldoms.appendChild(lldom);\r\n\t\t\tself.inputs.push(ipdoms);\r\n\t\t});\r\n\t\tbutspan.appendChild(addbut);\r\n\t\tinput.appendChild(butspan);\t\t\t\r\n\t}\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={HTMLCoordinateEditor}","const DateHelper = require('./DateHelper');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction HTMLDateViewer(options){\r\n\tthis.max = (options && options.max ? options.max : false);\r\n\tthis.min = (options && options.min ? options.min : false);\r\n\tthis.allowbce = (options && options.allowbce ? options.allowbce : false);\r\n\tthis.date_spacer = \"/\";\r\n\tthis.time_spacer = \":\";\r\n\tthis.datetime_separator = \", \";\r\n\tthis.helper = new DateHelper.HTMLDateHelper();\r\n}\r\n\r\nHTMLDateViewer.prototype.renderFrame = function(frame, dataviewer){\r\n\treturn this.render(frame.get());\r\n}\r\n\r\nHTMLDateViewer.prototype.renderValue = function(dataviewer){\r\n\treturn this.render(dataviewer.value());\r\n}\r\n\r\nHTMLDateViewer.prototype.render = function(value){\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', \"terminus-literal-value terminus-literal-date\");\r\n\tinput.setAttribute('data-value', value);\r\n\tif(value){\r\n\t\tvar parsed = TerminusClient.FrameHelper.parseDate(this.type, value);\r\n\t\tvar datepart = this.getDateComponentDOM(parsed);\r\n\t\tvar timepart = this.getTimeComponentDOM(parsed);\r\n\t\tif(timepart) input.appendChild(timepart);\r\n\t\tif(timepart && datepart) input.appendChild(document.createTextNode(this.datetime_separator));\r\n\t\tif(datepart) input.appendChild(datepart);\r\n\t}\r\n\treturn input;\r\n}\r\n\r\nHTMLDateViewer.prototype.getTimeComponentDOM = function(parsed, ty){\r\n\tvar hdom = (parsed.hour ? document.createElement(\"span\") : false);\r\n\tif(hdom){\r\n\t\thdom.setAttribute(\"class\", \"terminus-time-hour\");\r\n\t\thdom.appendChild(document.createTextNode(parsed.hour));\r\n\t}\r\n\tvar mdom = (typeof parsed.minute != \"undefined\" ? document.createElement(\"span\") : false);\r\n\tif(mdom){\r\n\t\tmdom.setAttribute(\"class\", \"terminus-time-minute\");\r\n\t\tvar mlab = (parsed.minute < 10 ? parsed.minute : parsed.minute);\r\n\t\tmdom.appendChild(document.createTextNode(mlab));\r\n\t}\r\n\tvar sdom = (typeof parsed.second != \"undefined\" ? document.createElement(\"span\") : false);\r\n\tif(sdom){\r\n\t\tsdom.setAttribute(\"class\", \"terminus-time-second\");\r\n\t\tvar slab = (parsed.second < 10 ? parsed.second : parsed.second);\r\n\t\tsdom.appendChild(document.createTextNode(slab));\r\n\t}\r\n\tvar tz = (parsed.timezone ? document.createElement(\"span\") : false);\r\n\tif(tz){\r\n\t\tsdom.setAttribute(\"class\", \"terminus-time-timezone\");\r\n\t\tsdom.appendChild(document.createTextNode(parsed.timezone));\r\n\t}\r\n\tif(hdom || mdom || sdom || tz){\r\n\t\tvar dadom = document.createElement(\"span\");\r\n\t\tdadom.setAttribute(\"class\", \"terminus-time-components time-\"+ty);\r\n\t\tif(hdom) dadom.appendChild(hdom); \r\n\t\tif(mdom) {\r\n\t\t\tif(hdom) dadom.appendChild(document.createTextNode(this.time_spacer));\r\n\t\t\tdadom.appendChild(mdom); \r\n\t\t}\r\n\t\tif(sdom) {\r\n\t\t\tif(mdom || hdom) dadom.appendChild(document.createTextNode(this.time_spacer));\r\n\t\t\tdadom.appendChild(sdom); \r\n\t\t}\r\n\t\tif(tz){\r\n\t\t\tdadom.appendChild(document.createTextNode(\" (Timezone: \")); \r\n\t\t\tdadom.appendChild(sdom); \r\n\t\t\tdadom.appendChild(document.createTextNode(\")\")); \t\t\t\r\n\t\t}\r\n\t\treturn dadom;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLDateViewer.prototype.getDateComponentDOM = function(parsed, ty){\r\n\tvar ydom = (parsed.year ? document.createElement(\"span\") : false);\r\n\tif(ydom){\r\n\t\tydom.setAttribute(\"class\", \"terminus-date-year\");\r\n\t\tydom.appendChild(document.createTextNode(parsed.year));\r\n\t}\r\n\tvar mdom = (parsed.month ? document.createElement(\"span\") : false);\r\n\tif(mdom){\r\n\t\tmdom.setAttribute(\"class\", \"terminus-date-month\");\r\n\t\tmdom.appendChild(document.createTextNode(this.helper.getMonthName(parsed.month)));\t\t\r\n\t}\r\n\tvar ddom = (parsed.day ? document.createElement(\"span\") : false );\r\n\tif(ddom){\r\n\t\tddom.setAttribute(\"class\", \"terminus-date-day\");\r\n\t\tddom.appendChild(document.createTextNode(parsed.day));\t\t\r\n\t}\r\n\tif(ydom || mdom || ddom){\r\n\t\tvar dadom = document.createElement(\"span\");\r\n\t\tif(ddom) dadom.appendChild(ddom); \r\n\t\tif(mdom) {\r\n\t\t\tif(ddom) dadom.appendChild(document.createTextNode(this.date_spacer));\r\n\t\t\tdadom.appendChild(mdom); \r\n\t\t}\r\n\t\tif(ydom) {\r\n\t\t\tif(mdom || ddom) dadom.appendChild(document.createTextNode(this.date_spacer));\r\n\t\t\tdadom.appendChild(ydom); \r\n\t\t}\r\n\t\treturn dadom;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nmodule.exports={HTMLDateViewer}","function HTMLDateHelper(){\r\n\tthis.months = [\"January\", \"Februrary\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"];\r\n}\r\n\r\nHTMLDateHelper.prototype.getMonthName = function(num){\r\n\treturn this.months[num-1];\r\n}\r\n\r\nmodule.exports={HTMLDateHelper}","const DateHelper = require('./DateHelper');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction HTMLDateEditor(options){\r\n\tthis.max = (options && options.max ? options.max : false);\r\n\tthis.min = (options && options.min ? options.min : false);\r\n\tthis.allowbce = (options && options.allowbce ? options.allowbce : false);\r\n\tthis.date_spacer = \"/\";\r\n\tthis.time_spacer = \":\";\r\n\tthis.datetime_separator = \", \";\r\n\tthis.helper = new DateHelper.HTMLDateHelper();\r\n}\r\n\r\nHTMLDateEditor.prototype.renderFrame = function(frame, dataviewer){\r\n\tvar value = frame.get();\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', \"terminus-literal-value terminus-literal-date\");\r\n\tinput.setAttribute('data-value', value);\r\n\tif(value){\r\n\t\tthis.parsed = TerminusClient.FrameHelper.parseDate(this.type, value);\r\n\t}\r\n\telse this.parsed = {};\r\n\tvar datepart = this.getDateComponentDOM(this.parsed, this.type, frame);\r\n\tvar timepart = this.getTimeComponentDOM(this.parsed, this.type, frame);\r\n\tif(timepart) input.appendChild(timepart);\r\n\tif(timepart && datepart) input.appendChild(document.createTextNode(this.datetime_separator));\r\n\tif(datepart) input.appendChild(datepart);\r\n\treturn input;\r\n}\r\n\r\nHTMLDateEditor.prototype.set = function(part, val, frame, ty){\r\n\tthis.parsed[part] = val;\r\n\tvar xsd = TerminusClient.FrameHelper.xsdFromParsed(this.parsed, ty);\r\n\tif(xsd){\r\n\t\tframe.set(xsd);\r\n\t}\r\n}\r\n\r\nHTMLDateEditor.prototype.getTimeComponentDOM = function(parsed, ty, frame){\r\n\tif([\"xsd:dateTime\", \"xsd:dateTimeStamp\", \"xsd:time\"].indexOf(ty) == -1){\r\n\t\treturn false;\r\n\t}\r\n\tvar self = this;\r\n\tvar hdom = document.createElement(\"input\");\r\n\thdom.setAttribute(\"class\", \"terminus-hour-input terminus-hour-\"+ty);\r\n\thdom.setAttribute(\"size\", 2);\r\n\thdom.setAttribute(\"placeholder\", \"HH\");\r\n\thdom.value = (parsed.hour ? parsed.hour : \"\");\r\n\thdom.addEventListener(\"input\", function(){\r\n\t\tself.set(\"hour\", this.value, frame, ty);\r\n\t});\r\n\tvar mdom = document.createElement(\"input\");\r\n\tmdom.setAttribute(\"class\", \"terminus-minute-input terminus-minute-\"+ty);\r\n\tmdom.setAttribute(\"size\", 2);\r\n\tmdom.setAttribute(\"placeholder\", \"MM\");\r\n\tmdom.value = (parsed.minute ? parsed.minute: \"\");\r\n\tmdom.addEventListener(\"input\", function(){\r\n\t\tself.set(\"minute\", this.value, frame, ty);\r\n\t});\r\n\tvar sdom = document.createElement(\"input\");\r\n\tsdom.setAttribute(\"class\", \"terminus-second-input terminus-second-\"+ty);\r\n\tsdom.setAttribute(\"size\", 8);\r\n\tsdom.setAttribute(\"placeholder\", \"SS.sss...\");\r\n\tsdom.value = (parsed.second ? parsed.second: \"\");\r\n\tsdom.addEventListener(\"input\", function(){\r\n\t\tself.set(\"second\", this.value, frame, ty);\r\n\t})\r\n\tvar tdom = document.createElement(\"span\");\r\n\ttdom.appendChild(hdom);\r\n\ttdom.appendChild(document.createTextNode(this.time_spacer));\r\n\ttdom.appendChild(mdom);\r\n\ttdom.appendChild(document.createTextNode(this.time_spacer));\r\n\ttdom.appendChild(sdom);\r\n\treturn tdom;\r\n}\r\n\r\nHTMLDateEditor.prototype.getDateComponentDOM = function(parsed, ty, frame){\r\n\tvar self = this;\r\n\tif([\"xsd:date\", \"xsd:dateTime\", \"xsd:gYear\", \"xsd:gYearMonth\", \"xsd:dateTimeStamp\"].indexOf(ty) != -1){\r\n\t\tvar ydom = document.createElement(\"input\");\r\n\t\tydom.setAttribute(\"class\", \"terminus-year-input terminus-year-\"+ty);\r\n\t\tydom.setAttribute(\"size\", 6);\r\n\t\tydom.setAttribute(\"placeholder\", \"YYYY\");\r\n\t\tydom.value = (parsed.year ? parsed.year : \"\");\r\n\t\tydom.addEventListener(\"input\", function(){\r\n\t\t\tself.set(\"year\", this.value, frame, ty);\r\n\t\t})\r\n\t}\r\n\tif([\"xsd:date\", \"xsd:dateTime\", \"xsd:gYearMonth\", \"xsd:dateTimeStamp\", \"xsd:gMonth\", \"xsd:gMonthDay\"].indexOf(ty) != -1){\r\n\t\tvar mdom = document.createElement(\"select\");\r\n\t\tmdom.setAttribute(\"class\", \"terminus-month-input terminus-month-\"+ty);\r\n\t\tfor(var i = 0; i<this.helper.months.length; i++){\r\n\t\t\tvar opdom = document.createElement(\"option\");\r\n\t\t\topdom.value = i+1;\r\n\t\t\topdom.appendChild(document.createTextNode(this.helper.months[i]));\r\n\t\t\tif(parsed.month && parsed.month == i+1){\r\n\t\t\t\topdom.selected = true;\r\n\t\t\t}\r\n\t\t\tmdom.appendChild(opdom);\r\n\t\t}\r\n\t\tmdom.addEventListener(\"change\", function(){\r\n\t\t\tself.set(\"month\", this.value, frame, ty);\r\n\t\t})\r\n\t}\t\r\n\tif([\"xsd:date\", \"xsd:dateTime\", \"xsd:dateTimeStamp\", \"xsd:gDay\", \"xsd:gMonthDay\"].indexOf(ty) != -1){\r\n\t\tvar ddom = document.createElement(\"input\");\r\n\t\tddom.setAttribute(\"class\", \"terminus-day-input terminus-day-\"+ty);\r\n\t\tddom.setAttribute(\"size\", 2);\r\n\t\tddom.setAttribute(\"placeholder\", \"DD\");\r\n\t\tddom.value = (parsed.day ? parsed.day : \"\");\t\r\n\t\tddom.addEventListener(\"input\", function(){\r\n\t\t\tself.set(\"day\", this.value, frame, ty);\r\n\t\t})\r\n\t}\t\r\n\tif(ydom || mdom || ddom){\r\n\t\tvar dadom = document.createElement(\"span\");\r\n\t\tif(ddom) dadom.appendChild(ddom); \r\n\t\tif(mdom) {\r\n\t\t\tif(ddom) dadom.appendChild(document.createTextNode(this.date_spacer));\r\n\t\t\tdadom.appendChild(mdom); \r\n\t\t}\r\n\t\tif(ydom) {\r\n\t\t\tif(mdom || ddom) dadom.appendChild(document.createTextNode(this.date_spacer));\r\n\t\t\tdadom.appendChild(ydom); \r\n\t\t}\r\n\t\treturn dadom;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nmodule.exports={HTMLDateEditor}","const HTMLFrameHelper = require('../HTMLFrameHelper');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction HTMLEntityViewer(options){\r\n\tthis.onclick = false;\r\n}\r\n\r\nHTMLEntityViewer.prototype.renderFrame = function(frame, dataviewer){\r\n\t//this.client = dataviewer.getClient();\r\n\treturn this.render(frame.get());\t\r\n}\r\n\r\nHTMLEntityViewer.prototype.renderValue = function(dataviewer){\r\n\t//this.client = dataviewer.getClient();\r\n\treturn this.render(dataviewer.value());\r\n}\r\n\r\nHTMLEntityViewer.prototype.render = function(value){\r\n\t//var value = TerminusClient.FrameHelper.unshorten(value);\r\n\tvar holder = document.createElement(\"span\");\r\n\tholder.setAttribute(\"class\", \"terminus-literal-value terminus-entity-reference-value\");\r\n\tvar self = this;\r\n\tif(this.holder){\r\n\t\treturn this.holder;\r\n\t}\r\n\tif(value){\r\n\t\tvar dom = this.showValue(value)\r\n\t\tholder.appendChild(dom);\r\n\t}\r\n\treturn holder;\r\n}\r\n\r\nHTMLEntityViewer.prototype.showValue = function(value){\r\n\treturn document.createTextNode(value);\r\n}\r\n\r\n\r\nHTMLEntityViewer.prototype.getEntityViewHTML = function(value, frame, dataviewer){\r\n\tvar span = document.createElement(\"span\");\r\n\tvar self = this;\r\n\tspan.setAttribute(\"class\", \"terminus-internal-link\");\r\n\tspan.appendChild(dataviewer.internalLink(value));\r\n\tif(controller = renderer.getController()){\r\n\t\tcontroller.getInstanceMeta(value).then(function(response){\r\n\t\t\tvar lab = self.getEntityLabel(value, response, dataviewer);\r\n\t\t\tif(lab){ \r\n\t\t\t\tTerminusClient.FrameHelper.removeChildren(span);\r\n\t\t\t\tspan.appendChild(lab);\r\n\t\t\t}\t\r\n\t\t});\r\n\t}\r\n\treturn span;\r\n}\r\n\r\nHTMLEntityViewer.prototype.getEntityLabel = function(url, response, dv){\r\n\tvar nspan = document.createElement(\"span\");\r\n\tif(response && (il = HTMLFrameHelper.getVariableValueFromBinding(\"InstanceLabel\", response))){\r\n\t\tnspan.appendChild(dv.internalLink(url, il));\r\n\t\tvar rt = HTMLFrameHelper.getVariableValueFromBinding(\"InstanceType\", response);\r\n\t\tvar tit = url + \" Type: \" + rt;\r\n\t\tvar ic = HTMLFrameHelper.getVariableValueFromBinding(\"InstanceComment\", response);\r\n\t\tif(typeof ic == \"object\" && ic[\"@value\"]){\r\n\t\t\ttit += \" \" + ic[\"@value\"];\r\n\t\t}\r\n\t\tnspan.setAttribute(\"title\", tit);\r\n\t\treturn nspan;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nmodule.exports={HTMLEntityViewer}","function HTMLEntityEditor(options){}\r\nHTMLEntityEditor.prototype.renderFrame = function(frame, dataviewer){\r\n\tvar value = frame.get();\r\n\tvar input = document.createElement(\"input\");\r\n\tinput.setAttribute(\"class\", \"terminus-literal-value terminus-entity-reference-value\");\r\n\tinput.setAttribute(\"type\", \"text\");\r\n\tinput.setAttribute('size', 80);\r\n\tinput.value = value;\r\n\tvar self = this;\r\n\tinput.addEventListener(\"change\", function(){\r\n\t\tvar url = this.value;\r\n\t\tif(url.indexOf(\"/\") == -1 && url.indexOf(\":\") == -1){\r\n\t\t\turl = \"doc:\" + url;\r\n\t\t}\r\n\t\tframe.set(url);\r\n\t});\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={HTMLEntityEditor}","const TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction HTMLImageViewer(options){}\r\n\r\nHTMLImageViewer.prototype.renderFrame = function(frame, dataviewer){\r\n\treturn this.render(frame.get());\r\n}\r\n\r\nHTMLImageViewer.prototype.renderValue = function(dataviewer){\r\n\treturn this.render(dataviewer.value());\r\n}\r\n\t\r\nHTMLImageViewer.prototype.render = function(value){\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', \"terminus-literal-value terminus-literal-image-value\");\r\n\tinput.setAttribute('data-value', value);\r\n\tif(value){\r\n\t\tvar img = document.createElement(\"a\");\r\n\t\timg.setAttribute('src', value);\r\n\t\tinput.appendChild(img);\r\n\t}\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={HTMLImageViewer}\r\n\r\n\r\n","const TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction HTMLImageEditor(options){}\r\nHTMLImageEditor.prototype.renderFrame = function(frame, dataviewer){\r\n\tif(this.type == \"xsd:base64Binary\"){\r\n\t\tvar input = document.createElement(\"textarea\");\r\n\t\tinput.setAttribute('class', \"terminus-literal-value terminus-literal-b64image-value\");\r\n\t\tinput.value = value;\r\n\t\tinput.addEventListener(\"change\", function(){\r\n\t\t\tframe.set(this.value);\r\n\t\t});\r\n\t\treturn input;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nmodule.exports={HTMLImageEditor}","function HTMLLinkViewer(options){\r\n\tthis.css = \"terminus-literal-value terminus-literal-value-range \" + ((options && options.css) ?  options.css : \"\");\r\n}\r\n\r\nHTMLLinkViewer.prototype.renderFrame = function(frame, dataviewer){\r\n\treturn this.render(frame.get());\r\n}\r\n\r\nHTMLLinkViewer.prototype.renderValue = function(dataviewer){\r\n\treturn this.render(dataviewer.value());\r\n}\r\n\t\r\nHTMLLinkViewer.prototype.render = function(value){\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', this.css);\r\n\tinput.setAttribute('size', 80);\r\n\tinput.setAttribute('data-value', value);\r\n\tif(value){\r\n\t\tvar a = document.createElement(\"a\");\r\n\t\ta.setAttribute('href', value);\r\n\t\ta.appendChild(document.createTextNode(value));\r\n\t\tinput.appendChild(a);\r\n\t}\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={HTMLLinkViewer}\r\n\r\n","const TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction HTMLNumberViewer(options){\r\n\tthis.commas = (options && options.commas ? options.commas : true);\r\n}\r\n\r\nHTMLNumberViewer.prototype.renderFrame = function(frame, dataviewer){\r\n\treturn this.render(frame.get());\r\n}\r\n\r\nHTMLNumberViewer.prototype.renderValue = function(dataviewer){\r\n\treturn this.render(dataviewer.value());\r\n}\r\n\t\r\nHTMLNumberViewer.prototype.render = function(value){\r\n\tif(value === 0) value = \"0\";\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', 'terminus-number-value terminus-literal-value');\r\n\tinput.setAttribute('data-value', value);\r\n\tvalue = (this.commas ? TerminusClient.FrameHelper.numberWithCommas(value) : value);\r\n\tinput.appendChild(document.createTextNode(value));\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={HTMLNumberViewer}\r\n","const TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction HTMLRangeViewer(options){\r\n\tthis.commas = (options && options.commas ? options.commas : true);\r\n\tthis.css = \"terminus-literal-value terminus-literal-value-range \" + ((options && options.css) ?  options.css : \"\");\r\n\tthis.delimiter = (options && options.delimiter ? options.delimiter : false);\r\n}\r\n\r\nHTMLRangeViewer.prototype.renderFrame = function(frame, dataviewer){\r\n\treturn this.render(frame.get());\r\n}\r\n\r\nHTMLRangeViewer.prototype.renderValue = function(dataviewer){\r\n\treturn this.render(dataviewer.value());\r\n}\r\n\t\r\nHTMLRangeViewer.prototype.render = function(value){\r\n\tvar vals = TerminusClient.FrameHelper.parseRangeValue(value, this.delimiter);\r\n\tvar d = document.createElement(\"span\");\r\n\td.setAttribute(\"class\", this.css);\r\n\tvar rvals = document.createElement(\"span\");\r\n\trvals.setAttribute(\"class\", \"terminus-range-value-left\");\r\n\tvar svals = document.createElement(\"span\");\r\n\tsvals.setAttribute(\"class\", \"terminus-range-value-right\");\r\n\tvar x = (this.useCommas() ? TerminusClient.FrameHelper.numberWithCommas(vals[0]) : vals[0]);\r\n\tvar tnode = document.createTextNode(x);\r\n\trvals.appendChild(tnode);\r\n\td.appendChild(rvals);\t\r\n\tif(vals.length == 2){\r\n\t\td.appendChild(getRangeSymbolDOM());\r\n\t\tvar x2 = (this.useCommas(renderer) ? TerminusClient.FrameHelper.numberWithCommas(vals[1]) : vals[1]);\r\n\t\tvar t2node = document.createTextNode(x2);\r\n\t\tsvals.appendChild(t2node);\r\n\t\td.appendChild(svals);\t\r\n\t}\r\n\treturn d;\r\n}\r\n\r\nHTMLRangeViewer.prototype.useCommas = function(){\r\n\tif([\"xdd:gYearRange\", \"xdd:dateRange\"].indexOf(this.type) != -1) return false;\r\n\treturn this.commas;\r\n}\r\n\r\nfunction getRangeSymbolDOM(){\r\n\tvar d = document.createElement(\"span\");\r\n\td.setAttribute(\"class\", \"terminus-range-indicator\");\r\n\td.setAttribute(\"title\", \"The value is uncertain, it lies somewhere in this range\");\r\n\td.appendChild(document.createTextNode(\" ... \"));\r\n\treturn d;\r\n}\r\n\r\nmodule.exports={HTMLRangeViewer}\r\n","const TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction HTMLRangeEditor(options){\r\n\tthis.commas = (options && options.commas ? options.commas : true);\r\n\tthis.css = \"terminus-literal-value terminus-literal-value-range \" + ((options && options.css) ?  options.css : \"\");\r\n\tthis.delimiter = (options && options.delimiter ? options.delimiter : false);\r\n}\r\n\r\nHTMLRangeEditor.prototype.renderFrame = function(frame, dataviewer){\r\n\tvar value = frame.get();\r\n\tvar vals = TerminusClient.FrameHelper.parseRangeValue(value, this.delimiter);\r\n\tvar d = document.createElement(\"span\");\r\n\td.setAttribute(\"class\", this.css);\r\n\tvar rvals = document.createElement(\"span\");\r\n\tvar svals = document.createElement(\"span\");\r\n\tvar data1 = (vals.length > 0 ? vals[0] : \"\");\r\n\tvar data2 = (vals.length > 1 ? vals[1] : \"\");\r\n\tvar firstip = document.createElement(\"input\");\r\n\tfirstip.setAttribute('type', \"text\");\r\n\tfirstip.setAttribute('size', 16);\r\n\tif(data1){\r\n\t\tfirstip.value = data1;\r\n\t}\r\n\tvar secondip = document.createElement(\"input\");\r\n\tsecondip.setAttribute('type', \"text\");\r\n\tsecondip.setAttribute('size', 16);\r\n\tif(data2){\r\n\t\tthis.showing_range = true;\r\n\t\tsecondip.value = data2;\r\n\t}\r\n\trvals.appendChild(firstip);\r\n\td.appendChild(rvals);\t\r\n\tif(this.showing_range){\r\n\t\tsvals.appendChild(getRangeSymbolDOM());\r\n\t\tsvals.appendChild(secondip);\r\n\t}\r\n\td.appendChild(svals);\t\r\n\tvar but = document.createElement(\"button\");\r\n\tbut.setAttribute(\"class\", \"terminus-change-range\");\r\n\tvar txt = this.showing_range ? \"Change to Simple Value\" : \"Change to Uncertain Range\";\r\n\tbut.appendChild(document.createTextNode(txt));\r\n\td.appendChild(but);\t\r\n\tvar self = this;\r\n\tbut.addEventListener(\"click\", function(){\r\n\t\tif(self.showing_range){\r\n\t\t\tself.showing_range = false;\r\n\t\t\tsecondip.value = \"\";\t\t\t\t\r\n\t\t\tTerminusClient.FrameHelper.removeChildren(svals);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tself.showing_range = true;\r\n\t\t\tsecondip.value = \"\";\t\t\t\t\r\n\t\t\tsvals.appendChild(getRangeSymbolDOM());\r\n\t\t\tsvals.appendChild(secondip);\r\n\t\t}\r\n\t\tvar txt = self.showing_range ? \"Change to Simple Value\" : \"Change to Uncertain Range\";\r\n\t\tbut.innerText = txt;\r\n\t\tchangeHandler();\r\n\t});\r\n\tvar changeHandler = function(){\r\n\t\tif(self.showing_range && secondip.value){\r\n\t\t\tif(firstip.value) frame.set(\"[\" + firstip.value + \",\" + secondip.value + \"]\");\t\t\t\t\r\n\t\t\telse frame.set(secondip.value);\t\t\t\t\r\n\t\t}\r\n\t\telse {\r\n\t\t\tframe.set(firstip.value);\r\n\t\t}\r\n\t}\r\n\tfirstip.addEventListener(\"change\", changeHandler);\r\n\tsecondip.addEventListener(\"change\", changeHandler);\r\n\treturn d;\r\n}\r\n\r\nfunction getRangeSymbolDOM(){\r\n\tvar d = document.createElement(\"span\");\r\n\td.setAttribute(\"class\", \"terminus-range-indicator\");\r\n\td.setAttribute(\"title\", \"The value is uncertain, it lies somewhere in this range\");\r\n\td.appendChild(document.createTextNode(\" ... \"));\r\n\treturn d;\r\n}\r\n\r\nmodule.exports={HTMLRangeEditor}\r\n","function SantizedHTMLViewer(options){\r\n\tthis.css = ((options && options.css) ? \"literal-value \" + options.css : \"literal-value\");\r\n}\r\n\r\nSantizedHTMLViewer.prototype.render = function(value){\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', this.css);\r\n\tinput.setAttribute('data-value', value);\r\n\tinput.innerHTML = value;\r\n\treturn input;\r\n}\r\n\r\nSantizedHTMLViewer.prototype.renderFrame = function(frame, dataviewer){\r\n\tvar value = frame.get();\r\n\treturn this.render(value);\r\n}\r\n\r\nSantizedHTMLViewer.prototype.renderValue = function(dataviewer){\r\n\treturn this.render(dataviewer.value());\r\n}\r\n\r\nmodule.exports={SantizedHTMLViewer}\r\n","const GoogleMapHelper = require(\"./GoogleMapHelper\")\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\nfunction GoogleMapEditor(options){}\r\n\r\nGoogleMapEditor.prototype.renderFrame = function(frame, dataviewer){\r\n\tvar mapcontainer = document.createElement(\"div\");\r\n\tmapcontainer.setAttribute('class', \"gmap-window gmap-editor\");\r\n\tvar self = this;\r\n\tvar ghelper = new GoogleMapHelper();\r\n\tvar map = ghelper.initMap(mapcontainer, value, this.type);\r\n    if(ty == \"xdd:coordinate\"){\r\n\t    google.maps.event.addListener(map, 'click', function(event) {\r\n\t    \tvar position = event.latLng;\r\n\t    \tvar coo = \"[\" + position.lat() + \",\" + position.lng() + \"]\";\r\n\t    \trenderer.set(coo);\r\n\t        ghelper.clearMarkers();\r\n\t        var init = {\r\n\t    \t\tposition: position, \r\n\t    \t\tmap: map\r\n\t    \t}\r\n\t    \tvar marker = new google.maps.Marker(init);\r\n\t    \tghelper.markers.push(marker);\r\n\t  \t});\r\n\t}\r\n    else {\r\n    \tgoogle.maps.event.addListener(map, 'click', function(event) {\r\n        \tvar path = ghelper.polyline.getPath();\r\n        \tpath.push(event.latLng);\r\n      \t    var position = event.latLng;\r\n      \t    ghelper.addMarker(position, map, frame, '#' + path.getLength(), this.type);\r\n      \t});\r\n    }\r\n    return mapcontainer;\r\n}\r\n\r\nmodule.exports={GoogleMapEditor};","function GoogleMapHelper(options){\r\n\tthis.polygon = false;\r\n\tthis.polyline = false;\r\n\tthis.markers = [];\r\n\tthis.init(options);\r\n}\r\n\r\nGoogleMapHelper.prototype.init = function(config){\r\n\tthis.type = ((config && config.type) ? config.type: 'Shape'); \r\n\tthis.width = ((config && config.width) ? config.width : '400px'); \r\n\tthis.height = ((config && config.height ) ? config.height : '400px'); \r\n\tthis.mapLat = ((config && config.mapLat) ? config.mapLat : '41.9010004'); \r\n\tthis.mapLong = ((config && config.mapLong ) ? config.mapLong : '12.500061500000015');\r\n\tthis.zoom = ((config && config.zoom) ? config.zoom : 3);\r\n\tthis.stroke = ((config && config.stroke) ? config.stroke : { color: '#FF0000', opacity: 0.3, weight: 3});\r\n\tthis.fill = ((config && config.fill) ? config.fill : { color: '#FF0000', opacity: 0.1});\r\n\tthis.line = ((config && config.line) ? config.line : { color: '#000000', opacity: 0.9, weight: 3});\r\n}\r\n\r\nGoogleMapHelper.prototype.destroy = function(){\r\n    this.clear();\r\n} \r\n\r\nGoogleMapHelper.prototype.translatePolygonToArray = function(polygon){\r\n   var data = \"[\";\r\n   var vertices = polygon.getPath();\r\n   var seenValue = false;\r\n   for (var j=0; j<vertices.getLength(); j++){\r\n       if(seenValue){\r\n           data = data + \",\";\r\n       }\r\n       var xy = vertices.getAt(j);\r\n       data = data + \"[\" + xy.lat() + \",\" + xy.lng() + \"]\"\r\n       seenValue = true;\r\n   }\r\n   data = data + \"]\";\r\n   return data;\r\n};\r\n\r\nGoogleMapHelper.prototype.translateArrayToPolygon = function(array){\r\n   var jsonified = JSON.parse(array);\r\n   var output = [];\r\n   for(var i=0;i<jsonified.length;i++){\r\n       var latlong = {}\r\n       latlong.lat = jsonified[i][0];\r\n       latlong.lng = jsonified[i][1];\r\n       output.push(latlong);\r\n   }\r\n   return output;\r\n}\r\n\r\nGoogleMapHelper.prototype.createPolygon = function(coords, map) {\r\n\tvar polygon = new google.maps.Polygon({\r\n        paths: coords,\r\n        strokeColor: this.stroke.color,\r\n        strokeOpacity: this.stroke.opacity,\r\n        strokeWeight: this.stroke.weight,\r\n        fillColor: this.fill.color,\r\n        fillOpacity: this.fill.opacity\r\n\t});\r\n    polygon.setMap(map);\r\n\treturn polygon;\r\n}\r\n\r\nGoogleMapHelper.prototype.createPolyline = function(coords){\r\n\tvar init = {\r\n\t      strokeColor: this.line.color,\r\n\t      strokeOpacity: this.line.opacity,\r\n\t      strokeWeight: this.line.weight\r\n\t};\r\n\tif(coords){\r\n\t\tinit.paths = coords;\r\n\t}\r\n\tvar poly = new google.maps.Polyline(init);\r\n\treturn poly;\r\n}\r\n\r\nGoogleMapHelper.prototype.clearMarkers = function() {\r\n\tfor (var i = 0; i < this.markers.length; i++ ) {\r\n\t\tthis.markers[i].setMap(null);\r\n\t}\r\n\tthis.markers.length = 0;\r\n}\r\n\r\n\r\nGoogleMapHelper.prototype.addMarker = function(position, map, frame, title, ty) {\r\n\tvar init = {\r\n\t\tposition: position, \r\n\t\tmap: map\r\n\t}\r\n\tif(title){\r\n\t\tinit.title = title;\r\n\t}\r\n\tvar marker = new google.maps.Marker(init);\r\n\tvar self = this;\r\n\tif(this.markers.length == 0 && ty == \"xdd:coordinatePolygon\"){\r\n     \tmarker.addListener('click', function() {\r\n\t\t\tvar coords = self.getCoordsFromMarkers();\r\n    \t\tself.polygon = self.createPolygon(coords, map);\r\n            self.clearMarkers();\r\n            self.polyline.setMap(null);\r\n            frame.set(self.translatePolygonToArray(self.polygon));\r\n        });                \t\r\n    }\r\n\tthis.markers.push(marker);\r\n\tif(ty == \"xdd:coordinatePolyline\"){\r\n\t\tvar x = this.translatePolygonToArray(this.polyline);\r\n\t\tframe.set(x);\r\n\t}\r\n\treturn marker;\r\n}\r\n\r\nGoogleMapHelper.prototype.getCoordsFromMarkers = function(){\r\n\treturn this.polyline.getPath();\r\n}\r\n\r\nGoogleMapHelper.prototype.clear = function(){\r\n\tif(this.polygon) {\r\n\t\tthis.polygon.setMap(null);\r\n\t\tthis.polygon = false;\r\n\t}\r\n\tif(this.polyline) {\r\n\t\tthis.clearMarkers();\r\n\t\tthis.polyline.setMap(null);\r\n\t}\r\n}\r\n\r\nGoogleMapHelper.prototype.initMap = function(mapContainer, value, type){\r\n\tmapContainer.style.width = this.width;\r\n\tmapContainer.style.height = this.height;\r\n\tif(typeof google == \"undefined\"){\r\n\t\talert(\"google is not effing loaded\");\r\n\t\treturn false;\r\n\t}\r\n\tvar map = new google.maps.Map(mapContainer, {\r\n\t    zoom: this.zoom,\r\n\t\tcenter: {lat: parseFloat(this.mapLat), lng: parseFloat(this.mapLong)}  \r\n\t});\r\n\tif(type == \"xdd:coordinatePolygon\"){\r\n\t    this.polyline = this.createPolyline();\r\n\t\tthis.polyline.setMap(map);\r\n\t\tvar coords = (value ? this.translateArrayToPolygon(value) : []);\r\n\t\tif(value){\r\n\t    \tthis.polygon = this.createPolygon(coords, map);\r\n\t    }\r\n\t}\r\n\telse if(type == \"xdd:coordinatePolyline\"){\r\n\t\tvar coords = (value ? this.translateArrayToPolygon(value) : []);\r\n\t    this.polyline = this.createPolyline();\r\n\t\tthis.polyline.setMap(map);\t\t\r\n\t\tif(value){\r\n\t    \tthis.polyline.setPath(coords);\r\n\t    }\r\n\t}\t\r\n\telse if(type == \"xdd:coordinate\"){\r\n\t\tif(value){\r\n\t\t\tthis.clearMarkers();\r\n            var lat = parseFloat(value.substring(1, value.indexOf(\",\")));\r\n\t\t\tvar long = parseFloat(value.substring(value.indexOf(\",\")+1, value.length-1));\r\n            var init = {\r\n            \tposition: {lat: lat, lng: long},\r\n        \t\tmap: map\r\n\t        }\r\n\t        var marker = new google.maps.Marker(init);\r\n\t        this.markers.push(marker);\r\n\t\t}\r\n\t}\r\n    google.maps.event.trigger(map, 'resize');\r\n    return map;\r\n}\r\n\r\nmodule.exports=GoogleMapHelper;","const GoogleMapHelper = require(\"./GoogleMapHelper\")\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction GoogleMapViewer(options){}\r\n\r\nGoogleMapViewer.prototype.renderFrame = function(frame, dataviewer){\r\n\treturn this.render(frame.get());\r\n}\r\n\r\nGoogleMapViewer.prototype.renderValue = function(dataviewer){\r\n\treturn this.render(dataviewer.value());\r\n}\r\n\t\r\nGoogleMapViewer.prototype.render = function(value){\r\n\tvar map = document.createElement(\"div\");\r\n\tmap.setAttribute('class', \"gmap-window gmap-viewer\");\r\n\tvar self = this;\r\n\tvar ghelper = new GoogleMapHelper();\r\n\tghelper.initMap(map, value, this.type);\t\t\r\n    return map;\r\n}\r\n\r\nmodule.exports={GoogleMapViewer};","const TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction HTMLMarkupEditor(options){}\r\n\r\nHTMLMarkupEditor.prototype.renderFrame = function(frame, dataviewer){\r\n\tvar value = frame.get();\r\n\tvar input = document.createElement(\"div\");\r\n\tinput.setAttribute('class', \"html-wysiwyg\");\r\n\tvar inner = document.createElement(\"span\");\r\n\tinner.setAttribute('class', \"html-literal literal-value\");\r\n\tinner.innerHTML=value;\r\n\tinput.appendChild(inner);\r\n\tif(typeof Quill != \"undefined\"){\r\n\t\tvar quill = new Quill(inner, { theme: 'snow' });\r\n\t\tquill.on(\"text-change\", function(){\r\n\t\t\tframe.set(quill.root.innerHTML);\r\n\t\t});\r\n\t}\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={HTMLMarkupEditor}","function S2EntityEditor(options){}\r\n\r\nS2EntityEditor.prototype.renderFrame = function(frame, dataviewer){\r\n\tvar value = frame.get();\r\n\tvar cls = frame.range();\r\n\tvar cback = frame.set;\r\n\tvar ctl = dataviewer.getClient();\r\n\tvar d2ch = new TerminusDocumentChooser(ctl, cls, value);\r\n\td2ch.change = function(val){\r\n\t\tframe.set(val);\r\n\t}\r\n\td2ch.view = \"label\";\r\n\tvar d2dom = d2ch.getAsDOM();\r\n\treturn d2dom;\r\n}\r\n\r\n\r\nmodule.exports={S2EntityEditor}","/*\r\n * User Interface elements dealing with database level functions - view, delete, create, db\r\n * view document etc\r\n */\r\nconst UTILS=require('./Utils');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\nconst WOQLRule = require(\"./viewer/WOQLRule\");\r\nconst QueryPane = require(\"./html/QueryPane\");\r\nconst TerminusFrame = require(\"./viewer/TerminusFrame\");\r\nconst DocumentPane = require(\"./html/DocumentPane\");\r\n\r\n\r\n/*\r\n * User Interface elements dealing with database level functions - view, delete, create, db\r\n * view document etc\r\n */\r\nfunction TerminusDBController(ui){\r\n\t this.ui = ui;\r\n}\r\n\r\n/*\r\n * Controller provides access to the server level functions (create/delete db) and db-level functions (schema, query, document)\r\n * Populates left hand column on dashboard page\r\n */\r\nTerminusDBController.prototype.getAsDOM = function(){\r\n\tvar self = this;\r\n\tvar dbc = document.createElement(\"div\");\r\n\tdbc.setAttribute(\"class\", \"terminus-db-controller\");\r\n\tif(this.ui && this.ui.db()){\r\n\t\tvar scd = document.createElement(\"div\");\r\n\t\tscd.setAttribute(\"class\", \"terminus-field terminus-db-connection\");\r\n\t\tvar dbrec = this.ui.client.connection.getDBRecord();\r\n\t\tvar nm = (dbrec && dbrec[\"rdfs:label\"] && dbrec[\"rdfs:label\"][\"@value\"] ? dbrec[\"rdfs:label\"][\"@value\"] : this.ui.db());\r\n\t\t//dbc.appendChild(scd);\r\n\t\tvar nav = document.createElement('div');\r\n\t\tnav.setAttribute('class', 'span3');\r\n\t\tdbc.appendChild(nav);\r\n\t\tvar ul = document.createElement('ul');\r\n\t\tul.setAttribute('class','terminus-ul' );\r\n\t\tnav.appendChild(ul);\r\n\t\t// connected to db\r\n\t\tvar a = document.createElement('a');\r\n        a.setAttribute('class', 'terminus-dashboard-info terminus-a terminus-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer\"');\r\n        a.appendChild(document.createTextNode(nm));\r\n\t\tul.appendChild(a);\r\n\t\tvar p = this.ui.page ? this.ui.page : \"db\";\r\n\t\tif(this.ui.showControl(\"db\")){\r\n\t\t\tif(p == \"db\") a.classList.add(\"terminus-selected\");\r\n\t\t\tself.ui.page = \"db\";\r\n\t\t\ta.addEventListener(\"click\", function(){\r\n\t\t\t\tself.ui.showDBMainPage();\r\n\t\t\t\tself.ui.page = \"db\";\r\n\t\t\t\tself.ui.redrawControls();\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tif(this.ui.showControl(\"get_document\")){\r\n\t\t\tvar item = this.getControlHTML(\"Documents\", \"fas fa-file\");\r\n\t\t\tif(p == \"docs\") item.classList.add(\"terminus-selected\");\r\n\t\t    item.addEventListener(\"click\", function(){\r\n\t\t\t\tself.ui.showDocumentPage();\r\n\t\t\t\tself.ui.page = \"docs\";\r\n\t\t\t\tself.ui.redrawControls();\r\n\t\t\t });\r\n\t        ul.appendChild(item);\r\n\t    }\r\n\t\tif(this.ui.showControl(\"delete_database\")){\r\n\t\t\tvar item = this.getControlHTML(\"Delete Database\", \"fa-trash-alt\");\r\n\t\t    item.addEventListener(\"click\", function(){\r\n\t\t\t\tUTILS.activateSelectedNav(this, self);\r\n\t\t\t\tself.ui.deleteDatabase();\r\n\t\t\t });\r\n\t        ul.appendChild(item);\r\n\t\t}\r\n\t\tif(this.ui.showControl(\"woql_select\")){\r\n\t\t\tvar item = this.getControlHTML(\"Query\", \"fa-search\");\r\n\t\t\tif(p == \"query\") item.classList.add(\"terminus-selected\");\r\n\t\t    item.addEventListener(\"click\", function(){\r\n\t\t\t\tUTILS.activateSelectedNav(this, self);\r\n\t\t\t\tself.ui.page = \"query\";\r\n\t\t\t\tself.ui.showQueryPage();\r\n\t\t\t\tself.ui.redrawControls();\r\n\t\t\t});\r\n\t        ul.appendChild(item);\r\n\t\t}\r\n\t\tif(this.ui.showControl(\"get_schema\")){\r\n\t\t\tvar item = this.getControlHTML(\"Schema\", \"fa-cog\");\r\n\t\t\tif(p == \"schema\") item.classList.add(\"terminus-selected\");\r\n\t        item.addEventListener(\"click\", function(){\r\n\t\t\t\tUTILS.activateSelectedNav(this, self);\r\n\t\t\t\tself.ui.page = \"schema\";\r\n\t\t\t\tself.ui.showSchemaPage();\r\n\t\t\t\tself.ui.redrawControls();\r\n\t\t\t})\r\n\t        ul.appendChild(item);\r\n\t\t}\r\n\t}\r\n\treturn dbc;\r\n}\r\n\r\n\r\nTerminusDBController.prototype.getControlHTML = function(text, ic, css){\r\n    var self = this;\r\n    var a = document.createElement('a');\r\n\ta.setAttribute('class', 'terminus-a terminus-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\r\n    var icon = document.createElement('i');\r\n    icon.setAttribute('class', 'terminus-menu-icon fa ' + ic);\r\n    a.appendChild(icon);\r\n    var txt = document.createTextNode(text);\r\n    a.appendChild(txt);\r\n    return a;\r\n}\r\n\r\n\r\n/**\r\n * DB home page main function\r\n * @param {TerminusUI} ui\r\n */\r\nfunction TerminusDBViewer(ui){\r\n\tthis.ui = ui;\r\n\tthis.container = document.createElement(\"span\");\r\n\tthis.container.setAttribute(\"class\", \"terminus-main-page\");\r\n\tthis.pages = [\"home\"];\r\n}\r\n\r\nTerminusDBViewer.prototype.getAsDOM = function(){\r\n\tTerminusClient.FrameHelper.removeChildren(this.container);\r\n\tvar limit = 20;\r\n\tvar WOQL = TerminusClient.WOQL;\r\n\tvar dburl = this.ui.client.connectionConfig.dbURL();\r\n\tvar q = WOQL.from(dburl).limit(limit).documentMetadata();\r\n\tq.execute(this.ui.client).then( (result) => {\r\n\t\tvar docs = new TerminusClient.WOQLResult(result, q);\r\n\t\tvar q2 = WOQL.from(dburl).concreteDocumentClasses();\r\n\t\tq2.execute(this.ui.client).then( (result2) => {\r\n\t\t\tvar docClasses = new TerminusClient.WOQLResult(result2, q2);\r\n\t\t\tvar bdom = this.getBodyAsDOM(docs, docClasses);\r\n\t\t\tif(bdom) this.container.appendChild(bdom);\r\n\t\t});\r\n\t}).catch((e) => {\r\n\t\tthis.ui.showError(e);\r\n\t});\r\n\treturn this.container;\r\n}\r\n\r\nTerminusDBViewer.prototype.getRulesForListOfDocuments = function(woql) {\r\n\tvar table = woql.table();\r\n\ttable.column('Label').header('Document');\r\n\ttable.column('Comment').header('Description');\r\n\ttable.column('Type_Comment').header('Type Description');\r\n\treturn table;\r\n}\r\n\r\nTerminusDBViewer.prototype.getRulesForGraphOfDocuments = function(woql){\r\n\tvar graph = woql.graph();\r\n\tgraph.height(500).width(1250);\r\n\treturn graph;\r\n}\r\n\r\nTerminusDBViewer.prototype.getBodyAsDOM = function(docs, docClasses){\r\n\t if(this.page == \"docs\"){\r\n\t\t return this.getDocumentsDOM(docs, docClasses);\r\n\t }\r\n\t else {\r\n\t\t return this.getHomeDOM(docs, docClasses);\r\n\t }\r\n}\r\n\r\nTerminusDBViewer.prototype.getHomeDOM = function(docs, docClasses){\r\n\tif(this.body){\r\n\t\tTerminusClient.FrameHelper.removeChildren(this.body);\r\n\t}\r\n\telse {\r\n\t\tthis.body = document.createElement(\"div\");\r\n\t\tthis.body.setAttribute(\"class\", \"terminus-home-body terminus-document-view\");\r\n\t\t//this.body.setAttribute('style', 'display: table-caption;');\r\n\t}\r\n\tthis.body.appendChild(this.showHappyBox(\"dbhome\", \"demo\"));\r\n\treturn this.body;\r\n}\r\n\r\n\r\nTerminusDBViewer.prototype.getDocumentsDOM = function(docs, docClasses){\r\n\tvar WOQL = TerminusClient.WOQL;\r\n\tvar self = this;\r\n\tif(this.body){\r\n\t\tTerminusClient.FrameHelper.removeChildren(this.body);\r\n\t\tvar body = this.body;\r\n\t}\r\n\telse {\r\n\t\tvar body = document.createElement(\"div\");\r\n\t\tbody.setAttribute(\"class\", \"terminus-home-body terminus-document-view\");\r\n\t\t//body.setAttribute('style', 'display: table-caption;');\r\n\t}\r\n\tvar page_actions = document.createElement(\"div\");\r\n\tpage_actions.setAttribute(\"class\", \"terminus-home-actions\");\r\n\tbody.appendChild(page_actions);\r\n\tvar span = document.createElement('span');\r\n\tspan.setAttribute('class', 'terminus-display-flex');\r\n\tpage_actions.appendChild(span);\r\n\tif(docClasses.count() > 0){\r\n\t\tvar ch = function(cls){\r\n\t\t\tif(cls)\tself.loadCreateDocumentPage(cls);\r\n\t\t}\r\n\t\tvar dchooser = this.getCreateDataChooser(docClasses,\r\n\t\t\t\t\t\t\t\t\t\t\t\t{showQuery: false, editQuery: false},\r\n\t\t\t\t\t\t\t\t\t\t\t\t{showConfig: false, editConfig: true},\r\n\t\t\t\t\t\t\t\t\t\t\t\t ch );\r\n\t\tif(docs.count() > 1) span.appendChild(dchooser);\r\n\t}\r\n\telse {\r\n\t\tthis.ui.showError(\"No document classes found in schema - you must define a document, entity or relationship class before you can create documents\");\r\n\t}\r\n\tif(docs.count() > 0){\r\n\t\tvar show_doc_action = this.getShowDocumentControl();\r\n\t\tspan.prepend(show_doc_action);\r\n\t\tvar dp = new QueryPane(this.ui.client, docs.query, docs)\r\n\t\t\t\t\t.options({showQuery: \"icon\", editQuery: true});\r\n\t\tvar table = this.getRulesForListOfDocuments(WOQL);\r\n\t\tvar g = this.getRulesForGraphOfDocuments(WOQL);\r\n\t\tvar options =  { showConfig: \"icon\", editConfig: \"true\", viewers: [g]};\r\n\t\tdp.addView(table, options);\r\n\t\tbody.appendChild(UTILS.getHeaderDom('Table view of documents'));\r\n\t\tbody.appendChild(dp.getAsDOM());\r\n\t\tvar WOQL = TerminusClient.WOQL;\r\n\t\tvar dburl = this.ui.client.connectionConfig.dbURL();\r\n\t\tvar q = WOQL.from(dburl).limit(1000).documentMetadata();\r\n\t\tq.execute(this.ui.client).then( (result) => {\r\n\t\t\tvar g = new TerminusClient.WOQLResult(result, q);\r\n\t\t\tvar ddp = new QueryPane(this.ui.client, g.query, g).options({showQuery: \"icon\", editQuery: false});\r\n\t\t\tvar g2 = this.getRulesForGraphOfDocuments(WOQL);\r\n\t\t\tvar options =  { showConfig: \"icon\", editConfig: \"true\", viewers: [table] };\r\n\t\t\tbody.appendChild(UTILS.getHeaderDom('Graph view of Documents linked to each other'));\r\n\t\t\tddp.addView(g2, options);\r\n\t\t\tbody.appendChild(ddp.getAsDOM());\r\n\t\t\tthis.container.appendChild(body);\r\n\t\t}).catch((e) => {\r\n\t\t\tthis.ui.showError(e);\r\n\t\t});\r\n\t}\r\n\telse {\r\n\t\tif(docClasses.count() == 3){\r\n\t\t\tbody.appendChild(this.showHappyBox(\"empty\", \"schema\"));\r\n\t\t\tbody.appendChild(this.showHappyBox(\"empty\", \"query\"));\r\n\t\t\tbody.appendChild(this.showHappyBox(\"empty\", \"docs\", dchooser));\r\n\t\t}\r\n\t\telse {\r\n\t\t\tbody.appendChild(this.showHappyBox(\"happy\", \"schema\"));\r\n\t\t\tbody.appendChild(this.showHappyBox(\"happy\", \"docs\", dchooser));\r\n\t\t\tbody.appendChild(this.showHappyBox(\"happy\", \"query\"));\r\n\t\t}\r\n\t}\r\n\tthis.body = body;\r\n\treturn body;\r\n}\r\n\r\n\r\nTerminusDBViewer.prototype.getDeleteOnHomePage = function(d){\r\n\t// delete database\r\n\tif(this.ui.db() == \"terminus\") return;\r\n\tTerminusClient.FrameHelper.removeChildren(this.container);\r\n    var del = document.createElement('button');\r\n    del.setAttribute('class', 'terminus-btn terminus-btn-float-right terminus-home-del');\r\n    del.setAttribute('type', 'button');\r\n\tdel.appendChild(document.createTextNode('Delete Database'));\r\n\tvar di = document.createElement(\"i\");\r\n\tdi.setAttribute(\"class\", \"fa fa-trash terminus-icon-padding\");\r\n\tdel.appendChild(di);\r\n\tvar dbrec = this.ui.getDBRecord();\r\n\tif(dbrec)\r\n\t\tvar nm = (dbrec[\"rdfs:label\"] && dbrec[\"rdfs:label\"][\"@value\"] ? dbrec[\"rdfs:label\"][\"@value\"] : this.ui.db());\r\n\telse var nm = this.ui.db();\r\n    var self = this;\r\n    var dbdel = this.ui.db();\r\n    del.addEventListener(\"click\", function(){\r\n      \tvar deleteConfirm = confirm(`Do you really want to delete database ${nm} with id: ${dbdel} ?`);\r\n\t\tif (deleteConfirm == true) {\r\n\t\t\tself.ui.deleteDatabase(dbdel);\r\n\t\t}\r\n    });\r\n    d.appendChild(del);\r\n}\r\n\r\n\r\nTerminusDBViewer.prototype.styleCreateDocumentChooser = function(){\r\n\tvar select = document.getElementsByClassName('woql-chooser');\r\n\tfor(i=0; i<select.length; i++){\r\n\t\tif(select[i].type == 'select'){\r\n\t\t\tselect[i].classList.add('terminus-form-doc-value');\r\n\t\t\tvar self = this;\r\n\t\t\tselect[i].addEventListener('change', function(){\r\n\t\t\t\tself.showCreateDocument(this.value);\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n}\r\n\r\nTerminusDBViewer.prototype.getCreateDataChooser = function(docClasses, qopts, ropts, change, pholder){\r\n\tvar WOQL = TerminusClient.WOQL;\r\n\tpholder = (pholder ? pholder : \"Create a New Document\");\r\n\tqopts  = (qopts ? qopts :  { showConfig: \"icon\", editConfig: \"true\" });\r\n\tvar dp = new QueryPane(this.ui.client, docClasses.query, docClasses).options(qopts);\r\n\tvar chooser = WOQL.chooser().values(\"Class\").labels(\"Label\").titles(\"Comment\").show_empty(pholder);\r\n\r\n\tvar self = this;\r\n\tchooser.change = (change ? change : function(cls){\r\n\t\tif(cls)\tself.loadCreateDocumentPage(cls);\r\n\t});\r\n\tropts  = (ropts ? ropts :  { showConfig: \"icon\", editConfig: \"true\" });\r\n\tdp.addView(chooser, ropts);\r\n\tvar dchooser = dp.getAsDOM();\r\n\treturn dchooser;\r\n}\r\n\r\nTerminusDBViewer.prototype.showHappyBox = function(happy, type, chooser){\r\n\tvar hbox = document.createElement(\"div\");\r\n\thbox.setAttribute(\"class\", \"terminus-welcome-box terminus-no-res-alert\");\r\n\tvar self = this;\r\n\tvar sets = {};\r\n\tif(type == \"schema\"){\r\n\t\tsets.title = (happy == \"happy\") ? \"Document Classes Created\" : \"No Schema Created\";\r\n\t\tsets.text = (happy == \"happy\") ? \"You have successfully created a schema with valid document classes!\" : \"You should create a schema and add at least one document classes before you add data to the system\";\r\n\t\tsets.css = \"fa fa-cog fa-2x terminus-welcome-icons\";\r\n\t}\r\n\telse if(type == \"docs\"){\r\n\t\tsets.css = \"fa fa-book fa-2x terminus-welcome-icons\";\r\n\t\tsets.title = \"Create Documents\";\r\n\t\tsets.text = (happy == \"happy\") ? \"Add data to the system through easy to use automatically generated forms for each document type\" : \"You should create a schema and add at least one document classes before you add data to the system\";\r\n\t}\r\n\telse if(type == \"query\"){\r\n\t\tsets.css = \"fa fa-search fa-2x terminus-welcome-icons\";\r\n\t\tsets.title = \"Update Queries\";\r\n\t\tsets.text = (happy == \"happy\") ? \"You can add data to the system with queries and scripts, and import data directly from CSVs and URLs\" : \"You can write WOQL queries to create a schema through our query interface\";\r\n\t}\r\n\telse if(type == \"demo\"){\r\n\t\tsets.css = \"fa fa-question fa-2x\";\r\n\t\tsets.title = \"Database Level Management\";\r\n\t\tsets.text = \"On this level we just want functions that have database granularity - collaboration, access control, database meta-data...\";\r\n\t}\r\n\tvar ispan =  document.createElement(\"span\");\r\n\tvar ic = document.createElement(\"i\");\r\n\tic.setAttribute(\"class\", sets.css);\r\n\tispan.appendChild(ic);\r\n\thbox.appendChild(ispan);\r\n\tvar htit = document.createElement(\"span\");\r\n\thtit.appendChild(document.createElement(\"strong\").appendChild(document.createTextNode(sets.title)));\r\n\thtit.classList.add('terminus-welcome-title');\r\n\thbox.appendChild(htit);\r\n\tvar body = document.createElement(\"p\");\r\n\tbody.setAttribute('class', 'terminus-welcome-body');\r\n\tbody.appendChild(document.createTextNode(sets.text));\r\n\thbox.appendChild(body);\r\n\tif(type == \"schema\"){\r\n\t\thbox.addEventListener(\"click\", function(){\r\n\t\t\tself.ui.page = \"schema\";\r\n\t\t\tself.ui.showSchemaPage();\r\n\t\t\tself.ui.redrawControls();\r\n\t\t});\r\n\t};\r\n\tif(type == \"query\"){\r\n\t\thbox.addEventListener(\"click\", function(){\r\n\t\t\tself.ui.page = \"query\";\r\n\t\t\tself.ui.showQueryPage();\r\n\t\t\tself.ui.redrawControls();\r\n\t\t});\r\n\t};\r\n\tif(type == \"query\" || type == \"schema\"){\r\n\t\thbox.addEventListener('mouseover', function(){\r\n            this.style.cursor = \"pointer\";\r\n\t\t});\r\n\t}\r\n\tif(type == \"docs\"){\r\n\t\tvar sp = document.createElement('span');\r\n\t\tsp.setAttribute('class', 'terminus-welcome-chooser');\r\n\t\tsp.appendChild(chooser);\r\n\t\thbox.appendChild(sp);\r\n\t}\r\n\treturn hbox;\r\n}\r\n\r\nTerminusDBViewer.prototype.loadCreateDocumentPage = function(cls){\r\n\tthis.ui.page = \"docs\";\r\n\tthis.ui.redrawControls();\r\n\tvar WOQL = TerminusClient.WOQL;\r\n\tvar dburl = this.ui.client.connectionConfig.dbURL();\r\n\r\n\tvar df = new DocumentPane(this.ui.client).options({\r\n\t\tshowQuery: \"icon\",\r\n\t\teditQuery: false,\r\n\t\tloadDocument: this.getShowDocumentControl(),\r\n\t});\r\n\tvar q2 = WOQL.from(dburl).concreteDocumentClasses();\r\n\tq2.execute(this.ui.client).then( (result2) => {\r\n\t\tvar docClasses = new TerminusClient.WOQLResult(result2, q2);\r\n\t\tvar dchooser = this.getCreateDataChooser(docClasses, {showQuery: \"icon\", editQuery: false},  { showConfig: \"icon\", editConfig: \"true\" } );\r\n\t\tdf.setClassLoader(dchooser);\r\n\t});\r\n\tvar config = WOQL.document().load_schema(true);\r\n\tconfig.show_all(\"SimpleFrameViewer\");\r\n\tconfig.object().features(\"id\", \"type\", \"comment\", \"delete\", \"reset\", \"hide\", \"show\", \"clone\", \"update\", \"view\", \"add\", \"value\").mode(\"edit\");//\"summary\", \"viewer\", \"status\",\r\n\tconfig.property().features(\"value\", \"label\").mode(\"edit\");//features(\"id\", \"cardinality\", \"type\", \"comment\", \"delete\", \"reset\", \"hide\", \"show\", \"clone\", \"update\", \"view\", \"add\", \"value\");//\"summary\", \"status\",\r\n\tconfig.data().features(\"value\").mode(\"edit\");//.dataviewer(\"HTMLStringViewer\").args({max_cell_size: 20, max_word_size: 10});\r\n\r\n\tdf.loadClass(cls, config).then(() => {\r\n\t\tthis.pages.push(\"New \" + cls);\r\n\t\tTerminusClient.FrameHelper.removeChildren(this.container);\r\n\t\tvar nav = this.getNavigationDOM();\r\n\t\tthis.container.appendChild(nav);\r\n\t\tthis.container.appendChild(df.getAsDOM());\r\n\t});\r\n}\r\n\r\nTerminusDBViewer.prototype.getNavigationDOM = function(){\r\n\tvar s = document.createElement(\"span\");\r\n\ts.setAttribute('class', 'terminus-back-to-home terminus-backtohome-span');\r\n\tvar i = document.createElement(\"span\");\r\n\ti.setAttribute(\"class\", \"fa fas fa-arrow-left\");\r\n\ts.appendChild(i);\r\n\tvar p =  this.pages[this.pages.length-2];\r\n\ts.appendChild(document.createTextNode(\" back to \" + p));\r\n\ts.addEventListener(\"click\", () => {\r\n\t\tvar pp = this.pages.pop();\r\n\t\tp =  this.pages[this.pages.length-1];\r\n\t\tif(p == \"home\"){\r\n\t\t\t//this.ui.page = \"docs\";\r\n\t\t\tthis.getAsDOM();\r\n\t\t}\r\n\t\telse {\r\n\t\t\tpp = this.pages.pop();\r\n\t\t\tthis.showDocumentPage(pp);\r\n\t\t}\r\n\t});\r\n\ts.addEventListener('mouseover', function(){\r\n\t\tthis.style.cursor = \"pointer\";\r\n\t});\r\n\treturn s;\r\n}\r\n\r\nTerminusDBViewer.prototype.showDocumentPage = function(docid){\r\n\tthis.ui.page = \"docs\";\r\n\tthis.ui.redrawControls();\r\n\tvar start = docid.substring(0, 4);\r\n\tif(start != \"doc:\" && start != \"http\") docid = \"doc:\" + docid;\r\n\tvar WOQL = TerminusClient.WOQL;\r\n\tvar dburl = this.ui.client.connectionConfig.dbURL();\r\n\tvar df = new DocumentPane(this.ui.client).options({\r\n\t\tshowQuery: \"icon\",\r\n\t\teditQuery: true,\r\n\t\tloadDocument: this.getShowDocumentControl(),\r\n\t});\r\n\tvar q2 = WOQL.from(dburl).concreteDocumentClasses();\r\n\tq2.execute(this.ui.client).then( (result2) => {\r\n\t\tvar docClasses = new TerminusClient.WOQLResult(result2, q2);\r\n\t\tvar dchooser = this.getCreateDataChooser(docClasses, {showQuery: \"icon\", editQuery: false},  { showConfig: \"icon\", editConfig: \"true\" } );\r\n\t\tdf.setClassLoader(dchooser);\r\n\t});\r\n\r\n\r\n\tvar config = WOQL.document().load_schema(true);\r\n\tconfig.show_all(\"SimpleFrameViewer\");\r\n\tconfig.object().features(\"id\", \"type\", \"comment\", \"delete\", \"reset\", \"hide\", \"show\", \"clone\", \"update\", \"view\", \"add\", \"value\");//\"summary\", \"viewer\", \"status\",\r\n\tconfig.property().features(\"value\");//features(\"id\", \"cardinality\", \"type\", \"comment\", \"delete\", \"reset\", \"hide\", \"show\", \"clone\", \"update\", \"view\", \"add\", \"value\");//\"summary\", \"status\",\r\n\tconfig.data().features(\"value\");//.dataviewer(\"HTMLStringViewer\").args({max_cell_size: 20, max_word_size: 10});\r\n\r\n\tdf.loadDocument(docid, config).then(() => {\r\n\t\tthis.pages.push(docid);\r\n\t\tTerminusClient.FrameHelper.removeChildren(this.container);\r\n\t\tvar nav = this.getNavigationDOM();\r\n\t\tthis.container.appendChild(nav);\r\n\t\tthis.container.appendChild(df.getAsDOM());\r\n\t\t/*var q = WOQL.from(dburl).limit(100).getDocumentConnections(docid);\r\n\t\tq.execute(this.ui.client).then( (result) => {\r\n\t\t\tvar g = new TerminusClient.WOQLResult(result, q);\r\n\t\t\tvar ddp = new QueryPane(this.ui.client, g.query, g).options({showQuery: \"icon\", editQuery: false});\r\n\t\t\tvar table = WOQL.table();\r\n\t\t\tvar options =  { showConfig: \"icon\", editConfig: \"true\" };\r\n\t\t\tddp.addView(table, options);\r\n\t\t\tbody.appendChild(ddp.getAsDOM());\r\n\t\t})\r\n\t\tvar q2 = WOQL.from(dburl).limit(1000).getDocumentConnections(docid);\r\n\t\tq2.execute(this.ui.client).then( (result2) => {\r\n\t\t\tvar g = new TerminusClient.WOQLResult(result2, q2);\r\n\t\t\tvar ddg = new QueryPane(this.ui.client, g.query, g).options({showQuery: \"icon\", editQuery: false});\r\n\t\t\tvar gr = WOQL.graph();\r\n\t\t\tvar options =  { showConfig: \"icon\", editConfig: \"true\" };\r\n\t\t\tddg.addView(gr, options);\r\n\t\t\tbody.appendChild(ddg.getAsDOM());\r\n\t\t})*/\r\n\t})\r\n\t.catch((e) => this.ui.showError(e));\r\n}\r\n\r\nTerminusDBViewer.prototype.getShowDocumentControl = function(){\r\n\tvar scd = document.createElement(\"span\");\r\n\tscd.setAttribute(\"class\", \"terminus-get-doc terminus-document-chooser terminus-form-horizontal terminus-control-group\");\r\n\tvar lab = document.createElement(\"span\");\r\n\tlab.setAttribute(\"class\", \"terminus-document-chooser-label terminus-doc-control-label terminus-control-label-padding\");\r\n\tvar dcip = document.createElement(\"input\");\r\n\tdcip.setAttribute(\"class\", \"terminus-form-doc-value terminus-document-chooser terminus-doc-input-text\");\r\n\tdcip.setAttribute(\"placeholder\", \"Enter Document ID to view ...\");\r\n\tvar nbut = document.createElement(\"button\");\r\n\tnbut.setAttribute('class', \"terminus-control-button terminus-document-button terminus-btn\");\r\n\tnbut.setAttribute('title', 'Enter Document ID to view');\r\n\tvar is = document.createElement('i');\r\n\tis.setAttribute('class', 'fa fa-caret-left');\r\n\tnbut.appendChild(is);\r\n\tnbut.appendChild(document.createTextNode(\" Load \"));\r\n\tvar i = document.createElement('i');\r\n\ti.setAttribute('class', 'fa fa-caret-right');\r\n\tnbut.appendChild(i);\r\n\tvar self = this;\r\n\tnbut.addEventListener(\"click\", function(){\r\n\t\tif(dcip.value) {\r\n\t\t\tself.showDocumentPage(dcip.value);\r\n\t\t}\r\n\t})\r\n\tdcip.addEventListener(\"keyup\", function(event) {\r\n\t\tevent.preventDefault();\r\n\t\tif (event.keyCode === 13 && dcip.value) {\r\n\t\t\tself.showDocumentPage(dcip.value);\r\n\t\t}\r\n\t});\r\n\tscd.appendChild(lab);\r\n\tscd.appendChild(dcip);\r\n\tscd.appendChild(nbut);\r\n\treturn scd;\r\n}\r\n\r\nTerminusDBViewer.prototype.getDocumentTableConfig = function(nq){\r\n\tvar self = this;\r\n\tvar rowClick = function(row){\r\n\t\tself.ui.showDocument(row['v:ID']);\r\n\t};\r\n\tvar cellClick = function(key, value){\r\n\t\tself.ui.showDocument(value);\r\n\t}\r\n\r\n\tvar opts = {\r\n\t\t//cellClick: cellClick,\r\n\t\trowClick: rowClick,\r\n\t\t\"v:ID\": {\r\n\t\t\thidden: true\r\n\t\t},\r\n\t\t\"v:Class\": {hidden: true },\r\n\t\t\"v:Type_Comment\": {hidden: true },\r\n\t\t\"v:Label\": {\r\n\t\t\theader: \"Document\",\r\n\t\t\trenderer: function(dataviewer){\r\n\t\t\t\treturn dataviewer.annotateValue(dataviewer.value(),\r\n\t\t\t\t\t{ ID: dataviewer.binding('v:ID')});\r\n\t\t\t},\r\n\t\t},\r\n\t\t\"v:Type\": {\r\n\t\t\trenderer: function(dataviewer){\r\n\t\t\t\treturn dataviewer.annotateValue(dataviewer.value(),\r\n\t\t\t\t\t\t{ Class: dataviewer.binding('v:Class'), Description: dataviewer.binding('v:Type_Comment')}\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t},\r\n\t\t\"v:Comment\": {\theader: \"Description\", renderer: \"HTMLStringViewer\", args: {max_cell_size: 40, max_word_size: 10} },\r\n\t\t\"column_order\" : [\"v:Label\", \"v:Type\", \"v:Comment\"]\r\n\t}\r\n\t//return {};\r\n\treturn opts;\r\n}\r\n\r\nTerminusDBViewer.prototype.getExplanation = function(view){\r\n\tvar d = document.createElement('div');\r\n\tvar title = view.charAt(0).toUpperCase() + view.slice(1)\r\n\td.appendChild(UTILS.getHeaderDom(title + ' View'));\r\n\tif(view == 'table')\r\n\t\tvar explaination = 'Below view shows a table view of available documents within the database';\r\n\telse var explaination = 'Below view shows a graph view of how available documents are related to other documents';\r\n\td.appendChild(document.createTextNode(explaination));\r\n\treturn d;\r\n}\r\n\r\nTerminusDBViewer.prototype.getClassesDOM = function(d){\r\n\tvar q = TerminusClient.WOQL\r\n\t\t\t\t.limit(25)\r\n\t\t\t\t.start(0)\r\n\t\t\t\t.documentMetadata();\r\n\tvar self = this;\r\n\tvar rowClick = function(row){\r\n\t\tself.ui.showDocument(row['v:ID']);\r\n\t};\r\n\tvar cellClick = function(key, value){\r\n\t\tself.ui.showDocument(value);\r\n\t}\r\n\r\n\tvar showLabel = function(value, key, row){\r\n\t\tif(value) return document.createTextNode(value['@value'] + \" aa\");\r\n\t\treturn document.createElement(\"span\");\r\n\t}\r\n\tlet nq = new TerminusHTMLViewer(this.ui.client);//should specify default renderers here....\r\n\tlet WOQL = TerminusClient.WOQL;\r\n\tlet query = WOQL.from(this.ui.client.connectionConfig.dbURL()).limit(25).start(0).documentMetadata();\r\n\t//TerminusClient.FrameHelper.loadDynamicCSS(\"myfa\", \"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0-11/css/all.css\");\r\n\tquery.execute(this.ui.client).then((results) => {\r\n\t\tlet qres = new TerminusClient.WOQLResult(results, query);\r\n\t\tvar nt = nq.showResult(qres, WOQL.table(), false);\r\n\t\td.appendChild(this.getExplanation('table'));\r\n\t\td.appendChild(nt);\r\n\t\t/*qres.first()\r\n\t\tvar n = nq.showResult(qres, WOQL.chooser());\r\n\t\td.appendChild(n); */\r\n\t\tqres.first();\r\n\t\tvar lg = WOQL.graph();\r\n\t\tlg.source(\"v:Subject\");\r\n\t\tvar licon2 = { color: [255,255,25], weight: 100, unicode: \"\\uf2bb\", size:2 };\r\n\t\tlg.edge(\"v:Subject\", \"v:Object\").icon(licon2);\r\n\t\tvar ng = nq.showResult(qres, lg, false);\r\n\t\td.appendChild(this.getExplanation('graph'));\r\n\t\td.appendChild(ng);\r\n\t\tqres.first();\r\n\t\t//var sg = nq.showResult(qres, WOQL.stream());\r\n\t\t//d.appendChild(sg);\r\n\t\t//d.appendChild(nc);\r\n\t\t//var ng = nq.displayResults(false, WOQL.graph());\r\n\t\t//d.appendChild(ng);\r\n\t\t/*let t = WOQL.table().pager(false);\r\n\t\tt.column(\"Class\", \"Type_Comment\", \"ID\").hidden(true);\r\n\t\tt.column(\"Label\").header(\"Document\");\r\n\t\tt.column(\"Comment\").header(\"Description\");\r\n\t\tt.column(\"Comment\").renderer(\"HTMLStringViewer\").args({max_cell_size: 20, max_word_size: 10});\r\n\t\t//t.column_order(\"Subject\", \"Predicate\", \"Object\");\r\n\t\tt.column(\"Label\").render(showLabel);\r\n\t\tt.row().click(rowClick);\r\n\t\tqres.first();\r\n\t\tvar dt2 = nq.showResult(qres, t);\r\n\t\td.appendChild(dt2);\r\n\r\n\t\tqres.first();\r\n\t\tvar w = WOQL.chooser().values(\"ID\").labels(\"Comment\").titles(\"Class\").sort(\"Comment\").direction(\"asc\");\r\n\t\tw.change(function(x){\r\n\t\t\talert(x);\r\n\t\t}).show_empty(\"Choose something\");\r\n\t\tvar n2 = nq.showResult(qres, w);\r\n\t\td.appendChild(n2);\r\n\t\tvar licon2 = { color: [255,255,25], weight: 100, unicode: \"\\uf2bb\", size:2 };\r\n\t\tvar licon = { color: [255,255,255], weight: 100, unicode: \"\\uf1c2\"};\r\n\t\tvar licon3 = { color: [23,3,34], weight: 100, unicode: \"\\uf1c2\"};\r\n\t\tvar lborder = { color: [10,255,0], weight: 100, unicode: \"\\uf2bb\", size:2 };\r\n\t\tvar g = WOQL.graph();\r\n\t\tg.source(\"ID\").width(\"1000\").height(1000);//.literals(false);\r\n\t\t//g.node(\"Id\").size(20).color([220, 202, 230]).collisionRadius(100).icon(licon3);\r\n\t\tg.node(\"Object\").size(24).color([20, 20, 20]).icon(licon2);\r\n\t\tg.node().literal(true).color([200, 200, 220]).size(10).icon(licon);\r\n\t\tg.node(\"Predicate\").hidden(true);\r\n\t\t//var e = g.rule().edge(\"ID\", \"Class\").label(x).icon(y).color();\r\n\t\t//var n = g.rule().node(\"ID\").label(x).icon(y).color();\r\n\t\tg.edges([\"Subject\", \"Object\"]);\r\n\t\tg.edge().color([150, 200, 250]);\r\n\t\tqres.first()\r\n\t\tvar ng3 = nq.showResult(qres, g);\r\n\t\td.appendChild(ng3);*/\r\n\t\t/*var x = \"doc:access_all_areas\";\r\n\t\tvar nd = WOQL.document();\r\n\t\tnd.show_all(\"SimpleFrameViewer\");\r\n\t\tnd.object().features(\"id\", \"type\", \"comment\", \"delete\", \"reset\", \"hide\", \"show\", \"clone\", \"update\", \"view\", \"add\", \"value\");//\"summary\", \"viewer\", \"status\",\r\n\t\tnd.property().features(\"value\");//features(\"id\", \"cardinality\", \"type\", \"comment\", \"delete\", \"reset\", \"hide\", \"show\", \"clone\", \"update\", \"view\", \"add\", \"value\");//\"summary\", \"status\",\r\n\t\tnd.data().features(\"value\");//.dataviewer(\"HTMLStringViewer\").args({max_cell_size: 20, max_word_size: 10});\r\n\t\tvar d1 = nq.document(x, nd);\r\n\t\td.appendChild(d1); */\r\n\t});\r\n\t//let c = WOQL.chooser();\r\n\r\n\t//t.display(query);\r\n\t//t.column(\"Label\").header(\"Document\").render(showLabel).click(cellClick);\r\n\t//t.column(\"ID\").header(\"l\").renderer(\"MyRenderer\");\r\n\t//should specify default renderers here....\r\n\t//var qp = nq.querypane(woql, this.getDocumentTableConfig());\r\n\r\n\t//let nquery = WOQL.from(this.ui.client.connectionConfig.dbURL()).limit(1000).simpleGraphQuery();\r\n\t//let g = WOQL.graph();\r\n\t//g.edge(\"v:Source\", \"v:Edge\", \"v:Target\").label(\"bla\").color([23,23,45]).weight(\"v:Account\")\r\n\t//t.column(\"Class\", \"Type_Comment\", \"ID\").hidden(true);\r\n\t//t.column(\"Label\").header(\"Document\").render(showLabel).click(cellClick);\r\n\t//t.column(\"Comment\").header(\"Description\").renderer(\"HTMLStringViewer\").args({max_cell_size: 20, max_word_size: 10});\r\n\t//t.column(\"ID\").header(\"l\").renderer(\"MyRenderer\");\r\n\t//t.order(\"Label\", \"Type\", \"Comment\");\r\n\t//var ng = nq.displayResults(nquery, g);\r\n\t//d.appendChild(ng);\r\n\r\n\r\n\treturn d;\r\n\t/*var q = this.wquery.getClassesQuery(25, 0);\r\n\tvar self = this;\r\n\t//this.wquery.execute(q)\r\n\tq.execute(this.ui.client)\r\n\t.then(function(result){\r\n\t\tvar wqRes = new TerminusClient.WOQLResult(result, q);\r\n\t\tself.result = new WOQLResultsViewer.WOQLResultsViewer(self.ui, result, wqRes, {}, {}, false);\r\n\t\tif(self.result){\r\n\t\t\tvar nd = self.result.getAsDOM(d, false);\r\n\t\t\tif(nd){\r\n\t\t\t\tnd.setAttribute('class', 'terminus-margin-box');\r\n\t        }\r\n\t\t\telse{\r\n\t\t\t\tnor = document.createElement('div');\r\n\t\t\t\tnor.setAttribute('class', 'terminus-no-res-alert');\r\n\t\t\t\tnor.appendChild(document.createTextNode(\"No results available, create new ones to view them here...\"));\r\n\t\t\t\td.appendChild(nor);\r\n\t\t\t}\r\n\t\t}\r\n\t})\r\n\t.catch(function(err){\r\n\t\tconsole.error(err);\r\n\t\tself.ui.showError(err);\r\n\t});\r\n\treturn d;*/\r\n}\r\n\r\n/**\r\n * Class Representing the create Database form\r\n * @param {TerminusUI} ui\r\n */\r\nfunction TerminusDBCreator(ui){\r\n\tthis.ui = ui;\r\n}\r\n\r\nTerminusDBCreator.prototype.getAsDOM = function(selected){\r\n\tvar scd = document.createElement(\"div\");\r\n\tscd.setAttribute(\"class\", \"terminus-db-creator\");\r\n\tvar sct = document.createElement(\"h3\");\r\n\tsct.setAttribute(\"class\", \"terminus-db-creator-title terminus-module-head\");\r\n\tsct.appendChild(UTILS.getHeaderDom(\"Create Database\"));\r\n\tscd.appendChild(sct);\r\n\tvar mfd = document.createElement('div');\r\n\tmfd.setAttribute('class', 'terminus-form-border ');\r\n\tscd.appendChild(mfd);\r\n\tvar dht = document.createElement('div');\r\n\tdht.setAttribute('class', 'terminus-form-margin-top');\r\n\tmfd.appendChild(dht);\r\n\tvar sci = document.createElement(\"div\");\r\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-form-field-spacing terminus-form-horizontal terminus-control-group\");\r\n\tvar slab = document.createElement(\"span\");\r\n\tslab.setAttribute(\"class\", \"terminus-id-label terminus-form-label terminus-control-label\");\r\n\tslab.appendChild(document.createTextNode(\"ID\"));\r\n\tsci.appendChild(slab);\r\n\tvar idip = document.createElement(\"input\");\r\n\tidip.setAttribute(\"type\", \"text\");\r\n\tidip.setAttribute(\"class\", \"terminus-form-value terminus-input-text\");\r\n\tidip.setAttribute(\"placeholder\", \"No spaces or special characters allowed in IDs\");\r\n\tsci.appendChild(idip);\r\n\tmfd.appendChild(sci);\r\n\tvar sci = document.createElement(\"div\");\r\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-form-field-spacing terminus-form-horizontal terminus-control-group\");\r\n\tvar slab = document.createElement(\"span\");\r\n\tslab.setAttribute(\"class\", \"terminus-title-label terminus-form-label terminus-control-label\");\r\n\tslab.appendChild(document.createTextNode(\"Title\"));\r\n\tvar titip = document.createElement(\"input\");\r\n\ttitip.setAttribute(\"type\", \"text\");\r\n\ttitip.setAttribute(\"placeholder\", \"A brief title for the Database\");\r\n\ttitip.setAttribute(\"class\", \"terminus-form-value terminus-input-text\");\r\n\tsci.appendChild(slab);\r\n\tsci.appendChild(titip);\r\n\tmfd.appendChild(sci);\r\n\tvar sci = document.createElement(\"div\");\r\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-form-field-spacing terminus-form-horizontal terminus-control-group\");\r\n\tvar slab = document.createElement(\"span\");\r\n\tslab.setAttribute(\"class\", \"terminus-title-label terminus-form-label terminus-control-label\");\r\n\tslab.appendChild(document.createTextNode(\"Description\"));\r\n\tsci.appendChild(slab);\r\n\tvar descip = document.createElement(\"textarea\");\r\n\tdescip.setAttribute(\"class\", \"terminus-textarea terminus-db-description terminus-textarea \");\r\n\tdescip.setAttribute(\"placeholder\", \"A short text describing the database and its purpose\");\r\n\tsci.appendChild(descip);\r\n\tmfd.appendChild(sci);\r\n\tvar sci = document.createElement(\"div\");\r\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-form-field-spacing terminus-form-horizontal terminus-control-group\");\r\n\tvar slab = document.createElement(\"span\");\r\n\tslab.setAttribute(\"class\", \"terminus-schema-label terminus-form-label terminus-control-label\");\r\n\tslab.appendChild(document.createTextNode(\"Import Schema\"));\r\n\tsci.appendChild(slab);\r\n\tvar schem = document.createElement(\"input\");\r\n\tschem.setAttribute(\"placeholder\", \"Terminus DB URL\");\r\n\tschem.setAttribute(\"type\", \"text\");\r\n\tschem.setAttribute(\"class\", \"terminus-form-value terminus-form-url terminus-input-text\");\r\n\tsci.appendChild(schem);\r\n\tmfd.appendChild(sci);\r\n\r\n\tvar sci = document.createElement(\"div\");\r\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-form-field-spacing terminus-form-horizontal terminus-control-group\");\r\n\tvar slab = document.createElement(\"span\");\r\n\tslab.setAttribute(\"class\", \"terminus-schema-label terminus-form-label terminus-control-label\");\r\n\tslab.appendChild(document.createTextNode(\"Key\"));\r\n\tsci.appendChild(slab);\r\n\tvar kip = document.createElement(\"input\");\r\n\tkip.setAttribute(\"placeholder\", \"Server API Key\");\r\n\tkip.setAttribute(\"type\", \"text\");\r\n\tkip.setAttribute(\"class\", \"terminus-form-value terminus-form-url terminus-input-text\");\r\n\tsci.appendChild(kip);\r\n\tmfd.appendChild(sci);\r\n\r\n\tvar sci = document.createElement(\"div\");\r\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-form-field-spacing terminus-form-horizontal terminus-control-group\");\r\n\tvar slab = document.createElement(\"span\");\r\n\tslab.setAttribute(\"class\", \"terminus-data-label terminus-form-label terminus-control-label\");\r\n\tslab.appendChild(document.createTextNode(\"Import Data\"));\r\n\tsci.appendChild(slab);\r\n\tvar datip = document.createElement(\"input\");\r\n\tdatip.setAttribute(\"type\", \"text\");\r\n\tdatip.setAttribute(\"placeholder\", \"Terminus DB URL\");\r\n\tdatip.setAttribute(\"class\", \"terminus-form-value terminus-form-url terminus-input-text\");\r\n\tsci.appendChild(datip);\r\n\t//mfd.appendChild(sci);\r\n\tvar butfield = document.createElement(\"div\");\r\n\tbutfield.setAttribute(\"class\", \"terminus-control-buttons\");\r\n\tvar cancbut = document.createElement(\"button\");\r\n\tcancbut.setAttribute(\"class\", \"terminus-control-button terminus-cancel-db-button terminus-btn terminus-btn-float-right\");\r\n\tcancbut.appendChild(document.createTextNode(\"Cancel\"));\r\n\tvar loadbut = document.createElement(\"button\");\r\n\tloadbut.setAttribute(\"class\", \"terminus-control-button terminus-create-db-button terminus-btn terminus-btn-float-right\");\r\n\tloadbut.appendChild(document.createTextNode(\"Create\"));\r\n\tvar self = this;\r\n\tvar gatherips = function(){\r\n\t\tvar input = {};\r\n\t\tinput.id = idip.value;\r\n\t\tinput.title = titip.value;\r\n\t\tinput.description = descip.value;\r\n\t\tinput.schema = schem.value;\r\n\t\tinput.key = kip.value;\r\n\t\tinput.data = datip.value;\r\n\t\treturn input;\r\n\t}\r\n\tvar self = this;\r\n\tloadbut.addEventListener(\"click\", function(){\r\n\t\tvar input = gatherips();\r\n\t\tself.ui.createDatabase(input);\r\n\t})\r\n\tcancbut.addEventListener(\"click\", function(){\r\n\t\tself.ui.showServerMainPage();\r\n\t})\r\n\tbutfield.appendChild(cancbut);\r\n\tbutfield.appendChild(loadbut);\r\n\tmfd.appendChild(butfield);\r\n\r\n\treturn scd;\r\n}\r\n\r\nmodule.exports={TerminusDBViewer:TerminusDBViewer,\r\n\t            TerminusDBController:TerminusDBController,\r\n\t            TerminusDBCreator:TerminusDBCreator}\r\n","const TerminusClient = require('@terminusdb/terminus-client');\r\nconst WOQLChooser = require(\"./WOQLChooser\");\r\nconst WOQLTable = require(\"./WOQLTable\");\r\nconst WOQLQueryViewer = require(\"./WOQLQueryView\");\r\nconst WOQLGraph = require(\"./WOQLGraph\");\r\nconst WOQLStream = require(\"./WOQLStream\");\r\nconst TerminusFrame = require(\"./TerminusFrame\");\r\n\r\nTerminusClient.WOQL.table = function(){ return new WOQLTableConfig(); }\r\nTerminusClient.WOQL.graph = function(){ return new WOQLGraphConfig(); }\r\nTerminusClient.WOQL.chooser = function(){ return new WOQLChooserConfig(); }\r\nTerminusClient.WOQL.stream = function(){ return new WOQLStreamConfig(); }\r\nTerminusClient.WOQL.document = function(){ return new FrameConfig(); }\r\nTerminusClient.WOQL.loadConfig = function(config){\r\n\tif(config.table){\r\n\t\tvar view = new WOQLTableConfig();\r\n\t\tview.loadJSON(config.table, config.rules);\r\n\t}\r\n\telse if(config.chooser){\r\n\t\tvar view = new WOQLChooserConfig();\r\n\t\tview.loadJSON(config.chooser, config.rules);\r\n\t}\r\n\telse if(config.graph){\r\n\t\tvar view = new WOQLGraphConfig();\r\n\t\tview.loadJSON(config.graph, config.rules);\r\n\t}\r\n\telse if(config.stream){\r\n\t\tvar view = new WOQLStreamConfig();\r\n\t\tview.loadJSON(config.stream, config.rules);\r\n\t}\r\n\telse if(config.frame){\r\n\t\tvar view = new FrameConfig();\r\n\t\tview.loadJSON(config.frame, config.rules);\r\n\t}\r\n\treturn view;\r\n}\r\n//the below are aspirational...\r\n//TerminusClient.WOQL.map = function(){ return new WOQLMapConfig(); }\r\n//TerminusClient.WOQL.chart = function(){ return new WOQLChartConfig(); }\r\n\r\n//Class for expressing and matching rules about WOQL results\r\n//especially for efficiently expressing rules about how they should be rendered\r\n//const TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction FrameConfig(){\r\n\tthis.rules = [];\r\n\tthis.type = \"document\";\r\n}\r\n\r\nFrameConfig.prototype.prettyPrint = function(){\r\n\tvar str = \"view = WOQL.document();\\n\";\r\n\tif(this.renderer()){\r\n\t\tstr += \"view.renderer('\" + this.renderer() + \"')\\n\";\r\n\t}\r\n\tif(typeof this.load_schema() != \"undefined\"){\r\n\t\tstr += \"view.load_schema(\" + this.load_schema() + \")\\n\";\r\n\t}\r\n\tfor(var i = 0; i<this.rules.length ; i++){\r\n\t\tstr += \"view.\" + this.rules[i].prettyPrint(\"frame\") + \"\\n\";\r\n\t}\r\n\treturn str;\r\n}\r\n\r\nFrameConfig.prototype.json = function(){\r\n\tlet jr = [];\r\n\tfor(var i = 0; i<this.rules.length; i++){\r\n\t\tjr.push(this.rules[i].json());\r\n\t}\r\n\tvar conf = {};\r\n\tif(typeof this.renderer() != \"undefined\"){\r\n\t\tconf['renderer'] = this.renderer();\r\n\t}\r\n\tif(typeof this.load_schema() != \"undefined\"){\r\n\t\tconf['load_schema'] = this.load_schema();\r\n\t}\r\n\tlet mj = {\"frame\" :conf, \"rules\": jr};\r\n\treturn mj;\r\n}\r\n\r\nFrameConfig.prototype.loadJSON = function(config, rules){\r\n\tvar jr = [];\r\n\tfor(var i = 0; i<rules.length; i++){\r\n\t\tvar nr = new TerminusClient.WOQL.rule();\r\n\t\tnr.json(rules[i]);\r\n\t\tjr.push(nr);\r\n\t}\r\n\tthis.rules = jr;\r\n\tif(typeof config.renderer != \"undefined\"){\r\n\t\tthis.renderer(config.renderer);\r\n\t}\r\n\tif(typeof config.load_schema != \"undefined\"){\r\n\t\tthis.load_schema(config.load_schema);\r\n\t}\r\n}\r\n\r\nFrameConfig.prototype.create = function(client, renderers){\r\n\tvar tf = new TerminusFrame(client, this);\r\n\tif(this.trenderer) tf.setRenderer(this.trenderer);\r\n\telse if(renderers && renderers['frame']){\r\n\t\ttf.setRenderer(renderers['frame']);\r\n\t}\r\n\treturn tf;\r\n}\r\n\r\nFrameConfig.prototype.renderer = function(rend){\r\n\tif(typeof rend == \"undefined\") return this.trenderer;\r\n\tthis.trenderer = rend;\r\n\treturn this;\r\n}\r\n\r\nFrameConfig.prototype.json_rules = function(){\r\n\tlet jr = [];\r\n\tfor(var i = 0; i<this.rules.length; i++){\r\n\t\tjr.push(this.rules[i].json());\r\n\t}\r\n\treturn jr;\r\n}\r\n\r\nFrameConfig.prototype.load_schema = function(tf){\r\n\tif(typeof tf == \"undefined\") return this.get_schema;\r\n\tthis.get_schema = tf;\r\n\treturn this;\r\n}\r\n\r\nFrameConfig.prototype.show_all = function(r){\r\n\tthis.all().renderer(r);\r\n\treturn this;\r\n}\r\n\r\nFrameConfig.prototype.show_parts = function(o, p, d){\r\n\tthis.object().renderer(o);\r\n\tthis.property().renderer(p);\r\n\tthis.data().renderer(d);\r\n\treturn this;\r\n}\r\n\r\nFrameConfig.prototype.object = function(){\r\n\tlet fp = TerminusClient.WOQL.rule();\r\n\tfp.scope(\"object\")\r\n\tthis.rules.push(fp);\r\n\treturn fp;\r\n}\r\n\r\nFrameConfig.prototype.property = function(){\r\n\tlet fp = TerminusClient.WOQL.rule();\r\n\tfp.scope(\"property\");\r\n\tthis.rules.push(fp);\r\n\treturn fp;\r\n}\r\n\r\nFrameConfig.prototype.data = function(){\r\n\tlet fp = TerminusClient.WOQL.rule();\r\n\tfp.scope(\"data\")\r\n\tthis.rules.push(fp);\r\n\treturn fp;\r\n}\r\n\r\nFrameConfig.prototype.all = function(){\r\n\tlet fp = TerminusClient.WOQL.rule();\r\n\tfp.scope(\"*\")\r\n\tthis.rules.push(fp);\r\n\treturn fp;\r\n}\r\n\r\n\r\nFrameConfig.prototype.setFrameDisplayOptions = function(frame, rule){\r\n\tif(typeof frame.display_options == \"undefined\") frame.display_options = {};\r\n\tif(typeof rule.mode() != \"undefined\") {\tframe.display_options.mode = rule.mode();}\r\n\tif(typeof rule.view() != \"undefined\") frame.display_options.view = rule.view();\r\n\t//if(typeof rule.facets() != \"undefined\") frame.display_options.facets = rule.facets();\r\n\t//if(typeof rule.facet() != \"undefined\") frame.display_options.facet = rule.facet();\r\n\tif(typeof rule.showDisabledButtons() != \"undefined\") frame.display_options.show_disabled_buttons = rule.showDisabledButtons();\r\n\tif(typeof rule.features() != \"undefined\") {\r\n\t\tframe.display_options.features = rule.features();\r\n\t}\r\n\tif(typeof rule.header() != \"undefined\") frame.display_options.header = rule.header();\r\n\tif(typeof rule.hidden() != \"undefined\") frame.display_options.hidden = rule.hidden();\r\n\tif(typeof rule.collapse() != \"undefined\") frame.display_options.collapse = rule.collapse();\r\n\tif(typeof rule.headerFeatures() != \"undefined\") frame.display_options.header_features = rule.headerFeatures();\r\n\tif(typeof rule.showEmpty() != \"undefined\") frame.display_options.show_empty = rule.showEmpty();\r\n\tif(typeof rule.featureRenderers() != \"undefined\") frame.display_options.feature_renderers = rule.featureRenderers();\r\n\tif(typeof rule.dataviewer() != \"undefined\") {\r\n\t\tframe.display_options.dataviewer = rule.dataviewer();\r\n\t\tif(typeof rule.args() != \"undefined\")\r\n\t\t\tframe.display_options.args = rule.args();\r\n\t}\r\n}\r\n\r\n\r\n\r\n//WOQL.rule().renderer(\"object\").json(),\r\n//WOQL.rule().renderer(\"property\").json(),\r\n//WOQL.rule().renderer(\"data\").json(),\r\n//WOQL.rule().renderer(\"data\").property(\"rdfs:comment\").render(false).json()\r\n\r\n\r\nfunction WOQLStreamConfig(){\r\n\tthis.rules = [];\r\n\tthis.type = \"stream\";\r\n}\r\n\r\nWOQLStreamConfig.prototype.prettyPrint = function(){\r\n\tvar str = \"view = WOQL.stream();\\n\";\r\n\tfor(var i = 0; i<this.rules.length ; i++){\r\n\t\tstr += \"view.\" + this.rules[i].prettyPrint(\"stream\") + \"\\n\";\r\n\t}\r\n\treturn str;\r\n}\r\n\r\nWOQLStreamConfig.prototype.loadJSON = function(config, rules){\r\n\tvar jr = [];\r\n\tfor(var i = 0; i<rules.length; i++){\r\n\t\tvar nr = new WOQLRule();\r\n\t\tnr.json(rules[i]);\r\n\t\tjr.push(nr);\r\n\t}\r\n\tthis.rules = jr;\r\n}\r\n\r\n\r\nWOQLStreamConfig.prototype.json = function(){\r\n\tlet jr = [];\r\n\tfor(var i = 0; i<this.rules.length; i++){\r\n\t\tjr.push(this.rules[i].json());\r\n\t}\r\n\tvar conf = {};\r\n\tlet mj = {\"stream\" :conf, \"rules\": jr};\r\n\treturn mj;\r\n}\r\n\r\nWOQLStreamConfig.prototype.getMatchingRules = function(row, key, context, action){\r\n\treturn getMatchingRules(this.rules, row, key, context, action);\r\n}\r\n\r\nWOQLStreamConfig.prototype.create = function(client, renderers){\r\n\tvar wqt = new WOQLStream(client, this);\r\n\tif(this.trenderer) wqt.setRenderer(this.trenderer);\r\n\telse if(renderers && renderers['stream']){\r\n\t\twqt.setRenderer(renderers['stream']);\r\n\t}\r\n\treturn wqt;\r\n}\r\n\r\n\r\nfunction WOQLChooserConfig(){\r\n\tthis.rules = [];\r\n\tthis.type = \"chooser\";\r\n}\r\n\r\nWOQLChooserConfig.prototype.getMatchingRules = function(row, key, context, action){\r\n\treturn getMatchingRules(this.rules, row, key, context, action);\r\n}\r\n\r\nWOQLChooserConfig.prototype.create = function(client, renderers){\r\n\tvar wqt = new WOQLChooser(client, this);\r\n\tif(this.trenderer) wqt.setRenderer(this.trenderer);\r\n\telse if(renderers && renderers['chooser']){\r\n\t\twqt.setRenderer(renderers['chooser']);\r\n\t}\r\n\treturn wqt;\r\n}\r\n\r\nWOQLChooserConfig.prototype.prettyPrint = function(){\r\n\tvar str = \"view = WOQL.chooser();\\n\";\r\n\tif(typeof this.change() != \"undefined\"){\r\n\t\tstr += \"view.change(\" + this.change() + \")\\n\";\r\n\t}\r\n\tif(typeof this.show_empty() != \"undefined\"){\r\n\t\tstr += \"view.show_empty('\" + this.show_empty() + \"')\\n\";\r\n\t}\r\n\tif(typeof this.values() != \"undefined\"){\r\n\t\tstr += \"view.values('\" + removeNamespaceFromVariable(this.values()) + \"')\\n\";\r\n\t}\r\n\tif(typeof this.labels() != \"undefined\"){\r\n\t\tstr += \"view.labels('\" + removeNamespaceFromVariable(this.labels()) + \"')\\n\";\r\n\t}\r\n\tif(typeof this.titles() != \"undefined\"){\r\n\t\tstr += \"view.titles('\" + removeNamespaceFromVariable(this.titles()) + \"')\\n\";\r\n\t}\r\n\tif(typeof this.sort() != \"undefined\"){\r\n\t\tstr += \"view.sort(\" + this.sort() + \")\\n\";\r\n\t}\r\n\tif(typeof this.direction() != \"undefined\"){\r\n\t\tstr += \"view.direction('\" + this.direction() + \"')\\n\";\r\n\t}\r\n\tfor(var i = 0; i<this.rules.length ; i++){\r\n\t\tstr += \"view.\" + this.rules[i].prettyPrint(\"chooser\") + \"\\n\";\r\n\t}\r\n\treturn str;\r\n}\r\n\r\nWOQLChooserConfig.prototype.json = function(){\r\n\tlet jr = [];\r\n\tfor(var i = 0; i<this.rules.length; i++){\r\n\t\tjr.push(this.rules[i].json());\r\n\t}\r\n\tvar conf = {};\r\n\tif(typeof this.change() != \"undefined\"){\r\n\t\tconf['change'] = this.change();\r\n\t}\r\n\tif(typeof this.show_empty() != \"undefined\"){\r\n\t\tconf['show_empty'] = this.show_empty();\r\n\t}\r\n\tif(typeof this.values() != \"undefined\"){\r\n\t\tconf['values'] = this.values();\r\n\t}\r\n\tif(typeof this.labels() != \"undefined\"){\r\n\t\tconf['labels'] = this.labels();\r\n\t}\r\n\tif(typeof this.titles() != \"undefined\"){\r\n\t\tconf['titles'] = this.titles();\r\n\t}\r\n\tif(typeof this.sort() != \"undefined\"){\r\n\t\tconf['sort'] = this.sort();\r\n\t}\r\n\tif(typeof this.direction() != \"undefined\"){\r\n\t\tconf['direction'] = this.direction();\r\n\t}\r\n\tlet mj = {\"chooser\" :conf, \"rules\": jr};\r\n\treturn mj;\r\n}\r\n\r\nWOQLChooserConfig.prototype.loadJSON = function(config, rules){\r\n\tvar jr = [];\r\n\tfor(var i = 0; i<rules.length; i++){\r\n\t\tvar nr = new WOQLRule();\r\n\t\tnr.json(rules[i]);\r\n\t\tjr.push(nr);\r\n\t}\r\n\tthis.rules = jr;\r\n\tif(typeof config.change != \"undefined\"){\r\n\t\tthis.change(config.change);\r\n\t}\r\n\tif(typeof config.show_empty != \"undefined\"){\r\n\t\tthis.show_empty(config.show_empty);\r\n\t}\r\n\tif(typeof config.values != \"undefined\"){\r\n\t\tthis.values(config.values);\r\n\t}\r\n\tif(typeof config.labels != \"undefined\"){\r\n\t\tthis.labels(config.labels);\r\n\t}\r\n\tif(typeof config.titles != \"undefined\"){\r\n\t\tthis.titles(config.titles);\r\n\t}\r\n\tif(typeof config.sort != \"undefined\"){\r\n\t\tthis.sort(config.sort);\r\n\t}\r\n\tif(typeof config.direction != \"undefined\"){\r\n\t\tthis.direction(config.direction);\r\n\t}\r\n}\r\n\r\nWOQLChooserConfig.prototype.change = function(v){\r\n\tif(typeof v != \"undefined\"){\r\n\t\tthis.onChange = v;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.onChange;\r\n}\r\n\r\nWOQLChooserConfig.prototype.show_empty = function(p){\r\n\tif(typeof p != \"undefined\"){\r\n\t\tthis.placeholder = p;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.placeholder;\r\n}\r\n\r\nWOQLChooserConfig.prototype.rule = function(v){\r\n\tlet nr = new WOQLRule(\"row\");\r\n\tthis.rules.push(nr);\r\n\treturn nr.v(v);\r\n}\r\n\r\nWOQLChooserConfig.prototype.values = function(v){\r\n\tif(typeof v != \"undefined\"){\r\n\t\tif(v.substring(0, 2) != \"v:\") v = \"v:\" + v;\r\n\t\tthis.value_variable = v;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.value_variable;\r\n}\r\n\r\nWOQLChooserConfig.prototype.labels = function(v){\r\n\tif(v){\r\n\t\tif(v.substring(0, 2) != \"v:\") v = \"v:\" + v;\r\n\t\tthis.label_variable = v;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.label_variable;\r\n}\r\n\r\nWOQLChooserConfig.prototype.titles = function(v){\r\n\tif(v){\r\n\t\tif(v.substring(0, 2) != \"v:\") v = \"v:\" + v;\r\n\t\tthis.title_variable = v;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.title_variable;\r\n}\r\n\r\nWOQLChooserConfig.prototype.sort = function(v){\r\n\tif(v){\r\n\t\tif(v.substring(0, 2) != \"v:\") v = \"v:\" + v;\r\n\t\tthis.sort_variable = v;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.sort_variable;\r\n}\r\n\r\nWOQLChooserConfig.prototype.direction = function(v){\r\n\tif(v){\r\n\t\tthis.sort_direction = v;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.sort_direction;\r\n}\r\n\r\n\r\n//this.choice = (config && config.choice ? config.choice : false);\r\n\r\n\r\nfunction WOQLTableConfig(){\r\n\tthis.rules = [];\r\n\tthis.type = \"table\";\r\n}\r\n\r\nWOQLTableConfig.prototype.getMatchingRules = function(row, key, context, action){\r\n\treturn getMatchingRules(this.rules, row, key, context, action);\r\n}\r\n\r\nWOQLTableConfig.prototype.create = function(client, renderers, dtypes){\r\n\tvar wqt = new WOQLTable(client, this);\r\n\twqt.setDatatypes(dtypes);\r\n\tif(this.trenderer) wqt.setRenderer(this.trenderer);\r\n\telse if(renderers && renderers['table']){\r\n\t\twqt.setRenderer(renderers['table']);\r\n\t}\r\n\treturn wqt;\r\n}\r\n\r\nWOQLTableConfig.prototype.json = function(){\r\n\tlet jr = [];\r\n\tfor(var i = 0; i<this.rules.length; i++){\r\n\t\tjr.push(this.rules[i].json());\r\n\t}\r\n\tvar conf = {};\r\n\tif(typeof this.column_order() != \"undefined\"){\r\n\t\tconf['column_order'] = this.column_order();\r\n\t}\r\n\tif(typeof this.pagesize() != \"undefined\"){\r\n\t\tconf['pagesize'] = this.pagesize();\r\n\t}\r\n\tif(typeof this.renderer() != \"undefined\"){\r\n\t\tconf['renderer'] = this.renderer();\r\n\t}\r\n\tif(typeof this.pager() != \"undefined\"){\r\n\t\tconf['pager'] = this.pager();\r\n\t}\r\n\tif(typeof this.page() != \"undefined\"){\r\n\t\tconf['page'] = this.page();\r\n\t}\r\n\tlet mj = {\"table\" :conf, \"rules\": jr};\r\n\treturn mj;\r\n}\r\n\r\nWOQLTableConfig.prototype.loadJSON = function(config, rules){\r\n\tvar jr = [];\r\n\tfor(var i = 0; i<rules.length; i++){\r\n\t\tvar nr = new WOQLRule();\r\n\t\tnr.json(rules[i]);\r\n\t\tjr.push(nr);\r\n\t}\r\n\tthis.rules = jr;\r\n\tif(typeof config.column_order != \"undefined\"){\r\n\t\tthis.column_order(config.column_order);\r\n\t}\r\n\tif(typeof config.pagesize != \"undefined\"){\r\n\t\tthis.pagesize(config.pagesize);\r\n\t}\r\n\tif(typeof config.renderer != \"undefined\"){\r\n\t\tthis.renderer(config.renderer);\r\n\t}\r\n\tif(typeof config.pager != \"undefined\"){\r\n\t\tthis.pager(config.pager);\r\n\t}\r\n\tif(typeof config.page != \"undefined\"){\r\n\t\tthis.titles(config.page);\r\n\t}\r\n}\r\n\r\nWOQLTableConfig.prototype.prettyPrint = function(){\r\n\tvar str = \"view = WOQL.table();\\n\";\r\n\tif(typeof this.column_order() != \"undefined\"){\r\n\t\tstr += \"view.column_order('\" + this.column_order() + \"')\\n\";\r\n\t}\r\n\tif(typeof this.pagesize() != \"undefined\"){\r\n\t\tstr += \"view.pagesize(\" + this.pagesize() + \")\\n\";\r\n\t}\r\n\tif(typeof this.renderer() != \"undefined\"){\r\n\t\tstr += \"view.renderer('\" + this.renderer() + \"')\\n\";\r\n\t}\r\n\tif(typeof this.pager() != \"undefined\"){\r\n\t\tstr += \"view.pager(\" + this.pager() + \")\\n\";\r\n\t}\r\n\tif(typeof this.page() != \"undefined\"){\r\n\t\tstr += \"view.page(\" + this.page() + \")\\n\";\r\n\t}\r\n\tfor(var i = 0; i<this.rules.length ; i++){\r\n\t\tstr += \"view.\" + this.rules[i].prettyPrint(\"table\") + \"\\n\";\r\n\t}\r\n\treturn str;\r\n}\r\n\r\nWOQLTableConfig.prototype.renderer = function(rend){\r\n\tif(!rend) return this.trenderer;\r\n\tthis.trenderer = rend;\r\n\treturn this;\r\n}\r\n\r\nWOQLTableConfig.prototype.column_order = function(...val){\r\n\tif(typeof val == \"undefined\" || val.length == 0){\r\n\t\treturn this.order;\r\n\t}\r\n\tthis.order = addNamespacesToVariables(val);\r\n\treturn this;\r\n}\r\n\r\nWOQLTableConfig.prototype.pager = function(val){\r\n\tif(typeof val == \"undefined\"){\r\n\t\treturn this.show_pager;\r\n\t}\r\n\tthis.show_pager = val;\r\n\treturn this;\r\n}\r\n\r\nWOQLTableConfig.prototype.pagesize = function(val, editable){\r\n\tif(typeof val == \"undefined\"){\r\n\t\treturn this.show_pagesize;\r\n\t}\r\n\tthis.show_pagesize = val;\r\n\tthis.change_pagesize = editable;\r\n\treturn this;\r\n}\r\n\r\nWOQLTableConfig.prototype.page = function(val){\r\n\tif(typeof val == \"undefined\"){\r\n\t\treturn this.show_pagenumber;\r\n\t}\r\n\tthis.show_pagenumber = val;\r\n\treturn this;\r\n}\r\n\r\nWOQLTableConfig.prototype.column = function(...cols){\r\n\tlet nr = new WOQLRule(\"column\");\r\n\tnr.setVariables(cols);\r\n\tthis.rules.push(nr);\r\n\treturn nr;\r\n}\r\n\r\nWOQLTableConfig.prototype.row = function(){\r\n\tlet nr = new WOQLRule(\"row\");\r\n\tthis.rules.push(nr);\r\n\treturn nr;\r\n}\r\n\r\nWOQLGraphConfig = function(){\r\n\tthis.rules = [];\r\n\tthis.type = \"graph\";\r\n}\r\n\r\nWOQLGraphConfig.prototype.create = function(client, renderers){\r\n\tvar wqt = new WOQLGraph(client, this);\r\n\tif(this.trenderer) wqt.setRenderer(this.trenderer);\r\n\telse if(renderers && renderers['graph']){\r\n\t\twqt.setRenderer(renderers['graph']);\r\n\t}\r\n\treturn wqt;\r\n}\r\n\r\nWOQLGraphConfig.prototype.getMatchingRules = function(row, key, context, action){\r\n\treturn getMatchingRules(this.rules, row, key, context, action);\r\n}\r\n\r\nWOQLGraphConfig.prototype.literals = function(v){\r\n\tif(typeof v != \"undefined\"){\r\n\t\tthis.show_literals = v;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.show_literals;\r\n}\r\n\r\nWOQLGraphConfig.prototype.source = function(v){\r\n\tif(v){\r\n\t\tif(v.substring(0, 2) != \"v:\") v = \"v:\" + v;\r\n\t\tthis.source_variable = v;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.source_variable;\r\n}\r\n\r\nWOQLGraphConfig.prototype.fontfamily = function(v){\r\n\tif(typeof v != \"undefined\"){\r\n\t\tthis.fontfam = v;\r\n\t\treturn this;\r\n\t}\r\n\t//return 'Font Awesome 5 Free';\r\n\treturn this.fontfam;\r\n}\r\n\r\nWOQLGraphConfig.prototype.show_force = function(v){\r\n\tif(typeof v != \"undefined\"){\r\n\t\tthis.force = v;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.force;\r\n}\r\n\r\nWOQLGraphConfig.prototype.fix_nodes = function(v){\r\n\tif(typeof v != \"undefined\"){\r\n\t\tthis.fixed = v;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.fixed;\r\n}\r\n\r\nWOQLGraphConfig.prototype.explode_out = function(v){\r\n\tif(typeof v != \"undefined\"){\r\n\t\tthis.explode = v;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.explode;\r\n}\r\n\r\nWOQLGraphConfig.prototype.selected_grows = function(v){\r\n\tif(typeof v != \"undefined\"){\r\n\t\tthis.bigsel = v;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.bigsel;\r\n}\r\n\r\nWOQLGraphConfig.prototype.width = function(v){\r\n\tif(typeof v != \"undefined\"){\r\n\t\tthis.gwidth = v;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.gwidth;\r\n}\r\n\r\nWOQLGraphConfig.prototype.height = function(v){\r\n\tif(typeof v != \"undefined\"){\r\n\t\tthis.gheight = v;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.gheight;\r\n}\r\n\r\nWOQLGraphConfig.prototype.edges = function(...edges){\r\n\tif(edges && edges.length){\r\n\t\tvar nedges = [];\r\n\t\tfor(var i = 0; i<edges.length; i++){\r\n\t\t\tnedges.push(addNamespacesToVariables(edges[i]));\r\n\t\t}\r\n\t\tthis.show_edges = nedges;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.show_edges;\r\n}\r\n\r\nWOQLGraphConfig.prototype.edge = function(source, target){\r\n\tlet nr = new WOQLRule(\"edge\");\r\n\tif(source && target) nr.setVariables([source, target]);\r\n\telse if(source) nr.setVariables([source]);\r\n\telse if(target) nr.setVariables([target]);\r\n\tif(source) nr.source = source;\r\n\tif(target) nr.target = target;\r\n\tthis.rules.push(nr);\r\n\treturn nr;\r\n}\r\n\r\nWOQLGraphConfig.prototype.node = function(...cols){\r\n\tlet nr = new WOQLRule(\"node\");\r\n\tnr.setVariables(cols);\r\n\tthis.rules.push(nr);\r\n\treturn nr;\r\n}\r\n\r\nWOQLGraphConfig.prototype.getConfigAsJSON = function(){\r\n\tvar json = {};\r\n\tif(typeof this.literals() != \"undefined\"){\r\n\t\tjson['literals'] = this.literals();\r\n\t}\r\n\tif(typeof this.source() != \"undefined\"){\r\n\t\tjson['source'] = this.source();\r\n\t}\r\n\tif(typeof this.fontfamily() != \"undefined\"){\r\n\t\tjson['fontfamily'] = this.fontfamily();\r\n\t}\r\n\tif(typeof this.show_force() != \"undefined\"){\r\n\t\tjson['show_force'] = this.show_force();\r\n\t}\r\n\tif(typeof this.fix_nodes() != \"undefined\"){\r\n\t\tjson['fix_nodes'] = this.fix_nodes();\r\n\t}\r\n\tif(typeof this.explode_out() != \"undefined\"){\r\n\t\tjson['explode_out'] = this.explode_out();\r\n\t}\r\n\tif(typeof this.selected_grows() != \"undefined\"){\r\n\t\tjson['selected_grows'] = this.selected_grows();\r\n\t}\r\n\tif(typeof this.width() != \"undefined\"){\r\n\t\tjson['width'] = this.width();\r\n\t}\r\n\tif(typeof this.height() != \"undefined\"){\r\n\t\tjson['height'] = this.height();\r\n\t}\r\n\tif(typeof this.edges() != \"undefined\"){\r\n\t\tjson['edges'] = this.edges();\r\n\t}\r\n\treturn json;\r\n}\r\n\r\nWOQLGraphConfig.prototype.loadJSON = function(config, rules){\r\n\tvar jr = [];\r\n\tfor(var i = 0; i<rules.length; i++){\r\n\t\tvar nr = new WOQLRule();\r\n\t\tnr.json(rules[i]);\r\n\t\tjr.push(nr);\r\n\t}\r\n\tthis.rules = jr;\r\n\tif(typeof config.literals != \"undefined\"){\r\n\t\tthis.literals(config.literals);\r\n\t}\r\n\tif(typeof config.source != \"undefined\"){\r\n\t\tthis.source(config.source);\r\n\t}\r\n\tif(typeof config.fontfamily != \"undefined\"){\r\n\t\tthis.fontfamily(config.fontfamily);\r\n\t}\r\n\tif(typeof config.show_force != \"undefined\"){\r\n\t\tthis.show_force(config.show_force);\r\n\t}\r\n\tif(typeof config.fix_nodes != \"undefined\"){\r\n\t\tthis.fix_nodes(config.showfix_nodes_force);\r\n\t}\r\n\tif(typeof config.explode_out != \"undefined\"){\r\n\t\tthis.explode_out(config.explode_out);\r\n\t}\r\n\tif(typeof config.selected_grows != \"undefined\"){\r\n\t\tthis.selected_grows(config.selected_grows);\r\n\t}\r\n\tif(typeof config.width != \"undefined\"){\r\n\t\tthis.width(config.width);\r\n\t}\r\n\tif(typeof config.height != \"undefined\"){\r\n\t\tthis.height(config.height);\r\n\t}\r\n\tif(typeof config.edges != \"undefined\"){\r\n\t\tthis.edges(config.edges);\r\n\t}\r\n}\r\n\r\n\r\nWOQLGraphConfig.prototype.prettyPrint = function(){\r\n\tvar str = \"view = WOQL.graph();\\n\";\r\n\tif(typeof this.literals() != \"undefined\"){\r\n\t\tstr += \"view.literals('\" + this.literals() + \"')\\n\";\r\n\t}\r\n\tif(typeof this.source() != \"undefined\"){\r\n\t\tstr += \"view.source('\" + removeNamespaceFromVariable(this.source()) + \"')\\n\";\r\n\t}\r\n\tif(typeof this.fontfamily() != \"undefined\"){\r\n\t\tstr += \"view.fontfamily('\" + this.fontfamily() + \"')\\n\";\r\n\t}\r\n\tif(typeof this.show_force() != \"undefined\"){\r\n\t\tstr += \"view.show_force('\" + this.show_force() + \"')\\n\";\r\n\t}\r\n\tif(typeof this.fix_nodes() != \"undefined\"){\r\n\t\tstr += \"view.fix_nodes('\" + this.fix_nodes() + \"')\\n\";\r\n\t}\r\n\tif(typeof this.explode_out() != \"undefined\"){\r\n\t\tstr += \"view.explode_out('\" + this.explode_out() + \"')\\n\";\r\n\t}\r\n\tif(typeof this.selected_grows() != \"undefined\"){\r\n\t\tstr += \"view.selected_grows('\" + this.selected_grows() + \"')\\n\";\r\n\t}\r\n\tif(typeof this.width() != \"undefined\"){\r\n\t\tstr += \"view.width('\" + this.width() + \"')\\n\";\r\n\t}\r\n\tif(typeof this.height() != \"undefined\"){\r\n\t\tstr += \"view.height('\" + this.height() + \"')\\n\";\r\n\t}\r\n\tif(typeof this.edges() != \"undefined\"){\r\n\t\tvar nedges = this.edges();\r\n\t\tvar estrs = [];\r\n\t\tfor(var i = 0; i<nedges.length; i++){\r\n\t\t\testrs.push(\"['\" + nedges[i][0] + \", \" + nedges[i][1] + \"']\");\r\n\t\t}\r\n\t\tstr += \"view.edges('\" + estrs.join(\", \") + \"')\\n\";\r\n\t}\r\n\tfor(var i = 0; i<this.rules.length ; i++){\r\n\t\tstr += \"view.\" + this.rules[i].prettyPrint(\"graph\") + \"\\n\";\r\n\t}\r\n\treturn str;\r\n}\r\n\r\nWOQLGraphConfig.prototype.json = function(){\r\n\tlet jr = [];\r\n\tfor(var i = 0; i<this.rules.length; i++){\r\n\t\tjr.push(this.rules[i].json());\r\n\t}\r\n\tlet mj = {\"graph\" : this.getConfigAsJSON(), \"rules\": jr};\r\n\treturn mj;\r\n}\r\n\r\n\r\nfunction WOQLRule(s){\r\n\tthis.rule = { scope: s };\r\n}\r\n\r\nWOQLRule.prototype.prettyPrint = function(type){\r\n\t//starts with obj. ...\r\n\tvar str = this.rule.scope + \"('\" + this.rule.variables.join(\"', '\") + \"')\";\r\n\tif(typeof this.literal() != \"undefined\"){\r\n\t\tstr += \".literal(\" + this.literal() + \")\";\r\n\t}\r\n\tif(typeof this.type() != \"undefined\"){\r\n\t\tstr += \".type(\" + JSON.stringify(removeNamespacesFromVariables(this.type())) + \")\";\r\n\t}\r\n\tif(typeof this.selected() != \"undefined\"){\r\n\t\tstr += \".selected(\" + this.selected() + \")\";\r\n\t}\r\n\tif(typeof this.label() != \"undefined\"){\r\n\t\tstr += \".label(\" + this.label() + \")\";\r\n\t}\r\n\tif(typeof this.size() != \"undefined\"){\r\n\t\tstr += \".size('\" + this.size() + \"')\";\r\n\t}\r\n\tif(typeof this.color() != \"undefined\"){\r\n\t\tstr += \".color([\" + this.color().join(\",\") + \"])\";\r\n\t}\r\n\tif(typeof this.charge() != \"undefined\"){\r\n\t\tstr += \".charge('\" + this.charge() + \"')\";\r\n\t}\r\n\tif(typeof this.distance() != \"undefined\"){\r\n\t\tstr += \".distance('\" + this.distance() + \"')\";\r\n\t}\r\n\tif(typeof this.weight() != \"undefined\"){\r\n\t\tstr += \".distance('\" + this.weight() + \"')\";\r\n\t}\r\n\tif(typeof this.symmetric() != \"undefined\"){\r\n\t\tstr += \".symmetric(\" + this.symmetric() + \")\";\r\n\t}\r\n\tif(typeof this.collisionRadius() != \"undefined\"){\r\n\t\tstr += \".collisionRadius(\" + this.collisionRadius() + \")\";\r\n\t}\r\n\tif(typeof this.icon() != \"undefined\"){\r\n\t\tstr += \".icon(\" + JSON.stringify(this.icon()) + \")\";\r\n\t}\r\n\tif(typeof this.text() != \"undefined\"){\r\n\t\tstr += \".text(\" + JSON.stringify(this.text()) + \")\";\r\n\t}\r\n\tif(typeof this.arrow() != \"undefined\"){\r\n\t\tstr += \".arrow(\" + JSON.stringify(this.arrow()) + \")\";\r\n\t}\r\n\tif(typeof this.border() != \"undefined\"){\r\n\t\tstr += \".border(\" + JSON.stringify(this.border()) + \")\";\r\n\t}\r\n\tif(typeof this.args() != \"undefined\"){\r\n\t\tstr += \".args(\" + JSON.stringify(this.args()) + \")\";\r\n\t}\r\n\tif(typeof this.renderer() != \"undefined\"){\r\n\t\tstr += \".renderer('\" + this.renderer() + \"')\";\r\n\t}\r\n\tif(typeof this.render() != \"undefined\"){\r\n\t\tstr += \".render(\" + this.render() + \")\";\r\n\t}\r\n\tif(typeof this.header() != \"undefined\"){\r\n\t\tstr += \".header('\" + this.header() + \"')\";\r\n\t}\r\n\tif(typeof this.click() != \"undefined\"){\r\n\t\tstr += \".click(\" + this.click() + \")\";\r\n\t}\r\n\tif(typeof this.hover() != \"undefined\"){\r\n\t\tstr += \".hover(\" + this.hover() + \")\";\r\n\t}\r\n\tfor(var v in this.rule.constraints){\r\n\t\tstr += \".v('\" + v + \"')\";\r\n\t\tfor(var i = 0; i<this.rule.constraints[v].length; i++){\r\n\t\t\tif(typeof(this.rule.constraints[v][i]) == \"function\"){\r\n\t\t\t\tstr += \".filter(\" + this.rule.constraints[v][i] + \")\";\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tstr += \".in(\" + JSON.stringify(this.rule.constraints[v][i]) + \")\";\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn str;\r\n}\r\n\r\n/*\r\n * Graph\r\n */\r\n\r\nWOQLRule.prototype.json = function(mjson){\r\n\tif(!mjson) return this.rule;\r\n\tthis.rule = mjson;\r\n\treturn this;\r\n}\r\n\r\n\r\nWOQLRule.prototype.size = function(size){\r\n\tif(typeof size == \"undefined\"){\r\n\t\treturn this.rule.size;\r\n\t}\r\n\tthis.rule.size = size;\r\n\treturn this;\r\n}\r\n\r\nWOQLRule.prototype.color = function(color){\r\n\tif(typeof color == \"undefined\"){\r\n\t\treturn this.rule.color;\r\n\t}\r\n\tthis.rule.color = color;\r\n\treturn this;\r\n}\r\n\r\nWOQLRule.prototype.charge = function(v){\r\n\tif(typeof v == \"undefined\"){\r\n\t\treturn this.rule.charge;\r\n\t}\r\n\tthis.rule.charge = v;\r\n\treturn this;\r\n}\r\n\r\nWOQLRule.prototype.collisionRadius = function(v){\r\n\tif(typeof v == \"undefined\"){\r\n\t\treturn this.rule.collisionRadius;\r\n\t}\r\n\tthis.rule.collisionRadius = v;\r\n\treturn this;\r\n}\r\n\r\nWOQLRule.prototype.icon = function(json){\r\n\tif(json){\r\n\t\tthis.rule.icon = json;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.rule.icon;\r\n}\r\n\r\nWOQLRule.prototype.text = function(json){\r\n\tif(json){\r\n\t\tthis.rule.text = json;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.rule.text;\r\n}\r\n\r\nWOQLRule.prototype.border = function(json){\r\n\tif(json){\r\n\t\tthis.rule.border = json;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.rule.border;\r\n}\r\n\r\nWOQLRule.prototype.arrow = function(json){\r\n\tif(json){\r\n\t\tthis.rule.arrow = json;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.rule.arrow;\r\n}\r\n\r\nWOQLRule.prototype.distance = function(d){\r\n\tif(typeof d != \"undefined\"){\r\n\t\tthis.rule.distance = d;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.rule.distance;\r\n}\r\n\r\nWOQLRule.prototype.symmetric = function(d){\r\n\tif(typeof d != \"undefined\"){\r\n\t\tthis.rule.symmetric = d;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.rule.symmetric ;\r\n}\r\n\r\n\r\nWOQLRule.prototype.weight = function(w){\r\n\tif(typeof w != \"undefined\"){\r\n\t\tthis.rule.weight = w;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.rule.weight;\r\n}\r\n\r\n/*\r\n * Table\r\n */\r\n\r\nWOQLRule.prototype.renderer = function(rend){\r\n\tif(typeof rend == \"undefined\"){\r\n\t\treturn this.rule.renderer;\r\n\t}\r\n\tthis.rule.renderer = rend;\r\n\treturn this;\r\n}\r\n\r\nWOQLRule.prototype.header = function(hdr){\r\n\tif(typeof hdr == \"undefined\"){\r\n\t\treturn this.rule.header;\r\n\t}\r\n\tthis.rule.header = hdr;\r\n\treturn this;\r\n}\r\n\r\n\r\nWOQLRule.prototype.render = function(func){\r\n\tif(typeof func == \"undefined\"){\r\n\t\treturn this.rule.render;\r\n\t}\r\n\tthis.rule.render = func;\r\n\treturn this;\r\n}\r\n\r\nWOQLRule.prototype.click = function(onClick){\r\n\tif(onClick){\r\n\t\tthis.rule.click = onClick;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.rule.click;\r\n}\r\n\r\nWOQLRule.prototype.hover = function(onHover){\r\n\tif(onHover){\r\n\t\tthis.rule.hover = onHover;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.rule.hover;\r\n}\r\n\r\n/*\r\n * All\r\n */\r\n\r\n\r\nWOQLRule.prototype.hidden = function(hidden){\r\n\tif(typeof hidden == \"undefined\"){\r\n\t\treturn this.rule.hidden;\r\n\t}\r\n\tthis.rule.hidden = hidden;\r\n\treturn this;\r\n}\r\n\r\nWOQLRule.prototype.args = function(args){\r\n\tif(typeof args == \"undefined\"){\r\n\t\treturn this.rule.args;\r\n\t}\r\n\tthis.rule.args = args;\r\n\treturn this;\r\n}\r\n\r\n/*\r\n * The below are conditions\r\n */\r\nWOQLRule.prototype.literal = function(tf){\r\n\tif(typeof tf == \"undefined\"){\r\n\t\treturn this.rule.literal;\r\n\t}\r\n\tthis.rule.literal = tf;\r\n\treturn this;\r\n}\r\n\r\nWOQLRule.prototype.type = function(...list){\r\n\tif(typeof list == \"undefined\" || list.length == 0){\r\n\t\treturn this.rule.type;\r\n\t}\r\n\tthis.rule.type = list;\r\n\treturn this;\r\n}\r\n\r\nWOQLRule.prototype.setVariables = function(vars){\r\n\tif(vars && vars.length){\r\n\t\tthis.rule.variables = addNamespacesToVariables(vars);\r\n\t\tthis.current_variable = this.rule.variables[this.rule.variables.length - 1];\r\n\t}\r\n\treturn this;\r\n}\r\n\r\nWOQLRule.prototype.v = function(v){\r\n\tif(v){\r\n\t\tif(v.substring(0, 2) != \"v:\") v = \"v:\" + v;\r\n\t\tthis.current_variable = v;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.current_variable;\r\n}\r\n\r\nWOQLRule.prototype.in = function(...list){\r\n\tif(this.current_variable){\r\n\t\tif(!this.rule.constraints) this.rule.constraints = {};\r\n\t\tif(!this.rule.constraints[this.current_variable]) this.rule.constraints[this.current_variable] = [];\r\n\t\tthis.rule.constraints[this.current_variable].push(list);\r\n\t}\r\n\treturn this;\r\n}\r\n\r\nWOQLRule.prototype.filter = function(tester){\r\n\tif(this.current_variable){\r\n\t\tif(!this.rule.constraints) this.rule.constraints = {};\r\n\t\tif(!this.rule.constraints[this.current_variable]) this.rule.constraints[this.current_variable] = [];\r\n\t\tthis.rule.constraints[this.current_variable].push(tester);\r\n\t}\r\n\treturn this;\r\n}\r\n\r\nWOQLRule.prototype.label = function(l){\r\n\tif(l){\r\n\t\tthis.rule.label = l;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.rule.label;\r\n}\r\n\r\nWOQLRule.prototype.title = function(l){\r\n\tif(l){\r\n\t\tthis.rule.title = l;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.rule.title;\r\n}\r\n\r\n/*\r\n * This is for chooser\r\n */\r\n\r\nWOQLRule.prototype.selected = function(s){\r\n\tif(typeof s != \"undefined\"){\r\n\t\tthis.rule.selected = s;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.rule.selected;\r\n}\r\n\r\n\r\n/*\r\n * Matches on\r\n * 1. scope (row, cell, column)\r\n * 2. variables - only match certain ones\r\n * 3. type - only match datatype\r\n * 4. constraints - on values of variables\r\n */\r\n\r\nWOQLRule.prototype.match = function(data, key, context, action){\r\n\tif(context && this.rule.scope != context) return false;\r\n\tif(key){\r\n\t\tif(this.rule.variables && this.rule.variables.length){\r\n\t\t\tif(typeof key == \"object\"){\r\n\t\t\t\tif(this.rule.variables.indexOf(key[0]) == -1) return false;\r\n\t\t\t\tif(this.rule.variables.indexOf(key[1]) == -1) return false;\r\n\t\t\t}\r\n\t\t\telse if(this.rule.variables.indexOf(key) == -1) return false;\r\n\t\t}\r\n\t\tif(this.rule && this.rule.type){\r\n\t\t\tif(typeof key == \"object\"){\r\n\t\t\t\tif(!(data[key][0][\"@type\"] && this.rule.type.indexOf(data[key][0][\"@type\"]) != -1)){\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse if(!(data[key][\"@type\"] && this.rule.type.indexOf(data[key][\"@type\"]) != -1)){\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(this.rule && typeof this.rule.literal != \"undefined\"){\r\n\t\t\tif(typeof key == \"object\"){\r\n\t\t\t\tif(data[key[0]]['@value']) {\r\n\t\t\t\t\tif(!this.rule.literal) return false;\r\n\t\t\t\t}\r\n\t\t\t\telse if(this.rule.literal) return false;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tif(data[key]['@value']) {\r\n\t\t\t\t\tif(!this.rule.literal) return false;\r\n\t\t\t\t}\r\n\t\t\t\telse if(this.rule.literal) return false;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(typeof key == \"object\"){\r\n\t\t\tif(this.rule.constraints && this.rule.constraints[key[0]]){\r\n\t\t\t\tif(!data) return false;\r\n\t\t\t\tfor(var i = 0; i<this.rule.constraints[key[0]].length; i++){\r\n\t\t\t\t\tif(!this.test(data[key[0]], this.rule.constraints[key][0])){\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif(this.rule.constraints && this.rule.constraints[key[1]]){\r\n\t\t\t\tif(!data) return false;\r\n\t\t\t\tfor(var i = 0; i<this.rule.constraints[key[1]].length; i++){\r\n\t\t\t\t\tif(!this.test(data[key[1]], this.rule.constraints[key][1])){\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if(this.rule.constraints && this.rule.constraints[key]){\r\n\t\t\tif(!data) return false;\r\n\t\t\tfor(var i = 0; i<this.rule.constraints[key].length; i++){\r\n\t\t\t\tif(!this.test(data[key], this.rule.constraints[key])){\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(context == \"edge\"){\r\n\t\t\tif(this.rule.source && this.rule.source != key[0]) return false;\r\n\t\t\tif(this.rule.target && this.rule.target != key[1]) return false;\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tfor(var k in this.rule.constraints){\r\n\t\t\tif(!data) return false;\r\n\t\t\tfor(var i = 0; i<this.rule.constraints[k].length; i++){\r\n\t\t\t\tif(!this.test(data[k], this.rule.constraints[k])){\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tif(action && typeof this.rule[action] == \"undefined\") return false;\r\n\treturn true;\r\n}\r\n\r\nWOQLRule.prototype.test = function(value, constraint){\r\n\tif(typeof constraint == \"object\" && constraint.length){\r\n\t\tvar vundertest = (value['@value'] ? value['@value'] : value);\r\n\t\treturn (constraint.indexOf(vundertest) != -1);\r\n\t}\r\n\tif(typeof constraint == \"function\"){\r\n\t\treturn constraint(value);\r\n\t}\r\n}\r\n\r\n\r\n/*\r\n * Utility function adds v: to variables...\r\n */\r\nfunction addNamespacesToVariables(vars){\r\n\tvar nvars = [];\r\n\tfor(var i = 0; i<vars.length; i++){\r\n\t\tvar nvar = (vars[i].substring(0, 2) == \"v:\") ? vars[i] : \"v:\" + vars[i];\r\n\t\tnvars.push(nvar);\r\n\t}\r\n\treturn nvars;\r\n}\r\n\r\nfunction removeNamespaceFromVariable(mvar){\r\n\tif(mvar.substring(0, 2) == \"v:\") return mvar.substring(2)\r\n\treturn mvar;\r\n}\r\n\r\n\r\nfunction removeNamespacesFromVariables(vars){\r\n\tvar nvars = [];\r\n\tfor(var i = 0; i<vars.length; i++){\r\n\t\tnvars.push(removeNamespaceFromVariable(vars[i]));\r\n\t}\r\n\treturn nvars;\r\n}\r\n\r\n\r\nfunction getMatchingRules(rules, row, key, context, action){\r\n\tvar matches = [];\r\n\tfor(var i = 0; i<rules.length; i++){\r\n\t\tif(rules[i].match(row, key, context, action)){\r\n\t\t\tmatches.push(rules[i].rule);\r\n\t\t}\r\n\t}\r\n\treturn matches;\r\n}\r\n\r\n\r\n/*\r\n *\r\nvar x = WOQL.schema();\r\nx.addClass(\"my:Class\").label(\"A class\").comment(\"A comment\").abstract().relationship();\r\nx.addProperty(\"my:prop\", \"xsd:string\").domain(\"my:Class\").label(\"x\").comment(\"x\").max(2).min(1);\r\nx.execute(client).then ...\r\n */\r\n","const TerminusClient = require('@terminusdb/terminus-client');\r\n\r\n/*\r\n * Very simple implementation of a WOQL backed chooser\r\n * Makes a drop down from a WOQL query - configuration tells it which columns to use...\r\n */\r\n\r\nfunction WOQLChooser(client, options){\r\n\tthis.client = client;\r\n\tthis.selected = false;\r\n\treturn this.options(options);\r\n}\r\n\r\nWOQLChooser.prototype.options = function(config){\r\n\tthis.config = config || TerminusClient.WOQL.chooser();\t\r\n\treturn this;\r\n}\r\n\r\nWOQLChooser.prototype.set = function(id){\r\n\tif(this.selected != id){\r\n\t\tthis.selected = id;\r\n\t\tlet ch = this.config.change;\r\n\t\tif(ch) ch(id);\r\n\t}\r\n}\r\n\r\nWOQLChooser.prototype.render = function(){\r\n\tif(this.renderer) return this.renderer.render(this);\r\n}\r\n\r\nWOQLChooser.prototype.setRenderer = function(rend){\r\n\tthis.renderer = rend;\r\n\treturn this;\r\n}\r\n\r\n/*\r\n * Sets up the required variables from the result / config\r\n */\r\nWOQLChooser.prototype.setResult = function(result){\r\n\tthis.result = result;\r\n\tthis.choices = [];\r\n\tthis.cursor = 0;\r\n\tconst variables = result.getVariableList();\r\n\tif(!this.config.values() && variables.length){\r\n\t\tthis.config.values(variables[0]);\r\n\t}\r\n\t//sort it \r\n\tif(this.config.sort()){\r\n\t\tthis.result.sort(this.config.sort(), this.config.direction());\r\n\t}\r\n\twhile(row = this.result.next()){\r\n\t\tif(row && this.includeRow(row)){\r\n\t\t\tthis.choices.push(this.rowToChoice(row, this.result.cursor));\r\n\t\t}\r\n\t}\r\n\treturn this;\r\n}\r\n\r\nWOQLChooser.prototype.includeRow = function(row){\r\n\tconst matched_rules = this.config.getMatchingRules(row, false, \"row\", \"hidden\");\r\n\tfor(var i = 0; i<matched_rules.length; i++){\r\n\t\tif(matched_rules[i].hidden) return false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nWOQLChooser.prototype.rowToChoice = function(binding, rownum){\r\n\tvar choice = { \r\n\t\tid: this.getRowID(binding) \r\n\t};\r\n\tchoice.label = this.getLabelFromBinding(binding, rownum);\r\n\tchoice.title = this.getTitleFromBinding(binding, rownum);\r\n\tchoice.selected = this.getSelectedFromBinding(binding, rownum);\r\n\treturn choice;\r\n}\r\n\r\nWOQLChooser.prototype.getRowID = function(binding){\r\n\tvar rval = binding[this.config.values()];\r\n\tif(rval['@value']) return rval['@value'];\r\n\treturn rval;\r\n}\r\n\r\nWOQLChooser.prototype.getLabelFromBinding = function(binding, rownum){\r\n\tlet sp = this.getSpecialRenderer(binding, \"label\");\r\n\tif(sp) return this.renderSpecial(sp, binding, rownum);\r\n\tif(this.config.labels()){\r\n\t\tif(binding[this.config.labels()]){\r\n\t\t\tvar lab = binding[this.config.labels()];\r\n\t\t\tif(lab[\"@value\"]) lab = lab[\"@value\"];\r\n\t\t\tif(lab != \"unknown\") return lab;\r\n\t\t}\r\n\t}\r\n\treturn TerminusClient.FrameHelper.labelFromURL(this.getRowID(binding));\r\n}\r\n\r\nWOQLChooser.prototype.getTitleFromBinding = function(binding, rownum){\r\n\tlet sp = this.getSpecialRenderer(binding, \"title\");\r\n\tif(sp) return this.renderSpecial(sp, binding, rownum);\r\n\tif(this.config.titles()){\r\n\t\tif(binding[this.config.titles()]){\r\n\t\t\tvar lab = binding[this.config.titles()];\r\n\t\t\tif(lab[\"@value\"]) lab = lab[\"@value\"];\r\n\t\t\tif(lab != \"unknown\") return lab;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nWOQLChooser.prototype.getSelectedFromBinding = function(binding){\r\n\tconst matched_rules = this.config.getMatchingRules(row, false, \"row\", \"selected\");\r\n\tif(matched_rules && matched_rules.length){\r\n\t\treturn matched_rules[matched_rules.length - 1].selected;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nWOQLChooser.prototype.getSpecialRenderer = function(row, type){\r\n\tconst matched_rules = this.config.getMatchingRules(row, false, \"row\", type);\r\n\tfor(var i = 0; i<matched_rules.length; i++){\r\n\t\tif(matched_rules[i][type]) return matched_rules[i][type];\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nWOQLChooser.prototype.renderSpecial = function(rule, row, rownum){\r\n\tif(rule && typeof rule == \"function\"){\r\n\t\treturn render(row);\r\n\t}\r\n\tif(rule && typeof rule == \"string\"){\r\n\t\treturn rule;\r\n\t}\r\n}\r\n\r\nWOQLChooser.prototype.count = function(){\r\n\treturn this.result.count();\r\n}\r\n\r\nWOQLChooser.prototype.first = function(){\r\n\tthis.cursor = 0;\r\n\treturn this.choices[this.cursor];\r\n}\r\n\r\nWOQLChooser.prototype.prev = function(){\r\n\tif(this.cursor > 0) {\r\n\t\treturn this.choices[--this.cursor];\r\n\t}\r\n}\r\n\r\nWOQLChooser.prototype.next = function(){\r\n\treturn this.choices[this.cursor++];\r\n}\r\n\r\n\r\nmodule.exports = WOQLChooser;","const TerminusClient = require('@terminusdb/terminus-client');\r\nconst DatatypeRenderers = require(\"./DatatypeRenderers\");\r\n\r\nfunction WOQLTable(client, config){\r\n\tthis.client = client;\r\n\tif(config) this.options(config);\r\n\treturn this;\r\n}\r\n\r\nWOQLTable.prototype.setResult = function(res){\r\n\tthis.result = res;\r\n\treturn this;\r\n}\r\n\r\nWOQLTable.prototype.setRenderer = function(rend){\r\n\tthis.renderer = rend;\r\n\treturn this;\r\n}\r\n\r\nWOQLTable.prototype.render = function(onChangeQuery){\r\n\tif(this.renderer) return this.renderer.render(this, onChangeQuery);\r\n}\r\n\r\nWOQLTable.prototype.count = function(){\r\n\treturn this.result.count();\r\n}\r\n\r\nWOQLTable.prototype.first = function(){\r\n\treturn this.result.first();\r\n}\r\n\r\nWOQLTable.prototype.prev = function(){\r\n\treturn this.result.prev();\r\n}\r\n\r\nWOQLTable.prototype.next = function(){\r\n\treturn this.result.next();\r\n}\r\n\r\n\r\nWOQLTable.prototype.options = function(config){\r\n\tthis.config = config || TerminusClient.WOQL.table();\t\r\n\treturn this;\r\n}\r\n\r\nWOQLTable.prototype.setDatatypes = function(func){\r\n\tthis.datatypes = new DatatypeRenderers();\r\n\tif(this.config.datatypes) this.datatypes.options(this.config.datatypes);\r\n\tif(func) func(this.datatypes);\r\n\treturn this;\r\n}\r\n\r\nWOQLTable.prototype.canAdvancePage = function(){\r\n\treturn (this.result.count() == this.result.query.getLimit()); \r\n}\r\n\r\nWOQLTable.prototype.canChangePage = function(){\r\n\treturn this.canAdvancePage() || this.canRetreatPage();\r\n}\r\n\r\nWOQLTable.prototype.canRetreatPage = function(){\r\n\treturn (this.result.query.getPage() > 1);\r\n}\r\n\r\nWOQLTable.prototype.getPageSize = function(){\r\n\treturn this.result.query.getLimit() ;\t\r\n}\r\n\r\nWOQLTable.prototype.setPage = function(l){\r\n\treturn this.result.query.setPage(l);\t\r\n}\r\n\r\n\r\nWOQLTable.prototype.getPage = function(){\r\n\treturn this.result.query.getPage();\t\r\n}\r\n\r\nWOQLTable.prototype.setPageSize = function(l){\r\n\treturn this.update(this.result.query.setPageSize(l));\r\n}\r\n\r\nWOQLTable.prototype.nextPage = function(){\r\n\treturn this.update(this.result.query.nextPage());\r\n}\r\n\r\nWOQLTable.prototype.firstPage = function(){\r\n\treturn this.update(this.result.query.firstPage());\r\n}\r\n\r\nWOQLTable.prototype.previousPage = function(){\r\n\treturn this.update(this.result.query.previousPage());\r\n}\r\n\r\nWOQLTable.prototype.getColumnsToRender = function(){\r\n\tif(this.hasColumnOrder()){\r\n\t\tvar cols = this.getColumnOrder();\r\n\t}\r\n\telse if(this.result.query.hasSelect()){\r\n\t\tvar cols = this.result.query.getSelectVariables();\r\n\t}\r\n\telse {\r\n\t\tvar cols = this.result.getVariableList();\r\n\t}\r\n\tvar self = this;\r\n\treturn (cols ? cols.filter(col => !self.hidden(col)) : []);\r\n}\r\n\r\nWOQLTable.prototype.getColumnHeaderContents = function(colid){\r\n\tlet hr = this.config.getMatchingRules(false, colid, \"column\", \"header\");\r\n\tif(hr && hr.length){\r\n\t\tlet h = hr[hr.length-1].header;\r\n\t\tif(typeof h == \"string\"){\r\n\t\t\treturn document.createTextNode(h);\t\t\t\r\n\t\t}\r\n\t\telse if(typeof h == \"function\"){\r\n\t\t\treturn h(colid);\r\n\t\t}\r\n\t\telse return h;\r\n\t}\r\n\tif(colid.indexOf(\"v:\") === 0) colid = colid.substring(2);\r\n\tvar clab = (colid.indexOf(\"http\") != -1) ? TerminusClient.FrameHelper.labelFromURL(colid) : colid;\r\n\tclab = clab.replace(\"_\", \" \");\r\n\treturn document.createTextNode(clab);\r\n}\r\n\r\n\r\nWOQLTable.prototype.hidden = function(col){\r\n\tconst matched_rules = this.config.getMatchingRules(false, col, \"column\", \"hidden\");\r\n\tif(matched_rules.length){\r\n\t\treturn matched_rules[matched_rules.length-1].hidden;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\n/**\r\n * Called when you want to change the query associated with the table. \r\n */\r\nWOQLTable.prototype.update = function(nquery){\r\n\treturn nquery.execute(this.client).then((results) => {\r\n\t\tvar nresult = new TerminusClient.WOQLResult(results, nquery);\r\n\t\tthis.setResult(nresult);\r\n\t\tif(this.notify) this.notify(nresult);\r\n\t\treturn nresult;\r\n\t});\t\r\n}\r\n\r\nWOQLTable.prototype.hasDefinedEvent = function(row, key, context, action){\r\n\tconst matched_rules = this.config.getMatchingRules(row, key, context, action);\r\n\tif(matched_rules && matched_rules.length) return true;\r\n\treturn false;\r\n}\r\n\r\nWOQLTable.prototype.getDefinedEvent = function(row, key, context, action){\r\n\tconst matched_rules = this.config.getMatchingRules(row, key, context, action);\r\n\tif(matched_rules && matched_rules.length) {\r\n\t\tvar l = (matched_rules.length - 1);\r\n\t\treturn matched_rules[l][action];\r\n\t}\r\n}\r\n\r\n\r\nWOQLTable.prototype.getRowClick = function(row){\r\n\tlet re = this.getDefinedEvent(row, false, \"row\", \"click\");\r\n\treturn re;\r\n}\r\n\r\nWOQLTable.prototype.getCellClick = function(row, col){\r\n\tlet cc = this.getDefinedEvent(row, col, \"column\", \"click\");\r\n\treturn cc;\r\n}\r\n\r\nWOQLTable.prototype.getRowHover = function(row){\r\n\treturn this.getDefinedEvent(row, false, \"row\", \"hover\");\r\n}\r\n\r\nWOQLTable.prototype.getCellHover = function(row, key){\r\n\treturn this.getDefinedEvent(row, key, \"column\", \"hover\");\r\n}\r\n\r\nWOQLTable.prototype.getColumnOrder = function(){\r\n\treturn this.config.column_order();\r\n}\r\n\r\nWOQLTable.prototype.hasColumnOrder = WOQLTable.prototype.getColumnOrder;\r\nWOQLTable.prototype.hasCellClick = WOQLTable.prototype.getCellClick;\r\nWOQLTable.prototype.hasRowClick = WOQLTable.prototype.getRowClick;\r\nWOQLTable.prototype.hasCellHover = WOQLTable.prototype.getCellHover;\r\nWOQLTable.prototype.hasRowHover = WOQLTable.prototype.getRowHover;\r\n\r\nWOQLTable.prototype.getRenderer = function(key, row){\r\n\tvar rend = this.getSpecificRender(key, row);\r\n\tif(rend) return rend;\r\n\tlet renderer = this.getDefinedEvent(row, key, \"column\", \"renderer\");\r\n\tlet args =  this.getDefinedEvent(row, key, \"column\", \"args\");\r\n\tif(!renderer){\r\n\t\tlet r = this.getRendererForDatatype(row[key]);\r\n\t\trenderer = r.name;\r\n\t\tif(!args) args = r.args;\r\n\t}\r\n\tif(renderer){\r\n\t\treturn this.datatypes.createRenderer(renderer, args);\t\t\r\n\t}\r\n}\r\n\r\nWOQLTable.prototype.renderValue = function(renderer, val, key, row){\r\n\tif(val && val['@type']){\r\n\t\trenderer.type = val['@type'];\r\n\t\tvar dv = new DataValue(val['@value'], val['@type'], key, row);\r\n\t}\t\r\n\telse if(val && val['@language']){\r\n\t\trenderer.type = \"xsd:string\";\r\n\t\tvar dv = new DataValue(val['@value'], renderer.type, key, row);\r\n\t}\r\n\telse if(val && typeof val == \"string\"){\r\n\t\trenderer.type = \"id\";\r\n\t\tvar dv = new DataValue(val, \"id\", key, row);\r\n\t}\r\n\tif(dv) return renderer.renderValue(dv);\r\n\treturn \"\";\r\n}\r\n\r\nfunction DataValue(val, type){\r\n\tthis.datavalue = (val == \"unknown\" ? \"\" : val);\r\n\tthis.datatype = type;\r\n}\r\n\r\nDataValue.prototype.value = function(nvalue){\r\n\tif(nvalue) {\r\n\t\tthis.datavalue = nvalue; \r\n\t\treturn this;\r\n\t}\r\n\treturn this.datavalue;\r\n}\r\n\r\n\r\nWOQLTable.prototype.getRendererForDatatype = function(val){\r\n\tif(val && val['@type']){\r\n\t\treturn this.datatypes.getRenderer(val['@type'], val['@value']);\r\n\t}\r\n\telse if(val && val['@language']){\r\n\t\treturn this.datatypes.getRenderer(\"xsd:string\", val['@value']);\r\n\t}\r\n\telse if(val && typeof val == \"string\"){\r\n\t\treturn this.datatypes.getRenderer(\"id\", val);\t\t\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nWOQLTable.prototype.getSpecificRender = function(key, row){\r\n\tlet rend = this.getDefinedEvent(row, key, \"column\", \"render\");\r\n\treturn rend;\r\n}\r\n\r\nmodule.exports = WOQLTable;","/*\r\n * Maintains a list of renderers that are available for rendering \r\n * datatype values - also covers choice values and id values\r\n */\r\n\r\nfunction DatatypeRenderers(options){\r\n\tthis.registeredDataViewers = {},\r\n\tthis.registeredDataEditors = {},\r\n\tthis.defaultViewers = {};\r\n\tthis.defaultEditors = {};\r\n\tthis.universalViewer = false;\r\n\tthis.universalEditor = false;\r\n\tif(options) this.options(options);\r\n\t//links to other documents, choices, id field, id fields of contained objects, ids of structural elements: properties, etc\r\n\tthis.specials = ['document', 'oneOf', 'id', 'contained', 'structural'];\r\n}\r\n\r\nDatatypeRenderers.prototype.options = function (options){\r\n\tthis.universalViewer = (options && options.universalViewer ? options.universalViewer : false);\r\n\tthis.universalEditor = (options && options.universalEditor ? options.universalEditor : false);\r\n\tthis.editor = (options && options.editor ? options.editor : false);\r\n}\r\n\r\nDatatypeRenderers.prototype.getValidDataViewerList = function(datatype){\r\n\tlet valids = [];\r\n\tif(datatype && typeof this.registeredDataViewers[datatype] != \"undefined\"){\r\n\t\tvalids = valids.concat(this.registeredDataViewers[datatype]);\r\n\t}\r\n\tif(this.universalViewer && valids.indexOf(this.universalViewer) == -1){\r\n\t\tvalids.push(this.universalViewer);\r\n\t}\r\n\treturn valids;\r\n};\r\n\r\nDatatypeRenderers.prototype.getValidDataEditorList = function(datatype){\r\n\tlet valids = [];\r\n\tif(datatype && typeof this.registeredDataEditors[datatype] != \"undefined\"){\r\n\t\tvar nftypes = this.registeredDataEditors[datatype];\r\n\t\tif(nftypes){\r\n\t\t\tfor(var i = 0; i<nftypes.length; i++){\r\n\t\t\t\tif(valids.indexOf(nftypes[i]) == -1) valids.push(nftypes[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tif(typeof this.registeredDataEditors[datatype] != \"undefined\"){\r\n\t\tvalids = valids.concat(this.registeredDataEditors[datatype]);\r\n\t}\r\n\tif(this.universalEditor && valids.indexOf(this.universalEditor) == -1){\r\n\t\tvalids.push(this.universalEditor);\r\n\t}\r\n\treturn valids;\r\n}\r\n\r\nDatatypeRenderers.prototype.getEditorForDataFrame = function(datatype){\r\n\tvar vals = this.getValidDataEditorList(datatype);\r\n\tif(this.defaultEditors[datatype] && vals[this.defaultEditors[datatype]]){\r\n\t\treturn vals[this.defaultEditors[datatype]];\r\n\t}\r\n\t//last added is default if no explicit default is set\r\n\tif(vals){\r\n\t\treturn vals[Object.keys(vals)[0]];\r\n\t}\r\n\telse {\r\n\t\tif(this.universalEditor) return this.universalEditor;\r\n\t}\r\n}\r\n\r\nDatatypeRenderers.prototype.getViewerForDataFrame = function(datatype){\r\n\tvar vals = this.getValidDataViewerList(datatype);\r\n\tif(this.defaultViewers[datatype] && vals[this.defaultViewers[datatype]]){\r\n\t\treturn vals[this.defaultViewers[datatype]];\r\n\t}\r\n\tif(vals){\r\n\t\treturn vals[Object.keys(vals)[0]];\r\n\t}\r\n\telse {\r\n\t\tif(this.universalViewer) return this.universalViewer;\r\n\t}\r\n\r\n}\r\n\r\nDatatypeRenderers.prototype.registerViewerForTypes = function(viewer, record, types){\r\n\tfor(var i = 0; i < types.length; i++){\r\n\t\tif(typeof this.registeredDataViewers[types[i]] == \"undefined\"){\r\n\t\t\tthis.registeredDataViewers[types[i]] = {};\r\n\t\t}\r\n\t\tif(!this.registeredDataViewers[types[i]][viewer]){\r\n\t\t\tthis.registeredDataViewers[types[i]][viewer] = record;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nDatatypeRenderers.prototype.registerEditorForTypes = function(viewer, record, types){\r\n\tfor(var i = 0; i < types.length; i++){\r\n\t\tif(typeof this.registeredDataEditors[types[i]] == \"undefined\"){\r\n\t\t\tthis.registeredDataEditors[types[i]] = {};\r\n\t\t}\r\n\t\tif(!this.registeredDataEditors[types[i]][viewer]){\r\n\t\t\tthis.registeredDataEditors[types[i]][viewer] = record;\r\n\t\t}\t\t\t\r\n\t}\r\n}\r\n\r\nDatatypeRenderers.prototype.getRenderer = function(type, value){\r\n\tvar r = {};\r\n\tlet v = this.getViewerForDataFrame(type);\r\n\tif(v){\r\n\t\tif(typeof v == \"object\"){\r\n\t\t\tr.name = Object.keys(v)[0];\r\n\t\t\tif(v[r.name].label){\r\n\t\t\t\tr.label = v[r.name].label;\r\n\t\t\t}\r\n\t\t\tif(v[r.name].args){\r\n\t\t\t\tr.args = v[r.name].args;\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tr.name = v;\r\n\t\t}\r\n\t\treturn r;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nDatatypeRenderers.prototype.getEditor = function(type, value){\r\n\tvar r = {};\r\n\tlet v = this.getEditorForDataFrame(type);\r\n\tif(v){\r\n\t\tif(typeof v == \"object\"){\r\n\t\t\tr.name = Object.keys(v)[0];\r\n\t\t\tif(v[r.name].label){\r\n\t\t\t\tr.label = v[r.name].label;\r\n\t\t\t}\r\n\t\t\tif(v[r.name].args){\r\n\t\t\t\tr.args = v[r.name].args;\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tr.name = v;\r\n\t\t}\r\n\t\treturn r;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\n\r\nmodule.exports=DatatypeRenderers;\r\n\r\n\r\n","const TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction WOQLGraph(client, options){\r\n\tthis.client = client;\r\n\tthis.options(options);\r\n\tthis.nodes = [];\r\n\tthis.node_ids = [];\r\n\tthis.edges = [];\r\n\treturn this;\r\n}\r\n\r\nWOQLGraph.prototype.setResult = function(result){\r\n\tthis.result = result;\r\n\tthis.calculateVariableTypes(result);\r\n}\r\n\r\nWOQLGraph.prototype.setRenderer = function(rend){\r\n\tthis.renderer = rend;\r\n\treturn this;\r\n}\r\n\r\nWOQLGraph.prototype.render = function(){\r\n\tif(this.renderer) return this.renderer.render(this);\r\n}\r\n\r\nWOQLGraph.prototype.options = function(config){\r\n\tthis.config = config || TerminusClient.WOQL.graph();\t\r\n\treturn this;\r\n}\r\n\r\nWOQLGraph.prototype.getEdges = function(){\r\n\tif(this.edges) return this.edges;\r\n\tthis.edges = [];\r\n\tvar bindings = this.result.getBindings();\r\n\tfor(var i = 0; i<bindings.length; i++){\r\n\t\tif(this.rowIncludesEdge(bindings[i])){\r\n\t\t\tthis.edges = this.edges.concat(this.makeEdgesFromRow(bindings[i]))\r\n\t\t}\r\n\t}\r\n\treturn this.edges;\r\n}\r\n\r\nWOQLGraph.prototype.getNodes = function(){\r\n\tif(this.nodes) return this.nodes;\r\n\tthis.nodes = [];\r\n\t//get column names first...\r\n\tvar bindings = this.result.getBindings();\r\n\tvar nodes = [];\r\n\tfor(var i = 0; i<bindings.length; i++){\r\n\t\tfor(var k in bindings[i]){\r\n\t\t\tif(this.source_variables.indexOf(k) != -1 && nodes.indexOf(bindings[i][k]) == -1){\r\n\t\t\t\tnodes.push(bindings[i][k]);\r\n\t\t\t\tthis.nodes.push(this.makeNodeFromSource(bindings[i][k], k, bindings[i]));\r\n\t\t\t}\r\n\t\t\tif(this.target_variables.indexOf(k) != -1 && nodes.indexOf(bindings[i][k]) == -1){\r\n\t\t\t\tnodes.push(bindings[i][k]);\r\n\t\t\t\tthis.nodes.push(this.makeNodeFromTarget(bindings[i][k], k, bindings[i]));\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn this.nodes;\r\n}\r\n\r\nWOQLGraph.prototype.makeNodeFromSource = function(sid, k, row) {\r\n\tvar node = {type: \"node\", id: sid};\r\n\treturn this.adornNode(node, row);\r\n}\r\n\r\nWOQLGraph.prototype.makeNodeFromTarget = WOQLGraph.prototype.makeNodeFromSource ;\r\n\r\nWOQLGraph.prototype.adornNode = function(node){\r\n\treturn node;\r\n}\r\n\r\nWOQLGraph.prototype.adornEdge = function(edge){\r\n\treturn edge;\r\n}\r\n\r\nWOQLGraph.prototype.makeEdgeFromRow = function(eid, k, row){\r\n\tvar target = false;\r\n\tvar source = false;\r\n\tfor(var i = 0; i<this.target_variables.length; i++){\r\n\t\tif(row[this.target_variables[i]]){\r\n\t\t\ttarget = row[this.target_variables[i]];\r\n\t\t\tcontinue;\r\n\t\t}\r\n\t}\r\n\tif(target){\r\n\t\tfor(var i = 0; i<this.source_variables.length; i++){\r\n\t\t\tif(row[this.source_variables[i]]){\r\n\t\t\t\tsource = row[this.source_variables[i]];\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t}\t\t\r\n\t}\r\n\tif(source && target){\r\n\t\tvar edge = { type: \"link\", id: eid, target: target, source: source };\r\n\t\treturn this.adornEdge(edge, row);\r\n\t}\r\n}\r\n\r\nWOQLGraph.prototype.calculateVariableTypes = function(){\r\n\tvar bindings = this.result.getBindings();\r\n\tif(bindings && bindings.length){\r\n\t\tfor(var i = 0; i<bindings.length; i++){\r\n\t\t\tthis.extractFromBinding(bindings[i]);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nWOQLGraph.prototype.extractFromBinding = function(row){\r\n\t//\r\n\tif(this.includeRow(row)){\r\n\t\t//get all the nodes (ids - non literals) //\r\n\t\t//see which nodes are excluded ...\r\n\t\tvar nodes = [];\r\n\t\tvar lits = [];\r\n\t\tfor(var k in row){\r\n\t\t\tif(typeof row[k] == \"string\"){\r\n\t\t\t\tif(row[k] && row[k] != \"unknown\" && this.includeNode(k, row)) nodes.push(k);\r\n\t\t\t}\r\n\t\t\telse if(typeof row[k][\"@value\"] == \"string\" && this.includeLiteralNode(k, row)){\r\n\t\t\t\tlits.push(k);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(nodes.length == 0) return;\r\n\t\t//first of all we need to make the literal nodes targets of \r\n\t\tfor(var i = 0; i<lits.length; i++){\r\n\t\t\t//make an edge and put the lit in as a node...\r\n\t\t\tvar nid = TerminusClient.FrameHelper.genBNID().substring(2);\r\n\t\t\tlet source = this.getLiteralOwner(nodes, lits[i], row);\r\n\t\t\tif(source) {\r\n\t\t\t\tthis.addAdornedNode(nid, lits[i], row);\r\n\t\t\t\tthis.addAdornedEdge(row[source], nid, source, lits[i], row);\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.createEdgesFromIDs(nodes, row);\r\n\t\tfor(var i = 0; i<nodes.length; i++){\r\n\t\t\tvar ndid = row[nodes[i]];\r\n\t\t\tthis.addAdornedNode(ndid, nodes[i], row);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nWOQLGraph.prototype.addAdornedEdge = function(source, target, ks, kt, row){\r\n\tvar edge = { type: \"link\", target: target, source: source, text: kt};\r\n\tconst matched_rules = this.config.getMatchingRules(row, [ks, kt], \"edge\");\r\n\tfor(var i = 0; i<matched_rules.length; i++){\r\n\t\tif(matched_rules[i].size){\r\n\t\t\tif(typeof matched_rules[i].size == \"string\" && matched_rules[i].size.substring(0, 2) == \"v:\"){\r\n\t\t\t\tvar w = row[matched_rules[i].size];\r\n\t\t\t\tif(w && w['@value']) edge.size = w['@value'];\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tedge.size = matched_rules[i].size;\r\n\t\t\t}\t\t\t\r\n\t\t}\r\n\t\tif(matched_rules[i].color){\r\n\t\t\tedge.color = matched_rules[i].color;\t\t\t\r\n\t\t}\r\n\t\tif(matched_rules[i].distance){\r\n\t\t\tif(typeof matched_rules[i].distance == \"string\" && matched_rules[i].distance.substring(0, 2) == \"v:\"){\r\n\t\t\t\tvar w = row[matched_rules[i].distance];\r\n\t\t\t\tif(w && w['@value']) edge.distance = w['@value'];\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tedge.distance = matched_rules[i].distance;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(matched_rules[i].arrow){\r\n\t\t\tedge.arrow = matched_rules[i].arrow;\r\n\t\t}\r\n\t\tif(typeof matched_rules[i].symmetric != \"undefined\"){\r\n\t\t\tedge.symmetric = matched_rules[i].symmetric;\r\n\t\t}\r\n\t\tif(matched_rules[i].weight){\r\n\t\t\tif(typeof matched_rules[i].weight == \"string\" && matched_rules[i].weight.substring(0, 2) == \"v:\"){\r\n\t\t\t\tvar w = row[matched_rules[i].weight];\r\n\t\t\t\tif(w && w['@value']) edge.weight = w['@value'];\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tedge.weight = matched_rules[i].weight;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tthis.edges.push(edge);\t\r\n}\r\n\r\nWOQLGraph.prototype.addAdornedNode = function(nid, k, row){\r\n\tvar node = { type: \"node\", id: nid, nodetype: k };\r\n\tconst matched_rules = this.config.getMatchingRules(row, k, \"node\");\r\n\tfor(var i = 0; i<matched_rules.length; i++){\r\n\t\tif(matched_rules[i].size){\r\n\t\t\tif(typeof matched_rules[i].size == \"string\" && matched_rules[i].size.substring(0, 2) == \"v:\"){\r\n\t\t\t\tvar rad = row[matched_rules[i].size];\r\n\t\t\t\tif(rad && rad['@value']) node.radius = rad['@value'];\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tnode.radius = matched_rules[i].size;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(matched_rules[i].color){\r\n\t\t\tnode.color = matched_rules[i].color;\r\n\t\t}\r\n\t\tif(matched_rules[i].charge){\r\n\t\t\tif(typeof matched_rules[i].charge == \"string\" && matched_rules[i].charge.substring(0, 2) == \"v:\"){\r\n\t\t\t\tvar rad = row[matched_rules[i].charge];\r\n\t\t\t\tif(rad && rad['@value']) node.charge = rad['@value'];\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tnode.charge = matched_rules[i].charge;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(matched_rules[i].collisionRadius ){\r\n\t\t\tif(typeof matched_rules[i].collisionRadius == \"string\" && matched_rules[i].collisionRadius.substring(0, 2) == \"v:\"){\r\n\t\t\t\tvar rad = row[matched_rules[i].collisionRadius];\r\n\t\t\t\tif(rad && rad['@value']) node.collisionRadius = rad['@value'];\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tnode.collisionRadius= matched_rules[i].collisionRadius;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(matched_rules[i].icon ){\r\n\t\t\tnode.icon = matched_rules[i].icon;\r\n\t\t}\r\n\t\tif(matched_rules[i].text){\r\n\t\t\tnode.text = matched_rules[i].text;\r\n\t\t}\r\n\t\tif(matched_rules[i].border){\r\n\t\t\tnode.border = matched_rules[i].border;\r\n\t\t}\r\n\t}\r\n\tif(!node.text){\r\n\t\tif(typeof row[k] == \"string\") node.text = row[k];\r\n\t\telse if(row[k]['@value']) node.text = row[k]['@value'];\r\n\t}\r\n\tthis.nodes.push(node);\r\n}\r\n\r\nWOQLGraph.prototype.getLiteralOwner = function(nodes, v, row){\r\n\tvar cs = this.config.source();\r\n\tif(cs && row[cs]){\r\n\t\treturn cs;\r\n\t}\r\n\tvar edges = this.config.edges();\r\n\tif(edges){\r\n\t\tfor(var i = 0; i < edges.length; i++){\r\n\t\t\tif(edges[i][1] == v){\r\n\t\t\t\treturn edges[i][0];\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\treturn nodes[0];\r\n}\r\n\r\nWOQLGraph.prototype.createEdgesFromIDs = function(nodes, row){\r\n\tif(nodes.length < 2) return;\r\n\tvar cs = this.config.source();\r\n\tlet es = this.config.edges();\r\n\tif(!cs && es && es.length){\r\n\t\tfor(var i = 0; i< es.length; i++){\r\n\t\t\tif(nodes.indexOf(es[i][0]) != -1 && nodes.indexOf(es[i][1]) != -1 ){\r\n\t\t\t\tthis.addAdornedEdge(row[es[i][0]], row[es[i][1]], es[i][0], es[i][1], row);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn;\r\n\t}\r\n\tvar s = (cs && nodes.indexOf(cs) != -1) ? cs : nodes[0];\r\n\tfor(var i = 0; i<nodes.length; i++){\r\n\t\tif(nodes[i] == s) continue;\r\n\t\tthis.addAdornedEdge(row[s], row[nodes[i]], s, nodes[i], row);\r\n\t}\r\n}\r\n\r\nWOQLGraph.prototype.includeNode = function(v, row){\r\n\tconst matched_rules = this.config.getMatchingRules(row, v, \"node\", \"hidden\");\r\n\tfor(var i = 0; i<matched_rules.length; i++){\r\n\t\tif(matched_rules[i].hidden) return false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nWOQLGraph.prototype.includeLiteralNode = function(v, row){\r\n\tlet l = this.config.literals();\r\n\tif(typeof l != \"undefined\" && !l) return false;\r\n\tconst matched_rules = this.config.getMatchingRules(row, v, \"node\", \"hidden\");\r\n\tfor(var i = 0; i<matched_rules.length; i++){\r\n\t\tif(matched_rules[i].hidden) return false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\n\r\nWOQLGraph.prototype.includeRow = function(row){\r\n\tconst matched_rules = this.config.getMatchingRules(row, false, \"row\", \"hidden\");\r\n\tfor(var i = 0; i<matched_rules.length; i++){\r\n\t\tif(matched_rules[i].hidden) return false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\n\r\n\r\nmodule.exports = WOQLGraph;","/*\r\n * Maps a woql query to a stream of results...\r\n */\r\n\r\nfunction WOQLStream(client){\r\n\tthis.client = client;\r\n}\r\n\r\nWOQLStream.prototype.options = function(opts){\r\n\tthis.page_size = 10;\r\n\treturn this;\r\n}\r\n\r\nWOQLStream.prototype.setResult = function(wqrs){\r\n\tthis.result = wqrs;\r\n}\r\n\r\nWOQLStream.prototype.setRenderer = function(rend){\r\n\tthis.renderer = rend;\r\n\treturn this;\r\n}\r\n\r\nWOQLStream.prototype.render = function(){\r\n\tif(this.renderer) return this.renderer.render(this);\r\n}\r\n\r\nmodule.exports = WOQLStream;","const TerminusClient = require('@terminusdb/terminus-client');\r\nconst TerminusCodeSnippet = require('./query/TerminusCodeSnippet');\r\nconst ResultPane = require(\"./ResultPane\");\r\nconst UTILS = require('../Utils');\r\nconst HTMLFrameHelper = require('./HTMLFrameHelper');\r\n\r\nfunction QueryPane(client, query, result){\r\n\tthis.client = client;\r\n\tthis.query = query;\r\n\tthis.result = result;\r\n\tthis.views = [];\r\n\tthis.container = document.createElement('span');\r\n    this.container.setAttribute('class', 'terminus-query-pane-cont');\r\n\tthis.fireDefaultQueries();\r\n}\r\n\r\nQueryPane.prototype.fireDefaultQueries = function(){\r\n\tlet WOQL = TerminusClient.WOQL;\r\n\tvar query = WOQL.query().classMetadata();\r\n\tquery.execute(this.client).then((results) => {\r\n\t\tlet qcres = new TerminusClient.WOQLResult(results, query);\r\n\t\tthis.classMetaDataRes = qcres;\r\n\t})\r\n\tvar query = WOQL.query().propertyMetadata();\r\n\tquery.execute(this.client).then((results) => {\r\n\t\tlet qpres = new TerminusClient.WOQLResult(results, query);\r\n\t\tthis.propertyMetaDataRes = qpres;\r\n\t})\r\n}\r\n\r\nQueryPane.prototype.options = function(opts){\r\n\tthis.showQuery = (opts && typeof opts.showQuery != \"undefined\" ? opts.showQuery : true);\r\n\tthis.editQuery = (opts && typeof opts.editQuery != \"undefined\" ? opts.editQuery : true);\r\n\tthis.showHeader = (opts && typeof opts.showHeader != \"undefined\" ? opts.showHeader : false);\r\n\tthis.addViews = (opts && typeof opts.addViews != \"undefined\" ? opts.addViews : false);\r\n\tthis.intro = (opts && typeof opts.intro != \"undefined\" ? opts.intro : false);\r\n\tthis.defaultResultView = { showConfig: \"true\", editConfig: \"true\" };\r\n    return this;\r\n}\r\n\r\nQueryPane.prototype.getSection = function(sName){\r\n\tvar btn = document.createElement('button');\r\n\tbtn.setAttribute('class', 'terminus-query-section');\r\n\tbtn.appendChild(document.createTextNode(sName));\r\n\treturn btn;\r\n}\r\n\r\nQueryPane.prototype.clearSubMenus = function(btn){\r\n\tvar par = btn.parentElement.parentElement;\r\n\tvar smenus = par.getElementsByClassName('terminus-queries-submenu');\r\n\tfor(var i=0; i<smenus.length; i++){\r\n\t\tTerminusClient.FrameHelper.removeChildren(smenus[i]);\r\n\t}\r\n}\r\n\r\nQueryPane.prototype.getResults = function(query){\r\n\tif(query)\r\n\t\tthis.input.setQuery(query);\r\n\tTerminusClient.FrameHelper.removeChildren(this.sampleQueryDOM);\r\n\tthis.input.refreshContents();\r\n}\r\n\r\nQueryPane.prototype.AddEvents = function(btn){\r\n\tvar self = this;\r\n\tbtn.addEventListener('click', function(){\r\n\t\tlet WOQL = TerminusClient.WOQL;\r\n\t\tself.clearSubMenus(this);\r\n\t\tvar query;\r\n\t\tswitch(this.value){\r\n\t\t\tcase 'Show All Schema Elements':\r\n\t\t\t\tquery = WOQL.query().elementMetadata();\r\n\t\t\tbreak;\r\n\t\t\tcase 'Show All Classes':\r\n\t\t\t\tquery = WOQL.query().classMetadata();\r\n\t\t\tbreak;\r\n\t\t\tcase 'Show Document Classes':\r\n\t\t\t\tquery = WOQL.query().documentMetadata();\r\n\t\t\tbreak;\r\n\t\t\tcase 'Show All Properties':\r\n\t\t\t\tquery = WOQL.query().propertyMetadata();\r\n\t\t\tbreak;\r\n\t\t\tcase 'Show All Data':\r\n\t\t\t\tquery = WOQL.query().getEverything();\r\n\t\t\tbreak;\r\n\t\t\tcase 'Show data of chosen type':\r\n\t\t\t\tvar choosen = 'scm:' + this.innerText;\r\n\t\t\t\tquery = WOQL.query().getDataOfClass(choosen);\r\n\t\t\tbreak;\r\n\t\t\tcase 'Show property of chosen type':\r\n\t\t\t\tvar choosen = 'scm:' + this.innerText;\r\n\t\t\t\tquery = WOQL.query().getDataOfProperty(choosen);\r\n\t\t\tbreak;\r\n\t\t\tcase 'Show data of type':\r\n\t\t\t\treturn;\r\n\t\t\tcase 'Show property of type':\r\n\t\t\t\treturn;\r\n\t\t\tdefault:\r\n\t\t\t\tconsole.log('Invalid Type of query');\r\n\t\t\tbreak;\r\n\t\t}\r\n\t\tself.getResults(query);\r\n\t})\r\n}\r\n\r\nQueryPane.prototype.getQueryMenu = function(qName){\r\n\tvar btn = document.createElement('button');\r\n\tbtn.setAttribute('class', 'terminus-load-queries');\r\n\tbtn.setAttribute('value', qName);\r\n\tbtn.appendChild(document.createTextNode(qName));\r\n\tthis.AddEvents(btn);\r\n\treturn btn;\r\n}\r\n\r\nQueryPane.prototype.getSubDataMenu = function(qName, val){\r\n\tvar btn = document.createElement('button');\r\n\tbtn.setAttribute('class', 'terminus-load-queries');\r\n\tbtn.setAttribute('value', qName);\r\n\tbtn.appendChild(document.createTextNode(val));\r\n\tthis.AddEvents(btn);\r\n\treturn btn;\r\n}\r\n\r\n// schema queries\r\nQueryPane.prototype.getSchemaSection = function(d){\r\n\tvar section = this.getSection('Schema Queries');\r\n\td.appendChild(section);\r\n\tvar btn = this.getQueryMenu('Show All Schema Elements');\r\n\td.appendChild(btn);\r\n\tvar btn = this.getQueryMenu('Show All Classes');\r\n\td.appendChild(btn);\r\n\tvar btn = this.getQueryMenu('Show Document Classes');\r\n\td.appendChild(btn);\r\n\tvar btn = this.getQueryMenu('Show All Properties');\r\n\td.appendChild(btn);\r\n}\r\n\r\nQueryPane.prototype.checkIfDataMenuOpen = function(btn){\r\n\tvar isOpen = false;\r\n\tif(btn.children.length){\r\n\t\tfor(var i=0; i<btn.children.length; i++){\r\n\t\t\t//var child = btn.children[i].getElementsByClassName('terminus-queries-submenu');\r\n\t\t\tvar child = btn.getElementsByClassName('terminus-queries-submenu');\r\n\t\t\tif(child.length){\r\n\t\t\t\tfor(var j=0; j<child.length; j++){\r\n\t\t\t\t\tTerminusClient.FrameHelper.removeElement(child[j]);\r\n\t\t\t\t\tisOpen = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn isOpen;\r\n}\r\n\r\nQueryPane.prototype.showDataOfTypeEvent = function(btn){\r\n\tvar self = this;\r\n\tbtn.addEventListener('click', function(){\r\n\t\tvar isMenuOpen = self.checkIfDataMenuOpen(this);\r\n\t\tif(!isMenuOpen){\r\n\t\t\tvar subPar = document.createElement('div');\r\n\t\t\tsubPar.setAttribute('class', 'terminus-queries-submenu');\r\n\t\t\tif(self.classMetaDataRes && self.classMetaDataRes.hasBindings()){\r\n\t\t\t\tfor(var i = 0; i<self.classMetaDataRes.bindings.length; i++){\r\n\t\t\t\t\tvar text = self.classMetaDataRes.bindings[i]['v:Label']['@value'];\r\n\t\t\t\t\tsubPar.appendChild(self.getSubDataMenu('Show data of chosen type', text));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tbtn.appendChild(subPar);\r\n\t\t}\r\n\t})\r\n}\r\n\r\nQueryPane.prototype.showPropertyOfTypeEvent = function(btn){\r\n\tvar self = this;\r\n\tbtn.addEventListener('click', function(){\r\n\t\tvar isMenuOpen = self.checkIfDataMenuOpen(this);\r\n\t\tif(!isMenuOpen){\r\n\t\t\tvar subPar = document.createElement('div');\r\n\t\t\tsubPar.setAttribute('class', 'terminus-queries-submenu');\r\n\t\t\tif(self.propertyMetaDataRes && self.propertyMetaDataRes.hasBindings()){\r\n\t\t\t\tfor(var i = 0; i<self.propertyMetaDataRes.bindings.length; i++){\r\n\t\t\t\t\tvar text = self.propertyMetaDataRes.bindings[i]['v:Label']['@value'];\r\n\t\t\t\t\tsubPar.appendChild(self.getSubDataMenu('Show property of chosen type', text));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tbtn.appendChild(subPar);\r\n\t\t}\r\n\t})\r\n}\r\n\r\nQueryPane.prototype.addCheveronIcon = function(btn){\r\n\tvar i = document.createElement('i');\r\n\ti.setAttribute('class', 'fa fa-chevron-right terminus-query-section');\r\n\tbtn.appendChild(i);\r\n}\r\n\r\n// data queries\r\nQueryPane.prototype.getDataSection = function(d){\r\n\tvar section = this.getSection('Data Queries');\r\n\td.appendChild(section);\r\n\t// div to populate submenu on data of type\r\n\tvar bd = document.createElement('div');\r\n\tbd.setAttribute('class', 'terminus-query-submenu');\r\n\td.appendChild(bd);\r\n\tvar btn = this.getQueryMenu('Show data of type');\r\n\tbd.appendChild(btn);\r\n\tthis.addCheveronIcon(btn);\r\n\tthis.showDataOfTypeEvent(btn);\r\n\t// div to populate submenu on property of type\r\n\tvar bd = document.createElement('div');\r\n\tbd.setAttribute('class', 'terminus-query-submenu');\r\n\td.appendChild(bd);\r\n\tvar btn = this.getQueryMenu('Show property of type');\r\n\tbd.appendChild(btn);\r\n\tthis.showPropertyOfTypeEvent(btn);\r\n\tthis.addCheveronIcon(btn);\r\n\tvar btn = this.getQueryMenu('Show All Data');\r\n\td.appendChild(btn);\r\n}\r\n\r\nQueryPane.prototype.fireDocumentEvent = function(document){\r\n\tlet WOQL = TerminusClient.WOQL;\r\n\tvar query = WOQL.query().documentProperties(document);\r\n\tthis.getResults(query);\r\n}\r\n\r\nQueryPane.prototype.getEnterDocumentIdDOM = function(){\r\n\tvar sp = document.createElement('span');\r\n\tsp.setAttribute('class', 'terminus-display-flex');\r\n\tvar inp = document.createElement('input');\r\n\tinp.setAttribute('class', 'terminus-doc-id-input');\r\n\tinp.setAttribute('placeholder', 'doc:myDocId');\r\n\tvar sub = document.createElement('button');\r\n\tsub.setAttribute('class', 'terminus-btn terminus-doc-id-input-submit');\r\n\tsub.appendChild(document.createTextNode('Submit'));\r\n\tvar self = this;\r\n\tsub.addEventListener('click', function(){\r\n\t\tself.fireDocumentEvent(inp.value);\r\n\t})\r\n\tsp.appendChild(inp);\r\n\tsp.appendChild(sub);\r\n\treturn sp;\r\n}\r\n\r\n// document queries\r\nQueryPane.prototype.getDocumentSection = function(d){\r\n\tvar section = this.getSection('Document Queries');\r\n\td.appendChild(section);\r\n\tvar btn = this.getQueryMenu('Show All Documents');\r\n\td.appendChild(btn);\r\n\td.appendChild(this.getEnterDocumentIdDOM());\r\n}\r\n\r\n// bottom color transaprent\r\nQueryPane.prototype.getQueryMenuBlock = function(){\r\n\tvar d = document.createElement('div');\r\n\td.setAttribute('class', 'terminus-load-queries');\r\n\tthis.getSchemaSection(d);\r\n\tthis.getDataSection(d);\r\n\tthis.getDocumentSection(d);\r\n\treturn d;\r\n}\r\n\r\nQueryPane.prototype.getSampleQueriesDOM = function(){\r\n\tvar i = document.createElement('icon');\r\n\ti.setAttribute('class', 'fa fa-ellipsis-v terminus-ellipsis-icon');\r\n\ti.setAttribute('title', 'Click to load sample Queries');\r\n\ti.setAttribute('value', false);\r\n\tthis.sampleQueryDOM = i;\r\n\tvar self = this;\r\n\ti.addEventListener('click', function(e){\r\n\t\tif(e.target !== this) return;\r\n\t\tif(this.children.length)\r\n\t\t\tTerminusClient.FrameHelper.removeChildren(this);\r\n\t\telse{\r\n\t\t\tvar d = self.getQueryMenuBlock();\r\n\t\t\tthis.appendChild(d);\r\n\t\t}\r\n\t})\r\n\treturn i;\r\n}\r\n\r\nQueryPane.prototype.getAsDOM = function(){\r\n\tif(this.intro){\r\n\t\tthis.container.appendChild(UTILS.getHeaderDom(this.intro));\r\n\t}\r\n\t//this.container.appendChild(document.createElement('BR'));\r\n\tif(this.showQuery) {\r\n\t\tvar configspan = document.createElement(\"span\");\r\n\t\tconfigspan.setAttribute(\"class\", \"pane-config-icons\");\r\n\t\tthis.container.appendChild(configspan);\r\n\t\tvar mode = (this.editQuery ? \"edit\" : \"view\");\r\n\t\tthis.input = this.createInput(mode);\r\n\t\tvar ipdom = this.input.getAsDOM(true);\r\n\t\tvar ispan = document.createElement(\"span\");\r\n\t\tispan.setAttribute(\"class\", \"query-pane-config\");\r\n\t\tvar ic = document.createElement(\"i\");\r\n\t\t//ic.setAttribute('style', 'margin:10px;')\r\n\t\tconfigspan.appendChild(ic);\r\n\t\tvar self = this;\r\n\t\tfunction showQueryConfig(){\r\n\t\t\tconfigspan.title=\"Click to Hide Query\";\r\n\t\t\tic.setAttribute(\"class\", \"fas fa fa-times-circle\");\r\n\t\t\tconfigspan.classList.remove('terminus-click-to-view-query');\r\n\t\t\tvar qicon = self.getSampleQueriesDOM();\r\n\t\t\tif(configspan.nextSibling){\r\n\t\t\t\tself.container.insertBefore(ipdom, configspan.nextSibling);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tself.container.appendChild(ipdom);\r\n\t\t\t\tipdom.appendChild(qicon);\r\n\t\t\t}\r\n\t\t\tself.input.stylizeSnippet();\r\n\t\t}\r\n\t\tfunction hideQueryConfig(){\r\n\t\t\tconfigspan.title=\"Click to View Query\";\r\n            ic.setAttribute(\"class\", \"fas fa fa-search terminus-query-view-icon\");\r\n\t\t\tconfigspan.classList.add('terminus-click-to-view-query');\r\n\t\t\tself.container.removeChild(ipdom);\r\n\t\t}\r\n\t\tconfigspan.addEventListener(\"click\", () => {\r\n\t\t\tif(this.showingQuery) hideQueryConfig();\r\n\t\t\telse showQueryConfig();\r\n\t\t\tthis.showingQuery = !this.showingQuery;\r\n\t\t});\r\n\t\tshowQueryConfig();\r\n\t\tif(this.showQuery == \"icon\") hideQueryConfig();\r\n    }\r\n\tthis.resultDOM = document.createElement(\"span\");\r\n\tthis.resultDOM.setAttribute(\"class\", \"terminus-query-results\");\r\n\tif(this.views.length == 0){\r\n\t\tthis.addView(TerminusClient.WOQL.table(), this.defaultResultView);\r\n\t}\r\n\t//this is where we want to put in the view headers in the case of the query page\r\n\tfor(var i = 0; i<this.views.length; i++){\r\n\t\tvar vdom = this.views[i].getAsDOM();\r\n\t\tif(vdom){\r\n\t\t\tif(this.showHeader){\r\n\t\t\t\tvar closable = (this.views.length != 1);\r\n\t\t\t\tvar qhdr = this.getResultPaneHeader(closable);\r\n\t\t\t\tvdom.prepend(qhdr);\r\n\t\t\t}\r\n\t\t\tthis.resultDOM.appendChild(vdom);\r\n\t\t}\r\n\t}\r\n\tthis.container.appendChild(this.resultDOM);\r\n\tif(this.addViews) this.container.appendChild(this.getAddViewControl());\r\n\treturn this.container;\r\n}\r\n\r\n\r\nQueryPane.prototype.getResultPaneHeader = function(closable){\r\n\tvar c = document.createElement('div');\r\n\tvar savePaneButton = document.createElement('button');\r\n\tsavePaneButton.setAttribute('class', 'terminus-btn terminus-query-btn');\r\n\tsavePaneButton.appendChild(document.createTextNode('Save'));\r\n\tc.appendChild(savePaneButton);\r\n\tif(closable){\r\n\t\tvar closePaneButton = document.createElement('button');\r\n\t\tclosePaneButton.setAttribute('class', 'terminus-btn terminus-query-btn');\r\n\t\tclosePaneButton.appendChild(document.createTextNode('Close'));\r\n\t\tc.appendChild(closePaneButton);\r\n\t}\r\n\tvar collapsePaneButton = document.createElement('button');\r\n\tcollapsePaneButton.setAttribute('class', 'terminus-btn terminus-query-btn');\r\n\tcollapsePaneButton.appendChild(document.createTextNode('Collapse'));\r\n\tc.appendChild(collapsePaneButton);\r\n\treturn c;\r\n}\r\n\r\nQueryPane.prototype.createInput = function(mode){\r\n    let input = new TerminusCodeSnippet(\"woql\", mode, null, 800);\r\n    if(this.query){\r\n    \tinput.setQuery(this.query);\r\n\t}\r\n\tvar self = this;\r\n\tinput.submit = function(qObj){\r\n\t\tself.submitQuery(qObj);\r\n\t};\r\n\treturn input;\r\n}\r\n\r\nQueryPane.prototype.updateQuery = function(qObj){\r\n\tthis.query = qObj;\r\n\tif(this.input) this.input.setQuery(this.query);\r\n}\r\n\r\nQueryPane.prototype.updateResult = function(result){\r\n\tthis.result = result;\r\n\tthis.updateQuery(result.query);\r\n\tthis.refreshViews();\r\n}\r\n\r\nQueryPane.prototype.addView = function(config, options){\r\n\tvar nrp = new ResultPane(this.client, this, config).options(options);\r\n\tif(this.result){\r\n\t\tnrp.setResult(this.result);\r\n\t}\r\n\tthis.views.push(nrp);\r\n\treturn nrp;\r\n}\r\n\r\nQueryPane.prototype.empty = function(){\r\n\treturn (typeof this.query == \"undefined\");\r\n}\r\n\r\nQueryPane.prototype.clearMessages = function(){}\r\nQueryPane.prototype.showError = function(){}\r\n\r\nQueryPane.prototype.submitQuery = function(qObj){\r\n\tthis.clearMessages();\r\n    this.query = qObj;\r\n    qObj.execute(this.client).then((results) => {\r\n\t\tvar r = new TerminusClient.WOQLResult(results, qObj);\r\n\t\tthis.result = r;\r\n\t\tthis.refreshViews();\r\n\t})\r\n}\r\n\r\nQueryPane.prototype.refreshViews = function(){\r\n\tfor(var i = 0; i<this.views.length; i++){\r\n\t\tthis.views[i].updateResult(this.result);\r\n\t}\r\n}\r\n\r\n\r\nQueryPane.prototype.getAddViewControl = function(){\r\n\tvar vd = document.createElement('div');\r\n\tvd.setAttribute('class', 'terminus-add-view-selector');\r\n\tvar self = this;\r\n\tvar WOQL = TerminusClient.WOQL;\r\n\tvar newView = function(val){\r\n\t\tself.selector.value = \"\";\r\n\t\tvar c= eval('WOQL.' + val + \"()\");\r\n\t\tvar nv = self.addView(c, self.defaultResultView);\r\n\t\tif(self.result){\r\n\t\t\tnv.setResult(self.result);\r\n\t\t}\r\n\t\tvar vdom = nv.getAsDOM();\r\n\t\tif(vdom){\r\n\t\t\tself.resultDOM.appendChild(vdom);\r\n\t\t}\r\n\t}\r\n\tvar opts = [\r\n\t\t{ value: \"\", label: \"Add another view of results\"},\r\n\t\t{ value: \"table\", label: \"Add Table View\"},\r\n\t\t{ value: \"stream\", label: \"Add Stream View\"},\r\n\t\t{ value: \"graph\", label: \"Add Graph View\"},\r\n\t\t{ value: \"chooser\", label: \"Add Drop-down View\"},\r\n\t\t{ value: \"map\", label: \"Add Map View\"}\r\n\t];\r\n\tvar sel = HTMLFrameHelper.getSelectionControl(\"view\", opts, false,newView);\r\n\tthis.selector = sel;\r\n\tvd.appendChild(sel);\r\n\treturn vd;\r\n}\r\n\r\n\r\n\r\n\r\n/*\r\ndescr: Show results editor on click of Add View\r\nparams: query object, query snippet\r\nQueryPane.prototype.showRuleEditor = function(woql, vd, qSnippet){\r\nvar cancel = document.createElement('icon');\r\n//cancel.appendChild(document.createTextNode('cancel'));\r\ncancel.setAttribute('class', 'fa fa-times terminus-pointer terminus-cancel-rule-editor');\r\nvd.appendChild(cancel);\r\nvar rSnippet = this.thv.getEditor(1350, 250, 'Enter Rules ...');\r\n//var rEditor = document.createElement('div');\r\nvd.setAttribute('class', 'terminus-rule-editor');\r\n//vd.setAttribute('style', 'border: 1px solid orange');\r\nthis.qpane.addRuleDom = rSnippet.actionButton;\r\nvd.appendChild(UTILS.getHeaderDom('Rule Editor:'));\r\nvd.appendChild(rSnippet.dom);\r\nqSnippet.dom.appendChild(vd);\r\nvar self = this;\r\ncancel.addEventListener('click', function(){\r\n    TerminusClient.FrameHelper.removeChildren(vd);\r\n    self.addView(woql, qSnippet);\r\n})\r\nthis.qpane.addRuleDom.addEventListener('click', function(){\r\n    try{\r\n        self.submitView(woql, qSnippet, rSnippet);\r\n        self.hideAddViewEditor(vd);\r\n    }\r\n    catch(e){\r\n        self.ui.showError('Error in rule editor: ' + e);\r\n    }\r\n})\r\nreturn rSnippet;\r\n}\r\n*/\r\n\r\n\r\n/*\r\n\r\nQueryPane.prototype.getWOQLEditor = function(){\r\n    var tcs = new TerminusCodeSnippet(\"woql\", \"edit\");\r\n\tvar snippet = tcs.getAsDOM();\r\n\tvar dimensions = {};\r\n\tdimensions.width = width;\r\n\tdimensions.height = height;\r\n\tUTILS.stylizeEditor(this.ui, snippet.snippetText, dimensions, 'javascript');\r\n\treturn snippet;\r\n}\r\n\r\nQueryPane.prototype.showConfigEditor = function(result, config, span){\r\n    var cSnippet = this.getEditor(300, 250,\r\n                        JSON.stringify(config, undefined, 2));\r\n    var self = this;\r\n    cSnippet.actionButton.addEventListener('click', function(){\r\n        try{\r\n            //self.submitConfigRules(woql, cSnippet, qSnippet, rSnippet);\r\n\t\t\tvar cObj = UTILS.getqObjFromInput(cSnippet.snippetText.value);\r\n\t\t\tTerminusClient.FrameHelper.removeChildren(span);\r\n\t\t\tspan.appendChild(self.showResult(result, cObj));\r\n        }\r\n        catch(e){\r\n            //self.ui.showError('Error in config editor: ' + e);\r\n\t\t\tconsole.log('Error in config editor: ' + e);\r\n        }\r\n    })\r\n    return cSnippet;\r\n}\r\n\r\nQueryPane.prototype.submitConfig = function(result, config, span, cdom){\r\n\tvar cSnippet = this.showConfigEditor(result, config, span);\r\n\tcdom.appendChild(cSnippet.dom);\r\n}\r\n\r\nQueryPane.prototype.showConfig = function(result, config, span, cdom){\r\n\tvar cbtn = document.createElement('button');\r\n    //cbtn.setAttribute('style', 'margin-top: 10px;');\r\n    cbtn.setAttribute('class', 'terminus-btn terminus-query-config-btn');\r\n    cbtn.appendChild(document.createTextNode('Config'));\r\n    //rSnippet.dom.appendChild(cbtn);\r\n    //qSnippet.dom.appendChild(cbtn);\r\n    var self = this;\r\n    cbtn.addEventListener('click', function(){\r\n\t\tTerminusClient.FrameHelper.removeChildren(cdom);\r\n        self.submitConfig(result, config, span, cdom);\r\n    })\r\n    return cbtn;\r\n}\r\n\r\n\r\n/*QueryPane.prototype.addResultViewerOLD = function(label, rule, ruleviewer){\r\n\tlet rv = new ResultViewer(rule);\r\n\tif(ruleviewer) rv.setRuleViewer(ruleviewer);\r\n\tthis.result_viewers[label] = rv;\r\n\treturn this;\r\n}\r\n\r\nQueryPane.prototype.addResultViewer = function(rule){\r\n\talert(\"rule \" + JSON.stringify(rule));\r\n\tthis.result_viewers.push(rule);\r\n\treturn this;\r\n}\r\n\r\n\r\n\r\nQueryPane.prototype.addLibrary = function(lib){\r\n\tthis.libraries.push(lib);\r\n\treturn this;\r\n}\r\n\r\nQueryPane.prototype.render = function(lib){\r\n\tvar qps = document.createElement(\"span\");\r\n\tfor(var i = 0; i<this.query_viewers.length; i++){\r\n\t\tvar qv = this.query_viewers[i];\r\n\t\tif(qv){\r\n\t\t\tlet v = qv.render();\r\n\t\t\tif(v) qps.appendChild(v);\r\n\t\t}\r\n\t}\r\n\r\n\tfor(var k in this.result_viewers){\r\n\t\tvar rv = this.result_viewers[k];\r\n\t\tif(rv){\r\n\t\t\tvar x = rv.render();\r\n\t\t\tif(x) qps.appendChild(x);\r\n\t\t}\r\n\t}\r\n\treturn qps;\r\n}\r\n\r\nfunction ResultViewer(rule){\r\n\tthis.rules = [];\r\n\tif(rule) this.rules.push(rule);\r\n}\r\n\r\nResultViewer.prototype.render = function(){\r\n\talert(\"rv\");\r\n\tvar span = document.createElement(\"span\");\r\n\tif(this.ruleviewer){\r\n\t\tlet r = this.ruleviewer.render();\r\n\t\tif(r) span.appendChild(r);\r\n\t}\r\n\treturn span;\r\n}\r\n\r\nResultViewer.prototype.setRuleViewer = function(rv){\r\n\tthis.ruleviewer = rv;\r\n}\r\n\r\n*/\r\n\r\nmodule.exports = QueryPane;\r\n","const TerminusClient = require('@terminusdb/terminus-client');\r\n\r\n\r\nfunction SimpleTable(){\r\n\tthis.holder = document.createElement(\"div\");\r\n}\r\n\r\nSimpleTable.prototype.options = function(options){\r\n\tfor(var k in options){\r\n\t\tthis[k] = options[k];\r\n\t}\r\n\treturn this;\r\n}\r\n\r\n\r\nSimpleTable.prototype.render = function(woqltable){\r\n\tif(woqltable) this.woqltable = woqltable;\r\n\tTerminusClient.FrameHelper.removeChildren(this.holder);\r\n\tvar ctls = this.getControlsDOM();\r\n\tvar tab = this.getTableDOM();\r\n\tif(ctls) this.holder.appendChild(ctls)\r\n\tthis.holder.appendChild(tab);\r\n\treturn this.holder;\r\n}\r\n\r\nSimpleTable.prototype.getControlsDOM = function(result){\r\n\tvar ctrls = document.createElement(\"span\");\r\n\tif(this.woqltable.config.pager()){\r\n\t\tvar paging = this.getPaging(result);\r\n\t\tif(paging) ctrls.appendChild(paging);\r\n\t}\r\n\treturn ctrls;\r\n}\r\n\r\nSimpleTable.prototype.getTableDOM = function(){\r\n\tconst columns = this.woqltable.getColumnsToRender();\r\n\tvar tab = document.createElement(\"table\");\r\n\ttab.setAttribute(\"class\", \"terminus-hover-table terminus-simple-table\");\r\n\tvar thead = this.getTableHeader(columns);\r\n\ttab.appendChild(thead);\r\n\tvar tbody = this.getTableBody(columns);\r\n\ttab.appendChild(tbody);\r\n\treturn tab;\r\n}\r\n\r\nSimpleTable.prototype.getTableHeader = function(cols){\r\n\tvar thead = document.createElement(\"thead\");\r\n\tvar thr = document.createElement(\"tr\");\r\n\tfor(var i = 0; i<cols.length; i++){\r\n\t\tvar th = this.getColumnHeader(cols[i]);\r\n\t\tthr.appendChild(th);\r\n\t}\r\n\tthead.appendChild(thr);\r\n\treturn thead;\r\n}\r\n\r\nSimpleTable.prototype.getColumnHeader = function(colid){\r\n\tvar th = document.createElement(\"th\");\r\n\tth.setAttribute('class', 'terminus-table-header-full-css');\r\n\tvar clab = this.woqltable.getColumnHeaderContents(colid);\r\n\tth.appendChild(clab);\r\n\treturn th;\r\n}\r\n\r\nSimpleTable.prototype.getTableBody = function(cols){\r\n\tvar tbody = document.createElement(\"tbody\");\r\n\twhile(row = this.woqltable.next()){\r\n\t\tvar tr = this.getHTMLRow(row, cols);\r\n\t\tif(tr) tbody.appendChild(tr);\r\n\t}\r\n\treturn tbody;\r\n}\r\n\r\nSimpleTable.prototype.getHTMLRow = function(row, cols){\r\n\tvar tr = document.createElement(\"tr\");\r\n\tfor(var i = 0; i<cols.length; i++){\r\n\t\tvar td = this.getCell(cols[i], row);\r\n\t\ttr.appendChild(td);\r\n\t}\r\n\tvar self = this;\r\n\tif(this.woqltable.hasRowClick(row)){\r\n\t\tvar rc = this.woqltable.getRowClick(row);\r\n\t\ttr.addEventListener(\"click\", function(){\r\n\t\t\trc(row);\r\n\t\t});\r\n\t\ttr.addEventListener(\"mouseover\", function(){\r\n\t\t\tthis.style.cursor = \"pointer\";\r\n\t\t});\r\n\t}\r\n\tif(this.woqltable.hasRowHover(row)){\r\n\t\tvar rc = this.woqltable.getRowHover(row);\r\n\t\ttr.addEventListener(\"mouseover\", function(){\r\n\t\t\trc(row);\r\n\t\t});\r\n\t}\r\n\treturn tr;\r\n}\r\n\r\nSimpleTable.prototype.getCell = function(key, row){\r\n\tvar td = document.createElement(\"td\");\r\n\tif(this.woqltable.hasCellClick(row, key)){\r\n\t\tvar rc = this.woqltable.getCellClick(row, key);\r\n\t\ttd.addEventListener(\"click\", function(){\r\n\t\t\trc(row);\r\n\t\t});\r\n\t\ttd.addEventListener(\"mouseover\", function(){\r\n\t\t\tthis.style.cursor = \"pointer\";\r\n\t\t});\r\n\t}\r\n\tif(this.woqltable.hasCellHover(row, key)){\r\n\t\tvar rc = this.woqltable.getCellHover(row, key);\r\n\t\ttr.addEventListener(\"mouseover\", function(){\r\n\t\t\trc(row);\r\n\t\t});\r\n\t}\r\n\tvar c = this.getCellData(key, row);\r\n\tif(c) td.appendChild(c);\r\n\treturn td;\r\n}\r\n\r\nSimpleTable.prototype.getCellData = function(key, row){\r\n\tvar renderer = this.woqltable.getRenderer(key, row);\r\n\tif(renderer && typeof renderer == \"function\"){\r\n\t\treturn renderer(row[key], key, row);\r\n\t}\r\n\telse if(renderer && typeof renderer == \"object\"){\r\n\t\treturn this.woqltable.renderValue(renderer, row[key], key, row);\r\n\t}\r\n\tvar val = row[key]\r\n\tif(val && val['@value']) val = val['@value'];\r\n\treturn document.createTextNode(val);\r\n}\r\n\r\nSimpleTable.prototype.getPaging = function(){\r\n\tif(this.woqltable.result.query.isPaged()){\r\n\t\tvar pdom = document.createElement(\"div\");\r\n\t\tpdom.setAttribute(\"class\", \"table-page-size\");\r\n\t\tif(this.woqltable.config.pagesize()) pdom.appendChild(this.getPageSize());\r\n\t\tif(this.woqltable.canChangePage()){\r\n\t\t\tvar pn = this.woqltable.result.query.getPage();\r\n\t\t\tif(pn > 2){\r\n\t\t\t\tpdom.appendChild(this.getFirst());\r\n\t\t\t}\r\n\t\t\tif(pn > 1){\r\n\t\t\t\tpdom.appendChild(this.getPrev(pn));\r\n\t\t\t}\r\n\t\t\tif(this.woqltable.config.page()) pdom.appendChild(this.getPageNumber(pn));\r\n\t\t\tpdom.appendChild(this.getNext(this.woqltable.result));\r\n\t\t}\r\n\t\treturn pdom;\r\n\t}\r\n}\r\n\r\nSimpleTable.prototype.getPageSize = function(){\r\n\tvar chunk = document.createElement(\"span\");\r\n\tchunk.setAttribute(\"class\", \"woql-table-pagesize\");\r\n\tclabel = document.createElement(\"span\");\r\n\tclabel.appendChild(document.createTextNode(\"Page Size\"));\r\n\tchunk.appendChild(clabel);\r\n\tif(this.woqltable.config.change_pagesize){\r\n\t\tvar ctl = document.createElement(\"input\");\r\n\t\tctl.setAttribute(\"size\", 6);\r\n\t\tvar self = this;\r\n\t\tctl.value = this.woqltable.getPageSize();\r\n\t\tctl.addEventListener(\"blur\", function(){\r\n\t\t\tvar pval = (this.value ? parseInt(this.value) : false);\r\n\t\t\tself.woqltable.setPageSize(pval);\r\n\t\t});\r\n\t\tchunk.appendChild(ctl);\r\n\t}\r\n\telse {\r\n\t\tchunk.appendChild(document.createTextNode(this.woqltable.getPageSize()));\r\n\t}\r\n\treturn chunk;\r\n}\r\n\r\nSimpleTable.prototype.getPageNumber = function(){\r\n\tvar ctl = document.createElement(\"input\");\r\n\tctl.setAttribute(\"size\", 4);\r\n\tctl.value = this.woqltable.result.query.getPage();\r\n\tvar self = this;\r\n\tctl.addEventListener(\"blur\", function(){\r\n\t\tvar pval = (this.value ? parseInt(this.value) : false);\r\n\t\tself.woqltable.setPage(pval);\r\n\t});\r\n\treturn ctl;\r\n}\r\n\r\nSimpleTable.prototype.getNext = function(result){\r\n\tvar ctl = document.createElement(\"button\");\r\n\tvar self = this;\r\n\tctl.appendChild(document.createTextNode(\"next\"));\r\n\tif(!this.woqltable.canAdvancePage(result)){\r\n\t\tctl.setAttribute(\"disabled\", \"disabled\");\r\n\t}\r\n\telse {\r\n\t\tctl.addEventListener(\"click\", function(){\r\n\t\t\tself.woqltable.nextPage();\r\n\t\t});\r\n\t}\r\n\treturn ctl;\r\n}\r\n\r\nSimpleTable.prototype.getPrev = function(result){\r\n\tvar ctl = document.createElement(\"button\");\r\n\tctl.appendChild(document.createTextNode(\"previous\"));\r\n\tvar self = this;\r\n\tif(!this.woqltable.canRetreatPage(result)){\r\n\t\tctl.setAttribute(\"disabled\", \"disabled\");\r\n\t}\r\n\telse {\r\n\t\tctl.addEventListener(\"click\", function(){\r\n\t\t\tself.woqltable.previousPage();\r\n\t\t});\r\n\t}\r\n\treturn ctl;\r\n}\r\n\r\nSimpleTable.prototype.getFirst = function(result){\r\n\tvar ctl = document.createElement(\"button\");\r\n\tctl.appendChild(document.createTextNode(\"first\"));\r\n\tvar self = this;\r\n\tif(!this.woqltable.canRetreatPage(result) || this.woqltable.getPage() <= 2){\r\n\t\tctl.setAttribute(\"disabled\", \"disabled\");\r\n\t}\r\n\telse {\r\n\t\tctl.addEventListener(\"click\", function(){\r\n\t\t\tself.woqltable.firstPage();\r\n\t\t});\r\n\t}\r\n\treturn ctl;\r\n}\r\n\r\nmodule.exports = SimpleTable;\r\n","const TerminusClient = require('@terminusdb/terminus-client');\r\nconst GraphResultsViewer = require('./GraphResultsViewer');\r\n\r\n\r\nfunction SimpleGraph(){\r\n\tthis.holder = document.createElement(\"div\");\r\n}\r\n\r\nSimpleGraph.prototype.setResult = function(result){\r\n\tthis.result = result;\r\n}\r\n\r\nSimpleGraph.prototype.render = function(wgraph){\r\n\tthis.graph = wgraph;\r\n\tTerminusClient.FrameHelper.removeChildren(this.holder);\r\n\t//var ctls = this.getControlsDOM(result);\r\n\tvar tab = this.getGraphDOM(this.result);\r\n\t//if(ctls) this.holder.appendChild(ctls)\r\n\tthis.holder.appendChild(tab);\r\n\treturn this.holder;\r\n}\r\n\r\n\r\nSimpleGraph.prototype.getGraphDOM = function(){\r\n\tthis.gviz = new GraphResultsViewer(this.graph.config);\r\n\tvar gdom = this.gviz.getAsDOM();\r\n\tvar h = this.graph.config.height() ? this.graph.config.height() : 800;\r\n\tvar w = this.graph.config.width() ? this.graph.config.width() : 800;\r\n\tgdom.setAttribute(\"style\", \"border: 1px solid #aaa; width: \" + w + \"px; height: \" + h + \"px; \" + this.graph.config.width() + \"px\");\r\n\tthis.gviz.setData(this.graph);\r\n\tthis.gviz.initDOM(gdom);\r\n\treturn gdom;\r\n}\r\n\r\nmodule.exports = SimpleGraph;\r\n","const TerminusClient = require('@terminusdb/terminus-client');\r\n\r\n\r\nfunction SimpleStream(){\t\r\n\tthis.holder = document.createElement(\"div\");\r\n}\r\n\r\nSimpleStream.prototype.options = function(options){\r\n\tfor(var k in options){\r\n\t\tthis[k] = options[k];\r\n\t}\r\n\treturn this;\r\n}\r\n\r\n\r\nSimpleStream.prototype.render = function(stream){\r\n\tif(stream) this.stream = stream;\r\n\tTerminusClient.FrameHelper.removeChildren(this.holder);\r\n\t//var ctls = this.getControlsDOM();\r\n\t//var tab = this.getTableDOM();\r\n\t//if(ctls) this.holder.appendChild(ctls)\r\n\t//this.holder.appendChild(tab);\r\n\treturn this.holder;\r\n}\r\n\r\nmodule.exports = SimpleStream;","function SimpleChooser(){}\r\n\r\nSimpleChooser.prototype.options = function(options){\r\n\tthis.options = options;\r\n\treturn this;\r\n}\r\n\r\nSimpleChooser.prototype.render = function(chooser){\r\n\tif(chooser) this.chooser = chooser;\r\n\tif(this.chooser.config.show_empty() == false && this.chooser.count() < 1) return false;\r\n\tvar ccdom = document.createElement(\"span\");\r\n\tccdom.setAttribute(\"class\", \"woql-chooser\");\r\n\tvar ccsel = document.createElement(\"select\");\r\n\tccsel.setAttribute(\"class\", \" woql-chooser\");\r\n\tvar self = this;\r\n\tccsel.addEventListener(\"change\", function(){\r\n\t\tself.chooser.set(this.value);\r\n\t});\r\n\tvar opts = [];\r\n\tif(this.chooser.config.show_empty()){\r\n\t\topts.push(this.getEmptyOption())\r\n\t}\r\n\twhile(choice = this.chooser.next()){\r\n\t\tvar opt = this.createOptionFromChoice(choice);\r\n\t\topts.push(opt);\r\n\t}\r\n\tfor(var i = 0; i<opts.length; i++){\r\n\t\tccsel.appendChild(opts[i]);\r\n\t}\r\n\tccdom.appendChild(ccsel);\r\n\treturn ccdom;\r\n}\r\n\r\nSimpleChooser.prototype.getEmptyOption = function(){\r\n\tvar choice = { id: \"\", label: this.chooser.config.show_empty()};\r\n\treturn this.createOptionFromChoice(choice);\r\n}\r\n\r\nSimpleChooser.prototype.createOptionFromChoice = function(choice){\r\n\tvar opt = document.createElement(\"option\");\r\n\topt.setAttribute(\"class\", \"terminus-woql-chooser-choice\");\r\n\topt.value = choice.id;\r\n\tif(choice.selected) opt.selected = true;\r\n\tif(typeof choice.label == \"string\"){\r\n\t\topt.appendChild(document.createTextNode(choice.label));\r\n\t}\r\n\telse if(choice.label){\r\n\t\topt.appendChild(choice.label);\r\n\t}\r\n\tif(choice.title){\r\n\t\topt.setAttribute(\"title\", choice.title);\r\n\t}\r\n\treturn opt;\r\n}\r\n\r\nmodule.exports = SimpleChooser;","const TerminusClient = require('@terminusdb/terminus-client');\r\nconst TerminusCodeSnippet = require('./query/TerminusCodeSnippet');\r\nconst UTILS = require('../Utils');\r\nconst HTMLFrameHelper = require('./HTMLFrameHelper');\r\nconst TerminusFrame = require(\"../viewer/TerminusFrame\");\r\nconst Datatypes = require(\"./Datatypes\");\r\nconst SimpleFrameViewer = require(\"./document/SimpleFrameViewer\");\r\n\r\n\r\nfunction DocumentPane(client){\r\n\tthis.client = client;\r\n\tthis.container = document.createElement('span');\r\n    this.container.setAttribute('class', 'terminus-document-cont');\r\n}\r\n\r\nDocumentPane.prototype.loadDocument = function(docid, config){\r\n\tthis.docid = docid;\r\n\tthis.clsid = false;\r\n\tthis.view = config;\r\n\tthis.frame = new TerminusFrame(this.client).options(this.view);\r\n\tthis.frame.owner = this;\r\n\tthis.frame.setDatatypes(Datatypes.initialiseDataRenderers);\r\n\treturn this.frame.loadDocument(docid);\r\n}\r\n\r\nDocumentPane.prototype.loadClass = function(cls, config){\r\n\tthis.clsid = cls;\r\n\tthis.docid = false;\r\n\tthis.view = config;\r\n\tthis.frame = new TerminusFrame(this.client).options(this.view);\r\n\tthis.frame.owner = this;\r\n\tthis.frame.setDatatypes(Datatypes.initialiseDataRenderers);\r\n\treturn this.frame.loadDocumentSchema(cls).then(() => this.frame.document.fillFromSchema(\"_:\"));\r\n}\r\n\r\n\r\n\r\nDocumentPane.prototype.setClassLoader = function(cloader){\r\n\tthis.classLoader = cloader;\r\n\tif(this.queryPane){\r\n\t\tthis.queryPane.appendChild(this.classLoader);\r\n\t}\r\n\treturn this;\r\n}\r\n\r\nDocumentPane.prototype.options = function(opts){\r\n\tthis.showQuery = (opts && typeof opts.showQuery != \"undefined\" ? opts.showQuery : true);\r\n\tthis.showConfig = (opts && typeof opts.showConfig != \"undefined\" ? opts.showConfig : true);\r\n\tthis.editConfig = (opts && typeof opts.editConfig != \"undefined\" ? opts.editConfig : true);\r\n\tthis.intro = (opts && typeof opts.intro != \"undefined\" ? opts.intro : false);\r\n\tthis.defaultResultView = { showConfig: \"true\", editConfig: \"true\" };\r\n\tthis.documentLoader = (opts && typeof opts.loadDocument != \"undefined\" ? opts.loadDocument : false);\r\n    return this;\r\n}\r\n\r\nDocumentPane.prototype.getQueryPane = function(){\r\n\tvar pane = document.createElement(\"div\");\r\n\tpane.setAttribute(\"class\", \"terminus-document-query\");\r\n\tif(this.documentLoader){\r\n\t\tpane.appendChild(this.documentLoader);\r\n\t}\r\n\tif(this.classLoader){\r\n\t\tpane.appendChild(this.classLoader);\r\n\t}\r\n\treturn pane;\r\n}\r\n\r\nDocumentPane.prototype.getAsDOM = function(){\r\n\tif(this.intro){\r\n\t\tthis.container.appendChild(UTILS.getHeaderDom(this.intro));\r\n\t}\r\n\tvar configspan = document.createElement(\"span\");\r\n\tconfigspan.setAttribute(\"class\", \"pane-config-icons\");\r\n\tthis.container.appendChild(configspan);\r\n\tif(this.showQuery && (this.documentLoader || this.classLoader)){\r\n\t\tvar ipdom = this.getQueryPane();\r\n\t\tvar ispan = document.createElement(\"span\");\r\n\t\tispan.setAttribute(\"class\", \"document-pane-config\");\r\n\t\tvar ic = document.createElement(\"i\");\r\n\t\tispan.appendChild(ic);\r\n\t\tconfigspan.appendChild(ispan);\r\n\t\tvar self = this;\r\n\t\tfunction showQueryConfig(){\r\n\t\t\tispan.title=\"Click to Hide Query\";\r\n\t\t\tic.setAttribute(\"class\", \"fas fa fa-times-circle\");\r\n\t\t\tif(configspan.nextSibling) self.container.insertBefore(ipdom, configspan.nextSibling);\r\n\t\t\telse self.container.appendChild(ipdom);\r\n\t\t}\r\n\t\tfunction hideQueryConfig(){\r\n\t\t\tispan.title=\"Click to View Query\";\r\n            ic.setAttribute(\"class\", \"fas fa fa-search\");\r\n\t\t\tself.container.removeChild(ipdom);\r\n\t\t}\r\n\t\tispan.addEventListener(\"click\", () => {\r\n\t\t\tif(this.showingQuery) hideQueryConfig();\r\n\t\t\telse showQueryConfig();\r\n\t\t\tthis.showingQuery = !this.showingQuery;\r\n\t\t});\r\n\t\tshowQueryConfig();\r\n\t\tif(this.showQuery == \"icon\") hideQueryConfig();\r\n\t\tthis.queryPane = ipdom;\r\n\t}\r\n\tif(this.showConfig){\r\n        this.showingConfig = (this.showConfig != \"icon\");\r\n\t\tvar mode = (this.editConfig ? \"edit\" : \"view\");\r\n\t\tthis.input = this.createInput(mode);\r\n\t\tvar ndom = this.input.getAsDOM();\r\n        var nspan = document.createElement(\"span\");\r\n        nspan.addEventListener('mouseover', function(){\r\n            this.style.cursor = \"pointer\";\r\n\t\t});\r\n\t\tnspan.setAttribute(\"class\", \"result-pane-config\");\r\n\t\tvar nc = document.createElement(\"i\");\r\n\t\tnspan.appendChild(nc);\r\n\t\tconfigspan.appendChild(nspan);\r\n\t\tvar self = this;\r\n\t\tfunction showDocConfig(){\r\n\t\t\tnspan.title=\"Click to Hide View Configuration\";\r\n\t\t\tnc.setAttribute(\"class\", \"fas fa fa-times-circle\");\r\n\t\t\tif(configspan.nextSibling) self.container.insertBefore(ndom, configspan.nextSibling);\r\n\t\t\telse self.container.appendChild(ndom);\r\n\t\t\t//stylize only after ta or pre have been appended\r\n\t\t\tif((self.input.snippet.value) || (self.input.snippet.innerHTML))\r\n\t\t\t\tself.input.stylizeSnippet();\r\n\t\t}\r\n\t\tfunction hideDocConfig(){\r\n\t\t\tnspan.title=\"Click to View Configuration\";\r\n            nc.setAttribute(\"class\", \"fas fa fa-vial\");\r\n\t\t\tself.container.removeChild(ndom);\r\n\t\t}\r\n\t\tnspan.addEventListener(\"click\", () => {\r\n\t\t\tif(this.showingConfig) hideDocConfig();\r\n\t\t\telse showDocConfig();\r\n\t\t\tthis.showingConfig = !this.showingConfig;\r\n        });\r\n        showDocConfig();\r\n\t\tif(this.showConfig == \"icon\") hideDocConfig();\r\n    }\r\n\tthis.resultDOM = document.createElement(\"span\");\r\n\tthis.resultDOM.setAttribute(\"class\", \"terminus-document-results\");\r\n\t//var form = (this.input.format == \"js\" ? \"javascript\" : \"json\");\r\n\t//UTILS.stylizeEditor(ui, this.input.snippet, {width: this.input.width, height: this.input.height}, form);\r\n\tthis.container.appendChild(this.resultDOM);\r\n\tthis.renderResult();\r\n\treturn this.container;\r\n}\r\n\r\nDocumentPane.prototype.renderResult = function(){\r\n\tTerminusClient.FrameHelper.removeChildren(this.resultDOM);\r\n\tif(this.frame && this.frame.render){\r\n\t\tvar fpt = this.frame.render();\r\n\t\tif(fpt){\r\n\t\t\tthis.resultDOM.appendChild(fpt);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nDocumentPane.prototype.loadRenderer = function(rendname, frame, args, termframe){\r\n\tvar evalstr = \"new \" + rendname + \"(\";\r\n\tif(args) evalstr += JSON.stringify(args);\r\n\tevalstr += \");\";\r\n\ttry {\r\n\t\tvar nr = eval(evalstr);\r\n\t\tnr.terminus = termframe;\r\n\t\treturn nr;\r\n\t}\r\n\tcatch(e){\r\n\t\tconsole.log(\"Failed to load \" + rendname + e.toString());\r\n\t\treturn false;\r\n\t}\r\n}\r\n\r\n\r\nDocumentPane.prototype.createInput = function(mode){\r\n    let input = new TerminusCodeSnippet(\"rule\", mode);\r\n    if(this.view){\r\n    \tinput.setQuery(this.view);\r\n\t}\r\n\tvar self = this;\r\n\tinput.submit = function(qObj){\r\n\t\tself.updateView(qObj);\r\n\t};\r\n\treturn input;\r\n}\r\n\r\nDocumentPane.prototype.updateView = function(docview){\r\n\tthis.view = docview;\r\n\tthis.frame.options(this.view);\r\n\tif(this.input) this.input.setQuery(this.view);\r\n\tthis.frame.applyRulesToDocument(this.frame.document, this.frame.config);\r\n\tthis.frame.renderer = this.frame.document;\r\n\tthis.renderResult();\r\n}\r\n\r\nDocumentPane.prototype.updateResult = function(result){\r\n\tthis.result = result;\r\n\tthis.updateQuery(result.query);\r\n\tthis.refreshViews();\r\n}\r\n\r\nDocumentPane.prototype.empty = function(){\r\n\treturn (typeof this.view == \"undefined\");\r\n}\r\n\r\nDocumentPane.prototype.clearMessages = function(){}\r\nDocumentPane.prototype.showError = function(){}\r\n\r\nDocumentPane.prototype.submitQuery = function(qObj){\r\n\tthis.clearMessages();\r\n\ttdv.owner = this;\r\n\ttdv.setDatatypes(Datatypes.initialiseDataRenderers);\r\n\ttdv.loadDocument(id).then(() => {\r\n\t\tlet dom = tdv.render();\r\n\t\tif(dom) holder.appendChild(dom);\r\n\t});\r\n\treturn holder;\r\n    this.query = qObj;\r\n    qObj.execute(this.client).then((results) => {\r\n\t\tvar r = new TerminusClient.WOQLResult(results, qObj);\r\n\t\tthis.result = r;\r\n\t\tthis.refreshViews();\r\n\t})\r\n}\r\n\r\nmodule.exports = DocumentPane;\r\n","const HTMLFrameHelper = require(\"../HTMLFrameHelper\");\r\n\r\nfunction SimpleFrameViewer(){\r\n}\r\n\r\nSimpleFrameViewer.prototype.getScope = function(frame){\r\n\tif(frame.isProperty()) return \"property\";\r\n\tif(frame.isObject()) return \"object\";\r\n\tif(frame.isData()) return \"data\";\r\n}\r\n\r\nSimpleFrameViewer.prototype.getDatatypeViewer = function(frame, mode){\r\n\tvar dv = frame.display_options.dataviewer;\r\n\tif(!dv){\r\n\t\tif(frame.isChoice()) var t = \"oneOf\";\r\n\t\telse if(frame.isDocument()) var t = \"document\";\r\n\t\telse t = frame.getType();\r\n\t\tif(mode && mode == \"edit\"){\r\n\t\t\tvar r = this.terminus.datatypes.getEditor(t);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tvar r = this.terminus.datatypes.getRenderer(t);\r\n\t\t}\r\n\t\tdv = r.name;\r\n\t}\r\n\tif(frame.display_options.args){\r\n\t\tvar args = frame.display_options.args ;\r\n\t}\r\n\telse {\r\n\t\tif(r && r.args) args = r.args;\r\n\t\telse args = false;\r\n\t}\r\n\treturn this.terminus.datatypes.createRenderer(dv, args);\r\n}\r\n\r\nSimpleFrameViewer.prototype.render = function(frame){\r\n\tvar scope = this.getScope(frame);\r\n\tif(frame.display_options.header_features){\r\n\t\tvar hfeatures = this.getFeaturesDOM(frame.display_options.header_features, frame.display_options.feature_renderers, scope, frame, frame.display_options.mode)\r\n\t}\r\n\telse var hfeatures = false;\r\n\tif(frame.display_options.features){\r\n\t\tvar features = this.getFeaturesDOM(frame.display_options.features, frame.display_options.feature_renderers, scope, frame, frame.display_options.mode);\r\n\t}\r\n\telse var features = false;\r\n\tvar orient = (scope == \"object\" || scope == \"property\") ? \"page\" : \"line\";\r\n\tvar ndom = HTMLFrameHelper.getFrameDOM(scope, frame, orient, hfeatures, features);\r\n\tif(!ndom) return false;\r\n\tif(this.framedom){\r\n\t\tthis.framedom.replaceWith(ndom);\r\n\t}\r\n\tthis.framedom = ndom;\r\n\treturn this.framedom;\r\n}\t\r\n\r\nSimpleFrameViewer.prototype.getFeaturesDOM = function(flist, renderers, scope, frame, mode){\r\n\tvar features = document.createElement(\"span\");\r\n\tfeatures.setAttribute(\"class\", featuresToCSS(flist));\r\n\tfor(var i = 0; i<flist.length; i++){\r\n\t\tif(typeof flist[i] == \"object\"){\r\n\t\t\tfeatures.appendChild(this.getFeaturesDOM(flist[i], renderers, scope, frame));\r\n\t\t}\r\n\t\telse {\r\n\t\t\tif(renderers && renderers[flist[i]]){\r\n\t\t\t\tvar dom = renderers[flist[i]](frame, flist[i]);\r\n\t\t\t\tif(dom)\tfeatures.appendChild(dom);\r\n\t\t\t}\t\t\t\t\r\n\t\t\telse {\r\n\t\t\t\tif(flist[i] == \"value\" && scope == \"data\"){\r\n\t\t\t\t\tvar dv = this.getDatatypeViewer(frame, mode);\r\n\t\t\t\t\tif(dv) {\r\n\t\t\t\t\t\tvar dom = dv.renderFrame(frame, this);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tvar dom = document.createTextNode(frame.get());\t\t\t\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(dom)\tfeatures.appendChild(dom);\r\n\t\t\t\t}\r\n\t\t\t\telse if(flist[i] == \"value\"){\r\n\t\t\t\t\tif(scope == 'object'){\r\n\t\t\t\t\t\tvar vals = frame.renderProperties();\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tvar vals = frame.renderValues();\t\t    \r\n\t\t\t\t\t}\r\n\t\t\t\t    for(var j = 0; j<vals.length; j++){\r\n\t\t\t\t\t\tfeatures.appendChild(vals[j]);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tvar dom = HTMLFrameHelper.getFeatureDOM(flist[i], scope, frame);\r\n\t\t\t\t\tif(dom)\tfeatures.appendChild(dom);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn features;\r\n}\r\n\r\nfunction featuresToCSS(flist){\r\n\tvar s = \"\";\r\n\tfor(var i = 0; i<flist.length; i++){\r\n\t\tif(typeof flist[i] == \"object\"){\r\n\t\t\ts += featuresToCSS(flist[i]) + \"-\";\r\n\t\t}\r\n\t\telse {\r\n\t\t\ts += flist[i] + \"-\";\r\n\t\t}\r\n\t}\r\n\treturn s.substring(0, s.length-1);\r\n}\r\n\r\n\r\n\r\nmodule.exports = SimpleFrameViewer;","const TerminusUI = require('./TerminusUI');\r\nconst RenderingMap = require('./client/RenderingMap');\r\nmodule.exports={TerminusUI:TerminusUI,\r\n                RenderingMap:RenderingMap}\r\n","/**\r\n * Terminus UI object\r\n *\r\n * Traffic control of messages going between different Terminus UI pages and features\r\n *\r\n * @param opts - options array\r\n */\r\nconst ApiExplorer = require('./ApiExplorer');\r\nconst TerminusDocumentViewer = require('./TerminusDocument');\r\nconst TerminusDBsdk = require('./TerminusDB');\r\nconst TerminusViolations = require('./html/TerminusViolation');\r\nconst TerminusQueryViewer = require('./TerminusQuery');\r\nconst TerminusSchemaViewer = require('./TerminusSchema');\r\nconst TerminusServersdk = require('./TerminusServer');\r\nconst TerminusURLLoader = require('./TerminusURL');\r\nconst TerminusPluginManager = require('./plugins/TerminusPlugin');\r\nconst UTILS = require('./Utils');\r\nconst RenderingMap = require('./client/RenderingMap');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction TerminusUI(opts){\r\n\tthis.client = new TerminusClient.WOQLClient();\r\n\tthis.controls = [];\r\n\tthis.setOptions(opts);\r\n}\r\n\r\n/*\r\n * Client connects to specified server and specified part\r\n * opts is a json with the following fields:\r\n * server: mandatory URL of the server to connect to\r\n * key: optional client API key\r\n * dbid: id of the database to connect to\r\n * schema: if set, the UI will load the schema page after connecting\r\n * query: if set, the query will be sent to the server and the results will be loaded on the query page\r\n * document: if set, the document page corresponding to this document will be loaded after connecting\r\n *\r\n * (note: schema, query, document are mutually exclusive and must also have a dbid set)\r\n */\r\nTerminusUI.prototype.connect = function(opts){\r\n\tvar self = this;\r\n\tthis.client.connectionConfig.server = false;\r\n\tvar key = ((opts && opts.key) ? opts.key : false);\r\n\tthis.showBusy(\"Connecting to server at \" + opts.server);\r\n\treturn this.client.connect(opts.server, key)\r\n\t.then( function(response) {\r\n\t\tself.clearBusy();\r\n\t\tif(opts && opts.db && self.getDBRecord(opts.db)){\r\n\t\t\tself.connectToDB(opts.db);\r\n\t\t\tif(opts.document && self.showView(\"get_document\")){\r\n\t\t\t\tresponse = self.showDocument(opts.document);\r\n\t\t\t}\r\n\t\t\telse if(opts.schema && self.showView(\"get_schema\")){\r\n\t\t\t\tresponse = self.showSchemaPage(opts.schema);\r\n\t\t\t}\r\n\t\t\telse if(opts.query && self.showView(\"woql_select\")){\r\n\t\t\t\tself.showQueryPage(opts.query);\r\n\t\t\t}\r\n\t\t\telse if(opts.explorer && self.showView(\"api_explorer\")){\r\n\t\t\t\tself.showExplorer(opts.explorer);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tself.showDBMainPage();\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tself.showServerMainPage();\r\n\t\t}\r\n\t\tself.redraw();\r\n\t\treturn response;\r\n\t})\r\n\t.catch(function(err) {\r\n\t\tself.clearBusy();\r\n\t\tself.showError(err);\r\n\t\tthrow(err);\r\n\t});\r\n}\r\n\r\n/**\r\n * Sends a request to create a new database to the server and interprets the response\r\n *\r\n * dbdets is a json object with the following fields:\r\n * id: the id of the new database (alphanumeric, no spaces, url friendly) mandatory\r\n * title: the text name of the new database for tables, etc. mandatory\r\n * description: text description of the database (optional)\r\n * key: a API client key for server auth\r\n * schema: the url of another Terminus DB from which to import schema\r\n * instance: the url of another Terminus DB from which to import data\r\n *\r\n */\r\nTerminusUI.prototype.createDatabase = function(dbdets){\r\n\tvar self = this;\r\n\tif(!dbdets.id || !dbdets.title){\r\n        return Promise.reject(new Error(self.getBadArguments(\"createDatabase\", \"ID and title are mandatory fields\")));\r\n\t}\r\n\tvar dbid = dbdets.id;\r\n\tvar myserver = this.client.connectionConfig.server;\r\n\tself.showBusy(\"Creating Database \" + dbdets.title + \" with id \" + dbid);\r\n\tvar dbdoc = this.generateNewDatabaseDocument(dbdets);\r\n\treturn this.client.createDatabase(dbid, dbdoc)\r\n\t.then(function(response){ //import schema into newly created DB\r\n\t\tif(dbdets.schema){\r\n\t\t\tself.showBusy(\"Fetching imported schema from \" + dbdets.schema);\r\n\t\t\tvar opts = (dbdets.key ?  {\"terminus:user_key\": dbdets.key } : {});\r\n\t\t\topts['terminus:encoding'] = \"terminus:turtle\";\r\n\t\t\treturn self.client.getSchema(dbdets.schema, opts)\r\n\t\t\t.then(function(response){\r\n\t\t\t\tself.showBusy(\"Updating database with new schema\");\r\n\t\t\t\tself.client.connectionConfig.server = myserver;\r\n\t\t\t\tself.client.connectionConfig.dbid = dbid;\r\n\t\t\t\tvar nopts = {'terminus:encoding':  \"terminus:turtle\"};\r\n\t\t\t\treturn self.client.updateSchema(false, response, nopts);\r\n\t\t\t})\r\n\t\t\t.then(function(response){\r\n\t\t\t\tself.clearBusy();\r\n\t\t\t\tself.redraw();\r\n\t\t\t\treturn response;\r\n\t\t\t});\r\n\t\t}\r\n\t\telse {\r\n\t\t\tself.clearBusy();\r\n\t\t}\r\n\t\treturn response;\r\n\t})\r\n\t.then(function(response){ //reload list of databases in background..\r\n\t\treturn self.refreshDBList()\r\n\t\t.then(function(response){\r\n\t\t\tif(crec = self.client.connection.getDBRecord(dbid)){\r\n\t\t\t\tself.client.connectionConfig.dbid = dbid;\r\n\t\t\t\tself.showDBMainPage();\r\n\t\t\t\tself.showMessage(\"Successfully Created Database \" + dbid, \"success\");\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t        return Promise.reject(new Error(self.getCrashString(\"createDatabase\", \"Failed to retrieve record of created database \" + dbid)));\r\n\t\t\t}\r\n\t\t})\r\n\t})\r\n\t.catch(function(error){\r\n\t\tself.clearBusy();\r\n\t\tself.showError(error);\r\n\t});\r\n}\r\n\r\n/**\r\n * Deletes the database with the passed id from the currently connected server\r\n */\r\nTerminusUI.prototype.deleteDatabase = function(dbid){\r\n\tvar self = this;\r\n\tvar delrec = this.client.connection.getDBRecord();\r\n\tvar lid = (dbid ? dbid : this.db());\r\n\tvar dbn = (delrec && delrec['rdfs:label'] && delrec['rdfs:label'][\"@value\"] ? delrec['rdfs:label'][\"@value\"] + \" (id: \" + lid + \")\" : lid);\r\n\tthis.showBusy(\"Deleting database \" + dbn);\r\n\treturn this.client.deleteDatabase(dbid)\r\n\t.then(function(response){\r\n\t\tself.clearBusy();\r\n\t\tself.client.connectionConfig.dbid = false;\r\n\t\tself.removeDB(dbid);\r\n\t\tself.showServerMainPage();\r\n\t\tself.showMessage(\"Successfully Deleted Database \" + dbn, \"success\");\r\n\t\tself.refreshDBList();\r\n\t\treturn response;\r\n\t})\r\n\t.catch(function(error){\r\n\t\tself.clearBusy();\r\n\t\tself.showError(error);\r\n\t});\r\n}\r\n\r\n/*\r\n * Transforms a details (id, title, description) array into  json-ld document\r\n */\r\nTerminusUI.prototype.generateNewDatabaseDocument = function(dets){\r\n\tvar doc = {\r\n\t\t\"@context\" : {\r\n\t\t\trdfs: \"http://www.w3.org/2000/01/rdf-schema#\",\r\n\t\t\tterminus: \"http://terminusdb.com/schema/terminus#\"\r\n\t\t},\r\n\t\t\"@type\": \"terminus:Database\"\r\n\t}\r\n\tif(dets.title){\r\n\t\tdoc['rdfs:label'] = {\r\n\t\t\t\"@language\":  \"en\",\r\n\t\t\t\"@value\": dets.title\r\n\t\t};\r\n\t}\r\n\tif(dets.description){\r\n\t\tdoc['rdfs:comment'] = {\r\n\t\t\t\"@language\":  \"en\",\r\n\t\t\t\"@value\": dets.description\r\n\t\t};\r\n\t}\r\n\tdoc['terminus:allow_origin'] = { \"@type\" : \"xsd:string\", \"@value\" : \"*\" };\r\n\treturn doc;\r\n}\r\n\r\nTerminusUI.prototype.getBadArguments = function(fname, str){\r\n\treturn \"Bad arguments to \" + fname + \": \" + str;\r\n}\r\n\r\nTerminusUI.prototype.getCrashString = function(fname, str){\r\n\treturn \"Results from \" + fname + \" indicate the possibility of a system failure \" + str;\r\n}\r\n\r\n/*\r\n * Parses the passed URL and turns it into a call to the connect function - loads the appropriate endpoing\r\n */\r\nTerminusUI.prototype.load = function(url, key){\r\n\tvar args = {};\r\n\tif(url && url.indexOf(\"/document/\") != -1){\r\n\t\turl = url.substring(0, url.indexOf(\"/document/\"));\r\n\t\targs.document = url.substring(url.indexOf(\"/document/\")+10);\r\n\t}\r\n\telse if(url && url.indexOf(\"/schema\") != -1){\r\n\t\turl = url.substring(0, url.indexOf(\"/schema\"));\r\n\t\targs.schema = {};\r\n\t}\r\n\telse if(url && url.indexOf(\"/woql\") != -1){\r\n\t\turl = url.substring(0, url.indexOf(\"/query\"));\r\n\t\targs.query = url.substring(url.indexOf(\"/query\")+7);\r\n\t}\r\n\targs.server = url;\r\n\tif(key) args.key = key;\r\n\treturn this.connect(args);\r\n}\r\n\r\n/**\r\n * Fetches the DB URL from the url by chopping off the extra bits\r\n */\r\nTerminusUI.prototype.getConnectionEndpoint = function(url){\r\n\tif(url && url.lastIndexOf(\"/schema\") != -1){\r\n\t\treturn url.substring(0, url.lastIndexOf(\"/schema\"));\r\n\t}\r\n\tif(url && url.lastIndexOf(\"/document\") != -1){\r\n\t\treturn url.substring(0, url.lastIndexOf(\"/document\"));\r\n\t}\r\n\tif(url && url.lastIndexOf(\"/frame\") != -1){\r\n\t\treturn url.substring(0, url.lastIndexOf(\"/frame\"));\r\n\t}\r\n\tif(url && url.lastIndexOf(\"/woql\") != -1){\r\n\t\treturn url.substring(0, url.lastIndexOf(\"/woql\"));\r\n\t}\r\n\treturn url;\r\n}\r\n\r\nTerminusUI.prototype.server = function(){\r\n\treturn this.client.connectionConfig.server;\r\n}\r\n\r\nTerminusUI.prototype.db = function(){\r\n\treturn this.client.connectionConfig.dbid;\r\n}\r\n\r\nTerminusUI.prototype.clearServer = function(){\r\n\tthis.client.connectionConfig.server = false;\r\n}\r\n\r\nTerminusUI.prototype.connectToDB = function(dbid){\r\n\tthis.client.connectionConfig.dbid = dbid;\r\n\tTerminusClient.FrameHelper.standard_urls['doc'] = this.client.connectionConfig.dbURL() + \"/document/\";\r\n\tTerminusClient.FrameHelper.standard_urls['scm'] = this.client.connectionConfig.dbURL() + \"/schema#\";\r\n}\r\n\r\nTerminusUI.prototype.clearDB = function(){\r\n\tthis.client.connectionConfig.dbid = false;\r\n}\r\n\r\nTerminusUI.prototype.removeDB = function(db, url){\r\n\tthis.client.connection.removeDB(db, url);\r\n}\r\n\r\nTerminusUI.prototype.getDBRecord = function(db, url){\r\n\treturn this.client.connection.getDBRecord(db, url);\r\n}\r\n\r\nTerminusUI.prototype.refreshDBList = function(){\r\n\tvar self = this;\r\n\treturn this.client.connect();\r\n}\r\n\r\nTerminusUI.prototype.showServerMainPage = function(){\r\n\tthis.viewer = new TerminusServersdk.TerminusServerViewer(this);\r\n\tthis.redrawMainPage();\r\n}\r\n\r\nTerminusUI.prototype.showCollaboratePage = function(){\r\n\tthis.viewer = new TerminusURLLoader(this);\r\n\tthis.redrawMainPage();\r\n}\r\n\r\n\r\nTerminusUI.prototype.showLoadURLPage = function(val){\r\n\tthis.viewer = new TerminusURLLoader(this, val);\r\n\tthis.redrawMainPage();\r\n}\r\n\r\nTerminusUI.prototype.showDBMainPage = function(){\r\n\tthis.viewer = new TerminusDBsdk.TerminusDBViewer(this);\r\n\tthis.viewer.page = \"db\";\r\n\tthis.redraw();\r\n}\r\n\r\nTerminusUI.prototype.showCreateDBPage = function(){\r\n\tthis.viewer = new TerminusDBsdk.TerminusDBCreator(this);\r\n\tthis.redrawMainPage();\r\n}\r\n\r\nTerminusUI.prototype.showSchemaPage = function(durl){\r\n\tthis.viewer = new TerminusSchemaViewer(this);\r\n\tthis.redrawMainPage();\r\n}\r\n\r\nTerminusUI.prototype.showQueryPage = function(query){\r\n\tthis.viewer = new TerminusQueryViewer(this, query, this.options);\r\n\tthis.redrawMainPage();\r\n}\r\n\r\nTerminusUI.prototype.showDocumentPage = function(){\r\n\tthis.viewer = new TerminusDBsdk.TerminusDBViewer(this);\r\n\tthis.viewer.page = \"docs\";\r\n\tthis.redraw();\r\n}\r\n\r\nTerminusUI.prototype.showDocument = function(durl){\r\n\tthis.viewer = new TerminusDocumentViewer(this, \"view\", this.getDocViewerOptions());\r\n\tconst promise = this.viewer.loadDocument(durl);\r\n\tthis.redrawMainPage();\r\n\treturn promise;\r\n}\r\n\r\nTerminusUI.prototype.showCreateDocument = function(durl){\r\n\tthis.viewer = new TerminusDocumentViewer(this, \"create\", this.getDocCreatorOptions());\r\n\tconst promise = this.viewer.loadCreateDocument(durl);\r\n\tthis.redrawMainPage();\r\n\treturn promise;\r\n}\r\n\r\nTerminusUI.prototype.redrawMainPage = function(){\r\n\tTerminusClient.FrameHelper.removeChildren(this.mainDOM);\r\n\tif(this.viewer && this.mainDOM){\r\n\t\tvar x = this.viewer.getAsDOM();\r\n\t\tthis.mainDOM.appendChild(x);\r\n\t}\r\n}\r\n\r\nTerminusUI.prototype.showResult = function(response){\r\n\tthis.showMessage(response, \"success\");\r\n};\r\n\r\nTerminusUI.prototype.showError = function(response){\r\n\tthis.showMessage(response, \"error\");\r\n};\r\n\r\nTerminusUI.prototype.clearMessages = function(response){\r\n\tif(this.messages) TerminusClient.FrameHelper.removeChildren(this.messages);\r\n};\r\n\r\nTerminusUI.prototype.clearMainPage = function(){\r\n\tif(this.main) TerminusClient.FrameHelper.removeChildren(this.main);\r\n}\r\n\r\nTerminusUI.prototype.setMessageDOM = function(dom){\r\n\tthis.messages = dom;\r\n}\r\n\r\nTerminusUI.prototype.setbuttonControls = function(dom){\r\n\tthis.buttons = dom;\r\n}\r\n\r\nTerminusUI.prototype.setControllerDOM = function(dom){\r\n\tthis.controller = dom;\r\n}\r\n\r\nTerminusUI.prototype.setExplorerDOM = function(dom){\r\n\tthis.explorer = dom;\r\n}\r\n\r\nTerminusUI.prototype.setPluginsDOM = function(dom){\r\n\tthis.plugins = dom;\r\n}\r\n\r\nTerminusUI.prototype.setViewerDOM = function(dom){\r\n\tthis.mainDOM = dom;\r\n}\r\n\r\nTerminusUI.prototype.draw = function(comps, slocation){\r\n\tif(comps && comps.viewer) this.setViewerDOM(comps.viewer);\r\n\tif(comps && comps.buttons) this.setbuttonControls(comps.buttons);\r\n\tif(comps && comps.messages) this.setMessageDOM(comps.messages);\r\n\tif(comps && comps.controller) this.setControllerDOM(comps.controller);\r\n\t//if(comps && comps.explorer) this.setExplorerDOM(comps.explorer);\r\n\tif(comps && comps.plugins) this.setPluginsDOM(comps.plugins);\r\n\tif(this.plugins){\r\n\t\tthis.drawPlugins();\r\n\t}\r\n\tif(this.buttons){\r\n\t\t//this.toggleControl();\r\n\t}\r\n\tvar self = this;\r\n\tvar cdrawn = false;\r\n\tif(slocation && slocation.server){\r\n\t\tif(typeof this.client.connection.connection[slocation.server] == \"undefined\") {\r\n\t\t\treturn this.connect(slocation)\r\n\t\t\t.catch(function(error){\r\n\t\t\t\tself.showLoadURLPage();\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tthis.showLoadURLPage();\r\n\t};\r\n}\r\n\r\n\r\n\r\nTerminusUI.prototype.redraw = function(msg){\r\n\tthis.clearMessages();\r\n\tthis.redrawControls();\r\n\tif(this.explorer){\r\n\t\tTerminusClient.FrameHelper.removeChildren(this.explorer);\r\n\t\t//this.drawExplorer();\r\n\t}\r\n\tif(this.viewer){\r\n\t\tthis.redrawMainPage();\r\n\t}\r\n\tif(msg) this.showMessage(msg);\r\n};\r\n\r\n\r\nTerminusUI.prototype.toggleDashboardWidget = function(widget){\r\n    TerminusClient.FrameHelper.removeChildren(this.controller);\r\n    TerminusClient.FrameHelper.removeChildren(this.explorer);\r\n    UTILS.removeSelectedNavClass('terminus-dashboard-selected');\r\n    widget.classList.add('terminus-dashboard-selected');\r\n}\r\n\r\nTerminusUI.prototype.toggleControl = function(){\r\n /* var self = this;\r\n  this.buttons.client.addEventListener('click', function(){\r\n    self.toggleDashboardWidget(this);\r\n    self.drawControls();\r\n    self.showServerMainPage();\r\n  })\r\n  this.buttons.explorer.addEventListener('click', function(){\r\n    self.toggleDashboardWidget(this);\r\n    self.drawExplorer();\r\n  })*/\r\n}\r\n\r\nTerminusUI.prototype.redrawControls = function(){\r\n\tif(this.controller){\r\n\t\tTerminusClient.FrameHelper.removeChildren(this.controller);\r\n\t\tthis.drawControls();\r\n\t}\r\n}\r\n\r\nTerminusUI.prototype.drawControls = function(){\r\n\tthis.controls = [];\r\n\tthis.loadControls();\r\n\tfor(var i = 0; i<this.controls.length; i++){\r\n\t\tvar ncontrol = this.controls[i];\r\n\t\tif(ncontrol && (nd = ncontrol.getAsDOM())){\r\n\t\t\tthis.controller.appendChild(nd);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nTerminusUI.prototype.drawExplorer = function(){\r\n\tif(this.explorer){\r\n\t\tif(this.showControl(\"api_explorer\")){\r\n\t\t\tvar exp = new ApiExplorer(this);\r\n\t\t\tae = exp.getAsDOM();\r\n\t\t\tthis.explorer.appendChild(ae);\r\n\t\t\tthis.explorer.style.display = 'block';\r\n\t\t}\r\n\t}\r\n}\r\n\r\nTerminusUI.prototype.loadControls = function(){\r\n\tif(this.showControl('server')){\r\n\t\tvar sc = new TerminusServersdk.TerminusServerController(this);\r\n\t\tif(sc) {\r\n\t\t\tthis.controls.push(sc);\r\n\t\t}\r\n\t\tif(this.db() && this.showControl(\"db\")){\r\n\t\t\tvar sc = new TerminusDBsdk.TerminusDBController(this);\r\n\t\t\tif(sc) this.controls.push(sc);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nTerminusUI.prototype.showControl = function(el){\r\n\tif(this.show_controls.indexOf(el) == -1) return false;\r\n\tif(this.pseudoCapability(el)) return true;\r\n\tif(this.client.connection.capabilitiesPermit(el)) {\r\n\t\treturn true;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nTerminusUI.prototype.showView = function(el){\r\n\tif(this.show_views.indexOf(el) == -1) return false;\r\n\tif(this.pseudoCapability(el)) return true;\r\n\tif(this.client.connection.capabilitiesPermit(el)) {\r\n\t\treturn true;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nTerminusUI.prototype.clearBusy = function(response){\r\n\tthis.clearMessages();\r\n\tif(this.viewer && typeof this.viewer.busy == \"function\") this.viewer.busy(false);\r\n}\r\n\r\nTerminusUI.prototype.getBusyLoader = function(bsyDom){\r\n     var pd = document.createElement('div');\r\n     var pbc = document.createElement('div');\r\n     pbc.setAttribute('class', 'term-progress-bar-container');\r\n     pd.appendChild(pbc);\r\n\r\n     var pbsa = document.createElement('div');\r\n     pbsa.setAttribute('class', 'term-progress-bar term-stripes animated reverse slower');\r\n     pbc.appendChild(pbsa);\r\n     var pbia = document.createElement('span');\r\n     pbia.setAttribute('class', 'term-progress-bar-inner');\r\n     pbsa.appendChild(pbia);\r\n\r\n     bsyDom.appendChild(pd);\r\n}\r\n\r\nTerminusUI.prototype.showMessage = function(msg, type){\r\n\tif(this.messages){\r\n\t\tTerminusClient.FrameHelper.removeChildren(this.messages);\r\n\t\tvar md = document.createElement('div');\r\n        switch(type){\r\n            case 'busy':\r\n                var msgHolder = document.createElement('div');\r\n                msgHolder.setAttribute('class', 'terminus-busy-msg')\r\n                msgHolder.appendChild(document.createTextNode(msg));\r\n                md.appendChild(msgHolder);\r\n                this.getBusyLoader(md);\r\n            break;\r\n            case 'success':\r\n                md.setAttribute('class', 'terminus-show-msg-success');\r\n                md.appendChild(document.createTextNode(msg));\r\n            break;\r\n            case 'error':\r\n                md.setAttribute('class', 'terminus-show-msg-error');\r\n                md.appendChild(document.createTextNode(msg));\r\n            break;\r\n        }\r\n\t\tthis.messages.appendChild(md);\r\n\t}\r\n};\r\n\r\nTerminusUI.prototype.showViolations = function(vios, type){\r\n\tvar nvios = new TerminusViolations(vios, this);\r\n\tif(this.messages){\r\n\t\tvar cmsg = (type == \"schema\" ? \" in Schema\" : \" in Document\");\r\n\t\tTerminusClient.FrameHelper.removeChildren(this.messages);\r\n\t\tthis.messages.appendChild(nvios.getAsDOM(cmsg));\r\n\t}\r\n}\r\n\r\nTerminusUI.prototype.showBusy = function(msg){\r\n\tthis.showMessage(msg, \"busy\");\r\n\tif(this.viewer && typeof this.viewer.busy == \"function\") this.viewer.busy(msg);\r\n};\r\n\r\nTerminusUI.prototype.pseudoCapability = function(el){\r\n\tvar pseuds = [\"server\", \"db\", \"collaborate\", \"change-server\", \"api_explorer\", \"import_schema\", \"add_new_library\"];\r\n\tif(pseuds.indexOf(el) == -1) return false;\r\n\treturn true;\r\n}\r\n\r\nTerminusUI.prototype.setOptions = function(opts){\r\n\tthis.show_controls = opts && opts.controls ? opts.controls :\r\n\t\t[\"server\", \"db\", \"change-server\", \"schema_format\",\r\n\t\t\t\"import_schema\", \"class_frame\", \"create_database\",\r\n\t\t\t\"collaborate\", \"get_document\", \"update_schema\",\r\n\t\t\t\"get_schema\", \"woql_select\"\r\n\t\t];\r\n\tthis.show_views = opts && opts.views ? opts.views : this.show_controls;\r\n\tif(opts.document){\r\n\t\tthis.document_options = opts.document;\r\n\t}\r\n\tif(opts.schema){\r\n\t\tthis.schema_options = opts.schema;\r\n\t}\r\n\tthis.piman = new TerminusPluginManager();\r\n\tvar self = this;\r\n\tthis.piman.init(opts.plugins, function(){\r\n\t\tvar pins = [\"gmaps\", \"quill\", \"select2\"];\r\n\t\tfor(var i = 0; i<pins.length; i++){\r\n\t\t\tif(self.piman.pluginAvailable(pins[i])){\r\n\t\t\t\tRenderingMap.addPlugin(pins[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t\tself.redraw();\r\n\t});\r\n\tif(opts.css && this.piman){\r\n\t\tthis.piman.loadPageCSS(opts.css);\r\n\t}\r\n\tthis.loadControls();\r\n}\r\n\r\nTerminusUI.prototype.pluginAvailable = function(p){\r\n\treturn this.piman.pluginAvailable(p);\r\n}\r\n\r\nTerminusUI.prototype.drawPlugins = function(){\r\n\tif(!this.piman) {\r\n\t\tconsole.log(new Error(\"No plugin manager initialised in UI object\"));\r\n\t\treturn false;\r\n\t}\r\n\tthis.plugins.appendChild(this.piman.getAsDOM(this));\r\n}\r\n\r\nTerminusUI.prototype.getDocViewerOptions = function(){\r\n\tif(this.document_options && this.document_options['view']){\r\n\t\treturn this.document_options['view'];\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nTerminusUI.prototype.getDocCreatorOptions = function(){\r\n\tif(this.document_options && this.document_options['view']){\r\n\t\treturn this.document_options['view'];\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nTerminusUI.prototype.getClassFrameOptions = function(){\r\n\treturn this.viewdoc_options;\r\n}\r\n\r\nmodule.exports=TerminusUI\r\n","/**\r\n * @file Javascript Api explorer tool\r\n * @author Kitty Jose\r\n * @license Copyright 2018-2019 Data Chemist Limited, All Rights Reserved. See LICENSE file for more\r\n *\r\n * @summary Displays a demo and description of api calls from WOQLCLient and what happens under the hood of api calls\r\n */\r\nconst TerminusPluginManager = require('./plugins/TerminusPlugin');\r\nconst UTILS = require('./Utils');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nlet apiNavConfig = {\r\n    mainNav: {\r\n        connect: {\r\n    \t\tnavText: 'Connect API',\r\n            action : 'connect',\r\n            icon   : 'link',\r\n            defaultSelected: true\r\n    \t},\r\n        database: {\r\n            navText: 'Database API',\r\n            action : 'create',\r\n            icon   : 'database'\r\n        },\r\n        schema: {\r\n            navText: 'Schema API',\r\n            action : 'schema',\r\n            icon   : 'cog'\r\n        },\r\n        document: {\r\n            navText: 'Document API',\r\n            action : 'document',\r\n            icon   : 'file'\r\n        },\r\n        query: {\r\n            navText: 'Query API',\r\n            action : 'query',\r\n            icon   : 'search'\r\n        }\r\n    },\r\n    subNav: {\r\n        database: {\r\n            createDatabase: {\r\n                navText: 'Create database',\r\n                action : 'create',\r\n                icon   : 'plus',\r\n                defaultSelected: true\r\n            },\r\n            deleteDatabase: {\r\n                navText: 'Delete database',\r\n                action : 'delete',\r\n                icon   : 'trash-alt'\r\n            }\r\n        },\r\n        schema: {\r\n            getSchema: {\r\n                navText: 'View Schema',\r\n                action : 'getSchema',\r\n                icon   : 'eye',\r\n                defaultSelected: true\r\n            },\r\n            updateSchema: {\r\n                navText: 'Update Schema',\r\n                action : 'updateSchema',\r\n                icon   : 'arrow-up'\r\n            },\r\n            getClassFrames: {\r\n                navText: 'Get Class Frames',\r\n                action : 'getClassFrames',\r\n                icon   : 'share-alt'\r\n            }\r\n        },\r\n        document: {\r\n            viewDocument: {\r\n        \t\tnavText: 'View Document',\r\n                action : 'viewDocument',\r\n                icon   : 'eye',\r\n                defaultSelected: true\r\n        \t},\r\n            createDocument: {\r\n                navText: 'Create Document',\r\n                action : 'createDocument',\r\n                icon   : 'plus'\r\n            },\r\n            updateDocument: {\r\n                navText: 'Update Document',\r\n                action : 'updateDocument',\r\n                icon   : 'arrow-up'\r\n            },\r\n            deleteDocument:{\r\n                navText: 'Delete Document',\r\n                action : 'deleteDocument',\r\n                icon   : 'trash-alt'\r\n            }\r\n        },\r\n        query: {\r\n            select: {\r\n                navText: 'Select',\r\n                action : 'select',\r\n                icon   : 'mouse-pointer',\r\n                defaultSelected: true\r\n            },\r\n            update: {\r\n                navText: 'Update',\r\n                action : 'update',\r\n                icon   : 'arrow-up'\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nfunction ApiExplorer(ui){\r\n    this.ui = ui;\r\n    this.viewer = ui.mainDOM;\r\n    this.client = new TerminusClient.WOQLClient();\r\n    this.client.use_fetch = true;\r\n    this.client.return_full_response = true;\r\n    this.pman = new TerminusPluginManager();\r\n}\r\n\r\n// Controller provides access to Api explorer functions\r\nApiExplorer.prototype.getAsDOM = function(){\r\n \tvar aec = document.createElement(\"div\");\r\n    aec.setAttribute(\"class\", \"terminus-db-controller\");\r\n    if(this.ui){\r\n       this.getApiNav(aec, this.viewer); // nav\r\n       this.getApiExplorerDom('connect', this.viewer); // content dom\r\n    } // if this.ui\r\n    return aec;\r\n }\r\n\r\n/***** Api Nav bar *****/\r\n// Toggle selected nav bars\r\nApiExplorer.prototype.setSelectedNavMenu = function(a){\r\n    UTILS.removeSelectedNavClass(\"terminus-selected\");\r\n    a.classList.add(\"terminus-selected\");\r\n}\r\n\r\nApiExplorer.prototype.navOnSelect = function(action, nav, viewer){\r\n    UTILS.removeSelectedNavClass(\"terminus-selected\");\r\n    nav.classList.add(\"terminus-selected\");\r\n    this.getApiExplorerDom(action, viewer);\r\n}\r\n\r\n// create nav bars\r\nApiExplorer.prototype.createNavs = function(navConfig, viewer, ul){\r\n    var a = document.createElement('a');\r\n    a.setAttribute('class', 'terminus-a terminus-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\r\n    if(navConfig.defaultSelected) a.classList.add('terminus-selected');\r\n    var self = this;\r\n    a.addEventListener(\"click\", function(){\r\n        self.navOnSelect(navConfig.action, this, viewer);\r\n    })\r\n    var icon = document.createElement('i');\r\n    icon.setAttribute('class', 'terminus-menu-icon fa fa-' + navConfig.icon);\r\n    a.appendChild(icon);\r\n    var txt = document.createTextNode(navConfig.navText);\r\n    a.appendChild(txt);\r\n    ul.appendChild(a);\r\n}\r\n\r\n// gets api nav bar\r\nApiExplorer.prototype.getApiNav = function(navDom, viewer){\r\n    // list view of apis\r\n    var nav = document.createElement('div');\r\n    navDom.appendChild(nav);\r\n    // connect to server api\r\n    var ul = document.createElement('ul');\r\n    ul.setAttribute('class', 'terminus-ul');\r\n    nav.appendChild(ul);\r\n    // loop over apiNavConfig\r\n    for (var key in apiNavConfig.mainNav){\r\n        if (apiNavConfig.mainNav.hasOwnProperty(key)) {\r\n            this.createNavs(apiNavConfig.mainNav[key], viewer, ul);\r\n        }\r\n    } // for apiNavConfig\r\n    return navDom;\r\n} // getApiNav()\r\n\r\n/***** Api sub navs  *****/\r\n// get schema api explorer - nav bar, alert msg, headers ...\r\nApiExplorer.prototype.getApiExplorerDom = function(view, viewer){\r\n    // clear of viewer\r\n    TerminusClient.FrameHelper.removeChildren(viewer);\r\n    // wrapper\r\n    var wrap = document.createElement('div');\r\n    //wrap.setAttribute('class', 'terminus-wrapper terminus-wrapper-height');\r\n    viewer.appendChild(wrap);\r\n    var cont = document.createElement('div');\r\n    cont.setAttribute('class', 'container-fluid');\r\n    wrap.appendChild(cont);\r\n    var row = document.createElement('div');\r\n    row.setAttribute('class', 'row-fluid');\r\n    cont.appendChild(row);\r\n    var body = document.createElement('div');\r\n    body.setAttribute('class', 'terminus-module-body');\r\n    row.appendChild(body);\r\n    var api = document.createElement('div');\r\n    api.setAttribute('class', 'terminus-module-body terminus-module-body-white-bg terminus-module-body-width');\r\n    body.appendChild(api);\r\n    // body\r\n    var cont = document.createElement('div');\r\n    var self = this;\r\n    switch(view){\r\n        case 'connect':\r\n            var apiCont = self.getConnectExplorer(cont);\r\n            api.appendChild(apiCont);\r\n        break;\r\n        case 'create':\r\n            var apiCont = self.getDatabaseExplorer(cont);\r\n            api.appendChild(apiCont);\r\n        break;\r\n        case 'schema':\r\n            var apiCont = self.getSchemaApi(cont);\r\n            api.appendChild(apiCont);\r\n        break;\r\n        case 'document':\r\n            var apiCont = self.getDocumentApi(cont);\r\n            api.appendChild(apiCont);\r\n        break;\r\n        case 'query':\r\n            var apiCont = self.getQueryApi(cont);\r\n            api.appendChild(apiCont);\r\n        break;\r\n    }// switch(api)\r\n    return wrap;\r\n} // getApiExplorerDom\r\n\r\n// on trigger of click event - change dom\r\nApiExplorer.prototype.changeSubApiDom = function(curSubMenu, action, cont, body){\r\n    TerminusClient.FrameHelper.removeChildren(body);\r\n    switch(curSubMenu){\r\n        case 'database':\r\n            var dom = this.getDatabaseDom(action, body);\r\n        break;\r\n        case 'schema':  // getShowApiDom() deals with schema and document\r\n             var dom = this.getShowApiDom(action, body);\r\n        break;\r\n        case 'document': // getShowApiDom() deals with schema and document\r\n             var dom = this.getShowApiDom(action, body);\r\n        break;\r\n        case 'query':\r\n            var dom = this.getQueryApiDom(action, body);\r\n        break;\r\n        default:\r\n            console.log('Invalid Api Config');\r\n        break;\r\n    }\r\n    cont.appendChild(dom);\r\n}\r\n\r\nApiExplorer.prototype.subNavOnSelect = function(curSubMenu, subMenuConfig, subNav, cont, body){\r\n    UTILS.setSelectedSubMenu(subNav);\r\n    this.changeSubApiDom(curSubMenu, subMenuConfig.action, cont, body);\r\n}\r\n\r\n// create sub nav bars\r\nApiExplorer.prototype.createSubNavs = function(curSubMenu, subMenuConfig, cont, body, ul){\r\n    // comment getclassframes for api explorer time being\r\n    if(subMenuConfig.action == 'getClassFrames') return;\r\n    var a = document.createElement('a');\r\n    a.setAttribute('class', 'terminus-a terminus-hz-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\r\n    if(subMenuConfig.defaultSelected) a.classList.add('terminus-submenu-selected');\r\n    var self = this;\r\n    a.addEventListener(\"click\", function() {\r\n        self.subNavOnSelect(curSubMenu, subMenuConfig, this, cont, body);\r\n    })\r\n    var icon = document.createElement('i');\r\n    icon.setAttribute('class', 'terminus-menu-icon fa fa-' + subMenuConfig.icon);\r\n    a.appendChild(icon);\r\n    var txt = document.createTextNode(subMenuConfig.navText);\r\n    a.appendChild(txt);\r\n    ul.appendChild(a);\r\n}\r\n\r\n// get connect to server api calls - on click of connectAPI nav bar\r\nApiExplorer.prototype.getConnectExplorer = function(body){\r\n    var self = this;\r\n    var br = document.createElement('BR');\r\n    body.appendChild(br);\r\n    // get signature\r\n    var b = this.getSignature('connect');\r\n    body.appendChild(b);\r\n    // get header Parameter\r\n    body.appendChild(UTILS.getHeaderDom('Parameters'));\r\n    var br = document.createElement('BR');\r\n    body.appendChild(br);\r\n    //form to get server url\r\n    this.getForm( '', body, true, 'connect', 'URL : server_url');\r\n    //body.appendChild(form);\r\n    return body;\r\n} // getConnectExplorer\r\n\r\n// get database api calls - on click of databaseAPI nav bar - submenus of database Api defined here\r\nApiExplorer.prototype.getDatabaseExplorer = function(cont){\r\n    var body = document.createElement('div');\r\n    // list view of Databse tools\r\n    var ul = document.createElement('ul');\r\n    ul.setAttribute('class','terminus-ul-horizontal');\r\n    // loop over apiNavConfig\r\n    for (var key in apiNavConfig.subNav.database){\r\n        if (apiNavConfig.subNav.database.hasOwnProperty(key))\r\n            this.createSubNavs('database', apiNavConfig.subNav.database[key], cont, body, ul);\r\n    } // for apiNavConfig\r\n    cont.appendChild(ul);\r\n    // landing page\r\n    var dom = this.getDatabaseDom(apiNavConfig.subNav.database.createDatabase.action, body);\r\n    cont.appendChild(dom);\r\n    return cont;\r\n} // getDatabaseExplorer\r\n\r\n// get schema api calls - on click of SchemaAPI nav bar - submenus of schema Api defined here\r\nApiExplorer.prototype.getSchemaApi = function(cont){\r\n    var body = document.createElement('div');\r\n    // list view of Databse tools\r\n    var ul = document.createElement('ul');\r\n    ul.setAttribute('class','terminus-ul-horizontal');\r\n    // loop over apiNavConfig\r\n    for (var key in apiNavConfig.subNav.schema){\r\n        if (apiNavConfig.subNav.schema.hasOwnProperty(key)) {\r\n            this.createSubNavs('schema', apiNavConfig.subNav.schema[key], cont, body, ul);\r\n        }\r\n    } // for apiNavConfig\r\n    cont.appendChild(ul);\r\n    var dom = this.getShowApiDom(apiNavConfig.subNav.schema.getSchema.action, body);\r\n    cont.appendChild(dom);\r\n    return cont;\r\n} // getSchemaApi\r\n\r\n// get document api calls - on click of DocumentAPI nav bar\r\nApiExplorer.prototype.getDocumentApi = function(cont){\r\n    var body = document.createElement('div');\r\n    // list view of Databse tools\r\n    var ul = document.createElement('ul');\r\n    ul.setAttribute('class','terminus-ul-horizontal');\r\n    // loop over apiNavConfig\r\n    for (var key in apiNavConfig.subNav.document){\r\n        if (apiNavConfig.subNav.document.hasOwnProperty(key)) {\r\n            this.createSubNavs('document', apiNavConfig.subNav.document[key], cont, body, ul);\r\n        }\r\n    } // for apiNavConfig\r\n    cont.appendChild(ul);\r\n    var dom = this.getShowApiDom(apiNavConfig.subNav.document.viewDocument.action, body);\r\n    cont.appendChild(dom);\r\n    return cont;\r\n} // getDocumentApi\r\n\r\n// get query api calls - on click of QueryAPI nav bar - submenus of Query Api defined here\r\nApiExplorer.prototype.getQueryApi  = function(cont){\r\n    var body = document.createElement('div');\r\n    // list view of Databse tools\r\n    var ul = document.createElement('ul');\r\n    ul.setAttribute('class','terminus-ul-horizontal');\r\n    // loop over apiNavConfig\r\n    for (var key in apiNavConfig.subNav.query){\r\n        if (apiNavConfig.subNav.query.hasOwnProperty(key)) {\r\n            this.createSubNavs('query', apiNavConfig.subNav.query[key], cont, body, ul);\r\n        }\r\n    } // for apiNavConfig\r\n    cont.appendChild(ul);\r\n    var dom = this.getQueryApiDom(apiNavConfig.subNav.query.select.action, body);\r\n    cont.appendChild(dom);\r\n    return cont;\r\n} //getQueryApi\r\n\r\n/***** Api Content view  *****/\r\n// get database dom\r\nApiExplorer.prototype.getDatabaseDom = function(mode, body){\r\n    var self = this;\r\n    var br = document.createElement('BR');\r\n    body.appendChild(br);\r\n    // get signature\r\n    var b = this.getSignature(mode);\r\n    body.appendChild(b);\r\n    // get header Parameter\r\n    body.appendChild(UTILS.getHeaderDom('Parameters'));\r\n    var br = document.createElement('BR');\r\n    body.appendChild(br);\r\n    //form to get database id\r\n    if(mode == 'create') this.getForm( null, body, false, mode, 'URL : server/database_id');\r\n    else this.getForm( null, body, true, mode, 'URL : server/database_id');\r\n    return body;\r\n} // getConnectExplorer\r\n\r\n//get create & delete db form\r\nApiExplorer.prototype.getServerForm = function(){\r\n  // form\r\n  var form = document.createElement('form');\r\n  form.setAttribute('class', 'terminus-form-horizontal row-fluid');\r\n\r\n  var fd = document.createElement('div');\r\n  fd.setAttribute('class', 'terminus-control-group');\r\n  form.appendChild(fd);\r\n  var inpLabel = document.createElement('label');\r\n  inpLabel.setAttribute('class', 'terminus-control-label');\r\n  inpLabel.setAttribute('for', 'basicinput');\r\n  inpLabel.innerHTML = 'Url:';\r\n  fd.appendChild(inpLabel);\r\n  var cd = document.createElement('div');\r\n  cd.setAttribute('class', 'terminus-controls');\r\n  fd.appendChild(cd);\r\n  var inpId = document.createElement('input');\r\n  inpId.setAttribute('type', 'text');\r\n  inpId.setAttribute('id', 'basicinput');\r\n  inpId.setAttribute('class', 'terminus-input-text');\r\n  inpId.setAttribute('placeholder', 'URL : server_url');\r\n  if(this.val) inpId.value = this.val;\r\n  cd.appendChild(inpId);\r\n\r\n  var fd = document.createElement('div');\r\n  fd.setAttribute('class', 'terminus-control-group');\r\n  form.appendChild(fd);\r\n  var keyLabel = document.createElement('label');\r\n  keyLabel.setAttribute('class', 'terminus-control-label');\r\n  keyLabel.setAttribute('for', 'basicinput');\r\n  keyLabel.innerHTML = 'Key:';\r\n  fd.appendChild(keyLabel);\r\n  var cd = document.createElement('div');\r\n  cd.setAttribute('class', 'terminus-controls');\r\n  fd.appendChild(cd);\r\n  var key = document.createElement('input');\r\n  key.setAttribute('type', 'text');\r\n  key.setAttribute('id', 'basicinput');\r\n  key.setAttribute('class', 'span8 terminus-input-text');\r\n  key.setAttribute('placeholder', 'Key : key');\r\n  if(this.val) key.value = this.val;\r\n  cd.appendChild(key);\r\n\r\n  var button = document.createElement('button');\r\n  button.setAttribute('class', 'terminus-btn terminus-send-api-btn');\r\n  button.setAttribute('type', 'button');\r\n  button.innerHTML = 'Send Api';\r\n  var gatherips = function(){\r\n    var input = {};\r\n    input.url = inpId.value;\r\n    input.key = key.value;\r\n    return input;\r\n  }\r\n  var resd = document.createElement('div');\r\n  form.appendChild(button);\r\n  form.appendChild(resd);\r\n  var self = this;\r\n  button.addEventListener(\"click\", function(){\r\n    var buttonSelf = this;\r\n    //opts = {};\r\n    var input = gatherips();\r\n    self.client.connect(input.url, input.key)\r\n    .then(function(response){\r\n      TerminusClient.FrameHelper.removeChildren(resd);\r\n      var resultDom = UTILS.showHttpResult(response, 'connect', resd, self.ui);\r\n    });\r\n  }) // button click\r\n  return form;\r\n} // getServerForm()\r\n\r\n// get database api calls - on click of databaseAPI nav bar - submenus of database Api defined here\r\nApiExplorer.prototype.getDatabaseExplorer = function(cont){\r\n  var body = document.createElement('div');\r\n  // list view of Databse tools\r\n  var ul = document.createElement('ul');\r\n  ul.setAttribute('class','terminus-ul-horizontal');\r\n  // loop over apiNavConfig\r\n  for (var key in apiNavConfig.subNav.database){\r\n      if (apiNavConfig.subNav.database.hasOwnProperty(key)) {\r\n          this.createSubNavs('database', apiNavConfig.subNav.database[key], cont, body, ul);\r\n      }\r\n  } // for apiNavConfig\r\n  cont.appendChild(ul);\r\n  // landing page\r\n  var dom = this.getDatabaseDom(apiNavConfig.subNav.database.createDatabase.action, body);\r\n  cont.appendChild(dom);\r\n  return cont;\r\n} // getDatabaseExplorer\r\n\r\n\r\n// get schema & document dom\r\nApiExplorer.prototype.getShowApiDom = function(action, body){\r\n    var self = this;\r\n    var br = document.createElement('BR');\r\n    body.appendChild(br);\r\n    // signature\r\n    var b = this.getSignature(action);\r\n    body.appendChild(b);\r\n    // get header Parameter\r\n    body.appendChild(UTILS.getHeaderDom('Parameters'));\r\n    var br = document.createElement('BR');\r\n    body.appendChild(br);\r\n    // get input\r\n    switch(action){\r\n        case 'getSchema':\r\n            this.getForm( 'schema', body, true, action, 'URL : server/database_id');\r\n        break;\r\n        case 'getClassFrames':\r\n            this.getForm( 'getClassFrames', body, true, action, 'URL : server/database_id');\r\n        break;\r\n        case 'updateSchema':\r\n            this.getForm( 'schema', body, false, action, 'URL : server/database_id');\r\n        break;\r\n        case 'viewDocument':\r\n            this.getForm('document', body, true, action, 'URL : server/database_id/document/document_id');\r\n        break;\r\n        case 'deleteDocument':\r\n            this.getForm('document', body, true, action, 'URL : server/database_id/document/document_id');\r\n        break;\r\n        case 'createDocument':\r\n            this.getForm('document', body, false, action, 'URL : server/database_id/document/document_id');\r\n        break;\r\n        case 'updateDocument':\r\n            this.getForm('document', body, false, action, 'URL : server/database_id/document/document_id');\r\n        break;\r\n        default:\r\n            console.log('Invalid Api Call on form');\r\n        break;\r\n   }// switch(action)\r\n\r\n   return body;\r\n } // getShowApiDom()\r\n\r\n// get query api dom\r\nApiExplorer.prototype.getQueryApiDom = function(action, body){\r\n    var br = document.createElement('BR');\r\n    body.appendChild(br);\r\n    // signature\r\n    var b = this.getSignature(action);\r\n    body.appendChild(b);\r\n    // get header Parameter\r\n    body.appendChild(UTILS.getHeaderDom('Parameters'));\r\n    var br = document.createElement('BR');\r\n    body.appendChild(br);\r\n    this.getForm( 'query', body, false, action, 'URL : server/database_id');\r\n    return body;\r\n} // getQueryApiDom\r\n\r\n/*ApiExplorer.prototype.getClassFramesForm = function(){\r\n    // form\r\n    var form = document.createElement('form');\r\n    form.setAttribute('class', 'terminus-form-horizontal row-fluid');\r\n    var fd = document.createElement('div');\r\n    fd.setAttribute('class', 'terminus-control-group');\r\n    form.appendChild(fd);\r\n    var inpLabel = document.createElement('label');\r\n    inpLabel.setAttribute('class', 'terminus-control-label');\r\n    inpLabel.setAttribute('for', 'basicinput');\r\n    inpLabel.innerHTML = 'Url:';\r\n    fd.appendChild(inpLabel);\r\n    var cd = document.createElement('div');\r\n    cd.setAttribute('class', 'terminus-controls');\r\n    fd.appendChild(cd);\r\n    var inpUrl = document.createElement('input');\r\n    inpUrl.setAttribute('type', 'text');\r\n    inpUrl.setAttribute('id', 'basicinput');\r\n    inpUrl.setAttribute('class', 'span8 terminus-input-text');\r\n    inpUrl.setAttribute('placeholder', 'URL : database_url');\r\n    if(this.val) inpUrl.value = this.val;\r\n    cd.appendChild(inpUrl);\r\n    var fd = document.createElement('div');\r\n    fd.setAttribute('class', 'terminus-control-group');\r\n    form.appendChild(fd);\r\n    var inpLabel = document.createElement('label');\r\n    inpLabel.setAttribute('class', 'terminus-control-label');\r\n    inpLabel.setAttribute('for', 'basicinput');\r\n    inpLabel.innerHTML = 'Url/ ID:';\r\n    fd.appendChild(inpLabel);\r\n    var cd = document.createElement('div');\r\n    cd.setAttribute('class', 'terminus-controls');\r\n    fd.appendChild(cd);\r\n    var inpDocUrl = document.createElement('input');\r\n    inpDocUrl.setAttribute('type', 'text');\r\n    inpDocUrl.setAttribute('id', 'basicinput');\r\n    inpDocUrl.setAttribute('class', 'span8 terminus-input-text');\r\n    inpDocUrl.setAttribute('placeholder', 'Url or ID of document class');\r\n    cd.appendChild(inpDocUrl);\r\n    var fd = document.createElement('div');\r\n    fd.setAttribute('class', 'terminus-control-group');\r\n    form.appendChild(fd);\r\n    var optLabel = document.createElement('label');\r\n    optLabel.setAttribute('class', 'terminus-control-label');\r\n    optLabel.setAttribute('for', 'basicinput');\r\n    optLabel.innerHTML = 'Options:';\r\n    fd.appendChild(optLabel);\r\n    var cd = document.createElement('div');\r\n    cd.setAttribute('class', 'terminus-controls');\r\n    fd.appendChild(cd);\r\n    var optInp = document.createElement('input');\r\n    optInp.setAttribute('type', 'text');\r\n    optInp.setAttribute('id', 'basicinput');\r\n    optInp.setAttribute('class', 'span8 terminus-input-text');\r\n    optInp.setAttribute('placeholder', 'options');\r\n    cd.appendChild(optInp);\r\n    var button = document.createElement('button');\r\n    button.setAttribute('class', 'terminus-btn terminus-send-api-btn');\r\n    button.setAttribute('type', 'button');\r\n    button.innerHTML = 'Send Api';\r\n    var gatherips = function(){\r\n        var input = {};\r\n        input.url = inpUrl.value;\r\n        input.docUrl = inpDocUrl.value;\r\n        input.options = optInp.value;\r\n        return input;\r\n    }\r\n    var self = this;\r\n    button.addEventListener(\"click\", function(form){\r\n      var input = gatherips();\r\n      var buttonSelf = this;\r\n      opts = {};\r\n      opts.explorer = true;\r\n      self.client.getClassFrame(input.url, input.docUrl, opts)\r\n      .then(function(response){\r\n          var currForm = buttonSelf.parentNode;\r\n          var resultDom = UTILS.showHttpResult(response, 'getClassFrames', currForm, self.ui);\r\n      });\r\n    }) // button click\r\n    form.appendChild(button);\r\n    return form;\r\n}   */\r\n\r\n// get form for all Apis\r\nApiExplorer.prototype.getForm = function(curApi, body, view, action, urlPlaceholder){\r\n    // form\r\n    var formDoc = document.createElement('form');\r\n    formDoc.setAttribute('class', 'terminus-form-horizontal row-fluid');\r\n    var fd = document.createElement('div');\r\n    fd.setAttribute('class', 'terminus-control-group');\r\n    formDoc.appendChild(fd);\r\n    var urlLabel = document.createElement('label');\r\n    urlLabel.setAttribute('class', 'terminus-control-label');\r\n    urlLabel.setAttribute('for', 'basicinput');\r\n    urlLabel.innerHTML = 'Url:';\r\n    fd.appendChild(urlLabel);\r\n    var cd = document.createElement('div');\r\n    cd.setAttribute('class', 'terminus-controls');\r\n    fd.appendChild(cd);\r\n    var inpUrl = document.createElement('input');\r\n    inpUrl.setAttribute('type', 'text');\r\n    inpUrl.setAttribute('id', 'basicinput');\r\n    inpUrl.setAttribute('class', 'span8 terminus-input-text');\r\n    inpUrl.setAttribute('placeholder', urlPlaceholder);\r\n    cd.appendChild(inpUrl);\r\n    // add extra form fields based on current api chosen\r\n    switch(curApi){\r\n        case 'getClassFrames':\r\n            var fd = document.createElement('div');\r\n            fd.setAttribute('class', 'terminus-control-group');\r\n            formDoc.appendChild(fd);\r\n            var docUrlLabel = document.createElement('label');\r\n            docUrlLabel.setAttribute('class', 'terminus-control-label');\r\n            docUrlLabel.setAttribute('for', 'basicinput');\r\n            docUrlLabel.innerHTML = 'Url/ ID:';\r\n            fd.appendChild(docUrlLabel);\r\n            var cd = document.createElement('div');\r\n            cd.setAttribute('class', 'terminus-controls');\r\n            fd.appendChild(cd);\r\n            var inpDocUrl = document.createElement('input');\r\n            inpDocUrl.setAttribute('type', 'text');\r\n            inpDocUrl.setAttribute('id', 'basicinput');\r\n            inpDocUrl.setAttribute('class', 'span8 terminus-input-text');\r\n            inpDocUrl.setAttribute('placeholder', 'Url or ID of document class');\r\n            cd.appendChild(inpDocUrl);\r\n        break;\r\n        case 'schema':\r\n            //encoding\r\n           /* var fd = document.createElement('div');\r\n            fd.setAttribute('class', 'terminus-control-group');\r\n            formDoc.appendChild(fd);\r\n            var encLabel = document.createElement('label');\r\n            encLabel.setAttribute('class', 'terminus-control-label');\r\n            encLabel.setAttribute('for', 'basicinput');\r\n            encLabel.innerHTML = 'Encoding:';\r\n            fd.appendChild(encLabel);\r\n            var cd = document.createElement('div');\r\n            cd.setAttribute('class', 'terminus-controls');\r\n            fd.appendChild(cd);\r\n            var inpEnc = document.createElement('select');\r\n            inpEnc.setAttribute('style', 'height: 50px;width: 300px;padding: 10px;');\r\n            inpEnc.setAttribute('placeholder', 'turtle');\r\n            var optTurt = document.createElement('option');\r\n            optTurt.setAttribute('value', 'terminus:turtle');\r\n            optTurt.appendChild(document.createTextNode('turtle'));\r\n            inpEnc.appendChild(optTurt);\r\n            var optJld = document.createElement('option');\r\n            optJld.setAttribute('value', 'terminus:jsonld');\r\n            optJld.appendChild(document.createTextNode('jsonLD'));\r\n            inpEnc.appendChild(optJld);\r\n            cd.appendChild(inpEnc); */\r\n        break;\r\n    }\r\n    var fd = document.createElement('div');\r\n    fd.setAttribute('class', 'terminus-control-group');\r\n    formDoc.appendChild(fd);\r\n    var keyLabel = document.createElement('label');\r\n    keyLabel.setAttribute('class', 'terminus-control-label');\r\n    keyLabel.setAttribute('for', 'basicinput');\r\n    keyLabel.innerHTML = 'Key:';\r\n    fd.appendChild(keyLabel);\r\n    var cd = document.createElement('div');\r\n    cd.setAttribute('class', 'terminus-controls');\r\n    fd.appendChild(cd);\r\n    var inpKey = document.createElement('input');\r\n    inpKey.setAttribute('type', 'text');\r\n    inpKey.setAttribute('id', 'basicinput');\r\n    inpKey.setAttribute('class', 'span8 terminus-input-text');\r\n    inpKey.setAttribute('placeholder', 'Key');\r\n    cd.appendChild(inpKey);\r\n    if(!view){\r\n        // include text area only if call is type post\r\n        var fd = document.createElement('div');\r\n        fd.setAttribute('class', 'terminus-control-group');\r\n        formDoc.appendChild(fd);\r\n        var docLabel = document.createElement('label');\r\n        docLabel.setAttribute('class', 'terminus-control-label');\r\n        docLabel.setAttribute('for', 'basicinput');\r\n        if(curApi == 'query') docLabel.innerHTML = 'Query:';\r\n        docLabel.innerHTML = 'Document:';\r\n        fd.appendChild(docLabel);\r\n        var cd = document.createElement('div');\r\n        cd.setAttribute('class', 'terminus-controls');\r\n        fd.appendChild(cd);\r\n        var inpDoc = document.createElement('textarea');\r\n        cd.appendChild(inpDoc);\r\n        inpDoc.setAttribute('class', 'terminus-api-explorer-text-area');\r\n        UTILS.stylizeEditor(this.ui, inpDoc, 'api-doc', 'javascript');\r\n    }\r\n    body.appendChild(formDoc);\r\n    // gather inputs\r\n    var inp ={};\r\n    inp.url = inpUrl;\r\n    inp.key = inpKey;\r\n    if(curApi == 'getClassFrames') inp.docUrl = inpDocUrl;\r\n    //if(curApi == 'schema') inp.enc = inpEnc;\r\n    if(!view) inp.doc = inpDoc;\r\n    var form = this.getApiSendButton(action, inp);\r\n    body.appendChild(form);\r\n}\r\n\r\n// define event listeners on send api of schema & documents\r\n\r\nApiExplorer.prototype.getApiForm = function(action, input){\r\n  // form\r\n  var form = document.createElement('form');\r\n  form.setAttribute('class', 'terminus-form-horizontal row-fluid');\r\n\r\n  var button = document.createElement('button');\r\n  button.setAttribute('class', 'terminus-btn terminus-send-api-btn');\r\n  button.setAttribute('type', 'button');\r\n  button.innerHTML = 'Send Api';\r\n  form.appendChild(button);\r\n  var resd = document.createElement('div');\r\n  form.appendChild(resd);\r\n  var self = this;\r\n  switch(action){\r\n    case 'getSchema':\r\n      button.addEventListener(\"click\", function(){\r\n        var opts = {};\r\n        opts['terminus:encoding'] = input.enc.value;\r\n        opts['terminus:user_key'] = 'terminus:turtle';\r\n        var schurl = input.url.value;\r\n        var buttonSelf = this;\r\n        self.client.getSchema(schurl, opts)\r\n        .then(function(response){\r\n          TerminusClient.FrameHelper.removeChildren(resd);\r\n          var resultDom = UTILS.showHttpResult(response, 'getSchema', resd, self.ui);\r\n        });\r\n      }) // button click\r\n    break;\r\n    case 'updateSchema':\r\n      button.addEventListener(\"click\", function(){\r\n        var buttonSelf = this;\r\n        opts = {};\r\n        opts['terminus:encoding'] = input.enc.value;\r\n        opts['terminus:user_key'] = 'terminus:turtle';\r\n        var schurl = input.url.value;\r\n        self.client.connectionConfig.connected_mode = false;\r\n        self.client.updateSchema(schurl, input.doc.value, opts)\r\n        .then(function(response){\r\n          var gtxtar = document.createElement('textarea');\r\n          gtxtar.setAttribute('readonly', true);\r\n          gtxtar.innerHTML = response;\r\n          var currForm = buttonSelf.parentNode;\r\n          currForm.appendChild(gtxtar);\r\n          UTILS.stylizeEditor(this.ui, txtar, 'schema', 'turtle');\r\n        });\r\n      }) // button click\r\n    break;\r\n    case 'viewDocument':\r\n      button.addEventListener(\"click\", function(){\r\n      var dcurl = input.value;\r\n      var buttonSelf = this;\r\n      var opts = {};\r\n      opts.format = 'turtle';\r\n      self.client.getDocument(dcurl, opts)\r\n      .then(function(response){\r\n        TerminusClient.FrameHelper.removeChildren(resd);\r\n        var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n      });\r\n    }) // button click\r\n    break;\r\n    case 'deleteDocument':\r\n      button.addEventListener(\"click\", function(){\r\n      var dcurl = input.value;\r\n      var buttonSelf = this;\r\n      var opts = {};\r\n      self.client.deleteDocument(dcurl, opts)\r\n      .then(function(response){\r\n        TerminusClient.FrameHelper.removeChildren(resd);\r\n        var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n      });\r\n    }) // button click\r\n    break;\r\n    case 'createDocument':\r\n      button.addEventListener(\"click\", function(){\r\n        var dcurl = input.schemaUrlDom.value;\r\n        var payload = input.htmlEditor.getValue();\r\n        var buttonSelf = this;\r\n        opts = {};\r\n        self.client.createDocument(dcurl, payload, opts)\r\n        .then(function(response){\r\n          TerminusClient.FrameHelper.removeChildren(resd);\r\n          var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n        });\r\n      }) // button click\r\n    break;\r\n    case 'updateDocument':\r\n      button.addEventListener(\"click\", function(){\r\n        var dcurl = input.schemaUrlDom.value;\r\n        var payload = input.htmlEditor.getValue();\r\n        var buttonSelf = this;\r\n        opts = {};\r\n        opts.editmode = 'replace';\r\n        opts.format = 'json';\r\n        self.client.updateDocument(dcurl, payload, opts)\r\n        .then(function(response){\r\n          TerminusClient.FrameHelper.removeChildren(resd);\r\n          var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n        });\r\n      }) // button click\r\n    break;\r\n  } // switch(action)\r\n\r\n  var br = document.createElement('BR');\r\n  form.appendChild(br);\r\n  var br = document.createElement('BR');\r\n  form.appendChild(br);\r\n\r\n  return form;\r\n} // getApiForm()\r\n\r\n\r\n// define event listeners on send api of schema & documents\r\nApiExplorer.prototype.getApiSendButton = function(action, input){\r\n    // form\r\n    var form = document.createElement('form');\r\n    form.setAttribute('class', 'terminus-form-horizontal row-fluid');\r\n    var button = document.createElement('button');\r\n    button.setAttribute('class', 'terminus-btn terminus-send-api-btn');\r\n    button.setAttribute('type', 'button');\r\n    button.innerHTML = 'Send Api';\r\n    form.appendChild(button);\r\n    var resd = document.createElement('div');\r\n    form.appendChild(resd);\r\n    var self = this;\r\n    switch(action){\r\n        case 'connect':\r\n            button.addEventListener(\"click\", function(){\r\n                self.client.connect(input.url.value, input.key.value)\r\n                .then(function(response){\r\n                \tTerminusClient.FrameHelper.removeChildren(resd);\r\n                    var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n               });\r\n            }) // button click\r\n        break;\r\n        case 'create':\r\n            button.addEventListener(\"click\", function(form){\r\n              self.client.createDatabase(input.url.value, JSON.parse(input.doc.value), input.key.value)\r\n              .then(function(response){\r\n            \t  TerminusClient.FrameHelper.removeChildren(resd);\r\n                  var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n              });\r\n            }) // button click\r\n        break;\r\n        case 'delete':\r\n            button.addEventListener(\"click\", function(){\r\n              var opts ={}\r\n              self.client.deleteDatabase(input.url.value, input.key.value)\r\n              .then(function(response){\r\n            \t  TerminusClient.FrameHelper.removeChildren(resd);\r\n                  var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n              });\r\n            }) // button click\r\n        break\r\n        case 'getSchema':\r\n            button.addEventListener(\"click\", function(){\r\n                var opts = {};\r\n                opts['terminus:encoding'] = 'terminus:turtle';\r\n                opts['terminus:user_key'] = input.key.value;\r\n                var schurl = input.url.value;\r\n                self.client.getSchema(schurl, opts)\r\n                .then(function(response){\r\n                \tTerminusClient.FrameHelper.removeChildren(resd);\r\n                    var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n                });\r\n            }) // button click\r\n        break;\r\n        case 'updateSchema':\r\n            button.addEventListener(\"click\", function(){\r\n                opts = {};\r\n                opts['terminus:encoding'] = 'terminus:turtle';\r\n                opts['terminus:user_key'] = input.key.value;\r\n                var payload = input.doc.value;\r\n                var schurl = input.url.value;\r\n                self.client.connectionConfig.connected_mode = false;\r\n                self.client.updateSchema(schurl, input.doc.value, opts)\r\n                //self.client.updateSchema(schurl, input.doc.value, opts)\r\n                .then(function(response){\r\n                \tTerminusClient.FrameHelper.removeChildren(resd);\r\n                    var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n                });\r\n            }) // button click\r\n        break;\r\n        case 'getClassFrames':\r\n            button.addEventListener(\"click\", function(form){\r\n                var schurl = input.url.value;\r\n                opts = {};\r\n                opts.explorer = true;\r\n                self.client.getClassFrame(input.url, JSON.parse(input.docUrl.value), opts)\r\n                .then(function(response){\r\n                    var currForm = buttonSelf.parentNode;\r\n                    var resultDom = UTILS.showHttpResult(response, action, currForm, self.ui);\r\n                });\r\n            }) // button click\r\n        break;\r\n        case 'viewDocument':\r\n          button.addEventListener(\"click\", function(){\r\n              var dcurl = input.url.value;\r\n              var opts = {};\r\n              opts['terminus:encoding'] = \"jsonld\";\r\n              opts['terminus:user_key'] = input.key.value;\r\n              self.client.getDocument(dcurl, opts)\r\n              .then(function(response){\r\n            \t    TerminusClient.FrameHelper.removeChildren(resd);\r\n                    var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n              });\r\n        }) // button click\r\n        break;\r\n        case 'deleteDocument':\r\n          button.addEventListener(\"click\", function(){\r\n              var dcurl = input.url.value;\r\n              var opts = {};\r\n              opts.key = input.key.value;\r\n              self.client.deleteDocument(dcurl, opts)\r\n              .then(function(response){\r\n            \t  TerminusClient.FrameHelper.removeChildren(resd);\r\n                  var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n              });\r\n          }) // button click\r\n        break;\r\n        case 'createDocument':\r\n          button.addEventListener(\"click\", function(){\r\n              var dcurl = input.url.value;\r\n              var payload = input.doc.value;\r\n              opts = {};\r\n              opts['terminus:encoding'] = \"jsonld\";\r\n              opts['terminus:user_key'] = input.key.value;\r\n              self.client.createDocument(dcurl, JSON.parse(payload), opts)\r\n              .then(function(response){\r\n            \t   TerminusClient.FrameHelper.removeChildren(resd);\r\n                   var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n               });\r\n          }) // button click\r\n        break;\r\n        case 'updateDocument':\r\n          button.addEventListener(\"click\", function(){\r\n            var dcurl = input.url.value;\r\n            var payload = input.doc.value;\r\n            var buttonSelf = this;\r\n            opts = {};\r\n            opts['terminus:encoding'] = \"jsonld\";\r\n            opts['terminus:user_key'] = input.key.value;\r\n            self.client.updateDocument(dcurl, JSON.parse(payload), opts)\r\n            .then(function(response){\r\n            \tTerminusClient.FrameHelper.removeChildren(resd);\r\n                var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n            });\r\n          }) // button click\r\n        break;\r\n        case 'select':\r\n            button.addEventListener(\"click\", function(){\r\n                var opts = {};\r\n                opts.key = input.key.value;\r\n                var doc = JSON.parse(input.doc.value);\r\n                self.client.select(input.url.value, doc, opts)\r\n                .then(function(response){\r\n                \tTerminusClient.FrameHelper.removeChildren(resd);\r\n                    var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n                });\r\n            }) // button click\r\n        break;\r\n        case 'update':\r\n            button.addEventListener(\"click\", function(){\r\n              var opts = {};\r\n              opts.key = input.key.value;\r\n              var doc = JSON.parse(input.doc.value);\r\n              self.client.update(input.url.value, doc, opts)\r\n              .then(function(response){\r\n            \t  TerminusClient.FrameHelper.removeChildren(resd);\r\n                  var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n              });\r\n            }) // button click\r\n        break;\r\n        default:\r\n            console.log('Invalid Api call on button');\r\n        break;\r\n    } // switch(action)\r\n    var br = document.createElement('BR');\r\n    form.appendChild(br);\r\n    var br = document.createElement('BR');\r\n    form.appendChild(br);\r\n    return form;\r\n} // getApiSendButton()\r\n\r\n// get signature of api calls\r\nApiExplorer.prototype.getSignature = function(action){\r\n    var api = document.createElement('div');\r\n    // get header signature\r\n    var sg = document.createElement('button');\r\n    sg.appendChild(document.createTextNode('Click to read API Signature'));\r\n    sg.setAttribute('class', 'terminus-collapsible');\r\n    ic = document.createElement('i');\r\n    ic.setAttribute('class', 'terminus-cheveron-float fa fa-chevron-down');\r\n    sg.appendChild(ic);\r\n    api.appendChild(sg);\r\n    var br = document.createElement('BR');\r\n    api.appendChild(br);\r\n    var cl = document.createElement('div');\r\n    cl.setAttribute('class', 'terminus-collapsible-content content');\r\n    var sig = UTILS.getFunctionSignature(action);\r\n    var txt = document.createTextNode(sig.spec);\r\n    var pre = document.createElement('pre');\r\n    pre.setAttribute('class', 'terminus-api-signature-pre');\r\n    pre.appendChild(txt);\r\n    var txt =  document.createTextNode(sig.descr);\r\n    pre.appendChild(txt);\r\n    var br = document.createElement('BR');\r\n    pre.appendChild(br);\r\n    var br = document.createElement('BR');\r\n    pre.appendChild(br);\r\n    var txt = document.createTextNode(sig.result);\r\n    pre.appendChild(txt);\r\n    cl.appendChild(pre);\r\n    api.appendChild(cl);\r\n    var br = document.createElement('BR');\r\n    api.appendChild(br);\r\n    sg.addEventListener('click', function(){\r\n        UTILS.tolggleContent(ic, cl);\r\n    });\r\n    return api;\r\n} // getSignature()\r\n\r\n// displays signature only on click\r\nfunction tolggleSignatureContent(content){\r\n    if (content.style.display === \"block\")\r\n        content.style.display = \"none\";\r\n    else content.style.display = \"block\";\r\n}\r\n\r\nmodule.exports=ApiExplorer\r\n","\r\nconst CONST = require('./const');\r\nconst DispatchRequest = require('./dispatchRequest');\r\nconst ErrorMessage = require('./errorMessage');\r\nconst ConnectionCapabilities = require('./connectionCapabilities');\r\nconst ConnectionConfig = require('./connectionConfig');\r\nconst UTILS = require('./utils.js');\r\n\r\n/**\r\n * @file Javascript WOQL client object\r\n * @license Apache Version 2\r\n * @summary Simple Javascript Client for accessing the Terminus DB API\r\n */\r\n\r\n/**\r\n  * @param {Object} params\r\n  */\r\nfunction WOQLClient(params) {\r\n\t// current connection context variables\r\n\tconst key = params ? params.key : undefined;\r\n\tthis.use_fetch = false;\r\n\tthis.return_full_response = false;\r\n\tthis.connectionConfig = new ConnectionConfig(params);\r\n\tthis.connection = new ConnectionCapabilities(this.connectionConfig, key);\r\n}\r\n\r\nWOQLClient.CONST = CONST;\r\n\r\n/**\r\n * Connect to a Terminus server at the given URI with an API key\r\n * Stores the terminus:ServerCapability document returned\r\n * in the connection register which stores, the url, key, capabilities,\r\n * and database meta-data for the connected server\r\n *\r\n * If the curl argument is false or null,\r\n * this.connectionConfig.server will be used if present,\r\n * or the promise will be rejected.\r\n\r\n * @param  {string} curl Terminus server URI\r\n * @param  {string} API  key\r\n * @return {Promise}\r\n * @public\r\n */\r\nWOQLClient.prototype.connect = function (curl, key) {\r\n\tif (curl && !this.connectionConfig.setServer(curl)) {\r\n\t\treturn Promise.reject(\r\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(curl, CONST.CONNECT))\r\n\t\t);\r\n\t}\r\n\tconst serverURL = this.connectionConfig.serverURL();\r\n\tif (key) {\r\n\t\tthis.connection.setClientKey(serverURL, key);\r\n\t}\r\n\t// unset the current server setting until successful connect\r\n\tthis.connectionConfig.server = false;\r\n\tconst self = this;\r\n\treturn this.dispatch(serverURL, CONST.CONNECT).then((response) => {\r\n\t\tself.connectionConfig.server = serverURL;\r\n\t\tself.connection.addConnection(serverURL, response);\r\n\t\treturn response;\r\n\t});\r\n};\r\n\r\n/**\r\n * Create a Terminus Database by posting\r\n * a terminus:Database document to the Terminus API\r\n *\r\n * The dburl argument can be\r\n *    1) a valid URL of a terminus database or\r\n *    2) a valid Terminus database id or\r\n *    3) can be omitted\r\n * \t\tin case 2) the current server will be used,\r\n * \t\tin case 3) the database id will be set from the @id field of the terminuse:Database document.\r\n *\r\n * The second (details) argument contains a terminus:Database document\r\n * with a mandatory rdfs:label field and an optional rdfs:comment field.\r\n * The third (key) argument contains an optional API key\r\n *\r\n * @param {string} dburl Terminus server URI or a TerminusID\r\n * @param {object} details\r\n * @param {string} key\r\n * @return {Promise}\r\n * @public\r\n */\r\nWOQLClient.prototype.createDatabase = function (dburl, details, key) {\r\n\tif (dburl && !this.connectionConfig.setDB(dburl)) {\r\n\t\treturn Promise.reject(\r\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(dburl, 'Create Database'))\r\n\t\t);\r\n\t}\r\n\tif (\r\n\t\tdetails\r\n    && details['@id']\r\n    && !this.connectionConfig.setDB(details['@id'], details['@context'])\r\n\t) {\r\n\t\treturn Promise.reject(\r\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(details['@id'], 'Create Database'))\r\n\t\t);\r\n\t}\r\n\tdetails = this.makeDocumentConsistentWithURL(details, this.connectionConfig.dbURL());\r\n\r\n\tconst opts = {};\r\n\tif (key) {\r\n\t\topts.key = key;\r\n\t}\r\n\tconst doc = this.addOptionsToDocument(details, opts);\r\n\treturn this.dispatch(this.connectionConfig.dbURL('create'), CONST.CREATE_DATABASE, doc);\r\n};\r\n\r\n/**\r\n * Delete a Database\r\n * @param {String} dburl it is a terminusDB Url or a terminusDB Id\r\n * @param {String} key an optional API key\r\n * @return {Promise}\r\n *\r\n * if dburl is omitted, the current server and database will be used\r\n */\r\nWOQLClient.prototype.deleteDatabase = function (dburl, key) {\r\n\tif (dburl && !this.connectionConfig.setDB(dburl)) {\r\n\t\treturn Promise.reject(\r\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(dburl, 'Delete Database'))\r\n\t\t);\r\n\t}\r\n\tconst opts = {};\r\n\r\n\tif (key) {\r\n\t\topts.key = key;\r\n\t}\r\n\r\n\tconst self = this;\r\n\treturn this.dispatch(`${this.connectionConfig.dbURL()}`, CONST.DELETE_DATABASE, opts).then(\r\n\t\t(response) => {\r\n\t\t\tself.connection.removeDB();\r\n\t\t\treturn response;\r\n\t\t}\r\n\t);\r\n};\r\n\r\n/**\r\n * Retrieves the schema of the specified database\r\n *\r\n * @param {string} schurl TerminusDB server URL or a valid TerminusDB Id or omitted\r\n * @param {object} opts is an options object\r\n * @return {Promise}\r\n *\r\n * opts.format is optional and defines which format is requested (*json / turtle)\r\n * opts.key is an optional API key\r\n */\r\nWOQLClient.prototype.getSchema = function (schurl, opts) {\r\n\tif (schurl && !this.connectionConfig.setSchemaURL(schurl)) {\r\n\t\treturn Promise.reject(\r\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(schurl, 'Get Schema'))\r\n\t\t);\r\n\t}\r\n\t// consoleco.log('schemaURL', this.connectionConfig.schemaURL());\r\n\treturn this.dispatch(this.connectionConfig.schemaURL(), CONST.GET_SCHEMA, opts);\r\n};\r\n\r\n/**\r\n * Updates the Schema of the specified database\r\n *\r\n * @param {string} schurl TerminusDB server URL or a valid TerminusDB Id or omitted\r\n * @param {object} doc is a valid owl ontology in json-ld or turtle format\r\n * @param {object} opts is an options object\r\n * @return {Promise}\r\n *\r\n * if omitted the current server and database will be used\r\n * opts.format is used to specify which format is being used (*json / turtle)\r\n * opts.key is an optional API key\r\n */\r\nWOQLClient.prototype.updateSchema = function (schurl, doc, opts) {\r\n\tif (schurl && !this.connectionConfig.setSchemaURL(schurl)) {\r\n\t\treturn Promise.reject(\r\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(schurl, 'Update Schema'))\r\n\t\t);\r\n\t}\r\n\tdoc = this.addOptionsToDocument(doc, opts);\r\n\treturn this.dispatch(this.connectionConfig.schemaURL(), 'update_schema', doc);\r\n};\r\n\r\n/**\r\n * Creates a new document in the specified database\r\n *\r\n * The first (docurl) argument can be\r\n * 1) a valid URL of a terminus database (an id will be randomly assigned) or\r\n * 2) a valid URL or of a terminus document (the document will be given the passed URL) or\r\n * 3) a valid terminus document id (the current server and database will be used)\r\n * 4) can be omitted (the URL will be taken from the document if present)\r\n * The second argument (doc) is a valid document in json-ld\r\n * the third argument (opts) is an options json - opts.key is an optional API key\r\n */\r\nWOQLClient.prototype.createDocument = function (docurl, doc, opts) {\r\n\tif (docurl && !this.connectionConfig.setDocument(docurl)) {\r\n\t\treturn Promise.reject(\r\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(docurl, 'Create Document'))\r\n\t\t);\r\n\t} if (\r\n\t\tdoc\r\n    && doc['@id']\r\n    && !this.connectionConfig.setDocument(doc['@id'], doc['@context'])\r\n\t) {\r\n\t\treturn Promise.reject(\r\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(doc['@id'], 'Create Document'))\r\n\t\t);\r\n\t}\r\n\tdoc = this.addOptionsToDocument(\r\n\t\tthis.makeDocumentConsistentWithURL(doc, this.connectionConfig.docURL()),\r\n\t\topts\r\n\t);\r\n\treturn this.dispatch(this.connectionConfig.docURL(), 'create_document', doc);\r\n};\r\n\r\n/**\r\n * Retrieves a document from the specified database\r\n *\r\n * The first (docurl) argument can be\r\n * 1) a valid URL of a terminus document or\r\n * 2) a valid ID of a terminus document in the current database\r\n * the second argument (opts) is an options json -\r\n * \t\topts.key is an optional API key\r\n * \t\topts.shape is frame | *document\r\n */\r\nWOQLClient.prototype.getDocument = function (docurl, opts) {\r\n\tif (docurl && (!this.connectionConfig.setDocument(docurl) || !this.connectionConfig.docid)) {\r\n\t\treturn Promise.reject(\r\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(docurl, 'Get Document'))\r\n\t\t);\r\n\t}\r\n\treturn this.dispatch(this.connectionConfig.docURL(), 'get_document', opts);\r\n};\r\n\r\n/**\r\n * Updates a document in the specified database with a new version\r\n *\r\n * The first (docurl) argument can be\r\n * 1) a valid URL of a terminus document or\r\n * 2) a valid ID of a terminus document in the current database or\r\n * 3) omitted in which case the id will be taken from the document @id field\r\n * the second argument (doc) is a document in json-ld format\r\n * the third argument (opts) is an options json - opts.key is an optional API key\r\n */\r\nWOQLClient.prototype.updateDocument = function (docurl, doc, opts) {\r\n\tif (docurl && !this.connectionConfig.setDocument(docurl)) {\r\n\t\treturn Promise.reject(\r\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(docurl, 'Update Document'))\r\n\t\t);\r\n\t}\r\n\tif (doc && doc['@id']\r\n    && !this.connectionConfig.setDocument(doc['@id'], doc['@context'])\r\n\t) {\r\n\t\treturn Promise.reject(\r\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(doc['@id'], 'Update Document'))\r\n\t\t);\r\n\t}\r\n\tdoc = this.addOptionsToDocument(\r\n\t\tthis.makeDocumentConsistentWithURL(doc, this.connectionConfig.docURL()),\r\n\t\topts\r\n\t);\r\n\treturn this.dispatch(this.connectionConfig.docURL(), 'update_document', doc);\r\n};\r\n\r\n/**\r\n * Deletes a document from the specified database\r\n *\r\n * The first (docurl) argument can be\r\n * 1) a valid URL of a terminus document or\r\n * 2) a valid ID of a terminus document in the current database\r\n * 3) omitted - the current document will be used\r\n * the second argument (opts) is an options json - opts.key is an optional API key\r\n */\r\nWOQLClient.prototype.deleteDocument = function (docurl, opts) {\r\n\tif (docurl && (!this.connectionConfig.setDocument(docurl) || !this.connectionConfig.docid)) {\r\n\t\treturn Promise.reject(\r\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(docurl, 'Delete Document'))\r\n\t\t);\r\n\t}\r\n\treturn this.dispatch(this.connectionConfig.docURL(), 'delete_document', opts);\r\n};\r\n\r\n/**\r\n * Executes a read-only WOQL query on the specified database and returns the results\r\n *\r\n * @param {string} qurl TerminusDB server URL or omitted (the current DB will be used)\r\n * @param {string} woql is a \"woql query select statement\"\r\n * @param {object} opts it can contents the API key (opts.key)\r\n *\r\n */\r\nWOQLClient.prototype.select = function (qurl, woql, opts) {\r\n\tif (qurl && !this.connectionConfig.setQueryURL(qurl)) {\r\n\t\treturn Promise.reject(\r\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(qurl, 'Select'))\r\n\t\t);\r\n\t}\r\n\tlet q = { 'terminus:query': JSON.stringify(woql) };\r\n\tq = this.addOptionsToWOQL(q, opts);\r\n\treturn this.dispatch(this.connectionConfig.queryURL(), CONST.WOQL_SELECT, q);\r\n};\r\n\r\n/**\r\n * Executes a WOQL query on the specified database which updates the state and returns the results\r\n *\r\n * The first (qurl) argument can be\r\n * 1) a valid URL of a terminus database or\r\n * 2) omitted - the current database will be used\r\n * the second argument (woql) is a woql select statement encoded as a string\r\n * the third argument (opts) is an options json - opts.key is an optional API key\r\n */\r\nWOQLClient.prototype.update = function (qurl, woql, opts) {\r\n\tif (qurl && !this.connectionConfig.setQueryURL(qurl)) {\r\n\t\treturn Promise.reject(\r\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(qurl, 'Update'))\r\n\t\t);\r\n\t}\r\n\twoql = this.addOptionsToWOQL(woql, opts);\r\n\treturn this.dispatch(this.connectionConfig.queryURL(), 'woql_update', woql);\r\n};\r\n\r\n/**\r\n * Retrieves a WOQL query on the specified database which updates the state and returns the results\r\n *\r\n * The first (cfurl) argument can be\r\n * 1) a valid URL of a terminus database or\r\n * 2) omitted - the current database will be used\r\n * the second argument (cls) is the URL / ID of a document class that exists in the database schema\r\n * the third argument (opts) is an options json - opts.key is an optional API key\r\n */\r\nWOQLClient.prototype.getClassFrame = function (cfurl, cls, opts) {\r\n\tif (cfurl && !this.connectionConfig.setClassFrameURL(cfurl)) {\r\n\t\treturn Promise.reject(\r\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(cfurl, 'Get Class Frame'))\r\n\t\t);\r\n\t}\r\n\tif (!opts) opts = {};\r\n\topts['terminus:class'] = cls;\r\n\treturn this.dispatch(this.connectionConfig.frameURL(), 'class_frame', opts);\r\n};\r\n\r\n/*\r\n * Utility functions for adding standard fields to API arguments\r\n */\r\nWOQLClient.prototype.addOptionsToWOQL = function (woql, opts) {\r\n\tif (opts && opts.key) {\r\n\t\twoql.key = opts.key;\r\n\t}\r\n\treturn woql;\r\n};\r\n\r\nWOQLClient.prototype.addOptionsToDocument = function (doc, opts) {\r\n\tconst pdoc = {};\r\n\tpdoc['@context'] = doc['@context'];\r\n\tif (pdoc['@context'] && doc['@id']) { // add blank node prefix as document base url\r\n\t\tpdoc['@context']._ = `${doc['@id']}/`;\r\n\t}\r\n\tif (opts && opts['terminus:encoding'] && opts['terminus:encoding'] === 'terminus:turtle') {\r\n\t\tpdoc['terminus:turtle'] = doc;\r\n\t\tpdoc['terminus:schema'] = this.connectionConfig.schemaURL();\r\n\t\tdelete pdoc['terminus:turtle']['@context'];\r\n\t} else {\r\n\t\tpdoc['terminus:document'] = doc;\r\n\t\tdelete pdoc['terminus:document']['@context'];\r\n\t}\r\n\tpdoc['@type'] = 'terminus:APIUpdate';\r\n\tif (opts && opts['terminus:user_key']) {\r\n\t\tpdoc['terminus:user_key'] = opts['terminus:user_key'];\r\n\t}\r\n\tif (opts && opts.key) {\r\n\t\tpdoc['terminus:user_key'] = opts.key;\r\n\t}\r\n\treturn pdoc;\r\n};\r\n\r\nWOQLClient.prototype.addKeyToPayload = function (payload, url) {\r\n\tif (typeof payload !== 'object')payload = {};\r\n\tif (payload.key) {\r\n\t\tpayload['terminus:user_key'] = payload.key;\r\n\t\tdelete payload.key;\r\n\t} else if (this.connection.getClientKey()) {\r\n\t\tpayload['terminus:user_key'] = this.connection.getClientKey();\r\n\t} else if (this.connection.getClientKey(url)) {\r\n\t\tpayload['terminus:user_key'] = this.connection.getClientKey(url);\r\n\t}\r\n\treturn payload;\r\n};\r\n\r\nWOQLClient.prototype.makeDocumentConsistentWithURL = function (doc, dburl) {\r\n\tdoc['@id'] = dburl;\r\n\treturn doc;\r\n};\r\n\r\nWOQLClient.prototype.dispatch = function (url, action, payload) {\r\n\tif (this.connectionConfig.includeKey()) {\r\n\t\tpayload = this.addKeyToPayload(payload, url);\r\n\t}\r\n\tif (this.use_fetch) {\r\n\t\treturn this.dispatchFetch(url, action, payload);\r\n\t}\r\n\treturn DispatchRequest(url, action, payload);\r\n};\r\n\r\n\r\nWOQLClient.prototype.dispatchFetch = function (url, action, payload) {\r\n\tconst api = {\r\n\t\t//mode: 'cors',  no-cors, cors, *same-origin\r\n\t\tredirect: 'follow', // manual, *follow, error\r\n\t\treferrer: 'client', // no-referrer, *client\r\n\t};\r\n\tlet hdrs = {};\r\n\tif (this.connectionConfig.platformEndpoint()) {\r\n\t\tapi.credentials = 'include'; // include, *same-origin, omit\r\n\t}\r\n\tif (payload && payload['terminus:user_key']) {\r\n\t\thdrs = { Authorization: `Basic ${btoa(`:${payload['terminus:user_key']}`)}` };\r\n\t\tdelete (payload['terminus:user_key']);\r\n\t}\r\n\t// read only API calls - use GET\r\n\tswitch (action) {\r\n\tcase CONST.DELETE_DATABASE:\r\n\tcase CONST.DELETE_DOCUMENT:\r\n\t\tif (Object.keys(payload).length > 0) url += `?${UTILS.URIEncodePayload(payload)}`;\r\n\t\tapi.method = 'DELETE';\r\n\t\tapi.cache = 'no-cache';\r\n\t\tbreak;\r\n\tcase CONST.CREATE_DATABASE:\r\n\tcase CONST.UPDATE_SCHEMA:\r\n\tcase CONST.CREATE_DOCUMENT:\r\n\tcase CONST.UPDATE_DOCUMENT:\r\n\tcase CONST.WOQL_UPDATE:\r\n\t\tapi.method = 'POST';\r\n\t\tapi.cache = 'no-cache';\r\n\t\thdrs['Content-Type'] = 'application/json';\r\n\t\tapi.body = JSON.stringify(payload);\r\n\t\tbreak;\r\n\tcase CONST.GET_SCHEMA:\r\n\tcase CONST.CONNECT:\r\n\tcase CONST.CLASS_FRAME:\r\n\tcase CONST.WOQL_SELECT:\r\n\tcase CONST.GET_DOCUMENT:\r\n\tdefault:\r\n\t\tapi.method = 'GET';\r\n\t\tif (Object.keys(payload).length > 0) url += `?${UTILS.URIEncodePayload(payload)}`;\r\n\t}\r\n\tconst self = this;\r\n\tif (Object.keys(hdrs).length > 0) {\r\n\t\tapi.headers = new Headers(hdrs);\r\n\t}\r\n\treturn fetch(url, api).then((response) => {\r\n\t\tif (self.return_full_response) return response;\r\n\t\tif (response.ok) {\r\n\t\t\treturn response.json();\r\n\t\t}\r\n\t\tself.error = self.parseAPIError(response);\r\n\t\treturn Promise.reject(new Error(self.getAPIErrorMessage(url, api, self.error)));\r\n\t});\r\n};\r\n\r\nmodule.exports = WOQLClient;\r\n","const axios = require('axios');\nconst UTILS = require('./utils.js');\nconst CONST = require('./const.js');\nconst ErrorMessage = require('./errorMessage');\n/*\nAccess-Control-Allow-Credentials   true\nAccess-Control-Allow-Headers  X-PINGOTHER, Content-Type\nAccess-Control-Allow-Methods GET, POST, PUT, PATCH, DELETE, HEAD, OPTIONS\nAccess-Control-Allow-Origin: http://localhost:3000 // WILD CARD WILL NOT WORK WHEN POSTING\n*/\n\nfunction btoaImplementation(str) {\n\ttry {\n\t\treturn btoa(str);\n\t} catch (err) {\n\t\t// console.log('in buffer')\n\t\treturn Buffer.from(str).toString('base64');\n\t}\n}\n\nfunction DispatchRequest(url, action, payload) {\n\t/*\n\t*CORS is only required when trying to fetch data from a browser,\n\t*as browsers by default will block requests to different origins\n\t*/\n\tconst options = {\n\t\tmode: 'cors', // no-cors, cors, *same-origin\n\t\tredirect: 'follow', // manual, *follow, error\n\t\treferrer: 'client',\n\t\t// url:url,\n\t\t// no-referrer, *client\n\t};\n\tif (payload && payload['terminus:user_key']) {\n\t\toptions.headers = { Authorization: `Basic ${btoaImplementation(`:${payload['terminus:user_key']}`)}` };\n\t\tdelete (payload['terminus:user_key']);\n\t}\n\n\tswitch (action) {\n\tcase CONST.DELETE_DATABASE:\n\tcase CONST.DELETE_DOCUMENT:\n\t\tif (payload) {\n\t\t\tconst ext = UTILS.URIEncodePayload(payload);\n\t\t\tif (ext) url += `?${ext}`;\n\t\t}\n\t\treturn axios.delete(url, options)\n\t\t\t.then(response => response.data)\n\t\t\t.catch((err) => {\n\t\t\t\tthrow new Error(ErrorMessage.getAPIErrorMessage(url, options, err));\n\t\t\t});\n\tcase CONST.CREATE_DATABASE:\n\tcase CONST.UPDATE_SCHEMA:\n\tcase CONST.CREATE_DOCUMENT:\n\tcase CONST.UPDATE_DOCUMENT:\n\tcase CONST.WOQL_UPDATE:\n\t\toptions.headers = options.headers ? options.headers : {};\n\t\toptions.headers['Content-Type'] = 'application/json';\n\t\treturn axios.post(url, JSON.stringify(payload), options)\n\t\t\t.then(response => response.data)\n\t\t\t.catch((err) => {\n\t\t\t\tconst e = new Error(ErrorMessage.getAPIErrorMessage(url, options, err));\n\t\t\t\tif (err.response && err.response.data) e.data = err.response.data;\n\t\t\t\tthrow e;\n\t\t\t});\n\tcase CONST.GET_SCHEMA:\n\tcase CONST.CONNECT:\n\tcase CONST.CLASS_FRAME:\n\tcase CONST.WOQL_SELECT:\n\tcase CONST.GET_DOCUMENT:\n\tdefault:\n\t\tif (payload) {\n\t\t\tconst ext = UTILS.URIEncodePayload(payload);\n\t\t\tif (ext) url += `?${ext}`;\n\t\t}\n\t\treturn axios.get(url, options)\n\t\t\t.then((response => response.data))\n\t\t\t.catch((err) => {\n\t\t\t\tthrow new Error(ErrorMessage.getAPIErrorMessage(url, options, err));\n\t\t\t});\n\t}\n}\n\nmodule.exports = DispatchRequest;\n","/*!\n * The buffer module from node.js, for the browser.\n *\n * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>\n * @license  MIT\n */\n/* eslint-disable no-proto */\n\n'use strict'\n\nvar base64 = require('base64-js')\nvar ieee754 = require('ieee754')\nvar isArray = require('isarray')\n\nexports.Buffer = Buffer\nexports.SlowBuffer = SlowBuffer\nexports.INSPECT_MAX_BYTES = 50\n\n/**\n * If `Buffer.TYPED_ARRAY_SUPPORT`:\n *   === true    Use Uint8Array implementation (fastest)\n *   === false   Use Object implementation (most compatible, even IE6)\n *\n * Browsers that support typed arrays are IE 10+, Firefox 4+, Chrome 7+, Safari 5.1+,\n * Opera 11.6+, iOS 4.2+.\n *\n * Due to various browser bugs, sometimes the Object implementation will be used even\n * when the browser supports typed arrays.\n *\n * Note:\n *\n *   - Firefox 4-29 lacks support for adding new properties to `Uint8Array` instances,\n *     See: https://bugzilla.mozilla.org/show_bug.cgi?id=695438.\n *\n *   - Chrome 9-10 is missing the `TypedArray.prototype.subarray` function.\n *\n *   - IE10 has a broken `TypedArray.prototype.subarray` function which returns arrays of\n *     incorrect length in some situations.\n\n * We detect these buggy browsers and set `Buffer.TYPED_ARRAY_SUPPORT` to `false` so they\n * get the Object implementation, which is slower but behaves correctly.\n */\nBuffer.TYPED_ARRAY_SUPPORT = global.TYPED_ARRAY_SUPPORT !== undefined\n  ? global.TYPED_ARRAY_SUPPORT\n  : typedArraySupport()\n\n/*\n * Export kMaxLength after typed array support is determined.\n */\nexports.kMaxLength = kMaxLength()\n\nfunction typedArraySupport () {\n  try {\n    var arr = new Uint8Array(1)\n    arr.__proto__ = {__proto__: Uint8Array.prototype, foo: function () { return 42 }}\n    return arr.foo() === 42 && // typed array instances can be augmented\n        typeof arr.subarray === 'function' && // chrome 9-10 lack `subarray`\n        arr.subarray(1, 1).byteLength === 0 // ie10 has broken `subarray`\n  } catch (e) {\n    return false\n  }\n}\n\nfunction kMaxLength () {\n  return Buffer.TYPED_ARRAY_SUPPORT\n    ? 0x7fffffff\n    : 0x3fffffff\n}\n\nfunction createBuffer (that, length) {\n  if (kMaxLength() < length) {\n    throw new RangeError('Invalid typed array length')\n  }\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    // Return an augmented `Uint8Array` instance, for best performance\n    that = new Uint8Array(length)\n    that.__proto__ = Buffer.prototype\n  } else {\n    // Fallback: Return an object instance of the Buffer class\n    if (that === null) {\n      that = new Buffer(length)\n    }\n    that.length = length\n  }\n\n  return that\n}\n\n/**\n * The Buffer constructor returns instances of `Uint8Array` that have their\n * prototype changed to `Buffer.prototype`. Furthermore, `Buffer` is a subclass of\n * `Uint8Array`, so the returned instances will have all the node `Buffer` methods\n * and the `Uint8Array` methods. Square bracket notation works as expected -- it\n * returns a single octet.\n *\n * The `Uint8Array` prototype remains unmodified.\n */\n\nfunction Buffer (arg, encodingOrOffset, length) {\n  if (!Buffer.TYPED_ARRAY_SUPPORT && !(this instanceof Buffer)) {\n    return new Buffer(arg, encodingOrOffset, length)\n  }\n\n  // Common case.\n  if (typeof arg === 'number') {\n    if (typeof encodingOrOffset === 'string') {\n      throw new Error(\n        'If encoding is specified then the first argument must be a string'\n      )\n    }\n    return allocUnsafe(this, arg)\n  }\n  return from(this, arg, encodingOrOffset, length)\n}\n\nBuffer.poolSize = 8192 // not used by this implementation\n\n// TODO: Legacy, not needed anymore. Remove in next major version.\nBuffer._augment = function (arr) {\n  arr.__proto__ = Buffer.prototype\n  return arr\n}\n\nfunction from (that, value, encodingOrOffset, length) {\n  if (typeof value === 'number') {\n    throw new TypeError('\"value\" argument must not be a number')\n  }\n\n  if (typeof ArrayBuffer !== 'undefined' && value instanceof ArrayBuffer) {\n    return fromArrayBuffer(that, value, encodingOrOffset, length)\n  }\n\n  if (typeof value === 'string') {\n    return fromString(that, value, encodingOrOffset)\n  }\n\n  return fromObject(that, value)\n}\n\n/**\n * Functionally equivalent to Buffer(arg, encoding) but throws a TypeError\n * if value is a number.\n * Buffer.from(str[, encoding])\n * Buffer.from(array)\n * Buffer.from(buffer)\n * Buffer.from(arrayBuffer[, byteOffset[, length]])\n **/\nBuffer.from = function (value, encodingOrOffset, length) {\n  return from(null, value, encodingOrOffset, length)\n}\n\nif (Buffer.TYPED_ARRAY_SUPPORT) {\n  Buffer.prototype.__proto__ = Uint8Array.prototype\n  Buffer.__proto__ = Uint8Array\n  if (typeof Symbol !== 'undefined' && Symbol.species &&\n      Buffer[Symbol.species] === Buffer) {\n    // Fix subarray() in ES2016. See: https://github.com/feross/buffer/pull/97\n    Object.defineProperty(Buffer, Symbol.species, {\n      value: null,\n      configurable: true\n    })\n  }\n}\n\nfunction assertSize (size) {\n  if (typeof size !== 'number') {\n    throw new TypeError('\"size\" argument must be a number')\n  } else if (size < 0) {\n    throw new RangeError('\"size\" argument must not be negative')\n  }\n}\n\nfunction alloc (that, size, fill, encoding) {\n  assertSize(size)\n  if (size <= 0) {\n    return createBuffer(that, size)\n  }\n  if (fill !== undefined) {\n    // Only pay attention to encoding if it's a string. This\n    // prevents accidentally sending in a number that would\n    // be interpretted as a start offset.\n    return typeof encoding === 'string'\n      ? createBuffer(that, size).fill(fill, encoding)\n      : createBuffer(that, size).fill(fill)\n  }\n  return createBuffer(that, size)\n}\n\n/**\n * Creates a new filled Buffer instance.\n * alloc(size[, fill[, encoding]])\n **/\nBuffer.alloc = function (size, fill, encoding) {\n  return alloc(null, size, fill, encoding)\n}\n\nfunction allocUnsafe (that, size) {\n  assertSize(size)\n  that = createBuffer(that, size < 0 ? 0 : checked(size) | 0)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) {\n    for (var i = 0; i < size; ++i) {\n      that[i] = 0\n    }\n  }\n  return that\n}\n\n/**\n * Equivalent to Buffer(num), by default creates a non-zero-filled Buffer instance.\n * */\nBuffer.allocUnsafe = function (size) {\n  return allocUnsafe(null, size)\n}\n/**\n * Equivalent to SlowBuffer(num), by default creates a non-zero-filled Buffer instance.\n */\nBuffer.allocUnsafeSlow = function (size) {\n  return allocUnsafe(null, size)\n}\n\nfunction fromString (that, string, encoding) {\n  if (typeof encoding !== 'string' || encoding === '') {\n    encoding = 'utf8'\n  }\n\n  if (!Buffer.isEncoding(encoding)) {\n    throw new TypeError('\"encoding\" must be a valid string encoding')\n  }\n\n  var length = byteLength(string, encoding) | 0\n  that = createBuffer(that, length)\n\n  var actual = that.write(string, encoding)\n\n  if (actual !== length) {\n    // Writing a hex string, for example, that contains invalid characters will\n    // cause everything after the first invalid character to be ignored. (e.g.\n    // 'abxxcd' will be treated as 'ab')\n    that = that.slice(0, actual)\n  }\n\n  return that\n}\n\nfunction fromArrayLike (that, array) {\n  var length = array.length < 0 ? 0 : checked(array.length) | 0\n  that = createBuffer(that, length)\n  for (var i = 0; i < length; i += 1) {\n    that[i] = array[i] & 255\n  }\n  return that\n}\n\nfunction fromArrayBuffer (that, array, byteOffset, length) {\n  array.byteLength // this throws if `array` is not a valid ArrayBuffer\n\n  if (byteOffset < 0 || array.byteLength < byteOffset) {\n    throw new RangeError('\\'offset\\' is out of bounds')\n  }\n\n  if (array.byteLength < byteOffset + (length || 0)) {\n    throw new RangeError('\\'length\\' is out of bounds')\n  }\n\n  if (byteOffset === undefined && length === undefined) {\n    array = new Uint8Array(array)\n  } else if (length === undefined) {\n    array = new Uint8Array(array, byteOffset)\n  } else {\n    array = new Uint8Array(array, byteOffset, length)\n  }\n\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    // Return an augmented `Uint8Array` instance, for best performance\n    that = array\n    that.__proto__ = Buffer.prototype\n  } else {\n    // Fallback: Return an object instance of the Buffer class\n    that = fromArrayLike(that, array)\n  }\n  return that\n}\n\nfunction fromObject (that, obj) {\n  if (Buffer.isBuffer(obj)) {\n    var len = checked(obj.length) | 0\n    that = createBuffer(that, len)\n\n    if (that.length === 0) {\n      return that\n    }\n\n    obj.copy(that, 0, 0, len)\n    return that\n  }\n\n  if (obj) {\n    if ((typeof ArrayBuffer !== 'undefined' &&\n        obj.buffer instanceof ArrayBuffer) || 'length' in obj) {\n      if (typeof obj.length !== 'number' || isnan(obj.length)) {\n        return createBuffer(that, 0)\n      }\n      return fromArrayLike(that, obj)\n    }\n\n    if (obj.type === 'Buffer' && isArray(obj.data)) {\n      return fromArrayLike(that, obj.data)\n    }\n  }\n\n  throw new TypeError('First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.')\n}\n\nfunction checked (length) {\n  // Note: cannot use `length < kMaxLength()` here because that fails when\n  // length is NaN (which is otherwise coerced to zero.)\n  if (length >= kMaxLength()) {\n    throw new RangeError('Attempt to allocate Buffer larger than maximum ' +\n                         'size: 0x' + kMaxLength().toString(16) + ' bytes')\n  }\n  return length | 0\n}\n\nfunction SlowBuffer (length) {\n  if (+length != length) { // eslint-disable-line eqeqeq\n    length = 0\n  }\n  return Buffer.alloc(+length)\n}\n\nBuffer.isBuffer = function isBuffer (b) {\n  return !!(b != null && b._isBuffer)\n}\n\nBuffer.compare = function compare (a, b) {\n  if (!Buffer.isBuffer(a) || !Buffer.isBuffer(b)) {\n    throw new TypeError('Arguments must be Buffers')\n  }\n\n  if (a === b) return 0\n\n  var x = a.length\n  var y = b.length\n\n  for (var i = 0, len = Math.min(x, y); i < len; ++i) {\n    if (a[i] !== b[i]) {\n      x = a[i]\n      y = b[i]\n      break\n    }\n  }\n\n  if (x < y) return -1\n  if (y < x) return 1\n  return 0\n}\n\nBuffer.isEncoding = function isEncoding (encoding) {\n  switch (String(encoding).toLowerCase()) {\n    case 'hex':\n    case 'utf8':\n    case 'utf-8':\n    case 'ascii':\n    case 'latin1':\n    case 'binary':\n    case 'base64':\n    case 'ucs2':\n    case 'ucs-2':\n    case 'utf16le':\n    case 'utf-16le':\n      return true\n    default:\n      return false\n  }\n}\n\nBuffer.concat = function concat (list, length) {\n  if (!isArray(list)) {\n    throw new TypeError('\"list\" argument must be an Array of Buffers')\n  }\n\n  if (list.length === 0) {\n    return Buffer.alloc(0)\n  }\n\n  var i\n  if (length === undefined) {\n    length = 0\n    for (i = 0; i < list.length; ++i) {\n      length += list[i].length\n    }\n  }\n\n  var buffer = Buffer.allocUnsafe(length)\n  var pos = 0\n  for (i = 0; i < list.length; ++i) {\n    var buf = list[i]\n    if (!Buffer.isBuffer(buf)) {\n      throw new TypeError('\"list\" argument must be an Array of Buffers')\n    }\n    buf.copy(buffer, pos)\n    pos += buf.length\n  }\n  return buffer\n}\n\nfunction byteLength (string, encoding) {\n  if (Buffer.isBuffer(string)) {\n    return string.length\n  }\n  if (typeof ArrayBuffer !== 'undefined' && typeof ArrayBuffer.isView === 'function' &&\n      (ArrayBuffer.isView(string) || string instanceof ArrayBuffer)) {\n    return string.byteLength\n  }\n  if (typeof string !== 'string') {\n    string = '' + string\n  }\n\n  var len = string.length\n  if (len === 0) return 0\n\n  // Use a for loop to avoid recursion\n  var loweredCase = false\n  for (;;) {\n    switch (encoding) {\n      case 'ascii':\n      case 'latin1':\n      case 'binary':\n        return len\n      case 'utf8':\n      case 'utf-8':\n      case undefined:\n        return utf8ToBytes(string).length\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return len * 2\n      case 'hex':\n        return len >>> 1\n      case 'base64':\n        return base64ToBytes(string).length\n      default:\n        if (loweredCase) return utf8ToBytes(string).length // assume utf8\n        encoding = ('' + encoding).toLowerCase()\n        loweredCase = true\n    }\n  }\n}\nBuffer.byteLength = byteLength\n\nfunction slowToString (encoding, start, end) {\n  var loweredCase = false\n\n  // No need to verify that \"this.length <= MAX_UINT32\" since it's a read-only\n  // property of a typed array.\n\n  // This behaves neither like String nor Uint8Array in that we set start/end\n  // to their upper/lower bounds if the value passed is out of range.\n  // undefined is handled specially as per ECMA-262 6th Edition,\n  // Section 13.3.3.7 Runtime Semantics: KeyedBindingInitialization.\n  if (start === undefined || start < 0) {\n    start = 0\n  }\n  // Return early if start > this.length. Done here to prevent potential uint32\n  // coercion fail below.\n  if (start > this.length) {\n    return ''\n  }\n\n  if (end === undefined || end > this.length) {\n    end = this.length\n  }\n\n  if (end <= 0) {\n    return ''\n  }\n\n  // Force coersion to uint32. This will also coerce falsey/NaN values to 0.\n  end >>>= 0\n  start >>>= 0\n\n  if (end <= start) {\n    return ''\n  }\n\n  if (!encoding) encoding = 'utf8'\n\n  while (true) {\n    switch (encoding) {\n      case 'hex':\n        return hexSlice(this, start, end)\n\n      case 'utf8':\n      case 'utf-8':\n        return utf8Slice(this, start, end)\n\n      case 'ascii':\n        return asciiSlice(this, start, end)\n\n      case 'latin1':\n      case 'binary':\n        return latin1Slice(this, start, end)\n\n      case 'base64':\n        return base64Slice(this, start, end)\n\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return utf16leSlice(this, start, end)\n\n      default:\n        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)\n        encoding = (encoding + '').toLowerCase()\n        loweredCase = true\n    }\n  }\n}\n\n// The property is used by `Buffer.isBuffer` and `is-buffer` (in Safari 5-7) to detect\n// Buffer instances.\nBuffer.prototype._isBuffer = true\n\nfunction swap (b, n, m) {\n  var i = b[n]\n  b[n] = b[m]\n  b[m] = i\n}\n\nBuffer.prototype.swap16 = function swap16 () {\n  var len = this.length\n  if (len % 2 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 16-bits')\n  }\n  for (var i = 0; i < len; i += 2) {\n    swap(this, i, i + 1)\n  }\n  return this\n}\n\nBuffer.prototype.swap32 = function swap32 () {\n  var len = this.length\n  if (len % 4 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 32-bits')\n  }\n  for (var i = 0; i < len; i += 4) {\n    swap(this, i, i + 3)\n    swap(this, i + 1, i + 2)\n  }\n  return this\n}\n\nBuffer.prototype.swap64 = function swap64 () {\n  var len = this.length\n  if (len % 8 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 64-bits')\n  }\n  for (var i = 0; i < len; i += 8) {\n    swap(this, i, i + 7)\n    swap(this, i + 1, i + 6)\n    swap(this, i + 2, i + 5)\n    swap(this, i + 3, i + 4)\n  }\n  return this\n}\n\nBuffer.prototype.toString = function toString () {\n  var length = this.length | 0\n  if (length === 0) return ''\n  if (arguments.length === 0) return utf8Slice(this, 0, length)\n  return slowToString.apply(this, arguments)\n}\n\nBuffer.prototype.equals = function equals (b) {\n  if (!Buffer.isBuffer(b)) throw new TypeError('Argument must be a Buffer')\n  if (this === b) return true\n  return Buffer.compare(this, b) === 0\n}\n\nBuffer.prototype.inspect = function inspect () {\n  var str = ''\n  var max = exports.INSPECT_MAX_BYTES\n  if (this.length > 0) {\n    str = this.toString('hex', 0, max).match(/.{2}/g).join(' ')\n    if (this.length > max) str += ' ... '\n  }\n  return '<Buffer ' + str + '>'\n}\n\nBuffer.prototype.compare = function compare (target, start, end, thisStart, thisEnd) {\n  if (!Buffer.isBuffer(target)) {\n    throw new TypeError('Argument must be a Buffer')\n  }\n\n  if (start === undefined) {\n    start = 0\n  }\n  if (end === undefined) {\n    end = target ? target.length : 0\n  }\n  if (thisStart === undefined) {\n    thisStart = 0\n  }\n  if (thisEnd === undefined) {\n    thisEnd = this.length\n  }\n\n  if (start < 0 || end > target.length || thisStart < 0 || thisEnd > this.length) {\n    throw new RangeError('out of range index')\n  }\n\n  if (thisStart >= thisEnd && start >= end) {\n    return 0\n  }\n  if (thisStart >= thisEnd) {\n    return -1\n  }\n  if (start >= end) {\n    return 1\n  }\n\n  start >>>= 0\n  end >>>= 0\n  thisStart >>>= 0\n  thisEnd >>>= 0\n\n  if (this === target) return 0\n\n  var x = thisEnd - thisStart\n  var y = end - start\n  var len = Math.min(x, y)\n\n  var thisCopy = this.slice(thisStart, thisEnd)\n  var targetCopy = target.slice(start, end)\n\n  for (var i = 0; i < len; ++i) {\n    if (thisCopy[i] !== targetCopy[i]) {\n      x = thisCopy[i]\n      y = targetCopy[i]\n      break\n    }\n  }\n\n  if (x < y) return -1\n  if (y < x) return 1\n  return 0\n}\n\n// Finds either the first index of `val` in `buffer` at offset >= `byteOffset`,\n// OR the last index of `val` in `buffer` at offset <= `byteOffset`.\n//\n// Arguments:\n// - buffer - a Buffer to search\n// - val - a string, Buffer, or number\n// - byteOffset - an index into `buffer`; will be clamped to an int32\n// - encoding - an optional encoding, relevant is val is a string\n// - dir - true for indexOf, false for lastIndexOf\nfunction bidirectionalIndexOf (buffer, val, byteOffset, encoding, dir) {\n  // Empty buffer means no match\n  if (buffer.length === 0) return -1\n\n  // Normalize byteOffset\n  if (typeof byteOffset === 'string') {\n    encoding = byteOffset\n    byteOffset = 0\n  } else if (byteOffset > 0x7fffffff) {\n    byteOffset = 0x7fffffff\n  } else if (byteOffset < -0x80000000) {\n    byteOffset = -0x80000000\n  }\n  byteOffset = +byteOffset  // Coerce to Number.\n  if (isNaN(byteOffset)) {\n    // byteOffset: it it's undefined, null, NaN, \"foo\", etc, search whole buffer\n    byteOffset = dir ? 0 : (buffer.length - 1)\n  }\n\n  // Normalize byteOffset: negative offsets start from the end of the buffer\n  if (byteOffset < 0) byteOffset = buffer.length + byteOffset\n  if (byteOffset >= buffer.length) {\n    if (dir) return -1\n    else byteOffset = buffer.length - 1\n  } else if (byteOffset < 0) {\n    if (dir) byteOffset = 0\n    else return -1\n  }\n\n  // Normalize val\n  if (typeof val === 'string') {\n    val = Buffer.from(val, encoding)\n  }\n\n  // Finally, search either indexOf (if dir is true) or lastIndexOf\n  if (Buffer.isBuffer(val)) {\n    // Special case: looking for empty string/buffer always fails\n    if (val.length === 0) {\n      return -1\n    }\n    return arrayIndexOf(buffer, val, byteOffset, encoding, dir)\n  } else if (typeof val === 'number') {\n    val = val & 0xFF // Search for a byte value [0-255]\n    if (Buffer.TYPED_ARRAY_SUPPORT &&\n        typeof Uint8Array.prototype.indexOf === 'function') {\n      if (dir) {\n        return Uint8Array.prototype.indexOf.call(buffer, val, byteOffset)\n      } else {\n        return Uint8Array.prototype.lastIndexOf.call(buffer, val, byteOffset)\n      }\n    }\n    return arrayIndexOf(buffer, [ val ], byteOffset, encoding, dir)\n  }\n\n  throw new TypeError('val must be string, number or Buffer')\n}\n\nfunction arrayIndexOf (arr, val, byteOffset, encoding, dir) {\n  var indexSize = 1\n  var arrLength = arr.length\n  var valLength = val.length\n\n  if (encoding !== undefined) {\n    encoding = String(encoding).toLowerCase()\n    if (encoding === 'ucs2' || encoding === 'ucs-2' ||\n        encoding === 'utf16le' || encoding === 'utf-16le') {\n      if (arr.length < 2 || val.length < 2) {\n        return -1\n      }\n      indexSize = 2\n      arrLength /= 2\n      valLength /= 2\n      byteOffset /= 2\n    }\n  }\n\n  function read (buf, i) {\n    if (indexSize === 1) {\n      return buf[i]\n    } else {\n      return buf.readUInt16BE(i * indexSize)\n    }\n  }\n\n  var i\n  if (dir) {\n    var foundIndex = -1\n    for (i = byteOffset; i < arrLength; i++) {\n      if (read(arr, i) === read(val, foundIndex === -1 ? 0 : i - foundIndex)) {\n        if (foundIndex === -1) foundIndex = i\n        if (i - foundIndex + 1 === valLength) return foundIndex * indexSize\n      } else {\n        if (foundIndex !== -1) i -= i - foundIndex\n        foundIndex = -1\n      }\n    }\n  } else {\n    if (byteOffset + valLength > arrLength) byteOffset = arrLength - valLength\n    for (i = byteOffset; i >= 0; i--) {\n      var found = true\n      for (var j = 0; j < valLength; j++) {\n        if (read(arr, i + j) !== read(val, j)) {\n          found = false\n          break\n        }\n      }\n      if (found) return i\n    }\n  }\n\n  return -1\n}\n\nBuffer.prototype.includes = function includes (val, byteOffset, encoding) {\n  return this.indexOf(val, byteOffset, encoding) !== -1\n}\n\nBuffer.prototype.indexOf = function indexOf (val, byteOffset, encoding) {\n  return bidirectionalIndexOf(this, val, byteOffset, encoding, true)\n}\n\nBuffer.prototype.lastIndexOf = function lastIndexOf (val, byteOffset, encoding) {\n  return bidirectionalIndexOf(this, val, byteOffset, encoding, false)\n}\n\nfunction hexWrite (buf, string, offset, length) {\n  offset = Number(offset) || 0\n  var remaining = buf.length - offset\n  if (!length) {\n    length = remaining\n  } else {\n    length = Number(length)\n    if (length > remaining) {\n      length = remaining\n    }\n  }\n\n  // must be an even number of digits\n  var strLen = string.length\n  if (strLen % 2 !== 0) throw new TypeError('Invalid hex string')\n\n  if (length > strLen / 2) {\n    length = strLen / 2\n  }\n  for (var i = 0; i < length; ++i) {\n    var parsed = parseInt(string.substr(i * 2, 2), 16)\n    if (isNaN(parsed)) return i\n    buf[offset + i] = parsed\n  }\n  return i\n}\n\nfunction utf8Write (buf, string, offset, length) {\n  return blitBuffer(utf8ToBytes(string, buf.length - offset), buf, offset, length)\n}\n\nfunction asciiWrite (buf, string, offset, length) {\n  return blitBuffer(asciiToBytes(string), buf, offset, length)\n}\n\nfunction latin1Write (buf, string, offset, length) {\n  return asciiWrite(buf, string, offset, length)\n}\n\nfunction base64Write (buf, string, offset, length) {\n  return blitBuffer(base64ToBytes(string), buf, offset, length)\n}\n\nfunction ucs2Write (buf, string, offset, length) {\n  return blitBuffer(utf16leToBytes(string, buf.length - offset), buf, offset, length)\n}\n\nBuffer.prototype.write = function write (string, offset, length, encoding) {\n  // Buffer#write(string)\n  if (offset === undefined) {\n    encoding = 'utf8'\n    length = this.length\n    offset = 0\n  // Buffer#write(string, encoding)\n  } else if (length === undefined && typeof offset === 'string') {\n    encoding = offset\n    length = this.length\n    offset = 0\n  // Buffer#write(string, offset[, length][, encoding])\n  } else if (isFinite(offset)) {\n    offset = offset | 0\n    if (isFinite(length)) {\n      length = length | 0\n      if (encoding === undefined) encoding = 'utf8'\n    } else {\n      encoding = length\n      length = undefined\n    }\n  // legacy write(string, encoding, offset, length) - remove in v0.13\n  } else {\n    throw new Error(\n      'Buffer.write(string, encoding, offset[, length]) is no longer supported'\n    )\n  }\n\n  var remaining = this.length - offset\n  if (length === undefined || length > remaining) length = remaining\n\n  if ((string.length > 0 && (length < 0 || offset < 0)) || offset > this.length) {\n    throw new RangeError('Attempt to write outside buffer bounds')\n  }\n\n  if (!encoding) encoding = 'utf8'\n\n  var loweredCase = false\n  for (;;) {\n    switch (encoding) {\n      case 'hex':\n        return hexWrite(this, string, offset, length)\n\n      case 'utf8':\n      case 'utf-8':\n        return utf8Write(this, string, offset, length)\n\n      case 'ascii':\n        return asciiWrite(this, string, offset, length)\n\n      case 'latin1':\n      case 'binary':\n        return latin1Write(this, string, offset, length)\n\n      case 'base64':\n        // Warning: maxLength not taken into account in base64Write\n        return base64Write(this, string, offset, length)\n\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return ucs2Write(this, string, offset, length)\n\n      default:\n        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)\n        encoding = ('' + encoding).toLowerCase()\n        loweredCase = true\n    }\n  }\n}\n\nBuffer.prototype.toJSON = function toJSON () {\n  return {\n    type: 'Buffer',\n    data: Array.prototype.slice.call(this._arr || this, 0)\n  }\n}\n\nfunction base64Slice (buf, start, end) {\n  if (start === 0 && end === buf.length) {\n    return base64.fromByteArray(buf)\n  } else {\n    return base64.fromByteArray(buf.slice(start, end))\n  }\n}\n\nfunction utf8Slice (buf, start, end) {\n  end = Math.min(buf.length, end)\n  var res = []\n\n  var i = start\n  while (i < end) {\n    var firstByte = buf[i]\n    var codePoint = null\n    var bytesPerSequence = (firstByte > 0xEF) ? 4\n      : (firstByte > 0xDF) ? 3\n      : (firstByte > 0xBF) ? 2\n      : 1\n\n    if (i + bytesPerSequence <= end) {\n      var secondByte, thirdByte, fourthByte, tempCodePoint\n\n      switch (bytesPerSequence) {\n        case 1:\n          if (firstByte < 0x80) {\n            codePoint = firstByte\n          }\n          break\n        case 2:\n          secondByte = buf[i + 1]\n          if ((secondByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0x1F) << 0x6 | (secondByte & 0x3F)\n            if (tempCodePoint > 0x7F) {\n              codePoint = tempCodePoint\n            }\n          }\n          break\n        case 3:\n          secondByte = buf[i + 1]\n          thirdByte = buf[i + 2]\n          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0xF) << 0xC | (secondByte & 0x3F) << 0x6 | (thirdByte & 0x3F)\n            if (tempCodePoint > 0x7FF && (tempCodePoint < 0xD800 || tempCodePoint > 0xDFFF)) {\n              codePoint = tempCodePoint\n            }\n          }\n          break\n        case 4:\n          secondByte = buf[i + 1]\n          thirdByte = buf[i + 2]\n          fourthByte = buf[i + 3]\n          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80 && (fourthByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0xF) << 0x12 | (secondByte & 0x3F) << 0xC | (thirdByte & 0x3F) << 0x6 | (fourthByte & 0x3F)\n            if (tempCodePoint > 0xFFFF && tempCodePoint < 0x110000) {\n              codePoint = tempCodePoint\n            }\n          }\n      }\n    }\n\n    if (codePoint === null) {\n      // we did not generate a valid codePoint so insert a\n      // replacement char (U+FFFD) and advance only 1 byte\n      codePoint = 0xFFFD\n      bytesPerSequence = 1\n    } else if (codePoint > 0xFFFF) {\n      // encode to utf16 (surrogate pair dance)\n      codePoint -= 0x10000\n      res.push(codePoint >>> 10 & 0x3FF | 0xD800)\n      codePoint = 0xDC00 | codePoint & 0x3FF\n    }\n\n    res.push(codePoint)\n    i += bytesPerSequence\n  }\n\n  return decodeCodePointsArray(res)\n}\n\n// Based on http://stackoverflow.com/a/22747272/680742, the browser with\n// the lowest limit is Chrome, with 0x10000 args.\n// We go 1 magnitude less, for safety\nvar MAX_ARGUMENTS_LENGTH = 0x1000\n\nfunction decodeCodePointsArray (codePoints) {\n  var len = codePoints.length\n  if (len <= MAX_ARGUMENTS_LENGTH) {\n    return String.fromCharCode.apply(String, codePoints) // avoid extra slice()\n  }\n\n  // Decode in chunks to avoid \"call stack size exceeded\".\n  var res = ''\n  var i = 0\n  while (i < len) {\n    res += String.fromCharCode.apply(\n      String,\n      codePoints.slice(i, i += MAX_ARGUMENTS_LENGTH)\n    )\n  }\n  return res\n}\n\nfunction asciiSlice (buf, start, end) {\n  var ret = ''\n  end = Math.min(buf.length, end)\n\n  for (var i = start; i < end; ++i) {\n    ret += String.fromCharCode(buf[i] & 0x7F)\n  }\n  return ret\n}\n\nfunction latin1Slice (buf, start, end) {\n  var ret = ''\n  end = Math.min(buf.length, end)\n\n  for (var i = start; i < end; ++i) {\n    ret += String.fromCharCode(buf[i])\n  }\n  return ret\n}\n\nfunction hexSlice (buf, start, end) {\n  var len = buf.length\n\n  if (!start || start < 0) start = 0\n  if (!end || end < 0 || end > len) end = len\n\n  var out = ''\n  for (var i = start; i < end; ++i) {\n    out += toHex(buf[i])\n  }\n  return out\n}\n\nfunction utf16leSlice (buf, start, end) {\n  var bytes = buf.slice(start, end)\n  var res = ''\n  for (var i = 0; i < bytes.length; i += 2) {\n    res += String.fromCharCode(bytes[i] + bytes[i + 1] * 256)\n  }\n  return res\n}\n\nBuffer.prototype.slice = function slice (start, end) {\n  var len = this.length\n  start = ~~start\n  end = end === undefined ? len : ~~end\n\n  if (start < 0) {\n    start += len\n    if (start < 0) start = 0\n  } else if (start > len) {\n    start = len\n  }\n\n  if (end < 0) {\n    end += len\n    if (end < 0) end = 0\n  } else if (end > len) {\n    end = len\n  }\n\n  if (end < start) end = start\n\n  var newBuf\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    newBuf = this.subarray(start, end)\n    newBuf.__proto__ = Buffer.prototype\n  } else {\n    var sliceLen = end - start\n    newBuf = new Buffer(sliceLen, undefined)\n    for (var i = 0; i < sliceLen; ++i) {\n      newBuf[i] = this[i + start]\n    }\n  }\n\n  return newBuf\n}\n\n/*\n * Need to make sure that buffer isn't trying to write out of bounds.\n */\nfunction checkOffset (offset, ext, length) {\n  if ((offset % 1) !== 0 || offset < 0) throw new RangeError('offset is not uint')\n  if (offset + ext > length) throw new RangeError('Trying to access beyond buffer length')\n}\n\nBuffer.prototype.readUIntLE = function readUIntLE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var val = this[offset]\n  var mul = 1\n  var i = 0\n  while (++i < byteLength && (mul *= 0x100)) {\n    val += this[offset + i] * mul\n  }\n\n  return val\n}\n\nBuffer.prototype.readUIntBE = function readUIntBE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    checkOffset(offset, byteLength, this.length)\n  }\n\n  var val = this[offset + --byteLength]\n  var mul = 1\n  while (byteLength > 0 && (mul *= 0x100)) {\n    val += this[offset + --byteLength] * mul\n  }\n\n  return val\n}\n\nBuffer.prototype.readUInt8 = function readUInt8 (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 1, this.length)\n  return this[offset]\n}\n\nBuffer.prototype.readUInt16LE = function readUInt16LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  return this[offset] | (this[offset + 1] << 8)\n}\n\nBuffer.prototype.readUInt16BE = function readUInt16BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  return (this[offset] << 8) | this[offset + 1]\n}\n\nBuffer.prototype.readUInt32LE = function readUInt32LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return ((this[offset]) |\n      (this[offset + 1] << 8) |\n      (this[offset + 2] << 16)) +\n      (this[offset + 3] * 0x1000000)\n}\n\nBuffer.prototype.readUInt32BE = function readUInt32BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset] * 0x1000000) +\n    ((this[offset + 1] << 16) |\n    (this[offset + 2] << 8) |\n    this[offset + 3])\n}\n\nBuffer.prototype.readIntLE = function readIntLE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var val = this[offset]\n  var mul = 1\n  var i = 0\n  while (++i < byteLength && (mul *= 0x100)) {\n    val += this[offset + i] * mul\n  }\n  mul *= 0x80\n\n  if (val >= mul) val -= Math.pow(2, 8 * byteLength)\n\n  return val\n}\n\nBuffer.prototype.readIntBE = function readIntBE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var i = byteLength\n  var mul = 1\n  var val = this[offset + --i]\n  while (i > 0 && (mul *= 0x100)) {\n    val += this[offset + --i] * mul\n  }\n  mul *= 0x80\n\n  if (val >= mul) val -= Math.pow(2, 8 * byteLength)\n\n  return val\n}\n\nBuffer.prototype.readInt8 = function readInt8 (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 1, this.length)\n  if (!(this[offset] & 0x80)) return (this[offset])\n  return ((0xff - this[offset] + 1) * -1)\n}\n\nBuffer.prototype.readInt16LE = function readInt16LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  var val = this[offset] | (this[offset + 1] << 8)\n  return (val & 0x8000) ? val | 0xFFFF0000 : val\n}\n\nBuffer.prototype.readInt16BE = function readInt16BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  var val = this[offset + 1] | (this[offset] << 8)\n  return (val & 0x8000) ? val | 0xFFFF0000 : val\n}\n\nBuffer.prototype.readInt32LE = function readInt32LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset]) |\n    (this[offset + 1] << 8) |\n    (this[offset + 2] << 16) |\n    (this[offset + 3] << 24)\n}\n\nBuffer.prototype.readInt32BE = function readInt32BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset] << 24) |\n    (this[offset + 1] << 16) |\n    (this[offset + 2] << 8) |\n    (this[offset + 3])\n}\n\nBuffer.prototype.readFloatLE = function readFloatLE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n  return ieee754.read(this, offset, true, 23, 4)\n}\n\nBuffer.prototype.readFloatBE = function readFloatBE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n  return ieee754.read(this, offset, false, 23, 4)\n}\n\nBuffer.prototype.readDoubleLE = function readDoubleLE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 8, this.length)\n  return ieee754.read(this, offset, true, 52, 8)\n}\n\nBuffer.prototype.readDoubleBE = function readDoubleBE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 8, this.length)\n  return ieee754.read(this, offset, false, 52, 8)\n}\n\nfunction checkInt (buf, value, offset, ext, max, min) {\n  if (!Buffer.isBuffer(buf)) throw new TypeError('\"buffer\" argument must be a Buffer instance')\n  if (value > max || value < min) throw new RangeError('\"value\" argument is out of bounds')\n  if (offset + ext > buf.length) throw new RangeError('Index out of range')\n}\n\nBuffer.prototype.writeUIntLE = function writeUIntLE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    var maxBytes = Math.pow(2, 8 * byteLength) - 1\n    checkInt(this, value, offset, byteLength, maxBytes, 0)\n  }\n\n  var mul = 1\n  var i = 0\n  this[offset] = value & 0xFF\n  while (++i < byteLength && (mul *= 0x100)) {\n    this[offset + i] = (value / mul) & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeUIntBE = function writeUIntBE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    var maxBytes = Math.pow(2, 8 * byteLength) - 1\n    checkInt(this, value, offset, byteLength, maxBytes, 0)\n  }\n\n  var i = byteLength - 1\n  var mul = 1\n  this[offset + i] = value & 0xFF\n  while (--i >= 0 && (mul *= 0x100)) {\n    this[offset + i] = (value / mul) & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeUInt8 = function writeUInt8 (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 1, 0xff, 0)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)\n  this[offset] = (value & 0xff)\n  return offset + 1\n}\n\nfunction objectWriteUInt16 (buf, value, offset, littleEndian) {\n  if (value < 0) value = 0xffff + value + 1\n  for (var i = 0, j = Math.min(buf.length - offset, 2); i < j; ++i) {\n    buf[offset + i] = (value & (0xff << (8 * (littleEndian ? i : 1 - i)))) >>>\n      (littleEndian ? i : 1 - i) * 8\n  }\n}\n\nBuffer.prototype.writeUInt16LE = function writeUInt16LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n  } else {\n    objectWriteUInt16(this, value, offset, true)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeUInt16BE = function writeUInt16BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 8)\n    this[offset + 1] = (value & 0xff)\n  } else {\n    objectWriteUInt16(this, value, offset, false)\n  }\n  return offset + 2\n}\n\nfunction objectWriteUInt32 (buf, value, offset, littleEndian) {\n  if (value < 0) value = 0xffffffff + value + 1\n  for (var i = 0, j = Math.min(buf.length - offset, 4); i < j; ++i) {\n    buf[offset + i] = (value >>> (littleEndian ? i : 3 - i) * 8) & 0xff\n  }\n}\n\nBuffer.prototype.writeUInt32LE = function writeUInt32LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset + 3] = (value >>> 24)\n    this[offset + 2] = (value >>> 16)\n    this[offset + 1] = (value >>> 8)\n    this[offset] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, true)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeUInt32BE = function writeUInt32BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 24)\n    this[offset + 1] = (value >>> 16)\n    this[offset + 2] = (value >>> 8)\n    this[offset + 3] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, false)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeIntLE = function writeIntLE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) {\n    var limit = Math.pow(2, 8 * byteLength - 1)\n\n    checkInt(this, value, offset, byteLength, limit - 1, -limit)\n  }\n\n  var i = 0\n  var mul = 1\n  var sub = 0\n  this[offset] = value & 0xFF\n  while (++i < byteLength && (mul *= 0x100)) {\n    if (value < 0 && sub === 0 && this[offset + i - 1] !== 0) {\n      sub = 1\n    }\n    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeIntBE = function writeIntBE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) {\n    var limit = Math.pow(2, 8 * byteLength - 1)\n\n    checkInt(this, value, offset, byteLength, limit - 1, -limit)\n  }\n\n  var i = byteLength - 1\n  var mul = 1\n  var sub = 0\n  this[offset + i] = value & 0xFF\n  while (--i >= 0 && (mul *= 0x100)) {\n    if (value < 0 && sub === 0 && this[offset + i + 1] !== 0) {\n      sub = 1\n    }\n    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeInt8 = function writeInt8 (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 1, 0x7f, -0x80)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)\n  if (value < 0) value = 0xff + value + 1\n  this[offset] = (value & 0xff)\n  return offset + 1\n}\n\nBuffer.prototype.writeInt16LE = function writeInt16LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n  } else {\n    objectWriteUInt16(this, value, offset, true)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeInt16BE = function writeInt16BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 8)\n    this[offset + 1] = (value & 0xff)\n  } else {\n    objectWriteUInt16(this, value, offset, false)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeInt32LE = function writeInt32LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n    this[offset + 2] = (value >>> 16)\n    this[offset + 3] = (value >>> 24)\n  } else {\n    objectWriteUInt32(this, value, offset, true)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeInt32BE = function writeInt32BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)\n  if (value < 0) value = 0xffffffff + value + 1\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 24)\n    this[offset + 1] = (value >>> 16)\n    this[offset + 2] = (value >>> 8)\n    this[offset + 3] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, false)\n  }\n  return offset + 4\n}\n\nfunction checkIEEE754 (buf, value, offset, ext, max, min) {\n  if (offset + ext > buf.length) throw new RangeError('Index out of range')\n  if (offset < 0) throw new RangeError('Index out of range')\n}\n\nfunction writeFloat (buf, value, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    checkIEEE754(buf, value, offset, 4, 3.4028234663852886e+38, -3.4028234663852886e+38)\n  }\n  ieee754.write(buf, value, offset, littleEndian, 23, 4)\n  return offset + 4\n}\n\nBuffer.prototype.writeFloatLE = function writeFloatLE (value, offset, noAssert) {\n  return writeFloat(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeFloatBE = function writeFloatBE (value, offset, noAssert) {\n  return writeFloat(this, value, offset, false, noAssert)\n}\n\nfunction writeDouble (buf, value, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    checkIEEE754(buf, value, offset, 8, 1.7976931348623157E+308, -1.7976931348623157E+308)\n  }\n  ieee754.write(buf, value, offset, littleEndian, 52, 8)\n  return offset + 8\n}\n\nBuffer.prototype.writeDoubleLE = function writeDoubleLE (value, offset, noAssert) {\n  return writeDouble(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeDoubleBE = function writeDoubleBE (value, offset, noAssert) {\n  return writeDouble(this, value, offset, false, noAssert)\n}\n\n// copy(targetBuffer, targetStart=0, sourceStart=0, sourceEnd=buffer.length)\nBuffer.prototype.copy = function copy (target, targetStart, start, end) {\n  if (!start) start = 0\n  if (!end && end !== 0) end = this.length\n  if (targetStart >= target.length) targetStart = target.length\n  if (!targetStart) targetStart = 0\n  if (end > 0 && end < start) end = start\n\n  // Copy 0 bytes; we're done\n  if (end === start) return 0\n  if (target.length === 0 || this.length === 0) return 0\n\n  // Fatal error conditions\n  if (targetStart < 0) {\n    throw new RangeError('targetStart out of bounds')\n  }\n  if (start < 0 || start >= this.length) throw new RangeError('sourceStart out of bounds')\n  if (end < 0) throw new RangeError('sourceEnd out of bounds')\n\n  // Are we oob?\n  if (end > this.length) end = this.length\n  if (target.length - targetStart < end - start) {\n    end = target.length - targetStart + start\n  }\n\n  var len = end - start\n  var i\n\n  if (this === target && start < targetStart && targetStart < end) {\n    // descending copy from end\n    for (i = len - 1; i >= 0; --i) {\n      target[i + targetStart] = this[i + start]\n    }\n  } else if (len < 1000 || !Buffer.TYPED_ARRAY_SUPPORT) {\n    // ascending copy from start\n    for (i = 0; i < len; ++i) {\n      target[i + targetStart] = this[i + start]\n    }\n  } else {\n    Uint8Array.prototype.set.call(\n      target,\n      this.subarray(start, start + len),\n      targetStart\n    )\n  }\n\n  return len\n}\n\n// Usage:\n//    buffer.fill(number[, offset[, end]])\n//    buffer.fill(buffer[, offset[, end]])\n//    buffer.fill(string[, offset[, end]][, encoding])\nBuffer.prototype.fill = function fill (val, start, end, encoding) {\n  // Handle string cases:\n  if (typeof val === 'string') {\n    if (typeof start === 'string') {\n      encoding = start\n      start = 0\n      end = this.length\n    } else if (typeof end === 'string') {\n      encoding = end\n      end = this.length\n    }\n    if (val.length === 1) {\n      var code = val.charCodeAt(0)\n      if (code < 256) {\n        val = code\n      }\n    }\n    if (encoding !== undefined && typeof encoding !== 'string') {\n      throw new TypeError('encoding must be a string')\n    }\n    if (typeof encoding === 'string' && !Buffer.isEncoding(encoding)) {\n      throw new TypeError('Unknown encoding: ' + encoding)\n    }\n  } else if (typeof val === 'number') {\n    val = val & 255\n  }\n\n  // Invalid ranges are not set to a default, so can range check early.\n  if (start < 0 || this.length < start || this.length < end) {\n    throw new RangeError('Out of range index')\n  }\n\n  if (end <= start) {\n    return this\n  }\n\n  start = start >>> 0\n  end = end === undefined ? this.length : end >>> 0\n\n  if (!val) val = 0\n\n  var i\n  if (typeof val === 'number') {\n    for (i = start; i < end; ++i) {\n      this[i] = val\n    }\n  } else {\n    var bytes = Buffer.isBuffer(val)\n      ? val\n      : utf8ToBytes(new Buffer(val, encoding).toString())\n    var len = bytes.length\n    for (i = 0; i < end - start; ++i) {\n      this[i + start] = bytes[i % len]\n    }\n  }\n\n  return this\n}\n\n// HELPER FUNCTIONS\n// ================\n\nvar INVALID_BASE64_RE = /[^+\\/0-9A-Za-z-_]/g\n\nfunction base64clean (str) {\n  // Node strips out invalid characters like \\n and \\t from the string, base64-js does not\n  str = stringtrim(str).replace(INVALID_BASE64_RE, '')\n  // Node converts strings with length < 2 to ''\n  if (str.length < 2) return ''\n  // Node allows for non-padded base64 strings (missing trailing ===), base64-js does not\n  while (str.length % 4 !== 0) {\n    str = str + '='\n  }\n  return str\n}\n\nfunction stringtrim (str) {\n  if (str.trim) return str.trim()\n  return str.replace(/^\\s+|\\s+$/g, '')\n}\n\nfunction toHex (n) {\n  if (n < 16) return '0' + n.toString(16)\n  return n.toString(16)\n}\n\nfunction utf8ToBytes (string, units) {\n  units = units || Infinity\n  var codePoint\n  var length = string.length\n  var leadSurrogate = null\n  var bytes = []\n\n  for (var i = 0; i < length; ++i) {\n    codePoint = string.charCodeAt(i)\n\n    // is surrogate component\n    if (codePoint > 0xD7FF && codePoint < 0xE000) {\n      // last char was a lead\n      if (!leadSurrogate) {\n        // no lead yet\n        if (codePoint > 0xDBFF) {\n          // unexpected trail\n          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n          continue\n        } else if (i + 1 === length) {\n          // unpaired lead\n          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n          continue\n        }\n\n        // valid lead\n        leadSurrogate = codePoint\n\n        continue\n      }\n\n      // 2 leads in a row\n      if (codePoint < 0xDC00) {\n        if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n        leadSurrogate = codePoint\n        continue\n      }\n\n      // valid surrogate pair\n      codePoint = (leadSurrogate - 0xD800 << 10 | codePoint - 0xDC00) + 0x10000\n    } else if (leadSurrogate) {\n      // valid bmp char, but last char was a lead\n      if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n    }\n\n    leadSurrogate = null\n\n    // encode utf8\n    if (codePoint < 0x80) {\n      if ((units -= 1) < 0) break\n      bytes.push(codePoint)\n    } else if (codePoint < 0x800) {\n      if ((units -= 2) < 0) break\n      bytes.push(\n        codePoint >> 0x6 | 0xC0,\n        codePoint & 0x3F | 0x80\n      )\n    } else if (codePoint < 0x10000) {\n      if ((units -= 3) < 0) break\n      bytes.push(\n        codePoint >> 0xC | 0xE0,\n        codePoint >> 0x6 & 0x3F | 0x80,\n        codePoint & 0x3F | 0x80\n      )\n    } else if (codePoint < 0x110000) {\n      if ((units -= 4) < 0) break\n      bytes.push(\n        codePoint >> 0x12 | 0xF0,\n        codePoint >> 0xC & 0x3F | 0x80,\n        codePoint >> 0x6 & 0x3F | 0x80,\n        codePoint & 0x3F | 0x80\n      )\n    } else {\n      throw new Error('Invalid code point')\n    }\n  }\n\n  return bytes\n}\n\nfunction asciiToBytes (str) {\n  var byteArray = []\n  for (var i = 0; i < str.length; ++i) {\n    // Node's code seems to be doing this and not & 0x7F..\n    byteArray.push(str.charCodeAt(i) & 0xFF)\n  }\n  return byteArray\n}\n\nfunction utf16leToBytes (str, units) {\n  var c, hi, lo\n  var byteArray = []\n  for (var i = 0; i < str.length; ++i) {\n    if ((units -= 2) < 0) break\n\n    c = str.charCodeAt(i)\n    hi = c >> 8\n    lo = c % 256\n    byteArray.push(lo)\n    byteArray.push(hi)\n  }\n\n  return byteArray\n}\n\nfunction base64ToBytes (str) {\n  return base64.toByteArray(base64clean(str))\n}\n\nfunction blitBuffer (src, dst, offset, length) {\n  for (var i = 0; i < length; ++i) {\n    if ((i + offset >= dst.length) || (i >= src.length)) break\n    dst[i + offset] = src[i]\n  }\n  return i\n}\n\nfunction isnan (val) {\n  return val !== val // eslint-disable-line no-self-compare\n}\n","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","'use strict'\n\nexports.byteLength = byteLength\nexports.toByteArray = toByteArray\nexports.fromByteArray = fromByteArray\n\nvar lookup = []\nvar revLookup = []\nvar Arr = typeof Uint8Array !== 'undefined' ? Uint8Array : Array\n\nvar code = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'\nfor (var i = 0, len = code.length; i < len; ++i) {\n  lookup[i] = code[i]\n  revLookup[code.charCodeAt(i)] = i\n}\n\n// Support decoding URL-safe base64 strings, as Node.js does.\n// See: https://en.wikipedia.org/wiki/Base64#URL_applications\nrevLookup['-'.charCodeAt(0)] = 62\nrevLookup['_'.charCodeAt(0)] = 63\n\nfunction getLens (b64) {\n  var len = b64.length\n\n  if (len % 4 > 0) {\n    throw new Error('Invalid string. Length must be a multiple of 4')\n  }\n\n  // Trim off extra bytes after placeholder bytes are found\n  // See: https://github.com/beatgammit/base64-js/issues/42\n  var validLen = b64.indexOf('=')\n  if (validLen === -1) validLen = len\n\n  var placeHoldersLen = validLen === len\n    ? 0\n    : 4 - (validLen % 4)\n\n  return [validLen, placeHoldersLen]\n}\n\n// base64 is 4/3 + up to two characters of the original data\nfunction byteLength (b64) {\n  var lens = getLens(b64)\n  var validLen = lens[0]\n  var placeHoldersLen = lens[1]\n  return ((validLen + placeHoldersLen) * 3 / 4) - placeHoldersLen\n}\n\nfunction _byteLength (b64, validLen, placeHoldersLen) {\n  return ((validLen + placeHoldersLen) * 3 / 4) - placeHoldersLen\n}\n\nfunction toByteArray (b64) {\n  var tmp\n  var lens = getLens(b64)\n  var validLen = lens[0]\n  var placeHoldersLen = lens[1]\n\n  var arr = new Arr(_byteLength(b64, validLen, placeHoldersLen))\n\n  var curByte = 0\n\n  // if there are placeholders, only get up to the last complete 4 chars\n  var len = placeHoldersLen > 0\n    ? validLen - 4\n    : validLen\n\n  var i\n  for (i = 0; i < len; i += 4) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 18) |\n      (revLookup[b64.charCodeAt(i + 1)] << 12) |\n      (revLookup[b64.charCodeAt(i + 2)] << 6) |\n      revLookup[b64.charCodeAt(i + 3)]\n    arr[curByte++] = (tmp >> 16) & 0xFF\n    arr[curByte++] = (tmp >> 8) & 0xFF\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  if (placeHoldersLen === 2) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 2) |\n      (revLookup[b64.charCodeAt(i + 1)] >> 4)\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  if (placeHoldersLen === 1) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 10) |\n      (revLookup[b64.charCodeAt(i + 1)] << 4) |\n      (revLookup[b64.charCodeAt(i + 2)] >> 2)\n    arr[curByte++] = (tmp >> 8) & 0xFF\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  return arr\n}\n\nfunction tripletToBase64 (num) {\n  return lookup[num >> 18 & 0x3F] +\n    lookup[num >> 12 & 0x3F] +\n    lookup[num >> 6 & 0x3F] +\n    lookup[num & 0x3F]\n}\n\nfunction encodeChunk (uint8, start, end) {\n  var tmp\n  var output = []\n  for (var i = start; i < end; i += 3) {\n    tmp =\n      ((uint8[i] << 16) & 0xFF0000) +\n      ((uint8[i + 1] << 8) & 0xFF00) +\n      (uint8[i + 2] & 0xFF)\n    output.push(tripletToBase64(tmp))\n  }\n  return output.join('')\n}\n\nfunction fromByteArray (uint8) {\n  var tmp\n  var len = uint8.length\n  var extraBytes = len % 3 // if we have 1 byte left, pad 2 bytes\n  var parts = []\n  var maxChunkLength = 16383 // must be multiple of 3\n\n  // go through the array every three bytes, we'll deal with trailing stuff later\n  for (var i = 0, len2 = len - extraBytes; i < len2; i += maxChunkLength) {\n    parts.push(encodeChunk(\n      uint8, i, (i + maxChunkLength) > len2 ? len2 : (i + maxChunkLength)\n    ))\n  }\n\n  // pad the end with zeros, but make sure to not forget the extra bytes\n  if (extraBytes === 1) {\n    tmp = uint8[len - 1]\n    parts.push(\n      lookup[tmp >> 2] +\n      lookup[(tmp << 4) & 0x3F] +\n      '=='\n    )\n  } else if (extraBytes === 2) {\n    tmp = (uint8[len - 2] << 8) + uint8[len - 1]\n    parts.push(\n      lookup[tmp >> 10] +\n      lookup[(tmp >> 4) & 0x3F] +\n      lookup[(tmp << 2) & 0x3F] +\n      '='\n    )\n  }\n\n  return parts.join('')\n}\n","exports.read = function (buffer, offset, isLE, mLen, nBytes) {\n  var e, m\n  var eLen = (nBytes * 8) - mLen - 1\n  var eMax = (1 << eLen) - 1\n  var eBias = eMax >> 1\n  var nBits = -7\n  var i = isLE ? (nBytes - 1) : 0\n  var d = isLE ? -1 : 1\n  var s = buffer[offset + i]\n\n  i += d\n\n  e = s & ((1 << (-nBits)) - 1)\n  s >>= (-nBits)\n  nBits += eLen\n  for (; nBits > 0; e = (e * 256) + buffer[offset + i], i += d, nBits -= 8) {}\n\n  m = e & ((1 << (-nBits)) - 1)\n  e >>= (-nBits)\n  nBits += mLen\n  for (; nBits > 0; m = (m * 256) + buffer[offset + i], i += d, nBits -= 8) {}\n\n  if (e === 0) {\n    e = 1 - eBias\n  } else if (e === eMax) {\n    return m ? NaN : ((s ? -1 : 1) * Infinity)\n  } else {\n    m = m + Math.pow(2, mLen)\n    e = e - eBias\n  }\n  return (s ? -1 : 1) * m * Math.pow(2, e - mLen)\n}\n\nexports.write = function (buffer, value, offset, isLE, mLen, nBytes) {\n  var e, m, c\n  var eLen = (nBytes * 8) - mLen - 1\n  var eMax = (1 << eLen) - 1\n  var eBias = eMax >> 1\n  var rt = (mLen === 23 ? Math.pow(2, -24) - Math.pow(2, -77) : 0)\n  var i = isLE ? 0 : (nBytes - 1)\n  var d = isLE ? 1 : -1\n  var s = value < 0 || (value === 0 && 1 / value < 0) ? 1 : 0\n\n  value = Math.abs(value)\n\n  if (isNaN(value) || value === Infinity) {\n    m = isNaN(value) ? 1 : 0\n    e = eMax\n  } else {\n    e = Math.floor(Math.log(value) / Math.LN2)\n    if (value * (c = Math.pow(2, -e)) < 1) {\n      e--\n      c *= 2\n    }\n    if (e + eBias >= 1) {\n      value += rt / c\n    } else {\n      value += rt * Math.pow(2, 1 - eBias)\n    }\n    if (value * c >= 2) {\n      e++\n      c /= 2\n    }\n\n    if (e + eBias >= eMax) {\n      m = 0\n      e = eMax\n    } else if (e + eBias >= 1) {\n      m = ((value * c) - 1) * Math.pow(2, mLen)\n      e = e + eBias\n    } else {\n      m = value * Math.pow(2, eBias - 1) * Math.pow(2, mLen)\n      e = 0\n    }\n  }\n\n  for (; mLen >= 8; buffer[offset + i] = m & 0xff, i += d, m /= 256, mLen -= 8) {}\n\n  e = (e << mLen) | m\n  eLen += mLen\n  for (; eLen > 0; buffer[offset + i] = e & 0xff, i += d, e /= 256, eLen -= 8) {}\n\n  buffer[offset + i - d] |= s * 128\n}\n","var toString = {}.toString;\n\nmodule.exports = Array.isArray || function (arr) {\n  return toString.call(arr) == '[object Array]';\n};\n","module.exports = require('./lib/axios');","'use strict';\n\nvar utils = require('./utils');\nvar bind = require('./helpers/bind');\nvar Axios = require('./core/Axios');\nvar mergeConfig = require('./core/mergeConfig');\nvar defaults = require('./defaults');\n\n/**\n * Create an instance of Axios\n *\n * @param {Object} defaultConfig The default config for the instance\n * @return {Axios} A new instance of Axios\n */\nfunction createInstance(defaultConfig) {\n  var context = new Axios(defaultConfig);\n  var instance = bind(Axios.prototype.request, context);\n\n  // Copy axios.prototype to instance\n  utils.extend(instance, Axios.prototype, context);\n\n  // Copy context to instance\n  utils.extend(instance, context);\n\n  return instance;\n}\n\n// Create the default instance to be exported\nvar axios = createInstance(defaults);\n\n// Expose Axios class to allow class inheritance\naxios.Axios = Axios;\n\n// Factory for creating new instances\naxios.create = function create(instanceConfig) {\n  return createInstance(mergeConfig(axios.defaults, instanceConfig));\n};\n\n// Expose Cancel & CancelToken\naxios.Cancel = require('./cancel/Cancel');\naxios.CancelToken = require('./cancel/CancelToken');\naxios.isCancel = require('./cancel/isCancel');\n\n// Expose all/spread\naxios.all = function all(promises) {\n  return Promise.all(promises);\n};\naxios.spread = require('./helpers/spread');\n\nmodule.exports = axios;\n\n// Allow use of default import syntax in TypeScript\nmodule.exports.default = axios;\n","/*!\n * Determine if an object is a Buffer\n *\n * @author   Feross Aboukhadijeh <https://feross.org>\n * @license  MIT\n */\n\nmodule.exports = function isBuffer (obj) {\n  return obj != null && obj.constructor != null &&\n    typeof obj.constructor.isBuffer === 'function' && obj.constructor.isBuffer(obj)\n}\n","'use strict';\n\nvar utils = require('./../utils');\nvar buildURL = require('../helpers/buildURL');\nvar InterceptorManager = require('./InterceptorManager');\nvar dispatchRequest = require('./dispatchRequest');\nvar mergeConfig = require('./mergeConfig');\n\n/**\n * Create a new instance of Axios\n *\n * @param {Object} instanceConfig The default config for the instance\n */\nfunction Axios(instanceConfig) {\n  this.defaults = instanceConfig;\n  this.interceptors = {\n    request: new InterceptorManager(),\n    response: new InterceptorManager()\n  };\n}\n\n/**\n * Dispatch a request\n *\n * @param {Object} config The config specific for this request (merged with this.defaults)\n */\nAxios.prototype.request = function request(config) {\n  /*eslint no-param-reassign:0*/\n  // Allow for axios('example/url'[, config]) a la fetch API\n  if (typeof config === 'string') {\n    config = arguments[1] || {};\n    config.url = arguments[0];\n  } else {\n    config = config || {};\n  }\n\n  config = mergeConfig(this.defaults, config);\n  config.method = config.method ? config.method.toLowerCase() : 'get';\n\n  // Hook up interceptors middleware\n  var chain = [dispatchRequest, undefined];\n  var promise = Promise.resolve(config);\n\n  this.interceptors.request.forEach(function unshiftRequestInterceptors(interceptor) {\n    chain.unshift(interceptor.fulfilled, interceptor.rejected);\n  });\n\n  this.interceptors.response.forEach(function pushResponseInterceptors(interceptor) {\n    chain.push(interceptor.fulfilled, interceptor.rejected);\n  });\n\n  while (chain.length) {\n    promise = promise.then(chain.shift(), chain.shift());\n  }\n\n  return promise;\n};\n\nAxios.prototype.getUri = function getUri(config) {\n  config = mergeConfig(this.defaults, config);\n  return buildURL(config.url, config.params, config.paramsSerializer).replace(/^\\?/, '');\n};\n\n// Provide aliases for supported request methods\nutils.forEach(['delete', 'get', 'head', 'options'], function forEachMethodNoData(method) {\n  /*eslint func-names:0*/\n  Axios.prototype[method] = function(url, config) {\n    return this.request(utils.merge(config || {}, {\n      method: method,\n      url: url\n    }));\n  };\n});\n\nutils.forEach(['post', 'put', 'patch'], function forEachMethodWithData(method) {\n  /*eslint func-names:0*/\n  Axios.prototype[method] = function(url, data, config) {\n    return this.request(utils.merge(config || {}, {\n      method: method,\n      url: url,\n      data: data\n    }));\n  };\n});\n\nmodule.exports = Axios;\n","'use strict';\n\nvar utils = require('./../utils');\n\nfunction InterceptorManager() {\n  this.handlers = [];\n}\n\n/**\n * Add a new interceptor to the stack\n *\n * @param {Function} fulfilled The function to handle `then` for a `Promise`\n * @param {Function} rejected The function to handle `reject` for a `Promise`\n *\n * @return {Number} An ID used to remove interceptor later\n */\nInterceptorManager.prototype.use = function use(fulfilled, rejected) {\n  this.handlers.push({\n    fulfilled: fulfilled,\n    rejected: rejected\n  });\n  return this.handlers.length - 1;\n};\n\n/**\n * Remove an interceptor from the stack\n *\n * @param {Number} id The ID that was returned by `use`\n */\nInterceptorManager.prototype.eject = function eject(id) {\n  if (this.handlers[id]) {\n    this.handlers[id] = null;\n  }\n};\n\n/**\n * Iterate over all the registered interceptors\n *\n * This method is particularly useful for skipping over any\n * interceptors that may have become `null` calling `eject`.\n *\n * @param {Function} fn The function to call for each interceptor\n */\nInterceptorManager.prototype.forEach = function forEach(fn) {\n  utils.forEach(this.handlers, function forEachHandler(h) {\n    if (h !== null) {\n      fn(h);\n    }\n  });\n};\n\nmodule.exports = InterceptorManager;\n","'use strict';\n\nvar utils = require('./../utils');\nvar transformData = require('./transformData');\nvar isCancel = require('../cancel/isCancel');\nvar defaults = require('../defaults');\nvar isAbsoluteURL = require('./../helpers/isAbsoluteURL');\nvar combineURLs = require('./../helpers/combineURLs');\n\n/**\n * Throws a `Cancel` if cancellation has been requested.\n */\nfunction throwIfCancellationRequested(config) {\n  if (config.cancelToken) {\n    config.cancelToken.throwIfRequested();\n  }\n}\n\n/**\n * Dispatch a request to the server using the configured adapter.\n *\n * @param {object} config The config that is to be used for the request\n * @returns {Promise} The Promise to be fulfilled\n */\nmodule.exports = function dispatchRequest(config) {\n  throwIfCancellationRequested(config);\n\n  // Support baseURL config\n  if (config.baseURL && !isAbsoluteURL(config.url)) {\n    config.url = combineURLs(config.baseURL, config.url);\n  }\n\n  // Ensure headers exist\n  config.headers = config.headers || {};\n\n  // Transform request data\n  config.data = transformData(\n    config.data,\n    config.headers,\n    config.transformRequest\n  );\n\n  // Flatten headers\n  config.headers = utils.merge(\n    config.headers.common || {},\n    config.headers[config.method] || {},\n    config.headers || {}\n  );\n\n  utils.forEach(\n    ['delete', 'get', 'head', 'post', 'put', 'patch', 'common'],\n    function cleanHeaderConfig(method) {\n      delete config.headers[method];\n    }\n  );\n\n  var adapter = config.adapter || defaults.adapter;\n\n  return adapter(config).then(function onAdapterResolution(response) {\n    throwIfCancellationRequested(config);\n\n    // Transform response data\n    response.data = transformData(\n      response.data,\n      response.headers,\n      config.transformResponse\n    );\n\n    return response;\n  }, function onAdapterRejection(reason) {\n    if (!isCancel(reason)) {\n      throwIfCancellationRequested(config);\n\n      // Transform response data\n      if (reason && reason.response) {\n        reason.response.data = transformData(\n          reason.response.data,\n          reason.response.headers,\n          config.transformResponse\n        );\n      }\n    }\n\n    return Promise.reject(reason);\n  });\n};\n","'use strict';\n\nvar utils = require('./../utils');\n\n/**\n * Transform the data for a request or a response\n *\n * @param {Object|String} data The data to be transformed\n * @param {Array} headers The headers for the request or response\n * @param {Array|Function} fns A single function or Array of functions\n * @returns {*} The resulting transformed data\n */\nmodule.exports = function transformData(data, headers, fns) {\n  /*eslint no-param-reassign:0*/\n  utils.forEach(fns, function transform(fn) {\n    data = fn(data, headers);\n  });\n\n  return data;\n};\n","'use strict';\n\nvar utils = require('../utils');\n\nmodule.exports = function normalizeHeaderName(headers, normalizedName) {\n  utils.forEach(headers, function processHeader(value, name) {\n    if (name !== normalizedName && name.toUpperCase() === normalizedName.toUpperCase()) {\n      headers[normalizedName] = value;\n      delete headers[name];\n    }\n  });\n};\n","'use strict';\n\nvar createError = require('./createError');\n\n/**\n * Resolve or reject a Promise based on response status.\n *\n * @param {Function} resolve A function that resolves the promise.\n * @param {Function} reject A function that rejects the promise.\n * @param {object} response The response.\n */\nmodule.exports = function settle(resolve, reject, response) {\n  var validateStatus = response.config.validateStatus;\n  if (!validateStatus || validateStatus(response.status)) {\n    resolve(response);\n  } else {\n    reject(createError(\n      'Request failed with status code ' + response.status,\n      response.config,\n      null,\n      response.request,\n      response\n    ));\n  }\n};\n","'use strict';\n\n/**\n * Update an Error with the specified config, error code, and response.\n *\n * @param {Error} error The error to update.\n * @param {Object} config The config.\n * @param {string} [code] The error code (for example, 'ECONNABORTED').\n * @param {Object} [request] The request.\n * @param {Object} [response] The response.\n * @returns {Error} The error.\n */\nmodule.exports = function enhanceError(error, config, code, request, response) {\n  error.config = config;\n  if (code) {\n    error.code = code;\n  }\n\n  error.request = request;\n  error.response = response;\n  error.isAxiosError = true;\n\n  error.toJSON = function() {\n    return {\n      // Standard\n      message: this.message,\n      name: this.name,\n      // Microsoft\n      description: this.description,\n      number: this.number,\n      // Mozilla\n      fileName: this.fileName,\n      lineNumber: this.lineNumber,\n      columnNumber: this.columnNumber,\n      stack: this.stack,\n      // Axios\n      config: this.config,\n      code: this.code\n    };\n  };\n  return error;\n};\n","'use strict';\n\nvar utils = require('./../utils');\n\n// Headers whose duplicates are ignored by node\n// c.f. https://nodejs.org/api/http.html#http_message_headers\nvar ignoreDuplicateOf = [\n  'age', 'authorization', 'content-length', 'content-type', 'etag',\n  'expires', 'from', 'host', 'if-modified-since', 'if-unmodified-since',\n  'last-modified', 'location', 'max-forwards', 'proxy-authorization',\n  'referer', 'retry-after', 'user-agent'\n];\n\n/**\n * Parse headers into an object\n *\n * ```\n * Date: Wed, 27 Aug 2014 08:58:49 GMT\n * Content-Type: application/json\n * Connection: keep-alive\n * Transfer-Encoding: chunked\n * ```\n *\n * @param {String} headers Headers needing to be parsed\n * @returns {Object} Headers parsed into an object\n */\nmodule.exports = function parseHeaders(headers) {\n  var parsed = {};\n  var key;\n  var val;\n  var i;\n\n  if (!headers) { return parsed; }\n\n  utils.forEach(headers.split('\\n'), function parser(line) {\n    i = line.indexOf(':');\n    key = utils.trim(line.substr(0, i)).toLowerCase();\n    val = utils.trim(line.substr(i + 1));\n\n    if (key) {\n      if (parsed[key] && ignoreDuplicateOf.indexOf(key) >= 0) {\n        return;\n      }\n      if (key === 'set-cookie') {\n        parsed[key] = (parsed[key] ? parsed[key] : []).concat([val]);\n      } else {\n        parsed[key] = parsed[key] ? parsed[key] + ', ' + val : val;\n      }\n    }\n  });\n\n  return parsed;\n};\n","'use strict';\n\nvar utils = require('./../utils');\n\nmodule.exports = (\n  utils.isStandardBrowserEnv() ?\n\n  // Standard browser envs have full support of the APIs needed to test\n  // whether the request URL is of the same origin as current location.\n    (function standardBrowserEnv() {\n      var msie = /(msie|trident)/i.test(navigator.userAgent);\n      var urlParsingNode = document.createElement('a');\n      var originURL;\n\n      /**\n    * Parse a URL to discover it's components\n    *\n    * @param {String} url The URL to be parsed\n    * @returns {Object}\n    */\n      function resolveURL(url) {\n        var href = url;\n\n        if (msie) {\n        // IE needs attribute set twice to normalize properties\n          urlParsingNode.setAttribute('href', href);\n          href = urlParsingNode.href;\n        }\n\n        urlParsingNode.setAttribute('href', href);\n\n        // urlParsingNode provides the UrlUtils interface - http://url.spec.whatwg.org/#urlutils\n        return {\n          href: urlParsingNode.href,\n          protocol: urlParsingNode.protocol ? urlParsingNode.protocol.replace(/:$/, '') : '',\n          host: urlParsingNode.host,\n          search: urlParsingNode.search ? urlParsingNode.search.replace(/^\\?/, '') : '',\n          hash: urlParsingNode.hash ? urlParsingNode.hash.replace(/^#/, '') : '',\n          hostname: urlParsingNode.hostname,\n          port: urlParsingNode.port,\n          pathname: (urlParsingNode.pathname.charAt(0) === '/') ?\n            urlParsingNode.pathname :\n            '/' + urlParsingNode.pathname\n        };\n      }\n\n      originURL = resolveURL(window.location.href);\n\n      /**\n    * Determine if a URL shares the same origin as the current location\n    *\n    * @param {String} requestURL The URL to test\n    * @returns {boolean} True if URL shares the same origin, otherwise false\n    */\n      return function isURLSameOrigin(requestURL) {\n        var parsed = (utils.isString(requestURL)) ? resolveURL(requestURL) : requestURL;\n        return (parsed.protocol === originURL.protocol &&\n            parsed.host === originURL.host);\n      };\n    })() :\n\n  // Non standard browser envs (web workers, react-native) lack needed support.\n    (function nonStandardBrowserEnv() {\n      return function isURLSameOrigin() {\n        return true;\n      };\n    })()\n);\n","'use strict';\n\nvar utils = require('./../utils');\n\nmodule.exports = (\n  utils.isStandardBrowserEnv() ?\n\n  // Standard browser envs support document.cookie\n    (function standardBrowserEnv() {\n      return {\n        write: function write(name, value, expires, path, domain, secure) {\n          var cookie = [];\n          cookie.push(name + '=' + encodeURIComponent(value));\n\n          if (utils.isNumber(expires)) {\n            cookie.push('expires=' + new Date(expires).toGMTString());\n          }\n\n          if (utils.isString(path)) {\n            cookie.push('path=' + path);\n          }\n\n          if (utils.isString(domain)) {\n            cookie.push('domain=' + domain);\n          }\n\n          if (secure === true) {\n            cookie.push('secure');\n          }\n\n          document.cookie = cookie.join('; ');\n        },\n\n        read: function read(name) {\n          var match = document.cookie.match(new RegExp('(^|;\\\\s*)(' + name + ')=([^;]*)'));\n          return (match ? decodeURIComponent(match[3]) : null);\n        },\n\n        remove: function remove(name) {\n          this.write(name, '', Date.now() - 86400000);\n        }\n      };\n    })() :\n\n  // Non standard browser env (web workers, react-native) lack needed support.\n    (function nonStandardBrowserEnv() {\n      return {\n        write: function write() {},\n        read: function read() { return null; },\n        remove: function remove() {}\n      };\n    })()\n);\n","'use strict';\n\n/**\n * Determines whether the specified URL is absolute\n *\n * @param {string} url The URL to test\n * @returns {boolean} True if the specified URL is absolute, otherwise false\n */\nmodule.exports = function isAbsoluteURL(url) {\n  // A URL is considered absolute if it begins with \"<scheme>://\" or \"//\" (protocol-relative URL).\n  // RFC 3986 defines scheme name as a sequence of characters beginning with a letter and followed\n  // by any combination of letters, digits, plus, period, or hyphen.\n  return /^([a-z][a-z\\d\\+\\-\\.]*:)?\\/\\//i.test(url);\n};\n","'use strict';\n\n/**\n * Creates a new URL by combining the specified URLs\n *\n * @param {string} baseURL The base URL\n * @param {string} relativeURL The relative URL\n * @returns {string} The combined URL\n */\nmodule.exports = function combineURLs(baseURL, relativeURL) {\n  return relativeURL\n    ? baseURL.replace(/\\/+$/, '') + '/' + relativeURL.replace(/^\\/+/, '')\n    : baseURL;\n};\n","'use strict';\n\nvar Cancel = require('./Cancel');\n\n/**\n * A `CancelToken` is an object that can be used to request cancellation of an operation.\n *\n * @class\n * @param {Function} executor The executor function.\n */\nfunction CancelToken(executor) {\n  if (typeof executor !== 'function') {\n    throw new TypeError('executor must be a function.');\n  }\n\n  var resolvePromise;\n  this.promise = new Promise(function promiseExecutor(resolve) {\n    resolvePromise = resolve;\n  });\n\n  var token = this;\n  executor(function cancel(message) {\n    if (token.reason) {\n      // Cancellation has already been requested\n      return;\n    }\n\n    token.reason = new Cancel(message);\n    resolvePromise(token.reason);\n  });\n}\n\n/**\n * Throws a `Cancel` if cancellation has been requested.\n */\nCancelToken.prototype.throwIfRequested = function throwIfRequested() {\n  if (this.reason) {\n    throw this.reason;\n  }\n};\n\n/**\n * Returns an object that contains a new `CancelToken` and a function that, when called,\n * cancels the `CancelToken`.\n */\nCancelToken.source = function source() {\n  var cancel;\n  var token = new CancelToken(function executor(c) {\n    cancel = c;\n  });\n  return {\n    token: token,\n    cancel: cancel\n  };\n};\n\nmodule.exports = CancelToken;\n","'use strict';\n\n/**\n * Syntactic sugar for invoking a function and expanding an array for arguments.\n *\n * Common use case would be to use `Function.prototype.apply`.\n *\n *  ```js\n *  function f(x, y, z) {}\n *  var args = [1, 2, 3];\n *  f.apply(null, args);\n *  ```\n *\n * With `spread` this example can be re-written.\n *\n *  ```js\n *  spread(function(x, y, z) {})([1, 2, 3]);\n *  ```\n *\n * @param {Function} callback\n * @returns {Function}\n */\nmodule.exports = function spread(callback) {\n  return function wrap(arr) {\n    return callback.apply(null, arr);\n  };\n};\n","/**\r\n * Represents a frame for programmatic access to object frame, anywhere within a document\r\n * Recursive data structure where this.children contains an indexed array of object frames\r\n * and this.dataframes contains a property indexed array of data frames\r\n * Every object frame carries a reference to its classframe\r\n * This gives us instructions as to how to create new frames according to the schema\r\n * After that it's turtles all the way down.\r\n * @param cls - ID of the class (URL)\r\n * @param classframe - an array of frames representing a class\r\n * @param archetypes list of class frames\r\n * @param parent parent object\r\n * @returns\r\n */\r\nconst FrameHelper = require('./frameHelper');\r\nconst FramePattern = require('./framePattern');\r\n\r\nfunction ObjectFrame(cls, dataframes, classframes, parent, parentframe) {\r\n\t// the class of the frame - mandatory\r\n\tthis.empty();\r\n\tthis.cls = cls;\r\n\r\n\t// array of frames representing the full class frame\r\n\t// (optional - required to be able to safely add missing properties)\r\n\tif (classframes && typeof classframes === 'object') {\r\n\t\tthis.loadClassFrames(classframes);\r\n\t}\r\n\tif (dataframes && typeof dataframes === 'object') {\r\n\t\tthis.originalFrames = dataframes;\r\n\t\tthis.loadDataFrames(dataframes);\r\n\t} else {\r\n\t\tthis.originalFrames = false;\r\n\t}\r\n\t// parent object frame\r\n\tthis.parent = parent;\r\n\t// original frame used by parent to create me\r\n\tthis.parentframe = parentframe;\r\n\t// set to true if this is a newly created document\r\n\tthis.newDoc = false;\r\n}\r\n\r\n/**\r\n * Loads class frames for the object's class - the instructions about how to put an object together\r\n */\r\nObjectFrame.prototype.loadClassFrames = function (classframes) {\r\n\tfor (let j = 0; j < classframes.length; j += 1) {\r\n\t\tif (classframes[j]['@context']) this.jsonld_context = classframes[j]['@context'];\r\n\r\n\t\tconst cf = new ClassFrame(classframes[j]);\r\n\t\tif (cf.isValid()) {\r\n\t\t\tif(!this.classframes) this.classframes = {};\r\n\t\t\tif(typeof this.classframes[classframes[j].property] === 'undefined') {\r\n\t\t\t\tthis.classframes[classframes[j].property] = [];\r\n\t\t\t}\r\n\t\t\tthis.classframes[classframes[j].property] = cf;\r\n\t\t\tif (cf.isObject() && this.properties[classframes[j].property]) {\r\n\t\t\t\tfor (let i = 0; i < this.properties[classframes[j].property].values.length; i += 1) {\r\n\t\t\t\t\tthis.properties[classframes[j].property].values[i].loadClassFrames(classframes[j].frame);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn this;\r\n};\r\n\r\n/**\r\n * Does this object have a schema loaded?\r\n */\r\nObjectFrame.prototype.hasSchema = function () {\r\n\treturn !FrameHelper.empty(this.classframes);\r\n};\r\n\r\n/*\r\n * Loads an array of data frames into the object's internal index\r\n * {property: [frames]}\r\n */\r\nObjectFrame.prototype.loadDataFrames = function (frames) {\r\n\tif (typeof frames !== 'object' || !frames.length) return undefined;\r\n\tif (!this.originalFrames) this.originalFrames = frames;\r\n\tif (!this.subjid && frames[0].domainValue) this.subjid = frames[0].domainValue;\r\n\tfor (let i = 0; i < frames.length; i += 1) {\r\n\t\tif (frames[i]['@context']) this.jsonld_context = frames[i]['@context'];\r\n\t\tlet cframe = this.getPropertyClassFrame(frames[i].property, frames[i]);\r\n\t\tif (cframe.isClassChoice()) {\r\n\t\t\tcframe = cframe.getChosenClassFrame(frames[i].range);\r\n\t\t\tif (!cframe) {\r\n\t\t\t\tconsole.log(`no choice frame ${frames[i].range}`);\r\n\t\t\t}\r\n\t\t} else if (cframe.isLogic()) {\r\n\t\t\tcframe = cframe.getChosenFrame(frames[i]);\r\n\t\t}\r\n\t\tif (cframe) {\r\n\t\t\tif (typeof this.properties[frames[i].property] === 'undefined') {\r\n\t\t\t\tthis.properties[frames[i].property] = new PropertyFrame(frames[i].property, cframe, this);\r\n\t\t\t}\r\n\t\t\tthis.properties[frames[i].property].addFrame(frames[i]);\r\n\t\t}\r\n\t}\r\n\treturn this;\r\n};\r\n\r\n/*\r\n * Serialises the javascript object as an array of frames\r\n */\r\nObjectFrame.prototype.getAsFrame = function (prop, parent) {\r\n\tif (this.parentframe) return this.parentframe;\r\n\tconst ff = { type: 'objectProperty', property: prop };\r\n\tff.range = this.cls;\r\n\tff.domain = parent.cls;\r\n\tff.domainValue = parent.subjid;\r\n\tff.frame = [];\r\n\tfor (const prop of Object.keys(this.properties)) {\r\n\t\tff.frame = ff.frame.concat(ff.frame, this.properties[prop].getAsFrames());\r\n\t}\r\n\treturn ff;\r\n};\r\n\r\nObjectFrame.prototype.getAsFrames = function (prop, parent) {\r\n\tvar frames = [];\r\n\tfor (const prop of Object.keys(this.properties)) {\r\n\t\tframes = frames.concat(frames, this.properties[prop].getAsFrames());\r\n\t}\r\n\treturn frames;\r\n}\r\n\r\nObjectFrame.prototype.isnew = function () {\r\n\treturn this.newDoc;\r\n};\r\n\r\n/**\r\n * Cleans out object and sets everything empty\r\n */\r\nObjectFrame.prototype.empty = function () {\r\n\t// all indexed by property\r\n\tthis.properties = {};\r\n\tthis.restrictions = {};\r\n\tthis.subjid = false;\r\n\tthis.cls = false;\r\n};\r\n\r\n/*\r\n * Resets object state to original state\r\n */\r\nObjectFrame.prototype.reset = function (prop) {\r\n\tif (prop) {\r\n\t\tconst props = [];\r\n\t\tfor (let i = 0; i < this.originalFrames.length; i += 1) {\r\n\t\t\tif (this.originalFrames[i].property === prop) {\r\n\t\t\t\tprops.push(this.originalFrames[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (this.properties[prop]) this.properties[prop] = [];\r\n\t\tthis.loadDataFrames(props);\r\n\t} else {\r\n\t\tthis.restrictions = {};\r\n\t\tthis.properties = {};\r\n\t\tthis.loadDataFrames(this.originalFrames);\r\n\t}\r\n};\r\n\r\n/*\r\n * Clears out any specific information from a tree\r\n */\r\nObjectFrame.prototype.clear = function () {\r\n\tfor (const prop of Object.keys(this.properties)) {\r\n\t\tthis.properties[prop].clear();\r\n\t}\r\n\treturn this;\r\n};\r\n\r\n/*\r\n * Filters the frame and its children\r\n */\r\nObjectFrame.prototype.filter = function (rules, onmatch, options) {\r\n\tconst cascading = (options && options.ignore_failure ? true : false);\r\n\tvar hits = FramePattern.FramePatternMatcher.testRules(rules, this, onmatch);\r\n\t//if(hits.length || cascading){\r\n\t\tfor (const prop of Object.keys(this.properties)) {\r\n\t\t\tthis.properties[prop].filter(rules, onmatch, options);\r\n\t\t}\r\n\t//}\r\n\treturn this;\r\n};\r\n\r\n\r\n/**\r\n * If a class frame is present, it is returned for the given property\r\n * If no class frame is present and an instance frame is passed in the\r\n * this enables make it up as you go along editing\r\n * second argument a class frame will be created from the instance frame.\r\n */\r\nObjectFrame.prototype.getPropertyClassFrame = function (prop, instance) {\r\n\tif (this.classframes && typeof this.classframes === 'object' && typeof this.classframes[prop] === 'object') {\r\n\t\treturn this.classframes[prop];\r\n\t}\r\n\tif (instance) {\r\n\t\tconst cf = new ClassFrame(instance);\r\n\t\treturn cf;\r\n\t}\r\n\tif (this.properties[prop]) {\r\n\t\treturn new ClassFrame(this.properties[prop].values[0]);\r\n\t}\r\n\treturn false;\r\n};\r\n\r\n/*\r\n * Returns a list of properties - type can be filled|missing|all\r\n */\r\nObjectFrame.prototype.getProperties = function (type) {\r\n\tif(type == \"filled\" || !this.classframes){\r\n\t\treturn Object.keys(this.properties);\r\n\t}\r\n\tif (type == 'missing') {\r\n\t\tconst filled = Object.keys(this.properties);\r\n\t\tconst all = Object.keys(this.classframes);\r\n\t\tconst missing = [];\r\n\t\tfor (let i = 0; i < all.length; i++) {\r\n\t\t\tif (filled.indexOf(all[i]) == -1 && missing.indexOf(all[i]) == -1) {\r\n\t\t\t\tmissing.push(all[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn missing;\r\n\t}\r\n\treturn Object.keys(this.classframes);\r\n};\r\n\r\n/**\r\n * Missing properties are those that are present in the classframe,\r\n * but not instantiated in the current object frame\r\n * for this to work we need to load the frame with the associated classframe\r\n */\r\nObjectFrame.prototype.getMissingPropertyList = function () {\r\n\tvar missing = this.getProperties(\"missing\");\r\n\tconst nmissing = [];\r\n\tfor (let i = 0; i < missing.length; i++) {\r\n\t\tconst cframe = this.getPropertyClassFrame(missing[i]);\r\n\t\tconst newb = { label: cframe.getLabel(), value: missing[i] };\r\n\t\tnmissing.push(newb);\r\n\t}\r\n\treturn nmissing;\r\n};\r\n\r\n/**\r\n * List of properties that are filled in the object\r\n */\r\nObjectFrame.prototype.getFilledPropertyList = function () {\r\n\tvar props = this.getProperties(\"filled\");\r\n\tconst filled = [];\r\n\tfor (let i = 0; i < props.length; i++) {\r\n\t\tconst cframe = this.getPropertyClassFrame(props[i]);\r\n\t\tconst newb = { label: cframe.getLabel(), value: props[i] };\r\n\t\tfilled.push(newb);\r\n\t}\r\n\treturn filled;\r\n};\r\n\r\n/*\r\n * Fills the object frame from the schema - adding all the necessary property frames, etc to make it complete\r\n */\r\nObjectFrame.prototype.fillFromSchema = function (newid) {\r\n\tif (newid) this.subjid = newid;\r\n\tnewid = (newid || FrameHelper.genBNID());\r\n\tconst properties = {};\r\n\tfor (const prop of Object.keys(this.classframes)) {\r\n\t\tconst pf = this.getPropertyClassFrame(prop);\r\n\t\tproperties[prop] = new PropertyFrame(prop, pf);\r\n\t\tproperties[prop].fillFromSchema(newid);\r\n\t}\r\n\tthis.properties = properties;\r\n\tthis.originalFrames = [];\r\n\tfor (const prop of Object.keys(this.properties)) {\r\n\t\tthis.originalFrames.push(this.properties[prop].getAsFrames());\r\n\t}\r\n\treturn this;\r\n};\r\n\r\n/*\r\n * Clones an object frame to be a copy of the current frame\r\n */\r\nObjectFrame.prototype.clone = function (newid) {\r\n\tconst properties = {};\r\n\tconst cloned = new ObjectFrame(this.cls, false, false, this.parent);\r\n\tcloned.classframes = this.classframes;\r\n\tcloned.subjid = newid;\r\n\tfor (const prop of Object.keys(this.properties)) {\r\n\t\tproperties[prop] = this.properties[prop].clone();\r\n\t}\r\n\tcloned.properties = properties;\r\n\treturn cloned;\r\n};\r\n\r\n\r\n/**\r\n * Returns a child frame with a particular id\r\n * If the second parameter is included, it will only look in that specific property\r\n * Otherwise searches all properties for the child\r\n */\r\nObjectFrame.prototype.getChild = function (childid, prop) {\r\n\tlet pframe = this.getProperty(prop);\r\n\tfor (let i = 0; i < pframe.values.length; pframe++) {\r\n\t\tif (pframe.values[i].isObject() && pframe.values[i].subject === childid) return pframe.values[i];\r\n\t}\r\n\tif (!prop) {\r\n\t\tfor (const key of Object.keys(this.properties)) {\r\n\t\t\tfor (let i = 0; i < this.properties[key].values.length; i += 1) {\r\n\t\t\t\tif (this.properties[key].values[i].subject() === childid) return this.properties[key].values[i];\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nObjectFrame.prototype.addProperty = function (prop, cls) {\r\n\tconst cframe = this.getPropertyClassFrame(prop);\r\n\tconst nprop = new PropertyFrame(prop, cframe);\r\n\tif (nprop.isData()) {\r\n\t\tconst df = cframe.copy();\r\n\t\tdf.set('');\r\n\t}\r\n\tif (cframe.isObject()) {\r\n\t\tif (!cframe.isClassChoice()) {\r\n\t\t\tconst df = cframe.createEmpty(FrameHelper.genBNID());\r\n\t\t}\r\n\t\tif (cls) {\r\n\t\t\tconst df = cframe.createEmptyChoice(cls, FrameHelper.genBNID());\r\n\t\t}\r\n\t\tconst clss = cframe.getClassChoices();\r\n\t\tif (clss && clss.length) {\r\n\t\t\tconst df = cframe.createEmptyChoice(clss[0], FrameHelper.genBNID());\r\n\t\t}\r\n\t}\r\n\tif (typeof this.properties[prop] === 'undefined') {\r\n\t\tthis.properties[prop] = [];\r\n\t}\r\n\tthis.properties[prop].push(df);\r\n\treturn df;\r\n};\r\n\r\nObjectFrame.prototype.addPropertyValue = function (prop, value) {\r\n\tconst pframe = this.properties[prop];\r\n\treturn pframe.addValue(value);\r\n};\r\n\r\nObjectFrame.prototype.removeProperty = function (prop) {\r\n\tif (typeof this.properties[prop] !== 'undefined') {\r\n\t\tdelete (this.properties[prop]);\r\n\t}\r\n};\r\n\r\nObjectFrame.prototype.removePropertyValue = function (prop, value, index) {\r\n\tconst pframe = this.properties[prop];\r\n\tpframe.removeValue(value, index);\r\n\tif (pframe.values.length == 0) {\r\n\t\tthis.removeProperty(prop);\r\n\t}\r\n};\r\n\r\nObjectFrame.prototype.error = function (msg) {\r\n\tconsole.error(msg);\r\n};\r\n\r\n\r\nObjectFrame.prototype.subject = function () {\r\n\treturn this.subjid;\r\n};\r\n\r\nObjectFrame.prototype.get = ObjectFrame.prototype.subject;\r\n\r\nObjectFrame.prototype.isObject = function () { return true; };\r\nObjectFrame.prototype.isProperty = function () { return false; };\r\nObjectFrame.prototype.isData = function () { return false; };\r\n\r\n\r\nObjectFrame.prototype.subjectClass = function () {\r\n\treturn this.cls;\r\n};\r\n\r\nObjectFrame.prototype.depth = function () {\r\n\tif (this.parent) return (this.parent.depth() + 1);\r\n\treturn 0;\r\n};\r\n\r\nObjectFrame.prototype.getProperty = function (prop) {\r\n\treturn this.properties[prop];\r\n};\r\n\r\nObjectFrame.prototype.first = function (prop) {\r\n\tif (this.properties && this.properties[prop]) {\r\n\t\treturn this.properties[prop].first();\r\n\t}\r\n};\r\n\r\nObjectFrame.prototype.property = function (prop) {\r\n\tif (this.parent) return this.parent.property();\r\n\treturn false;\r\n};\r\n\r\nObjectFrame.prototype.parentObject = function () {\r\n\tif (this.parent && this.parent.parent) {\r\n\t\treturn this.parent.parent;\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nObjectFrame.prototype.root = function () {\r\n\tif (this.parent) return false;\r\n\treturn true;\r\n};\r\n\r\nObjectFrame.prototype.renderProperties = function () {\r\n\tconst props = this.sortProperties();\r\n\tconst nprops = [];\r\n\tfor (let i = 0; i < props.length; i++) {\r\n\t\tif (this.properties[props[i]].render) {\r\n\t\t\tconst rend = this.properties[props[i]].render(this.properties[props[i]]);\r\n\t\t\tif (rend) nprops.push(rend);\r\n\t\t}\r\n\t}\r\n\treturn nprops;\r\n};\r\n\r\nObjectFrame.prototype.sortProperties = function () {\r\n\tconst unsorted = Object.keys(this.properties);\r\n\tif (this.compare) {\r\n\t\treturn unsorted.sort((a, b) => this.compare(a, b, this));\r\n\t}\r\n\treturn unsorted.sort((a, b) => this.standardCompare(a, b, this));\r\n};\r\n\r\n/*\r\n * Label first, then datatype properties, then object properties\r\n */\r\nObjectFrame.prototype.standardCompare = function (a, b, doc) {\r\n\tif (a == 'rdfs:label') return -1;\r\n\tif (b == 'rdfs:label') return 1;\r\n\tif (a == 'rdfs:comment') return -1;\r\n\tif (b == 'rdfs:comment') return 1;\r\n\tif (doc.properties[a].isData() && doc.properties[b].isObject()) return -1;\r\n\tif (doc.properties[b].isData() && doc.properties[a].isObject()) return 1;\r\n\treturn 0;\r\n};\r\n\r\nObjectFrame.prototype.cardControlAllows = function(action){\r\n\tif(!this.parent) return true;\r\n\tif(this.parent.cframe.hasRestriction()){\r\n\t\tvar rest = this.parent.cframe.restriction;\r\n\t\tvar currentnum = this.parent.values.length;\r\n\t\tif(action == \"add\" || action == \"clone\"){\r\n\t\t\tif(rest.max && currentnum >= rest.max){\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(action == \"delete\" && (rest.min && currentnum <= rest.min)){\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nObjectFrame.prototype.isUpdated = function(){\r\n\tvar i = 0;\r\n\tfor(var prop in this.properties){\r\n\t\tif(this.originalFrames[i] != prop) return true;\r\n\t\tif(this.properties[prop].isUpdated()) return true;\r\n\t\ti++;\r\n\t}\r\n\tif(i != this.originalFrames.length) return true;\r\n\treturn false;\r\n}\r\n\r\n\r\nObjectFrame.prototype.getSummary = function(){\r\n\tvar ret = { status: \"ok\" };\r\n\tif(this.isUpdated()) ret.status = \"updated\";\r\n\tif(this.isNew()) ret.status = \"new\";\r\n\tret.propcount = 0;\r\n\tfor(var prop in this.properties){\r\n\t\tret.propcount++;\r\n\t}\r\n\tret.long = ret.propcount + \" properties\";\r\n\treturn ret;\r\n}\r\n\r\nfunction PropertyFrame(property, cframe, parent) {\r\n\tthis.predicate = property;\r\n\tthis.cframe = cframe;\r\n\tthis.parent = parent;\r\n\tthis.values = [];\r\n}\r\n\r\nPropertyFrame.prototype.addFrame = function (frame) {\r\n\tif(this.cframe.isData()){\r\n\t\tvar df = new DataFrame(frame, this, this.values.length);\r\n\t\tthis.values.push(df);\r\n\t} else {\r\n\t\tconst kid = new ObjectFrame(this.range(), cframe.frame, frame.frame, this, frame);\r\n\t\tthis.values.push(kid);\r\n\t}\r\n};\r\n\r\nPropertyFrame.prototype.fillFromSchema = function (newid) {\r\n\tif (this.isData() || (this.isObject() && !this.isClassChoice())) {\r\n\t\tif (this.cframe.hasRestriction() && this.cframe.restriction.min) {\r\n\t\t\tvalues = [];\r\n\t\t\tfor (let i = 0; i < this.cframe.restriction.min; i += 1) {\r\n\t\t\t\tvalues.push(this.createEmpty(newid));\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tvalues = [this.createEmpty(newid)];\r\n\t\t}\r\n\t} else if (this.isClassChoice()) {\r\n\t\tconst clss = this.getClassChoices();\r\n\t\tif (clss && clss.length) {\r\n\t\t\tconst empty = this.createEmptyChoice(clss[0], FrameHelper.genBNID());\r\n\t\t\tvalues = [empty];\r\n\t\t}\r\n\t}\r\n\tthis.values = values;\r\n};\r\n\r\nPropertyFrame.prototype.isData = function () {\r\n\treturn this.cframe.isData();\r\n};\r\n\r\nPropertyFrame.prototype.isObject = function () {\r\n\treturn this.cframe.isObject();\r\n};\r\n\r\nPropertyFrame.prototype.isProperty = function () {\r\n\treturn true;\r\n};\r\n\r\nPropertyFrame.prototype.property = function () {\r\n\treturn this.predicate;\r\n};\r\n\r\nPropertyFrame.prototype.extract = function () {\r\n \tconst extracts = [];\r\n \tfor (let i = 0; i < this.values.length; i++) {\r\n \t\tconst val = this.values[i].extract();\r\n \t\tif (val !== '' && val !== false && typeof val !== 'undefined') extracts.push(val);\r\n \t}\r\n\treturn extracts;\r\n};\r\n\r\nPropertyFrame.prototype.subject = function () {\r\n\treturn (this.parent ? this.parent.subject() : false);\r\n};\r\nPropertyFrame.prototype.subjectClass = function () {\r\n\treturn (this.parent ? this.parent.subjectClass() : false);\r\n};\r\nPropertyFrame.prototype.depth = function () {\r\n\treturn (this.parent ? this.parent.depth() : false);\r\n};\r\nPropertyFrame.prototype.updated = function () {\r\n\treturn (this.parent ? this.parent.childUpdated() : false);\r\n};\r\nPropertyFrame.prototype.range = function () {\r\n\treturn (this.cframe ? this.cframe.range : '');\r\n};\r\nPropertyFrame.prototype.getLabel = function () {\r\n\treturn (\r\n\t\tthis.cframe ? this.cframe.getLabel() : '');\r\n};\r\nPropertyFrame.prototype.getComment = function () {\r\n\treturn (this.cframe ? this.cframe.getComment() : false);\r\n};\r\nPropertyFrame.prototype.hasCardinalityRestriction = function () {\r\n\treturn (this.cframe ? this.cframe.hasRestriction() : false);\r\n};\r\nPropertyFrame.prototype.getRestriction = function () {\r\n\treturn (this.cframe ? this.cframe.restriction : false);\r\n};\r\nPropertyFrame.prototype.isClassChoice = function () {\r\n\treturn (this.cframe ? this.cframe.isClassChoice() : false);\r\n};\r\n\r\nPropertyFrame.prototype.deletePropertyValue = function (value, index) {\r\n\tthis.parent.removePropertyValue(this.property(), value, index);\r\n};\r\n\r\nPropertyFrame.prototype.get = function(){\r\n\tvar gets = [];\r\n\tfor(var i = 0; i<this.values.length; i++){\r\n\t\tif(this.values[i]) {\r\n\t\t\tvar x = this.values[i].get();\r\n\t\t\tif(x) gets.push(x);\r\n\t\t}\r\n\t}\r\n\treturn gets;\r\n}\r\n\r\nPropertyFrame.prototype.clear = function(){\r\n\tfor(var i = 0 ; i<this.values.length; i++){\r\n\t\tthis.values[i].clear();\r\n\t}\r\n}\r\n\r\nPropertyFrame.prototype.clone = function(){\r\n\tconst cvalues = [];\r\n\tconst cloned = new PropertyFrame(this.predicate, this.cframe, this.parent);\r\n\tfor(var i = 0 ; i<this.values.length; i++){\r\n\t\tcvalues.push(this.values[i].clone());\r\n\t}\r\n\tcloned.values = cvalues;\r\n\treturn cloned;\r\n\t//\r\n}\r\n\r\nPropertyFrame.prototype.getAsFrames = function(){\r\n\tvar fs = [];\r\n\tfor(var i = 0; i<this.values.length; i++){\r\n\t\tif(this.values[i]){\r\n\t\t\tif(this.isData()){\r\n\t\t\t\tfs.push(this.values[i].getAsFrame());\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tfs = fs.concat(this.values[i].getAsFrames());\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn fs;\r\n}\r\n\r\nPropertyFrame.prototype.createEmpty = function(){\r\n\tif (this.cframe.isData()) {\r\n\t\tconst df = this.cframe.copy();\r\n\t\tdf.set('');\r\n\t\treturn df;\r\n\t}\r\n\telse if (this.cframe.isObject()) {\r\n\t\tif (!this.cframe.isClassChoice()) {\r\n\t\t\tconst df = this.cframe.createEmpty(FrameHelper.genBNID());\r\n\t\t\treturn df;\r\n\t\t}\r\n\t\tconst clss = this.cframe.getClassChoices();\r\n\t\tif (clss && clss.length) {\r\n\t\t\tconst df = this.cframe.createEmptyChoice(clss[0], FrameHelper.genBNID());\r\n\t\t\treturn df;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nPropertyFrame.prototype.filter = function (rules, onmatch, options) {\r\n\tconst cascading = (options && options.ignore_failure ? true : false);\r\n\tvar hits = FramePattern.FramePatternMatcher.testRules(rules, this, onmatch);\r\n\t//if(hits.length || cascading){\r\n\t\tfor (var i = 0; i<this.values.length; i++){\r\n\t\t\tthis.values[i].filter(rules, onmatch, options);\r\n\t\t}\r\n\t//}\r\n\treturn this;\r\n}\r\n\r\n/*\r\n * Shorthand functions to make it easier to access the underlying data\r\n */\r\n\r\nPropertyFrame.prototype.first = function () {\r\n\tif (this.values && this.values[0]) {\r\n\t\treturn this.values[0].get();\r\n\t}\r\n};\r\n\r\nPropertyFrame.prototype.renderValues = function(){\r\n\tvar sortedVals = this.sortValues();\r\n\tvar vals = [];\r\n\tfor(var i = 0; i<sortedVals.length; i++){\r\n\t\tif(sortedVals[i] && sortedVals[i].render){\r\n\t\t\tvar rend = sortedVals[i].render(sortedVals[i]);\r\n\t\t\tif(rend) vals.push(rend);\r\n\t\t}\r\n\t}\r\n\treturn vals;\r\n};\r\n\r\nPropertyFrame.prototype.sortValues = function () {\r\n\tif (this.compare) {\r\n\t\treturn this.values.sort((a, b) => this.compare(a, b, this));\r\n\t}\r\n\treturn this.values;\r\n};\r\n\r\nPropertyFrame.prototype.cardControlAllows = function(action){\r\n\tif(this.cframe.hasRestriction()){\r\n\t\tvar rest = this.cframe.restriction;\r\n\t\tvar currentnum = this.values.length;\r\n\t\tif(action == \"add\" || action == \"clone\"){\r\n\t\t\tif(rest.max && currentnum >= rest.max){\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(action == \"delete\" && (rest.min)){\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nPropertyFrame.prototype.isUpdated = function(){\r\n\treturn true;\r\n\tif(this.values.length != this.originalValues.length) return true;\r\n\tfor(var i = 0 ; i < this.values.length; i++){\r\n\t\tif(this.cframe && this.cframe.isData()){\r\n\t\t\tif(this.values[i].value() != this.originalValues[i]){\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tif(this.values[i].subject() != this.originalValues[i]) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\tif(this.values[i].isUpdated()) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\n\r\nfunction DataFrame(frame, parent, index) {\r\n\tthis.err = false;\r\n\tthis.parent = parent;\r\n\t// the id of the object that owns this dataframe\r\n\tthis.subjid = (parent ? parent.subjid : false);\r\n\tthis.index = index;\r\n\tif (frame) {\r\n\t\tthis.load(frame);\r\n\t}\r\n}\r\n\r\nDataFrame.prototype.load = function (frame) {\r\n\tif (typeof frame !== 'object') {\r\n\t\tthis.error('No frame passed to load');\r\n\t\treturn;\r\n\t}\r\n\t// all the meta-data carried in frames:\r\n\tthis.type = frame.type;\r\n\tthis.predicate = frame.property;\r\n\tthis.range = frame.range;\r\n\tthis.rangeValue = frame.rangeValue;\r\n\tthis.domain = frame.domain;\r\n\tthis.domainValue = frame.domainValue;\r\n\tthis.frame = frame.frame;\r\n\tthis.label = frame.label;\r\n\tthis.comment = frame.comment;\r\n\tconst { restriction } = frame;\r\n\tthis.restriction = false;\r\n\tif (restriction && typeof restriction === 'object') {\r\n\t\tthis.restriction = new Restriction(restriction);\r\n\t}\r\n};\r\n\r\nDataFrame.prototype.filter = function (rules, onmatch) {\r\n\tFramePattern.FramePatternMatcher.testRules(rules, this, onmatch);\r\n\treturn this;\r\n};\r\n\r\nDataFrame.prototype.delete = function () {\r\n\tthis.parent.deletePropertyValue(this.get(), this.index);\r\n};\r\n\r\nDataFrame.prototype.save = function () {\r\n\tif (this.parent) {\r\n\t\tthis.parent.save();\r\n\t}\r\n};\r\n\r\nDataFrame.prototype.reset = function () {\r\n\tthis.set(this.originalValue);\r\n\t// this.redraw();\r\n};\r\n\r\nDataFrame.prototype.clone = function () {\r\n\tconst newb = this.parent.addPropertyValue(this.get());\r\n\tconst nrend = this.copy(newb);\r\n\tnrend.setNew();\r\n\tnrend.mode = 'edit';\r\n\tnrend.index = this.parent.values.length;\r\n\tthis.parent.values.push(nrend);\r\n};\r\n\r\n\r\nDataFrame.prototype.depth = function () { return (this.parent ? this.parent.depth() : false); };\r\nDataFrame.prototype.property = function () { return (this.parent ? this.parent.property() : false); };\r\nDataFrame.prototype.subject = function () { return (this.parent ? this.parent.subject() : false); };\r\nDataFrame.prototype.subjectClass = function () { return (this.parent ? this.parent.subjectClass() : false); };\r\nDataFrame.prototype.range = function () {\treturn (this.frame ? this.frame.range : false); };\r\n\r\nDataFrame.prototype.isValidType = function (dt) {\r\n\tconst vtypes = ['datatypeProperty', 'objectProperty', 'restriction '];\r\n\tif (vtypes.indexOf(dt) === -1) return false;\r\n\treturn true;\r\n};\r\n\r\n\r\nDataFrame.prototype.getAsFrame = function () {\r\n\t const ff = { type: this.type, property: this.property() };\r\n\t if (this.range) ff.range = this.range;\r\n\t if (this.rangeValue) ff.rangeValue = this.rangeValue;\r\n\t if (this.domain) ff.domain = this.domain;\r\n\t if (this.domainValue) ff.domainValue = this.domainValue;\r\n\t if (this.frame) ff.frame = this.frame;\r\n\t if (this.label) ff.label = this.label;\r\n\t if (this.comment) ff.comment = this.comment;\r\n\t return ff;\r\n};\r\n\r\nDataFrame.prototype.hasRestriction = function () {\r\n\t if (this.restriction) {\r\n\t\t return this.restriction.hasCardRestriction();\r\n\t }\r\n\t return false;\r\n};\r\n\r\nDataFrame.prototype.copy = function (newid) {\r\n\tconst copy = new DataFrame(this, this.parent);\r\n\tif (newid) copy.domainValue = newid;\r\n\treturn copy;\r\n};\r\n\r\nDataFrame.prototype.getLabel = function () {\r\n\tlet lab = '';\r\n\tif(this.predicate == \"rdfs:label\") return \"Label\";\r\n\tif(this.predicate == \"rdfs:comment\") return \"Comment\";\r\n\tif (this.label && typeof this.label === 'object') lab = this.label['@value'];\r\n\tif (this.label && typeof this.label === 'string') lab = this.label;\r\n\t// always return something\r\n\tif (!lab && this.property()) lab = FrameHelper.labelFromURL(this.property());\r\n\tif (!lab) lab = FrameHelper.labelFromURL(this.cls);\r\n\treturn lab;\r\n};\r\n\r\nDataFrame.prototype.getType = function () {\r\n\tif (this.range) return this.range;\r\n\tif (this.rangeValue && this.rangeValue.type) return this.rangeValue.type;\r\n\treturn false;\r\n};\r\n\r\nObjectFrame.prototype.getLabel = DataFrame.prototype.getLabel;\r\n\r\nDataFrame.prototype.getComment = function () {\r\n\tlet comment = '';\r\n\tif (this.comment && typeof this.comment === 'object') comment = this.comment['@value'];\r\n\tif (this.comment && typeof this.comment === 'string') comment = this.comment;\r\n\treturn comment;\r\n};\r\n\r\nObjectFrame.prototype.getComment = DataFrame.prototype.getComment;\r\n\r\n\r\nDataFrame.prototype.error = function (msg) {\r\n\tif (msg)\tthis.err = msg;\r\n\treturn this.err;\r\n};\r\n\r\nDataFrame.prototype.isValid = function () {\r\n\tif (!(this.type && this.isValidType(this.type))) {\r\n\t\tthis.error(`Missing or Illegal Frame Type ${this.type}`);\r\n\t\treturn false;\r\n\t}\r\n\tif (!(this.predicate)) {\r\n\t\tthis.error('Missing Frame Property');\r\n\t\treturn false;\r\n\t}\r\n\tif (!(this.domain)) {\r\n\t\tthis.error('Missing Frame Domain');\r\n\t\treturn false;\r\n\t}\r\n\tif (!(this.range)) {\r\n\t\tthis.error('Missing Frame Range');\r\n\t\treturn false;\r\n\t}\r\n\tif (this.isObjectProperty() && !(this.frame && typeof this.frame === 'object')) {\r\n\t\tthis.error('Missing Object Frame');\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n};\r\n\r\nDataFrame.prototype.isObjectProperty = function () {\r\n\treturn this.type === 'objectProperty';\r\n};\r\n\r\nDataFrame.prototype.isDatatypeProperty = function () {\r\n\treturn this.type === 'datatypeProperty';\r\n};\r\n\r\nDataFrame.prototype.isLogic = function () {\r\n\tif (this.type === 'and' || this.type === 'or' || this.type === 'xor') {\r\n\t\treturn true;\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nDataFrame.prototype.isRestriction = function () {\r\n\treturn this.type === 'restriction';\r\n};\r\n\r\nDataFrame.prototype.ftype = function () {\r\n\tif (this.isDocument()) return 'document';\r\n\tif (this.isDatatypeProperty()) return 'data';\r\n\tif (this.isChoice()) return 'oneOf';\r\n\tif (this.isObject()) return 'object';\r\n\tif (this.isLogic()) return 'logic';\r\n\tif (this.isClassChoice()) return 'class_choice';\r\n\treturn undefined;\r\n};\r\n\r\n\r\nDataFrame.prototype.isClassChoice = function () {\r\n\treturn (this.frame && this.frame.type === 'class_choice');\r\n};\r\n\r\nDataFrame.prototype.isString = function () {\r\n\tif (this.range === FrameHelper.getStdURL('xsd', 'string')) {\r\n\t\treturn true;\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nDataFrame.prototype.getChoiceOptions = function () {\r\n\tconst opts = [];\r\n\tfor (let i = 0; i < this.frame.elements.length; i += 1) {\r\n\t\tconst option = {};\r\n\t\tif (this.frame.elements[i].label) {\r\n\t\t\toption.label = this.frame.elements[i].label['@value'];\r\n\t\t} else {\r\n\t\t\toption.label = FrameHelper.labelFromURL(this.frame.elements[i].class);\r\n\t\t}\r\n\t\toption.value = this.frame.elements[i].class;\r\n\t\topts.push(option);\r\n\t}\r\n\treturn opts;\r\n};\r\n\r\nDataFrame.prototype.lang = function () {\r\n\treturn 'en';\r\n};\r\n\r\nDataFrame.prototype.isChoice = function () {\r\n\treturn (this.frame && this.frame.type === 'oneOf');\r\n};\r\n\r\nDataFrame.prototype.isDocument = function () {\r\n\treturn (this.frame && this.frame.type === 'document');\r\n};\r\n\r\nDataFrame.prototype.isData = function () {\r\n\treturn (this.isDocument() || this.isChoice() || this.isDatatypeProperty());\r\n};\r\n\r\nDataFrame.prototype.isObject = function () {\r\n\treturn (this.isObjectProperty() && this.frame && !(this.isChoice() || this.isDocument()));\r\n};\r\n\r\nDataFrame.prototype.isProperty = function () {\r\n\treturn false;\r\n};\r\n\r\nDataFrame.prototype.getTypeShorthand = function () {\r\n\tif (this.isDocument()) return 'document';\r\n\tif (this.isChoice()) return 'choice';\r\n\tconst sh = FrameHelper.getShorthand(this.getType());\r\n\treturn (sh || this.getType());\r\n};\r\n\r\nDataFrame.prototype.get = function () {\r\n\tif (this.contents) {\r\n\t\treturn this.contents;\r\n\t}\r\n\tif (this.isDatatypeProperty() && this.rangeValue && typeof this.rangeValue['@value'] !== 'undefined') {\r\n\t\treturn this.rangeValue['@value'];\r\n\t}\r\n\tif (this.isChoice() || this.isDocument()) {\r\n\t\treturn this.frame.domainValue;\r\n\t}\r\n\treturn '';\r\n};\r\n\r\nDataFrame.prototype.set = function (value, normalizer) {\r\n\tif (normalizer) value = normalizer(value, this);\r\n\tthis.contents = value;\r\n\tif (this.isChoice() || this.isDocument()) {\r\n\t\tthis.frame.domainValue = value;\r\n\t}\r\n\tif (this.isDatatypeProperty() && this.rangeValue) {\r\n\t\tthis.rangeValue['@value'] = value;\r\n\t}\r\n};\r\n\r\nDataFrame.prototype.clear = function () {\r\n\tif (this.isDocument() || this.isChoice() || this.isDatatypeProperty()) {\r\n\t\tthis.set('');\r\n\t}\r\n};\r\n\r\nDataFrame.prototype.cardControlAllows = function(action){\r\n\tif(this.parent.cframe.hasRestriction()){\r\n\t\tvar rest = this.parent.cframe.restriction;\r\n\t\tvar currentnum = this.parent.values.length;\r\n\t\tif(action == \"add\" || action == \"clone\"){\r\n\t\t\tif(rest.max && currentnum >= rest.max){\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(action == \"delete\" && (rest.min && currentnum <= rest.min)){\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\treturn true;\r\n}\r\n\r\n\r\n/*\r\n * Class frames represent the archetypal version of a property frame as returned by the class frame api\r\n */\r\nfunction ClassFrame(frame, parent) {\r\n\tthis.err = false;\r\n\tthis.parent = parent;\r\n\t// the id of the object that owns this dataframe\r\n\tthis.subjid = (parent ? parent.subjid : false);\r\n\tif (frame) {\r\n\t\tthis.load(frame);\r\n\t}\r\n}\r\n\r\nClassFrame.prototype = DataFrame.prototype;\r\n\r\nClassFrame.prototype.loadFromObjectFrame = function (par, child) {\r\n\t// all the meta-data carried in frames:\r\n\tthis.type = 'objectProperty';\r\n\tthis.predicate = par.property;\r\n\tthis.range = par.range;\r\n\tthis.rangeValue = child.subjid;\r\n\tthis.domain = par.cls;\r\n\tthis.domainValue = par.subjid;\r\n\tthis.label = par.getLabel();\r\n\tthis.comment = par.getComment();\r\n\tthis.restriction = par.restriction;\r\n};\r\n\r\nClassFrame.prototype.createEmptyChoice = function (cls, newid) {\r\n\tconst cf = this.getChosenClassFrames(cls);\r\n\tconst objframe = new ObjectFrame(cls);\r\n\tif (newid) objframe.subjid = newid;\r\n\tobjframe.loadClassFrames(cf);\r\n\tconst fframe = objframe.fillFromSchema();\r\n\treturn fframe;\r\n};\r\n\r\nClassFrame.prototype.getChosenClassFrames = function (chosen) {\r\n\tlet nc = [];\r\n\tfor (let i = 0; i < this.frame.operands.length; i += 1) {\r\n\t\tfor (let j = 0; j < this.frame.operands[i].length; j += 1) {\r\n\t\t\tif (chosen === this.frame.operands[i][j].domain) {\r\n\t\t\t\tnc = nc.concat(this.frame.operands[i][j]);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn nc;\r\n};\r\n\r\nClassFrame.prototype.createEmpty = function (newid) {\r\n\tif (this.isObject()) {\r\n\t\tconst objframe = new ObjectFrame(this.range);\r\n\t\tif (newid) objframe.subjid = newid;\r\n\t\tobjframe.loadClassFrames(this.frame);\r\n\t\tconst fframe = objframe.fillFromSchema();\r\n\t\treturn fframe;\r\n\t}\r\n\tif (this.isData()) {\r\n\t\tconst dataframe = this.copy();\r\n\t\tdataframe.set('');\r\n\t\treturn dataframe;\r\n\t}\r\n\treturn undefined;\r\n};\r\n\r\nClassFrame.prototype.cloneDataFrame = function (newid, other) {\r\n\treturn other;\r\n};\r\n\r\nClassFrame.prototype.clone = function (newid, other) {\r\n\tif (this.isObject()) {\r\n\t\tconsole.log('cannot clone class frame');\r\n\t} else if (this.isData()) {\r\n\t\treturn this.cloneDataFrame(newid, other);\r\n\t}\r\n\treturn undefined;\r\n};\r\n\r\nClassFrame.prototype.getClassChoices = function () {\r\n\tconst choices = [];\r\n\tif (this.frame.operands) {\r\n\t\tfor (let i = 0; i < this.frame.operands.length; i += 1) {\r\n\t\t\tfor (let j = 0; j < this.frame.operands[i].length; j += 1) {\r\n\t\t\t\tconst domcls = this.frame.operands[i][j].domain;\r\n\t\t\t\tif (domcls && choices.indexOf(domcls) === -1) {\r\n\t\t\t\t\tchoices.push(domcls);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn choices;\r\n};\r\n\r\nClassFrame.prototype.getChosenClassFrame = function (chosen) {\r\n\tfor (let i = 0; i < this.frame.operands.length; i += 1) {\r\n\t\tconst operand = this.frame.operands[i];\r\n\t\tif (operand.length) {\r\n\t\t\tfor (let j = 0; j < operand.length; j += 1) {\r\n\t\t\t\tif (operand[j] && (chosen === operand[j].domain)) {\r\n\t\t\t\t\tconst cf = new ClassFrame(operand);\r\n\t\t\t\t\treturn cf;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else if (operand.range && chosen === operand.range) {\r\n\t\t\tconst cf = new ClassFrame(operand);\r\n\t\t\treturn cf;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nClassFrame.prototype.getChosenFrame = function (dataframe) {\r\n\treturn dataframe;\r\n};\r\n\r\n\r\nfunction Restriction(restriction) {\r\n\tthis.min = 0;\r\n\tthis.max = 0;\r\n\tif (restriction) this.loadRestriction(restriction);\r\n}\r\n\r\nRestriction.prototype.hasCardRestriction = function () {\r\n\tif (this.min === 0 && this.max === 0) return false;\r\n\treturn true;\r\n};\r\n\r\nRestriction.prototype.loadRestriction = function (restriction) {\r\n\tif (typeof restriction.cardinality !== 'undefined') {\r\n\t\tthis.max = restriction.cardinality;\r\n\t\tthis.min = restriction.cardinality;\r\n\t} else if (typeof restriction.maxCardinality !== 'undefined') {\r\n\t\tthis.max = restriction.maxCardinality;\r\n\t} else if (typeof restriction.minCardinality !== 'undefined') {\r\n\t\tthis.min = restriction.minCardinality;\r\n\t} else if (typeof restriction.type !== 'undefined' && restriction.type === 'and' && typeof restriction.operands === 'object') {\r\n\t\tfor (let i = 0; i < restriction.operands.length; i += 1) {\r\n\t\t\tconst nrest = new Restriction(restriction.operands[i]);\r\n\t\t\tif (this.max === 0 && nrest.max > 0) this.max = nrest.max;\r\n\t\t\telse if (this.max > 0 && nrest.max > 0 && nrest.max < this.max) this.max = nrest.max;\r\n\t\t\tif (this.min === 0 && nrest.min > 0) this.min = nrest.min;\r\n\t\t\telse if (this.min > 0 && nrest.min > 0 && nrest.min > this.min) this.min = nrest.min;\r\n\t\t}\r\n\t}\r\n};\r\n\r\nmodule.exports = ObjectFrame;\r\n","const FrameHelper = require('./frameHelper');\r\n\r\nfunction WOQLResult(results, query, config) {\r\n\tthis.bindings = results.bindings;\r\n\tif(query.constructor.name == \"WOQLQuery\"){\r\n\t\tthis.query = query;\r\n\t}\r\n\telse {\r\n\t\tthis.query = query.query;\r\n\t}\r\n\tthis.cursor = 0;\r\n\tif (!(config && config.no_compress)) {\r\n\t\tconst context = (config && config.context ? config.context : false);\r\n\t\tthis.compress(context);\r\n\t}\r\n}\r\n\r\nWOQLResult.prototype.compress = function (context) {\r\n\tcontext = (context || this.query.getContext());\r\n\tfor (let i = 0; i < this.bindings.length; i++) {\r\n\t\tfor (const prop of Object.keys(this.bindings[i])) {\r\n\t\t\tconst nprop = FrameHelper.shorten(prop, context);\r\n\t\t\tconst nval = ((typeof this.bindings[i][prop] === 'string')\r\n\t\t\t\t? FrameHelper.shorten(this.bindings[i][prop], context)\r\n\t\t\t\t: this.bindings[i][prop]\r\n\t\t\t);\r\n\t\t\tdelete (this.bindings[i][prop]);\r\n\t\t\tthis.bindings[i][nprop] = nval;\r\n\t\t}\r\n\t}\r\n\treturn this;\r\n}\r\n\r\nWOQLResult.prototype.first = function () {\r\n\tthis.cursor = 0;\r\n\treturn this.bindings[0];\r\n};\r\n\r\nWOQLResult.prototype.last = function(){\r\n\tthis.cursor = this.bindings.length-1;\r\n\treturn this.bindings[this.bindings.length-1];\r\n}\r\n\r\nWOQLResult.prototype.next = function () {\r\n\tconst res = this.bindings[this.cursor];\r\n\tthis.cursor++;\r\n\treturn res;\r\n};\r\n\r\nWOQLResult.prototype.prev = function () {\r\n\tif (this.cursor > 0) {\r\n\t\tthis.cursor--;\r\n\t\treturn this.bindings[this.cursor];\r\n\t}\r\n};\r\n\r\nWOQLResult.prototype.compareValues = function(a, b, asc_or_desc){\r\n\tif(!a || !b) return 0;\r\n\tif(typeof a['@value'] != \"undefined\" && typeof b['@value'] != \"undefined\"){\r\n\t\ta = a['@value'];\r\n\t\tb = b['@value'];\r\n\t}\r\n\tif (a > b) {\r\n\t\treturn (asc_or_desc && asc_or_desc == 'asc' ? 1 : -1);\r\n\t}\r\n\tif (b > a) {\r\n\t\treturn (asc_or_desc && asc_or_desc == 'asc' ? -1 : 1);\r\n\t}\r\n};\r\n\r\nWOQLResult.prototype.sort = function(key, asc_or_desc){\r\n\tthis.bindings.sort((a, b) => {\r\n\t\treturn this.compareValues(a[key], b[key], asc_or_desc);\r\n\t});\r\n\tthis;\r\n}\r\n\r\nWOQLResult.prototype.getVariableList = function () {\r\n\tif (this.bindings && this.bindings[0]) {\r\n\t\treturn Object.keys(this.bindings[0]);\r\n\t}\r\n};\r\n\r\nWOQLResult.prototype.count = function () {\r\n\treturn this.bindings.length;\r\n};\r\n\r\nWOQLResult.prototype.hasBindings = function (result) {\r\n\treturn (this.bindings && this.count());\r\n};\r\n\r\nWOQLResult.prototype.getBindings = function () {\r\n\treturn this.bindings;\r\n};\r\n\r\nmodule.exports = WOQLResult;\r\n","/**\r\n * The WOQL object is a wrapper around the WOQL query object\r\n * Syntactic sugar to allow you to write WOQL.triple()... instead of new WOQLQuery().triple()\r\n * Every function matches one of the public api functions of the woql query object\r\n */\r\n\r\nconst FrameHelper = require('./frameHelper');\r\nconst Pattern = require('./framePattern');\r\n\r\nconst WOQL = {};\r\n\r\n/*\r\n * We expose all the real woql predicates via the WOQL object,\r\n * for ease of typing - all return a WOQL query object\r\n */\r\nWOQL.when = function(Query, Update){ return new WOQLQuery().when(Query, Update);}\r\nWOQL.opt = function(query){ return new WOQLQuery().opt(query); }\r\nWOQL.from = function(dburl, query){ return new WOQLQuery().from(dburl, query); }\r\nWOQL.into = function(dburl, query){ return new WOQLQuery().into(dburl, query); }\r\nWOQL.limit = function(limit, query){ return new WOQLQuery().limit(limit, query); }\r\nWOQL.start = function(start, query){ return new WOQLQuery().start(start, query); }\r\nWOQL.select = function(...list){ return new WOQLQuery().select(...list); }\r\nWOQL.or = function(...queries){\treturn new WOQLQuery().or(...queries); }\r\nWOQL.and = function(...queries){ return new WOQLQuery().and(...queries); }\r\nWOQL.not = function(query){ return new WOQLQuery().not(query); }\r\nWOQL.triple = function(a, b, c){ return new WOQLQuery().triple(a, b, c); }\r\nWOQL.quad = function(a, b, c, d){ return new WOQLQuery().quad(a, b, c, d); }\r\nWOQL.sub = function(a, b){ return new WOQLQuery().sub(a, b); }\r\nWOQL.isa = function(a, b){\treturn new WOQLQuery().isa(a, b);\t}\r\nWOQL.eq = function(a, b){ return new WOQLQuery().eq(a, b);}\r\nWOQL.trim = function(a, b){\treturn new WOQLQuery().trim(a, b);\t}\r\nWOQL.delete = function(JSON_or_IRI){ return new WOQLQuery().delete(JSON_or_IRI);\t}\r\nWOQL.delete_triple = function( S, P, O ){ return new WOQLQuery().delete_triple (S, P, O);\t}\r\nWOQL.delete_quad = function( S, P, O, G ){ return new WOQLQuery().delete_quad (S, P, O, G); }\r\nWOQL.add_triple = function( S, P, O ){ return new WOQLQuery().add_triple (S, P, O); }\r\nWOQL.add_quad = function( S, P, O, G ){ \treturn new WOQLQuery().add_quad (S, P, O, G);}\r\nWOQL.get = function(vars, cols, target){\treturn new WOQLQuery().get(vars, cols, target); }\r\nWOQL.as = function(map, vari){\treturn new WOQLQuery().as(map, vari); }\r\nWOQL.remote = function(url){\treturn new WOQLQuery().remote(url); }\r\nWOQL.file = function(url){\treturn new WOQLQuery().file(url); }\r\nWOQL.list = function(...vars){\treturn new WOQLQuery().list(...vars); }\r\nWOQL.group_by = function(gvarlist, groupedvar, groupquery, output){\treturn new WOQLQuery().group_by(gvarlist, groupedvar, groupquery, output); }\r\nWOQL.update = function(Q){\treturn new WOQLQuery().update(Q); }\r\n\r\n/* String and other processing functions */\r\nWOQL.concat = function(list, v){\treturn new WOQLQuery().concat(list, v); }\r\nWOQL.lower = function(u, l){\treturn new WOQLQuery().lower(u, l); }\r\nWOQL.pad = function(input, pad, len, output){\treturn new WOQLQuery().pad(input, pad, len, output); }\r\nWOQL.join = function(...list){\treturn new WOQLQuery().join(...list); }\r\nWOQL.unique = function(prefix, vari, type){\treturn new WOQLQuery().unique(prefix, vari, type); }\r\nWOQL.idgen = function(prefix, vari, type, output){\treturn new WOQLQuery().idgen(prefix, vari, type, output); }\r\nWOQL.typecast = function(vara, type, varb){\treturn new WOQLQuery().typecast(vara, type, varb); }\r\n\r\n\r\n/* Mathematical Processing */\r\nWOQL.eval = function(arith, v){\treturn new WOQLQuery().eval(arith, v);}\t\r\nWOQL.plus = function(...args){\treturn new WOQLQuery().plus(...args);}\r\nWOQL.minus = function(...args){\treturn new WOQLQuery().minus(...args); }\r\nWOQL.times = function(...args){\treturn new WOQLQuery().times(...args); }\r\nWOQL.divide = function(...args){ return new WOQLQuery().divide(...args); }\r\nWOQL.exp = function(a, b){\treturn new WOQLQuery().exp(a, b); }\r\nWOQL.div = function(...args){\treturn new WOQLQuery().div(...args); }\r\nWOQL.comment = function(arg){\treturn new WOQLQuery().comment(arg); }\r\n\r\n\r\n//language extensions that can be chained after 'grounded' stuff (clauses with a specific subject) sub, isa, delete_triple, add_triple, delete_quad, add_quad, node\r\n//WOQL.value = function(vars){\treturn new WOQLQuery().list(vars); }\r\n//These ones are special ones for dealing with the schema only...\r\nWOQL.star = function(G, S, P, O){\treturn new WOQLQuery().star(G, S, P, O); }\r\nWOQL.addClass = function(classid, graph){\treturn new WOQLQuery().addClass(classid, graph); }\r\nWOQL.addProperty = function(propid, type, graph){\treturn new WOQLQuery().addProperty(propid, type, graph); }\r\nWOQL.deleteClass = function(classid, graph){\treturn new WOQLQuery().deleteClass(classid, graph); }\r\nWOQL.deleteProperty = function(propid, type, graph){\treturn new WOQLQuery().deleteProperty(propid, type, graph); }\r\nWOQL.node = function(nodeid, type){\treturn new WOQLQuery().node(nodeid, type); }\r\n\r\n\r\n/*\r\n * Beneath here are pseudo predicates - they belong to the javascript object\r\n * but not to the WOQL language\r\n */\r\n//returns empty query object\r\nWOQL.query = function(){\treturn new WOQLQuery(); }\r\n//loads query from json\r\nWOQL.json = function(json){\treturn new WOQLQuery().json(json); }\r\n\r\nWOQL.rule = function(){ return new Pattern.FrameRule(); }\r\n//Simple utility function for typechecking\r\nWOQL.isLiteralType = function(t){\r\n\tif(t){\r\n\t\tvar pref = t.split(\":\");\r\n\t\tif(pref[0] == \"xdd\" || pref[0] == \"xsd\") return true;\r\n\t}\r\n\treturn false;\r\n}\r\n/**\r\n * The WOQL Query object implements the WOQL language via the fluent style\r\n * @param query - json version of query\r\n * @returns WOQLQuery object\r\n */\r\nfunction WOQLQuery(query){\r\n\tthis.query = (query ? query : {});\r\n\tthis.cursor = this.query;\r\n\tthis.chain_ended = false;\r\n\tthis.contains_update = false;\r\n\t// operators which preserve global paging\r\n\tthis.paging_transitive_properties = ['select', 'from', 'start', 'when', 'opt', 'limit'];\r\n\tthis.vocab = this.loadDefaultVocabulary();\r\n\t//object used to accumulate triples from fragments to support usage like node(\"x\").label(\"y\");\r\n\tthis.tripleBuilder = false;\r\n\treturn this;\r\n}\r\n\r\n/**\r\n * Takes an array of variables, an optional array of column names\r\n */\r\nWOQLQuery.prototype.get = function(arr1, arr2, target){\r\n\tif(arr1.json){\r\n\t\tvar map = arr1.json();\r\n\t\ttarget = arr2;\r\n\t}\r\n\telse {\r\n\t\tvar map = this.buildAsClauses(arr1, arr2); \r\n\t}\r\n\tif(target){\r\n\t\tif(target.json) target = target.json();\r\n\t\tthis.cursor['get'] = [map, target];\r\n\t}\r\n\telse {\r\n\t\tthis.cursor['get'] = [map, {}];\r\n\t\tthis.cursor = this.cursor[\"get\"][1];\r\n\t}\r\n\treturn this;\r\n}\r\n\r\nWOQLQuery.prototype.buildAsClauses = function(vars, cols){\r\n\tvar clauses = [];\r\n\tif(vars && typeof vars == \"object\" && vars.length){\r\n\t\tfor(var i = 0; i<vars.length; i++){\r\n\t\t\tvar v = vars[i];\r\n\t\t\tif(cols && typeof cols == \"object\" && cols.length){\r\n\t\t\t\tvar c = cols[i];\r\n\t\t\t\tif(typeof c == \"string\"){\r\n\t\t\t\t\tc = {\"@value\": c};\r\n\t\t\t\t}\r\n\t\t\t\tclauses.push({as: [c, v]});\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tv.as ? clauses.push(v) : clauses.push({as: [v]});\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn clauses;\r\n}\r\n\r\nWOQLQuery.prototype.typecast = function(va, type, vb){\r\n\tthis.cursor['typecast'] = [va, type, vb];\r\n\treturn this;\r\n}\r\n\r\n\r\nWOQLQuery.prototype.remote = function(json){\r\n\tthis.cursor['remote'] = [json];\r\n\treturn this;\r\n}\r\n\r\nWOQLQuery.prototype.file = function(json){\r\n\tthis.cursor['file'] = [json];\r\n\treturn this;\r\n}\r\n\r\n//WOQL.group_by = function(gvarlist, groupedvar, groupquery, output){\treturn new WOQLQuery().group_by(gvarlist, groupedvar, groupquery, output); }\r\n\r\nWOQLQuery.prototype.group_by = function(gvarlist, groupedvar, groupquery, output){\r\n\tvar args = [];\r\n\tthis.cursor['group_by'] = args;\r\n\tif(gvarlist.json){\r\n\t\targs.push(gvarlist.json());\r\n\t}\r\n\tif(gvarlist['list']){\r\n\t\targs.push(gvarlist);\r\n\t}\r\n\telse {\r\n\t\targs.push({'list': gvarlist});\r\n\t}\r\n\tif(groupedvar.substring(0, 2) != \"v:\") groupedvar = \"v:\" + groupedvar;\r\n\targs.push(groupedvar);\r\n\tif(output){\r\n\t\targs.push(groupquery.json());\r\n\t}\r\n\telse {\r\n\t\toutput = groupquery;\r\n\t\tvar sq = {};\r\n\t\tthis.cursor = sq;\r\n\t\targs.push(sq);\r\n\t}\r\n\tif(output.substring(0, 2) != \"v:\") output = \"v:\" + output;\r\n\targs.push(output);\r\n\treturn this;\r\n}\r\n\r\nWOQLQuery.prototype.idgen = function(prefix, vari, type, mode){\r\n\tthis.cursor['idgen'] = [prefix];\r\n\tif(vari.json){\r\n\t\tthis.cursor['idgen'].push(vari.json());\r\n\t}\r\n\telse if(vari.list){\r\n\t\tthis.cursor['idgen'].push(vari);\r\n\t}\r\n\telse {\r\n\t\tthis.cursor['idgen'].push({\"list\": vari})\r\n\t}\r\n\tif(mode){\r\n\t\tthis.cursor['idgen'].push(mode);\r\n\t}\r\n\tthis.cursor['idgen'].push(type);\r\n\treturn this;\r\n}\r\n\r\n\r\nWOQLQuery.prototype.unique = function(prefix, vari, type){\r\n\tthis.cursor['unique'] = [prefix];\r\n\tif(vari.json){\r\n\t\tthis.cursor['unique'].push(vari.json());\r\n\t}\r\n\telse if(vari.list){\r\n\t\tthis.cursor['unique'].push(vari);\r\n\t}\r\n\telse {\r\n\t\tthis.cursor['unique'].push({\"list\": vari})\r\n\t}\r\n\tthis.cursor['unique'].push(type);\r\n\treturn this;\r\n}\r\n\r\n\r\nWOQLQuery.prototype.concat = function(list, v){\r\n\tif(typeof list == \"string\"){\r\n\t\tvar nlist = list.split(/(v:[\\w_]+)\\b/);\r\n\t\tvar nxlist = [];\r\n\t\tfor(var i = 1; i<nlist.length; i++){\r\n\t\t\tif(nlist[i-1].substring(nlist[i-1].length-1) == \"v\" && nlist[i].substring(0, 1) == \":\"){\r\n\t\t\t\tnlist[i-1] = nlist[i-1].substring(0, nlist[i-1].length-1);\r\n\t\t\t\tnlist[i] = nlist[i].substring(1);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\telse if(list.list){\r\n\t\tvar nlist = list.list;\r\n\t}\r\n\telse if(typeof list == \"object\"){\r\n\t\tvar nlist = list;\r\n\t}\r\n\tvar args = [];\r\n\tfor(var i = 0; i<nlist.length; i++){\r\n\t\tif(!nlist[i]) continue;\r\n\t\tif(typeof nlist[i] == \"string\"){\r\n\t\t\tif(nlist[i].substring(0, 2) == \"v:\"){\r\n\t\t\t\targs.push(nlist[i]);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tvar nvalue = {\"@value\": nlist[i], \"@type\": \"xsd:string\"};\r\n\t\t\t\targs.push(nvalue);\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if(nlist[i]){\r\n\t\t\targs.push(nlist[i]);\r\n\t\t}\r\n\t}\r\n\tif(v.indexOf(\":\") == -1) v = \"v:\" + v;\r\n\tthis.cursor['concat'] = [{\"list\": args}, v];\r\n\treturn this;\r\n};\r\n\r\nWOQLQuery.prototype.lower = function(u, l){\r\n\tthis.cursor['lower'] = [u, l];\r\n\treturn this;\r\n};\r\n\r\nWOQLQuery.prototype.pad = function(input, pad, len, output){\r\n\tthis.cursor['pad'] = [input, pad, len, output];\r\n\treturn this;\r\n}\r\n\r\nWOQLQuery.prototype.join = function(...list){\r\n\tthis.cursor['join'] = list;\r\n\treturn this;\r\n}\r\n\r\n\r\nWOQLQuery.prototype.list  = function(...vars){\r\n\tthis.cursor['list'] = vars;\r\n\treturn this;\r\n}\r\n\r\n\r\n/*\r\n * json version of query for passing to api\r\n */\r\nWOQLQuery.prototype.json = function(json){\r\n\tif(json){\r\n\t\tthis.query = json;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.query;\r\n}\r\n\r\n/*\r\n * Functions which take a query as an argument advance the cursor to make the chaining of queries fall\r\n * into the corrent place in the encompassing json\r\n */\r\nWOQLQuery.prototype.when = function(Query, Update){\r\n\tif(typeof Query == 'boolean'){\r\n\t\tif(Query){\r\n\t\t\tthis.cursor[\"when\"] = [{\"true\": []}, {}];\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.cursor[\"when\"] = [{\"false\": []}, {}];\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tvar q = (Query.json ? Query.json() : Query);\r\n\t\tthis.cursor['when'] = [q, {}];\r\n\t}\r\n\tif(Update){\r\n\t\tvar upd = (Update.json ? Update.json() : Update);\r\n\t\tthis.cursor[\"when\"][1] = upd;\r\n\t}\r\n\tthis.cursor = this.cursor[\"when\"][1];\r\n\treturn this;\r\n}\r\n\r\nWOQLQuery.prototype.opt = function(query){\r\n\tif(query){\r\n\t\tvar q = ((typeof query.json == \"function\") ? query.json() : query);\r\n\t\tthis.cursor[\"opt\"] = [q];\r\n\t}\r\n\telse {\r\n\t\tthis.cursor['opt'] = [{}];\r\n\t\tthis.cursor = this.cursor[\"opt\"][0];\r\n\t}\r\n\treturn this;\r\n};\r\n\r\nWOQLQuery.prototype.from = function(dburl, query){\r\n\tthis.advanceCursor(\"from\", dburl);\r\n\tif(query){\r\n\t\tthis.cursor = query.json();\r\n\t}\r\n\treturn this;\r\n}\r\n\r\nWOQLQuery.prototype.into = function(dburl, query){\r\n\tthis.advanceCursor(\"into\", dburl);\r\n\tif(query){\r\n\t\tthis.cursor = query.json();\r\n\t}\r\n\treturn this;\r\n};\r\n\r\n\r\nWOQLQuery.prototype.limit = function(limit, query){\r\n\tthis.advanceCursor(\"limit\", limit);\r\n\tif(query){\r\n\t\tthis.cursor = query.json();\r\n\t}\r\n\treturn this;\r\n}\r\n\r\nWOQLQuery.prototype.start = function(start, query){\r\n\tthis.advanceCursor(\"start\", start);\r\n\tif(query){\r\n\t\tthis.cursor = query.json();\r\n\t}\r\n\treturn this;\r\n};\r\n\r\nWOQLQuery.prototype.select = function (...list) {\r\n\tthis.cursor.select = list;\r\n\tconst index = list.length;\r\n\tif (typeof this.cursor.select[index - 1] === 'object') {\r\n\t\tthis.cursor.select[index - 1] = this.cursor.select[index - 1].json();\r\n\t} else {\r\n\t\tthis.cursor.select[index] = {};\r\n\t\tthis.cursor = this.cursor.select[index];\r\n\t}\r\n\treturn this;\r\n};\r\n\r\nWOQLQuery.prototype.and = function (...queries) {\r\n\tthis.cursor.and = [];\r\n\tfor (let i = 0; i < queries.length; i++) {\r\n\t\tif (queries[i].contains_update) this.contains_update = true;\r\n\t\tthis.cursor.and.push(queries[i].json());\r\n\t}\r\n\treturn this;\r\n};\r\n\r\nWOQLQuery.prototype.or = function (...queries) {\r\n\tthis.cursor.or = [];\r\n\tfor (let i = 0; i < queries.length; i++) {\r\n\t\tif (queries[i].contains_update) this.contains_update = true;\r\n\t\tthis.cursor.or.push(queries[i].json());\r\n\t}\r\n\treturn this;\r\n};\r\n\r\nWOQLQuery.prototype.not = function (query) {\r\n\tif (query) {\r\n\t\tif (query.contains_update) this.contains_update = true;\r\n\t\tthis.cursor.not = [query.json()];\r\n\t} else {\r\n\t\tthis.cursor.not = [{}];\r\n\t\tthis.cursor = this.cursor.not[0];\r\n\t}\r\n\treturn this;\r\n};\r\n\r\nWOQLQuery.prototype.triple = function(a, b, c){\r\n\tthis.cursor[\"triple\"] = [this.cleanSubject(a),this.cleanPredicate(b),this.cleanObject(c)];\r\n\treturn this.last(\"triple\", this.cleanSubject(a));\r\n}\r\n\r\nWOQLQuery.prototype.quad = function(a, b, c, g){\r\n\tthis.cursor[\"quad\"] = [this.cleanSubject(a),this.cleanPredicate(b),this.cleanObject(c),this.cleanGraph(g)];\r\n\treturn this.last(\"quad\", this.cleanSubject(a));\r\n}\r\n\r\nWOQLQuery.prototype.eq = function(a, b){\r\n\tthis.cursor[\"eq\"] = [this.cleanObject(a),this.cleanObject(b)];\r\n\treturn this.last();\r\n};\r\n\r\nWOQLQuery.prototype.sub = function(a, b){\r\n\tif(!b && this.tripleBuilder){\r\n\t\tthis.tripleBuilder.sub(this.cleanClass(a));\r\n\t\treturn this;\r\n\t}\r\n\tthis.cursor[\"sub\"] = [this.cleanClass(a),this.cleanClass(b)];\r\n\treturn this.last(\"sub\", a);\r\n}\r\n\r\nWOQLQuery.prototype.comment = function(val){\r\n\tif(val){\r\n\t\tval = (val.json ? val.json() : val)\r\n\t\tthis.cursor['comment'] = val;\r\n\t}\r\n\telse {\r\n\t\tthis.cursor['comment'] = null;\r\n\t\tthis.cursor = this.cursor['comment'];\r\n\t}\r\n\treturn this;\r\n}\r\n\r\n\r\nWOQLQuery.prototype.abstract = function(varname){\r\n\tif(varname){\r\n\t\treturn this.quad(varname, \"tcs:tag\", \"tcs:abstract\", \"db:schema\");\r\n\t}\r\n\telse if(this.tripleBuilder){\r\n\t\tthis.tripleBuilder.abstract();\r\n\t}\r\n\treturn this;\r\n}\r\n\r\nWOQLQuery.prototype.isa = function(a, b){\r\n\tif(!b && this.tripleBuilder){\r\n\t\tthis.tripleBuilder.isa(this.cleanClass(a));\r\n\t\treturn this;\r\n\t}\r\n\tif(b){\r\n\t\tthis.cursor[\"isa\"] = [this.cleanClass(a),this.cleanClass(b)];\r\n\t\treturn this.last(\"isa\", a);\r\n\t}\r\n}\r\n\r\nWOQLQuery.prototype.trim = function(a, b){\r\n\tthis.cursor['trim'] = [a, b];\r\n\treturn this.last('trim', b);\r\n}\r\n\r\nWOQLQuery.prototype.eval = function(arith, v){\r\n\tarith = arith.json ? arith.json() : arith;\r\n\tthis.cursor['eval'] = [arith, v];\r\n\treturn this.last('eval', v);\r\n}\r\n\r\nWOQLQuery.prototype.plus = function (...args) {\r\n\tthis.cursor.plus = []; \r\n\tfor(var i = 0; i < args.length; i++){\r\n\t\tthis.cursor.plus.push(args[i].json ? args[i].json() : args[i]);\r\n\t}\r\n\treturn this.last();\r\n};\r\n\r\nWOQLQuery.prototype.minus = function (...args) {\r\n\tthis.cursor.minus = [];\r\n\tfor(var i = 0; i < args.length; i++){\r\n\t\tthis.cursor.minus.push(args[i].json ? args[i].json() : args[i]);\r\n\t}\r\n\treturn this.last();\r\n};\r\n\r\nWOQLQuery.prototype.times = function (...args) {\r\n\tthis.cursor.times = [];\r\n\tfor(var i = 0; i < args.length; i++){\r\n\t\tthis.cursor.times.push(args[i].json ? args[i].json() : args[i]);\r\n\t}\r\n\treturn this.last();\r\n};\r\n\r\nWOQLQuery.prototype.divide = function (...args) {\r\n\tthis.cursor.divide = [];\r\n\tfor(var i = 0; i < args.length; i++){\r\n\t\tthis.cursor.divide.push(args[i].json ? args[i].json() : args[i]);\r\n\t}\r\n\treturn this.last();\r\n};\r\n\r\nWOQLQuery.prototype.div = function (...args) {\r\n\tthis.cursor.div = [];\r\n\tfor(var i = 0; i < args.length; i++){\r\n\t\tthis.cursor.div.push(args[i].json ? args[i].json() : args[i]);\r\n\t}\r\n\treturn this.last();\r\n};\r\n\r\nWOQLQuery.prototype.exp = function (a, b) {\r\n\ta = (a.json ? a.json() : a);\r\n\tb = (b.json ? b.json() : b);\r\n\tthis.cursor.exp = [a, b];\r\n\treturn this.last();\r\n};\r\n\r\nWOQLQuery.prototype.delete = function (JSON_or_IRI) {\r\n\tthis.cursor.delete = [JSON_or_IRI];\r\n\treturn this.lastUpdate();\r\n};\r\n\r\nWOQLQuery.prototype.delete_triple = function( Subject, Predicate, Object_or_Literal ){\r\n\tthis.cursor['delete_triple'] = [this.cleanSubject(Subject),this.cleanPredicate(Predicate),this.cleanObject(Object_or_Literal)];\r\n\treturn this.lastUpdate('delete_triple', this.cleanSubject(Subject));\r\n}\r\n\r\nWOQLQuery.prototype.add_triple = function( Subject, Predicate, Object_or_Literal ){\r\n\tthis.cursor['add_triple'] =[this.cleanSubject(Subject),this.cleanPredicate(Predicate),this.cleanObject(Object_or_Literal)];\r\n\treturn this.lastUpdate('add_triple', this.cleanSubject(Subject));\r\n}\r\n\r\nWOQLQuery.prototype.delete_quad = function( Subject, Predicate, Object_or_Literal, Graph ){\r\n\tthis.cursor['delete_quad'] =[this.cleanSubject(Subject),this.cleanPredicate(Predicate),this.cleanObject(Object_or_Literal),this.cleanGraph(Graph)];\r\n\treturn this.lastUpdate('delete_quad', this.cleanSubject(Subject));\r\n}\r\n\r\nWOQLQuery.prototype.add_quad = function( Subject, Predicate, Object_or_Literal, Graph){\r\n\tthis.cursor['add_quad'] = [this.cleanSubject(Subject),this.cleanPredicate(Predicate),this.cleanObject(Object_or_Literal),this.cleanGraph(Graph)];\r\n\treturn this.lastUpdate(\"add_quad\", this.cleanSubject(Subject));\r\n}\r\n\r\nWOQLQuery.prototype.update = function(woql){\r\n\tthis.cursor['update'] = [ woql.json() ];\r\n\treturn this.lastUpdate();\r\n}\r\n\r\n/**\r\n * Schema manipulation shorthand\r\n */\r\nWOQLQuery.prototype.addClass = function(c, graph){\r\n\tif(c){\r\n\t\tgraph = (graph ? this.cleanGraph(graph) : \"db:schema\");\r\n\t\tc = (c.indexOf(\":\") == -1) ? \"scm:\" + c : c;\r\n\t\tthis.add_quad(c, \"rdf:type\", \"owl:Class\", graph);\r\n\t}\r\n\treturn this;\r\n}\r\n\r\nWOQLQuery.prototype.addProperty = function(p, t, g){\r\n\tt = (t ? t : \"xsd:string\");\r\n\tif(p){\r\n\t\tvar graph = (g ? this.cleanGraph(g) : \"db:schema\");\r\n\t\tp = (p.indexOf(\":\") == -1) ?  \"scm:\" + p : p;\r\n\t\tt = (t.indexOf(\":\") == -1) ? this.cleanType(t) : t ;\r\n\t\tvar tc = this.cursor;\r\n\t\tif(WOQL.isLiteralType(t)){\r\n\t\t\tthis.and(\r\n\t\t\t\tWOQL.add_quad(p, \"rdf:type\", \"owl:DatatypeProperty\", graph),\r\n\t\t\t\tWOQL.add_quad(p, \"rdfs:range\", t, graph)\r\n\t\t\t);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.and(\r\n\t\t\t\tWOQL.add_quad(p, \"rdf:type\", \"owl:ObjectProperty\", graph),\r\n\t\t\t\tWOQL.add_quad(p, \"rdfs:range\", t, graph)\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n\treturn this.lastUpdate(\"add_quad\", this.cleanClass(p));\r\n}\r\n\r\nWOQLQuery.prototype.deleteClass = function(c, graph){\r\n\tif(c){\r\n\t\tgraph = (graph ? this.cleanGraph(graph) : \"db:schema\");\r\n\t\tc = (c.indexOf(\":\") == -1) ?  \"scm:\" + c : c;\r\n\t\treturn this.and(\r\n\t\t\tWOQL.delete_quad(c, \"v:All\", \"v:Al2\", graph),\r\n\t\t\tWOQL.opt().delete_quad(\"v:Al3\", \"v:Al4\", c, graph)\r\n\t\t);\r\n\t}\r\n\treturn this;\r\n}\r\n\r\nWOQLQuery.prototype.deleteProperty = function(p, graph){\r\n\tif(p){\r\n\t\tgraph = (graph ? this.cleanGraph(graph) : \"db:schema\");\r\n\t\tp = (p.indexOf(\":\") == -1) ? \"scm:\" + p : p;\r\n\t\treturn this.and(\r\n\t\t\tWOQL.delete_quad(p, \"v:All\", \"v:Al2\", graph),\r\n\t\t\tWOQL.delete_quad(\"v:Al3\", \"v:Al4\", p, graph)\r\n\t\t);\r\n\t}\r\n\treturn this;\r\n}\r\n\r\n/**\r\n * Language elements that cannot be invoked from the top level and therefore are not exposed in the WOQL api\r\n */\r\nWOQLQuery.prototype.as = function(a, b){\r\n\tif(!a || !b) return;\r\n\tif(!this.asArray){\r\n\t\tthis.asArray = true;\r\n\t\tthis.query = [];\r\n\t}\r\n\tb = (b.indexOf(\":\") == -1 ? \"v:\" + b : b);\r\n\tvar val = (typeof a == \"object\" ? a : { \"@value\" : a});\r\n\tthis.query.push({as: [val, b]});\r\n\treturn this;\t\t\r\n}\r\n\r\n/**\r\n * WOQL API\r\n */\r\n\r\nWOQLQuery.prototype.node = function(node, type){\r\n\ttype = (type ? type : \"triple\");\r\n\tthis.tripleBuilder = new TripleBuilder(type, this.cursor, node);\r\n\treturn this;\r\n}\r\n\r\nWOQLQuery.prototype.max = function(m){\r\n\tif(this.tripleBuilder) this.tripleBuilder.card(m, \"max\");\r\n\treturn this;\r\n}\r\n\r\nWOQLQuery.prototype.cardinality = function(m){\r\n\tif(this.tripleBuilder) this.tripleBuilder.card(m, \"cardinality\");\r\n\treturn this;\r\n}\r\n\r\nWOQLQuery.prototype.min = function(m){\r\n\tif(this.tripleBuilder) this.tripleBuilder.card(m, \"min\");\r\n\treturn this;\r\n}\r\n\r\nWOQLQuery.prototype.graph = function(g){\r\n\tg = this.cleanGraph(g);\r\n\tvar t = (this.type == \"triple\") ? \"quad\" : false;\r\n\tif(this.type == \"add_triple\") t = \"add_quad\";\r\n\tif(this.type == \"delete_triple\") t = \"delete_quad\";\r\n\tif(!this.tripleBuilder){\r\n\t\tthis.tripleBuilder = new TripleBuilder(t, this.cursor);\r\n\t}\r\n\tthis.tripleBuilder.graph(g);\r\n\treturn this;\r\n}\r\n\r\nWOQLQuery.prototype.domain = function(d){\r\n\td = this.cleanClass(d);\r\n\tif(this.tripleBuilder) this.tripleBuilder.addPO('rdfs:domain',d);\r\n\treturn this;\r\n}\r\n\r\nWOQLQuery.prototype.label = function(l, lang){\r\n\tif(this.tripleBuilder) this.tripleBuilder.label(l, lang);\r\n\treturn this;\r\n}\r\n\r\nWOQLQuery.prototype.description = function(c, lang){\r\n\tif(this.tripleBuilder) this.tripleBuilder.comment(c, lang);\r\n\treturn this;\r\n}\r\n\r\nWOQLQuery.prototype.parent = function(...p){\r\n\tif(this.tripleBuilder){\r\n\t\tfor(var i = 0 ; i<p.length; i++){\r\n\t\t\tvar pn = this.cleanClass(p[i]);\r\n\t\t\tthis.tripleBuilder.addPO('rdfs:subClassOf', pn);\r\n\t\t}\r\n\t}\r\n\treturn this;\r\n}\r\n\r\nWOQLQuery.prototype.entity = function(...p){\r\n\treturn this.parent(\"tcs:Entity\");\r\n}\r\n\r\nWOQLQuery.prototype.relationship = function(...p){\r\n\treturn this.parent(\"tcs:Entity\");\r\n}\r\n\r\nWOQLQuery.prototype.property = function(p,val){\r\n\tif(this.tripleBuilder) {\r\n\t\tp = this.cleanPredicate(p);\r\n\t\tthis.tripleBuilder.addPO(p, val);\r\n\t}\r\n\treturn this;\r\n}\r\n\r\nWOQLQuery.prototype.star = function(GraphIRI, Subj, Pred, Obj){\r\n\tSubj = (Subj ? this.cleanSubject(Subj) : \"v:Subject\");\r\n\tPred = (Pred ? this.cleanPredicate(Pred) : \"v:Predicate\");\r\n\tObj = (Obj  ? this.cleanObject(Obj) : \"v:Object\");\r\n\tGraphIRI = (GraphIRI ? this.cleanGraph(GraphIRI) : false);\r\n\tif(GraphIRI){\r\n\t\treturn this.quad(Subj, Pred, Obj, GraphIRI);\r\n\t}\r\n\telse {\r\n\t\treturn this.triple(Subj, Pred, Obj);\r\n\t}\r\n}\r\n\r\n\r\nWOQLQuery.prototype.getEverything = function(GraphIRI){\r\n\tif(GraphIRI){\r\n\t\tGraphIRI = this.cleanGraph(GraphIRI);\r\n\t\treturn this.quad(\"v:Subject\", \"v:Predicate\", \"v:Object\", GraphIRI);\r\n\t}\r\n\telse {\r\n\t\treturn this.triple(\"v:Subject\", \"v:Predicate\", \"v:Object\");\r\n\t}\r\n}\r\n\r\nWOQLQuery.prototype.getAllDocuments = function(){\r\n\treturn this.and(\r\n\t\tWOQL.triple(\"v:Subject\", \"rdf:type\", \"v:Type\"),\r\n\t\tWOQL.sub(\"v:Type\", \"tcs:Document\")\r\n\t);\r\n}\r\n\r\nWOQLQuery.prototype.documentMetadata = function(){\r\n\treturn this.and(\r\n\t\tWOQL.triple(\"v:ID\", \"rdf:type\", \"v:Class\"),\r\n\t\tWOQL.sub(\"v:Class\", \"tcs:Document\"),\r\n\t\tWOQL.opt().triple(\"v:ID\", \"rdfs:label\", \"v:Label\"),\r\n\t\tWOQL.opt().triple(\"v:ID\", \"rdfs:comment\", \"v:Comment\"),\r\n\t\tWOQL.opt().quad(\"v:Class\", \"rdfs:label\", \"v:Type\", \"db:schema\"),\r\n\t\tWOQL.opt().quad(\"v:Class\", \"rdfs:comment\", \"v:Type_Comment\", \"db:schema\")\r\n\t);\r\n}\r\n\r\nWOQLQuery.prototype.concreteDocumentClasses = function(){\r\n\treturn this.and(\r\n\t\tWOQL.sub(\"v:Class\", \"tcs:Document\"),\r\n\t\tWOQL.not().abstract(\"v:Class\"),\r\n\t\tWOQL.opt().quad(\"v:Class\", \"rdfs:label\", \"v:Label\", \"db:schema\"),\r\n\t\tWOQL.opt().quad(\"v:Class\", \"rdfs:comment\", \"v:Comment\", \"db:schema\")\r\n\t);\r\n}\r\n\r\nWOQLQuery.prototype.propertyMetadata = function(){\r\n\treturn this.and(\r\n\t\tWOQL.or(\r\n\t\t\tWOQL.quad(\"v:Property\", \"rdf:type\", \"owl:DatatypeProperty\", \"db:schema\"),\r\n\t\t\tWOQL.quad(\"v:Property\", \"rdf:type\", \"owl:ObjectProperty\", \"db:schema\")\r\n\t\t),\r\n\t\tWOQL.opt().quad(\"v:Property\", \"rdfs:range\", \"v:Range\", \"db:schema\"),\r\n\t\tWOQL.opt().quad(\"v:Property\", \"rdf:type\", \"v:Type\", \"db:schema\"),\r\n\t\tWOQL.opt().quad(\"v:Property\", \"rdfs:label\", \"v:Label\", \"db:schema\"),\r\n\t\tWOQL.opt().quad(\"v:Property\", \"rdfs:comment\", \"v:Comment\", \"db:schema\"),\r\n\t\tWOQL.opt().quad(\"v:Property\", \"rdfs:domain\", \"v:Domain\", \"db:schema\")\r\n\t);\r\n}\r\n\r\nWOQLQuery.prototype.elementMetadata = function(){\r\n\treturn this.and(\r\n\t\tWOQL.quad(\"v:Element\", \"rdf:type\", \"v:Type\", \"db:schema\"),\r\n\t\tWOQL.opt().quad(\"v:Element\", \"tcs:tag\", \"v:Abstract\", \"db:schema\"),\r\n\t\tWOQL.opt().quad(\"v:Element\", \"rdfs:label\", \"v:Label\", \"db:schema\"),\r\n\t\tWOQL.opt().quad(\"v:Element\", \"rdfs:comment\", \"v:Comment\", \"db:schema\"),\r\n\t\tWOQL.opt().quad(\"v:Element\", \"rdfs:subClassOf\", \"v:Parent\", \"db:schema\"),\r\n\t\tWOQL.opt().quad(\"v:Element\", \"rdfs:domain\", \"v:Domain\", \"db:schema\"),\r\n\t\tWOQL.opt().quad(\"v:Element\", \"rdfs:range\", \"v:Range\", \"db:schema\")\r\n\t);\r\n}\r\n\r\nWOQLQuery.prototype.classMetadata = function(){\r\n\treturn this.and(\r\n\t\tWOQL.quad(\"v:Element\", \"rdf:type\", \"owl:Class\", \"db:schema\"),\r\n\t\tWOQL.opt().quad(\"v:Element\", \"rdfs:label\", \"v:Label\", \"db:schema\"),\r\n\t\tWOQL.opt().quad(\"v:Element\", \"rdfs:comment\", \"v:Comment\", \"db:schema\"),\r\n\t\tWOQL.opt().quad(\"v:Element\", \"tcs:tag\", \"v:Abstract\", \"db:schema\")\r\n\t);\r\n}\r\n\r\nWOQLQuery.prototype.getDataOfClass = function(chosen){\r\n\treturn this.and(\r\n\t\tWOQL.triple(\"v:Subject\", \"rdf:type\", chosen),\r\n\t\tWOQL.opt().triple(\"v:Subject\", \"v:Property\", \"v:Value\")\r\n\t);\r\n}\r\n\r\nWOQLQuery.prototype.getDataOfProperty = function(chosen){\r\n\treturn this.and(\r\n\t\tWOQL.triple(\"v:Subject\", chosen, \"v:Value\"),\r\n\t\tWOQL.opt().triple(\"v:Subject\", \"rdfs:label\", \"v:Label\")\r\n\t);\r\n}\r\n\r\nWOQLQuery.prototype.documentProperties = function(id){\r\n\treturn this.and(\r\n\t\tWOQL.triple(id, \"v:Property\", \"v:Property_Value\"),\r\n\t\tWOQL.opt().quad(\"v:Property\", \"rdfs:label\", \"v:Property_Label\", \"db:schema\"),\r\n\t\tWOQL.opt().quad(\"v:Property\", \"rdf:type\", \"v:Property_Type\", \"db:schema\")\r\n\t);\r\n}\r\n\r\nWOQLQuery.prototype.getDocumentConnections = function(id){\r\n\treturn this.and(\r\n\t\tWOQL.or(\r\n\t\t\tWOQL.triple(id, \"v:Outgoing\", \"v:Entid\"),\r\n\t\t\tWOQL.triple(\"v:Entid\", \"v:Incoming\", id)\r\n\t\t),\r\n\t\tWOQL.isa(\"v:Entid\", \"v:Enttype\"),\r\n\t\tWOQL.sub(\"v:Enttype\", \"tcs:Document\"),\r\n\t\tWOQL.opt().triple(\"v:Entid\", \"rdfs:label\", \"v:Label\"),\r\n\t\tWOQL.opt().quad(\"v:Enttype\", \"rdfs:label\", \"v:Class_Label\", \"db:schema\")\r\n\t);\r\n}\r\n\r\nWOQLQuery.prototype.getInstanceMeta = function(url){\r\n\treturn this.and(\r\n\t\tWOQL.triple(url, \"rdf:type\", \"v:InstanceType\"),\r\n\t\tWOQL.opt().triple(url, \"rdfs:label\", \"v:InstanceLabel\"),\r\n\t\tWOQL.opt().triple(url, \"rdfs:comment\", \"v:InstanceComment\"),\r\n\t\tWOQL.opt().quad(\"v:InstanceType\", \"rdfs:label\", \"v:ClassLabel\", \"db:schema\")\r\n\t);\r\n}\r\n\r\nWOQLQuery.prototype.simpleGraphQuery = function(){\r\n\treturn this.and(\r\n\t    WOQL.triple(\"v:Source\", \"v:Edge\", \"v:Target\"),\r\n\t    WOQL.isa(\"v:Source\", \"v:Source_Class\"),\r\n\t    WOQL.sub(\"v:Source_Class\", \"tcs:Document\"),\r\n\t    WOQL.isa(\"v:Target\", \"v:Target_Class\"),\r\n\t    WOQL.sub(\"v:Target_Class\", \"tcs:Document\"),\r\n\t    WOQL.opt().triple(\"v:Source\", \"rdfs:label\", \"v:Source_Label\"),\r\n\t    WOQL.opt().triple(\"v:Source\", \"rdfs:comment\", \"v:Source_Comment\"),\r\n\t    WOQL.opt().quad(\"v:Source_Class\", \"rdfs:label\", \"v:Source_Type\", \"db:schema\"),\r\n\t    WOQL.opt().quad(\"v:Source_Class\", \"rdfs:comment\", \"v:Source_Type_Comment\", \"db:schema\"),\r\n\t    WOQL.opt().triple(\"v:Target\", \"rdfs:label\", \"v:Target_Label\"),\r\n\t    WOQL.opt().triple(\"v:Target\", \"rdfs:comment\", \"v:Target_Comment\"),\r\n\t    WOQL.opt().quad(\"v:Target_Class\", \"rdfs:label\", \"v:Target_Type\", \"db:schema\"),\r\n\t    WOQL.opt().quad(\"v:Target_Class\", \"rdfs:comment\", \"v:Target_Type_Comment\", \"db:schema\"),\r\n\t    WOQL.opt().quad(\"v:Edge\", \"rdfs:label\", \"v:Edge_Type\", \"db:schema\"),\r\n\t    WOQL.opt().quad(\"v:Edge\", \"rdfs:comment\", \"v:Edge_Type_Comment\", \"db:schema\")\r\n\t);\r\n}\r\n\r\n\r\n/**\r\n * Queries the schema graph and loads all the ids found there as vocabulary that can be used without prefixes\r\n * ignoring blank node ids\r\n */\r\nWOQLQuery.prototype.loadVocabulary = function(client){\r\n\tvar nw = new WOQLQuery().quad(\"v:S\", \"v:P\", \"v:O\", \"db:schema\");\r\n\tnw.execute(client).then( (result) => {\r\n\t\tif(result.bindings && result.bindings.length > 0){\r\n\t\t\tfor(var i = 0; i<result.bindings.length; i++){\r\n\t\t\t\tfor(var k in result.bindings[i]){\r\n\t\t\t\t\tvar v = result.bindings[i][k]\r\n\t\t\t\t\tif(typeof v == \"string\"){\r\n\t\t\t\t\t\tvar spl = v.split(\":\");\r\n\t\t\t\t\t\tif(spl.length == 2 && spl[1] && spl[0] != \"_\"){\r\n\t\t\t\t\t\t\tthis.vocab[spl[1]] = v;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n}\r\n\r\n\r\n/**\r\n * Provides the query with a 'vocabulary' a list of well known predicates that can be used without prefixes mapping: id: prefix:id ...\r\n */\r\nWOQLQuery.prototype.setVocabulary = function(vocab){\r\n\tthis.vocab = vocab;\r\n}\r\n\r\nWOQLQuery.prototype.getVocabulary = function(vocab){\r\n\treturn this.vocab;\r\n}\r\n\r\nWOQLQuery.prototype.getLimit = function(){\r\n\treturn this.getPagingProperty(\"limit\");\r\n}\r\n\r\nWOQLQuery.prototype.setLimit = function(l){\r\n\treturn this.setPagingProperty(\"limit\", l);\r\n}\r\n\r\nWOQLQuery.prototype.isPaged = function(q){\r\n\tq = (q ? q : this.query);\r\n\tfor (const prop of Object.keys(q)) {\r\n\t\tif(prop == \"limit\") return true;\r\n\t\telse if(this.paging_transitive_properties.indexOf(prop) !== -1){\r\n\t\t\treturn this.isPaged(q[prop][q[prop].length-1]);\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nWOQLQuery.prototype.getPage = function(){\r\n\tif(this.isPaged()){\r\n\t\tvar psize = this.getLimit();\r\n\t\tif(this.hasStart()){\r\n\t\t\tvar s = this.getStart();\r\n\t\t\treturn (parseInt(s / psize) + 1);\r\n\t\t}\r\n\t\telse return 1;\r\n\t}\r\n\telse return false;\r\n}\r\n\r\nWOQLQuery.prototype.setPage = function(pagenum){\r\n\tvar pstart = (this.getLimit() * (pagenum - 1));\r\n\tif(this.hasStart()){\r\n\t\tthis.setStart(pstart);\r\n\t}\r\n\telse {\r\n\t\tthis.addStart(pstart);\r\n\t}\r\n\treturn this;\r\n}\r\n\r\nWOQLQuery.prototype.nextPage = function(){\r\n\treturn this.setPage(this.getPage() + 1);\r\n}\r\n\r\nWOQLQuery.prototype.firstPage = function(){\r\n\treturn this.setPage(1);\r\n}\r\n\r\nWOQLQuery.prototype.previousPage = function(){\r\n\tconst npage = this.getPage() - 1;\r\n\tif(npage > 0) this.setPage(npage);\r\n\treturn this;\r\n}\r\n\r\nWOQLQuery.prototype.setPageSize = function(size){\r\n\tthis.setPagingProperty(\"limit\", size);\r\n\tif(this.hasStart()){\r\n\t\tthis.setStart(0);\r\n\t}\r\n\telse {\r\n\t\tthis.addStart(0);\r\n\t}\r\n\treturn this;\r\n}\r\n\r\nWOQLQuery.prototype.hasSelect = function(){\r\n\treturn (this.getPagingProperty(\"select\") ? true : false);\r\n}\r\n\r\nWOQLQuery.prototype.getSelectVariables = function(q){\r\n\tq = (q ? q : this.query);\r\n\tfor (const prop of Object.keys(q)) {\r\n\t\tif(prop == \"select\") {\r\n\t\t\tvar vars = q[prop].slice(0, q[prop].length - 1);\r\n\t\t\treturn vars;\r\n\t\t}\r\n\t\telse if(this.paging_transitive_properties.indexOf(prop) !== -1){\r\n\t\t\tvar val = this.getSelectVariables(q[prop][q[prop].length-1]);\r\n\t\t\tif(typeof val != \"undefined\"){\r\n\t\t\t\treturn val;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\nWOQLQuery.prototype.hasStart = function(){\r\n\treturn (typeof this.getPagingProperty(\"start\") != \"undefined\");\r\n}\r\n\r\nWOQLQuery.prototype.getStart = function(){\r\n\treturn this.getPagingProperty(\"start\");\r\n}\r\n\r\nWOQLQuery.prototype.setStart = function(start){\r\n\treturn this.setPagingProperty(\"start\", start);\r\n}\r\n\r\nWOQLQuery.prototype.addStart = function(s){\r\n\tif(this.hasStart()) this.setStart(s);\r\n\telse {\r\n\t\tvar nq = {'start': [s, this.query]};\r\n\t\tthis.query = nq;\r\n\t}\r\n\treturn this;\r\n}\r\n\r\n\r\n/**\r\n * Executes the query using the passed client to connect to a server\r\n */\r\nWOQLQuery.prototype.execute = function(client){\r\n\tif(!this.query[\"@context\"]){\r\n\t\tthis.query['@context'] = this.defaultContext(client.connectionConfig.dbURL());\r\n\t\tvar json = this.json();\r\n\t}\r\n\telse {\r\n\t\tvar json = this.json();\r\n\t}\r\n\tif(this.contains_update){\r\n\t\treturn client.select(false, json);\r\n\t\t//return client.update(false, json);\r\n\t}\r\n\telse {\r\n\t\treturn client.select(false, json);\r\n\t}\r\n}\r\n\r\n/*\r\n * Internal State Control Functions\r\n * Not part of public API -\r\n */\r\n\r\n /**\r\n * Advances internal cursor to support chaining of calls: limit(50).start(50). rather than (limit, [50, (start, [50, (lisp-style (encapsulation)))))\r\n */\r\nWOQLQuery.prototype.advanceCursor = function(action, value){\r\n\tthis.cursor[action] = [value];\r\n\tthis.cursor[action][1] = {};\r\n\tthis.cursor = this.cursor[action][1];\r\n}\r\n\r\nWOQLQuery.prototype.loadDefaultVocabulary = function(){\r\n\tvar vocab = {};\r\n\tvocab.type = \"rdf:type\";\r\n\tvocab.label = \"rdfs:label\";\r\n\tvocab.Class = \"owl:Class\";\r\n\tvocab.DatatypeProperty = \"owl:DatatypeProperty\";\r\n\tvocab.ObjectProperty = \"owl:ObjectProperty\";\r\n\tvocab.Entity = \"tcs:Entity\";\r\n\tvocab.Document = \"tcs:Document\";\r\n\tvocab.Relationship = \"tcs:Relationship\";\r\n\tvocab.temporality = \"tcs:temporality\";\r\n\tvocab.geotemporality = \"tcs:geotemporality\";\r\n\tvocab.geography = \"tcs:geography\";\r\n\tvocab.abstract = \"tcs:abstract\";\r\n\tvocab.comment = \"rdfs:comment\";\r\n\tvocab.range = \"rdfs:range\";\r\n\tvocab.domain = \"rdfs:domain\";\r\n\tvocab.subClassOf = \"rdfs:subClassOf\";\r\n\tvocab.string = \"xsd:string\";\r\n\tvocab.integer = \"xsd:integer\";\r\n\tvocab.decimal = \"xsd:decimal\";\r\n\tvocab.email = \"xdd:email\";\r\n\tvocab.json = \"xdd:json\";\r\n\tvocab.dateTime = \"xsd:dateTime\";\r\n\tvocab.date = \"xsd:date\";\r\n\tvocab.coordinate = \"xdd:coordinate\";\r\n\tvocab.line = \"xdd:coordinatePolyline\";\r\n\tvocab.polygon = \"xdd:coordinatePolygon\";\r\n\treturn vocab;\r\n}\r\n\r\nWOQLQuery.prototype.defaultContext = function(DB_IRI){\r\n\tlet def = {}\r\n\tfor(var pref in FrameHelper.standard_urls){\r\n\t\tdef[pref] = FrameHelper.standard_urls[pref];\r\n\t}\r\n\tdef.scm = DB_IRI + \"/schema#\"\r\n\tdef.doc = DB_IRI + \"/document/\"\r\n\tdef.db = DB_IRI + \"/\";\r\n\treturn def;\r\n}\r\n\r\n\r\n\r\n/**\r\n * Called to indicate that this is the last call that is chainable - for example triple pattern matching..\r\n *\r\n */\r\nWOQLQuery.prototype.last = function(call, subject){\r\n\tthis.chain_ended = true;\r\n\tif(call) this.tripleBuilder = new TripleBuilder(call, this.cursor, this.cleanSubject(subject));\r\n\treturn this;\r\n}\r\n\r\nWOQLQuery.prototype.lastUpdate = function(call, subj){\r\n\tthis.contains_update = true;\r\n\tvar ret = this.last(call, subj);\r\n\treturn ret;\r\n}\r\n\r\n/**\r\n * Returns the value of one of the 'paging' related properties (limit, start,...)\r\n */\r\nWOQLQuery.prototype.getPagingProperty = function(pageprop, q){\r\n\tq = (q ? q : this.query);\r\n\tfor (const prop of Object.keys(q)) {\r\n\t\tif(prop == pageprop) return q[prop][0];\r\n\t\telse if(this.paging_transitive_properties.indexOf(prop) !== -1){\r\n\t\t\tvar val = this.getPagingProperty(pageprop, q[prop][q[prop].length-1]);\r\n\t\t\tif(typeof val != \"undefined\"){\r\n\t\t\t\treturn val;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\n/**\r\n * Sets the value of one of the paging_transitive_properties properties\r\n */\r\nWOQLQuery.prototype.setPagingProperty = function(pageprop, val, q){\r\n\tq = (q ? q : this.query);\r\n\tfor (const prop of Object.keys(q)) {\r\n\t\tif(prop == pageprop) {\r\n\t\t\tq[prop][0] = val;\r\n\t\t}\r\n\t\telse if(this.paging_transitive_properties.indexOf(prop) !== -1){\r\n\t\t\tthis.setPagingProperty(pageprop, val, q[prop][q[prop].length-1]);\r\n\t\t}\r\n\t}\r\n\treturn this;\r\n}\r\n\r\n/**\r\n * Retrieves the value of the current json-ld context\r\n */\r\nWOQLQuery.prototype.getContext = function(q){\r\n\tq = (q ? q : this.query);\r\n\tfor (const prop of Object.keys(q)) {\r\n\t\tif(prop == \"@context\") return q[prop];\r\n\t\tif(this.paging_transitive_properties.indexOf(prop) !== -1){\r\n\t\t\tvar nq = q[prop][1];\r\n\t\t\tvar nc = this.getContext(nq);\r\n\t\t\tif(nc) return nc;\r\n\t\t}\r\n\t}\r\n}\r\n\r\n\r\n/**\r\n * Retrieves the value of the current json-ld context\r\n */\r\nWOQLQuery.prototype.context = function(c){\r\n\tthis.cursor['@context'] = c;\r\n}\r\n\r\n\r\n/*\r\n* Transforms from internal json representation to human writable WOQL.js format\r\n*/\r\nWOQLQuery.prototype.prettyPrint = function(indent, show_context, q, fluent){\r\n\tif(!this.indent) this.indent = indent;\r\n\tq = (q ? q : this.query);\r\n\tvar str = \"\";\r\n\tconst newlining_operators = [\"get\", \"from\", \"into\"];\r\n\tfor(var operator in q){\r\n\t\t//ignore context in pretty print\r\n\t\tif(operator == \"@context\") {\r\n\t\t\tif( show_context){\r\n\t\t\t\tvar c = this.getContext();\r\n\t\t\t\tif(c) str += \"@context: \" + JSON.stringify(c) + \"\\n\";\r\n\t\t\t}\r\n\t\t\tcontinue;\r\n\t\t}\r\n\t\t//statement starts differently depending on indent and whether it is fluent style or regular function style\r\n\t\tstr += this.getWOQLPrelude(operator, fluent, indent - this.indent);\r\n\t\tvar val = q[operator];\r\n\t\tif(this.chainable(operator, val[val.length-1])){\r\n\t\t\t//all arguments up until the last are regular function arguments \r\n\t\t\tstr += this.uncleanArguments(operator,  val.slice(0, val.length-1), indent, show_context);\r\n\t\t\tif(newlining_operators.indexOf(operator) !== -1){\r\n\t\t\t\t//some fluent function calls demand a linebreak..\r\n\t\t\t\tstr += \"\\n\" + nspaces(indent-this.indent);\r\n\t\t\t}\r\n\t\t\t//recursive call to query included in tail\r\n\t\t\tstr += this.prettyPrint(indent, show_context, val[val.length-1], true);\r\n\t\t}\r\n\t\telse {\r\n\t\t\t//non chainable operators all live inside the function call parameters\r\n\t\t\tstr += this.uncleanArguments(operator,  val, indent, show_context);\r\n\t\t}\r\n\t}\r\n\t//remove any trailing dots in the chain (only exist in incompletely specified queries)\r\n\tif(str.substring(str.length-1) == \".\"){\r\n\t\tstr = str.substring(0, str.length-1);\r\n\t}\r\n\treturn str;\r\n}\r\n\r\n/**\r\n * Gets the starting characters for a WOQL query - varies depending on how the query is invoked and how indented it is\r\n */\r\nWOQLQuery.prototype.getWOQLPrelude = function(operator, fluent, inline){\r\n\tif(operator === \"true\" || operator === \"false\"){\r\n\t\treturn operator;\r\n\t}\r\n\tif(fluent){\r\n\t\treturn \".\" + operator;\r\n\t}\r\n\treturn (inline ? \"\\n\" + nspaces(inline) : \"\") + \"WOQL.\" + operator;\t\t\r\n}\r\n\r\n/**\r\n * Determines whether a given operator can have a chained query as its last argument\r\n */\r\nWOQLQuery.prototype.chainable = function(operator, lastArg){\r\n\tconst non_chaining_operators = [\"and\", \"or\"];\r\n\tif(typeof lastArg == \"object\" && typeof lastArg['@value'] == \"undefined\"  && typeof lastArg['@type'] == \"undefined\"  && typeof lastArg['value'] == \"undefined\" && non_chaining_operators.indexOf(operator) == -1){\r\n\t\treturn true;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\n/**\r\n * Transforms arguments to WOQL functions from the internal (clean) version, to the WOQL.js human-friendly version\r\n */\r\nWOQLQuery.prototype.uncleanArguments = function(operator, args, indent, show_context){\r\n\tstr = '(';\r\n\tconst args_take_newlines = [\"and\", \"or\"];\r\n\tif(this.hasShortcut(operator, args)){\r\n\t\treturn this.getShortcut(args, indent);\r\n\t}\r\n\telse {\r\n\t\tfor(var i = 0; i<args.length; i++){\r\n\t\t\tif(this.argIsSubQuery(operator, args[i], i)){\r\n\t\t\t\tstr += this.prettyPrint(indent + this.indent, show_context, args[i], false);\r\n\t\t\t}\r\n\t\t\telse if(operator == \"get\" && i == 0){ // weird one, needs special casing\r\n\t\t\t\tstr += \"\\n\" + nspaces(indent-this.indent) + \"WOQL\";\r\n\t\t\t\tfor(var j = 0; j < args[0].length; j++){\r\n\t\t\t\t\tvar myas = (args[0][j].as ? args[0][j].as : args[0][j]);\r\n\t\t\t\t\tvar lhs = myas[0];\r\n\t\t\t\t\tvar rhs = myas[1];\r\n\t\t\t\t\tif(typeof lhs == \"object\" && lhs['@value']){\r\n\t\t\t\t\t\tlhs = lhs['@value'];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(typeof lhs == \"object\") {\r\n\t\t\t\t\t\tlhs = JSON.stringify(lhs);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tlhs = '\"' + lhs + '\"'\r\n\t\t\t\t\t}\r\n\t\t\t\t\tstr += '.as(' + lhs;\r\n\t\t\t\t\tif(rhs) str += ', \"' + rhs + '\"';\r\n\t\t\t\t\tstr += \")\";\r\n\t\t\t\t\tstr += \"\\n\" + nspaces(indent);\r\n\t\t\t\t}\r\n\t\t\t}\t\r\n\t\t\telse {\r\n\t\t\t\tstr += this.uncleanArgument(operator, args[i], i, args);\r\n\t\t\t}\r\n\t\t\tif(i < args.length -1) str +=  ',';\r\n\t\t}\r\n\t}\r\n\tif(args_take_newlines.indexOf(operator) != -1){\r\n\t\tstr += \"\\n\" + nspaces(indent-this.indent);\r\n\t}\r\n\tstr += \")\";\r\n\treturn str;\r\n}\r\n\r\n\r\n/**\r\n * Passed as arguments: 1) the operator (and, triple, not, opt, etc)\r\n * 2) the value of the argument\r\n * 3) the index (position) of the argument. \r\n */\r\nWOQLQuery.prototype.uncleanArgument = function(operator, val, index, allArgs){\r\n\t//numeric values go out untouched... \r\n\tconst numeric_operators = [\"limit\", \"start\", \"eval\", \"plus\", \"minus\", \"times\", \"divide\", \"exp\", \"div\"];\r\n\tif(operator == \"isa\"){\r\n\t\tval = (index == 0 ? this.unclean(val, 'subject') : this.unclean(val, 'class'));\r\n\t}\r\n\telse if(operator == \"sub\"){\r\n\t\tval = this.unclean(val, 'class');\r\n\t}\r\n\telse if([\"select\"].indexOf(operator) != -1){\r\n\t\tif(val.substring(0, 2) == \"v:\") val = val.substring(2);\r\n\t}\r\n\telse if([\"quad\", \"add_quad\", \"delete_quad\", \"add_triple\", \"delete_triple\", \"triple\"].indexOf(operator) != -1){\r\n\t\tswitch(index){\r\n\t\t\tcase 0: val = this.unclean(val, \"subject\"); break;\r\n\t\t\tcase 1: val = this.unclean(val, \"predicate\"); break;\r\n\t\t\tcase 2: val = this.unclean(val, \"object\"); break;\r\n\t\t\tcase 3: val = this.unclean(val, \"graph\"); break;\r\n\t\t}\r\n\t}\r\n\tif(typeof val == \"object\"){\r\n\t\tif(operator == \"concat\" && index == 0){\r\n\t\t\tvar cstr = \"\";\r\n\t\t\tif(val.list){\r\n\t\t\t\tfor(var i = 0 ; i<val.list.length; i++){\r\n\t\t\t\t\tif(val.list[i]['@value']) cstr += val.list[i]['@value'];\r\n\t\t\t\t\telse cstr += val.list[i];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar oval = '\"' + cstr + '\"';\r\n\t\t}\r\n\t\telse {\r\n\t\t\tvar oval = this.uncleanObjectArgument(operator, val, index);\r\n\t\t}\r\n\t\treturn oval;\r\n\t}\r\n\t//else if(numeric_operators.indexOf(operator) !== -1){\r\n\t//\treturn val;\r\n\t//}\r\n\tif(typeof val == \"string\"){\r\n\t\treturn '\"' + val + '\"';\r\n\t}\r\n\treturn val;\r\n}\r\n\r\n\r\n\r\nWOQLQuery.prototype.uncleanObjectArgument = function(operator, val, index){\r\n\tif(val['@value'] && (val['@language'] || (val['@type'] && val['@type'] == \"xsd:string\"))) return '\"' + val['@value'] + '\"';\r\n\tif(val['@value'] && (val['@type'] && val['@type'] == \"xsd:integer\")) return val['@value'];\r\n\tif(val['list']) {\r\n\t\tvar nstr = \"[\";\r\n\t\tfor(var i = 0 ; i<val['list'].length; i++){\r\n\t\t\tif(typeof val['list'][i] == \"object\"){\r\n\t\t\t\tnstr += this.uncleanObjectArgument(\"list\", val['list'][i], i);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tnstr += '\"' + val['list'][i] + '\"';\r\n\t\t\t}\r\n\t\t\tif(i < val['list'].length-1){\r\n\t\t\t\tnstr += \",\";\r\n\t\t\t}\r\n\t\t}\r\n\t\tnstr += \"]\";\r\n\t\treturn nstr;\r\n\t}\r\n\treturn JSON.stringify(val);\r\n}\r\n\r\nWOQLQuery.prototype.argIsSubQuery = function(operator, args){\r\n\tconst squery_operators = [\"and\", \"or\", \"when\", \"not\", \"opt\"];\r\n\treturn (squery_operators.indexOf(operator) !== -1);\r\n}\r\n\r\n/**\r\n * Goes from the properly prefixed clean internal version of a variable to the WOQL.js unprefixed form\r\n */\r\nWOQLQuery.prototype.unclean = function(s, part){\r\n\tif(typeof s != \"string\") return s;\r\n\tif(s.indexOf(\":\") == -1) return s;\r\n\tif(s.substring(0,4) == \"http\") return s;\r\n\tvar suff = s.split(\":\")[1];\r\n\tif(this.vocab && this.vocab[suff] && this.vocab[suff] == s){\r\n\t\treturn suff;\r\n\t}\r\n\tif(!part) return s;\r\n\tif(part == \"subject\" && (s.split(\":\")[0] == \"doc\")) return suff;\r\n\tif(part == \"class\" && (s.split(\":\")[0] == \"scm\")) return suff;\r\n\tif(part == \"predicate\" && (s.split(\":\")[0] == \"scm\")) return suff;\r\n\tif(part == \"type\" && (s.split(\":\")[0] == \"scm\")) return suff;\r\n\tif(part == \"graph\" && (s.split(\":\")[0] == \"db\")) return suff;\r\n\treturn s;\r\n}\r\n\r\nWOQLQuery.prototype.hasShortcut = function(operator, args, indent, show_context){\r\n\tif(operator == \"true\") return true;\r\n}\r\n\r\nWOQLQuery.prototype.getShortcut = function(operator, args, indent, show_context){\r\n\tif(operator == \"true\") return true;\r\n}\r\n\r\n\r\n\r\n\r\nfunction nspaces(n){\r\n\tlet spaces = \"\";\r\n\tfor(var i = 0; i<n; i++){\r\n\t\tspaces += \" \";\r\n\t}\r\n\treturn spaces;\r\n}\r\n\r\n\r\nWOQLQuery.prototype.printLine = function(indent, clauses){\r\n\treturn \"(\\n\" + nspaces(indent) + \"WOQL.\" + clauses.join(\",\\n\"+ nspaces(indent) + \"WOQL.\") + \"\\n\" + nspaces(indent - this.indent) + \")\";\r\n}\r\n\r\n\r\n\r\n\r\nWOQLQuery.prototype.cleanSubject = function(s){\r\n\tif(typeof s != \"string\") return s;\r\n\tif(s.indexOf(\":\") != -1) return s;\r\n\tif(this.vocab && this.vocab[s]) return this.vocab[s];\r\n\treturn \"doc:\" + s;\r\n}\r\n\r\nWOQLQuery.prototype.cleanPredicate = function(p){\r\n\tif(p.indexOf(\":\") != -1) return p;\r\n\tif(this.vocab && this.vocab[p]) return this.vocab[p];\r\n\treturn \"scm:\" + p;\r\n}\r\nWOQLQuery.prototype.cleanType = function(t){\r\n\tif(t.indexOf(\":\") != -1) return t;\r\n\tif(this.vocab && this.vocab[t]) return this.vocab[t];\r\n\treturn \"scm:\" + t;\r\n}\r\n\r\nWOQLQuery.prototype.cleanObject = function(o){\r\n\tif(typeof o != \"string\" || o.indexOf(\":\") != -1) return o;\r\n\tif(this.vocab && this.vocab[o]) return this.vocab[o];\r\n\treturn { \"@value\": o, \"@language\": \"en\"};\r\n}\r\n\r\nWOQLQuery.prototype.cleanGraph = function(g){\r\n\tif(g.indexOf(\":\") != -1) return g;\r\n\tif(this.vocab && this.vocab[g]) return this.vocab[g];\r\n\treturn \"db:\" + g;\r\n}\r\n\r\nWOQLQuery.prototype.cleanClass = function(c){\r\n\tif(c.indexOf(\":\") != -1) return c;\r\n\tif(this.vocab && this.vocab[c]) return this.vocab[c];\r\n\treturn \"scm:\" + c;\r\n}\r\n\r\n/*\r\n * higher level composite queries - not language or api elements\r\n */\r\n/**\r\n * Class for enabling building of triples from pieces\r\n * type is add_quad / remove_quad / add_triple / remove_triple\r\n */\r\nfunction TripleBuilder(type, cursor, s){\r\n\t//what accumulation type are we\r\n\tthis.type = type;\r\n\tthis.cursor = cursor;\r\n\tthis.subject = (s ? s : false);\r\n\tthis.g = false;\r\n}\r\n\r\nTripleBuilder.prototype.label = function(l, lang){\r\n\tlang = (lang ? lang : \"en\");\r\n\tif(l.substring(0, 2) == \"v:\"){\r\n\t\tvar d = {\"value\": l, \"@language\": lang }\r\n\t}\r\n\telse {\r\n\t\tvar d = {\"@value\": l, \"@language\": lang }\r\n\t}\r\n\tvar x = this.addPO('rdfs:label', d);\r\n\treturn x;\r\n}\r\n\r\nTripleBuilder.prototype.comment = function(c, lang){\r\n\tlang = (lang ? lang : \"en\");\r\n\tif(c.substring(0, 2) == \"v:\"){\r\n\t\tvar d = {\"value\": l, \"@language\": lang }\r\n\t}\r\n\telse {\r\n\t\tvar d = {\"@value\": l, \"@language\": lang }\r\n\t}\r\n\treturn this.addPO('rdfs:comment', d);\r\n}\r\n\r\nTripleBuilder.prototype.addPO = function(p, o, g){\r\n\tif(this.type){\r\n\t\tvar ttype = (this.type == \"isa\" || this.type == \"sub\" ? \"triple\" : this.type);\r\n\t}\r\n\telse var ttype = \"triple\";\r\n\tvar evstr = ttype + '(\"' + this.subject + '\", \"' + p + '\", ';\r\n\tif(typeof o == \"string\"){\r\n\t\tevstr += \"'\" + o + \"'\";\t\t\r\n\t} \r\n\telse if(typeof o == \"object\"){\r\n\t\tevstr += JSON.stringify(o);\r\n\t}\r\n\telse {\r\n\t\tevstr += o;\r\n\t}\r\n\tif(ttype.substring(ttype.length-4) == \"quad\" || this.g){\r\n\t\tvar g = (g ? g : (this.g ? this.g : \"db:schema\"));\r\n\t\tevstr += ', \"' + g + '\"'; \r\n\t}\r\n\tevstr += \")\";\r\n\ttry {\r\n\t\tvar unit = eval(\"new WOQLQuery().\" + evstr );\r\n\t\treturn this.addEntry(unit);\r\n\t}\r\n\tcatch(e){\r\n\t\tconsole.error(e);\r\n\t\treturn this;\r\n\t}\r\n}\r\n\r\nTripleBuilder.prototype.getO = function(s, p){\r\n\tif(this.cursor['and']){\r\n\t\tfor(var i = 0; i<this.cursor['and'].length; i++){\r\n\t\t\tvar clause = this.cursor['and'][i];\r\n\t\t\tvar key = Object.keys(clause)[0];\r\n\t\t\tif(clause[key][0] == s && clause[key][1] == p && clause[key][2]) return clause[key][2];\r\n\t\t}\r\n\t}\r\n\telse if(Object.keys(this.cursor)) {\r\n\t\tvar key =  Object.keys(this.cursor)[0];\r\n\t\tif(this.cursor[key][0] == s && this.cursor[key][1] == p && this.cursor[key][2])  return this.cursor[key][2];\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nTripleBuilder.prototype.addEntry = function(unit){\r\n\tif(this.cursor[this.type]){\r\n\t\tvar next = {};\r\n\t\tnext[this.type] = this.cursor[this.type];\r\n\t\tthis.cursor['and'] = [next];\r\n\t\tdelete(this.cursor[this.type]);\r\n\t}\r\n\tif(this.cursor['and']){\r\n\t\tthis.cursor['and'].push(unit.json());\r\n\t}\r\n\telse {\r\n\t\tvar j = unit.json();\r\n\t\tif(j[this.type]) this.cursor[this.type] = j[this.type];\r\n\t\telse {\r\n\t\t\talert(JSON.stringify(j));\r\n\t\t}\r\n\t}\r\n\treturn this;\r\n}\r\n\r\nTripleBuilder.prototype.card = function(n, which){\r\n\tlet os = this.subject;\r\n\tthis.subject += \"_\" + which;\r\n\tthis.addPO('rdf:type', \"owl:Restriction\");\r\n\tthis.addPO(\"owl:onProperty\", os);\r\n\tswitch(which){\r\n\t\tcase \"max\": this.addPO(\"owl:maxCardinality\", n);\r\n\t\t\tbreak;\r\n\t\tcase \"min\": this.addPO(\"owl:minCardinality\", n);\r\n\t\t\tbreak;\r\n\t\tdefault: this.addPO(\"owl:cardinality\", n);\r\n\t}\r\n\tlet od = this.getO(os, \"rdfs:domain\");\r\n\tif(od){\r\n\t\tvar x = this.subject;\r\n\t\tthis.subject = od;\r\n\t\tthis.addPO(\"rdfs:subClassOf\", this.subject);\r\n\t\t//this.triples.push([od, \"rdfs:subClassOf\", this.subject]);\r\n\t}\r\n\tthis.subject = os;\r\n\treturn this;\r\n};\r\n\r\nTripleBuilder.prototype.isa = function(a){\r\n\tvar unit = new WOQLQuery.isa(this.subject, a);\r\n\tthis.tb.addEntry(unit);\r\n}\r\n\r\nTripleBuilder.prototype.graph = function(g){\r\n\tthis.g = g;\r\n}\r\n\r\nTripleBuilder.prototype.sub = function(s){\r\n\tvar unit = new WOQLQuery.sub(this.subject, s);\r\n\treturn this.addEntry(unit);\r\n}\r\n\r\nTripleBuilder.prototype.abstract = function(){\r\n\treturn this.addPO('tcs:tag', \"tcs:abstract\");\r\n}\r\n\r\nmodule.exports = WOQL;\r\n","function Codemirror(text, format, config){\r\n  this.textdom = text;\r\n  this.mode = format;\r\n  if(objectIsEmpty(config)) this.darkMode = config.darkMode;\r\n  if(this.jsonldCheck(format)) this.mode = 'javascript';\r\n}\r\n// checks if a json object is empty\r\nfunction objectIsEmpty(arg) {\r\n  for (var item in arg) {\r\n    return false;\r\n  }\r\n  return true;\r\n}\r\n\r\nfunction autocomplete(){\r\n    var orig = CodeMirror.hint.javascript = function (cm) {\r\n        var list = [\"limit()\",\"start()\",\"triple()\"];//Session.get(Template.strSessionDistinctFields) || [];\r\n        var cursor = cm.getCursor();\r\n        var currentLine = cm.getLine(cursor.line);\r\n        var start = cursor.ch;\r\n        var end = start;\r\n        while (end < currentLine.length && /[\\w$]+/.test(currentLine.charAt(end))) ++end;\r\n        while (start && /[\\w$]+/.test(currentLine.charAt(start - 1))) --start;\r\n        var curWord = start != end && currentLine.slice(start, end);\r\n        var regex = new RegExp('^' + curWord, 'i');\r\n        var result = {\r\n            list: (!curWord ? list : list.filter(function (item) {\r\n                return item.match(regex);\r\n            })).sort(),\r\n            from: CodeMirror.Pos(cursor.line, start),\r\n            to: CodeMirror.Pos(cursor.line, end)\r\n        };\r\n        return result;\r\n    };\r\n    // codeMirror.hint.sql is defined when importing codemirror/addon/hint/sql-hint\r\n    // (this is mentioned in codemirror addon documentation)\r\n    // Reference the hint function imported here when including other hint addons\r\n    // or supply your own\r\n   \t//cm.replaceSelection(\".\");\r\n    //codeMirror.showHint(cm, CodeMirror.hint.javascript, hintOptions);\r\n}\r\n\r\n/*\r\ntxtar    : editor is attached to textar\r\nmode     : format for highlighting, ex: json, html etc.\r\neditable : readOnly false/ nocursor is special value in code editor to set readonly true */\r\nCodemirror.prototype.colorizeTextArea = function(dimensions){\r\n    //initize auto complete\r\n    /*CodeMirror.commands.autocomplete = function(cm) {\r\n    cm.showHint({hint: CodeMirror.hint.anyword});\r\n    }*/\r\n\r\n    // initialise code editor on text area\r\n    var editor = CodeMirror.fromTextArea(this.textdom, {\r\n        mode                : this.mode,\r\n        firstLineNumber     : 1,\r\n        lineNumbers         : true,\r\n        styleActiveLine     : true,\r\n        lineWrapping        : true,\r\n        smartIndent         : true,\r\n        indentWithTabs      : true,\r\n        newlineAndIndent    : true,\r\n        autoCloseBrackets   : true,\r\n        matchBrackets       : {afterCursor: true},\r\n        extraKeys           : {\"Ctrl-F\": \"find\",\r\n                               \"Tab\": \"autocomplete\",\r\n                               \"Ctrl-Q\": function(cm){ cm.foldCode(cm.getCursor()); }},\r\n        refresh             : true,\r\n        foldGutter          : true,\r\n        gutters             : [\"CodeMirror-linenumbers\", \"CodeMirror-foldgutter\"]\r\n    });\r\n    editor.foldCode(CodeMirror.Pos(13, 0));\r\n    if(!(objectIsEmpty(dimensions)))\r\n        editor.setSize(dimensions.width, dimensions.height);\r\n    else this.setCodemirrorSize(editor, dimensions);\r\n    editor.defaultCharWidth('20px');\r\n    if(this.darkMode) editor.setOption(\"theme\", 'erlang-dark');\r\n    else editor.setOption(\"theme\", 'neo');\r\n    return editor;\r\n} // colorizeTextArea()\r\n\r\n/*\r\n  set editor size according to screens\r\n  editor : code mirror editor Object\r\n  mode   : editor being viewed from schema/ doc/ query page*/\r\nCodemirror.prototype.setCodemirrorSize = function(editor, dimensions){\r\n  switch(dimensions){\r\n    case 'query':\r\n      editor.setSize('800', '400');\r\n    break;\r\n    case 'schema':\r\n      editor.setSize('auto', '1550');\r\n    break;\r\n    case 'document':\r\n     editor.setSize('765', '500');\r\n    break;\r\n    case 'api-doc':\r\n        editor.setSize('800', '500');\r\n    break;\r\n    case 'doc-json':\r\n        editor.setSize('1410', 'auto');\r\n    break;\r\n    case 'doc-json-create':\r\n        editor.setSize('1410', '500');\r\n    break;\r\n  } // switch(dimensions)\r\n} // setCodemirrorSize()\r\n\r\n// updateTextArea(): highlights new changes on editor\r\nCodemirror.prototype.updateTextArea = function(editor){\r\n  editor.save();\r\n  setTimeout(function() {\r\n      editor.refresh();\r\n  },1);\r\n  // save changes of code mirror editor\r\n  editor.on('change', function(){\r\n    editor.save();\r\n  });\r\n} //updateTextArea()\r\n\r\n/*\r\ncolorizePre() to colorise pre tags (read only mode)\r\ntext (string)    : The document to run through the highlighter.\r\nmode (mode spec) : format to highlight color\r\noutput (DOM node): The tokens will be converted to spans as in an editor,\r\n                   and inserted into the node (through innerHTML).*/\r\nCodemirror.prototype.colorizePre = function(){\r\n  CodeMirror.runMode(this.textdom.innerText, this.mode, this.textdom);\r\n  if(this.darkMode)\r\n      var theme = 'cm-s-erlang-dark';\r\n  else var theme = 'cm-s-neo';\r\n  this.textdom.setAttribute('class', 'CodeMirror CodeMirror-wrap ' + theme + ' terminus-wrap-text terminus-wrapper-height ');\r\n  return this.textdom;\r\n} // colorizePre()\r\n\r\nCodemirror.prototype.jsonldCheck = function(format){\r\n  if(format == 'jsonld') return true;\r\n}\r\n\r\nmodule.exports=Codemirror\r\n","const TerminusPluginManager = require('../plugins/TerminusPlugin');\r\nconst Datatables = require('../plugins/datatables.terminus');\r\nconst UTILS=require('../Utils');\r\nconst HTMLFrameHelper = require('../html/HTMLFrameHelper');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction WOQLResult(res, query, options, ui){\r\n\tthis.ui = ui;\r\n\tthis.query = query;\r\n\tthis.bindings = ((res && res.bindings) ? res.bindings : []);\r\n}\r\n\r\nWOQLResult.prototype.count = function(){\r\n\treturn this.bindings.length;\r\n}\r\n\r\nWOQLResult.prototype.shorten = function(url){\r\n\treturn this.query.shorten(url);\r\n}\r\n\r\nWOQLResult.prototype.hasBindings = function(result){\r\n\tif(result) return (result.bindings && result.bindings.length);\r\n\telse return (this.bindings && this.bindings.length);\r\n}\r\n\r\n\r\nfunction WOQLResultsViewer(ui, wresult, woqlResult, options, settings, queryPage){\r\n\tthis.ui = ui;\r\n\tthis.result = wresult;\r\n\tthis.woqlResult = woqlResult;\r\n\tthis.max_cell_size = 400;\r\n\tthis.max_word_size = 60;\r\n\tthis.options = options;\r\n\tthis.qPage = queryPage;\r\n\t//this.wqlRes = new WOQLResult();\r\n\tthis.pman = new TerminusPluginManager();\r\n\tthis.settings = settings;\r\n}\r\n\r\nWOQLResultsViewer.prototype.showTable = function(){\r\n\tif(this.options && typeof this.options.show_table != \"undefined\") return this.options.show_table;\r\n\treturn true;\r\n}\r\n\r\nWOQLResultsViewer.prototype.orderColumns = function(sample){\r\n\tvar ordered = [];\r\n\tfor(var h in sample){\r\n\t\tif(ordered.indexOf(h) == -1){\r\n\t\t\tordered.unshift(h);\r\n\t\t}\r\n\t}\r\n\treturn ordered;\r\n}\r\n\r\nWOQLResultsViewer.prototype.getAsDOM = function(resultDOM, displayResultHeader){\r\n\tvar rs = document.createElement('div');\r\n\tresultDOM.appendChild(rs);\r\n\r\n\tif(displayResultHeader){\r\n\t\tvar rh = document.createElement('div');\r\n\t\trh.setAttribute(\"class\", \"terminus-margin-top-bottom terminus-module-head\");\r\n\t\trh.appendChild(document.createTextNode(\"Results\"));\r\n\t\trs.appendChild(rh);\r\n\t}\r\n\tif(this.result && this.woqlResult.hasBindings(this.result) && this.showTable()){\r\n\t\tthis.getTableDOM(this.result.bindings, rs);\r\n\t\treturn rs;\r\n\t}\r\n\telse {\r\n\t\tnor = document.createElement('div');\r\n\t\tnor.setAttribute('class', 'terminus-no-res-alert');\r\n\t\tnor.appendChild(document.createTextNode(\"No results available, create new ones to view them here...\"));\r\n\t\trs.appendChild(nor);\r\n\t\treturn rs;\r\n\t}\r\n}\r\n\r\nWOQLResultsViewer.prototype.getTableDOM = function(bindings, resultDOM){\r\n\tif(this.pman.pluginAvailable(\"datatables\")){\r\n\t\tvar dtResult = this.getTable(bindings, true, {});\r\n\t\tresultDOM.appendChild(dtResult.tab);\r\n\t\tvar dt = new Datatables.Datatables(this, this.qPage);\r\n\t\tdt.draw(dtResult, resultDOM);\r\n\t\tresultDOM.classList.add('terminus-expandable');\r\n\t\tresultDOM.classList.add('terminus-dt-result-cont');\r\n\t\treturn tab;\r\n    }\r\n\telse {\r\n\t\tvar tab = this.getTable(bindings, false, {});\r\n\t\tresultDOM.appendChild(tab);\r\n\t}\r\n}\r\n\r\nWOQLResultsViewer.prototype.getDtTableDOMOnChange = function(bindings, resultDOM, pageInfo){\r\n\t\tvar dtResult = this.getTable(bindings, true, pageInfo);\r\n\t\tresultDOM.appendChild(dtResult.tab);\r\n\t\treturn dtResult;\r\n}\r\n\r\nWOQLResultsViewer.prototype.formatResultsForDatatableDisplay = function(bindings, pageInfo){\r\n    var columns = [], colDataData = {}, data = [], formattedResult = {}, arr = [];\r\n\tvar dtResult = {};\r\n    var ordered_headings = this.orderColumns(bindings[0]);\r\n\t// get columns\r\n\tfor(var i = 0; i<ordered_headings.length; i++){\r\n\t\tvar clab = TerminusClient.FrameHelper.validURL(ordered_headings[i]) ? TerminusClient.FrameHelper.labelFromURL(ordered_headings[i]) : ordered_headings[i];\r\n        columns.push({data: clab});\r\n\t}\r\n\t// get data for respective columns\r\n\tfor(var i = 0; i<bindings.length; i++){\r\n\t\tcolDataData = {};\r\n\t\tfor(var j = 0; j<ordered_headings.length; j++){\r\n\t\t\tif(typeof bindings[i][ordered_headings[j]] == \"object\"){\r\n\t\t\t\tvar lab = (bindings[i][ordered_headings[j]]['@value'] ? bindings[i][ordered_headings[j]]['@value'] : \"Object?\");\r\n\t\t\t\tvar wrap = document.createElement(\"p\");\r\n\t\t\t\twrap.setAttribute(\"class\", \"terminus-table-content\");\r\n\t\t\t\tHTMLFrameHelper.wrapShortenedText(wrap, lab, this.max_cell_size, this.max_word_size);\r\n\t\t\t\tlab = wrap.innerText;\r\n\t\t\t}\r\n\t\t\telse if(typeof bindings[i][ordered_headings[j]] == \"string\") {\r\n\t\t\t\t//var lab = this.result.shorten(bindings[i][ordered_headings[j]]);\r\n\t\t\t\tvar lab = bindings[i][ordered_headings[j]];\r\n\t\t\t\tif(lab == \"unknown\") lab = \"\";\r\n\t\t\t\telse if(lab.substring(0, 4) == \"doc:\"){\r\n\t\t\t\t\tvar a = document.createElement(\"a\");\r\n\t\t\t\t\ta.setAttribute(\"title\", lab);\r\n\t\t\t\t\ta.setAttribute(\"href\", '#');\r\n\t\t\t\t\ta.appendChild(document.createTextNode(lab));\r\n\t\t\t\t\tlab = a.outerHTML;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar clab = TerminusClient.FrameHelper.validURL(ordered_headings[j]) ? TerminusClient.FrameHelper.labelFromURL(ordered_headings[j]) : ordered_headings[j];\r\n\t\t\tcolDataData[clab] = lab;\r\n\t\t}\r\n\t\tdata.push(colDataData);\r\n\t}\r\n\tdtResult.columns                = columns;\r\n\tformattedResult.data            = data;\r\n\tformattedResult.recordsTotal    = 65;\r\n\tformattedResult.recordsFiltered = 65;\r\n\tformattedResult.draw \t\t\t= pageInfo.draw;\r\n\tdtResult.data \t\t\t\t\t= formattedResult;\r\n\treturn dtResult;\r\n}\r\n\r\nWOQLResultsViewer.prototype.getTableBody = function(bindings, ordered_headings){\r\n\tvar tbody = document.createElement(\"tbody\");\r\n\tvar self = this;\r\n\tfor(var i = 0; i<bindings.length; i++){\r\n\t\tvar tr = document.createElement(\"tr\");\r\n\t\tfor(var j = 0; j<ordered_headings.length; j++){\r\n\t\t\tvar td = document.createElement(\"td\");\r\n\t\t\tif(typeof bindings[i][ordered_headings[j]] == \"object\"){\r\n\t\t\t\tvar lab = (bindings[i][ordered_headings[j]]['@value'] ? bindings[i][ordered_headings[j]]['@value'] : \"?\");\r\n\t\t\t}\r\n\t\t\telse if(typeof bindings[i][ordered_headings[j]] == \"string\") {\r\n\t\t\t\t//var lab = this.result.shorten(bindings[i][ordered_headings[j]]);\r\n\t\t\t\tvar lab = bindings[i][ordered_headings[j]];\r\n\t\t\t}\r\n\t\t\tif(lab == \"unknown\") lab = \"\";\r\n\t\t\tif(lab.substring(0, 4) == \"doc:\"){\r\n\t\t\t\tvar a = this.getDocumentLocalLink(lab);\r\n\t\t\t\ttd.appendChild(a);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tHTMLFrameHelper.wrapShortenedText(td, lab, this.max_cell_size, this.max_word_size);\r\n\t\t\t}\r\n\t\t\ttr.appendChild(td);\r\n\t\t}\r\n\t\ttbody.appendChild(tr);\r\n\t}\r\n\treturn tbody;\r\n}\r\n\r\nWOQLResultsViewer.prototype.selectDocumentNavBar = function(ui) {\r\n\tUTILS.removeSelectedNavClass(\"terminus-selected\");\r\n\tvar dnav = document.getElementsByClassName('terminus-document-nav');\r\n\tdnav[0].classList.add(\"terminus-selected\");\r\n\tUTILS.displayDocumentSubMenus(ui);\r\n}\r\n\r\nWOQLResultsViewer.prototype.getDocumentLocalLink = function(lab){\r\n\tvar a = document.createElement(\"a\");\r\n\ta.setAttribute(\"title\", lab);\r\n\ta.setAttribute(\"href\", '#');\r\n\tvar self = this;\r\n\ta.addEventListener(\"click\", function(){\r\n\t\tif(self.result.ui) {\r\n\t\t\tself.result.ui.showDocument(this.title);\r\n\t\t\t//self.result.ui.redraw();\r\n\t\t\tself.selectDocumentNavBar(self.ui);\r\n\t\t}\r\n\t});\r\n\ta.appendChild(document.createTextNode(lab));\r\n\treturn a;\r\n}\r\n\r\nWOQLResultsViewer.prototype.getTable = function(bindings, dtPlugin, pageInfo){\r\n\tvar tab = document.createElement(\"table\");\r\n\ttab.setAttribute(\"class\", \"terminus-hover-table\");\r\n\tvar thead = document.createElement(\"thead\");\r\n\tvar thr = document.createElement(\"tr\");\r\n\tvar ordered_headings = this.orderColumns(bindings[0]);\r\n\tfor(var i = 0; i<ordered_headings.length; i++){\r\n\t\tvar th = document.createElement(\"th\");\r\n\t\tth.setAttribute('class', 'terminus-table-header-full-css');\r\n\t\tvar clab = (ordered_headings[i].indexOf(\"http\") != -1) ? TerminusClient.FrameHelper.labelFromURL(ordered_headings[i]) : ordered_headings[i];\r\n\t\tth.appendChild(document.createTextNode(clab));\r\n\t\tthr.appendChild(th);\r\n\t}\r\n\tthead.appendChild(thr);\r\n\ttab.appendChild(thead);\r\n\tif(dtPlugin){\r\n\t\tvar tbody = document.createElement(\"tbody\");\r\n\t\ttab.appendChild(tbody);\r\n\t\tvar dtResult ={};\r\n\t\tdtResult.result = this.formatResultsForDatatableDisplay(bindings, pageInfo);\r\n\t\tdtResult.tab = tab;\r\n\t\treturn dtResult;\r\n\t}\r\n\telse {\r\n\t\tvar tbody = this.getTableBody(bindings, ordered_headings);\r\n\t\ttab.appendChild(tbody);\r\n\t\treturn tab;\r\n\t}\r\n}\r\n\r\n\r\nmodule.exports={WOQLResultsViewer, WOQLResult}\r\n","/**\r\n * object renderer binds to object frame - provides filters, sorts and manipulations of underlying object frame\r\n * and coordinates viewer to draw updates\r\n\r\n * Object Renderer - provides sorting / filtering / state management of objects\r\n * @param obj ObjectFrame object - contains underlying data and frame structure\r\n * @param parent PropertyRenderer - property that owns this object (if any)\r\n * @param options options json\r\n * @returns\r\n */\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\nconst RenderingMap = require('./RenderingMap');\r\nconst ValueRenderer = require('./ValueRenderer');\r\nconst ObjectViewer = require('../html/document/ObjectViewer');\r\nconst PropertyViewer = require('../html/document/PropertyViewer');\r\nconst HTMLDataViewer = require('../html/document/DataViewer');\r\nconst HTMLFrameHelper = require('../html/HTMLFrameHelper');\r\n\r\nfunction PropertyRenderer(prop, parent, options){\r\n\tthis.predicate = prop;\r\n\tthis.parent = parent;\r\n\tthis.cframe = this.parent.objframe.getPropertyClassFrame(this.predicate);\r\n\tthis.originalValues = false;\r\n\tthis.changed = false;\r\n\tthis.values = [];\r\n\tthis.renderer_type = \"property\";\r\n\tthis.options = this.setOptions(options);\r\n}\r\n\r\nPropertyRenderer.prototype.setOptions = function(options){\r\n\treturn TerminusDashboard.RenderingMap.decorateRenderer(options, this);\r\n}\r\n\r\nPropertyRenderer.prototype.getOptionsForChild = function(){\r\n\tvar opts = {};\r\n\tif(this.options.features){ opts.features = this.options.features };\r\n\tif(this.options.controls){ opts.controls = this.options.controls};\r\n\treturn this.options;\r\n}\r\n\r\nPropertyRenderer.prototype.getOptionsForValue = function(df, index){\r\n\treturn this.getOptionsForChild();\r\n}\r\n\r\nPropertyRenderer.prototype.getOptionsForObject = function(objframe){\r\n\treturn this.getOptionsForChild();\r\n}\r\n\r\n\r\nPropertyRenderer.prototype.render = function(viewer){\r\n \tthis.buildValueRenderers();\r\n \tif(this.cframe && this.cframe.property){\r\n \t\tthis.viewer = (viewer ? viewer : this.getViewerForProperty());\r\n \t\tfor(var i = 0; i<this.values.length; i++){\r\n \t\t\tvar renderedval = this.values[i].render();\r\n \t\t\tif(renderedval && this.showFeature(\"body\")) this.viewer.addRenderedValue(renderedval);\r\n \t\t}\r\n \t\treturn this.viewer.render();\r\n \t}\r\n}\r\n\r\n/*\r\n * Creates the array of object renderer or value renderer objects corresponding to the property values.\r\n */\r\nPropertyRenderer.prototype.buildValueRenderers = function(){\r\n \tvar adorig = (this.originalValues === false ? true : false);\r\n \tthis.cframe = this.parent.objframe.getPropertyClassFrame(this.predicate);\r\n \tif(!this.cframe){\r\n \t\tconsole.error(\"No frame for \" + this.property() + \" id: \" + this.subject());\r\n \t\treturn false;\r\n \t}\r\n \tif(this.cframe && this.cframe.isData()){\r\n \t\tvar dataframes = this.getDataFramesToRender();\r\n \t\tif(dataframes.length == 0){\r\n \t\t\talert(this.predicate);\r\n \t\t}\r\n \t\tvar vals = [];\r\n \t\tfor(var i = this.values.length; i<dataframes.length; i++){\r\n \t\t\tvar vr = new ValueRenderer(dataframes[i], i, this, this.getOptionsForValue(dataframes[i], i));\r\n \t\t\tthis.values.push(vr);\r\n \t\t\tvals.push(vr.value());\r\n \t\t}\r\n \t\tif(adorig) this.originalValues = vals;\r\n \t}\r\n \telse {\r\n \t\tif(adorig) this.originalValues = [];\r\n \t\tvar kids = this.getChildrenToRender();\r\n \t\tif(kids && kids.length){\r\n \t\t\tfor(var i = this.values.length; i<kids.length; i++){\r\n \t\t\t\tvar kidf = new ObjectRenderer(kids[i], this, this.getOptionsForObject(kids[i]));\r\n \t\t\t\tif(adorig) this.originalValues.push(kidf.subject());\r\n \t\t\t\tthis.values.push(kidf);\r\n \t\t\t}\r\n \t\t}\r\n \t}\r\n}\r\n\r\n/*\r\n * Returns the array of values that should be rendered (enables value filtering)\r\n */\r\nPropertyRenderer.prototype.getDataFramesToRender = function(options){\r\n \tvar allvals = this.parent.objframe.getDataFrames(this.property());\r\n \treturn allvals;\r\n}\r\n\r\n/*\r\n * Returns the array of child / objects that should be rendered (enables value filtering)\r\n */\r\nPropertyRenderer.prototype.getChildrenToRender = function(options){\r\n \tif(TerminusClient.FrameHelper.viewIncludesChildren(this.view, \"property\")){\r\n \t\tvar allkids = this.parent.objframe.getChildren(this.property());\r\n \t}\r\n \telse {\r\n \t\tvar allkids = [];\r\n \t}\r\n \treturn allkids;\r\n}\r\n\r\nPropertyRenderer.prototype.redraw = function(){\r\n \tthis.viewer.clear();\r\n \tthis.render(this.viewer, \"x\");\r\n \t//alert(this.values.length);\r\n}\r\n\r\nPropertyRenderer.prototype.extract = function(){\r\n \tvar extracts = [];\r\n \tfor(var i = 0; i<this.values.length; i++){\r\n \t\tvar val = this.values[i].extract();\r\n \t\tif(val !== \"\" && val !== false && typeof val != \"undefined\") extracts.push(val);\r\n \t}\r\n \tif(this.cframe.isData()){\r\n \t\treturn extracts;\r\n \t}\r\n \telse {\r\n \t\treturn extracts;\r\n \t\tvar extr = {};\r\n \t\tfor(var i = 0; i<extracts.length; i++){\r\n \t\t\tfor(var subjid in extracts[i]){\r\n \t\t\t\textr[subjid] = extracts[i][subjid];\r\n \t\t\t}\r\n \t\t}\r\n \t\treturn extr;\r\n \t}\r\n}\r\n\r\n/*\r\n * simple wrapper functions\r\n */\r\nPropertyRenderer.prototype.currentViewer = function(){return this.viewerType;}\r\nPropertyRenderer.prototype.property = function(){return this.predicate;}\r\nPropertyRenderer.prototype.subject = function(){return (this.parent ? this.parent.subject() : false);};\r\nPropertyRenderer.prototype.depth = function(){return (this.parent ? this.parent.depth() : false);};\r\nPropertyRenderer.prototype.subjectClass = function(){return (this.parent ? this.parent.subjectClass() : false);};\r\nPropertyRenderer.prototype.updated = function(){ return (this.parent ? this.parent.childUpdated() : false);};\r\nPropertyRenderer.prototype.range = function(){\treturn (this.cframe ? this.cframe.range : \"\");};\r\nPropertyRenderer.prototype.getLabel = function(){ return (this.cframe ? this.cframe.getLabel() : \"\" );};\r\nPropertyRenderer.prototype.getComment = function(){ return (this.cframe ? this.cframe.getComment() : false);}\r\nPropertyRenderer.prototype.load = function(link){ return (this.parent ? this.parent.load(link) : false);}\r\nPropertyRenderer.prototype.hasCardinalityRestriction = function(){return (this.cframe ? this.cframe.hasRestriction() : false);};\r\nPropertyRenderer.prototype.getRestriction = function(){return (this.cframe ? this.cframe.restriction : false);};\r\nPropertyRenderer.prototype.isClassChoice = function(){\treturn (this.cframe ? this.cframe.isClassChoice() : false);};\r\nPropertyRenderer.prototype.currentFacet = function(){\treturn this.facet;} ;\r\nPropertyRenderer.prototype.save = function(){ return (this.parent ? this.parent.save() : false);};\r\n\r\nPropertyRenderer.prototype.cancel = function(){\r\n\tthis.reset();\r\n\tthis.setMode(\"view\");\r\n}\r\n\r\nPropertyRenderer.prototype.getAvailableClassChoices = function(){\r\n\tif(this.cframe){\r\n\t\tvar cf = this.cframe.getClassChoices();\r\n\t\tif(this.parent){\r\n\t\t\tvar choices = [];\r\n\t\t\tfor(var i = 0; i < cf.length; i++){\r\n\t\t\t\tvar clsmeta = this.parent.getClassMeta(cf[i]);\r\n\t\t\t\tvar lab = (clsmeta ? HTMLFrameHelper.getVariableValueFromBinding(\"Label\", clsmeta) : false);\r\n\t\t\t\tvar lab = (lab ? lab : TerminusClient.FrameHelper.labelFromURL(cf[i]));\r\n\t\t\t\tchoices.push({value: cf[i], label: lab});\r\n\t\t\t}\r\n\t\t\treturn choices;\r\n\t\t}\r\n\t\treturn cf;\r\n\r\n\t}\r\n\treturn false;\r\n};\r\n\r\n\r\nPropertyRenderer.prototype.delete = function(){\r\n\tvar prop = this.predicate;\r\n\tif(prop){\r\n\t\tthis.reset();\r\n\t\tthis.parent.deleteProperty(prop);\r\n\t\tthis.parent.redraw();\r\n\t}\r\n}\r\n\r\nPropertyRenderer.prototype.add = function(view){\r\n\tthis.parent.addProperty(this.property(), view);\r\n\tthis.updated();\r\n\tif(view) {\r\n\t\tthis.values[this.values.length-1].setMode(view);\r\n\t\tthis.values[this.values.length-1].setNew();\r\n\t}\r\n\tthis.redraw();\r\n}\r\n\r\nPropertyRenderer.prototype.goToValue = function(index){\r\n\tthis.viewer.goTo(this.subject(), this.property(), index);\r\n}\r\n\r\nPropertyRenderer.prototype.addClass = function(cls){\r\n\tthis.parent.addPropertyClass(this.property(), cls);\r\n\tthis.updated();\r\n\tvar newb = this.values[this.values.length-1];\r\n\tif(newb){\r\n\t\tnewb.setNew();\r\n\t\tnewb.setMode(\"edit\");\r\n\t}\r\n\tthis.redraw();\r\n\tif(newb) this.viewer.goTo(newb.subject());\r\n}\r\n\r\nPropertyRenderer.prototype.reset = function(){\r\n\tthis.parent.objframe.reset(this.predicate);\r\n\tif(this.cframe && this.cframe.isData()){\r\n\t\tfor(var i = 0; i<this.values.length; i++){\r\n\t\t\tthis.values[i].reset();\r\n\t\t}\r\n\t\tthis.values = [];\r\n\t}\r\n\telse {\r\n\t\tvar nvals = [];\r\n\t\tfor(var i = 0; i<this.originalValues.length; i++){\r\n\t\t\tfor(var j = 0; j<this.values.length; j++){\r\n\t\t\t\tthis.values[j].reset();\r\n\t\t\t\tif(this.values[j].subject() == this.originalValues[i]){\r\n\t\t\t\t\tnvals.push(this.values[j]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.values = nvals;\r\n\t}\r\n\tthis.redraw();\r\n\tthis.parent.childUpdated();\r\n}\r\n\r\nPropertyRenderer.prototype.deletePropertyValue = function(value, index){\r\n\tthis.parent.objframe.removePropertyValue(this.property(), value, index);\r\n\tvar nvals = [];\r\n\tfor(var i = 0; i<this.values.length; i++){\r\n\t\tif(typeof index == \"undefined\"){\r\n\t\t\tif(this.values[i].subject() == value){\r\n\t\t\t\tthis.values[i].reset();\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tnvals.push(this.values[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if(i != index){\r\n\t\t\tthis.values[i].index = nvals.length;\r\n\t\t\tnvals.push(this.values[i]);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.values[i].reset();\r\n\t\t}\r\n\t}\r\n\tthis.values = nvals;\r\n\tthis.parent.childUpdated();\r\n\tthis.parent.redraw();\r\n}\r\n\r\nPropertyRenderer.prototype.addPropertyValue = function(value){\r\n\tthis.updated();\r\n\treturn this.parent.objframe.addPropertyValue(this.property(), value);\r\n}\r\n\r\n/*\r\n * Checks to see if an action (add, clone, delete) which affects the cardinality of the property is allowed by cardinality rules.\r\n */\r\nPropertyRenderer.prototype.cardControlAllows = function(action){\r\n\tif(this.cframe.hasRestriction()){\r\n\t\tvar rest = this.cframe.restriction;\r\n\t\tvar currentnum = this.values.length;\r\n\t\tif(action == \"add\" || action == \"clone\"){\r\n\t\t\tif(rest.max && currentnum >= rest.max){\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(action == \"delete\" && (rest.min)){\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nPropertyRenderer.prototype.isNew = function(){\r\n\tif(this.new_property){\r\n\t\treturn true;\r\n\t}\r\n\treturn this.parent.isNew();\r\n}\r\n\r\nPropertyRenderer.prototype.setNew = function(){\r\n\tthis.new_property = true;\r\n}\r\n\r\n\r\nPropertyRenderer.prototype.isUpdated = function(){\r\n\tif(this.values.length != this.originalValues.length) return true;\r\n\tfor(var i = 0 ; i < this.values.length; i++){\r\n\t\tif(this.cframe && this.cframe.isData()){\r\n\t\t\tif(this.values[i].value() != this.originalValues[i]){\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tif(this.values[i].subject() != this.originalValues[i]) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\tif(this.values[i].isUpdated()) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nPropertyRenderer.prototype.childUpdated = function(){\r\n\tthis.viewer.redrawHeader();\r\n\tif(this.parent) this.parent.childUpdated();\r\n}\r\n\r\n\r\n/**\r\n * Sets mode of viewer to either \"view\" or \"edit\"\r\n */\r\nPropertyRenderer.prototype.setMode = function(mode){\r\n\tthis.mode = mode;\r\n\tfor(var i = 0; i<this.values.length; i++){\r\n\t\tthis.values[i].setMode(mode);\r\n\t}\r\n\tthis.redraw();\r\n}\r\n\r\n/*\r\n * Jump to property value\r\n */\r\nPropertyRenderer.prototype.getViewableValues = function(){\r\n\tvar viewables = [];\r\n\tif(this.cframe && this.cframe.isData())\r\n\tfor(var i = 0; i<this.values.length; i++){\r\n\t\tvar sum = this.values[i].getSummary();\r\n\t\tvar lab = sum.long;\r\n\t\tviewables.push({label: lab, value: i});\r\n\t}\r\n\treturn viewables;\r\n}\r\n\r\nPropertyRenderer.prototype.hideDisabledControls = function(){\r\n\treturn this.hide_disabled_controls;\r\n}\r\n\r\nPropertyRenderer.prototype.setFacet = function(facet, nocascade){\r\n\tthis.facet = facet;\r\n\tif(!nocascade){\r\n\t\tfor(var i = 0; i<this.values.length; i++){\r\n\t\t\tthis.values[i].parentFacetChange(facet);\r\n\t\t}\r\n\t}\r\n\tthis.redraw();\r\n}\r\n\r\nPropertyRenderer.prototype.parentFacetChange = function(facet){\r\n\tif(facet == 'page'){\r\n\t\tif(!(this.facet == \"page\" || this.facet == \"multiline\")){\r\n\t\t\tthis.setFacet('multiline');\r\n\t\t}\r\n\t}\r\n\tif(facet == 'line'){\r\n\t\tthis.setFacet(\"label\");\r\n\t}\r\n\r\n}\r\n\r\n\r\n\r\nPropertyRenderer.prototype.getDefaultFacets = function(){\r\n\tvar defs = {\r\n\t\tpage: {\r\n\t\t\tlabel: \"Full Page\", value: \"page\",\r\n\t\t\tfeatures: [\"facet\", \"label\", \"comment\", \"id\", \"control\", \"type\", \"cardinality\", \"body\", \"status\", \"facet\", \"view\", \"viewer\"],\r\n\t\t\tcontrols: [\"delete\", \"clone\", \"add\", \"reset\", \"cancel\", \"update\", \"mode\", \"show\", \"hide\"]\r\n\t\t},\r\n\t\tmultiline: {\r\n\t\t\tlabel: \"Multiple Lines\", value: \"multiline\",\r\n\t\t\tfeatures: [\"facet\", \"label\", \"comment\", \"id\", \"control\", \"type\", \"cardinality\", \"body\", \"status\", \"facet\", \"view\", \"viewer\"],\r\n\t\t\tcontrols: [\"delete\", \"clone\", \"add\", \"reset\", \"cancel\", \"update\", \"mode\", \"show\", \"hide\"]\r\n\t\t},\r\n\t\tline: {\r\n\t\t\tlabel: \"Single Line\", value: \"line\",\r\n\t\t\tfeatures: [\"facet\", \"label\", \"comment\", \"id\", \"control\", \"type\", \"cardinality\", \"body\", \"status\", \"facet\", \"viewer\"],\r\n\t\t\tcontrols: [\"delete\", \"clone\", \"add\", \"reset\", \"cancel\", \"update\", \"mode\", \"show\", \"hide\"]\r\n\t\t},\r\n\t\tsummary: {\r\n\t\t\tlabel: \"Summary\", value: \"summary\",\r\n\t\t\tfeatures: [\"facet\", \"satus\", \"label\", \"type\", \"cardinality\", \"body\", \"status\", \"facet\", \"viewer\"],\r\n\t\t\tcontrols: []\r\n\t\t},\r\n\t\tlabel: {\r\n\t\t\tlabel: \"Label\", value: \"label\",\r\n\t\t\tfeatures: [\"facet\", \"status\", \"label\", \"summary\"],\r\n\t\t\tcontrols: []\r\n\t\t},\r\n\t\ticon: {\r\n\t\t\tlabel: \"Snippet\", value: \"icon\",\r\n\t\t\tfeatures: [\"facet\", \"summary\"],\r\n\t\t\tcontrols: []\r\n\t\t}\r\n\t}\r\n\treturn defs;\r\n}\r\n\r\nPropertyRenderer.prototype.getAvailableFacets = function(){\r\n\treturn Object.values(this.facets);\r\n\tvar facets = [];\r\n\tfacets.push({label: \"Full Page\", value: \"page\"});\r\n\tfacets.push({label: \"Multiple Lines\", value: \"multiline\"});\r\n\tfacets.push({label: \"Single Line\", value: \"line\"});\r\n\tfacets.push({label: \"Summary\", value: \"summary\"});\r\n\tfacets.push({label: \"Label\", value: \"label\"});\r\n\tfacets.push({label: \"Snippet\", value: \"icon\"});\r\n\treturn facets;\r\n}\r\n\r\nPropertyRenderer.prototype.getContentOrientation = function(facet){\r\n\tif(this.currentFacet() == \"page\" || this.containsPage()){\r\n\t\treturn \"page\";\r\n\t}\r\n\tif(this.currentFacet() == \"line\" || this.currentFacet() == \"multiline\" || this.currentFacet() == \"summary\"){\r\n\t\treturn \"line\";\r\n\t}\r\n\treturn \"label\";\r\n}\r\n\r\n\r\nPropertyRenderer.prototype.getDefaultFacet = function(){\r\n\tif(this.cframe && this.cframe.isObject()){\r\n\t\treturn \"page\";\r\n\t}\r\n\treturn \"multiline\";\r\n}\r\n\r\n/*\r\n * Viewers for specific properties\r\n */\r\n\r\nPropertyRenderer.prototype.hide = function(){\r\n\tthis.setView(\"hidden\");\r\n}\r\n\r\nPropertyRenderer.prototype.show = function(){\r\n\tthis.setView(\"full\");\r\n}\r\n\r\nPropertyRenderer.prototype.setView = function(view){\r\n\tthis.view = view;\r\n\tthis.redraw();\r\n}\r\n\r\nPropertyRenderer.prototype.getAvailableViewers = function(){\r\n\tif(this.mode == \"view\"){\r\n\t\treturn TerminusDashboard.RenderingMap.getAvailablePropertyViewers(this);\r\n\t}\r\n\treturn TerminusDashboard.RenderingMap.getAvailablePropertyEditors(this);\r\n}\r\n\r\nPropertyRenderer.prototype.nukeViewer = function(){\r\n\tthis.viewer.remove();\r\n}\r\n\r\nPropertyRenderer.prototype.containsPage = function(){\r\n\t//collapsed facets do not show their values\r\n\tif(this.currentFacet() == \"icon\" || this.currentFacet() == \"label\") return false;\r\n\tfor(var i = 0; i<this.values.length; i++){\r\n\t\tif(this.values[i].facet == \"page\") {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nPropertyRenderer.prototype.getViewerForProperty = function(ptype){\r\n\tif(this.mode == \"edit\"){\r\n\t\treturn new PropertyViewer.HTMLPropertyViewer(this);\r\n\t}\r\n\treturn new PropertyViewer.HTMLPropertyViewer(this);\r\n}\r\n\r\nPropertyRenderer.prototype.getPropertyHeaderViewer = function(){\r\n\treturn new PropertyViewer.HTMLPropertyHeaderViewer();\r\n}\r\n\r\nPropertyRenderer.prototype.getSummary = function(){\r\n\tvar status = \"ok\";\r\n\tif(this.isNew()) status = \"new\";\r\n\telse if(this.isUpdated()) status = \"updated\";\r\n\tvar ret = {\r\n\t\tstatus: status,\r\n\t\tvalcount: this.values.length\r\n\t};\r\n\tret.long = ((ret.valcount != 1) ? \"(\" + ret.valcount + \") \" : \"\");\r\n\tfor(var i = 0; i<this.values.length; i++){\r\n\t\tvsum = this.values[i].getSummary();\r\n\t\tret.long += vsum.long;\r\n\t\tif(i < this.values.length-1) ret.long += \", \";\r\n\t}\r\n\treturn ret;\r\n}\r\n\r\nPropertyRenderer.prototype.getFeaturesForFacet = function(facet){\r\n\treturn this.facets[facet].features.concat(this.facets[facet].controls);\r\n}\r\n\r\nPropertyRenderer.prototype.showFeature = function(which){\r\n\tif(this.features.indexOf(which) == -1 && this.controls.indexOf(which) == -1) {\r\n\t\treturn false;\r\n\t}\r\n\tvar cardcontrols = [\"delete\", \"clone\", \"add\"];\r\n\tif(cardcontrols.indexOf(which) != -1){\r\n\t\tif(!this.cardControlAllows(which)) return false;\r\n\t}\r\n\tvar updcontrols = [\"update\", \"reset\"];\r\n\tif(this.hideDisabledControls() && updcontrols.indexOf(which) != -1 ){\r\n\t\tif(!this.isUpdated()){\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\tif(which == 'hide' && this.view == \"hidden\") return false;\r\n\tif(which == 'show' && this.view != \"hidden\") return false;\r\n\tvar fets = this.getFeaturesForFacet(this.facet);\r\n\treturn (fets.indexOf(which) != -1);\r\n}\r\n\r\nfunction ObjectRenderer(obj, parent, options){\r\n\tthis.objframe = obj;\r\n\tthis.parent = parent;\r\n\tthis.properties = {};\r\n\tthis.originalProperties = false;\r\n\tthis.newProperties = [];\r\n\tthis.renderer_type = \"object\";\r\n\tthis.options = this.setOptions(options);\r\n}\r\n\r\n//options has to include mode, viewer, facet, controls, features, hide_disabled_controls\r\n\r\nObjectRenderer.prototype.setOptions = function(options){\r\n\treturn TerminusDashboard.RenderingMap.decorateRenderer(options, this);\r\n}\r\n\r\nObjectRenderer.prototype.getOptionsForProperty = function(prop){\r\n\treturn this.options;\r\n}\r\n\r\nObjectRenderer.prototype.render = function(viewer){\r\n\tthis.buildPropertyRenderers();\r\n\tthis.viewer = (viewer ? viewer: this.getViewerForObject());\r\n\tfor(var prop in this.properties){\r\n\t\tvar renderedprop = this.properties[prop].render();\r\n\t\tif(renderedprop && this.showFeature(\"body\")) this.viewer.addRenderedProperty(prop, renderedprop);\r\n\t}\r\n\treturn this.viewer.render(this.view);\r\n}\r\n\r\nObjectRenderer.prototype.buildPropertyRenderers = function(){\r\n\tvar props = this.getPropertiesToRender();\r\n\tif(this.originalProperties === false) this.originalProperties = props;\r\n\tvar renders = {};\r\n\tfor(var j = 0; j<props.length; j++){\r\n\t\tif(typeof this.properties[props[j]] == \"undefined\"){\r\n\t\t\trenders[props[j]] = new PropertyRenderer(props[j], this, this.getOptionsForProperty(props[j]));\r\n\t\t}\r\n\t\telse {\r\n\t\t\trenders[props[j]] = this.properties[props[j]];\r\n\t\t}\r\n\t\tif(this.newProperties.indexOf(props[j]) != -1) {\r\n\t\t\trenders[props[j]].setNew();\r\n\t\t\trenders[props[j]].mode = \"edit\";\r\n\t\t}\r\n\t}\r\n\tthis.properties = renders;\r\n}\r\n\r\nObjectRenderer.prototype.subject = function(){\r\n\tif(this.objframe) return this.objframe.subjid;\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.subjectClass = function(){\r\n\tif(this.objframe) return this.objframe.cls;\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.getAvailableViewers = function(){\r\n\t//if(this.mode == \"view\"){\r\n\t//\treturn RenderingMap.getAvailableObjectViewers(this);\r\n\t//}\r\n\t//return RenderingMap.getAvailableObjectEditors(this);\r\n\treturn [\"html\", \"json\"];\r\n}\r\n\r\nObjectRenderer.prototype.depth = function(){\r\n\tif(this.parent) return (this.parent.depth() + 1);\r\n\treturn 0;\r\n}\r\n\r\n\r\nObjectRenderer.prototype.property = function(){\r\n\tif(this.parent) return this.parent.property();\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.parentObject = function(){\r\n\tif(this.parent && this.parent.parent && this.parent.parent.objframe){\r\n\t\treturn this.parent.parent.objframe;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.root = function(){\r\n\tif(this.parent) return false;\r\n\treturn true;\r\n}\r\n\r\nObjectRenderer.prototype.load = function(link){\r\n\tvar self = this;\r\n\tif(this.controller){\r\n\t\tthis.controller.ui.showDocument(link);\r\n\t}\r\n\telse if(this.parent) {\r\n\t\tthis.parent.load(link);\r\n\t}\r\n}\r\n\r\nObjectRenderer.prototype.copy = function(nkid){\r\n\tnkid = (nkid ? nkid : this.objframe);\r\n\tvar other = new ObjectRenderer(nkid, this.parent, this.options);\r\n\treturn other;\r\n}\r\n\r\nObjectRenderer.prototype.clone = function(){\r\n\tif(this.root()){\r\n\t\tthis.objframe = this.objframe.clone(\"_:\");\r\n\t\tthis.objframe.newDoc = true;\r\n\t\tthis.setMode(\"edit\");\r\n\t}\r\n\telse {\r\n\t\tvar nkid = this.objframe.clone(TerminusClient.FrameHelper.genBNID());\r\n\t\tvar parentobj = this.parentObject();\r\n\t\tvar prop = this.property();\r\n\t\tif(parentobj && prop){\r\n\t\t\tif(typeof parentobj.children[prop] == \"undefined\"){\r\n\t\t\t\tparentobj.children[prop] = [];\r\n\t\t\t}\r\n\t\t\tparentobj.children[prop].push(nkid);\r\n\t\t\tvar newrend = this.copy(nkid);\r\n\t\t\tthis.parent.values.push(newrend);\r\n\t\t}\r\n\t\tthis.parent.redraw();\r\n\t}\r\n}\r\n\r\nObjectRenderer.prototype.cancel = function(){\r\n\tthis.reset();\r\n\tthis.setMode(\"view\");\r\n}\r\n\r\nObjectRenderer.prototype.save = function(){\r\n\tif(this.controller){\r\n\t\tif(this.isNewDocument()){\r\n\t\t\tvar demandid = this.inputID();\r\n\t\t\tif(demandid == \"_:\") demandid = \"\";\r\n            var extr = this.extract();\r\n\t\t\tthis.controller.createDocument(demandid, extr);\r\n\t\t}\r\n\t\telse {\r\n            var extr = this.extract();\r\n\t\t\tthis.controller.updateDocument(extr);\r\n\t\t}\r\n\t}\r\n\telse if(this.parent) {\r\n\t\tthis.parent.save();\r\n\t}\r\n}\r\n\r\nObjectRenderer.prototype.delete = function(){\r\n\tvar dval = this.subject();\r\n\tif(this.controller && this.root()){\r\n\t\tif(!this.isNewDocument()){\r\n\t\t\tthis.controller.deleteDocument(dval);\r\n\t\t}\r\n\t\tthis.nukeViewer();\r\n\t}\r\n\telse {\r\n\t\tif(this.parent){\r\n\t\t\tthis.parent.deletePropertyValue(dval);\r\n\t\t\tthis.parent.redraw();\r\n\t\t}\r\n\t}\r\n}\r\n\r\nObjectRenderer.prototype.reset = function(){\r\n\tthis.objframe.reset();\r\n\tvar nprops = {};\r\n\tfor(var i = 0; i<this.originalProperties.length; i++){\r\n\t\tvar prop = this.originalProperties[i];\r\n\t\tif(typeof this.properties[prop] == \"object\"){\r\n\t\t\tthis.properties[prop].reset();\r\n\t\t\tnprops[prop] = this.properties[prop];\r\n\t\t}\r\n\t}\r\n\tthis.properties = nprops;\r\n\tthis.redraw();\r\n}\r\n\r\nObjectRenderer.prototype.deleteProperty = function(prop){\r\n\tthis.objframe.removeProperty(prop);\r\n\tdelete(this.properties[prop]);\r\n\tthis.updated();\r\n}\r\n\r\nObjectRenderer.prototype.addProperty = function(prop){\r\n\tthis.objframe.addProperty(prop);\r\n\tthis.updated();\r\n\tthis.redraw();\r\n}\r\n\r\nObjectRenderer.prototype.addNewProperty = function(prop){\r\n\tthis.objframe.addProperty(prop);\r\n\tthis.updated();\r\n\tthis.newProperties.push(prop);\r\n\tthis.redraw();\r\n\tthis.goToProperty(prop);\r\n}\r\n\r\nObjectRenderer.prototype.addPropertyClass = function(prop, cls){\r\n\tthis.objframe.addProperty(prop, cls);\r\n\tthis.updated();\r\n}\r\n\r\nObjectRenderer.prototype.changeClass = function(cls){\r\n\tif(this.parent){\r\n\t\tthis.parent.addClass(cls);\r\n\t\tthis.parent.deletePropertyValue(this.subject());\r\n\t}\r\n}\r\n\r\nObjectRenderer.prototype.getClassMeta = function(cls){\r\n\tvar ctl = this.getController();\r\n\tif(ctl && ctl.classmeta && ctl.classmeta[cls]){\r\n\t\treturn ctl.classmeta[cls];\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.getController = function(){\r\n\tif(this.controller){\r\n\t\treturn this.controller;\r\n\t}\r\n\tif(this.parent && this.parent.parent){\r\n\t\treturn this.parent.parent.getController();\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.getClient = function(){\r\n\tif(this.controller){\r\n\t\treturn this.controller.getClient();\r\n\t}\r\n\telse {\r\n\t\tif(this.parent && this.parent.parent){\r\n\t\t\treturn(this.parent.parent.getClient())\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.inputID = function(){\r\n\tif(this.idDOM){\r\n\t\treturn this.idDOM.value;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.isNew = function(){\r\n\tif(this.new_object){\r\n\t\treturn true;\r\n\t}\r\n\tif(this.isPartOfNewDocument()){\r\n\t\treturn true;\r\n\t}\r\n\tif(this.parent) return this.parent.isNew();\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.setNew = function(){\r\n\tthis.new_object = true;\r\n}\r\n\r\nObjectRenderer.prototype.isUpdated = function(){\r\n\tvar i = 0;\r\n\tfor(var prop in this.properties){\r\n\t\tif(this.originalProperties[i] != prop) return true;\r\n\t\tif(this.properties[prop].isUpdated()) return true;\r\n\t\ti++;\r\n\t}\r\n\tif(i != this.originalProperties.length) return true;\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.childUpdated = function(){\r\n\tthis.viewer.redrawHeader();\r\n\tif(this.parent) this.parent.childUpdated();\r\n}\r\n\r\nObjectRenderer.prototype.updated = ObjectRenderer.prototype.childUpdated;\r\n\r\nObjectRenderer.prototype.isNewDocument = function(){\r\n\tif(this.root() && this.objframe.isnew()) return true;\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.isPartOfNewDocument = function(){\r\n\tif(this.isNewDocument()) return true;\r\n\tif(this.parent && this.parent.parent){\r\n\t\treturn this.parent.parent.isPartOfNewDocument();\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.setFacet = function(facet, nocascade){\r\n\tthis.facet = facet;\r\n\tif(!nocascade){\r\n\t\tfor(var prop in this.properties){\r\n\t\t\tthis.properties[prop].parentFacetChange(facet);\r\n\t\t}\r\n\t}\r\n\tif(this.parent){\r\n\t\tthis.parent.redraw();\r\n\t}\r\n\telse {\r\n\t\tthis.redraw();\r\n\t}\r\n}\r\n\r\nObjectRenderer.prototype.getDefaultFacets = function(){\r\n\tvar defs = {\r\n\t\tpage: {\r\n\t\t\tlabel: \"Full Page\", value: \"page\",\r\n\t\t\tfeatures: [\"facet\", \"label\", \"comment\", \"id\", \"control\", \"type\", \"body\", \"status\", \"facet\", \"view\", \"viewer\"],\r\n\t\t\tcontrols: [\"delete\", \"clone\", \"add\", \"reset\", \"cancel\", \"update\", \"mode\", \"show\", \"hide\"]\r\n\t\t},\r\n\t\tline: {\r\n\t\t\tlabel: \"Single Line\", value: \"line\",\r\n\t\t\tfeatures: [\"facet\", \"label\", \"comment\", \"id\", \"type\", \"body\", \"status\", \"facet\"],\r\n\t\t\tcontrols: []\r\n\t\t},\r\n\t\tsummary: {\r\n\t\t\tlabel: \"Summary\", value: \"summary\",\r\n\t\t\tfeatures: [\"facet\", \"satus\", \"label\", \"type\", \"summary\", \"status\", \"facet\"],\r\n\t\t\tcontrols: []\r\n\t\t},\r\n\t\tlabel: {\r\n\t\t\tlabel: \"Label\", value: \"label\",\r\n\t\t\tfeatures: [\"facet\", \"status\", \"label\"],\r\n\t\t\tcontrols: []\r\n\t\t}\r\n\t}\r\n\treturn defs;\r\n}\r\n\r\nObjectRenderer.prototype.getAvailableFacets = function(){\r\n\treturn Object.keys(this.facets);\r\n}\r\n\r\nObjectRenderer.prototype.currentFacet = function(){\r\n\treturn this.facet;\r\n}\r\n\r\nObjectRenderer.prototype.getDefaultFacet = function(){\r\n\tif(!this.parent) return \"page\";\r\n\tvar pfacet = this.parent.currentFacet();\r\n\tif(pfacet == \"page\"){\r\n\t\treturn \"page\";\r\n\t}\r\n\tif(pfacet == \"multiline\") return \"line\";\r\n\tif(pfacet == \"line\") return \"summary\";\r\n\treturn \"label\";\r\n}\r\n\r\nObjectRenderer.prototype.parentFacetChange = function(pfacet){\r\n\tif(pfacet == \"page\") this.setFacet(\"page\");\r\n\tif(pfacet == \"multiline\") this.setFacet(\"summary\");\r\n\tif(pfacet == \"line\") this.setFacet(\"summary\");\r\n\tif(pfacet == \"summary\") this.setFacet(\"summary\");\r\n}\r\n\r\nObjectRenderer.prototype.getContentOrientation = function(){\r\n\tif(this.currentFacet() == \"page\"){\r\n\t\treturn \"page\";\r\n\t}\r\n\tif(this.currentFacet() == \"line\"){\r\n\t\treturn \"line\";\r\n\t}\r\n\treturn \"label\";\r\n}\r\n\r\nObjectRenderer.prototype.getLabel = function(){\r\n\tfor(var prop in this.properties){\r\n\t\tif(TerminusClient.FrameHelper.getShorthand(prop) == \"rdfs:label\" || prop == \"rdfs:label\"){\r\n\t\t\tvar prend = this.properties[prop];\r\n\t\t\tvar vrend = prend.values[0];\r\n\t\t\tif(vrend){\r\n\t\t\t\tvar sum = vrend.getSummary();\r\n\t\t\t\tif(sum.long != \"empty\") return sum.long;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tvar s = this.subject();\r\n\tif(s && s.substring(0, 2) == \"_:\"){\r\n\t\tvar ty = this.subjectClass();\r\n\t\tvar sh = TerminusClient.FrameHelper.getShorthand(ty);\r\n\t\tif(!sh) sh = ty;\r\n\t\tvar b = sh.split(\":\");\r\n\t\tif(b.length > 1){\r\n\t\t\treturn \"New \" + b[1];\r\n\t\t}\r\n\t\treturn \"New Object\";\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.getSummary = function(){\r\n\tvar ret = { status: \"ok\" };\r\n\tif(this.isUpdated()) ret.status = \"updated\";\r\n\tif(this.isNew()) ret.status = \"new\";\r\n\tret.propcount = 0;\r\n\tfor(var prop in this.properties){\r\n\t\tret.propcount++;\r\n\t}\r\n\tret.long = ret.propcount + \" properties\";\r\n\treturn ret;\r\n}\r\n\r\nObjectRenderer.prototype.getObjectHeaderViewer = function(){\r\n\treturn this.header_viewer;\r\n}\r\n\r\nObjectRenderer.prototype.getViewerForObject = function(format){\r\n\tif(format == \"json\"){\r\n\t\treturn new ObjectViewer.JSONObjectViewer(this);\r\n\t}\r\n\treturn new ObjectViewer.HTMLObjectViewer(this);\r\n}\r\n\r\nObjectRenderer.prototype.getFeaturesForFacet = function(facet){\r\n\treturn this.facets[facet].features.concat(this.facets[facet].controls);\r\n}\r\n\r\nObjectRenderer.prototype.hideDisabledControls = function(){\r\n\treturn this.hide_disabled_controls;\r\n}\r\n\r\nObjectRenderer.prototype.showFeature = function(which){\r\n\tif(this.features.indexOf(which) == -1 && this.controls.indexOf(which) == -1) {\r\n\t\treturn false;\r\n\t}\r\n\tvar cardcontrols = [\"delete\", \"clone\", \"add\"];\r\n\tif(cardcontrols.indexOf(which) != -1){\r\n\t\tif(!this.cardControlAllows(which)) return false;\r\n\t}\r\n\tvar updcontrols = [\"update\", \"reset\"];\r\n\tif(this.hideDisabledControls() && updcontrols.indexOf(which) != -1 ){\r\n\t\tif(!this.isUpdated()){\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\tif(this.isNewDocument() && which == \"clone\") return false;\r\n\tif(which == 'hide' && this.view == \"hidden\") return false;\r\n\tif(which == 'show' && this.view != \"hidden\") return false;\r\n\tvar fets = this.getFeaturesForFacet(this.facet);\r\n\tif (fets.indexOf(which) != -1){\r\n\t\treturn true;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.cardControlAllows = function(action){\r\n\tif(!this.parent) return true;\r\n\tif(this.parent.cframe.hasRestriction()){\r\n\t\tvar rest = this.parent.cframe.restriction;\r\n\t\tvar currentnum = this.parent.values.length;\r\n\t\tif(action == \"add\" || action == \"clone\"){\r\n\t\t\tif(rest.max && currentnum >= rest.max){\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(action == \"delete\" && (rest.min && currentnum <= rest.min)){\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nObjectRenderer.prototype.goToProperty = function(prop){\r\n\tthis.viewer.goTo(this.subject(), prop);\r\n}\r\n\r\nObjectRenderer.prototype.setMode = function(mode){\r\n\tthis.mode = mode;\r\n\tfor(var prop in this.properties){\r\n\t\tthis.properties[prop].setMode(mode);\r\n\t}\r\n\tthis.viewer.redraw();\r\n}\r\n\r\nObjectRenderer.prototype.currentViewer = function(){return this.viewerType;}\r\n\r\n\r\nObjectRenderer.prototype.setViewer = function(viewer){\r\n\tvar nviewer = this.getViewerForObject(viewer);\r\n\tif(nviewer){\r\n\t\tthis.viewerType = viewer;\r\n\t\tthis.viewer = nviewer;\r\n\t\tthis.viewer.redraw();\r\n\t}\r\n}\r\n\r\n\r\nObjectRenderer.prototype.setView = function(view){\r\n\tvar views = {\r\n\t\t\"full\": {\r\n\r\n\t\t},\r\n\t\t\"hidden\": {\r\n\r\n\t\t}\r\n\t};\r\n\tthis.view = view;\r\n\tthis.viewer.redraw();\r\n}\r\n\r\n\r\nObjectRenderer.prototype.hide = function(){\r\n\tthis.setView(\"hidden\");\r\n}\r\n\r\nObjectRenderer.prototype.show = function(){\r\n\tthis.setView(\"full\");\r\n}\r\n\r\nObjectRenderer.prototype.nukeViewer = function(){\r\n\tthis.viewer.remove();\r\n}\r\n\r\nObjectRenderer.prototype.getViewableProperties = function(){\r\n\treturn this.objframe.getFilledPropertyList();\r\n}\r\n\r\nObjectRenderer.prototype.getAddableProperties = function(){\r\n\tvar props = this.objframe.getMissingPropertyList();\r\n\treturn props;\r\n}\r\n\r\nObjectRenderer.prototype.getPropertiesToRender = function(options){\r\n\tvar sort = this.standardSort;\r\n\tvar filter = function(){return true};\r\n\tif(options && options.map && options.map.patterns){\r\n\t\t/*for(var i = 0; i<options.map.patterns.length; i++){\r\n\t\t\tif(this.objframe.matchesPattern({property: this.property(), action: \"sort\"}, options.map.patterns[i])){\r\n\t\t\t\tsort = options.map.patterns[i].sort;\r\n\t\t\t}\r\n\t\t\tif(this.objframe.matchesPattern({property: this.property(), action: \"filter\"}, options.map.patterns[i])){\r\n\t\t\t\tfilter = options.map.patterns[i].filter;\r\n\t\t\t}\r\n\t\t}*/\r\n\t}\r\n\treturn sort(this.objframe, filter);\r\n}\r\n\r\nObjectRenderer.prototype.standardSort = function(objframe, filter){\r\n\tvar sorted = [];\r\n\tvar rdft = TerminusClient.FrameHelper.getStdURL(\"rdfs\", \"label\");\r\n\tif(objframe.dataframes[rdft] && filter(objframe, rdft, objframe.dataframes[rdft])){\r\n\t\tsorted.push(rdft);\r\n\t}\r\n\tvar rdfc = TerminusClient.FrameHelper.getStdURL(\"rdfs\", \"comment\");\r\n\tif(objframe.dataframes[rdfc]){\r\n\t\tsorted.push(rdfc);\r\n\t}\r\n\tfor(var prop in objframe.dataframes){\r\n\t\tif(sorted.indexOf(prop) == -1) sorted.push(prop);\r\n\t}\r\n\tfor(var prop in objframe.children){\r\n\t\tif(sorted.indexOf(prop) == -1) sorted.push(prop);\r\n\t}\r\n\treturn sorted;\r\n}\r\n\r\n\r\nObjectRenderer.prototype.redraw = function(){\r\n\tthis.viewer.clear();\r\n\tthis.render(this.viewer);\r\n}\r\n\r\nObjectRenderer.prototype.extractLDO = function(extracts){\r\n\textracts[\"rdf:type\"] = this.objframe.cls;\r\n\tvar full = {};\r\n\tfull[this.subject()] = extracts;\r\n\treturn full;\r\n}\r\n\r\nObjectRenderer.prototype.extractJSONLD = function(extracts){\r\n\textracts[\"@type\"] = this.objframe.cls;\r\n\tif(this.subject() != \"_:\")\textracts[\"@id\"] = this.subject();\r\n\tif(this.objframe.jsonld_context) extracts['@context'] = this.objframe.jsonld_context;\r\n\treturn extracts;\r\n}\r\n\r\nObjectRenderer.prototype.extract = function(){\r\n\tvar extracts = {};\r\n\tfor(var i in this.properties){\r\n\t\tvar extracted = this.properties[i].extract();\r\n\t\tif(!TerminusClient.FrameHelper.empty(extracted)){\r\n\t\t\textracts[i] = extracted;\r\n\t\t}\r\n\t}\r\n\tif(TerminusClient.FrameHelper.empty(extracts) && this.parent){\r\n\t\treturn false;\r\n\t}\r\n\telse {\r\n\t\tvar ext = this.extractJSONLD(extracts);\r\n\t\treturn ext;\r\n\t\t//return this.extractLDO(extracts);\r\n\t}\r\n}\r\n\r\nmodule.exports={ObjectRenderer,PropertyRenderer}\r\n","const HTMLPropertyViewer = require('../html/document/PropertyViewer');\r\nconst RenderingMap = require('./RenderingMap');\r\nconst HTMLDataViewer = require('../html/document/DataViewer');\r\n\r\nfunction ValueRenderer(dataframe, index, parent, options){\r\n\tthis.frame = dataframe;\r\n\tthis.index = index;\r\n\tthis.parent = parent;\r\n\tthis.originalValue = this.value();\r\n\tthis.renderer_type = \"value\";\r\n\tthis.options = this.setOptions(options);\r\n}\r\n\r\nValueRenderer.prototype.depth = () => this.parent ? this.parent.depth() : false;\r\nValueRenderer.prototype.property = () => this.parent ? this.parent.property() : false;\r\nValueRenderer.prototype.subject = () => this.parent ? this.parent.subject() : false;\r\nValueRenderer.prototype.subjectClass = () => this.parent ? this.parent.subjectClass() : false;\r\nValueRenderer.prototype.type = () => this.frame ? this.frame.range : false;\r\nValueRenderer.prototype.range = () => this.frame ? this.frame.range : false;\r\nValueRenderer.prototype.value = () => this.frame ? this.frame.get() : false;\r\nValueRenderer.prototype.isDocument = () => this.frame ? this.frame.isDocument() : false;\r\nValueRenderer.prototype.currentViewer = () => this.viewerType;\r\n\r\nValueRenderer.prototype.copy = function(nf){\r\n\tvar nvr = new ValueRenderer(nf, false, this.parent, this.options);\r\n\tnvr.mode = this.mode;\r\n\tnvr.view = this.view;\r\n\treturn nvr;\r\n}\r\n\r\nValueRenderer.prototype.setFacet = function(facet){\r\n\tthis.facet = facet;\r\n\tthis.parent.redraw();\r\n}\r\n\r\nValueRenderer.prototype.parentFacetChange = function(pfacet){\r\n\tif(pfacet == \"page\") this.setFacet(\"page\");\r\n\tif(pfacet == \"multiline\") this.setFacet(\"line\");\r\n\tif(pfacet == \"line\") this.setFacet(\"inline\");\r\n\tif(pfacet == \"summary\") this.setFacet(\"icon\");\r\n}\r\n\r\nValueRenderer.prototype.getDefaultFacet = function(){\r\n\tif(this.parent.currentFacet() == \"page\" || this.parent.currentFacet() == \"multiline\"){\r\n\t\treturn \"line\";\r\n\t}\r\n\treturn \"inline\";\r\n}\r\n\r\nValueRenderer.prototype.getAvailableFacets = function(){\r\n\treturn Object.values(this.facets);\r\n}\r\n\r\nValueRenderer.prototype.getDefaultFacets = function(){\r\n\tvar defs = {\r\n\t\tpage: {\r\n\t\t\tlabel: \"Full Page\", value: \"page\",\r\n\t\t\tfeatures: [\"facet\", \"type\", \"cardinality\", \"body\", \"status\", \"facet\", \"viewer\", \"control\"],\r\n\t\t\tcontrols: [\"delete\", \"clone\", \"add\", \"reset\", \"cancel\", \"update\", \"mode\", \"show\", \"hide\"]\r\n\t\t},\r\n\t\tline: {\r\n\t\t\tlabel: \"Single Line\", value: \"line\",\r\n\t\t\tfeatures: [\"facet\", \"type\", \"cardinality\", \"body\", \"status\", \"facet\", \"viewer\", \"control\"],\r\n\t\t\tcontrols: [\"delete\", \"clone\", \"add\", \"reset\", \"cancel\", \"update\", \"mode\", \"show\", \"hide\"]\r\n\t\t},\r\n\t\tinline: {\r\n\t\t\tlabel: \"Inline\", value: \"inline\",\r\n\t\t\tfeatures: [\"facet\", \"type\", \"cardinality\", \"body\", \"status\", \"facet\", \"viewer\", \"control\"],\r\n\t\t\tcontrols: [\"delete\", \"clone\", \"add\", \"reset\", \"cancel\", \"update\", \"mode\", \"show\", \"hide\"]\r\n\t\t},\r\n\t\tlabel: {\r\n\t\t\tlabel: \"Label\", value: \"label\",\r\n\t\t\tfeatures: [\"facet\", \"status\", \"body\"],\r\n\t\t\tcontrols: []\r\n\t\t},\r\n\t\ticon: {\r\n\t\t\tlabel: \"Snippet\", value: \"icon\",\r\n\t\t\tfeatures: [\"facet\", \"summary\"],\r\n\t\t\tcontrols: []\r\n\t\t}\r\n\t}\r\n\treturn defs;\r\n}\r\n\r\nValueRenderer.prototype.currentFacet = function(){\r\n\treturn this.facet;\r\n}\r\n\r\nValueRenderer.prototype.setOptions = function(options){\r\n\treturn TerminusDashboard.RenderingMap.decorateRenderer(options, this);\r\n}\r\n\r\nValueRenderer.prototype.hideDisabledControls = function(){\r\n\treturn this.hide_disabled_controls;\r\n}\r\n\r\nValueRenderer.prototype.setMode = function(mode){\r\n\tthis.mode = mode;\r\n\tthis.options.mode = mode;\r\n\tthis.viewerType = false;\r\n\tthis.redraw();\r\n}\r\n\r\nValueRenderer.prototype.setView = function(view){\r\n\tthis.view = view;\r\n\tthis.options.view = view;\r\n\tthis.redraw();\r\n}\r\n\r\nValueRenderer.prototype.getAPIURL = function(a, b){\r\n\tif(this.parent && this.parent.parent){\r\n\t\tif(client = this.parent.parent.getClient()){\r\n\t\t\tvar apiurl = client.dbURL() + a + \"/\" + b;\r\n\t\t\treturn apiurl;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nValueRenderer.prototype.getClient = function(){\r\n\tif(this.parent && this.parent.parent){\r\n\t\treturn this.parent.parent.getClient();\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nValueRenderer.prototype.getController = function(){\r\n\tif(this.parent && this.parent.parent){\r\n\t\treturn this.parent.parent.getController();\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nValueRenderer.prototype.DBURL = function(){\r\n\tif(this.parent && this.parent.parent){\r\n\t\tif(client = this.parent.parent.getClient()){\r\n\t\t\treturn client.dbURL();\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nValueRenderer.prototype.getEntityReference = function(url, cls, entities, opts){\r\n\tif(this.parent && this.parent.parent){\r\n\t\tif(client = this.parent.parent.getClient()){\r\n\t\t\treturn client.getEntityReference(url, cls, entities, opts);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nValueRenderer.prototype.badData = function(bd){\r\n\talert(\"bad data \" + bd);\r\n}\r\n\r\nValueRenderer.prototype.setNew = function(){\r\n\tthis.new_value = true;\r\n}\r\n\r\nValueRenderer.prototype.isNew = function(){\r\n\tif(this.new_value){\r\n\t\treturn true;\r\n\t}\r\n\treturn this.parent.isNew();\r\n}\r\n\r\n\r\nValueRenderer.prototype.isUpdated = function(){\r\n\tif(this.frame.get() != this.originalValue){\r\n\t\treturn true;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nValueRenderer.prototype.getSummary = function(){\r\n\tvar ret = { status: \"ok\" };\r\n\tif(this.isNew()) ret.status = \"new\";\r\n\telse if(this.isUpdated()) ret.status = \"updated\";\r\n\tvar val = this.frame.get();\r\n\tif(val){\r\n\t\tif(val.length && val.length > this.text_summary_length){\r\n\t\t\tret.long = val.substring(0, this.text_summary_length) + \"...\" + \" (\" + val.length + \" characters)\";\r\n\t\t}\r\n\t\telse {\r\n\t\t\tret.long = val;\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tret.long = \"empty\";\r\n\t}\r\n\treturn ret;\r\n}\r\n\r\nValueRenderer.prototype.cardControlAllows = function(action){\r\n\tif(this.parent.cframe.hasRestriction()){\r\n\t\tvar rest = this.parent.cframe.restriction;\r\n\t\tvar currentnum = this.parent.values.length;\r\n\t\tif(action == \"add\" || action == \"clone\"){\r\n\t\t\tif(rest.max && currentnum >= rest.max){\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(action == \"delete\" && (rest.min && currentnum <= rest.min)){\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nValueRenderer.prototype.set = function(v){\r\n\tthis.frame.set(v);\r\n\tthis.viewer.redrawHeader();\r\n\tthis.parent.childUpdated();\r\n}\r\n\r\nValueRenderer.prototype.delete = function(){\r\n\tthis.parent.deletePropertyValue(this.value(), this.index);\r\n\tthis.parent.parent.redraw();\r\n}\r\n\r\nValueRenderer.prototype.load = function(link){\r\n\tthis.parent.load(link);\r\n}\r\n\r\nValueRenderer.prototype.hide = function(){\r\n\tthis.setView(\"hidden\");\r\n}\r\n\r\nValueRenderer.prototype.show = function(){\r\n\tthis.setView(\"full\");\r\n}\r\n\r\nValueRenderer.prototype.cancel = function(){\r\n\tthis.reset();\r\n\tthis.setMode(\"view\");\r\n}\r\n\r\nValueRenderer.prototype.save = function(){\r\n\tif(this.parent) {\r\n\t\tthis.parent.save();\r\n\t}\r\n}\r\n\r\nValueRenderer.prototype.reset = function(){\r\n\tthis.set(this.originalValue);\r\n\tthis.redraw();\r\n}\r\n\r\nValueRenderer.prototype.clone = function(){\r\n\tvar newb = this.parent.addPropertyValue(this.value());\r\n\tvar nrend = this.copy(newb);\r\n\tnrend.setNew();\r\n\tnrend.mode = \"edit\";\r\n\tnrend.index = this.parent.values.length;\r\n\tthis.parent.values.push(nrend);\r\n\tthis.parent.childUpdated();\r\n\tthis.parent.redraw();\r\n\tthis.parent.goToValue(this.parent.values.length-1);\r\n}\r\n\r\nValueRenderer.prototype.getViewerForValue = function(){\r\n\treturn new HTMLDataViewer.HTMLDataViewer(this);\r\n}\r\n\r\nValueRenderer.prototype.getFeaturesForFacet = function(facet){\r\n\treturn this.facets[facet].features.concat(this.facets[facet].controls);\r\n}\r\n\r\nValueRenderer.prototype.showFeature = function(which){\r\n\tif(this.features.indexOf(which) == -1 && this.controls.indexOf(which) == -1) {\r\n\t\treturn false;\r\n\t}\r\n\tvar cardcontrols = [\"delete\", \"clone\", \"add\"];\r\n\tif(cardcontrols.indexOf(which) != -1){\r\n\t\tif(!this.cardControlAllows(which)) return false;\r\n\t}\r\n\tvar updcontrols = [\"update\", \"reset\"];\r\n\tif(this.hideDisabledControls() && updcontrols.indexOf(which) != -1 ){\r\n\t\tif(!this.isUpdated()){\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\tif(which == 'hide' && this.view == \"hidden\") return false;\r\n\tif(which == 'show' && this.view != \"hidden\") return false;\r\n\tvar fets = this.getFeaturesForFacet(this.facet);\r\n\treturn (fets.indexOf(which) != -1);\r\n}\r\n\r\n\r\nValueRenderer.prototype.render = function(viewer){\r\n\tthis.viewer = (viewer ? viewer : this.getViewerForValue());\r\n\treturn this.viewer.render();\r\n}\r\n\r\nValueRenderer.prototype.extract = function(){\r\n\tvar val = this.value();\r\n\tif(val !== \"\" && val !== false){\r\n\t\tif(this.frame.isDatatypeProperty()){\r\n\t\t\tvar objlit = { \"@value\": this.value()}\r\n\t\t\t//var objlit = { data: this.value()}\r\n\t\t\tif(this.frame.isString()) objlit[\"@language\"] = this.frame.lang();\r\n\t\t\telse objlit[\"@type\"] = this.type();\r\n\t\t\treturn objlit;\r\n\t\t}\r\n\t\telse if(this.frame.isChoice() || this.frame.isDocument()){\r\n\t\t\treturn {\"@id\": val}\r\n\t\t}\r\n\t}\r\n\telse return val;\r\n}\r\n\r\nValueRenderer.prototype.getValueHeaderViewer = function(){\r\n\treturn new HTMLDataViewer.HTMLDataHeaderViewer();\r\n}\r\n\r\nValueRenderer.prototype.getDataValueViewer = function(){\r\n\tif(!this.viewerType) {\r\n\t\tthis.viewerType = this.getViewerForDataValue();\r\n\t}\r\n\treturn TerminusDashboard.RenderingMap.getViewer(this.viewerType, this.viewerOptions);\r\n}\r\n\r\nValueRenderer.prototype.getAvailableViewers = function(){\r\n\tvar dt = this.frame.getTypeShorthand();\r\n\tvar ft = this.frame.ftype();\r\n\tif(this.mode == \"view\"){\r\n\t\treturn TerminusDashboard.RenderingMap.getAvailableDataViewers(dt, ft);\r\n\t}\r\n\treturn TerminusDashboard.RenderingMap.getAvailableDataEditors(dt, ft);\r\n}\r\n\r\nValueRenderer.prototype.setViewer = function(viewer){\r\n\tthis.viewerType = viewer;\r\n\tthis.redraw();\r\n}\r\n\r\nValueRenderer.prototype.getViewerForDataValue = function(){\r\n\tvar dt = this.frame.getTypeShorthand();\r\n\tvar ft = this.frame.ftype();\r\n\tif(this.mode == \"edit\"){\r\n\t\treturn TerminusDashboard.RenderingMap.getEditorForDataFrame(dt, ft);\r\n\t}\r\n\treturn TerminusDashboard.RenderingMap.getViewerForDataFrame(dt, ft);\r\n}\r\n\r\nValueRenderer.prototype.redraw = function(){\r\n\tthis.viewer.clear();\r\n\tthis.render(this.viewer);\r\n}\r\n\r\n\r\n\r\n\r\n\r\nmodule.exports=ValueRenderer\r\n","const TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction WOQLQueryView(client){\r\n\tthis.client = client;\r\n}\r\n\r\nWOQLQueryView.prototype.options = function(options){\r\n\tthis.options = options;\r\n\treturn this;\r\n}\r\n\r\nWOQLQueryView.prototype.setQuery = function(query){\r\n\tthis.query = query;\r\n\treturn this;\r\n}\r\n\r\nWOQLQueryView.prototype.setRenderer = function(rend){\r\n\tthis.renderer = rend;\r\n\treturn this;\r\n}\r\n\r\nWOQLQueryView.prototype.render = function(){\r\n\tif(this.renderer){\r\n\t\tif(this.query){\r\n\t\t\tthis.renderer.set(this.query);\r\n\t\t}\r\n\t\treturn this.renderer.render(this);\r\n\t}\r\n}\r\n\r\n//parses a string encoding a woql in either json or js notation\r\nWOQLQueryView.prototype.parseText = function(text, format){\r\n\ttry {\r\n\t\tvar WOQL = TerminusClient.WOQL;\r\n\t\tif(format == \"json\"){\r\n\t\t\tvar qval = JSON.parse(text);\r\n\t\t\treturn WOQL.json(qval);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tvar nw = eval(\"WOQL.\" + text);\r\n\t\t\treturn nw;\r\n\t\t}\r\n\t}\r\n\tcatch(e){\r\n\t\tthis.error(\"Failed to parse Query \" + e.toString());\r\n\t}\r\n}\r\n\r\nWOQLQueryView.prototype.submitQuery = function(qObj){\r\n\r\n}\r\n\r\nWOQLQueryView.prototype.error = function(msg){\r\n\tconsole.log(msg);\r\n}\r\n\r\nWOQLQueryView.prototype.serialise = function(query, format){\r\n\tif(format == \"json\"){\r\n\t\treturn JSON.stringify(query.json(), 0, 2);\r\n\t}\r\n\telse {\r\n\t\treturn query.prettyPrint(4);\r\n\t}\r\n}\r\n\r\nmodule.exports = WOQLQueryView;\r\n","const TerminusCodeSnippet = require('./query/TerminusCodeSnippet');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\nconst Datatypes = require(\"./Datatypes\");\r\nconst SimpleTable = require(\"./table/SimpleTable\");\r\nconst SimpleGraph = require(\"./graph/SimpleGraph\");\r\nconst SimpleStream = require(\"./stream/SimpleStream\");\r\nconst SimpleChooser = require(\"./chooser/SimpleChooser\");\r\n\r\n/**\r\n * Result Pane is defined by a WOQL configuration object\r\n * Visually it consists of a single rule editor (showing the current state of the configuration object) which may be collapsed behind a configuration link\r\n * and a single result view which shows the result of the rule when applied to the current results.\r\n *\r\n */\r\nfunction ResultPane(client, querypane, config){\r\n    this.client = client;\r\n    this.qp = querypane;\r\n    this.config = config;\r\n\tthis.container = document.createElement('span');\r\n    this.container.setAttribute('class', 'terminus-result-pane');\r\n}\r\n\r\nResultPane.prototype.options = function(opts){\r\n\tthis.showConfig = (opts && typeof opts.showConfig != \"undefined\" ? opts.showConfig : false);\r\n    this.editConfig = (opts && typeof opts.editConfig != \"undefined\" ? opts.editConfig : false);\r\n    this.changeViewType = (opts && typeof opts.changeViewType != \"undefined\" ? opts.changeViewType : true);\r\n    this.intro = (opts && typeof opts.intro != \"undefined\" ? opts.intro : false);\r\n    this.renderers =  (opts && opts.renderers ? opts.renderers : {\r\n\t\ttable: new SimpleTable(),\r\n\t\tgraph: new SimpleGraph(),\r\n\t\tstream: new SimpleStream(),\r\n\t\tchooser: new SimpleChooser()\r\n    });\r\n    if(this.config){\r\n        this.viewers = [this.config];\r\n    }\r\n    this.viewers =  (opts && typeof opts.viewers != \"undefined\" ? this.viewers.concat(opts.viewers) : this.viewers);\r\n    this.currentViewer = 0;\r\n    return this;\r\n}\r\n\r\nResultPane.prototype.getAsDOM = function(){\r\n    if(this.intro){\r\n        var di = (typeof this.intro == \"string\" ? document.createTextNode(this.intro) : this.intro);\r\n\t\tthis.container.appendChild(di);\r\n\t}\r\n    var configspan = document.createElement(\"span\");\r\n    configspan.setAttribute(\"class\", \"pane-config-icons\");\r\n    this.container.appendChild(configspan);\r\n\tthis.resultDOM = document.createElement('span');\r\n\tthis.resultDOM.setAttribute('class', 'terminus-result-view');\r\n\tif(this.result){\r\n\t\tthis.resultDOM.appendChild(this.getResultDOM());\r\n\t}\r\n\tthis.container.appendChild(this.resultDOM);\r\n\tif(this.showConfig){\r\n        this.showingQuery = (this.showConfig != \"icon\");\r\n\t\tvar mode = (this.editConfig ? \"edit\" : \"view\");\r\n\t\tthis.input = this.createInput(mode);\r\n\t\tvar ipdom = this.input.getAsDOM();\r\n        var ispan = document.createElement(\"span\");\r\n        ispan.addEventListener('mouseover', function(){\r\n            this.style.cursor = \"pointer\";\r\n\t\t});\r\n\t\tispan.setAttribute(\"class\", \"result-pane-config\");\r\n\t\tvar ic = document.createElement(\"i\");\r\n\t\tispan.appendChild(ic);\r\n\t\tconfigspan.appendChild(ispan);\r\n\t\tvar self = this;\r\n\t\tfunction showQueryConfig(){\r\n\t\t\tconfigspan.title=\"Click to Hide View Configuration\";\r\n\t\t\tic.setAttribute(\"class\", \"fas fa fa-times-circle\");\r\n            if(configspan.nextSibling){\r\n                self.container.insertBefore(ipdom, configspan.nextSibling);\r\n                if(self.input.snippet.value)\r\n\t\t\t\t\tself.input.stylizeSnippet();\r\n            }\r\n            else{\r\n                self.container.appendChild(ipdom);\r\n                if(self.input.snippet.value)\r\n\t\t\t\t\tself.input.stylizeSnippet();\r\n            }\r\n\t\t}\r\n\t\tfunction hideQueryConfig(){\r\n\t\t\tconfigspan.title=\"Click to View Configuration\";\r\n            ic.setAttribute(\"class\", \"terminus-result-icons terminus-result-view-icon \" + self.getViewConfigIconClass());\r\n\t\t\tself.container.removeChild(ipdom);\r\n\t\t}\r\n\t\tispan.addEventListener(\"click\", () => {\r\n\t\t\tif(this.showingQuery) hideQueryConfig();\r\n\t\t\telse showQueryConfig();\r\n\t\t\tthis.showingQuery = !this.showingQuery;\r\n        });\r\n        showQueryConfig();\r\n\t\tif(this.showConfig == \"icon\") hideQueryConfig();\r\n    }\r\n    if(this.changeViewType){\r\n        cvicons = this.getViewTypeIconDOM(ipdom);\r\n        if(cvicons) configspan.prepend(cvicons);\r\n    }\r\n\treturn this.container;\r\n}\r\n\r\nResultPane.prototype.getViewConfigIconClass = function(){\r\n    if(this.changeViewType && this.viewers.length > 1){\r\n        return \"fas fa fa-vial\";\r\n    }\r\n    if(this.viewers[this.currentViewer].icon){\r\n        return this.viewers[this.currentViewer].icon;\r\n    }\r\n    var def = this.getDefaultViewerIcon(this.viewers[this.currentViewer]);\r\n    return def.icon;\r\n}\r\n\r\n\r\nResultPane.prototype.getViewTypeIconDOM = function(sp, ipdom){\r\n    var bsp = document.createElement('span');\r\n    bsp.setAttribute('class', 'terminus-result-icons');\r\n    if(this.viewers.length > 1){\r\n        for(var i = 0; i<this.viewers.length; i++){\r\n            var isp = this.getIconForViewer(this.viewers[i], i, bsp);\r\n            bsp.appendChild(isp);\r\n        }\r\n    }\r\n    return bsp;\r\n}\r\n\r\nResultPane.prototype.changeViewerType = function(viewer, index){\r\n    this.currentViewer = index;\r\n    this.config = viewer;\r\n    this.input.setQuery(viewer);\r\n    this.input.submit(this.input.qObj);\r\n}\r\n\r\n\r\nResultPane.prototype.getDefaultViewerIcon = function(viewer){\r\n    var view_types = {\r\n        table: {label: \"Table\", icon: \"fa fa-table\"},\r\n\t\tgraph: {label: \"Graph\", icon: \"fas fa-code-branch\"},\r\n\t\tchooser: {label: \"Drop-down List\", icon: \"fas fa-caret-down\"},\r\n\t\tstream: {label: \"Result Stream\", icon: \"fa fa-list\"}\r\n    }\r\n    return view_types[viewer.type];\r\n}\r\n\r\n\r\nResultPane.prototype.getIconForViewer = function(viewer, index, container){\r\n    var isp = document.createElement('span');\r\n    var icon = document.createElement(\"i\");\r\n    var def = this.getDefaultViewerIcon(viewer);\r\n    icon.title = (viewer.label) ? viewer.label : def.label;\r\n    var ic = (viewer.icon ? viewer.icon : def.icon);\r\n    icon.setAttribute(\"class\", ic);\r\n    icon.classList.add('terminus-result-view-icon');\r\n    //icon.classList.add('circle-icon');\r\n    isp.appendChild(icon);\r\n    if(this.currentViewer == index){\r\n        isp.setAttribute(\"class\", \"result-icon-selected selected terminus-result-selected\");\r\n        icon.classList.add('terminus-view-selected');\r\n    }\r\n    else {\r\n        isp.setAttribute(\"class\", \"result-icon-selectable selectable\");\r\n        isp.addEventListener('mouseover', function(){\r\n            this.style.cursor = \"pointer\";\r\n\t\t});\r\n    }\r\n    isp.addEventListener(\"click\", () => {\r\n        this.changeViewerType(viewer, index);\r\n        TerminusClient.FrameHelper.removeChildren(container);\r\n        for(var i = 0; i<this.viewers.length; i++){\r\n            var isp = this.getIconForViewer(this.viewers[i], i, container);\r\n            container.appendChild(isp);\r\n        }\r\n    });\r\n    return isp;\r\n}\r\n\r\nResultPane.prototype.createInput = function(mode){\r\n    let input = new TerminusCodeSnippet(\"rule\", mode);\r\n    if(this.config){\r\n    \tinput.setQuery(this.config);\r\n\t}\r\n\tvar self = this;\r\n\tinput.submit = function(config){\r\n\t\tself.updateView(config);\r\n\t};\r\n\treturn input;\r\n}\r\n\r\nResultPane.prototype.setResult = function(wres){\r\n\tthis.result = wres;\r\n}\r\n\r\nResultPane.prototype.updateResult = function(wres){\r\n\tthis.result = wres;\r\n\tTerminusClient.FrameHelper.removeChildren(this.resultDOM);\r\n\tthis.resultDOM.appendChild(this.getResultDOM());\r\n}\r\n\r\nResultPane.prototype.updateView = function(config){\r\n\tthis.config = config;\r\n\tTerminusClient.FrameHelper.removeChildren(this.resultDOM);\r\n\tif(this.result){\r\n\t\tthis.resultDOM.appendChild(this.getResultDOM());\r\n\t}\r\n}\r\n\r\nResultPane.prototype.getResultDOM = function(){\r\n\tlet span = document.createElement(\"span\");\r\n\tspan.setAttribute(\"class\", \"terminus-query-results\");\r\n    let viewer = this.config.create(this.client, this.renderers, Datatypes.initialiseDataRenderers);\r\n    var self = this;\r\n    viewer.notify = function(r){\r\n        self.qp.updateResult(r);\r\n    }\r\n\tthis.result.first();\r\n\tviewer.setResult(this.result);\r\n\tspan.appendChild(viewer.render());\r\n\treturn span;\r\n}\r\n\r\nmodule.exports = ResultPane;\r\n","function GraphResultsViewer(config) {\r\n\tthis.svg;\r\n\tthis.visid = randomString(8);\r\n\tthis.currentDate = Date.now() / 1000; // nowish\r\n\t// Individual links, nodes and text graphical elements\r\n\tthis.link_elements;\r\n\tthis.node_elements;\r\n\t// DOM object that this this is directly drawn into\r\n\tthis.container = false;\r\n\t// Map of ids to loaded nodes for ease\r\n\tthis.loadedNodes = {};\r\n\tthis.focusNodes = [];\r\n\t// Currently displayed nodes and links\r\n\tthis.nodes;\r\n\tthis.links;\r\n\t// Var for selecting and deselecting elements\r\n\tthis.selected_id;\r\n\tthis.setConfigOptions(config);\r\n}\r\n\r\n/*\r\n * Loads the graph with new data and optionally starts the animation\r\n */\r\nGraphResultsViewer.prototype.load = function(show) {\r\n\tthis.initD3(this.d3DOM);\r\n\tthis.loadNewData();\r\n\tthis.updateGraph();\r\n\tif(show){\r\n\t\tthis.updateSimulation(\"init\");\r\n\t}\r\n}\r\n\r\n/*\r\n * Called to issue a new set of datapoints\r\n */\r\nGraphResultsViewer.prototype.setData = function(dqr, show){\r\n\t//this.setFocusNodeFromResult(dqr);\r\n\tif(this.result){\r\n\t\tthis.clear();\r\n\t}\r\n\tthis.result = dqr;\r\n\t//if(this.svg){\r\n\t\tthis.load(show);\r\n\t//}\r\n}\r\n\r\nGraphResultsViewer.prototype.loadNewData = function(){\r\n\tthis.nodes = jQuery.extend(true, [], this.result.getNodes());\r\n\tfor(var i = 0 ; i<this.nodes.length; i++){\r\n\t\tthis.loadedNodes[this.nodes[i].id] = this.nodes[i];\r\n\t}\r\n\tthis.links = this.result.getEdges();\r\n\t//this.browser.rebuildController();\r\n}\r\n\r\n\r\n/*\r\n * Called to indicate that the current set of datapoints has been updated\r\n */\r\nGraphResultsViewer.prototype.updateData = function(dqr, show) {\r\n\tthis.setFocusNodeFromResult(dqr);\r\n\tthis.result = dqr;\r\n\tthis.reload(show, \"update\", this.fix_nodes);\r\n}\r\n\r\nGraphResultsViewer.prototype.setFocusNodeFromResult = function(dqr) {\r\n\tvar fn = dqr.getFocusNode();\r\n\tif(fn){\r\n\t\tthis.selected_id = fn;\r\n\t\tthis.focusNodes.push(fn);\r\n\t}\r\n}\r\n\r\n/*\r\n * Called to indicate that the filter setting has been changed on the current datapoints\r\n */\r\nGraphResultsViewer.prototype.setFilter = function(dqr, show){\r\n\tthis.simulation.stop();\r\n\tthis.reload(show, \"filter\", true);\r\n}\r\n\r\nGraphResultsViewer.prototype.wake = function() {\r\n\tif(this.simulation)\tthis.updateSimulation(\"wake\");\r\n}\r\n\r\nGraphResultsViewer.prototype.hibernate = function() {\r\n\tthis.simulation.stop();\r\n}\r\n\r\n/*\r\n * Called when more data is added to the result but the query remains the same\r\n */\r\nGraphResultsViewer.prototype.reload = function(show, mode, no_animate) {\r\n\tfor(var i = 0 ; i<this.nodes.length; i++){\r\n\t\tthis.loadedNodes[this.nodes[i].id] = this.nodes[i];\r\n\t}\r\n\tvar nnodes = jQuery.extend(true, [], this.result.getNodesAndFringes());\r\n\tthis.nodes = [];\r\n\tvar snode = this.loadedNodes[this.selected_id];\r\n\tfor(var i = 0 ; i<nnodes.length; i++){\r\n\t\tvar nnode = nnodes[i];\r\n\t\tif(this.loadedNodes[nnode.id]){\r\n\t\t\tif(nnode.id == this.selected_id){\r\n\t\t\t\tthis.loadedNodes[nnode.id].fx = this.loadedNodes[nnode.id].x;\r\n\t\t\t\tthis.loadedNodes[nnode.id].fy = this.loadedNodes[nnode.id].y;\r\n\t\t\t}\r\n\t\t\telse if(!no_animate) {\r\n\t\t\t\tthis.loadedNodes[nnode.id].fx = null;\r\n\t\t\t\tthis.loadedNodes[nnode.id].fy = null;\r\n\t\t\t}\r\n\t\t\telse if(this.loadedNodes[nnode.id].x){\r\n\t\t\t\tthis.loadedNodes[nnode.id].fx = this.loadedNodes[nnode.id].x;\r\n\t\t\t\tthis.loadedNodes[nnode.id].fy = this.loadedNodes[nnode.id].y;\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tif(this.explode_out && snode.x){\r\n\t\t\t\tnnode.x = snode.x;\r\n\t\t\t\tnnode.y = snode.y;\r\n\t\t\t}\r\n\t\t\tthis.loadedNodes[nnode.id] = nnode;\r\n\t\t}\r\n\t\tthis.nodes.push(this.loadedNodes[nnode.id]);\r\n\t}\r\n\tthis.links = this.result.getLinks();\r\n\tthis.updateGraph();\r\n\tif(show){\r\n\t\t//this.browser.rebuildController();\r\n\t\tthis.updateSimulation(mode);\r\n\t}\r\n}\r\n\r\nGraphResultsViewer.prototype.clear = function() {\r\n\tthis.nodes = [];\r\n\tthis.loadedNodes = {};\r\n\tthis.links = [];\r\n\tthis.updateGraph();\r\n\tjQuery(this.d3DOM).empty();\r\n\tthis.scale_factor = 1;\r\n}\r\n\r\n/*\r\n * Called to initialise the DOM when it is first loaded (called after setData)\r\n */\r\nGraphResultsViewer.prototype.initDOM = function(vdom) {\r\n\tif(!this.width) this.width = this.setWidth();\r\n\tif(!this.height) this.height = this.setHeight();\r\n\tthis.d3DOM = vdom;\r\n\tif(this.result){\r\n\t\tthis.load(true);\r\n\t}\r\n}\r\n\r\n/*\r\n * Generate the div that contains the visualisation panel\r\n */\r\nGraphResultsViewer.prototype.getAsDOM = function() {\r\n\tvar vdom = document.createElement(\"div\");\r\n\tvdom.setAttribute(\"class\", \"terminus-gviz-panel\");\r\n\tvdom.setAttribute(\"id\", this.visid);\r\n\tvdom.setAttribute(\"width\", \"100%\");\r\n\tthis.container = vdom;\r\n\treturn vdom;\r\n}\r\n\r\n/*\r\n * Calculates the width of the container area available for the SVG\r\n */\r\nGraphResultsViewer.prototype.setWidth = function() {\r\n\tif(this.container && this.container.clientWidth){\r\n\t\tthis.width = this.container.clientWidth;\r\n\t}\r\n\telse if(this.container.parentNode && this.container.parentNode.clientWidth){\r\n\t\tthis.width = this.container.parentNode.clientWidth;\r\n\t}\r\n\telse {\r\n\t\tvar w = jQuery(this.container).width();\r\n\t\tif(w == 0){\r\n\t\t\tw = jQuery(this.container.parentNode).width();\r\n\t\t}\r\n\t\tif(w == 0) {\r\n\t\t\tw = 800;\r\n\t\t}\r\n\t\tthis.width = w;\r\n\t}\r\n\treturn this.width;\r\n}\r\n\r\nGraphResultsViewer.prototype.setHeight = function() {\r\n\tif(this.container && this.container.clientHeight){\r\n\t\tthis.height = this.container.clientHeight;\r\n\t}\r\n\telse if(this.container.parentNode && this.container.parentNode.clientHeight){\r\n\t\tthis.height = this.container.parentNode.clientHeight;\r\n\t}\r\n\telse {\r\n\t\tvar w = jQuery(this.container).height();\r\n\t\tif(w == 0){\r\n\t\t\tw = jQuery(this.container.parentNode).height();\r\n\t\t}\r\n\t\tif(w == 0) {\r\n\t\t\tw = 400;\r\n\t\t}\r\n\t\tthis.height = w;\r\n\t}\r\n\treturn this.height;\r\n}\r\n\r\n\r\nGraphResultsViewer.prototype.initD3 = function(jqid) {\r\n\tvar self = this;\r\n\r\n\t/********************* Seed the data **************************/\r\n\tthis.svg = d3.select(jqid).append(\"svg\")\r\n\t\t.attr(\"width\", this.width)\r\n\t\t.attr(\"height\", this.height);\r\n\r\n\tvar distanceFun = function(link){\r\n\t\treturn self.getLinkDistance(link);\r\n\t}\r\n\r\n\t// create the force object\r\n\tthis.simulation  = d3.forceSimulation()\r\n\t\t//link distance varies with link type\r\n\t    .force(\"link\", d3.forceLink().distance(distanceFun).id(function(link) { return link.id; }))\r\n\t    //charge is the same for all nodes\r\n\t    .force('charge', d3.forceManyBody().strength(function(node){ return self.getCharge(node)}))\r\n\t    //collision radius changes with node type\r\n\t    .force('collision', d3.forceCollide().radius(function(node) {\r\n\t    \treturn (self.getCollisionRadius(node));\r\n\t    }))\r\n\t\t.force(\"center\", d3.forceCenter(this.width / 2, this.height / 2));\r\n\r\n\t// node drag\r\n\tthis.drag_drop = d3.drag()\r\n\t\t.on('start', function(node) {\r\n\t\t\tnode.fx = node.x\r\n\t\t\tnode.fy = node.y\r\n\t\t})\r\n\t\t.on('drag', function(node) {\r\n\t\t\tself.simulation.restart()\r\n\t\t\tnode.fx = d3.event.x;\r\n\t\t\tnode.fy = d3.event.y;\r\n\t\t})\r\n\t\t.on('end', function(node) {\r\n\t\t\tnode.fx = null;\r\n\t\t\tnode.fx = null;\r\n\t\t\tself.simulation.stop()\r\n\t\t});\r\n\r\n\tthis.svg.append(\"rect\")\r\n\t   .attr(\"width\", this.width)\r\n\t   .attr(\"height\", this.height)\r\n\t   .style(\"fill\", \"none\")\r\n\t   .style(\"pointer-events\", \"all\")\r\n\t   .call(d3.zoom().on(\"zoom\", function(){self.zoomed()}));\r\n\r\n\t// Append graphic element to svg which are groups for graph elements\r\n\tthis.link_group = this.svg.append(\"g\").classed(\"links\", true);\r\n\tthis.node_group = this.svg.append(\"g\").classed(\"nodes\", true);\r\n}\r\n\r\nGraphResultsViewer.prototype.zoomed = function() {\r\n\tthis.current_transform = d3.event.transform;\r\n\tif(this.node_elements)\r\n\t\tthis.node_elements.attr(\"transform\", d3.event.transform);\r\n    if(this.link_elements)\r\n    \tthis.link_elements.attr(\"transform\", d3.event.transform);\r\n}\r\n\r\n/***\r\n * updates the svg with the current nodes and links\r\n */\r\nGraphResultsViewer.prototype.updateGraph = function(nodes, links) {\r\n\tvar self = this;\r\n\r\n\tvar follow_node_wrapper = function(graph_node){\r\n\t\tself.nodeSelected(graph_node);\r\n\t}\r\n\tvar zoomed = function(){\r\n\t\tself.zoomed();\r\n\t}\r\n\r\n\tnodes = (typeof nodes != \"undefined\" ? nodes : this.nodes);\r\n\tlinks = (typeof links != \"undefined\" ? links : this.links);\r\n\tthis.node_elements  = this.node_group.selectAll(\"g\").data(nodes);\r\n\tthis.node_elements.exit().remove();\r\n\r\n\t/*Create and place the \"blocks\" containing the circle and the text */\r\n    var node_enter = this.node_elements.enter().append(\"g\");\r\n\r\n\t// enter and create new ones\r\n\tnode_enter.append(\"circle\")\r\n\t\t.style('opacity', 0.99)\r\n\t\t.attr('r', function(node){return self.getRadius(node)})\r\n\t\t.attr(\"cx\",  function(node){ return node.x})\r\n\t\t.attr(\"cy\",  function(node){ return node.y})\r\n\t\t.attr(\"type\", function(node) {return self.isFringe(node) ? \"fringe\" : \"node\"})\r\n\t\t.call(self.drag_drop)\r\n\t\t.on(\"mouseover\", function(d){ d3.select(this).style(\"cursor\", \"pointer\"); })\r\n\t\t.on(\"mouseout\", function(d){ d3.select(this).style(\"cursor\", \"default\"); })\r\n\t\t.on('click', follow_node_wrapper);\r\n\r\n    node_enter.append(\"text\")\r\n\t\t.attr(\"x\",  function(node){ return node.x})\r\n\t\t.attr(\"y\",  function(node){ return node.y})\r\n\t\t.text(function(node) { return self.getNodeIconUnicode(node)})\r\n\t\t.call(self.drag_drop)\r\n\t\t.on(\"mouseover\", function(d){ d3.select(this).style(\"cursor\", \"pointer\"); })\r\n\t\t.on(\"mouseout\", function(d){ d3.select(this).style(\"cursor\", \"default\"); })\r\n\t\t.on('click', follow_node_wrapper);\r\n\r\n\t// merge new and old nodes\r\n\tthis.node_elements = node_enter.merge(this.node_elements);\r\n\r\n\tthis.styleNodeElements();\r\n\r\n\t// update LINKS ********************************************\r\n\tthis.link_elements  = this.link_group.selectAll(\"line\").data(links);\r\n\r\n\t// remove old links\r\n\tthis.link_elements.exit().remove();\r\n\t// enter and create new ones\r\n\tvar link_enter = this.link_elements.enter().append(\"line\");\r\n\r\n\t// merge new and old links\r\n\tthis.link_elements = link_enter.merge(this.link_elements)\r\n\r\n\tthis.styleLinkElements();\r\n\r\n\t//execute the current state of the pan-zoom transform\r\n\tif(this.current_transform){\r\n\t\tif(this.node_elements)\r\n\t\t\tthis.node_elements.attr(\"transform\", this.current_transform);\r\n\t    if(this.link_elements)\r\n\t    \tthis.link_elements.attr(\"transform\", this.current_transform);\r\n\t}\r\n}\r\n\r\nGraphResultsViewer.prototype.updateSimulation = function(mode) {\r\n\tvar self = this;\r\n\t//move all of the graphical elements corresponding to the nodes with each tick\r\n\tvar ticker = function(){\r\n\t\tself.node_elements.selectAll(\"circle\")\r\n\t\t\t.attr(\"cx\",  function(node){ return node.x})\r\n\t\t\t.attr(\"cy\",  function(node){ return node.y});\r\n\t\tself.node_elements.selectAll(\"text\")\r\n\t\t\t.attr(\"x\",  function(node){ return node.x})\r\n\t\t\t.attr(\"y\",  function(node){ return node.y});\r\n\t\tself.link_elements\r\n\t\t\t.attr('x1', function(link){ return link.source.x})\r\n\t\t\t.attr('y1', function(link){ return link.source.y})\r\n\t\t\t.attr('x2', function(link){ return link.target.x})\r\n\t\t\t.attr('y2', function(link){ return link.target.y});\r\n\t}\r\n\tif(this.show_force){\r\n\t\tthis.simulation.nodes(this.nodes).on('tick', ticker).force('link').links(this.links);\r\n\t}\r\n\telse {\r\n\t\tthis.simulation.nodes(this.nodes).on('end', ticker).force('link').links(this.links);\r\n\t}\r\n\tif(this.nodes.length){\r\n\t\tif(mode == \"wake\" || mode == \"init\"){\r\n\t\t\tthis.simulation.restart();\r\n\t\t}\r\n\t\telse if(mode == \"filter\"){\r\n\t\t\tthis.simulation.restart();\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.simulation.alpha(1).restart();\r\n\t\t}\r\n\t}\r\n}\r\n\r\nGraphResultsViewer.prototype.styleNodeElements = function() {\r\n\tvar self = this;\r\n\tif(this.node_elements){\r\n\t\tthis.node_elements.each(function(node){\r\n\t\t\tvar g = d3.select(this);\r\n\t\t\tvar sel = g.select(\"circle\");\r\n\t\t\tsel.select(\"title\").remove();\r\n\t\t\tsel.style(\"fill\", self.getNodeColour(node));\r\n\t\t\tsel.attr('r', self.getRadius(node));\r\n\t\t\tsel.classed(\"highlighted\", function(node) { return self.focusNodes.indexOf(node.id) != -1});\r\n\t\t\tsel.append(\"title\")\r\n\t\t\t\t.classed(\"terminus-gnode-title\", true)\r\n\t\t\t\t.text(self.getNodeText(node));\r\n\t\t\tvar txt = g.select(\"text\");\r\n\t\t\ttxt.select(\"title\").remove();\r\n\t\t\ttxt.attr('text-anchor', 'middle')\r\n\t\t\t\t.attr(\"title\", self.getNodeText(node))\r\n\t\t\t\t.attr('dominant-baseline', 'central')\r\n\t\t\t\t.style('font-family', \"'\" + self.fontfam + \"'\")\r\n\t\t\t\t.style('font-weight', self.getNodeIconWeight(node))\r\n\t\t\t\t.style('font-size', self.getNodeIconSize(node))\r\n\t\t\t\t.style(\"fill\", self.getNodeIconColour(node))\r\n\t\t\t\t.text(self.getNodeIconUnicode(node))\r\n\t\t\t\t.append(\"title\")\r\n\t\t\t\t\t.classed(\"terminus-gnode-title\", true)\r\n\t\t\t\t\t.text(self.getNodeText(node));\r\n\t\t});\r\n\t}\r\n}\r\n\r\nGraphResultsViewer.prototype.styleLinkElements = function() {\r\n\tvar self = this;\r\n\tif(this.link_elements){\r\n\t\tthis.link_elements.each(function(link){\r\n\t\t\tvar sel = d3.select(this);\r\n\t\t\tsel.select(\"title\").remove();\r\n\t\t\tsel.attr(\"stroke-width\", self.getLineWidth(link));\r\n\t\t\tsel.attr(\"marker-end\", self.getEdgeArrow(link));\r\n\t\t\tsel.style(\"stroke\", self.getEdgeColour(link));\r\n\t\t\tsel.append(\"title\")\r\n\t\t\t\t.classed(\"terminus-glink-title\", true)\r\n\t\t\t\t.text(self.getLinkText(link));\r\n\t\t});\r\n\t}\r\n}\r\n\r\nGraphResultsViewer.prototype.getEdgeArrow = function(edge) {\r\n\tif(edge){\r\n\t\tvar dir = this.getEdgeDirection(edge);\r\n\t\t//if(dir){\r\n\t\t\tvar col = this.getEdgeColour(edge);\r\n\t\t\tvar reference;\r\n\t\t\tthis.svg.append(\"svg:defs\").selectAll(\"marker\")\r\n\t\t\t\t.data([reference])\r\n\t\t\t\t.enter().append(\"svg:marker\")\r\n\t\t\t\t.attr(\"id\", String)\r\n\t\t\t\t.attr(\"viewBox\", \"0 -5 10 10\")\r\n\t\t\t\t.attr(\"refX\", 22)  // This sets how far back it sits, kinda\r\n\t\t\t\t.attr(\"refY\", 0)\r\n\t\t\t\t.attr(\"markerWidth\", this.getArrowWidth(edge))\r\n\t\t\t\t.attr(\"markerHeight\", this.getArrowHeight(edge))\r\n\t\t\t\t.attr(\"orient\", \"auto\")\r\n\t\t\t\t.attr(\"markerUnits\", \"userSpaceOnUse\")\r\n\t\t\t\t.append(\"svg:path\")\r\n\t\t\t\t\t.attr(\"d\", dir)\r\n\t\t\t\t\t.style(\"fill\", col);\r\n\t\t\t\treturn \"url(#\" + reference + \")\";\r\n\t\t//}\r\n\t}\r\n\treturn \"\";\r\n}\r\n\r\n\r\nGraphResultsViewer.prototype.nodeSelected = function(selected_node) {\r\n\tvar self = this;\r\n\tif(this.selected_id == selected_node.id && this.selection_grows){\r\n\t\tthis.selection_grows = false;\r\n\t\tthis.styleNodeElements();\r\n\t}\r\n\telse {\r\n\t\tthis.selection_grows = true;\r\n\t\tthis.selected_id = selected_node.id;\r\n\t\tthis.styleNodeElements();\r\n\t\t//this.browser.nodeSelected(selected_node);\r\n\t\tif(this.isFringe(selected_node)){\r\n\t\t\t//this.browser.followNode(selected_node);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nGraphResultsViewer.prototype.getScaleTransform = function(x, y, scale_factor){\r\n\treturn \"scale(\"+ scale_factor + \") translate(\" + x + \",\" + y + \")\";\r\n}\r\n\r\nGraphResultsViewer.prototype.scale = function(min_ratio) {\r\n    // the new dimensions of the molecule\r\n    new_mol_width = this.width * min_ratio;\r\n    new_mol_height = this.height * min_ratio;\r\n\r\n    var y_trans = (this.height - new_mol_height) ;\r\n\r\n    var x_trans = (this.width - new_mol_width);\r\n    // do the actual moving\r\n    var self = this;\r\n    if(this.node_elements)\r\n    \tthis.node_elements.transition()\r\n        .duration(750).attr(\"transform\", function(node){ return self.getScaleTransform(x_trans, y_trans, min_ratio)});\r\n    if(this.link_elements)\r\n        this.link_elements.transition()\r\n        .duration(750).attr(\"transform\", function(node){ return self.getScaleTransform(x_trans, y_trans, min_ratio)});\r\n\tthis.scale_factor = min_ratio;\r\n\tthis.svg.selectAll(\"marker\").attr(\"markerWidth\", this.getArrowWidth())\r\n\t\t\t.attr(\"markerHeight\", this.getArrowHeight());\r\n}\r\n\r\n\r\nGraphResultsViewer.prototype.scaleToFit = function() {\r\n    // Center the view on the molecule(s) and scale it so that everything\r\n    // fits in the window\r\n    //no molecules, nothing to do\r\n    if (this.nodes.length === 0)\r\n        return;\r\n\r\n    // Get the bounding box\r\n    min_x = d3.min(this.nodes.map(function(d) {return d.x;}));\r\n    min_y = d3.min(this.nodes.map(function(d) {return d.y;}));\r\n    max_x = d3.max(this.nodes.map(function(d) {return d.x;}));\r\n    max_y = d3.max(this.nodes.map(function(d) {return d.y;}));\r\n\r\n    // The width and the height of the graph\r\n    mol_width = max_x - min_x;\r\n    mol_height = max_y - min_y;\r\n\r\n    mol_width = mol_width * 1.05;\r\n    mol_height = mol_height * 1.05;\r\n    // how much larger the drawing area is than the width and the height\r\n    width_ratio = this.width / mol_width;\r\n    height_ratio = this.height / mol_height;\r\n\r\n    // we need to fit it in both directions, so we scale according to\r\n    // the direction in which we need to scale the most\r\n    min_ratio = Math.min(width_ratio, height_ratio);\r\n    if(min_ratio < 1){\r\n    \tthis.scale(min_ratio);\r\n    }\r\n};\r\n\r\n// recentre graph\r\nGraphResultsViewer.prototype.recentre = function(graph_node) {\r\n\tthis.translated = true;\r\n\t// get the x and y you need to transform the nodes by\r\n\tthis.dcx = (this.width/2-graph_node.x);\r\n\tthis.dcy = (this.height/2-graph_node.y);\r\n\t//zoom.translate([dcx,dcy]); If we do zooming we'll need to do something here\r\n\tthis.node_elements.attr(\"transform\", \"translate(\"+ this.dcx + \",\" + this.dcy  + \")\");\r\n\tthis.link_elements.attr(\"transform\", \"translate(\"+ this.dcx + \",\" + this.dcy  + \")\");\r\n\tthis.text_elements.attr(\"transform\", \"translate(\"+ this.dcx + \",\" + this.dcy  + \")\");\r\n}\r\n\r\n\r\nGraphResultsViewer.prototype.setConfigOptions = function(config) {\r\n\t//configuration options for different types of behaviour\r\n\t// Need to explicitly know font family name for unicode glyphs\r\n\tthis.fontfam = (config && (config.fontfamily()) ? config.fontfamily() : 'Font Awesome 5 Free');\r\n\tthis.selected_grows = (config && typeof config.selected_grows() != \"undefined\" ? config.selected_grows() : true);\r\n\tthis.show_force = (config && typeof config.show_force() != \"undefined\" ? config.show_force() : true);\r\n\tthis.fix_nodes = (config && typeof config.fix_nodes() != \"undefined\" ? config.fix_nodes() : false);\r\n\tthis.explode_out = (config && typeof config.explode_out() != \"undefined\" ? config.explode_out(): false);\r\n\tthis.width = (config && config.width() ? config.width(): false);\r\n\tthis.height = (config && config.height() ? config.height(): false);\r\n\tthis.defaults = {\r\n\t\tedge: {\r\n\t\t\ttype: \"edge\",\r\n\t\t\tdistance: (config && config.edge && config.edge.distance ? config.edge.distance : 70),\r\n\t\t\tarrow: (config && config.edge && config.edge.arrow ? config.edge.arrow : { width: 36, height: 16}),\r\n\t\t\tsymmetric: (config && config.edge && config.edge.symmetric ? config.edge.symmetric : true),\r\n\t\t\tcolor: (config && config.edge && config.edge.color ? config.edge.color : [150,150,255]),\r\n\t\t\tweight: (config && config.edge && config.edge.weight ? config.edge.weight : 0.3),\r\n\t\t\tsize: (config && config.edge && config.edge.size ? config.edge.size : 4)\r\n\t\t},\r\n\t\tnode: {\r\n\t\t\ttype: \"node\",\r\n\t\t\tradius: (config && config.node && config.node.radius ? config.node.radius : 14),\r\n\t\t\tcharge: (config && config.node && config.node.charge ? config.node.charge : -60),\r\n\t\t\tcollisionRadius: (config && config.node && config.node.collisionRadius ? config.node.collisionRadius : 20),\r\n\t\t\tcolor: (config && config.node && config.node.color ? config.node.color : [0,255,255]),\r\n\t\t\ticon: {\r\n\t\t\t\tweight: (config && config.node && config.node.icon && config.node.icon.weight ? config.node.icon.weight : 900),\r\n\t\t\t\tcolor: (config && config.node && config.node.icon && config.node.icon.color ? config.node.icon.color : [0,0,255]),\r\n\t\t\t\tunicode: (config && config.node && config.node.icon && config.node.icon.unicode ? config.node.icon.unicode : \"\\uf4fb\"),\r\n\t\t\t\tsize: (config && config.node && config.node.icon && config.node.icon.size ? config.node.icon.size : 10),\r\n\t\t\t\tfaclass: (config && config.node && config.node.icon && config.node.icon.faclass ? config.node.icon.faclass : \"fas fa-user-astronaut\")\r\n\t\t\t},\r\n\t\t\ttext: {\r\n\t\t\t\tcolor: (config && config.node && config.node.text && config.node.text.color ? config.node.text.color : [0,0,0]),\r\n\t\t\t\tsize: (config && config.node && config.node.icon && config.node.text.size ? config.node.text.size : 10)\r\n\t\t\t},\r\n\t\t\tborder: {\r\n\t\t\t\tcolor: (config && config.node && config.node.border && config.node.border.color ? config.node.border.color : [0,0,0]),\r\n\t\t\t\tsize: (config && config.node && config.node.border && config.node.border.size ? config.node.border.size : 10)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\n/*\r\n * Dimensions / forces / etc all settable with a scale factor - for zooming\r\n */\r\nGraphResultsViewer.prototype.getMultiplier = function(node) {\r\n\tvar mult = (node && node.size ? node.size : 1);\r\n\tif(node.id == this.selected_id && this.selection_grows){\r\n\t\tmult = mult * 2;\r\n\t}\r\n\treturn mult;\r\n}\r\n\r\nGraphResultsViewer.prototype.getRadius = function(node) {\r\n\tvar radius = (node && node.radius ? node.radius : this.defaults.node.radius);\r\n\tvar r = (this.scale_factor ? Math.min(this.scale_factor * radius, radius) : radius);\r\n\tr = r * this.getMultiplier(node);\r\n\treturn r;\r\n}\r\n\r\nGraphResultsViewer.prototype.getCollisionRadius = function(node) {\r\n\tvar colrad = (node && node.collisionRadius ? node.collisionRadius : this.defaults.node.collisionRadius );\r\n\tvar v = (this.scale_factor ? Math.min(this.scale_factor * colrad, colrad) : colrad);\r\n\treturn v * this.getMultiplier(node);\r\n}\r\n\r\nGraphResultsViewer.prototype.getCharge = function(node) {\r\n\tvar charge = (node && node.charge ? node.charge : this.defaults.node.charge);\r\n\tif(charge < 0){\r\n\t\tvar v = (this.scale_factor ? Math.max(this.scale_factor * charge, charge) : charge);\r\n\t}\r\n\telse {\r\n\t\tvar v = (this.scale_factor ? Math.min(this.scale_factor * charge, charge) : charge);\r\n\t}\r\n\treturn v * this.getMultiplier(node);\r\n}\r\n\r\nGraphResultsViewer.prototype.getLinkDistance = function(link) {\r\n\tvar linkDistance = (link && link.distance ? link.distance : this.defaults.edge.distance);\r\n\tvar x = (this.scale_factor ? Math.min(this.scale_factor * linkDistance, linkDistance) : linkDistance);\r\n\treturn x;\r\n}\r\n\r\nGraphResultsViewer.prototype.getNodeIconSize = function(node) {\r\n\tif(node && node.icon && node.icon.size){\r\n\t\treturn node.icon.size + \"em\";\r\n\t}\r\n\treturn (this.getMultiplier(node) + \"em\");\r\n}\r\n\r\nGraphResultsViewer.prototype.getNodeColour = function(node) {\r\n\tvar col = (node && node.color ? node.color : this.defaults.node.color);\r\n\tif(this.isFringe(node)){\r\n\t\treturn \"rgba(\"+col.join(\",\")+\",0.25)\";\r\n\t}\r\n\telse {\r\n\t\treturn \"rgb(\"+col.join(\",\")+\")\";\r\n\t}\r\n}\r\n\r\nGraphResultsViewer.prototype.getNodeIcon = function(node) {\r\n\tvar fac = (node && node.icon && node.icon.faclass ? node.icon.faclass : this.defaults.node.icon.faclass);\r\n\treturn fac;\r\n}\r\n\r\nGraphResultsViewer.prototype.getNodeIconUnicode= function(node) {\r\n\treturn (node && node.icon && node.icon.unicode ? node.icon.unicode : this.defaults.node.icon.unicode);\r\n}\r\n\r\nGraphResultsViewer.prototype.getNodeIconWeight = function(node) {\r\n\treturn (node && node.icon && node.icon.weight ? node.icon.weight : this.defaults.node.icon.weight );\r\n}\r\n\r\nGraphResultsViewer.prototype.getNodeIconColour = function(node) {\r\n\tvar col = (node && node.icon && node.icon.color ? node.icon.color : this.defaults.node.icon.color );\r\n\tif(this.isFringe(node)){\r\n\t\treturn \"rgba(\"+col.join(\",\")+\",0.25)\";\r\n\t}\r\n\telse {\r\n\t\treturn \"rgb(\"+col.join(\",\")+\")\";\r\n\t}\r\n}\r\n\r\nGraphResultsViewer.prototype.getEdgeColour = function(edge) {\r\n\tvar col = (edge && edge.color ? edge.color : this.defaults.edge.color );\r\n\tvar weight = (edge && edge.weight ? edge.weight : this.defaults.edge.weight);\r\n\tvar nc = col.concat([weight]);\r\n\treturn \"rgba(\"+nc.join(\",\")+\")\";\r\n}\r\n\r\nGraphResultsViewer.prototype.getEdgeDirection = function(edge) {\r\n\tif(edge && edge.symmetric){\r\n\t\treturn \"M10,-5 L0,0 L10,5\";\r\n\t}\r\n\treturn \"M0,-5 L10,0 L0,5\";\r\n\treturn false;\r\n}\r\n\r\nGraphResultsViewer.prototype.getLineWidth = function(link) {\r\n\tvar x = (link && link.size ? link.size : this.defaults.edge.size);\r\n\treturn x;\r\n}\r\n\r\n\r\nGraphResultsViewer.prototype.getNodeText = function(node) {\r\n\tif(node && node.text) return node.text;\r\n\treturn node.id;\r\n}\r\n\r\nGraphResultsViewer.prototype.getLinkText = function(edge) {\r\n\tif(edge && edge.text) return edge.text;\r\n\tif(edge && edge.id) return edge.id;\r\n\treturn \"\";\r\n}\r\n\r\nGraphResultsViewer.prototype.getArrowWidth = function(edge) {\r\n\tvar w = (edge && edge.arrow && edge.arrow.width ? edge.arrow.width : this.defaults.edge.arrow.width);\r\n\treturn (this.scale_factor ? Math.min(this.scale_factor * w, w) : w);\r\n}\r\n\r\nGraphResultsViewer.prototype.getArrowHeight = function(edge) {\r\n\tvar w = (edge && edge.arrow && edge.arrow.height ? edge.arrow.height : this.defaults.edge.arrow.height );\r\n\treturn (this.scale_factor ? Math.min(this.scale_factor * w, w) : w);\r\n}\r\n\r\nGraphResultsViewer.prototype.isNeighbourLink = function(node, link) {\r\n\treturn link.target.id === node.id || link.source.id === node.id;\r\n}\r\n\r\nGraphResultsViewer.prototype.isFringe = function(node){\r\n\tif(this.result && this.result.added && this.result.added.upgraded){\r\n\t\tif(this.result.added.upgraded.indexOf(node.id) != -1){\r\n\t\t\tnode.type = \"node\";\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\treturn node.type && node.type == \"fringe\";\r\n}\r\n\r\nfunction randomString(length) {\r\n    var chars = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz'.split('');\r\n    if (! length) {\r\n        length = Math.floor(Math.random() * chars.length);\r\n    }\r\n    var str = '';\r\n    for (var i = 0; i < length; i++) {\r\n        str += chars[Math.floor(Math.random() * chars.length)];\r\n    }\r\n    return str;\r\n}\r\n\r\nmodule.exports = GraphResultsViewer;\r\n","function TerminusViolations(vios, ui){\r\n\tthis.ui = ui;\r\n\tthis.vios = [];\r\n\tvar nvios = [];\r\n\tfor(var i = 0; i<vios.length; i++){\r\n\t\tfor(var j = 0; j<nvios.length; j++){\r\n\t\t\tif(JSON.stringify(vios[i]) == JSON.stringify(nvios[j])) continue;\r\n\t\t}\r\n\t\tnvios.push(vios[i]);\r\n\t}\r\n\tfor(var i = 0; i<nvios.length; i++){\r\n\t\tthis.vios.push(new TerminusViolation(nvios[i], this.ui));\r\n\t}\r\n}\r\n\r\nTerminusViolations.prototype.getAsDOM = function(context_msg){\r\n\tvar vdom = document.createElement(\"div\");\r\n\tvdom.setAttribute(\"class\", \"terminus-violations terminus-show-msg-vio\");\r\n\tvar vioHeading = document.createElement(\"div\");\r\n\tvioHeading.setAttribute('class', 'terminus-violations-heading');\r\n\tvdom.appendChild(vioHeading);\r\n\tvar msg = this.vios.length + (this.vios.length > 1 ? \" Violations Detected\" : \" Violation Detected\");\r\n\tif(context_msg) msg += \" \" + context_msg;\r\n\tvioHeading.appendChild(document.createTextNode(msg));\r\n\tfor(var i = 0; i<this.vios.length; i++){\r\n\t\tvdom.appendChild(this.vios[i].getAsDOM());\r\n\t}\r\n\treturn vdom;\r\n}\r\n\r\n/*\r\n * Class for displaying violation reports as HTML\r\n */\r\nfunction TerminusViolation(vio, ui){\r\n\tthis.ui = ui;\r\n\tthis.vio = vio;\r\n}\r\n\r\nTerminusViolation.prototype.getAsDOM = function(){\r\n\tvar vdom = document.createElement(\"div\");\r\n\tvdom.setAttribute(\"class\", \"terminus-violation\");\r\n\tif(this.vio['@type']){\r\n\t\tvar msg = this.vio['vio:message'] || {\"@value\": \"\"};\r\n\t\tvdom.appendChild(this.getPropertyAsDOM(this.vio[\"@type\"], msg));\r\n\t}\r\n\tfor(var prop in this.vio){\r\n\t\tif(prop != \"vio:message\" && prop != \"@type\"){\r\n\t\t\tvdom.appendChild(this.getPropertyAsDOM(prop, this.vio[prop]));\r\n\t\t}\r\n\t}\r\n\treturn vdom;\r\n}\r\n\r\nTerminusViolation.prototype.getPropertyAsDOM = function(prop, val){\r\n\tvar pdom = document.createElement(\"div\");\r\n\tpdom.setAttribute(\"class\", \"terminus-violation-property\");\r\n\tvar ldom = document.createElement(\"span\");\r\n\tldom.setAttribute(\"class\", \"terminus-label terminus-violation-property-label\");\r\n\tldom.appendChild(document.createTextNode(prop));\r\n\tvar vdom = document.createElement(\"span\");\r\n\tvdom.setAttribute(\"class\", \"terminus-violation-property-value\");\r\n\tvdom.appendChild(document.createTextNode(val[\"@value\"]));\r\n\tpdom.appendChild(ldom);\r\n\tpdom.appendChild(vdom);\r\n\treturn pdom;\r\n}\r\n\r\nmodule.exports=TerminusViolations\r\n","//const TerminusHTMLViewer = require('./html/TerminusHTMLViewer');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\nconst QueryPane = require(\"./html/QueryPane\");\r\nconst ScriptPane = require(\"./html/ScriptPane\");\r\nconst DocumentPane = require(\"./html/DocumentPane\");\r\n\r\nfunction TerminusQueryViewer(ui, options){\r\n\tthis.ui = ui;\r\n\tthis.options = options;\r\n\tthis.panes = [];\r\n\tthis.new_pane = false;\r\n\tthis.new_pane_type = false;\r\n\tthis.meta = {};\r\n\tthis.container = document.createElement(\"div\");\r\n\tthis.container.setAttribute(\"class\", \"terminus-query-page\");   \r\n}\r\n\r\nTerminusQueryViewer.prototype.newPaneOptions = function(){ \r\n\tvar opts = {showQuery: true, \r\n\t\teditQuery: true,\r\n\t\tshowHeader: true, \r\n\t\taddViews: true,\r\n\t\tviewers: []\r\n\t};\r\n\topts.viewers.push(new TerminusClient.WOQL.table());\r\n\topts.viewers.push(new TerminusClient.WOQL.graph());\r\n\topts.viewers.push(new TerminusClient.WOQL.chooser());\r\n\topts.viewers.push(new TerminusClient.WOQL.stream()); \r\n\treturn opts;\r\n} \r\n\r\nTerminusQueryViewer.prototype.addQueryPane = function(){\r\n\tlet qpane = new QueryPane(this.ui.client).options(this.newPaneOptions());\r\n\tthis.panes.push(qpane);\r\n\treturn qpane;\r\n}\r\n\r\nTerminusQueryViewer.prototype.addScriptPane = function(q){\r\n\tlet qpane = new ScriptPane(this.ui.client, q);\r\n\tthis.panes.push(qpane);\r\n\treturn qpane;\r\n}\r\n\r\nTerminusQueryViewer.prototype.addScriptPaneDOM = function(){\r\n\tlet qpane = new ScriptPane(this.ui.client);\r\n\tthis.addNewPaneDOM(qpane);\r\n}\r\n\r\nTerminusQueryViewer.prototype.addQueryPaneDOM = function(){\r\n\tlet qpane = new QueryPane(this.ui.client).options({showQuery: true, editQuery: true});\r\n\tthis.addNewPaneDOM(qpane);\r\n}\r\n\r\nTerminusQueryViewer.prototype.setNewDocumentPaneDOM = function(){\r\n\tthis.new_pane = new DocumentPane(this.ui.client).options({showQuery: true, editQuery: true});\r\n\tthis.new_pane_type = \"document\";\r\n}\r\n\r\nTerminusQueryViewer.prototype.addDocumentPaneDOM = function(){\r\n\tlet qpane = new DocumentPane(this.ui.client).options({showQuery: true, editQuery: true});\r\n\tthis.addNewPaneDOM(qpane);\r\n}\r\n\r\nTerminusQueryViewer.prototype.addNewPaneDOM = function(qpane){\r\n\tvar lpane = this.panes[this.panes.length-1];\r\n\tif(lpane && lpane.empty()){\r\n\t\tthis.panes[this.panes.length-1] = qpane;\r\n\t\tthis.paneDOM.removeChild(this.paneDOM.lastChild)\t\t \r\n\t}\r\n\telse {\r\n\t\tthis.panes.push(qpane);\r\n\t}\r\n\tvar qdom = qpane.getAsDOM();\r\n\tvar qhdr = this.getPaneHeader();\r\n\tqdom.prepend(qhdr);\r\n\tthis.paneDOM.appendChild(qdom);\r\n}\r\n\r\nTerminusQueryViewer.prototype.getAsDOM = function(q){\r\n\tTerminusClient.FrameHelper.removeChildren(this.container);\r\n\tif(!this.paneDOM) this.paneDOM = this.getPanesDOM();\r\n\tthis.container.appendChild(this.paneDOM);\r\n\tthis.controlDOM = this.getControlsDOM();\r\n\tthis.container.appendChild(this.controlDOM);\r\n\treturn this.container;\r\n}\r\n\r\nTerminusQueryViewer.prototype.getPanesDOM = function(q){\r\n\tthis.panesDOM = document.createElement(\"div\");\r\n\tthis.panesDOM.setAttribute(\"class\", \"terminus-query-panes\");\r\n\tfor(var i = 0; i<this.panes.length; i++){\r\n\t\tvar pd = this.panes[i].getAsDOM();\r\n\t\tvar qhdr = this.getPaneHeader();\r\n\t\tpd.prepend(qhdr);\r\n\t\tthis.panesDOM.appendChild(pd);\r\n\t}\r\n\tif(!this.new_pane){\r\n\t\tthis.new_pane = new QueryPane(this.ui.client).options(this.newPaneOptions());\r\n\t}\r\n\tvar npd = this.new_pane.getAsDOM();\r\n\tvar nqhdr = this.getNewPaneHeader();\r\n\tthis.new_pane.headerDOM = nqhdr;\r\n\tthis.new_pane.paneDOM = npd;\r\n\tnpd.prepend(nqhdr);\r\n\tthis.panesDOM.appendChild(npd);\r\n\treturn this.panesDOM;\r\n}\r\n\r\nTerminusQueryViewer.prototype.removePane = function(pane, index){\r\n\tTerminusClient.FrameHelper.removeChildren(pane.paneDOM);\r\n\tpane.paneDOM.appendChild(pane.headerDOM);\r\n\tif(this.panes[i]){\r\n\t\tthis.panes.splice(i, 1);\r\n\t}\r\n}\r\n\r\nTerminusQueryViewer.prototype.showPane = function(pane){\r\n\t//TerminusClient.FrameHelper.removeChildren(pane.paneDOM);\r\n\t//var pd = pane.getAsDOM();\r\n\t//var qhdr = this.getPaneHeader();\r\n\t//pd.prepend(qhdr);\r\n\t//pane.headerDOM = qhdr;\t\r\n}\r\n\r\nTerminusQueryViewer.prototype.hidePane = function(pane){\r\n\t\r\n}\r\n\r\n\r\n\r\nTerminusQueryViewer.prototype.getPaneHeader = function(){\r\n\tvar hdr = document.createElement(\"div\");\r\n\thdr.appendChild(this.getControlsDOM());\r\n\treturn hdr;\r\n}\r\n\r\nTerminusQueryViewer.prototype.getNewPaneHeader = function(){\r\n\tvar hdr = document.createElement(\"div\");\r\n\thdr.appendChild(this.getControlsDOM(\"new\"));\r\n\treturn hdr;\r\n}\r\n\r\nTerminusQueryViewer.prototype.getControlsDOM = function(isnew){\r\n\tvar c = document.createElement(\"div\");\r\n\tc.setAttribute(\"class\", \"terminus-query-page-controls\");    \r\n\tif(isnew == \"new\"){\r\n\t\tvar newPaneButton = document.createElement('button');\r\n\t\tnewPaneButton.setAttribute('class', 'terminus-btn terminus-query-btn');\r\n\t\tnewPaneButton.appendChild(document.createTextNode('WOQL Query'));\r\n\t\t//newPaneButton.addEventListener('click', () => this.addQueryPaneDOM());\t    \r\n\t\tc.appendChild(newPaneButton);\r\n\t\tvar newScriptButton = document.createElement('button');\r\n\t\tnewScriptButton.setAttribute('class', 'terminus-btn terminus-query-btn');\r\n\t\tnewScriptButton.appendChild(document.createTextNode('Script'));\r\n\t\t//newScriptButton.addEventListener('click', () => this.addScriptPaneDOM());\t    \r\n\t\tc.appendChild(newScriptButton);\r\n\t\tvar newDocButton = document.createElement('button');\r\n\t\tnewDocButton.setAttribute('class', 'terminus-btn terminus-query-btn');\r\n\t\tnewDocButton.appendChild(document.createTextNode('Document Query'));\r\n\t\tnewDocButton.addEventListener('click', () => this.setNewDocumentPaneDOM());\t    \r\n\t\tc.appendChild(newDocButton);\r\n\t}\r\n\telse {\r\n\t\tvar savePaneButton = document.createElement('button');\r\n\t\tsavePaneButton.setAttribute('class', 'terminus-btn terminus-query-btn');\r\n\t\tsavePaneButton.appendChild(document.createTextNode('Save'));\r\n\t\tc.appendChild(savePaneButton);\r\n\t\tvar closePaneButton = document.createElement('button');\r\n\t\tclosePaneButton.setAttribute('class', 'terminus-btn terminus-query-btn');\r\n\t\tclosePaneButton.appendChild(document.createTextNode('Close'));\r\n\t\tc.appendChild(closePaneButton);\r\n\t\tvar collapsePaneButton = document.createElement('button');\r\n\t\tcollapsePaneButton.setAttribute('class', 'terminus-btn terminus-query-btn');\r\n\t\tcollapsePaneButton.appendChild(document.createTextNode('Collapse'));\t\t\r\n\t\tc.appendChild(collapsePaneButton);\r\n\t}\r\n\treturn c;\r\n}\r\n\r\n\r\nmodule.exports=TerminusQueryViewer\r\n","const TerminusClient = require('@terminusdb/terminus-client');\r\nconst TerminusCodeSnippet = require('./query/TerminusCodeSnippet');\r\nconst UTILS = require('../Utils');\r\n\r\nfunction ScriptPane(client, script){\r\n\tthis.client = client;\r\n\tthis.script = (script ? script : \"\");\r\n\tthis.container = document.createElement('div');\r\n    this.container.setAttribute('class', 'terminus-script-pane-cont');\r\n}\r\n\r\nScriptPane.prototype.empty = function(){\r\n\treturn this.script == \"\";\r\n}\r\n\r\n\r\nScriptPane.prototype.createInput = function(ui){\r\n\tlet input = new TerminusCodeSnippet(\"code\", \"edit\");\r\n\tif(this.script){\r\n\t\tinput.setQuery(this.script);\r\n\t}\r\n\tvar self = this;\r\n\tinput.submit = function(qObj){\r\n\t\tself.executeScript(qObj, ui);\r\n\t};\r\n\treturn input;\r\n}\r\n\r\n\r\nScriptPane.prototype.executeScript = function(script, ui){\r\n    if(ui) ui.clearMessages();\r\n    this.script = script;\r\n\tvar client = this.client;\r\n\tvar WOQL = TerminusClient.WOQL;\r\n\ttry {\r\n\t\tvar res = eval(script);\r\n\t\tif(res){\r\n\t\t\tthis.updateResult(res);\r\n\t\t}\r\n\t\telse {\r\n\t\t\t//executed ok message \r\n\t\t}\r\n\t}\r\n\tcatch(e){\r\n\t\tif(ui) ui.showError(e);\r\n\t\tconsole.error(e);\r\n\t}\r\n}\r\n\r\nScriptPane.prototype.showOKMessage = function(){\r\n    var msg = document.createTextNode(\"Script executed ok\");\r\n    this.updateResult(msg);\r\n}\r\n\r\nScriptPane.prototype.updateResult = function(res){\r\n    TerminusClient.FrameHelper.removeChildren(this.resultDOM);\r\n    this.resultDOM.appendChild(res);\r\n}\r\n\r\n\r\nScriptPane.prototype.getAsDOM = function(ui){\r\n\tthis.container.appendChild(UTILS.getHeaderDom('Enter Script'));\r\n\tthis.input = this.createInput(ui);\r\n\tthis.container.appendChild(this.input.getAsDOM());\r\n\tthis.resultDOM = document.createElement(\"div\");\r\n\tthis.resultDOM.setAttribute(\"class\", \"terminus-script-results\"); \r\n\t//var form = (this.input.format == \"js\" ? \"javascript\" : \"json\");\r\n\t//UTILS.stylizeEditor(ui, this.input.snippet, {width: this.input.width, height: this.input.height}, form);\r\n\tif(this.result){\r\n        this.resultDOM.appendChild(this.result);\r\n    }\r\n\tthis.container.appendChild(this.resultDOM);\r\n\treturn this.container;\r\n}\r\n\r\n\r\nmodule.exports = ScriptPane;\r\n","/*\r\n * Draws the screen for viewing and updating the schema\r\n * and provides wrappers around the client's schema API\r\n */\r\nconst TerminusClassChooser = require('./client/TerminusClassChooser');\r\nconst TerminusDocumentViewer = require('./TerminusDocument');\r\nconst TerminusHTMLViewer = require('./html/TerminusHTMLViewer');\r\nconst UTILS=require('./Utils')\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nfunction TerminusSchemaViewer(ui){\r\n\tthis.ui = ui;\r\n\tthis.mode = \"view\";\r\n\tthis.format = \"turtle\";\r\n\tthis.confirm_before_update = false;\r\n\tthis.thv = new TerminusHTMLViewer(this.ui.client);\r\n\tlet WOQL = TerminusClient.WOQL;\r\n\tthis.woql = WOQL;\r\n}\r\n\r\nTerminusSchemaViewer.prototype.changeHeaders = function() {\r\n\tvar table = this.woql.table();\r\n\ttable.column('Comment').header('Description');\r\n\treturn table;\r\n}\r\n\r\nTerminusSchemaViewer.prototype.setGraphSize = function(){\r\n\tvar graph = this.woql.graph();\r\n\tgraph.source(\"v:Subject\");\r\n\tvar licon2 = { color: [255,255,25], weight: 100, unicode: \"\\uf2bb\", size:2 };\r\n\tgraph.edge(\"v:Subject\", \"v:Object\").icon(licon2);\r\n\tgraph.width(1223);\r\n\treturn graph;\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getOWLView = function(){\r\n\tthis.mode = 'view'; // reset mode\r\n\tthis.loadSchema();\r\n}\r\n\r\nTerminusSchemaViewer.prototype.appendRuleViews = function(){\r\n\tthis.view.appendChild(UTILS.getHeaderDom('Classes'));\r\n\tthis.appendClassViews(this.woql.table());\r\n\tthis.appendClassViews(this.woql.graph());\r\n\tthis.view.appendChild(UTILS.getHeaderDom('Properties'));\r\n\tthis.appendPropertyViews(this.woql.table());\r\n\tthis.appendPropertyViews(this.woql.graph());\r\n}\r\n\r\nTerminusSchemaViewer.prototype.appendPropertyViews = function(config){\r\n\tthis.qprops.first();\r\n\tvar n = this.thv.showResult(this.qprops, config, false);\r\n\tthis.view.appendChild(n);\r\n}\r\n\r\nTerminusSchemaViewer.prototype.appendClassViews = function(config){\r\n\tthis.qclasses.first();\r\n\tvar n = this.thv.showResult(this.qclasses, config, false);\r\n\tthis.view.appendChild(n);\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getAllProperties = function(){\r\n\tlet query = this.woql.from(this.ui.client.connectionConfig.dbURL())\r\n\t\t\t\t\t\t .limit(25)\r\n\t\t\t\t\t\t .start(0)\r\n\t\t\t\t\t\t .propertyMetadata();\r\n    var self = this;\r\n    query.execute(this.ui.client).then((results) => {\r\n\t\tlet qres = new TerminusClient.WOQLResult(results, query);\r\n\t\tself.qprops = qres;\r\n\t\tthis.view.appendChild(UTILS.getHeaderDom('Table & Graph View of Properties'));\r\n\t\tvar table = self.changeHeaders();\r\n\t\tvar graph = self. setGraphSize();\r\n\t\tself.appendPropertyViews(table);\r\n\t\tself.appendPropertyViews(graph);\r\n\t})\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getAllClasses = function(){\r\n\tlet query = this.woql.from(this.ui.client.connectionConfig.dbURL())\r\n\t\t\t\t\t\t .limit(25)\r\n\t\t\t\t\t\t .start(0)\r\n\t\t\t\t\t\t .classMetadata();\r\n    var self = this;\r\n    query.execute(this.ui.client).then((results) => {\r\n\t\tlet qres = new TerminusClient.WOQLResult(results, query);\r\n\t\tself.qclasses = qres;\r\n\t\tself.view.appendChild(UTILS.getHeaderDom('Table & Graph View of Classes'));\r\n\t\tvar table = self.changeHeaders();\r\n\t\tvar graph = self. setGraphSize();\r\n\t\tself.appendClassViews(table);\r\n\t\tself.appendClassViews(graph);\r\n\t})\r\n}\r\n\r\nTerminusSchemaViewer.prototype.defineViewAction = function(a, view){\r\n\tTerminusClient.FrameHelper.removeChildren(this.view);\r\n\tUTILS.setSelectedSubMenu(a);\r\n\tswitch(view){\r\n\t\tcase 'table':\r\n\t\t\tthis.appendRuleViews();\r\n\t\tbreak;\r\n\t\tcase 'owl':\r\n\t\t\tthis.getOWLView();\r\n\t\tbreak;\r\n\t\tdefault:\r\n\t\t\tconsole.log('Invalid view passed in TerminusSchema.js')\r\n\t\tbreak;\r\n\t}\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getTabs = function(view){\r\n\tvar a = document.createElement('a');\r\n    a.setAttribute('class', 'terminus-a terminus-hz-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\r\n    //if(navConfig.defaultSelected) a.classList.add('terminus-selected');\r\n    var self = this;\r\n    a.addEventListener(\"click\", function(){\r\n        self.defineViewAction(this, view);\r\n    })\r\n\tif(view == 'owl')\r\n\t\tvar t = view.toUpperCase();\r\n\telse var t = view.charAt(0).toUpperCase() + view.slice(1)\r\n\ta.appendChild(document.createTextNode(t + ' View'));\r\n    return a;\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getSchemaViews = function(){\r\n\tvar ul = document.createElement('ul');\r\n    ul.setAttribute('class', 'terminus-ul-horizontal');\r\n\tvar tview = this.getTabs('table');\r\n\ttview.classList.add('terminus-submenu-selected'); // default view is table\r\n\tul.appendChild(tview);\r\n\tul.appendChild(this.getTabs('owl'));\r\n\tthis.controldom.appendChild(ul);\r\n\tthis.getAllClasses();\r\n\tthis.getAllProperties();\r\n}\r\n\r\n/*\r\n * Retrieves schema from API and writes the response into the page\r\n */\r\nTerminusSchemaViewer.prototype.getAsDOM = function(){\r\n\tthis.holder = document.createElement(\"div\");\r\n\tthis.controldom = document.createElement(\"div\");\r\n\tthis.controldom.setAttribute(\"class\", \"terminus-schema-controls\");\r\n\tthis.view = document.createElement(\"div\");\r\n\tthis.view.setAttribute(\"class\", \"terminus-schema-view\");\r\n\tthis.getSchemaViews();\r\n\tthis.pagedom = document.createElement(\"div\");\r\n\tthis.pagedom.setAttribute(\"class\", \"terminus-schema-viewer\");\r\n\t//this.loadSchema();\r\n\tthis.holder.appendChild(this.controldom);\r\n\tthis.controldom.appendChild(this.view);\r\n\tthis.holder.appendChild(this.pagedom);\r\n\treturn this.holder;\r\n}\r\n\r\nTerminusSchemaViewer.prototype.loadSchema = function(msg, msgtype){\r\n\tvar self = this;\r\n\tthis.ui.showBusy(\"Fetching Database Schema\");\r\n\tthis.ui.client.getSchema(false, {\"terminus:encoding\": \"terminus:\" + this.format})\r\n\t.then(function(response){\r\n\t\tself.ui.clearBusy();\r\n\t\tself.schema = response;\r\n\t\tself.refreshPage(msg, msgtype);\r\n\t})\r\n\t.catch(function(error){\r\n\t\tself.ui.clearBusy();\r\n\t\tself.ui.showError(error);\r\n\t});\r\n}\r\n\r\nTerminusSchemaViewer.prototype.resetControlDOM = function(){\r\n\tTerminusClient.FrameHelper.removeChildren(this.view);\r\n\tif(this.mode == \"edit\"){\r\n\t\tthis.view.appendChild(this.getSchemaSaveButtons());\r\n\t}\r\n\telse if(this.mode == \"import\"){\r\n\t\tthis.view.appendChild(this.getSchemaImportActionButtons());\r\n\t}\r\n\telse if(this.mode == \"class_frame\"){\r\n\t\tif(this.ui.showControl(\"get_schema\")){\r\n\t\t\tthis.view.appendChild(this.getShowSchemaButton());\r\n\t\t}\r\n\t\tif(this.ui.showControl(\"class_frame\")){\r\n\t\t\tthis.view.appendChild(this.getClassFrameChooser());\r\n\t\t}\r\n\t}\r\n\telse if(this.mode == \"view\"){\r\n\t\tif(this.ui.showControl(\"update_schema\")){\r\n\t\t\tthis.view.appendChild(this.getSchemaEditButton());\r\n\t\t}\r\n\t\tif(this.ui.showControl(\"import_schema\")){\r\n\t\t\tthis.view.appendChild(this.getImportButton());\r\n\t\t}\r\n\t\tif(this.ui.showControl(\"add_new_library\")){\r\n\t\t\tthis.view.appendChild(this.getNewLibaryButton());\r\n\t\t}\r\n\t\tif(this.ui.showControl(\"class_frame\")){\r\n\t\t\tthis.view.appendChild(this.getClassFrameChooser());\r\n\t\t}\r\n\t}\r\n}\r\n/*\r\nTerminusSchemaViewer.prototype.getFormatChoices = function(){\r\n\tvar fc = document.createElement(\"select\");\r\n\tfc.setAttribute(\"class\", \"terminus-form-select terminus-schema-format terminus-type-select\");\r\n\tvar tc = document.createElement(\"option\");\r\n\ttc.setAttribute(\"class\", \"terminus-schema-turtle\");\r\n\ttc.value = \"turtle\";\r\n\ttc.appendChild(document.createTextNode(\"Turtle\"));\r\n\tif(this.format == \"turtle\") tc.selected = true;\r\n\tfc.appendChild(tc);\r\n\tvar tj = document.createElement(\"option\");\r\n\ttj.setAttribute(\"class\", \"terminus-schema-jsonld\");\r\n\ttj.value = \"jsonld\";\r\n\ttj.appendChild(document.createTextNode(\"Json LD\"));\r\n\tif(this.format == \"jsonld\") tj.selected = true;\r\n\tfc.appendChild(tj);\r\n\tvar self = this;\r\n\tfc.addEventListener(\"change\", function(e){\r\n\t\tself.format = this.value;\r\n\t\tself.loadSchema();\r\n\t});\r\n\treturn fc;\r\n}\r\n*/\r\n\r\nTerminusSchemaViewer.prototype.refreshPage = function(msg, msgtype){\r\n\tif(this.view) {\r\n\t\tthis.resetControlDOM();\r\n\t\tthis.refreshMainPage(msg, msgtype);\r\n\t}\r\n\t/*if(this.controldom)\tthis.resetControlDOM();\r\n\tif(this.pagedom) this.refreshMainPage(msg, msgtype);*/\r\n}\r\n\r\nTerminusSchemaViewer.prototype.refreshMainPage = function(msg, msgtype){\r\n\tTerminusClient.FrameHelper.removeChildren(this.pagedom);\r\n\tif(this.mode == 'view'){\r\n\t\tthis.view.appendChild(this.getSchemaViewDOM());\r\n\t}\r\n\telse if(this.mode == \"edit\"){\r\n\t\tthis.view.appendChild(this.getSchemaEditDOM());\r\n\t}\r\n\telse if(this.mode == \"import\"){\r\n\t\tthis.view.appendChild(this.getSchemaImportDOM());\r\n\t}\r\n\telse if(this.mode == \"class_frame\"){\r\n\t\tthis.view.appendChild(this.getClassFrameDOM());\r\n\t}\r\n\tif(msg){\r\n\t\tthis.ui.showMessage(msg, msgtype);\r\n\t}\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getSchemaSaveButtons = function(){\r\n\tvar ssb = document.createElement(\"span\");\r\n\tssb.setAttribute(\"class\", \"terminus-schema-save-buttons\");\r\n\tssb.appendChild(this.getCancelButton());\r\n\tssb.appendChild(this.getSaveButton());\r\n\treturn ssb;\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getSchemaImportActionButtons = function(){\r\n\tvar ssb = document.createElement(\"span\");\r\n\tssb.setAttribute(\"class\", \"terminus-schema-import-buttons\");\r\n\tssb.appendChild(this.getCancelButton(true));\r\n\tssb.appendChild(this.getImportSaveButton());\r\n\treturn ssb;\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getShowSchemaButton = function(){\r\n\tvar self = this;\r\n\tvar func = function(){\r\n\t\tself.ui.clearMessages();\r\n\t\tself.mode = \"view\";\r\n\t\tself.refreshPage();\r\n\t}\r\n\treturn this.getSchemaButton(\"View Schema\", \"get_schema\", func);\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getImportPreviewButton = function(){\r\n\tvar self = this;\r\n\tvar func = function(){\r\n\t\tself.ui.clearMessages();\r\n\t\tself.mode = \"preview\";\r\n\t\tself.refreshPage();\r\n\t}\r\n\treturn this.getSchemaButton(\"Preview\", \"preview\", func);\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getCancelButton = function(is_import){\r\n\tvar self = this;\r\n\tvar func = function(){\r\n\t\tself.ui.clearMessages();\r\n\t\tself.mode = \"view\";\r\n\t\tif(is_import){\r\n\t\t\tself.ui.redraw();\r\n\t\t}\r\n\t\telse {\r\n\t\t\tself.refreshPage();\r\n\t\t}\r\n\t}\r\n\treturn this.getSchemaButton(\"Cancel\", \"cancel_update\", func);\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getImportSaveButton = function(){\r\n\tvar self = this;\r\n\tvar func = function(){\r\n\t\tself.ui.clearMessages();\r\n\t\tif(typeof self.doImport == \"function\"){\r\n\t\t\tself.doImport();\r\n\t\t}\r\n\t}\r\n\treturn this.getSchemaButton(\"Import\", \"import_schema\", func)\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getSaveButton = function(){\r\n\tvar self = this;\r\n\tvar func = function(){\r\n\t\tself.ui.clearMessages();\r\n\t\tvar text = self.schema_edit_dom.value;\r\n\t\tif(typeof(self.schema) == \"object\"){\r\n\t\t\ttext = JSON.parse(text);\r\n\t\t}\r\n\t\tvar opts = {};\r\n\t\topts['terminus:encoding'] =  'terminus:' + self.format;\r\n\t\tif(!(TerminusClient.FrameHelper.empty(self.schema_edit_dom_name)))\r\n\t\t\topts['schemaId'] = self.ui.client.connectionConfig.dbURL() + '/' + self.schema_edit_dom_name.value;\r\n\t\telse opts['schemaId'] = self.ui.client.connectionConfig.dbURL() + '/' + 'schema';\r\n\t\treturn self.updateSchema(text, opts);\r\n\t}\r\n\treturn this.getSchemaButton(\"Save\", \"update_schema\", func);\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getSchemaEditButton = function(){\r\n\tvar self = this;\r\n\tvar func = function(){\r\n\t\tself.mode = \"edit\";\r\n\t\tself.refreshPage();\r\n\t}\r\n\treturn this.getSchemaButton(\"Edit\", \"update_schema\", func);\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getNewLibaryButton = function(){  //add_new_library\r\n\tvar self = this;\r\n\tvar func = function(){\r\n\t\tself.ui.clearMessages();\r\n\t\tself.mode = \"edit\";\r\n\t\tself.refreshPage();\r\n\t}\r\n\treturn this.getSchemaButton(\"New Library\", \"add_new_library\", func);\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getImportButton = function(){\r\n\tvar self = this;\r\n\tvar func = function(){\r\n\t\tself.ui.clearMessages();\r\n\t\tself.mode = \"import\";\r\n\t\tself.refreshPage();\r\n\t}\r\n\treturn this.getSchemaButton(\"Import New Schema\", \"import_schema\", func);\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getSchemaButton = function(label, action, func){\r\n\tvar opt = document.createElement(\"button\");\r\n\topt.appendChild(document.createTextNode(label));\r\n\topt.setAttribute(\"class\", \"terminus-btn terminus-control-button terminus-schema-\" + action);\r\n\topt.addEventListener(\"click\", func);\r\n\treturn opt;\r\n}\r\n\r\n/*\r\n * Updates schema, then fetches updated version and updates the page with it\r\n */\r\nTerminusSchemaViewer.prototype.updateSchema  = function(text, opts) {\r\n\tthis.ui.showBusy(\"Updating Database Schema\");\r\n\tvar self = this;\r\n\treturn this.ui.client.updateSchema(false, text, opts)\r\n\t.then(function(response){\r\n\t\tif(response['terminus:status'] && response['terminus:status'] == \"terminus:success\"){\r\n\t\t\tself.ui.showBusy(\"Retrieving updated schema\");\r\n\t\t\tself.mode = \"view\";\r\n\t\t\tself.loadSchema(\"Successfully Updated Schema\");\r\n\t\t\tself.ui.redraw();\r\n\t\t}\r\n\t\telse if(response['terminus:status'] && response['terminus:status'] == \"terminus:failure\"){\r\n\t\t\tself.ui.clearBusy();\r\n\t\t\tself.ui.showViolations(response['terminus:witnesses'], \"schema\");\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthrow new Error(\"Update Schema returned no terminus:status code\");\r\n\t\t}\r\n\t})\r\n\t.catch(function(error){\r\n\t\tself.ui.clearBusy();\r\n\t\tif(error.data && error.data['terminus:witnesses']){\r\n\t\t\tself.ui.showViolations(error.data['terminus:witnesses'], \"schema\");\r\n\t\t}\r\n\t\telse {\r\n\t\t\tself.ui.showError(error);\r\n\t\t}\r\n\t});\r\n}\r\n\r\n/*\r\n * Imports a schema from the passed url\r\n * mode: replace | append\r\n */\r\nTerminusSchemaViewer.prototype.load  = function(url, key, mode){\r\n\tvar self = this;\r\n\tmode = (mode ? mode : \"replace\");\r\n\tthis.ui.showBusy(\"Loading schema from \" + url);\r\n\tvar origurl = this.ui.client.connectionConfig.schemaURL();\r\n\treturn this.ui.client.getSchema(url, {\"terminus:user_key\": key, \"terminus:encoding\" : \"terminus:\" + this.format})\r\n\t.then(function(response){\r\n\t\tvar newschema = (mode == \"append\") ? self.appendSchema(response) : response;\r\n\t\tif(self.confirm_before_update){\r\n\t\t\t//reconnect to original db\r\n\t\t\tself.ui.showResult(\"Schema retrieved - click save to deploy\");\r\n\t\t\tself.ui.client.connectionConfig.setSchemaURL(origurl);\r\n\t\t\tself.showConfirmPage(newschema);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tself.ui.showBusy(\"Updating schema\");\r\n\t\t\tself.ui.client.connectionConfig.setSchemaURL(origurl);\r\n\t\t\tself.updateSchema(newschema, {\"terminus:encoding\": \"terminus:\" + self.format}).then(function(response){\r\n\t\t\t\tself.mode = \"view\";\r\n\t\t\t\tself.ui.clearBusy();\r\n\t\t\t\tself.ui.redraw();\r\n\t\t\t\tself.ui.showResult(\"Successfully deployed new schema from \" + url);\r\n\t\t\t\treturn response;\r\n\t\t\t});\r\n\t\t}\r\n\t}).catch(function(error){\r\n\t\tself.ui.clearBusy();\r\n\t\tself.ui.showError(error);\r\n\t});\r\n}\r\n\r\nTerminusSchemaViewer.prototype.appendSchema = function(s2){\r\n\tvar nschema = this.schema;\r\n\tif(this.format == 'turtle'){\r\n\t\tnschema = this.schema + s2;\r\n\t}\r\n\telse if(this.format == 'jsonld'){\r\n\t\tfor(var i in s2){\r\n\t\t\tnschema[i] = s2[i];\r\n\t\t}\r\n\t}\r\n\treturn nschema;\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getClassFrameChooser = function(){\r\n\tvar np = document.createElement(\"span\");\r\n\tnp.setAttribute(\"class\", \"terminus-class frame-chooser\");\r\n\tvar termcc = new TerminusClassChooser(this.ui);\r\n\ttermcc.empty_choice = \"View Individual Class Frames\";\r\n\tvar self = this;\r\n\ttermcc.change = function(new_class){\r\n\t\tif(new_class){\r\n\t\t\tself.cls = new_class;\r\n\t\t\tif(self.mode != \"class_frame\"){\r\n\t\t\t\tself.mode = \"class_frame\";\r\n\t\t\t\tself.refreshPage();\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tself.refreshMainPage();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tvar tcdom = termcc.getAsDOM();\r\n\tnp.appendChild(tcdom);\r\n\treturn np;\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getClassFrameDOM = function(){\r\n\tvar np = document.createElement(\"div\");\r\n\tnp.setAttribute(\"class\", \"terminus-schema-page terminus-schema-classframe-page\");\r\n\tvar docviewer = new TerminusDocumentViewer(this.ui, \"model\");\r\n\tdocviewer.loadCreateDocument(this.cls);\r\n\tdocviewer.page_config = \"model\";\r\n\tnp.appendChild(docviewer.getAsDOM());\r\n\treturn np;\r\n}\r\n\r\nTerminusSchemaViewer.prototype.showConfirmPage = function(newschema){\r\n\tthis.schema = newschema;\r\n\tthis.confirm_before_update = false;\r\n\tthis.mode = \"edit\";\r\n\tthis.refreshPage(\"Confirm new schema\");\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getSchemaNameInputDOM = function(np){\r\n\tvar label = document.createElement('label');\r\n    label.setAttribute('class', 'terminus-control-label');\r\n\tlabel.setAttribute('for', 'basicinput');\r\n    label.appendChild(document.createTextNode('Schema name:'));\r\n\tvar sid = document.createElement('input');\r\n\tsid.setAttribute('class', 'terminus-input-text terminus-schema-id-display');\r\n\tsid.setAttribute('placeholder', 'Enter schema name');\r\n\tnp.appendChild(label);\r\n\tnp.appendChild(sid);\r\n\treturn sid;\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getSchemaEditDOM = function(){\r\n\tvar np = document.createElement(\"div\");\r\n\tnp.setAttribute(\"class\", \"terminus-schema-page terminus-schema-edit-page\");\r\n\tif(this.ui.showControl(\"add_new_library\")) var sid = this.getSchemaNameInputDOM(np);\r\n\tvar ipval = document.createElement(\"textarea\");\r\n\tipval.setAttribute(\"class\", \"terminus-schema-edit terminus-schema-textarea\");\r\n\tipval.setAttribute(\"width\", \"100%\");\r\n\tipval.setAttribute(\"style\", \"min-width: 400px; min-height: 400px;\");\r\n\tif(typeof(this.schema) == \"string\"){\r\n\t\tipval.innerHTML = this.schema;\r\n\t}\r\n\telse if(typeof (this.schema) == \"object\") {\r\n\t\tipval.innerHTML = JSON.stringify(this.schema, 0, 4);\r\n\t}\r\n\tif(this.ui.showControl(\"add_new_library\")) this.schema_edit_dom_name = sid;\r\n\tthis.schema_edit_dom = ipval;\r\n\tnp.appendChild(ipval);\r\n\tUTILS.stylizeEditor(this.ui, ipval, 'schema', 'turtle');\r\n\treturn np;\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getSchemaViewDOM = function(){\r\n\tvar self = this;\r\n\tvar np = document.createElement(\"div\");\r\n\tnp.setAttribute(\"class\", \"terminus-schema-page terminus-schema-view-page\");\r\n\tvar ipval = document.createElement(\"pre\");\r\n\tipval.setAttribute(\"class\", \"terminus-schema-view terminus-scheme-pre\");\r\n\tif(typeof(this.schema) == \"string\"){\r\n\t\tvar txt = this.schema.replace(/&/g, \"&amp;\")\r\n         .replace(/</g, \"&lt;\")\r\n         .replace(/>/g, \"&gt;\")\r\n         .replace(/\"/g, \"&quot;\")\r\n         .replace(/'/g, \"&#039;\");\r\n\t\tipval.innerHTML = txt;\r\n\t}\r\n\telse if(typeof (this.schema) == \"object\") {\r\n\t\tipval.innerHTML = JSON.stringify(this.schema, 0, 4);\r\n\t}\r\n\tvar cm = UTILS.stylizeCodeDisplay(this.ui, ipval, np, 'turtle');\r\n\tif(!cm) np.appendChild(ipval);\r\n\treturn np;\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getSchemaImportDOM = function(){\r\n\tvar scd = document.createElement(\"div\");\r\n\tscd.setAttribute(\"class\", \"terminus-form-border terminus-schema-page terminus-schema-import-page\");\r\n\r\n\r\n\tvar sci = document.createElement(\"div\");\r\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-form-field-spacing terminus-form-horizontal terminus-control-group\");\r\n\tvar slab = document.createElement(\"span\");\r\n\tslab.setAttribute(\"class\", \"terminus-url-loader-input terminus-form-label terminus-control-label\");\r\n\tslab.appendChild(document.createTextNode(\"URL\"));\r\n\tsci.appendChild(slab);\r\n\tvar inpUrl  = document.createElement(\"input\");\r\n\tinpUrl.setAttribute(\"type\", \"text\");\r\n\tinpUrl.setAttribute(\"class\", \"terminus-form-value terminus-input-text terminus-form-url terminus-url-connect\");\r\n\tinpUrl.setAttribute(\"placeholder\", \"Enter URL of DB to import from\");\r\n\tsci.appendChild(inpUrl);\r\n\tscd.appendChild(sci);\r\n\r\n\tvar sci = document.createElement(\"div\");\r\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-form-field-spacing terminus-form-horizontal terminus-control-group\");\r\n\tvar klab = document.createElement(\"span\");\r\n\tklab.setAttribute(\"class\", \"terminus-url-loader-input terminus-form-label  terminus-control-label terminus-import_mode-input\");\r\n\tklab.appendChild(document.createTextNode(\"Import Mode\"));\r\n\tsci.appendChild(klab);\r\n\tvar modes = document.createElement(\"select\");\r\n\tmodes.setAttribute(\"class\", \"terminus-form-select\");\r\n\r\n\tvar overwrite = document.createElement(\"option\");\r\n\toverwrite.value = \"replace\";\r\n\toverwrite.appendChild(document.createTextNode(\"Replace Mode\"))\r\n\tmodes.appendChild(overwrite);\r\n\tvar append = document.createElement(\"option\");\r\n\tappend.value = \"append\";\r\n\tappend.appendChild(document.createTextNode(\"Append Mode\"))\r\n\tmodes.appendChild(append);\r\n\tmodes.setAttribute(\"class\", \"terminus-form-select terminus-import-mode\");\r\n\tsci.appendChild(klab);\r\n\tsci.appendChild(modes);\r\n\tscd.appendChild(sci);\r\n\r\n\tvar sci = document.createElement(\"div\");\r\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-form-field-spacing terminus-form-horizontal terminus-control-group\");\r\n\tvar klab = document.createElement(\"span\");\r\n\tklab.setAttribute(\"class\", \"terminus-form-label terminus-url-key-input terminus-control-label\");\r\n\tklab.appendChild(document.createTextNode(\"Key\"))\r\n\tvar key = document.createElement(\"input\");\r\n\tkey.setAttribute(\"type\", \"text\");\r\n\tkey.setAttribute(\"class\", \"terminus-form-value terminus-input-text terminus-url-key\");\r\n\tsci.appendChild(klab);\r\n\tsci.appendChild(key);\r\n\tscd.appendChild(sci);\r\n\tvar self = this;\r\n\tthis.doImport = function(){\r\n\t\tif(inpUrl.value){\r\n\t\t\tself.load(inpUrl.value, key.value, modes.value);\r\n\t\t}\r\n\t}\r\n\treturn scd;\r\n}\r\n\r\nmodule.exports=TerminusSchemaViewer\r\n","/*\r\n * Utility class which runs a query against the schema and presents the returned classes as a drop-down / class filter list\r\n */\r\n\r\nconst WOQLQuery = require('./WOQLQuery');\r\nconst HTMLFrameHelper = require('../html/HTMLFrameHelper');\r\nconst TerminusClient = require('@terminusdb/terminus-client');\r\n\r\nTerminusClassChooser = function(ui, filter, chosen){\r\n\tthis.ui = ui;\r\n\tthis.choice = (chosen ? chosen : false);\r\n\tthis.filter = filter;\r\n\tthis.show_single = true;\r\n}\r\n\r\nTerminusClassChooser.prototype.setRoot = function(root){\r\n\tthis.root = root;\r\n}\r\n\r\nTerminusClassChooser.prototype.setFilter = function(filter){\r\n\tthis.filter = filter;\r\n}\r\n\r\nTerminusClassChooser.prototype.change = function(cls){\r\n\talert(\"Need to specify class chooser function (\" + cls + \")\");\r\n}\r\n\r\nTerminusClassChooser.prototype.getAsDOM = function(style){\r\n\tvar ccdom = document.createElement(\"span\");\r\n\tccdom.setAttribute(\"class\", \"terminus-class-chooser\");\r\n\tvar ccsel = document.createElement(\"select\");\r\n\tccsel.setAttribute(\"class\", style + \" terminus-type-select terminus-class-select\");\r\n\t// ccsel.setAttribute(\"class\", \"terminus-class-select terminus-type-select terminus-query-select\");\r\n\tvar self = this;\r\n\tccsel.addEventListener(\"change\", function(){\r\n\t\tthis.choice = this.value;\r\n\t\tself.change(this.value);\r\n\t\tthis.value = \"\";\r\n\t});\r\n\tccdom.appendChild(ccsel);\r\n\tvar wq = TerminusClient.WOQL.query().classMetadata();\r\n\tvar self = this;\r\n\twq.execute(this.ui.client)\r\n\t.then(function(response){\r\n\t\tvar opts = self.getResultsAsOptions(response);\r\n\t\tif(opts){\r\n\t\t\tfor(var i = 0; i<opts.length; i++){\r\n\t\t\t\tccsel.appendChild(opts[i]);\r\n\t\t\t}\r\n\t\t\tself.options = opts;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tccdom.removeChild(ccsel);\r\n\t\t}\r\n\t});\r\n\treturn ccdom;\r\n}\r\n\r\nTerminusClassChooser.prototype.getResultsAsOptions = function(clist){\r\n\tvar choices = [];\r\n\tif(clist.bindings){\r\n\t\tif(this.show_single == false && clist.bindings.length < 2) return false;\r\n\t\tif(this.empty_choice){\r\n\t\t\tvar opt1 = document.createElement(\"option\");\r\n\t\t\topt1.setAttribute(\"class\", \"terminus-class-choice terminus-empty-choice\");\r\n\t\t\topt1.value = \"\";\r\n\t\t\topt1.appendChild(document.createTextNode(this.empty_choice));\r\n\t\t\tchoices.push(opt1);\r\n\t\t}\r\n\t\tvar added = [];\r\n\t\tfor(var i = 0; i<clist.bindings.length; i++){\r\n\t\t\tvar bclass = HTMLFrameHelper.getVariableValueFromBinding(\"Element\", clist.bindings[i]);\r\n\t\t\tif(!bclass) bclass = HTMLFrameHelper.getVariableValueFromBinding(\"Class\", clist.bindings[i]);\r\n\t\t\tif(bclass && added.indexOf(bclass) == -1){\r\n\t\t\t\tadded.push(bclass);\r\n\t\t\t\tvar opt = document.createElement(\"option\");\r\n\t\t\t\topt.setAttribute(\"class\", \"terminus-class-choice\");\r\n\t\t\t\topt.value = bclass;\r\n\t\t\t\tif(opt.value == this.choice){\r\n\t\t\t\t\topt.selected = true;\r\n\t\t\t\t}\r\n\t\t\t\tvar lab = HTMLFrameHelper.getVariableValueFromBinding(\"Label\", clist.bindings[i]);\r\n\t\t\t\tif(!lab || lab == \"unknown\"){\r\n\r\n\t\t\t\t\tlab = TerminusClient.FrameHelper.labelFromURL(bclass);\r\n\r\n\t\t\t\t}\r\n\t\t\t\tif(lab[\"@value\"]) lab = lab[\"@value\"];\r\n\t\t\t\topt.appendChild(document.createTextNode(lab));\r\n\t\t\t\tchoices.push(opt);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn choices;\r\n}\r\n\r\n\r\n\r\nmodule.exports=TerminusClassChooser\r\n","const TerminusClient = require('@terminusdb/terminus-client');\r\nconst WOQLRule = require(\"../viewer/WOQLRule\");\r\nconst WOQLTable = require(\"../viewer/WOQLTable\");\r\nconst WOQLChooser = require(\"../viewer/WOQLChooser\");\r\n//const WOQLQueryViewer = require(\"./viewer/WOQLQueryView\");\r\nconst WOQLGraph = require(\"../viewer/WOQLGraph\");\r\nconst WOQLStream = require(\"../viewer/WOQLStream\");\r\nconst TerminusFrame = require(\"../viewer/TerminusFrame\");\r\nconst Datatypes = require(\"./Datatypes\");\r\nconst SimpleTable = require(\"./table/SimpleTable\");\r\nconst SimpleGraph = require(\"./graph/SimpleGraph\");\r\nconst SimpleStream = require(\"./stream/SimpleStream\");\r\n//const SimpleTextbox = require(\"./html/query/SimpleTextbox\");\r\nconst SimpleChooser = require(\"./chooser/SimpleChooser\");\r\nconst SimpleDocument = require(\"./document/SimpleDocument\");\r\nconst DocumentTable = require(\"./document/DocumentTable\");\r\nconst SimpleFrameViewer = require(\"./document/SimpleFrameViewer\");\r\nconst HTMLObjectViewer = require(\"./document/ObjectViewer\");\r\nconst HTMLPropertyViewer = require(\"./document/PropertyViewer\");\r\nconst HTMLDataViewer = require(\"./document/DataViewer\");\r\nconst TerminusCodeSnippet = require('./query/TerminusCodeSnippet');\r\nconst UTILS = require('../Utils');\r\n\r\n/**\r\n * Provides access to the two basic HTML views supported by the system:\r\n * QueryPane(, [rvs])\r\n * DocumentPane(qeditor, [rvs])\r\n * ScriptPane(seditor, sv)\r\n */\r\n\r\n\r\nfunction TerminusHTMLViewer(client){\r\n\tthis.client = client;\r\n}\r\n\r\nTerminusHTMLViewer.prototype.setRenderers = function(config){\r\n}\r\n\r\nTerminusHTMLViewer.prototype.getEditor = function(width, height, placeholder){\r\n    var woql = TerminusClient.WOQL;\r\n\tvar tcs = new TerminusCodeSnippet({}, width, height, placeholder, this.mode);\r\n\tvar snippet = tcs.getAsDOM();\r\n\tvar dimensions = {};\r\n\tdimensions.width = width;\r\n\tdimensions.height = height;\r\n\tUTILS.stylizeEditor(this.ui, snippet.snippetText, dimensions, 'javascript');\r\n\treturn snippet;\r\n}\r\n\r\nTerminusHTMLViewer.prototype.showConfigEditor = function(result, config, span){\r\n    var cSnippet = this.getEditor(300, 250,\r\n                        JSON.stringify(config, undefined, 2));\r\n    var self = this;\r\n    cSnippet.actionButton.addEventListener('click', function(){\r\n        try{\r\n            //self.submitConfigRules(woql, cSnippet, qSnippet, rSnippet);\r\n\t\t\tvar cObj = UTILS.getqObjFromInput(cSnippet.snippetText.value);\r\n\t\t\tTerminusClient.FrameHelper.removeChildren(span);\r\n\t\t\tspan.appendChild(self.showResult(result, cObj));\r\n        }\r\n        catch(e){\r\n            //self.ui.showError('Error in config editor: ' + e);\r\n\t\t\tconsole.log('Error in config editor: ' + e);\r\n        }\r\n    })\r\n    return cSnippet;\r\n}\r\n\r\nTerminusHTMLViewer.prototype.submitConfig = function(result, config, span, cdom){\r\n\tvar cSnippet = this.showConfigEditor(result, config, span);\r\n\tcdom.appendChild(cSnippet.dom);\r\n}\r\n\r\nTerminusHTMLViewer.prototype.showConfig = function(result, config, span, cdom){\r\n\tvar cbtn = document.createElement('button');\r\n    //cbtn.setAttribute('style', 'margin-top: 10px;');\r\n    cbtn.setAttribute('class', 'terminus-btn terminus-query-config-btn');\r\n    cbtn.appendChild(document.createTextNode('Config'));\r\n    //rSnippet.dom.appendChild(cbtn);\r\n    //qSnippet.dom.appendChild(cbtn);\r\n    var self = this;\r\n    cbtn.addEventListener('click', function(){\r\n\t\tTerminusClient.FrameHelper.removeChildren(cdom);\r\n        self.submitConfig(result, config, span, cdom);\r\n    })\r\n    return cbtn;\r\n}\r\n\r\nTerminusHTMLViewer.prototype.showResult = function(result, config, cDisplay){\r\n\tlet span = document.createElement(\"span\");\r\n\tspan.setAttribute(\"class\", \"terminus-query-results\");\r\n\tresult.first();\r\n\tlet renderers = {\r\n\t\ttable: new SimpleTable(),\r\n\t\tgraph: new SimpleGraph(),\r\n\t\tstream: new SimpleStream(),\r\n\t\tchooser: new SimpleChooser()\r\n\t}\r\n\tlet viewer = config.create(this.client, renderers, Datatypes.initialiseDataRenderers);\r\n\tviewer.setResult(result);\r\n\tspan.appendChild(viewer.render());\r\n\tvar cdom = document.createElement('div');\r\n\tspan.appendChild(cdom);\r\n\tif(cDisplay) span.appendChild(this.showConfig(result, config, span, cdom));\r\n\treturn span;\r\n}\r\n\r\nTerminusHTMLViewer.prototype.displayResults = function(query, config){\r\n\tlet span = document.createElement(\"span\");\r\n\tspan.setAttribute(\"class\", \"terminus-results\");\r\n\tlet renderers = {\r\n\t\t\ttable: new SimpleTable(),\r\n\t\t\tgraph: new SimpleGraph(),\r\n\t\t//\tstream: [new SimpleStream()],\r\n\t\t\tchoice: new SimpleChooser()\r\n\t}\r\n\tlet viewer = config.create(this.client, renderers, Datatypes.initialiseDataRenderers);\r\n\tif(query){\r\n\t\tthis.loadResults(query, viewer, function(){ span.appendChild(viewer.render()); })\r\n\t}\r\n\telse {\r\n\t\tif(this.last_result){\r\n\t\t\tviewer.setResult(this.last_result);\r\n\t\t\tspan.appendChild(viewer.render());\r\n\t\t}\r\n\t}\r\n\treturn span;\r\n}\r\n\r\nTerminusHTMLViewer.prototype.loadResults = function(query, viewer, then){\r\n\tvar self = this;\r\n\treturn query.execute(this.client).then((results) => {\r\n\t\tself.last_result = new TerminusClient.WOQLResult(results, query);\r\n\t\tviewer.setResult(self.last_result);\r\n\t\tconsole.log('self.last_result', self.last_result);\r\n\t});\r\n}\r\n\r\nTerminusHTMLViewer.prototype.table = function(query, config){\r\n\tvar span = document.createElement(\"span\");\r\n\tspan.setAttribute(\"class\", \"terminus-table\");\r\n\tvar wqt = new WOQLTable(this.client).options(config);\r\n\twqt.setDatatypes(Datatypes.initialiseDataRenderers);\r\n\twqt.setRenderer(new SimpleTable());\r\n\tquery.execute(this.client).then((results) => {\r\n\t\tvar result = new TerminusClient.WOQLResult(results, query);\r\n\t\twqt.setResult(result);\r\n\t\tspan.appendChild(wqt.render());\r\n\t});\r\n\treturn span;\r\n}\r\n\r\nTerminusHTMLViewer.prototype.stream = function(query, config){\r\n\tvar span = document.createElement(\"span\");\r\n\tspan.setAttribute(\"class\", \"terminus-stream\");\r\n\tvar wqt = new WOQLStream(this.client).options(config);\r\n\twqt.setDatatypes(Datatypes.initialiseDataRenderers);\r\n\treturn query.execute(this.client).then((results) => {\r\n\t\tvar result = new WOQLResult(results, query);\r\n\t\tspan.appendChild(wqt.render());\r\n\t});\r\n\treturn span;\r\n}\r\n\r\nTerminusHTMLViewer.prototype.woql = function(query, config){\r\n\tvar span = document.createElement(\"span\");\r\n\tspan.setAttribute(\"class\", \"terminus-woql\");\r\n\tvar wqt = new WOQLQueryViewer(this.client).options(config);\r\n\tspan.appendChild(wqt.render());\r\n\tif(query){\r\n\t\twqt.setQuery(query, true);\r\n\t}\r\n\treturn span;\r\n}\r\n\r\nTerminusHTMLViewer.prototype.ruleEditor = function(){\r\n\r\n}\r\n\r\nTerminusHTMLViewer.prototype.getAddRuleButton = function(cont){\r\n\tvar rbtn = document.createElement('button');\r\n\trbtn.appendChild(document.createTextNode('Add another rule'));\r\n\tvar self = this;\r\n\trbtn.addEventListener('click', function(){\r\n\t\t//self.QueryPane.addResultViewer(\"Choice\", wqc);\r\n\t\t//qp.addResultViewer(\"Choice\", wqc);\r\n\t\t//addResultViewer = function(label, rule, ruleviewer){\r\n\t})\r\n\tcont.appendChild(rbtn);\r\n}\r\n\r\nTerminusHTMLViewer.prototype.getConfigButton = function(cont){\r\n\tvar cbtn = document.createElement('button');\r\n\tcbtn.appendChild(document.createTextNode('Rule'));\r\n\tvar self = this;\r\n\tcbtn.addEventListener('click', function(){\r\n\t\tcont.appendChild(self.ruleEditor());\r\n\t\tself.getAddRuleButton(cont);\r\n\t})\r\n\tcont.appendChild(cbtn);\r\n}\r\n\r\nTerminusHTMLViewer.prototype.querypane = function(query, config){\r\n\tvar span = document.createElement(\"span\");\r\n\tspan.setAttribute(\"class\", \"terminus-woql-pane\");\r\n\tvar qp = new QueryPane(this.client, query);\r\n\tqp.options(config);\r\n\tthis.queryPane = qp;\r\n\tvar wqv = new WOQLQueryViewer(this.client).options(config);\r\n\tthis.queryViewer = wqv;\r\n\r\n\t// Query Viewer\r\n/*\tvar tcs = new TerminusCodeSnippet({}, 800, 250, 'Enter Query', 'edit');\r\n\tvar snippet = tcs.getAsDOM();\r\n\tspan.appendChild(snippet.dom);\r\n\t//span.appendChild(this.ruleEditor());\r\n\tvar abtn = snippet.actionButton;\r\n\tvar self = this; */\r\n\t// On submit query\r\n\t/*abtn.addEventListener('click', function(){\r\n\t\tvar qObj = wqv.getqObjFromInput(snippet.snippetText.value);\r\n\t\tlet t = TerminusClient.WOQL.table();\r\n\t\tconsole.log('t', t);\r\n\r\n\r\n\t\tspan.appendChild(self.displayResults(qObj, t));\r\n\t\tself.getConfigButton(span);\r\n\r\n\t\t/*qObj.execute(self.client).then(function(response){\r\n\t\t\t// default result in table format\r\n\t\t\tlet t = TerminusClient.WOQL.table();\r\n\t\t\tlet res = TerminusClient.WOQLResult(response, qObj, t);\r\n\t\t\t/*t.column(\"Label\").header(\"Document\");\r\n\t\t\tt.column(\"Range\").header(\"Range\");\r\n\t\t\tt.column(\"Domain\").header(\"Domain\");\r\n\t\t\tt.column(\"Comment\").header(\"Description\");\r\n\t\t\tt.column(\"Comment\").renderer(\"HTMLStringViewer\").args({max_cell_size: 20, max_word_size: 10});\r\n\t\t    t.column_order(\"Label\", \"Type\", \"Comment\");*/\r\n\t\t/*\tspan.appendChild(self.displayResults(res, t));\r\n\t\t\tself.getConfigButton(span);\r\n\t\t}) */\r\n\t\t//wqv.submitQuery(qObj);\r\n\t/*})\r\n\t*/\r\n\r\n\t//console.log('wqv', wqv);\r\n\t//var wqc = new WOQLChoice(this.client).options(config);\r\n\t//var wqs = new WOQLStream(this.client).options(config);\r\n\t//var wqg = new WOQLGraph(this.client).options(config);\r\n\t//var wqt = new WOQLTable(this.client).options(config)\r\n\t//wqv.setRenderer(new SimpleTextbox(wqv, 1000, 600));\r\n\t//wqt.setRenderer(new SimpleTable());\r\n\t//wqg.setRenderer(new SimpleGraph());\r\n\t//wqt.setDatatypes(Datatypes.initialiseDataRenderers);\r\n\t//wqs.setDatatypes(Datatypes.initialiseDataRenderers);\r\n\t//qp.addQueryViewer(wqv);\r\n\t//qp.addResultViewer(\"Choice\", wqc);\r\n\t//qp.addResultViewer(\"Stream\", wqs);\r\n\t//qp.addResultViewer(\"Graph\", wqg);\r\n\t//qp.addResultViewer(\"Table\", wqt);\r\n\r\n\t//qp.addResultViewer(\"ABC\", config, new SimpleTextbox(wqv, 1000, 600));\r\n\t//span.appendChild(qp.render());\r\n\r\n\treturn span;\r\n}\r\n\r\n\r\nTerminusHTMLViewer.prototype.chooser = function(query, config){\r\n\tvar span = document.createElement(\"span\");\r\n\tspan.setAttribute(\"class\", \"terminus-chooser\");\r\n\tvar wqt = new WOQLChoice(this.client).options(config);\r\n\treturn query.execute(this.client).then((results) => {\r\n\t\tvar result = new WOQLResult(results, query);\r\n\t\tspan.appendChild(wqt.render(result));\r\n\t});\r\n\treturn span;\r\n}\r\n\r\nTerminusHTMLViewer.prototype.graph = function(query, config){\r\n\tvar span = document.createElement(\"span\");\r\n\tspan.setAttribute(\"class\", \"terminus-graph terminus-graph-holder\");\r\n\tvar wqt = new WOQLGraph(this.client).options(config);\r\n\treturn query.execute(this.client).then((results) => {\r\n\t\tvar result = new WOQLResult(results, query);\r\n\t\tspan.appendChild(wqt.render(result));\r\n\t});\r\n\treturn span;\r\n}\r\n\r\nTerminusHTMLViewer.prototype.document = function(id, config){\r\n\tvar holder = document.createElement(\"span\");\r\n\tholder.setAttribute(\"class\", \"terminus-document terminus-document-holder\");\r\n\t//config.renderer(new DocumentTable());\r\n\t//config.show_all(\"SimpleFrameViewer\");\r\n\tvar tdv = new TerminusFrame(this.client).options(config);\r\n\ttdv.owner = this;\r\n\ttdv.setDatatypes(Datatypes.initialiseDataRenderers);\r\n\ttdv.loadDocument(id).then(() => {\r\n\t\tlet dom = tdv.render();\r\n\t\tif(dom) holder.appendChild(dom);\r\n\t});\r\n\treturn holder;\r\n}\r\n\r\nTerminusHTMLViewer.prototype.loadRenderer = function(rendname, frame, args, termframe){\r\n\tvar evalstr = \"new \" + rendname + \"(\";\r\n\tif(args) evalstr += JSON.stringify(args);\r\n\tevalstr += \");\";\r\n\ttry {\r\n\t\tvar nr = eval(evalstr);\r\n\t\tnr.terminus = termframe;\r\n\t\treturn nr;\r\n\t}\r\n\tcatch(e){\r\n\t\tconsole.log(\"Failed to load \" + rendname + e.toString());\r\n\t\treturn false;\r\n\t}\r\n}\r\n\r\nmodule.exports = TerminusHTMLViewer;\r\n","function SimpleDocument(){}\r\n\r\nSimpleDocument.prototype.render = function(frame){\r\n\tvar s = document.createElement(\"div\");\r\n\tfor(var p in frame.properties){\r\n\t\tvar pr = this.renderProperty(frame.properties[p])\r\n\t\tif(pr) s.appendChild(pr);\r\n\t}\r\n\treturn s;\r\n}\r\n\r\nSimpleDocument.prototype.renderProperty = function(frame){\r\n\tvar s = document.createElement(\"div\");\r\n\ts.appendChild(document.createTextNode(frame.getLabel() + \": \"));\r\n\tfor(var i = 0 ; i < frame.values.length; i++){\r\n\t\tif(frame.values[i].isData()){\r\n\t\t\tvar pr = this.renderValue(frame.values[i]);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tvar pr = this.render(frame.values[i]);\t\t\t\r\n\t\t}\r\n\t\tif(pr) s.appendChild(pr);\r\n\t}\r\n\treturn s;\r\n}\r\n\r\nSimpleDocument.prototype.renderValue = function(frame){\r\n\tvar s = document.createElement(\"span\");\r\n\ts.appendChild(document.createTextNode(frame.get() + \" \"));\r\n\treturn s;\r\n}\r\n\r\nmodule.exports = SimpleDocument;","function DocumentTable(){}\r\n\r\nDocumentTable.prototype.render = function(frame){\r\n\tvar t = this.getTableDOM(frame);\r\n\tvar tbody = document.createElement(\"tbody\");\r\n\tfor(var p in frame.properties){\r\n\t\t//s.appendChild(document.createTextNode(p));\r\n\t\tvar pr = this.renderProperty(tbody, frame.properties[p]);\r\n\t\t//if(pr) tbody.appendChild(pr);\r\n\t}\r\n\tt.appendChild(tbody);\r\n\treturn t;\r\n}\r\n\r\nDocumentTable.prototype.getTableDOM = function(frame){\r\n\t//const columns = this.woqltable.getColumnsToRender();\r\n\tvar tab = document.createElement(\"table\");\r\n\ttab.setAttribute(\"class\", \"terminus-hover-table\");\r\n\tvar thead = document.createElement(\"thead\");\r\n\tvar thr = document.createElement(\"tr\");\r\n\tvar th = document.createElement(\"th\");\r\n\tth.setAttribute('class', 'terminus-table-header-full-css');\r\n\tth.setAttribute('colspan', 2);\r\n\tth.appendChild(document.createTextNode(frame.subject() + \", \" + frame.subjectClass()));\r\n\tthr.appendChild(th);\r\n\tthead.appendChild(thr);\t\r\n\ttab.appendChild(thead);\r\n\treturn tab;\r\n}\r\n\r\nDocumentTable.prototype.renderProperty = function(tbody, frame){\r\n\tfor(var i = 0 ; i < frame.values.length; i++){\r\n\t\tvar thr = document.createElement(\"tr\");\r\n\t\tvar td = document.createElement(\"td\");\r\n\t\ttd.appendChild(document.createTextNode(frame.getLabel()));\r\n\t\tvar td2 = document.createElement(\"td\");\r\n\t\tif(frame.values[i].isData()){\r\n\t\t\ttd2.appendChild(this.renderValue(frame.values[i]));\r\n\t\t}\r\n\t\telse {\r\n\t\t\ttd2.appendChild(this.render(frame.values[i]));\t\t\t\r\n\t\t}\r\n\t\tthr.appendChild(td);\t\r\n\t\tthr.appendChild(td2);\t\r\n\t\ttbody.appendChild(thr);\t\r\n\t}\r\n}\r\n\r\nDocumentTable.prototype.renderValue = function(frame){\r\n\treturn document.createTextNode(frame.get());\r\n}\r\n\r\nmodule.exports = DocumentTable;","/* User interface elements that relate to server context\r\n *\r\n * TerminusServerController is a control widget that invokes server actions\r\n * TerminusServerViewer is a window that displays server actions and server screens\r\n *\r\n */\r\n const Datatables = require('./plugins/datatables.terminus');\r\n const UTILS =require('./Utils');\r\n const HTMLFrameHelper = require('./html/HTMLFrameHelper');\r\n \r\n //const TerminusHTMLViewer = require(\"./html/TerminusHTMLViewer\");\r\n const TerminusClient = require('@terminusdb/terminus-client');\r\n\r\n function TerminusServerController(ui){\r\n\t this.ui = ui;\r\n }\r\n\r\nTerminusServerController.prototype.getAsDOM = function(){\r\n\tvar rsc = document.createElement(\"div\");\r\n\trsc.setAttribute(\"class\", \"terminus-server-controller\");\r\n\tvar self = this;\r\n\tif(this.ui && this.ui.server()){\r\n\t\tvar scd = document.createElement(\"div\");\r\n\t\tscd.setAttribute(\"class\", \"terminus-server-connection\");\r\n        var nav = document.createElement('div');\r\n        nav.setAttribute('class', 'span3');\r\n        var ul = document.createElement('ul');\r\n        ul.setAttribute('class', 'terminus-ul');\r\n        nav.appendChild(ul);\r\n        rsc.appendChild(nav);\r\n        // connected to server\r\n        // change server\r\n        if(this.ui.showControl(\"change-server\")){\r\n            var a = document.createElement('a');\r\n            a.setAttribute('class', 'terminus-a terminus-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\r\n            var self = this;\r\n            a.addEventListener(\"click\", function(){\r\n                UTILS.activateSelectedNav(this, self);\r\n                self.ui.showLoadURLPage();\r\n            })\r\n            var icon = document.createElement('i');\r\n            icon.setAttribute('class', 'terminus-menu-icon fa fa-link');\r\n            a.appendChild(icon);\r\n            var txt = document.createTextNode('Change Server');\r\n            a.appendChild(txt);\r\n            ul.appendChild(a);\r\n        }\r\n        // view databases\r\n        if(this.ui.showControl(\"db\")){\r\n            var a = document.createElement('a');\r\n            a.setAttribute('class', 'terminus-a terminus-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\r\n            var self = this;\r\n            a.addEventListener(\"click\", function(){\r\n                UTILS.activateSelectedNav(this, self);\r\n                if(self.ui.db()){\r\n                    self.ui.clearDB();\r\n\t\t\t\t\tself.ui.redrawControls();\r\n                }\r\n                self.ui.showServerMainPage();\r\n            })\r\n            var icon = document.createElement('i');\r\n            icon.setAttribute('class', 'terminus-menu-icon fa fa-home');\r\n            a.appendChild(icon);\r\n            var txt = document.createTextNode('Home');\r\n            a.appendChild(txt);\r\n            ul.appendChild(a);\r\n        }\r\n\t\tif(this.ui.showControl(\"create_database\")){\r\n            var a = document.createElement('a');\r\n            a.setAttribute('class', 'terminus-a terminus-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\r\n            var self = this;\r\n            a.addEventListener(\"click\", function(){\r\n               UTILS.activateSelectedNav(this, self);\r\n                if(self.ui.db()){\r\n                    self.ui.clearDB();\r\n\t\t\t\t\tself.ui.redrawControls();\r\n                }\r\n                self.ui.showCreateDBPage();\r\n            })\r\n            var icon = document.createElement('i');\r\n            icon.setAttribute('class', 'terminus-menu-icon fa fa-plus');\r\n            a.appendChild(icon);\r\n            var txt = document.createTextNode('Create Database');\r\n            a.appendChild(txt);\r\n            ul.appendChild(a);\r\n        }\r\n        if(this.ui.showControl(\"collaborate\")){\r\n            var a = document.createElement('a');\r\n            a.setAttribute('class', 'terminus-a terminus-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\r\n            var self = this;\r\n            a.addEventListener(\"click\", function(){\r\n               UTILS.activateSelectedNav(this, self);\r\n                if(self.ui.db()){\r\n                    self.ui.clearDB();\r\n\t\t\t\t\tself.ui.redrawControls();\r\n                }\r\n                self.ui.showCollaboratePage();\r\n            })\r\n            var icon = document.createElement('i');\r\n            icon.setAttribute('class', 'terminus-menu-icon fa fa-share-alt');\r\n            a.appendChild(icon);\r\n            var txt = document.createTextNode('Collaborate');\r\n            a.appendChild(txt);\r\n            ul.appendChild(a);\r\n\t\t}\r\n\t}\r\n\treturn rsc;\r\n}\r\n\r\nTerminusServerController.prototype.getServerLabelDOM = function(){\r\n\tvar srec = this.ui.client.connection.getServerRecord();\r\n\tvar lab = (srec && srec['rdfs:label'] && srec['rdfs:label'][\"@value\"] ? srec['rdfs:label'][\"@value\"] : this.ui.server());\r\n\tvar desc = (srec && srec['rdfs:comment'] && srec['rdfs:comment'][\"@value\"] ? srec['rdfs:comment'][\"@value\"] : \"\");\r\n\tdesc += \" Server URL: \"+ this.ui.server();\r\n\tvar val = document.createElement(\"span\");\r\n\tval.setAttribute(\"class\", \"terminus-server-value\");\r\n\tval.setAttribute(\"title\", desc);\r\n\tval.appendChild(document.createTextNode(lab));\r\n    val =  document.createElement('div');\r\n\treturn val;\r\n}\r\n\r\nfunction TerminusServerViewer(ui){\r\n\tthis.ui = ui;\r\n\tthis.server = this.ui.server();\r\n\tthis.max_cell_size = 500;\r\n\tthis.max_word_size = 40;\r\n}\r\n\r\nTerminusServerViewer.prototype.getAsDOM = function(selected){\r\n\tvar self = this;\r\n\tvar pd = document.createElement(\"span\");\r\n\tpd.setAttribute(\"class\", \"terminus-server-home-page\");\r\n\tif(this.ui.server()){\r\n\t\tvar scd = document.createElement(\"span\");\r\n\t\tscd.setAttribute(\"class\", \"terminus-server-home\");\r\n\t\tif(this.ui.showView(\"server\")){\r\n\t\t\t// 11092019 scd.appendChild(this.getServerDetailsDOM());\r\n\t\t}\r\n\t\tif(this.ui.showView(\"change-server\")){\r\n\t\t\tvar csbut = document.createElement(\"button\");\r\n\t\t\tcsbut.setAttribute(\"class\", \"terminus-control-button terminus-change-server-button terminus-btn\")\r\n\t\t\tcsbut.appendChild(document.createTextNode(\"Disconnect\"));\r\n\t\t\tcsbut.addEventListener(\"click\", function(){\r\n\t\t\t\t//self.ui.clearDB();\r\n\t\t\t\t//self.ui.clearServer();\r\n\t\t\t\tself.ui.showLoadURLPage();\r\n\t\t\t})\r\n\t\t\t// 11092019 scd.appendChild(csbut);\r\n\t\t}\r\n\t\tif(this.ui.showView(\"create_database\")){\r\n\t\t\tvar crbut = document.createElement(\"button\");\r\n\t\t\tcrbut.setAttribute(\"class\", \"terminus-control-button terminus-create-db-button terminus-btn\")\r\n\t\t\tcrbut.appendChild(document.createTextNode(\"Create New Database\"));\r\n\t\t\tcrbut.addEventListener(\"click\", function(){\r\n\t\t\t\tif(self.ui.db()){\r\n\t\t\t\t\t//self.ui.clearDB();\r\n\t\t\t\t}\r\n\t\t\t\tself.ui.clearMessages();\r\n\t\t\t\tself.ui.showCreateDBPage();\r\n\t\t\t})\r\n\t\t\t// 11092019 scd.appendChild(crbut);\r\n\t\t}\r\n\t\tif(this.ui.showView(\"db\")){\r\n\t\t\t//scd.appendChild(this.getNDBListDOM());\r\n\t\t\tscd.appendChild(this.getDBListDOM());\r\n\t\t}\r\n\t\tpd.appendChild(scd);\r\n\t}\r\n\telse {\r\n\t\tself.ui.showLoadURLPage();\r\n\r\n\t\t//pd.appendChild(this.getLoadURLPage());\r\n\t}\r\n\treturn pd;\r\n}\r\n\r\nTerminusServerViewer.prototype.getServerDetailsDOM = function(){\r\n\tvar scd = document.createElement(\"span\");\r\n\tscd.setAttribute(\"class\", \"terminus-server-details terminus-server-banner\");\r\n\tvar scl = document.createElement(\"span\");\r\n\tscl.setAttribute(\"class\", \"terminus-label terminus-server-info\");\r\n\tscl.appendChild(document.createTextNode(\"Connected to Server - \"))\r\n\tvar scs = document.createElement(\"span\");\r\n\tscs.setAttribute(\"class\", \"terminus-value terminus-server-info\");\r\n\tscs.appendChild(document.createTextNode(this.ui.server()))\r\n\tscd.appendChild(scl);\r\n\tscd.appendChild(scs);\r\n\treturn scd;\r\n}\r\n\r\nTerminusServerViewer.prototype.wrapTableLinkCell = function(tdElement,dbid, text){\r\n\tvar self = this;\r\n\tvar wrap = document.createElement(\"p\");\r\n//\twrap.setAttribute(\"href\", \"#\");\r\n\twrap.setAttribute(\"class\", \"terminus-table-content\");\r\n\tHTMLFrameHelper.wrapShortenedText(wrap, text, this.max_cell_size, this.max_word_size);\r\n\ttdElement.addEventListener(\"click\", function(){\r\n\t\tself.ui.connectToDB(dbid);\r\n\t\tself.ui.showDBMainPage();\r\n\t});\r\n\treturn wrap;\r\n}\r\n\r\nTerminusServerViewer.prototype.getNDBListDOM = function(){\r\n\tvar whtml = new TerminusHTMLViewer(this.ui.client);\r\n\tvar dbrecs = this.ui.client.connection.getServerDBRecords();\r\n\r\n\t//var tab = whtml.table();\r\n}\r\n\r\nTerminusServerViewer.prototype.getDBListDOM = function(){\r\n\tvar self = this;\r\n\tvar sec = document.createElement(\"div\");\r\n\tsec.appendChild(UTILS.getHeaderDom('Available Databases'));\r\n\tvar scd = document.createElement(\"table\");\r\n\tscd.setAttribute(\"class\", \"terminus-db-list terminus-db-size terminus-hover-table terminus-margin-top\");\r\n\tvar thead = document.createElement(\"thead\");\r\n\tvar thr = document.createElement(\"tr\");\r\n\tvar th1 = document.createElement(\"th\");\r\n\tth1.appendChild(document.createTextNode(\"ID\"));\r\n\tth1.setAttribute(\"class\", \"terminus-db-id terminus-table-header-full-css\");\r\n\tvar th2 = document.createElement(\"th\");\r\n\tth2.appendChild(document.createTextNode(\"Title\"));\r\n\tth2.setAttribute(\"class\", \"terminus-db-title terminus-table-header-full-css\");\r\n\tvar th3 = document.createElement(\"th\");\r\n\tth3.appendChild(document.createTextNode(\"Description\"));\r\n\tth3.setAttribute(\"class\", \"terminus-db-description terminus-table-header-full-css\");\r\n\tvar th4 = document.createElement(\"th\");\r\n\tth4.setAttribute(\"class\", \"terminus-db-size terminus-table-header-full-css\");\r\n\tth4.appendChild(document.createTextNode(\"Size\"));\r\n\tvar th5 = document.createElement(\"th\");\r\n\tth5.setAttribute(\"class\", \"terminus-db-created terminus-table-header-full-css\");\r\n\tth5.appendChild(document.createTextNode(\"Created\"));\r\n\tvar th6 = document.createElement(\"th\");\r\n\tth6.appendChild(document.createTextNode(\"Delete\"));\r\n\tth6.setAttribute(\"class\", \"terminus-db-delete terminus-table-header-full-css\");\r\n\tthr.appendChild(th1);\r\n\tthr.appendChild(th2);\r\n\tthr.appendChild(th3);\r\n\t//thr.appendChild(th4);\r\n\t//thr.appendChild(th5);\r\n\tthr.appendChild(th6);\r\n\tthead.appendChild(thr);\r\n\tscd.appendChild(thead);\r\n\tvar tbody = document.createElement(\"tbody\");\r\n\tvar dbrecs = this.ui.client.connection.getServerDBRecords();\r\n\tfor(let fullid in dbrecs){\r\n\t\tlet dbrec = dbrecs[fullid];\r\n\t\tconst dbid = fullid.split(\":\")[1];\r\n\t\tlet tr = document.createElement(\"tr\");\r\n\t\tvar td1 = document.createElement(\"td\");\r\n\t\ttd1.appendChild(this.wrapTableLinkCell(td1,dbid, dbid));\r\n\t\ttd1.setAttribute(\"class\", \"terminus-db-id terminus-db-pointer\");\r\n\t\tvar td2 = document.createElement(\"td\");\r\n\t\ttd2.setAttribute(\"class\", \"terminus-db-title terminus-db-pointer\");\r\n\t\tvar txt = (dbrec && dbrec['rdfs:label'] && dbrec['rdfs:label']['@value'] ? dbrec['rdfs:label']['@value'] : \"\");\r\n\t\ttd2.appendChild(this.wrapTableLinkCell(td2,dbid, txt));\r\n\t\tvar td3 = document.createElement(\"td\");\r\n\t\ttd3.setAttribute(\"class\", \"terminus-db-description terminus-db-pointer\");\r\n\t\tvar txt = (dbrec && dbrec['rdfs:comment'] && dbrec['rdfs:comment']['@value'] ? dbrec['rdfs:comment']['@value'] : \"\");\r\n\t\ttd3.appendChild(this.wrapTableLinkCell(td3,dbid, txt));\r\n\t\tvar td4 = document.createElement(\"td\");\r\n\t\ttd4.setAttribute(\"class\", \"terminus-db-size terminus-db-pointer\");\r\n\t\tvar txt = (dbrec && dbrec['terminus:size'] && dbrec['terminus:size']['@value'] ? dbrec['terminus:size']['@value'] : \"\");\r\n\t\ttd4.appendChild(this.wrapTableLinkCell(td4,dbid, txt));\r\n\t\tvar td5 = document.createElement(\"td\");\r\n\t\ttd5.setAttribute(\"class\", \"terminus-db-created terminus-db-pointer\");\r\n\t\tvar txt = (dbrec && dbrec['terminus:last_updated'] && dbrec['terminus:last_updated']['@value'] ? dbrec['terminus:last_updated']['@value'] : \"\");\r\n\t\ttd5.appendChild(this.wrapTableLinkCell(td5,dbid, txt));\r\n\t\tvar td6 = document.createElement(\"td\");\r\n\t\ttd6.setAttribute(\"class\", \"db-delete\");\r\n        if(this.deleteDBPermitted(dbid)){\r\n            if(this.ui.pluginAvailable(\"font-awesome\")){\r\n                var delbut = document.createElement('i');\r\n        \t\tdelbut.setAttribute(\"class\", \"terminus-db-list-del-icon fa fa-times-circle\");\r\n        \t}\r\n            else{\r\n                var delbut = document.createElement(\"button\");\r\n    \t\t\tdelbut.appendChild(document.createTextNode(\"Delete\"));\r\n    \t\t\tdelbut.setAttribute(\"class\", \"terminus-control-button terminus-delete-db-button\");\r\n            }\r\n\t\t\t// function to fix db in a closure\r\n\t\t\tvar delDB = function(db){\r\n\t\t\t\treturn function(){\r\n\t\t\t\t\tlet deleteConfirm = confirm(`Do you want to delete ${db} Database?`);\r\n\t\t\t\t\tif (deleteConfirm == true) {\r\n\t\t\t  \t\t\tself.ui.deleteDatabase(db);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t//self.ui.deleteDatabase(db);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tdelbut.addEventListener(\"click\", delDB(dbid));\r\n\t\t\ttd6.appendChild(delbut);\r\n\t\t}\r\n\r\n\t\ttr.appendChild(td1);\r\n\t\ttr.appendChild(td2);\r\n\t\ttr.appendChild(td3);\r\n\t\t//tr.appendChild(td4);\r\n\t\t//tr.appendChild(td5);\r\n\t\ttr.appendChild(td6);\r\n\t\ttbody.appendChild(tr);\r\n\t}\r\n\tscd.appendChild(tbody);\r\n\tsec.appendChild(scd);\r\n\r\n\tif(this.ui.pluginAvailable(\"datatables\")){\r\n        var dt = new Datatables.CspDatatables(this.ui);\r\n\t\tvar tab = dt.draw(scd);\r\n\t}\r\n\treturn sec;\r\n}\r\n\r\nTerminusServerViewer.prototype.deleteDBPermitted = function(dbid){\r\n\tif(dbid == \"terminus\") return false;\r\n\tif(this.ui.client.connection.capabilitiesPermit(\"delete_database\", dbid)) return true;\r\n\treturn false;\r\n}\r\n\r\nmodule.exports = {TerminusServerViewer,TerminusServerController}\r\n","const UTILS = require(\"./Utils.js\");\r\n\r\nfunction TerminusURLLoader(ui, val){\r\n\tthis.ui = ui;\r\n\tthis.val = val;\r\n\tthis.url_input = false;\r\n\tthis.key_input = false;\r\n}\r\n\r\nTerminusURLLoader.prototype.getLabelDOM = function(){\r\n\treturn document.createTextNode(\"Connect\");\r\n}\r\n\r\nTerminusURLLoader.prototype.getFormFieldDOM = function(ip, fname, ltxt, pholder){\r\n\tvar sci = document.createElement(\"div\");\r\n\tsci.setAttribute(\"class\", \"terminus-form-horizontal terminus-control-group terminus-form-field-spacing terminus-display-flex terminus-field-\"+fname);\r\n\tvar lab = document.createElement(\"span\");\r\n\tlab.setAttribute(\"class\", \"terminus-control-label terminus-form-label terminus-form-field-label terminus-label-\"+fname);\r\n\tlab.appendChild(document.createTextNode(ltxt))\r\n\tip.setAttribute(\"type\", \"text\");\r\n\tip.setAttribute(\"placeholder\", pholder);\r\n\tsci.appendChild(lab);\r\n\tsci.appendChild(ip);\r\n\treturn sci;\r\n}\r\n\r\nTerminusURLLoader.prototype.getAsDOM = function(){\r\n\tvar scd = document.createElement(\"div\");\r\n\tscd.setAttribute(\"class\", \"terminus-form terminus-url-loader\");\r\n\tscd.appendChild(UTILS.getHeaderDom('Connect To Terminus Server'));\r\n\tvar mfd = document.createElement('div');\r\n\tmfd.setAttribute('class', 'terminus-form-border terminus-margin-top');\r\n\tscd.appendChild(mfd);\r\n\tthis.url_input = document.createElement(\"input\");\r\n\tthis.url_input.setAttribute(\"class\", \"terminus-form-value terminus-form-url terminus-form-field-input terminus-input-text\");\r\n\tif(this.val){\r\n\t\tthis.url_input.value = this.val;\r\n\t}\r\n\tvar dht = document.createElement('div');\r\n\tdht.setAttribute('class', 'terminus-form-margin-top');\r\n\tmfd.appendChild(dht);\r\n\tmfd.appendChild(this.getFormFieldDOM(this.url_input, \"connect\", \"URL\", \"Terminus DB URL\"));\r\n\tthis.key_input = document.createElement(\"input\");\r\n\tthis.key_input.setAttribute(\"class\", \"terminus-form-value terminus-value terminus-input-text\");\r\n\tmfd.appendChild(this.getFormFieldDOM(this.key_input, \"connect\", \"Key\", \"Server API Key\"));\r\n\tvar loadbuts = document.createElement(\"div\");\r\n\tloadbuts.setAttribute(\"class\", \"terminus-control-buttons\");\r\n\tvar loadbut = document.createElement(\"button\");\r\n\tloadbut.setAttribute(\"class\", \"terminus-control-button terminus-url-load terminus-btn terminus-btn-float-right\");\r\n\tloadbut.appendChild(document.createTextNode(\"Connect\"));\r\n\tvar self = this;\r\n\tloadbut.addEventListener(\"click\", function(){\r\n\t\tif(self.url_input.value){\r\n\t\t\tself.ui.load(self.url_input.value, self.key_input.value);\r\n\t\t}\r\n\t});\r\n\tloadbuts.appendChild(loadbut);\r\n\tmfd.appendChild(loadbuts);\r\n\treturn scd;\r\n}\r\n\r\n\r\nmodule.exports=TerminusURLLoader\r\n"],"sourceRoot":""}
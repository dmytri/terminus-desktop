{"version":3,"sources":["webpack://TerminusDashboard/webpack/bootstrap","webpack://TerminusDashboard/./src/client/HTMLFrameHelper.js","webpack://TerminusDashboard/./src/Utils.js","webpack://TerminusDashboard/./src/query/WOQLQuery.js","webpack://TerminusDashboard/./src/plugins/TerminusPlugin.js","webpack://TerminusDashboard/./src/client/RenderingMap.js","webpack://TerminusDashboard/./src/client/TerminusClassChooser.js","webpack://TerminusDashboard/./src/query/WOQLResultsViewer.js","webpack://TerminusDashboard/./src/client/TerminusDocument.js","webpack://TerminusDashboard/./src/plugins/datatables.terminus.js","webpack://TerminusDashboard/./src/client/ObjectViewer.js","webpack://TerminusDashboard/./src/client/viewers/String.js","webpack://TerminusDashboard/./src/client/viewers/DateHelper.js","webpack://TerminusDashboard/./src/client/viewers/GoogleMapHelper.js","webpack://TerminusDashboard/./src/client/PropertyViewer.js","webpack://TerminusDashboard/./src/client/DataViewer.js","webpack://TerminusDashboard/./src/client/TerminusDocumentChooser.js","webpack://TerminusDashboard/./src/index.js","webpack://TerminusDashboard/./src/TerminusUI.js","webpack://TerminusDashboard/./src/ApiExplorer.js","webpack://TerminusDashboard/./src/plugins/codemirror.terminus.js","webpack://TerminusDashboard/./src/client/ObjectRenderer.js","webpack://TerminusDashboard/./src/client/viewers/StringEditor.js","webpack://TerminusDashboard/./src/client/viewers/Boolean.js","webpack://TerminusDashboard/./src/client/viewers/BooleanEditor.js","webpack://TerminusDashboard/./src/client/viewers/Choice.js","webpack://TerminusDashboard/./src/client/viewers/ChoiceEditor.js","webpack://TerminusDashboard/./src/client/viewers/Coordinate.js","webpack://TerminusDashboard/./src/client/viewers/CoordinateEditor.js","webpack://TerminusDashboard/./src/client/viewers/Date.js","webpack://TerminusDashboard/./src/client/viewers/DateEditor.js","webpack://TerminusDashboard/./src/client/viewers/Entity.js","webpack://TerminusDashboard/./src/client/viewers/EntityEditor.js","webpack://TerminusDashboard/./src/client/viewers/Image.js","webpack://TerminusDashboard/./src/client/viewers/ImageEditor.js","webpack://TerminusDashboard/./src/client/viewers/Link.js","webpack://TerminusDashboard/./src/client/viewers/Number.js","webpack://TerminusDashboard/./src/client/viewers/Range.js","webpack://TerminusDashboard/./src/client/viewers/RangeEditor.js","webpack://TerminusDashboard/./src/client/viewers/SanitizedHTML.js","webpack://TerminusDashboard/./src/client/viewers/GoogleMapEditor.js","webpack://TerminusDashboard/./src/client/viewers/GoogleMapViewer.js","webpack://TerminusDashboard/./src/client/viewers/HTMLMarkupEditor.js","webpack://TerminusDashboard/./src/client/viewers/S2EntityEditor.js","webpack://TerminusDashboard/./src/client/ValueRenderer.js","webpack://TerminusDashboard/./src/client/TerminusDB.js","webpack://TerminusDashboard/./src/client/TerminusViolation.js","webpack://TerminusDashboard/./src/client/TerminusQuery.js","webpack://TerminusDashboard/./src/query/WOQLTextboxGenerator.js","webpack://TerminusDashboard/./src/client/TerminusPropertyChooser.js","webpack://TerminusDashboard/./src/client/TerminusMapping.js","webpack://TerminusDashboard/./src/client/TerminusSchema.js","webpack://TerminusDashboard/./src/client/TerminusServer.js","webpack://TerminusDashboard/./src/client/TerminusURL.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","TerminusPluginManager","require","HTMLFrameHelper","type","control","label","callback","disabled","dpropDOM","document","createElement","setAttribute","button","appendChild","createTextNode","addEventListener","this","innerHTML","objId","getElementsByClassName","length","style","background","view","pluginAvailable","icon","options","selected","sel","opt","TerminusClient","FrameHelper","labelFromURL","which","renderer","viewsDOM","setMode","getActionControl","isNew","cancel","url","window","location","href","loc","split","sh","getShorthand","bits","htmlid","prop","wrap","text","max_cell_size","max_word_size","substring","replacements","words","word","newstr","k","replace","varname","lastIndexOf","obj","help","input","infoDOM","linfo","lspacer","lval","Codemirror","getHeaderDom","hd","h","stylizeCodeDisplay","ui","txt","dom","cmConfig","pr","colorizePre","removeSelectedNavClass","el","classList","remove","hideDocumentSubMenus","contains","add","showSubMenus","tolggleContent","content","display","stylizeEditor","cm","ar","colorizeTextArea","updateTextArea","deleteStylizedEditor","qip","nextElementSibling","removeChildren","showHttpResult","response","action","currForm","terminator","br","retHttpHeaders","headers","hdres","json","then","rd","data","JSON","stringify","pre","getResponse","getInfoAlertDom","msg","ald","str","getFunctionSignature","sigs","spec","descr","result","args","server_url","title","description","database_url","details","format","editmode","document_url","fail_on_id_denied","woql","class","term","source","target","toggleVisibility","extractValueFromCell","cellValue","DOMParser","parseFromString","firstChild","displayDocumentSubMenus","showControl","activateSelectedNav","nav","checkDocumentSubMenus","WOQLResult","WOQLQuery","client","default_limit","prefixes","connectionConfig","platformEndpoint","sid","server","colid","dbid","serverURL","schemaURL","dbURL","docURL","pref","standard_urls","setPrefixes","shorten","execute","wrapped","self","select","getConcreteDocumentClassPattern","varc","and","getSubclassQueryPattern","not","getAbstractQueryPattern","quad","clsname","sub","queryWrappedWithLimit","query","limit","start","getAllDocumentQuery","constraint","triple","push","getEverythingQuery","wjson","getPropertyListQuery","getElementMetaDataQuery","getClassListMetaDataQuery","getClassMetaDataQuery","getDataOfChosenClassQuery","chosen","getDataOfChosenPropertyQuery","getInstanceMeta","getDocumentQuery","id","getClassesQuery","preloaded","loaded","loading","precluded","plugins","css","js","requires","setPluginOptions","opts","init","calculatePreloaded","toload","calculateRequiredInitPlugins","loadPlugins","pins","pid","indexOf","getDefaultPlugins","needed_pins","loading_order","getAvailablePlugins","pl","plugin","version_check","pluginmeta","version","jQuery","isFunction","fn","slider","e","Quill","JSONEditor","CodeMirror","fontAwesomeCheck","dataTable","select2","google","maps","ol","Map","d3","console","log","Error","element","span","className","body","insertBefore","getComputedStyle","getPropertyValue","removeChild","ticker","cback","loadPlugin","pug","cssid","loadDynamicCSS","scripts","splice","loadDynamicScript","loadPluginScripts","loadPageCSS","cssfid","cssdom","getElementById","parentNode","cssurl","pluginLoadable","pluginLoadedOrLoading","getPluginDOM","plugid","a","cl","cbox","checked","clab","togglePlugin","redraw","unloadPlugin","drawPlugins","num","getAsDOM","dm","clh","showPlugins","ObjectViewer","HTMLStringViewer","HTMLStringEditor","HTMLBooleanViewer","HTMLBooleanEditor","HTMLChoiceViewer","HTMLChoiceEditor","HTMLCoordinateViewer","HTMLCoordinateEditor","HTMLDateViewer","HTMLDateEditor","HTMLEntityViewer","HTMLEntityEditor","HTMLImageViewer","HTMLImageEditor","HTMLLinkViewer","HTMLNumberViewer","HTMLRangeViewer","HTMLRangeEditor","SantizedHTMLViewer","GoogleMapEditor","GoogleMapViewer","HTMLMarkupEditor","S2EntityEditor","RenderingMap","registeredDataViewers","registeredDataEditors","registeredPropertyViewers","registeredPropertyEditors","registeredObjectViewers","registeredObjectEditors","getValidDataViewerList","frametype","valids","concat","getValidDataEditorList","nftypes","getValidPropertyViewerList","proptype","proprange","propdom","getValidPropertyEditorList","getViewer","vi","renderers","viewer","eval","alert","toString","getAvailablePropertyViewers","viewers","nviewers","sets","getAvailablePropertyEditors","getAvailableDataViewers","getAvailableDataEditors","getViewerForDataFrame","vals","getEditorForDataFrame","registerViewerForTypes","types","registerEditorForTypes","registerEditorForFrameType","registerViewerForFrameType","registerViewerForProperties","properties","registerEditorForProperties","HTMLPropertyViewer","patternMatchesRenderer","pattern","FramePattern","checkRenderer","compiled_options","compileOptions","parent","facets","getDefaultFacets","facet","deffacet","getDefaultFacet","hide_disabled_buttons","features","controls","viewerType","viewerOptions","header","header_viewer","HTMLObjectHeaderViewer","filter","sort","rules","output","frame_type","subject","subjectClass","range","children","depth","index","status","rtype","getRendererType","illegalRuleType","checkFrameType","checkLabel","checkSubject","checkSubjectClass","checkProperty","checkDepth","checkRange","checkValue","checkParent","checkChildren","checkIndex","checkStatus","rsubj","IDsMatch","found","j","values","isUpdated","numberMatch","propertyIDsMatch","valuesMatch","rangeIDsMatch","rcls","classIDsMatch","frame","ftype","renderder","getLabel","stringMatch","ida","idb","compareIDs","vala","valb","RegExp","test","constructor","renderer_type","TerminusClassChooser","choice","show_single","setRoot","root","setFilter","change","cls","ccdom","ccsel","wq","getResultsAsOptions","clist","choices","bindings","empty_choice","opt1","added","bclass","getVariableValueFromBinding","lab","Datatables","UTILS","res","WOQLResultsViewer","wresult","wQuery","settings","queryPage","qPage","pman","count","hasBindings","showTable","show_table","orderColumns","sample","ordered","unshift","resultDOM","displayResultHeader","rs","rh","getTableDOM","nor","dtResult","getTable","tab","draw","getDtTableDOMOnChange","pageInfo","formatResultsForDatatableDisplay","columns","colDataData","formattedResult","ordered_headings","validURL","getDocumentLocalLink","outerHTML","recordsTotal","recordsFiltered","getTableBody","tbody","tr","td","wrapShortenedText","selectDocumentNavBar","showDocument","dtPlugin","thead","thr","th","Renderers","TerminusDocumentViewer","db","editor","load_schema","config_options","getBuiltInViewerOptions","classmeta","instancemeta","refreshPage","elid","getClassMeta","loadCreateDocument","showBusy","page_config","loadDocumentSchema","clearBusy","setLabel","error","showError","loadDocument","getDocument","loadDataFrames","ncls","unshorten","getClassFrame","loadSchemaFrames","deleteDocument","URL","createDocument","extr","extract","showViolations","updateDocument","durl","subjid","dataframes","domain","ObjectFrame","classframes","loadClassFrames","newDoc","fillFromSchema","render","getOptionsFromPageConfig","ObjectRenderer","controller","FrameConfig","pageconf","getClient","docid","labdom","dfs","getDataFrames","getStdURL","pagedom","rends","holder","controldom","keys","getDocumentPageControls","dpc","CspDatatables","wResViewer","wrViewer","convertToDatatable","dt","table","DataTable","searching","pageLength","lengthMenu","paging","initComplete","oInstance","api","$","each","html","columnDefs","targets","createdRow","row","find","attr","on","cell","column","showDBMainPage","dbInfo","parents","dbId","deleteDatabase","executeQuery","err","getQueryOnPagination","sqp","chosenValue","generateNewQueryOnPageChange","qTextDom","undefined","getCallbackSettings","len","setUp","dtdom","getNewDataOnChange","drawnTab","aSettings","_iDisplayLength","_iDisplayStart","getDataFromServer","serverSide","processing","ajax","entries","buttons","extend","scrollX","HTMLObjectViewer","headerViewer","getObjectHeaderViewer","renderedDOM","getObjectDOM","replaceWith","getObjectIDMarker","getObjectBodyDOM","orientation","getContentOrientation","pcls","sp","vholder","getFeatureDOM","feature","hasFeatureViewer","featureViewer","redrawHeader","nheader","redrawBody","nbody","addRenderedProperty","renderedprop","clear","goTo","subj","goToName","idm","sumDOM","controlsDOM","objDOM","showFeature","facetDOM","getObjectFacetDOM","getObjectLabelDOM","idDOM","getObjectIDDOM","typeDOM","getObjectTypeDOM","getObjectStatusDOM","viewDOM","getViewPropertyDOM","hideDOM","getViewerSelectorDOM","getObjectControlsDOM","getObjectSummaryDOM","sum","getSummary","getInfoboxDOM","addDOM","getAddPropertyDOM","getModeSelectorDOM","getObjectDeleteDOM","cpropDOM","getObjectCloneDOM","rpropDOM","getObjectResetDOM","upropDOM","getObjectUpdateDOM","showDOM","getObjectShowDOM","getObjectHideDOM","viewables","getAvailableFacets","mpropDOM","getSelectionControl","currentFacet","val","setFacet","isNewDocument","required","isClassChoice","cs","getAvailableClassChoices","mlabDOM","changeClass","cmt","addables","getAddableProperties","cardControlAllows","addNewProperty","getViewableProperties","goToProperty","clone","reset","getAvailableViewers","currentViewer","setViewer","hide","show","save","size","getDOM","dataviewer","HTMLDateHelper","months","getMonthName","GoogleMapHelper","polygon","polyline","markers","config","width","height","mapLat","mapLong","zoom","stroke","color","opacity","weight","fill","line","destroy","translatePolygonToArray","vertices","getPath","seenValue","getLength","xy","getAt","lat","lng","translateArrayToPolygon","array","jsonified","parse","latlong","createPolygon","coords","map","Polygon","paths","strokeColor","strokeOpacity","strokeWeight","fillColor","fillOpacity","setMap","createPolyline","Polyline","clearMarkers","addMarker","position","ty","marker","Marker","addListener","getCoordsFromMarkers","set","x","initMap","mapContainer","center","parseFloat","setPath","event","trigger","getPropertyHeaderViewer","HTMLPropertyHeaderViewer","propDOM","npropDOM","getPropertyDOM","getPropertyIDMarker","getPropertyBodyDOM","addRenderedValue","renderedval","wrapper","expModeMenu","getPropertyControlsDOM","getPropertyLabelDOM","statDOM","getPropertyStatusDOM","prepend","getPropertySummaryDOM","prelude","getPropertyFacetDOM","getViewValueDOM","getPropertyIDDOM","getPropertyRangeDOM","hasCardinalityRestriction","getPropertyCardinalityDOM","getPropertyCommentDOM","getComment","restriction","getRestriction","min","max","getActionControlDOM","settingsDOM","getPropertyDeleteDOM","getAddValueDOM","getPropertyResetDOM","getPropertyUpdateDOM","getPropertyShowDOM","getPropertyHideDOM","getSettingsControlDOM","addClass","getViewableValues","goToValue","showValue","HTMLDataViewer","getValueHeaderViewer","HTMLDataHeaderViewer","JSONObjectViewer","valDOM","nvalDOM","getValueDOM","getValueIDMarker","getValueBodyDOM","vdom","getDataValueViewer","getSummaryDOM","HTMLTerminusClient","fireInternalLink","link","preventDefault","load","internalLink","onclick","onClick","getValueFacetDOM","getValueTypeDOM","getValueStatusDOM","getValueControlsDOM","getValueDeleteDOM","getValueCloneDOM","getValueResetDOM","getValueUpdateDOM","getValueShowDOM","getValueHideDOM","TerminusDocumentChooser","show_button","getS2DOM","getIDDOM","docchooser","cfilter","termcc","new_class","tdom","s2config","dataType","params","contentType","delay","cache","placeholder","dcip","keyCode","dbut","toggleView","getChangeViewText","TerminusUI","TerminusConfig","pconfig","messages","explorer","nlocation","ApiExplorer","TerminusDBsdk","TerminusViolations","TerminusQueryViewer","TerminusMappingViewer","TerminusSchemaViewer","TerminusServersdk","TerminusURLLoader","WOQLClient","setOptions","connect","getDBRecord","connectToDB","showView","schema","showSchemaPage","showQueryPage","showExplorer","showServerMainPage","createDatabase","dbdets","Promise","reject","getBadArguments","myserver","dbdoc","generateNewDatabaseDocument","getSchema","updateSchema","refreshDBList","crec","connection","getCrashString","showMessage","delrec","lid","dbn","removeDB","dets","doc","rdfs","terminus","fname","getConnectionEndpoint","clearServer","clearDB","TerminusServerViewer","redrawMainPage","showLoadURLPage","TerminusDBViewer","showCreateDBPage","TerminusDBCreator","showMappingPage","mapping","getDocViewerOptions","promise","showCreateDocument","getDocCreatorOptions","main","showResult","clearMessages","clearMainPage","setMessageDOM","setbuttonControls","setControllerDOM","setExplorerDOM","setPluginsDOM","setViewerDOM","comps","slocation","toggleControl","drawControls","toggleDashboardWidget","widget","drawExplorer","loadControls","ncontrol","nd","exp","ae","sc","TerminusServerController","TerminusDBController","show_controls","pseudoCapability","capabilitiesPermit","show_views","busy","getBusyLoader","bsyDom","pd","pbc","pbsa","pbia","md","msgHolder","vios","nvios","cmsg","views","document_options","schema_options","piman","addPlugin","getClassFrameOptions","viewdoc_options","apiNavConfig","mainNav","navText","defaultSelected","database","subNav","getClassFrames","viewDocument","update","use_fetch","return_full_response","aec","getApiNav","getApiExplorerDom","setSelectedNavMenu","setSelectedSubMenu","navOnSelect","createNavs","navConfig","ul","navDom","cont","apiCont","getConnectExplorer","getDatabaseExplorer","getSchemaApi","getDocumentApi","getQueryApi","changeSubApiDom","curSubMenu","getDatabaseDom","getShowApiDom","getQueryApiDom","subNavOnSelect","subMenuConfig","createSubNavs","b","getSignature","getForm","getServerForm","form","fd","inpLabel","cd","inpId","keyLabel","resd","gatherips","curApi","urlPlaceholder","formDoc","urlLabel","inpUrl","docUrlLabel","inpDocUrl","inpKey","docLabel","inpDoc","inp","docUrl","getApiSendButton","getApiForm","enc","schurl","buttonSelf","connected_mode","gtxtar","txtar","dcurl","schemaUrlDom","payload","htmlEditor","getValue","sg","ic","sig","textdom","darkMode","jsonldCheck","fromTextArea","firstLineNumber","lineNumbers","styleActiveLine","lineWrapping","smartIndent","indentWithTabs","newlineAndIndent","autoCloseBrackets","matchBrackets","afterCursor","extraKeys","refresh","setCodemirrorSize","defaultCharWidth","setOption","setSize","setTimeout","runMode","innerText","theme","ValueRenderer","PropertyViewer","PropertyRenderer","predicate","cframe","objframe","getPropertyClassFrame","originalValues","changed","originalProperties","newProperties","TerminusDashboard","decorateRenderer","getOptionsForChild","getOptionsForValue","df","getOptionsForObject","buildValueRenderers","getViewerForProperty","adorig","isData","getDataFramesToRender","vr","kids","getChildrenToRender","kidf","viewIncludesChildren","allkids","getChildren","extracts","updated","childUpdated","hasRestriction","cf","getClassChoices","clsmeta","deleteProperty","addProperty","setNew","addPropertyClass","newb","nvals","deletePropertyValue","removePropertyValue","addPropertyValue","rest","currentnum","new_property","hideDisabledControls","hide_disabled_controls","nocascade","parentFacetChange","page","multiline","summary","containsPage","isObject","setView","nukeViewer","ptype","ret","valcount","vsum","getFeaturesForFacet","getOptionsForProperty","buildPropertyRenderers","getViewerForObject","props","getPropertiesToRender","renders","parentObject","copy","nkid","genBNID","parentobj","newrend","demandid","inputID","dval","nprops","removeProperty","ctl","getController","new_object","isPartOfNewDocument","isnew","pfacet","vrend","propcount","nviewer","getFilledPropertyList","getMissingPropertyList","standardSort","patterns","sorted","rdft","rdfc","extractLDO","full","extractJSONLD","jsonld_context","extracted","empty","getType","big","isBigType","getTypeSize","vallab","els","elements","foptions","getChoiceOptions","inputs","parsed","badData","lldom","getInputDOMs","long","latdom","longdom","getLatLongDOM","firstcol","delbut","getTypeShorthand","updateValueFromForm","op","lldoms","butspan","addbut","ipdoms","DateHelper","allowbce","date_spacer","time_spacer","datetime_separator","helper","parseDate","datepart","getDateComponentDOM","timepart","getTimeComponentDOM","hdom","hour","mdom","minute","mlab","sdom","second","slab","tz","timezone","dadom","ydom","year","month","ddom","day","part","xsd","xsdFromParsed","opdom","getEntityViewHTML","getEntityLabel","dv","nspan","il","tit","img","commas","numberWithCommas","delimiter","parseRangeValue","rvals","svals","useCommas","tnode","getRangeSymbolDOM","x2","t2node","data1","data2","firstip","secondip","showing_range","but","changeHandler","mapcontainer","ghelper","latLng","coo","path","inner","quill","d2ch","dataframe","originalValue","isDocument","nf","nvr","inline","getAPIURL","DBURL","getEntityReference","entities","bd","new_value","text_summary_length","v","nrend","getViewerForValue","isDatatypeProperty","objlit","isString","lang","isChoice","getViewerForDataValue","ft","wquery","dbc","scd","dbrec","nm","item","getControlHTML","getDocumentChooserDOM","getDocumentCreatorDOM","nbut","mcls","nlab","click","nbuts","tcdom","gb","bi","tds","bt","tts","nlabs","ccDOM","sth","banner","dhp","scs","getDeleteOnHomePage","getClassesDOM","getDbInfoBox","info","charAt","toUpperCase","slice","del","dbdel","confirm","getDBSummary","q","sct","mfd","sci","idip","titip","descip","schem","datip","butfield","cancbut","loadbut","TerminusViolation","vio","context_msg","vioHeading","getPropertyAsDOM","pdom","ldom","WOQLTextboxGenerator","meta","generator","gentype","generators","loadGenerator","hasGeneratorOptions","changeGenerator","ng","redrawGenerator","inputDOM","getQueryButtonsDOM","getResultViewDom","qbox","getQueryCreatorChoiceDOM","qtHolder","qTextBox","getQueryTextAreaDOM","buttonsDOM","qcc","gen","box","TerminusPropertyChooser","tq","qman","datatable","gatherDatatableSettings","txtArea","queryName","getQueryButtonGroups","qGroupQueries","qrow","g","srcElement","textContent","nodeName","qeb","ch","setDatatableSettings","eqh","qbut","qval","qbuts","qexs","qh","qcGroup","nqbut","aqbut","qvalue","ebut","pbut","prbut","qdGroup","termpc","qdocGroup","docch","docdom","d2dom","clGroup","dtGroup","docGroup","labopt","comopt","cprop","tsel","o1","o2","ff","getFormFieldDOM","getFormField","queries","submit","jsonip","map_source","map_target","confirm_before_update","loadSchema","msgtype","resetControlDOM","getSchemaSaveButtons","getSchemaImportActionButtons","getShowSchemaButton","getClassFrameChooser","getSchemaEditButton","getImportButton","getFormatChoices","fc","tc","tj","refreshMainPage","getSchemaViewDOM","getSchemaEditDOM","getSchemaImportDOM","getClassFrameDOM","ssb","getCancelButton","getSaveButton","getImportSaveButton","getSchemaButton","getImportPreviewButton","is_import","doImport","schema_edit_dom","func","origurl","newschema","appendSchema","setSchemaURL","showConfirmPage","s2","nschema","np","docviewer","ipval","klab","modes","overwrite","append","rsc","getServerLabelDOM","srec","getServerRecord","desc","csbut","crbut","getDBListDOM","getServerDetailsDOM","scl","wrapTableLinkCell","tdElement","sec","lihed","th1","th2","th3","th4","th5","th6","dbrecs","getServerDBRecords","fullid","td1","td2","td3","td4","td5","td6","deleteDBPermitted","delDB","url_input","key_input","getLabelDOM","ip","ltxt","pholder","stit","loadbuts"],"mappings":"kCACE,IAAIA,EAAmB,GAGvB,SAASC,EAAoBC,GAG5B,GAAGF,EAAiBE,GACnB,OAAOF,EAAiBE,GAAUC,QAGnC,IAAIC,EAASJ,EAAiBE,GAAY,CACzCG,EAAGH,EACHI,GAAG,EACHH,QAAS,IAUV,OANAI,EAAQL,GAAUM,KAAKJ,EAAOD,QAASC,EAAQA,EAAOD,QAASF,GAG/DG,EAAOE,GAAI,EAGJF,EAAOD,QA0Df,OArDAF,EAAoBQ,EAAIF,EAGxBN,EAAoBS,EAAIV,EAGxBC,EAAoBU,EAAI,SAASR,EAASS,EAAMC,GAC3CZ,EAAoBa,EAAEX,EAASS,IAClCG,OAAOC,eAAeb,EAASS,EAAM,CAAEK,YAAY,EAAMC,IAAKL,KAKhEZ,EAAoBkB,EAAI,SAAShB,GACX,oBAAXiB,QAA0BA,OAAOC,aAC1CN,OAAOC,eAAeb,EAASiB,OAAOC,YAAa,CAAEC,MAAO,WAE7DP,OAAOC,eAAeb,EAAS,aAAc,CAAEmB,OAAO,KAQvDrB,EAAoBsB,EAAI,SAASD,EAAOE,GAEvC,GADU,EAAPA,IAAUF,EAAQrB,EAAoBqB,IAC/B,EAAPE,EAAU,OAAOF,EACpB,GAAW,EAAPE,GAA8B,iBAAVF,GAAsBA,GAASA,EAAMG,WAAY,OAAOH,EAChF,IAAII,EAAKX,OAAOY,OAAO,MAGvB,GAFA1B,EAAoBkB,EAAEO,GACtBX,OAAOC,eAAeU,EAAI,UAAW,CAAET,YAAY,EAAMK,MAAOA,IACtD,EAAPE,GAA4B,iBAATF,EAAmB,IAAI,IAAIM,KAAON,EAAOrB,EAAoBU,EAAEe,EAAIE,EAAK,SAASA,GAAO,OAAON,EAAMM,IAAQC,KAAK,KAAMD,IAC9I,OAAOF,GAIRzB,EAAoB6B,EAAI,SAAS1B,GAChC,IAAIS,EAAST,GAAUA,EAAOqB,WAC7B,WAAwB,OAAOrB,EAAgB,SAC/C,WAA8B,OAAOA,GAEtC,OADAH,EAAoBU,EAAEE,EAAQ,IAAKA,GAC5BA,GAIRZ,EAAoBa,EAAI,SAASiB,EAAQC,GAAY,OAAOjB,OAAOkB,UAAUC,eAAe1B,KAAKuB,EAAQC,IAGzG/B,EAAoBkC,EAAI,GAIjBlC,EAAoBA,EAAoBmC,EAAI,I,uPClFrD,IAAMC,EAAwBC,EAAQ,GAElCC,EAAkB,CAEtBA,iBAAmC,SAASC,EAAMC,EAASC,EAAOC,EAAUC,GAChE,IAAIP,EAAf,IACIQ,EAAWC,SAASC,cAAc,QACtCF,EAASG,aAAa,QAAS,6CAA+CR,EAAO,IAAMC,GAChF,IAAIJ,EAAf,IAiBKY,EAASH,SAASC,cAAc,UA0BrC,OAzBCE,EAAOC,YAAYJ,SAASK,eAAeT,IACxCE,GACFK,EAAOD,aAAa,QAAS,kFAAoFR,EAAO,IAAMC,EAAU,aACxIQ,EAAOD,aAAa,QAASJ,KAG7BK,EAAOD,aAAa,QAAS,kEAAoER,EAAO,IAAMC,GAC9GQ,EAAOG,iBAAiB,SAAS,WAChC,GAAqB,QAAlBC,KAAKC,UAAoB,CAC3B,IAAIC,EAAQT,SAASU,uBAAuB,4BACzCD,EAAME,OAAO,EACXF,EAAM,GAAGjC,MAIRqB,EAASF,IAHbc,EAAM,GAAGP,aAAa,cAAe,kBACrCO,EAAM,GAAGG,MAAMC,WAAa,WAIzBhB,EAASF,QAEVE,EAASF,OAIhBI,EAASK,YAAYD,GAEfJ,GAGRN,mBAAqC,SAASqB,GAE7C,IADW,IAAIvB,GACPwB,gBAAgB,gBAAgB,CACvC,IAAIC,EAAOhB,SAASC,cAAc,QAIlC,MAHW,YAARa,EAAoBE,EAAKd,aAAa,QAAS,8BAClC,QAARY,GAAgBE,EAAKd,aAAa,QAAS,+BACnDc,EAAKd,aAAa,QAAS,iBACpBc,EAGP,IAAIb,EAASH,SAASC,cAAc,UAGpC,OAFAE,EAAOD,aAAa,QAAS,gBAC7BC,EAAOC,YAAYJ,SAASK,eAAe,aACpCF,GAITV,eAAiC,SAASE,GACzC,IAAIqB,EACJ,OAAOrB,GACN,IAAK,SACJqB,EAAO,cACR,MACA,IAAK,MACJA,EAAO,QACR,MACA,IAAK,QACJA,EAAO,QACR,MACA,IAAK,OACJA,EAAO,QACR,MACA,IAAK,OACJA,EAAO,aAGT,OAAOA,GAGRvB,oBAAsC,SAASC,EAAMuB,EAASC,EAAUrB,GACvE,IAAIsB,EAAMnB,SAASC,cAAc,UACjCkB,EAAIjB,aAAa,QAAS,mDAAqDR,GAC/E,IAAI,IAAInC,EAAI,EAAGA,EAAI0D,EAAQN,OAAQpD,IAAI,CACtC,IAAI6D,EAAMpB,SAASC,cAAc,UACjC,GAAwB,UAArB,EAAOgB,EAAQ1D,IAAe,CAChC6D,EAAI5C,MAAQyC,EAAQ1D,GAAGiB,MACvB,IAAIoB,EAASqB,EAAQ1D,GAAGqC,MAASI,SAASK,eAAeY,EAAQ1D,GAAGqC,OAASI,SAASK,eAAegB,eAAeC,YAAYC,aAAaN,EAAQ1D,GAAGiB,QACxJ4C,EAAIhB,YAAYR,QAGhBwB,EAAI5C,MAAQyC,EAAQ1D,GACpBqC,EAAQyB,eAAeC,YAAYC,aAAaH,EAAI5C,OACpD4C,EAAIhB,YAAYJ,SAASK,eAAeT,IAEtCsB,GAAYE,EAAI5C,OAClB4C,EAAIlB,aAAa,WAAY,YAE9BiB,EAAIf,YAAYgB,GAKjB,OAHAD,EAAIb,iBAAiB,UAAU,WAC9BT,EAASU,KAAK/B,UAER2C,GAGR1B,mBAAqC,SAAS+B,EAAOC,GACpD,IAAIC,EAAW1B,SAASC,cAAc,QAEtC,GADAyB,EAASxB,aAAa,QAAS,0BAA0BsB,EAAM,SAC3C,QAAjBC,EAAS/C,KAAe,CAC1B,IAAImB,EAAW,WAAY4B,EAASE,QAAQ,SAC5CD,EAAStB,YAAYX,EAAgBmC,iBAAiB,0BAA0BJ,EAAM,QAAS,OAAQ,SAAU3B,QAE7G,IAAG4B,EAASI,QAChB,OAAO,EAGHhC,EAAW,WAAY4B,EAASK,UACpCJ,EAAStB,YAAYX,EAAgBmC,iBAAiBJ,EAAO,SAAU,SAAU3B,IAElF,OAAO6B,GAGRjC,SAA2B,SAASH,EAAGD,EAAG9B,GACzC,IAAIwE,EAAMC,OAAOC,SAASC,KAC1B,GAAGH,EAAI,CACN,IACII,EADQJ,EAAIK,MAAM,KACN,GACZC,EAAKhB,eAAeC,YAAYgB,aAAahD,GAC1C+C,IAAIA,EAAK/C,IACZiD,EAAOF,EAAGD,MAAM,MACZzB,OAAS,IAAG0B,EAAKE,EAAK,IAC9B,IAAIC,EAASH,EACb,GAAGhD,EAAE,CACJ,IAEIkD,EAFAE,EAAOpB,eAAeC,YAAYgB,aAAajD,GAC/CoD,IAAOA,EAAOpD,IACdkD,EAAOE,EAAKL,MAAM,MACdzB,OAAS,IAAG8B,EAAOF,EAAK,IAChCC,GAAU,IAAMC,EACblF,IACFiF,GAAU,IAAMjF,GAGlByE,OAAOC,SAAWE,EAAM,IAAMK,IAIhC/C,kBAAoC,SAASiD,EAAMC,EAAMC,EAAeC,GAKvE,GAJGD,GAAkBD,EAAKhC,OAASiC,IAClCF,EAAKxC,aAAa,QAASyC,GAC3BA,EAAOA,EAAKG,UAAU,EAAGF,GAAiB,OAExCC,EAAc,CAGhB,IAFA,IAAME,EAAe,GACfC,EAAQL,EAAKP,MAAM,KACjB7E,EAAI,EAAGA,EAAIyF,EAAMrC,OAAQpD,IAAI,CACpC,IAAI0F,EAAOD,EAAMzF,GACjB,GAAG0F,EAAKtC,OAASkC,EAAc,CAC9BH,EAAKxC,aAAa,QAASyC,GAC3B,IAAIO,EAASD,EAAKH,UAAU,EAAGD,GAAiB,MAChDE,EAAaE,GAAQC,GAGvB,IAAI,IAAIC,KAAKJ,EACZJ,EAAOA,EAAKS,QAAQD,EAAGJ,EAAaI,IAGtCT,EAAKtC,YAAYJ,SAASK,eAAesC,KAG1ClD,4BAA8C,SAAS4D,EAAStE,GAC/D,IAAI,IAAID,KAAOC,EAAK,CAEnB,GADWD,EAAIgE,UAAUhE,EAAIwE,YAAY,KAAK,IACnCD,EAAQ,CAClB,IAAME,EAAMxE,EAAKD,GACjB,MAAiB,UAAd,EAAOyE,IAAmBA,EAAI,UAAkBA,EAAI,UAChDA,GAGT,OAAO,GAqBR9D,cAAgC,SAASC,EAAME,EAAOpB,EAAOgF,EAAMC,GAGlE,IAAIC,EAAU1D,SAASC,cAAc,QAMrC,GALAyD,EAAQxD,aAAa,QAAS,uCAA6CR,GAExE8D,GACFE,EAAQxD,aAAa,QAASsD,GAE5B5D,EAAM,CACR,IAAI+D,EAAQ3D,SAASC,cAAc,QACnC0D,EAAMzD,aAAa,QAAS,yCAA+CR,EAAO,UAClFiE,EAAMvD,YAAYJ,SAASK,eAAeT,IAC1C8D,EAAQtD,YAAYuD,GAErB,IAAIC,EAAU5D,SAASC,cAAc,QACrC2D,EAAQ1D,aAAa,QAAS,0CAAgDR,EAAO,WACrFkE,EAAQxD,YAAYJ,SAASK,eAAe,MAC5CqD,EAAQtD,YAAYwD,GACpB,IAAIC,EAAO7D,SAASC,cAAc,QAElC,GADA4D,EAAK3D,aAAa,QAAS,yCAA+CR,EAAO,wCAC9E+D,EACFA,EAAMjF,MAAQA,EACdqF,EAAKzD,YAAYqD,QAEb,GAAGjF,EAAO,CACd,IAAI6D,EAAKhB,eAAeC,YAAYgB,aAAa9D,GAC3C,GAAG6D,EAAG,CACL,IAAIE,EAAOF,EAAGD,MAAM,KACjBC,EAAKE,EAAK,GAChBsB,EAAK3D,aAAa,QAAS1B,GAC9BqF,EAAKzD,YAAYJ,SAASK,eAAegC,SAGzCwB,EAAKzD,YAAYJ,SAASK,eAAe7B,IAI3C,OADAkF,EAAQtD,YAAYyD,GACbH,IAGRpG,EAAOD,QAAQoC,G;;;;;;;ybCvPf,IAAMqE,EAAYtE,EAAQ,IAyK1B,SAASuE,EAAapB,GACpB,IAAIqB,EAAKhE,SAASC,cAAc,OAChC+D,EAAG9D,aAAa,QAAS,wBACzB,IAAI+D,EAAIjE,SAASC,cAAc,MAG/B,OAFAgE,EAAEzD,UAAYmC,EACdqB,EAAG5D,YAAY6D,GACRD,EA4GT,SAASE,EAAmBC,EAAIC,EAAKC,EAAK3F,GACtC,IAAI4F,EAAWH,EAAGpD,gBAAgB,cAClC,IAAKuD,EAAW,OAAO,EACvB,IACIC,EADK,IAAIT,EAAWM,EAAK1F,EAAM4F,GACvBE,cAEZ,OADAH,EAAIjE,YAAYmE,IACT,EAKX,SAASE,EAAuB3G,GAE5B,IADA,IAAI4G,EAAK1E,SAASU,uBAAuB5C,GACjCP,EAAE,EAAGA,EAAEmH,EAAG/D,OAAQpD,IACtBmH,EAAGnH,GAAGoH,UAAUC,OAAO9G,GAyB/B,SAAS+G,EAAqBH,GAC1BA,EAAGC,UAAUG,SAAS,sBACxBJ,EAAGC,UAAUC,OAAO,oBACpBF,EAAGC,UAAUI,IAAI,kBA2CnB,SAASC,EAAcN,GACtBA,EAAGC,UAAUC,OAAO,iBACpBF,EAAGC,UAAUI,IAAI,oBAIlBzH,EAAOD,QAAQ,CAAC4H,eAxEhB,SAAwBjE,EAAMkE,GACI,UAA1BA,EAAQtE,MAAMuE,SACdV,EAAuB,iBACvBzD,EAAK2D,UAAUI,IAAI,mBACnBG,EAAQtE,MAAMuE,QAAU,SAGxBV,EAAuB,mBACvBzD,EAAK2D,UAAUI,IAAI,iBACnBG,EAAQtE,MAAMuE,QAAU,UAgEjBV,yBACAP,qBACAkB,cA3Gf,SAAuBjB,EAAIC,EAAKtD,EAAMpC,GAClC,IAAI4F,EAAWH,EAAGpD,gBAAgB,cAClC,GAAKuD,EAAL,CACH,IAAIe,EAAK,IAAIvB,EAAWM,EAAK1F,EAAM4F,GAC/BgB,EAAKD,EAAGE,iBAAiBzE,GAC7BuE,EAAGG,eAAeF,KAuGJG,qBAzHf,SAA8BtB,EAAIuB,GAC9B,GAAGvB,EAAGpD,gBAAgB,cAAc,CACtC,IAAIsE,EAAKK,EAAIC,mBACbN,EAAGnF,aAAa,QAAS,iBACzBmB,eAAeC,YAAYsE,eAAeP,KAsH7BQ,eAhKf,SAAwBC,EAAUC,EAAQC,EAAUC,GAGhD,IAAIC,EAAKlG,SAASC,cAAc,MAChC+F,EAAS5F,YAAY8F,GACjBA,EAAKlG,SAASC,cAAc,MAChC+F,EAAS5F,YAAY8F,GAGrBF,EAAS5F,YAAY2D,EAAa,gBAE9BmC,EAAKlG,SAASC,cAAc,MAChC+F,EAAS5F,YAAY8F,GAEpB,IAAIC,EAAkB,GAdoC,uBAiB1D,YAAyBL,EAASM,QAAlC,+CAA2C,oBAAjCtH,EAAiC,KAA5BN,EAA4B,KACzC2H,EAAiBA,EAAiB,GAAH,OAAOrH,EAAP,cAAgBN,GAAU,MAlBD,kFAsB3D,IAAI6H,EAAQrG,SAASC,cAAc,OACnCoG,EAAMnG,aAAa,QAAS,8BAC5B,IAAIkE,EAAMpE,SAASK,eAAe8F,GAMlC,OALAE,EAAMjG,YAAYgE,GAETF,EAAmB+B,EAAYI,EAAOL,EAAU,iBACjDA,EAAS5F,YAAYiG,GAEtBP,EAASQ,OACfC,MAAK,SAAST,IA1DnB,SAAqBE,EAAUD,EAAQD,EAAUG,GAE/C,IAAIO,EAAKxG,SAASC,cAAc,OAGhCuG,EAAGpG,YAAY2D,EAAa,WAC5B,IAAImC,EAAKlG,SAASC,cAAc,MAChCuG,EAAGpG,YAAY8F,GAEf,IAAIO,EAAOC,KAAKC,UAAUb,EAAU,EAAG,GAEnCc,EAAM5G,SAASC,cAAc,OACjC2G,EAAI1G,aAAa,QAAS,yCAC1B0G,EAAIpG,UAAYiG,EAEPvC,EAAmB+B,EAAYW,EAAKJ,EAAI,eACzCA,EAAGpG,YAAYwG,GAEnBV,EAAKlG,SAASC,cAAc,MAChCuG,EAAGpG,YAAY8F,GAEfF,EAAS5F,YAAYoG,GAsCjBK,CAAYb,EAAUD,EAAQD,EAAUG,OAiI/BlC,eACA+C,gBA1Mf,SAAyBpH,EAAME,EAAOmH,GACpC,IAAIC,EAAMhH,SAASC,cAAc,OACtB,QAARP,EAAgBsH,EAAI9G,aAAa,QAAS,yCACxC8G,EAAI9G,aAAa,QAAS,SAC/B,IAAI+G,EAAMjH,SAASC,cAAc,UACjCgH,EAAIzG,UAAYZ,EAChBoH,EAAI5G,YAAY6G,GAChB,IAAI7C,EAAMpE,SAASK,eAAe0G,GAElC,OADAC,EAAI5G,YAAYgE,GACT4C,GAkMME,qBA5Wf,SAA8B1F,GAC5B,IAAI2F,EAAO,CACXA,QAAe,CACbC,KAAS,gCACTC,MAAS,seAOTC,OAAS,+EACTC,KAAS,CAACC,WAAa,MAAO1I,IAAK,WACnCmC,QAAS,CAAEwG,MAAO,GAAIC,YAAa,KAErCP,OAAc,CACZC,KAAU,iDACVC,MAAU,qTAKVC,OAAS,+EACTC,KAAS,CAACI,aAAe,MAAOC,QAAS,GAAI9I,IAAK,YAClDmC,QAAS,CAAEwG,MAAO,GAAIC,YAAa,KAErCP,OAAc,CACVC,KAAQ,wCACRC,MAAQ,wKAGRC,OAAQ,6CAEZH,UAAiB,CACfC,KAAS,sCACTC,MAAS,6JAGTC,OAAS,mGACTrG,QAAS,CAAE4G,OAAQ,WAErBV,eAAsB,CACpBC,KAAS,wDACTC,MAAS,sZAMTC,OAAS,mGACTrG,QAAS,CAAE4G,OAAQ,WAErBV,aAAoB,CAClBC,KAAU,iDACVC,MAAU,kRAIVC,OAAS,mGACTC,KAAS,CAACvH,SAAW,OACrBiB,QAAS,CAAE4G,OAAQ,SAAUC,SAAU,YAEzCX,eAAsB,CACpBC,KAAS,uDACTC,MAAS,sQAITC,OAAS,iFACTC,KAAS,CAACQ,aAAe,MAAO/H,SAAU,OAC1CiB,QAAS,CAAE4G,OAAQ,SAAUG,mBAAmB,IAElDb,aAAoB,CAClBC,KAAU,0CACVC,MAAU,6LAGVC,OAAS,8DACTC,KAAS,CAACQ,aAAe,OACzB9G,QAAS,CAAE4G,OAAQ,WAErBV,eAAsB,CACpBC,KAAS,uDACTC,MAAS,6RAITC,OAAS,mGACTC,KAAS,CAACQ,aAAe,MAAO/H,SAAU,OAC1CiB,QAAS,CAAE4G,OAAQ,SAAUC,SAAU,YAEzCX,eAAsB,CACpBC,KAAQ,yCACRC,MAAQ,0LAGRC,OAAQ,mGACRC,KAAQ,CAACQ,aAAe,QAE1BZ,OAAc,CACZC,KAAM,2CACNC,MAAO,8SAIPC,OAAQ,+CACRC,KAAM,CAACU,KAAM,SAEfd,OAAc,CACZC,KAAQ,2CACRC,MAAQ,2TAIRC,OAAQ,+CACRC,KAAQ,CAACU,KAAM,SAEjBd,OAAc,CACZC,KAAM,iDACNE,OAAQ,+CACRC,KAAM,CAACW,MAAO,MAAOC,KAAM,WAE7BhB,IAAW,CACTC,KAAM,mDACNE,OAAQ,+CACRC,KAAM,CAACa,OAAQ,OAAQC,OAAQ,OAAQJ,KAAM,SAE/Cd,cAAqB,CACnBC,KAAM,2CACNE,OAAQ,+CACRC,KAAM,CAACW,MAAO,QAEhBf,iBAAwB,CACtBC,KAAM,wDACNE,OAAQ,+CACRC,KAAM,CAACW,MAAO,MAAOhJ,SAAU,QAEjCiI,uBAA8B,CAC5BC,KAAM,+DACNE,OAAQ,+CACRC,KAAM,CAACQ,aAAc,MAAO7I,SAAU,QAExCiI,cAAqB,CACnBC,KAAM,2CACNE,OAAQ,+CACRC,KAAM,CAACW,MAAO,SAEhB,OAAOf,EAAK3F,IA0NC8G,iBA3Cf,SAA0B5D,GACtBA,EAAGC,UAAUG,SAAS,qBACxBJ,EAAGC,UAAUC,OAAO,oBACpBF,EAAGC,UAAUI,IAAI,kBAEPL,EAAGC,UAAUG,SAAS,mBAC1BJ,EAAGC,UAAUC,OAAO,iBAC1BF,EAAGC,UAAUI,IAAI,sBAqCJwD,qBAjCf,SAA8BC,GAE1B,OADY,IAAIC,WAAYC,gBAAgBF,EAAW,YAC1CG,WAAWnI,WAgCboI,wBA7Bf,SAAiCzE,GAE7BA,EAAG0E,YAAY,iBAEjB7D,EADShF,SAASU,uBAAuB,oBACzB,IAEdyD,EAAG0E,YAAY,oBAEjB7D,EADShF,SAASU,uBAAuB,uBACzB,KAsBHoI,oBAtEf,SAA6BC,EAAK9C,GAC9BxB,EAAuB,qBAY3B,SAA+BwB,GAC9B,GAAGA,EAAW9B,GAAG0E,YAAY,gBAAiB,CAE7ChE,EADS7E,SAASU,uBAAuB,oBACjB,IAEzB,GAAGuF,EAAW9B,GAAG0E,YAAY,mBAAoB,CAEhDhE,EADS7E,SAASU,uBAAuB,uBACjB,KAlBzBsI,CAAsB/C,GACtB8C,EAAIpE,UAAUI,IAAI,wB,gBCtUnB,IAAMkE,EAAazJ,EAAQ,GAE3B,SAAS0J,EAAUC,EAAQlI,EAASkD,GAMnC,GALA5D,KAAK4I,OAASA,EACd5I,KAAKU,QAAUA,EACfV,KAAK4D,GAAKA,EACV5D,KAAK6I,cAAgB,IACrB7I,KAAK8I,SAAW,GACbF,EAAOG,iBAAiBC,mBAAmB,CAC7C,IAAIC,EAAML,EAAOG,iBAAiBG,OAAO3G,UAAU,EAAGqG,EAAOG,iBAAiBG,OAAOnG,YAAY,aACjG/C,KAAKiJ,IAAMA,EACX,IAAIE,EAAQP,EAAOG,iBAAiBG,OAAO3G,UAAU,EAAGqG,EAAOG,iBAAiBG,OAAOnG,YAAY,aAAe6F,EAAOG,iBAAiBK,KAC1IpJ,KAAK8I,SAAL,EAAqBK,EAAQ,kBAC7BnJ,KAAK8I,SAAL,EAAqBG,EACrBjJ,KAAK8I,SAAL,GAAsBK,EAAQ,IAC9BnJ,KAAK8I,SAAL,IAAuBK,EAAQ,cAC/BnJ,KAAK8I,SAAL,GAAsBK,EAAQ,oBAG9BnJ,KAAKiJ,IAAML,EAAOG,iBAAiBM,YACnCrJ,KAAK8I,SAAL,EAAqBF,EAAOG,iBAAiBO,YAAc,IAC3DtJ,KAAK8I,SAAL,GAAsBF,EAAOG,iBAAiBQ,QAAU,UACxDvJ,KAAK8I,SAAL,IAAuBF,EAAOG,iBAAiBS,SAC/CxJ,KAAK8I,SAAL,GAAsBF,EAAOG,iBAAiBQ,QAAU,IACxDvJ,KAAK8I,SAAL,EAAqBF,EAAOG,iBAAiBM,YAE9C,IAAI,IAAII,KAAQ3I,eAAeC,YAAY2I,cAC1C1J,KAAK8I,SAASW,GAAQ3I,eAAeC,YAAY2I,cAAcD,GAIjEd,EAAU/J,UAAU+K,YAAc,SAASb,GAC1C9I,KAAK8I,SAAWA,GAIjBH,EAAU/J,UAAUgL,QAAU,SAASpI,GACtC,IAAI,IAAIiI,KAAQzJ,KAAK8I,SACpB,GAAG9I,KAAK8I,SAASW,IAASjI,EAAIe,UAAU,EAAGvC,KAAK8I,SAASW,GAAMrJ,QAC9D,OAASqJ,EAAO,IAAMjI,EAAIe,UAAUvC,KAAK8I,SAASW,GAAMrJ,QAG1D,OAAOoB,GAGRmH,EAAU/J,UAAUiL,QAAU,SAASnC,GACtC,IAAIoC,EAAU9J,KAAKmC,KAAKuF,GACpBqC,EAAO/J,KACX,OAAOA,KAAK4I,OAAOoB,QAAO,EAAOF,GAChC9D,MAAK,SAAST,GAEd,OADU,IAAImD,EAAWA,WAAWnD,EAAUwE,EAAMA,EAAKrJ,QAASqJ,EAAKnG,QAKzE+E,EAAU/J,UAAUuD,KAAO,SAASuF,GAQnC,MAPY,CACX,WAAa1H,KAAK8I,SAClB,KAAQ,CACP9I,KAAK4I,OAAOG,iBAAiBQ,QAC7B7B,KAMHiB,EAAU/J,UAAUqL,gCAAkC,SAASC,GAC1DA,EAAOA,GAAQ,UASnB,MARU,CACTC,IAAK,CACJnK,KAAKoK,wBAAwBF,EAAM,gBACnC,CACCG,IAAK,CAACrK,KAAKsK,wBAAwBJ,QAOvCvB,EAAU/J,UAAU0L,wBAA0B,SAASxH,GAItD,MAHS,CACRyH,KAAM,CAACzH,EAAS,UAAW,eAAgB,eAK7C6F,EAAU/J,UAAUwL,wBAA0B,SAAStH,EAAS0H,GAE/D,MADU,CAACC,IAAK,CAAC3H,EAAS0H,KAI3B7B,EAAU/J,UAAU8L,sBAAwB,SAASC,EAAOC,EAAOC,GAQlE,MALY,CACXD,MAAO,CAHRA,EAAQA,GAAgB5K,KAAK6I,cAGb,CACdgC,MAAO,CAHTA,EAAQA,GAAgB,EAGPF,OAOlBhC,EAAU/J,UAAUkM,oBAAsB,SAASC,EAAYH,EAAOC,GACrE,IAAIF,EAAQ,CACXR,IAAK,CACJ,CACCa,OAAQ,CAAC,aAAc,WAAY,WAEpChL,KAAKoK,wBAAwB,SAAU,kBAMzC,OAHGW,GACFJ,EAAMR,IAAIc,KAAKF,GAET/K,KAAK0K,sBAAsBC,EAAOC,EAAOC,IAGjDlC,EAAU/J,UAAUsM,mBAAqB,SAASH,EAAYH,EAAOC,GACpE,IAAIM,EAAQ,CAACH,OAAQ,CAAC,YAAa,cAAe,aAIlD,OAHGD,IACFI,EAAQ,CAAChB,IAAK,CAACgB,EAAOJ,KAEhB/K,KAAK0K,sBAAsBS,EAAOP,EAAOC,IAGjDlC,EAAU/J,UAAUwM,qBAAuB,SAASL,EAAYH,EAAOC,GACtE,IAAIM,EAAQ,CACXhB,IAAK,CAAC,CAACI,KAAM,CAAC,aAAc,aAAc,UAAW,cACpD,CACC1J,IAAK,CAAC,CAAC0J,KAAM,CAAC,aAAc,WAAY,SAAU,gBAEnD,CACC1J,IAAK,CAAC,CAAC0J,KAAM,CAAC,aAAc,aAAc,UAAW,gBAEtD,CACC1J,IAAK,CAAC,CAAC0J,KAAM,CAAC,aAAc,eAAgB,YAAa,gBAE1D,CACC1J,IAAK,CAAC,CAAC0J,KAAM,CAAC,aAAc,cAAe,WAAY,kBAO1D,OAHGQ,IACFI,EAAQ,CAAChB,IAAK,CAACgB,EAAOJ,KAEhB/K,KAAK0K,sBAAsBS,EAAOP,EAAOC,IAIjDlC,EAAU/J,UAAUyM,wBAA0B,SAASN,EAAYH,EAAOC,GACzE,IAAIM,EAAQ,CACXhB,IAAK,CAAC,CAACI,KAAM,CAAC,YAAa,WAAY,SAAU,cAChD,CACC1J,IAAK,CAAC,CAAC0J,KAAM,CAAC,YAAa,aAAc,UAAW,gBAErD,CACC1J,IAAK,CAAC,CAAC0J,KAAM,CAAC,YAAa,eAAgB,YAAa,gBAEzD,CACC1J,IAAK,CAAC,CAAC0J,KAAM,CAAC,YAAa,UAAW,aAAc,gBAErD,CACC1J,IAAK,CAAC,CAAC0J,KAAM,CAAC,YAAa,cAAe,WAAY,gBAEvD,CACC1J,IAAK,CAAC,CAAC0J,KAAM,CAAC,YAAa,aAAc,UAAW,kBAOvD,OAHGQ,IACFI,EAAQ,CAAChB,IAAK,CAACgB,EAAOJ,KAEhB/K,KAAK0K,sBAAsBS,EAAOP,EAAOC,IAGjDlC,EAAU/J,UAAU0M,0BAA4B,SAASP,EAAYH,EAAOC,GAC3E,IAAIM,EAAQ,CACXhB,IAAK,CAAC,CAACI,KAAM,CAAC,YAAa,WAAY,YAAa,cACnD,CACC1J,IAAK,CAAC,CAAC0J,KAAM,CAAC,YAAa,aAAc,UAAW,gBAErD,CACC1J,IAAK,CAAC,CAAC0J,KAAM,CAAC,YAAa,eAAgB,YAAa,gBAEzD,CACC1J,IAAK,CAAC,CAAC0J,KAAM,CAAC,YAAa,UAAW,aAAc,kBAOvD,OAHGQ,IACFI,EAAQ,CAAChB,IAAK,CAACgB,EAAOJ,KAEhB/K,KAAK0K,sBAAsBS,EAAOP,EAAOC,IAGjDlC,EAAU/J,UAAU2M,sBAAwB5C,EAAU/J,UAAU0M,0BAEhE3C,EAAU/J,UAAU4M,0BAA4B,SAASC,EAAQb,EAAOC,GACvE,IAAIM,EAAQ,CACXhB,IAAK,CAAC,CAACa,OAAQ,CAAC,aAAc,WAAYS,IACzC,CACC5K,IAAK,CAAC,CAACmK,OAAQ,CAAC,aAAc,aAAc,gBAI/C,OAAOhL,KAAK0K,sBAAsBS,EAAOP,EAAOC,IAGjDlC,EAAU/J,UAAU8M,6BAA+B,SAASD,EAAQb,EAAOC,GAC1E,IAAIM,EAAQ,CACXhB,IAAK,CAAC,CAACa,OAAQ,CAAC,aAAcS,EAAQ,YACrC,CACC5K,IAAK,CAAC,CAACmK,OAAQ,CAAC,aAAc,aAAc,gBAI/C,OAAOhL,KAAK0K,sBAAsBS,EAAOP,EAAOC,IAGjDlC,EAAU/J,UAAU+M,gBAAkB,SAASnK,EAAKoJ,EAAOC,GAC1D,IAAIM,EAAQ,CACXhB,IAAK,CACJ,CAACa,OAAQ,CAACxJ,EAAK,aAAc,oBAC7B,CAACwJ,OAAQ,CAACxJ,EAAK,WAAY,mBAC3B,CACCX,IAAK,CAAC,CAACmK,OAAQ,CAACxJ,EAAK,eAAgB,wBAEtC,CACCX,IAAK,CAAC,CAAC0J,KAAM,CAAC,iBAAkB,aAAc,eAAgB,kBAIjE,OAAOvK,KAAK0K,sBAAsBS,EAAOP,EAAOC,IAIjDlC,EAAU/J,UAAUgN,iBAAmB,SAASC,EAAIjB,EAAOC,GAC1D,IAAIM,EAAQ,CACXhB,IAAK,CACJ,CAACa,OAAQ,CAACa,EAAI,aAAc,qBAC5B,CACChL,IAAK,CAAC,CAAC0J,KAAM,CAAC,aAAc,aAAc,mBAAoB,gBAE/D,CACC1J,IAAK,CAAC,CAAC0J,KAAM,CAAC,aAAc,WAAY,kBAAmB,kBAI9D,OAAOvK,KAAK0K,sBAAsBS,EAAOP,EAAOC,IAGjDlC,EAAU/J,UAAUkN,gBAAkB,WAkBrC,MAjBY,CACX3B,IAAK,CACJ,CAACa,OAAQ,CAAC,OAAQ,WAAY,YAC9B,CACCnK,IAAK,CAAC,CAACmK,OAAQ,CAAC,OAAQ,aAAc,cAEvC,CACCnK,IAAK,CAAC,CAACmK,OAAQ,CAAC,OAAQ,eAAgB,gBAEzC,CACCnK,IAAK,CAAC,CAAC0J,KAAM,CAAC,UAAW,aAAc,SAAU,gBAElD,CACCE,IAAK,CAAC,UAAW,oBAOrB1N,EAAOD,QAAQ6L,G,mPCjRf,SAAS3J,IACRgB,KAAK+L,UAAY,GACjB/L,KAAKgM,OAAS,GACdhM,KAAKiM,QAAU,GACfjM,KAAKkM,UAAY,GACjBlM,KAAKmM,QAAU,GACfnM,KAAKmM,QAAQ,gBAAkB,CAC9B9M,MAAO,eACP+M,IAAK,CAAC,8EAEPpM,KAAKmM,QAAL,MAAwB,CACvB9M,MAAO,QACPgN,GAAI,CAAC,8CACLD,IAAK,CAAC,iDAEPpM,KAAKmM,QAAL,WAA6B,CAC5B9M,MAAQ,cACRgN,GAAI,CAAC,yEACJ,2EACA,2EACA,iFACA,yFACA,sFACA,mFACA,oFACE,6EACF,uFACA,uFACA,yFAEDD,IAAK,CACJ,0EACA,oFACA,yEACA,iFACA,+EAGFpM,KAAKmM,QAAL,OAAyB,CACxB9M,MAAO,SACPgN,GAAI,CAAC,gDAENrM,KAAKmM,QAAL,SAA2B,CAC1B9M,MAAO,YACP+M,IAAK,CAAC,qEACNC,GAAI,CAAC,kDACLC,SAAU,CAAC,WAEZtM,KAAKmM,QAAL,WAA6B,CAC5B9M,MAAO,cACPgN,GAAI,CAAC,iEACH,kGACFD,IAAK,CAAC,oEACNE,SAAU,CAAC,WAQZtM,KAAKmM,QAAL,MAAwB,CACvB9M,MAAO,cACPgN,GAAI,CAAC,4CAGNrM,KAAKmM,QAAL,GAAqB,CACpB9M,MAAO,KACPgN,GAAI,CAAC,+CACLC,SAAU,CAAC,WAEZtM,KAAKmM,QAAL,QAA0B,CACzB9M,MAAO,WACPgN,GAAI,CAAC,0EACLD,IAAK,CAAC,4EACNE,SAAU,CAAC,WAsBbtN,EAAsBJ,UAAU2N,iBAAmB,SAASC,GAC3D,IAAI,IAAI1N,KAAK0N,EACZ,GAAIxM,KAAKmM,QAAQrN,GACjB,IAAI,IAAI8D,KAAK4J,EAAK1N,GACjBkB,KAAKmM,QAAQrN,GAAG8D,GAAK4J,EAAK1N,GAAG8D,IAKhC5D,EAAsBJ,UAAU6N,KAAO,SAASD,EAAMxG,GAClDwG,GAAMxM,KAAKuM,iBAAiBC,GAC/BxM,KAAK0M,qBACL,IAAIC,EAAS3M,KAAK4M,6BAA6BJ,GAC/C,GAAGG,GAAUA,EAAO,GAAGvM,OACtB,GAAGuM,EAAO,GAAGvM,OAAO,CACnB,IAAI2J,EAAO/J,KAIXA,KAAK6M,YAAYF,EAAO,IAHZ,WACX5C,EAAK8C,YAAYF,EAAO,GAAI3G,WAK7BhG,KAAK6M,YAAYF,EAAO,GAAI3G,QAGtBA,GACPA,KAIFhH,EAAsBJ,UAAUgO,6BAA+B,SAASJ,GACvE,GAAGA,EAAK,CACP,IAAIM,EAAO,GACX,IAAI,IAAIC,KAAOP,EACXA,EAAKO,KAA8B,GAAtBD,EAAKE,QAAQD,KACL,UAApB,EAAOP,EAAKO,KAAoBP,EAAKO,GACvCD,EAAK7B,KAAK8B,GAEiB,UAApB,EAAOP,EAAKO,WACa,IAApBP,EAAKO,GAAKf,QAA0BQ,EAAKO,GAAKf,SACzDc,EAAK7B,KAAK8B,SAOVD,EAAO9M,KAAKiN,oBAGjB,IADA,IAAIC,EAAc,GACVlQ,EAAI,EAAGA,EAAE8P,EAAK1M,OAAQpD,KACO,GAAjCgD,KAAKgM,OAAOgB,QAAQF,EAAK9P,MAAiD,GAApCgD,KAAK+L,UAAUiB,QAAQF,EAAK9P,KACpEkQ,EAAYjC,KAAK6B,EAAK9P,IAGxB,IAAImQ,EAAgB,CAAC,GAAI,IACzB,IAAQnQ,EAAI,EAAGA,EAAEkQ,EAAY9M,OAAQpD,IACjCgD,KAAKmM,QAAQe,EAAYlQ,MACxBgD,KAAKmM,QAAQe,EAAYlQ,IAAIsP,UAAYtM,KAAKmM,QAAQe,EAAYlQ,IAAIsP,SAASlM,OACjF+M,EAAc,GAAGlC,KAAKiC,EAAYlQ,IAGlCmQ,EAAc,GAAGlC,KAAKiC,EAAYlQ,KAIrC,OAAOmQ,GAGRnO,EAAsBJ,UAAUwO,oBAAsB,WACrD,OAAOpN,KAAKmM,SAGbnN,EAAsBJ,UAAU8N,mBAAqB,WACpD,IAAI,IAAIW,KAAMrN,KAAKmM,QACfnM,KAAKQ,gBAAgB6M,IACvBrN,KAAK+L,UAAUd,KAAKoC,IAKvBrO,EAAsBJ,UAAU4B,gBAAkB,SAAS8M,EAAQC,GAClE,GAAkC,UAA/B,EAAOvN,KAAKmM,QAAQmB,IAAoB,CAC1C,IAAIE,EAAaxN,KAAKmM,QAAQmB,GAC9B,GAAGE,EAAWlB,UAAYkB,EAAWlB,SAASlM,OAC7C,IAAI,IAAIpD,EAAG,EAAIA,EAAIwQ,EAAWlB,SAASlM,OAAQpD,IAC9C,IAAIgD,KAAKQ,gBAAgBgN,EAAWlB,SAAStP,GAAIuQ,GAChD,OAAO,IAIcC,EAAWC,SAAUD,EAAWC,QACxD,OAAOH,GACN,IAAK,SACJ,MAAoB,oBAAVI,OAKX,IAAK,WACJ,IACC,GAAoB,oBAAVA,QAAyBA,OAAOC,WAAYD,OAAOE,GAAGC,QAAU,OAAO,EAElF,MAAMC,IACN,OAAO,EAGR,IAAK,QACJ,MAAmB,oBAATC,MAIX,IAAK,aACJ,MAAwB,oBAAdC,WAIX,IAAK,aACJ,MAAwB,oBAAdC,YACHjO,KAAKmM,QAAQmB,GAErB,IAAK,eAEJ,OAAOtN,KAAKkO,mBAEb,IAAK,aACH,QAAoB,oBAAVR,SAAyBA,OAAOC,WAAYD,OAAOE,GAAGO,YAGlE,IAAK,UACH,QAAoB,oBAAVT,SAAyBA,OAAOC,WAAYD,OAAOE,GAAGQ,UAGlE,IAAK,QACJ,MAAoB,oBAAVC,aAA+C,IAAfA,OAAOC,KAGlD,IAAK,aACJ,MAAgB,oBAANC,SAAsC,IAAVA,GAAGC,IAG1C,IAAK,KACJ,MAAgB,oBAANC,SAMZC,QAAQC,IAAI,IAAIC,MAAMtB,EAAS,kCAEhC,OAAO,GAGRtO,EAAsBJ,UAAUsP,iBAAmB,WAClD,IAKcW,EAASlQ,EALnBmQ,EAAOrP,SAASC,cAAc,QAGlC,GAFAoP,EAAKC,UAAY,KACjBD,EAAKzO,MAAMuE,QAAU,OAClBnF,SAASuP,KAAK,CAChBvP,SAASuP,KAAKC,aAAaH,EAAMrP,SAASuP,KAAK5G,YAI/C,IAAI4D,GAAS,EAMb,MAJkC,wBALrB6C,EAIMC,EAJGnQ,EAIG,cAHhB8C,OAAOyN,iBAAiBL,EAAS,MAAMM,iBAAiBxQ,IAIpDkE,QAAQ,KAAM,MAC1BmJ,GAAS,GAEVvM,SAASuP,KAAKI,YAAYN,GACnB9C,EAER,OAAO,GAGRhN,EAAsBJ,UAAUqO,kBAAoB,WAEnD,MADe,CAAC,iBAIjBjO,EAAsBJ,UAAUiO,YAAc,SAASV,EAASnG,GAO/D,IANA,IAAIqJ,EAASlD,EAAQ/L,OACjBkP,EAAQ,aACND,GAAU,GAAKrJ,GACnBA,KAGMhJ,EAAI,EAAGA,EAAImP,EAAQ/L,OAAQpD,IAClCgD,KAAKuP,WAAWpD,EAAQnP,GAAIsS,IAI9BtQ,EAAsBJ,UAAU2Q,WAAa,SAASjC,EAAQtH,GAC7D,IAAIwJ,EAAMxP,KAAKmM,QAAQmB,GACvB,GAAGkC,EAAIpD,IACN,IAAI,IAAIpP,EAAE,EAAGA,EAAEwS,EAAIpD,IAAIhM,OAAQpD,IAAI,CAClC,IAAIyS,EAAQnC,EAAS,QAAUtQ,EAC/B8D,eAAeC,YAAY2O,eAAeD,EAAOD,EAAIpD,IAAIpP,IAG3D,IAAI2S,EAAWH,EAAInD,GAAKmD,EAAInD,GAAK,GAOjC,GANa,SAAViB,GAAqBkC,EAAIjR,MAC3BoR,EAAQ,IAAM,QAAUH,EAAIjR,KAE1BiR,EAAIlC,OAGM,cAAVA,EAAuB,CACzB,IAAIxI,EAAK6K,EAAQ,GACb1G,EAAMqE,EAAS,QAAUqC,EAAQvP,OAAQ,GAC7CuP,EAAQC,OAAO,EAAG,GAClB,IAAI7F,EAAO/J,KAIXc,eAAeC,YAAY8O,kBAAkB5G,EAAKnE,GAHtC,WACXiF,EAAK+F,kBAAkBxC,EAAQqC,EAAS3J,WAKzChG,KAAK8P,kBAAkBxC,EAAQqC,EAAS3J,IAI1ChH,EAAsBJ,UAAUkR,kBAAoB,SAASxC,EAAQqC,EAAS3J,GAC7E,IAAIqJ,EAASM,EAAQvP,OAAS,EAC1B2J,EAAO/J,KACPsP,EAAQ,WACE,GAAVD,KACiC,GAAhCtF,EAAKiC,OAAOgB,QAAQM,IACtBvD,EAAKiC,OAAOf,KAAKqC,IAEkB,GAAjCvD,EAAKkC,QAAQe,QAAQM,IACvBvD,EAAKkC,QAAQ2D,OAAO7F,EAAKkC,QAAQe,QAAQM,GAAS,GAEnDtH,KAEDqJ,KAEoB,GAAlBM,EAAQvP,OACVJ,KAAKgM,OAAOf,KAAKqC,GAGjBtN,KAAKiM,QAAQhB,KAAKqC,GAEnB,IAAI,IAAItQ,EAAI,EAAGA,EAAE2S,EAAQvP,OAAQpD,IAAI,CACpC,IAAIiM,EAAMqE,EAAS,OAAStQ,EAC5B8D,eAAeC,YAAY8O,kBAAkB5G,EAAK0G,EAAQ3S,GAAIsS,KAIhEtQ,EAAsBJ,UAAUmR,YAAc,SAAS3D,GACtD4D,OAAS,sBACT,IAAIC,EAASxQ,SAASyQ,eAAeF,QAClCC,GACFA,EAAOE,WAAWf,YAAYa,GAE5B7D,IACFgE,OAAS,OAAShE,EAAM,OACxBtL,eAAeC,YAAY2O,eAAeM,OAAQI,UAIpDpR,EAAsBJ,UAAUyR,eAAiB,SAAStD,GACzD,OAAyC,IAAjC/M,KAAKkM,UAAUc,QAAQD,IAAe/M,KAAKsQ,sBAAsBvD,IAG1E/N,EAAsBJ,UAAU0R,sBAAwB,SAASvD,GAChE,OAAgC,GAA7B/M,KAAKgM,OAAOgB,QAAQD,MACY,GAAhC/M,KAAK+L,UAAUiB,QAAQD,KACO,GAA9B/M,KAAKiM,QAAQe,QAAQD,KAIzB/N,EAAsBJ,UAAUW,SAAW,SAASwN,EAAK/J,GACxD,IAAmC,GAAhChD,KAAKkM,UAAUc,QAAQD,GAAY,OAAO,EAC7C,GAAG/J,EAAIsJ,SACN,IAAI,IAAItP,EAAI,EAAGA,EAAEgG,EAAIsJ,SAASlM,OAAQpD,IACrC,IAAIgD,KAAKsQ,sBAAsBtN,EAAIsJ,SAAStP,IAAK,OAAO,EAG1D,OAAO,GAGRgC,EAAsBJ,UAAU2R,aAAe,SAASC,EAAQxN,EAAKY,GACpE,IAAI6M,EAAIhR,SAASC,cAAc,KAC3BgR,EAAKjR,SAASC,cAAc,QAChC+Q,EAAE5Q,YAAY6Q,GACdA,EAAG/Q,aAAa,QAAS,2BACzB,IAAIgR,EAAOlR,SAASC,cAAc,SAClCiR,EAAK9E,GAAK,2BAA6B2E,EACvCG,EAAKxR,KAAO,YAC0B,GAAnCa,KAAK+L,UAAUiB,QAAQwD,IACzBG,EAAKC,SAAU,EACfD,EAAKpR,UAAW,IAEuB,GAAhCS,KAAKgM,OAAOgB,QAAQwD,GAC3BG,EAAKC,SAAU,GAEyB,GAAjC5Q,KAAKiM,QAAQe,QAAQwD,GAC5BG,EAAKC,SAAU,EAER5Q,KAAKT,SAASiR,EAAQxN,KAC7B2N,EAAKpR,UAAW,GAEjB,IAAIsR,EAAOpR,SAASC,cAAc,SAClCmR,EAAKlR,aAAa,QAAS,0CAC3BkR,EAAKlR,aAAa,MAAOgR,EAAK9E,IAC9BgF,EAAKhR,YAAYJ,SAASK,eAAekD,EAAI3D,QAC7CqR,EAAG7Q,YAAYgR,GACfH,EAAG7Q,YAAY8Q,GACf,IAAI5G,EAAO/J,KAIX,OAHA2Q,EAAK5Q,iBAAiB,UAAU,WAC/BgK,EAAK+G,aAAaN,EAAQ5M,MAEpB6M,GAGRzR,EAAsBJ,UAAUkS,aAAe,SAASN,EAAQ5M,GAC/D,IAAmC,GAAhC5D,KAAKgM,OAAOgB,QAAQwD,GAAc,CAIpCxQ,KAAKuP,WAAWiB,GAHL,WACV5M,EAAGmN,iBAKJ/Q,KAAKgR,aAAaR,GAEnB1P,eAAeC,YAAYsE,eAAezB,EAAGuI,SAC7CvI,EAAGqN,eAGJjS,EAAsBJ,UAAUoS,aAAe,SAASR,GACvD,IAAIxQ,KAAKmM,QAAQqE,KAA2C,GAAhCxQ,KAAKgM,OAAOgB,QAAQwD,GAE/C,OADA9B,QAAQC,IAAI,IAAIC,MAAM4B,EAAS,kDACxB,EAER,IAAIhB,EAAMxP,KAAKmM,QAAQqE,GACnBU,EAAO1B,EAAInD,GAAMmD,EAAInD,GAAGjM,OAAS,EAClCoP,EAAIlC,QAAQ4D,IACf,IAAI,IAAIlU,EAAE,EAAGA,EAAGkU,EAAKlU,IAAI,CACxB,IAAIgT,EAASQ,EAAS,OAASxT,GAC3BiT,EAASxQ,SAASyQ,eAAeF,KAEpCC,EAAOE,WAAWf,YAAYa,GAGhCiB,EAAO1B,EAAIpD,IAAMoD,EAAIpD,IAAIhM,OAAS,EAClC,IAAQpD,EAAE,EAAGA,EAAGkU,EAAKlU,IAAI,CACxB,IACIiT,EADAD,EAASQ,EAAS,QAAUxT,GAC5BiT,EAASxQ,SAASyQ,eAAeF,KAEpCC,EAAOE,WAAWf,YAAYa,GAGhCjQ,KAAKgM,OAAO4D,OAAO5P,KAAKgM,OAAOgB,QAAQwD,GAAS,IAGjDxR,EAAsBJ,UAAUuS,SAAW,SAASvN,GACnD,IAAIwN,EAAK3R,SAASC,cAAc,QAChC0R,EAAGzR,aAAa,QAAS,2BACzB,IAAI0R,EAAM5R,SAASC,cAAc,QACjC2R,EAAI1R,aAAa,QAAS,uEAC1B0R,EAAIxR,YAAYJ,SAASK,eAAe,YACxCsR,EAAGvR,YAAYwR,GACf,IAAIZ,EAAIhR,SAASC,cAAc,KAS/B,OARAM,KAAKsR,YAAYb,EAAG7M,GACpByN,EAAIxR,YAAY4Q,GAChBA,EAAEpQ,MAAMuE,QAAU,OAClByM,EAAItR,iBAAiB,SAAS,WACP,QAAnB0Q,EAAEpQ,MAAMuE,QACV6L,EAAEpQ,MAAMuE,QAAU,QACd6L,EAAEpQ,MAAMuE,QAAU,UAEjBwM,GAGRpS,EAAsBJ,UAAU0S,YAAc,SAASb,EAAG7M,GAEzD,IAAI,IAAImJ,KADR0D,EAAE9Q,aAAa,QAAS,2BACTK,KAAKmM,QACnBsE,EAAE5Q,YAAYG,KAAKuQ,aAAaxD,EAAK/M,KAAKmM,QAAQY,GAAMnJ,KAI1D7G,EAAOD,QAAQkC,G,8RC7df,IAAMuS,aAActS,oBAAQ,GACtBuS,iBAAmBvS,oBAAQ,IAC3BwS,iBAAmBxS,oBAAQ,IAC3ByS,kBAAoBzS,oBAAQ,IAC5B0S,kBAAoB1S,oBAAQ,IAC5B2S,iBAAmB3S,oBAAQ,IAC3B4S,iBAAmB5S,oBAAQ,IAC3B6S,qBAAuB7S,oBAAQ,IAC/B8S,qBAAuB9S,oBAAQ,IAC/B+S,eAAiB/S,oBAAQ,IACzBgT,eAAiBhT,oBAAQ,IACzBiT,iBAAmBjT,oBAAQ,IAC3BkT,iBAAmBlT,oBAAQ,IAC3BmT,gBAAkBnT,oBAAQ,IAC1BoT,gBAAkBpT,oBAAQ,IAC1BqT,eAAiBrT,oBAAQ,IACzBsT,iBAAmBtT,oBAAQ,IAC3BuT,gBAAkBvT,oBAAQ,IAC1BwT,gBAAkBxT,oBAAQ,IAC1ByT,mBAAqBzT,oBAAQ,IAC7B0T,gBAAkB1T,oBAAQ,IAC1B2T,gBAAkB3T,oBAAQ,IAC1B4T,iBAAmB5T,oBAAQ,IAC3B6T,eAAiB7T,oBAAQ,IAG3B8T,aAAe,CAClBC,sBAAuB,GACvBC,sBAAuB,GACvBC,0BAA2B,GAC3BC,0BAA2B,GAC3BC,wBAAyB,GACzBC,wBAAyB,GACzBC,uBAAwB,SAASnU,EAAMoU,GACtC,IAAIC,EAAS,CAAC,oBAOd,OANGD,QAA6D,IAAzCvT,KAAKgT,sBAAsBO,KACjDC,EAASA,EAAOC,OAAOzT,KAAKgT,sBAAsBO,UAEL,IAApCvT,KAAKgT,sBAAsB7T,KACpCqU,EAASA,EAAOC,OAAOzT,KAAKgT,sBAAsB7T,KAE5CqU,GAERE,uBAAwB,SAASvU,EAAMoU,GACtC,IAAIC,EAAS,CAAC,oBACd,GAAGD,QAA6D,IAAzCvT,KAAKiT,sBAAsBM,GAA0B,CAC3E,IAAII,EAAU3T,KAAKiT,sBAAsBM,GACzC,GAAGI,EACF,IAAI,IAAI3W,EAAI,EAAGA,EAAE2W,EAAQvT,OAAQpD,KACE,GAA/BwW,EAAOxG,QAAQ2G,EAAQ3W,KAAWwW,EAAOvI,KAAK0I,EAAQ3W,IAO5D,YAH8C,IAApCgD,KAAKiT,sBAAsB9T,KACpCqU,EAASA,EAAOC,OAAOzT,KAAKiT,sBAAsB9T,KAE5CqU,GAERI,2BAA4B,SAASjV,EAAUkV,EAAUC,EAAWC,GACnE,IAAIP,EAAS,CAAC,sBAad,OAZG7U,QAA+D,IAA5CqB,KAAKkT,0BAA0BvU,KACpD6U,EAASA,EAAOC,OAAOzT,KAAKkT,0BAA0BvU,KAEpDmV,QAAiE,IAA7C9T,KAAKkT,0BAA0BY,KACrDN,EAASA,EAAOC,OAAOzT,KAAKkT,0BAA0BY,KAEpDC,QAA6D,IAA3C/T,KAAKkT,0BAA0Ba,KACnDP,EAASA,EAAOC,OAAOzT,KAAKkT,0BAA0Ba,KAEpDF,QAA+D,IAA5C7T,KAAKkT,0BAA0BW,KACpDL,EAASA,EAAOC,OAAOzT,KAAKkT,0BAA0BW,KAEhDL,GAERQ,2BAA4B,SAASrV,EAAUkV,EAAUC,EAAWC,GACnE,IAAIP,EAAS,CAAC,sBAad,OAZG7U,QAA+D,IAA5CqB,KAAKmT,0BAA0BxU,KACpD6U,EAASA,EAAOC,OAAOzT,KAAKmT,0BAA0BxU,KAEpDmV,QAAiE,IAA7C9T,KAAKmT,0BAA0BW,KACrDN,EAASA,EAAOC,OAAOzT,KAAKmT,0BAA0BW,KAEpDC,QAA6D,IAA3C/T,KAAKmT,0BAA0BY,KACnDP,EAASA,EAAOC,OAAOzT,KAAKmT,0BAA0BY,KAEpDF,QAA+D,IAA5C7T,KAAKmT,0BAA0BU,KACpDL,EAASA,EAAOC,OAAOzT,KAAKmT,0BAA0BU,KAEhDL,GAERS,UAAW,mBAAS9U,KAAMuB,SACzB,IAAIwT,GAAKlU,KAAKmU,UAAUhV,MACxBuB,QAAWA,SAAmB,GAC9B,IACC,IAAI0T,OAASC,KAAK,OAASlV,KAAO,IAAMA,KAAO,IAAMgH,KAAKC,UAAU1F,SAAW,KAC/E,OAAO0T,OAER,MAAMtG,GACLwG,MAAM,oBAAsBxG,EAAEyG,cAGhCC,4BAA6B,SAASrV,EAAM+B,GAI3C,IAHA,IAAIuT,EAAU,GACVC,EAAW,GACXlI,EAAOxM,KAAK4T,2BAA2BzU,GACnCnC,EAAI,EAAGA,EAAEwP,EAAKpM,OAAQpD,KACI,GAA9B0X,EAAS1H,QAAQR,EAAKxP,KACxB0X,EAASzJ,KAAKuB,EAAKxP,IAGrB,IAAQA,EAAI,EAAGA,EAAE0X,EAAStU,OAAQpD,IACjC,GAAGgD,KAAKmU,UAAUO,EAAS1X,IAAI,CAC9B,IAAI2X,EAAO3U,KAAKmU,UAAUO,EAAS1X,IACnCyX,EAAQxJ,KAAK,CAAChN,MAAOyW,EAAS1X,GAAIqC,MAAOsV,EAAKtV,QAGhD,OAAOoV,GAERG,4BAA6B,SAASzV,EAAM+B,GAI3C,IAHA,IAAIuT,EAAU,GACVC,EAAW,GACXlI,EAAOxM,KAAKgU,6BACRhX,EAAI,EAAGA,EAAEwP,EAAKpM,OAAQpD,KACI,GAA9B0X,EAAS1H,QAAQR,EAAKxP,KACxB0X,EAASzJ,KAAKuB,EAAKxP,IAGrB,IAAQA,EAAI,EAAGA,EAAE0X,EAAStU,OAAQpD,IACjC,GAAGgD,KAAKmU,UAAUO,EAAS1X,IAAI,CAC9B,IAAI2X,EAAO3U,KAAKmU,UAAUO,EAAS1X,IACnCyX,EAAQxJ,KAAK,CAAChN,MAAOyW,EAAS1X,GAAIqC,MAAOsV,EAAKtV,QAGhD,OAAOoV,GAGRI,wBAAyB,SAAS1V,EAAMoU,GAIvC,IAHA,IAAIkB,EAAU,GACVC,EAAW,GACXlI,EAAOxM,KAAKsT,uBAAuBnU,EAAMoU,GACrCvW,EAAI,EAAGA,EAAEwP,EAAKpM,OAAQpD,KACI,GAA9B0X,EAAS1H,QAAQR,EAAKxP,KACxB0X,EAASzJ,KAAKuB,EAAKxP,IAGrB,IAAQA,EAAI,EAAGA,EAAE0X,EAAStU,OAAQpD,IACjC,GAAGgD,KAAKmU,UAAUO,EAAS1X,IAAI,CAC9B,IAAI2X,EAAO3U,KAAKmU,UAAUO,EAAS1X,IACnCyX,EAAQxJ,KAAK,CAAChN,MAAOyW,EAAS1X,GAAIqC,MAAOsV,EAAKtV,QAGhD,OAAOoV,GAERK,wBAAyB,SAAS3V,EAAMoU,GAIvC,IAHA,IAAIkB,EAAU,GACVC,EAAW,GACXlI,EAAOxM,KAAK0T,uBAAuBvU,EAAMoU,GACrCvW,EAAI,EAAGA,EAAEwP,EAAKpM,OAAQpD,KACI,GAA9B0X,EAAS1H,QAAQR,EAAKxP,KACxB0X,EAASzJ,KAAKuB,EAAKxP,IAGrB,IAAQA,EAAI,EAAGA,EAAE0X,EAAStU,OAAQpD,IACjC,GAAGgD,KAAKmU,UAAUO,EAAS1X,IAAI,CAC9B,IAAI2X,EAAO3U,KAAKmU,UAAUO,EAAS1X,IACnCyX,EAAQxJ,KAAK,CAAChN,MAAOyW,EAAS1X,GAAIqC,MAAOsV,EAAKtV,QAGhD,OAAOoV,GAERM,sBAAuB,SAAS5V,EAAMoU,GACrC,IAAIyB,EAAOhV,KAAKsT,uBAAuBnU,EAAMoU,GAC7C,OAAOyB,EAAKA,EAAK5U,OAAO,IAEzB6U,sBAAuB,SAAS9V,EAAMoU,GACrC,IAAIyB,EAAOhV,KAAK0T,uBAAuBvU,EAAMoU,GAC7C,OAAOyB,EAAKA,EAAK5U,OAAO,IAEzB8U,uBAAwB,SAASd,EAAQ/U,EAAO8V,GAC/C,IAAI,IAAInY,EAAI,EAAGA,EAAImY,EAAM/U,OAAQpD,SACkB,IAAxCgD,KAAKgT,sBAAsBmC,EAAMnY,MAC1CgD,KAAKgT,sBAAsBmC,EAAMnY,IAAM,KAEoB,GAAzDgD,KAAKgT,sBAAsBmC,EAAMnY,IAAIgQ,QAAQoH,KAC/CpU,KAAKgT,sBAAsBmC,EAAMnY,IAAIiO,KAAKmJ,GAC1CpU,KAAKmU,UAAUC,GAAU,CAAC/U,MAAOA,KAIpC+V,uBAAwB,SAAShB,EAAQ/U,EAAO8V,GAC/C,IAAI,IAAInY,EAAI,EAAGA,EAAImY,EAAM/U,OAAQpD,SACkB,IAAxCgD,KAAKiT,sBAAsBkC,EAAMnY,MAC1CgD,KAAKiT,sBAAsBkC,EAAMnY,IAAM,KAEoB,GAAzDgD,KAAKiT,sBAAsBkC,EAAMnY,IAAIgQ,QAAQoH,KAC/CpU,KAAKiT,sBAAsBkC,EAAMnY,IAAIiO,KAAKmJ,GAC1CpU,KAAKmU,UAAUC,GAAU,CAAC/U,MAAOA,KAIpCgW,2BAA4B,SAASjB,EAAQ/U,EAAOkU,GACnDvT,KAAKmU,UAAUC,GAAU,CAAC/U,MAAOA,QACkB,IAAzCW,KAAKiT,sBAAsBM,KAA2BvT,KAAKiT,sBAAsBM,GAAa,KAC3C,GAA1DvT,KAAKiT,sBAAsBM,GAAWvG,QAAQoH,IAChDpU,KAAKiT,sBAAsBM,GAAWtI,KAAKmJ,IAG7CkB,2BAA4B,SAASlB,EAAQ/U,EAAOkU,GACnDvT,KAAKmU,UAAUC,GAAU,CAAC/U,MAAOA,QACkB,IAAzCW,KAAKgT,sBAAsBO,KAA2BvT,KAAKgT,sBAAsBO,GAAa,KAC3C,GAA1DvT,KAAKgT,sBAAsBO,GAAWvG,QAAQoH,IAChDpU,KAAKgT,sBAAsBO,GAAWtI,KAAKmJ,IAG7CmB,4BAA6B,SAASnB,EAAQ/U,EAAOmW,GACpD,IAAI,IAAIxY,EAAI,EAAGA,EAAIwY,EAAWpV,OAAQpD,SACsB,IAAjDgD,KAAKkT,0BAA0BsC,EAAWxY,MACnDgD,KAAKkT,0BAA0BsC,EAAWxY,IAAM,KAEoB,GAAlEgD,KAAKkT,0BAA0BsC,EAAWxY,IAAIgQ,QAAQoH,KACxDpU,KAAKkT,0BAA0BsC,EAAWxY,IAAIiO,KAAKmJ,GACnDpU,KAAKmU,UAAUC,GAAU,CAAC/U,MAAOA,KAIpCoW,4BAA6B,SAASrB,EAAQ/U,EAAOmW,GACpD,IAAI,IAAIxY,EAAI,EAAGA,EAAIwY,EAAWpV,OAAQpD,SACsB,IAAjDgD,KAAKmT,0BAA0BqC,EAAWxY,MACnDgD,KAAKmT,0BAA0BqC,EAAWxY,IAAM,KAEoB,GAAlEgD,KAAKmT,0BAA0BqC,EAAWxY,IAAIgQ,QAAQoH,KACxDpU,KAAKmT,0BAA0BqC,GAAYvK,KAAKmJ,GAChDpU,KAAKmU,UAAUC,GAAU,CAAC/U,MAAOA,KAIpC8U,UAAW,CACV3C,iBAAkB,CAAEnS,MAAO,iBAC3BoS,iBAAkB,CAAEpS,MAAO,iBAC3BqW,mBAAoB,CAAErW,MAAO,yBAE9BsW,uBAAwB,SAASC,EAAS1U,GACzC,GAAqB,UAAlB,QAAO0U,IAAuBA,EAAQxV,OAAO,CAC/C,IAAI,IAAIpD,EAAI,EAAIA,EAAE4Y,EAAQxV,OAAQpD,IAAI,CAErC,IADS,IAAI6Y,aAAaD,EAAQ5Y,IAC3B8Y,cAAc5U,GAAW,OAAO,EAExC,OAAO,EAIP,OADS,IAAI2U,aAAaD,GAChBE,cAAc5U,IAK3B6R,UAAyB,SAASzF,GACpB,SAAVA,IACFtN,KAAKoV,uBAAuB,kBAAmB,oBAAqB,CAAC,iBAAkB,yBAA0B,0BACjHpV,KAAKkV,uBAAuB,kBAAmB,oBAAqB,CAAC,iBAAkB,yBAA0B,2BAErG,SAAV5H,GACFtN,KAAKoV,uBAAuB,mBAAoB,4BAA6B,CAAC,aAElE,WAAV9H,GACFyF,aAAasC,2BAA2B,iBAAkB,2BAA4B,YAE1E,cAAV/H,GACFyF,aAAasC,2BAA2B,iBAAkB,2BAA4B,aAIxFtC,0BAAyC,SAAS7R,GAEjD,MADc,CAAC,OAAQ,SAIxB6R,iBAAgC,SAASrS,EAASQ,GACjD,IAAI6U,EAAmB/V,KAAKgW,eAAetV,EAASQ,GAqBpD,GApBG6U,GAAoBA,EAAiB5X,KACvC+C,EAAS/C,KAAO4X,EAAiB5X,KAG9B+C,EAAS+U,QAAU/U,EAAS+U,OAAO9X,KAAM+C,EAAS/C,KAAO+C,EAAS+U,OAAO9X,KACvE+C,EAAS/C,KAAO,OAEnB4X,GAAoBA,EAAiBxV,KACvCW,EAASX,KAAOwV,EAAiBxV,KAG9BW,EAAS+U,QAAU/U,EAAS+U,OAAO1V,KAAMW,EAASX,KAAOW,EAAS+U,OAAO1V,KACvEW,EAASX,KAAO,OAEnBwV,GAAoBA,EAAiBG,OACvChV,EAASgV,OAASH,EAAiBG,OAGnChV,EAASgV,OAAShV,EAASiV,mBAEzBJ,GAAoBA,EAAiBK,OAA2D,UAAlD,QAAOlV,EAASgV,OAAOH,EAAiBK,QACxFlV,EAASkV,MAAQL,EAAiBK,UAE9B,CACJ,IAAIC,EAAWnV,EAASoV,kBACe,UAApC,QAAOpV,EAASgV,OAAOG,IACzBnV,EAASkV,MAAQC,EAGjBnV,EAASkV,MAAQ7X,IAAI2C,EAASgV,QAmChC,OAhCGH,GAAoBA,EAAiBQ,sBACvCrV,EAASqV,sBAAwBR,EAAiBQ,sBAE3CrV,EAAS+U,OAAQ/U,EAASqV,sBAAwBN,OAAOM,sBAC5DrV,EAASqV,uBAAwB,EACnCR,GAAwD,UAApC,QAAOA,EAAiBS,UAC9CtV,EAASsV,SAAWT,EAAiBS,SAGrCtV,EAASsV,SAAWtV,EAASgV,OAAOhV,EAASkV,OAAOI,SAGlDT,GAAwD,UAApC,QAAOA,EAAiBU,UAC9CvV,EAASuV,SAAWV,EAAiBU,SAGrCvV,EAASuV,SAAWvV,EAASgV,OAAOhV,EAASkV,OAAOK,SAGlDV,QAA0D,IAA/BA,EAAiBW,aAC9CxV,EAASwV,WAAaX,EAAiBW,WACpCX,EAAiBY,gBACnBzV,EAASyV,cAAgBZ,EAAiBY,gBAEzCZ,QAAsD,IAA3BA,EAAiBa,SAE9C1V,EAAS2V,cAAgB,IAAItF,aAAauF,wBAExCf,GAA2BA,EAAiBgB,OAE5ChB,GAA2BA,EAAiBiB,KAExCtW,GAGRqS,eAA8B,SAASrS,EAASQ,GAC/C,IAAI6U,EAAmB,GAEvB,IAAI,IAAIxX,KAAOmC,EACJ,SAAPnC,IACFwX,EAAiBxX,GAAOmC,EAAQnC,IAGlC,GAAGmC,EAAQuW,MACV,IAAI,IAAIja,EAAI,EAAGA,EAAE0D,EAAQuW,MAAM7W,OAAQpD,IAAI,CAE1C,KADc0D,EAAQuW,MAAMja,GAAG4Y,SAAW5V,KAAK2V,uBAAuBjV,EAAQuW,MAAMja,GAAG4Y,QAAS1U,KACpFR,EAAQuW,MAAMja,GAAGka,OAC5B,IAAI,IAAItU,KAAKlC,EAAQuW,MAAMja,GAAGka,OAC7BnB,EAAiBnT,GAAKlC,EAAQuW,MAAMja,GAAGka,OAAOtU,GAKlD,OAAOmT,IAIRhD,aAAamC,uBAAuB,oBAAqB,kBAAmB,CAAC,gBAC7EnC,aAAaqC,uBAAuB,oBAAqB,kBAAmB,CAAC,gBAC7ErC,aAAauC,2BAA2B,mBAAoB,gBAAiB,SAC7EvC,aAAasC,2BAA2B,mBAAoB,kBAAmB,SAC/EtC,aAAamC,uBAAuB,uBAAwB,oBAAqB,CAAC,iBAAkB,yBAA0B,0BAC9HnC,aAAaqC,uBAAuB,uBAAwB,oBAAqB,CAAC,iBAAkB,yBAA0B,0BAC9HrC,aAAamC,uBAAuB,iBAAkB,cAAe,CAAC,WAAY,WAAY,eAAgB,YAC7G,iBAAkB,aAAc,WAAY,iBAAkB,gBAAiB,sBAChFnC,aAAaqC,uBAAuB,iBAAkB,cAAe,CAAC,WAAY,WAAY,gBAAiB,eAAgB,YAC9H,iBAAkB,aAAc,WAAY,iBAAkB,gBAAiB,sBAChFrC,aAAauC,2BAA2B,mBAAoB,kBAAmB,YAC/EvC,aAAasC,2BAA2B,mBAAoB,oBAAqB,YACjFtC,aAAamC,uBAAuB,kBAAmB,eAAgB,CAAC,UAAW,aAAc,qBACjGnC,aAAaqC,uBAAuB,kBAAmB,eAAgB,CAAC,qBACxErC,aAAamC,uBAAuB,kBAAmB,eAAgB,CAAC,UAAW,aAAc,qBACjGnC,aAAaqC,uBAAuB,kBAAmB,eAAgB,CAAC,qBACxErC,aAAamC,uBAAuB,iBAAkB,cAAe,CAAC,UAAW,eACjFnC,aAAamC,uBAAuB,mBAAoB,qBACtD,CAAC,cAAe,aAAc,YAAa,YAAa,cAAe,WACtE,yBAA0B,sBAAuB,sBAAuB,2BAC3EnC,aAAamC,uBAAuB,kBAAmB,eAAgB,CAAC,iBAAkB,gBAAiB,mBAAoB,qBAC/HnC,aAAaqC,uBAAuB,kBAAmB,eAAgB,CAAC,iBAAkB,gBAAiB,mBAAoB,qBAC/HrC,aAAamC,uBAAuB,qBAAsB,iBAAkB,CAAC,aAAc,aAE3FW,aAAe,SAAH,oGAAG,WAASD,GAWvB,GAVA5V,KAAKkB,WAAY0U,EAAQ1U,UAAW0U,EAAQ1U,SAC5ClB,KAAKX,QAASuW,EAAQ3X,OAAQ2X,EAAQ3X,MACtC+B,KAAKmX,aAAcvB,EAAQuB,YAAavB,EAAQuB,WAChDnX,KAAKoX,UAAWxB,EAAQwB,SAAUxB,EAAQwB,QAC1CpX,KAAKqX,eAAgBzB,EAAQyB,cAAezB,EAAQyB,aACpDrX,KAAKsX,QAAS1B,EAAQ0B,OAAQ1B,EAAQ0B,MACtCtX,KAAKrB,WAAYiX,EAAQjX,UAAWiX,EAAQjX,SAC5CqB,KAAK/B,QAAS2X,EAAQ3X,OAAQ2X,EAAQ3X,MACtC+B,KAAKiW,SAAUL,EAAQK,QAAS,IAAIJ,aAAaD,EAAQK,QACzDjW,KAAKuX,SAAW,GACb3B,EAAQ2B,SACV,IAAI,IAAIva,EAAI,EAAIA,EAAI4Y,EAAQ2B,SAASnX,OAASpD,IAC7CgD,KAAKuX,SAAStM,KAAK,IAAI4K,aAAaD,EAAQ2B,SAASva,KAGvDgD,KAAKwX,WAAiC,IAAjB5B,EAAQ4B,OAAuB5B,EAAQ4B,MAC5DxX,KAAKyX,QAAS7B,EAAQ6B,OAAQ7B,EAAQ6B,MACtCzX,KAAK0X,SAAU9B,EAAQ8B,QAAS9B,EAAQ8B,UAGzC7B,aAAajX,UAAUkX,cAAgB,SAAS5U,GAC/C,IAAIyW,EAAQ3X,KAAK4X,gBAAgB1W,GACjC,QAAIyW,MACD3X,KAAKkB,UAAYlB,KAAKkB,UAAYyW,MAClC3X,KAAK6X,gBAAgBF,OACrB3X,KAAKmX,aAAenX,KAAK8X,eAAeH,EAAOzW,QAC/ClB,KAAKX,QAAUW,KAAK+X,WAAWJ,EAAOzW,QACtClB,KAAKoX,UAAYpX,KAAKgY,aAAaL,EAAOzW,QAC1ClB,KAAKqX,eAAiBrX,KAAKiY,kBAAkBN,EAAOzW,QACpDlB,KAAKrB,WAAaqB,KAAKkY,cAAcP,EAAOzW,SAC7B,IAAflB,KAAKwX,QAAoBxX,KAAKmY,WAAWR,EAAOzW,QAChDlB,KAAKsX,QAAUtX,KAAKoY,WAAWT,EAAOzW,QACtClB,KAAK/B,QAAU+B,KAAKqY,WAAWV,EAAOzW,QACtClB,KAAKiW,SAAWjW,KAAKsY,YAAYX,EAAOzW,QACxClB,KAAKuX,UAAYvX,KAAKuX,SAASnX,SAAWJ,KAAKuY,cAAcZ,EAAOzW,QACpElB,KAAKyX,QAAUzX,KAAKwY,WAAWb,EAAOzW,OACtClB,KAAK0X,SAAW1X,KAAKyY,YAAYd,EAAOzW,kBAI5C2U,aAAajX,UAAUiZ,gBAAkB,SAASF,GACjD,QAAY,SAATA,IAAqB3X,KAAKuX,SAASnX,SAAUJ,KAAKX,UACzC,UAATsY,IAAqB3X,KAAKsX,QAO9BzB,aAAajX,UAAUoZ,aAAe,SAASZ,EAASlW,GAC7B,UAAvB,QAAOlB,KAAKoX,UAAwBpX,KAAKoX,QAAQhX,SAAQJ,KAAKoX,QAAU,CAACpX,KAAKoX,UAEjF,IADA,IAAIsB,EAAQxX,EAASkW,UACbpa,EAAI,EAAIA,EAAEgD,KAAKoX,QAAQhX,OAAQpD,IACtC,GAAGgD,KAAK2Y,SAASvB,EAAQpa,GAAI0b,GAC5B,OAAO,EAGT,OAAO,GAIR7C,aAAajX,UAAU2Z,cAAgB,SAASZ,EAAOzW,GACtD,IAAI,IAAIlE,EAAI,EAAIA,EAAEgD,KAAKuX,SAASnX,OAAQpD,IAAI,CAC3C,IAAI4b,GAAQ,EACZ,GAAY,UAATjB,EACF,IAAI,IAAIzV,KAAQhB,EAASsU,WACrBxV,KAAKuX,SAASva,GAAG8Y,cAAc5U,EAASsU,WAAWtT,MACrD0W,GAAQ,QAKN,GAAY,YAATjB,EACP,IAAI,IAAIkB,EAAI,EAAGA,GAAK3X,EAAS4X,OAAO1Y,OAAQyY,IACxC7Y,KAAKuX,SAASsB,GAAG/C,cAAc5U,EAAS4X,OAAOD,MACjDD,GAAQ,GAKX,IAAIA,EAAO,OAAO,EAEnB,OAAO,GAGR/C,aAAajX,UAAU6Z,YAAc,SAASd,EAAOzW,GAC3B,UAAtB,QAAOlB,KAAK0X,SAA4C,GAAtB1X,KAAK0X,OAAOtX,SAAaJ,KAAK0X,OAAS,CAAC1X,KAAK0X,SAClF,IAAI,IAAI1a,EAAI,EAAGA,EAAEgD,KAAK0X,OAAOtX,OAAQpD,IAAI,CACxC,GAAqB,WAAlBgD,KAAK0X,OAAO1a,KAAoBkE,EAAS6X,YAAa,OAAO,EAChE,GAAqB,OAAlB/Y,KAAK0X,OAAO1a,KAAgBkE,EAASI,QAAS,OAAO,EACxD,GAAqB,aAAlBtB,KAAK0X,OAAO1a,IAAqBkE,EAAS6X,YAAa,OAAO,EAElE,OAAO,GAGRlD,aAAajX,UAAUuZ,WAAa,SAASR,EAAOzW,GACnD,OAAOlB,KAAKgZ,YAAYhZ,KAAKwX,MAAOtW,EAASsW,UAG9C3B,aAAajX,UAAU0Z,YAAc,SAASX,EAAOzW,GACpD,OAAOlB,KAAKiW,OAAOH,cAAc5U,EAAS+U,SAG3CJ,aAAajX,UAAU4Z,WAAa,SAASb,EAAOzW,GACnD,MAAY,SAATyW,GACK3X,KAAKyX,OAASvW,EAASuW,OAKhC5B,aAAajX,UAAUsZ,cAAiB,SAASP,EAAOzW,GAC5B,UAAxB,QAAOlB,KAAKrB,WAAyBqB,KAAKrB,SAASyB,SAAQJ,KAAKrB,SAAW,CAACqB,KAAKrB,WACpF,IAAI,IAAI3B,EAAI,EAAIA,EAAEgD,KAAKrB,SAASyB,OAAQpD,IACvC,GAAGgD,KAAKiZ,iBAAiB/X,EAASvC,WAAYqB,KAAKrB,SAAS3B,IAC3D,OAAO,EAGT,OAAO,GAIR6Y,aAAajX,UAAUyZ,WAAa,SAASV,EAAOzW,GAC3B,UAArB,QAAOlB,KAAK/B,QAAsB+B,KAAK/B,MAAMmC,SAAQJ,KAAK/B,MAAQ,CAAC+B,KAAK/B,QAC3E,IAAI,IAAIjB,EAAI,EAAIA,EAAEgD,KAAK/B,MAAMmC,OAAQpD,IACpC,GAAY,SAAT2a,GACF,GAAG3X,KAAKkZ,YAAYhY,EAASjD,QAAS+B,KAAK/B,MAAMjB,IAChD,OAAO,OAGJ,GAAY,YAAT2a,GACP,IAAI,IAAIkB,EAAI,EAAGA,GAAI3X,EAAS4X,OAAO1Y,OAASyY,IAC3C,GAA+C,SAA5C7Y,KAAK4X,gBAAgB1W,EAAS4X,OAAO9b,KACtCgD,KAAKkZ,YAAYhY,EAAS4X,OAAO9b,GAAGiB,QAAS+B,KAAK/B,MAAMjB,IACzD,OAAO,OAIL,GAAY,UAAT2a,EACP,IAAI,IAAIzV,KAAQhB,EAASsU,WACxB,GAAGxV,KAAKqY,WAAWrY,KAAK4X,gBAAgB1W,EAASsU,WAAWtT,IAAQhB,EAASsU,WAAWtT,IACvF,OAAO,EAKX,OAAO,GAGR2T,aAAajX,UAAUwZ,WAAc,SAAST,EAAOzW,GAC5B,UAArB,QAAOlB,KAAKsX,QAAsBtX,KAAKsX,MAAMlX,SAAQJ,KAAKsX,MAAQ,CAACtX,KAAKsX,QAC3E,IAAI,IAAIta,EAAI,EAAIA,EAAEgD,KAAKsX,MAAMlX,OAAQpD,IACpC,GAAGgD,KAAKmZ,cAAcjY,EAASoW,QAAStX,KAAKsX,MAAMta,IAClD,OAAO,EAGT,OAAO,GAGR6Y,aAAajX,UAAUqZ,kBAAoB,SAASN,EAAOzW,GAC3B,UAA5B,QAAOlB,KAAKqX,eAA6BrX,KAAKqX,aAAajX,SAAQJ,KAAKqX,aAAe,CAACrX,KAAKqX,eAEhG,IADA,IAAI+B,EAAOlY,EAASmW,eACZra,EAAI,EAAIA,EAAEgD,KAAKqX,aAAajX,OAAQpD,IAC3C,GAAGgD,KAAKqZ,cAAcrZ,KAAKqX,aAAara,GAAIoc,GAC3C,OAAO,EAGT,OAAO,GAGRvD,aAAajX,UAAUkZ,eAAiB,SAAUH,EAAOzW,GACxD,GAAY,UAATyW,EAAmB,MAA0B,UAAnB3X,KAAKmX,WAClC,GAAY,SAATQ,EAAkB,CACpB,GAAGzW,EAASoY,MACX,OAAOtZ,KAAKmX,YAAcjW,EAASoY,MAAMC,QAGzCjF,MAAMnO,KAAKC,UAAUlF,IACrBoT,MAAM,YAGR,MAAY,YAATqD,QAAH,GAGD9B,aAAajX,UAAUmZ,WAAa,SAASJ,EAAOzW,GACnD,MAAgC,mBAAtBsY,UAAUC,UACnB/K,QAAQC,IAAI,IAAIC,MAAM,0EACf,GAED5O,KAAK0Z,YAAY1Z,KAAKX,MAAO6B,EAASuY,aAG9C5D,aAAajX,UAAU+Z,SAAW,SAASgB,EAAKC,GAC/C,OAAO9Y,eAAeC,YAAY8Y,WAAWF,EAAKC,IAGnD/D,aAAajX,UAAUya,cAAgB,SAASM,EAAKC,GACpD,OAAO5Z,KAAK2Y,SAASgB,EAAKC,IAE3B/D,aAAajX,UAAUqa,iBAAmB,SAASU,EAAKC,GAEvD,OADY5Z,KAAK2Y,SAASgB,EAAKC,IAGhC/D,aAAajX,UAAUua,cAAgB,SAASQ,EAAKC,GACpD,OAAO5Z,KAAK2Y,SAASgB,EAAKC,IAE3B/D,aAAajX,UAAUsa,YAAc,SAASY,EAAMC,GACnD,OAAOD,GAAQC,GAEhBlE,aAAajX,UAAUoa,YAAc,SAASc,KAAMC,MACnD,GAAkB,iBAARD,KACT,IACC,OAAOzF,KAAK0F,KAAOD,MAEpB,MAAMhM,GACL,OAAO,EAGT,OAAOgM,OAASC,MAGjBlE,aAAajX,UAAU8a,YAAc,SAASI,EAAMC,GAEnD,OADU,IAAIC,OAAOF,GACVG,KAAKF,IAGjBlE,aAAajX,UAAUgZ,gBAAkB,SAAS1W,GAC9C,MAAgC,kBAA7BA,EAASgZ,YAAY3c,KAAiC,SACzB,oBAA7B2D,EAASgZ,YAAY3c,KAAmC,WAC3B,iBAA7B2D,EAASgZ,YAAY3c,KAAgC,QACxD2D,EAASiZ,cAAsBjZ,EAASiZ,eAC3CzL,QAAQC,IAAI,IAAIC,MAAM,gDAAkD1N,EAASgZ,YAAY3c,OAC7FmR,QAAQC,IAAIzN,IACL,IAIRnE,OAAOD,QAAQiW,c,gBCjnBf,IAAMpK,EAAY1J,EAAQ,GACpBC,EAAkBD,EAAQ,GAGhCmb,qBAAuB,SAASxW,EAAImT,EAAQtL,GAC3CzL,KAAK4D,GAAKA,EACV5D,KAAKqa,OAAU5O,IAAkB,EACjCzL,KAAK+W,OAASA,EACd/W,KAAKsa,aAAc,GAGpBF,qBAAqBxb,UAAU2b,QAAU,SAASC,GACjDxa,KAAKwa,KAAOA,GAGbJ,qBAAqBxb,UAAU6b,UAAY,SAAS1D,GACnD/W,KAAK+W,OAASA,GAGfqD,qBAAqBxb,UAAU8b,OAAS,SAASC,GAChDrG,MAAM,2CAA6CqG,EAAM,MAG1DP,qBAAqBxb,UAAUuS,SAAW,SAAS9Q,GAClD,IAAIua,EAAQnb,SAASC,cAAc,QACnCkb,EAAMjb,aAAa,QAAS,0BAC5B,IAAIkb,EAAQpb,SAASC,cAAc,UACnCmb,EAAMlb,aAAa,QAASU,EAAQ,+CAEpC,IAAI0J,EAAO/J,KACX6a,EAAM9a,iBAAiB,UAAU,WAChCC,KAAKqa,OAASra,KAAK/B,MACnB8L,EAAK2Q,OAAO1a,KAAK/B,OACjB+B,KAAK/B,MAAQ,MAEd2c,EAAM/a,YAAYgb,GAClB,IAAIC,EAAK,IAAInS,EAAU3I,KAAK4D,GAAGgF,OAAQ,GAAI5I,KAAK4D,IAC5C8D,EAAOoT,EAAGxP,0BAA0BtL,KAAK+W,QACzChN,EAAO/J,KAcX,OAbA8a,EAAGjR,QAAQnC,GACV1B,MAAK,SAAST,GACd,IAAIiH,EAAOzC,EAAKgR,oBAAoBxV,GACpC,GAAGiH,EAAK,CACP,IAAI,IAAIxP,EAAI,EAAGA,EAAEwP,EAAKpM,OAAQpD,IAC7B6d,EAAMhb,YAAY2M,EAAKxP,IAExB+M,EAAKrJ,QAAU8L,OAGfoO,EAAMxL,YAAYyL,MAGbD,GAGRR,qBAAqBxb,UAAUmc,oBAAsB,SAASC,GAC7D,IAAIC,EAAU,GACd,GAAGD,EAAME,SAAS,CACjB,GAAuB,GAApBlb,KAAKsa,aAAwBU,EAAME,SAAS9a,OAAS,EAAG,OAAO,EAClE,GAAGJ,KAAKmb,aAAa,CACpB,IAAIC,EAAO3b,SAASC,cAAc,UAClC0b,EAAKzb,aAAa,QAAS,+CAC3Byb,EAAKnd,MAAQ,GACbmd,EAAKvb,YAAYJ,SAASK,eAAeE,KAAKmb,eAC9CF,EAAQhQ,KAAKmQ,GAGd,IADA,IAAIC,EAAQ,GACJre,EAAI,EAAGA,EAAEge,EAAME,SAAS9a,OAAQpD,IAAI,CAC3C,IAAIse,EAASpc,EAAgBqc,4BAA4B,UAAWP,EAAME,SAASle,IAEnF,GADIse,IAAQA,EAASpc,EAAgBqc,4BAA4B,QAASP,EAAME,SAASle,KACtFse,IAAoC,GAA1BD,EAAMrO,QAAQsO,GAAc,CACxCD,EAAMpQ,KAAKqQ,GACX,IAAIza,EAAMpB,SAASC,cAAc,UACjCmB,EAAIlB,aAAa,QAAS,yBAC1BkB,EAAI5C,MAAQqd,EACTza,EAAI5C,OAAS+B,KAAKqa,SACpBxZ,EAAIF,UAAW,GAEhB,IAAI6a,EAAMtc,EAAgBqc,4BAA4B,QAASP,EAAME,SAASle,IAC1Ewe,GAAc,WAAPA,IAEVA,EAAM1a,eAAeC,YAAYC,aAAasa,IAG5CE,EAAI,YAAWA,EAAMA,EAAI,WAC5B3a,EAAIhB,YAAYJ,SAASK,eAAe0b,IACxCP,EAAQhQ,KAAKpK,KAIhB,OAAOoa,GAKRle,EAAOD,QAAQsd,sB,qPCnGf,IAAMpb,EAAwBC,EAAQ,GAChCwc,EAAaxc,EAAQ,GACrByc,EAAMzc,EAAQ,GACdC,EAAkBD,EAAQ,GAGhC,SAASyJ,EAAWiT,EAAKhR,EAAOjK,EAASkD,GACxC5D,KAAK4D,GAAKA,EACV5D,KAAK2K,MAAQA,EACb3K,KAAKkb,SAAaS,GAAOA,EAAIT,SAAYS,EAAIT,SAAW,GAkBzD,SAASU,EAAkBhY,EAAIiY,EAASC,EAAQpb,EAASqb,EAAUC,GAClEhc,KAAK4D,GAAKA,EACV5D,KAAK+G,OAAS8U,EACd7b,KAAK8b,OAASA,EACd9b,KAAKqC,cAAgB,IACrBrC,KAAKsC,cAAgB,GACrBtC,KAAKU,QAAUA,EACfV,KAAKic,MAAQD,EAEbhc,KAAKkc,KAAO,IAAIld,EAChBgB,KAAK+b,SAAWA,EAzBjBrT,EAAW9J,UAAUud,MAAQ,WAC5B,OAAOnc,KAAKkb,SAAS9a,QAGtBsI,EAAW9J,UAAUgL,QAAU,SAASpI,GACvC,OAAOxB,KAAK2K,MAAMf,QAAQpI,IAG3BkH,EAAW9J,UAAUwd,YAAc,SAASrV,GAC3C,OAAGA,EAAgBA,EAAOmU,UAAYnU,EAAOmU,SAAS9a,OACzCJ,KAAKkb,UAAYlb,KAAKkb,SAAS9a,QAkB7Cwb,EAAkBhd,UAAUyd,UAAY,WACvC,OAAGrc,KAAKU,cAA6C,IAA3BV,KAAKU,QAAQ4b,YAAkCtc,KAAKU,QAAQ4b,YAIvFV,EAAkBhd,UAAU2d,aAAe,SAASC,GACnD,IAAIC,EAAU,GACd,IAAI,IAAI/Y,KAAK8Y,GACc,GAAvBC,EAAQzP,QAAQtJ,IAClB+Y,EAAQC,QAAQhZ,GAGlB,OAAO+Y,GAGRb,EAAkBhd,UAAUuS,SAAW,SAASwL,EAAWC,GAC1D,IAAIC,EAAKpd,SAASC,cAAc,OAEhC,GADAid,EAAU9c,YAAYgd,GACnBD,EAAoB,CACtB,IAAIE,EAAKrd,SAASC,cAAc,OAChCod,EAAGnd,aAAa,QAAS,mDACzBmd,EAAGjd,YAAYJ,SAASK,eAAe,YACvC+c,EAAGhd,YAAYid,GAEhB,OAAG9c,KAAK+G,QAAU/G,KAAK+G,OAAOqV,eAAiBpc,KAAKqc,aACnDrc,KAAK+c,YAAY/c,KAAK+G,OAAOmU,SAAU2B,GAChCA,IAGPG,IAAMvd,SAASC,cAAc,OAC7Bsd,IAAIrd,aAAa,QAAS,yBAC1Bqd,IAAInd,YAAYJ,SAASK,eAAe,+DACxC+c,EAAGhd,YAAYmd,KACRH,IAITjB,EAAkBhd,UAAUme,YAAc,SAAS7B,EAAUyB,GAC5D,GAAG3c,KAAKkc,KAAK1b,gBAAgB,cAAc,CAC1C,IAAIyc,EAAWjd,KAAKkd,SAAShC,GAAU,EAAM,IAM7C,OALAyB,EAAU9c,YAAYod,EAASE,KACtB,IAAI1B,EAAWA,WAAWzb,KAAMA,KAAKic,OAC3CmB,KAAKH,EAAUN,GAClBA,EAAUvY,UAAUI,IAAI,uBACxBmY,EAAUvY,UAAUI,IAAI,2BACjB2Y,EAGP,IAAIA,EAAMnd,KAAKkd,SAAShC,GAAU,EAAO,IACzCyB,EAAU9c,YAAYsd,IAIxBvB,EAAkBhd,UAAUye,sBAAwB,SAASnC,EAAUyB,EAAWW,GAChF,IAAIL,EAAWjd,KAAKkd,SAAShC,GAAU,EAAMoC,GAE7C,OADAX,EAAU9c,YAAYod,EAASE,KACxBF,GAGTrB,EAAkBhd,UAAU2e,iCAAmC,SAASrC,EAAUoC,GAKjF,IAJG,IAAIE,EAAU,GAAIC,EAAc,GAAIvX,EAAO,GAAIwX,EAAkB,GAChET,EAAW,GACRU,EAAmB3d,KAAKuc,aAAarB,EAAS,IAE7Cle,EAAI,EAAGA,EAAE2gB,EAAiBvd,OAAQpD,IAAI,CAC7C,IAAI6T,EAAO/P,eAAeC,YAAY6c,SAASD,EAAiB3gB,IAAM8D,eAAeC,YAAYC,aAAa2c,EAAiB3gB,IAAM2gB,EAAiB3gB,GAChJwgB,EAAQvS,KAAK,CAAC/E,KAAM2K,IAG3B,IAAQ7T,EAAI,EAAGA,EAAEke,EAAS9a,OAAQpD,IAAI,CACrCygB,EAAc,GACd,IAAI,IAAI5E,EAAI,EAAGA,EAAE8E,EAAiBvd,OAAQyY,IAAI,CAC7C,GAA8C,UAA3C,EAAOqC,EAASle,GAAG2gB,EAAiB9E,KACtC,IAAI2C,EAAON,EAASle,GAAG2gB,EAAiB9E,IAAI,UAAYqC,EAASle,GAAG2gB,EAAiB9E,IAAI,UAAY,eAEjG,GAA8C,iBAApCqC,EAASle,GAAG2gB,EAAiB9E,IAAiB,CAElD,YADN2C,EAAMxb,KAAK+G,OAAO6C,QAAQsR,EAASle,GAAG2gB,EAAiB9E,QACtC2C,EAAM,IACD,QAAvBA,EAAIjZ,UAAU,EAAG,KACnBiZ,EAAMxb,KAAK6d,qBAAqBrC,GAAKsC,WAIvCL,EADI5M,EAAO/P,eAAeC,YAAY6c,SAASD,EAAiB9E,IAAM/X,eAAeC,YAAYC,aAAa2c,EAAiB9E,IAAM8E,EAAiB9E,IAClI2C,EAErBtV,EAAK+E,KAAKwS,GAQX,OANAR,EAASO,QAAUA,EACnBE,EAAgBxX,KAAOA,EACvBwX,EAAgBK,aAAe,GAC/BL,EAAgBM,gBAAkB,GAClCN,EAAgBN,KAAO,EACvBH,EAAS/W,KAAOwX,EACTT,GAGRrB,EAAkBhd,UAAUqf,aAAe,SAAS/C,EAAUyC,GAG7D,IAFA,IAAIO,EAAQze,SAASC,cAAc,SAE3B1C,EAAI,EAAGA,EAAEke,EAAS9a,OAAQpD,IAAI,CAErC,IADA,IAAImhB,EAAK1e,SAASC,cAAc,MACxBmZ,EAAI,EAAGA,EAAE8E,EAAiBvd,OAAQyY,IAAI,CAC7C,IAAIuF,EAAK3e,SAASC,cAAc,MAChC,GAA8C,UAA3C,EAAOwb,EAASle,GAAG2gB,EAAiB9E,KACtC,IAAI2C,EAAON,EAASle,GAAG2gB,EAAiB9E,IAAI,UAAYqC,EAASle,GAAG2gB,EAAiB9E,IAAI,UAAY,SAEjG,GAA8C,iBAApCqC,EAASle,GAAG2gB,EAAiB9E,IACvC2C,EAAMxb,KAAK+G,OAAO6C,QAAQsR,EAASle,GAAG2gB,EAAiB9E,KAG5D,GADU,WAAP2C,IAAkBA,EAAM,IACD,QAAvBA,EAAIjZ,UAAU,EAAG,GAAa,CAChC,IAAIkO,EAAIzQ,KAAK6d,qBAAqBrC,GAClC4C,EAAGve,YAAY4Q,QAGfvR,EAAgBmf,kBAAkBD,EAAI5C,EAAKxb,KAAKqC,cAAerC,KAAKsC,eAErE6b,EAAGte,YAAYue,GAEhBF,EAAMre,YAAYse,GAEnB,OAAOD,GAGRtC,EAAkBhd,UAAU0f,qBAAuB,SAAS1a,GAC3D8X,EAAMxX,uBAAuB,qBAClBzE,SAASU,uBAAuB,yBACtC,GAAGiE,UAAUI,IAAI,qBACtBkX,EAAMrT,wBAAwBzE,IAG/BgY,EAAkBhd,UAAUif,qBAAuB,SAASrC,GAC3D,IAAI/K,EAAIhR,SAASC,cAAc,KAC/B+Q,EAAE9Q,aAAa,QAAS6b,GACxB/K,EAAE9Q,aAAa,OAAQ,KACvB,IAAIoK,EAAO/J,KASX,OARAyQ,EAAE1Q,iBAAiB,SAAS,WACxBgK,EAAKhD,OAAOnD,KACdmG,EAAKhD,OAAOnD,GAAG2a,aAAave,KAAKkH,OACjC6C,EAAKhD,OAAOnD,GAAGmN,SACfhH,EAAKuU,qBAAqBvU,EAAKnG,QAGjC6M,EAAE5Q,YAAYJ,SAASK,eAAe0b,IAC/B/K,GAGRmL,EAAkBhd,UAAUse,SAAW,SAAShC,EAAUsD,EAAUlB,GACnE,IAAIH,EAAM1d,SAASC,cAAc,SACjCyd,EAAIxd,aAAa,QAAS,wBAI1B,IAHA,IAAI8e,EAAQhf,SAASC,cAAc,SAC/Bgf,EAAMjf,SAASC,cAAc,MAC7Bie,EAAmB3d,KAAKuc,aAAarB,EAAS,IAC1Cle,EAAI,EAAGA,EAAE2gB,EAAiBvd,OAAQpD,IAAI,CAC7C,IAAI2hB,EAAKlf,SAASC,cAAc,MAChCif,EAAGhf,aAAa,QAAS,kCACzB,IAAIkR,GAAgD,GAAxC8M,EAAiB3gB,GAAGgQ,QAAQ,QAAiBlM,eAAeC,YAAYC,aAAa2c,EAAiB3gB,IAAM2gB,EAAiB3gB,GACzI2hB,EAAG9e,YAAYJ,SAASK,eAAe+Q,IACvC6N,EAAI7e,YAAY8e,GAIjB,GAFAF,EAAM5e,YAAY6e,GAClBvB,EAAItd,YAAY4e,GACbD,EAAS,CACX,IAAIN,EAAQze,SAASC,cAAc,SACnCyd,EAAItd,YAAYqe,GAChB,IAAIjB,EAAU,GAGd,OAFAA,EAASlW,OAAS/G,KAAKud,iCAAiCrC,EAAUoC,GAClEL,EAASE,IAAMA,EACRF,EAGHiB,EAAQle,KAAKie,aAAa/C,EAAUyC,GAExC,OADAR,EAAItd,YAAYqe,GACTf,GAKTpgB,EAAOD,QAAQ,CAAC8e,oBAAmBlT,e,qPC1NnC,IAAMC,EAAY1J,EAAQ,GACpB2f,EAAY3f,EAAQ,IACpBC,EAAkBD,EAAQ,GAGhC,SAAS4f,EAAuBjb,EAAI4B,EAAQ9E,GAC3CV,KAAK4D,GAAKA,EACV5D,KAAKkJ,OAASlJ,KAAK4D,GAAGsF,SACtBlJ,KAAK8e,GAAK9e,KAAK4D,GAAGkb,KAClB9e,KAAKyM,OACLzM,KAAK7B,KAAQuC,GAAWA,EAAQvC,KAAOuC,EAAQvC,KAAO,OACtD6B,KAAK+e,UAAUre,IAAWA,EAAQqe,SAASre,EAAQqe,OACnD/e,KAAKgf,aAAete,IAAWA,EAAQse,aAActe,EAAQse,YAC7Dhf,KAAKif,eAAiBjf,KAAKkf,0BAC3Blf,KAAKU,QAAWA,GAAoBV,KAAKif,eAAezZ,GACxDxF,KAAKwF,OAASA,EACdxF,KAAKP,UAAW,EAGjBof,EAAuBjgB,UAAU6N,KAAO,WACvC,IAAIqO,EAAK,IAAInS,EAAU3I,KAAK4D,GAAGgF,OAAQ5I,KAAKU,QAASV,KAAK4D,IACtD8D,EAAOoT,EAAGvP,wBACVxB,EAAO/J,KACX+J,EAAKoV,UAAY,GACjBpV,EAAKqV,aAAe,GACpBtE,EAAGjR,QAAQnC,GAAM1B,MAAK,SAAS6V,GAC9B,GAAGA,GAAWA,EAAQO,cAAc,CACnC,IAAI,IAAIpf,EAAI,EAAGA,EAAE6e,EAAQX,SAAS9a,OAAQpD,IAAI,CAC7C,IAAI2d,EAAMzb,EAAgBqc,4BAA4B,UAAWM,EAAQX,SAASle,IAC/E2d,QAAqC,IAAvB5Q,EAAKoV,UAAUxE,KAC/B5Q,EAAKoV,UAAUxE,GAAOkB,EAAQX,SAASle,IAGzC+M,EAAKsV,kBARP,OAWO,SAASvR,GACfY,QAAQC,IAAIb,OAId+Q,EAAuBjgB,UAAU+M,gBAAkB,SAAS2T,GAE3D,GADWtf,KACHof,mBAAkD,IAD/Cpf,KACyBof,aAAaE,GAAsB,OAD5Dtf,KACwEof,aAAaE,GAChG,IAAIxE,EAAK,IAAInS,EAAU3I,KAAK4D,GAAGgF,OAAQ5I,KAAKU,QAASV,KAAK4D,IACtD8D,EAAOoT,EAAGnP,gBAAgB2T,GAC9B,OAAOxE,EAAGjR,QAAQnC,GAAM1B,MAAK,SAAS6V,GACrC,SAAGA,IAAWA,EAAQO,gBACXP,EAAQX,SAAS,MAFtB,OAOA,SAASpN,GACfY,QAAQC,IAAIb,OAId+Q,EAAuBjgB,UAAU2gB,aAAe,SAAS5E,GACxD,UAAU3a,KAAKmf,UAAUxE,KACjB3a,KAAKmf,UAAUxE,IAKxBkE,EAAuBjgB,UAAU4gB,mBAAqB,SAAShe,GAC9D,GAAGA,EAAI,CACNxB,KAAK4D,GAAG6b,SAAS,qCAAuCje,GACxD,IAAIuI,EAAO/J,KAMX,OALAA,KAAK7B,KAAO,OACZ6B,KAAK0f,YAAc,UACK,GAArBle,EAAIwL,QAAQ,OAAmC,GAArBxL,EAAIwL,QAAQ,OACxCxL,EAAM,UAAYA,GAEZxB,KAAK2f,mBAAmBne,GAC9BwE,MAAK,SAAST,GACdwE,EAAKnG,GAAGgc,YACR7V,EAAK8V,cAHC,OAKA,SAASC,GACfpR,QAAQoR,MAAMA,GACd/V,EAAKnG,GAAGgc,YACR7V,EAAKnG,GAAGmc,UAAUD,QAKrBjB,EAAuBjgB,UAAUohB,aAAe,SAASxe,EAAKmZ,GAC7D,IAAInZ,EAAK,OAAO,EAChB,IAAIuI,EAAO/J,KAOX,MANyB,QAAtBwB,EAAIe,UAAU,EAAE,KAClBf,EAAMA,EAAIe,UAAU,IAErBvC,KAAK0f,YAAc,OACnBle,EAAMA,EAAIqB,QAAQ,aAAc,sBAChC7C,KAAK4D,GAAG6b,SAAS,yBAA2Bje,GACrCxB,KAAK4D,GAAGgF,OAAOqX,YAAYze,EAAK,CAAC,oBAAqB,mBAC5DwE,MAAK,SAAST,GAQd,OAPAwE,EAAKnG,GAAGgc,YACR7V,EAAKmW,eAAe3a,GACpBwE,EAAK8V,WACL9V,EAAKsV,cACFtV,EAAKiV,aACPjV,EAAK4V,mBAAmB5V,EAAKtK,SAASkb,KAAK3U,MAAK,WAAY+D,EAAKsV,iBAAjE,OAAuF,SAASvR,GAAGY,QAAQoR,MAAMhS,MAE3GvI,KATD,OAWA,SAASua,GACfpR,QAAQoR,MAAMA,GACd/V,EAAKnG,GAAGgc,YACR7V,EAAKnG,GAAGmc,UAAUD,OAIpBjB,EAAuBjgB,UAAU+gB,mBAAqB,SAAShF,GAC9D,IAAI5Q,EAAO/J,KACPmgB,EAAOrf,eAAeC,YAAYqf,UAAUzF,GAChD,OAAO3a,KAAK4D,GAAGgF,OAAOyX,eAAc,EAAOF,GAC1Cna,MAAK,SAAST,GACdwE,EAAKuW,iBAAiB/a,EAAUoV,GAChC5Q,EAAKsV,kBAIPR,EAAuBjgB,UAAU2hB,eAAiB,SAASC,GAC1DxgB,KAAKP,UAAW,EAChB,IAAIsK,EAAO/J,KAEX,OADAA,KAAK4D,GAAG6b,SAAS,qBAAuBe,GACjCxgB,KAAK4D,GAAGgF,OAAO2X,eAAeC,GACpCxa,MAAK,SAAST,GACdwE,EAAKnG,GAAGgc,eAFF,OAGE,SAASE,GACjB/V,EAAKnG,GAAGgc,YACR7V,EAAKnG,GAAGmc,UAAUD,OAIpBjB,EAAuBjgB,UAAU6hB,eAAiB,SAAS5U,GAC1D,IAAI9B,EAAO/J,KACP0gB,EAAO1gB,KAAKkB,SAASyf,UAGzB,OADA3gB,KAAK4D,GAAG6b,SAAS,qBACVzf,KAAK4D,GAAGgF,OAAO6X,eAAe5U,EAAI6U,EAF9B,CAAE,oBAAqB,WAGjC1a,MAAK,SAAST,GACdwE,EAAKnG,GAAGgc,YACR7V,EAAKnG,GAAG2a,aAAa1S,MAHf,OAIE,SAASiU,GACjB/V,EAAKnG,GAAGgc,YACLE,EAAM5Z,MAAQ4Z,EAAM5Z,KAAK,sBAC3B6D,EAAKnG,GAAGgd,eAAed,EAAM5Z,KAAK,sBAAuB,YAGzD6D,EAAKnG,GAAGmc,UAAUD,OAKrBjB,EAAuBjgB,UAAUiiB,eAAiB,WACjD,IAAIC,EAAO9gB,KAAKP,SAASshB,OACrBL,EAAO1gB,KAAKkB,SAASyf,UACrB5W,EAAO/J,KAGX,OADAA,KAAK4D,GAAG6b,SAAS,qBAAuBqB,GACjC9gB,KAAK4D,GAAGgF,OAAOiY,eAAeC,EAAMJ,EAFhC,CAAE,oBAAqB,WAGjC1a,MAAK,SAAST,GACdwE,EAAKnG,GAAGgc,YACR7V,EAAKnG,GAAG2a,aAAauC,MAHf,OAIE,SAAShB,GACjB/V,EAAKnG,GAAGgc,YACLE,EAAM5Z,MAAQ4Z,EAAM5Z,KAAK,sBAC3B6D,EAAKnG,GAAGgd,eAAed,EAAM5Z,KAAK,sBAAuB,YAGzD6D,EAAKnG,GAAGmc,UAAUD,OAKrBjB,EAAuBjgB,UAAUshB,eAAiB,SAASc,EAAYrG,GAClEA,IACA3a,KAAKP,SAAUkb,EAAM3a,KAAKP,SAASkb,IAElCqG,GAAcA,EAAW5gB,QAAU4gB,EAAW,IAAMA,EAAW,GAAGC,SACpEtG,EAAMqG,EAAW,GAAGC,SAIpBtG,EACE3a,KAAKP,SAIRO,KAAKP,SAASygB,eAAec,GAH7BhhB,KAAKP,SAAW,IAAIqB,eAAeogB,YAAYvG,EAAKqG,GAOrDtS,QAAQC,IAAI,gEAKdkQ,EAAuBjgB,UAAU0hB,iBAAmB,SAASa,EAAaxG,GACrEA,GACAwG,GAAeA,EAAY/gB,QAAU+gB,EAAY,IAAMA,EAAY,GAAGF,SACxEtG,EAAMwG,EAAY,GAAGF,QAGpBtG,GACE3a,KAAKP,WACRO,KAAKP,SAAW,IAAIqB,eAAeogB,YAAYvG,IAE7CwG,IACFnhB,KAAKP,SAAS2hB,gBAAgBD,GAC1BnhB,KAAKP,SAASshB,SACjB/gB,KAAKP,SAAS4hB,QAAS,EACvBrhB,KAAKP,SAAS6hB,eAAe,SAK/B5S,QAAQC,IAAI,gBAAiB,oDAI/BkQ,EAAuBjgB,UAAU2iB,OAAS,WACzC,IAAIvhB,KAAKkB,UAAYlB,KAAKP,SAAS,CAC/BO,KAAK0f,cACP1f,KAAKU,QAAUV,KAAKwhB,yBAAyBxhB,KAAK0f,cAEnD,IACC1f,KAAKkB,SAAW,IAAI0d,EAAU6C,eAAezhB,KAAKP,UAAU,EAAOO,KAAKU,SACxEV,KAAKkB,SAAS/C,KAAO6B,KAAK7B,KAC1B6B,KAAKkB,SAASwgB,WAAa1hB,KAC3B,MAAM8N,GACLY,QAAQoR,MAAM,gCAAgChS,EAAEyG,aAGnD,GAAGvU,KAAKkB,SACP,OAAOlB,KAAKkB,SAASqgB,UAIvB1C,EAAuBjgB,UAAUsgB,wBAA0B,WAC1D,OAAOyC,aAGR9C,EAAuBjgB,UAAU4iB,yBAA2B,SAASI,GACpE,MAA2C,UAAxC,EAAO5hB,KAAKif,eAAe2C,IACtB5hB,KAAKif,eAAe2C,GAErB5hB,KAAKU,SAIbme,EAAuBjgB,UAAUijB,UAAY,WAC5C,OAAO7hB,KAAK4D,GAAGgF,QAGhBiW,EAAuBjgB,UAAU+hB,QAAU,SAASjgB,GACnD,OAAOV,KAAKkB,SAASyf,WAGtB9B,EAAuBjgB,UAAU6a,SAAW,WAC3C,IAAI+B,IAAOxb,KAAK2a,KAAM3a,KAAK2a,IAE3B,OADIa,IAAKA,EAAOxb,KAAK8hB,MAAQ9hB,KAAK8hB,MAAQ,QACnCtG,GAGRqD,EAAuBjgB,UAAUihB,SAAW,WAC3C,GAAG7f,KAAKP,UAAYO,KAAK+hB,OAAO,CAC/BjhB,eAAeC,YAAYsE,eAAerF,KAAK+hB,QAE/C,IADA,IAAIC,EAAMhiB,KAAKP,SAASwiB,cAAcnhB,eAAeC,YAAYmhB,UAAU,OAAQ,UAC3EllB,EAAI,EAAGA,EAAGglB,EAAI5hB,OAAQpD,IAAI,CACjC,IAAIwe,EAAMwG,EAAIhlB,GAAGa,MACd2d,GACFxb,KAAK+hB,OAAOliB,YAAYJ,SAASK,eAAe0b,OAMpDqD,EAAuBjgB,UAAUygB,YAAc,WAC9C,GAAGrf,KAAKmiB,QAAQ,CACfrhB,eAAeC,YAAYsE,eAAerF,KAAKmiB,SAC/C,IAAIC,EAAQpiB,KAAKuhB,SACda,GACFpiB,KAAKmiB,QAAQtiB,YAAYuiB,KAK5BvD,EAAuBjgB,UAAUuS,SAAW,WAC3C,IAAIkR,EAAS5iB,SAASC,cAAc,OACpC2iB,EAAO1iB,aAAa,QAAS,4BACZ,SAAdK,KAAK7B,OACP6B,KAAKsiB,WAAa7iB,SAASC,cAAc,OACzCM,KAAKsiB,WAAW3iB,aAAa,QAAS,gCACnCjC,OAAO6kB,KAAKviB,KAAKif,gBAAgB7e,OAAS,GAAGJ,KAAKsiB,WAAWziB,YAAYG,KAAKwiB,2BACjFH,EAAOxiB,YAAYG,KAAKsiB,aAEzBtiB,KAAKmiB,QAAU1iB,SAASC,cAAc,OACtCM,KAAKmiB,QAAQxiB,aAAa,QAAS,0BACnC,IAAIyiB,EAAQpiB,KAAKuhB,SAKjB,OAJGa,GACFpiB,KAAKmiB,QAAQtiB,YAAYuiB,GAE1BC,EAAOxiB,YAAYG,KAAKmiB,SACjBE,GAGRxD,EAAuBjgB,UAAU4jB,wBAA0B,WAC1D,IAAIC,EAAMhjB,SAASC,cAAc,UAEjC,IAAI,IAAI1C,KADRylB,EAAI9iB,aAAa,QAAS,iDACbK,KAAKif,eACjB,GAAS,WAANjiB,EAAH,CACA,IAAI6D,EAAMpB,SAASC,cAAc,UACjCmB,EAAI5C,MAAQjB,EACTgD,KAAK0f,aAAe1iB,IACtB6D,EAAIF,UAAW,GAEhBE,EAAIhB,YAAYJ,SAASK,eAAeE,KAAKif,eAAejiB,GAAGqC,QAC/DojB,EAAI5iB,YAAYgB,GAEjB,IAAIkJ,EAAO/J,KAMX,OALAyiB,EAAI1iB,iBAAiB,UAAU,WAC9BgK,EAAK2V,YAAc1f,KAAK/B,MACxB8L,EAAK7I,UAAW,EAChB6I,EAAKsV,iBAECoD,GAGR1lB,EAAOD,QAAQ+hB,G,gBC5Uf,IAAMnD,EAAOzc,EAAQ,GAGrB,SAASyjB,EAAc9e,GACnB5D,KAAK4D,GAAKA,EA6Cd,SAAS6X,EAAWkH,EAAY1G,GAC7Bjc,KAAK4iB,SAAWD,EAChB3iB,KAAK8b,OAAS6G,EAAW7G,OACzB9b,KAAK4D,GAAK+e,EAAW/e,GACrB5D,KAAKic,MAAQA,EA9ChByG,EAAc9jB,UAAUikB,mBAAqB,SAAS1F,GAClD,IAAI2F,EAAK9iB,KACL+iB,EAAQrV,OAAOyP,GAAK6F,UAAU,CAC7BC,WAAY,EACZC,WAAY,GACZC,WAAY,CAAC,GAAI,GAAI,GAAI,GAAI,KAC7BC,QAAY,EACZpZ,QAAY,EACZqZ,aAAc,SAAStH,GACCA,EAASuH,UAAUC,MACxBC,EAAE,MAAMC,MAAK,WACbzjB,KAAKL,aAAa,QAAS6jB,EAAExjB,MAAM0jB,YAEtDC,WAAW,CAAC,CAACC,QAAQ,OAAO7U,UAAU,aACtC8U,WAAY,SAASC,GACF,IAAI1F,EAAKoF,EAAEM,GAAKC,KAAK,aACrB3F,EAAG4F,KAAK,QAAS5F,EAAGsF,WAkB5C,OAdAhW,OAAOyP,EAAK,SAAS8G,GAAG,QAAS,MAAM,WACnC,GAAsC,GAAnClB,EAAMmB,KAAKlkB,MAAMyX,QAAQ0M,OAMvBrB,EAAGlf,GAAGwgB,qBANX,CACI,IAAIC,EAAStB,EAAMe,IAAIpW,OAAO1N,MAAMskB,QAAQ,OAAOpe,OAC/Cqe,EAAO7I,EAAM1T,qBAAqBqc,EAAO,IAC7CvB,EAAGlf,GAAG4gB,eAAeD,OAM7BpH,EAAIxd,aAAa,QAAe,qCAChCwd,EAAIxd,aAAa,cAAe,KAChCwd,EAAIxd,aAAa,cAAe,KAChCwd,EAAIxd,aAAa,SAAe,KACzBwd,GAGXuF,EAAc9jB,UAAUwe,KAAO,SAASH,GACpC,OAAOjd,KAAK6iB,mBAAmB5F,IAgBnCxB,EAAW7c,UAAU6lB,aAAe,SAAS9Z,EAAO2S,EAAUX,GAC1D,IAAI5S,EAAO/J,KAEXA,KAAK8b,OAAOjS,QAAQc,GACjB3E,MAAK,SAASe,GAGX,OADUgD,EAAK6Y,SAASvF,sBAAsBtW,EAAOmU,SAAUyB,EAAWW,MAHhF,OAOS,SAASoH,GACZhW,QAAQoR,MAAM4E,GACd3a,EAAKnG,GAAGmc,UAAU2E,OAK5BjJ,EAAW7c,UAAU+lB,qBAAuB,SAAS7J,EAAIiB,GACrD,OAAOA,EAASpR,OACZ,IAAK,qBACD,OAAOmQ,EAAGhQ,oBAAoB,KAAMiR,EAASmH,WAAYnH,EAASlR,OAEtE,IAAK,gBACD,OAAOiQ,EAAG5P,mBAAmB,KAAM6Q,EAASmH,WAAYnH,EAASlR,OAErE,IAAK,2BACD,OAAOiQ,EAAGzP,wBAAwB,KAAM0Q,EAASmH,WAAYnH,EAASlR,OAE1E,IAAK,wBACJ,IAAI+Z,EAAM9J,EAAG7Q,gCAAgC,SAC1C,OAAO6Q,EAAGvP,sBAAsBqZ,GAEpC,IAAK,sBACD,OAAO9J,EAAG1P,qBAAqB,KAAM2Q,EAASmH,WAAYnH,EAASlR,OAEvE,IAAK,mBACD,OAAOiQ,EAAGvP,sBAAsB,KAAMwQ,EAASmH,WAAYnH,EAASlR,OAExE,IAAK,kBACD,OAAQiQ,EAAGtP,0BAA0BuQ,EAAS8I,YAAa9I,EAASmH,WAAYnH,EAASlR,OAE7F,IAAK,sBACD,OAAOiQ,EAAGpP,6BAA6BqQ,EAAS8I,YAAa9I,EAASmH,WAAYnH,EAASlR,OAE/F,IAAK,2BACD,OAAOiQ,EAAGlP,iBAAiBmQ,EAAS8I,YAAa9I,EAASmH,WAAYnH,EAASlR,OAEnF,QACI6D,QAAQC,IAAI,gCASxB8M,EAAW7c,UAAUkmB,6BAA+B,SAASxH,GACtDtd,KAAKic,OAAOP,EAAMxW,qBAAqBlF,KAAK4D,GAAI0Z,EAASyH,UAC5D,IAAIpa,EAAQ3K,KAAK2kB,qBAAqB3kB,KAAK8b,OAAQwB,GAKnD,OAJGtd,KAAKic,QACJqB,EAASyH,SAAS9mB,MAAQkI,KAAKC,UAAUuE,OAAMqa,EAAW,GAC1DtJ,EAAM7W,cAAc7E,KAAK4D,GAAI0Z,EAASyH,SAAU,QAAS,eAEtDpa,GAOX8Q,EAAW7c,UAAUqmB,oBAAsB,SAASnC,EAAIoC,EAAKra,GACzD,IAAIyS,EAAW,GAMf,OALAA,EAAS4F,WAAagC,EACtB5H,EAASzS,MAAaA,EACtByS,EAASyH,SAAajC,EAAGiC,SACzBzH,EAAS3S,MAAamY,EAAGnY,MACzB2S,EAASuH,YAAc/B,EAAG+B,YACnBvH,GAQX7B,EAAW7c,UAAUumB,MAAQ,SAAShI,EAAKpB,EAAUY,GAEjD7b,eAAeC,YAAYsE,eAAerF,KAAKolB,OAC/CplB,KAAKolB,MAAQ3lB,SAASC,cAAc,OACpCM,KAAKolB,MAAMvlB,YAAYsd,GACvBR,EAAU9c,YAAYG,KAAKolB,OAE3BplB,KAAK+kB,SAAWhJ,EAASgJ,SACzB/kB,KAAK2K,MAAQoR,EAASpR,MACtB3K,KAAK6kB,YAAc9I,EAAS8I,aAGhCpJ,EAAW7c,UAAUymB,mBAAqB,SAASC,EAAUC,EAAW5I,GACpE,IAAIW,EAAWtd,KAAKilB,oBAAoBjlB,KAAMulB,EAAUC,gBAAiBD,EAAUE,gBAC/E9a,EAAQ3K,KAAK8kB,6BAA6BxH,GAC9C,OAAOtd,KAAKykB,aAAa9Z,EAAO2S,EAAUX,IAI9ClB,EAAW7c,UAAU8mB,kBAAoB,SAASzI,EAASN,GACvD,IAAImG,EAAK9iB,KACLmd,EAAMF,EAASE,IACnBnd,KAAKmlB,MAAMhI,EAAKnd,KAAK4iB,SAAS7G,SAAUY,GAE5BjP,OAAOyP,GAAK6F,UAAU,CAC7BC,WAAc,EACdC,WAAcJ,EAAGF,SAAS7G,SAASmH,WACnCyC,YAAc,EACdC,YAAc,EACdzC,WAAc,CAAC,EAAG,GAAI,GAAI,GAAI,GAAI,KAClCrf,IAAc,UACd0Z,QAAcP,EAASlW,OAAOyW,QAC9B4F,QAAc,EACdpZ,QAAc,EACdqZ,aAAc,SAAStH,GACCA,EAASuH,UAAUC,MACxBC,EAAE,MAAMC,MAAK,WACbzjB,KAAKL,aAAa,QAAS6jB,EAAExjB,MAAM0jB,YAEtDmC,KAAc,SAAU3f,EAAM5G,EAAUyc,GACzB,GAAGre,OAAOooB,QAAQ7I,EAASlW,OAAOb,MAAM9F,OAAS,EAAE,CAE/C,IAAIub,EAAMsB,EAASlW,OAAOb,KAC1B+W,EAASlW,OAAOb,KAAO,OAEvB,CACIyV,EAAMmH,EAAGuC,mBAAmBrlB,KAAM+b,EAAUY,GAChDjO,QAAQC,IAAI,MAAOgN,GAEvBrc,EAASqc,IACxBoK,QAAc,CAAC,CAAEC,OAAQ,OAAQ5jB,KAAM,qBACxB,CAAE4jB,OAAQ,QAAS5jB,KAAM,oBACxCuhB,WAAc,CAAC,CAACC,QAAQ,OAAO7U,UAAU,aACzC8U,WAAc,SAASC,GACJ,IAAI1F,EAAKoF,EAAEM,GAAKC,KAAK,aACrB3F,EAAG4F,KAAK,QAAS5F,EAAGsF,SAEvCuC,SAAc,IAUnB,OANA9I,EAAIxd,aAAa,QAAe,oBAChCwd,EAAIxd,aAAa,QAAgB,uBACjCwd,EAAIxd,aAAa,cAAe,KAChCwd,EAAIxd,aAAa,cAAe,KAChCwd,EAAIxd,aAAa,SAAe,KAEzBwd,GAMX1B,EAAW7c,UAAUwe,KAAO,SAASH,EAAUN,GAC3C,OAAO3c,KAAK0lB,kBAAkBzI,EAAUN,IAG5C5f,EAAOD,QAAQ,CAAC2e,aAAYiH,kB,gBC7N5B,IAAMxjB,EAAkBD,EAAQ,GAEhC,SAASinB,EAAiBhlB,GACzBlB,KAAKkB,SAAWA,EAChBlB,KAAKwV,WAAa,GAClBxV,KAAKmmB,aAAejlB,EAASklB,wBA6H9B,SAAStP,KAtHToP,EAAiBtnB,UAAU2iB,OAAS,WACnC,GAAGvhB,KAAKqmB,YAAY,CACnB,IAAIA,EAAcrmB,KAAKsmB,eACvBtmB,KAAKqmB,YAAYE,YAAYF,GAC7BrmB,KAAKqmB,YAAcA,OAGnBrmB,KAAKqmB,YAAcrmB,KAAKsmB,eASzB,OAPAtmB,KAAKqmB,YAAYxmB,YAAYG,KAAKwmB,kBAAkBxmB,KAAKkB,WACtDlB,KAAKmmB,eACPnmB,KAAK4W,OAAS5W,KAAKmmB,aAAahV,SAASnR,KAAKkB,UAC3ClB,KAAK4W,QAAQ5W,KAAKqmB,YAAYxmB,YAAYG,KAAK4W,SAEnD5W,KAAKgP,KAAOhP,KAAKymB,mBACdzmB,KAAKgP,MAAMhP,KAAKqmB,YAAYxmB,YAAYG,KAAKgP,MACzChP,KAAKqmB,aAGbH,EAAiBtnB,UAAU0nB,aAAe,WACzC,IAAII,EAAc1mB,KAAKkB,SAASylB,wBAC5BC,EAAO,yBAA2BF,EACtC,GAAkB,QAAfA,EACF,IAAIG,EAAKpnB,SAASC,cAAc,YAG5BmnB,EAAKpnB,SAASC,cAAc,QAEjC,IAAI0M,EAAM,yBAA2Bwa,GAAQ5mB,KAAKkB,SAAS+U,OAAS,GAAK,wBAA0B,0BAA4BjW,KAAKkB,SAAS/C,KAI7I,OAHA0oB,EAAGlnB,aAAa,QAASyM,GACzBya,EAAGlnB,aAAa,aAAcK,KAAKkB,SAASmW,gBAC5CwP,EAAGlnB,aAAa,UAAWK,KAAKkB,SAASkW,WAClCyP,GAGRX,EAAiBtnB,UAAU6nB,iBAAmB,WAC7C,IAAIC,EAAc1mB,KAAKkB,SAASylB,wBAC5BC,EAAO,8BAAgCF,EAC3C,GAAkB,QAAfA,EACF,IAAII,EAAUrnB,SAASC,cAAc,YAGjConB,EAAUrnB,SAASC,cAAc,QAGnC,IAAI,IAAIwC,KADR4kB,EAAQnnB,aAAa,QAAS,8BAAgCinB,GAC9C5mB,KAAKwV,WACpBxV,KAAKwV,WAAWtT,IAAO4kB,EAAQjnB,YAAYG,KAAKwV,WAAWtT,IAE/D,OAAO4kB,GAGRZ,EAAiBtnB,UAAUmoB,cAAgB,SAASC,GACnD,GAAGhnB,KAAKinB,iBAAiBD,GACxB,OAAOhnB,KAAKknB,cAAcF,GAAShnB,KAAKkB,SAAUlB,OAIpDkmB,EAAiBtnB,UAAUmS,OAAS,WACnCjQ,eAAeC,YAAYsE,eAAerF,KAAKqmB,aAC/CrmB,KAAKwV,WAAa,GAClBxV,KAAKkB,SAASqgB,OAAOvhB,OAGtBkmB,EAAiBtnB,UAAUuoB,aAAe,WACzC,GAAGnnB,KAAKmmB,cAAgBnmB,KAAK4W,OAAQ,CACpC,IAAIwQ,EAAUpnB,KAAKmmB,aAAahV,SAASnR,KAAKkB,UAC9ClB,KAAK4W,OAAO2P,YAAYa,GACxBpnB,KAAK4W,OAASwQ,IAIhBlB,EAAiBtnB,UAAUyoB,WAAa,WACvC,GAAGrnB,KAAKgP,KAAK,CACZ,IAAIsY,EAAQtnB,KAAKymB,mBACjBzmB,KAAKgP,KAAKuX,YAAYe,GACtBtnB,KAAKgP,KAAOsY,IAOdpB,EAAiBtnB,UAAU2oB,oBAAsB,SAASrlB,EAAMslB,GAC/DxnB,KAAKwV,WAAWtT,GAAQslB,GAGzBtB,EAAiBtnB,UAAU6oB,MAAQ,WAClC3mB,eAAeC,YAAYsE,eAAerF,KAAKqmB,aAC/CrmB,KAAKwV,WAAa,IAMnB0Q,EAAiBtnB,UAAUyF,OAAS,WACnCrE,KAAKqmB,YAAYlW,WAAWf,YAAYpP,KAAKqmB,cAG9CH,EAAiBtnB,UAAU8oB,KAAO,SAASC,EAAMhpB,GAChDO,EAAgB0oB,SAASD,EAAMhpB,IAMhCunB,EAAiBtnB,UAAU4nB,kBAAoB,SAAStlB,GACvD,IAAI2mB,EAAMpoB,SAASC,cAAc,KACjCmoB,EAAIloB,aAAa,QAAS,4BAC1B,IAAImC,EAAKhB,eAAeC,YAAYgB,aAAab,EAASkW,WAEvD,GADItV,IAAIA,EAAKZ,EAASkW,WACnBtV,EAAG,CACR,IAAIE,EAAOF,EAAGD,MAAM,KACjBG,EAAK5B,OAAS,IAAG0B,EAAKE,EAAK,IAC9B6lB,EAAIloB,aAAa,OAAQmC,GAE1B,OAAO+lB,GAKR/Q,EAAuBlY,UAAUuS,SAAW,SAASjQ,GACpD,IA0BK4mB,EAgBAC,EA1CDrB,EAAcxlB,EAASylB,wBACvBC,EAAO,oDAAsDF,EACjE,GAAkB,QAAfA,EACF,IAAIsB,EAASvoB,SAASC,cAAc,YAGhCsoB,EAASvoB,SAASC,cAAc,QAGrC,GADAsoB,EAAOroB,aAAa,QAAS,0BAA4BinB,GACtD1lB,EAAS+mB,YAAY,SAAS,CAChC,IAAIC,EAAWloB,KAAKmoB,kBAAkBjnB,GACnCgnB,GAAUF,EAAOnoB,YAAYqoB,GAE9BhnB,EAAS+mB,YAAY,YACnBH,EAAS9nB,KAAKooB,kBAAkBlnB,KACzB8mB,EAAOnoB,YAAYioB,IAE/B,GAAG5mB,EAAS+mB,YAAY,MAAM,CAC7B,IAAII,EAAQroB,KAAKsoB,eAAepnB,GAC7BmnB,GAAOL,EAAOnoB,YAAYwoB,GAE9B,GAAGnnB,EAAS+mB,YAAY,QAAQ,CAC/B,IAAIM,EAAUvoB,KAAKwoB,iBAAiBtnB,GACjCqnB,GAASP,EAAOnoB,YAAY0oB,GAE7BrnB,EAAS+mB,YAAY,aACnBH,EAAS9nB,KAAKyoB,mBAAmBvnB,KAC1B8mB,EAAOnoB,YAAYioB,IAE/B,GAAG5mB,EAAS+mB,YAAY,QAAQ,CAC/B,IAAIS,EAAU1oB,KAAK2oB,mBAAmBznB,GACnCwnB,GAASV,EAAOnoB,YAAY6oB,GAEhC,GAAGxnB,EAAS+mB,YAAY,UAAU,CACjC,IAAIW,EAAU5oB,KAAK6oB,qBAAqB3nB,GACrC0nB,GAASZ,EAAOnoB,YAAY+oB,GAE7B1nB,EAAS+mB,YAAY,cACnBF,EAAc/nB,KAAK8oB,qBAAqB5nB,KAC5B8mB,EAAOnoB,YAAYkoB,IAEjC7mB,EAAS+mB,YAAY,cACnBF,EAAc/nB,KAAK+oB,oBAAoB7nB,KAC3B8mB,EAAOnoB,YAAYkoB,IAEpC,OAAOC,GAGRlR,EAAuBlY,UAAUmqB,oBAAsB,SAAS7nB,GAC/D,IAAI8nB,EAAM9nB,EAAS+nB,aACnB,OAAO/pB,EAAgBgqB,cAAc,kBAAkB,EAAOF,EAAG,KAAOA,EAAItR,SAG7EZ,EAAuBlY,UAAUkqB,qBAAuB,SAAS5nB,GAChE,IAAI6mB,EAActoB,SAASC,cAAc,QAEzC,GADAqoB,EAAYpoB,aAAa,QAAS,4BAC/BuB,EAAS+mB,YAAY,OAAO,CAC9B,IAAIkB,EAASnpB,KAAKopB,kBAAkBloB,GACjCioB,GAAQpB,EAAYloB,YAAYspB,GAEpC,GAAGjoB,EAAS+mB,YAAY,QAAQ,CAC/B,IAAI9mB,EAAWjC,EAAgBmqB,mBAAmB,SAAUnoB,GACzDC,GAAU4mB,EAAYloB,YAAYsB,GAEtC,GAAGD,EAAS+mB,YAAY,UAAU,CACjC,IAAIzoB,EAAWQ,KAAKspB,mBAAmBpoB,GACpC1B,GAAUuoB,EAAYloB,YAAYL,GAEtC,GAAG0B,EAAS+mB,YAAY,SAAS,CAChC,IAAIsB,EAAWvpB,KAAKwpB,kBAAkBtoB,GACnCqoB,GAAUxB,EAAYloB,YAAY0pB,GAEtC,GAAGroB,EAAS+mB,YAAY,SAAS,CAChC,IAAIwB,EAAWzpB,KAAK0pB,kBAAkBxoB,GACnCuoB,GAAU1B,EAAYloB,YAAY4pB,GAEtC,GAAGvoB,EAAS+mB,YAAY,UAAU,CACjC,IAAI0B,EAAW3pB,KAAK4pB,mBAAmB1oB,GACpCyoB,GAAU5B,EAAYloB,YAAY8pB,GAEtC,GAAGzoB,EAAS+mB,YAAY,QAAQ,CAC/B,IAAI4B,EAAU7pB,KAAK8pB,iBAAiB5oB,GACjC2oB,GAAS9B,EAAYloB,YAAYgqB,GAErC,GAAG3oB,EAAS+mB,YAAY,QAAQ,CAC/B,IAAIW,EAAU5oB,KAAK+pB,iBAAiB7oB,GACjC0nB,GAASb,EAAYloB,YAAY+oB,GAErC,OAAOb,GAGRjR,EAAuBlY,UAAUupB,kBAAoB,SAASjnB,GAC7D,IAAI8oB,EAAY9oB,EAAS+oB,qBAEzB,GAAGD,GAAaA,EAAU5pB,OAAO,CAChC,IAAI8pB,EAAWzqB,SAASC,cAAc,QACtCwqB,EAASvqB,aAAa,QAAS,yBAC/B,IAKIiB,EAAM1B,EAAgBirB,oBAAoB,eAAgBH,EAAW9oB,EAASkpB,gBALnE,SAASC,GACpBA,GACFnpB,EAASopB,SAASD,MAKpB,OADAH,EAASrqB,YAAYe,GACdspB,EAER,OAAO,GAGRpT,EAAuBlY,UAAUwpB,kBAAoB,SAASlnB,GAC7D,IAAIsa,EAAMta,EAASuY,WACnB,QAAG+B,GACKtc,EAAgBgqB,cAAc,gBAAgB,EAAO1N,IAK9D1E,EAAuBlY,UAAU0pB,eAAiB,SAASpnB,GAC1D,IAAImpB,EAAMnpB,EAASkW,UACflU,GAAQ,EAYZ,MAXoB,QAAjBhC,EAAS/C,MAAkB+C,EAASqpB,iBACnCrpB,EAASmnB,QAAOgC,EAAMnpB,EAASmnB,MAAMpqB,QACxCiF,EAAQzD,SAASC,cAAc,UACzBC,aAAa,QAAS,4BAC5BuD,EAAMsnB,UAAY,EACR,MAAPH,IAAaA,EAAM,IACtBnpB,EAASmnB,MAAQnlB,GAGdhC,EAASqpB,iBAA0B,MAAPF,IAAaA,EAAM,gBAE5CnrB,EAAgBgqB,cAAc,YAAa,KAAMmB,EAAK,uDAAwDnnB,IAGtH4T,EAAuBlY,UAAU4pB,iBAAmB,SAAStnB,GAC5D,GAAoB,QAAjBA,EAAS/C,MAAkB+C,EAAS+U,QAAU/U,EAAS+U,OAAOwU,iBAAmBvpB,EAASI,QAAQ,CACpG,IAAIopB,EAAKxpB,EAAS+U,OAAO0U,2BACzB,GAAGD,GAAMA,EAAGtqB,OAAO,CAClB,IAAI8pB,EAAWzqB,SAASC,cAAc,QACtCwqB,EAASvqB,aAAa,QAAS,kCAC/B,IAAIirB,EAAUnrB,SAASC,cAAc,QACrCkrB,EAAQjrB,aAAa,QAAS,kCAC9BirB,EAAQ/qB,YAAYJ,SAASK,eAAe,SAC5CoqB,EAASrqB,YAAY+qB,GACrB,IAKIhqB,EAAM1B,EAAgBirB,oBAAoB,eAAgBO,EAAIxpB,EAASmW,gBAL5D,SAASsD,GACpBA,GACFzZ,EAAS2pB,YAAYlQ,MAKvB,OADAuP,EAASrqB,YAAYe,GACdspB,GAGT,IAAIplB,EAAK5D,EAASqe,aAAare,EAASmW,gBACpCmE,EAAMta,EAASmW,eACfyT,EAAM,qDAMV,OALGhmB,IACF0W,EAAMtc,EAAgBqc,4BAA4B,QAASzW,GAE3DgmB,GADAA,EAAM5rB,EAAgBqc,4BAA4B,UAAWzW,IAChD5D,EAASmW,eAAiB,IAAMyT,EAAM5pB,EAASmW,gBAEtDnY,EAAgBgqB,cAAc,cAAe,OAAQ1N,EAAKsP,IAGlEhU,EAAuBlY,UAAU6pB,mBAAqB,SAASvnB,GAC9D,IAAI8nB,EAAM9nB,EAAS+nB,aACnB,OAAO/pB,EAAgBgqB,cAAc,UAAUF,EAAItR,QAAQ,EAAOsR,EAAItR,OAAQsR,EAAItR,SAGnFZ,EAAuBlY,UAAUwqB,kBAAoB,SAASloB,GAC7D,IAAI6pB,EAAW7pB,EAAS8pB,uBACxB,GAAGD,GAAYA,EAAS3qB,OAAO,CAC9B,IAAI8pB,EAAWzqB,SAASC,cAAc,QACtCwqB,EAASvqB,aAAa,QAAS,gCAC/BorB,EAASrO,QAAQ,CAAEze,MAAO,GAAIoB,MAAO,qBACrC,IAKIE,GAAY2B,EAAS+pB,kBAAkB,QAAiB,+BACxDrqB,EAAM1B,EAAgBirB,oBAAoB,eAAgBY,EAAU,IANzD,SAASvmB,GACpBA,GACFtD,EAASgqB,eAAe1mB,KAI4DjF,GAEtF,OADA2qB,EAASrqB,YAAYe,GACdspB,EAER,OAAO,GAGRpT,EAAuBlY,UAAU+pB,mBAAqB,SAASznB,GAC9D,IAAI8oB,EAAY9oB,EAASiqB,wBAEzB,GAAGnB,GAAaA,EAAU5pB,OAAO,CAChC,IAAI8pB,EAAWzqB,SAASC,cAAc,QACtCwqB,EAASvqB,aAAa,QAAS,iCAC/BqqB,EAAUtN,QAAQ,CAAEze,MAAO,GAAIoB,MAAO,kBACtC,IAKIuB,EAAM1B,EAAgBirB,oBAAoB,gBAAiBH,EAAW,IAL3D,SAASxlB,GACpBA,GACFtD,EAASkqB,aAAa5mB,MAKxB,OADA0lB,EAASrqB,YAAYe,GACdspB,EAER,OAAO,GAGRpT,EAAuBlY,UAAU0qB,mBAAqB,SAASpoB,GAC9D,IACI3B,GAAY2B,EAAS+pB,kBAAkB,WAAoB,kCAC/D,OAAO/rB,EAAgBmC,iBAAiB,SAAU,SAAU,UAF7C,WAAWH,EAAQ,WAE8C3B,IAGjFuX,EAAuBlY,UAAU4qB,kBAAoB,SAAStoB,GAC7D,IACI3B,GAAY2B,EAAS+pB,kBAAkB,UAAmB,iCAC9D,OAAO/rB,EAAgBmC,iBAAiB,SAAU,QAAS,SAF5C,WAAWH,EAASmqB,UAE2C9rB,IAG/EuX,EAAuBlY,UAAU8qB,kBAAoB,SAASxoB,GAC7D,IACI3B,GAAY2B,EAAS6X,aAAsB,mBAC/C,OAAO7Z,EAAgBmC,iBAAiB,SAAU,QAAS,SAF5C,WAAWH,EAASoqB,UAE2C/rB,IAG/EuX,EAAuBlY,UAAUiqB,qBAAuB,SAAS3nB,GAChE,IAAIuT,EAAUvT,EAASqqB,sBACvB,GAAG9W,GAAWA,EAAQrU,OAAO,CAC5B,IAAI8pB,EAAWzqB,SAASC,cAAc,QACtCwqB,EAASvqB,aAAa,QAAS,0BAC/B,IAKIgB,EAAWO,EAASsqB,gBACpB5qB,EAAM1B,EAAgBirB,oBAAoB,gBAAiB1V,EAAS9T,GANzD,SAASyT,GACpBA,GACFlT,EAASuqB,UAAUrX,MAMrB,OADA8V,EAASrqB,YAAYe,GACdspB,EAER,OAAO,GAGRpT,EAAuBlY,UAAUmrB,iBAAmB,SAAS7oB,GAE5D,OAAOhC,EAAgBmC,iBAAiB,SAAU,OAAQ,QAD3C,WAAWH,EAASwqB,WAIpC5U,EAAuBlY,UAAUkrB,iBAAmB,SAAS5oB,GAE5D,OAAOhC,EAAgBmC,iBAAiB,SAAU,OAAQ,QAD3C,WAAWH,EAASyqB,WAIpC7U,EAAuBlY,UAAUgrB,mBAAqB,SAAS1oB,GAC9D,IAAI1B,EAAWC,SAASC,cAAc,QAEtC,GADAF,EAASG,aAAa,QAAS,0BAC5BuB,EAASqpB,gBACX,IAAIhrB,GAAW,OAGXA,GAAY2B,EAAS6X,aAAsB,aAIhD,OADAvZ,EAASK,YAAYX,EAAgBmC,iBAAiB,SAAU,OAAQ,QADzD,WAAWH,EAAS0qB,SACuDrsB,IACnFC,GAGRzC,EAAOD,QAAQ,CAACopB,mBAAiBpP,2B,cCpZjC,SAAStF,EAAiB9Q,GACzBV,KAAK6rB,QAASnrB,IAAWA,EAAQmrB,OAAQnrB,EAAQmrB,KACjD7rB,KAAKoM,IAAQ1L,GAAWA,EAAQ0L,IAAO,0BAA4B1L,EAAQ0L,IAAM,yBAGlFoF,EAAiB5S,UAAUktB,OAAS,SAAS5qB,EAAU6qB,GACtD,IAAI9tB,EAAQiD,EAASjD,QACjBiF,EAAQzD,SAASC,cAAc,QAKnC,OAJAwD,EAAMvD,aAAa,QAASK,KAAKoM,KACjClJ,EAAMvD,aAAa,aAAc1B,GACjCA,EAAQwB,SAASK,eAAe7B,GAChCiF,EAAMrD,YAAY5B,GACXiF,GAGRnG,EAAOD,QAAQ,CAAC0U,qB,cCfhB,SAASwa,IACRhsB,KAAKisB,OAAS,CAAC,UAAW,YAAa,QAAS,QAAS,MAAO,OAAQ,OAAQ,SAAU,YAAa,UAAW,WAAY,YAG/HD,EAAeptB,UAAUstB,aAAe,SAAShb,GAChD,OAAOlR,KAAKisB,OAAO/a,EAAI,IAGxBnU,EAAOD,QAAQ,CAACkvB,mB,cCPhB,SAASG,EAAgBzrB,GACxBV,KAAKosB,SAAU,EACfpsB,KAAKqsB,UAAW,EAChBrsB,KAAKssB,QAAU,GACftsB,KAAKyM,KAAK/L,GAGXyrB,EAAgBvtB,UAAU6N,KAAO,SAAS8f,GACzCvsB,KAAKb,KAASotB,GAAUA,EAAOptB,KAAQotB,EAAOptB,KAAM,QACpDa,KAAKwsB,MAAUD,GAAUA,EAAOC,MAASD,EAAOC,MAAQ,QACxDxsB,KAAKysB,OAAWF,GAAUA,EAAOE,OAAWF,EAAOE,OAAS,QAC5DzsB,KAAK0sB,OAAWH,GAAUA,EAAOG,OAAUH,EAAOG,OAAS,aAC3D1sB,KAAK2sB,QAAYJ,GAAUA,EAAOI,QAAYJ,EAAOI,QAAU,qBAC/D3sB,KAAK4sB,KAASL,GAAUA,EAAOK,KAAQL,EAAOK,KAAO,EACrD5sB,KAAK6sB,OAAWN,GAAUA,EAAOM,OAAUN,EAAOM,OAAS,CAAEC,MAAO,UAAWC,QAAS,GAAKC,OAAQ,GACrGhtB,KAAKitB,KAASV,GAAUA,EAAOU,KAAQV,EAAOU,KAAO,CAAEH,MAAO,UAAWC,QAAS,IAClF/sB,KAAKktB,KAASX,GAAUA,EAAOW,KAAQX,EAAOW,KAAO,CAAEJ,MAAO,UAAWC,QAAS,GAAKC,OAAQ,IAGhGb,EAAgBvtB,UAAUuuB,QAAU,WAChCntB,KAAKynB,SAGT0E,EAAgBvtB,UAAUwuB,wBAA0B,SAAShB,GAI1D,IAHA,IAAIlmB,EAAO,IACPmnB,EAAWjB,EAAQkB,UACnBC,GAAY,EACP1U,EAAE,EAAGA,EAAEwU,EAASG,YAAa3U,IAAI,CACnC0U,IACCrnB,GAAc,KAElB,IAAIunB,EAAKJ,EAASK,MAAM7U,GACxB3S,EAAOA,EAAO,IAAMunB,EAAGE,MAAQ,IAAMF,EAAGG,MAAQ,IAChDL,GAAY,EAGhB,OADArnB,GAAc,KAIjBimB,EAAgBvtB,UAAUivB,wBAA0B,SAASC,GAG1D,IAFA,IAAIC,EAAY5nB,KAAK6nB,MAAMF,GACvB5W,EAAS,GACLla,EAAE,EAAEA,EAAE+wB,EAAU3tB,OAAOpD,IAAI,CAC/B,IAAIixB,EAAU,GACdA,EAAQN,IAAMI,EAAU/wB,GAAG,GAC3BixB,EAAQL,IAAMG,EAAU/wB,GAAG,GAC3Bka,EAAOjM,KAAKgjB,GAEhB,OAAO/W,GAGViV,EAAgBvtB,UAAUsvB,cAAgB,SAASC,EAAQC,GAC1D,IAAIhC,EAAU,IAAI/d,OAAOC,KAAK+f,QAAQ,CAC/BC,MAAOH,EACPI,YAAavuB,KAAK6sB,OAAOC,MACzB0B,cAAexuB,KAAK6sB,OAAOE,QAC3B0B,aAAczuB,KAAK6sB,OAAOG,OAC1B0B,UAAW1uB,KAAKitB,KAAKH,MACrB6B,YAAa3uB,KAAKitB,KAAKF,UAG9B,OADGX,EAAQwC,OAAOR,GACXhC,GAGRD,EAAgBvtB,UAAUiwB,eAAiB,SAASV,GACnD,IAAI1hB,EAAO,CACL8hB,YAAavuB,KAAKktB,KAAKJ,MACvB0B,cAAexuB,KAAKktB,KAAKH,QACzB0B,aAAczuB,KAAKktB,KAAKF,QAM9B,OAJGmB,IACF1hB,EAAK6hB,MAAQH,GAEH,IAAI9f,OAAOC,KAAKwgB,SAASriB,IAIrC0f,EAAgBvtB,UAAUmwB,aAAe,WACxC,IAAK,IAAI/xB,EAAI,EAAGA,EAAIgD,KAAKssB,QAAQlsB,OAAQpD,IACxCgD,KAAKssB,QAAQtvB,GAAG4xB,OAAO,MAExB5uB,KAAKssB,QAAQlsB,OAAS,GAIvB+rB,EAAgBvtB,UAAUowB,UAAY,SAASC,EAAUb,EAAKltB,EAAUgG,EAAOgoB,GAC9E,IAAIziB,EAAO,CACVwiB,SAAUA,EACVb,IAAKA,GAEHlnB,IACFuF,EAAKvF,MAAQA,GAEd,IAAIioB,EAAS,IAAI9gB,OAAOC,KAAK8gB,OAAO3iB,GAChC1C,EAAO/J,KAWX,GAV0B,GAAvBA,KAAKssB,QAAQlsB,QAAqB,yBAAN8uB,GAC1BC,EAAOE,YAAY,SAAS,WAC/B,IAAIlB,EAASpkB,EAAKulB,uBACfvlB,EAAKqiB,QAAUriB,EAAKmkB,cAAcC,EAAQC,GACpCrkB,EAAKglB,eACLhlB,EAAKsiB,SAASuC,OAAO,MACrB1tB,EAASquB,IAAIxlB,EAAKqjB,wBAAwBrjB,EAAKqiB,aAG1DpsB,KAAKssB,QAAQrhB,KAAKkkB,GACT,0BAAND,EAA+B,CACjC,IAAIM,EAAIxvB,KAAKotB,wBAAwBptB,KAAKqsB,UAC1CnrB,EAASquB,IAAIC,GAEd,OAAOL,GAGRhD,EAAgBvtB,UAAU0wB,qBAAuB,WAChD,OAAOtvB,KAAKqsB,SAASiB,WAGtBnB,EAAgBvtB,UAAU6oB,MAAQ,WAC9BznB,KAAKosB,UACPpsB,KAAKosB,QAAQwC,OAAO,MACpB5uB,KAAKosB,SAAU,GAEbpsB,KAAKqsB,WACPrsB,KAAK+uB,eACL/uB,KAAKqsB,SAASuC,OAAO,QAIvBzC,EAAgBvtB,UAAU6wB,QAAU,SAASC,EAAcxuB,EAAUjD,EAAOkB,GAG3E,GAFAuwB,EAAarvB,MAAMmsB,MAAQxsB,KAAKwsB,MAChCkD,EAAarvB,MAAMosB,OAASzsB,KAAKysB,OACb,oBAAVpe,OAET,OADAiG,MAAM,gCACC,EAER,IAAI8Z,EAAM,IAAI/f,OAAOC,KAAKE,IAAIkhB,EAAc,CACxC9C,KAAM5sB,KAAK4sB,KACd+C,OAAQ,CAAChC,IAAKiC,WAAW5vB,KAAK0sB,QAASkB,IAAKgC,WAAW5vB,KAAK2sB,YAE7D,GAAW,yBAARxtB,EAAgC,CAC/Ba,KAAKqsB,SAAWrsB,KAAK6uB,iBACxB7uB,KAAKqsB,SAASuC,OAAOR,GACrB,IAAID,EAAUlwB,EAAQ+B,KAAK6tB,wBAAwB5vB,GAAS,GACzDA,IACC+B,KAAKosB,QAAUpsB,KAAKkuB,cAAcC,EAAQC,SAG1C,GAAW,0BAARjvB,EAAiC,CACpCgvB,EAAUlwB,EAAQ+B,KAAK6tB,wBAAwB5vB,GAAS,GACzD+B,KAAKqsB,SAAWrsB,KAAK6uB,iBACxB7uB,KAAKqsB,SAASuC,OAAOR,GAClBnwB,GACC+B,KAAKqsB,SAASwD,QAAQ1B,QAGtB,GAAW,kBAARhvB,GACJlB,EAAM,CACR+B,KAAK+uB,eACI,IAEItiB,EAAO,CACVwiB,SAAU,CAACtB,IAHFiC,WAAW3xB,EAAMsE,UAAU,EAAGtE,EAAM+O,QAAQ,OAGhC4gB,IAFpBgC,WAAW3xB,EAAMsE,UAAUtE,EAAM+O,QAAQ,KAAK,EAAG/O,EAAMmC,OAAO,KAGlEguB,IAAKA,GAEFe,EAAS,IAAI9gB,OAAOC,KAAK8gB,OAAO3iB,GACpCzM,KAAKssB,QAAQrhB,KAAKkkB,GAIvB,OADA9gB,OAAOC,KAAKwhB,MAAMC,QAAQ3B,EAAK,UACxBA,GAGXrxB,EAAOD,QAAQqvB,G,gBC5Kf,IAAMjtB,EAAkBD,EAAQ,GAKhC,SAASyW,EAAmBxU,GAC3BlB,KAAKkB,SAAWA,EAChBlB,KAAK8Y,OAAS,GACd9Y,KAAKmmB,aAAejlB,EAAS8uB,0BAsI9B,SAASC,KA/HTva,EAAmB9W,UAAU2iB,OAAS,WAKrC,GAAGvhB,KAAKkwB,QAAQ,CACf,IAAIC,EAAWnwB,KAAKowB,iBAGpBpwB,KAAKkwB,QAAQ3J,YAAY4J,GACzBnwB,KAAKkwB,QAAUC,OAMfnwB,KAAKkwB,QAAUlwB,KAAKowB,iBAUrB,OAPApwB,KAAKkwB,QAAQrwB,YAAYG,KAAKqwB,oBAAoBrwB,KAAKkB,WACpDlB,KAAKmmB,eACPnmB,KAAK4W,OAAS5W,KAAKmmB,aAAahV,SAASnR,KAAKkB,UAC3ClB,KAAK4W,QAAQ5W,KAAKkwB,QAAQrwB,YAAYG,KAAK4W,SAE/C5W,KAAKgP,KAAOhP,KAAKswB,qBACdtwB,KAAKgP,MAAMhP,KAAKkwB,QAAQrwB,YAAYG,KAAKgP,MACrChP,KAAKkwB,SAGbxa,EAAmB9W,UAAUwxB,eAAiB,WAC7C,IAAI1J,EAAc1mB,KAAKkB,SAASylB,wBAC5BC,EAAO,4DAA8DF,EACzE,GAAkB,SAAfA,EACF,IAAIG,EAAKpnB,SAASC,cAAc,aAG5BmnB,EAAKpnB,SAASC,cAAc,OAMjC,OAFAmnB,EAAGlnB,aAAa,QAAS,wEAA0EK,KAAKkB,SAAS/C,KAAO,IAAMyoB,GAC9HC,EAAGlnB,aAAa,gBAAiBK,KAAKkB,SAASvC,YACxCkoB,GAGRnR,EAAmB9W,UAAU0xB,mBAAqB,WACjD,IAAI5J,EAAc1mB,KAAKkB,SAASylB,wBAC5BC,EAAO,4BAA8BF,EACzC,GAAkB,QAAfA,EACF,IAAII,EAAUrnB,SAASC,cAAc,YAGjConB,EAAUrnB,SAASC,cAAc,QAEnConB,EAAQnnB,aAAa,QAAS,4BAA8BinB,EAAO,mCACtE,IAAI,IAAI5pB,EAAG,EAAGA,EAAEgD,KAAK8Y,OAAO1Y,OAAQpD,IACnC8pB,EAAQjnB,YAAYG,KAAK8Y,OAAO9b,IAEjC,OAAO8pB,GAGRpR,EAAmB9W,UAAU2xB,iBAAmB,SAASC,GACxDxwB,KAAK8Y,OAAO7N,KAAKulB,IAGlB9a,EAAmB9W,UAAU6oB,MAAQ,WACpC3mB,eAAeC,YAAYsE,eAAerF,KAAKkwB,SAC/ClwB,KAAK8Y,OAAS,IAOfpD,EAAmB9W,UAAUyF,OAAS,WACrCrE,KAAKkwB,QAAQ/f,WAAWf,YAAYpP,KAAKkwB,UAM1Cxa,EAAmB9W,UAAUmS,OAAS,WACrC,IAAIof,EAAWnwB,KAAKowB,iBACpBpwB,KAAKkwB,QAAQ3J,YAAY4J,GACzBnwB,KAAKkwB,QAAUC,EACfnwB,KAAK8Y,OAAS,GACd9Y,KAAKkB,SAASqgB,OAAOvhB,OAGtB0V,EAAmB9W,UAAUuoB,aAAe,WAC3C,GAAGnnB,KAAKmmB,cAAgBnmB,KAAK4W,OAAQ,CACpC,IAAIwQ,EAAUpnB,KAAKmmB,aAAahV,SAASnR,KAAKkB,UAC9ClB,KAAK4W,OAAO2P,YAAYa,GACxBpnB,KAAK4W,OAASwQ,IAIhB1R,EAAmB9W,UAAUyoB,WAAa,WACzC,GAAGrnB,KAAKgP,KAAK,CACZ,IAAIsY,EAAQtnB,KAAKswB,qBACjBtwB,KAAKgP,KAAKuX,YAAYe,GACtBtnB,KAAKgP,KAAOsY,IAOd5R,EAAmB9W,UAAUyxB,oBAAsB,SAASnvB,GAC3D,IAAI2mB,EAAMpoB,SAASC,cAAc,KACjCmoB,EAAIloB,aAAa,QAAS,8BAC1B,IAAIgoB,EAAO7mB,eAAeC,YAAYgB,aAAab,EAASkW,WACxDuQ,IAAOA,EAAOzmB,EAASkW,YACvBpV,EAAO2lB,EAAM9lB,MAAM,MACfzB,OAAS,IAAGunB,EAAO3lB,EAAK,IAChC,IAEIA,EAFAE,EAAOpB,eAAeC,YAAYgB,aAAab,EAASvC,YAK5D,OAJIuD,IAAOA,EAAOhB,EAASvC,aACvBqD,EAAOE,EAAKL,MAAM,MACdzB,OAAS,IAAG8B,EAAOF,EAAK,IAChC6lB,EAAIloB,aAAa,OAAQgoB,EAAO,IAAMzlB,GAC/B2lB,GAGRnS,EAAmB9W,UAAU8oB,KAAO,SAASC,EAAMhpB,EAAU8Y,GAC5DvY,EAAgB0oB,SAASD,EAAMhpB,EAAU8Y,IAK1CwY,EAAyBrxB,UAAUuS,SAAW,SAASjQ,GACtD,IAAIwlB,EAAcxlB,EAASylB,wBACvBC,EAAO,4BAA8BF,EACzC,GAAkB,QAAfA,EACF,IAAIsB,EAASvoB,SAASC,cAAc,YAGhCsoB,EAASvoB,SAASC,cAAc,QAErCsoB,EAAOroB,aAAa,QAAS,0CAA4CinB,GACzE,IAAI6J,EAAUhxB,SAASC,cAAc,QAErC,GADA+wB,EAAQ9wB,aAAa,QAAS,oCAC3BuB,EAAS+mB,YAAY,WAAW,CAClC,IAAIyI,EAAc1wB,KAAK2wB,uBAAuBF,EAASvvB,GAC7BlB,KAAK0wB,YAAb,QAAfhK,EAA0CgK,EACrB,KAEzB,GAAGxvB,EAAS+mB,YAAY,SAAS,CAChC,IAAIH,EAAS9nB,KAAK4wB,oBAAoB1vB,GACtC,GAAGA,EAAS+mB,YAAY,WACnB4I,EAAU7wB,KAAK8wB,qBAAqB5vB,KAC5B4mB,EAAOiJ,QAAQF,GAEzB/I,GAAQ2I,EAAQ5wB,YAAYioB,QAE3B,GAAG5mB,EAAS+mB,YAAY,UAAU,CACtC,IAAI4I,KAAU7wB,KAAK8wB,qBAAqB5vB,KAC5BuvB,EAAQ5wB,YAAYgxB,GAE9B3vB,EAAS+mB,YAAY,cACnBH,EAAS9nB,KAAKgxB,sBAAsB9vB,KAC7BuvB,EAAQ5wB,YAAYioB,IAGhC,IAAImJ,EAAUxxB,SAASC,cAAc,QAGrC,GAFAuxB,EAAQtxB,aAAa,QAAS,+DAA+DuB,EAASkpB,gBAEnGlpB,EAAS+mB,YAAY,SAAS,CAChC,IAAIC,EAAWloB,KAAKkxB,oBAAoBhwB,GACrCgnB,GAAU+I,EAAQpxB,YAAYqoB,GAGlC,GAAGhnB,EAAS+mB,YAAY,QAAQ,CAC/B,IAAIS,EAAU1oB,KAAKmxB,gBAAgBjwB,GAChCwnB,GAASuI,EAAQpxB,YAAY6oB,GAGjC,GAAGxnB,EAAS+mB,YAAY,MAAM,CAC7B,IAAII,EAAQroB,KAAKoxB,iBAAiBlwB,GAC/BmnB,GAAO4I,EAAQpxB,YAAYwoB,GAG/B,GAAGnnB,EAAS+mB,YAAY,QAAQ,CAC/B,IAAIM,EAAUvoB,KAAKqxB,oBAAoBnwB,GACpCqnB,GAAS0I,EAAQpxB,YAAY0oB,GAMjC,GAAGrnB,EAAS+mB,YAAY,gBAAkB/mB,EAASowB,4BAA4B,CAC9E,IAAI1I,EAAU5oB,KAAKuxB,0BAA0BrwB,GAC1C0nB,GAASqI,EAAQpxB,YAAY+oB,GAI9B1nB,EAAS+mB,YAAY,cACnBH,EAAS9nB,KAAKwxB,sBAAsBtwB,KAC7B+vB,EAAQpxB,YAAYioB,IAQhC,OAFA2I,EAAQ5wB,YAAYoxB,GACpBjJ,EAAOnoB,YAAY4wB,GACZzI,GAGRiI,EAAyBrxB,UAAUsyB,oBAAsB,SAAShwB,GACjE,IAAI8oB,EAAY9oB,EAAS+oB,qBAEzB,GAAGD,GAAaA,EAAU5pB,OAAO,CAChC,IAAI8pB,EAAWzqB,SAASC,cAAc,QACtCwqB,EAASvqB,aAAa,QAAS,2BAC/B,IAKIiB,EAAM1B,EAAgBirB,oBAAoB,iBAAkBH,EAAW9oB,EAASkpB,gBALrE,SAASC,GACpBA,GACFnpB,EAASopB,SAASD,MAKpB,OADAH,EAASrqB,YAAYe,GACdspB,EAER,OAAO,GAGR+F,EAAyBrxB,UAAUwyB,iBAAmB,SAASlwB,GAC9D,OAAOhC,EAAgBgqB,cAAc,cAAe,WAAYhoB,EAASvC,WAAY,mDAAqDuC,EAASvC,aAGpJsxB,EAAyBrxB,UAAUyyB,oBAAsB,SAASnwB,GACjE,OAAOhC,EAAgBgqB,cAAc,gBAAiB,OAAQhoB,EAASoW,QAAS,qDAGjF2Y,EAAyBrxB,UAAUoyB,sBAAwB,SAAS9vB,GACnE,IAAI8nB,EAAM9nB,EAAS+nB,aACnB,OAAO/pB,EAAgBgqB,cAAc,oBAAoB,EAAOF,EAAG,KAAOA,EAAItR,SAG/EuY,EAAyBrxB,UAAUkyB,qBAAuB,SAAS5vB,GAClE,IAAI8nB,EAAM9nB,EAAS+nB,aACnB,OAAO/pB,EAAgBgqB,cAAc,UAAUF,EAAItR,QAAQ,EAAOsR,EAAItR,OAAQsR,EAAItR,SAGnFuY,EAAyBrxB,UAAUgyB,oBAAsB,SAAS1vB,GACjE,IAAIsa,EAAMta,EAASuY,WACnB,OAAOva,EAAgBgqB,cAAc,kBAAkB,EAAO1N,IAG/DyU,EAAyBrxB,UAAU4yB,sBAAwB,SAAStwB,GACnE,IAAIsa,EAAMta,EAASuwB,aACnB,OAAOvyB,EAAgBgqB,cAAc,oBAAoB,EAAO1N,IAGjEyU,EAAyBrxB,UAAU2yB,0BAA4B,SAASrwB,GACvE,IAAIwwB,EAAcxwB,EAASywB,iBAC3B,GAAGD,EAAYE,KAAOF,EAAYG,IACjC,GAAGH,EAAYE,KAAOF,EAAYG,IACjC,IAAIrW,EAAMkW,EAAYE,IAClB3uB,EAAO,gBAAkByuB,EAAYE,QAErC,CACApW,EAAMkW,EAAYE,IAAM,IAAMF,EAAYG,IAC1C5uB,EAAO,wBAA0ByuB,EAAYE,IACjD3uB,GAAQ,0BAA4ByuB,EAAYG,SAG7C,GAAGH,EAAYE,IACfpW,EAAM,KAAKkW,EAAYE,IAAI,GAC3B3uB,EAAO,wBAA0ByuB,EAAYE,QAE7C,KAAGF,EAAYG,IAKnB,OAAO,EAJHrW,EAAM,KAAKkW,EAAYG,IAAI,GAC3B5uB,EAAO,wBAA0ByuB,EAAYG,IAKlD,OAAO3yB,EAAgBgqB,cAAc,uBAAwB,cAAe1N,EAAKvY,IAGlFgtB,EAAyBrxB,UAAUkzB,oBAAsB,SAASC,EAAa7wB,GAC9E,GAAGA,EAAS+mB,YAAY,QAAQ,CAC/B,IAAI9mB,EAAWjC,EAAgBmqB,mBAAmB,WAAYnoB,GAC1DC,GAAU4wB,EAAYlyB,YAAYsB,GAEvC,GAAGD,EAAS+mB,YAAY,UAAU,CACjC,IAAIzoB,EAAWQ,KAAKgyB,qBAAqB9wB,GACrC1B,GAAUuyB,EAAYlyB,YAAYL,GAGtC,IAoBIopB,EAIAO,EAzBFjoB,EAAS+mB,YAAY,SAAW/mB,EAASupB,mBACvCtB,EAASnpB,KAAKiyB,eAAe/wB,KACtB6wB,EAAYlyB,YAAYspB,IAEpC,GAAGjoB,EAAS+mB,YAAY,SAAS,CAChC,IAAIwB,EAAWzpB,KAAKkyB,oBAAoBhxB,GACrCuoB,GAAUsI,EAAYlyB,YAAY4pB,GAEtC,GAAGvoB,EAAS+mB,YAAY,UAAU,CACjC,IAAI0B,EAAW3pB,KAAKmyB,qBAAqBjxB,GACtCyoB,GAAUoI,EAAYlyB,YAAY8pB,GAEtC,GAAGzoB,EAAS+mB,YAAY,QAAQ,CAC/B,IAAI4B,EAAU7pB,KAAKoyB,mBAAmBlxB,GACnC2oB,GAASkI,EAAYlyB,YAAYgqB,GAElC3oB,EAAS+mB,YAAY,WACnBW,EAAU5oB,KAAKqyB,mBAAmBnxB,KAC1B6wB,EAAYlyB,YAAY+oB,IAElC1nB,EAAS+mB,YAAY,aACnBW,EAAU5oB,KAAK6oB,qBAAqB3nB,KAC5B6wB,EAAYlyB,YAAY+oB,IAElC1nB,EAAS+mB,YAAY,QAAU/mB,EAASupB,mBACtCtB,EAASnpB,KAAKiyB,eAAe/wB,KACtB6wB,EAAYlyB,YAAYspB,KAIrC8G,EAAyBrxB,UAAU0zB,sBAAwB,SAASvK,EAAa7mB,GAChF,IAAI6a,EAAWtc,SAASC,cAAc,OACtCqoB,EAAYloB,YAAYkc,GACN7a,EAASylB,wBAoBtB3mB,KAAK8xB,oBAAoB/J,EAAa7mB,IAG5C+uB,EAAyBrxB,UAAU+xB,uBAAyB,SAASF,EAASvvB,GAC7E,IAAI6mB,EAActoB,SAASC,cAAc,QACzCqoB,EAAYpoB,aAAa,QAAS,8BAGlC,IAAI+wB,EAAc1wB,KAAKsyB,sBAAsBvK,EAAa7mB,GAE1D,OADAuvB,EAAQ5wB,YAAYkoB,GACb2I,GAGRT,EAAyBrxB,UAAUqzB,eAAiB,SAAS/wB,GAC5D,IAAGA,EAASupB,gBAgBP,CACAnrB,EAAW,WAAW4B,EAASsD,IAAI,SAAvC,IACIjF,GAAY2B,EAAS+pB,kBAAkB,QAAiB,+BAC5D,OAAO/rB,EAAgBmC,iBAAiB,WAAY,MAAO,MAAO/B,EAAUC,GAlB5E,IAAImrB,EAAKxpB,EAASypB,2BAClB,GAAGD,GAAMA,EAAGtqB,OAAO,CAClB,IAAI8pB,EAAWzqB,SAASC,cAAc,QACtCwqB,EAASvqB,aAAa,QAAS,+BAC/B+qB,EAAGhO,QAAQ,CAAEze,MAAO,GAAIoB,MAAO,aAC/B,IAAIC,EAAW,SAASqb,GACpBA,GACFzZ,EAASqxB,SAAS5X,IAGhB/Z,EAAM1B,EAAgBirB,oBAAoB,eAAgBO,EAAI,GAAIprB,GAEtE,OADA4qB,EAASrqB,YAAYe,GACdspB,EAQT,OAAO,GAGR+F,EAAyBrxB,UAAUuyB,gBAAkB,SAASjwB,GAC7D,IAAI8oB,EAAY9oB,EAASsxB,oBAEzB,GAAGxI,GAAaA,EAAU5pB,OAAO,CAChC,IAAI8pB,EAAWzqB,SAASC,cAAc,QACtCwqB,EAASvqB,aAAa,QAAS,gCAC/BqqB,EAAUtN,QAAQ,CAAEze,MAAO,GAAIoB,MAAO,eACtC,IAGIuB,EAAM1B,EAAgBirB,oBAAoB,cAAeH,EAAW,IAHzD,SAASK,GACvBnpB,EAASuxB,UAAUpI,MAIpB,OADAH,EAASrqB,YAAYe,GACdspB,EAER,OAAO,GAGR+F,EAAyBrxB,UAAUozB,qBAAuB,SAAS9wB,GAClE,IACI3B,GAAY2B,EAAS+pB,kBAAkB,WAAoB,kCAC/D,OAAO/rB,EAAgBmC,iBAAiB,WAAY,SAAU,UAF/C,WAAWH,EAAQ,WAEgD3B,IAGnF0wB,EAAyBrxB,UAAUyzB,mBAAqB,SAASnxB,GAEhE,OAAOhC,EAAgBmC,iBAAiB,WAAY,OAAQ,QAD7C,WAAWH,EAASwqB,WAIpCuE,EAAyBrxB,UAAUszB,oBAAsB,SAAShxB,GACjE,IACI3B,GAAY2B,EAAS6X,aAAsB,mBAC/C,OAAO7Z,EAAgBmC,iBAAiB,WAAY,QAAS,SAF9C,WAAWH,EAASoqB,UAE6C/rB,IAGjF0wB,EAAyBrxB,UAAUwzB,mBAAqB,SAASlxB,GAEhE,OAAOhC,EAAgBmC,iBAAiB,WAAY,OAAQ,QAD7C,WAAWH,EAASyqB,WAIpCsE,EAAyBrxB,UAAUuzB,qBAAuB,SAASjxB,GAClE,IAAI1B,EAAWC,SAASC,cAAc,QACtCF,EAASG,aAAa,QAAS,4BAC/B,IAAIJ,GAAY2B,EAAS6X,aAAsB,YAG/C,OADAvZ,EAASK,YAAYX,EAAgBmC,iBAAiB,WAAY,OAAQ,QAD3D,WAAWH,EAAS0qB,SACyDrsB,IACrFC,GAGRywB,EAAyBrxB,UAAUiqB,qBAAuB,SAAS3nB,GAClE,IAAIuT,EAAUvT,EAASqqB,sBACvB,GAAG9W,GAAWA,EAAQrU,OAAO,CAC5B,IAAI8pB,EAAWzqB,SAASC,cAAc,QACtCwqB,EAASvqB,aAAa,QAAS,4BAC/B,IAKIgB,EAAWO,EAASsqB,gBACpB5qB,EAAM1B,EAAgBirB,oBAAoB,mBAAoB1V,EAAS9T,GAN5D,SAASyT,GACpBA,GACFlT,EAASuqB,UAAUrX,MAMrB,OADA8V,EAASrqB,YAAYe,GACdspB,EAER,OAAO,GAGR+F,EAAyBrxB,UAAU8zB,UAAY,SAASxxB,EAAUuW,GACjE,IAAIxV,EAASf,EAASkW,UAAY,KAAOlW,EAASvC,WAAa,IAAM8Y,EACrEhW,OAAOC,UAAY,GAAGD,OAAOC,UAAUmB,QAAQ,kBAAkB,IAAM,IAAMZ,GAQ9ElF,EAAOD,QAAQ,CAAC4Y,qBAAmBua,6B,gBCrdnC,IAAM/wB,EAAkBD,EAAQ,GACPA,EAAQ,IAEjC,SAAS0zB,EAAezxB,GACvBlB,KAAKkB,SAAWA,EAChBlB,KAAKmmB,aAAejlB,EAAS0xB,uBAqK9B,SAASC,KAuJT,SAASC,EAAiB5xB,GACzBlB,KAAKkB,SAAWA,EAChBlB,KAAKwV,WAAa,GA3TnBmd,EAAe/zB,UAAU2iB,OAAS,WACjC,GAAGvhB,KAAK+yB,OAAO,CACd,IAAIC,EAAUhzB,KAAKizB,cACnBjzB,KAAK+yB,OAAOxM,YAAYyM,GACxBhzB,KAAK+yB,OAASC,OAGdhzB,KAAK+yB,OAAS/yB,KAAKizB,cAepB,OAbAjzB,KAAK+yB,OAAOlzB,YAAYG,KAAKkzB,iBAAiBlzB,KAAKkB,WACnDlB,KAAKgP,KAAOhP,KAAKmzB,kBACdnzB,KAAKgP,MAAMhP,KAAK+yB,OAAOlzB,YAAYG,KAAKgP,MACxChP,KAAKmmB,eACPnmB,KAAK4W,OAAS5W,KAAKmmB,aAAahV,SAASnR,KAAKkB,UACpB,QAAvBlB,KAAKkB,SAASkV,MACbpW,KAAK4W,QAAU5W,KAAK0wB,aACtB1wB,KAAK0wB,YAAY7wB,YAAYG,KAAK4W,QAI5B5W,KAAK4W,QAAQ5W,KAAK+yB,OAAOlzB,YAAYG,KAAK4W,SAE5C5W,KAAK+yB,QAGbJ,EAAe/zB,UAAUq0B,YAAc,WACtC,GAAmC,QAAhCjzB,KAAKkB,SAASkpB,eAChB,IAAIvD,EAAKpnB,SAASC,cAAc,YAG5BmnB,EAAKpnB,SAASC,cAAc,QAMjC,OAJAmnB,EAAGlnB,aAAa,QAAS,0CAA4CK,KAAKkB,SAASkpB,eAAiB,mBAAqBpqB,KAAKkB,SAAS/C,MAC9G,QAAtB6B,KAAKkB,SAAS/C,MAChB0oB,EAAGlnB,aAAa,aAAcK,KAAKkB,SAASjD,SAEtC4oB,GAGR8L,EAAe/zB,UAAUu0B,gBAAkB,WAC1C,GAAmC,QAAhCnzB,KAAKkB,SAASkpB,eAChB,IAAItD,EAAUrnB,SAASC,cAAc,YAGjConB,EAAUrnB,SAASC,cAAc,QAItC,GAFGonB,EAAQnnB,aAAa,QAAS,mEAAmEK,KAAKkB,SAASkpB,eAAiB,iCAEhIpqB,KAAKkB,SAAS+mB,YAAY,QACtB,IACCmL,EADiBpzB,KAAKkB,SAASmyB,qBACZvH,OAAO9rB,KAAKkB,SAAUlB,UAEzC,KAAGA,KAAKkB,SAAS+mB,YAAY,WAIjC,OAAO,EAHNmL,EAAOpzB,KAAKszB,gBAwBjB,OAnBMF,GAAMtM,EAAQjnB,YAAYuzB,GAmBzBtM,GAMR6L,EAAe/zB,UAAUyF,OAAS,WACjCrE,KAAK+yB,OAAO5iB,WAAWf,YAAYpP,KAAK+yB,SAGzCJ,EAAe/zB,UAAUuoB,aAAe,WACvC,GAAGnnB,KAAKmmB,cAAgBnmB,KAAK4W,OAAQ,CACpC,IAAIwQ,EAAUpnB,KAAKmmB,aAAahV,SAASnR,KAAKkB,UAC9ClB,KAAK4W,OAAO2P,YAAYa,GACxBpnB,KAAK4W,OAASwQ,IAIhBuL,EAAe/zB,UAAUyoB,WAAa,WACrC,GAAGrnB,KAAKgP,KAAK,CACZ,IAAIsY,EAAQtnB,KAAKmzB,kBACjBnzB,KAAKgP,KAAKuX,YAAYe,GACtBtnB,KAAKgP,KAAOsY,IAOdqL,EAAe/zB,UAAUs0B,iBAAmB,SAAShyB,GACpD,IAAI2mB,EAAMpoB,SAASC,cAAc,KACjCmoB,EAAIloB,aAAa,QAAS,2BAC1B,IAAIgoB,EAAO7mB,eAAeC,YAAYgB,aAAab,EAASkW,WACxDuQ,IAAOA,EAAOzmB,EAASkW,YACvBpV,EAAO2lB,EAAM9lB,MAAM,MACfzB,OAAS,IAAGunB,EAAO3lB,EAAK,IAChC,IAEIA,EAFAE,EAAOpB,eAAeC,YAAYgB,aAAab,EAASvC,YAK5D,OAJIuD,IAAOA,EAAOhB,EAASvC,aACvBqD,EAAOE,EAAKL,MAAM,MACdzB,OAAS,IAAG8B,EAAOF,EAAK,IAChC6lB,EAAIloB,aAAa,OAAQgoB,EAAO,IAAMzlB,EAAO,IAAMhB,EAASuW,OACrDoQ,GAGR8K,EAAe/zB,UAAU00B,cAAgB,WACxC,IAAItK,EAAMhpB,KAAKkB,SAAS+nB,aACxB,OAAOsK,mBAAmBxyB,YAAYmoB,cAAc,iBAAiB,EAAOF,EAAG,KAAOA,EAAG,OAG1F2J,EAAe/zB,UAAU40B,iBAAmB,SAASC,GACpD,IAAI1pB,EAAO/J,KAKX,OAJW,SAAS8N,GACnBA,EAAE4lB,iBACF3pB,EAAK7I,SAASyyB,KAAKF,KAKrBd,EAAe/zB,UAAUg1B,aAAe,SAASH,EAAMp0B,GACtD,IAAIw0B,EAAU7zB,KAAKwzB,iBAAiBC,GAChChjB,EAAIhR,SAASC,cAAc,KAI/B,GAHA+Q,EAAEqjB,QAAUD,EACZpjB,EAAE9O,KAAK8xB,EACPhjB,EAAE1Q,iBAAiB,QAAS8zB,GACzBx0B,EACFoR,EAAE5Q,YAAYJ,SAASK,eAAeT,QAElC,CACJ,IAAIyC,EAAKhB,eAAeC,YAAYgB,aAAa0xB,GAC9C3xB,GACF2O,EAAE9Q,aAAa,QAAS8zB,GACxBhjB,EAAE5Q,YAAYJ,SAASK,eAAegC,KAGtC2O,EAAE5Q,YAAYJ,SAASK,eAAe2zB,IAGxC,OAAOhjB,GAGRkiB,EAAe/zB,UAAU6oB,MAAQ,WAChC3mB,eAAeC,YAAYsE,eAAerF,KAAK+yB,SAMhDF,EAAqBj0B,UAAUuS,SAAW,SAASjQ,GAClD,GAA8B,QAA3BA,EAASkpB,eACX,IAAIpC,EAASvoB,SAASC,cAAc,YAGhCsoB,EAASvoB,SAASC,cAAc,QAGrC,GADAsoB,EAAOroB,aAAa,QAAS,+CAAiDuB,EAASkpB,gBACpFlpB,EAAS+mB,YAAY,SAAS,CAChC,IAAIC,EAAWloB,KAAK+zB,iBAAiB7yB,GAClCgnB,GAAUF,EAAOnoB,YAAYqoB,GAEjC,GAAGhnB,EAAS+mB,YAAY,UAAU,CACjC,IAAIW,EAAU5oB,KAAK6oB,qBAAqB3nB,GACrC0nB,GAASZ,EAAOnoB,YAAY+oB,GAEhC,GAAG1nB,EAAS+mB,YAAY,QAAQ,CAC/B,IAAIM,EAAUvoB,KAAKg0B,gBAAgB9yB,GAChCqnB,GAASP,EAAOnoB,YAAY0oB,GAEhC,GAAGrnB,EAAS+mB,YAAY,UAAU,CACjC,IAAIH,EAAS9nB,KAAKi0B,kBAAkB/yB,GACjC4mB,GAAQE,EAAOnoB,YAAYioB,GAE/B,GAAG5mB,EAAS+mB,YAAY,WAAW,CAClC,IAAIF,EAAc/nB,KAAKk0B,oBAAoBhzB,GACxC6mB,GAAaC,EAAOnoB,YAAYkoB,GAEpC,OAAOC,GAGR6K,EAAqBj0B,UAAUm1B,iBAAmB,SAAS7yB,GAC1D,IAAI8oB,EAAY9oB,EAAS+oB,qBAEzB,GAAGD,GAAaA,EAAU5pB,OAAO,CAChC,IAAI8pB,EAAWzqB,SAASC,cAAc,QACtCwqB,EAASvqB,aAAa,QAAS,wBAC/B,IAKIiB,EAAM1B,EAAgBirB,oBAAoB,cAAeH,EAAW9oB,EAASkpB,gBALlE,SAASC,GACpBA,GACFnpB,EAASopB,SAASD,MAKpB,OADAH,EAASrqB,YAAYe,GACdspB,EAER,OAAO,GAIR2I,EAAqBj0B,UAAUo1B,gBAAkB,SAAS9yB,GACzD,OAAOhC,EAAgBgqB,cAAc,aAAc,OAAQhoB,EAAS/B,OAAQ,2DAG7E0zB,EAAqBj0B,UAAUq1B,kBAAoB,SAAS/yB,GAC3D,IAAI8nB,EAAM9nB,EAAS+nB,aACnB,OAAO/pB,EAAgBgqB,cAAc,UAAUF,EAAItR,QAAQ,EAAOsR,EAAItR,OAAQsR,EAAItR,SAInFmb,EAAqBj0B,UAAUs1B,oBAAsB,SAAShzB,GAC7D,IAAI6mB,EAActoB,SAASC,cAAc,QAEzC,GADAqoB,EAAYpoB,aAAa,QAAS,2BAC/BuB,EAAS+mB,YAAY,QAAQ,CAC/B,IAAI9mB,EAAWjC,EAAgBmqB,mBAAmB,QAASnoB,GACxDC,GAAU4mB,EAAYloB,YAAYsB,GAEtC,GAAGD,EAAS+mB,YAAY,UAAU,CACjC,IAAIzoB,EAAWQ,KAAKm0B,kBAAkBjzB,GACnC1B,GAAUuoB,EAAYloB,YAAYL,GAEtC,GAAG0B,EAAS+mB,YAAY,SAAS,CAChC,IAAIsB,EAAWvpB,KAAKo0B,iBAAiBlzB,GAClCqoB,GAAUxB,EAAYloB,YAAY0pB,GAEtC,GAAGroB,EAAS+mB,YAAY,SAAS,CAChC,IAAIwB,EAAWzpB,KAAKq0B,iBAAiBnzB,GAClCuoB,GAAU1B,EAAYloB,YAAY4pB,GAEtC,GAAGvoB,EAAS+mB,YAAY,UAAU,CACjC,IAAI0B,EAAW3pB,KAAKs0B,kBAAkBpzB,GACnCyoB,GAAU5B,EAAYloB,YAAY8pB,GAEtC,GAAGzoB,EAAS+mB,YAAY,QAAQ,CAC/B,IAAI4B,EAAU7pB,KAAKu0B,gBAAgBrzB,GAChC2oB,GAAS9B,EAAYloB,YAAYgqB,GAErC,GAAG3oB,EAAS+mB,YAAY,QAAQ,CAC/B,IAAIW,EAAU5oB,KAAKw0B,gBAAgBtzB,GAChC0nB,GAASb,EAAYloB,YAAY+oB,GAErC,OAAOb,GAGR8K,EAAqBj0B,UAAUu1B,kBAAoB,SAASjzB,GAC3D,IACI3B,GAAY2B,EAAS+pB,kBAAkB,WAAoB,kCAC/D,OAAO/rB,EAAgBmC,iBAAiB,QAAS,SAAU,UAF5C,WAAWH,EAAQ,WAE6C3B,IAGhFszB,EAAqBj0B,UAAUy1B,iBAAmB,SAASnzB,GAC1D,IACI3B,GAAY2B,EAAS6X,aAAsB,mBAC/C,OAAO7Z,EAAgBmC,iBAAiB,QAAS,QAAS,SAF3C,WAAWH,EAASoqB,UAE0C/rB,IAG9EszB,EAAqBj0B,UAAU21B,gBAAkB,SAASrzB,GAEzD,OAAOhC,EAAgBmC,iBAAiB,QAAS,OAAQ,QAD1C,WAAWH,EAASyqB,WAIpCkH,EAAqBj0B,UAAU41B,gBAAkB,SAAStzB,GAEzD,OAAOhC,EAAgBmC,iBAAiB,QAAS,OAAQ,QAD1C,WAAWH,EAASwqB,WAIpCmH,EAAqBj0B,UAAUw1B,iBAAmB,SAASlzB,GAC1D,IACI3B,GAAY2B,EAAS+pB,kBAAkB,UAAmB,iCAC9D,OAAO/rB,EAAgBmC,iBAAiB,QAAS,QAAS,SAF3C,WAAWH,EAASmqB,UAE0C9rB,IAG9EszB,EAAqBj0B,UAAU01B,kBAAoB,SAASpzB,GAC3D,IAAI1B,EAAWC,SAASC,cAAc,QACtCF,EAASG,aAAa,QAAS,yBAC/B,IACIJ,GAAY2B,EAAS6X,aAAsB,8BAE/C,OADAvZ,EAASK,YAAYX,EAAgBmC,iBAAiB,QAAS,OAAQ,QAFxD,WAAWH,EAAS0qB,SAEsDrsB,IAClFC,GAGRqzB,EAAqBj0B,UAAUiqB,qBAAuB,SAAS3nB,GAC9D,IAAIuT,EAAUvT,EAASqqB,sBACvB,GAAG9W,GAAWA,EAAQrU,OAAO,CAC5B,IAAI8pB,EAAWzqB,SAASC,cAAc,QACtCwqB,EAASvqB,aAAa,QAAS,yBAC/B,IAKIgB,EAAWO,EAASsqB,gBACpB5qB,EAAM1B,EAAgBirB,oBAAoB,cAAe1V,EAAS9T,GANvD,SAASyT,GACpBA,GACFlT,EAASuqB,UAAUrX,MAMrB,OADA8V,EAASrqB,YAAYe,GACdspB,EAER,OAAO,GAWR4I,EAAiBl0B,UAAU2iB,OAAS,WACnCjN,MAAM,oBAEPwe,EAAiBl0B,UAAUmS,OAAS,WACnCuD,MAAM,oBAGPvX,EAAOD,QAAQ,CAAC61B,iBAAeE,uBAAqBC,qB,gBCnVpD,IAAMnqB,EAAY1J,EAAQ,GACpBmb,EAAuBnb,EAAQ,GAKrCw1B,wBAA0B,SAAS7wB,EAAI4W,EAAMvc,EAAOsC,GACnDP,KAAK4D,GAAKA,EACV5D,KAAKwa,KAAOA,EACZxa,KAAKqa,OAASpc,EACd+B,KAAKO,KAAQA,GAAc,KAC3BP,KAAK00B,aAAc,GAGpBD,wBAAwB71B,UAAU2b,QAAU,SAASC,GACpDxa,KAAKwa,KAAOA,GAGbia,wBAAwB71B,UAAU6b,UAAY,SAAS1D,GACtD/W,KAAK+W,OAASA,GAGf0d,wBAAwB71B,UAAU8b,OAAS,SAASoH,GACnDxN,MAAM,yCAA2CwN,EAAQ,MAG1D2S,wBAAwB71B,UAAUuS,SAAW,SAAS9Q,GACrD,MAAgB,SAAbL,KAAKO,MAAoBP,KAAK4D,GAAGgF,OAAOG,iBAAiBC,oBAAsBhJ,KAAK4D,GAAGpD,gBAAgB,WAClGR,KAAK20B,SAASt0B,GAEfL,KAAK40B,YAGbH,wBAAwB71B,UAAU+1B,SAAW,SAASt0B,GACrD,IAAIw0B,EAAap1B,SAASC,cAAc,QACxCm1B,EAAWl1B,aAAa,QAAS,iDACjC,IACIm1B,EADK,IAAInsB,EAAU3I,KAAK4D,GAAGgF,OAAQ,GAAI5I,KAAK4D,IAC/BwG,wBAAwB,UAAW,IAAIpK,KAAKwa,KAAK,KAC9Dua,EAAS,IAAI3a,EAAqBpa,KAAK4D,GAAIkxB,GAC/CC,EAAO5Z,aAAe,iBACtB4Z,EAAOza,aAAc,EACrB,IAAIvQ,EAAO/J,KACX+0B,EAAOra,OAAS,SAASsa,GACrBA,IACFjrB,EAAKgN,OAASie,IAGhBC,KAAOF,EAAO5jB,SAAS9Q,GACpB40B,MAAMJ,EAAWh1B,YAAYo1B,MAChC,IAAI5S,EAAS5iB,SAASC,cAAc,QACpC2iB,EAAO1iB,aAAa,QAAS,mCAC7B,IAAIiB,EAAMnB,SAASC,cAAc,UACjCkB,EAAIjB,aAAa,QAAS,+BAC1B0iB,EAAOxiB,YAAYe,GACTnB,SAASC,cAAc,UAAjC,IAMIw1B,EAAW,CACdrP,KAAM,CACFrkB,IAHWxB,KAAK4D,GAAGgF,OAAOW,QAAU,UAIpC4rB,SAAU,OACVjvB,KATQ,SAAUkvB,GAEtB,OADAA,EAAM,MAASrrB,EAAKgN,OACb5Q,KAAKC,UAAUgvB,IAQlBj2B,KAAM,OACTk2B,YAAa,kCACVC,MAAO,IACPC,OAAO,GAEXC,YAAa,sBACbhJ,MAAO,KAMR,OAJA9e,OAAO9M,GAAKwN,QAAQ8mB,GAAUxa,QAAO,WACpCpb,SAASU,KAAK/B,UAEf42B,EAAWh1B,YAAYwiB,GAChBwS,GAGRJ,wBAAwB71B,UAAUg2B,SAAW,WAC5C,IAAIC,EAAap1B,SAASC,cAAc,QACxCm1B,EAAWl1B,aAAa,QAAS,iDACjC,IAAI81B,EAAOh2B,SAASC,cAAc,SAalC,GAZA+1B,EAAK91B,aAAa,QAAS,iDAE3B81B,EAAK91B,aAAa,cAAe,qBACjC81B,EAAK11B,iBAAiB,YAAY,SAAS+N,GAG9B,MAFFA,EAAE7M,OAAS6M,EAAE4nB,UAELD,EAAKx3B,QACtB8L,EAAKsQ,OAASob,EAAKx3B,MACnB8L,EAAK2Q,OAAO+a,EAAKx3B,WAGnB42B,EAAWh1B,YAAY41B,GACpBz1B,KAAK00B,YAAY,CACnB,IAAIiB,EAAOl2B,SAASC,cAAc,UAClCi2B,EAAKh2B,aAAa,QAAS,wCAC3B,IAAIoK,EAAO/J,KACX21B,EAAK51B,iBAAiB,SAAS,WAC3B01B,EAAKx3B,QACP8L,EAAKsQ,OAASob,EAAKx3B,MACnB8L,EAAK2Q,OAAO+a,EAAKx3B,WAInB03B,EAAK91B,YAAYJ,SAASK,eAAe,OACzC+0B,EAAWh1B,YAAY81B,GAExB,OAAOd,GAGRJ,wBAAwB71B,UAAUg3B,WAAa,WAC9B,MAAb51B,KAAKO,KAAcP,KAAKO,KAAO,QAC7BP,KAAKO,KAAO,MAGlBk0B,wBAAwB71B,UAAUi3B,kBAAoB,WACrD,MAAgB,MAAb71B,KAAKO,KACA,kBAED,oBAGRxD,EAAOD,QAAQ23B,yB,gBC7Hf,IAAMqB,EAAa72B,EAAQ,IACrB8T,EAAe9T,EAAQ,GAEzByG,EAAa,IAAIowB,EAAWC,gBAC5BC,EAAU,GACdA,EAAQjQ,QAAU,CAAC,OAAatmB,SAASyQ,eAAe,uBACjD,SAAazQ,SAASyQ,eAAe,0BAC5C8lB,EAAQtU,WAAcjiB,SAASyQ,eAAe,0BAC9C8lB,EAAQC,SAAWx2B,SAASyQ,eAAe,0BAC3C8lB,EAAQ7pB,QAAU1M,SAASyQ,eAAe,0BAC1C8lB,EAAQE,SAAWz2B,SAASyQ,eAAe,qBAC3C8lB,EAAQ5hB,OAAS3U,SAASyQ,eAAe,2BACzC,IAAIimB,KAAaJ,iBAAkBA,eAAer0B,WAAYq0B,eAAer0B,SAC7EgE,EAAW0X,KAAK4Y,EAASG,GAMzBp5B,EAAOD,QAAQ,CAACg5B,WAAWA,EACX/iB,aAAaA,I,gBCb7B,IAAMqjB,EAAcn3B,EAAQ,IACtB4f,EAAyB5f,EAAQ,GACjCo3B,EAAgBp3B,EAAQ,IACxBq3B,EAAqBr3B,EAAQ,IAC7Bs3B,EAAsBt3B,EAAQ,IAC9Bu3B,EAAwBv3B,EAAQ,IAChCw3B,EAAuBx3B,EAAQ,IAC/By3B,EAAoBz3B,EAAQ,IAC5B03B,EAAoB13B,EAAQ,IAC5BD,EAAwBC,EAAQ,GAChCyc,EAAMzc,EAAQ,GACd8T,EAAe9T,EAAQ,GAE7B,SAAS62B,EAAWtpB,GACnBxM,KAAK4I,OAAS,IAAI9H,eAAe81B,WACjC52B,KAAKyW,SAAW,GAChBzW,KAAK62B,WAAWrqB,GAejBspB,EAAWl3B,UAAUk4B,QAAU,SAAStqB,GACvC,IAAIzC,EAAO/J,KACXA,KAAK4I,OAAOG,iBAAiBG,QAAS,EACtC,IAAI3K,KAAQiO,IAAQA,EAAKjO,MAAOiO,EAAKjO,IAErC,OADAyB,KAAKyf,SAAS,2BAA6BjT,EAAKtD,QACzClJ,KAAK4I,OAAOkuB,QAAQtqB,EAAKtD,OAAQ3K,GACvCyH,MAAM,SAAST,GAwBf,OAvBAwE,EAAK6V,YACFpT,GAAQA,EAAKsS,IAAM/U,EAAKgtB,YAAYvqB,EAAKsS,KAC3C/U,EAAKitB,YAAYxqB,EAAKsS,IACnBtS,EAAK/M,UAAYsK,EAAKktB,SAAS,gBACjC1xB,EAAWwE,EAAKwU,aAAa/R,EAAK/M,UAE3B+M,EAAK0qB,QAAUntB,EAAKktB,SAAS,cACpC1xB,EAAWwE,EAAKotB,eAAe3qB,EAAK0qB,QAE7B1qB,EAAK7B,OAASZ,EAAKktB,SAAS,eACnCltB,EAAKqtB,cAAc5qB,EAAK7B,OAEjB6B,EAAK0pB,UAAYnsB,EAAKktB,SAAS,gBACtCltB,EAAKstB,aAAa7qB,EAAK0pB,UAGvBnsB,EAAKqa,kBAINra,EAAKutB,qBAENvtB,EAAKgH,SACExL,KAzBD,OA2BA,SAASmf,GAGf,MAFA3a,EAAK6V,YACL7V,EAAKgW,UAAU2E,GACTA,MAgBRoR,EAAWl3B,UAAU24B,eAAiB,SAASC,GAC9C,IAAIztB,EAAO/J,KACX,IAAIw3B,EAAO3rB,KAAO2rB,EAAOtwB,MAClB,OAAOuwB,QAAQC,OAAO,IAAI9oB,MAAM7E,EAAK4tB,gBAAgB,iBAAkB,uCAE9E,IAAIvuB,EAAOouB,EAAO3rB,GACd+rB,EAAW53B,KAAK4I,OAAOG,iBAAiBG,OAC5Ca,EAAK0V,SAAS,qBAAuB+X,EAAOtwB,MAAQ,YAAckC,GAClE,IAAIyuB,EAAQ73B,KAAK83B,4BAA4BN,GAC7C,OAAOx3B,KAAK4I,OAAO2uB,eAAenuB,EAAMyuB,GACvC7xB,MAAK,SAAST,GACd,GAAGiyB,EAAON,OAAO,CAChBntB,EAAK0V,SAAS,iCAAmC+X,EAAON,QACxD,IAAI1qB,EAAQgrB,EAAOj5B,IAAO,CAAC,oBAAqBi5B,EAAOj5B,KAAQ,GAE/D,OADAiO,EAAK,qBAAuB,kBACrBzC,EAAKnB,OAAOmvB,UAAUP,EAAON,OAAQ1qB,GAC3CxG,MAAK,SAAST,GACdwE,EAAK0V,SAAS,qCACd1V,EAAKnB,OAAOG,iBAAiBG,OAAS0uB,EACtC7tB,EAAKnB,OAAOG,iBAAiBK,KAAOA,EAEpC,OAAOW,EAAKnB,OAAOovB,cAAa,EAAOzyB,EAD3B,CAAC,oBAAsB,uBAGnCS,MAAK,SAAST,GAGd,OAFAwE,EAAK6V,YACL7V,EAAKgH,SACExL,KAMT,OAFCwE,EAAK6V,YAECra,KAEPS,MAAK,SAAST,GACd,OAAOwE,EAAKkuB,gBACXjyB,MAAK,SAAST,GACd,KAAG2yB,KAAOnuB,EAAKnB,OAAOuvB,WAAWpB,YAAY3tB,IAMtC,OAAOquB,QAAQC,OAAO,IAAI9oB,MAAM7E,EAAKquB,eAAe,iBAAkB,iDAAmDhvB,KAL/HW,EAAKnB,OAAOG,iBAAiBK,KAAOA,EACpCW,EAAKqa,iBACLra,EAAKsuB,YAAY,iCAAmCjvB,EAAM,iBA/BtD,OAsCA,SAAS0W,GACf/V,EAAK6V,YACL7V,EAAKgW,UAAUD,OAOjBgW,EAAWl3B,UAAU4lB,eAAiB,SAASpb,GAC9C,IAAIW,EAAO/J,KACPs4B,EAASt4B,KAAK4I,OAAOuvB,WAAWpB,cAChCwB,EAAOnvB,GAAcpJ,KAAK8e,KAC1B0Z,EAAOF,GAAUA,EAAO,eAAiBA,EAAO,cAAc,UAAYA,EAAO,cAAc,UAAY,SAAWC,EAAM,IAAMA,EAEtI,OADAv4B,KAAKyf,SAAS,qBAAuB+Y,GAC9Bx4B,KAAK4I,OAAO4b,eAAepb,GACjCpD,MAAK,SAAST,GAOd,OANAwE,EAAK6V,YACL7V,EAAKnB,OAAOG,iBAAiBK,MAAO,EACpCW,EAAK0uB,SAASrvB,GACdW,EAAKutB,qBACLvtB,EAAKsuB,YAAY,iCAAmCG,EAAK,WACzDzuB,EAAKkuB,gBACE1yB,KARD,OAUA,SAASua,GACf/V,EAAK6V,YACL7V,EAAKgW,UAAUD,OAOjBgW,EAAWl3B,UAAUk5B,4BAA8B,SAASY,GAC3D,IAAIC,EAAM,CACT,WAAa,CACZC,KAAM,wCACNC,SAAU,0CAEX,QAAS,qBAeV,OAbGH,EAAKxxB,QACPyxB,EAAI,cAAgB,CACnB,YAAc,KACd,SAAUD,EAAKxxB,QAGdwxB,EAAKvxB,cACPwxB,EAAI,gBAAkB,CACrB,YAAc,KACd,SAAUD,EAAKvxB,cAGjBwxB,EAAI,yBAA2B,CAAE,QAAU,aAAc,SAAW,KAC7DA,GAGR7C,EAAWl3B,UAAU+4B,gBAAkB,SAASmB,EAAOpyB,GACtD,MAAO,oBAAsBoyB,EAAQ,KAAOpyB,GAG7CovB,EAAWl3B,UAAUw5B,eAAiB,SAASU,EAAOpyB,GACrD,MAAO,gBAAkBoyB,EAAQ,iDAAmDpyB,GAMrFovB,EAAWl3B,UAAU+0B,KAAO,SAASnyB,EAAKjD,GACzC,IAAIyI,EAAO,GAeX,OAdGxF,IAAqC,GAA9BA,EAAIwL,QAAQ,eACrBxL,EAAMA,EAAIe,UAAU,EAAGf,EAAIwL,QAAQ,eACnChG,EAAKvH,SAAW+B,EAAIe,UAAUf,EAAIwL,QAAQ,cAAc,KAEjDxL,IAAkC,GAA3BA,EAAIwL,QAAQ,YAC1BxL,EAAMA,EAAIe,UAAU,EAAGf,EAAIwL,QAAQ,YACnChG,EAAKkwB,OAAS,IAEP11B,IAAgC,GAAzBA,EAAIwL,QAAQ,WAC1BxL,EAAMA,EAAIe,UAAU,EAAGf,EAAIwL,QAAQ,WACnChG,EAAK2D,MAAQnJ,EAAIe,UAAUf,EAAIwL,QAAQ,UAAU,IAElDhG,EAAKkC,OAAS1H,EACXjD,IAAKyI,EAAKzI,IAAMA,GACZyB,KAAK82B,QAAQ9vB,IAMrB8uB,EAAWl3B,UAAUm6B,sBAAwB,SAASv3B,GACrD,OAAGA,IAAsC,GAA/BA,EAAIuB,YAAY,WAClBvB,EAAIe,UAAU,EAAGf,EAAIuB,YAAY,YAEtCvB,IAAwC,GAAjCA,EAAIuB,YAAY,aAClBvB,EAAIe,UAAU,EAAGf,EAAIuB,YAAY,cAEtCvB,IAAqC,GAA9BA,EAAIuB,YAAY,UAClBvB,EAAIe,UAAU,EAAGf,EAAIuB,YAAY,WAEtCvB,IAAoC,GAA7BA,EAAIuB,YAAY,SAClBvB,EAAIe,UAAU,EAAGf,EAAIuB,YAAY,UAElCvB,GAGRs0B,EAAWl3B,UAAUsK,OAAS,WAC7B,OAAOlJ,KAAK4I,OAAOG,iBAAiBG,QAGrC4sB,EAAWl3B,UAAUkgB,GAAK,WACzB,OAAO9e,KAAK4I,OAAOG,iBAAiBK,MAGrC0sB,EAAWl3B,UAAUo6B,YAAc,WAClCh5B,KAAK4I,OAAOG,iBAAiBG,QAAS,GAGvC4sB,EAAWl3B,UAAUo4B,YAAc,SAAS5tB,GAC3CpJ,KAAK4I,OAAOG,iBAAiBK,KAAOA,EACpCtI,eAAeC,YAAY2I,cAA3B,IAAkD1J,KAAK4I,OAAOG,iBAAiBQ,QAAU,aACzFzI,eAAeC,YAAY2I,cAA3B,IAAkD1J,KAAK4I,OAAOG,iBAAiBQ,QAAU,YAG1FusB,EAAWl3B,UAAUq6B,QAAU,WAC9Bj5B,KAAK4I,OAAOG,iBAAiBK,MAAO,GAGrC0sB,EAAWl3B,UAAU65B,SAAW,SAAS3Z,EAAItd,GAC5CxB,KAAK4I,OAAOuvB,WAAWM,SAAS3Z,EAAItd,IAGrCs0B,EAAWl3B,UAAUm4B,YAAc,SAASjY,EAAItd,GAC/C,OAAOxB,KAAK4I,OAAOuvB,WAAWpB,YAAYjY,EAAItd,IAG/Cs0B,EAAWl3B,UAAUq5B,cAAgB,WAEpC,OAAOj4B,KAAK4I,OAAOkuB,WAGpBhB,EAAWl3B,UAAU04B,mBAAqB,WACzCt3B,KAAKoU,OAAS,IAAIsiB,EAAkBwC,qBAAqBl5B,MACzDA,KAAKm5B,kBAGNrD,EAAWl3B,UAAUw6B,gBAAkB,SAAS/O,GAC/CrqB,KAAKoU,OAAS,IAAIuiB,EAAkB32B,KAAMqqB,GAC1CrqB,KAAKm5B,kBAGNrD,EAAWl3B,UAAUwlB,eAAiB,WACrCpkB,KAAKoU,OAAS,IAAIiiB,EAAcgD,iBAAiBr5B,MACjDA,KAAK+Q,UAGN+kB,EAAWl3B,UAAU06B,iBAAmB,WACvCt5B,KAAKoU,OAAS,IAAIiiB,EAAckD,kBAAkBv5B,MAClDA,KAAKm5B,kBAGNrD,EAAWl3B,UAAUu4B,eAAiB,SAASrW,GAC9C9gB,KAAKoU,OAAS,IAAIqiB,EAAqBz2B,MACvCA,KAAKm5B,kBAGNrD,EAAWl3B,UAAUw4B,cAAgB,SAASzsB,GAC7C3K,KAAKoU,OAAS,IAAImiB,EAAoBv2B,KAAM2K,EAAO3K,KAAKU,SACxDV,KAAKm5B,kBAGNrD,EAAWl3B,UAAU46B,gBAAkB,SAASC,GAC/Cz5B,KAAKoU,OAAS,IAAIoiB,EAAsBx2B,KAAMy5B,EAASz5B,KAAKU,SAC5DV,KAAKm5B,kBAGNrD,EAAWl3B,UAAU2f,aAAe,SAASuC,GAC5C9gB,KAAKoU,OAAS,IAAIyK,EAAuB7e,KAAM,OAAQA,KAAK05B,uBAC5D,IAAMC,EAAU35B,KAAKoU,OAAO4L,aAAac,GAEzC,OADA9gB,KAAKm5B,iBACEQ,GAGR7D,EAAWl3B,UAAUg7B,mBAAqB,SAAS9Y,GAClD9gB,KAAKoU,OAAS,IAAIyK,EAAuB7e,KAAM,SAAUA,KAAK65B,wBAC9D,IAAMF,EAAU35B,KAAKoU,OAAOoL,mBAAmBsB,GAE/C,OADA9gB,KAAKm5B,iBACEQ,GAGR7D,EAAWl3B,UAAUu6B,eAAiB,WACrCr4B,eAAeC,YAAYsE,eAAerF,KAAK85B,MAC5C95B,KAAKoU,QACPpU,KAAK85B,KAAKj6B,YAAYG,KAAKoU,OAAOjD,aAIpC2kB,EAAWl3B,UAAUm7B,WAAa,SAASx0B,GAC1CvF,KAAKq4B,YAAY9yB,EAAU,YAG5BuwB,EAAWl3B,UAAUmhB,UAAY,SAASxa,GACzCvF,KAAKq4B,YAAY9yB,EAAU,UAG5BuwB,EAAWl3B,UAAUo7B,cAAgB,SAASz0B,GAC1CvF,KAAKi2B,UAAUn1B,eAAeC,YAAYsE,eAAerF,KAAKi2B,WAGlEH,EAAWl3B,UAAUq7B,cAAgB,WACjCj6B,KAAK85B,MAAMh5B,eAAeC,YAAYsE,eAAerF,KAAK85B,OAG9DhE,EAAWl3B,UAAUs7B,cAAgB,SAASp2B,GAC7C9D,KAAKi2B,SAAWnyB,GAGjBgyB,EAAWl3B,UAAUu7B,kBAAoB,SAASr2B,GACjD9D,KAAK+lB,QAAUjiB,GAGhBgyB,EAAWl3B,UAAUw7B,iBAAmB,SAASt2B,GAChD9D,KAAK0hB,WAAa5d,GAGnBgyB,EAAWl3B,UAAUy7B,eAAiB,SAASv2B,GAC9C9D,KAAKk2B,SAAWpyB,GAGjBgyB,EAAWl3B,UAAU07B,cAAgB,SAASx2B,GAC7C9D,KAAKmM,QAAUrI,GAGhBgyB,EAAWl3B,UAAU27B,aAAe,SAASz2B,GAC5C9D,KAAK85B,KAAOh2B,GAGbgyB,EAAWl3B,UAAUwe,KAAO,SAASod,EAAOC,GACxCD,GAASA,EAAMzU,SAAS/lB,KAAKm6B,kBAAkBK,EAAMzU,SACrDyU,GAASA,EAAMvE,UAAUj2B,KAAKk6B,cAAcM,EAAMvE,UAClDuE,GAASA,EAAM9Y,YAAY1hB,KAAKo6B,iBAAiBI,EAAM9Y,YACvD8Y,GAASA,EAAMtE,UAAUl2B,KAAKq6B,eAAeG,EAAMtE,UACnDsE,GAASA,EAAMpmB,QAAQpU,KAAKu6B,aAAaC,EAAMpmB,QAC/ComB,GAASA,EAAMruB,SAASnM,KAAKs6B,cAAcE,EAAMruB,SACjDnM,KAAKmM,SACPnM,KAAKiR,cAEHjR,KAAK+lB,SACP/lB,KAAK06B,gBAEN,IAAI3wB,EAAO/J,KAEX,GAAGy6B,GAAaA,EAAUvxB,QACzB,QAAiE,IAAvDlJ,KAAK4I,OAAOuvB,WAAWA,WAAWsC,EAAUvxB,QACrD,OAAOlJ,KAAK82B,QAAQ2D,GAAb,OACA,SAAS3a,GACf/V,EAAKqvB,0BAKPp5B,KAAKo5B,mBAMPtD,EAAWl3B,UAAUmS,OAAS,SAASvK,GACtCxG,KAAKg6B,gBACFh6B,KAAK0hB,aACP5gB,eAAeC,YAAYsE,eAAerF,KAAK0hB,YAC/C1hB,KAAK26B,gBAEH36B,KAAKk2B,UACPp1B,eAAeC,YAAYsE,eAAerF,KAAKk2B,UAG7Cl2B,KAAKoU,QACPpU,KAAKm5B,iBAEH3yB,GAAKxG,KAAKq4B,YAAY7xB,IAI1BsvB,EAAWl3B,UAAUg8B,sBAAwB,SAASC,GAClD/5B,eAAeC,YAAYsE,eAAerF,KAAK0hB,YAC/C5gB,eAAeC,YAAYsE,eAAerF,KAAKk2B,UAC/Cxa,EAAMxX,uBAAuB,+BAC7B22B,EAAOz2B,UAAUI,IAAI,gCAGzBsxB,EAAWl3B,UAAU87B,cAAgB,WACnC,IAAI3wB,EAAO/J,KACXA,KAAK+lB,QAAQnd,OAAO7I,iBAAiB,SAAS,WAC5CgK,EAAK6wB,sBAAsB56B,MAC3B+J,EAAK4wB,eACL5wB,EAAKutB,wBAEPt3B,KAAK+lB,QAAQmQ,SAASn2B,iBAAiB,SAAS,WAC9CgK,EAAK6wB,sBAAsB56B,MAC3B+J,EAAK+wB,mBAIThF,EAAWl3B,UAAU+7B,aAAe,WACnC36B,KAAKyW,SAAW,GAChBzW,KAAK+6B,eACL,IAAI,IAAI/9B,EAAI,EAAGA,EAAEgD,KAAKyW,SAASrW,OAAQpD,IAAI,CAC1C,IAAIg+B,EAAWh7B,KAAKyW,SAASzZ,GAC1Bg+B,IAAaC,GAAKD,EAAS7pB,aAC7BnR,KAAK0hB,WAAW7hB,YAAYo7B,MAK/BnF,EAAWl3B,UAAUk8B,aAAe,WACnC,GAAG96B,KAAKk2B,UACJl2B,KAAKsI,YAAY,gBAAgB,CACnC,IAAI4yB,EAAM,IAAI9E,EAAYp2B,MAC1Bm7B,GAAKD,EAAI/pB,WACTnR,KAAKk2B,SAASr2B,YAAYs7B,IAC1Bn7B,KAAKk2B,SAAS71B,MAAMuE,QAAU,UAKjCkxB,EAAWl3B,UAAUm8B,aAAe,WAElC,IAKKK,EANHp7B,KAAKsI,YAAY,aACf8yB,EAAK,IAAI1E,EAAkB2E,yBAAyBr7B,QAEvDA,KAAKyW,SAASxL,KAAKmwB,GAEjBp7B,KAAK8e,MAAQ9e,KAAKsI,YAAY,QAC5B8yB,EAAK,IAAI/E,EAAciF,qBAAqBt7B,QACzCA,KAAKyW,SAASxL,KAAKmwB,KAK7BtF,EAAWl3B,UAAU0J,YAAc,SAASnE,GAC3C,OAAsC,GAAnCnE,KAAKu7B,cAAcvuB,QAAQ7I,OAC3BnE,KAAKw7B,iBAAiBr3B,MACtBnE,KAAK4I,OAAOuvB,WAAWsD,mBAAmBt3B,KAM9C2xB,EAAWl3B,UAAUq4B,SAAW,SAAS9yB,GACxC,OAAmC,GAAhCnE,KAAK07B,WAAW1uB,QAAQ7I,OACxBnE,KAAKw7B,iBAAiBr3B,MACtBnE,KAAK4I,OAAOuvB,WAAWsD,mBAAmBt3B,KAM9C2xB,EAAWl3B,UAAUghB,UAAY,SAASra,GACzCvF,KAAKg6B,gBACFh6B,KAAKoU,QAAqC,mBAApBpU,KAAKoU,OAAOunB,MAAoB37B,KAAKoU,OAAOunB,MAAK,IAG3E7F,EAAWl3B,UAAUg9B,cAAgB,SAASC,GACzC,IAAIC,EAAKr8B,SAASC,cAAc,OAC5Bq8B,EAAMt8B,SAASC,cAAc,OACjCq8B,EAAIp8B,aAAa,QAAS,+BAC1Bm8B,EAAGj8B,YAAYk8B,GAEf,IAAIC,EAAOv8B,SAASC,cAAc,OAClCs8B,EAAKr8B,aAAa,QAAS,0DAC3Bo8B,EAAIl8B,YAAYm8B,GAChB,IAAIC,EAAOx8B,SAASC,cAAc,QAClCu8B,EAAKt8B,aAAa,QAAS,2BAC3Bq8B,EAAKn8B,YAAYo8B,GAEjBJ,EAAOh8B,YAAYi8B,IAGxBhG,EAAWl3B,UAAUy5B,YAAc,SAAS7xB,EAAKrH,GAChD,GAAGa,KAAKi2B,SAAS,CAChBn1B,eAAeC,YAAYsE,eAAerF,KAAKi2B,UAC/C,IAAIiG,EAAKz8B,SAASC,cAAc,OAC1B,OAAOP,GACH,IAAK,OACD,IAAIg9B,EAAY18B,SAASC,cAAc,OACvCy8B,EAAUx8B,aAAa,QAAS,qBAChCw8B,EAAUt8B,YAAYJ,SAASK,eAAe0G,IAC9C01B,EAAGr8B,YAAYs8B,GACfn8B,KAAK47B,cAAcM,GACvB,MACA,IAAK,UACDA,EAAGv8B,aAAa,QAAS,6BACzBu8B,EAAGr8B,YAAYJ,SAASK,eAAe0G,IAC3C,MACA,IAAK,QACD01B,EAAGv8B,aAAa,QAAS,2BACzBu8B,EAAGr8B,YAAYJ,SAASK,eAAe0G,IAGrDxG,KAAKi2B,SAASp2B,YAAYq8B,KAI5BpG,EAAWl3B,UAAUgiB,eAAiB,SAASwb,EAAMj9B,GACpD,IAAIk9B,EAAQ,IAAI/F,EAAmB8F,EAAMp8B,MACzC,GAAGA,KAAKi2B,SAAS,CAChB,IAAIqG,EAAgB,UAARn9B,EAAmB,aAAe,eAC9C2B,eAAeC,YAAYsE,eAAerF,KAAKi2B,UAC/Cj2B,KAAKi2B,SAASp2B,YAAYw8B,EAAMlrB,SAASmrB,MAI3CxG,EAAWl3B,UAAU6gB,SAAW,SAASjZ,GACxCxG,KAAKq4B,YAAY7xB,EAAK,QACnBxG,KAAKoU,QAAqC,mBAApBpU,KAAKoU,OAAOunB,MAAoB37B,KAAKoU,OAAOunB,KAAKn1B,IAG3EsvB,EAAWl3B,UAAU48B,iBAAmB,SAASr3B,GAEhD,OAA0B,GADb,CAAC,SAAU,KAAM,gBAAiB,eAAgB,gBAAiB,iBACtE6I,QAAQ7I,IAInB2xB,EAAWl3B,UAAUi4B,WAAa,SAASrqB,GAC1CxM,KAAKu7B,cAAgB/uB,GAAQA,EAAKiK,SAAWjK,EAAKiK,SACjD,CAAC,SAAU,KAAM,gBAAiB,gBACjC,gBAAiB,cAAe,kBAChC,kBAAmB,eAAgB,gBACnC,aAAc,eAEhBzW,KAAK07B,WAAalvB,GAAQA,EAAK+vB,MAAQ/vB,EAAK+vB,MAAQv8B,KAAKu7B,cACtD/uB,EAAK/M,WACPO,KAAKw8B,iBAAmBhwB,EAAK/M,UAE3B+M,EAAK0qB,SACPl3B,KAAKy8B,eAAiBjwB,EAAK0qB,QAE5Bl3B,KAAK08B,MAAQ,IAAI19B,EACjB,IAAI+K,EAAO/J,KACXA,KAAK08B,MAAMjwB,KAAKD,EAAKL,SAAS,WAE7B,IADA,IAAIW,EAAO,CAAC,QAAS,QAAS,WACtB9P,EAAI,EAAGA,EAAE8P,EAAK1M,OAAQpD,IAC1B+M,EAAK2yB,MAAMl8B,gBAAgBsM,EAAK9P,KAClC+V,EAAa4pB,UAAU7vB,EAAK9P,IAG9B+M,EAAKgH,YAEHvE,EAAKJ,KAAOpM,KAAK08B,OACnB18B,KAAK08B,MAAM3sB,YAAYvD,EAAKJ,KAE7BpM,KAAK+6B,gBAGNjF,EAAWl3B,UAAU4B,gBAAkB,SAAS1B,GAC/C,OAAOkB,KAAK08B,MAAMl8B,gBAAgB1B,IAGnCg3B,EAAWl3B,UAAUqS,YAAc,WAClC,IAAIjR,KAAK08B,MAER,OADAhuB,QAAQC,IAAI,IAAIC,MAAM,gDACf,EAER5O,KAAKmM,QAAQtM,YAAYG,KAAK08B,MAAMvrB,SAASnR,QAG9C81B,EAAWl3B,UAAU86B,oBAAsB,WAC1C,SAAG15B,KAAKw8B,mBAAoBx8B,KAAKw8B,iBAAL,OACpBx8B,KAAKw8B,iBAAL,MAKT1G,EAAWl3B,UAAUi7B,qBAAuB,WAC3C,SAAG75B,KAAKw8B,mBAAoBx8B,KAAKw8B,iBAAL,OACpBx8B,KAAKw8B,iBAAL,MAKT1G,EAAWl3B,UAAUg+B,qBAAuB,WAC3C,OAAO58B,KAAK68B,iBAGb9/B,EAAOD,QAAQg5B,G;;;;;;;;ACtmBf,IAAM92B,EAAwBC,EAAQ,GAChCyc,EAAQzc,EAAQ,GAElB69B,EAAe,CACfC,QAAS,CACLjG,QAAS,CACXkG,QAAS,cACHx3B,OAAS,UACT/E,KAAS,OACTw8B,iBAAiB,GAErBC,SAAU,CACNF,QAAS,eACTx3B,OAAS,SACT/E,KAAS,YAEby2B,OAAQ,CACJ8F,QAAS,aACTx3B,OAAS,SACT/E,KAAS,OAEbhB,SAAU,CACNu9B,QAAS,eACTx3B,OAAS,WACT/E,KAAS,QAEbkK,MAAO,CACHqyB,QAAS,YACTx3B,OAAS,QACT/E,KAAS,WAGjB08B,OAAQ,CACJD,SAAU,CACN3F,eAAgB,CACZyF,QAAS,kBACTx3B,OAAS,SACT/E,KAAS,OACTw8B,iBAAiB,GAErBzY,eAAgB,CACZwY,QAAS,kBACTx3B,OAAS,SACT/E,KAAS,cAGjBy2B,OAAQ,CACJa,UAAW,CACPiF,QAAS,cACTx3B,OAAS,YACT/E,KAAS,MACTw8B,iBAAiB,GAErBjF,aAAc,CACVgF,QAAS,gBACTx3B,OAAS,eACT/E,KAAS,YAEb28B,eAAgB,CACZJ,QAAS,mBACTx3B,OAAS,iBACT/E,KAAS,cAGjBhB,SAAU,CACN49B,aAAc,CAChBL,QAAS,gBACHx3B,OAAS,eACT/E,KAAS,MACTw8B,iBAAiB,GAErBxc,eAAgB,CACZuc,QAAS,kBACTx3B,OAAS,iBACT/E,KAAS,QAEbogB,eAAgB,CACZmc,QAAS,kBACTx3B,OAAS,iBACT/E,KAAS,YAEb8f,eAAe,CACXyc,QAAS,kBACTx3B,OAAS,iBACT/E,KAAS,cAGjBkK,MAAO,CACHX,OAAQ,CACJgzB,QAAS,SACTx3B,OAAS,SACT/E,KAAS,gBACTw8B,iBAAiB,GAErBK,OAAQ,CACJN,QAAS,SACTx3B,OAAS,SACT/E,KAAS,eAMzB,SAAS21B,EAAYxyB,GACjB5D,KAAK4D,GAAKA,EACV5D,KAAKoU,OAASxQ,EAAGk2B,KACjB95B,KAAK4I,OAAS,IAAI9H,eAAe81B,WACjC52B,KAAK4I,OAAO20B,WAAY,EACxBv9B,KAAK4I,OAAO40B,sBAAuB,EACnCx9B,KAAKkc,KAAO,IAAIld,EAIpBo3B,EAAYx3B,UAAUuS,SAAW,WAC/B,IAAIssB,EAAMh+B,SAASC,cAAc,OAM/B,OALA+9B,EAAI99B,aAAa,QAAS,0BACvBK,KAAK4D,KACL5D,KAAK09B,UAAUD,EAAKz9B,KAAKoU,QACzBpU,KAAK29B,kBAAkB,UAAW39B,KAAKoU,SAEnCqpB,GAKXrH,EAAYx3B,UAAUg/B,mBAAqB,SAASntB,GAChDiL,EAAMxX,uBAAuB,qBAC7BuM,EAAErM,UAAUI,IAAI,sBAGpB4xB,EAAYx3B,UAAUi/B,mBAAqB,SAASptB,GAChDiL,EAAMxX,uBAAuB,6BAC7BuM,EAAErM,UAAUI,IAAI,8BAGpB4xB,EAAYx3B,UAAUk/B,YAAc,SAASt4B,EAAQgD,EAAK4L,GACtDsH,EAAMxX,uBAAuB,qBAC7BsE,EAAIpE,UAAUI,IAAI,qBAClBxE,KAAK29B,kBAAkBn4B,EAAQ4O,IAInCgiB,EAAYx3B,UAAUm/B,WAAa,SAASC,EAAW5pB,EAAQ6pB,GAC3D,IAAIxtB,EAAIhR,SAASC,cAAc,KAC/B+Q,EAAE9Q,aAAa,QAAS,qGACrBq+B,EAAUf,iBAAiBxsB,EAAErM,UAAUI,IAAI,qBAC9C,IAAIuF,EAAO/J,KACXyQ,EAAE1Q,iBAAiB,SAAS,WACxBgK,EAAK+zB,YAAYE,EAAUx4B,OAAQxF,KAAMoU,MAE7C,IAAI3T,EAAOhB,SAASC,cAAc,KAClCe,EAAKd,aAAa,QAAS,4BAA8Bq+B,EAAUv9B,MACnEgQ,EAAE5Q,YAAYY,GACd,IAAIoD,EAAMpE,SAASK,eAAek+B,EAAUhB,SAC5CvsB,EAAE5Q,YAAYgE,GACdo6B,EAAGp+B,YAAY4Q,IAInB2lB,EAAYx3B,UAAU8+B,UAAY,SAASQ,EAAQ9pB,GAE/C,IAAI5L,EAAM/I,SAASC,cAAc,OACjCw+B,EAAOr+B,YAAY2I,GAEnB,IAAIy1B,EAAKx+B,SAASC,cAAc,MAIhC,IAAK,IAAInB,KAHT0/B,EAAGt+B,aAAa,QAAS,eACzB6I,EAAI3I,YAAYo+B,GAEAnB,EAAaC,QACrBD,EAAaC,QAAQl+B,eAAeN,IACpCyB,KAAK+9B,WAAWjB,EAAaC,QAAQx+B,GAAM6V,EAAQ6pB,GAG3D,OAAOC,GAKX9H,EAAYx3B,UAAU++B,kBAAoB,SAASp9B,EAAM6T,GAErDtT,eAAeC,YAAYsE,eAAe+O,GAE1C,IAAIjS,EAAO1C,SAASC,cAAc,OAElC0U,EAAOvU,YAAYsC,IACfg8B,EAAO1+B,SAASC,cAAc,QAC7BC,aAAa,QAAS,mBAC3BwC,EAAKtC,YAAYs+B,GACjB,IAAIra,EAAMrkB,SAASC,cAAc,OACjCokB,EAAInkB,aAAa,QAAS,aAC1Bw+B,EAAKt+B,YAAYikB,GACjB,IAAI9U,EAAOvP,SAASC,cAAc,OAClCsP,EAAKrP,aAAa,QAAS,wBAC3BmkB,EAAIjkB,YAAYmP,GAChB,IAAIuU,EAAM9jB,SAASC,cAAc,OACjC6jB,EAAI5jB,aAAa,QAAS,iFAC1BqP,EAAKnP,YAAY0jB,GAEjB,IAAI4a,EAAO1+B,SAASC,cAAc,OAElC,OAAOa,GACH,IAAK,UACD,IAAI69B,EAHDp+B,KAGgBq+B,mBAAmBF,GACtC5a,EAAI1jB,YAAYu+B,GACpB,MACA,IAAK,SACGA,EAPDp+B,KAOgBs+B,oBAAoBH,GACvC5a,EAAI1jB,YAAYu+B,GACpB,MACA,IAAK,SACGA,EAXDp+B,KAWgBu+B,aAAaJ,GAChC5a,EAAI1jB,YAAYu+B,GACpB,MACA,IAAK,WACGA,EAfDp+B,KAegBw+B,eAAeL,GAClC5a,EAAI1jB,YAAYu+B,GACpB,MACA,IAAK,QACGA,EAnBDp+B,KAmBgBy+B,YAAYN,GAC/B5a,EAAI1jB,YAAYu+B,GAGxB,OAAOj8B,GAIXi0B,EAAYx3B,UAAU8/B,gBAAkB,SAASC,EAAYn5B,EAAQ24B,EAAMnvB,GAEvE,OADAlO,eAAeC,YAAYsE,eAAe2J,GACnC2vB,GACH,IAAK,WACD,IAAI76B,EAAM9D,KAAK4+B,eAAep5B,EAAQwJ,GAC1C,MACA,IAAK,SAGL,IAAK,WACIlL,EAAM9D,KAAK6+B,cAAcr5B,EAAQwJ,GAC1C,MACA,IAAK,QACGlL,EAAM9D,KAAK8+B,eAAet5B,EAAQwJ,GAC1C,MACA,QACIN,QAAQC,IAAI,sBAGpBwvB,EAAKt+B,YAAYiE,IAGrBsyB,EAAYx3B,UAAUmgC,eAAiB,SAASJ,EAAYK,EAAe7B,EAAQgB,EAAMnvB,GACrFhP,KAAK69B,mBAAmBV,GACxBn9B,KAAK0+B,gBAAgBC,EAAYK,EAAcx5B,OAAQ24B,EAAMnvB,IAIjEonB,EAAYx3B,UAAUqgC,cAAgB,SAASN,EAAYK,EAAeb,EAAMnvB,EAAMivB,GAElF,GAA2B,kBAAxBe,EAAcx5B,OAAjB,CACA,IAAIiL,EAAIhR,SAASC,cAAc,KAC/B+Q,EAAE9Q,aAAa,QAAS,wGACrBq/B,EAAc/B,iBAAiBxsB,EAAErM,UAAUI,IAAI,6BAClD,IAAIuF,EAAO/J,KACXyQ,EAAE1Q,iBAAiB,SAAS,WACxBgK,EAAKg1B,eAAeJ,EAAYK,EAAeh/B,KAAMm+B,EAAMnvB,MAE/D,IAAIvO,EAAOhB,SAASC,cAAc,KAClCe,EAAKd,aAAa,QAAS,4BAA8Bq/B,EAAcv+B,MACvEgQ,EAAE5Q,YAAYY,GACd,IAAIoD,EAAMpE,SAASK,eAAek/B,EAAchC,SAChDvsB,EAAE5Q,YAAYgE,GACdo6B,EAAGp+B,YAAY4Q,KAInB2lB,EAAYx3B,UAAUy/B,mBAAqB,SAASrvB,GAChD,IACIrJ,EAAKlG,SAASC,cAAc,MAChCsP,EAAKnP,YAAY8F,GAEjB,IAAIu5B,EAAIl/B,KAAKm/B,aAAa,WAC1BnwB,EAAKnP,YAAYq/B,GAEjBlwB,EAAKnP,YAAY6b,EAAMlY,aAAa,eAChCmC,EAAKlG,SAASC,cAAc,MAKhC,OAJAsP,EAAKnP,YAAY8F,GAEjB3F,KAAKo/B,QAAS,GAAIpwB,GAAM,EAAM,UAAW,oBAElCA,GAIXonB,EAAYx3B,UAAU0/B,oBAAsB,SAASH,GACjD,IAAInvB,EAAOvP,SAASC,cAAc,OAE9Bu+B,EAAKx+B,SAASC,cAAc,MAGhC,IAAK,IAAInB,KAFT0/B,EAAGt+B,aAAa,QAAQ,0BAERm9B,EAAaK,OAAOD,SAC5BJ,EAAaK,OAAOD,SAASr+B,eAAeN,IAC5CyB,KAAKi/B,cAAc,WAAYnC,EAAaK,OAAOD,SAAS3+B,GAAM4/B,EAAMnvB,EAAMivB,GAEtFE,EAAKt+B,YAAYo+B,GAEjB,IAAIn6B,EAAM9D,KAAK4+B,eAAe9B,EAAaK,OAAOD,SAAS3F,eAAe/xB,OAAQwJ,GAElF,OADAmvB,EAAKt+B,YAAYiE,GACVq6B,GAIX/H,EAAYx3B,UAAU2/B,aAAe,SAASJ,GAC1C,IAAInvB,EAAOvP,SAASC,cAAc,OAE9Bu+B,EAAKx+B,SAASC,cAAc,MAGhC,IAAK,IAAInB,KAFT0/B,EAAGt+B,aAAa,QAAQ,0BAERm9B,EAAaK,OAAOjG,OAC5B4F,EAAaK,OAAOjG,OAAOr4B,eAAeN,IAC1CyB,KAAKi/B,cAAc,SAAUnC,EAAaK,OAAOjG,OAAO34B,GAAM4/B,EAAMnvB,EAAMivB,GAGlFE,EAAKt+B,YAAYo+B,GACjB,IAAIn6B,EAAM9D,KAAK6+B,cAAc/B,EAAaK,OAAOjG,OAAOa,UAAUvyB,OAAQwJ,GAE1E,OADAmvB,EAAKt+B,YAAYiE,GACVq6B,GAIX/H,EAAYx3B,UAAU4/B,eAAiB,SAASL,GAC5C,IAAInvB,EAAOvP,SAASC,cAAc,OAE9Bu+B,EAAKx+B,SAASC,cAAc,MAGhC,IAAK,IAAInB,KAFT0/B,EAAGt+B,aAAa,QAAQ,0BAERm9B,EAAaK,OAAO19B,SAC5Bq9B,EAAaK,OAAO19B,SAASZ,eAAeN,IAC5CyB,KAAKi/B,cAAc,WAAYnC,EAAaK,OAAO19B,SAASlB,GAAM4/B,EAAMnvB,EAAMivB,GAGtFE,EAAKt+B,YAAYo+B,GACjB,IAAIn6B,EAAM9D,KAAK6+B,cAAc/B,EAAaK,OAAO19B,SAAS49B,aAAa73B,OAAQwJ,GAE/E,OADAmvB,EAAKt+B,YAAYiE,GACVq6B,GAIX/H,EAAYx3B,UAAU6/B,YAAe,SAASN,GAC1C,IAAInvB,EAAOvP,SAASC,cAAc,OAE9Bu+B,EAAKx+B,SAASC,cAAc,MAGhC,IAAK,IAAInB,KAFT0/B,EAAGt+B,aAAa,QAAQ,0BAERm9B,EAAaK,OAAOxyB,MAC5BmyB,EAAaK,OAAOxyB,MAAM9L,eAAeN,IACzCyB,KAAKi/B,cAAc,QAASnC,EAAaK,OAAOxyB,MAAMpM,GAAM4/B,EAAMnvB,EAAMivB,GAGhFE,EAAKt+B,YAAYo+B,GACjB,IAAIn6B,EAAM9D,KAAK8+B,eAAehC,EAAaK,OAAOxyB,MAAMX,OAAOxE,OAAQwJ,GAEvE,OADAmvB,EAAKt+B,YAAYiE,GACVq6B,GAKX/H,EAAYx3B,UAAUggC,eAAiB,SAASzgC,EAAM6Q,GAClD,IACIrJ,EAAKlG,SAASC,cAAc,MAChCsP,EAAKnP,YAAY8F,GAEjB,IAAIu5B,EAAIl/B,KAAKm/B,aAAahhC,GAC1B6Q,EAAKnP,YAAYq/B,GAEjBlwB,EAAKnP,YAAY6b,EAAMlY,aAAa,eAChCmC,EAAKlG,SAASC,cAAc,MAKhC,OAJAsP,EAAKnP,YAAY8F,GAEN,UAARxH,EAAkB6B,KAAKo/B,QAAS,KAAMpwB,GAAM,EAAO7Q,EAAM,4BACvD6B,KAAKo/B,QAAS,KAAMpwB,GAAM,EAAM7Q,EAAM,4BACpC6Q,GAIXonB,EAAYx3B,UAAUygC,cAAgB,WAEpC,IAAIC,EAAO7/B,SAASC,cAAc,QAClC4/B,EAAK3/B,aAAa,QAAS,uCAEvB4/B,EAAK9/B,SAASC,cAAc,QAC7BC,aAAa,QAAS,0BACzB2/B,EAAKz/B,YAAY0/B,GACjB,IAAIC,EAAW//B,SAASC,cAAc,SACtC8/B,EAAS7/B,aAAa,QAAS,0BAC/B6/B,EAAS7/B,aAAa,MAAO,cAC7B6/B,EAASv/B,UAAY,OACrBs/B,EAAG1/B,YAAY2/B,IACXC,EAAKhgC,SAASC,cAAc,QAC7BC,aAAa,QAAS,qBACzB4/B,EAAG1/B,YAAY4/B,GACf,IAQIF,EARAG,EAAQjgC,SAASC,cAAc,SACnCggC,EAAM//B,aAAa,OAAQ,QAC3B+/B,EAAM//B,aAAa,KAAM,cACzB+/B,EAAM//B,aAAa,QAAS,uBAC5B+/B,EAAM//B,aAAa,cAAe,oBAC/BK,KAAKqqB,MAAKqV,EAAMzhC,MAAQ+B,KAAKqqB,KAChCoV,EAAG5/B,YAAY6/B,IAEXH,EAAK9/B,SAASC,cAAc,QAC7BC,aAAa,QAAS,0BACzB2/B,EAAKz/B,YAAY0/B,GACjB,IAKIE,EALAE,EAAWlgC,SAASC,cAAc,SACtCigC,EAAShgC,aAAa,QAAS,0BAC/BggC,EAAShgC,aAAa,MAAO,cAC7BggC,EAAS1/B,UAAY,OACrBs/B,EAAG1/B,YAAY8/B,IACXF,EAAKhgC,SAASC,cAAc,QAC7BC,aAAa,QAAS,qBACzB4/B,EAAG1/B,YAAY4/B,GACf,IAAIlhC,EAAMkB,SAASC,cAAc,SACjCnB,EAAIoB,aAAa,OAAQ,QACzBpB,EAAIoB,aAAa,KAAM,cACvBpB,EAAIoB,aAAa,QAAS,6BAC1BpB,EAAIoB,aAAa,cAAe,aAC7BK,KAAKqqB,MAAK9rB,EAAIN,MAAQ+B,KAAKqqB,KAC9BoV,EAAG5/B,YAAYtB,GAEf,IAAIqB,EAASH,SAASC,cAAc,UACpCE,EAAOD,aAAa,QAAS,sCAC7BC,EAAOD,aAAa,OAAQ,UAC5BC,EAAOK,UAAY,WACnB,IAMI2/B,EAAOngC,SAASC,cAAc,OAClC4/B,EAAKz/B,YAAYD,GACjB0/B,EAAKz/B,YAAY+/B,GACjB,IAAI71B,EAAO/J,KAWX,OAVAJ,EAAOG,iBAAiB,SAAS,WAC/B,IAEImD,EAbU,WACd,IAAIA,EAAQ,GAGZ,OAFAA,EAAM1B,IAAMk+B,EAAMzhC,MAClBiF,EAAM3E,IAAMA,EAAIN,MACTiF,EASK28B,GACZ91B,EAAKnB,OAAOkuB,QAAQ5zB,EAAM1B,IAAK0B,EAAM3E,KACpCyH,MAAK,SAAST,GACbzE,eAAeC,YAAYsE,eAAeu6B,GAC1BlkB,EAAMpW,eAAeC,EAAU,UAAWq6B,EAAM71B,EAAKnG,UAGlE07B,GAITlJ,EAAYx3B,UAAU0/B,oBAAsB,SAASH,GACnD,IAAInvB,EAAOvP,SAASC,cAAc,OAE9Bu+B,EAAKx+B,SAASC,cAAc,MAGhC,IAAK,IAAInB,KAFT0/B,EAAGt+B,aAAa,QAAQ,0BAERm9B,EAAaK,OAAOD,SAC5BJ,EAAaK,OAAOD,SAASr+B,eAAeN,IAC5CyB,KAAKi/B,cAAc,WAAYnC,EAAaK,OAAOD,SAAS3+B,GAAM4/B,EAAMnvB,EAAMivB,GAGtFE,EAAKt+B,YAAYo+B,GAEjB,IAAIn6B,EAAM9D,KAAK4+B,eAAe9B,EAAaK,OAAOD,SAAS3F,eAAe/xB,OAAQwJ,GAElF,OADAmvB,EAAKt+B,YAAYiE,GACVq6B,GAKT/H,EAAYx3B,UAAUigC,cAAgB,SAASr5B,EAAQwJ,GACnD,IACIrJ,EAAKlG,SAASC,cAAc,MAChCsP,EAAKnP,YAAY8F,GAEjB,IAAIu5B,EAAIl/B,KAAKm/B,aAAa35B,GAC1BwJ,EAAKnP,YAAYq/B,GAEjBlwB,EAAKnP,YAAY6b,EAAMlY,aAAa,eAChCmC,EAAKlG,SAASC,cAAc,MAGhC,OAFAsP,EAAKnP,YAAY8F,GAEVH,GACH,IAAK,YACDxF,KAAKo/B,QAAS,SAAUpwB,GAAM,EAAMxJ,EAAQ,4BAChD,MACA,IAAK,iBACDxF,KAAKo/B,QAAS,iBAAkBpwB,GAAM,EAAMxJ,EAAQ,4BACxD,MACA,IAAK,eACDxF,KAAKo/B,QAAS,SAAUpwB,GAAM,EAAOxJ,EAAQ,4BACjD,MACA,IAAK,eAGL,IAAK,iBACDxF,KAAKo/B,QAAQ,WAAYpwB,GAAM,EAAMxJ,EAAQ,iDACjD,MACA,IAAK,iBAGL,IAAK,iBACDxF,KAAKo/B,QAAQ,WAAYpwB,GAAM,EAAOxJ,EAAQ,iDAClD,MACA,QACIkJ,QAAQC,IAAI,4BAIrB,OAAOK,GAIVonB,EAAYx3B,UAAUkgC,eAAiB,SAASt5B,EAAQwJ,GACpD,IAAIrJ,EAAKlG,SAASC,cAAc,MAChCsP,EAAKnP,YAAY8F,GAEjB,IAAIu5B,EAAIl/B,KAAKm/B,aAAa35B,GAC1BwJ,EAAKnP,YAAYq/B,GAEjBlwB,EAAKnP,YAAY6b,EAAMlY,aAAa,eAChCmC,EAAKlG,SAASC,cAAc,MAGhC,OAFAsP,EAAKnP,YAAY8F,GACjB3F,KAAKo/B,QAAS,QAASpwB,GAAM,EAAOxJ,EAAQ,4BACrCwJ,GAuFXonB,EAAYx3B,UAAUwgC,QAAU,SAASU,EAAQ9wB,EAAMzO,EAAMiF,EAAQu6B,GAEjE,IAAIC,EAAUvgC,SAASC,cAAc,QACrCsgC,EAAQrgC,aAAa,QAAS,uCAC1B4/B,EAAK9/B,SAASC,cAAc,QAC7BC,aAAa,QAAS,0BACzBqgC,EAAQngC,YAAY0/B,GACpB,IAAIU,EAAWxgC,SAASC,cAAc,SACtCugC,EAAStgC,aAAa,QAAS,0BAC/BsgC,EAAStgC,aAAa,MAAO,cAC7BsgC,EAAShgC,UAAY,OACrBs/B,EAAG1/B,YAAYogC,IACXR,EAAKhgC,SAASC,cAAc,QAC7BC,aAAa,QAAS,qBACzB4/B,EAAG1/B,YAAY4/B,GACf,IAAIS,EAASzgC,SAASC,cAAc,SAOpC,OANAwgC,EAAOvgC,aAAa,OAAQ,QAC5BugC,EAAOvgC,aAAa,KAAM,cAC1BugC,EAAOvgC,aAAa,QAAS,6BAC7BugC,EAAOvgC,aAAa,cAAeogC,GACnCN,EAAG5/B,YAAYqgC,GAERJ,GACH,IAAK,kBACGP,EAAK9/B,SAASC,cAAc,QAC7BC,aAAa,QAAS,0BACzBqgC,EAAQngC,YAAY0/B,GACpB,IAAIY,EAAc1gC,SAASC,cAAc,SACzCygC,EAAYxgC,aAAa,QAAS,0BAClCwgC,EAAYxgC,aAAa,MAAO,cAChCwgC,EAAYlgC,UAAY,WACxBs/B,EAAG1/B,YAAYsgC,IACXV,EAAKhgC,SAASC,cAAc,QAC7BC,aAAa,QAAS,qBACzB4/B,EAAG1/B,YAAY4/B,GACf,IAAIW,EAAY3gC,SAASC,cAAc,SACvC0gC,EAAUzgC,aAAa,OAAQ,QAC/BygC,EAAUzgC,aAAa,KAAM,cAC7BygC,EAAUzgC,aAAa,QAAS,6BAChCygC,EAAUzgC,aAAa,cAAe,+BACtC8/B,EAAG5/B,YAAYugC,IA6BnBb,EAAK9/B,SAASC,cAAc,QAC7BC,aAAa,QAAS,0BACzBqgC,EAAQngC,YAAY0/B,GACpB,IAAII,EAAWlgC,SAASC,cAAc,SACtCigC,EAAShgC,aAAa,QAAS,0BAC/BggC,EAAShgC,aAAa,MAAO,cAC7BggC,EAAS1/B,UAAY,OACrBs/B,EAAG1/B,YAAY8/B,IACXF,EAAKhgC,SAASC,cAAc,QAC7BC,aAAa,QAAS,qBACzB4/B,EAAG1/B,YAAY4/B,GACf,IAAIY,EAAS5gC,SAASC,cAAc,SAMpC,GALA2gC,EAAO1gC,aAAa,OAAQ,QAC5B0gC,EAAO1gC,aAAa,KAAM,cAC1B0gC,EAAO1gC,aAAa,QAAS,6BAC7B0gC,EAAO1gC,aAAa,cAAe,OACnC8/B,EAAG5/B,YAAYwgC,IACX9/B,EAAK,CAEL,IAAIg/B,KAAK9/B,SAASC,cAAc,QAC7BC,aAAa,QAAS,0BACzBqgC,EAAQngC,YAAY0/B,GACpB,IAMIE,EANAa,EAAW7gC,SAASC,cAAc,SACtC4gC,EAAS3gC,aAAa,QAAS,0BAC/B2gC,EAAS3gC,aAAa,MAAO,cAChB,SAAVmgC,IAAmBQ,EAASrgC,UAAY,UAC3CqgC,EAASrgC,UAAY,YACrBs/B,EAAG1/B,YAAYygC,IACXb,EAAKhgC,SAASC,cAAc,QAC7BC,aAAa,QAAS,qBACzB4/B,EAAG1/B,YAAY4/B,GACf,IAAIc,EAAS9gC,SAASC,cAAc,YACpC+/B,EAAG5/B,YAAY0gC,GACfA,EAAO5gC,aAAa,QAAS,mCAC7B+b,EAAM7W,cAAc7E,KAAK4D,GAAI28B,EAAQ,UAAW,cAEpDvxB,EAAKnP,YAAYmgC,GAEjB,IAAIQ,EAAK,GACTA,EAAIh/B,IAAM0+B,EACVM,EAAIjiC,IAAM8hC,EACG,kBAAVP,IAA4BU,EAAIC,OAASL,GAExC7/B,IAAMigC,EAAI7H,IAAM4H,GACpB,IAAIjB,EAAOt/B,KAAK0gC,iBAAiBl7B,EAAQg7B,GACzCxxB,EAAKnP,YAAYy/B,IAKrBlJ,EAAYx3B,UAAU+hC,WAAa,SAASn7B,EAAQtC,GAElD,IAAIo8B,EAAO7/B,SAASC,cAAc,QAClC4/B,EAAK3/B,aAAa,QAAS,sCAE3B,IAAIC,EAASH,SAASC,cAAc,UACpCE,EAAOD,aAAa,QAAS,sCAC7BC,EAAOD,aAAa,OAAQ,UAC5BC,EAAOK,UAAY,WACnBq/B,EAAKz/B,YAAYD,GACjB,IAAIggC,EAAOngC,SAASC,cAAc,OAClC4/B,EAAKz/B,YAAY+/B,GACjB,IAAI71B,EAAO/J,KACX,OAAOwF,GACL,IAAK,YACH5F,EAAOG,iBAAiB,SAAS,WAC/B,IAAIyM,EAAO,GACXA,EAAK,qBAAuBtJ,EAAM09B,IAAI3iC,MACtCuO,EAAK,qBAAuB,kBAC5B,IAAIq0B,EAAS39B,EAAM1B,IAAIvD,MAEvB8L,EAAKnB,OAAOmvB,UAAU8I,EAAQr0B,GAC7BxG,MAAK,SAAST,GACbzE,eAAeC,YAAYsE,eAAeu6B,GAC1BlkB,EAAMpW,eAAeC,EAAU,YAAaq6B,EAAM71B,EAAKnG,UAG7E,MACA,IAAK,eACHhE,EAAOG,iBAAiB,SAAS,WAC/B,IAAI+gC,EAAa9gC,KACjBwM,KAAO,GACPA,KAAK,qBAAuBtJ,EAAM09B,IAAI3iC,MACtCuO,KAAK,qBAAuB,kBAC5B,IAAIq0B,EAAS39B,EAAM1B,IAAIvD,MACvB8L,EAAKnB,OAAOG,iBAAiBg4B,gBAAiB,EAC9Ch3B,EAAKnB,OAAOovB,aAAa6I,EAAQ39B,EAAMy1B,IAAI16B,MAAOuO,MACjDxG,MAAK,SAAST,GACb,IAAIy7B,EAASvhC,SAASC,cAAc,YACpCshC,EAAOrhC,aAAa,YAAY,GAChCqhC,EAAO/gC,UAAYsF,EACJu7B,EAAW3wB,WACjBtQ,YAAYmhC,GACrBtlB,EAAM7W,cAAc7E,KAAK4D,GAAIq9B,MAAO,SAAU,gBAGpD,MACA,IAAK,eACHrhC,EAAOG,iBAAiB,SAAS,WACjC,IAAImhC,EAAQh+B,EAAMjF,MAEduO,EAAO,CACXA,OAAc,UACdzC,EAAKnB,OAAOqX,YAAYihB,EAAO10B,GAC9BxG,MAAK,SAAST,GACbzE,eAAeC,YAAYsE,eAAeu6B,GAC1BlkB,EAAMpW,eAAeC,EAAUC,EAAQo6B,EAAM71B,EAAKnG,UAGtE,MACA,IAAK,iBACHhE,EAAOG,iBAAiB,SAAS,WACjC,IAAImhC,EAAQh+B,EAAMjF,MAGlB8L,EAAKnB,OAAO2X,eAAe2gB,EADhB,IAEVl7B,MAAK,SAAST,GACbzE,eAAeC,YAAYsE,eAAeu6B,GAC1BlkB,EAAMpW,eAAeC,EAAUC,EAAQo6B,EAAM71B,EAAKnG,UAGtE,MACA,IAAK,iBACHhE,EAAOG,iBAAiB,SAAS,WAC/B,IAAImhC,EAAQh+B,EAAMi+B,aAAaljC,MAC3BmjC,EAAUl+B,EAAMm+B,WAAWC,WAE/B90B,KAAO,GACPzC,EAAKnB,OAAO6X,eAAeygB,EAAOE,EAAS50B,MAC1CxG,MAAK,SAAST,GACbzE,eAAeC,YAAYsE,eAAeu6B,GAC1BlkB,EAAMpW,eAAeC,EAAUC,EAAQo6B,EAAM71B,EAAKnG,UAGxE,MACA,IAAK,iBACHhE,EAAOG,iBAAiB,SAAS,WAC/B,IAAImhC,EAAQh+B,EAAMi+B,aAAaljC,MAC3BmjC,EAAUl+B,EAAMm+B,WAAWC,WAE/B90B,KAAO,GACPA,KAAKjF,SAAW,UAChBiF,KAAKlF,OAAS,OACdyC,EAAKnB,OAAOiY,eAAeqgB,EAAOE,EAAS50B,MAC1CxG,MAAK,SAAST,GACbzE,eAAeC,YAAYsE,eAAeu6B,GAC1BlkB,EAAMpW,eAAeC,EAAUC,EAAQo6B,EAAM71B,EAAKnG,UAM1E,IAAI+B,EAAKlG,SAASC,cAAc,MAChC4/B,EAAKz/B,YAAY8F,GACbA,EAAKlG,SAASC,cAAc,MAGhC,OAFA4/B,EAAKz/B,YAAY8F,GAEV25B,GAKTlJ,EAAYx3B,UAAU8hC,iBAAmB,SAASl7B,EAAQtC,GAEtD,IAAIo8B,EAAO7/B,SAASC,cAAc,QAClC4/B,EAAK3/B,aAAa,QAAS,sCAC3B,IAAIC,EAASH,SAASC,cAAc,UACpCE,EAAOD,aAAa,QAAS,sCAC7BC,EAAOD,aAAa,OAAQ,UAC5BC,EAAOK,UAAY,WACnBq/B,EAAKz/B,YAAYD,GACjB,IAAIggC,EAAOngC,SAASC,cAAc,OAClC4/B,EAAKz/B,YAAY+/B,GACjB,IAAI71B,EAAO/J,KACX,OAAOwF,GACH,IAAK,UACD5F,EAAOG,iBAAiB,SAAS,WAC7BgK,EAAKnB,OAAOkuB,QAAQ5zB,EAAM1B,IAAIvD,MAAOiF,EAAM3E,IAAIN,OAC9C+H,MAAK,SAAST,GACdzE,eAAeC,YAAYsE,eAAeu6B,GACvBlkB,EAAMpW,eAAeC,EAAUC,EAAQo6B,EAAM71B,EAAKnG,UAG9E,MACA,IAAK,SACDhE,EAAOG,iBAAiB,SAAS,SAASu/B,GACxCv1B,EAAKnB,OAAO2uB,eAAer0B,EAAM1B,IAAIvD,MAAOkI,KAAK6nB,MAAM9qB,EAAMy1B,IAAI16B,OAAQiF,EAAM3E,IAAIN,OAClF+H,MAAK,SAAST,GACdzE,eAAeC,YAAYsE,eAAeu6B,GACvBlkB,EAAMpW,eAAeC,EAAUC,EAAQo6B,EAAM71B,EAAKnG,UAG5E,MACA,IAAK,SACDhE,EAAOG,iBAAiB,SAAS,WAE/BgK,EAAKnB,OAAO4b,eAAethB,EAAM1B,IAAIvD,MAAOiF,EAAM3E,IAAIN,OACrD+H,MAAK,SAAST,GACdzE,eAAeC,YAAYsE,eAAeu6B,GACvBlkB,EAAMpW,eAAeC,EAAUC,EAAQo6B,EAAM71B,EAAKnG,UAG5E,MACA,IAAK,YACDhE,EAAOG,iBAAiB,SAAS,WAC7B,IAAIyM,EAAO,CACXA,oBAA4B,mBAC5BA,EAAK,qBAAuBtJ,EAAM3E,IAAIN,MACtC,IAAI4iC,EAAS39B,EAAM1B,IAAIvD,MACvB8L,EAAKnB,OAAOmvB,UAAU8I,EAAQr0B,GAC7BxG,MAAK,SAAST,GACdzE,eAAeC,YAAYsE,eAAeu6B,GACvBlkB,EAAMpW,eAAeC,EAAUC,EAAQo6B,EAAM71B,EAAKnG,UAG9E,MACA,IAAK,eACDhE,EAAOG,iBAAiB,SAAS,WAC7ByM,KAAO,GACPA,KAAK,qBAAuB,kBAC5BA,KAAK,qBAAuBtJ,EAAM3E,IAAIN,MACxBiF,EAAMy1B,IAAI16B,MAAxB,IACI4iC,EAAS39B,EAAM1B,IAAIvD,MACvB8L,EAAKnB,OAAOG,iBAAiBg4B,gBAAiB,EAC9Ch3B,EAAKnB,OAAOovB,aAAa6I,EAAQ39B,EAAMy1B,IAAI16B,MAAOuO,MAEjDxG,MAAK,SAAST,GACdzE,eAAeC,YAAYsE,eAAeu6B,GACvBlkB,EAAMpW,eAAeC,EAAUC,EAAQo6B,EAAM71B,EAAKnG,UAG9E,MACA,IAAK,iBACDhE,EAAOG,iBAAiB,SAAS,SAASu/B,GACzBp8B,EAAM1B,IAAIvD,MACvBuO,KAAO,GACPA,KAAK0pB,UAAW,EAChBnsB,EAAKnB,OAAOyX,cAAcnd,EAAM1B,IAAK2E,KAAK6nB,MAAM9qB,EAAMu9B,OAAOxiC,OAAQuO,MACpExG,MAAK,SAAST,GACX,IAAIE,EAAWq7B,WAAW3wB,WACVuL,EAAMpW,eAAeC,EAAUC,EAAQC,EAAUsE,EAAKnG,UAGlF,MACA,IAAK,eACHhE,EAAOG,iBAAiB,SAAS,WAC7B,IAAImhC,EAAQh+B,EAAM1B,IAAIvD,MAClBuO,EAAO,CACXA,oBAA4B,kBAC5BA,EAAK,qBAAuBtJ,EAAM3E,IAAIN,MACtC8L,EAAKnB,OAAOqX,YAAYihB,EAAO10B,GAC9BxG,MAAK,SAAST,GACZzE,eAAeC,YAAYsE,eAAeu6B,GACvBlkB,EAAMpW,eAAeC,EAAUC,EAAQo6B,EAAM71B,EAAKnG,UAG9E,MACA,IAAK,iBACHhE,EAAOG,iBAAiB,SAAS,WAC7B,IAAImhC,EAAQh+B,EAAM1B,IAAIvD,MAClBuO,EAAO,GACXA,EAAKjO,IAAM2E,EAAM3E,IAAIN,MACrB8L,EAAKnB,OAAO2X,eAAe2gB,EAAO10B,GACjCxG,MAAK,SAAST,GACdzE,eAAeC,YAAYsE,eAAeu6B,GACvBlkB,EAAMpW,eAAeC,EAAUC,EAAQo6B,EAAM71B,EAAKnG,UAG5E,MACA,IAAK,iBACHhE,EAAOG,iBAAiB,SAAS,WAC7B,IAAImhC,EAAQh+B,EAAM1B,IAAIvD,MAClBmjC,EAAUl+B,EAAMy1B,IAAI16B,MACxBuO,KAAO,GACPA,KAAK,qBAAuB,SAC5BA,KAAK,qBAAuBtJ,EAAM3E,IAAIN,MACtC8L,EAAKnB,OAAO6X,eAAeygB,EAAO/6B,KAAK6nB,MAAMoT,GAAU50B,MACtDxG,MAAK,SAAST,GACbzE,eAAeC,YAAYsE,eAAeu6B,GACvBlkB,EAAMpW,eAAeC,EAAUC,EAAQo6B,EAAM71B,EAAKnG,UAG7E,MACA,IAAK,iBACHhE,EAAOG,iBAAiB,SAAS,WAC/B,IAAImhC,EAAQh+B,EAAM1B,IAAIvD,MAClBmjC,EAAUl+B,EAAMy1B,IAAI16B,MAExBuO,KAAO,GACPA,KAAK,qBAAuB,SAC5BA,KAAK,qBAAuBtJ,EAAM3E,IAAIN,MACtC8L,EAAKnB,OAAOiY,eAAeqgB,EAAO/6B,KAAK6nB,MAAMoT,GAAU50B,MACtDxG,MAAK,SAAST,GACdzE,eAAeC,YAAYsE,eAAeu6B,GACvBlkB,EAAMpW,eAAeC,EAAUC,EAAQo6B,EAAM71B,EAAKnG,UAG1E,MACA,IAAK,SACDhE,EAAOG,iBAAiB,SAAS,WAC7B,IAAIyM,EAAO,GACXA,EAAKjO,IAAM2E,EAAM3E,IAAIN,MACrB,IAAI06B,EAAMxyB,KAAK6nB,MAAM9qB,EAAMy1B,IAAI16B,OAC/B8L,EAAKnB,OAAOoB,OAAO9G,EAAM1B,IAAIvD,MAAO06B,EAAKnsB,GACxCxG,MAAK,SAAST,GACdzE,eAAeC,YAAYsE,eAAeu6B,GACvBlkB,EAAMpW,eAAeC,EAAUC,EAAQo6B,EAAM71B,EAAKnG,UAG9E,MACA,IAAK,SACDhE,EAAOG,iBAAiB,SAAS,WAC/B,IAAIyM,EAAO,GACXA,EAAKjO,IAAM2E,EAAM3E,IAAIN,MACrB,IAAI06B,EAAMxyB,KAAK6nB,MAAM9qB,EAAMy1B,IAAI16B,OAC/B8L,EAAKnB,OAAO00B,OAAOp6B,EAAM1B,IAAIvD,MAAO06B,EAAKnsB,GACxCxG,MAAK,SAAST,GACdzE,eAAeC,YAAYsE,eAAeu6B,GACvBlkB,EAAMpW,eAAeC,EAAUC,EAAQo6B,EAAM71B,EAAKnG,UAG5E,MACA,QACI8K,QAAQC,IAAI,8BAGpB,IAAIhJ,EAAKlG,SAASC,cAAc,MAChC4/B,EAAKz/B,YAAY8F,GACbA,EAAKlG,SAASC,cAAc,MAEhC,OADA4/B,EAAKz/B,YAAY8F,GACV25B,GAIXlJ,EAAYx3B,UAAUugC,aAAe,SAAS35B,GAC1C,IAAI+d,EAAM9jB,SAASC,cAAc,OAE7B6hC,EAAK9hC,SAASC,cAAc,UAChC6hC,EAAG1hC,YAAYJ,SAASK,eAAe,gCACvCyhC,EAAG5hC,aAAa,QAAS,wBACzB6hC,GAAK/hC,SAASC,cAAc,KAC5B8hC,GAAG7hC,aAAa,QAAS,8CACzB4hC,EAAG1hC,YAAY2hC,IACfje,EAAI1jB,YAAY0hC,GAChB,IAAI57B,EAAKlG,SAASC,cAAc,MAChC6jB,EAAI1jB,YAAY8F,GAChB,IAAI+K,EAAKjR,SAASC,cAAc,OAChCgR,EAAG/Q,aAAa,QAAS,wCACzB,IAAI8hC,EAAM/lB,EAAM/U,qBAAqBnB,GACjC3B,EAAMpE,SAASK,eAAe2hC,EAAI56B,MAClCR,EAAM5G,SAASC,cAAc,OACjC2G,EAAI1G,aAAa,QAAS,8BAC1B0G,EAAIxG,YAAYgE,GACZA,EAAOpE,SAASK,eAAe2hC,EAAI36B,OACvCT,EAAIxG,YAAYgE,GACZ8B,EAAKlG,SAASC,cAAc,MAChC2G,EAAIxG,YAAY8F,GACZA,EAAKlG,SAASC,cAAc,MAChC2G,EAAIxG,YAAY8F,GACZ9B,EAAMpE,SAASK,eAAe2hC,EAAI16B,QACtCV,EAAIxG,YAAYgE,GAChB6M,EAAG7Q,YAAYwG,GACfkd,EAAI1jB,YAAY6Q,GACZ/K,EAAKlG,SAASC,cAAc,MAKhC,OAJA6jB,EAAI1jB,YAAY8F,GAChB47B,EAAGxhC,iBAAiB,SAAS,WACzB2b,EAAMhX,eAAe88B,GAAI9wB,MAEtB6S,GAUXxmB,EAAOD,QAAQs5B,G,cC5iCf,SAAS7yB,EAAWnB,EAAMkF,EAAQilB,GAChCvsB,KAAK0hC,QAAUt/B,EACfpC,KAAK7B,KAAOmJ,EACZtH,KAAK2hC,SAAWpV,EAAOoV,SACpB3hC,KAAK4hC,YAAYt6B,KAAStH,KAAK7B,KAAO,cAO3CoF,EAAW3E,UAAUoG,iBAAmB,SAAS7G,GAO7C,IAAI4gB,EAAS9Q,WAAW4zB,aAAa7hC,KAAK0hC,QAAS,CAC/CvjC,KAAsB6B,KAAK7B,KAC3B2jC,gBAAsB,EACtBC,aAAsB,EACtBC,iBAAsB,EACtBC,cAAsB,EACtBC,aAAsB,EACtBC,gBAAsB,EACtBC,kBAAsB,EACtBC,mBAAsB,EACtBC,cAAsB,CAACC,aAAa,GACpCC,UAAsB,CAAC,SAAU,OAAQ,IAAO,gBAChDC,SAAsB,IAQ1B,OALAziC,KAAK0iC,kBAAkB3jB,EAAQ5gB,GAC/B4gB,EAAO4jB,iBAAiB,QACrB3iC,KAAK2hC,SAAU5iB,EAAO6jB,UAAU,QAAS,eACvC7jB,EAAO6jB,UAAU,QAAS,OAExB7jB,GAOXxb,EAAW3E,UAAU8jC,kBAAoB,SAAS3jB,EAAQ5gB,GACxD,OAAOA,GACL,IAAK,QACH4gB,EAAO8jB,QAAQ,MAAO,OACxB,MACA,IAAK,SACH9jB,EAAO8jB,QAAQ,OAAQ,QACzB,MACA,IAAK,WACJ9jB,EAAO8jB,QAAQ,MAAO,OACvB,MACA,IAAK,UACD9jB,EAAO8jB,QAAQ,MAAO,SAM9Bt/B,EAAW3E,UAAUqG,eAAiB,SAAS8Z,GAC7CA,EAAO6M,OACPkX,YAAW,WACP/jB,EAAO0jB,YACT,GAEF1jB,EAAOkF,GAAG,UAAU,WAClBlF,EAAO6M,WAUXroB,EAAW3E,UAAUqF,YAAc,WAEjC,GADAgK,WAAW80B,QAAQ/iC,KAAK0hC,QAAQsB,UAAWhjC,KAAK7B,KAAM6B,KAAK0hC,SACxD1hC,KAAK2hC,SACJ,IAAIsB,EAAQ,wBACPA,EAAQ,WAEjB,OADAjjC,KAAK0hC,QAAQ/hC,aAAa,QAAS,8BAAgCsjC,EAAQ,gDACpEjjC,KAAK0hC,SAGdn+B,EAAW3E,UAAUgjC,YAAc,SAASt6B,GAC1C,GAAa,UAAVA,EAAoB,OAAO,GAGhCvK,EAAOD,QAAQyG,G,qPClFMtE,EAAQ,GAA7B,IACMikC,EAAgBjkC,EAAQ,IACxBsS,EAAetS,EAAQ,GACvBkkC,EAAiBlkC,EAAQ,IAEzBC,GADiBD,EAAQ,IACPA,EAAQ,IAEhC,SAASmkC,EAAiBlhC,EAAM+T,EAAQvV,GACvCV,KAAKqjC,UAAYnhC,EACjBlC,KAAKiW,OAASA,EACdjW,KAAKsjC,OAAStjC,KAAKiW,OAAOstB,SAASC,sBAAsBxjC,KAAKqjC,WAC9DrjC,KAAKyjC,gBAAiB,EACtBzjC,KAAK0jC,SAAU,EACf1jC,KAAK8Y,OAAS,GACd9Y,KAAKma,cAAgB,WACrBna,KAAKU,QAAUV,KAAK62B,WAAWn2B,GAugBhC,SAAS+gB,EAAeze,EAAKiT,EAAQvV,GACpCV,KAAKujC,SAAWvgC,EAChBhD,KAAKiW,OAASA,EACdjW,KAAKwV,WAAa,GAClBxV,KAAK2jC,oBAAqB,EAC1B3jC,KAAK4jC,cAAgB,GACrB5jC,KAAKma,cAAgB,SACrBna,KAAKU,QAAUV,KAAK62B,WAAWn2B,GA3gBhC0iC,EAAiBxkC,UAAUi4B,WAAa,SAASn2B,GAChD,OAAOmjC,kBAAkB9wB,aAAa+wB,iBAAiBpjC,EAASV,OAGjEojC,EAAiBxkC,UAAUmlC,mBAAqB,WAC/C,IAAIv3B,EAAO,GAGX,OAFGxM,KAAKU,QAAQ8V,WAAWhK,EAAKgK,SAAWxW,KAAKU,QAAQ8V,UACrDxW,KAAKU,QAAQ+V,WAAWjK,EAAKiK,SAAWzW,KAAKU,QAAQ+V,UACjDzW,KAAKU,SAGb0iC,EAAiBxkC,UAAUolC,mBAAqB,SAASC,EAAIxsB,GAC5D,OAAOzX,KAAK+jC,sBAGbX,EAAiBxkC,UAAUslC,oBAAsB,SAASX,GACzD,OAAOvjC,KAAK+jC,sBAIbX,EAAiBxkC,UAAU2iB,OAAS,SAASnN,GAE3C,GADApU,KAAKmkC,sBACFnkC,KAAKsjC,QAAUtjC,KAAKsjC,OAAO3kC,SAAS,CACtCqB,KAAKoU,OAAUA,GAAkBpU,KAAKokC,uBACtC,IAAI,IAAIpnC,EAAI,EAAGA,EAAEgD,KAAK8Y,OAAO1Y,OAAQpD,IAAI,CACxC,IAAIwzB,EAAcxwB,KAAK8Y,OAAO9b,GAAGukB,SAC9BiP,GAAexwB,KAAKioB,YAAY,SAASjoB,KAAKoU,OAAOmc,iBAAiBC,GAE1E,OAAOxwB,KAAKoU,OAAOmN,WAOtB6hB,EAAiBxkC,UAAUulC,oBAAsB,WAC/C,IAAIE,GAAkC,IAAxBrkC,KAAKyjC,eAEnB,GADAzjC,KAAKsjC,OAAStjC,KAAKiW,OAAOstB,SAASC,sBAAsBxjC,KAAKqjC,YAC1DrjC,KAAKsjC,OAER,OADA50B,QAAQoR,MAAM,gBAAkB9f,KAAKrB,WAAa,QAAUqB,KAAKoX,YAC1D,EAER,GAAGpX,KAAKsjC,QAAUtjC,KAAKsjC,OAAOgB,SAAS,CACtC,IAAItjB,EAAahhB,KAAKukC,wBACE,GAArBvjB,EAAW5gB,QACbkU,MAAMtU,KAAKqjC,WAGZ,IADA,IAAIruB,EAAO,GACHhY,EAAIgD,KAAK8Y,OAAO1Y,OAAQpD,EAAEgkB,EAAW5gB,OAAQpD,IAAI,CACxD,IAAIwnC,EAAK,IAAItB,EAAcliB,EAAWhkB,GAAIA,EAAGgD,KAAMA,KAAKgkC,mBAAmBhjB,EAAWhkB,GAAIA,IAC1FgD,KAAK8Y,OAAO7N,KAAKu5B,GACjBxvB,EAAK/J,KAAKu5B,EAAGvmC,SAEXomC,IAAQrkC,KAAKyjC,eAAiBzuB,OAE7B,CACDqvB,IAAQrkC,KAAKyjC,eAAiB,IACjC,IAAIgB,EAAOzkC,KAAK0kC,sBAChB,GAAGD,GAAQA,EAAKrkC,OACf,IAAQpD,EAAIgD,KAAK8Y,OAAO1Y,OAAQpD,EAAEynC,EAAKrkC,OAAQpD,IAAI,CAClD,IAAI2nC,EAAO,IAAIljB,EAAegjB,EAAKznC,GAAIgD,KAAMA,KAAKkkC,oBAAoBO,EAAKznC,KACxEqnC,GAAQrkC,KAAKyjC,eAAex4B,KAAK05B,EAAKvtB,WACzCpX,KAAK8Y,OAAO7N,KAAK05B,MAStBvB,EAAiBxkC,UAAU2lC,sBAAwB,SAAS7jC,GAE1D,OADcV,KAAKiW,OAAOstB,SAASthB,cAAcjiB,KAAKrB,aAOxDykC,EAAiBxkC,UAAU8lC,oBAAsB,SAAShkC,GACxD,GAAGI,eAAeC,YAAY6jC,qBAAqB5kC,KAAKO,KAAM,YAC7D,IAAIskC,EAAU7kC,KAAKiW,OAAOstB,SAASuB,YAAY9kC,KAAKrB,iBAGhDkmC,EAAU,GAEf,OAAOA,GAGTzB,EAAiBxkC,UAAUmS,OAAS,WAClC/Q,KAAKoU,OAAOqT,QACZznB,KAAKuhB,OAAOvhB,KAAKoU,OAAQ,MAI3BgvB,EAAiBxkC,UAAU+hB,QAAU,WAEnC,IADA,IAAIokB,EAAW,GACP/nC,EAAI,EAAGA,EAAEgD,KAAK8Y,OAAO1Y,OAAQpD,IAAI,CACxC,IAAIqtB,EAAMrqB,KAAK8Y,OAAO9b,GAAG2jB,UACd,KAAR0J,IAAsB,IAARA,QAA+B,IAAPA,GAAoB0a,EAAS95B,KAAKof,GAE5E,OAAGrqB,KAAKsjC,OAAOgB,SACPS,GAiBV3B,EAAiBxkC,UAAU4sB,cAAgB,WAAW,OAAOxrB,KAAK0W,YAClE0sB,EAAiBxkC,UAAUD,SAAW,WAAW,OAAOqB,KAAKqjC,WAC7DD,EAAiBxkC,UAAUwY,QAAU,WAAW,QAAQpX,KAAKiW,QAASjW,KAAKiW,OAAOmB,WAClFgsB,EAAiBxkC,UAAU4Y,MAAQ,WAAW,QAAQxX,KAAKiW,QAASjW,KAAKiW,OAAOuB,SAChF4rB,EAAiBxkC,UAAUyY,aAAe,WAAW,QAAQrX,KAAKiW,QAASjW,KAAKiW,OAAOoB,gBACvF+rB,EAAiBxkC,UAAUomC,QAAU,WAAY,QAAQhlC,KAAKiW,QAASjW,KAAKiW,OAAOgvB,gBACnF7B,EAAiBxkC,UAAU0Y,MAAQ,WAAY,OAAQtX,KAAKsjC,OAAStjC,KAAKsjC,OAAOhsB,MAAQ,IACzF8rB,EAAiBxkC,UAAU6a,SAAW,WAAY,OAAQzZ,KAAKsjC,OAAStjC,KAAKsjC,OAAO7pB,WAAa,IACjG2pB,EAAiBxkC,UAAU6yB,WAAa,WAAY,QAAQzxB,KAAKsjC,QAAStjC,KAAKsjC,OAAO7R,cACtF2R,EAAiBxkC,UAAU+0B,KAAO,SAASF,GAAO,QAAQzzB,KAAKiW,QAASjW,KAAKiW,OAAO0d,KAAKF,IACzF2P,EAAiBxkC,UAAU0yB,0BAA4B,WAAW,QAAQtxB,KAAKsjC,QAAStjC,KAAKsjC,OAAO4B,kBACpG9B,EAAiBxkC,UAAU+yB,eAAiB,WAAW,QAAQ3xB,KAAKsjC,QAAStjC,KAAKsjC,OAAO5R,aACzF0R,EAAiBxkC,UAAU6rB,cAAgB,WAAY,QAAQzqB,KAAKsjC,QAAStjC,KAAKsjC,OAAO7Y,iBACzF2Y,EAAiBxkC,UAAUwrB,aAAe,WAAY,OAAOpqB,KAAKoW,OAClEgtB,EAAiBxkC,UAAUgtB,KAAO,WAAY,QAAQ5rB,KAAKiW,QAASjW,KAAKiW,OAAO2V,QAEhFwX,EAAiBxkC,UAAU2C,OAAS,WACnCvB,KAAKsrB,QACLtrB,KAAKoB,QAAQ,SAGdgiC,EAAiBxkC,UAAU+rB,yBAA2B,WACrD,GAAG3qB,KAAKsjC,OAAO,CACd,IAAI6B,EAAKnlC,KAAKsjC,OAAO8B,kBACrB,GAAGplC,KAAKiW,OAAO,CAEd,IADA,IAAIgF,EAAU,GACNje,EAAI,EAAGA,EAAImoC,EAAG/kC,OAAQpD,IAAI,CACjC,IAAIqoC,EAAUrlC,KAAKiW,OAAOsJ,aAAa4lB,EAAGnoC,IAEtCwe,GADAA,IAAO6pB,GAAUnmC,EAAgBqc,4BAA4B,QAAS8pB,KACnDvkC,eAAeC,YAAYC,aAAamkC,EAAGnoC,IAClEie,EAAQhQ,KAAK,CAAChN,MAAOknC,EAAGnoC,GAAIqC,MAAOmc,IAEpC,OAAOP,EAER,OAAOkqB,EAGR,OAAO,GAIR/B,EAAiBxkC,UAAjB,OAAoC,WACnC,IAAIsD,EAAOlC,KAAKqjC,UACbnhC,IACFlC,KAAKsrB,QACLtrB,KAAKiW,OAAOqvB,eAAepjC,GAC3BlC,KAAKiW,OAAOlF,WAIdqyB,EAAiBxkC,UAAU4F,IAAM,SAASjE,GACzCP,KAAKiW,OAAOsvB,YAAYvlC,KAAKrB,WAAY4B,GACzCP,KAAKglC,UACFzkC,IACFP,KAAK8Y,OAAO9Y,KAAK8Y,OAAO1Y,OAAO,GAAGgB,QAAQb,GAC1CP,KAAK8Y,OAAO9Y,KAAK8Y,OAAO1Y,OAAO,GAAGolC,UAEnCxlC,KAAK+Q,UAGNqyB,EAAiBxkC,UAAU6zB,UAAY,SAAShb,GAC/CzX,KAAKoU,OAAOsT,KAAK1nB,KAAKoX,UAAWpX,KAAKrB,WAAY8Y,IAGnD2rB,EAAiBxkC,UAAU2zB,SAAW,SAAS5X,GAC9C3a,KAAKiW,OAAOwvB,iBAAiBzlC,KAAKrB,WAAYgc,GAC9C3a,KAAKglC,UACL,IAAIU,EAAO1lC,KAAK8Y,OAAO9Y,KAAK8Y,OAAO1Y,OAAO,GACvCslC,IACFA,EAAKF,SACLE,EAAKtkC,QAAQ,SAEdpB,KAAK+Q,SACF20B,GAAM1lC,KAAKoU,OAAOsT,KAAKge,EAAKtuB,YAGhCgsB,EAAiBxkC,UAAU0sB,MAAQ,WAElC,GADAtrB,KAAKiW,OAAOstB,SAASjY,MAAMtrB,KAAKqjC,WAC7BrjC,KAAKsjC,QAAUtjC,KAAKsjC,OAAOgB,SAAS,CACtC,IAAI,IAAItnC,EAAI,EAAGA,EAAEgD,KAAK8Y,OAAO1Y,OAAQpD,IACpCgD,KAAK8Y,OAAO9b,GAAGsuB,QAEhBtrB,KAAK8Y,OAAS,OAEV,CACJ,IAAI6sB,EAAQ,GACZ,IAAQ3oC,EAAI,EAAGA,EAAEgD,KAAKyjC,eAAerjC,OAAQpD,IAC5C,IAAI,IAAI6b,EAAI,EAAGA,EAAE7Y,KAAK8Y,OAAO1Y,OAAQyY,IACpC7Y,KAAK8Y,OAAOD,GAAGyS,QACZtrB,KAAK8Y,OAAOD,GAAGzB,WAAapX,KAAKyjC,eAAezmC,IAClD2oC,EAAM16B,KAAKjL,KAAK8Y,OAAOD,IAI1B7Y,KAAK8Y,OAAS6sB,EAEf3lC,KAAK+Q,SACL/Q,KAAKiW,OAAOgvB,gBAGb7B,EAAiBxkC,UAAUgnC,oBAAsB,SAAS3nC,EAAOwZ,GAChEzX,KAAKiW,OAAOstB,SAASsC,oBAAoB7lC,KAAKrB,WAAYV,EAAOwZ,GAEjE,IADA,IAAIkuB,EAAQ,GACJ3oC,EAAI,EAAGA,EAAEgD,KAAK8Y,OAAO1Y,OAAQpD,SACjB,IAATya,EACNzX,KAAK8Y,OAAO9b,GAAGoa,WAAanZ,EAC9B+B,KAAK8Y,OAAO9b,GAAGsuB,QAGfqa,EAAM16B,KAAKjL,KAAK8Y,OAAO9b,IAGjBA,GAAKya,GACZzX,KAAK8Y,OAAO9b,GAAGya,MAAQkuB,EAAMvlC,OAC7BulC,EAAM16B,KAAKjL,KAAK8Y,OAAO9b,KAGvBgD,KAAK8Y,OAAO9b,GAAGsuB,QAGjBtrB,KAAK8Y,OAAS6sB,EACd3lC,KAAKiW,OAAOgvB,eACZjlC,KAAKiW,OAAOlF,UAGbqyB,EAAiBxkC,UAAUknC,iBAAmB,SAAS7nC,GAEtD,OADA+B,KAAKglC,UACEhlC,KAAKiW,OAAOstB,SAASuC,iBAAiB9lC,KAAKrB,WAAYV,IAM/DmlC,EAAiBxkC,UAAUqsB,kBAAoB,SAASzlB,GACvD,GAAGxF,KAAKsjC,OAAO4B,iBAAiB,CAC/B,IAAIa,EAAO/lC,KAAKsjC,OAAO5R,YACnBsU,EAAahmC,KAAK8Y,OAAO1Y,OAC7B,IAAa,OAAVoF,GAA6B,SAAVA,IAClBugC,EAAKlU,KAAOmU,GAAcD,EAAKlU,IACjC,OAAO,EAGT,GAAa,UAAVrsB,GAAuBugC,EAAKnU,IAC9B,OAAO,EAGT,OAAO,GAGRwR,EAAiBxkC,UAAU0C,MAAQ,WAClC,QAAGtB,KAAKimC,cAGDjmC,KAAKiW,OAAO3U,SAGpB8hC,EAAiBxkC,UAAU4mC,OAAS,WACnCxlC,KAAKimC,cAAe,GAIrB7C,EAAiBxkC,UAAUma,UAAY,WACtC,GAAG/Y,KAAK8Y,OAAO1Y,QAAUJ,KAAKyjC,eAAerjC,OAAQ,OAAO,EAC5D,IAAI,IAAIpD,EAAI,EAAIA,EAAIgD,KAAK8Y,OAAO1Y,OAAQpD,IACvC,GAAGgD,KAAKsjC,QAAUtjC,KAAKsjC,OAAOgB,UAC7B,GAAGtkC,KAAK8Y,OAAO9b,GAAGiB,SAAW+B,KAAKyjC,eAAezmC,GAChD,OAAO,MAGJ,CACJ,GAAGgD,KAAK8Y,OAAO9b,GAAGoa,WAAapX,KAAKyjC,eAAezmC,GAClD,OAAO,EAER,GAAGgD,KAAK8Y,OAAO9b,GAAG+b,YACjB,OAAO,EAIV,OAAO,GAGRqqB,EAAiBxkC,UAAUqmC,aAAe,WACzCjlC,KAAKoU,OAAO+S,eACTnnB,KAAKiW,QAAQjW,KAAKiW,OAAOgvB,gBAO7B7B,EAAiBxkC,UAAUwC,QAAU,SAASjD,GAC7C6B,KAAK7B,KAAOA,EACZ,IAAI,IAAInB,EAAI,EAAGA,EAAEgD,KAAK8Y,OAAO1Y,OAAQpD,IACpCgD,KAAK8Y,OAAO9b,GAAGoE,QAAQjD,GAExB6B,KAAK+Q,UAMNqyB,EAAiBxkC,UAAU4zB,kBAAoB,WAC9C,IAAIxI,EAAY,GAChB,GAAGhqB,KAAKsjC,QAAUtjC,KAAKsjC,OAAOgB,SAC9B,IAAI,IAAItnC,EAAI,EAAGA,EAAEgD,KAAK8Y,OAAO1Y,OAAQpD,IAAI,CACxC,IACIwe,EADMxb,KAAK8Y,OAAO9b,GAAGisB,aACZ,KACbe,EAAU/e,KAAK,CAAC5L,MAAOmc,EAAKvd,MAAOjB,IAEpC,OAAOgtB,GAGRoZ,EAAiBxkC,UAAUsnC,qBAAuB,WACjD,OAAOlmC,KAAKmmC,wBAGb/C,EAAiBxkC,UAAU0rB,SAAW,SAASlU,EAAOgwB,GAErD,GADApmC,KAAKoW,MAAQA,GACTgwB,EACH,IAAI,IAAIppC,EAAI,EAAGA,EAAEgD,KAAK8Y,OAAO1Y,OAAQpD,IACpCgD,KAAK8Y,OAAO9b,GAAGqpC,kBAAkBjwB,GAGnCpW,KAAK+Q,UAGNqyB,EAAiBxkC,UAAUynC,kBAAoB,SAASjwB,GAC3C,QAATA,GACiB,QAAdpW,KAAKoW,OAAiC,aAAdpW,KAAKoW,OACjCpW,KAAKsqB,SAAS,aAGJ,QAATlU,GACFpW,KAAKsqB,SAAS,UAOhB8Y,EAAiBxkC,UAAUuX,iBAAmB,WAiC7C,MAhCW,CACVmwB,KAAM,CACLjnC,MAAO,YAAapB,MAAO,OAC3BuY,SAAU,CAAC,QAAS,QAAS,UAAW,KAAM,UAAW,OAAQ,cAAe,OAAQ,SAAU,QAAS,OAAQ,UACnHC,SAAU,CAAC,SAAU,QAAS,MAAO,QAAS,SAAU,SAAU,OAAQ,OAAQ,SAEnF8vB,UAAW,CACVlnC,MAAO,iBAAkBpB,MAAO,YAChCuY,SAAU,CAAC,QAAS,QAAS,UAAW,KAAM,UAAW,OAAQ,cAAe,OAAQ,SAAU,QAAS,OAAQ,UACnHC,SAAU,CAAC,SAAU,QAAS,MAAO,QAAS,SAAU,SAAU,OAAQ,OAAQ,SAEnFyW,KAAM,CACL7tB,MAAO,cAAepB,MAAO,OAC7BuY,SAAU,CAAC,QAAS,QAAS,UAAW,KAAM,UAAW,OAAQ,cAAe,OAAQ,SAAU,QAAS,UAC3GC,SAAU,CAAC,SAAU,QAAS,MAAO,QAAS,SAAU,SAAU,OAAQ,OAAQ,SAEnF+vB,QAAS,CACRnnC,MAAO,UAAWpB,MAAO,UACzBuY,SAAU,CAAC,QAAS,QAAS,QAAS,OAAQ,cAAe,OAAQ,SAAU,QAAS,UACxFC,SAAU,IAEXpX,MAAO,CACNA,MAAO,QAASpB,MAAO,QACvBuY,SAAU,CAAC,QAAS,SAAU,QAAS,WACvCC,SAAU,IAEXhW,KAAM,CACLpB,MAAO,UAAWpB,MAAO,OACzBuY,SAAU,CAAC,QAAS,WACpBC,SAAU,MAMb2sB,EAAiBxkC,UAAUqrB,mBAAqB,WAC/C,OAAOvsB,OAAOob,OAAO9Y,KAAKkW,SAW3BktB,EAAiBxkC,UAAU+nB,sBAAwB,SAASvQ,GAC3D,MAA0B,QAAvBpW,KAAKoqB,gBAA4BpqB,KAAKymC,eACjC,OAEkB,QAAvBzmC,KAAKoqB,gBAAmD,aAAvBpqB,KAAKoqB,gBAAwD,WAAvBpqB,KAAKoqB,eACvE,OAED,SAIRgZ,EAAiBxkC,UAAU0X,gBAAkB,WAC5C,OAAGtW,KAAKsjC,QAAUtjC,KAAKsjC,OAAOoD,WACtB,OAED,aAORtD,EAAiBxkC,UAAU8sB,KAAO,WACjC1rB,KAAK2mC,QAAQ,WAGdvD,EAAiBxkC,UAAU+sB,KAAO,WACjC3rB,KAAK2mC,QAAQ,SAGdvD,EAAiBxkC,UAAU+nC,QAAU,SAASpmC,GAC7CP,KAAKO,KAAOA,EACZP,KAAK+Q,UAGNqyB,EAAiBxkC,UAAU2sB,oBAAsB,WAChD,MAAgB,QAAbvrB,KAAK7B,KACA0lC,kBAAkB9wB,aAAayB,4BAA4BxU,MAE5D6jC,kBAAkB9wB,aAAa6B,4BAA4B5U,OAGnEojC,EAAiBxkC,UAAUgoC,WAAa,WACvC5mC,KAAKoU,OAAO/P,UAGb++B,EAAiBxkC,UAAU6nC,aAAe,WAEzC,GAA0B,QAAvBzmC,KAAKoqB,gBAAmD,SAAvBpqB,KAAKoqB,eAA2B,OAAO,EAC3E,IAAI,IAAIptB,EAAI,EAAGA,EAAEgD,KAAK8Y,OAAO1Y,OAAQpD,IACpC,GAA2B,QAAxBgD,KAAK8Y,OAAO9b,GAAGoZ,MACjB,OAAO,EAGT,OAAO,GAGRgtB,EAAiBxkC,UAAUwlC,qBAAuB,SAASyC,GAC1D,OAAG7mC,KAAK7B,KACA,IAAIglC,EAAeztB,mBAAmB1V,OAK/CojC,EAAiBxkC,UAAUoxB,wBAA0B,WACpD,OAAO,IAAImT,EAAelT,0BAG3BmT,EAAiBxkC,UAAUqqB,WAAa,WACvC,IAAIvR,EAAS,KACV1X,KAAKsB,QAASoW,EAAS,MAClB1X,KAAK+Y,cAAarB,EAAS,WACnC,IAAIovB,EAAM,CACTpvB,OAAQA,EACRqvB,SAAU/mC,KAAK8Y,OAAO1Y,QAEvB0mC,EAAG,KAA0B,GAAhBA,EAAIC,SAAiB,IAAMD,EAAIC,SAAW,KAAO,GAC9D,IAAI,IAAI/pC,EAAI,EAAGA,EAAEgD,KAAK8Y,OAAO1Y,OAAQpD,IACpCgqC,KAAOhnC,KAAK8Y,OAAO9b,GAAGisB,aACtB6d,EAAG,MAASE,KAAI,KACbhqC,EAAIgD,KAAK8Y,OAAO1Y,OAAO,IAAG0mC,EAAG,MAAS,MAE1C,OAAOA,GAGR1D,EAAiBxkC,UAAUqoC,oBAAsB,SAAS7wB,GACzD,OAAOpW,KAAKkW,OAAOE,GAAOI,SAAS/C,OAAOzT,KAAKkW,OAAOE,GAAOK,WAG9D2sB,EAAiBxkC,UAAUqpB,YAAc,SAAShnB,GACjD,IAAoC,GAAjCjB,KAAKwW,SAASxJ,QAAQ/L,KAAiD,GAAjCjB,KAAKyW,SAASzJ,QAAQ/L,GAC9D,OAAO,EAGR,IAAmC,GADhB,CAAC,SAAU,QAAS,OACvB+L,QAAQ/L,KACnBjB,KAAKirB,kBAAkBhqB,GAAQ,OAAO,EAG3C,QAAGjB,KAAKkmC,yBAAyD,GAD/C,CAAC,SAAU,SACiBl5B,QAAQ/L,KACjDjB,KAAK+Y,gBAIE,QAAT9X,GAAgC,UAAbjB,KAAKO,SACf,QAATU,GAAgC,UAAbjB,KAAKO,QAEK,GADrBP,KAAKinC,oBAAoBjnC,KAAKoW,OAC5BpJ,QAAQ/L,MAetBwgB,EAAe7iB,UAAUi4B,WAAa,SAASn2B,GAC9C,OAAOmjC,kBAAkB9wB,aAAa+wB,iBAAiBpjC,EAASV,OAGjEyhB,EAAe7iB,UAAUsoC,sBAAwB,SAAShlC,GACzD,OAAOlC,KAAKU,SAGb+gB,EAAe7iB,UAAU2iB,OAAS,SAASnN,GAG1C,IAAI,IAAIlS,KAFRlC,KAAKmnC,yBACLnnC,KAAKoU,OAAUA,GAAiBpU,KAAKonC,qBACrBpnC,KAAKwV,WAAW,CAC/B,IAAIgS,EAAexnB,KAAKwV,WAAWtT,GAAMqf,SACtCiG,GAAgBxnB,KAAKioB,YAAY,SAASjoB,KAAKoU,OAAOmT,oBAAoBrlB,EAAMslB,GAEpF,OAAOxnB,KAAKoU,OAAOmN,OAAOvhB,KAAKO,OAGhCkhB,EAAe7iB,UAAUuoC,uBAAyB,WACjD,IAAIE,EAAQrnC,KAAKsnC,yBACc,IAA5BtnC,KAAK2jC,qBAA8B3jC,KAAK2jC,mBAAqB0D,GAEhE,IADA,IAAIE,EAAU,GACN1uB,EAAI,EAAGA,EAAEwuB,EAAMjnC,OAAQyY,SACS,IAA7B7Y,KAAKwV,WAAW6xB,EAAMxuB,IAC/B0uB,EAAQF,EAAMxuB,IAAM,IAAIuqB,EAAiBiE,EAAMxuB,GAAI7Y,KAAMA,KAAKknC,sBAAsBG,EAAMxuB,KAG1F0uB,EAAQF,EAAMxuB,IAAM7Y,KAAKwV,WAAW6xB,EAAMxuB,KAEC,GAAzC7Y,KAAK4jC,cAAc52B,QAAQq6B,EAAMxuB,MACnC0uB,EAAQF,EAAMxuB,IAAI2sB,SAClB+B,EAAQF,EAAMxuB,IAAI1a,KAAO,QAG3B6B,KAAKwV,WAAa+xB,GAGnB9lB,EAAe7iB,UAAUwY,QAAU,WAClC,QAAGpX,KAAKujC,UAAiBvjC,KAAKujC,SAASxiB,QAIxCU,EAAe7iB,UAAUyY,aAAe,WACvC,QAAGrX,KAAKujC,UAAiBvjC,KAAKujC,SAAS5oB,KAIxC8G,EAAe7iB,UAAU2sB,oBAAsB,WAK9C,MAAO,CAAC,OAAQ,SAGjB9J,EAAe7iB,UAAU4Y,MAAQ,WAChC,OAAGxX,KAAKiW,OAAgBjW,KAAKiW,OAAOuB,QAAU,EACvC,GAIRiK,EAAe7iB,UAAUD,SAAW,WACnC,QAAGqB,KAAKiW,QAAejW,KAAKiW,OAAOtX,YAIpC8iB,EAAe7iB,UAAU4oC,aAAe,WACvC,SAAGxnC,KAAKiW,QAAUjW,KAAKiW,OAAOA,QAAUjW,KAAKiW,OAAOA,OAAOstB,WACnDvjC,KAAKiW,OAAOA,OAAOstB,UAK5B9hB,EAAe7iB,UAAU4b,KAAO,WAC/B,OAAGxa,KAAKiW,QAITwL,EAAe7iB,UAAU+0B,KAAO,SAASF,GAErCzzB,KAAK0hB,WACP1hB,KAAK0hB,WAAW9d,GAAG2a,aAAakV,GAEzBzzB,KAAKiW,QACZjW,KAAKiW,OAAO0d,KAAKF,IAInBhS,EAAe7iB,UAAU6oC,KAAO,SAASC,GAGxC,OADY,IAAIjmB,EADhBimB,EAAQA,GAAc1nC,KAAKujC,SACUvjC,KAAKiW,OAAQjW,KAAKU,UAIxD+gB,EAAe7iB,UAAUysB,MAAQ,WAChC,GAAGrrB,KAAKwa,OACPxa,KAAKujC,SAAWvjC,KAAKujC,SAASlY,MAAM,MACpCrrB,KAAKujC,SAASliB,QAAS,EACvBrhB,KAAKoB,QAAQ,YAET,CACJ,IAAIsmC,EAAO1nC,KAAKujC,SAASlY,MAAMvqB,eAAeC,YAAY4mC,WACtDC,EAAY5nC,KAAKwnC,eACjBtlC,EAAOlC,KAAKrB,WAChB,GAAGipC,GAAa1lC,EAAK,MACkB,IAA5B0lC,EAAUrwB,SAASrV,KAC5B0lC,EAAUrwB,SAASrV,GAAQ,IAE5B0lC,EAAUrwB,SAASrV,GAAM+I,KAAKy8B,GAC9B,IAAIG,EAAU7nC,KAAKynC,KAAKC,GACxB1nC,KAAKiW,OAAO6C,OAAO7N,KAAK48B,GAEzB7nC,KAAKiW,OAAOlF,WAId0Q,EAAe7iB,UAAU2C,OAAS,WACjCvB,KAAKsrB,QACLtrB,KAAKoB,QAAQ,SAGdqgB,EAAe7iB,UAAUgtB,KAAO,WAC/B,GAAG5rB,KAAK0hB,WACP,GAAG1hB,KAAKuqB,gBAAgB,CACvB,IAAIud,EAAW9nC,KAAK+nC,UACL,MAAZD,IAAkBA,EAAW,IAChC9nC,KAAK0hB,WAAWjB,eAAeqnB,QAG/B9nC,KAAK0hB,WAAWb,sBAGV7gB,KAAKiW,QACZjW,KAAKiW,OAAO2V,QAIdnK,EAAe7iB,UAAf,OAAkC,WACjC,IAAIopC,EAAOhoC,KAAKoX,UACbpX,KAAK0hB,YAAc1hB,KAAKwa,QACtBxa,KAAKuqB,iBACRvqB,KAAK0hB,WAAWnB,eAAeynB,GAEhChoC,KAAK4mC,cAGF5mC,KAAKiW,SACPjW,KAAKiW,OAAO2vB,oBAAoBoC,GAChChoC,KAAKiW,OAAOlF,WAKf0Q,EAAe7iB,UAAU0sB,MAAQ,WAChCtrB,KAAKujC,SAASjY,QAEd,IADA,IAAI2c,EAAS,GACLjrC,EAAI,EAAGA,EAAEgD,KAAK2jC,mBAAmBvjC,OAAQpD,IAAI,CACpD,IAAIkF,EAAOlC,KAAK2jC,mBAAmB3mC,GACA,UAAhC,EAAOgD,KAAKwV,WAAWtT,MACzBlC,KAAKwV,WAAWtT,GAAMopB,QACtB2c,EAAO/lC,GAAQlC,KAAKwV,WAAWtT,IAGjClC,KAAKwV,WAAayyB,EAClBjoC,KAAK+Q,UAGN0Q,EAAe7iB,UAAU0mC,eAAiB,SAASpjC,GAClDlC,KAAKujC,SAAS2E,eAAehmC,UACtBlC,KAAKwV,WAAWtT,GACvBlC,KAAKglC,WAGNvjB,EAAe7iB,UAAU2mC,YAAc,SAASrjC,GAC/ClC,KAAKujC,SAASgC,YAAYrjC,GAC1BlC,KAAKglC,UACLhlC,KAAK+Q,UAGN0Q,EAAe7iB,UAAUssB,eAAiB,SAAShpB,GAClDlC,KAAKujC,SAASgC,YAAYrjC,GAC1BlC,KAAKglC,UACLhlC,KAAK4jC,cAAc34B,KAAK/I,GACxBlC,KAAK+Q,SACL/Q,KAAKorB,aAAalpB,IAGnBuf,EAAe7iB,UAAU6mC,iBAAmB,SAASvjC,EAAMyY,GAC1D3a,KAAKujC,SAASgC,YAAYrjC,EAAMyY,GAChC3a,KAAKglC,WAGNvjB,EAAe7iB,UAAUisB,YAAc,SAASlQ,GAC5C3a,KAAKiW,SACPjW,KAAKiW,OAAOsc,SAAS5X,GACrB3a,KAAKiW,OAAO2vB,oBAAoB5lC,KAAKoX,aAIvCqK,EAAe7iB,UAAU2gB,aAAe,SAAS5E,GAChD,IAAIwtB,EAAMnoC,KAAKooC,gBACf,SAAGD,GAAOA,EAAIhpB,WAAagpB,EAAIhpB,UAAUxE,KACjCwtB,EAAIhpB,UAAUxE,IAKvB8G,EAAe7iB,UAAUwpC,cAAgB,WACxC,OAAGpoC,KAAK0hB,WACA1hB,KAAK0hB,cAEV1hB,KAAKiW,SAAUjW,KAAKiW,OAAOA,SACtBjW,KAAKiW,OAAOA,OAAOmyB,iBAK5B3mB,EAAe7iB,UAAUijB,UAAY,WACpC,OAAG7hB,KAAK0hB,WACA1hB,KAAK0hB,WAAWG,eAGpB7hB,KAAKiW,SAAUjW,KAAKiW,OAAOA,SACtBjW,KAAKiW,OAAOA,OAAO4L,aAM7BJ,EAAe7iB,UAAUmpC,QAAU,WAClC,QAAG/nC,KAAKqoB,OACAroB,KAAKqoB,MAAMpqB,OAKpBwjB,EAAe7iB,UAAU0C,MAAQ,WAChC,QAAGtB,KAAKqoC,eAGLroC,KAAKsoC,yBAGLtoC,KAAKiW,QAAejW,KAAKiW,OAAO3U,UAIpCmgB,EAAe7iB,UAAU4mC,OAAS,WACjCxlC,KAAKqoC,YAAa,GAGnB5mB,EAAe7iB,UAAUma,UAAY,WACpC,IAAI/b,EAAI,EACR,IAAI,IAAIkF,KAAQlC,KAAKwV,WAAW,CAC/B,GAAGxV,KAAK2jC,mBAAmB3mC,IAAMkF,EAAM,OAAO,EAC9C,GAAGlC,KAAKwV,WAAWtT,GAAM6W,YAAa,OAAO,EAC7C/b,IAED,OAAGA,GAAKgD,KAAK2jC,mBAAmBvjC,QAIjCqhB,EAAe7iB,UAAUqmC,aAAe,WACvCjlC,KAAKoU,OAAO+S,eACTnnB,KAAKiW,QAAQjW,KAAKiW,OAAOgvB,gBAG7BxjB,EAAe7iB,UAAUomC,QAAUvjB,EAAe7iB,UAAUqmC,aAE5DxjB,EAAe7iB,UAAU2rB,cAAgB,WACxC,SAAGvqB,KAAKwa,SAAUxa,KAAKujC,SAASgF,UAIjC9mB,EAAe7iB,UAAU0pC,oBAAsB,WAC9C,QAAGtoC,KAAKuqB,oBACLvqB,KAAKiW,SAAUjW,KAAKiW,OAAOA,SACtBjW,KAAKiW,OAAOA,OAAOqyB,uBAK5B7mB,EAAe7iB,UAAU0rB,SAAW,SAASlU,EAAOgwB,GAEnD,GADApmC,KAAKoW,MAAQA,GACTgwB,EACH,IAAI,IAAIlkC,KAAQlC,KAAKwV,WACpBxV,KAAKwV,WAAWtT,GAAMmkC,kBAAkBjwB,GAGvCpW,KAAKiW,OACPjW,KAAKiW,OAAOlF,SAGZ/Q,KAAK+Q,UAIP0Q,EAAe7iB,UAAUuX,iBAAmB,WAuB3C,MAtBW,CACVmwB,KAAM,CACLjnC,MAAO,YAAapB,MAAO,OAC3BuY,SAAU,CAAC,QAAS,QAAS,UAAW,KAAM,UAAW,OAAQ,OAAQ,SAAU,QAAS,OAAQ,UACpGC,SAAU,CAAC,SAAU,QAAS,MAAO,QAAS,SAAU,SAAU,OAAQ,OAAQ,SAEnFyW,KAAM,CACL7tB,MAAO,cAAepB,MAAO,OAC7BuY,SAAU,CAAC,QAAS,QAAS,UAAW,KAAM,OAAQ,OAAQ,SAAU,SACxEC,SAAU,IAEX+vB,QAAS,CACRnnC,MAAO,UAAWpB,MAAO,UACzBuY,SAAU,CAAC,QAAS,QAAS,QAAS,OAAQ,UAAW,SAAU,SACnEC,SAAU,IAEXpX,MAAO,CACNA,MAAO,QAASpB,MAAO,QACvBuY,SAAU,CAAC,QAAS,SAAU,SAC9BC,SAAU,MAMbgL,EAAe7iB,UAAUqrB,mBAAqB,WAC7C,OAAOvsB,OAAO6kB,KAAKviB,KAAKkW,SAGzBuL,EAAe7iB,UAAUwrB,aAAe,WACvC,OAAOpqB,KAAKoW,OAGbqL,EAAe7iB,UAAU0X,gBAAkB,WAC1C,IAAItW,KAAKiW,OAAQ,MAAO,OACxB,IAAIuyB,EAASxoC,KAAKiW,OAAOmU,eACzB,MAAa,QAAVoe,EACK,OAEK,aAAVA,EAA8B,OACpB,QAAVA,EAAyB,UACrB,SAGR/mB,EAAe7iB,UAAUynC,kBAAoB,SAASmC,GACxC,QAAVA,GAAkBxoC,KAAKsqB,SAAS,QACtB,aAAVke,GAAuBxoC,KAAKsqB,SAAS,WAC3B,QAAVke,GAAkBxoC,KAAKsqB,SAAS,WACtB,WAAVke,GAAqBxoC,KAAKsqB,SAAS,YAGvC7I,EAAe7iB,UAAU+nB,sBAAwB,WAChD,MAA0B,QAAvB3mB,KAAKoqB,eACA,OAEkB,QAAvBpqB,KAAKoqB,eACA,OAED,SAGR3I,EAAe7iB,UAAU6a,SAAW,WACnC,IAAI,IAAIvX,KAAQlC,KAAKwV,WACpB,GAAoD,cAAjD1U,eAAeC,YAAYgB,aAAaG,IAAiC,cAARA,EAAqB,CACxF,IACIumC,EADQzoC,KAAKwV,WAAWtT,GACV4W,OAAO,GACzB,GAAG2vB,EAAM,CACR,IAAIzf,EAAMyf,EAAMxf,aAChB,GAAe,SAAZD,EAAG,KAAkB,OAAOA,EAAG,MAIrC,IAAIjqB,EAAIiB,KAAKoX,UACb,GAAGrY,GAA0B,MAArBA,EAAEwD,UAAU,EAAG,GAAW,CACjC,IAAI2sB,EAAKlvB,KAAKqX,eACVvV,EAAKhB,eAAeC,YAAYgB,aAAamtB,GAC7CptB,IAAIA,EAAKotB,GACb,IAAIgQ,EAAIp9B,EAAGD,MAAM,KACjB,OAAGq9B,EAAE9+B,OAAS,EACN,OAAS8+B,EAAE,GAEZ,aAER,OAAO,GAGRzd,EAAe7iB,UAAUqqB,WAAa,WACrC,IAAI6d,EAAM,CAAEpvB,OAAQ,MAIpB,IAAI,IAAIxV,KAHLlC,KAAK+Y,cAAa+tB,EAAIpvB,OAAS,WAC/B1X,KAAKsB,UAASwlC,EAAIpvB,OAAS,OAC9BovB,EAAI4B,UAAY,EACA1oC,KAAKwV,WACpBsxB,EAAI4B,YAGL,OADA5B,EAAG,KAAQA,EAAI4B,UAAY,cACpB5B,GAGRrlB,EAAe7iB,UAAUwnB,sBAAwB,WAChD,OAAOpmB,KAAK6W,eAGb4K,EAAe7iB,UAAUwoC,mBAAqB,SAAS9/B,GACtD,MAAa,QAAVA,EACK,IAAIiK,EAAauhB,iBAAiB9yB,MAEnC,IAAIuR,EAAa2U,iBAAiBlmB,OAG1CyhB,EAAe7iB,UAAUqoC,oBAAsB,SAAS7wB,GACvD,OAAOpW,KAAKkW,OAAOE,GAAOI,SAAS/C,OAAOzT,KAAKkW,OAAOE,GAAOK,WAG9DgL,EAAe7iB,UAAUsnC,qBAAuB,WAC/C,OAAOlmC,KAAKmmC,wBAGb1kB,EAAe7iB,UAAUqpB,YAAc,SAAShnB,GAC/C,IAAoC,GAAjCjB,KAAKwW,SAASxJ,QAAQ/L,KAAiD,GAAjCjB,KAAKyW,SAASzJ,QAAQ/L,GAC9D,OAAO,EAGR,IAAmC,GADhB,CAAC,SAAU,QAAS,OACvB+L,QAAQ/L,KACnBjB,KAAKirB,kBAAkBhqB,GAAQ,OAAO,EAG3C,QAAGjB,KAAKkmC,yBAAyD,GAD/C,CAAC,SAAU,SACiBl5B,QAAQ/L,KACjDjB,KAAK+Y,iBAIP/Y,KAAKuqB,iBAA4B,SAATtpB,MACf,QAATA,GAAgC,UAAbjB,KAAKO,SACf,QAATU,GAAgC,UAAbjB,KAAKO,QAEC,GADjBP,KAAKinC,oBAAoBjnC,KAAKoW,OAChCpJ,QAAQ/L,OAMlBwgB,EAAe7iB,UAAUqsB,kBAAoB,SAASzlB,GACrD,IAAIxF,KAAKiW,OAAQ,OAAO,EACxB,GAAGjW,KAAKiW,OAAOqtB,OAAO4B,iBAAiB,CACtC,IAAIa,EAAO/lC,KAAKiW,OAAOqtB,OAAO5R,YAC1BsU,EAAahmC,KAAKiW,OAAO6C,OAAO1Y,OACpC,IAAa,OAAVoF,GAA6B,SAAVA,IAClBugC,EAAKlU,KAAOmU,GAAcD,EAAKlU,IACjC,OAAO,EAGT,GAAa,UAAVrsB,GAAuBugC,EAAKnU,KAAOoU,GAAcD,EAAKnU,IACxD,OAAO,EAGT,OAAO,GAGRnQ,EAAe7iB,UAAUwsB,aAAe,SAASlpB,GAChDlC,KAAKoU,OAAOsT,KAAK1nB,KAAKoX,UAAWlV,IAGlCuf,EAAe7iB,UAAUwC,QAAU,SAASjD,GAE3C,IAAI,IAAI+D,KADRlC,KAAK7B,KAAOA,EACI6B,KAAKwV,WACpBxV,KAAKwV,WAAWtT,GAAMd,QAAQjD,GAE/B6B,KAAKoU,OAAOrD,UAGb0Q,EAAe7iB,UAAU4sB,cAAgB,WAAW,OAAOxrB,KAAK0W,YAGhE+K,EAAe7iB,UAAU6sB,UAAY,SAASrX,GAC7C,IAAIu0B,EAAU3oC,KAAKonC,mBAAmBhzB,GACnCu0B,IACF3oC,KAAK0W,WAAatC,EAClBpU,KAAKoU,OAASu0B,EACd3oC,KAAKoU,OAAOrD,WAKd0Q,EAAe7iB,UAAU+nC,QAAU,SAASpmC,GAS3CP,KAAKO,KAAOA,EACZP,KAAKoU,OAAOrD,UAIb0Q,EAAe7iB,UAAU8sB,KAAO,WAC/B1rB,KAAK2mC,QAAQ,WAGdllB,EAAe7iB,UAAU+sB,KAAO,WAC/B3rB,KAAK2mC,QAAQ,SAGdllB,EAAe7iB,UAAUgoC,WAAa,WACrC5mC,KAAKoU,OAAO/P,UAGbod,EAAe7iB,UAAUusB,sBAAwB,WAChD,OAAOnrB,KAAKujC,SAASqF,yBAGtBnnB,EAAe7iB,UAAUosB,qBAAuB,WAE/C,OADYhrB,KAAKujC,SAASsF,0BAI3BpnB,EAAe7iB,UAAU0oC,sBAAwB,SAAS5mC,GACzD,IAAIsW,EAAOhX,KAAK8oC,aAYhB,OAVGpoC,GAAWA,EAAQ0tB,KAAO1tB,EAAQ0tB,IAAI2a,SAUlC/xB,EAAKhX,KAAKujC,UAXJ,WAAW,OAAO,MAchC9hB,EAAe7iB,UAAUkqC,aAAe,SAASvF,EAAUxsB,GAC1D,IAAIiyB,EAAS,GACTC,EAAOnoC,eAAeC,YAAYmhB,UAAU,OAAQ,SACrDqhB,EAASviB,WAAWioB,IAASlyB,EAAOwsB,EAAU0F,EAAM1F,EAASviB,WAAWioB,KAC1ED,EAAO/9B,KAAKg+B,GAEb,IAAIC,EAAOpoC,eAAeC,YAAYmhB,UAAU,OAAQ,WAIxD,IAAI,IAAIhgB,KAHLqhC,EAASviB,WAAWkoB,IACtBF,EAAO/9B,KAAKi+B,GAEG3F,EAASviB,YACI,GAAzBgoB,EAAOh8B,QAAQ9K,IAAa8mC,EAAO/9B,KAAK/I,GAE5C,IAAI,IAAIA,KAAQqhC,EAAShsB,UACI,GAAzByxB,EAAOh8B,QAAQ9K,IAAa8mC,EAAO/9B,KAAK/I,GAE5C,OAAO8mC,GAIRvnB,EAAe7iB,UAAUmS,OAAS,WACjC/Q,KAAKoU,OAAOqT,QACZznB,KAAKuhB,OAAOvhB,KAAKoU,SAGlBqN,EAAe7iB,UAAUuqC,WAAa,SAASpE,GAC9CA,EAAS,YAAc/kC,KAAKujC,SAAS5oB,IACrC,IAAIyuB,EAAO,GAEX,OADAA,EAAKppC,KAAKoX,WAAa2tB,EAChBqE,GAGR3nB,EAAe7iB,UAAUyqC,cAAgB,SAAStE,GAIjD,OAHAA,EAAS,SAAW/kC,KAAKujC,SAAS5oB,IACb,MAAlB3a,KAAKoX,YAAmB2tB,EAAS,OAAS/kC,KAAKoX,WAC/CpX,KAAKujC,SAAS+F,iBAAgBvE,EAAS,YAAc/kC,KAAKujC,SAAS+F,gBAC/DvE,GAGRtjB,EAAe7iB,UAAU+hB,QAAU,WAClC,IAAIokB,EAAW,GACf,IAAI,IAAI/nC,KAAKgD,KAAKwV,WAAW,CAC5B,IAAI+zB,EAAYvpC,KAAKwV,WAAWxY,GAAG2jB,UAC/B7f,eAAeC,YAAYyoC,MAAMD,KACpCxE,EAAS/nC,GAAKusC,GAGhB,QAAGzoC,eAAeC,YAAYyoC,MAAMzE,KAAa/kC,KAAKiW,SAI3CjW,KAAKqpC,cAActE,IAM/BhoC,EAAOD,QAAQ,CAAC2kB,iBAAe2hB,qB,cCxnC/B,SAAS3xB,EAAiB/Q,GACzBV,KAAKoM,IAAQ1L,GAAWA,EAAQ0L,IAAO,0BAA4B1L,EAAQ0L,IAAM,yBACjFpM,KAAKU,QAAUA,EAGhB+Q,EAAiB7S,UAAUktB,OAAS,SAAS5qB,EAAU6qB,GACtD,IAAImD,EAAKpuB,eAAeC,YAAYgB,aAAab,EAASoY,MAAMmwB,WAChEva,EAAMA,GAAUhuB,EAASoY,MAAMmwB,UAC/B,IAAIxrC,EAAQiD,EAASjD,QAErB,GADY+B,KAAKU,cAAsC,IAApBV,KAAKU,QAAQgpC,IAAsB1pC,KAAKU,QAAQgpC,IAAM1pC,KAAK2pC,UAAUza,EAAIjxB,GACrG,CACN,IAAIiF,EAAQzD,SAASC,cAAc,YACnCM,KAAKoM,KAAO,kCAER,CACJ,IAAIyf,EAAS7rB,KAAKU,cAAuC,IAArBV,KAAKU,QAAQmrB,KAAuB7rB,KAAKU,QAAQmrB,KAAO7rB,KAAK4pC,YAAY1a,EAAIjxB,IAC7GiF,EAAQzD,SAASC,cAAc,UAC7BC,aAAa,OAAQ,QAC3BuD,EAAMvD,aAAa,OAAQksB,GAE5B3oB,EAAMvD,aAAa,QAASK,KAAKoM,KACjClJ,EAAMjF,MAAQA,EAKd,OAHAiF,EAAMnD,iBAAiB,SAAS,WAC/BmB,EAASquB,IAAIvvB,KAAK/B,UAEZiF,GAGRuO,EAAiB7S,UAAU+qC,UAAY,SAASza,EAAIjxB,GACnD,GAAGA,GAASA,EAAMmC,QAAUnC,EAAMmC,OAAS,IAAK,OAAO,EAEvD,OAAyB,GADb,CAAC,yBAA0B,wBAAyB,mBAAoB,WAAY,WAAY,kBACnG4M,QAAQkiB,IAIlBzd,EAAiB7S,UAAUgrC,YAAc,SAAS1a,EAAIjxB,GACrD,GAAGA,GAASA,EAAMmC,QAAUnC,EAAMmC,OAAS,GAAI,OAAO,GAMtD,OAAwB,GALb,CAAC,UAAW,iBAAkB,cAKjC4M,QAAQkiB,GAAkB,IACR,GALb,CAAC,iBAAkB,iBAAkB,cAAe,YAAa,WAAY,WACzF,oBAAoB,iBAAkB,gBAAiB,eAAgB,wBAAyB,sBAChG,yBAA0B,sBAAuB,sBAAuB,yBAA0B,cAAc,mBAGvGliB,QAAQkiB,GAAkB,IACX,GAHb,CAAC,cAAe,YAAa,aAAc,WAAY,WAAY,YAAa,mBAAoB,gBAGvGliB,QAAQkiB,GAAkB,EAC5B,IAGRnyB,EAAOD,QAAQ,CAAC2U,qB,cCnDhB,SAASC,EAAkBhR,GAC1BV,KAAKoM,IAAM,wDAA2D1L,GAAWA,EAAQ0L,IAAQ1L,EAAQ0L,IAAM,IAGhHsF,EAAkB9S,UAAUktB,OAAS,SAAS5qB,EAAU6qB,GACvD,IAAI9tB,EAAQiD,EAASjD,QACjBiF,EAAQzD,SAASC,cAAc,QAEnC,GADAwD,EAAMvD,aAAa,QAASK,KAAKoM,KAC9BnO,EAAM,CACR,IAAI4rC,EAASpqC,SAASK,eAAe7B,GACrCiF,EAAMrD,YAAYgqC,GAEnB,OAAO3mC,GAGRnG,EAAOD,QAAQ,CAAC4U,sB,cCfhB,SAASC,EAAkBjR,GAC1BV,KAAKoM,IAAM,wDAA2D1L,GAAWA,EAAQ0L,IAAQ1L,EAAQ0L,IAAM,IAGhHuF,EAAkB/S,UAAUktB,OAAS,SAAS5qB,EAAU6qB,GACvD,IAAI9tB,EAAQiD,EAASjD,QACjBiF,EAAQzD,SAASC,cAAc,SAanC,OAZAwD,EAAMvD,aAAa,OAAQ,YACxB1B,GACFiF,EAAMvD,aAAa,UAAW,WAE/BuD,EAAMnD,iBAAiB,UAAU,WAC7B9B,EACFiD,EAASquB,IAAI,IAGbruB,EAASquB,IAAI,WAGRrsB,GAGRnG,EAAOD,QAAQ,CAAC6U,sB,cCtBhB,SAASC,EAAiBlR,IAE1BkR,EAAiBhT,UAAUktB,OAAS,SAAS5qB,EAAU6qB,GACtD,IAAI9tB,EAAQiD,EAASjD,QACjBiF,EAAQzD,SAASC,cAAc,QAGnC,GAFAwD,EAAMvD,aAAa,QAAS,gDAC5BuD,EAAMvD,aAAa,aAAc1B,GAC9BA,EAEF,IADA,IAAI6rC,EAAM5oC,EAASoY,MAAMA,MAAMywB,SACvB/sC,EAAI,EAAGA,EAAE8sC,EAAI1pC,OAAQpD,IAC5B,GAAG8sC,EAAI9sC,GAAJ,OAAgBiB,OAAnB,CACC,GAAG6rC,EAAI9sC,GAAGqC,OAASyqC,EAAI9sC,GAAGqC,MAAM,UAC/B,IAAImc,EAAMsuB,EAAI9sC,GAAGqC,MAAM,eAGvBmc,EAAM1a,eAAeC,YAAYC,aAAa/C,GAE/CiF,EAAMrD,YAAYJ,SAASK,eAAe0b,IAK7C,OAAOtY,GAGRnG,EAAOD,QAAQ,CAAC8U,qB,gBCzBhB,IAAM1S,EAAkBD,EAAQ,GAEhC,SAAS4S,EAAiBnR,IAE1BmR,EAAiBjT,UAAUktB,OAAS,SAAS5qB,EAAU6qB,GACtD,IAAI9tB,EAAQiD,EAASjD,QACNwB,SAASC,cAAc,UAC7BC,aAAa,QAAS,0BAC/B,IAAIqqC,EAAW9oC,EAASoY,MAAM2wB,mBAC9BD,EAASttB,QAAQ,CAAEze,MAAO,GAAIoB,MAAO,kBAKrC,OADUH,EAAgBirB,oBAAoB,gBAAiB6f,EAAU/rC,GAH1D,SAASosB,GACvBnpB,EAASquB,IAAIlF,OAMfttB,EAAOD,QAAQ,CAAC+U,qB,cChBhB,SAASC,EAAqBpR,GAC7BV,KAAKkqC,OAAS,GAGfp4B,EAAqBlT,UAAUktB,OAAS,SAAS5qB,EAAU6qB,GAC1D,IAAImD,EAAKpuB,eAAeC,YAAYgB,aAAab,EAASoY,MAAMmwB,WAChEva,EAAMA,GAAUhuB,EAASoY,MAAMmwB,UAC/B,IAAIxrC,EAAQiD,EAASjD,QACjBiF,EAAQzD,SAASC,cAAc,QACnCwD,EAAMvD,aAAa,QAAS,sDAC5BuD,EAAMvD,aAAa,aAAc1B,GACjC,IACC,IAAIksC,IAAUlsC,GAAQkI,KAAK6nB,MAAM/vB,GAElC,MAAM6P,GACL5M,EAASkpC,QAAQlb,EAAK,2BAA4BphB,EAAEyG,YAChD41B,GAAS,EACblsC,GAAQ,EAET,GAAGA,EAAM,CACC,kBAANixB,IACFib,EAAS,CAACA,IAEX,IAAI,IAAIntC,EAAI,EAAGA,EAAImtC,EAAO/pC,OAAQpD,IAAI,CACrC,IAAIqtC,EAAQ5qC,SAASC,cAAc,QACnC2qC,EAAM1qC,aAAa,QAAS,WAC5B0qC,EAAMxqC,YAAYJ,SAASK,eAAe,eAC1CuqC,EAAMxqC,YAAYJ,SAASK,eAAeqqC,EAAOntC,GAAG,GAAK,QACzDqtC,EAAMxqC,YAAYJ,SAASK,eAAe,gBAC1CuqC,EAAMxqC,YAAYJ,SAASK,eAAeqqC,EAAOntC,GAAG,GAAK,OACzDkG,EAAMrD,YAAYwqC,IAGpB,OAAOnnC,GAGRnG,EAAOD,QAAQ,CAACgV,yB,cCrChB,SAASC,EAAqBrR,GAC7BV,KAAKkqC,OAAS,GAGfn4B,EAAqBnT,UAAU0rC,aAAe,SAAS3c,EAAK4c,EAAM7vB,GACjE,IAAI8vB,EAAS/qC,SAASC,cAAc,SACpC8qC,EAAO7qC,aAAa,OAAQ,QAC5B6qC,EAAOvsC,MAAQ0vB,EACf,IAAI8c,EAAUhrC,SAASC,cAAc,SAKrC,OAJA+qC,EAAQ9qC,aAAa,OAAQ,QAC7B8qC,EAAQxsC,MAAQssC,EAChBC,EAAOzqC,iBAAiB,SAAU2a,GAClC+vB,EAAQ1qC,iBAAiB,SAAU2a,GAC5B,CAAC8vB,EAAQC,IAGjB14B,EAAqBnT,UAAU8rC,cAAgB,SAAS/c,EAAK4c,EAAMrb,EAAIzX,EAAOxB,GAC7E,IAAIo0B,EAAQ5qC,SAASC,cAAc,QACnC2qC,EAAM1qC,aAAa,QAAS,qBAC5B,IAAIgrC,EAAWlrC,SAASC,cAAc,QAGtC,GAFAirC,EAAShrC,aAAa,QAAS,yBAC/B0qC,EAAMxqC,YAAY8qC,GACflzB,EAAQ,GAAY,0BAANyX,GAAkCzX,EAAQ,EAAG,CAC7D,IAAImzB,EAASnrC,SAASC,cAAc,UACpCkrC,EAAOjrC,aAAa,QAAS,qBAC7BirC,EAAO/qC,YAAYJ,SAASK,eAAe,WAC3C8qC,EAAO7qC,iBAAiB,SAAS,WAChCwqC,EAAKtsC,MAAQ,GACb0vB,EAAI1vB,MAAQ,GACZgY,EAAO7G,YAAYi7B,MAEpBM,EAAS9qC,YAAY+qC,GAQtB,OANAP,EAAMxqC,YAAYJ,SAASK,eAAe,eAC1CuqC,EAAMxqC,YAAY8tB,GAClB0c,EAAMxqC,YAAYJ,SAASK,eAAe,QAC1CuqC,EAAMxqC,YAAYJ,SAASK,eAAe,kBAC1CuqC,EAAMxqC,YAAY0qC,GAClBF,EAAMxqC,YAAYJ,SAASK,eAAe,QACnCuqC,GAIRt4B,EAAqBnT,UAAUktB,OAAS,SAAS5qB,EAAU6qB,GAC1D,IAAImD,EAAKhuB,EAASoY,MAAMuxB,mBACpB5sC,EAAQiD,EAASjD,QACjBiF,EAAQzD,SAASC,cAAc,QACnCwD,EAAMvD,aAAa,QAAS,sDAC5BuD,EAAMvD,aAAa,aAAc1B,GACjC,IACC,IAAIksC,IAAUlsC,GAAQkI,KAAK6nB,MAAM/vB,GAElC,MAAM6P,GACL5M,EAASkpC,QAAQlb,EAAK,2BAA4BphB,EAAEyG,YAChD41B,GAAS,EACblsC,GAAQ,EAET,IAAI8L,EAAO/J,KACP8qC,EAAsB,WAEzB,IADA,IAAI91B,EAAO,GACHhY,EAAI,EAAGA,EAAE+M,EAAKmgC,OAAO9pC,OAAQpD,IACpC,GAAG+M,EAAKmgC,OAAOltC,GAAG,GAAGiB,OAAS8L,EAAKmgC,OAAOltC,GAAG,GAAGiB,MAAM,CACrD,IAAIosB,EAAM,IAAMtgB,EAAKmgC,OAAOltC,GAAG,GAAGiB,MAAQ,IAAM8L,EAAKmgC,OAAOltC,GAAG,GAAGiB,MAAQ,IAC1E+W,EAAK/J,KAAKof,GAGZ,GAAkB,GAAfrV,EAAK5U,OACPc,EAASquB,IAAI,SAET,GAAS,kBAANL,EACPhuB,EAASquB,IAAIva,EAAK,QAEd,CACJ,IAAI+1B,EAAK,IACT,IAAQ/tC,EAAI,EAAGA,EAAEgY,EAAK5U,OAAQpD,IAC7B+tC,GAAM/1B,EAAKhY,GACRA,EAAE,EAAIgY,EAAK5U,SAAQ2qC,GAAM,KAE7BA,GAAM,IACN7pC,EAASquB,IAAIwb,KAGXZ,IACM,kBAANjb,EAAwBib,EAAS,CAAC,GAAG,KAEvCA,EAAS,CAAC,CAAC,GAAG,IAAI,CAAC,GAAG,KACb,yBAANjb,GAA+Bib,EAAOl/B,KAAK,CAAC,GAAG,OAG3C,kBAANikB,IACFib,EAAS,CAACA,IAEX,IAAI,IAAIntC,EAAI,EAAGA,EAAImtC,EAAO/pC,OAAQpD,IACjCgD,KAAKkqC,OAAOj/B,KAAKjL,KAAKsqC,aAAaH,EAAOntC,GAAG,GAAImtC,EAAOntC,GAAG,GAAI8tC,IAEhE,IAAIE,EAASvrC,SAASC,cAAc,QACpC,IAAQ1C,EAAI,EAAGA,EAAIgD,KAAKkqC,OAAO9pC,OAAQpD,IAAI,CAC1C,IAAIqtC,EAAQrqC,KAAK0qC,cAAc1qC,KAAKkqC,OAAOltC,GAAG,GAAIgD,KAAKkqC,OAAOltC,GAAG,GAAIkyB,EAAIlyB,EAAGguC,GAC5EA,EAAOnrC,YAAYwqC,GAEpBnnC,EAAMrD,YAAYmrC,GACdjhC,EAAO/J,KACX,GAAS,kBAANkvB,EAAuB,CACzB,IAAI+b,EAAUxrC,SAASC,cAAc,QACrCurC,EAAQtrC,aAAa,QAAS,2BAC9B,IAAIurC,EAASzrC,SAASC,cAAc,UACpCwrC,EAAOvrC,aAAa,QAAS,2BAC7BurC,EAAOrrC,YAAYJ,SAASK,eAAe,QAC3CorC,EAAOnrC,iBAAiB,SAAS,WAChC,IAAIorC,EAASphC,EAAKugC,aAAa,GAAI,GAAIQ,GACnCT,EAAQtgC,EAAK2gC,cAAcS,EAAO,GAAIA,EAAO,GAAIjc,EAAInlB,EAAKmgC,OAAO9pC,OAAQ4qC,GAC7EA,EAAOnrC,YAAYwqC,GACnBtgC,EAAKmgC,OAAOj/B,KAAKkgC,MAElBF,EAAQprC,YAAYqrC,GACpBhoC,EAAMrD,YAAYorC,GAEnB,OAAO/nC,GAGRnG,EAAOD,QAAQ,CAACiV,yB,gBCxHhB,IAAMq5B,EAAansC,EAAQ,IAE3B,SAAS+S,EAAetR,GACvBV,KAAK6xB,OAAOnxB,IAAWA,EAAQmxB,MAAMnxB,EAAQmxB,IAC7C7xB,KAAK4xB,OAAOlxB,IAAWA,EAAQkxB,MAAMlxB,EAAQkxB,IAC7C5xB,KAAKqrC,YAAY3qC,IAAWA,EAAQ2qC,WAAW3qC,EAAQ2qC,SACvDrrC,KAAKsrC,YAAc,IACnBtrC,KAAKurC,YAAc,IACnBvrC,KAAKwrC,mBAAqB,KAC1BxrC,KAAKyrC,OAAS,IAAIL,EAAWpf,eAG9Bha,EAAepT,UAAUktB,OAAS,SAAS5qB,EAAU6qB,GACpD,IAAImD,EAAKpuB,eAAeC,YAAYgB,aAAab,EAASoY,MAAMmwB,WAChEva,EAAMA,GAAUhuB,EAASoY,MAAMmwB,UAC/B,IAAIxrC,EAAQiD,EAASjD,QACjBiF,EAAQzD,SAASC,cAAc,QAGnC,GAFAwD,EAAMvD,aAAa,QAAS,gDAC5BuD,EAAMvD,aAAa,aAAc1B,GAC9BA,EAAM,CACR,IAAIksC,EAASrpC,eAAeC,YAAY2qC,UAAUxc,EAAIjxB,GAClD0tC,EAAW3rC,KAAK4rC,oBAAoBzB,GACpC0B,EAAW7rC,KAAK8rC,oBAAoB3B,GACrC0B,GAAU3oC,EAAMrD,YAAYgsC,GAC5BA,GAAYF,GAAUzoC,EAAMrD,YAAYJ,SAASK,eAAeE,KAAKwrC,qBACrEG,GAAUzoC,EAAMrD,YAAY8rC,GAEhC,OAAOzoC,GAGR8O,EAAepT,UAAUktC,oBAAsB,SAAS3B,EAAQjb,GAC/D,IAAI6c,IAAQ5B,EAAO6B,MAAOvsC,SAASC,cAAc,QAC9CqsC,IACFA,EAAKpsC,aAAa,QAAS,sBAC3BosC,EAAKlsC,YAAYJ,SAASK,eAAeqqC,EAAO6B,QAEjD,IAAIC,OAAgC,IAAjB9B,EAAO+B,QAAwBzsC,SAASC,cAAc,QACzE,GAAGusC,EAAK,CACPA,EAAKtsC,aAAa,QAAS,wBAC3B,IAAIwsC,GAAQhC,EAAO+B,OAAc/B,EAAO+B,QACxCD,EAAKpsC,YAAYJ,SAASK,eAAeqsC,IAE1C,IAAIC,OAAgC,IAAjBjC,EAAOkC,QAAwB5sC,SAASC,cAAc,QACzE,GAAG0sC,EAAK,CACPA,EAAKzsC,aAAa,QAAS,wBAC3B,IAAI2sC,GAAQnC,EAAOkC,OAAclC,EAAOkC,QACxCD,EAAKvsC,YAAYJ,SAASK,eAAewsC,IAE1C,IAAIC,IAAMpC,EAAOqC,UAAW/sC,SAASC,cAAc,QAKnD,GAJG6sC,IACFH,EAAKzsC,aAAa,QAAS,0BAC3BysC,EAAKvsC,YAAYJ,SAASK,eAAeqqC,EAAOqC,YAE9CT,GAAQE,GAAQG,GAAQG,EAAG,CAC7B,IAAIE,EAAQhtC,SAASC,cAAc,QAgBnC,OAfA+sC,EAAM9sC,aAAa,QAAS,iCAAiCuvB,GAC1D6c,GAAMU,EAAM5sC,YAAYksC,GACxBE,IACCF,GAAMU,EAAM5sC,YAAYJ,SAASK,eAAeE,KAAKurC,cACxDkB,EAAM5sC,YAAYosC,IAEhBG,KACCH,GAAQF,IAAMU,EAAM5sC,YAAYJ,SAASK,eAAeE,KAAKurC,cAChEkB,EAAM5sC,YAAYusC,IAEhBG,IACFE,EAAM5sC,YAAYJ,SAASK,eAAe,iBAC1C2sC,EAAM5sC,YAAYusC,GAClBK,EAAM5sC,YAAYJ,SAASK,eAAe,OAEpC2sC,EAER,OAAO,GAGRz6B,EAAepT,UAAUgtC,oBAAsB,SAASzB,EAAQjb,GAC/D,IAAIwd,IAAQvC,EAAOwC,MAAOltC,SAASC,cAAc,QAC9CgtC,IACFA,EAAK/sC,aAAa,QAAS,sBAC3B+sC,EAAK7sC,YAAYJ,SAASK,eAAeqqC,EAAOwC,QAEjD,IAAIV,IAAQ9B,EAAOyC,OAAQntC,SAASC,cAAc,QAC/CusC,IACFA,EAAKtsC,aAAa,QAAS,uBAC3BssC,EAAKpsC,YAAYJ,SAASK,eAAeE,KAAKyrC,OAAOvf,aAAaie,EAAOyC,UAE1E,IAAIC,IAAQ1C,EAAO2C,KAAMrtC,SAASC,cAAc,QAKhD,GAJGmtC,IACFA,EAAKltC,aAAa,QAAS,qBAC3BktC,EAAKhtC,YAAYJ,SAASK,eAAeqqC,EAAO2C,OAE9CJ,GAAQT,GAAQY,EAAK,CACvB,IAAIJ,EAAQhtC,SAASC,cAAc,QAUnC,OATGmtC,GAAMJ,EAAM5sC,YAAYgtC,GACxBZ,IACCY,GAAMJ,EAAM5sC,YAAYJ,SAASK,eAAeE,KAAKsrC,cACxDmB,EAAM5sC,YAAYosC,IAEhBS,KACCT,GAAQY,IAAMJ,EAAM5sC,YAAYJ,SAASK,eAAeE,KAAKsrC,cAChEmB,EAAM5sC,YAAY6sC,IAEZD,EAER,OAAO,GAGR1vC,EAAOD,QAAQ,CAACkV,mB,gBC3GhB,IAAMo5B,EAAansC,EAAQ,IAE3B,SAASgT,EAAevR,GACvBV,KAAK6xB,OAAOnxB,IAAWA,EAAQmxB,MAAMnxB,EAAQmxB,IAC7C7xB,KAAK4xB,OAAOlxB,IAAWA,EAAQkxB,MAAMlxB,EAAQkxB,IAC7C5xB,KAAKqrC,YAAY3qC,IAAWA,EAAQ2qC,WAAW3qC,EAAQ2qC,SACvDrrC,KAAKsrC,YAAc,IACnBtrC,KAAKurC,YAAc,IACnBvrC,KAAKwrC,mBAAqB,KAC1BxrC,KAAKyrC,OAAS,IAAIL,EAAWpf,eAG9B/Z,EAAerT,UAAUktB,OAAS,SAAS5qB,EAAU6qB,GACpD,IAAImD,EAAKpuB,eAAeC,YAAYgB,aAAab,EAASoY,MAAMmwB,WAChEva,EAAMA,GAAUhuB,EAASoY,MAAMmwB,UAC/B,IAAIxrC,EAAQiD,EAASjD,QACjBiF,EAAQzD,SAASC,cAAc,QACnCwD,EAAMvD,aAAa,QAAS,gDAC5BuD,EAAMvD,aAAa,aAAc1B,GAEhC+B,KAAKmqC,OADHlsC,EACY6C,eAAeC,YAAY2qC,UAAUxc,EAAIjxB,GAErC,GACnB,IAAI0tC,EAAW3rC,KAAK4rC,oBAAoB5rC,KAAKmqC,OAAQjb,EAAIhuB,GACrD2qC,EAAW7rC,KAAK8rC,oBAAoB9rC,KAAKmqC,OAAQjb,EAAIhuB,GAIzD,OAHG2qC,GAAU3oC,EAAMrD,YAAYgsC,GAC5BA,GAAYF,GAAUzoC,EAAMrD,YAAYJ,SAASK,eAAeE,KAAKwrC,qBACrEG,GAAUzoC,EAAMrD,YAAY8rC,GACxBzoC,GAGR+O,EAAerT,UAAU2wB,IAAM,SAASwd,EAAM1iB,EAAKnpB,EAAUguB,GAC5DlvB,KAAKmqC,OAAO4C,GAAQ1iB,EACpB,IAAI2iB,EAAMlsC,eAAeC,YAAYksC,cAAcjtC,KAAKmqC,OAAQjb,GAC7D8d,GACF9rC,EAASquB,IAAIyd,IAIf/6B,EAAerT,UAAUktC,oBAAsB,SAAS3B,EAAQjb,EAAIhuB,GACnE,IAAqE,GAAlE,CAAC,eAAgB,oBAAqB,YAAY8L,QAAQkiB,GAC5D,OAAO,EAER,IAAInlB,EAAO/J,KACP+rC,EAAOtsC,SAASC,cAAc,SAClCqsC,EAAKpsC,aAAa,QAAS,qCAAqCuvB,GAChE6c,EAAKpsC,aAAa,OAAQ,GAC1BosC,EAAKpsC,aAAa,cAAe,MACjCosC,EAAK9tC,MAASksC,EAAO6B,KAAO7B,EAAO6B,KAAO,GAC1CD,EAAKhsC,iBAAiB,SAAS,WAC9BgK,EAAKwlB,IAAI,OAAQvvB,KAAK/B,MAAOiD,EAAUguB,MAExC,IAAI+c,EAAOxsC,SAASC,cAAc,SAClCusC,EAAKtsC,aAAa,QAAS,yCAAyCuvB,GACpE+c,EAAKtsC,aAAa,OAAQ,GAC1BssC,EAAKtsC,aAAa,cAAe,MACjCssC,EAAKhuC,MAASksC,EAAO+B,OAAS/B,EAAO+B,OAAQ,GAC7CD,EAAKlsC,iBAAiB,SAAS,WAC9BgK,EAAKwlB,IAAI,SAAUvvB,KAAK/B,MAAOiD,EAAUguB,MAE1C,IAAIkd,EAAO3sC,SAASC,cAAc,SAClC0sC,EAAKzsC,aAAa,QAAS,yCAAyCuvB,GACpEkd,EAAKzsC,aAAa,OAAQ,GAC1BysC,EAAKzsC,aAAa,cAAe,aACjCysC,EAAKnuC,MAASksC,EAAOkC,OAASlC,EAAOkC,OAAQ,GAC7CD,EAAKrsC,iBAAiB,SAAS,WAC9BgK,EAAKwlB,IAAI,SAAUvvB,KAAK/B,MAAOiD,EAAUguB,MAE1C,IAAI+F,EAAOx1B,SAASC,cAAc,QAMlC,OALAu1B,EAAKp1B,YAAYksC,GACjB9W,EAAKp1B,YAAYJ,SAASK,eAAeE,KAAKurC,cAC9CtW,EAAKp1B,YAAYosC,GACjBhX,EAAKp1B,YAAYJ,SAASK,eAAeE,KAAKurC,cAC9CtW,EAAKp1B,YAAYusC,GACVnX,GAGRhjB,EAAerT,UAAUgtC,oBAAsB,SAASzB,EAAQjb,EAAIhuB,GACnE,IAAI6I,EAAO/J,KACX,IAAoG,GAAjG,CAAC,WAAY,eAAgB,YAAa,iBAAkB,qBAAqBgN,QAAQkiB,GAAU,CACrG,IAAIwd,EAAOjtC,SAASC,cAAc,SAClCgtC,EAAK/sC,aAAa,QAAS,qCAAqCuvB,GAChEwd,EAAK/sC,aAAa,OAAQ,GAC1B+sC,EAAK/sC,aAAa,cAAe,QACjC+sC,EAAKzuC,MAASksC,EAAOwC,KAAOxC,EAAOwC,KAAO,GAC1CD,EAAK3sC,iBAAiB,SAAS,WAC9BgK,EAAKwlB,IAAI,OAAQvvB,KAAK/B,MAAOiD,EAAUguB,MAGzC,IAAsH,GAAnH,CAAC,WAAY,eAAgB,iBAAkB,oBAAqB,aAAc,iBAAiBliB,QAAQkiB,GAAU,CACvH,IAAI+c,EAAOxsC,SAASC,cAAc,UAClCusC,EAAKtsC,aAAa,QAAS,uCAAuCuvB,GAClE,IAAI,IAAIlyB,EAAI,EAAGA,EAAEgD,KAAKyrC,OAAOxf,OAAO7rB,OAAQpD,IAAI,CAC/C,IAAIkwC,EAAQztC,SAASC,cAAc,UACnCwtC,EAAMjvC,MAAQjB,EAAE,EAChBkwC,EAAMrtC,YAAYJ,SAASK,eAAeE,KAAKyrC,OAAOxf,OAAOjvB,KAC1DmtC,EAAOyC,OAASzC,EAAOyC,OAAS5vC,EAAE,IACpCkwC,EAAMvsC,UAAW,GAElBsrC,EAAKpsC,YAAYqtC,GAElBjB,EAAKlsC,iBAAiB,UAAU,WAC/BgK,EAAKwlB,IAAI,QAASvvB,KAAK/B,MAAOiD,EAAUguB,MAG1C,IAAkG,GAA/F,CAAC,WAAY,eAAgB,oBAAqB,WAAY,iBAAiBliB,QAAQkiB,GAAU,CACnG,IAAI2d,EAAOptC,SAASC,cAAc,SAClCmtC,EAAKltC,aAAa,QAAS,mCAAmCuvB,GAC9D2d,EAAKltC,aAAa,OAAQ,GAC1BktC,EAAKltC,aAAa,cAAe,MACjCktC,EAAK5uC,MAASksC,EAAO2C,IAAM3C,EAAO2C,IAAM,GACxCD,EAAK9sC,iBAAiB,SAAS,WAC9BgK,EAAKwlB,IAAI,MAAOvvB,KAAK/B,MAAOiD,EAAUguB,MAGxC,GAAGwd,GAAQT,GAAQY,EAAK,CACvB,IAAIJ,EAAQhtC,SAASC,cAAc,QAUnC,OATGmtC,GAAMJ,EAAM5sC,YAAYgtC,GACxBZ,IACCY,GAAMJ,EAAM5sC,YAAYJ,SAASK,eAAeE,KAAKsrC,cACxDmB,EAAM5sC,YAAYosC,IAEhBS,KACCT,GAAQY,IAAMJ,EAAM5sC,YAAYJ,SAASK,eAAeE,KAAKsrC,cAChEmB,EAAM5sC,YAAY6sC,IAEZD,EAER,OAAO,GAGR1vC,EAAOD,QAAQ,CAACmV,mB,qPCnIhB,IAAM/S,EAAkBD,EAAQ,GAGhC,SAASiT,EAAiBxR,IAC1BwR,EAAiBtT,UAAUktB,OAAS,SAAS5qB,EAAU6qB,GACtD,IAAI9tB,EAAQiD,EAASjD,QAEjBokB,GADApkB,EAAQ6C,eAAeC,YAAYqf,UAAUniB,GACpCwB,SAASC,cAAc,SACpC2iB,EAAO1iB,aAAa,QAAS,0DAE7B,GAAGK,KAAKqiB,OACP,OAAOriB,KAAKqiB,OAEb,GAAGpkB,EAAM,CACR,IAAI6F,EAAM9D,KAAKmtC,kBAAkBlvC,EAAOiD,EAAU6qB,GAClD1J,EAAOxiB,YAAYiE,GAEpB,OAAOue,GAGRnQ,EAAiBtT,UAAUuuC,kBAAoB,SAASlvC,EAAOiD,EAAU6qB,GACxE,IAAIjd,EAAOrP,SAASC,cAAc,QAC9BqK,EAAO/J,KAYX,OAXA8O,EAAKnP,aAAa,QAAS,0BAC3BmP,EAAKjP,YAAYksB,EAAW6H,aAAa31B,KACtCyjB,WAAaxgB,EAASknC,kBACxB1mB,WAAW/V,gBAAgB1N,GAAO+H,MAAK,SAAST,GAC/C,IAAIiW,EAAMzR,EAAKqjC,eAAenvC,EAAOsH,EAAUwmB,GAC5CvQ,IACF1a,eAAeC,YAAYsE,eAAeyJ,GAC1CA,EAAKjP,YAAY2b,OAIb1M,GAGRoD,EAAiBtT,UAAUwuC,eAAiB,SAAS5rC,EAAK+D,EAAU8nC,GACnE,IAAIC,EAAQ7tC,SAASC,cAAc,QACnC,GAAG6F,IAAagoC,GAAKruC,EAAgBqc,4BAA4B,gBAAiBhW,IAAW,CAC5F+nC,EAAMztC,YAAYwtC,EAAGzZ,aAAapyB,EAAK+rC,KACvC,IACIC,EAAMhsC,EAAM,UADPtC,EAAgBqc,4BAA4B,eAAgBhW,GAEjEi8B,EAAKtiC,EAAgBqc,4BAA4B,kBAAmBhW,GAKxE,MAJgB,UAAb,EAAOi8B,IAAkBA,EAAG,YAC9BgM,GAAO,IAAMhM,EAAG,WAEjB8L,EAAM3tC,aAAa,QAAS6tC,GACrBF,EAER,OAAO,GAGRvwC,EAAOD,QAAQ,CAACoV,qB,cCrDhB,SAASC,EAAiBzR,IAC1ByR,EAAiBvT,UAAUktB,OAAS,SAAS5qB,EAAU6qB,GACtD,IAAI9tB,EAAQiD,EAASjD,QACjBiF,EAAQzD,SAASC,cAAc,SACnCwD,EAAMvD,aAAa,QAAS,0DAC5BuD,EAAMvD,aAAa,OAAQ,QAC3BuD,EAAMvD,aAAa,OAAQ,IAC3BuD,EAAMjF,MAAQA,EASd,OAPAiF,EAAMnD,iBAAiB,UAAU,WAChC,IAAIyB,EAAMxB,KAAK/B,OACS,GAArBuD,EAAIwL,QAAQ,OAAmC,GAArBxL,EAAIwL,QAAQ,OACxCxL,EAAM,OAASA,GAEhBN,EAASquB,IAAI/tB,MAEP0B,GAGRnG,EAAOD,QAAQ,CAACqV,qB,cCnBhB,SAASC,EAAgB1R,IACzB0R,EAAgBxT,UAAUktB,OAAS,SAAS5qB,EAAU6qB,GACrD,IAAI9tB,EAAQiD,EAASjD,QACjBixB,EAAKpuB,eAAeC,YAAYgB,aAAab,EAASoY,MAAMmwB,WAChEva,EAAMA,GAAUhuB,EAASoY,MAAMmwB,UAC/B,IAAIvmC,EAAQzD,SAASC,cAAc,QAGnC,GAFAwD,EAAMvD,aAAa,QAAS,uDAC5BuD,EAAMvD,aAAa,aAAc1B,GAC9BA,EAAM,CACR,IAAIwvC,EAAMhuC,SAASC,cAAc,KACjC+tC,EAAI9tC,aAAa,MAAO1B,GACxBiF,EAAMrD,YAAY4tC,GAEnB,OAAOvqC,GAGRnG,EAAOD,QAAQ,CAACsV,oB,cCdhB,SAASC,EAAgB3R,IACzB2R,EAAgBzT,UAAUktB,OAAS,SAAS5qB,EAAU6qB,GACrD,IAAI9tB,EAAQiD,EAASjD,QACjBixB,EAAKpuB,eAAeC,YAAYgB,aAAab,EAASoY,MAAMmwB,WAEhE,GAAS,qBADTva,EAAMA,GAAUhuB,EAASoY,MAAMmwB,WACH,CAC3B,IAAIvmC,EAAQzD,SAASC,cAAc,YAMnC,OALAwD,EAAMvD,aAAa,QAAS,0DAC5BuD,EAAMjF,MAAQA,EACdiF,EAAMnD,iBAAiB,UAAU,WAChCmB,EAASquB,IAAIvvB,KAAK/B,UAEZiF,EAER,OAAO,GAGRnG,EAAOD,QAAQ,CAACuV,oB,cCnBhB,SAASC,EAAe5R,GACvBV,KAAKoM,IAAM,wDAA2D1L,GAAWA,EAAQ0L,IAAQ1L,EAAQ0L,IAAM,IAGhHkG,EAAe1T,UAAUktB,OAAS,SAAS5qB,EAAU6qB,GACpD,IAAI9tB,EAAQiD,EAASjD,QACjBiF,EAAQzD,SAASC,cAAc,QAInC,GAHAwD,EAAMvD,aAAa,QAASK,KAAKoM,KACjClJ,EAAMvD,aAAa,OAAQ,IAC3BuD,EAAMvD,aAAa,aAAc1B,GAC9BA,EAAM,CACR,IAAIwS,EAAIhR,SAASC,cAAc,KAC/B+Q,EAAE9Q,aAAa,OAAQ1B,GACvBwS,EAAE5Q,YAAYJ,SAASK,eAAe7B,IACtCiF,EAAMrD,YAAY4Q,GAEnB,OAAOvN,GAGRnG,EAAOD,QAAQ,CAACwV,mB,cCnBhB,SAASC,EAAiB7R,GACzBV,KAAK0tC,QAAUhtC,IAAWA,EAAQgtC,QAAShtC,EAAQgtC,OAGpDn7B,EAAiB3T,UAAUktB,OAAS,SAAS5qB,EAAU6qB,GACtD,IAAI9tB,EAAQiD,EAASjD,QACR,IAAVA,IAAaA,EAAQ,KACxB,IAAIiF,EAAQzD,SAASC,cAAc,QAKnC,OAJAwD,EAAMvD,aAAa,QAAS,gDAC5BuD,EAAMvD,aAAa,aAAc1B,GACjCA,EAAS+B,KAAK0tC,OAAS5sC,eAAeC,YAAY4sC,iBAAiB1vC,GAASA,EAC5EiF,EAAMrD,YAAYJ,SAASK,eAAe7B,IACnCiF,GAGRnG,EAAOD,QAAQ,CAACyV,qB,cCfhB,SAASC,EAAgB9R,GACxBV,KAAK0tC,QAAUhtC,IAAWA,EAAQgtC,QAAShtC,EAAQgtC,OACnD1tC,KAAKoM,IAAM,wDAA2D1L,GAAWA,EAAQ0L,IAAQ1L,EAAQ0L,IAAM,IAC/GpM,KAAK4tC,aAAaltC,IAAWA,EAAQktC,YAAYltC,EAAQktC,UAG1Dp7B,EAAgB5T,UAAUktB,OAAS,SAAS5qB,EAAU6qB,GACrD,IAAI9tB,EAAQiD,EAASjD,QACjB+W,EAAOlU,eAAeC,YAAY8sC,gBAAgB5vC,EAAO+B,KAAK4tC,WAC9DtwC,EAAImC,SAASC,cAAc,QAC/BpC,EAAEqC,aAAa,QAASK,KAAKoM,KAC7B,IAAI0hC,EAAQruC,SAASC,cAAc,QACnCouC,EAAMnuC,aAAa,QAAS,6BAC5B,IAAIouC,EAAQtuC,SAASC,cAAc,QACnCquC,EAAMpuC,aAAa,QAAS,8BAC5B,IAAI6vB,EAAKxvB,KAAKguC,UAAU9sC,GAAYJ,eAAeC,YAAY4sC,iBAAiB34B,EAAK,IAAMA,EAAK,GAC5Fi5B,EAAQxuC,SAASK,eAAe0vB,GAGpC,GAFAse,EAAMjuC,YAAYouC,GAClB3wC,EAAEuC,YAAYiuC,GACI,GAAf94B,EAAK5U,OAAY,CACnB9C,EAAEuC,YAcJ,WACC,IAAIvC,EAAImC,SAASC,cAAc,QAI/B,OAHApC,EAAEqC,aAAa,QAAS,4BACxBrC,EAAEqC,aAAa,QAAS,2DACxBrC,EAAEuC,YAAYJ,SAASK,eAAe,UAC/BxC,EAnBQ4wC,IACd,IAAIC,EAAMnuC,KAAKguC,UAAU9sC,GAAYJ,eAAeC,YAAY4sC,iBAAiB34B,EAAK,IAAMA,EAAK,GAC7Fo5B,EAAS3uC,SAASK,eAAequC,GACrCJ,EAAMluC,YAAYuuC,GAClB9wC,EAAEuC,YAAYkuC,GAEf,OAAOzwC,GAgBRP,EAAOD,QAAQ,CAAC0V,oB,cC1ChB,SAASC,EAAgB/R,GACxBV,KAAK0tC,QAAUhtC,IAAWA,EAAQgtC,QAAShtC,EAAQgtC,OACnD1tC,KAAKoM,IAAM,wDAA2D1L,GAAWA,EAAQ0L,IAAQ1L,EAAQ0L,IAAM,IAC/GpM,KAAK4tC,aAAaltC,IAAWA,EAAQktC,YAAYltC,EAAQktC,UAoE1D,SAASM,IACR,IAAI5wC,EAAImC,SAASC,cAAc,QAI/B,OAHApC,EAAEqC,aAAa,QAAS,4BACxBrC,EAAEqC,aAAa,QAAS,2DACxBrC,EAAEuC,YAAYJ,SAASK,eAAe,UAC/BxC,EAtERmV,EAAgB7T,UAAUktB,OAAS,SAAS5qB,EAAU6qB,GACrD,IAAI9tB,EAAQiD,EAASjD,QACjB+W,EAAOlU,eAAeC,YAAY8sC,gBAAgB5vC,EAAO+B,KAAK4tC,WAC9DtwC,EAAImC,SAASC,cAAc,QAC/BpC,EAAEqC,aAAa,QAASK,KAAKoM,KAC7B,IAAI0hC,EAAQruC,SAASC,cAAc,QAC/BquC,EAAQtuC,SAASC,cAAc,QAC/B2uC,EAASr5B,EAAK5U,OAAS,EAAI4U,EAAK,GAAK,GACrCs5B,EAASt5B,EAAK5U,OAAS,EAAI4U,EAAK,GAAK,GACrCu5B,EAAU9uC,SAASC,cAAc,SACrC6uC,EAAQ5uC,aAAa,OAAQ,QAC7B4uC,EAAQ5uC,aAAa,OAAQ,IAC1B0uC,IACFE,EAAQtwC,MAAQowC,GAEjB,IAAIG,EAAW/uC,SAASC,cAAc,SACtC8uC,EAAS7uC,aAAa,OAAQ,QAC9B6uC,EAAS7uC,aAAa,OAAQ,IAC3B2uC,IACFtuC,KAAKyuC,eAAgB,EACrBD,EAASvwC,MAAQqwC,GAElBR,EAAMjuC,YAAY0uC,GAClBjxC,EAAEuC,YAAYiuC,GACX9tC,KAAKyuC,gBACPV,EAAMluC,YAAYquC,KAClBH,EAAMluC,YAAY2uC,IAEnBlxC,EAAEuC,YAAYkuC,GACd,IAAIW,EAAMjvC,SAASC,cAAc,UACjCgvC,EAAI/uC,aAAa,QAAS,yBAC1B,IAAIkE,EAAM7D,KAAKyuC,cAAgB,yBAA2B,4BAC1DC,EAAI7uC,YAAYJ,SAASK,eAAe+D,IACxCvG,EAAEuC,YAAY6uC,GACd,IAAI3kC,EAAO/J,KACX0uC,EAAI3uC,iBAAiB,SAAS,WAC1BgK,EAAK0kC,eACP1kC,EAAK0kC,eAAgB,EACrBD,EAASvwC,MAAQ,GACjB6C,eAAeC,YAAYsE,eAAe0oC,KAG1ChkC,EAAK0kC,eAAgB,EACrBD,EAASvwC,MAAQ,GACjB8vC,EAAMluC,YAAYquC,KAClBH,EAAMluC,YAAY2uC,IAEnB,IAAI3qC,EAAMkG,EAAK0kC,cAAgB,yBAA2B,4BAC1DC,EAAI1L,UAAYn/B,EAChB8qC,OAED,IAAIA,EAAgB,WAChB5kC,EAAK0kC,eAAiBD,EAASvwC,MAC9BswC,EAAQtwC,MAAOiD,EAASquB,IAAI,IAAMgf,EAAQtwC,MAAQ,IAAMuwC,EAASvwC,MAAQ,KACvEiD,EAASquB,IAAIif,EAASvwC,OAG3BiD,EAASquB,IAAIgf,EAAQtwC,QAKvB,OAFAswC,EAAQxuC,iBAAiB,SAAU4uC,GACnCH,EAASzuC,iBAAiB,SAAU4uC,GAC7BrxC,GAWRP,EAAOD,QAAQ,CAAC2V,oB,cC/EhB,SAASC,EAAmBhS,GAC3BV,KAAKoM,IAAQ1L,GAAWA,EAAQ0L,IAAO,iBAAmB1L,EAAQ0L,IAAM,gBAGzEsG,EAAmB9T,UAAUktB,OAAS,SAAS5qB,EAAU6qB,GACxD,IAAI1B,EAAMnpB,EAASjD,QACfiF,EAAQzD,SAASC,cAAc,QAInC,OAHAwD,EAAMvD,aAAa,QAASK,KAAKoM,KACjClJ,EAAMvD,aAAa,aAAc0qB,GACjCnnB,EAAMjD,UAAYoqB,EACXnnB,GAGRnG,EAAOD,QAAQ,CAAC4V,uB,gBCbhB,IAAMyZ,EAAkBltB,EAAQ,IAEhC,SAAS0T,EAAgBjS,IAEzBiS,EAAgB/T,UAAUktB,OAAS,SAAS5qB,EAAU6qB,GACrD,IAAI9tB,EAAQiD,EAASjD,QACjBixB,EAAKpuB,eAAeC,YAAYgB,aAAab,EAASoY,MAAMmwB,WAChEva,EAAMA,GAAUhuB,EAASoY,MAAMmwB,UAC/B,IAAImF,EAAenvC,SAASC,cAAc,OAC1CkvC,EAAajvC,aAAa,QAAS,2BACnC,IACIkvC,EAAU,IAAI1iB,EACdiC,EAAMygB,EAAQpf,QAAQmf,EAAc1tC,EAAUjD,EAAOixB,GAuBtD,MAtBS,kBAANA,EACF7gB,OAAOC,KAAKwhB,MAAMT,YAAYjB,EAAK,SAAS,SAAS0B,GACpD,IAAIb,EAAWa,EAAMgf,OACjBC,EAAM,IAAM9f,EAAStB,MAAQ,IAAMsB,EAASrB,MAAQ,IACxD1sB,EAASquB,IAAIwf,GACVF,EAAQ9f,eACR,IAAItiB,EAAO,CACbwiB,SAAUA,EACVb,IAAKA,GAEFe,EAAS,IAAI9gB,OAAOC,KAAK8gB,OAAO3iB,GACpCoiC,EAAQviB,QAAQrhB,KAAKkkB,MAItB9gB,OAAOC,KAAKwhB,MAAMT,YAAYjB,EAAK,SAAS,SAAS0B,GACjD,IAAIkf,EAAOH,EAAQxiB,SAASiB,UAC5B0hB,EAAK/jC,KAAK6kB,EAAMgf,QACd,IAAI7f,EAAWa,EAAMgf,OACrBD,EAAQ7f,UAAUC,EAAUb,EAAKltB,EAAU,IAAM8tC,EAAKxhB,YAAa0B,MAGnE0f,GAGX7xC,EAAOD,QAAQ,CAAC6V,oB,gBCtChB,IAAMwZ,EAAkBltB,EAAQ,IAEhC,SAAS2T,EAAgBlS,IAEzBkS,EAAgBhU,UAAUktB,OAAS,SAAS5qB,EAAU6qB,GACrD,IAAI9tB,EAAQiD,EAASjD,QACjBixB,EAAKpuB,eAAeC,YAAYgB,aAAab,EAASoY,MAAMmwB,WAChEva,EAAMA,GAAUhuB,EAASoY,MAAMmwB,UAC9B,IAAIrb,EAAM3uB,SAASC,cAAc,OAClC0uB,EAAIzuB,aAAa,QAAS,2BAIvB,OAFW,IAAIwsB,GACVsD,QAAQrB,EAAKltB,EAAUjD,EAAOixB,GAC5Bd,GAGXrxB,EAAOD,QAAQ,CAAC8V,oB,cChBhB,SAASC,EAAiBnS,IAC1BmS,EAAiBjU,UAAUktB,OAAS,SAAS5qB,EAAU6qB,GACtD,IAAI9tB,EAAQiD,EAASjD,QACjBixB,EAAKpuB,eAAeC,YAAYgB,aAAab,EAASoY,MAAMmwB,WAChEva,EAAMA,GAAUhuB,EAASoY,MAAMmwB,UAC/B,IAAIvmC,EAAQzD,SAASC,cAAc,OACnCwD,EAAMvD,aAAa,QAAS,gBAC5B,IAAIsvC,EAAQxvC,SAASC,cAAc,QAInC,GAHAuvC,EAAMtvC,aAAa,QAAS,8BAC5BsvC,EAAMhvC,UAAUhC,EAChBiF,EAAMrD,YAAYovC,GACC,oBAATlhC,MAAqB,CAC9B,IAAImhC,EAAQ,IAAInhC,MAAMkhC,EAAO,CAAEhM,MAAO,SACtCiM,EAAMjrB,GAAG,eAAe,WACvB/iB,EAASquB,IAAI2f,EAAM10B,KAAKva,cAG1B,OAAOiD,GAGRnG,EAAOD,QAAQ,CAAC+V,qB,cCpBhB,SAASC,EAAepS,IAExBoS,EAAelU,UAAUktB,OAAS,SAAS5qB,EAAU6qB,GACpD,IAAI9tB,EAAQiD,EAASjD,QACjB0c,EAAMzZ,EAASoY,MAAMhC,MAErB6wB,GADQjnC,EAASquB,IACXruB,EAASknC,iBACf+G,EAAO,IAAI1a,wBAAwB0T,EAAIvkC,GAAI+W,EAAK1c,GAMpD,OALAkxC,EAAKz0B,OAAS,SAAS2P,GACtBnpB,EAASquB,IAAIlF,IAEd8kB,EAAK5uC,KAAO,QACA4uC,EAAKh+B,YAKlBpU,EAAOD,QAAQ,CAACgW,mB,gBCjBW7T,EAAQ,IACdA,EAAQ,GAD7B,IAEM0zB,EAAiB1zB,EAAQ,IAE/B,SAASikC,EAAckM,EAAW33B,EAAOxB,EAAQvV,GAChDV,KAAKsZ,MAAQ81B,EACbpvC,KAAKyX,MAAQA,EACbzX,KAAKiW,OAASA,EACdjW,KAAKqvC,cAAgBrvC,KAAK/B,QAC1B+B,KAAKma,cAAgB,QACrBna,KAAKU,QAAUV,KAAK62B,WAAWn2B,GAGhCwiC,EAActkC,UAAU4Y,MAAQ,WAAW,QAAQxX,KAAKiW,QAASjW,KAAKiW,OAAOuB,SAC7E0rB,EAActkC,UAAUD,SAAW,WAAY,QAAQqB,KAAKiW,QAASjW,KAAKiW,OAAOtX,YACjFukC,EAActkC,UAAUwY,QAAU,WAAY,QAAQpX,KAAKiW,QAASjW,KAAKiW,OAAOmB,WAChF8rB,EAActkC,UAAUyY,aAAe,WAAY,QAAQrX,KAAKiW,QAASjW,KAAKiW,OAAOoB,gBACrF6rB,EAActkC,UAAUO,KAAO,WAAY,QAAQa,KAAKsZ,OAAQtZ,KAAKsZ,MAAMhC,OAC3E4rB,EAActkC,UAAU0Y,MAAQ,WAAY,QAAQtX,KAAKsZ,OAAQtZ,KAAKsZ,MAAMhC,OAC5E4rB,EAActkC,UAAUX,MAAQ,WAAY,QAAQ+B,KAAKsZ,OAAQtZ,KAAKsZ,MAAMzb,OAC5EqlC,EAActkC,UAAU0wC,WAAa,WAAY,QAAQtvC,KAAKsZ,OAAQtZ,KAAKsZ,MAAMg2B,cACjFpM,EAActkC,UAAU4sB,cAAgB,WAAY,OAAOxrB,KAAK0W,YAEhEwsB,EAActkC,UAAU6oC,KAAO,SAAS8H,GACvC,IAAIC,EAAM,IAAItM,EAAcqM,GAAI,EAAOvvC,KAAKiW,OAAQjW,KAAKU,SAGzD,OAFA8uC,EAAIrxC,KAAO6B,KAAK7B,KAChBqxC,EAAIjvC,KAAOP,KAAKO,KACTivC,GAGRtM,EAActkC,UAAU0rB,SAAW,SAASlU,GAC3CpW,KAAKoW,MAAQA,EACbpW,KAAKiW,OAAOlF,UAGbmyB,EAActkC,UAAUynC,kBAAoB,SAASmC,GACvC,QAAVA,GAAkBxoC,KAAKsqB,SAAS,QACtB,aAAVke,GAAuBxoC,KAAKsqB,SAAS,QAC3B,QAAVke,GAAkBxoC,KAAKsqB,SAAS,UACtB,WAAVke,GAAqBxoC,KAAKsqB,SAAS,SAGvC4Y,EAActkC,UAAU0X,gBAAkB,WACzC,MAAiC,QAA9BtW,KAAKiW,OAAOmU,gBAA0D,aAA9BpqB,KAAKiW,OAAOmU,eAC/C,OAED,UAGR8Y,EAActkC,UAAUqrB,mBAAqB,WAC5C,OAAOvsB,OAAOob,OAAO9Y,KAAKkW,SAG3BgtB,EAActkC,UAAUuX,iBAAmB,WA4B1C,MA3BW,CACVmwB,KAAM,CACLjnC,MAAO,YAAapB,MAAO,OAC3BuY,SAAU,CAAC,QAAS,OAAQ,cAAe,OAAQ,SAAU,QAAS,SAAU,WAChFC,SAAU,CAAC,SAAU,QAAS,MAAO,QAAS,SAAU,SAAU,OAAQ,OAAQ,SAEnFyW,KAAM,CACL7tB,MAAO,cAAepB,MAAO,OAC7BuY,SAAU,CAAC,QAAS,OAAQ,cAAe,OAAQ,SAAU,QAAS,SAAU,WAChFC,SAAU,CAAC,SAAU,QAAS,MAAO,QAAS,SAAU,SAAU,OAAQ,OAAQ,SAEnFg5B,OAAQ,CACPpwC,MAAO,SAAUpB,MAAO,SACxBuY,SAAU,CAAC,QAAS,OAAQ,cAAe,OAAQ,SAAU,QAAS,SAAU,WAChFC,SAAU,CAAC,SAAU,QAAS,MAAO,QAAS,SAAU,SAAU,OAAQ,OAAQ,SAEnFpX,MAAO,CACNA,MAAO,QAASpB,MAAO,QACvBuY,SAAU,CAAC,QAAS,SAAU,QAC9BC,SAAU,IAEXhW,KAAM,CACLpB,MAAO,UAAWpB,MAAO,OACzBuY,SAAU,CAAC,QAAS,WACpBC,SAAU,MAMbysB,EAActkC,UAAUwrB,aAAe,WACtC,OAAOpqB,KAAKoW,OAGb8sB,EAActkC,UAAUi4B,WAAa,SAASn2B,GAC7C,OAAOmjC,kBAAkB9wB,aAAa+wB,iBAAiBpjC,EAASV,OAGjEkjC,EAActkC,UAAUsnC,qBAAuB,WAC9C,OAAOlmC,KAAKmmC,wBAGbjD,EAActkC,UAAUwC,QAAU,SAASjD,GAC1C6B,KAAK7B,KAAOA,EACZ6B,KAAKU,QAAQvC,KAAOA,EACpB6B,KAAK0W,YAAa,EAClB1W,KAAK+Q,UAGNmyB,EAActkC,UAAU+nC,QAAU,SAASpmC,GAC1CP,KAAKO,KAAOA,EACZP,KAAKU,QAAQH,KAAOA,EACpBP,KAAK+Q,UAGNmyB,EAActkC,UAAU8wC,UAAY,SAASj/B,EAAGyuB,GAC/C,GAAGl/B,KAAKiW,QAAUjW,KAAKiW,OAAOA,SAC1BrN,OAAS5I,KAAKiW,OAAOA,OAAO4L,aAE9B,OADajZ,OAAOW,QAAUkH,EAAI,IAAMyuB,EAI1C,OAAO,GAGRgE,EAActkC,UAAUijB,UAAY,WACnC,SAAG7hB,KAAKiW,SAAUjW,KAAKiW,OAAOA,SACtBjW,KAAKiW,OAAOA,OAAO4L,aAK5BqhB,EAActkC,UAAUwpC,cAAgB,WACvC,SAAGpoC,KAAKiW,SAAUjW,KAAKiW,OAAOA,SACtBjW,KAAKiW,OAAOA,OAAOmyB,iBAK5BlF,EAActkC,UAAU+wC,MAAQ,WAC/B,SAAG3vC,KAAKiW,QAAUjW,KAAKiW,OAAOA,SAC1BrN,OAAS5I,KAAKiW,OAAOA,OAAO4L,eACvBjZ,OAAOW,SAMjB25B,EAActkC,UAAUgxC,mBAAqB,SAASpuC,EAAKmZ,EAAKk1B,EAAUrjC,GACzE,GAAGxM,KAAKiW,QAAUjW,KAAKiW,OAAOA,SAC1BrN,OAAS5I,KAAKiW,OAAOA,OAAO4L,aAC9B,OAAOjZ,OAAOgnC,mBAAmBpuC,EAAKmZ,EAAKk1B,EAAUrjC,IAKxD02B,EAActkC,UAAUwrC,QAAU,SAAS0F,GAC1Cx7B,MAAM,YAAcw7B,IAGrB5M,EAActkC,UAAU4mC,OAAS,WAChCxlC,KAAK+vC,WAAY,GAGlB7M,EAActkC,UAAU0C,MAAQ,WAC/B,QAAGtB,KAAK+vC,WAGD/vC,KAAKiW,OAAO3U,SAIpB4hC,EAActkC,UAAUma,UAAY,WACnC,OAAG/Y,KAAKsZ,MAAMzb,OAASmC,KAAKqvC,eAM7BnM,EAActkC,UAAUqqB,WAAa,WACpC,IAAI6d,EAAM,CAAEpvB,OAAQ,MACjB1X,KAAKsB,QAASwlC,EAAIpvB,OAAS,MACtB1X,KAAK+Y,cAAa+tB,EAAIpvB,OAAS,WACvC,IAAI2S,EAAMrqB,KAAKsZ,MAAMzb,MAYrB,OAXGwsB,EACCA,EAAIjqB,QAAUiqB,EAAIjqB,OAASJ,KAAKgwC,oBAClClJ,EAAG,KAAQzc,EAAI9nB,UAAU,EAAGvC,KAAKgwC,qBAAuB,QAAe3lB,EAAIjqB,OAAS,eAGpF0mC,EAAG,KAAQzc,EAIZyc,EAAG,KAAQ,QAELA,GAGR5D,EAActkC,UAAUqsB,kBAAoB,SAASzlB,GACpD,GAAGxF,KAAKiW,OAAOqtB,OAAO4B,iBAAiB,CACtC,IAAIa,EAAO/lC,KAAKiW,OAAOqtB,OAAO5R,YAC1BsU,EAAahmC,KAAKiW,OAAO6C,OAAO1Y,OACpC,IAAa,OAAVoF,GAA6B,SAAVA,IAClBugC,EAAKlU,KAAOmU,GAAcD,EAAKlU,IACjC,OAAO,EAGT,GAAa,UAAVrsB,GAAuBugC,EAAKnU,KAAOoU,GAAcD,EAAKnU,IACxD,OAAO,EAGT,OAAO,GAGRsR,EAActkC,UAAU2wB,IAAM,SAAS0gB,GACtCjwC,KAAKsZ,MAAMiW,IAAI0gB,GACfjwC,KAAKoU,OAAO+S,eACZnnB,KAAKiW,OAAOgvB,gBAGb/B,EAActkC,UAAd,OAAiC,WAChCoB,KAAKiW,OAAO2vB,oBAAoB5lC,KAAK/B,QAAS+B,KAAKyX,OACnDzX,KAAKiW,OAAOA,OAAOlF,UAGpBmyB,EAActkC,UAAU+0B,KAAO,SAASF,GACvCzzB,KAAKiW,OAAO0d,KAAKF,IAGlByP,EAActkC,UAAU8sB,KAAO,WAC9B1rB,KAAK2mC,QAAQ,WAGdzD,EAActkC,UAAU+sB,KAAO,WAC9B3rB,KAAK2mC,QAAQ,SAGdzD,EAActkC,UAAU2C,OAAS,WAChCvB,KAAKsrB,QACLtrB,KAAKoB,QAAQ,SAGd8hC,EAActkC,UAAUgtB,KAAO,WAC3B5rB,KAAKiW,QACPjW,KAAKiW,OAAO2V,QAIdsX,EAActkC,UAAU0sB,MAAQ,WAC/BtrB,KAAKuvB,IAAIvvB,KAAKqvC,eACdrvC,KAAK+Q,UAGNmyB,EAActkC,UAAUysB,MAAQ,WAC/B,IAAIqa,EAAO1lC,KAAKiW,OAAO6vB,iBAAiB9lC,KAAK/B,SACzCiyC,EAAQlwC,KAAKynC,KAAK/B,GACtBwK,EAAM1K,SACN0K,EAAM/xC,KAAO,OACb+xC,EAAMz4B,MAAQzX,KAAKiW,OAAO6C,OAAO1Y,OACjCJ,KAAKiW,OAAO6C,OAAO7N,KAAKilC,GACxBlwC,KAAKiW,OAAOgvB,eACZjlC,KAAKiW,OAAOlF,SACZ/Q,KAAKiW,OAAOwc,UAAUzyB,KAAKiW,OAAO6C,OAAO1Y,OAAO,IAGjD8iC,EAActkC,UAAUuxC,kBAAoB,WAC3C,OAAO,IAAIxd,EAAeA,eAAe3yB,OAG1CkjC,EAActkC,UAAUqoC,oBAAsB,SAAS7wB,GACtD,OAAOpW,KAAKkW,OAAOE,GAAOI,SAAS/C,OAAOzT,KAAKkW,OAAOE,GAAOK,WAG9DysB,EAActkC,UAAUqpB,YAAc,SAAShnB,GAC9C,IAAoC,GAAjCjB,KAAKwW,SAASxJ,QAAQ/L,KAAiD,GAAjCjB,KAAKyW,SAASzJ,QAAQ/L,GAC9D,OAAO,EAGR,IAAmC,GADhB,CAAC,SAAU,QAAS,OACvB+L,QAAQ/L,KACnBjB,KAAKirB,kBAAkBhqB,GAAQ,OAAO,EAG3C,QAAGjB,KAAKkmC,yBAAyD,GAD/C,CAAC,SAAU,SACiBl5B,QAAQ/L,KACjDjB,KAAK+Y,gBAIE,QAAT9X,GAAgC,UAAbjB,KAAKO,SACf,QAATU,GAAgC,UAAbjB,KAAKO,QAEK,GADrBP,KAAKinC,oBAAoBjnC,KAAKoW,OAC5BpJ,QAAQ/L,MAItBiiC,EAActkC,UAAU2iB,OAAS,SAASnN,GAEzC,OADApU,KAAKoU,OAAUA,GAAkBpU,KAAKmwC,oBAC/BnwC,KAAKoU,OAAOmN,UAGpB2hB,EAActkC,UAAU+hB,QAAU,WACjC,IAAI0J,EAAMrqB,KAAK/B,QACf,GAAW,KAARosB,IAAsB,IAARA,EAYZ,OAAOA,EAXX,GAAGrqB,KAAKsZ,MAAM82B,qBAAqB,CAClC,IAAIC,EAAS,CAAE,SAAUrwC,KAAK/B,SAI9B,OAFG+B,KAAKsZ,MAAMg3B,WAAYD,EAAO,aAAerwC,KAAKsZ,MAAMi3B,OACtDF,EAAO,SAAWrwC,KAAKb,OACrBkxC,EAEH,OAAGrwC,KAAKsZ,MAAMk3B,YAAcxwC,KAAKsZ,MAAMg2B,aACpC,CAAC,MAAOjlB,QADX,GAOP6Y,EAActkC,UAAUg0B,qBAAuB,WAC9C,OAAO,IAAID,EAAeE,sBAG3BqQ,EAActkC,UAAUy0B,mBAAqB,WAI5C,OAHIrzB,KAAK0W,aACR1W,KAAK0W,WAAa1W,KAAKywC,yBAEjB5M,kBAAkB9wB,aAAakB,UAAUjU,KAAK0W,WAAY1W,KAAK2W,gBAGvEusB,EAActkC,UAAU2sB,oBAAsB,WAC7C,IAAIzI,EAAK9iB,KAAKsZ,MAAMuxB,mBAChB6F,EAAK1wC,KAAKsZ,MAAMC,QACpB,MAAgB,QAAbvZ,KAAK7B,KACA0lC,kBAAkB9wB,aAAa8B,wBAAwBiO,EAAI4tB,GAE5D7M,kBAAkB9wB,aAAa+B,wBAAwBgO,EAAI4tB,IAGnExN,EAActkC,UAAU6sB,UAAY,SAASrX,GAC5CpU,KAAK0W,WAAatC,EAClBpU,KAAK+Q,UAGNmyB,EAActkC,UAAU6xC,sBAAwB,WAC/C,IAAI3tB,EAAK9iB,KAAKsZ,MAAMuxB,mBAChB6F,EAAK1wC,KAAKsZ,MAAMC,QACpB,MAAgB,QAAbvZ,KAAK7B,KACA0lC,kBAAkB9wB,aAAakC,sBAAsB6N,EAAI4tB,GAE1D7M,kBAAkB9wB,aAAagC,sBAAsB+N,EAAI4tB,IAGjExN,EAActkC,UAAUmS,OAAS,WAChC/Q,KAAKoU,OAAOqT,QACZznB,KAAKuhB,OAAOvhB,KAAKoU,SAOlBrX,EAAOD,QAAQomC,G,gBC7Vf,IAAMtnB,EAAoB3c,EAAQ,GAC5Bmb,EAAuBnb,EAAQ,GAC/Bw1B,EAA0Bx1B,EAAQ,IAClC0J,EAAU1J,EAAQ,GAClByc,EAAMzc,EAAQ,GAOpB,SAASq8B,EAAqB13B,GAC5B5D,KAAK4D,GAAKA,EAiQZ,SAASy1B,EAAiBz1B,GACzB5D,KAAK4D,GAAKA,EACV5D,KAAK2wC,OAAS,IAAIhoC,EAAU/E,EAAGgF,OAAQ5I,KAAKU,QAASkD,GA4HtD,SAAS21B,EAAkB31B,GAC1B5D,KAAK4D,GAAKA,EA1XX03B,EAAqB18B,UAAUuS,SAAW,WACzC,IAAIpH,EAAO/J,KACP4wC,EAAMnxC,SAASC,cAAc,OAEjC,GADAkxC,EAAIjxC,aAAa,QAAS,0BACvBK,KAAK4D,IAAM5D,KAAK4D,GAAGkb,KAAK,CAC1B,IAAI+xB,EAAMpxC,SAASC,cAAc,OACjCmxC,EAAIlxC,aAAa,QAAS,yCAC1B,IAAI6b,EAAM/b,SAASC,cAAc,QACjC8b,EAAI7b,aAAa,QAAS,iEAC1B6b,EAAI3b,YAAYJ,SAASK,eAAe,QACxC,IAAIuqB,EAAM5qB,SAASC,cAAc,QACjC2qB,EAAI1qB,aAAa,QAAS,iEAC1B,IAAImxC,EAAQ9wC,KAAK4D,GAAGgF,OAAOuvB,WAAWpB,cAClCga,EAAMD,GAASA,EAAM,eAAiBA,EAAM,cAAc,UAAYA,EAAM,cAAc,UAAY9wC,KAAK4D,GAAGkb,KAClHuL,EAAIxqB,YAAYJ,SAASK,eAAeixC,IACxCF,EAAIhxC,YAAY2b,GAChBq1B,EAAIhxC,YAAYwqB,GAEhB,IAAI7hB,EAAM/I,SAASC,cAAc,OACjC8I,EAAI7I,aAAa,QAAS,SAC1BixC,EAAI/wC,YAAY2I,GAChB,IAAIy1B,EAAKx+B,SAASC,cAAc,MAChCu+B,EAAGt+B,aAAa,QAAQ,eACxB6I,EAAI3I,YAAYo+B,IAEZxtB,EAAIhR,SAASC,cAAc,MACvBC,aAAa,QAAS,oEACxB,IA6CDqxC,EAmBAvgC,EAhEK5M,EAAM,aAAektC,EAG/B,GAFMtgC,EAAE5Q,YAAYJ,SAASK,eAAe+D,IACtCo6B,EAAGp+B,YAAY4Q,GAClBzQ,KAAK4D,GAAG0E,YAAY,OAClB0oC,EAAOhxC,KAAKixC,eAAe,gBAAiB,YAC3C7sC,UAAUI,IAAI,qBAChBwsC,EAAKjxC,iBAAiB,SAAS,WACjC2b,EAAMnT,oBAAoBvI,KAAM+J,GAChCA,EAAKnG,GAAGwgB,oBAEH6Z,EAAGp+B,YAAYmxC,GAEtB,GAAGhxC,KAAK4D,GAAG0E,YAAY,oBAClB0oC,EAAOhxC,KAAKixC,eAAe,kBAAmB,iBAC1ClxC,iBAAiB,SAAS,WACjC2b,EAAMnT,oBAAoBvI,KAAM+J,GAChCA,EAAKnG,GAAG4gB,oBAEHyZ,EAAGp+B,YAAYmxC,GAEtB,GAAGhxC,KAAK4D,GAAG0E,YAAY,gBAClB0oC,EAAOhxC,KAAKixC,eAAe,QAAS,cAChClxC,iBAAiB,SAAS,WACjC2b,EAAMnT,oBAAoBvI,KAAM+J,GAChCA,EAAKnG,GAAGwzB,mBAEH6G,EAAGp+B,YAAYmxC,GAEtB,GAAGhxC,KAAK4D,GAAG0E,YAAY,gBAClB0oC,EAAOhxC,KAAKixC,eAAe,UAAW,mBAC/BlxC,iBAAiB,SAAS,WACpC2b,EAAMnT,oBAAoBvI,KAAM+J,GAChCA,EAAKnG,GAAG41B,qBAEHyE,EAAGp+B,YAAYmxC,GAEtB,GAAGhxC,KAAK4D,GAAG0E,YAAY,eAClB0oC,EAAOhxC,KAAKixC,eAAe,SAAU,WAC9BlxC,iBAAiB,SAAS,WACpC2b,EAAMnT,oBAAoBvI,KAAM+J,GAChCA,EAAKnG,GAAGuzB,oBAEH8G,EAAGp+B,YAAYmxC,GAEtB,GAAIhxC,KAAK4D,GAAG0E,YAAY,iBAAmBtI,KAAK4D,GAAG0E,YAAY,oBAC1D0oC,EAAOhxC,KAAKixC,eAAe,WAAY,YACtC7sC,UAAUI,IAAI,yBACbwsC,EAAKjxC,iBAAiB,SAAS,WACpC2b,EAAMxX,uBAAuB,qBACjBlE,KAAKoE,UAAUI,IAAI,qBAC/BkX,EAAMrT,wBAAwB0B,EAAKnG,OAE9Bq6B,EAAGp+B,YAAYmxC,GAGtB,GAAGhxC,KAAK4D,GAAG0E,YAAY,iBAClBmI,EAAIhR,SAASC,cAAc,MAC7BC,aAAa,QAAS,kCACxB8Q,EAAE5Q,YAAYkK,EAAKmnC,yBACnBzgC,EAAErM,UAAUI,MACZy5B,EAAGp+B,YAAY4Q,GAGhB,GAAGzQ,KAAK4D,GAAG0E,YAAY,oBAClBmI,EAAIhR,SAASC,cAAc,MAC7BC,aAAa,QAAS,qCACxB8Q,EAAE5Q,YAAYkK,EAAKonC,yBACnBlT,EAAGp+B,YAAY4Q,GAGjB,OAAOmgC,GAIRtV,EAAqB18B,UAAUqyC,eAAiB,SAAS7uC,EAAMo/B,EAAIp1B,GAC/D,IACIqE,EAAIhR,SAASC,cAAc,KAClC+Q,EAAE9Q,aAAa,QAAS,qGACrB,IAAIc,EAAOhB,SAASC,cAAc,KAClCe,EAAKd,aAAa,QAAS,yBAA2B6hC,GACtD/wB,EAAE5Q,YAAYY,GACd,IAAIoD,EAAMpE,SAASK,eAAesC,GAElC,OADAqO,EAAE5Q,YAAYgE,GACP4M,GAGX6qB,EAAqB18B,UAAUsyC,sBAAwB,WACtD,IAAInnC,EAAO/J,KACP6wC,EAAMpxC,SAASC,cAAc,QACjCmxC,EAAIlxC,aAAa,QAAS,mGAC1B,IAAI6b,EAAM/b,SAASC,cAAc,QACjC8b,EAAI7b,aAAa,QAAS,yFAE1B,IAAI81B,EAAOh2B,SAASC,cAAc,SAClC+1B,EAAK91B,aAAa,QAAS,6EAC3B81B,EAAK91B,aAAa,cAAe,qBACjC,IAAIyxC,EAAO3xC,SAASC,cAAc,UAMlC,GALA0xC,EAAKzxC,aAAa,QAAS,qEAC3ByxC,EAAKvxC,YAAYJ,SAASK,eAAe,SACzCsxC,EAAKrxC,iBAAiB,SAAS,WAC3B01B,EAAKx3B,OAAO8L,EAAKnG,GAAG2a,aAAakX,EAAKx3B,UAEvC+B,KAAK4D,GAAGgF,OAAOG,iBAAiBC,oBAAsBhJ,KAAK4D,GAAGpD,gBAAgB,WAAW,CAE3F,IAAI6wC,EAAOvwC,eAAeC,YAAYqf,UAAU,gBAC5C+uB,EAAO,IAAI1a,EAAwBz0B,KAAK4D,GAAIytC,GAChDlC,EAAKz0B,OAAS,SAAS2P,GACtBtgB,EAAKnG,GAAG2a,aAAa8L,IAEtB8kB,EAAK5uC,KAAO,QACZ,IAAI6rC,EAAO+C,EAAKh+B,SAAS,yBACzBzD,OAAO+nB,GAAM/J,OACbhe,OAAO0jC,GAAM1lB,OACb,IAAI4lB,EAAO7xC,SAASC,cAAc,KAClC4xC,EAAK3xC,aAAa,OAAQ,KAC1B2xC,EAAK3xC,aAAa,QAAS,mCAC3B2xC,EAAKzxC,YAAYJ,SAASK,eAAe,iBACzC,IAAI6rB,EAAO,QACXje,OAAO4jC,GAAMC,OAAM,WACP,SAAR5lB,GACFA,EAAO,KACPje,OAAO+nB,GAAM9J,OACbje,OAAO0jC,GAAMzlB,OACbje,OAAO0+B,GAAM1gB,OACbhe,OAAO4jC,GAAMlvC,KAAK,qBAGlBupB,EAAO,QACPje,OAAO+nB,GAAM/J,OACbhe,OAAO0jC,GAAM1lB,OACbhe,OAAO0+B,GAAMzgB,OACbje,OAAO4jC,GAAMlvC,KAAK,oBAGpByuC,EAAIhxC,YAAYusC,GAChByE,EAAI9f,QAAQugB,GAEb,IAAIE,EAAQ/xC,SAASC,cAAc,QAMnC,OALA8xC,EAAM7xC,aAAa,QAAS,8DAC5B6xC,EAAM3xC,YAAYuxC,GAClBP,EAAIhxC,YAAY2b,GAChBq1B,EAAIhxC,YAAY41B,GAChBob,EAAIhxC,YAAY2xC,GACTX,GAGRvV,EAAqB18B,UAAUuyC,sBAAwB,WACtD,IAAIpnC,EAAO/J,KACP6wC,EAAMpxC,SAASC,cAAc,OACjCmxC,EAAIlxC,aAAa,QAAS,mGAE1B,IAAI81B,EAAOh2B,SAASC,cAAc,SAClC+1B,EAAK91B,aAAa,QAAS,6EAC3B81B,EAAK91B,aAAa,cAAe,uBACjC,IAAIyxC,EAAO3xC,SAASC,cAAc,UACxBD,SAASC,cAAc,QAC7BC,aAAa,QAAS,gFAE1ByxC,EAAKzxC,aAAa,QAAS,mEAC3ByxC,EAAKvxC,YAAYJ,SAASK,eAAe,WACzCsxC,EAAKrxC,iBAAiB,SAAS,WAC3B01B,EAAKx3B,OAAO8L,EAAKnG,GAAGg2B,mBAAmBnE,EAAKx3B,UAEpCwB,SAASC,cAAc,OAC7BC,aAAa,QAAS,8DAC5B,IACIoX,EADK,IAAIpO,EAAU3I,KAAK4D,GAAGgF,OAAQ,GAAI5I,KAAK4D,IAChCqG,gCAAgC,aAC5C8qB,EAAS,IAAI3a,EAAqBpa,KAAK4D,GAAImT,GAC/Cge,EAAO5Z,aAAe,0BAClBpR,EAAO/J,KACX+0B,EAAOra,OAAS,SAASsa,GACrBA,IACFjrB,EAAKnG,GAAGg2B,mBAAmB5E,GAC3BD,EAAO1a,QAAS,IAGlB,IAAIo3B,EAAQ1c,EAAO5jB,SAAS,yBAExBugC,EAAKjyC,SAASC,cAAc,OAChCgyC,EAAG/xC,aAAa,QAAS,0BACzB,IAAIgyC,EAAKlyC,SAASC,cAAc,UAChCiyC,EAAGhyC,aAAa,QAAS,qDACzBgyC,EAAG9xC,YAAaJ,SAASK,eAAe,MACxC,IAAI8xC,EAAMnyC,SAASC,cAAc,QACjCkyC,EAAIjyC,aAAa,QAAS,wBAC1BiyC,EAAI/xC,YAAYJ,SAASK,eAAe,kBACxC6xC,EAAG9xC,YAAY+xC,GACf,IAAIC,EAAKpyC,SAASC,cAAc,UAChCmyC,EAAGlyC,aAAa,QAAS,2BACzBkyC,EAAGhyC,YAAaJ,SAASK,eAAe,MACxC,IAAIgyC,EAAMryC,SAASC,cAAc,QACjCoyC,EAAInyC,aAAa,QAAS,wBAC1BmyC,EAAIjyC,YAAYJ,SAASK,eAAe,eACxC+xC,EAAGhyC,YAAYiyC,GACfJ,EAAG7xC,YAAYgyC,GACfH,EAAG7xC,YAAY8xC,GACf,IAAII,EAAQtyC,SAASC,cAAc,OACnCqyC,EAAMpyC,aAAa,QAAS,6BAC5BoyC,EAAMlyC,YAAY6xC,GAClBb,EAAIhxC,YAAYkyC,GAChB,IAAIC,EAAQvyC,SAASC,cAAc,QACnCqyC,EAAMlyC,YAAYmyC,GAClBA,EAAMryC,aAAa,QAAS,wBAC5BqyC,EAAMnyC,YAAY4xC,GAkBlB,OAhBAI,EAAG9xC,iBAAiB,SAAS,WAE5Be,eAAeC,YAAYsE,eAAe2sC,GAC1Ct2B,EAAMxX,uBAAuB,6BAC7BlE,KAAKoE,UAAUI,IAAI,6BACnBwtC,EAAMnyC,YAAY41B,GAClBuc,EAAMnyC,YAAYuxC,MAGnBO,EAAG5xC,iBAAiB,SAAS,WAE5Be,eAAeC,YAAYsE,eAAe2sC,GAC1Ct2B,EAAMxX,uBAAuB,6BAC7BlE,KAAKoE,UAAUI,IAAI,6BACnBwtC,EAAMnyC,YAAY4xC,MAEZZ,GAQRxX,EAAiBz6B,UAAUuS,SAAW,SAASxQ,GAC9C,IAAIm7B,EAAKr8B,SAASC,cAAc,QAChCo8B,EAAGn8B,aAAa,QAAS,yBACzB,IAAIsyC,EAAMxyC,SAASC,cAAc,OAC7BwyC,EAASzyC,SAASC,cAAc,OAEpCwyC,EAAOvyC,aAAa,QAAS,mBAC7B,IAAIwyC,EAAM1yC,SAASC,cAAc,QACjCyyC,EAAIxyC,aAAa,QAAS,yBAC1BwyC,EAAItyC,YAAYJ,SAASK,eAAe,oBACxCmyC,EAAIpyC,YAAYsyC,GAChB,IAAItB,EAAMpxC,SAASC,cAAc,QACjCmxC,EAAIlxC,aAAa,QAAS,uBAC1B,IAAIyyC,EAAM3yC,SAASC,cAAc,QACjC0yC,EAAIzyC,aAAa,QAAS,8BAC1B,IAAImxC,EAAQ9wC,KAAK4D,GAAGmzB,cACpB,GAAG+Z,EAAM,CACR,IAAIC,EAAMD,EAAM,eAAiBA,EAAM,cAAc,UAAYA,EAAM,cAAc,UAAY9wC,KAAK8e,GACtGszB,EAAIvyC,YAAYJ,SAASK,eAAeixC,IACxCqB,EAAIzyC,aAAa,QAAS,yBAW3B,OATAkxC,EAAIhxC,YAAYuyC,GAChBH,EAAIpyC,YAAYgxC,GAChBqB,EAAOryC,YAAYoyC,GAGnBjyC,KAAKqyC,oBAAoBvW,GAEzBA,EAAGj8B,YAAYi8B,EAAGj8B,YAAY6b,EAAMlY,aAAa,uBACjDxD,KAAKsyC,cAAcxW,GACZA,GAGRzC,EAAiBz6B,UAAU2zC,aAAe,SAASz0C,EAAGf,GACrD,IAAI8pB,EAAKpnB,SAASC,cAAc,QAC7BmnB,EAAGlnB,aAAa,QAAS,wBAC5B,IAAI6yC,EAAO/yC,SAASC,cAAc,OAClC8yC,EAAK3yC,YAAYJ,SAASK,eAAe/C,EAAO01C,OAAO,GAAGC,cAAgB31C,EAAO41C,MAAM,KACvFH,EAAK7yC,aAAa,QAAS,oBAC3BknB,EAAGhnB,YAAY2yC,GAEZ,IAAIx1C,EAAIyC,SAASC,cAAc,KAClC,OAAO3C,GACN,IAAK,OACJC,EAAE2C,aAAa,QAAS,qCACrB,IAAIkE,EAAMpE,SAASK,eAAe,QACtC,MACA,IAAK,UACJ9C,EAAE2C,aAAa,QAAS,gCACjBkE,EAAMpE,SAASK,eAAe,gBACtC,MACA,IAAK,WACJ9C,EAAE2C,aAAa,QAAS,6BACjBkE,EAAMpE,SAASK,eAAe,eAGpC+mB,EAAGhnB,YAAY7C,GACf6G,GAAKgjB,EAAGhnB,YAAYgE,GACpB/F,EAAE+B,YAAYgnB,IAGlBwS,EAAiBz6B,UAAUyzC,oBAAsB,SAAS/0C,GAEzD,GAAmB,YAAhB0C,KAAK4D,GAAGkb,KAAX,CACG,IAAI8zB,EAAMnzC,SAASC,cAAc,UACjCkzC,EAAIjzC,aAAa,QAAS,2DAC1BizC,EAAIjzC,aAAa,OAAQ,UACzBizC,EAAI3yC,UAAY,kBACnB,IAAI6wC,EAAQ9wC,KAAK4D,GAAGmzB,cACpB,GAAG+Z,EACQA,EAAM,eAAiBA,EAAM,cAAc,UAAYA,EAAM,cAAc,UAAY9wC,KAAK4D,GAAGkb,KACvG,IAAI/U,EAAO/J,KACP6yC,EAAQ7yC,KAAK4D,GAAGkb,KAEpB8zB,EAAI7yC,iBAAiB,SAAS,WAEX,GADI+yC,QAAQ,yBAAD,OAA0BD,EAA1B,gBAE/B9oC,EAAKnG,GAAG4gB,eAAequB,MAGtBv1C,EAAEuC,YAAY+yC,KAGlBvZ,EAAiBz6B,UAAUm0C,aAAe,SAASz1C,GAC/C,IAAIQ,EAAI2B,SAASC,cAAc,QAC/B5B,EAAE6B,aAAa,QAAS,gCACxBrC,EAAEuC,YAAY/B,GAGdkC,KAAKuyC,aAAaz0C,EAAG,QACrBkC,KAAKuyC,aAAaz0C,EAAG,WACrBkC,KAAKuyC,aAAaz0C,EAAG,aAGzBu7B,EAAiBz6B,UAAU0zC,cAAgB,SAASh1C,GACnD,IAAI01C,EAAIhzC,KAAK2wC,OAAO7kC,kBAChB/B,EAAO/J,KAqBX,OApBAA,KAAK2wC,OAAO9mC,QAAQmpC,GACnBhtC,MAAK,SAASe,GAEd,GADAgD,EAAKhD,OAAS,IAAI6U,EAAkBA,kBAAkB7R,EAAKnG,GAAImD,EAAQgD,EAAK4mC,OAAQ,GAAI,IAAI,GACzF5mC,EAAKhD,OAAO,CACd,IAAIk0B,EAAKlxB,EAAKhD,OAAOoK,SAAS7T,GAAG,GAC9B29B,EACFA,EAAGt7B,aAAa,QAAS,wBAGzBqd,IAAMvd,SAASC,cAAc,OAC7Bsd,IAAIrd,aAAa,QAAS,yBAC1Bqd,IAAInd,YAAYJ,SAASK,eAAe,+DACxCxC,EAAEuC,YAAYmd,UAZjB,OAgBO,SAAS0H,GACfhW,QAAQoR,MAAM4E,GACd3a,EAAKnG,GAAGmc,UAAU2E,MAEZpnB,GAQRi8B,EAAkB36B,UAAUuS,SAAW,SAASxQ,GAC/C,IAAIkwC,EAAMpxC,SAASC,cAAc,OAKjCmxC,EAAIlxC,aAAa,QAAS,uBAC1B,IAAIszC,EAAMxzC,SAASC,cAAc,MACjCuzC,EAAItzC,aAAa,QAAS,kDAC1BszC,EAAIpzC,YAAYJ,SAASK,eAAe,wBACxC+wC,EAAIhxC,YAAYozC,GAChB,IAAIC,EAAMzzC,SAASC,cAAc,OACjCwzC,EAAIvzC,aAAa,QAAS,wBAC1BkxC,EAAIhxC,YAAYqzC,IACZC,EAAM1zC,SAASC,cAAc,QAC7BC,aAAa,QAAS,oGACtB2sC,EAAO7sC,SAASC,cAAc,SAC7BC,aAAa,QAAS,gEAC3B2sC,EAAKzsC,YAAYJ,SAASK,eAAe,OACzCqzC,EAAItzC,YAAYysC,GAChB,IAAI8G,EAAO3zC,SAASC,cAAc,SAClC0zC,EAAKzzC,aAAa,OAAQ,QAC1ByzC,EAAKzzC,aAAa,QAAS,2CAC3ByzC,EAAKzzC,aAAa,cAAe,kDACjCwzC,EAAItzC,YAAYuzC,GAChBF,EAAIrzC,YAAYszC,IACZA,EAAM1zC,SAASC,cAAc,QAC7BC,aAAa,QAAS,oGACtB2sC,EAAO7sC,SAASC,cAAc,SAC7BC,aAAa,QAAS,mEAC3B2sC,EAAKzsC,YAAYJ,SAASK,eAAe,UACzC,IAAIuzC,EAAQ5zC,SAASC,cAAc,SACnC2zC,EAAM1zC,aAAa,OAAQ,QAC3B0zC,EAAM1zC,aAAa,cAAe,kCAClC0zC,EAAM1zC,aAAa,QAAS,2CAC5BwzC,EAAItzC,YAAYysC,GAChB6G,EAAItzC,YAAYwzC,GAChBH,EAAIrzC,YAAYszC,IACZA,EAAM1zC,SAASC,cAAc,QAC7BC,aAAa,QAAS,oGACtB2sC,EAAO7sC,SAASC,cAAc,SAC7BC,aAAa,QAAS,mEAC3B2sC,EAAKzsC,YAAYJ,SAASK,eAAe,gBACzCqzC,EAAItzC,YAAYysC,GAChB,IAAIgH,EAAS7zC,SAASC,cAAc,YACpC4zC,EAAO3zC,aAAa,QAAS,gEAC7B2zC,EAAO3zC,aAAa,cAAe,wDACnCwzC,EAAItzC,YAAYyzC,GAChBJ,EAAIrzC,YAAYszC,IACZA,EAAM1zC,SAASC,cAAc,QAC7BC,aAAa,QAAS,oGACtB2sC,EAAO7sC,SAASC,cAAc,SAC7BC,aAAa,QAAS,oEAC3B2sC,EAAKzsC,YAAYJ,SAASK,eAAe,kBACzCqzC,EAAItzC,YAAYysC,GAChB,IAOI6G,EAEA7G,EATAiH,EAAQ9zC,SAASC,cAAc,SACnC6zC,EAAM5zC,aAAa,cAAe,mBAClC4zC,EAAM5zC,aAAa,OAAQ,QAC3B4zC,EAAM5zC,aAAa,QAAS,6DAE5BwzC,EAAItzC,YAAY0zC,GAChBL,EAAIrzC,YAAYszC,IACZA,EAAM1zC,SAASC,cAAc,QAC7BC,aAAa,QAAS,oGACtB2sC,EAAO7sC,SAASC,cAAc,SAC7BC,aAAa,QAAS,kEAC3B2sC,EAAKzsC,YAAYJ,SAASK,eAAe,gBACzCqzC,EAAItzC,YAAYysC,GAChB,IAAIkH,EAAQ/zC,SAASC,cAAc,SACnC8zC,EAAM7zC,aAAa,OAAQ,QAC3B6zC,EAAM7zC,aAAa,cAAe,mBAClC6zC,EAAM7zC,aAAa,QAAS,6DAC5BwzC,EAAItzC,YAAY2zC,GAEhB,IAAIC,EAAWh0C,SAASC,cAAc,OACtC+zC,EAAS9zC,aAAa,QAAS,4BAC/B,IAAI+zC,EAAUj0C,SAASC,cAAc,UACrCg0C,EAAQ/zC,aAAa,QAAS,kEAC9B+zC,EAAQ7zC,YAAYJ,SAASK,eAAe,WAC5C,IAAI6zC,EAAUl0C,SAASC,cAAc,UACrCi0C,EAAQh0C,aAAa,QAAS,kEAC9Bg0C,EAAQ9zC,YAAYJ,SAASK,eAAe,WAC5C,IAUIiK,EAAO/J,KAYX,OAXA2zC,EAAQ5zC,iBAAiB,SAAS,WACjC,IAAImD,EAXW,WACf,IAAIA,EAAQ,GAMZ,OALAA,EAAM2I,GAAKunC,EAAKn1C,MAChBiF,EAAMgE,MAAQmsC,EAAMp1C,MACpBiF,EAAMiE,YAAcmsC,EAAOr1C,MAC3BiF,EAAMg0B,OAASqc,EAAMt1C,MACrBiF,EAAMgD,KAAOstC,EAAMv1C,MACZiF,EAIK28B,GACZ91B,EAAKnG,GAAG2zB,eAAer0B,MAExBwwC,EAAQ3zC,iBAAiB,SAAS,WACjCgK,EAAKnG,GAAG0zB,wBAETmc,EAAS5zC,YAAY6zC,GACrBD,EAAS5zC,YAAY8zC,GACrBT,EAAIrzC,YAAY4zC,GAET5C,GAER9zC,EAAOD,QAAQ,CAACu8B,iBAAiBA,EACpBiC,qBAAqBA,EACrB/B,kBAAkBA,I,cC/f/B,SAASjD,EAAmB8F,EAAMx4B,GACjC5D,KAAK4D,GAAKA,EACV5D,KAAKo8B,KAAO,GAEZ,IADA,IAAIC,EAAQ,GACJr/B,EAAI,EAAGA,EAAEo/B,EAAKh8B,OAAQpD,IAAI,CACjC,IAAI,IAAI6b,EAAI,EAAGA,EAAEwjB,EAAMj8B,OAAQyY,IAC3B1S,KAAKC,UAAUg2B,EAAKp/B,IAAOmJ,KAAKC,UAAUi2B,EAAMxjB,IAEpDwjB,EAAMpxB,KAAKmxB,EAAKp/B,IAEjB,IAAQA,EAAI,EAAGA,EAAEq/B,EAAMj8B,OAAQpD,IAC9BgD,KAAKo8B,KAAKnxB,KAAK,IAAI2oC,EAAkBvX,EAAMr/B,GAAIgD,KAAK4D,KAsBtD,SAASgwC,EAAkBC,EAAKjwC,GAC/B5D,KAAK4D,GAAKA,EACV5D,KAAK6zC,IAAMA,EApBZvd,EAAmB13B,UAAUuS,SAAW,SAAS2iC,GAChD,IAAI1gB,EAAO3zB,SAASC,cAAc,OAClC0zB,EAAKzzB,aAAa,QAAS,6CAC3B,IAAIo0C,EAAat0C,SAASC,cAAc,OACxCq0C,EAAWp0C,aAAa,QAAS,+BACjCyzB,EAAKvzB,YAAYk0C,GACjB,IAAIvtC,EAAMxG,KAAKo8B,KAAKh8B,QAAUJ,KAAKo8B,KAAKh8B,OAAS,EAAI,uBAAyB,uBAC3E0zC,IAAattC,GAAO,IAAMstC,GAC7BC,EAAWl0C,YAAYJ,SAASK,eAAe0G,IAC/C,IAAI,IAAIxJ,EAAI,EAAGA,EAAEgD,KAAKo8B,KAAKh8B,OAAQpD,IAClCo2B,EAAKvzB,YAAYG,KAAKo8B,KAAKp/B,GAAGmU,YAE/B,OAAOiiB,GAWRwgB,EAAkBh1C,UAAUuS,SAAW,WACtC,IAAIiiB,EAAO3zB,SAASC,cAAc,OAElC,GADA0zB,EAAKzzB,aAAa,QAAS,sBACxBK,KAAK6zC,IAAI,SAAS,CACpB,IAAIrtC,EAAMxG,KAAK6zC,IAAI,gBAAkB,CAAC,SAAU,IAChDzgB,EAAKvzB,YAAYG,KAAKg0C,iBAAiBh0C,KAAK6zC,IAAI,SAAUrtC,IAE3D,IAAI,IAAItE,KAAQlC,KAAK6zC,IACT,eAAR3xC,GAAiC,SAARA,GAC3BkxB,EAAKvzB,YAAYG,KAAKg0C,iBAAiB9xC,EAAMlC,KAAK6zC,IAAI3xC,KAGxD,OAAOkxB,GAGRwgB,EAAkBh1C,UAAUo1C,iBAAmB,SAAS9xC,EAAMmoB,GAC7D,IAAI4pB,EAAOx0C,SAASC,cAAc,OAClCu0C,EAAKt0C,aAAa,QAAS,+BAC3B,IAAIu0C,EAAOz0C,SAASC,cAAc,QAClCw0C,EAAKv0C,aAAa,QAAS,oDAC3Bu0C,EAAKr0C,YAAYJ,SAASK,eAAeoC,IACzC,IAAIkxB,EAAO3zB,SAASC,cAAc,QAKlC,OAJA0zB,EAAKzzB,aAAa,QAAS,qCAC3ByzB,EAAKvzB,YAAYJ,SAASK,eAAeuqB,EAAI,YAC7C4pB,EAAKp0C,YAAYq0C,GACjBD,EAAKp0C,YAAYuzB,GACV6gB,GAGRl3C,EAAOD,QAAQw5B,G,gBCnEf,IAAM3tB,EAAY1J,EAAQ,GACpB2c,EAAoB3c,EAAQ,GAC5Bk1C,EAAuBl1C,EAAQ,IAC/BD,EAAwBC,EAAQ,GAChCC,EAAkBD,EAAQ,GAEhC,SAASs3B,EAAoB3yB,EAAIlD,GAChCV,KAAK4D,GAAKA,EACV5D,KAAKU,QAAUA,EACfV,KAAKo0C,KAAO,GACZp0C,KAAKyM,OACLzM,KAAKq0C,WAAY,EACjBr0C,KAAK+G,QAAS,EACd/G,KAAK2wC,OAAS,IAAIhoC,EAAU/E,EAAGgF,OAAQ5I,KAAKU,QAASV,KAAK4D,IAC1D5D,KAAKkc,KAAO,IAAIld,EAChBgB,KAAKs0C,QAAW5zC,GAAWA,EAAQ2zC,UAAY3zC,EAAQ2zC,UAAY,UACnEr0C,KAAKu0C,WAAa,CACjB,QAAY,CAAEl1C,MAAO,kBAAmBpB,MAAO,YAEhD+B,KAAKw0C,gBAGNje,EAAoB33B,UAAU61C,oBAAsB,WACnD,OAAO,GASRle,EAAoB33B,UAAU81C,gBAAkB,SAASC,GACrD30C,KAAKs0C,SAAWK,IAClB30C,KAAKs0C,QAAUK,EACf30C,KAAKw0C,gBACLx0C,KAAK40C,oBAGPre,EAAoB33B,UAAUg2C,gBAAkB,SAAS5B,GACxDlyC,eAAeC,YAAYsE,eAAerF,KAAK60C,UAC/C70C,KAAK60C,SAASh1C,YAAYG,KAAK80C,mBAAmB9B,KAGnDzc,EAAoB33B,UAAU41C,cAAgB,WAC7C,IAAIzqC,EAAO/J,KAIQ,WAAhBA,KAAKs0C,UACPt0C,KAAKq0C,UAAY,IAAIF,GAJT,SAASnB,EAAGj3B,GACxBhS,EAAKY,MAAMqoC,EAAGj3B,KAGoC/b,KAAMA,KAAK4D,MAI/D2yB,EAAoB33B,UAAU6N,KAAO,WACpC,IAAIqO,EAAK,IAAInS,EAAU3I,KAAK4D,GAAGgF,OAAQ5I,KAAKU,QAASV,KAAK4D,IACtD8D,EAAOoT,EAAGzP,0BACVtB,EAAO/J,KACX+J,EAAKqqC,KAAO,GACZt5B,EAAGjR,QAAQnC,GAAM1B,MAAK,SAAS6V,GAE9B,GADW,IAAID,EAAkBlT,WAAWmT,EAAS,KAAM,KAAM9R,EAAKnG,IAC9DwY,YAAYP,GACnB,IAAI,IAAI7e,EAAI,EAAGA,EAAE6e,EAAQX,SAAS9a,OAAQpD,IAAI,CAC7C,IAAImH,EAAKjF,EAAgBqc,4BAA4B,UAAWM,EAAQX,SAASle,IAC9EmH,QAA8B,IAAjB4F,EAAKqqC,KAAKjwC,KACzB4F,EAAKqqC,KAAKjwC,GAAM0X,EAAQX,SAASle,QANrC,OAWO,SAAS8Q,GACfY,QAAQoR,MAAMhS,OAKhByoB,EAAoB33B,UAAU+L,MAAQ,SAAS0f,EAAKtO,EAAUoB,GAC7D,IAAIpT,EAAO/J,KACXc,eAAeC,YAAYsE,eAAerF,KAAK2c,WAC/C3c,KAAK2wC,OAAO9mC,QAAQwgB,GACnBrkB,MAAK,SAASe,GACdgD,EAAKhD,OAAS,IAAI6U,EAAkBA,kBAAkB7R,EAAKnG,GAAImD,EAAQgD,EAAK4mC,OAAQ5mC,EAAKrJ,QAASqb,GAAU,GAC5G,IAAIkf,EAAKlxB,EAAKhD,OAAOoK,SAASpH,EAAK4S,WAAW,GAC3Cse,GACDlxB,EAAK4S,UAAU9c,YAAYo7B,MAL9B,OAQO,SAASvW,GACf3a,EAAKnG,GAAGmc,UAAU2E,OAIpB6R,EAAoB33B,UAAUm2C,iBAAmB,WAChD/0C,KAAK2c,UAAYld,SAASC,cAAc,OACxCM,KAAK2c,UAAUhd,aAAa,QAAS,2BAGtC42B,EAAoB33B,UAAUuS,SAAW,SAAS6hC,GACjD,IAAIgC,EAAOv1C,SAASC,cAAc,OAClCs1C,EAAKr1C,aAAa,QAAS,uBACxBK,KAAKy0C,uBACPO,EAAKn1C,YAAYG,KAAKi1C,yBAAyBjC,IAEhDhzC,KAAK2c,UAAYld,SAASC,cAAc,OACxCM,KAAK2c,UAAUhd,aAAa,QAAS,iDAErC,IAAIu1C,EAAWz1C,SAASC,cAAc,QAYtC,OAXAw1C,EAASv1C,aAAa,QAAS,kBAE/BK,KAAKm1C,SAAWn1C,KAAKo1C,oBAAoBpC,EAAGkC,GAC5Cl1C,KAAKq1C,WAAa51C,SAASC,cAAc,QACzCM,KAAKq1C,WAAW11C,aAAa,QAAS,wBACtCK,KAAKq1C,WAAWx1C,YAAYG,KAAK80C,mBAAmB9B,EAAGhzC,KAAKm1C,WAE5DD,EAASr1C,YAAYG,KAAKq1C,YAE1BL,EAAKn1C,YAAYq1C,GACjBF,EAAKn1C,YAAYG,KAAK2c,WACfq4B,GAGRze,EAAoB33B,UAAUq2C,yBAA2B,WACxD,IAAIK,EAAM71C,SAASC,cAAc,UAEjC,IAAI,IAAIrC,KADRi4C,EAAI31C,aAAa,QAAS,qCACbK,KAAKu0C,WAAW,CAC5B,IAAIgB,EAAMv1C,KAAKu0C,WAAWl3C,GACtBwD,EAAMpB,SAASC,cAAc,UACjCmB,EAAI5C,MAASs3C,EAAIt3C,MAAQs3C,EAAIt3C,MAAQZ,EACrC,IAAIme,EAAO+5B,EAAIl2C,MAAQk2C,EAAIl2C,MAAQhC,EACnCwD,EAAIhB,YAAYJ,SAASK,eAAe0b,IACxC85B,EAAIz1C,YAAYgB,GAEjB,IAAIkJ,EAAO/J,KAIX,OAHAs1C,EAAIv1C,iBAAiB,UAAU,WAC9BgK,EAAK2qC,gBAAgB10C,KAAK/B,UAEpBq3C,GAGR/e,EAAoB33B,UAAUk2C,mBAAqB,SAAS9B,EAAG7tC,GAC9D,OAAOnF,KAAKq0C,UAAUljC,SAAS6hC,EAAG7tC,IAGnCoxB,EAAoB33B,UAAUw2C,oBAAsB,SAASpC,EAAGwC,GAC/D,OAAOx1C,KAAKq0C,UAAUe,oBAAoBpC,EAAGwC,IAG9Cz4C,EAAOD,QAAQy5B,G,gBCnJf,IAAMnc,EAAuBnb,EAAQ,GAC/Bw2C,EAA0Bx2C,EAAQ,IAClCw1B,EAA0Bx1B,EAAQ,IAClCyc,EAAOzc,EAAQ,GAErB,SAASk1C,EAAqBuB,EAAIC,EAAM/xC,GACvC5D,KAAK2K,MAAQ+qC,EACb11C,KAAK2wC,OAASgF,EAAKhF,OACnB3wC,KAAK4D,GAAKA,EAEV5D,KAAK41C,UAAY,GACjB51C,KAAK41C,UAAU1yB,WAAa,GAC5BljB,KAAK41C,UAAU/qC,MAAQ,EAGxBspC,EAAqBv1C,UAAUi3C,wBAA0B,SAASC,EAASC,GAC1E/1C,KAAK41C,UAAU7wB,SAAY+wB,EAC3B91C,KAAK41C,UAAUjrC,MAASorC,EACxB/1C,KAAK41C,UAAU/wB,YAAc,MAG9BsvB,EAAqBv1C,UAAUo3C,qBAAuB,SAAShB,GAC9D,IAAIlxB,EAAMrkB,SAASC,cAAc,OAGjC,OAFAokB,EAAInkB,aAAa,QAAS,4BAC1Bq1C,EAAKn1C,YAAYikB,GACVA,GAGRqwB,EAAqBv1C,UAAUq3C,cAAgB,SAASC,EAAMt/B,EAAQ9P,GACrE,IAAIqvC,EAAI12C,SAASC,cAAc,UAC3BqK,EAAO/J,KACXm2C,EAAEp2C,iBAAiB,SAAS,SAAS+N,GAEpC,GADA/D,EAAKnG,GAAGo2B,gBACK,gBAAVpjB,EAAyB,EACvB9O,EAASgG,EAAEhG,QAAUgG,EAAEsoC,YACPC,aAAevuC,EAAOk7B,UAC1C,GAAuB,UAAnBl7B,EAAOwuC,SAAuB,YAE9B,GAAa,oBAAV1/B,EAA6B,CACpC,IAAI9O,KAASgG,EAAEhG,QAAUgG,EAAEsoC,YACPC,aAAevuC,EAAOk7B,UAC1C,GAAuB,SAAnBl7B,EAAOwuC,SAAsB,OAElC,IAAI,IAAIt5C,EAAE,EAAGA,EAAEgD,KAAKuX,SAASnX,OAASpD,IACrC0e,EAAM3T,iBAAiB/H,KAAKuX,SAASva,IAEtC,IAAIu5C,EAAM92C,SAASU,uBAAuB,yBAC1C,IAAQnD,EAAE,EAAGA,EAAEu5C,EAAIn2C,OAASpD,IAC3B,GAAGgD,MAAQu2C,EAAIv5C,GACd,IAAI,IAAI6b,EAAE,EAAGA,EAAE09B,EAAIv5C,GAAGua,SAASnX,OAASyY,IACpC09B,EAAIv5C,GAAGua,SAASsB,GAAGzU,UAAUG,SAAS,sBACxCgyC,EAAIv5C,GAAGua,SAASsB,GAAGzU,UAAUC,OAAO,oBACpCkyC,EAAIv5C,GAAGua,SAASsB,GAAGzU,UAAUI,IAAI,qBAOtC2xC,EAAEx2C,aAAa,QAAS,6DAExB,IAAI8/B,EAAKhgC,SAASC,cAAc,OAChC+/B,EAAG9/B,aAAa,QAAS,kBACzBw2C,EAAEt2C,YAAY4/B,GAEd,IAAI+W,EAAK/2C,SAASC,cAAc,OAChC82C,EAAG72C,aAAa,QAAS,yBACzB8/B,EAAG5/B,YAAY22C,GAEf,IAAIl5C,EAAImC,SAASC,cAAc,OAC/BpC,EAAEqC,aAAa,QAAS,gCACxBrC,EAAEuC,YAAYJ,SAASK,eAAe8W,IACtC4/B,EAAG32C,YAAYvC,GACfkkC,GAAK/hC,SAASC,cAAc,KACzB8hC,GAAG7hC,aAAa,QAAS,kDAC5BrC,EAAEuC,YAAY2hC,IAEd,IAAItjC,EAAIuB,SAASC,cAAc,MAO/B,OANAxB,EAAEyB,aAAa,QAAS,0CACxBzB,EAAE2B,YAAYJ,SAASK,eAAegH,IACtCqvC,EAAEt2C,YAAY3B,GAEdg4C,EAAKr2C,YAAYs2C,GAEVA,GAGRhC,EAAqBv1C,UAAU63C,qBAAuB,SAAS9rC,GAC3DA,EAAMC,QACR5K,KAAK41C,UAAU1yB,WAAavY,EAAMC,MAAM,GACxC5K,KAAK41C,UAAU/qC,MAAQF,EAAMC,MAAM,GAAGC,MAAM,KAa9CspC,EAAqBv1C,UAAUw2C,oBAAsB,SAASpC,EAAGwC,GAChE,IAAIR,EAAOv1C,SAASC,cAAc,QAClCs1C,EAAKr1C,aAAa,QAAS,uDAE3B,IAAI+2C,EAAMj3C,SAASC,cAAc,MACjCg3C,EAAI72C,YAAYJ,SAASK,eAAe,gBACxC42C,EAAI/2C,aAAa,QAAS,qDAC1Bq1C,EAAKn1C,YAAY62C,GAEjB,IAAIvxC,EAAM1F,SAASC,cAAc,YACjCyF,EAAIxF,aAAa,QAAS,sBAC1BwF,EAAIxF,aAAa,cAAe,2EAChCwF,EAAIxF,aAAa,QAAS,uCACvBqzC,IAAG7tC,EAAIlH,MAAQkI,KAAKC,UAAU4sC,OAAEhuB,EAAW,IAC9CgwB,EAAKn1C,YAAYsF,GACjBuW,EAAM7W,cAAc7E,KAAK4D,GAAIuB,EAAK,QAAS,cAC3C,IAAI4E,EAAO/J,KACP22C,EAAOl3C,SAASC,cAAc,UAqBlC,OApBAi3C,EAAKh3C,aAAa,QAAS,wCAC3Bg3C,EAAK92C,YAAYJ,SAASK,eAAe,eACzC62C,EAAK52C,iBAAiB,SAAS,WAC9BgK,EAAKnG,GAAGo2B,gBACR,IACC,IAAI4c,EAAOzwC,KAAK6nB,MAAM7oB,EAAIlH,OACvB8L,EAAKnG,GAAGpD,gBAAgB,eAE1BuJ,EAAK8rC,wBAAwB1wC,EAAK4E,EAAK6rC,UAAUjrC,OACjDZ,EAAK0sC,qBAAqBG,GAC1B7sC,EAAKY,MAAMisC,EAAM7sC,EAAK6rC,YAElB7rC,EAAKY,MAAMisC,GAEjB,MAAM9oC,GACLwG,MAAM,yBAA2BxG,EAAEyG,gBAGrCygC,EAAKn1C,YAAY82C,GACjBnB,EAAI31C,YAAYm1C,GACT7vC,GAGRgvC,EAAqBv1C,UAAUuS,SAAW,SAAS6hC,EAAG7tC,GACrD,IAAI6vC,EAAOv1C,SAASC,cAAc,OAClCs1C,EAAKr1C,aAAa,QAAS,gCAC3B,IAAIk3C,EAAQp3C,SAASC,cAAc,OACnCm3C,EAAMl3C,aAAa,QAAS,4BAE5Bq1C,EAAKn1C,YAAYg3C,GACjB,IAAIC,EAAOr3C,SAASC,cAAc,OAClCo3C,EAAKn3C,aAAa,QAAS,kDAC3B,IAAIo3C,EAAKt3C,SAASC,cAAc,MAChCq3C,EAAGl3C,YAAYJ,SAASK,eAAe,kBACvCi3C,EAAGp3C,aAAa,QAAS,qDACzBm3C,EAAKj3C,YAAYk3C,GAEjB,IAAIb,EAAOl2C,KAAKg2C,qBAAqBc,GACrCA,EAAKj3C,YAAYq2C,GAGjB,IAAIc,EAAUh3C,KAAKi2C,cAAcC,EAAM,iBAAkB,IAErDe,EAAQx3C,SAASC,cAAc,UACnCu3C,EAAMp3C,YAAYJ,SAASK,eAAe,qBAC1Cm3C,EAAMt3C,aAAa,QAAS,0CAC5Bs3C,EAAMl3C,iBAAiB,SAAS,WAC/BgK,EAAKnG,GAAGo2B,gBACRte,EAAMxW,qBAAqB6E,EAAKnG,GAAIuB,GACpC,IAAIyxC,EAAO7sC,EAAK4mC,OAAOplC,sBAAsB,KAAMxB,EAAK6rC,UAAU1yB,WAAYnZ,EAAK6rC,UAAU/qC,OAC7F1F,EAAIlH,MAAQkI,KAAKC,UAAUwwC,OAAK5xB,EAAW,GAC3CtJ,EAAM7W,cAAckF,EAAKnG,GAAIuB,EAAK,QAAS,cACxC4E,EAAKnG,GAAGpD,gBAAgB,eAC1BuJ,EAAK8rC,wBAAwB1wC,EAAK,oBAClC4E,EAAKY,MAAMisC,EAAM7sC,EAAK6rC,YAElB7rC,EAAKY,MAAMisC,MAGjB,IAAIM,EAAQz3C,SAASC,cAAc,UACnCw3C,EAAMr3C,YAAYJ,SAASK,eAAe,0BAC1Co3C,EAAMv3C,aAAa,QAAS,0CAC5Bu3C,EAAMn3C,iBAAiB,SAAS,WAC/BgK,EAAKnG,GAAGo2B,gBACRte,EAAMxW,qBAAqB6E,EAAKnG,GAAIuB,GACpC,IAAIgyC,EAASptC,EAAK4mC,OAAOplC,sBAAsBxB,EAAK4mC,OAAO1mC,gCAAgC,aAC/EF,EAAK6rC,UAAU1yB,WAAYnZ,EAAK6rC,UAAU/qC,OACtD1F,EAAIlH,MAAQkI,KAAKC,UAAU+wC,OAAOnyB,EAAW,GAC7CtJ,EAAM7W,cAAckF,EAAKnG,GAAIuB,EAAK,QAAS,cACxC4E,EAAKnG,GAAGpD,gBAAgB,eAC1BuJ,EAAK8rC,wBAAwB1wC,EAAK,yBAClC4E,EAAKY,MAAMwsC,EAAQptC,EAAK6rC,YAEpB7rC,EAAKY,MAAMwsC,MAGjB,IAAIC,EAAO33C,SAASC,cAAc,UAClC03C,EAAKv3C,YAAYJ,SAASK,eAAe,6BACzCs3C,EAAKz3C,aAAa,QAAS,0CAC3B,IAAIoK,EAAO/J,KACXo3C,EAAKr3C,iBAAiB,SAAS,WAC9BgK,EAAKnG,GAAGo2B,gBACRte,EAAMxW,qBAAqB6E,EAAKnG,GAAIuB,GACpC,IAAIyxC,EAAO7sC,EAAK4mC,OAAOtlC,wBAAwB,KAAMtB,EAAK6rC,UAAU1yB,WAAYnZ,EAAK6rC,UAAU/qC,OAC/F1F,EAAIlH,MAAQkI,KAAKC,UAAUwwC,OAAK5xB,EAAW,GAC3CtJ,EAAM7W,cAAckF,EAAKnG,GAAIuB,EAAK,QAAS,cACxC4E,EAAKnG,GAAGpD,gBAAgB,eAC1BuJ,EAAK8rC,wBAAwB1wC,EAAK,4BAClC4E,EAAKY,MAAMisC,EAAM7sC,EAAK6rC,YAElB7rC,EAAKY,MAAMisC,MAEjB,IAAIjhB,EAAOl2B,SAASC,cAAc,UAClCi2B,EAAK91B,YAAYJ,SAASK,eAAe,uBACzC61B,EAAKh2B,aAAa,QAAS,0CAC3Bg2B,EAAK51B,iBAAiB,SAAS,WAC9BgK,EAAKnG,GAAGo2B,gBACRte,EAAMxW,qBAAqB6E,EAAKnG,GAAIuB,GACpC,IAAIgyC,EAASptC,EAAK4mC,OAAO7lC,oBAAoB,KAAMf,EAAK6rC,UAAU1yB,WAAYnZ,EAAK6rC,UAAU/qC,OAC7F1F,EAAIlH,MAAQkI,KAAKC,UAAU+wC,OAAOnyB,EAAW,GAC7CtJ,EAAM7W,cAAckF,EAAKnG,GAAIuB,EAAK,QAAS,cACxC4E,EAAKnG,GAAGpD,gBAAgB,eAC1BuJ,EAAK8rC,wBAAwB1wC,EAAK,sBAClC4E,EAAKY,MAAMwsC,EAAQptC,EAAK6rC,YAEpB7rC,EAAKY,MAAMwsC,MAEjB,IAAIE,EAAO53C,SAASC,cAAc,UAClC23C,EAAKx3C,YAAYJ,SAASK,eAAe,kBACzCu3C,EAAK13C,aAAa,QAAS,0CAC3B03C,EAAKt3C,iBAAiB,SAAS,WAC9BgK,EAAKnG,GAAGo2B,gBACRte,EAAMxW,qBAAqB6E,EAAKnG,GAAIuB,GACpC,IAAIgyC,EAASptC,EAAK4mC,OAAOzlC,mBAAmB,KAAMnB,EAAK6rC,UAAU1yB,WAAYnZ,EAAK6rC,UAAU/qC,OAC5F1F,EAAIlH,MAAQkI,KAAKC,UAAU+wC,OAAOnyB,EAAW,GAC7CtJ,EAAM7W,cAAckF,EAAKnG,GAAIuB,EAAK,QAAS,cACxC4E,EAAKnG,GAAGpD,gBAAgB,eAC1BuJ,EAAK8rC,wBAAwB1wC,EAAK,iBAClC4E,EAAKY,MAAMwsC,EAAQptC,EAAK6rC,YAEpB7rC,EAAKY,MAAMwsC,MAGjB,IAAIG,EAAQ73C,SAASC,cAAc,UACnC43C,EAAMz3C,YAAYJ,SAASK,eAAe,wBAC1Cw3C,EAAM33C,aAAa,QAAS,0CAC5B23C,EAAMv3C,iBAAiB,SAAS,WAC/BgK,EAAKnG,GAAGo2B,gBACRte,EAAMxW,qBAAqB6E,EAAKnG,GAAIuB,GACpC,IAAIgyC,EAASptC,EAAK4mC,OAAOvlC,qBAAqB,KAAMrB,EAAK6rC,UAAU1yB,WAAYnZ,EAAK6rC,UAAU/qC,OAC9F1F,EAAIlH,MAAQkI,KAAKC,UAAU+wC,OAAOnyB,EAAW,GAC7CtJ,EAAM7W,cAAckF,EAAKnG,GAAIuB,EAAK,QAAS,cACxC4E,EAAKnG,GAAGpD,gBAAgB,eAC1BuJ,EAAK8rC,wBAAwB1wC,EAAK,uBAClC4E,EAAKY,MAAMwsC,EAAQptC,EAAK6rC,YAEpB7rC,EAAKY,MAAMwsC,MAIjB,IAAII,EAAUv3C,KAAKi2C,cAAcC,EAAM,eAAgB,IAEnDnhB,EAAS,IAAI3a,EAAqBpa,KAAK4D,IAC3CmxB,EAAO5Z,aAAe,oBAClBpR,EAAO/J,KACX+0B,EAAOra,OAAS,SAASsa,GAExB,GADAjrB,EAAKnG,GAAGo2B,gBACLhF,EAAU,CACZtZ,EAAMxW,qBAAqB6E,EAAKnG,GAAIuB,GACpC,IAAIgyC,EAASptC,EAAK4mC,OAAOnlC,0BAA0BwpB,EAAWjrB,EAAK6rC,UAAU1yB,WAAYnZ,EAAK6rC,UAAU/qC,OACxG1F,EAAIlH,MAAQkI,KAAKC,UAAU+wC,OAAOnyB,EAAW,GAC7CtJ,EAAM7W,cAAckF,EAAKnG,GAAIuB,EAAK,QAAS,cACxC4E,EAAKnG,GAAGpD,gBAAgB,eAC1BuJ,EAAK8rC,wBAAwB1wC,EAAK,mBAClC4E,EAAK6rC,UAAU/wB,YAAcmQ,EAC7BjrB,EAAKY,MAAMwsC,EAAQptC,EAAK6rC,YAEpB7rC,EAAKY,MAAMwsC,KAGlB,IAAI1F,EAAQ1c,EAAO5jB,SAAS,yBAExBqmC,EAAS,IAAI/B,EAAwBz1C,KAAK4D,IAC9C4zC,EAAOr8B,aAAe,qBAClBpR,EAAO/J,KACXw3C,EAAO98B,OAAS,SAASurB,GACxB,GAAGA,EAAa,CACfvqB,EAAMxW,qBAAqB6E,EAAKnG,GAAIuB,GACpC,IAAIgyC,EAASptC,EAAK4mC,OAAOjlC,6BAA6Bu6B,EAAcl8B,EAAK6rC,UAAU1yB,WAAYnZ,EAAK6rC,UAAU/qC,OAC9G1F,EAAIlH,MAAQkI,KAAKC,UAAU+wC,OAAOnyB,EAAW,GAC7CtJ,EAAM7W,cAAckF,EAAKnG,GAAIuB,EAAK,QAAS,cACxC4E,EAAKnG,GAAGpD,gBAAgB,eAC1BuJ,EAAK8rC,wBAAwB1wC,EAAK,uBAClC4E,EAAK6rC,UAAU/wB,YAAcohB,EAC7Bl8B,EAAKY,MAAMwsC,EAAQptC,EAAK6rC,YAEpB7rC,EAAKY,MAAMwsC,KAKlB,IAAIM,EAAYz3C,KAAKi2C,cAAcC,EAAM,mBAAoB,IAEzDjC,EAAOuD,EAAOrmC,WAEdumC,EAAQ,IAAIjjB,EAAwBz0B,KAAK4D,IAC7C8zC,EAAMh9B,OAAS,SAAS2P,GACvBtgB,EAAKnG,GAAGo2B,gBACRte,EAAMxW,qBAAqB6E,EAAKnG,GAAIuB,GACpC,IAAIgyC,EAASptC,EAAK4mC,OAAO/kC,iBAAiBye,EAAKtgB,EAAK6rC,UAAU1yB,WAAYnZ,EAAK6rC,UAAU/qC,OACzF1F,EAAIlH,MAAQkI,KAAKC,UAAU+wC,OAAOnyB,EAAW,GAC7CtJ,EAAM7W,cAAckF,EAAKnG,GAAIuB,EAAK,QAAS,cACxC4E,EAAKnG,GAAGpD,gBAAgB,eAC1BuJ,EAAK8rC,wBAAwB1wC,EAAK,4BAClC4E,EAAK6rC,UAAU/wB,YAAcwF,EAC7BtgB,EAAKY,MAAMwsC,EAAQptC,EAAK6rC,YAEpB7rC,EAAKY,MAAMwsC,IAEjB,IAAIQ,EAASD,EAAMvmC,SAAS,yBAExBg+B,EAAO,IAAI1a,EAAwBz0B,KAAK4D,GAAI9C,eAAeC,YAAYqf,UAAU,iBACrF+uB,EAAK5uC,KAAO,QACZ4uC,EAAKz0B,OAASg9B,EAAMh9B,OACpB,IAAIk9B,EAAQzI,EAAKh+B,SAAS,yBAClB1R,SAASC,cAAc,KAC7BG,YAAY+3C,GAGd,IAAIC,EAAUp4C,SAASC,cAAc,OACrCm4C,EAAQl4C,aAAa,QAAS,kBAC9Bk4C,EAAQh4C,YAAYu3C,GACpB,IAAIzxC,EAAKlG,SAASC,cAAc,MAChCm4C,EAAQh4C,YAAY8F,GACpBkyC,EAAQh4C,YAAYo3C,GAChBtxC,EAAKlG,SAASC,cAAc,MAChCm4C,EAAQh4C,YAAY8F,GACpBkyC,EAAQh4C,YAAYq3C,GAChBvxC,EAAKlG,SAASC,cAAc,MAChCm4C,EAAQh4C,YAAY8F,GACpBkyC,EAAQh4C,YAAYy3C,GAChB3xC,EAAKlG,SAASC,cAAc,MAChCm4C,EAAQh4C,YAAY8F,GACpBqxC,EAAQn3C,YAAYg4C,GAEpB7C,EAAKn1C,YAAYi3C,GAGjB,IAAIgB,EAAUr4C,SAASC,cAAc,OACrCo4C,EAAQn4C,aAAa,QAAS,iBAC9Bm4C,EAAQj4C,YAAY4xC,GACpBqG,EAAQj4C,YAAYo0C,GAEhBtuC,EAAKlG,SAASC,cAAc,MAChCo4C,EAAQj4C,YAAY8F,GACpBmyC,EAAQj4C,YAAYw3C,GACpBE,EAAQ13C,YAAYi4C,GAIpB,IAAIC,EAAWt4C,SAASC,cAAc,OAOtC,OANAq4C,EAASp4C,aAAa,QAAS,iBAC/Bo4C,EAASl4C,YAAY83C,GACrBI,EAASl4C,YAAY81B,GAErB8hB,EAAU53C,YAAYk4C,GAEf/C,GAGRj4C,EAAOD,QAAQq3C,G,gBChXf,IAAMxrC,EAAY1J,EAAQ,GACpBC,EAAkBD,EAAQ,GAEhCw2C,wBAA0B,SAAS7xC,EAAImT,GACtC/W,KAAK4D,GAAKA,EACV5D,KAAKqa,QAAS,EACdra,KAAK+W,OAASA,GAGf0+B,wBAAwB72C,UAAU2b,QAAU,SAASC,GACpDxa,KAAKwa,KAAOA,GAGbi7B,wBAAwB72C,UAAU6b,UAAY,SAAS1D,GACtD/W,KAAK+W,OAASA,GAGf0+B,wBAAwB72C,UAAU8b,OAAS,SAASC,GACnDrG,MAAM,8CAAgDqG,EAAM,MAG7D86B,wBAAwB72C,UAAUuS,SAAW,WAC5C,IAAIyJ,EAAQnb,SAASC,cAAc,QACnCkb,EAAMjb,aAAa,QAAS,0BAC5B,IAAIkb,EAAQpb,SAASC,cAAc,UACnCmb,EAAMlb,aAAa,QAAS,+CAC5B,IAAIoK,EAAO/J,KACX6a,EAAM9a,iBAAiB,UAAU,WAC7BC,KAAK/B,OAAS+B,KAAKqa,SACrBra,KAAKqa,OAASra,KAAK/B,MACnB8L,EAAK2Q,OAAO1a,KAAK/B,WAGnB2c,EAAM/a,YAAYgb,GAClB,IAAIC,EAAK,IAAInS,EAAU3I,KAAK4D,GAAGgF,QAAQ,EAAO5I,KAAK4D,IAC/C8D,EAAOoT,EAAG1P,qBAAqBpL,KAAK+W,QACpChN,EAAO/J,KAQX,OAPA8a,EAAGjR,QAAQnC,GACV1B,MAAK,SAAST,GAEd,IADA,IAAIiH,EAAOzC,EAAKgR,oBAAoBxV,GAC5BvI,EAAI,EAAGA,EAAEwP,EAAKpM,OAAQpD,IAC7B6d,EAAMhb,YAAY2M,EAAKxP,OAGlB4d,GAGR66B,wBAAwB72C,UAAUmc,oBAAsB,SAASC,GAChE,IAAIC,EAAU,GACd,GAAGjb,KAAKmb,aAAa,CACpB,IAAIC,EAAO3b,SAASC,cAAc,UAClC0b,EAAKzb,aAAa,QAAS,+CAC3Byb,EAAKnd,MAAQ,GACbmd,EAAKvb,YAAYJ,SAASK,eAAeE,KAAKmb,eAC9CF,EAAQhQ,KAAKmQ,GAEd,IAAI48B,EAASv4C,SAASC,cAAc,UACpCs4C,EAAOr4C,aAAa,QAAS,yBAC7Bq4C,EAAO/5C,MAAQ,aACf+5C,EAAOn4C,YAAYJ,SAASK,eAAe,UAC3Cmb,EAAQhQ,KAAK+sC,GAEb,IAAIC,EAASx4C,SAASC,cAAc,UAMpC,GALAu4C,EAAOt4C,aAAa,QAAS,yBAC7Bs4C,EAAOh6C,MAAQ,eACfg6C,EAAOp4C,YAAYJ,SAASK,eAAe,YAC3Cmb,EAAQhQ,KAAKgtC,GAEVj9B,EAAME,SAER,IADA,IAAIG,EAAQ,GACJre,EAAI,EAAGA,EAAEge,EAAME,SAAS9a,OAAQpD,IAAI,CAC3C,IAAIk7C,EAAQh5C,EAAgBqc,4BAA4B,WAAYP,EAAME,SAASle,IACnF,GAAGk7C,IAAkC,GAAzB78B,EAAMrO,QAAQkrC,GAAa,CACtC78B,EAAMpQ,KAAKitC,GACX,IAAIr3C,EAAMpB,SAASC,cAAc,UACjCmB,EAAIlB,aAAa,QAAS,yBAC1BkB,EAAI5C,MAAQi6C,EACZ,IAAI18B,EAAMtc,EAAgBqc,4BAA4B,QAASP,EAAME,SAASle,IAC1Ewe,GAAc,WAAPA,IACVA,EAAM1a,eAAeC,YAAYC,aAAak3C,IAE5C18B,EAAI,YAAWA,EAAMA,EAAI,WAC5B3a,EAAIhB,YAAYJ,SAASK,eAAe0b,IACxCP,EAAQhQ,KAAKpK,IAIhB,OAAOoa,GAKRle,EAAOD,QAAQ24C,yB,cC/Ff,SAASjf,EAAsB5yB,EAAIzF,GAClC6B,KAAK4D,GAAKA,EACV5D,KAAK7B,KAAQA,GAAc,OAG5Bq4B,EAAsB53B,UAAUuS,SAAW,WAC1C,IAAI0/B,EAAMpxC,SAASC,cAAc,OACjCmxC,EAAIlxC,aAAa,QAAS,uCAC1B,IAAIw4C,EAAO14C,SAASC,cAAc,UAC9B04C,EAAK34C,SAASC,cAAc,UAChC04C,EAAGn6C,MAAQ,OACXm6C,EAAGv4C,YAAYJ,SAASK,eAAe,aACvCq4C,EAAKt4C,YAAYu4C,GACjB,IAAIC,EAAK54C,SAASC,cAAc,UAChC24C,EAAGp6C,MAAQ,QACXo6C,EAAGx4C,YAAYJ,SAASK,eAAe,cACvCq4C,EAAKt4C,YAAYw4C,GACjB,IAAIC,EAAKt4C,KAAKu4C,gBAAgB,YAC9BD,EAAGz4C,YAAYs4C,GACftH,EAAIhxC,YAAYy4C,GAChB,IAAIzwC,EAAS7H,KAAKw4C,aAAa3H,EAAK,cAChC/oC,EAAS9H,KAAKw4C,aAAa3H,EAAK,cAChC4H,EAAUz4C,KAAKw4C,aAAa3H,EAAK,WACjCnwC,EAAUV,KAAKw4C,aAAa3H,EAAK,WAEjC5E,EAAOjsC,KAAKu4C,gBAAgB,oBAC5B9e,EAAUh6B,SAASC,cAAc,SACrC+5B,EAAQ95B,aAAa,OAAQ,QAC7B85B,EAAQ95B,aAAa,OAAQ,IAC7BssC,EAAKpsC,YAAY45B,GACjBoX,EAAIhxC,YAAYosC,GAEhB,IAAIyM,EAASj5C,SAASC,cAAc,UACpCg5C,EAAO/4C,aAAa,QAAS,wCAC7B+4C,EAAO74C,YAAYJ,SAASK,eAAe,oBAC3C,IAAIiK,EAAO/J,KAkBX,OAjBA04C,EAAO34C,iBAAiB,SAAS,WAChC,IAAI44C,EAAS,CACZC,WAAYzyC,KAAK6nB,MAAMnmB,EAAO5J,QAEd,QAAdk6C,EAAKl6C,MACP06C,EAAO,YAAc,oBAGrBA,EAAO,YAAc,qBAEnB7wC,EAAO7J,QAAO06C,EAAOE,WAAa/wC,EAAO7J,OACzCw6C,EAAQx6C,QAAO06C,EAAOF,QAAUA,EAAQx6C,OACxCyC,EAAQzC,QAAO06C,EAAOj4C,QAAUA,EAAQzC,OACxCw7B,EAAQx7B,QAAO06C,EAAOlf,QAAUA,EAAQx7B,OAC3C8L,EAAKnG,GAAGgF,OAAO00B,QAAO,EAAOqb,MAE9B9H,EAAIhxC,YAAY64C,GACT7H,GAGRra,EAAsB53B,UAAU25C,gBAAkB,SAASl5C,GAC1D,IAAI8zC,EAAM1zC,SAASC,cAAc,OACjCyzC,EAAIxzC,aAAa,QAAS,8CAC1B,IAAI6b,EAAM/b,SAASC,cAAc,QAIjC,OAHA8b,EAAI7b,aAAa,QAAS,8CAC1B6b,EAAI3b,YAAYJ,SAASK,eAAeT,IACxC8zC,EAAItzC,YAAY2b,GACT23B,GAGR3c,EAAsB53B,UAAU45C,aAAe,SAASn2B,EAAQhjB,GAC/D,IAAIi5C,EAAKt4C,KAAKu4C,gBAAgBl5C,GAC1BwI,EAASpI,SAASC,cAAc,YAIpC,OAHAmI,EAAOlI,aAAa,QAAS,yCAC7B24C,EAAGz4C,YAAYgI,GACfwa,EAAOxiB,YAAYy4C,GACZzwC,GAGR9K,EAAOD,QAAQ05B,G,qPCvEf,IAAMpc,EAAuBnb,EAAQ,GAC/B4f,EAAyB5f,EAAQ,GACjCyc,EAAMzc,EAAQ,GAEpB,SAASw3B,EAAqB7yB,GAC7B5D,KAAK4D,GAAKA,EACV5D,KAAK7B,KAAO,OACZ6B,KAAKsH,OAAS,SACdtH,KAAK84C,uBAAwB,EAM9BriB,EAAqB73B,UAAUuS,SAAW,WASzC,OARAnR,KAAKqiB,OAAS5iB,SAASC,cAAc,OACrCM,KAAKsiB,WAAa7iB,SAASC,cAAc,OACzCM,KAAKsiB,WAAW3iB,aAAa,QAAS,4BACtCK,KAAKmiB,QAAU1iB,SAASC,cAAc,OACtCM,KAAKmiB,QAAQxiB,aAAa,QAAS,0BACnCK,KAAK+4C,aACL/4C,KAAKqiB,OAAOxiB,YAAYG,KAAKsiB,YAC7BtiB,KAAKqiB,OAAOxiB,YAAYG,KAAKmiB,SACtBniB,KAAKqiB,QAGboU,EAAqB73B,UAAUm6C,WAAa,SAASvyC,EAAKwyC,GACzD,IAAIjvC,EAAO/J,KACXA,KAAK4D,GAAG6b,SAAS,4BACjBzf,KAAK4D,GAAGgF,OAAOmvB,WAAU,EAAO,CAAC,oBAAqB,YAAc/3B,KAAKsH,SACxEtB,MAAK,SAAST,GACdwE,EAAKnG,GAAGgc,YACR7V,EAAKmtB,OAAS3xB,EACdwE,EAAKsV,YAAY7Y,EAAKwyC,MAJvB,OAMO,SAASl5B,GACf/V,EAAKnG,GAAGgc,YACR7V,EAAKnG,GAAGmc,UAAUD,OAIpB2W,EAAqB73B,UAAUq6C,gBAAkB,WAChDn4C,eAAeC,YAAYsE,eAAerF,KAAKsiB,YAC/B,QAAbtiB,KAAK7B,KACP6B,KAAKsiB,WAAWziB,YAAYG,KAAKk5C,wBAEb,UAAbl5C,KAAK7B,KACZ6B,KAAKsiB,WAAWziB,YAAYG,KAAKm5C,gCAEb,eAAbn5C,KAAK7B,MACT6B,KAAK4D,GAAG0E,YAAY,eACtBtI,KAAKsiB,WAAWziB,YAAYG,KAAKo5C,uBAE/Bp5C,KAAK4D,GAAG0E,YAAY,gBACtBtI,KAAKsiB,WAAWziB,YAAYG,KAAKq5C,yBAGd,QAAbr5C,KAAK7B,OACT6B,KAAK4D,GAAG0E,YAAY,kBACtBtI,KAAKsiB,WAAWziB,YAAYG,KAAKs5C,uBAE/Bt5C,KAAK4D,GAAG0E,YAAY,kBACtBtI,KAAKsiB,WAAWziB,YAAYG,KAAKu5C,mBAE/Bv5C,KAAK4D,GAAG0E,YAAY,kBACtBtI,KAAKsiB,WAAWziB,YAAYG,KAAKw5C,oBAE/Bx5C,KAAK4D,GAAG0E,YAAY,gBACtBtI,KAAKsiB,WAAWziB,YAAYG,KAAKq5C,0BAKpC5iB,EAAqB73B,UAAU46C,iBAAmB,WACjD,IAAIC,EAAKh6C,SAASC,cAAc,UAChC+5C,EAAG95C,aAAa,QAAS,oEACzB,IAAI+5C,EAAKj6C,SAASC,cAAc,UAChCg6C,EAAG/5C,aAAa,QAAS,0BACzB+5C,EAAGz7C,MAAQ,SACXy7C,EAAG75C,YAAYJ,SAASK,eAAe,WACrB,UAAfE,KAAKsH,SAAoBoyC,EAAG/4C,UAAW,GAC1C84C,EAAG55C,YAAY65C,GACf,IAAIC,EAAKl6C,SAASC,cAAc,UAChCi6C,EAAGh6C,aAAa,QAAS,0BACzBg6C,EAAG17C,MAAQ,SACX07C,EAAG95C,YAAYJ,SAASK,eAAe,YACrB,UAAfE,KAAKsH,SAAoBqyC,EAAGh5C,UAAW,GAC1C84C,EAAG55C,YAAY85C,GACf,IAAI5vC,EAAO/J,KAKX,OAJAy5C,EAAG15C,iBAAiB,UAAU,SAAS+N,GACtC/D,EAAKzC,OAAStH,KAAK/B,MACnB8L,EAAKgvC,gBAECU,GAIRhjB,EAAqB73B,UAAUygB,YAAc,SAAS7Y,EAAKwyC,GACvDh5C,KAAKsiB,YAAYtiB,KAAKi5C,kBACtBj5C,KAAKmiB,SAASniB,KAAK45C,gBAAgBpzC,EAAKwyC,IAG5CviB,EAAqB73B,UAAUg7C,gBAAkB,SAASpzC,EAAKwyC,GAC9Dl4C,eAAeC,YAAYsE,eAAerF,KAAKmiB,SAC/B,QAAbniB,KAAK7B,KACP6B,KAAKmiB,QAAQtiB,YAAYG,KAAK65C,oBAEV,QAAb75C,KAAK7B,KACZ6B,KAAKmiB,QAAQtiB,YAAYG,KAAK85C,oBAEV,UAAb95C,KAAK7B,KACZ6B,KAAKmiB,QAAQtiB,YAAYG,KAAK+5C,sBAEV,eAAb/5C,KAAK7B,MACZ6B,KAAKmiB,QAAQtiB,YAAYG,KAAKg6C,oBAE5BxzC,GACFxG,KAAK4D,GAAGy0B,YAAY7xB,EAAKwyC,IAI3BviB,EAAqB73B,UAAUs6C,qBAAuB,WACrD,IAAIe,EAAMx6C,SAASC,cAAc,QAIjC,OAHAu6C,EAAIt6C,aAAa,QAAS,gCAC1Bs6C,EAAIp6C,YAAYG,KAAKk6C,mBACrBD,EAAIp6C,YAAYG,KAAKm6C,iBACdF,GAGRxjB,EAAqB73B,UAAUu6C,6BAA+B,WAC7D,IAAIc,EAAMx6C,SAASC,cAAc,QAIjC,OAHAu6C,EAAIt6C,aAAa,QAAS,kCAC1Bs6C,EAAIp6C,YAAYG,KAAKk6C,iBAAgB,IACrCD,EAAIp6C,YAAYG,KAAKo6C,uBACdH,GAGRxjB,EAAqB73B,UAAUw6C,oBAAsB,WACpD,IAAIrvC,EAAO/J,KAMX,OAAOA,KAAKq6C,gBAAgB,cAAe,cALhC,WACVtwC,EAAKnG,GAAGo2B,gBACRjwB,EAAK5L,KAAO,OACZ4L,EAAKsV,kBAKPoX,EAAqB73B,UAAU07C,uBAAyB,WACvD,IAAIvwC,EAAO/J,KAMX,OAAOA,KAAKq6C,gBAAgB,UAAW,WAL5B,WACVtwC,EAAKnG,GAAGo2B,gBACRjwB,EAAK5L,KAAO,UACZ4L,EAAKsV,kBAKPoX,EAAqB73B,UAAUs7C,gBAAkB,SAASK,GACzD,IAAIxwC,EAAO/J,KAWX,OAAOA,KAAKq6C,gBAAgB,SAAU,iBAV3B,WACVtwC,EAAKnG,GAAGo2B,gBACRjwB,EAAK5L,KAAO,OACTo8C,EACFxwC,EAAKnG,GAAGmN,SAGRhH,EAAKsV,kBAMRoX,EAAqB73B,UAAUw7C,oBAAsB,WACpD,IAAIrwC,EAAO/J,KAOX,OAAOA,KAAKq6C,gBAAgB,SAAU,iBAN3B,WACVtwC,EAAKnG,GAAGo2B,gBACmB,mBAAjBjwB,EAAKywC,UACdzwC,EAAKywC,eAMR/jB,EAAqB73B,UAAUu7C,cAAgB,WAC9C,IAAIpwC,EAAO/J,KASX,OAAOA,KAAKq6C,gBAAgB,OAAQ,iBARzB,WACVtwC,EAAKnG,GAAGo2B,gBACR,IAAI53B,EAAO2H,EAAK0wC,gBAAgBx8C,MAIhC,MAH0B,UAAvB,EAAO8L,EAAKmtB,UACd90B,EAAO+D,KAAK6nB,MAAM5rB,IAEZ2H,EAAKiuB,aAAa51B,EAAM,CAAC,oBAAqB,YAAc2H,EAAKzC,aAK1EmvB,EAAqB73B,UAAU06C,oBAAsB,WACpD,IAAIvvC,EAAO/J,KAKX,OAAOA,KAAKq6C,gBAAgB,OAAQ,iBAJzB,WACVtwC,EAAK5L,KAAO,OACZ4L,EAAKsV,kBAKPoX,EAAqB73B,UAAU26C,gBAAkB,WAChD,IAAIxvC,EAAO/J,KAMX,OAAOA,KAAKq6C,gBAAgB,oBAAqB,iBALtC,WACVtwC,EAAKnG,GAAGo2B,gBACRjwB,EAAK5L,KAAO,SACZ4L,EAAKsV,kBAKPoX,EAAqB73B,UAAUy7C,gBAAkB,SAASh7C,EAAOmG,EAAQk1C,GACxE,IAAI75C,EAAMpB,SAASC,cAAc,UAIjC,OAHAmB,EAAIhB,YAAYJ,SAASK,eAAeT,IACxCwB,EAAIlB,aAAa,QAAS,wDAA0D6F,GACpF3E,EAAId,iBAAiB,QAAS26C,GACvB75C,GAMR41B,EAAqB73B,UAAUo5B,aAAgB,SAAS51B,EAAMoK,GAC7DxM,KAAK4D,GAAG6b,SAAS,4BACjB,IAAI1V,EAAO/J,KACX,OAAOA,KAAK4D,GAAGgF,OAAOovB,cAAa,EAAO51B,EAAMoK,GAC/CxG,MAAK,SAAST,GACd,GAAGA,EAAS,oBAAqD,oBAA/BA,EAAS,mBAC1CwE,EAAKnG,GAAG6b,SAAS,6BACjB1V,EAAK5L,KAAO,OACZ4L,EAAKgvC,WAAW,+BAChBhvC,EAAKnG,GAAGmN,aAEJ,KAAGxL,EAAS,oBAAqD,oBAA/BA,EAAS,mBAK/C,MAAM,IAAIqJ,MAAM,kDAJhB7E,EAAKnG,GAAGgc,YACR7V,EAAKnG,GAAGgd,eAAerb,EAAS,sBAAuB,cAVlD,OAgBA,SAASua,GACf/V,EAAKnG,GAAGgc,YACLE,EAAM5Z,MAAQ4Z,EAAM5Z,KAAK,sBAC3B6D,EAAKnG,GAAGgd,eAAed,EAAM5Z,KAAK,sBAAuB,UAGzD6D,EAAKnG,GAAGmc,UAAUD,OASrB2W,EAAqB73B,UAAU+0B,KAAQ,SAASnyB,EAAKjD,EAAKJ,GACzD,IAAI4L,EAAO/J,KACX7B,EAAQA,GAAc,UACtB6B,KAAK4D,GAAG6b,SAAS,uBAAyBje,GAC1C,IAAIm5C,EAAU36C,KAAK4D,GAAGgF,OAAOG,iBAAiBO,YAC9C,OAAOtJ,KAAK4D,GAAGgF,OAAOmvB,UAAUv2B,EAAK,CAAC,oBAAqBjD,EAAK,oBAAsB,YAAcyB,KAAKsH,SACxGtB,MAAK,SAAST,GACd,IAAIq1C,EAAqB,UAARz8C,EAAoB4L,EAAK8wC,aAAat1C,GAAYA,EAChEwE,EAAK+uC,uBAEP/uC,EAAKnG,GAAGm2B,WAAW,2CACnBhwB,EAAKnG,GAAGgF,OAAOG,iBAAiB+xC,aAAaH,GAC7C5wC,EAAKgxC,gBAAgBH,KAGrB7wC,EAAKnG,GAAG6b,SAAS,mBACjB1V,EAAKnG,GAAGgF,OAAOG,iBAAiB+xC,aAAaH,GAC7C5wC,EAAKiuB,aAAa4iB,EAAW,CAAC,oBAAqB,YAAc7wC,EAAKzC,SAAStB,MAAK,SAAST,GAK5F,OAJAwE,EAAK5L,KAAO,OACZ4L,EAAKnG,GAAGgc,YACR7V,EAAKnG,GAAGmN,SACRhH,EAAKnG,GAAGm2B,WAAW,yCAA2Cv4B,GACvD+D,SAjBH,OAoBE,SAASua,GACjB/V,EAAKnG,GAAGgc,YACR7V,EAAKnG,GAAGmc,UAAUD,OAIpB2W,EAAqB73B,UAAUi8C,aAAe,SAASG,GACtD,IAAIC,EAAUj7C,KAAKk3B,OACnB,GAAkB,UAAfl3B,KAAKsH,OACP2zC,EAAUj7C,KAAKk3B,OAAS8jB,OAEpB,GAAkB,UAAfh7C,KAAKsH,OACZ,IAAI,IAAItK,KAAKg+C,EACZC,EAAQj+C,GAAKg+C,EAAGh+C,GAGlB,OAAOi+C,GAGRxkB,EAAqB73B,UAAUy6C,qBAAuB,WACrD,IAAI6B,EAAKz7C,SAASC,cAAc,QAChCw7C,EAAGv7C,aAAa,QAAS,gCACzB,IAAIo1B,EAAS,IAAI3a,EAAqBpa,KAAK4D,IAC3CmxB,EAAO5Z,aAAe,+BACtB,IAAIpR,EAAO/J,KACX+0B,EAAOra,OAAS,SAASsa,GACrBA,IACFjrB,EAAK4Q,IAAMqa,EACK,eAAbjrB,EAAK5L,MACP4L,EAAK5L,KAAO,cACZ4L,EAAKsV,eAGLtV,EAAK6vC,oBAIR,IAAInI,EAAQ1c,EAAO5jB,WAEnB,OADA+pC,EAAGr7C,YAAY4xC,GACRyJ,GAGRzkB,EAAqB73B,UAAUo7C,iBAAmB,WACjD,IAAIkB,EAAKz7C,SAASC,cAAc,OAChCw7C,EAAGv7C,aAAa,QAAS,wDACzB,IAAIw7C,EAAY,IAAIt8B,EAAuB7e,KAAK4D,GAAI,SAIpD,OAHAu3C,EAAU37B,mBAAmBxf,KAAK2a,KAClCwgC,EAAUz7B,YAAc,QACxBw7B,EAAGr7C,YAAYs7C,EAAUhqC,YAClB+pC,GAGRzkB,EAAqB73B,UAAUm8C,gBAAkB,SAASH,GACzD56C,KAAKk3B,OAAS0jB,EACd56C,KAAK84C,uBAAwB,EAC7B94C,KAAK7B,KAAO,OACZ6B,KAAKqf,YAAY,uBAGlBoX,EAAqB73B,UAAUk7C,iBAAmB,WACjD,IAAIoB,EAAKz7C,SAASC,cAAc,OAChCw7C,EAAGv7C,aAAa,QAAS,kDACzB,IAAIy7C,EAAQ37C,SAASC,cAAc,YAanC,OAZA07C,EAAMz7C,aAAa,QAAS,iDAC5By7C,EAAMz7C,aAAa,QAAS,QAC5By7C,EAAMz7C,aAAa,QAAS,wCACF,iBAAhBK,KAAKk3B,OACdkkB,EAAMn7C,UAAYD,KAAKk3B,OAEQ,UAAxB,EAAQl3B,KAAKk3B,UACpBkkB,EAAMn7C,UAAYkG,KAAKC,UAAUpG,KAAKk3B,OAAQ,EAAG,IAElDl3B,KAAKy6C,gBAAkBW,EACvBF,EAAGr7C,YAAYu7C,GACf1/B,EAAM7W,cAAc7E,KAAK4D,GAAIw3C,EAAO,SAAU,UACvCF,GAGRzkB,EAAqB73B,UAAUi7C,iBAAmB,WACjD,IACIqB,EAAKz7C,SAASC,cAAc,OAChCw7C,EAAGv7C,aAAa,QAAS,kDACzB,IAAIy7C,EAAQ37C,SAASC,cAAc,OAEnC,GADA07C,EAAMz7C,aAAa,QAAS,4CACF,iBAAhBK,KAAKk3B,OAAoB,CAClC,IAAIrzB,EAAM7D,KAAKk3B,OAAOr0B,QAAQ,KAAM,SAC5BA,QAAQ,KAAM,QACdA,QAAQ,KAAM,QACdA,QAAQ,KAAM,UACdA,QAAQ,KAAM,UACtBu4C,EAAMn7C,UAAY4D,MAEa,UAAxB,EAAQ7D,KAAKk3B,UACpBkkB,EAAMn7C,UAAYkG,KAAKC,UAAUpG,KAAKk3B,OAAQ,EAAG,IAIlD,OAFSxb,EAAM/X,mBAAmB3D,KAAK4D,GAAIw3C,EAAOF,EAAI,WAC9CA,EAAGr7C,YAAYu7C,GAChBF,GAGRzkB,EAAqB73B,UAAUm7C,mBAAqB,WACnD,IAAIlJ,EAAMpxC,SAASC,cAAc,OACjCmxC,EAAIlxC,aAAa,QAAS,0EAGtBwzC,EAAM1zC,SAASC,cAAc,QAC7BC,aAAa,QAAS,mGAC1B,IAAI2sC,EAAO7sC,SAASC,cAAc,QAClC4sC,EAAK3sC,aAAa,QAAS,wEAC3B2sC,EAAKzsC,YAAYJ,SAASK,eAAe,QACzCqzC,EAAItzC,YAAYysC,GAChB,IAAIpM,EAAUzgC,SAASC,cAAc,SACrCwgC,EAAOvgC,aAAa,OAAQ,QAC5BugC,EAAOvgC,aAAa,QAAS,kFAC7BugC,EAAOvgC,aAAa,cAAe,kCACnCwzC,EAAItzC,YAAYqgC,GAChB2Q,EAAIhxC,YAAYszC,IAEZA,EAAM1zC,SAASC,cAAc,QAC7BC,aAAa,QAAS,oGACtB07C,EAAO57C,SAASC,cAAc,SAC7BC,aAAa,QAAS,oGAC3B07C,EAAKx7C,YAAYJ,SAASK,eAAe,gBACzCqzC,EAAItzC,YAAYw7C,GAChB,IAAIC,EAAQ77C,SAASC,cAAc,UACnC47C,EAAM37C,aAAa,QAAS,wBAE5B,IAAI47C,EAAY97C,SAASC,cAAc,UACvC67C,EAAUt9C,MAAQ,UAClBs9C,EAAU17C,YAAYJ,SAASK,eAAe,iBAC9Cw7C,EAAMz7C,YAAY07C,GAClB,IASIpI,EAEAkI,EAXAG,EAAS/7C,SAASC,cAAc,UACpC87C,EAAOv9C,MAAQ,SACfu9C,EAAO37C,YAAYJ,SAASK,eAAe,gBAC3Cw7C,EAAMz7C,YAAY27C,GAClBF,EAAM37C,aAAa,QAAS,6CAC5BwzC,EAAItzC,YAAYw7C,GAChBlI,EAAItzC,YAAYy7C,GAChBzK,EAAIhxC,YAAYszC,IAEZA,EAAM1zC,SAASC,cAAc,QAC7BC,aAAa,QAAS,oGACtB07C,EAAO57C,SAASC,cAAc,SAC7BC,aAAa,QAAS,qEAC3B07C,EAAKx7C,YAAYJ,SAASK,eAAe,QACzC,IAAIvB,EAAMkB,SAASC,cAAc,SACjCnB,EAAIoB,aAAa,OAAQ,QACzBpB,EAAIoB,aAAa,QAAS,4DAC1BwzC,EAAItzC,YAAYw7C,GAChBlI,EAAItzC,YAAYtB,GAChBsyC,EAAIhxC,YAAYszC,GAChB,IAAIppC,EAAO/J,KAMX,OALAA,KAAKw6C,SAAW,WACZta,EAAOjiC,OACT8L,EAAK4pB,KAAKuM,EAAOjiC,MAAOM,EAAIN,MAAOq9C,EAAMr9C,QAGpC4yC,GAGR9zC,EAAOD,QAAQ25B,G,gBC3bd,IAAMhb,EAAaxc,EAAQ,GACrByc,EAAOzc,EAAQ,GACfC,EAAkBD,EAAQ,GAEhC,SAASo8B,EAAyBz3B,GACjC5D,KAAK4D,GAAKA,EA4FZ,SAASs1B,EAAqBt1B,GAC7B5D,KAAK4D,GAAKA,EACV5D,KAAKkJ,OAASlJ,KAAK4D,GAAGsF,SACtBlJ,KAAKqC,cAAgB,IACrBrC,KAAKsC,cAAgB,GA7FtB+4B,EAAyBz8B,UAAUuS,SAAW,WAC7C,IAAIsqC,EAAMh8C,SAASC,cAAc,OACjC+7C,EAAI97C,aAAa,QAAS,8BAC1B,IAAIoK,EAAO/J,KACX,GAAGA,KAAK4D,IAAM5D,KAAK4D,GAAGsF,SAAS,CACpBzJ,SAASC,cAAc,OAC7BC,aAAa,QAAS,uLACpB,IAAI6I,EAAM/I,SAASC,cAAc,OACjC8I,EAAI7I,aAAa,QAAS,SAC1B,IAAIs+B,EAAKx+B,SAASC,cAAc,MAChCu+B,EAAGt+B,aAAa,QAAS,eACzB6I,EAAI3I,YAAYo+B,GAChBwd,EAAI57C,YAAY2I,IAEZiI,EAAIhR,SAASC,cAAc,MAC7BC,aAAa,QAAS,oEACxB,IAAIkE,EAAM,WAAa7D,KAAK4D,GAAGsF,SAI/B,GAHAuH,EAAE5Q,YAAYJ,SAASK,eAAe+D,IACtCo6B,EAAGp+B,YAAY4Q,GAEZzQ,KAAK4D,GAAG0E,YAAY,iBAAiB,EAChCmI,EAAIhR,SAASC,cAAc,MAC7BC,aAAa,QAAS,qGACpBoK,EAAO/J,KACXyQ,EAAE1Q,iBAAiB,SAAS,WACxB2b,EAAMnT,oBAAoBvI,KAAM+J,GAChCA,EAAKnG,GAAGw1B,sBAER34B,EAAOhB,SAASC,cAAc,MAC7BC,aAAa,QAAS,iCAC3B8Q,EAAE5Q,YAAYY,GACVoD,EAAMpE,SAASK,eAAe,iBAClC2Q,EAAE5Q,YAAYgE,GACdo6B,EAAGp+B,YAAY4Q,GAGnB,GAAGzQ,KAAK4D,GAAG0E,YAAY,MAAM,EACrBmI,EAAIhR,SAASC,cAAc,MAC7BC,aAAa,QAAS,qGACpBoK,EAAO/J,KACXyQ,EAAE1Q,iBAAiB,SAAS,WACxB2b,EAAMnT,oBAAoBvI,KAAM+J,GAC7BA,EAAKnG,GAAGkb,KAGX/U,EAAKnG,GAAG0zB,yBAER72B,EAAOhB,SAASC,cAAc,MAC7BC,aAAa,QAAS,gCAC3B8Q,EAAE5Q,YAAYY,GACVoD,EAAMpE,SAASK,eAAe,kBAClC2Q,EAAE5Q,YAAYgE,GACdo6B,EAAGp+B,YAAY4Q,GAEnB,GAAGzQ,KAAK4D,GAAG0E,YAAY,mBAAmB,CACtC,IAAImI,KAAIhR,SAASC,cAAc,MAC7BC,aAAa,QAAS,qGACxB,IAQIc,EARAsJ,EAAO/J,KACXyQ,EAAE1Q,iBAAiB,SAAS,WACzB2b,EAAMnT,oBAAoBvI,KAAM+J,GAC5BA,EAAKnG,GAAGkb,KAGX/U,EAAKnG,GAAG01B,uBAER74B,EAAOhB,SAASC,cAAc,MAC7BC,aAAa,QAAS,iCAC3B8Q,EAAE5Q,YAAYY,GACVoD,EAAMpE,SAASK,eAAe,uBAClC2Q,EAAE5Q,YAAYgE,GACdo6B,EAAGp+B,YAAY4Q,IAG1B,OAAOgrC,GAGRpgB,EAAyBz8B,UAAU88C,kBAAoB,WACtD,IAAIC,EAAO37C,KAAK4D,GAAGgF,OAAOuvB,WAAWyjB,kBACjCpgC,EAAOmgC,GAAQA,EAAK,eAAiBA,EAAK,cAAc,UAAYA,EAAK,cAAc,UAAY37C,KAAK4D,GAAGsF,SAC3G2yC,EAAQF,GAAQA,EAAK,iBAAmBA,EAAK,gBAAgB,UAAYA,EAAK,gBAAgB,UAAY,GAC9GE,GAAQ,gBAAiB77C,KAAK4D,GAAGsF,SACjC,IAAImhB,EAAM5qB,SAASC,cAAc,QAKjC,OAJA2qB,EAAI1qB,aAAa,QAAS,yBAC1B0qB,EAAI1qB,aAAa,QAASk8C,GAC1BxxB,EAAIxqB,YAAYJ,SAASK,eAAe0b,IACrC6O,EAAO5qB,SAASC,cAAc,QAWlCw5B,EAAqBt6B,UAAUuS,SAAW,SAASxQ,GAClD,IAAIoJ,EAAO/J,KACP87B,EAAKr8B,SAASC,cAAc,QAEhC,GADAo8B,EAAGn8B,aAAa,QAAS,6BACtBK,KAAK4D,GAAGsF,SAAS,CACnB,IAAI2nC,EAAMpxC,SAASC,cAAc,QAKjC,GAJAmxC,EAAIlxC,aAAa,QAAS,wBACvBK,KAAK4D,GAAGqzB,SAAS,UAGjBj3B,KAAK4D,GAAGqzB,SAAS,iBAAiB,CACpC,IAAI6kB,EAAQr8C,SAASC,cAAc,UACnCo8C,EAAMn8C,aAAa,QAAS,sEAC5Bm8C,EAAMj8C,YAAYJ,SAASK,eAAe,eAC1Cg8C,EAAM/7C,iBAAiB,SAAS,WAG/BgK,EAAKnG,GAAGw1B,qBAIV,GAAGp5B,KAAK4D,GAAGqzB,SAAS,mBAAmB,CACtC,IAAI8kB,EAAQt8C,SAASC,cAAc,UACnCq8C,EAAMp8C,aAAa,QAAS,kEAC5Bo8C,EAAMl8C,YAAYJ,SAASK,eAAe,wBAC1Ci8C,EAAMh8C,iBAAiB,SAAS,WAC5BgK,EAAKnG,GAAGkb,KAGX/U,EAAKnG,GAAGo2B,gBACRjwB,EAAKnG,GAAG01B,sBAIPt5B,KAAK4D,GAAGqzB,SAAS,OACnB4Z,EAAIhxC,YAAYG,KAAKg8C,gBAEtBlgB,EAAGj8B,YAAYgxC,QAGf9mC,EAAKnG,GAAGw1B,kBAIT,OAAO0C,GAGR5C,EAAqBt6B,UAAUq9C,oBAAsB,WACpD,IAAIpL,EAAMpxC,SAASC,cAAc,QACjCmxC,EAAIlxC,aAAa,QAAS,kDAC1B,IAAIu8C,EAAMz8C,SAASC,cAAc,QACjCw8C,EAAIv8C,aAAa,QAAS,uCAC1Bu8C,EAAIr8C,YAAYJ,SAASK,eAAe,2BACxC,IAAIsyC,EAAM3yC,SAASC,cAAc,QAKjC,OAJA0yC,EAAIzyC,aAAa,QAAS,uCAC1ByyC,EAAIvyC,YAAYJ,SAASK,eAAeE,KAAK4D,GAAGsF,WAChD2nC,EAAIhxC,YAAYq8C,GAChBrL,EAAIhxC,YAAYuyC,GACTvB,GAGR3X,EAAqBt6B,UAAUu9C,kBAAoB,SAASC,EAAUhzC,EAAMhH,GAC3E,IAAI2H,EAAO/J,KACPmC,EAAO1C,SAASC,cAAc,KAQlC,OANAyC,EAAKxC,aAAa,QAAS,0BAC3BT,EAAgBmf,kBAAkBlc,EAAMC,EAAMpC,KAAKqC,cAAerC,KAAKsC,eACvE85C,EAAUr8C,iBAAiB,SAAS,WACnCgK,EAAKnG,GAAGozB,YAAY5tB,GACpBW,EAAKnG,GAAGwgB,oBAEFjiB,GAGR+2B,EAAqBt6B,UAAUo9C,aAAe,WAC7C,IAAIjyC,EAAO/J,KACPq8C,EAAM58C,SAASC,cAAc,OAC7B48C,EAAQ78C,SAASC,cAAc,MACnC48C,EAAM38C,aAAa,QAAS,+CAC5B28C,EAAMz8C,YAAYJ,SAASK,eAAe,wBAC1Cu8C,EAAIx8C,YAAYy8C,GAChB,IAAIzL,EAAMpxC,SAASC,cAAc,SACjCmxC,EAAIlxC,aAAa,QAAS,0DAC1B,IAAI8e,EAAQhf,SAASC,cAAc,SAC/Bgf,EAAMjf,SAASC,cAAc,MAC7B68C,EAAM98C,SAASC,cAAc,MACjC68C,EAAI18C,YAAYJ,SAASK,eAAe,OACxCy8C,EAAI58C,aAAa,QAAS,iDAC1B,IAAI68C,EAAM/8C,SAASC,cAAc,MACjC88C,EAAI38C,YAAYJ,SAASK,eAAe,UACxC08C,EAAI78C,aAAa,QAAS,oDAC1B,IAAI88C,EAAMh9C,SAASC,cAAc,MACjC+8C,EAAI58C,YAAYJ,SAASK,eAAe,gBACxC28C,EAAI98C,aAAa,QAAS,0DAC1B,IAAI+8C,EAAMj9C,SAASC,cAAc,MACjCg9C,EAAI/8C,aAAa,QAAS,mDAC1B+8C,EAAI78C,YAAYJ,SAASK,eAAe,SACxC,IAAI68C,EAAMl9C,SAASC,cAAc,MACjCi9C,EAAIh9C,aAAa,QAAS,sDAC1Bg9C,EAAI98C,YAAYJ,SAASK,eAAe,YACxC,IAAI88C,EAAMn9C,SAASC,cAAc,MACjCk9C,EAAI/8C,YAAYJ,SAASK,eAAe,WACxC88C,EAAIj9C,aAAa,QAAS,qDAC1B+e,EAAI7e,YAAY08C,GAChB79B,EAAI7e,YAAY28C,GAChB99B,EAAI7e,YAAY48C,GAGhB/9B,EAAI7e,YAAY+8C,GAChBn+B,EAAM5e,YAAY6e,GAClBmyB,EAAIhxC,YAAY4e,GAChB,IAAIP,EAAQze,SAASC,cAAc,SAC/Bm9C,EAAS78C,KAAK4D,GAAGgF,OAAOuvB,WAAW2kB,qBACvC,IAAI,IAAIC,KAAUF,EAAO,CACxB,IAAI/L,EAAQ+L,EAAOE,GACb3zC,EAAO2zC,EAAOl7C,MAAM,KAAK,GAC3Bsc,EAAK1e,SAASC,cAAc,MAC5Bs9C,EAAMv9C,SAASC,cAAc,MACjCs9C,EAAIn9C,YAAYG,KAAKm8C,kBAAkBa,EAAI5zC,EAAMA,IACjD4zC,EAAIr9C,aAAa,QAAS,sCAC1B,IAAIs9C,EAAMx9C,SAASC,cAAc,MACjCu9C,EAAIt9C,aAAa,QAAS,yCAC1B,IAAIkE,EAAOitC,GAASA,EAAM,eAAiBA,EAAM,cAAc,UAAYA,EAAM,cAAc,UAAY,GAC3GmM,EAAIp9C,YAAYG,KAAKm8C,kBAAkBc,EAAI7zC,EAAMvF,IACjD,IAAIq5C,EAAMz9C,SAASC,cAAc,MACjCw9C,EAAIv9C,aAAa,QAAS,+CACtBkE,EAAOitC,GAASA,EAAM,iBAAmBA,EAAM,gBAAgB,UAAYA,EAAM,gBAAgB,UAAY,GACjHoM,EAAIr9C,YAAYG,KAAKm8C,kBAAkBe,EAAI9zC,EAAMvF,IACjD,IAAIs5C,EAAM19C,SAASC,cAAc,MACjCy9C,EAAIx9C,aAAa,QAAS,wCACtBkE,EAAOitC,GAASA,EAAM,kBAAoBA,EAAM,iBAAiB,UAAYA,EAAM,iBAAiB,UAAY,GACpHqM,EAAIt9C,YAAYG,KAAKm8C,kBAAkBgB,EAAI/zC,EAAMvF,IACjD,IAAIu5C,EAAM39C,SAASC,cAAc,MACjC09C,EAAIz9C,aAAa,QAAS,2CACtBkE,EAAOitC,GAASA,EAAM,0BAA4BA,EAAM,yBAAyB,UAAYA,EAAM,yBAAyB,UAAY,GAC5IsM,EAAIv9C,YAAYG,KAAKm8C,kBAAkBiB,EAAIh0C,EAAMvF,IACjD,IAAIw5C,EAAM59C,SAASC,cAAc,MAE3B,GADN29C,EAAI19C,aAAa,QAAS,aACjBK,KAAKs9C,kBAAkBl0C,GAAM,CAExB,IAIIwhC,EALR,GAAG5qC,KAAK4D,GAAGpD,gBAAgB,iBACnBoqC,EAASnrC,SAASC,cAAc,MACnCC,aAAa,QAAS,qDAGnBirC,EAASnrC,SAASC,cAAc,WACtCG,YAAYJ,SAASK,eAAe,WAC3C8qC,EAAOjrC,aAAa,QAAS,qDAYjCirC,EAAO7qC,iBAAiB,QATZ,SAAS+e,GACpB,OAAO,WAEe,GADDg0B,QAAQ,yBAAD,OAA0Bh0B,EAA1B,gBAExB/U,EAAKnG,GAAG4gB,eAAe1F,IAKKy+B,CAAMn0C,IACvCi0C,EAAIx9C,YAAY+qC,GAGjBzsB,EAAGte,YAAYm9C,GACf7+B,EAAGte,YAAYo9C,GACf9+B,EAAGte,YAAYq9C,GAGf/+B,EAAGte,YAAYw9C,GACfn/B,EAAMre,YAAYse,GAKnB,GAHA0yB,EAAIhxC,YAAYqe,GAChBm+B,EAAIx8C,YAAYgxC,GAEb7wC,KAAK4D,GAAGpD,gBAAgB,cACX,IAAIib,EAAWiH,cAAc1iB,KAAK4D,IACpCwZ,KAAKyzB,GAEnB,OAAOwL,GAGRnjB,EAAqBt6B,UAAU0+C,kBAAoB,SAASl0C,GAC3D,MAAW,YAARA,KACApJ,KAAK4D,GAAGgF,OAAOuvB,WAAWsD,mBAAmB,kBAAmBryB,IAIpErM,EAAOD,QAAU,CAACo8B,uBAAqBmC,6B,cCxSvC,SAAS1E,EAAkB/yB,EAAIymB,GAC9BrqB,KAAK4D,GAAKA,EACV5D,KAAKqqB,IAAMA,EACXrqB,KAAKw9C,WAAY,EACjBx9C,KAAKy9C,WAAY,EAGlB9mB,EAAkB/3B,UAAU8+C,YAAc,WACzC,OAAOj+C,SAASK,eAAe,YAGhC62B,EAAkB/3B,UAAU25C,gBAAkB,SAASoF,EAAI7kB,EAAO8kB,EAAMC,GACvE,IAAI1K,EAAM1zC,SAASC,cAAc,OACjCyzC,EAAIxzC,aAAa,QAAS,kHAAkHm5B,GAC5I,IAAItd,EAAM/b,SAASC,cAAc,QAOjC,OANA8b,EAAI7b,aAAa,QAAS,uFAAuFm5B,GACjHtd,EAAI3b,YAAYJ,SAASK,eAAe89C,IACxCD,EAAGh+C,aAAa,OAAQ,QACxBg+C,EAAGh+C,aAAa,cAAek+C,GAC/B1K,EAAItzC,YAAY2b,GAChB23B,EAAItzC,YAAY89C,GACTxK,GAGRxc,EAAkB/3B,UAAUuS,SAAW,WACtC,IAAI0/B,EAAMpxC,SAASC,cAAc,OACjCmxC,EAAIlxC,aAAa,QAAS,qCAC1B,IAAIm+C,EAAOr+C,SAASC,cAAc,MAClCo+C,EAAKn+C,aAAa,QAAS,qEAC3Bm+C,EAAKj+C,YAAYJ,SAASK,eAAe,+BACzC+wC,EAAIhxC,YAAYi+C,GAChB,IAAI5K,EAAMzzC,SAASC,cAAc,OACjCwzC,EAAIvzC,aAAa,QAAS,wBAC1BkxC,EAAIhxC,YAAYqzC,GAChBlzC,KAAKw9C,UAAY/9C,SAASC,cAAc,SACxCM,KAAKw9C,UAAU79C,aAAa,QAAS,uFAClCK,KAAKqqB,MACPrqB,KAAKw9C,UAAUv/C,MAAQ+B,KAAKqqB,KAE7B6oB,EAAIrzC,YAAYG,KAAKu4C,gBAAgBv4C,KAAKw9C,UAAW,UAAW,MAAO,oBACvEx9C,KAAKy9C,UAAYh+C,SAASC,cAAc,SACxCM,KAAKy9C,UAAU99C,aAAa,QAAS,0DACrCuzC,EAAIrzC,YAAYG,KAAKu4C,gBAAgBv4C,KAAKy9C,UAAW,UAAW,MAAO,mBACvE,IAAIM,EAAWt+C,SAASC,cAAc,OACtCq+C,EAASp+C,aAAa,QAAS,4BAC/B,IAAIg0C,EAAUl0C,SAASC,cAAc,UACrCi0C,EAAQh0C,aAAa,QAAS,0DAC9Bg0C,EAAQ9zC,YAAYJ,SAASK,eAAe,YAC5C,IAAIiK,EAAO/J,KAQX,OAPA2zC,EAAQ5zC,iBAAiB,SAAS,WAC9BgK,EAAKyzC,UAAUv/C,OACjB8L,EAAKnG,GAAG+vB,KAAK5pB,EAAKyzC,UAAUv/C,MAAO8L,EAAK0zC,UAAUx/C,UAGpD8/C,EAASl+C,YAAY8zC,GACrBT,EAAIrzC,YAAYk+C,GACTlN,GAIR9zC,EAAOD,QAAQ65B","file":"terminus-dashboard.min.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 16);\n","const TerminusPluginManager = require('../plugins/TerminusPlugin');\r\n\r\nlet HTMLFrameHelper = {};\r\n\r\nHTMLFrameHelper.getActionControl = function(type, control, label, callback, disabled){\r\n\tvar pman = new TerminusPluginManager();\r\n\tvar dpropDOM = document.createElement(\"span\");\r\n\tdpropDOM.setAttribute(\"class\", \"terminus-action-control terminus-save-btn \" + type + \"-\" + control);\r\n\tvar pman = new TerminusPluginManager();\r\n    /*if(pman.pluginAvailable(\"font-awesome\")){\r\n\t\tvar icon = document.createElement('icon');\r\n\t\tvar faic = this.getControlIcon(control);\r\n\t\tif(disabled){\r\n\t\t\ticon.setAttribute(\"class\", \"terminus-frame-control frame-control-action action-disabled fa fa\" + faic + \" \" + type + \"-\" + control + \"-disabled terminus-font-align\");\r\n\t\t\ticon.setAttribute(\"title\", disabled);\r\n\t\t}\r\n\t\telse {\r\n\t\t\ticon.setAttribute(\"class\", \"terminus-frame-control frame-control-action frame-control-action fa fa\" + faic + \" \" + type + \"-\" + control + \" terminus-font-align\");\r\n\t\t\ticon.addEventListener(\"click\", function(){\r\n\t\t\t\tcallback(control);\r\n\t\t\t});\r\n\t\t}\r\n\t\tdpropDOM.appendChild(icon);\r\n\t}\r\n\telse{*/\r\n\t\tvar button = document.createElement(\"button\");\r\n\t\tbutton.appendChild(document.createTextNode(label));\r\n\t\tif(disabled){\r\n\t\t\tbutton.setAttribute(\"class\", \"terminus-frame-control terminus-frame-btn frame-control-action action-disabled \" + type + \"-\" + control + \"-disabled\");\r\n\t\t\tbutton.setAttribute(\"title\", disabled);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tbutton.setAttribute(\"class\", \"terminus-frame-control terminus-frame-btn frame-control-action \" + type + \"-\" + control);\r\n\t\t\tbutton.addEventListener(\"click\", function(){\r\n\t\t\t\tif(this.innerHTML == 'Save'){\r\n\t\t\t\t\tvar objId = document.getElementsByClassName('terminus-object-id-input');\r\n\t\t\t\t\tif(objId.length>0){\r\n\t\t\t\t\t\tif(!objId[0].value){\r\n\t\t\t\t\t\t\tobjId[0].setAttribute('placeholder', 'Required field');\r\n\t\t\t\t\t\t\tobjId[0].style.background = '#f8d7da';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse callback(control);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse callback(control);\r\n\t\t\t\t}\r\n\t\t\t\telse callback(control);\r\n\t\t\t\t//(control);\r\n\t\t\t});\r\n\t\t}\r\n\t\tdpropDOM.appendChild(button);\r\n\t//}\r\n\treturn dpropDOM;\r\n}\r\n\r\nHTMLFrameHelper.getSettingsControl = function(view){\r\n\tvar pman = new TerminusPluginManager();\r\n\tif(pman.pluginAvailable(\"font-awesome\")){\r\n\t\tvar icon = document.createElement('icon');\r\n\t\tif(view == 'property') icon.setAttribute('class', 'fa fa-cog terminus-pointer');\r\n\t\telse if(view == 'data') icon.setAttribute('class', 'fa fa-edit terminus-pointer');\r\n\t\ticon.setAttribute('style', 'margin: 10px;')\r\n\t\treturn icon;\r\n\t}\r\n\telse{\r\n\t\tvar button = document.createElement(\"button\");\r\n\t\tbutton.setAttribute('class', 'terminus-btn');\r\n\t\tbutton.appendChild(document.createTextNode('Settings'));\r\n\t\treturn button;\r\n\t}\r\n}\r\n\r\nHTMLFrameHelper.getControlIcon = function(control){\r\n\tvar icon;\r\n\tswitch(control){\r\n\t\tcase 'delete':\r\n\t\t\ticon = '-alt-delete';\r\n\t\tbreak;\r\n\t\tcase 'add':\r\n\t\t\ticon = '-plus';\r\n\t\tbreak;\r\n\t\tcase 'reset':\r\n\t\t\ticon = '-undo';\r\n\t\tbreak;\r\n\t\tcase 'save':\r\n\t\t\ticon = '-save';\r\n\t\tbreak;\r\n\t\tcase 'hide':\r\n\t\t\ticon = '-eye-slash';\r\n\t\tbreak;\r\n\t}\r\n\treturn icon;\r\n}\r\n\r\nHTMLFrameHelper.getSelectionControl = function(type, options, selected, callback){\r\n\tvar sel = document.createElement(\"select\");\r\n\tsel.setAttribute(\"class\", \"terminus-frame-selector frame-control-selection \" + type);\r\n\tfor(var i = 0; i < options.length; i++){\r\n\t\tvar opt = document.createElement(\"option\");\r\n\t\tif(typeof options[i] == \"object\"){\r\n\t\t\topt.value = options[i].value;\r\n\t\t\tvar label = (options[i].label ?  document.createTextNode(options[i].label) : document.createTextNode(TerminusClient.FrameHelper.labelFromURL(options[i].value)));\r\n\t\t\topt.appendChild(label);\r\n\t\t}\r\n\t\telse {\r\n\t\t\topt.value = options[i];\r\n\t\t\tlabel = TerminusClient.FrameHelper.labelFromURL(opt.value);\r\n\t\t\topt.appendChild(document.createTextNode(label));\r\n\t\t}\r\n\t\tif(selected == opt.value){\r\n\t\t\topt.setAttribute(\"selected\", \"selected\");\r\n\t\t}\r\n\t\tsel.appendChild(opt);\r\n\t}\r\n\tsel.addEventListener(\"change\", function(){\r\n\t\tcallback(this.value);\r\n\t});\r\n\treturn sel;\r\n}\r\n\r\nHTMLFrameHelper.getModeSelectorDOM = function(which, renderer){\r\n\tvar viewsDOM = document.createElement(\"span\");\r\n\tviewsDOM.setAttribute(\"class\", \"terminus-mode terminus-\"+which+\"-mode\");\r\n\tif(renderer.mode == \"view\"){\r\n\t\tvar callback = function(){ renderer.setMode(\"edit\");}\r\n\t\tviewsDOM.appendChild(HTMLFrameHelper.getActionControl(\"terminus-mode terminus-\"+which+\"-mode\", \"edit\", \" Edit \", callback));\r\n\t}\r\n\telse if(renderer.isNew()){\r\n\t\treturn false;\r\n\t}\r\n\telse {\r\n\t\tvar callback = function(){ renderer.cancel();}\r\n\t\tviewsDOM.appendChild(HTMLFrameHelper.getActionControl(which, \"cancel\", \"Cancel\", callback));\r\n\t}\r\n\treturn viewsDOM;\r\n}\r\n\r\nHTMLFrameHelper.goToName = function(s, p, i){\r\n\tvar url = window.location.href;\r\n\tif(url){\r\n\t\tvar wbits = url.split(\"#\");\r\n\t\tvar loc = wbits[0];\r\n\t\tvar sh = TerminusClient.FrameHelper.getShorthand(s);\r\n\t    if(!sh) sh = s;\r\n\t\tvar bits = sh.split(\":\");\r\n\t\tif(bits.length > 1) sh = bits[1];\r\n\t\tvar htmlid = sh;\r\n\t\tif(p){\r\n\t\t\tvar prop = TerminusClient.FrameHelper.getShorthand(p);\r\n\t\t\tif(!prop ) prop = p;\r\n\t\t\tvar bits = prop.split(\":\");\r\n\t\t\tif(bits.length > 1) prop = bits[1];\r\n\t\t\thtmlid += \"_\" + prop;\r\n\t\t\tif(i){\r\n\t\t\t\thtmlid += \"_\" + i;\r\n\t\t\t}\r\n\t\t}\r\n\t\twindow.location = loc + \"#\" + htmlid;\r\n\t}\r\n}\r\n\r\nHTMLFrameHelper.wrapShortenedText = function(wrap, text, max_cell_size, max_word_size){\r\n\tif(max_cell_size && (text.length > max_cell_size)){\r\n\t\twrap.setAttribute(\"title\", text);\r\n\t\ttext = text.substring(0, max_cell_size) + \"...\";\r\n\t}\r\n\tif(max_word_size){\r\n\t\tconst replacements = {}\r\n\t\tconst words = text.split(\" \");\r\n\t\tfor(var i = 0; i < words.length; i++){\r\n\t\t\tvar word = words[i];\r\n\t\t\tif(word.length > max_word_size){\r\n\t\t\t\twrap.setAttribute(\"title\", text);\r\n\t\t\t\tvar newstr = word.substring(0, max_word_size) + \"...\";\r\n\t\t\t\treplacements[word] = newstr;\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor(var k in replacements){\r\n\t\t\ttext = text.replace(k, replacements[k]);\r\n\t\t}\r\n\t}\r\n\twrap.appendChild(document.createTextNode(text));\r\n}\r\n\r\nHTMLFrameHelper.getVariableValueFromBinding = function(varname, bind){\r\n\tfor(var key in bind){\r\n\t\tvar skey = key.substring(key.lastIndexOf(\"/\")+1);\r\n\t\tif(skey == varname){\r\n\t\t\tconst obj = bind[key];\r\n\t\t\tif(typeof obj == \"object\" && obj['@value']) return obj['@value'];\r\n\t\t\treturn obj;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\n\r\n/*HTMLFrameHelper.getFrameRow = function(){\r\n\tvar row = document.createElement('div');\r\n\trow.setAttribute('class', 'terminus-frame-row');\r\n\treturn row;\r\n}\r\n\r\nHTMLFrameHelper.getFrameGroup = function(frow){\r\n\tvar fl = document.createElement('div');\r\n\tfl.setAttribute('class', 'terminus-frame-length');\r\n\tfrow.appendChild(fl);\r\n\r\n\tvar fg = document.createElement('div');\r\n\tfg.setAttribute('class', 'terminus-frame-group');\r\n\tfl.appendChild(fg);\r\n\treturn fl;\r\n}*/\r\n\r\nHTMLFrameHelper.getInfoboxDOM = function(type, label, value, help, input){\r\n\t/*var frow = this.getFrameRow();\r\n\tvar fgroup = this.getFrameGroup(frow);*/\r\n\tvar infoDOM = document.createElement(\"span\");\r\n\tinfoDOM.setAttribute(\"class\", \"terminus-frame-infobox-box \" + \"terminus-\" +type );\r\n\t//fgroup.appendChild(infoDOM);\r\n\tif(help){\r\n\t\tinfoDOM.setAttribute(\"title\", help);\r\n\t}\r\n\tif(label){\r\n\t\tvar linfo = document.createElement(\"span\");\r\n\t\tlinfo.setAttribute(\"class\", \"terminus-frame-infobox-label \" + \"terminus-\" +type + \"-label\");\r\n\t\tlinfo.appendChild(document.createTextNode(label));\r\n\t\tinfoDOM.appendChild(linfo);\r\n\t}\r\n\tvar lspacer = document.createElement(\"span\");\r\n\tlspacer.setAttribute(\"class\", \"terminus-frame-infobox-spacer \" + \"terminus-\" +type + \"-spacer\");\r\n\tlspacer.appendChild(document.createTextNode(\" \"));\r\n\tinfoDOM.appendChild(lspacer);\r\n\tvar lval = document.createElement(\"span\");\r\n\tlval.setAttribute(\"class\", \"terminus-frame-infobox-value \" + \"terminus-\" +type + \"-value terminus-property-label-align\");\r\n\tif(input){\r\n\t\tinput.value = value;\r\n\t\tlval.appendChild(input);\r\n\t}\r\n\telse if(value) {\r\n\t\tvar sh = TerminusClient.FrameHelper.getShorthand(value);\r\n        if(sh){\r\n    \t   \tvar bits = sh.split(\":\");\r\n            sh = bits[1];\r\n   \t\t\tlval.setAttribute(\"title\", value);\r\n\t\t\tlval.appendChild(document.createTextNode(sh));\r\n\t\t}\r\n\t\telse {\r\n\t\t\tlval.appendChild(document.createTextNode(value));\r\n\t\t}\r\n\t}\r\n\tinfoDOM.appendChild(lval);\r\n\treturn infoDOM;\r\n}\r\n\r\nmodule.exports=HTMLFrameHelper\r\n","/**\r\n * @file Javascript Api explorer tool\r\n * @author Kitty Jose\r\n * @license Copyright 2018-2019 Data Chemist Limited, All Rights Reserved. See LICENSE file for more\r\n *\r\n * @summary Set of functions used across scripts\r\n */\r\nconst Codemirror= require('./plugins/codemirror.terminus');\r\n// function to read Files\r\nfunction readFile(file){\r\n    if (window.XMLHttpRequest){\r\n        // code for IE7+, Firefox, Chrome, Opera, Safari\r\n        xmlhttp=new XMLHttpRequest();\r\n    }\r\n    else{\r\n        // code for IE6, IE5\r\n        xmlhttp=new ActiveXObject(\"Microsoft.XMLHTTP\");\r\n    }\r\n    xmlhttp.open(\"GET\",file,false);\r\n    xmlhttp.send();\r\n    xmlDoc=xmlhttp.responseText;\r\n    return xmlDoc;\r\n} // readFile()\r\n\r\n// function to write api call signatures from woql client\r\nfunction getFunctionSignature(which){\r\n  var sigs = {};\r\n  sigs.connect = {\r\n    spec   : \"WOQLClient.connect(surl, key)\",\r\n    descr  : \"\\n\\nConnect to a Terminus server at the given URI with an API key\"\r\n                + \"Stores the terminus:ServerCapability document returned in the connection register\"\r\n                + \"which stores, the url, key, capabilities, and database meta-data for the connected server\"\r\n                + \"If the curl argument is false or null, the this.server will be used if present,\"\r\n                + \" or the promise will be rejected.\"\r\n                + \"\\n1)The first (surl) argument: {string} argument it is the Server Url\"\r\n                + \"\\n2)The second(key) argument: {string} argument contains an API key\",\r\n    result : \"HTTP 200 on success, 409 for already existing database, otherwise error code\",\r\n    args   : {server_url : 'url', key: 'Api key'},\r\n    options: { title: \"\", description: \"\" }\r\n  };\r\n  sigs.create = {\r\n    spec    : \"WOQLClient.createDatabase(dburl, details, key)\",\r\n    descr   : \"\\n\\nCreate a Terminus Database\"\r\n                + \"\\n1)The first (dburl) argument:{string}, it is a terminusDB Url or a terminusDB Id \"\r\n                + \"\\n2)The second(details) argument:{object}, details which is the payload\"\r\n                + \"\\n which included information of the new database to be created\"\r\n                +  \"\\n3)The third (key) argument:{string}, contains an API key \",\r\n    result : \"HTTP 200 on success, 409 for already existing database, otherwise error code\",\r\n    args   : {database_url : 'url', details: '', key: ' Api key'},\r\n    options: { title: \"\", description: \"\" }\r\n  };\r\n  sigs.delete = {\r\n      spec  : \"WOQLClient.deleteDatabase(dburl, key)\",\r\n      descr : \"\\n\\nDeletes a Database\"\r\n                + \"\\n1)The first (dburl) argument: {string}, it is a terminusDB Url or a terminusDB Id \"\r\n                + \"\\n2)The second(key) argument: {string}, contains an API key\",\r\n      result: \"HTTP 200 on success, otherwise error code\",\r\n  };\r\n  sigs.getSchema = {\r\n    spec   : \"WOQLClient.getSchema(surl, options)\",\r\n    descr  : \"\\n\\nGets the schema of a database.\"\r\n             +\"\\n1)The first (surl) argument: {string}, it is a dbUrl/schema\"\r\n             + \"\\n2)The second(key) argument: {string}, contains an API key\",\r\n    result : \"Ontology Document on success (HTTP 200), 409 for already existing database, otherwise error code\",\r\n    options: { format: \"turtle\" }\r\n  };\r\n  sigs.getClassFrames = {\r\n    spec   : \"WOQLClient.getClassFrame = function(cfurl, cls, opts)\",\r\n    descr  : \"\\n\\nRetrieves a WOQL query on the specified database which updates the state and returns the results\"\r\n              +  \"\\nThe first (cfurl) argument can be\"\r\n              + \"\\n1) a valid URL of a terminus database or\"\r\n              +  \"\\n2) omitted - the current database will be used\"\r\n              +  \"\\nthe second argument (cls) is the URL / ID of a document class that exists in the database schema\"\r\n              +  \"\\nthe third argument (opts) is an options json - opts.key is an optional API key\",\r\n    result : \"Ontology Document on success (HTTP 200), 409 for already existing database, otherwise error code\",\r\n    options: { format: \"turtle\" }\r\n  };\r\n  sigs.updateSchema = {\r\n    spec    : \"WOQLClient.updateSchema(schurl, docs, options)\",\r\n    descr   : \"\\n\\nUpdates the Schema of the specified database\"\r\n                +\"\\n1)The first (surl) argument :{string}, is a dbUrl/schema\"\r\n                + \"\\n2)The second(docs) argument:{object}, is a valid owl ontology (new schema to be updated) in turtle format\"\r\n                + \"\\n3)The third (key) argument:{string}, contains an API key\",\r\n    result : \"Ontology Document on success (HTTP 200), 409 for already existing database, otherwise error code\",\r\n    args   : {document : 'doc'},\r\n    options: { format: \"turtle\", editmode: \"replace\"}\r\n  };\r\n  sigs.createDocument = {\r\n    spec   : \"WOQLClient.createDocument(docurl, document, options)\",\r\n    descr  : \"\\n\\nCreates a new document in the specified database\"\r\n              + \"\\n1)The first (docurl) argument: {string}, is a dbUrl/document/document_id\"\r\n              + \"\\n2)The second(document) argument: {object}, is a valid document in json-ld\"\r\n              + \"\\n3)The third (key) argument:{string}, contains an API key\",\r\n    result : \"Created Document on success (HTTP 200), Violation Report Otherwise (HTTP 400+)\",\r\n    args   : {document_url : 'url', document: \"doc\"},\r\n    options: { format: \"turtle\", fail_on_id_denied: false}\r\n  };\r\n  sigs.viewDocument = {\r\n    spec    : \"WOQLClient.getDocument(docurl, options)\",\r\n    descr   : \"\\n\\nRetrieves a document from the specified database\"\r\n              + \"\\n1)The first (docurl) argument: {string}, is a dbUrl/document/document_id\"\r\n              + \"\\n2)The second (key) argument: {string}, contains an API key\",\r\n    result : \"Document (HTTP 200), Violation Report Otherwise (HTTP 400+)\",\r\n    args   : {document_url : 'url'},\r\n    options: { format: \"turtle\"}\r\n  };\r\n  sigs.updateDocument = {\r\n    spec   : \"WOQLClient.updateDocument(docurl, document, options)\",\r\n    descr  : \"\\n\\nUpdates a document in the specified database with a new version\"\r\n                + \"\\n1)The first (docurl) argument: {string}, is a dbUrl/document/document_id\"\r\n                + \"\\n2)The second(document) argument: {object}, is a valid document in json-ld\"\r\n                + \"\\n3)The third (key) argument:{string} argument contains an API key\",\r\n    result : \"Ontology Document on success (HTTP 200), 409 for already existing database, otherwise error code\",\r\n    args   : {document_url : 'url', document: \"doc\"},\r\n    options: { format: \"turtle\", editmode: \"replace\"}\r\n  };\r\n  sigs.deleteDocument = {\r\n    spec  : \"WOQLClient.deleteDocument(docurl, key)\",\r\n    descr : \"\\n\\nDeletes a document from the specified database\"\r\n            + \"\\n1)The first (docurl) argument: {string},is a dbUrl/document/document_id\"\r\n            + \"\\n2)The second (key) argument: {string}, contains an API key\",\r\n    result: \"Ontology Document on success (HTTP 200), 409 for already existing database, otherwise error code\",\r\n    args  : {document_url : 'url'},\r\n  };\r\n  sigs.select = {\r\n    spec: \"WOQLClient.select(dburl, query, options)\",\r\n    descr: \"\\n\\nExecutes a read-only WOQL query on the specified database and returns the results\"\r\n              + \"\\n1)The first (docurl) argument: {string}, is a terminusDB Url or a terminusDB Id\"\r\n              + \"\\n2)The second (query) argument: {object}, a valid query in json-ld format \"\r\n              + \"\\n3)The third (key) argument:{string}, contains an API key\",\r\n    result: \"WOQL Result (HTTP 200), otherwise error code\",\r\n    args: {woql: 'woql'},\r\n  };\r\n  sigs.update = {\r\n    spec  : \"WOQLClient.update(dburl, query, options)\",\r\n    descr : \"\\n\\nExecutes a WOQL query on the specified database which updates the state and returns the results\"\r\n              + \"\\n1)The first (dburl) argument: {string}, is a terminusDB Url or a terminusDB Id\"\r\n              + \"\\n2)The second (query) argument: {object}, a valid query in json-ld format \"\r\n              + \"\\n3)The third (key) argument:{string}, contains an API key\",\r\n    result: \"WOQL Result (HTTP 200), otherwise error code\",\r\n    args  : {woql: 'woql'},\r\n  };\r\n  sigs.lookup = {\r\n    spec: \"WOQLClient.lookup(database_url, woql, options)\",\r\n    result: \"WOQL Result (HTTP 200), otherwise error code\",\r\n    args: {class: 'url', term: 'string'},\r\n  };\r\n  sigs.map = {\r\n    spec: \"WOQLClient.lookup(source, target, woql, options)\",\r\n    result: \"WOQL Result (HTTP 200), otherwise error code\",\r\n    args: {source: 'json', target: \"json\", woql: 'json'},\r\n  };\r\n  sigs.getClassFrame = {\r\n    spec: \"WOQLClient.getClassFrame(class, options)\",\r\n    result: \"WOQL Result (HTTP 200), otherwise error code\",\r\n    args: {class: 'url'},\r\n  };\r\n  sigs.getPropertyFrame = {\r\n    spec: \"WOQLClient.getPropertyFrame(class, property, options)\",\r\n    result: \"WOQL Result (HTTP 200), otherwise error code\",\r\n    args: {class: 'url', property: 'url'},\r\n  };\r\n  sigs.getFilledPropertyFrame = {\r\n    spec: \"WOQLClient.getPropertyFrame(document_url, property, options)\",\r\n    result: \"WOQL Result (HTTP 200), otherwise error code\",\r\n    args: {document_url: 'url', property: 'url'},\r\n  };\r\n  sigs.getSubClasses = {\r\n    spec: \"WOQLClient.getSubClasses(class, options)\",\r\n    result: \"WOQL Result (HTTP 200), otherwise error code\",\r\n    args: {class: 'url'},\r\n  };\r\n  return sigs[which];\r\n}//getFunctionSignature\r\n\r\n// returns dom element for header text\r\nfunction getHeaderDom(text){\r\n  var hd = document.createElement('div');\r\n  hd.setAttribute('class', 'terminus-module-head');\r\n  var h = document.createElement('h3');\r\n  h.innerHTML = text;\r\n  hd.appendChild(h);\r\n  return hd;\r\n} // getHeaderTextDom\r\n\r\n// returns dom for alert banner\r\nfunction getInfoAlertDom(type, label, msg){\r\n  var ald = document.createElement('div');\r\n  if(type == 'info') ald.setAttribute('class', 'terminus-alert terminus-alert-success');\r\n  else ald.setAttribute('class', 'alert');\r\n  var str = document.createElement('STRONG');\r\n  str.innerHTML = label;\r\n  ald.appendChild(str);\r\n  var txt = document.createTextNode(msg);\r\n  ald.appendChild(txt);\r\n  return ald;\r\n} // getInfoAlertDom()\r\n\r\n// formats response results from platform\r\nfunction getResponse(currForm, action, response, terminator){\r\n\r\n  var rd = document.createElement('div');\r\n\r\n  // get header result\r\n  rd.appendChild(getHeaderDom('Result'));\r\n  var br = document.createElement('BR');\r\n  rd.appendChild(br);\r\n\r\n  var data = JSON.stringify(response, 0, 4);\r\n\r\n  var pre = document.createElement('pre');\r\n  pre.setAttribute('class', 'terminus-api-view terminus-scheme-pre');\r\n  pre.innerHTML = data;\r\n\r\n  var cm = stylizeCodeDisplay(terminator, pre, rd, 'javascript');\r\n  if(!cm) rd.appendChild(pre);\r\n\r\n  var br = document.createElement('BR');\r\n  rd.appendChild(br);\r\n\r\n  currForm.appendChild(rd);\r\n\r\n  return currForm;\r\n}\r\n\r\n// formats the response from fetch call and spits out Http header and result\r\nfunction showHttpResult(response, action, currForm, terminator){\r\n    //var currForm = document.createElement('div');\r\n\r\n    var br = document.createElement('BR');\r\n    currForm.appendChild(br);\r\n    var br = document.createElement('BR');\r\n    currForm.appendChild(br);\r\n\r\n    // get header result\r\n    currForm.appendChild(getHeaderDom('HTTP Header'));\r\n\r\n    var br = document.createElement('BR');\r\n    currForm.appendChild(br);\r\n\r\n     var retHttpHeaders  = '';\r\n\r\n     // iterate over all headers\r\n     for (let [key, value] of response.headers) {\r\n       retHttpHeaders = retHttpHeaders +  `${key} = ${value}` + '\\n';\r\n     }\r\n\r\n    // http header result\r\n    var hdres = document.createElement('pre');\r\n    hdres.setAttribute('class', 'terminus-api-signature-pre');\r\n    var txt = document.createTextNode(retHttpHeaders);\r\n    hdres.appendChild(txt);\r\n\r\n    var cm = stylizeCodeDisplay(terminator, hdres, currForm, 'message/http');\r\n    if(!cm) currForm.appendChild(hdres);\r\n\r\n    return response.json()\r\n    .then(function(response){\r\n      getResponse(currForm, action, response, terminator); // get return response\r\n    })\r\n\r\n} // UTILS.showHttpResult()\r\n\r\n\r\nfunction deleteStylizedEditor(ui, qip){\r\n    if(ui.pluginAvailable(\"codemirror\")){\r\n\t\tvar cm = qip.nextElementSibling;\r\n\t\tcm.setAttribute('class', 'terminus-hide');\r\n\t\tTerminusClient.FrameHelper.removeChildren(cm);\r\n\t}\r\n}\r\n\r\n/* ui: terminus ui reference\r\n   txt: text area to be stylized\r\n   view: defines the size of editor to appear in pages (schema/ query)\r\n   mode: format to be displayed in\r\n*/\r\nfunction stylizeEditor(ui, txt, view, mode){\r\n    var cmConfig = ui.pluginAvailable(\"codemirror\");\r\n    if(!(cmConfig)) return;\r\n\tvar cm = new Codemirror(txt, mode, cmConfig);\r\n\tvar ar = cm.colorizeTextArea(view);\r\n\tcm.updateTextArea(ar);\r\n}\r\n\r\n/* ui: terminus ui reference\r\n   txt: text area to be stylized\r\n   dom: stylized pre area is appended to dom\r\n   mode: format to be displayed in\r\n*/\r\nfunction stylizeCodeDisplay(ui, txt, dom, mode){\r\n    var cmConfig = ui.pluginAvailable(\"codemirror\");\r\n    if(!(cmConfig)) return false;\r\n    var cm = new Codemirror(txt, mode, cmConfig);\r\n    var pr = cm.colorizePre();\r\n    dom.appendChild(pr);\r\n    return true;\r\n}\r\n\r\n/* name: classname to find and remove classes from elements\r\n*/\r\nfunction removeSelectedNavClass(name){\r\n    var el = document.getElementsByClassName(name);\r\n    for(var i=0; i<el.length; i++){\r\n        el[i].classList.remove(name);\r\n    }\r\n}\r\n\r\n// toggles between contents\r\nfunction tolggleContent(icon, content){\r\n    if (content.style.display === \"block\"){\r\n        removeSelectedNavClass(\"fa-chevron-up\");\r\n        icon.classList.add(\"fa-chevron-down\");\r\n        content.style.display = \"none\";\r\n    }\r\n    else{\r\n        removeSelectedNavClass(\"fa-chevron-down\");\r\n        icon.classList.add(\"fa-chevron-up\");\r\n        content.style.display = \"block\";\r\n    }\r\n}\r\n\r\n// controls current selected nav bar\r\nfunction activateSelectedNav(nav, terminator){\r\n    removeSelectedNavClass(\"terminus-selected\");\r\n\tcheckDocumentSubMenus(terminator);\r\n\tnav.classList.add(\"terminus-selected\");\r\n}\r\n\r\nfunction hideDocumentSubMenus(el){\r\n\tif(el.classList.contains('terminus-display')){\r\n\t\tel.classList.remove('terminus-display');\r\n\t\tel.classList.add('terminus-hide');\r\n\t}\r\n}\r\n\r\nfunction checkDocumentSubMenus(terminator){\r\n\tif(terminator.ui.showControl(\"get_document\")) {\r\n\t\tvar gd = document.getElementsByClassName('terminus-get-doc');\r\n\t\thideDocumentSubMenus(gd[0]);\r\n\t}\r\n\tif(terminator.ui.showControl(\"create_document\")) {\r\n\t\tvar cd = document.getElementsByClassName('terminus-create-doc');\r\n\t\thideDocumentSubMenus(cd[0]);\r\n\t}\r\n}\r\n\r\nfunction toggleVisibility(el){\r\n\tif(el.classList.contains('terminus-display')){\r\n\t\tel.classList.remove('terminus-display');\r\n\t\tel.classList.add('terminus-hide');\r\n\t}\r\n    else if(el.classList.contains('terminus-hide')){\r\n        el.classList.remove('terminus-hide');\r\n\t\tel.classList.add('terminus-display');\r\n\t}\r\n}\r\n\r\nfunction extractValueFromCell(cellValue){\r\n    var ihtml = new DOMParser().parseFromString(cellValue, \"text/xml\");\r\n    return ihtml.firstChild.innerHTML;\r\n}\r\n\r\nfunction displayDocumentSubMenus(ui) {\r\n\t//display submenus on click of documents\r\n\tif(ui.showControl(\"get_document\")) {\r\n\t\tvar gd = document.getElementsByClassName('terminus-get-doc');\r\n\t\tshowSubMenus(gd[0]);\r\n\t}\r\n\tif(ui.showControl(\"create_document\")) {\r\n\t\tvar cd = document.getElementsByClassName('terminus-create-doc');\r\n\t\tshowSubMenus(cd[0]);\r\n\t}\r\n}\r\n\r\nfunction showSubMenus (el){\r\n\tel.classList.remove('terminus-hide');\r\n\tel.classList.add('terminus-display');\r\n}\r\n\r\n\r\nmodule.exports={tolggleContent,\r\n               removeSelectedNavClass,\r\n               stylizeCodeDisplay,\r\n               stylizeEditor,\r\n               deleteStylizedEditor,\r\n               showHttpResult,\r\n               getHeaderDom,\r\n               getInfoAlertDom,\r\n               getFunctionSignature,\r\n               toggleVisibility,\r\n               extractValueFromCell,\r\n               displayDocumentSubMenus,\r\n               activateSelectedNav}\r\n","const WOQLResult = require('./WOQLResultsViewer');\r\n\r\nfunction WOQLQuery(client, options, ui){\r\n\tthis.client = client;\r\n\tthis.options = options;\r\n\tthis.ui = ui;\r\n\tthis.default_limit = 1000;\r\n\tthis.prefixes = {};\r\n\tif(client.connectionConfig.platformEndpoint()){\r\n\t\tvar sid = client.connectionConfig.server.substring(0, client.connectionConfig.server.lastIndexOf(\"platform\"));\r\n\t\tthis.sid = sid;\r\n\t\tvar colid = client.connectionConfig.server.substring(0, client.connectionConfig.server.lastIndexOf(\"platform\")) + client.connectionConfig.dbid;\r\n\t\tthis.prefixes['s'] = colid + \"/ontology/main#\";\r\n\t\tthis.prefixes['g'] = sid;\r\n\t\tthis.prefixes['db'] = colid + \"/\";\r\n\t\tthis.prefixes['doc'] = colid + \"/candidate/\";\r\n\t\tthis.prefixes['dg'] = colid + \"/graph/main/\";\r\n\t}\r\n\telse {\r\n\t\tthis.sid = client.connectionConfig.serverURL();\r\n\t\tthis.prefixes['s'] = client.connectionConfig.schemaURL() + \"#\";\r\n\t\tthis.prefixes['dg'] = client.connectionConfig.dbURL() + \"/schema\";\r\n\t\tthis.prefixes['doc'] = client.connectionConfig.docURL();\r\n\t\tthis.prefixes['db'] = client.connectionConfig.dbURL() + \"/\";\r\n\t\tthis.prefixes['g'] = client.connectionConfig.serverURL();\r\n\t}\r\n\tfor(var pref in TerminusClient.FrameHelper.standard_urls){\r\n\t\tthis.prefixes[pref] = TerminusClient.FrameHelper.standard_urls[pref];\r\n\t}\r\n}\r\n\r\nWOQLQuery.prototype.setPrefixes = function(prefixes){\r\n\tthis.prefixes = prefixes;\r\n}\r\n\r\n\r\nWOQLQuery.prototype.shorten = function(url){\r\n\tfor(var pref in this.prefixes){\r\n\t\tif(this.prefixes[pref] == url.substring(0, this.prefixes[pref].length)){\r\n\t\t\treturn ( pref + \":\" + url.substring(this.prefixes[pref].length));\r\n\t\t}\r\n\t}\r\n\treturn url;\r\n}\r\n\r\nWOQLQuery.prototype.execute = function(woql){\r\n\tvar wrapped = this.wrap(woql);\r\n\tvar self = this;\r\n\treturn this.client.select(false, wrapped)\r\n\t.then(function(response){\r\n\t\tvar res = new WOQLResult.WOQLResult(response, self, self.options, self.ui);\r\n\t\treturn res;\r\n\t});\r\n}\r\n\r\nWOQLQuery.prototype.wrap = function(woql){\r\n\tvar wjson = {\r\n\t\t\"@context\" : this.prefixes,\r\n\t\t\"from\": [\r\n\t\t\tthis.client.connectionConfig.dbURL(),\r\n\t\t\twoql\r\n\t\t]\r\n\t};\r\n\treturn wjson;\r\n}\r\n\r\nWOQLQuery.prototype.getConcreteDocumentClassPattern = function(varc){\r\n\tvar varc = varc || \"v:Class\";\r\n\tvar pat = {\r\n\t\tand: [\r\n\t\t\tthis.getSubclassQueryPattern(varc, \"tcs:Document\"),\r\n\t\t\t{\r\n\t\t\t\tnot: [this.getAbstractQueryPattern(varc)]\r\n\t\t\t}\r\n\t\t]\r\n\t}\r\n\treturn pat;\r\n}\r\n\r\nWOQLQuery.prototype.getAbstractQueryPattern = function(varname){\r\n\tvar qp = {\r\n\t\tquad: [varname, \"tcs:tag\", \"tcs:abstract\", \"db:schema\"]\r\n\t}\r\n\treturn qp;\r\n}\r\n\r\nWOQLQuery.prototype.getSubclassQueryPattern = function(varname, clsname){\r\n\tvar sqp = {sub: [varname, clsname]};\r\n\treturn sqp;\r\n}\r\n\r\nWOQLQuery.prototype.queryWrappedWithLimit = function(query, limit, start){\r\n\tlimit = limit ? limit : this.default_limit ;\r\n\tstart = start ? start : 0;\r\n\tvar wjson = {\r\n\t\tlimit: [limit, {\r\n\t\t\tstart: [start, query]\r\n\t\t}]\r\n\t};\r\n\treturn wjson;\r\n}\r\n\r\n\r\nWOQLQuery.prototype.getAllDocumentQuery = function(constraint, limit, start){\r\n\tvar query = {\r\n\t\tand: [\r\n\t\t\t{\r\n\t\t\t\ttriple: [\"v:Document\", \"rdf:type\", \"v:Type\"]\r\n\t\t\t},\r\n\t\t\tthis.getSubclassQueryPattern(\"v:Type\", \"tcs:Document\")\r\n\t\t]\r\n\t}\r\n\tif(constraint){\r\n\t\tquery.and.push(constraint);\r\n\t}\r\n\treturn this.queryWrappedWithLimit(query, limit, start);\r\n}\r\n\r\nWOQLQuery.prototype.getEverythingQuery = function(constraint, limit, start){\r\n\tvar wjson = {triple: [\"v:Subject\", \"v:Predicate\", \"v:Object\"]};\r\n\tif(constraint){\r\n\t\twjson = {and: [wjson, constraint]};\r\n\t}\r\n\treturn this.queryWrappedWithLimit(wjson, limit, start);\r\n}\r\n\r\nWOQLQuery.prototype.getPropertyListQuery = function(constraint, limit, start){\r\n\tvar wjson = {\r\n\t\tand: [{quad: [\"v:Property\", \"rdfs:range\", \"v:Range\", \"db:schema\"]},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Property\", \"rdf:type\", \"v:Type\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Property\", \"rdfs:label\", \"v:Label\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Property\", \"rdfs:comment\", \"v:Comment\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Property\", \"rdfs:domain\", \"v:Domain\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t]\r\n\t}\r\n\tif(constraint){\r\n\t\twjson = {and: [wjson, constraint]};\r\n\t}\r\n\treturn this.queryWrappedWithLimit(wjson, limit, start);\r\n}\r\n\r\n\r\nWOQLQuery.prototype.getElementMetaDataQuery = function(constraint, limit, start){\r\n\tvar wjson = {\r\n\t\tand: [{quad: [\"v:Element\", \"rdf:type\", \"v:Type\", \"db:schema\"]},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Element\", \"rdfs:label\", \"v:Label\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Element\", \"rdfs:comment\", \"v:Comment\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Element\", \"tcs:tag\", \"v:Abstract\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Element\", \"rdfs:domain\", \"v:Domain\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Element\", \"rdfs:range\", \"v:Range\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t]\r\n\t}\r\n\tif(constraint){\r\n\t\twjson = {and: [wjson, constraint]};\r\n\t}\r\n\treturn this.queryWrappedWithLimit(wjson, limit, start);\r\n}\r\n\r\nWOQLQuery.prototype.getClassListMetaDataQuery = function(constraint, limit, start){\r\n\tvar wjson = {\r\n\t\tand: [{quad: [\"v:Element\", \"rdf:type\", \"owl:Class\", \"db:schema\"]},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Element\", \"rdfs:label\", \"v:Label\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Element\", \"rdfs:comment\", \"v:Comment\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Element\", \"tcs:tag\", \"v:Abstract\", \"db:schema\"]}]\r\n\t\t\t}\r\n\t\t]\r\n\t}\r\n\tif(constraint){\r\n\t\twjson = {and: [wjson, constraint]};\r\n\t}\r\n\treturn this.queryWrappedWithLimit(wjson, limit, start);\r\n}\r\n\r\nWOQLQuery.prototype.getClassMetaDataQuery = WOQLQuery.prototype.getClassListMetaDataQuery;\r\n\r\nWOQLQuery.prototype.getDataOfChosenClassQuery = function(chosen, limit, start){\r\n\tvar wjson = {\r\n\t\tand: [{triple: [\"v:Document\", \"rdf:type\", chosen]},\r\n\t\t\t{\r\n\t\t\t\topt: [{triple: [\"v:Document\", \"v:Property\", \"v:Value\"]}]\r\n\t\t\t}\r\n\t\t]\r\n\t}\r\n\treturn this.queryWrappedWithLimit(wjson, limit, start);\r\n}\r\n\r\nWOQLQuery.prototype.getDataOfChosenPropertyQuery = function(chosen, limit, start){\r\n\tvar wjson = {\r\n\t\tand: [{triple: [\"v:Document\", chosen, \"v:Value\"]},\r\n\t\t\t{\r\n\t\t\t\topt: [{triple: [\"v:Document\", \"rdfs:label\", \"v:Label\"]}]\r\n\t\t\t}\r\n\t\t]\r\n\t}\r\n\treturn this.queryWrappedWithLimit(wjson, limit, start);\r\n}\r\n\r\nWOQLQuery.prototype.getInstanceMeta = function(url, limit, start){\r\n\tvar wjson = {\r\n\t\tand: [\r\n\t\t\t{triple: [url, \"rdfs:label\", \"v:InstanceLabel\"]},\r\n\t\t\t{triple: [url, \"rdf:type\", \"v:InstanceType\"]},\r\n\t\t\t{\r\n\t\t\t\topt: [{triple: [url, \"rdfs:comment\", \"v:InstanceComment\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:InstanceType\", \"rdfs:label\", \"v:ClassLabel\", \"db:schema\"]}]\r\n\t\t\t}\r\n\t\t]\r\n\t}\r\n\treturn this.queryWrappedWithLimit(wjson, limit, start);\r\n}\r\n\r\n\r\nWOQLQuery.prototype.getDocumentQuery = function(id, limit, start){\r\n\tvar wjson = {\r\n\t\tand: [\r\n\t\t\t{triple: [id, \"v:Property\", \"v:Property_Value\"]},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Property\", \"rdfs:label\", \"v:Property_Label\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Property\", \"rdf:type\", \"v:Property_Type\", \"db:schema\"]}]\r\n\t\t\t}\r\n\t\t]\r\n\t}\r\n\treturn this.queryWrappedWithLimit(wjson, limit, start);\r\n}\r\n\r\nWOQLQuery.prototype.getClassesQuery = function(){\r\n\tvar wjson = {\r\n\t\tand: [\r\n\t\t\t{triple: [\"v:ID\", \"rdf:type\", \"v:Class\"]},\r\n\t\t\t{\r\n\t\t\t\topt: [{triple: [\"v:ID\", \"rdfs:label\", \"v:Label\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\topt: [{triple: [\"v:ID\", \"rdfs:comment\", \"v:Comment\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\topt: [{quad: [\"v:Class\", \"rdfs:label\", \"v:Type\", \"db:schema\"]}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tsub: ['v:Class', 'tcs:Document']\r\n\t\t\t}\r\n\t\t]\r\n\t}\r\n\treturn wjson;\r\n}\r\n\r\nmodule.exports=WOQLQuery\r\n","function TerminusPluginManager(){\r\n\tthis.preloaded = [];\r\n\tthis.loaded = [];\r\n\tthis.loading = [];\r\n\tthis.precluded = [];\r\n\tthis.plugins = {};\r\n\tthis.plugins[\"font-awesome\"] = {\r\n\t\tlabel: \"Font Awesome\",\r\n\t\tcss: [\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0-11/css/all.css\"]\r\n\t};\r\n\tthis.plugins[\"quill\"] = {\r\n\t\tlabel: \"Quill\",\r\n\t\tjs: [\"https://cdn.quilljs.com/1.3.6/quill.min.js\"],\r\n\t\tcss: [\"https://cdn.quilljs.com/1.3.6/quill.snow.css\"],\r\n\t};\r\n\tthis.plugins[\"codemirror\"] = {\r\n\t\tlabel : \"Code Mirror\",\r\n\t\tjs: [\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/codemirror.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/mode/xml/xml.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/mode/css/css.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/mode/turtle/turtle.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/mode/javascript/javascript.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/addon/hint/anyword-hint.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/addon/hint/show-hint.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/addon/runmode/runmode.js\",\r\n\t\t  \t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/mode/http/http.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/addon/edit/closebrackets.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/addon/edit/matchbrackets.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/addon/display/placeholder.js\"\r\n\t  ],\r\n\t\tcss: [\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/codemirror.css\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/addon/hint/show-hint.css\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/theme/neo.css\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/theme/erlang-dark.css\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/theme/eclipse.css\"\r\n\t\t]\r\n\t};\r\n\tthis.plugins[\"jquery\"] = {\r\n\t\tlabel: \"jQuery\",\r\n\t\tjs: [\"https://code.jquery.com/jquery-2.2.4.min.js\"]\r\n\t};\r\n\tthis.plugins[\"jqueryui\"] = {\r\n\t\tlabel: \"jQuery UI\",\r\n\t\tcss: [\"https://code.jquery.com/ui/1.12.0/themes/smoothness/jquery-ui.css\"],\r\n\t\tjs: [\"https://code.jquery.com/ui/1.12.0/jquery-ui.js\"],\r\n\t\trequires: ['jquery']\r\n\t};\r\n\tthis.plugins[\"datatables\"] = {\r\n\t\tlabel: \"Data Tables\",\r\n\t\tjs: [\"https://cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js\",\r\n\t\t\t \"https://cdn.datatables.net/v/dt/jszip-2.5.0/dt-1.10.16/b-1.5.1/b-html5-1.5.1/datatables.min.js\"],\r\n\t\tcss: [\"https://cdn.datatables.net/1.10.19/css/jquery.dataTables.min.css\"],\r\n\t\trequires: ['jquery']\r\n\t};\r\n\t/*this.plugins[\"prettify\"] = {\r\n\t\tlabel: \"Prettify\",\r\n\t\tjs: [\"https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.js\"],\r\n\t\tcss: [\"https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.css\"],\r\n\t\trequires: ['jquery']\r\n\t};*/\r\n\tthis.plugins[\"gmaps\"] = {\r\n\t\tlabel: \"Google Maps\",\r\n\t\tjs: [\"https://maps.googleapis.com/maps/api/js\"],\r\n\t\t//plugin: \"gmaps.terminus.js\"\r\n\t};\r\n\tthis.plugins[\"d3\"] = {\r\n\t\tlabel: \"d3\",\r\n\t\tjs: [\"https://code.jquery.com/jquery-2.2.4.min.js\"],\r\n\t\trequires: ['jquery']\r\n\t};\r\n\tthis.plugins[\"select2\"] = {\r\n\t\tlabel: \"Select 2\",\r\n\t\tjs: [\"https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.7/js/select2.min.js\"],\r\n\t\tcss: [\"https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.7/css/select2.min.css\"],\r\n\t\trequires: ['jquery']\r\n\t};\r\n\t/*this.plugins[\"jsoneditor\"] = {\r\n\t\tlabel: \"JSON Editor\",\r\n\t\tjs: [\"https://cdnjs.cloudflare.com/ajax/libs/jsoneditor/7.0.4/jsoneditor.min.js\"],\r\n\t\tcss: [\"https://cdnjs.cloudflare.com/ajax/libs/jsoneditor/7.0.4/jsoneditor.min.css\"],\r\n\t\t//plugin: \"jsoneditor.terminus.js\"\r\n\t};\r\n\tthis.plugins[\"bootstrap\"] = {\r\n\t\tlabel: \"Bootstrap\",\r\n\t\tjs: [\"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js\"],\r\n\t\tcss: [\"https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/2.2.2/css/bootstrap.min.css\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/2.2.2/css/bootstrap-responsive.min.css\"]\r\n\t};\r\n\tthis.plugins[\"flot\"] = {\r\n\t\tlabel: \"Flot\",\r\n\t\tjs: [\"https://cdnjs.cloudflare.com/ajax/libs/flot/0.8.3/jquery.flot.min.js\",\r\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/flot/0.8.3/jquery.flot.resize.min.js\"],\r\n\t\trequires: [\"jquery\"]\r\n\t};*/\r\n}\r\n\r\nTerminusPluginManager.prototype.setPluginOptions = function(opts){\r\n\tfor(var p in opts){\r\n\t\tif(!this.plugins[p]) continue;\r\n\t\tfor(var k in opts[p]){\r\n\t\t\tthis.plugins[p][k] = opts[p][k];\r\n\t\t}\r\n\t}\r\n}\r\n\r\nTerminusPluginManager.prototype.init = function(opts, then){\r\n\tif(opts) this.setPluginOptions(opts);\r\n\tthis.calculatePreloaded();\r\n\tvar toload = this.calculateRequiredInitPlugins(opts);\r\n\tif(toload && toload[0].length) {\r\n\t\tif(toload[1].length){\r\n\t\t\tvar self = this;\r\n\t\t\tvar nthen = function(){\r\n\t\t\t\tself.loadPlugins(toload[1], then);\r\n\t\t\t}\r\n\t\t\tthis.loadPlugins(toload[0], nthen);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.loadPlugins(toload[0], then);\r\n\t\t}\r\n\t}\r\n\telse if(then){\r\n\t\tthen();\r\n\t}\r\n}\r\n\r\nTerminusPluginManager.prototype.calculateRequiredInitPlugins = function(opts){\r\n\tif(opts){\r\n\t\tvar pins = [];\r\n\t\tfor(var pid in opts){\r\n\t\t\tif(opts[pid] && pins.indexOf(pid) == -1){\r\n\t\t\t\tif(typeof opts[pid] != \"object\" && opts[pid]){\r\n\t\t\t\t\tpins.push(pid);\r\n\t\t\t\t}\r\n\t\t\t\telse if(typeof opts[pid] == \"object\"){\r\n\t\t\t\t\tif(!(typeof opts[pid].loaded != \"undefined\" && !opts[pid].loaded)){\r\n\t\t\t\t\t\tpins.push(pid);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tvar pins = this.getDefaultPlugins();\r\n\t}\r\n\tvar needed_pins = [];\r\n\tfor(var i = 0; i<pins.length; i++){\r\n\t\tif(this.loaded.indexOf(pins[i]) == -1 && this.preloaded.indexOf(pins[i]) == -1 ){\r\n\t\t\tneeded_pins.push(pins[i])\r\n\t\t}\r\n\t}\r\n\tvar loading_order = [[], []];\r\n\tfor(var i = 0; i<needed_pins.length; i++){\r\n\t\tif(this.plugins[needed_pins[i]]){\r\n\t\t\tif(this.plugins[needed_pins[i]].requires && this.plugins[needed_pins[i]].requires.length){\r\n\t\t\t\tloading_order[1].push(needed_pins[i]);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tloading_order[0].push(needed_pins[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn loading_order;\r\n}\r\n\r\nTerminusPluginManager.prototype.getAvailablePlugins = function(){\r\n\treturn this.plugins;\r\n}\r\n\r\nTerminusPluginManager.prototype.calculatePreloaded = function(){\r\n\tfor(var pl in this.plugins){\r\n\t\tif(this.pluginAvailable(pl)){\r\n\t\t\tthis.preloaded.push(pl);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nTerminusPluginManager.prototype.pluginAvailable = function(plugin, version_check){\r\n\tif(typeof this.plugins[plugin] == \"object\"){\r\n\t\tvar pluginmeta = this.plugins[plugin];\r\n\t\tif(pluginmeta.requires && pluginmeta.requires.length){\r\n\t\t\tfor(var i =0 ; i < pluginmeta.requires.length; i++){\r\n\t\t\t\tif(!this.pluginAvailable(pluginmeta.requires[i], version_check)) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar required_version = (pluginmeta.version ? pluginmeta.version : false);\r\n\t\tswitch(plugin){\r\n\t\t\tcase \"jquery\": {\r\n\t\t\t\tif(typeof jQuery == \"undefined\") return false;\r\n\t\t\t\tif(version_check && required_version){}\r\n\t\t\t\treturn true;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tcase \"jqueryui\": {\r\n\t\t\t\ttry{\r\n\t\t\t\t\tif(typeof jQuery != \"undefined\" && jQuery.isFunction( jQuery.fn.slider )) return true;\r\n\t\t\t\t}\r\n\t\t\t\tcatch(e){}\r\n\t\t\t\treturn false;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tcase \"quill\": {\r\n\t\t\t\tif(typeof Quill == \"undefined\") return false;\r\n\t\t\t\treturn true;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tcase \"jsoneditor\": {\r\n\t\t\t\tif(typeof JSONEditor == \"undefined\") return false;\r\n\t\t\t\treturn true;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tcase \"codemirror\": {\r\n\t\t\t\tif(typeof CodeMirror == \"undefined\") return false;\r\n\t\t\t\treturn this.plugins[plugin];  // sent plugin config with darkmode true/ false\r\n\t\t\t}\r\n\t\t\tcase \"font-awesome\": {\r\n\t\t\t\t//if(typeof CodeMirror != \"undefined\") return true;\r\n\t\t\t\treturn this.fontAwesomeCheck();\r\n\t\t\t}\r\n\t\t\tcase \"datatables\": {\r\n\t\t\t\t if(typeof jQuery != \"undefined\" && jQuery.isFunction( jQuery.fn.dataTable)) return true;\r\n\t\t\t\t return false;\r\n\t\t\t}\r\n\t\t\tcase \"select2\": {\r\n\t\t\t\t if(typeof jQuery != \"undefined\" && jQuery.isFunction( jQuery.fn.select2 )) return true;\r\n\t\t\t\t return false;\r\n\t\t\t}\r\n\t\t\tcase \"gmaps\": {\r\n\t\t\t\tif(typeof google == \"undefined\" || typeof google.maps == \"undefined\") return false;\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\tcase \"openlayers\": {\r\n\t\t\t\tif(typeof ol == \"undefined\" || typeof ol.Map == \"undefined\") return false;\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\tcase \"d3\": {\r\n\t\t\t\tif(typeof d3 == \"undefined\") return false;\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tconsole.log(new Error(plugin + \" is not a supported plugin ID\"));\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nTerminusPluginManager.prototype.fontAwesomeCheck = function(){\r\n\tvar span = document.createElement('span');\r\n\tspan.className = 'fa';\r\n\tspan.style.display = 'none';\r\n\tif(document.body){\r\n\t\tdocument.body.insertBefore(span, document.body.firstChild);\r\n\t\tfunction css(element, property) {\r\n\t\t  return window.getComputedStyle(element, null).getPropertyValue(property);\r\n\t\t}\r\n\t\tvar loaded = false;\r\n\t\tvar fontAwsm = css(span, 'font-family');\r\n\t\tif (fontAwsm.replace(/\"/g, \"\") == 'Font Awesome 5 Free') { // remove double quotes\r\n\t\t\tloaded = true;\r\n\t\t}\r\n\t\tdocument.body.removeChild(span);\r\n\t\treturn loaded;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nTerminusPluginManager.prototype.getDefaultPlugins = function(){\r\n\tvar defplugs = [\"font-awesome\"];\r\n\treturn defplugs;\r\n}\r\n\r\nTerminusPluginManager.prototype.loadPlugins = function(plugins, then){\r\n\tvar ticker = plugins.length;\r\n\tvar cback = function(){\r\n\t\tif(--ticker <= 1 && then){\r\n\t\t\tthen();\r\n\t\t}\r\n\t};\r\n\tfor(var i = 0; i < plugins.length; i++){\r\n\t\tthis.loadPlugin(plugins[i], cback);\r\n\t}\r\n}\r\n\r\nTerminusPluginManager.prototype.loadPlugin = function(plugin, then){\r\n\tvar pug = this.plugins[plugin];\r\n\tif(pug.css){\r\n\t\tfor(var i=0; i<pug.css.length; i++){\r\n\t\t\tvar cssid = plugin + \"_css_\" + i;\r\n\t\t\tTerminusClient.FrameHelper.loadDynamicCSS(cssid, pug.css[i]);\r\n\t\t}\r\n\t}\r\n\tvar scripts = (pug.js ? pug.js : []);\r\n\tif(plugin == \"gmaps\" && pug.key){\r\n\t\tscripts[0] += \"?key=\" + pug.key;\r\n\t}\r\n\tif(pug.plugin){\r\n\t\t//scripts.push(\"plugins/\" + pug.plugin);\r\n\t}\r\n\tif(plugin == \"codemirror\"){\r\n\t\tvar cm = scripts[0];\r\n\t\tvar sid = plugin + \"_js_\" + (scripts.length -1);\r\n\t\tscripts.splice(0, 1);\r\n\t\tvar self = this;\r\n\t\tvar cback = function(){\r\n\t\t\tself.loadPluginScripts(plugin, scripts, then);\r\n\t\t}\r\n\t\tTerminusClient.FrameHelper.loadDynamicScript(sid, cm, cback);\r\n\t}\r\n\telse {\r\n\t\tthis.loadPluginScripts(plugin, scripts, then);\r\n\t}\r\n}\r\n\r\nTerminusPluginManager.prototype.loadPluginScripts = function(plugin, scripts, then){\r\n\tvar ticker = scripts.length - 1;\r\n\tvar self = this;\r\n\tvar cback = function(){\r\n\t\tif(ticker == 0) {\r\n\t\t\tif(self.loaded.indexOf(plugin) == -1){\r\n\t\t\t\tself.loaded.push(plugin);\r\n\t\t\t}\r\n\t\t\tif(self.loading.indexOf(plugin) != -1){\r\n\t\t\t\tself.loading.splice(self.loading.indexOf(plugin), 1);\r\n\t\t\t}\r\n\t\t\tthen();\r\n\t\t}\r\n\t\tticker--;\r\n\t};\r\n\tif(scripts.length == 0){\r\n\t\tthis.loaded.push(plugin);\r\n\t}\r\n\telse {\r\n\t\tthis.loading.push(plugin);\r\n\t}\r\n\tfor(var i = 0; i<scripts.length; i++){\r\n\t\tvar sid = plugin + \"_js_\" + i;\r\n\t\tTerminusClient.FrameHelper.loadDynamicScript(sid, scripts[i], cback);\r\n\t}\r\n}\r\n\r\nTerminusPluginManager.prototype.loadPageCSS = function(css){\r\n\tcssfid = \"terminus_client_css\";\r\n\tvar cssdom = document.getElementById(cssfid);\r\n\tif(cssdom){\r\n\t\tcssdom.parentNode.removeChild(cssdom);\r\n\t}\r\n\tif(css){\r\n\t\tcssurl = \"css/\" + css + \".css\";\r\n\t\tTerminusClient.FrameHelper.loadDynamicCSS(cssfid, cssurl);\r\n\t}\r\n}\r\n\r\nTerminusPluginManager.prototype.pluginLoadable = function(pid){\r\n\treturn (this.precluded.indexOf(pid) !== -1 || this.pluginLoadedOrLoading(pid));\r\n}\r\n\r\nTerminusPluginManager.prototype.pluginLoadedOrLoading = function(pid){\r\n\tif(this.loaded.indexOf(pid) != -1) return true;\r\n\tif(this.preloaded.indexOf(pid) != -1) return true;\r\n\tif(this.loading.indexOf(pid) != -1) return true;\r\n\treturn false;\r\n}\r\n\r\nTerminusPluginManager.prototype.disabled = function(pid, obj){\r\n\tif(this.precluded.indexOf(pid) != -1) return true;\r\n\tif(obj.requires){\r\n\t\tfor(var i = 0; i<obj.requires.length; i++){\r\n\t\t\tif(!this.pluginLoadedOrLoading(obj.requires[i])) return true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nTerminusPluginManager.prototype.getPluginDOM = function(plugid, obj, ui){\r\n\tvar a = document.createElement(\"a\");\r\n\tvar cl = document.createElement(\"span\");\r\n\ta.appendChild(cl);\r\n\tcl.setAttribute(\"class\", \"terminus-plugin-control\");\r\n\tvar cbox = document.createElement(\"input\");\r\n\tcbox.id = \"terminus-plugin-control-\" + plugid;\r\n\tcbox.type = \"checkbox\";\r\n\tif(this.preloaded.indexOf(plugid) != -1){\r\n\t\tcbox.checked = true;\r\n\t\tcbox.disabled = true;\r\n\t}\r\n\telse if(this.loaded.indexOf(plugid) != -1){\r\n\t\tcbox.checked = true;\r\n\t}\r\n\telse if(this.loading.indexOf(plugid) != -1){\r\n\t\tcbox.checked = true;\r\n\t}\r\n\telse if(this.disabled(plugid, obj)){\r\n\t\tcbox.disabled = true;\r\n\t}\r\n\tvar clab = document.createElement(\"label\");\r\n\tclab.setAttribute(\"class\", \"terminus-plugin-label terminus-pointer\");\r\n\tclab.setAttribute(\"for\", cbox.id);\r\n\tclab.appendChild(document.createTextNode(obj.label));\r\n\tcl.appendChild(clab);\r\n\tcl.appendChild(cbox);\r\n\tvar self = this;\r\n\tcbox.addEventListener(\"change\", function(){\r\n\t\tself.togglePlugin(plugid, ui);\r\n\t});\r\n\treturn a;\r\n}\r\n\r\nTerminusPluginManager.prototype.togglePlugin = function(plugid, ui){\r\n\tif(this.loaded.indexOf(plugid) == -1){\r\n\t\tvar then = function(){\r\n\t\t\tui.redraw();\r\n\t\t}\r\n\t\tthis.loadPlugin(plugid, then);\r\n\t}\r\n\telse {\r\n\t\tthis.unloadPlugin(plugid);\r\n\t}\r\n\tTerminusClient.FrameHelper.removeChildren(ui.plugins);\r\n\tui.drawPlugins();\r\n}\r\n\r\nTerminusPluginManager.prototype.unloadPlugin = function(plugid){\r\n\tif(!this.plugins[plugid] || this.loaded.indexOf(plugid) == -1) {\r\n\t\tconsole.log(new Error(plugid + \" plugin unload request when it is not loaded\"));\r\n\t\treturn false;\r\n\t}\r\n\tvar pug = this.plugins[plugid];\r\n\tvar num = (pug.js) ? pug.js.length : 0;\r\n\tif(pug.plugin) num++;\r\n\tfor(var i=0; i< num; i++){\r\n\t\tvar cssfid = plugid + \"_js_\" + i;\r\n\t\tvar cssdom = document.getElementById(cssfid);\r\n\t\tif(cssdom){\r\n\t\t\tcssdom.parentNode.removeChild(cssdom);\r\n\t\t}\r\n\t}\r\n\tnum = (pug.css ? pug.css.length : 0);\r\n\tfor(var i=0; i< num; i++){\r\n\t\tvar cssfid = plugid + \"_css_\" + i;\r\n\t\tvar cssdom = document.getElementById(cssfid);\r\n\t\tif(cssdom){\r\n\t\t\tcssdom.parentNode.removeChild(cssdom);\r\n\t\t}\r\n\t}\r\n\tthis.loaded.splice(this.loaded.indexOf(plugid), 1);\r\n}\r\n\r\nTerminusPluginManager.prototype.getAsDOM = function(ui){\r\n\tvar dm = document.createElement(\"span\");\r\n\tdm.setAttribute(\"class\", \"terminus-plugin-manager\");\r\n\tvar clh = document.createElement(\"span\");\r\n\tclh.setAttribute(\"class\", \"terminus-plugin-control-header terminus-plugin-nav terminus-pointer\");\r\n\tclh.appendChild(document.createTextNode(\"Plugins\"));\r\n\tdm.appendChild(clh);\r\n\tvar a = document.createElement('a');\r\n\tthis.showPlugins(a, ui);\r\n\tclh.appendChild(a);\r\n\ta.style.display = 'none';\r\n\tclh.addEventListener('click', function(){\r\n\t\tif(a.style.display == 'none')\r\n\t\t\ta.style.display = 'block';\r\n\t\telse a.style.display = 'none';\r\n\t})\r\n\treturn dm;\r\n}\r\n\r\nTerminusPluginManager.prototype.showPlugins = function(a, ui){\r\n\ta.setAttribute('style', 'background-color: #111;');\r\n\tfor(var pid in this.plugins){\r\n\t\ta.appendChild(this.getPluginDOM(pid, this.plugins[pid], ui));\r\n\t}\r\n}\r\n\r\nmodule.exports=TerminusPluginManager\r\n","const ObjectViewer= require(\"./ObjectViewer\")\r\nconst HTMLStringViewer = require('./viewers/String');\r\nconst HTMLStringEditor = require('./viewers/StringEditor');\r\nconst HTMLBooleanViewer = require('./viewers/Boolean');\r\nconst HTMLBooleanEditor = require('./viewers/BooleanEditor');\r\nconst HTMLChoiceViewer = require('./viewers/Choice');\r\nconst HTMLChoiceEditor = require('./viewers/ChoiceEditor');\r\nconst HTMLCoordinateViewer = require('./viewers/Coordinate');\r\nconst HTMLCoordinateEditor = require('./viewers/CoordinateEditor');\r\nconst HTMLDateViewer = require('./viewers/Date');\r\nconst HTMLDateEditor = require('./viewers/DateEditor');\r\nconst HTMLEntityViewer = require('./viewers/Entity');\r\nconst HTMLEntityEditor = require('./viewers/EntityEditor');\r\nconst HTMLImageViewer = require('./viewers/Image');\r\nconst HTMLImageEditor = require('./viewers/ImageEditor');\r\nconst HTMLLinkViewer = require('./viewers/Link');\r\nconst HTMLNumberViewer = require('./viewers/Number');\r\nconst HTMLRangeViewer = require('./viewers/Range');\r\nconst HTMLRangeEditor = require('./viewers/RangeEditor');\r\nconst SantizedHTMLViewer = require('./viewers/SanitizedHTML');\r\nconst GoogleMapEditor = require('./viewers/GoogleMapEditor');\r\nconst GoogleMapViewer = require('./viewers/GoogleMapViewer');\r\nconst HTMLMarkupEditor = require('./viewers/HTMLMarkupEditor');\r\nconst S2EntityEditor = require('./viewers/S2EntityEditor');\r\n\r\n\r\nlet RenderingMap = {\r\n\tregisteredDataViewers: {},\r\n\tregisteredDataEditors: {},\t\r\n\tregisteredPropertyViewers: {},\r\n\tregisteredPropertyEditors: {},\r\n\tregisteredObjectViewers: {},\r\n\tregisteredObjectEditors: {},\r\n\tgetValidDataViewerList: function(type, frametype){\r\n\t\tvar valids = ['HTMLStringViewer'];\r\n\t\tif(frametype && typeof this.registeredDataViewers[frametype] != \"undefined\"){\r\n\t\t\tvalids = valids.concat(this.registeredDataViewers[frametype]);\r\n\t\t}\r\n\t\tif(typeof this.registeredDataViewers[type] != \"undefined\"){\r\n\t\t\tvalids = valids.concat(this.registeredDataViewers[type]);\r\n\t\t}\r\n\t\treturn valids;\r\n\t},\r\n\tgetValidDataEditorList: function(type, frametype){\r\n\t\tvar valids = ['HTMLStringEditor'];\r\n\t\tif(frametype && typeof this.registeredDataEditors[frametype] != \"undefined\"){\r\n\t\t\tvar nftypes = this.registeredDataEditors[frametype];\r\n\t\t\tif(nftypes){\r\n\t\t\t\tfor(var i = 0; i<nftypes.length; i++){\r\n\t\t\t\t\tif(valids.indexOf(nftypes[i]) == -1) valids.push(nftypes[i]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(typeof this.registeredDataEditors[type] != \"undefined\"){\r\n\t\t\tvalids = valids.concat(this.registeredDataEditors[type]);\r\n\t\t}\r\n\t\treturn valids;\r\n\t},\r\n\tgetValidPropertyViewerList: function(property, proptype, proprange, propdom){\r\n\t\tvar valids = ['HTMLPropertyViewer'];\r\n\t\tif(property && typeof this.registeredPropertyViewers[property] != \"undefined\"){\r\n\t\t\tvalids = valids.concat(this.registeredPropertyViewers[property]);\r\n\t\t}\r\n\t\tif(proprange && typeof this.registeredPropertyViewers[proprange] != \"undefined\"){\r\n\t\t\tvalids = valids.concat(this.registeredPropertyViewers[proprange]);\r\n\t\t}\r\n\t\tif(propdom && typeof this.registeredPropertyViewers[propdom] != \"undefined\"){\r\n\t\t\tvalids = valids.concat(this.registeredPropertyViewers[propdom]);\r\n\t\t}\r\n\t\tif(proptype && typeof this.registeredPropertyViewers[proptype] != \"undefined\"){\r\n\t\t\tvalids = valids.concat(this.registeredPropertyViewers[proptype]);\r\n\t\t}\r\n\t\treturn valids;\r\n\t},\r\n\tgetValidPropertyEditorList: function(property, proptype, proprange, propdom){\r\n\t\tvar valids = ['HTMLPropertyViewer'];\r\n\t\tif(property && typeof this.registeredPropertyEditors[property] != \"undefined\"){\r\n\t\t\tvalids = valids.concat(this.registeredPropertyEditors[property]);\r\n\t\t}\r\n\t\tif(proprange && typeof this.registeredPropertyEditors[proprange] != \"undefined\"){\r\n\t\t\tvalids = valids.concat(this.registeredPropertyEditors[proprange]);\r\n\t\t}\r\n\t\tif(propdom && typeof this.registeredPropertyEditors[propdom] != \"undefined\"){\r\n\t\t\tvalids = valids.concat(this.registeredPropertyEditors[propdom]);\r\n\t\t}\r\n\t\tif(proptype && typeof this.registeredPropertyEditors[proptype] != \"undefined\"){\r\n\t\t\tvalids = valids.concat(this.registeredPropertyEditors[proptype]);\r\n\t\t}\r\n\t\treturn valids;\r\n\t},\r\n\tgetViewer: function(type, options){\r\n\t\tvar vi = this.renderers[type];\r\n\t\toptions = (options ? options: {});\r\n\t\ttry {\r\n\t\t\tvar viewer = eval(\"new \" + type + \".\" + type + \"(\" + JSON.stringify(options) + \")\");\t\r\n\t\t\treturn viewer;\r\n\t\t}\r\n\t\tcatch(e){\r\n\t\t\talert(\"failed on create \" + e.toString());\r\n\t\t}\r\n\t},\r\n\tgetAvailablePropertyViewers: function(type, renderer) {\r\n\t\tvar viewers = [];\r\n\t\tvar nviewers = []\r\n\t\tvar opts = this.getValidPropertyViewerList(type);\r\n\t\tfor(var i = 0; i<opts.length; i++){\r\n\t\t\tif(nviewers.indexOf(opts[i]) == -1) {\r\n\t\t\t\tnviewers.push(opts[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor(var i = 0; i<nviewers.length; i++){\r\n\t\t\tif(this.renderers[nviewers[i]]){\r\n\t\t\t\tvar sets = this.renderers[nviewers[i]];\r\n\t\t\t\tviewers.push({value: nviewers[i], label: sets.label});\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn viewers;\r\n\t},\r\n\tgetAvailablePropertyEditors: function(type, renderer) {\r\n\t\tvar viewers = [];\r\n\t\tvar nviewers = []\r\n\t\tvar opts = this.getValidPropertyEditorList();\r\n\t\tfor(var i = 0; i<opts.length; i++){\r\n\t\t\tif(nviewers.indexOf(opts[i]) == -1) {\r\n\t\t\t\tnviewers.push(opts[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor(var i = 0; i<nviewers.length; i++){\r\n\t\t\tif(this.renderers[nviewers[i]]){\r\n\t\t\t\tvar sets = this.renderers[nviewers[i]];\r\n\t\t\t\tviewers.push({value: nviewers[i], label: sets.label});\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn viewers;\r\n\t\t\r\n\t},\r\n\tgetAvailableDataViewers: function(type, frametype){\r\n\t\tvar viewers = [];\r\n\t\tvar nviewers = []\r\n\t\tvar opts = this.getValidDataViewerList(type, frametype);\r\n\t\tfor(var i = 0; i<opts.length; i++){\r\n\t\t\tif(nviewers.indexOf(opts[i]) == -1) {\r\n\t\t\t\tnviewers.push(opts[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor(var i = 0; i<nviewers.length; i++){\r\n\t\t\tif(this.renderers[nviewers[i]]){\r\n\t\t\t\tvar sets = this.renderers[nviewers[i]];\r\n\t\t\t\tviewers.push({value: nviewers[i], label: sets.label});\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn viewers;\r\n\t},\r\n\tgetAvailableDataEditors: function(type, frametype){\r\n\t\tvar viewers = [];\r\n\t\tvar nviewers = []\r\n\t\tvar opts = this.getValidDataEditorList(type, frametype);\r\n\t\tfor(var i = 0; i<opts.length; i++){\r\n\t\t\tif(nviewers.indexOf(opts[i]) == -1) {\r\n\t\t\t\tnviewers.push(opts[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor(var i = 0; i<nviewers.length; i++){\r\n\t\t\tif(this.renderers[nviewers[i]]){\r\n\t\t\t\tvar sets = this.renderers[nviewers[i]];\r\n\t\t\t\tviewers.push({value: nviewers[i], label: sets.label});\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn viewers;\r\n\t},\r\n\tgetViewerForDataFrame: function(type, frametype){\r\n\t\tvar vals = this.getValidDataViewerList(type, frametype);\r\n\t\treturn vals[vals.length-1];\r\n\t},\r\n\tgetEditorForDataFrame: function(type, frametype){\r\n\t\tvar vals = this.getValidDataEditorList(type, frametype);\r\n\t\treturn vals[vals.length-1];\r\n\t},\r\n\tregisterViewerForTypes: function(viewer, label, types){\r\n\t\tfor(var i = 0; i < types.length; i++){\r\n\t\t\tif(typeof this.registeredDataViewers[types[i]] == \"undefined\"){\r\n\t\t\t\tthis.registeredDataViewers[types[i]] = [];\r\n\t\t\t}\r\n\t\t\tif(this.registeredDataViewers[types[i]].indexOf(viewer) == -1){\r\n\t\t\t\tthis.registeredDataViewers[types[i]].push(viewer);\r\n\t\t\t\tthis.renderers[viewer] = {label: label};\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tregisterEditorForTypes: function(viewer, label, types){\r\n\t\tfor(var i = 0; i < types.length; i++){\r\n\t\t\tif(typeof this.registeredDataEditors[types[i]] == \"undefined\"){\r\n\t\t\t\tthis.registeredDataEditors[types[i]] = [];\r\n\t\t\t}\r\n\t\t\tif(this.registeredDataEditors[types[i]].indexOf(viewer) == -1){\r\n\t\t\t\tthis.registeredDataEditors[types[i]].push(viewer);\r\n\t\t\t\tthis.renderers[viewer] = {label: label};\r\n\t\t\t}\t\t\t\r\n\t\t}\r\n\t},\r\n\tregisterEditorForFrameType: function(viewer, label, frametype){\r\n\t\tthis.renderers[viewer] = {label: label};\r\n\t\tif(typeof this.registeredDataEditors[frametype] == \"undefined\") this.registeredDataEditors[frametype] = [];\r\n\t\tif(this.registeredDataEditors[frametype].indexOf(viewer) == -1){\r\n\t\t\tthis.registeredDataEditors[frametype].push(viewer);\r\n\t\t}\r\n\t},\r\n\tregisterViewerForFrameType: function(viewer, label, frametype){\r\n\t\tthis.renderers[viewer] = {label: label};\r\n\t\tif(typeof this.registeredDataViewers[frametype] == \"undefined\") this.registeredDataViewers[frametype] = [];\r\n\t\tif(this.registeredDataViewers[frametype].indexOf(viewer) == -1){\r\n\t\t\tthis.registeredDataViewers[frametype].push(viewer);\r\n\t\t}\r\n\t},\r\n\tregisterViewerForProperties: function(viewer, label, properties){\r\n\t\tfor(var i = 0; i < properties.length; i++){\r\n\t\t\tif(typeof this.registeredPropertyViewers[properties[i]] == \"undefined\"){\r\n\t\t\t\tthis.registeredPropertyViewers[properties[i]] = [];\r\n\t\t\t}\r\n\t\t\tif(this.registeredPropertyViewers[properties[i]].indexOf(viewer) == -1){\r\n\t\t\t\tthis.registeredPropertyViewers[properties[i]].push(viewer);\r\n\t\t\t\tthis.renderers[viewer] = {label: label};\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tregisterEditorForProperties: function(viewer, label, properties){\r\n\t\tfor(var i = 0; i < properties.length; i++){\r\n\t\t\tif(typeof this.registeredPropertyEditors[properties[i]] == \"undefined\"){\r\n\t\t\t\tthis.registeredPropertyEditors[properties[i]] = [];\r\n\t\t\t}\r\n\t\t\tif(this.registeredPropertyEditors[properties[i]].indexOf(viewer) == -1){\r\n\t\t\t\tthis.registeredPropertyEditors[properties].push(viewer);\r\n\t\t\t\tthis.renderers[viewer] = {label: label};\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\trenderers: {\r\n\t\tHTMLStringViewer: { label: \"String Viewer\"},\r\n\t\tHTMLStringEditor: { label: \"String Editor\"},\r\n\t\tHTMLPropertyViewer: { label: \"HTML Property Viewer\"}\r\n\t},\r\n\tpatternMatchesRenderer: function(pattern, renderer){\r\n\t\tif(typeof pattern == \"object\" && pattern.length){ //multiple patterns are ANDed\r\n\t\t\tfor(var i = 0 ; i<pattern.length; i++){\r\n\t\t\t\tvar fp = new FramePattern(pattern[i]);\r\n\t\t\t\tif(!fp.checkRenderer(renderer)) return false;\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tvar fp = new FramePattern(pattern);\r\n\t\t\treturn fp.checkRenderer(renderer);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nRenderingMap.addPlugin = function(plugin){\r\n\tif(plugin == \"gmaps\"){\r\n\t\tthis.registerEditorForTypes(\"GoogleMapEditor\", \"Google Map Editor\", [\"xdd:coordinate\", \"xdd:coordinatePolyline\", \"xdd:coordinatePolygon\"]);\r\n\t\tthis.registerViewerForTypes(\"GoogleMapViewer\", \"Google Map Editor\", [\"xdd:coordinate\", \"xdd:coordinatePolyline\", \"xdd:coordinatePolygon\"]);\r\n\t}\r\n\tif(plugin == \"quill\"){\r\n\t\tthis.registerEditorForTypes(\"HTMLMarkupEditor\", \"Quill WYSIWIG HTML Editor\", [\"xdd:html\"]);\r\n\t}\r\n\tif(plugin == \"select2\"){\r\n\t\tRenderingMap.registerEditorForFrameType(\"S2EntityEditor\", \"S2 Autocomplete Selector\", \"document\");\r\n\t}\r\n\tif(plugin == \"jsoneditor\"){\r\n\t\tRenderingMap.registerEditorForFrameType(\"S2EntityEditor\", \"S2 Autocomplete Selector\", \"document\");\r\n\t}\r\n}\r\n\r\nRenderingMap.getAvailableObjectViewers = function(renderer){\r\n\tvar entries = ['html', 'json'];\r\n\treturn entries;\r\n}\r\n\r\nRenderingMap.decorateRenderer = function(options, renderer){\r\n\tvar compiled_options = this.compileOptions(options, renderer);\r\n\tif(compiled_options && compiled_options.mode){\r\n\t\trenderer.mode = compiled_options.mode;\r\n\t}\r\n\telse {\r\n\t\tif(renderer.parent && renderer.parent.mode) renderer.mode = renderer.parent.mode;\r\n\t\telse renderer.mode = \"view\";\r\n\t}\r\n\tif(compiled_options && compiled_options.view){\r\n\t\trenderer.view = compiled_options.view;\r\n\t}\r\n\telse {\r\n\t\tif(renderer.parent && renderer.parent.view) renderer.view = renderer.parent.view;\r\n\t\telse renderer.view = \"full\";\r\n\t}\r\n\tif(compiled_options && compiled_options.facets){\r\n\t\trenderer.facets = compiled_options.facets;\r\n\t}\r\n\telse {\r\n\t\trenderer.facets = renderer.getDefaultFacets();\r\n\t}\r\n\tif(compiled_options && compiled_options.facet && typeof renderer.facets[compiled_options.facet] == \"object\"){\r\n\t\trenderer.facet = compiled_options.facet;\r\n\t}\t\r\n\telse {\r\n\t\tvar deffacet = renderer.getDefaultFacet();\r\n\t\tif(typeof renderer.facets[deffacet] == \"object\"){\r\n\t\t\trenderer.facet = deffacet;\r\n\t\t}\r\n\t\telse {\r\n\t\t\trenderer.facet = key(renderer.facets);\r\n\t\t}\r\n\t}\r\n\tif(compiled_options && compiled_options.hide_disabled_buttons){\r\n\t\trenderer.hide_disabled_buttons = compiled_options.hide_disabled_buttons;\r\n\t}\r\n\telse if(renderer.parent) renderer.hide_disabled_buttons = parent.hide_disabled_buttons;\r\n\telse renderer.hide_disabled_buttons = true;\r\n\tif(compiled_options && typeof compiled_options.features == \"object\"){\r\n\t\trenderer.features = compiled_options.features;\r\n\t}\r\n\telse {\r\n\t\trenderer.features = renderer.facets[renderer.facet].features;\r\n\t\t//renderer.features = renderer.getDefaultFeatures(renderer.facet);\r\n\t}\r\n\tif(compiled_options && typeof compiled_options.controls == \"object\"){\r\n\t\trenderer.controls = compiled_options.controls;\r\n\t}\r\n\telse {\r\n\t\trenderer.controls = renderer.facets[renderer.facet].controls;\r\n\t\t//renderer.controls = renderer.getDefaultControls();\r\n\t}\r\n\tif(compiled_options && typeof compiled_options.viewerType != \"undefined\"){\r\n\t\trenderer.viewerType = compiled_options.viewerType;\r\n\t\tif(compiled_options.viewerOptions)\r\n\t\t\trenderer.viewerOptions = compiled_options.viewerOptions;\r\n\t}\r\n\tif(compiled_options && typeof compiled_options.header != \"undefined\"){}\r\n\telse {\r\n\t\trenderer.header_viewer = new ObjectViewer.HTMLObjectHeaderViewer();\r\n\t}\r\n\tif(compiled_options && typeof compiled_options.filter != \"undefined\"){}\r\n\telse {}\r\n\tif(compiled_options && typeof compiled_options.sort != \"undefined\"){}\r\n\telse {}\r\n\treturn options;\r\n}\t\r\n\r\nRenderingMap.compileOptions = function(options, renderer){\r\n\tvar compiled_options = {};\r\n\tvar rules = [];\r\n\tfor(var key in options){\r\n\t\tif(key != \"rules\"){\r\n\t\t\tcompiled_options[key] = options[key];\r\n\t\t}\r\n\t}\r\n\tif(options.rules){\r\n\t\tfor(var i = 0; i<options.rules.length; i++){\r\n\t\t\tvar match = (!options.rules[i].pattern || this.patternMatchesRenderer(options.rules[i].pattern, renderer));\r\n\t\t\tif(match && options.rules[i].output){\r\n\t\t\t\tfor(var k in options.rules[i].output){\r\n\t\t\t\t\tcompiled_options[k] = options.rules[i].output[k];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn compiled_options;\r\n}\r\n\r\n\r\nRenderingMap.registerViewerForTypes(\"HTMLBooleanViewer\", \"Checkbox Viewer\", [\"xsd:boolean\"]);\r\nRenderingMap.registerEditorForTypes(\"HTMLBooleanEditor\", \"Checkbox Editor\", [\"xsd:boolean\"]);\r\nRenderingMap.registerViewerForFrameType(\"HTMLChoiceViewer\", \"Choice Viewer\", \"oneOf\");\r\nRenderingMap.registerEditorForFrameType(\"HTMLChoiceEditor\", \"Choice Selector\", \"oneOf\");\r\nRenderingMap.registerViewerForTypes(\"HTMLCoordinateViewer\", \"Coordinate Viewer\", [\"xdd:coordinate\", \"xdd:coordinatePolyline\", \"xdd:coordinatePolygon\"]);\r\nRenderingMap.registerEditorForTypes(\"HTMLCoordinateEditor\", \"Coordinate Editor\", [\"xdd:coordinate\", \"xdd:coordinatePolyline\", \"xdd:coordinatePolygon\"]);\r\nRenderingMap.registerViewerForTypes(\"HTMLDateViewer\", \"Date Viewer\", [\"xsd:time\", \"xsd:date\", \"xsd:dateTime\", \"xsd:gYear\", \r\n\t\"xsd:gYearRange\", \"xsd:gMonth\", \"xsd:gDay\", \"xsd:gYearMonth\", \"xsd:gMonthDay\", \"xsd:dateTimeStamp\"]);\r\nRenderingMap.registerEditorForTypes(\"HTMLDateEditor\", \"Date Editor\", [\"xsd:time\", \"xsd:date\", \"xsd:dateRange\" ,\"xsd:dateTime\", \"xsd:gYear\", \r\n\t\"xsd:gYearRange\", \"xsd:gMonth\", \"xsd:gDay\", \"xsd:gYearMonth\", \"xsd:gMonthDay\", \"xsd:dateTimeStamp\"]);\r\nRenderingMap.registerViewerForFrameType(\"HTMLEntityViewer\", \"Document Viewer\", \"document\");\r\nRenderingMap.registerEditorForFrameType(\"HTMLEntityEditor\", \"Document Selector\", \"document\");\r\nRenderingMap.registerViewerForTypes(\"HTMLImageViewer\", \"Image Viewer\", [\"xdd:url\", \"xsd:anyURI\", \"xsd:base64Binary\"]);\r\nRenderingMap.registerEditorForTypes(\"HTMLImageEditor\", \"Image Editor\", [\"xsd:base64Binary\"]);\r\nRenderingMap.registerViewerForTypes(\"HTMLImageViewer\", \"Image Viewer\", [\"xdd:url\", \"xsd:anyURI\", \"xsd:base64Binary\"]);\r\nRenderingMap.registerEditorForTypes(\"HTMLImageEditor\", \"Image Editor\", [\"xsd:base64Binary\"]);\r\nRenderingMap.registerViewerForTypes(\"HTMLLinkViewer\", \"Link Viewer\", [\"xdd:url\", \"xsd:anyURI\"]);\r\nRenderingMap.registerViewerForTypes(\"HTMLNumberViewer\", \"Number with commas\", \r\n\t\t[\"xsd:decimal\", \"xsd:double\", \"xsd:float\", \"xsd:short\", \"xsd:integer\", \"xsd:long\", \r\n\t\t\t\"xsd:nonNegativeInteger\", \"xsd:positiveInteger\", \"xsd:negativeInteger\", \"xsd:nonPositiveInteger\"]);\r\nRenderingMap.registerViewerForTypes(\"HTMLRangeViewer\", \"Range Viewer\", [\"xdd:gYearRange\", \"xdd:dateRange\", \"xdd:integerRange\", \"xdd:decimalRange\"]);\r\nRenderingMap.registerEditorForTypes(\"HTMLRangeEditor\", \"Range Editor\", [\"xdd:gYearRange\", \"xdd:dateRange\", \"xdd:integerRange\", \"xdd:decimalRange\"]);\r\nRenderingMap.registerViewerForTypes(\"SantizedHTMLViewer\", \"Sanitized HTML\", [\"xsd:string\", \"xdd:html\"]);\r\n\r\nFramePattern = function(pattern){\r\n\tthis.renderer = (pattern.renderer ? pattern.renderer : false);\r\n\tthis.label = (pattern.value ? pattern.value : false);\r\n\tthis.frame_type = (pattern.frame_type ? pattern.frame_type : false);\r\n\tthis.subject = (pattern.subject ? pattern.subject : false);\r\n\tthis.subjectClass = (pattern.subjectClass ? pattern.subjectClass : false);\r\n\tthis.range = (pattern.range ? pattern.range : false);\r\n\tthis.property = (pattern.property ? pattern.property : false);\r\n\tthis.value = (pattern.value ? pattern.value : false);\r\n\tthis.parent = (pattern.parent ? new FramePattern(pattern.parent) : false);\r\n\tthis.children = [];\r\n\tif(pattern.children){\r\n\t\tfor(var i = 0 ; i < pattern.children.length ; i++){\r\n\t\t\tthis.children.push(new FramePattern(pattern.children[i]));\r\n\t\t}\r\n\t}\r\n\tthis.depth = (typeof pattern.depth != \"undefined\" ? pattern.depth : false);\r\n\tthis.index = (pattern.index ? pattern.index : false);\r\n\tthis.status = (pattern.status ? pattern.status : false);\r\n}\r\n\r\nFramePattern.prototype.checkRenderer = function(renderer){\r\n\tvar rtype = this.getRendererType(renderer);\r\n\tif(!rtype) return false;\r\n\tif(this.renderer && this.renderer != rtype) return false;\r\n\tif(this.illegalRuleType(rtype)) return false;\r\n\tif(this.frame_type && !this.checkFrameType(rtype, renderer)) return false;\r\n\tif(this.label && !this.checkLabel(rtype, renderer)) return false;\r\n\tif(this.subject && !this.checkSubject(rtype, renderer)) return false;\r\n\tif(this.subjectClass && !this.checkSubjectClass(rtype, renderer)) return false;\r\n\tif(this.property && !this.checkProperty(rtype, renderer)) return false;\r\n\tif(this.depth !== false && !this.checkDepth(rtype, renderer)) return false;\r\n\tif(this.range && !this.checkRange(rtype, renderer)) return false;\r\n\tif(this.value && !this.checkValue(rtype, renderer)) return false;\r\n\tif(this.parent && !this.checkParent(rtype, renderer)) return false;\r\n\tif(this.children && this.children.length && !this.checkChildren(rtype, renderer)) return false;\r\n\tif(this.index && !this.checkIndex(rtype, renderer)) return false;\r\n\tif(this.status && !this.checkStatus(rtype, renderer)) return false;\r\n\treturn true;\r\n} \r\n\r\nFramePattern.prototype.illegalRuleType = function(rtype){\r\n\tif(rtype == 'value' && (this.children.length || this.label)) return true;\r\n\tif(rtype == 'object' && this.range ) return true;\r\n\treturn false;\r\n}\r\n\r\n/* subject is an id or an array of ids, \r\n/* match is positive if the renderer's subject appears in the array or is the id\r\n */\r\nFramePattern.prototype.checkSubject = function(subject, renderer){\r\n\tif(typeof this.subject != \"object\" || !this.subject.length) this.subject = [this.subject];\r\n\tvar rsubj = renderer.subject();\r\n\tfor(var i = 0 ; i<this.subject.length; i++){\r\n\t\tif(this.IDsMatch(subject[i], rsubj)){\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\n//at least one child must match all child rules\r\nFramePattern.prototype.checkChildren = function(rtype, renderer){\r\n\tfor(var i = 0 ; i<this.children.length; i++){\r\n\t\tvar found = false;\r\n\t\tif(rtype == \"object\"){\r\n\t\t\tfor(var prop in renderer.properties){\r\n\t\t\t\tif(this.children[i].checkRenderer(renderer.properties[prop])) {\r\n\t\t\t\t\tfound = true;\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if(rtype == \"property\"){\r\n\t\t\tfor(var j = 0; j <= renderer.values.length; j++){\r\n\t\t\t\tif(this.children[j].checkRenderer(renderer.values[j])) {\r\n\t\t\t\t\tfound = true;\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(!found) return false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nFramePattern.prototype.checkStatus = function(rtype, renderer){\r\n\tif(typeof this.status != \"object\" || this.status.length == 0) this.status = [this.status];\r\n\tfor(var i = 0; i<this.status.length; i++){\r\n\t\tif(this.status[i] == \"updated\" && !renderer.isUpdated()) return false;\r\n\t\tif(this.status[i] == \"new\" && !renderer.isNew()) return false;\r\n\t\tif(this.status[i] == \"unchanged\" && renderer.isUpdated()) return false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nFramePattern.prototype.checkDepth = function(rtype, renderer){\r\n\treturn this.numberMatch(this.depth, renderer.depth());\r\n}\r\n\r\nFramePattern.prototype.checkParent = function(rtype, renderer){\r\n\treturn this.parent.checkRenderer(renderer.parent);\r\n}\r\n\r\nFramePattern.prototype.checkIndex = function(rtype, renderer){\r\n\tif(rtype == 'value'){\r\n\t\treturn this.index == renderer.index;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nFramePattern.prototype.checkProperty  = function(rtype, renderer){\r\n\tif(typeof this.property != \"object\" || !this.property.length) this.property = [this.property];\r\n\tfor(var i = 0 ; i<this.property.length; i++){\r\n\t\tif(this.propertyIDsMatch(renderer.property(), this.property[i])){\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\n//returns true if any of the values are found\r\nFramePattern.prototype.checkValue = function(rtype, renderer){\r\n\tif(typeof this.value != \"object\" || !this.value.length) this.value = [this.value];\r\n\tfor(var i = 0 ; i<this.value.length; i++){\r\n\t\tif(rtype == \"value\"){\r\n\t\t\tif(this.valuesMatch(renderer.value(), this.value[i])){\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if(rtype == \"property\"){\r\n\t\t\tfor(var j = 0; j<= renderer.values.length;  j++){\r\n\t\t\t\tif(this.getRendererType(renderer.values[i]) == 'value' &&\r\n\t\t\t\t\t\tthis.valuesMatch(renderer.values[i].value(), this.value[i])){\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if(rtype == \"object\"){\r\n\t\t\tfor(var prop in renderer.properties){\r\n\t\t\t\tif(this.checkValue(this.getRendererType(renderer.properties[prop]), renderer.properties[prop])){\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nFramePattern.prototype.checkRange  = function(rtype, renderer){\r\n\tif(typeof this.range != \"object\" || !this.range.length) this.range = [this.range];\r\n\tfor(var i = 0 ; i<this.range.length; i++){\r\n\t\tif(this.rangeIDsMatch(renderer.range(), this.range[i])){ \r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nFramePattern.prototype.checkSubjectClass = function(rtype, renderer){\r\n\tif(typeof this.subjectClass != \"object\" || !this.subjectClass.length) this.subjectClass = [this.subjectClass];\r\n\tvar rcls = renderer.subjectClass();\r\n\tfor(var i = 0 ; i<this.subjectClass.length; i++){\r\n\t\tif(this.classIDsMatch(this.subjectClass[i], rcls)){\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nFramePattern.prototype.checkFrameType = function (rtype, renderer){\r\n\tif(rtype == \"object\") return this.frame_type == \"object\";\r\n\tif(rtype == \"value\") {\r\n\t\tif(renderer.frame){\r\n\t\t\treturn this.frame_type == renderer.frame.ftype();\r\n\t\t}\r\n\t\telse {\r\n\t\t\talert(JSON.stringify(renderer));\r\n\t\t\talert(\"No frame\");\r\n\t\t}\r\n\t}\r\n\tif(rtype == \"property\") return false;\r\n}\r\n\r\nFramePattern.prototype.checkLabel = function(rtype, renderer){\r\n\tif(typeof renderder.getLabel != \"function\"){\r\n\t\tconsole.log(new Error(\"Rule passed to check label with broken renderer object - no getLabel\"));\r\n\t\treturn false;\r\n\t}\r\n\treturn this.stringMatch(this.label, renderer.getLabel());\r\n}\r\n\r\nFramePattern.prototype.IDsMatch = function(ida, idb){\r\n\treturn TerminusClient.FrameHelper.compareIDs(ida, idb);\r\n}\r\n\r\nFramePattern.prototype.classIDsMatch = function(ida, idb){\r\n\treturn this.IDsMatch(ida, idb);\r\n}\r\nFramePattern.prototype.propertyIDsMatch = function(ida, idb){\r\n\tvar match = this.IDsMatch(ida, idb);\r\n\treturn match;\r\n}\r\nFramePattern.prototype.rangeIDsMatch = function(ida, idb){\r\n\treturn this.IDsMatch(ida, idb);\r\n}\r\nFramePattern.prototype.valuesMatch = function(vala, valb){\r\n\treturn vala == valb;\r\n}\r\nFramePattern.prototype.numberMatch = function(vala, valb){\r\n\tif(typeof vala == \"string\"){\r\n\t\ttry {\r\n\t\t\treturn eval(valb + vala);\r\n\t\t}\r\n\t\tcatch(e){\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\treturn vala === valb;\r\n}\r\n\r\nFramePattern.prototype.stringMatch = function(vala, valb){\r\n\tvar pat = new RegExp(vala);\r\n\treturn pat.test(valb);\r\n}\r\n\r\nFramePattern.prototype.getRendererType = function(renderer){\r\n    if(renderer.constructor.name == \"ObjectRenderer\") return \"object\";\r\n    if(renderer.constructor.name == \"PropertyRenderer\") return \"property\";\r\n    if(renderer.constructor.name == \"ValueRenderer\") return \"value\";\r\n\tif(renderer.renderer_type) return renderer.renderer_type;\r\n\tconsole.log(new Error(\"frame configuration passed non-renderer type \" + renderer.constructor.name));\r\n\tconsole.log(renderer);\r\n\treturn false;\r\n}\r\n\r\n\r\nmodule.exports=RenderingMap\r\n\r\n\r\n","/*\r\n * Utility class which runs a query against the schema and presents the returned classes as a drop-down / class filter list\r\n */\r\n\r\nconst WOQLQuery = require('../query/WOQLQuery');\r\nconst HTMLFrameHelper = require('./HTMLFrameHelper');\r\n\r\n\r\nTerminusClassChooser = function(ui, filter, chosen){\r\n\tthis.ui = ui;\r\n\tthis.choice = (chosen ? chosen : false);\r\n\tthis.filter = filter;\r\n\tthis.show_single = true;\r\n}\r\n\r\nTerminusClassChooser.prototype.setRoot = function(root){\r\n\tthis.root = root;\r\n}\r\n\r\nTerminusClassChooser.prototype.setFilter = function(filter){\r\n\tthis.filter = filter;\r\n}\r\n\r\nTerminusClassChooser.prototype.change = function(cls){\r\n\talert(\"Need to specify class chooser function (\" + cls + \")\");\r\n}\r\n\r\nTerminusClassChooser.prototype.getAsDOM = function(style){\r\n\tvar ccdom = document.createElement(\"span\");\r\n\tccdom.setAttribute(\"class\", \"terminus-class-chooser\");\r\n\tvar ccsel = document.createElement(\"select\");\r\n\tccsel.setAttribute(\"class\", style + \" terminus-type-select terminus-class-select\");\r\n\t// ccsel.setAttribute(\"class\", \"terminus-class-select terminus-type-select terminus-query-select\");\r\n\tvar self = this;\r\n\tccsel.addEventListener(\"change\", function(){\r\n\t\tthis.choice = this.value;\r\n\t\tself.change(this.value);\r\n\t\tthis.value = \"\";\r\n\t});\r\n\tccdom.appendChild(ccsel);\r\n\tvar wq = new WOQLQuery(this.ui.client, {}, this.ui);\r\n\tvar woql = wq.getClassListMetaDataQuery(this.filter);\r\n\tvar self = this;\r\n\twq.execute(woql)\r\n\t.then(function(response){\r\n\t\tvar opts = self.getResultsAsOptions(response);\r\n\t\tif(opts){\r\n\t\t\tfor(var i = 0; i<opts.length; i++){\r\n\t\t\t\tccsel.appendChild(opts[i]);\r\n\t\t\t}\r\n\t\t\tself.options = opts;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tccdom.removeChild(ccsel);\r\n\t\t}\r\n\t});\r\n\treturn ccdom;\r\n}\r\n\r\nTerminusClassChooser.prototype.getResultsAsOptions = function(clist){\r\n\tvar choices = [];\r\n\tif(clist.bindings){\r\n\t\tif(this.show_single == false && clist.bindings.length < 2) return false;\r\n\t\tif(this.empty_choice){\r\n\t\t\tvar opt1 = document.createElement(\"option\");\r\n\t\t\topt1.setAttribute(\"class\", \"terminus-class-choice terminus-empty-choice\");\r\n\t\t\topt1.value = \"\";\r\n\t\t\topt1.appendChild(document.createTextNode(this.empty_choice));\r\n\t\t\tchoices.push(opt1);\r\n\t\t}\r\n\t\tvar added = [];\r\n\t\tfor(var i = 0; i<clist.bindings.length; i++){\r\n\t\t\tvar bclass = HTMLFrameHelper.getVariableValueFromBinding(\"Element\", clist.bindings[i]);\r\n\t\t\tif(!bclass) bclass = HTMLFrameHelper.getVariableValueFromBinding(\"Class\", clist.bindings[i]);\r\n\t\t\tif(bclass && added.indexOf(bclass) == -1){\r\n\t\t\t\tadded.push(bclass);\r\n\t\t\t\tvar opt = document.createElement(\"option\");\r\n\t\t\t\topt.setAttribute(\"class\", \"terminus-class-choice\");\r\n\t\t\t\topt.value = bclass;\r\n\t\t\t\tif(opt.value == this.choice){\r\n\t\t\t\t\topt.selected = true;\r\n\t\t\t\t}\r\n\t\t\t\tvar lab = HTMLFrameHelper.getVariableValueFromBinding(\"Label\", clist.bindings[i]);\r\n\t\t\t\tif(!lab || lab == \"unknown\"){\r\n\r\n\t\t\t\t\tlab = TerminusClient.FrameHelper.labelFromURL(bclass);\r\n\r\n\t\t\t\t}\r\n\t\t\t\tif(lab[\"@value\"]) lab = lab[\"@value\"];\r\n\t\t\t\topt.appendChild(document.createTextNode(lab));\r\n\t\t\t\tchoices.push(opt);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn choices;\r\n}\r\n\r\n\r\n\r\nmodule.exports=TerminusClassChooser\r\n","const TerminusPluginManager = require('../plugins/TerminusPlugin');\r\nconst Datatables = require('../plugins/datatables.terminus');\r\nconst UTILS=require('../Utils');\r\nconst HTMLFrameHelper = require('../client/HTMLFrameHelper');\r\n\r\n\r\nfunction WOQLResult(res, query, options, ui){\r\n\tthis.ui = ui;\r\n\tthis.query = query;\r\n\tthis.bindings = ((res && res.bindings) ? res.bindings : []);\r\n}\r\n\r\nWOQLResult.prototype.count = function(){\r\n\treturn this.bindings.length;\r\n}\r\n\r\nWOQLResult.prototype.shorten = function(url){\r\n\treturn this.query.shorten(url);\r\n}\r\n\r\nWOQLResult.prototype.hasBindings = function(result){\r\n\tif(result) return (result.bindings && result.bindings.length);\r\n\telse return (this.bindings && this.bindings.length);\r\n}\r\n\r\n\r\n\r\nfunction WOQLResultsViewer(ui, wresult, wQuery, options, settings, queryPage){\r\n\tthis.ui = ui;\r\n\tthis.result = wresult;\r\n\tthis.wQuery = wQuery;\r\n\tthis.max_cell_size = 400;\r\n\tthis.max_word_size = 60;\r\n\tthis.options = options;\r\n\tthis.qPage = queryPage;\r\n\t//this.wqlRes = new WOQLResult();\r\n\tthis.pman = new TerminusPluginManager();\r\n\tthis.settings = settings;\r\n}\r\n\r\nWOQLResultsViewer.prototype.showTable = function(){\r\n\tif(this.options && typeof this.options.show_table != \"undefined\") return this.options.show_table;\r\n\treturn true;\r\n}\r\n\r\nWOQLResultsViewer.prototype.orderColumns = function(sample){\r\n\tvar ordered = [];\r\n\tfor(var h in sample){\r\n\t\tif(ordered.indexOf(h) == -1){\r\n\t\t\tordered.unshift(h);\r\n\t\t}\r\n\t}\r\n\treturn ordered;\r\n}\r\n\r\nWOQLResultsViewer.prototype.getAsDOM = function(resultDOM, displayResultHeader){\r\n\tvar rs = document.createElement('div');\r\n\tresultDOM.appendChild(rs);\r\n\tif(displayResultHeader){\r\n\t\tvar rh = document.createElement('div');\r\n\t\trh.setAttribute(\"class\", \"terminus-margin-top-bottom terminus-module-head\");\r\n\t\trh.appendChild(document.createTextNode(\"Results\"));\r\n\t\trs.appendChild(rh);\r\n\t}\r\n\tif(this.result && this.result.hasBindings() && this.showTable()){\r\n\t\tthis.getTableDOM(this.result.bindings, rs);\r\n\t\treturn rs;\r\n\t}\r\n\telse {\r\n\t\tnor = document.createElement('div');\r\n\t\tnor.setAttribute('class', 'terminus-no-res-alert');\r\n\t\tnor.appendChild(document.createTextNode(\"No results available, create new ones to view them here...\"));\r\n\t\trs.appendChild(nor);\r\n\t\treturn rs;\r\n\t}\r\n}\r\n\r\nWOQLResultsViewer.prototype.getTableDOM = function(bindings, resultDOM){\r\n\tif(this.pman.pluginAvailable(\"datatables\")){\r\n\t\tvar dtResult = this.getTable(bindings, true, {});\r\n\t\tresultDOM.appendChild(dtResult.tab);\r\n\t\tvar dt = new Datatables.Datatables(this, this.qPage);\r\n\t\tdt.draw(dtResult, resultDOM);\r\n\t\tresultDOM.classList.add('terminus-expandable');\r\n\t\tresultDOM.classList.add('terminus-dt-result-cont');\r\n\t\treturn tab;\r\n    }\r\n\telse{\r\n\t\tvar tab = this.getTable(bindings, false, {});\r\n\t\tresultDOM.appendChild(tab);\r\n\t}\r\n}\r\n\r\nWOQLResultsViewer.prototype.getDtTableDOMOnChange = function(bindings, resultDOM, pageInfo){\r\n\t\tvar dtResult = this.getTable(bindings, true, pageInfo);\r\n\t\tresultDOM.appendChild(dtResult.tab);\r\n\t\treturn dtResult;\r\n}\r\n\r\nWOQLResultsViewer.prototype.formatResultsForDatatableDisplay = function(bindings, pageInfo){\r\n    var columns = [], colDataData = {}, data = [], formattedResult = {}, arr = [];\r\n\tvar dtResult = {};\r\n    var ordered_headings = this.orderColumns(bindings[0]);\r\n\t// get columns\r\n\tfor(var i = 0; i<ordered_headings.length; i++){\r\n\t\tvar clab = TerminusClient.FrameHelper.validURL(ordered_headings[i]) ? TerminusClient.FrameHelper.labelFromURL(ordered_headings[i]) : ordered_headings[i];\r\n        columns.push({data: clab});\r\n\t}\r\n\t// get data for respective columns\r\n\tfor(var i = 0; i<bindings.length; i++){\r\n\t\tcolDataData = {};\r\n\t\tfor(var j = 0; j<ordered_headings.length; j++){\r\n\t\t\tif(typeof bindings[i][ordered_headings[j]] == \"object\"){\r\n\t\t\t\tvar lab = (bindings[i][ordered_headings[j]]['@value'] ? bindings[i][ordered_headings[j]]['@value'] : \"Object?\");\r\n\t\t\t}\r\n\t\t\telse if(typeof bindings[i][ordered_headings[j]] == \"string\") {\r\n\t\t\t\tvar lab = this.result.shorten(bindings[i][ordered_headings[j]]);\r\n\t\t\t\tif(lab == \"unknown\") lab = \"\";\r\n\t\t\t\tif(lab.substring(0, 4) == \"doc:\"){\r\n\t\t\t\t\tlab = this.getDocumentLocalLink(lab).outerHTML;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar clab = TerminusClient.FrameHelper.validURL(ordered_headings[j]) ? TerminusClient.FrameHelper.labelFromURL(ordered_headings[j]) : ordered_headings[j];\r\n\t\t\tcolDataData[clab] = lab;\r\n\t\t}\r\n\t\tdata.push(colDataData);\r\n\t}\r\n\tdtResult.columns = columns;\r\n\tformattedResult.data = data;\r\n\tformattedResult.recordsTotal = 65;\r\n\tformattedResult.recordsFiltered = 65;\r\n\tformattedResult.draw = 1;\r\n\tdtResult.data = formattedResult;\r\n\treturn dtResult;\r\n}\r\n\r\nWOQLResultsViewer.prototype.getTableBody = function(bindings, ordered_headings){\r\n\tvar tbody = document.createElement(\"tbody\");\r\n\tvar self = this;\r\n\tfor(var i = 0; i<bindings.length; i++){\r\n\t\tvar tr = document.createElement(\"tr\");\r\n\t\tfor(var j = 0; j<ordered_headings.length; j++){\r\n\t\t\tvar td = document.createElement(\"td\");\r\n\t\t\tif(typeof bindings[i][ordered_headings[j]] == \"object\"){\r\n\t\t\t\tvar lab = (bindings[i][ordered_headings[j]]['@value'] ? bindings[i][ordered_headings[j]]['@value'] : \"?\");\r\n\t\t\t}\r\n\t\t\telse if(typeof bindings[i][ordered_headings[j]] == \"string\") {\r\n\t\t\t\tvar lab = this.result.shorten(bindings[i][ordered_headings[j]]);\r\n\t\t\t}\r\n\t\t\tif(lab == \"unknown\") lab = \"\";\r\n\t\t\tif(lab.substring(0, 4) == \"doc:\"){\r\n\t\t\t\tvar a = this.getDocumentLocalLink(lab);\r\n\t\t\t\ttd.appendChild(a);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tHTMLFrameHelper.wrapShortenedText(td, lab, this.max_cell_size, this.max_word_size);\r\n\t\t\t}\r\n\t\t\ttr.appendChild(td);\r\n\t\t}\r\n\t\ttbody.appendChild(tr);\r\n\t}\r\n\treturn tbody;\r\n}\r\n\r\nWOQLResultsViewer.prototype.selectDocumentNavBar = function(ui) {\r\n\tUTILS.removeSelectedNavClass(\"terminus-selected\");\r\n\tvar dnav = document.getElementsByClassName('terminus-document-nav');\r\n\tdnav[0].classList.add(\"terminus-selected\");\r\n\tUTILS.displayDocumentSubMenus(ui);\r\n}\r\n\r\nWOQLResultsViewer.prototype.getDocumentLocalLink = function(lab){\r\n\tvar a = document.createElement(\"a\");\r\n\ta.setAttribute(\"title\", lab);\r\n\ta.setAttribute(\"href\", '#');\r\n\tvar self = this;\r\n\ta.addEventListener(\"click\", function(){\r\n\t\tif(self.result.ui) {\r\n\t\t\tself.result.ui.showDocument(this.title);\r\n\t\t\tself.result.ui.redraw();\r\n\t\t\tself.selectDocumentNavBar(self.ui);\r\n\t\t}\r\n\t});\r\n\ta.appendChild(document.createTextNode(lab));\r\n\treturn a;\r\n}\r\n\r\nWOQLResultsViewer.prototype.getTable = function(bindings, dtPlugin, pageInfo){\r\n\tvar tab = document.createElement(\"table\");\r\n\ttab.setAttribute(\"class\", \"terminus-hover-table\");\r\n\tvar thead = document.createElement(\"thead\");\r\n\tvar thr = document.createElement(\"tr\");\r\n\tvar ordered_headings = this.orderColumns(bindings[0]);\r\n\tfor(var i = 0; i<ordered_headings.length; i++){\r\n\t\tvar th = document.createElement(\"th\");\r\n\t\tth.setAttribute('class', 'terminus-table-header-full-css');\r\n\t\tvar clab = (ordered_headings[i].indexOf(\"http\") != -1) ? TerminusClient.FrameHelper.labelFromURL(ordered_headings[i]) : ordered_headings[i];\r\n\t\tth.appendChild(document.createTextNode(clab));\r\n\t\tthr.appendChild(th);\r\n\t}\r\n\tthead.appendChild(thr);\r\n\ttab.appendChild(thead);\r\n\tif(dtPlugin){\r\n\t\tvar tbody = document.createElement(\"tbody\");\r\n\t\ttab.appendChild(tbody);\r\n\t\tvar dtResult ={};\r\n\t\tdtResult.result = this.formatResultsForDatatableDisplay(bindings, pageInfo);\r\n\t\tdtResult.tab = tab;\r\n\t\treturn dtResult;\r\n\t}\r\n\telse {\r\n\t\tvar tbody = this.getTableBody(bindings, ordered_headings);\r\n\t\ttab.appendChild(tbody);\r\n\t\treturn tab;\r\n\t}\r\n}\r\n\r\n\r\nmodule.exports={WOQLResultsViewer, WOQLResult}\r\n","const WOQLQuery = require('../query/WOQLQuery');\r\nconst Renderers = require('./ObjectRenderer');\r\nconst HTMLFrameHelper = require('./HTMLFrameHelper');\r\n\r\n\r\nfunction TerminusDocumentViewer(ui, action, options){\r\n\tthis.ui = ui;\r\n\tthis.server = this.ui.server();\r\n\tthis.db = this.ui.db();\r\n\tthis.init();\r\n\tthis.mode = (options && options.mode ? options.mode : \"view\");\r\n\tthis.editor = (options && options.editor ? options.editor : false);\r\n\tthis.load_schema = (options && options.load_schema ? options.load_schema : true);\r\n\tthis.config_options = this.getBuiltInViewerOptions();\r\n\tthis.options = (options ? options : this.config_options[action]);\r\n\tthis.action = action;\r\n\tthis.document = false;\r\n}\r\n\r\nTerminusDocumentViewer.prototype.init = function(){\r\n\tvar wq = new WOQLQuery(this.ui.client, this.options, this.ui);\r\n\tvar woql = wq.getClassMetaDataQuery();\r\n\tvar self = this;\r\n\tself.classmeta = {};\r\n\tself.instancemeta = {};\r\n\twq.execute(woql).then(function(wresult){\r\n\t\tif(wresult && wresult.hasBindings()){\r\n\t\t\tfor(var i = 0; i<wresult.bindings.length; i++){\r\n\t\t\t\tvar cls = HTMLFrameHelper.getVariableValueFromBinding(\"Element\", wresult.bindings[i]);\r\n\t\t\t\tif(cls && typeof self.classmeta[cls] == \"undefined\"){\r\n\t\t\t\t\tself.classmeta[cls] = wresult.bindings[i];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tself.refreshPage();\r\n\t\t}\r\n\t})\r\n\t.catch(function(e){\r\n\t\tconsole.log(e);\r\n\t});\r\n}\r\n\r\nTerminusDocumentViewer.prototype.getInstanceMeta = function(elid){\r\n\tvar self = this;\r\n\tif(self.instancemeta && typeof self.instancemeta[elid] != \"undefined\") return self.instancemeta[elid] ;\r\n\tvar wq = new WOQLQuery(this.ui.client, this.options, this.ui);\r\n\tvar woql = wq.getInstanceMeta(elid);\r\n\treturn wq.execute(woql).then(function(wresult){\r\n\t\tif(wresult && wresult.hasBindings()){\r\n\t\t\tvar res = wresult.bindings[0];\r\n\t\t\treturn res;\r\n\t\t}\r\n\t\treturn false;\r\n\t})\r\n\t.catch(function(e){\r\n\t\tconsole.log(e);\r\n\t});\r\n}\r\n\r\nTerminusDocumentViewer.prototype.getClassMeta = function(cls){\r\n\tif(typeof this.classmeta[cls]){\r\n\t\treturn this.classmeta[cls];\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nTerminusDocumentViewer.prototype.loadCreateDocument = function(url){\r\n\tif(url){\r\n\t\tthis.ui.showBusy(\"Fetching frame for document class \" + url);\r\n\t\tvar self = this;\r\n\t\tthis.mode = \"edit\";\r\n\t\tthis.page_config = \"create\";\r\n\t\tif(url.indexOf(\"/\") == -1 && url.indexOf(\":\") == -1) {\r\n\t\t\turl = \"schema:\" + url;\r\n\t\t}\r\n\t\treturn this.loadDocumentSchema(url)\r\n\t\t.then(function(response){\r\n\t\t\tself.ui.clearBusy();\r\n\t\t\tself.setLabel();\r\n\t\t})\r\n\t\t.catch(function(error) {\r\n\t\t\tconsole.error(error);\r\n\t\t\tself.ui.clearBusy();\r\n\t\t\tself.ui.showError(error);\r\n\t\t});\r\n\t}\r\n}\r\n\r\nTerminusDocumentViewer.prototype.loadDocument = function(url, cls){\r\n\tif(!url) return false;\r\n\tvar self = this;\r\n\tif(url.substring(0,4) == \"doc:\"){\r\n\t\turl = url.substring(4);\r\n\t}\r\n\tthis.page_config = \"view\";\r\n\turl = url.replace(\"/candidate\", \"/platform/document\");\r\n\tthis.ui.showBusy(\"Loading Document from \" + url);\r\n\treturn this.ui.client.getDocument(url, {\"terminus:encoding\": \"terminus:frame\"})\r\n\t.then(function(response){\r\n\t\tself.ui.clearBusy();\r\n\t\tself.loadDataFrames(response);\r\n\t\tself.setLabel();\r\n\t\tself.refreshPage();\r\n\t\tif(self.load_schema){\r\n\t\t\tself.loadDocumentSchema(self.document.cls).then(function(){ self.refreshPage()}).catch(function(e){console.error(e)});\r\n\t\t}\r\n\t\treturn response;\r\n\t})\r\n\t.catch(function(error) {\r\n\t\tconsole.error(error);\r\n\t\tself.ui.clearBusy();\r\n\t\tself.ui.showError(error);\r\n\t});\r\n}\r\n\r\nTerminusDocumentViewer.prototype.loadDocumentSchema = function(cls){\r\n\tvar self = this;\r\n\tvar ncls = TerminusClient.FrameHelper.unshorten(cls);\r\n\treturn this.ui.client.getClassFrame(false, ncls)\r\n\t.then(function(response){\r\n\t\tself.loadSchemaFrames(response, cls);\r\n\t\tself.refreshPage();\r\n\t});\r\n}\r\n\r\nTerminusDocumentViewer.prototype.deleteDocument = function(URL){\r\n\tthis.document = false;\r\n\tvar self = this;\r\n\tthis.ui.showBusy(\"Deleting Document \" + URL);\r\n\treturn this.ui.client.deleteDocument(URL)\r\n\t.then(function(response){\r\n\t\tself.ui.clearBusy();\r\n\t}).catch(function(error){\r\n\t\tself.ui.clearBusy();\r\n\t\tself.ui.showError(error);\r\n\t});\r\n}\r\n\r\nTerminusDocumentViewer.prototype.createDocument = function(id){\r\n\tvar self = this;\r\n\tvar extr = this.renderer.extract();\r\n\tvar opts = { \"terminus:encoding\": \"jsonld\" };\r\n\tthis.ui.showBusy(\"Creating document\");\r\n\treturn this.ui.client.createDocument(id, extr, opts)\r\n\t.then(function(response){\r\n\t\tself.ui.clearBusy();\r\n\t\tself.ui.showDocument(id);\r\n\t}).catch(function(error){\r\n\t\tself.ui.clearBusy();\r\n\t\tif(error.data && error.data['terminus:witnesses']){\r\n\t\t\tself.ui.showViolations(error.data['terminus:witnesses'], \"instance\");\t\t\t\r\n\t\t}\r\n\t\telse {\r\n\t\t\tself.ui.showError(error);\r\n\t\t}\r\n\t});\r\n}\r\n\r\nTerminusDocumentViewer.prototype.updateDocument = function(){\r\n\tvar durl = this.document.subjid;\r\n\tvar extr = this.renderer.extract();\r\n\tvar self = this;\r\n\tvar opts = { \"terminus:encoding\": \"jsonld\" };\r\n\tthis.ui.showBusy(\"Updating document \" + durl);\r\n\treturn this.ui.client.updateDocument(durl, extr, opts)\r\n\t.then(function(response){\r\n\t\tself.ui.clearBusy();\r\n\t\tself.ui.showDocument(durl);\r\n\t}).catch(function(error){\r\n\t\tself.ui.clearBusy();\r\n\t\tif(error.data && error.data['terminus:witnesses']){\r\n\t\t\tself.ui.showViolations(error.data['terminus:witnesses'], \"instance\");\t\t\t\r\n\t\t}\r\n\t\telse {\r\n\t\t\tself.ui.showError(error);\r\n\t\t}\r\n\t});\r\n}\r\n\r\nTerminusDocumentViewer.prototype.loadDataFrames = function(dataframes, cls){\r\n\tif(!cls){\r\n\t\tif(this.document) cls = this.document.cls;\r\n\t\telse {\r\n\t\t\tif(dataframes && dataframes.length && dataframes[0] && dataframes[0].domain){\r\n\t\t\t\tcls = dataframes[0].domain;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tif(cls){\r\n\t\tif(!this.document){\r\n\t\t\tthis.document = new TerminusClient.ObjectFrame(cls, dataframes);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.document.loadDataFrames(dataframes);\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tconsole.log(\"Missing Class\" + \" \" + \"Failed to add dataframes due to missing class\");\r\n\t}\r\n}\r\n\r\n\r\nTerminusDocumentViewer.prototype.loadSchemaFrames = function(classframes, cls){\r\n\tif(!cls){\r\n\t\tif(classframes && classframes.length && classframes[0] && classframes[0].domain){\r\n\t\t\tcls = classframes[0].domain;\r\n\t\t}\r\n\t}\r\n\tif(cls){\r\n\t\tif(!this.document){\r\n\t\t\tthis.document = new TerminusClient.ObjectFrame(cls);\r\n\t\t}\r\n\t\tif(classframes){\r\n\t\t\tthis.document.loadClassFrames(classframes);\r\n\t\t\tif(!this.document.subjid){\r\n\t\t\t\tthis.document.newDoc = true;\r\n\t\t\t\tthis.document.fillFromSchema(\"_:\");\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tconsole.log(\"Missing Class\", \"Failed to add class frames due to missing class\");\r\n\t}\r\n}\r\n\r\nTerminusDocumentViewer.prototype.render = function(){\r\n\tif(!this.renderer && this.document){\r\n\t\tif(this.page_config){\r\n\t\t\tthis.options = this.getOptionsFromPageConfig(this.page_config);\r\n\t\t}\r\n\t\ttry{\r\n\t\t\tthis.renderer = new Renderers.ObjectRenderer(this.document, false, this.options);\r\n\t\t\tthis.renderer.mode = this.mode;\r\n\t\t\tthis.renderer.controller = this;\r\n\t\t}catch(e){\r\n\t \t\tconsole.error('TerminusDocumentViewer render',e.toString())\r\n\t \t}\r\n\t}\r\n\tif(this.renderer){\r\n\t\treturn this.renderer.render();\r\n\t}\r\n}\r\n\r\nTerminusDocumentViewer.prototype.getBuiltInViewerOptions = function(){\r\n\treturn FrameConfig;\r\n}\r\n\r\nTerminusDocumentViewer.prototype.getOptionsFromPageConfig = function(pageconf){\r\n\tif(typeof this.config_options[pageconf] == \"object\") {\r\n\t\treturn this.config_options[pageconf];\r\n\t}\r\n\treturn this.options;\r\n}\r\n\r\n\r\nTerminusDocumentViewer.prototype.getClient = function(){\r\n\treturn this.ui.client;\r\n}\r\n\r\nTerminusDocumentViewer.prototype.extract = function(options){\r\n\treturn this.renderer.extract();\r\n}\r\n\r\nTerminusDocumentViewer.prototype.getLabel = function(){\r\n\tvar lab = (this.cls ? this.cls : false);\r\n\tif(!lab) lab = (this.docid ? this.docid : \"Void\");\r\n\treturn lab;\r\n}\r\n\r\nTerminusDocumentViewer.prototype.setLabel = function(){\r\n\tif(this.document && this.labdom){\r\n\t\tTerminusClient.FrameHelper.removeChildren(this.labdom);\r\n\t\tvar dfs = this.document.getDataFrames(TerminusClient.FrameHelper.getStdURL(\"rdfs\", \"label\"));\r\n\t\tfor(var i = 0; i< dfs.length; i++){\r\n\t\t\tvar lab = dfs[i].get();\r\n\t\t\tif(lab) {\r\n\t\t\t\tthis.labdom.appendChild(document.createTextNode(lab));\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\nTerminusDocumentViewer.prototype.refreshPage = function(){\r\n\tif(this.pagedom){\r\n\t\tTerminusClient.FrameHelper.removeChildren(this.pagedom);\r\n\t\tvar rends = this.render();\r\n\t\tif(rends){\r\n\t\t\tthis.pagedom.appendChild(rends);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nTerminusDocumentViewer.prototype.getAsDOM = function(){\r\n\tvar holder = document.createElement(\"div\");\r\n\tholder.setAttribute(\"class\", \"terminus-document-holder\");\r\n\tif(this.mode !== 'edit'){ // dont provide drop down on create mode\r\n\t\tthis.controldom = document.createElement(\"div\");\r\n\t\tthis.controldom.setAttribute(\"class\", \"terminus-document-controller\");\r\n\t\tif(Object.keys(this.config_options).length > 1)\tthis.controldom.appendChild(this.getDocumentPageControls());\r\n\t\tholder.appendChild(this.controldom);\r\n\t}\r\n\tthis.pagedom = document.createElement(\"div\");\r\n\tthis.pagedom.setAttribute(\"class\", \"terminus-document-page\");\r\n\tvar rends = this.render();\r\n\tif(rends){\r\n\t\tthis.pagedom.appendChild(rends);\r\n\t}\r\n\tholder.appendChild(this.pagedom);\r\n\treturn holder;\r\n}\r\n\r\nTerminusDocumentViewer.prototype.getDocumentPageControls = function(){\r\n\tvar dpc = document.createElement(\"select\");\r\n\tdpc.setAttribute(\"class\", \"terminus-form-select terminus-document-config\");\r\n\tfor(var i in this.config_options){\r\n\t\tif(i === 'create') continue; // create docuemnt option from config is not taken in edit mode \r\n\t\tvar opt = document.createElement(\"option\");\r\n\t\topt.value = i;\r\n\t\tif(this.page_config == i){\r\n\t\t\topt.selected = true;\r\n\t\t}\r\n\t\topt.appendChild(document.createTextNode(this.config_options[i].label));\r\n\t\tdpc.appendChild(opt);\r\n\t}\r\n\tvar self = this;\r\n\tdpc.addEventListener(\"change\", function(){\r\n\t\tself.page_config = this.value;\r\n\t\tself.renderer = false;\r\n\t\tself.refreshPage();\r\n\t})\r\n\treturn dpc;\r\n}\r\n\r\nmodule.exports=TerminusDocumentViewer\r\n","const UTILS= require('../Utils')\r\n\r\n/*** client side processing ***/\r\nfunction CspDatatables(ui){\r\n    this.ui = ui;\r\n}\r\n\r\nCspDatatables.prototype.convertToDatatable = function(tab){\r\n    var dt = this;\r\n    var table = jQuery(tab).DataTable({\r\n         searching : false,\r\n         pageLength: 25,\r\n         lengthMenu: [10, 25, 50, 75, 100],\r\n         paging    : true,\r\n         select    : true,\r\n         initComplete: function(settings) {\r\n                        var ict =settings.oInstance.api();\r\n                        ict.$('td').each(function(){\r\n                            this.setAttribute('title', $(this).html())\r\n                        })},\r\n         columnDefs:[{targets:'_all',className:\"truncate\"}],\r\n         createdRow: function(row) {\r\n                            var td = $(row).find(\".truncate\");\r\n                            td.attr(\"title\", td.html());}\r\n    }); //jQuery(tab)\r\n\r\n    // on click of row connect to db, on click of 5th column delete db\r\n    jQuery(tab, 'tbody').on('click', 'td', function(){\r\n        if(table.cell(this).index().column == 5){\r\n            var dbInfo = table.row(jQuery(this).parents('tr')).data();\r\n            var dbId = UTILS.extractValueFromCell(dbInfo[0]);\r\n            dt.ui.deleteDatabase(dbId);\r\n            return;\r\n        }\r\n        else dt.ui.showDBMainPage();\r\n     }); // on click\r\n\r\n    tab.setAttribute('class'      , 'stripe dataTable terminus-db-size');\r\n    tab.setAttribute('cellpadding', '1');\r\n    tab.setAttribute('cellspacing', '0');\r\n    tab.setAttribute('border'     , '0');\r\n    return tab;\r\n}\r\n\r\nCspDatatables.prototype.draw = function(dtResult){\r\n    return(this.convertToDatatable(dtResult));\r\n}\r\n\r\n/*** server side processing ***/\r\nfunction Datatables(wResViewer, qPage){\r\n   this.wrViewer = wResViewer;\r\n   this.wQuery = wResViewer.wQuery;\r\n   this.ui = wResViewer.ui;\r\n   this.qPage = qPage;\r\n}\r\n\r\n/*\r\n    query: new woqlquery with current pagination changes\r\n    pageInfo: current drawCallBack page change info\r\n    resultDOM: result dom on veiwer page\r\n*/\r\nDatatables.prototype.executeQuery = function(query, pageInfo, resultDOM){\r\n    var self = this;\r\n    //dcb.wquery.execute(query)\r\n    this.wQuery.execute(query)\r\n      .then(function(result){\r\n          var dtResult = {};\r\n          dtResult =self.wrViewer.getDtTableDOMOnChange(result.bindings, resultDOM, pageInfo);\r\n          return dtResult;\r\n          //self.getDataFromServer(dtResult, wrViewer, ui, wQuery, resultDOM);\r\n      })\r\n      .catch(function(err){\r\n          console.error(err);\r\n          self.ui.showError(err);\r\n      });\r\n}\r\n\r\n/* get query string based on datatable pagination and current query */\r\nDatatables.prototype.getQueryOnPagination = function(wq, settings){\r\n    switch(settings.query){\r\n        case 'Show_All_Documents':\r\n            return wq.getAllDocumentQuery(null, settings.pageLength, settings.start);\r\n        break;\r\n        case 'Show_All_Data':\r\n            return wq.getEverythingQuery(null, settings.pageLength, settings.start);\r\n        break;\r\n        case 'Show_All_Schema_Elements':\r\n            return wq.getElementMetaDataQuery(null, settings.pageLength, settings.start);\r\n        break;\r\n        case 'Show_Document_Classes':\r\n        \tvar sqp = wq.getConcreteDocumentClassPattern(\"Class\");\r\n            return wq.getClassMetaDataQuery(sqp);\r\n        break;\r\n        case 'Show_All_Properties':\r\n            return wq.getPropertyListQuery(null, settings.pageLength, settings.start);\r\n        break;\r\n        case 'Show_All_Classes':\r\n            return wq.getClassMetaDataQuery(null, settings.pageLength, settings.start);\r\n        break;\r\n        case 'Show_Data_Class':\r\n            return  wq.getDataOfChosenClassQuery(settings.chosenValue, settings.pageLength, settings.start);\r\n        break;\r\n        case 'Show_Property_Class':\r\n            return wq.getDataOfChosenPropertyQuery(settings.chosenValue, settings.pageLength, settings.start);\r\n        break;\r\n        case 'Show_Document_Info_by_Id':\r\n            return wq.getDocumentQuery(settings.chosenValue, settings.pageLength, settings.start);\r\n        break;\r\n        default:\r\n            console.log('Invalid woql option passed');\r\n        break;\r\n\r\n    }\r\n}\r\n\r\n/*\r\n    pageInfo: current drawCallBack page change info\r\n*/\r\nDatatables.prototype.generateNewQueryOnPageChange = function(pageInfo){\r\n    if(this.qPage) UTILS.deleteStylizedEditor(this.ui, pageInfo.qTextDom);\r\n    var query = this.getQueryOnPagination(this.wQuery, pageInfo)\r\n    if(this.qPage) {\r\n        pageInfo.qTextDom.value = JSON.stringify(query,undefined, 2);\r\n        UTILS.stylizeEditor(this.ui, pageInfo.qTextDom, 'query', 'javascript');\r\n    }\r\n    return query;\r\n}\r\n\r\n/*\r\n    dt: Datatable reference\r\n    len : current number of records to display\r\n*/\r\nDatatables.prototype.getCallbackSettings = function(dt, len, start){\r\n    var pageInfo = {};\r\n    pageInfo.pageLength = len;\r\n    pageInfo.start      = start;\r\n    pageInfo.qTextDom   = dt.qTextDom;\r\n    pageInfo.query      = dt.query;\r\n    pageInfo.chosenValue = dt.chosenValue;\r\n    return pageInfo;\r\n}\r\n\r\n/*\r\n    tab: datatable table dom\r\n    settings : settings from woql txt generator\r\n    resultDOM: result dom of viewer\r\n*/\r\nDatatables.prototype.setUp = function(tab, settings, resultDOM){\r\n    // delete previous datatable\r\n    TerminusClient.FrameHelper.removeChildren(this.dtdom);\r\n    this.dtdom = document.createElement('div');\r\n    this.dtdom.appendChild(tab);\r\n    resultDOM.appendChild(this.dtdom);\r\n    // saving query text box dom to change limit value on change of datatable page length\r\n    this.qTextDom = settings.qTextDom;\r\n    this.query = settings.query;\r\n    this.chosenValue = settings.chosenValue;\r\n}\r\n\r\nDatatables.prototype.getNewDataOnChange = function(drawnTab, aSettings, resultDOM){\r\n    var pageInfo = this.getCallbackSettings(this, aSettings._iDisplayLength, aSettings._iDisplayStart);\r\n    var query = this.generateNewQueryOnPageChange(pageInfo);\r\n    return this.executeQuery(query, pageInfo, resultDOM);\r\n    //return  dtResult.result.data;\r\n}\r\n\r\nDatatables.prototype.getDataFromServer = function(dtResult,resultDOM){\r\n    var dt = this;\r\n    var tab = dtResult.tab;\r\n    this.setUp(tab, this.wrViewer.settings, resultDOM);\r\n    // initialize datatables\r\n    var table = jQuery(tab).DataTable({\r\n         searching   : false,\r\n         pageLength  : dt.wrViewer.settings.pageLength,\r\n         serverSide  : true,\r\n         processing  : true,\r\n         lengthMenu  : [5, 10, 25, 50, 75, 100],\r\n         dom         : 'RBlftip',\r\n         columns     : dtResult.result.columns,\r\n         paging      : true,\r\n         select      : true,\r\n         initComplete: function(settings) {\r\n                        var ict =settings.oInstance.api();\r\n                        ict.$('td').each(function(){\r\n                            this.setAttribute('title', $(this).html())\r\n                        })},\r\n         ajax        : function (data, callback, settings) {\r\n                        if(Object.entries(dtResult.result.data).length > 0){\r\n                            // first draw is loaded\r\n                            var res = dtResult.result.data;\r\n                            dtResult.result.data = {};\r\n                        }\r\n                        else{\r\n                            var res = dt.getNewDataOnChange(this, settings, resultDOM);\r\n                            console.log('res', res);\r\n                        }\r\n                        callback(res);},\r\n         buttons     : [{ extend: 'copy', text: 'Copy to clipboard' },\r\n                        { extend: 'excel', text: 'Export to Excel' }],\r\n         columnDefs  : [{targets:'_all',className:\"truncate\"}],\r\n         createdRow  : function(row){\r\n                            var td = $(row).find(\".truncate\");\r\n                            td.attr(\"title\", td.html());},\r\n         //colReorder  : {addFixed : true, liveDrag:true},\r\n         scrollX     : true\r\n    }); //jQuery(tab)\r\n\r\n    //styling\r\n    tab.setAttribute('class'      , 'stripe dataTable');\r\n    tab.setAttribute('style'       , 'margin: 0!important');\r\n    tab.setAttribute('cellpadding', '1');\r\n    tab.setAttribute('cellspacing', '1');\r\n    tab.setAttribute('border'     , '0');\r\n\r\n    return tab;\r\n}\r\n\r\n/*\r\nserverside: true or false\r\n*/\r\nDatatables.prototype.draw = function(dtResult, resultDOM){\r\n    return(this.getDataFromServer(dtResult, resultDOM));\r\n}\r\n\r\nmodule.exports={Datatables, CspDatatables}\r\n","/**\r\n * Object for producing a HTML view of a given object in a frame\r\n */\r\nconst HTMLFrameHelper = require('./HTMLFrameHelper');\r\n\r\nfunction HTMLObjectViewer(renderer){\r\n\tthis.renderer = renderer;\r\n\tthis.properties = [];\r\n\tthis.headerViewer = renderer.getObjectHeaderViewer();\r\n\t//this.featureViewers = {};\r\n}\r\n\r\n/**\r\n * Functions for rendering / re-rendering the object as header and body components\r\n */\r\nHTMLObjectViewer.prototype.render = function(){\r\n\tif(this.renderedDOM){\r\n\t\tvar renderedDOM = this.getObjectDOM();\r\n\t\tthis.renderedDOM.replaceWith(renderedDOM);\r\n\t\tthis.renderedDOM = renderedDOM;\r\n\t}\r\n\telse {\r\n\t\tthis.renderedDOM = this.getObjectDOM();\r\n\t}\r\n\tthis.renderedDOM.appendChild(this.getObjectIDMarker(this.renderer));\r\n\tif(this.headerViewer){\r\n\t\tthis.header = this.headerViewer.getAsDOM(this.renderer);\r\n\t\tif(this.header) this.renderedDOM.appendChild(this.header);\r\n\t}\r\n\tthis.body = this.getObjectBodyDOM();\r\n\tif(this.body) this.renderedDOM.appendChild(this.body);\r\n\treturn this.renderedDOM;\r\n}\r\n\r\nHTMLObjectViewer.prototype.getObjectDOM = function(){\r\n\tvar orientation = this.renderer.getContentOrientation();\r\n\tvar pcls = \"terminus-object-frame-\" + orientation;\r\n\tif(orientation == \"page\"){\r\n\t\tvar sp = document.createElement(\"div\");\r\n\t}\r\n\telse {\r\n\t\tvar sp = document.createElement(\"span\");\r\n\t}\r\n\tvar css = \"terminus-object-frame \" + pcls + (this.renderer.parent ? \"\" : \" terminus-root-frame\") + \" terminus-object-frame-\" + this.renderer.mode;\r\n\tsp.setAttribute(\"class\", css);\r\n\tsp.setAttribute(\"data-class\", this.renderer.subjectClass());\r\n\tsp.setAttribute(\"data-id\", this.renderer.subject());\r\n\treturn sp;\r\n}\r\n\r\nHTMLObjectViewer.prototype.getObjectBodyDOM = function(){\r\n\tvar orientation = this.renderer.getContentOrientation();\r\n\tvar pcls = \"terminus-object-properties-\" + orientation;\r\n\tif(orientation == \"page\"){\r\n\t\tvar vholder = document.createElement(\"div\");\r\n\t}\r\n\telse {\r\n\t\tvar vholder = document.createElement(\"span\");\r\n\t}\r\n    vholder.setAttribute('class', 'terminus-object-properties ' + pcls);\r\n    for(var prop in this.properties){\r\n\t\tif(this.properties[prop]) vholder.appendChild(this.properties[prop]);\r\n\t}\r\n\treturn vholder;\r\n}\r\n\r\nHTMLObjectViewer.prototype.getFeatureDOM = function(feature){\r\n\tif(this.hasFeatureViewer(feature)){\r\n\t\treturn this.featureViewer[feature](this.renderer, this);\r\n\t}\r\n}\r\n\r\nHTMLObjectViewer.prototype.redraw = function(){\r\n\tTerminusClient.FrameHelper.removeChildren(this.renderedDOM);\r\n\tthis.properties = [];\r\n\tthis.renderer.render(this);\r\n}\r\n\r\nHTMLObjectViewer.prototype.redrawHeader = function(){\r\n\tif(this.headerViewer && this.header) {\r\n\t\tvar nheader = this.headerViewer.getAsDOM(this.renderer);\r\n\t\tthis.header.replaceWith(nheader);\r\n\t\tthis.header = nheader;\r\n\t}\r\n}\r\n\r\nHTMLObjectViewer.prototype.redrawBody = function(){\r\n\tif(this.body){\r\n\t\tvar nbody = this.getObjectBodyDOM();\r\n\t\tthis.body.replaceWith(nbody);\r\n\t\tthis.body = nbody;\r\n\t}\r\n}\r\n\r\n/**\r\n * Adds a rendered version of a property to the internal properties array\r\n */\r\nHTMLObjectViewer.prototype.addRenderedProperty = function(prop, renderedprop){\r\n\tthis.properties[prop] = renderedprop;\r\n}\r\n\r\nHTMLObjectViewer.prototype.clear = function(){\r\n\tTerminusClient.FrameHelper.removeChildren(this.renderedDOM);\r\n\tthis.properties = {};\r\n}\r\n\r\n/**\r\n * Removes the object from the dom\r\n */\r\nHTMLObjectViewer.prototype.remove = function(){\r\n\tthis.renderedDOM.parentNode.removeChild(this.renderedDOM);\r\n}\r\n\r\nHTMLObjectViewer.prototype.goTo = function(subj, property){\r\n\tHTMLFrameHelper.goToName(subj, property);\r\n}\r\n\r\n/**\r\n * Generates a html anchor element to use as a marker to find the object on the page\r\n */\r\nHTMLObjectViewer.prototype.getObjectIDMarker = function(renderer){\r\n\tvar idm = document.createElement(\"a\");\r\n\tidm.setAttribute(\"class\", \"terminus-object-idmarker\");\r\n\tvar sh = TerminusClient.FrameHelper.getShorthand(renderer.subject());\r\n    if(!sh) sh = renderer.subject();\r\n    if(sh){\r\n\t\tvar bits = sh.split(\":\");\r\n\t\tif(bits.length > 1) sh = bits[1];\r\n\t\tidm.setAttribute(\"name\", sh);\r\n    }\r\n\treturn idm;\r\n}\r\n\r\nfunction HTMLObjectHeaderViewer(){}\r\n\r\nHTMLObjectHeaderViewer.prototype.getAsDOM = function(renderer){\r\n\tvar orientation = renderer.getContentOrientation();\r\n\tvar pcls = \"terminus-object-frame-btn terminus-object-header-\" + orientation;\r\n\tif(orientation == \"page\"){\r\n\t\tvar objDOM = document.createElement(\"div\");\r\n\t}\r\n\telse {\r\n\t\tvar objDOM = document.createElement(\"span\");\r\n\t}\r\n\tobjDOM.setAttribute(\"class\", \"terminus-object-header \" + pcls);\r\n\tif(renderer.showFeature(\"facet\")){\r\n\t\tvar facetDOM = this.getObjectFacetDOM(renderer);\r\n\t\tif(facetDOM) objDOM.appendChild(facetDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"label\")){\r\n\t\tvar sumDOM = this.getObjectLabelDOM(renderer);\r\n\t\tif(sumDOM) objDOM.appendChild(sumDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"id\")){\r\n\t\tvar idDOM = this.getObjectIDDOM(renderer);\r\n\t\tif(idDOM) objDOM.appendChild(idDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"type\")){\r\n\t\tvar typeDOM = this.getObjectTypeDOM(renderer);\r\n\t\tif(typeDOM) objDOM.appendChild(typeDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"status\")){\r\n\t\tvar sumDOM = this.getObjectStatusDOM(renderer);\r\n\t\tif(sumDOM) objDOM.appendChild(sumDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"view\")){\r\n\t\tvar viewDOM = this.getViewPropertyDOM(renderer);\r\n\t\tif(viewDOM) objDOM.appendChild(viewDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"viewer\")){\r\n\t\tvar hideDOM = this.getViewerSelectorDOM(renderer);\r\n\t\tif(hideDOM) objDOM.appendChild(hideDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"control\")){\r\n\t\tvar controlsDOM = this.getObjectControlsDOM(renderer);\r\n\t\tif(controlsDOM) objDOM.appendChild(controlsDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"summary\")){\r\n\t\tvar controlsDOM = this.getObjectSummaryDOM(renderer);\r\n\t\tif(controlsDOM) objDOM.appendChild(controlsDOM);\r\n\t}\r\n\treturn objDOM;\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectSummaryDOM = function(renderer){\r\n\tvar sum = renderer.getSummary();\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"object-summary\", false, sum.long, sum.status);\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectControlsDOM = function(renderer){\r\n\tvar controlsDOM = document.createElement(\"span\");\r\n\tcontrolsDOM.setAttribute(\"class\", \"terminus-object-controls\");\r\n\tif(renderer.showFeature(\"add\")){\r\n\t\tvar addDOM = this.getAddPropertyDOM(renderer);\r\n\t\tif(addDOM) controlsDOM.appendChild(addDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"mode\")){\r\n\t\tvar viewsDOM = HTMLFrameHelper.getModeSelectorDOM(\"object\", renderer);\r\n\t\tif(viewsDOM) controlsDOM.appendChild(viewsDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"delete\")){\r\n\t\tvar dpropDOM = this.getObjectDeleteDOM(renderer);\r\n\t\tif(dpropDOM) controlsDOM.appendChild(dpropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"clone\")){\r\n\t\tvar cpropDOM = this.getObjectCloneDOM(renderer);\r\n\t\tif(cpropDOM) controlsDOM.appendChild(cpropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"reset\")){\r\n\t\tvar rpropDOM = this.getObjectResetDOM(renderer);\r\n\t\tif(rpropDOM) controlsDOM.appendChild(rpropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"update\")){\r\n\t\tvar upropDOM = this.getObjectUpdateDOM(renderer);\r\n\t\tif(upropDOM) controlsDOM.appendChild(upropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"show\")){\r\n\t\tvar showDOM = this.getObjectShowDOM(renderer);\r\n\t\tif(showDOM) controlsDOM.appendChild(showDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"hide\")){\r\n\t\tvar hideDOM = this.getObjectHideDOM(renderer);\r\n\t\tif(hideDOM) controlsDOM.appendChild(hideDOM);\r\n\t}\r\n\treturn controlsDOM;\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectFacetDOM = function(renderer){\r\n\tvar viewables = renderer.getAvailableFacets();\r\n\tvar self = this;\r\n\tif(viewables && viewables.length){\r\n\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-object-facet\");\r\n\t\tvar callback = function(val){\r\n\t\t\tif(val){\r\n\t\t\t\trenderer.setFacet(val);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"object-facet\", viewables, renderer.currentFacet(), callback);\r\n\t\tmpropDOM.appendChild(sel);\r\n\t\treturn mpropDOM;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectLabelDOM = function(renderer){\r\n\tvar lab = renderer.getLabel();\r\n\tif(lab){\r\n\t\treturn HTMLFrameHelper.getInfoboxDOM(\"object-label\", false, lab);\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectIDDOM = function(renderer){\r\n\tvar val = renderer.subject();\r\n\tvar input = false;\r\n\tif(renderer.mode == \"edit\" && renderer.isNewDocument()){\r\n\t\tif(renderer.idDOM) val = renderer.idDOM.value;\r\n\t\tinput = document.createElement(\"input\");\r\n\t\tinput.setAttribute(\"class\", \"terminus-object-id-input\");\r\n\t\tinput.required  = true;\r\n\t\tif(val == \"_:\") val = \"\";\r\n\t\trenderer.idDOM = input;\r\n\t}\r\n\telse {\r\n\t\tif(renderer.isNewDocument() && val == \"_:\") val = \"New Document\";\r\n\t}\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"object-id\", \"ID\", val, \"Every fragment of data is identified by a unique URL\", input);\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectTypeDOM = function(renderer){\r\n\tif(renderer.mode == \"edit\" && renderer.parent && renderer.parent.isClassChoice() && renderer.isNew()){\r\n\t\tvar cs = renderer.parent.getAvailableClassChoices();\r\n\t\tif(cs && cs.length){\r\n\t\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\t\tmpropDOM.setAttribute(\"class\", \"terminus-property-change-class\");\r\n\t\t\tvar mlabDOM = document.createElement(\"span\");\r\n\t\t\tmlabDOM.setAttribute(\"class\", \"terminus-property-change-label\");\r\n\t\t\tmlabDOM.appendChild(document.createTextNode(\"Type\"));\r\n\t\t\tmpropDOM.appendChild(mlabDOM);\r\n\t\t\tvar callback = function(cls){\r\n\t\t\t\tif(cls){\r\n\t\t\t\t\trenderer.changeClass(cls);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"change-class\", cs, renderer.subjectClass(), callback);\r\n\t\t\tmpropDOM.appendChild(sel);\r\n\t\t\treturn mpropDOM;\r\n\t\t}\r\n\t}\r\n\tvar cm = renderer.getClassMeta(renderer.subjectClass());\r\n\tvar lab = renderer.subjectClass();\r\n\tvar cmt = \"All objects have types, identified by a unique URL\";\r\n\tif(cm){\r\n\t\tlab = HTMLFrameHelper.getVariableValueFromBinding(\"Label\", cm);\r\n\t\tcmt = HTMLFrameHelper.getVariableValueFromBinding(\"Comment\", cm);\r\n\t\tcmt = (cmt ? renderer.subjectClass() + \" \" + cmt : renderer.subjectClass());\r\n\t}\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"object-type\", \"Type\", lab, cmt);\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectStatusDOM = function(renderer){\r\n\tvar sum = renderer.getSummary();\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"status-\"+sum.status, false, sum.status, sum.status);\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getAddPropertyDOM = function(renderer){\r\n\tvar addables = renderer.getAddableProperties();\r\n\tif(addables && addables.length){\r\n\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-object-add-property\");\r\n\t\taddables.unshift({ value: \"\", label: \"Add New Property\"});\r\n\t\tvar callback = function(add){\r\n\t\t\tif(add){\r\n\t\t\t\trenderer.addNewProperty(add);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar disabled = (renderer.cardControlAllows(\"add\") ? false : \"Cardinality Rules Forbid Add\");\r\n\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"add-property\", addables, \"\", callback, disabled);\r\n\t\tmpropDOM.appendChild(sel);\r\n\t\treturn mpropDOM;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getViewPropertyDOM = function(renderer){\r\n\tvar viewables = renderer.getViewableProperties();\r\n\tvar self = this;\r\n\tif(viewables && viewables.length){\r\n\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-object-view-property\");\r\n\t\tviewables.unshift({ value: \"\", label: \"View Property\"});\r\n\t\tvar callback = function(add){\r\n\t\t\tif(add){\r\n\t\t\t\trenderer.goToProperty(add);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"view-property\", viewables, \"\", callback);\r\n\t\tmpropDOM.appendChild(sel);\r\n\t\treturn mpropDOM;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectDeleteDOM = function(renderer){\r\n\tvar callback = function(){renderer.delete()};\r\n\tvar disabled = (renderer.cardControlAllows(\"delete\") ? false : \"Cardinality Rules Forbid Delete\");\r\n\treturn HTMLFrameHelper.getActionControl(\"object\", \"delete\", \"Delete\", callback, disabled);\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectCloneDOM = function(renderer){\r\n\tvar callback = function(){renderer.clone()};\r\n\tvar disabled = (renderer.cardControlAllows(\"clone\") ? false : \"Cardinality Rules Forbid Clone\");\r\n\treturn HTMLFrameHelper.getActionControl(\"object\", \"clone\", \"Clone\", callback, disabled);\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectResetDOM = function(renderer){\r\n\tvar callback = function(){renderer.reset()};\r\n\tvar disabled = (renderer.isUpdated() ? false : \"Nothing to reset\");\r\n\treturn HTMLFrameHelper.getActionControl(\"object\", \"reset\", \"Reset\", callback, disabled);\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getViewerSelectorDOM = function(renderer){\r\n\tvar viewers = renderer.getAvailableViewers();\r\n\tif(viewers && viewers.length){\r\n\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-object-viewer\");\r\n\t\tvar callback = function(viewer){\r\n\t\t\tif(viewer){\r\n\t\t\t\trenderer.setViewer(viewer);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar selected = renderer.currentViewer();\r\n\t\tvar sel = HTMLFrameHelper.getSelectionControl('object-viewer', viewers, selected, callback);\r\n\t\tmpropDOM.appendChild(sel);\r\n\t\treturn mpropDOM;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectHideDOM = function(renderer){\r\n\tvar callback = function(){renderer.hide()};\r\n\treturn HTMLFrameHelper.getActionControl(\"object\", \"hide\", \"Hide\", callback);\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectShowDOM = function(renderer){\r\n\tvar callback = function(){renderer.show()};\r\n\treturn HTMLFrameHelper.getActionControl(\"object\", \"show\", \"Show\", callback);\r\n}\r\n\r\nHTMLObjectHeaderViewer.prototype.getObjectUpdateDOM = function(renderer){\r\n\tvar dpropDOM = document.createElement(\"span\");\r\n\tdpropDOM.setAttribute(\"class\", \"terminus-object-update\");\r\n\tif(renderer.isNewDocument()){\r\n\t\tvar disabled = false;//(renderer.isUpdated() ? false : \"No changes\");\r\n\t}\r\n\telse {\r\n\t\tvar disabled = (renderer.isUpdated() ? false : \"No changes\");\r\n\t}\r\n\tvar saveback = function(){renderer.save()};\r\n\tdpropDOM.appendChild(HTMLFrameHelper.getActionControl(\"object\", \"save\", \"Save\", saveback, disabled));\r\n\treturn dpropDOM;\r\n}\r\n\r\nmodule.exports={HTMLObjectViewer,HTMLObjectHeaderViewer}\r\n","function HTMLStringViewer(options){\r\n\tthis.size = ((options && options.size) ? options.size : false);\r\n\tthis.css = ((options && options.css) ? \"terminus-literal-value \" + options.css : \"terminus-literal-value\");\r\n}\r\n\r\nHTMLStringViewer.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar value = renderer.value();\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', this.css);\r\n\tinput.setAttribute('data-value', value);\r\n\tvalue = document.createTextNode(value);\r\n\tinput.appendChild(value);\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={HTMLStringViewer}\r\n\r\n\r\n","function HTMLDateHelper(){\r\n\tthis.months = [\"January\", \"Februrary\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"];\r\n}\r\n\r\nHTMLDateHelper.prototype.getMonthName = function(num){\r\n\treturn this.months[num-1];\r\n}\r\n\r\nmodule.exports={HTMLDateHelper}","\r\nfunction GoogleMapHelper(options){\r\n\tthis.polygon = false;\r\n\tthis.polyline = false;\r\n\tthis.markers = [];\r\n\tthis.init(options);\r\n}\r\n\r\nGoogleMapHelper.prototype.init = function(config){\r\n\tthis.type = ((config && config.type) ? config.type: 'Shape'); \r\n\tthis.width = ((config && config.width) ? config.width : '400px'); \r\n\tthis.height = ((config && config.height ) ? config.height : '400px'); \r\n\tthis.mapLat = ((config && config.mapLat) ? config.mapLat : '41.9010004'); \r\n\tthis.mapLong = ((config && config.mapLong ) ? config.mapLong : '12.500061500000015');\r\n\tthis.zoom = ((config && config.zoom) ? config.zoom : 3);\r\n\tthis.stroke = ((config && config.stroke) ? config.stroke : { color: '#FF0000', opacity: 0.3, weight: 3});\r\n\tthis.fill = ((config && config.fill) ? config.fill : { color: '#FF0000', opacity: 0.1});\r\n\tthis.line = ((config && config.line) ? config.line : { color: '#000000', opacity: 0.9, weight: 3});\r\n}\r\n\r\nGoogleMapHelper.prototype.destroy = function(){\r\n    this.clear();\r\n} \r\n\r\nGoogleMapHelper.prototype.translatePolygonToArray = function(polygon){\r\n   var data = \"[\";\r\n   var vertices = polygon.getPath();\r\n   var seenValue = false;\r\n   for (var j=0; j<vertices.getLength(); j++){\r\n       if(seenValue){\r\n           data = data + \",\";\r\n       }\r\n       var xy = vertices.getAt(j);\r\n       data = data + \"[\" + xy.lat() + \",\" + xy.lng() + \"]\"\r\n       seenValue = true;\r\n   }\r\n   data = data + \"]\";\r\n   return data;\r\n};\r\n\r\nGoogleMapHelper.prototype.translateArrayToPolygon = function(array){\r\n   var jsonified = JSON.parse(array);\r\n   var output = [];\r\n   for(var i=0;i<jsonified.length;i++){\r\n       var latlong = {}\r\n       latlong.lat = jsonified[i][0];\r\n       latlong.lng = jsonified[i][1];\r\n       output.push(latlong);\r\n   }\r\n   return output;\r\n}\r\n\r\nGoogleMapHelper.prototype.createPolygon = function(coords, map) {\r\n\tvar polygon = new google.maps.Polygon({\r\n        paths: coords,\r\n        strokeColor: this.stroke.color,\r\n        strokeOpacity: this.stroke.opacity,\r\n        strokeWeight: this.stroke.weight,\r\n        fillColor: this.fill.color,\r\n        fillOpacity: this.fill.opacity\r\n\t});\r\n    polygon.setMap(map);\r\n\treturn polygon;\r\n}\r\n\r\nGoogleMapHelper.prototype.createPolyline = function(coords){\r\n\tvar init = {\r\n\t      strokeColor: this.line.color,\r\n\t      strokeOpacity: this.line.opacity,\r\n\t      strokeWeight: this.line.weight\r\n\t};\r\n\tif(coords){\r\n\t\tinit.paths = coords;\r\n\t}\r\n\tvar poly = new google.maps.Polyline(init);\r\n\treturn poly;\r\n}\r\n\r\nGoogleMapHelper.prototype.clearMarkers = function() {\r\n\tfor (var i = 0; i < this.markers.length; i++ ) {\r\n\t\tthis.markers[i].setMap(null);\r\n\t}\r\n\tthis.markers.length = 0;\r\n}\r\n\r\n\r\nGoogleMapHelper.prototype.addMarker = function(position, map, renderer, title, ty) {\r\n\tvar init = {\r\n\t\tposition: position, \r\n\t\tmap: map\r\n\t}\r\n\tif(title){\r\n\t\tinit.title = title;\r\n\t}\r\n\tvar marker = new google.maps.Marker(init);\r\n\tvar self = this;\r\n\tif(this.markers.length == 0 && ty == \"xdd:coordinatePolygon\"){\r\n     \tmarker.addListener('click', function() {\r\n\t\t\tvar coords = self.getCoordsFromMarkers();\r\n    \t\tself.polygon = self.createPolygon(coords, map);\r\n            self.clearMarkers();\r\n            self.polyline.setMap(null);\r\n            renderer.set(self.translatePolygonToArray(self.polygon));\r\n        });                \t\r\n    }\r\n\tthis.markers.push(marker);\r\n\tif(ty == \"xdd:coordinatePolyline\"){\r\n\t\tvar x = this.translatePolygonToArray(this.polyline);\r\n\t\trenderer.set(x);\r\n\t}\r\n\treturn marker;\r\n}\r\n\r\nGoogleMapHelper.prototype.getCoordsFromMarkers = function(){\r\n\treturn this.polyline.getPath();\r\n}\r\n\r\nGoogleMapHelper.prototype.clear = function(){\r\n\tif(this.polygon) {\r\n\t\tthis.polygon.setMap(null);\r\n\t\tthis.polygon = false;\r\n\t}\r\n\tif(this.polyline) {\r\n\t\tthis.clearMarkers();\r\n\t\tthis.polyline.setMap(null);\r\n\t}\r\n}\r\n\r\nGoogleMapHelper.prototype.initMap = function(mapContainer, renderer, value, type){\r\n\tmapContainer.style.width = this.width;\r\n\tmapContainer.style.height = this.height;\r\n\tif(typeof google == \"undefined\"){\r\n\t\talert(\"google is not effing loaded\");\r\n\t\treturn false;\r\n\t}\r\n\tvar map = new google.maps.Map(mapContainer, {\r\n\t    zoom: this.zoom,\r\n\t\tcenter: {lat: parseFloat(this.mapLat), lng: parseFloat(this.mapLong)}  \r\n\t});\r\n\tif(type == \"xdd:coordinatePolygon\"){\r\n\t    this.polyline = this.createPolyline();\r\n\t\tthis.polyline.setMap(map);\r\n\t\tvar coords = (value ? this.translateArrayToPolygon(value) : []);\r\n\t\tif(value){\r\n\t    \tthis.polygon = this.createPolygon(coords, map);\r\n\t    }\r\n\t}\r\n\telse if(type == \"xdd:coordinatePolyline\"){\r\n\t\tvar coords = (value ? this.translateArrayToPolygon(value) : []);\r\n\t    this.polyline = this.createPolyline();\r\n\t\tthis.polyline.setMap(map);\t\t\r\n\t\tif(value){\r\n\t    \tthis.polyline.setPath(coords);\r\n\t    }\r\n\t}\t\r\n\telse if(type == \"xdd:coordinate\"){\r\n\t\tif(value){\r\n\t\t\tthis.clearMarkers();\r\n            var lat = parseFloat(value.substring(1, value.indexOf(\",\")));\r\n\t\t\tvar long = parseFloat(value.substring(value.indexOf(\",\")+1, value.length-1));\r\n            var init = {\r\n            \tposition: {lat: lat, lng: long},\r\n        \t\tmap: map\r\n\t        }\r\n\t        var marker = new google.maps.Marker(init);\r\n\t        this.markers.push(marker);\r\n\t\t}\r\n\t}\r\n    google.maps.event.trigger(map, 'resize');\r\n    return map;\r\n}\r\n\r\nmodule.exports=GoogleMapHelper;","const HTMLFrameHelper = require('./HTMLFrameHelper');\r\n\r\n/**\r\n * Property Viewer\r\n */\r\nfunction HTMLPropertyViewer(renderer){\r\n\tthis.renderer = renderer;\r\n\tthis.values = [];\r\n\tthis.headerViewer = renderer.getPropertyHeaderViewer();\r\n}\r\n\r\n\r\n/**\r\n * Draws the property as header and body components\r\n */\r\nHTMLPropertyViewer.prototype.render = function(){\r\n\t//var block = document.createElement('div');\r\n\t//block.setAttribute('style', 'display: flex; margin: 10px');\r\n\t//var br = document.createElement('br');\r\n\t//block.appendChild(br);\r\n\tif(this.propDOM){\r\n\t\tvar npropDOM = this.getPropertyDOM();\r\n\t\t//npropDOM.setAttribute('style', 'display: flex; margin: 10px;');\r\n\t\t\t//block.appendChild(npropDOM);\r\n\t\tthis.propDOM.replaceWith(npropDOM);\r\n\t\tthis.propDOM = npropDOM;\r\n\t\t//this.propDOM = block;\r\n\t}\r\n\telse {\r\n\t\t//block.appendChild(this.getPropertyDOM());\r\n\t\t//this.propDOM = block;\r\n\t\tthis.propDOM = this.getPropertyDOM();\r\n\t\t//this.propDOM.setAttribute('style', 'display: flex; margin: 10px;');\r\n\t}\r\n\tthis.propDOM.appendChild(this.getPropertyIDMarker(this.renderer));\r\n\tif(this.headerViewer){\r\n\t\tthis.header = this.headerViewer.getAsDOM(this.renderer);\r\n\t\tif(this.header) this.propDOM.appendChild(this.header);\r\n\t}\r\n\tthis.body = this.getPropertyBodyDOM();\r\n\tif(this.body) this.propDOM.appendChild(this.body);\r\n\treturn this.propDOM;\r\n}\r\n\r\nHTMLPropertyViewer.prototype.getPropertyDOM = function(){\r\n\tvar orientation = this.renderer.getContentOrientation();\r\n\tvar pcls = \" terminus-property-frame-display terminus-property-frame-\" + orientation;\r\n\tif(orientation == \"label\"){\r\n\t\tvar sp = document.createElement(\"span\");\r\n\t}\r\n\telse {\r\n\t\tvar sp = document.createElement(\"div\");\r\n\t}\r\n\t//terminus-property-frame-spacer\r\n\r\n\tsp.setAttribute(\"class\", \"terminus-property-frame terminus-zebra-frame terminus-property-frame-\" + this.renderer.mode + \" \" + pcls);\r\n\tsp.setAttribute('data-property', this.renderer.property());\r\n\treturn sp;\r\n}\r\n\r\nHTMLPropertyViewer.prototype.getPropertyBodyDOM = function(){\r\n\tvar orientation = this.renderer.getContentOrientation();\r\n\tvar pcls = \"terminus-property-values-\" + orientation;\r\n\tif(orientation == \"page\"){\r\n\t\tvar vholder = document.createElement(\"div\");\r\n\t}\r\n\telse {\r\n\t\tvar vholder = document.createElement(\"span\");\r\n\t}\r\n    vholder.setAttribute('class', 'terminus-property-values ' + pcls + ' terminus-property-values-align');\r\n\tfor(var i =0; i<this.values.length; i++){\r\n\t\tvholder.appendChild(this.values[i]);\r\n\t}\r\n\treturn vholder;\r\n}\r\n\r\nHTMLPropertyViewer.prototype.addRenderedValue = function(renderedval){\r\n\tthis.values.push(renderedval);\r\n}\r\n\r\nHTMLPropertyViewer.prototype.clear = function(){\r\n\tTerminusClient.FrameHelper.removeChildren(this.propDOM);\r\n\tthis.values = [];\r\n}\r\n\r\n\r\n/**\r\n * Removes the property from the dom\r\n */\r\nHTMLPropertyViewer.prototype.remove = function(){\r\n\tthis.propDOM.parentNode.removeChild(this.propDOM);\r\n}\r\n\r\n/**\r\n * Redraws the property to reflect an updated state\r\n */\r\nHTMLPropertyViewer.prototype.redraw = function(){\r\n\tvar npropDOM = this.getPropertyDOM();\r\n\tthis.propDOM.replaceWith(npropDOM);\r\n\tthis.propDOM = npropDOM;\r\n\tthis.values = [];\r\n\tthis.renderer.render(this);\r\n}\r\n\r\nHTMLPropertyViewer.prototype.redrawHeader = function(){\r\n\tif(this.headerViewer && this.header) {\r\n\t\tvar nheader = this.headerViewer.getAsDOM(this.renderer);\r\n\t\tthis.header.replaceWith(nheader);\r\n\t\tthis.header = nheader;\r\n\t}\r\n}\r\n\r\nHTMLPropertyViewer.prototype.redrawBody = function(){\r\n\tif(this.body){\r\n\t\tvar nbody = this.getPropertyBodyDOM();\r\n\t\tthis.body.replaceWith(nbody);\r\n\t\tthis.body = nbody;\r\n\t}\r\n}\r\n\r\n/**\r\n * Generates a html anchor element to use as a marker to find the property on the page\r\n */\r\nHTMLPropertyViewer.prototype.getPropertyIDMarker = function(renderer){\r\n\tvar idm = document.createElement(\"a\");\r\n\tidm.setAttribute(\"class\", \"terminus-property-idmarker\");\r\n\tvar subj = TerminusClient.FrameHelper.getShorthand(renderer.subject());\r\n\tif(!subj ) subj = renderer.subject();\r\n\tvar bits = subj .split(\":\");\r\n\tif(bits.length > 1) subj = bits[1];\r\n\tvar prop = TerminusClient.FrameHelper.getShorthand(renderer.property());\r\n\tif(!prop ) prop = renderer.property();\r\n\tvar bits = prop.split(\":\");\r\n\tif(bits.length > 1) prop = bits[1];\r\n\tidm.setAttribute(\"name\", subj + \"_\" + prop);\r\n\treturn idm;\r\n}\r\n\r\nHTMLPropertyViewer.prototype.goTo = function(subj, property, index){\r\n\tHTMLFrameHelper.goToName(subj, property, index);\r\n}\r\n\r\nfunction HTMLPropertyHeaderViewer(){}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getAsDOM = function(renderer){\r\n\tvar orientation = renderer.getContentOrientation();\r\n\tvar pcls = \"terminus-property-header-\" + orientation;\r\n\tif(orientation == \"page\"){\r\n\t\tvar objDOM = document.createElement(\"div\");\r\n\t}\r\n\telse {\r\n\t\tvar objDOM = document.createElement(\"span\");\r\n\t}\r\n\tobjDOM.setAttribute(\"class\", \"terminus-text terminus-property-header \" + pcls);\r\n\tvar wrapper = document.createElement(\"span\");\r\n\twrapper.setAttribute(\"class\", \"terminus-property-header-wrapper\");\r\n\tif(renderer.showFeature(\"control\")){\r\n\t\tvar expModeMenu = this.getPropertyControlsDOM(wrapper, renderer);\r\n\t\tif(orientation == 'page') this.expModeMenu = expModeMenu;\r\n\t\telse this.expModeMenu = null;\r\n\t}\r\n\tif(renderer.showFeature(\"label\")){\r\n\t\tvar sumDOM = this.getPropertyLabelDOM(renderer);\r\n\t\tif(renderer.showFeature(\"status\")){\r\n\t\t\tvar statDOM = this.getPropertyStatusDOM(renderer);\r\n\t\t\tif(statDOM) sumDOM.prepend(statDOM);\r\n\t\t}\r\n\t\tif(sumDOM) wrapper.appendChild(sumDOM);\r\n\t}\r\n\telse if(renderer.showFeature(\"status\")){\r\n\t\tvar statDOM = this.getPropertyStatusDOM(renderer);\r\n\t\tif(statDOM) wrapper.appendChild(statDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"summary\")){\r\n\t\tvar sumDOM = this.getPropertySummaryDOM(renderer);\r\n\t\tif(sumDOM) wrapper.appendChild(sumDOM);\r\n\t}\r\n\r\n\tvar prelude = document.createElement(\"span\");\r\n\tprelude.setAttribute(\"class\", \"terminus-property-header-info terminus-property-header-info-\"+renderer.currentFacet());\r\n\r\n\tif(renderer.showFeature(\"facet\")){\r\n\t\tvar facetDOM = this.getPropertyFacetDOM(renderer);\r\n\t\tif(facetDOM) prelude.appendChild(facetDOM);\r\n\t\t//if(facetDOM && this.expModeMenu) this.expModeMenu.appendChild(facetDOM);//\r\n\t}\r\n\tif(renderer.showFeature(\"view\")){\r\n\t\tvar viewDOM = this.getViewValueDOM(renderer);\r\n\t\tif(viewDOM) prelude.appendChild(viewDOM);\r\n\t\t//if(viewDOM && this.expModeMenu) this.expModeMenu.appendChild(viewDOM); //prelude.appendChild(viewDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"id\")){\r\n\t\tvar idDOM = this.getPropertyIDDOM(renderer);\r\n\t\tif(idDOM) prelude.appendChild(idDOM);\r\n\t\t//if(idDOM && this.expModeMenu) this.expModeMenu.appendChild(idDOM); //\r\n\t}\r\n\tif(renderer.showFeature(\"type\")){\r\n\t\tvar typeDOM = this.getPropertyRangeDOM(renderer);\r\n\t\tif(typeDOM)\tprelude.appendChild(typeDOM);\r\n\t\t/*if(typeDOM && this.expModeMenu){\r\n\t\t\tthis.expModeMenu.appendChild(typeDOM);//\r\n\t\t\ttypeDOM.style.display = 'block';\r\n\t\t}*/\r\n\t}\r\n\tif(renderer.showFeature(\"cardinality\") && renderer.hasCardinalityRestriction()){\r\n\t\tvar hideDOM = this.getPropertyCardinalityDOM(renderer);\r\n\t\tif(hideDOM) prelude.appendChild(hideDOM);\r\n\t\t//\tthis.expModeMenu.appendChild(hideDOM); \t\t\thideDOM.style.display = 'block';\r\n\r\n\t}\r\n\tif(renderer.showFeature(\"comment\")){\r\n\t\tvar sumDOM = this.getPropertyCommentDOM(renderer);\r\n\t\tif(sumDOM) prelude.appendChild(sumDOM);\r\n\t\t/*if(sumDOM && this.expModeMenu){\r\n\t\t\tthis.expModeMenu.appendChild(sumDOM); //\r\n\t\t\tsumDOM.style.display = 'block';\r\n\t\t}*/\r\n\t}\r\n\twrapper.appendChild(prelude);\r\n\tobjDOM.appendChild(wrapper);\r\n\treturn objDOM;\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyFacetDOM = function(renderer){\r\n\tvar viewables = renderer.getAvailableFacets();\r\n\tvar self = this;\r\n\tif(viewables && viewables.length){\r\n\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-property-facet\");\r\n\t\tvar callback = function(val){\r\n\t\t\tif(val){\r\n\t\t\t\trenderer.setFacet(val);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"property-facet\", viewables, renderer.currentFacet(), callback);\r\n\t\tmpropDOM.appendChild(sel);\r\n\t\treturn mpropDOM;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyIDDOM = function(renderer){\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"property-id\", \"Property\", renderer.property(), \"This property is identified by this unique URL: \" + renderer.property());\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyRangeDOM = function(renderer){\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"property-type\", \"Type\", renderer.range(), \"The type of arguments that this property accepts\");\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertySummaryDOM = function(renderer){\r\n\tvar sum = renderer.getSummary();\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"property-summary\", false, sum.long, sum.status);\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyStatusDOM = function(renderer){\r\n\tvar sum = renderer.getSummary();\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"status-\"+sum.status, false, sum.status, sum.status);\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyLabelDOM = function(renderer){\r\n\tvar lab = renderer.getLabel();\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"property-label\", false, lab);\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyCommentDOM = function(renderer){\r\n\tvar lab = renderer.getComment();\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"property-comment\", false, lab);\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyCardinalityDOM = function(renderer){\r\n\tvar restriction = renderer.getRestriction();\r\n\tif(restriction.min && restriction.max){\r\n\t\tif(restriction.min == restriction.max){\r\n\t\t\tvar lab = restriction.min;\r\n\t\t\tvar help = \"Cardinality: \" + restriction.min;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tvar lab = restriction.min + \"-\" + restriction.max;\r\n\t\t\tvar help = \"Minimum Cardinality: \" + restriction.min;\r\n\t\t\thelp += \", Maximum Cardinality: \" + restriction.max;\r\n\t\t}\r\n\t}\r\n\telse if(restriction.min){\r\n\t\tvar lab = \">\"+(restriction.min-1);\r\n\t\tvar help = \"Minimum Cardinality: \" + restriction.min;\r\n\t}\r\n\telse if(restriction.max){\r\n\t\tvar lab = \"<\"+(restriction.max+1);\r\n\t\tvar help = \"Maximum Cardinality: \" + restriction.max;\r\n\t}\r\n\telse {\r\n\t\treturn false;\r\n\t}\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"property-cardinality\", \"Cardinality\", lab, help);\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getActionControlDOM = function(settingsDOM, renderer){\r\n\tif(renderer.showFeature(\"mode\")){\r\n\t\tvar viewsDOM = HTMLFrameHelper.getModeSelectorDOM(\"property\", renderer);\r\n\t\tif (viewsDOM) settingsDOM.appendChild(viewsDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"delete\")){\r\n\t\tvar dpropDOM = this.getPropertyDeleteDOM(renderer);\r\n\t\tif (dpropDOM) settingsDOM.appendChild(dpropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"add\") && !renderer.isClassChoice()){\r\n\t\tvar addDOM = this.getAddValueDOM(renderer);\r\n\t\tif(addDOM) settingsDOM.appendChild(addDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"reset\")){\r\n\t\tvar rpropDOM = this.getPropertyResetDOM(renderer);\r\n\t\tif(rpropDOM) settingsDOM.appendChild(rpropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"update\")){\r\n\t\tvar upropDOM = this.getPropertyUpdateDOM(renderer);\r\n\t\tif(upropDOM) settingsDOM.appendChild(upropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"show\")){\r\n\t\tvar showDOM = this.getPropertyShowDOM(renderer);\r\n\t\tif(showDOM) settingsDOM.appendChild(showDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"hide\")){\r\n\t\tvar hideDOM = this.getPropertyHideDOM(renderer);\r\n\t\tif(hideDOM) settingsDOM.appendChild(hideDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"viewer\")){\r\n\t\tvar hideDOM = this.getViewerSelectorDOM(renderer);\r\n\t\tif(hideDOM) settingsDOM.appendChild(hideDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"add\") && renderer.isClassChoice()){\r\n\t\tvar addDOM = this.getAddValueDOM(renderer);\r\n\t\tif(addDOM) settingsDOM.appendChild(addDOM);\r\n\t}\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getSettingsControlDOM = function(controlsDOM, renderer){\r\n\tvar settings = document.createElement(\"div\");\r\n\tcontrolsDOM.appendChild(settings);\r\n\tvar orientation = renderer.getContentOrientation();\r\n\tif(false && orientation == 'page'){ // expert mode\r\n\t\tvar sControl = HTMLFrameHelper.getSettingsControl('property');\r\n\t\tvar menu = document.createElement('div');\r\n\t\tmenu.setAttribute('class', 'terminus-hide terminus-popup');\r\n\t\tmenu.appendChild(document.createTextNode('Edit property'));\r\n\t\tmenu.appendChild(document.createElement('BR'));\r\n\t\tsControl.appendChild(menu);\r\n\t\tsControl.addEventListener('click', function(e){\r\n\t\t\tvar target = e.target || e.srcElement,\r\n        \ttext = target.textContent || target.innerText;\r\n\t\t\tif((target.nodeName == 'ICON') || (target.nodeName == 'BUTTON')){\r\n\t\t\t\tif(this.children[0].style.display == 'none') this.children[0].style.display = 'block';\r\n\t\t\t\telse this.children[0].style.display = 'none';\r\n\t\t\t}\r\n\t\t});\r\n\t\tthis.getActionControlDOM(menu, renderer);\r\n\t    settings.appendChild(sControl);\r\n\t\treturn menu;\r\n\t}\r\n\telse this.getActionControlDOM(controlsDOM, renderer);\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyControlsDOM = function(wrapper, renderer){\r\n\tvar controlsDOM = document.createElement(\"span\");\r\n\tcontrolsDOM.setAttribute(\"class\", \"terminus-property-controls\");\r\n\t//controlsDOM.setAttribute(\"style\", \"display: table-cell;\");\r\n\t// get settings icon or button\r\n\tvar expModeMenu = this.getSettingsControlDOM(controlsDOM, renderer);\r\n\twrapper.appendChild(controlsDOM);\r\n\treturn expModeMenu;\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getAddValueDOM = function(renderer){\r\n\tif(renderer.isClassChoice()){\r\n\t\tvar cs = renderer.getAvailableClassChoices();\r\n\t\tif(cs && cs.length){\r\n\t\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\t\tmpropDOM.setAttribute(\"class\", \"terminus-property-add-class\");\r\n\t\t\tcs.unshift({ value: \"\", label: \"Add Type\"});\r\n\t\t\tvar callback = function(cls){\r\n\t\t\t\tif(cls){\r\n\t\t\t\t\trenderer.addClass(cls);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"add-property\", cs, \"\", callback);\r\n\t\t\tmpropDOM.appendChild(sel);\r\n\t\t\treturn mpropDOM;\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tvar callback = function(){renderer.add(\"edit\")};\r\n\t\tvar disabled = (renderer.cardControlAllows(\"add\") ? false : \"Cardinality Rules Forbid Add\");\r\n\t\treturn HTMLFrameHelper.getActionControl(\"property\", \"add\", \"Add\", callback, disabled);\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getViewValueDOM = function(renderer){\r\n\tvar viewables = renderer.getViewableValues();\r\n\tvar self = this;\r\n\tif(viewables && viewables.length){\r\n\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-property-view-value\");\r\n\t\tviewables.unshift({ value: \"\", label: \"View Value\"});\r\n\t\tvar callback = function(val){\r\n\t\t\trenderer.goToValue(val);\r\n\t\t}\r\n\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"view-values\", viewables, \"\", callback);\r\n\t\tmpropDOM.appendChild(sel);\r\n\t\treturn mpropDOM;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyDeleteDOM = function(renderer){\r\n\tvar callback = function(){renderer.delete()};\r\n\tvar disabled = (renderer.cardControlAllows(\"delete\") ? false : \"Cardinality Rules Forbid Delete\");\r\n\treturn HTMLFrameHelper.getActionControl(\"property\", \"delete\", \"Delete\", callback, disabled);\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyHideDOM = function(renderer){\r\n\tvar callback = function(){renderer.hide()};\r\n\treturn HTMLFrameHelper.getActionControl(\"property\", \"hide\", \"Hide\", callback);\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyResetDOM = function(renderer){\r\n\tvar callback = function(){renderer.reset()};\r\n\tvar disabled = (renderer.isUpdated() ? false : \"Nothing to reset\");\r\n\treturn HTMLFrameHelper.getActionControl(\"property\", \"reset\", \"Reset\", callback, disabled);\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyShowDOM = function(renderer){\r\n\tvar callback = function(){renderer.show()};\r\n\treturn HTMLFrameHelper.getActionControl(\"property\", \"show\", \"Show\", callback);\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getPropertyUpdateDOM = function(renderer){\r\n\tvar dpropDOM = document.createElement(\"span\");\r\n\tdpropDOM.setAttribute(\"class\", \"terminus-property-update\");\r\n\tvar disabled = (renderer.isUpdated() ? false : \"No Change\");\r\n\tvar saveback = function(){renderer.save()};\r\n\tdpropDOM.appendChild(HTMLFrameHelper.getActionControl(\"property\", \"save\", \"Save\", saveback, disabled));\r\n\treturn dpropDOM;\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.getViewerSelectorDOM = function(renderer){\r\n\tvar viewers = renderer.getAvailableViewers();\r\n\tif(viewers && viewers.length){\r\n\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-property-viewer\");\r\n\t\tvar callback = function(viewer){\r\n\t\t\tif(viewer){\r\n\t\t\t\trenderer.setViewer(viewer);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar selected = renderer.currentViewer();\r\n\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"property-viewers\", viewers, selected, callback);\r\n\t\tmpropDOM.appendChild(sel);\r\n\t\treturn mpropDOM;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLPropertyHeaderViewer.prototype.showValue = function(renderer, index){\r\n\tvar htmlid = renderer.subject() + \"->\" + renderer.property() + \"_\" + index;\r\n\twindow.location = (\"\"+window.location).replace(/#[A-Za-z0-9_]*$/,'') + \"#\" + htmlid;\r\n}\r\n\r\nfunction HTMLDataViewer(renderer){\r\n\tthis.renderer = renderer;\r\n\tthis.headerViewer = renderer.getValueHeaderViewer();\r\n}\r\n\r\nmodule.exports={HTMLPropertyViewer,HTMLPropertyHeaderViewer}\r\n","/**\r\n * Draws the property as header and body components\r\n */\r\nconst HTMLFrameHelper = require('./HTMLFrameHelper');\r\nconst HTMLStringViewer = require('./viewers/String');\r\n\r\nfunction HTMLDataViewer(renderer){\r\n\tthis.renderer = renderer;\r\n\tthis.headerViewer = renderer.getValueHeaderViewer();\r\n}\r\n\r\nHTMLDataViewer.prototype.render = function(){\r\n\tif(this.valDOM){\r\n\t\tvar nvalDOM = this.getValueDOM();\r\n\t\tthis.valDOM.replaceWith(nvalDOM);\r\n\t\tthis.valDOM = nvalDOM;\r\n\t}\r\n\telse {\r\n\t\tthis.valDOM = this.getValueDOM();\r\n\t}\r\n\tthis.valDOM.appendChild(this.getValueIDMarker(this.renderer));\r\n\tthis.body = this.getValueBodyDOM();\r\n\tif(this.body) this.valDOM.appendChild(this.body);\r\n\tif(this.headerViewer){\r\n\t\tthis.header = this.headerViewer.getAsDOM(this.renderer);\r\n\t\tif(this.renderer.facet == 'page'){ //expert mode\r\n\t\t\tif(this.header && this.expModeMenu) {\r\n\t\t\t\tthis.expModeMenu.appendChild(this.header);\r\n\t\t\t\t//this.valDOM.appendChild(this.expModeMenu);\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if(this.header) this.valDOM.appendChild(this.header);\r\n\t}\r\n\treturn this.valDOM;\r\n}\r\n\r\nHTMLDataViewer.prototype.getValueDOM = function(){\r\n\tif(this.renderer.currentFacet() == \"page\"){\r\n\t\tvar sp = document.createElement(\"div\");\r\n\t}\r\n\telse {\r\n\t\tvar sp = document.createElement(\"span\");\r\n\t}\r\n\tsp.setAttribute(\"class\", \"terminus-property-value property-value-\" + this.renderer.currentFacet() + \" property-value-\" + this.renderer.mode);\r\n\tif(this.renderer.mode == \"view\"){\r\n\t\tsp.setAttribute('data-value', this.renderer.value());\r\n\t}\r\n\treturn sp;\r\n}\r\n\r\nHTMLDataViewer.prototype.getValueBodyDOM = function(){\r\n\tif(this.renderer.currentFacet() == \"page\"){\r\n\t\tvar vholder = document.createElement(\"div\");\r\n\t}\r\n\telse {\r\n\t\tvar vholder = document.createElement(\"span\");\r\n\t}\r\n    vholder.setAttribute('class', ' terminus-property-body property-value-body property-value-body-'+this.renderer.currentFacet() + ' terminus-property-body-align');\r\n\t//vholder.setAttribute('style', 'display: flex;');\r\n\tif(this.renderer.showFeature(\"body\")){\r\n        var valueViewer = this.renderer.getDataValueViewer();\r\n    \tvar vdom = valueViewer.getDOM(this.renderer, this);\r\n    }\r\n    else if(this.renderer.showFeature(\"summary\")){\r\n\t\tvar vdom = this.getSummaryDOM();\r\n    }\r\n    else {\r\n    \treturn false;\r\n    }\r\n    if(vdom) vholder.appendChild(vdom);\r\n\tif(false && this.renderer.currentFacet() == \"page\"){\r\n\t\tvar sControl = HTMLFrameHelper.getSettingsControl('data');\r\n\t\tvar menu = document.createElement('div');\r\n\t\tmenu.setAttribute('class', 'terminus-hide terminus-popup');\r\n\t\tmenu.appendChild(document.createTextNode('Edit property value'));\r\n\t\tmenu.appendChild(document.createElement('BR'));\r\n\t\tsControl.appendChild(menu);\r\n\t\tsControl.addEventListener('click', function(e){\r\n\t\t\tvar target = e.target || e.srcElement,\r\n\t\t\ttext = target.textContent || target.innerText;\r\n\t\t\tif((target.nodeName == 'ICON') || (target.nodeName == 'BUTTON')){\r\n\t\t\t\tif(this.children[0].style.display == 'none') this.children[0].style.display = 'block';\r\n\t\t\t\telse this.children[0].style.display = 'none';\r\n\t\t\t}\r\n\t\t});\r\n\t\tthis.expModeMenu = menu;\r\n\t\tvholder.appendChild(sControl);\r\n\t}\r\n\treturn vholder;\r\n}\r\n\r\n/**\r\n * Removes the value from the dom\r\n */\r\nHTMLDataViewer.prototype.remove = function(){\r\n\tthis.valDOM.parentNode.removeChild(this.valDOM);\r\n}\r\n\r\nHTMLDataViewer.prototype.redrawHeader = function(){\r\n\tif(this.headerViewer && this.header) {\r\n\t\tvar nheader = this.headerViewer.getAsDOM(this.renderer);\r\n\t\tthis.header.replaceWith(nheader);\r\n\t\tthis.header = nheader;\r\n\t}\r\n}\r\n\r\nHTMLDataViewer.prototype.redrawBody = function(){\r\n\tif(this.body){\r\n\t\tvar nbody = this.getValueBodyDOM();\r\n\t\tthis.body.replaceWith(nbody);\r\n\t\tthis.body = nbody;\r\n\t}\r\n}\r\n\r\n/**\r\n * Generates a html anchor element to use as a marker to find the property on the page\r\n */\r\nHTMLDataViewer.prototype.getValueIDMarker = function(renderer){\r\n\tvar idm = document.createElement(\"a\");\r\n\tidm.setAttribute(\"class\", \"terminus-value-idmarker\");\r\n\tvar subj = TerminusClient.FrameHelper.getShorthand(renderer.subject());\r\n\tif(!subj ) subj = renderer.subject();\r\n\tvar bits = subj .split(\":\");\r\n\tif(bits.length > 1) subj = bits[1];\r\n\tvar prop = TerminusClient.FrameHelper.getShorthand(renderer.property());\r\n\tif(!prop ) prop = renderer.property();\r\n\tvar bits = prop.split(\":\");\r\n\tif(bits.length > 1) prop = bits[1];\r\n\tidm.setAttribute(\"name\", subj + \"_\" + prop + \"_\" + renderer.index);\r\n\treturn idm;\r\n}\r\n\r\nHTMLDataViewer.prototype.getSummaryDOM = function(){\r\n\tvar sum = this.renderer.getSummary();\r\n\treturn HTMLTerminusClient.FrameHelper.getInfoboxDOM(\"value-summary\", false, sum.long, sum.long);\r\n}\r\n\r\nHTMLDataViewer.prototype.fireInternalLink = function(link){\r\n\tvar self = this;\r\n\tvar fire = function(e){\r\n\t\te.preventDefault();\r\n\t\tself.renderer.load(link);\t\t\r\n\t}\r\n\treturn fire;\r\n}\r\n\r\nHTMLDataViewer.prototype.internalLink = function(link, label){\r\n\tvar onclick = this.fireInternalLink(link);\r\n\tvar a = document.createElement(\"a\");\r\n\ta.onClick = onclick;\r\n\ta.href=link;\r\n\ta.addEventListener(\"click\", onclick);\r\n\tif(label){\r\n\t\ta.appendChild(document.createTextNode(label));\r\n\t}\r\n\telse {\r\n\t\tvar sh = TerminusClient.FrameHelper.getShorthand(link);\r\n\t\tif(sh){\r\n\t\t\ta.setAttribute(\"title\", link);\r\n\t\t\ta.appendChild(document.createTextNode(sh));\r\n\t\t}\r\n\t\telse {\r\n\t\t\ta.appendChild(document.createTextNode(link));\r\n\t\t}\r\n\t}\r\n\treturn a;\r\n}\r\n\r\nHTMLDataViewer.prototype.clear = function(){\r\n\tTerminusClient.FrameHelper.removeChildren(this.valDOM);\r\n}\r\n\r\n\r\nfunction HTMLDataHeaderViewer(){}\r\n\r\nHTMLDataHeaderViewer.prototype.getAsDOM = function(renderer){\r\n\tif(renderer.currentFacet() == \"page\"){\r\n\t\tvar objDOM = document.createElement(\"div\");\r\n\t}\r\n\telse {\r\n\t\tvar objDOM = document.createElement(\"span\");\r\n\t}\r\n\tobjDOM.setAttribute(\"class\", \"terminus-value-header terminus-value-header-\" + renderer.currentFacet());\r\n\tif(renderer.showFeature(\"facet\")){\r\n\t\tvar facetDOM = this.getValueFacetDOM(renderer);\r\n\t\tif(facetDOM) objDOM.appendChild(facetDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"viewer\")){\r\n\t\tvar hideDOM = this.getViewerSelectorDOM(renderer);\r\n\t\tif(hideDOM) objDOM.appendChild(hideDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"type\")){\r\n\t\tvar typeDOM = this.getValueTypeDOM(renderer);\r\n\t\tif(typeDOM) objDOM.appendChild(typeDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"status\")){\r\n\t\tvar sumDOM = this.getValueStatusDOM(renderer);\r\n\t\tif(sumDOM) objDOM.appendChild(sumDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"control\")){\r\n\t\tvar controlsDOM = this.getValueControlsDOM(renderer);\r\n\t\tif(controlsDOM) objDOM.appendChild(controlsDOM);\r\n\t}\r\n\treturn objDOM;\r\n}\r\n\r\nHTMLDataHeaderViewer.prototype.getValueFacetDOM = function(renderer){\r\n\tvar viewables = renderer.getAvailableFacets();\r\n\tvar self = this;\r\n\tif(viewables && viewables.length){\r\n\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-value-facet\");\r\n\t\tvar callback = function(val){\r\n\t\t\tif(val){\r\n\t\t\t\trenderer.setFacet(val);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"value-facet\", viewables, renderer.currentFacet(), callback);\r\n\t\tmpropDOM.appendChild(sel);\r\n\t\treturn mpropDOM;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\n\r\nHTMLDataHeaderViewer.prototype.getValueTypeDOM = function(renderer){\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"value-type\", \"Type\", renderer.type(), \"All data values have types, identified by a unique URL\");\r\n}\r\n\r\nHTMLDataHeaderViewer.prototype.getValueStatusDOM = function(renderer){\r\n\tvar sum = renderer.getSummary();\r\n\treturn HTMLFrameHelper.getInfoboxDOM(\"status-\"+sum.status, false, sum.status, sum.status);\r\n}\r\n\r\n\r\nHTMLDataHeaderViewer.prototype.getValueControlsDOM = function(renderer){\r\n\tvar controlsDOM = document.createElement(\"span\");\r\n\tcontrolsDOM.setAttribute(\"class\", \"terminus-value-controls\");\r\n\tif(renderer.showFeature(\"mode\")){\r\n\t\tvar viewsDOM = HTMLFrameHelper.getModeSelectorDOM(\"value\", renderer);\r\n\t\tif(viewsDOM) controlsDOM.appendChild(viewsDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"delete\")){\r\n\t\tvar dpropDOM = this.getValueDeleteDOM(renderer);\r\n\t\tif(dpropDOM) controlsDOM.appendChild(dpropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"clone\")){\r\n\t\tvar cpropDOM = this.getValueCloneDOM(renderer);\r\n\t\tif(cpropDOM) controlsDOM.appendChild(cpropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"reset\")){\r\n\t\tvar rpropDOM = this.getValueResetDOM(renderer);\r\n\t\tif(rpropDOM) controlsDOM.appendChild(rpropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"update\")){\r\n\t\tvar upropDOM = this.getValueUpdateDOM(renderer);\r\n\t\tif(upropDOM) controlsDOM.appendChild(upropDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"show\")){\r\n\t\tvar showDOM = this.getValueShowDOM(renderer);\r\n\t\tif(showDOM) controlsDOM.appendChild(showDOM);\r\n\t}\r\n\tif(renderer.showFeature(\"hide\")){\r\n\t\tvar hideDOM = this.getValueHideDOM(renderer);\r\n\t\tif(hideDOM) controlsDOM.appendChild(hideDOM);\r\n\t}\r\n\treturn controlsDOM;\r\n}\r\n\r\nHTMLDataHeaderViewer.prototype.getValueDeleteDOM = function(renderer){\r\n\tvar callback = function(){renderer.delete()};\r\n\tvar disabled = (renderer.cardControlAllows(\"delete\") ? false : \"Cardinality Rules Forbid Delete\");\r\n\treturn HTMLFrameHelper.getActionControl(\"value\", \"delete\", \"Delete\", callback, disabled);\r\n}\r\n\r\nHTMLDataHeaderViewer.prototype.getValueResetDOM = function(renderer){\r\n\tvar callback = function(){renderer.reset()};\r\n\tvar disabled = (renderer.isUpdated() ? false : \"Nothing to reset\");\r\n\treturn HTMLFrameHelper.getActionControl(\"value\", \"reset\", \"Reset\", callback, disabled);\r\n}\r\n\r\nHTMLDataHeaderViewer.prototype.getValueShowDOM = function(renderer){\r\n\tvar callback = function(){renderer.show()};\r\n\treturn HTMLFrameHelper.getActionControl(\"value\", \"show\", \"Show\", callback);\r\n}\r\n\r\nHTMLDataHeaderViewer.prototype.getValueHideDOM = function(renderer){\r\n\tvar callback = function(){renderer.hide()};\r\n\treturn HTMLFrameHelper.getActionControl(\"value\", \"hide\", \"Hide\", callback);\r\n}\r\n\r\nHTMLDataHeaderViewer.prototype.getValueCloneDOM = function(renderer){\r\n\tvar callback = function(){renderer.clone()};\r\n\tvar disabled = (renderer.cardControlAllows(\"clone\") ? false : \"Cardinality Rules Forbid Clone\");\r\n\treturn HTMLFrameHelper.getActionControl(\"value\", \"clone\", \"Clone\", callback, disabled);\r\n}\r\n\r\nHTMLDataHeaderViewer.prototype.getValueUpdateDOM = function(renderer){\r\n\tvar dpropDOM = document.createElement(\"span\");\r\n\tdpropDOM.setAttribute(\"class\", \"terminus-value-update\");\r\n\tvar saveback = function(){renderer.save()};\r\n\tvar disabled = (renderer.isUpdated() ? false : \"Nothing to save - no change\");\r\n\tdpropDOM.appendChild(HTMLFrameHelper.getActionControl(\"value\", \"save\", \"Save\", saveback, disabled));\r\n\treturn dpropDOM;\r\n}\r\n\r\nHTMLDataHeaderViewer.prototype.getViewerSelectorDOM = function(renderer){\r\n\tvar viewers = renderer.getAvailableViewers();\r\n\tif(viewers && viewers.length){\r\n\t\tvar mpropDOM = document.createElement(\"span\");\r\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-value-viewer\");\r\n\t\tvar callback = function(viewer){\r\n\t\t\tif(viewer){\r\n\t\t\t\trenderer.setViewer(viewer);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar selected = renderer.currentViewer();\r\n\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"data-viewer\", viewers, selected, callback);\r\n\t\tmpropDOM.appendChild(sel);\r\n\t\treturn mpropDOM;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nfunction JSONObjectViewer(renderer){\r\n\tthis.renderer = renderer;\r\n\tthis.properties = [];\r\n}\r\n\r\n/**\r\n * Functions for rendering / re-rendering the object as header and body components\r\n */\r\nJSONObjectViewer.prototype.render = function(){\r\n\talert(\"render json tbd\");\r\n}\r\nJSONObjectViewer.prototype.redraw = function(){\r\n\talert('redraw json tbd');\r\n}\r\n\r\nmodule.exports={HTMLDataViewer,HTMLDataHeaderViewer,JSONObjectViewer}\r\n","const WOQLQuery = require('../query/WOQLQuery');\r\nconst TerminusClassChooser = require('./TerminusClassChooser');\r\n/*\r\n * Utility class which allows the user to choose a document by id or by label (if select2 and full text indexing is turned on)\r\n */\r\n\r\nTerminusDocumentChooser = function(ui, root, value, view){\r\n\tthis.ui = ui;\r\n\tthis.root = root;\r\n\tthis.choice = value;\r\n\tthis.view = (view ? view : \"id\");\r\n\tthis.show_button = true;\r\n}\r\n\r\nTerminusDocumentChooser.prototype.setRoot = function(root){\r\n\tthis.root = root;\r\n}\r\n\r\nTerminusDocumentChooser.prototype.setFilter = function(filter){\r\n\tthis.filter = filter;\r\n}\r\n\r\nTerminusDocumentChooser.prototype.change = function(docid){\r\n\talert(\"Need to specify doc chooser function (\" + docid + \")\");\r\n}\r\n\r\nTerminusDocumentChooser.prototype.getAsDOM = function(style){\r\n\tif(this.view == \"label\" && \tthis.ui.client.connectionConfig.platformEndpoint() && this.ui.pluginAvailable(\"select2\")){\r\n\t\treturn this.getS2DOM(style);\r\n\t}\r\n\treturn this.getIDDOM();\r\n}\r\n\r\nTerminusDocumentChooser.prototype.getS2DOM = function(style){\r\n\tvar docchooser = document.createElement(\"span\");\r\n\tdocchooser.setAttribute(\"class\", \"terminus-document-chooser terminus-doc-holder\");\r\n\tvar wq = new WOQLQuery(this.ui.client, {}, this.ui);\r\n\tvar cfilter = wq.getSubclassQueryPattern(\"v:Class\", \"'\"+this.root+\"'\");\r\n\tvar termcc = new TerminusClassChooser(this.ui, cfilter);\r\n\ttermcc.empty_choice = \"Filter by Type\";\r\n\ttermcc.show_single = false;\r\n\tvar self = this;\r\n\ttermcc.change = function(new_class){\r\n\t\tif(new_class){\r\n\t\t\tself.filter = new_class;\r\n\t\t}\r\n\t}\r\n\ttdom = termcc.getAsDOM(style);\r\n\tif(tdom) docchooser.appendChild(tdom);\r\n\tvar holder = document.createElement(\"span\");\r\n\tholder.setAttribute(\"class\", \"terminus-entity-reference-value\");\r\n\tvar sel = document.createElement(\"select\");\r\n\tsel.setAttribute(\"class\", \"terminus-entity-class-input\");\r\n\tholder.appendChild(sel);\r\n\tvar opt = document.createElement(\"option\");\r\n\tvar lookup = function (params) {\r\n\t\tparams.class = self.filter;\r\n\t\treturn JSON.stringify(params);\r\n    }\r\n\tvar searchurl = this.ui.client.dbURL() + \"/search\";\r\n\tvar s2config = {\r\n\t\tajax: {\r\n\t\t    url: searchurl,\r\n\t\t    dataType: 'json',\r\n\t\t    data: lookup,\r\n\t\t    type: \"POST\",\r\n\t\t\tcontentType: \"application/json; charset=utf-8\",\r\n\t\t    delay: 250,\r\n\t\t    cache: true\r\n\t\t},\r\n\t\tplaceholder: \"Enter Document Name\",\r\n\t\twidth: 200\r\n\t};\r\n\tjQuery(sel).select2(s2config).change(function(){\r\n\t\tcallback(this.value);\r\n\t});\r\n\tdocchooser.appendChild(holder);\r\n\treturn docchooser;\r\n}\r\n\r\nTerminusDocumentChooser.prototype.getIDDOM = function(){\r\n\tvar docchooser = document.createElement(\"span\");\r\n\tdocchooser.setAttribute(\"class\", \"terminus-document-chooser terminus-doc-holder\");\r\n\tvar dcip = document.createElement(\"input\");\r\n\tdcip.setAttribute(\"class\", \"terminus-document-chooser terminus-query-text\");\r\n\t//11092019 dcip.setAttribute(\"class\", \"terminus-form-value terminus-document-chooser\");\r\n\tdcip.setAttribute(\"placeholder\", \"Enter Document ID\");\r\n\tdcip.addEventListener('keypress', function(e){\r\n\t\tvar key = e.which || e.keyCode;\r\n\t\t// on enter\r\n\t\tif (key === 13 && dcip.value) {\r\n\t\t\tself.choice = dcip.value;\r\n\t\t\tself.change(dcip.value);\r\n\t\t}\r\n\t});\r\n\tdocchooser.appendChild(dcip);\r\n\tif(this.show_button){\r\n\t\tvar dbut = document.createElement(\"button\");\r\n\t\tdbut.setAttribute(\"class\", \"terminus-control-button terminus-btn\");\r\n\t\tvar self = this;\r\n\t\tdbut.addEventListener(\"click\", function(){\r\n\t\t\tif(dcip.value) {\r\n\t\t\t\tself.choice = dcip.value;\r\n\t\t\t\tself.change(dcip.value);\r\n\t\t\t}\r\n\t\t});\r\n\t\t//11092019 dbut.appendChild(document.createTextNode(\"View Document Properties\"));\r\n\t\tdbut.appendChild(document.createTextNode(\"Go\"));\r\n\t\tdocchooser.appendChild(dbut);\r\n\t}\r\n\treturn docchooser;\r\n}\r\n\r\nTerminusDocumentChooser.prototype.toggleView = function(){\r\n\tif(this.view == \"id\") this.view = \"label\";\r\n\telse this.view = \"id\";\r\n}\r\n\r\nTerminusDocumentChooser.prototype.getChangeViewText = function(){\r\n\tif(this.view == \"id\"){\r\n\t\treturn \"Document Lookup\";\r\n\t}\r\n\treturn \"Load Document ID\";\r\n}\r\n\r\nmodule.exports=TerminusDocumentChooser\r\n","const TerminusUI = require('./TerminusUI');\r\nconst RenderingMap = require('./client/RenderingMap');\r\n\r\nvar terminator = new TerminusUI(TerminusConfig);\r\nvar pconfig = {};\r\npconfig.buttons = {'client'   : document.getElementById(\"terminus-client-btn\"),\r\n\t\t\t\t   'explorer' : document.getElementById(\"terminus-explorer-btn\")}\r\npconfig.controller \t= document.getElementById(\"terminus-control-panel\");\r\npconfig.messages = document.getElementById(\"terminus-user-messages\");\r\npconfig.plugins = document.getElementById(\"terminus-plugin-loader\");\r\npconfig.explorer = document.getElementById(\"terminus-explorer\");\r\npconfig.viewer = document.getElementById(\"terminus-content-viewer\");\r\nvar nlocation = (TerminusConfig && TerminusConfig.location) ? TerminusConfig.location : false;\r\nterminator.draw(pconfig, nlocation);\r\n\r\nfunction showPanel(mode){\r\n\ttoggleHeaders(mode, document.getElementById(\"terminus-content-viewer\"));\r\n}\r\n\r\nmodule.exports={TerminusUI:TerminusUI,\r\n                RenderingMap:RenderingMap}\r\n","/**\r\n * Terminus UI object\r\n *\r\n * Traffic control of messages going between different Terminus UI pages and features\r\n *\r\n * @param opts - options array\r\n */\r\nconst ApiExplorer = require('./ApiExplorer');\r\nconst TerminusDocumentViewer = require('./client/TerminusDocument');\r\nconst TerminusDBsdk = require('./client/TerminusDB');\r\nconst TerminusViolations = require('./client/TerminusViolation');\r\nconst TerminusQueryViewer = require('./client/TerminusQuery');\r\nconst TerminusMappingViewer = require('./client/TerminusMapping');\r\nconst TerminusSchemaViewer = require('./client/TerminusSchema');\r\nconst TerminusServersdk = require('./client/TerminusServer');\r\nconst TerminusURLLoader = require('./client/TerminusURL');\r\nconst TerminusPluginManager = require('./plugins/TerminusPlugin');\r\nconst UTILS=require('./Utils');\r\nconst RenderingMap = require('./client/RenderingMap');\r\n\r\nfunction TerminusUI(opts){\r\n\tthis.client = new TerminusClient.WOQLClient();\r\n\tthis.controls = [];\r\n\tthis.setOptions(opts);\r\n}\r\n\r\n/*\r\n * Client connects to specified server and specified part\r\n * opts is a json with the following fields:\r\n * server: mandatory URL of the server to connect to\r\n * key: optional client API key\r\n * dbid: id of the database to connect to\r\n * schema: if set, the UI will load the schema page after connecting\r\n * query: if set, the query will be sent to the server and the results will be loaded on the query page\r\n * document: if set, the document page corresponding to this document will be loaded after connecting\r\n *\r\n * (note: schema, query, document are mutually exclusive and must also have a dbid set)\r\n */\r\nTerminusUI.prototype.connect = function(opts){\r\n\tvar self = this;\r\n\tthis.client.connectionConfig.server = false;\r\n\tvar key = ((opts && opts.key) ? opts.key : false);\r\n\tthis.showBusy(\"Connecting to server at \" + opts.server);\r\n\treturn this.client.connect(opts.server, key)\r\n\t.then( function(response) {\r\n\t\tself.clearBusy();\r\n\t\tif(opts && opts.db && self.getDBRecord(opts.db)){\r\n\t\t\tself.connectToDB(opts.db);\r\n\t\t\tif(opts.document && self.showView(\"get_document\")){\r\n\t\t\t\tresponse = self.showDocument(opts.document);\r\n\t\t\t}\r\n\t\t\telse if(opts.schema && self.showView(\"get_schema\")){\r\n\t\t\t\tresponse = self.showSchemaPage(opts.schema);\r\n\t\t\t}\r\n\t\t\telse if(opts.query && self.showView(\"woql_select\")){\r\n\t\t\t\tself.showQueryPage(opts.query);\r\n\t\t\t}\r\n\t\t\telse if(opts.explorer && self.showView(\"api_explorer\")){\r\n\t\t\t\tself.showExplorer(opts.explorer);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tself.showDBMainPage();\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tself.showServerMainPage();\r\n\t\t}\r\n\t\tself.redraw();\r\n\t\treturn response;\r\n\t})\r\n\t.catch(function(err) {\r\n\t\tself.clearBusy();\r\n\t\tself.showError(err);\r\n\t\tthrow(err);\r\n\t});\r\n}\r\n\r\n/**\r\n * Sends a request to create a new database to the server and interprets the response\r\n *\r\n * dbdets is a json object with the following fields:\r\n * id: the id of the new database (alphanumeric, no spaces, url friendly) mandatory\r\n * title: the text name of the new database for tables, etc. mandatory\r\n * description: text description of the database (optional)\r\n * key: a API client key for server auth\r\n * schema: the url of another Terminus DB from which to import schema\r\n * instance: the url of another Terminus DB from which to import data\r\n *\r\n */\r\nTerminusUI.prototype.createDatabase = function(dbdets){\r\n\tvar self = this;\r\n\tif(!dbdets.id || !dbdets.title){\r\n        return Promise.reject(new Error(self.getBadArguments(\"createDatabase\", \"ID and title are mandatory fields\")));\r\n\t}\r\n\tvar dbid = dbdets.id;\r\n\tvar myserver = this.client.connectionConfig.server;\r\n\tself.showBusy(\"Creating Database \" + dbdets.title + \" with id \" + dbid);\r\n\tvar dbdoc = this.generateNewDatabaseDocument(dbdets);\r\n\treturn this.client.createDatabase(dbid, dbdoc)\r\n\t.then(function(response){ //import schema into newly created DB\r\n\t\tif(dbdets.schema){\r\n\t\t\tself.showBusy(\"Fetching imported schema from \" + dbdets.schema);\r\n\t\t\tvar opts = (dbdets.key ?  {\"terminus:user_key\": dbdets.key } : {});\r\n\t\t\topts['terminus:encoding'] = \"terminus:turtle\";\r\n\t\t\treturn self.client.getSchema(dbdets.schema, opts)\r\n\t\t\t.then(function(response){\r\n\t\t\t\tself.showBusy(\"Updating database with new schema\");\r\n\t\t\t\tself.client.connectionConfig.server = myserver;\r\n\t\t\t\tself.client.connectionConfig.dbid = dbid;\r\n\t\t\t\tvar nopts = {'terminus:encoding':  \"terminus:turtle\"};\r\n\t\t\t\treturn self.client.updateSchema(false, response, nopts);\r\n\t\t\t})\r\n\t\t\t.then(function(response){\r\n\t\t\t\tself.clearBusy();\r\n\t\t\t\tself.redraw();\r\n\t\t\t\treturn response;\r\n\t\t\t});\r\n\t\t}\r\n\t\telse {\r\n\t\t\tself.clearBusy();\r\n\t\t}\r\n\t\treturn response;\r\n\t})\r\n\t.then(function(response){ //reload list of databases in background..\r\n\t\treturn self.refreshDBList()\r\n\t\t.then(function(response){\r\n\t\t\tif(crec = self.client.connection.getDBRecord(dbid)){\r\n\t\t\t\tself.client.connectionConfig.dbid = dbid;\r\n\t\t\t\tself.showDBMainPage();\r\n\t\t\t\tself.showMessage(\"Successfully Created Database \" + dbid, \"success\");\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t        return Promise.reject(new Error(self.getCrashString(\"createDatabase\", \"Failed to retrieve record of created database \" + dbid)));\r\n\t\t\t}\r\n\t\t})\r\n\t})\r\n\t.catch(function(error){\r\n\t\tself.clearBusy();\r\n\t\tself.showError(error);\r\n\t});\r\n}\r\n\r\n/**\r\n * Deletes the database with the passed id from the currently connected server\r\n */\r\nTerminusUI.prototype.deleteDatabase = function(dbid){\r\n\tvar self = this;\r\n\tvar delrec = this.client.connection.getDBRecord();\r\n\tvar lid = (dbid ? dbid : this.db());\r\n\tvar dbn = (delrec && delrec['rdfs:label'] && delrec['rdfs:label'][\"@value\"] ? delrec['rdfs:label'][\"@value\"] + \" (id: \" + lid + \")\" : lid);\r\n\tthis.showBusy(\"Deleting database \" + dbn);\r\n\treturn this.client.deleteDatabase(dbid)\r\n\t.then(function(response){\r\n\t\tself.clearBusy();\r\n\t\tself.client.connectionConfig.dbid = false;\r\n\t\tself.removeDB(dbid);\r\n\t\tself.showServerMainPage();\r\n\t\tself.showMessage(\"Successfully Deleted Database \" + dbn, \"success\");\r\n\t\tself.refreshDBList();\r\n\t\treturn response;\r\n\t})\r\n\t.catch(function(error){\r\n\t\tself.clearBusy();\r\n\t\tself.showError(error);\r\n\t});\r\n}\r\n\r\n/*\r\n * Transforms a details (id, title, description) array into  json-ld document\r\n */\r\nTerminusUI.prototype.generateNewDatabaseDocument = function(dets){\r\n\tvar doc = {\r\n\t\t\"@context\" : {\r\n\t\t\trdfs: \"http://www.w3.org/2000/01/rdf-schema#\",\r\n\t\t\tterminus: \"http://terminusdb.com/schema/terminus#\"\r\n\t\t},\r\n\t\t\"@type\": \"terminus:Database\"\r\n\t}\r\n\tif(dets.title){\r\n\t\tdoc['rdfs:label'] = {\r\n\t\t\t\"@language\":  \"en\",\r\n\t\t\t\"@value\": dets.title\r\n\t\t};\r\n\t}\r\n\tif(dets.description){\r\n\t\tdoc['rdfs:comment'] = {\r\n\t\t\t\"@language\":  \"en\",\r\n\t\t\t\"@value\": dets.description\r\n\t\t};\r\n\t}\r\n\tdoc['terminus:allow_origin'] = { \"@type\" : \"xsd:string\", \"@value\" : \"*\" };\r\n\treturn doc;\r\n}\r\n\r\nTerminusUI.prototype.getBadArguments = function(fname, str){\r\n\treturn \"Bad arguments to \" + fname + \": \" + str;\r\n}\r\n\r\nTerminusUI.prototype.getCrashString = function(fname, str){\r\n\treturn \"Results from \" + fname + \" indicate the possibility of a system failure \" + str;\r\n}\r\n\r\n/*\r\n * Parses the passed URL and turns it into a call to the connect function - loads the appropriate endpoing\r\n */\r\nTerminusUI.prototype.load = function(url, key){\r\n\tvar args = {};\r\n\tif(url && url.indexOf(\"/document/\") != -1){\r\n\t\turl = url.substring(0, url.indexOf(\"/document/\"));\r\n\t\targs.document = url.substring(url.indexOf(\"/document/\")+10);\r\n\t}\r\n\telse if(url && url.indexOf(\"/schema\") != -1){\r\n\t\turl = url.substring(0, url.indexOf(\"/schema\"));\r\n\t\targs.schema = {};\r\n\t}\r\n\telse if(url && url.indexOf(\"/woql\") != -1){\r\n\t\turl = url.substring(0, url.indexOf(\"/query\"));\r\n\t\targs.query = url.substring(url.indexOf(\"/query\")+7);\r\n\t}\r\n\targs.server = url;\r\n\tif(key) args.key = key;\r\n\treturn this.connect(args);\r\n}\r\n\r\n/**\r\n * Fetches the DB URL from the url by chopping off the extra bits\r\n */\r\nTerminusUI.prototype.getConnectionEndpoint = function(url){\r\n\tif(url && url.lastIndexOf(\"/schema\") != -1){\r\n\t\treturn url.substring(0, url.lastIndexOf(\"/schema\"));\r\n\t}\r\n\tif(url && url.lastIndexOf(\"/document\") != -1){\r\n\t\treturn url.substring(0, url.lastIndexOf(\"/document\"));\r\n\t}\r\n\tif(url && url.lastIndexOf(\"/frame\") != -1){\r\n\t\treturn url.substring(0, url.lastIndexOf(\"/frame\"));\r\n\t}\r\n\tif(url && url.lastIndexOf(\"/woql\") != -1){\r\n\t\treturn url.substring(0, url.lastIndexOf(\"/woql\"));\r\n\t}\r\n\treturn url;\r\n}\r\n\r\nTerminusUI.prototype.server = function(){\r\n\treturn this.client.connectionConfig.server;\r\n}\r\n\r\nTerminusUI.prototype.db = function(){\r\n\treturn this.client.connectionConfig.dbid;\r\n}\r\n\r\nTerminusUI.prototype.clearServer = function(){\r\n\tthis.client.connectionConfig.server = false;\r\n}\r\n\r\nTerminusUI.prototype.connectToDB = function(dbid){\r\n\tthis.client.connectionConfig.dbid = dbid;\r\n\tTerminusClient.FrameHelper.standard_urls['doc'] = this.client.connectionConfig.dbURL() + \"/document/\";\r\n\tTerminusClient.FrameHelper.standard_urls['scm'] = this.client.connectionConfig.dbURL() + \"/schema#\";\r\n}\r\n\r\nTerminusUI.prototype.clearDB = function(){\r\n\tthis.client.connectionConfig.dbid = false;\r\n}\r\n\r\nTerminusUI.prototype.removeDB = function(db, url){\r\n\tthis.client.connection.removeDB(db, url);\r\n}\r\n\r\nTerminusUI.prototype.getDBRecord = function(db, url){\r\n\treturn this.client.connection.getDBRecord(db, url);\r\n}\r\n\r\nTerminusUI.prototype.refreshDBList = function(){\r\n\tvar self = this;\r\n\treturn this.client.connect();\r\n}\r\n\r\nTerminusUI.prototype.showServerMainPage = function(){\r\n\tthis.viewer = new TerminusServersdk.TerminusServerViewer(this);\r\n\tthis.redrawMainPage();\r\n}\r\n\r\nTerminusUI.prototype.showLoadURLPage = function(val){\r\n\tthis.viewer = new TerminusURLLoader(this, val);\r\n\tthis.redrawMainPage();\r\n}\r\n\r\nTerminusUI.prototype.showDBMainPage = function(){\r\n\tthis.viewer = new TerminusDBsdk.TerminusDBViewer(this);\r\n\tthis.redraw();\r\n}\r\n\r\nTerminusUI.prototype.showCreateDBPage = function(){\r\n\tthis.viewer = new TerminusDBsdk.TerminusDBCreator(this);\r\n\tthis.redrawMainPage();\r\n}\r\n\r\nTerminusUI.prototype.showSchemaPage = function(durl){\r\n\tthis.viewer = new TerminusSchemaViewer(this);\r\n\tthis.redrawMainPage();\r\n}\r\n\r\nTerminusUI.prototype.showQueryPage = function(query){\r\n\tthis.viewer = new TerminusQueryViewer(this, query, this.options);\r\n\tthis.redrawMainPage();\r\n}\r\n\r\nTerminusUI.prototype.showMappingPage = function(mapping){\r\n\tthis.viewer = new TerminusMappingViewer(this, mapping, this.options);\r\n\tthis.redrawMainPage();\r\n}\r\n\r\nTerminusUI.prototype.showDocument = function(durl){\r\n\tthis.viewer = new TerminusDocumentViewer(this, \"view\", this.getDocViewerOptions());\r\n\tconst promise = this.viewer.loadDocument(durl);\r\n\tthis.redrawMainPage();\r\n\treturn promise;\r\n}\r\n\r\nTerminusUI.prototype.showCreateDocument = function(durl){\r\n\tthis.viewer = new TerminusDocumentViewer(this, \"create\", this.getDocCreatorOptions());\r\n\tconst promise = this.viewer.loadCreateDocument(durl);\r\n\tthis.redrawMainPage();\r\n\treturn promise;\r\n}\r\n\r\nTerminusUI.prototype.redrawMainPage = function(){\r\n\tTerminusClient.FrameHelper.removeChildren(this.main);\r\n\tif(this.viewer){\r\n\t\tthis.main.appendChild(this.viewer.getAsDOM());\r\n\t}\r\n}\r\n\r\nTerminusUI.prototype.showResult = function(response){\r\n\tthis.showMessage(response, \"success\");\r\n};\r\n\r\nTerminusUI.prototype.showError = function(response){\r\n\tthis.showMessage(response, \"error\");\r\n};\r\n\r\nTerminusUI.prototype.clearMessages = function(response){\r\n\tif(this.messages) TerminusClient.FrameHelper.removeChildren(this.messages);\r\n};\r\n\r\nTerminusUI.prototype.clearMainPage = function(){\r\n\tif(this.main) TerminusClient.FrameHelper.removeChildren(this.main);\r\n}\r\n\r\nTerminusUI.prototype.setMessageDOM = function(dom){\r\n\tthis.messages = dom;\r\n}\r\n\r\nTerminusUI.prototype.setbuttonControls = function(dom){\r\n\tthis.buttons = dom;\r\n}\r\n\r\nTerminusUI.prototype.setControllerDOM = function(dom){\r\n\tthis.controller = dom;\r\n}\r\n\r\nTerminusUI.prototype.setExplorerDOM = function(dom){\r\n\tthis.explorer = dom;\r\n}\r\n\r\nTerminusUI.prototype.setPluginsDOM = function(dom){\r\n\tthis.plugins = dom;\r\n}\r\n\r\nTerminusUI.prototype.setViewerDOM = function(dom){\r\n\tthis.main = dom;\r\n}\r\n\r\nTerminusUI.prototype.draw = function(comps, slocation){\r\n\tif(comps && comps.buttons) this.setbuttonControls(comps.buttons);\r\n\tif(comps && comps.messages) this.setMessageDOM(comps.messages);\r\n\tif(comps && comps.controller) this.setControllerDOM(comps.controller);\r\n\tif(comps && comps.explorer) this.setExplorerDOM(comps.explorer);\r\n\tif(comps && comps.viewer) this.setViewerDOM(comps.viewer);\r\n\tif(comps && comps.plugins) this.setPluginsDOM(comps.plugins);\r\n\tif(this.plugins){\r\n\t\tthis.drawPlugins();\r\n\t}\r\n\tif(this.buttons){\r\n\t\tthis.toggleControl();\r\n\t}\r\n\tvar self = this;\r\n\tvar cdrawn = false;\r\n\tif(slocation && slocation.server){\r\n\t\tif(typeof this.client.connection.connection[slocation.server] == \"undefined\") {\r\n\t\t\treturn this.connect(slocation)\r\n\t\t\t.catch(function(error){\r\n\t\t\t\tself.showLoadURLPage();\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tthis.showLoadURLPage();\r\n\t};\r\n}\r\n\r\n\r\n\r\nTerminusUI.prototype.redraw = function(msg){\r\n\tthis.clearMessages();\r\n\tif(this.controller){\r\n\t\tTerminusClient.FrameHelper.removeChildren(this.controller);\r\n\t\tthis.drawControls();\r\n\t}\r\n\tif(this.explorer){\r\n\t\tTerminusClient.FrameHelper.removeChildren(this.explorer);\r\n\t\t//this.drawExplorer();\r\n\t}\r\n\tif(this.viewer){\r\n\t\tthis.redrawMainPage();\r\n\t}\r\n\tif(msg) this.showMessage(msg);\r\n};\r\n\r\n\r\nTerminusUI.prototype.toggleDashboardWidget = function(widget){\r\n    TerminusClient.FrameHelper.removeChildren(this.controller);\r\n    TerminusClient.FrameHelper.removeChildren(this.explorer);\r\n    UTILS.removeSelectedNavClass('terminus-dashboard-selected');\r\n    widget.classList.add('terminus-dashboard-selected');\r\n}\r\n\r\nTerminusUI.prototype.toggleControl = function(){\r\n  var self = this;\r\n  this.buttons.client.addEventListener('click', function(){\r\n    self.toggleDashboardWidget(this);\r\n    self.drawControls();\r\n    self.showServerMainPage();\r\n  })\r\n  this.buttons.explorer.addEventListener('click', function(){\r\n    self.toggleDashboardWidget(this);\r\n    self.drawExplorer();\r\n  })\r\n}\r\n\r\nTerminusUI.prototype.drawControls = function(){\r\n\tthis.controls = [];\r\n\tthis.loadControls();\r\n\tfor(var i = 0; i<this.controls.length; i++){\r\n\t\tvar ncontrol = this.controls[i];\r\n\t\tif(ncontrol && (nd = ncontrol.getAsDOM())){\r\n\t\t\tthis.controller.appendChild(nd);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nTerminusUI.prototype.drawExplorer = function(){\r\n\tif(this.explorer){\r\n\t\tif(this.showControl(\"api_explorer\")){\r\n\t\t\tvar exp = new ApiExplorer(this);\r\n\t\t\tae = exp.getAsDOM();\r\n\t\t\tthis.explorer.appendChild(ae);\r\n\t\t\tthis.explorer.style.display = 'block';\r\n\t\t}\r\n\t}\r\n}\r\n\r\nTerminusUI.prototype.loadControls = function(){\r\n\tif(this.showControl('server')){\r\n\t\tvar sc = new TerminusServersdk.TerminusServerController(this);\r\n\t\tif(sc) {\r\n\t\t\tthis.controls.push(sc);\r\n\t\t}\r\n\t\tif(this.db() && this.showControl(\"db\")){\r\n\t\t\tvar sc = new TerminusDBsdk.TerminusDBController(this);\r\n\t\t\tif(sc) this.controls.push(sc);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nTerminusUI.prototype.showControl = function(el){\r\n\tif(this.show_controls.indexOf(el) == -1) return false;\r\n\tif(this.pseudoCapability(el)) return true;\r\n\tif(this.client.connection.capabilitiesPermit(el)) {\r\n\t\treturn true;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nTerminusUI.prototype.showView = function(el){\r\n\tif(this.show_views.indexOf(el) == -1) return false;\r\n\tif(this.pseudoCapability(el)) return true;\r\n\tif(this.client.connection.capabilitiesPermit(el)) {\r\n\t\treturn true;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nTerminusUI.prototype.clearBusy = function(response){\r\n\tthis.clearMessages();\r\n\tif(this.viewer && typeof this.viewer.busy == \"function\") this.viewer.busy(false);\r\n}\r\n\r\nTerminusUI.prototype.getBusyLoader = function(bsyDom){\r\n     var pd = document.createElement('div');\r\n     var pbc = document.createElement('div');\r\n     pbc.setAttribute('class', 'term-progress-bar-container');\r\n     pd.appendChild(pbc);\r\n\r\n     var pbsa = document.createElement('div');\r\n     pbsa.setAttribute('class', 'term-progress-bar term-stripes animated reverse slower');\r\n     pbc.appendChild(pbsa);\r\n     var pbia = document.createElement('span');\r\n     pbia.setAttribute('class', 'term-progress-bar-inner');\r\n     pbsa.appendChild(pbia);\r\n\r\n     bsyDom.appendChild(pd);\r\n}\r\n\r\nTerminusUI.prototype.showMessage = function(msg, type){\r\n\tif(this.messages){\r\n\t\tTerminusClient.FrameHelper.removeChildren(this.messages);\r\n\t\tvar md = document.createElement('div');\r\n        switch(type){\r\n            case 'busy':\r\n                var msgHolder = document.createElement('div');\r\n                msgHolder.setAttribute('class', 'terminus-busy-msg')\r\n                msgHolder.appendChild(document.createTextNode(msg));\r\n                md.appendChild(msgHolder);\r\n                this.getBusyLoader(md);\r\n            break;\r\n            case 'success':\r\n                md.setAttribute('class', 'terminus-show-msg-success');\r\n                md.appendChild(document.createTextNode(msg));\r\n            break;\r\n            case 'error':\r\n                md.setAttribute('class', 'terminus-show-msg-error');\r\n                md.appendChild(document.createTextNode(msg));\r\n            break;\r\n        }\r\n\t\tthis.messages.appendChild(md);\r\n\t}\r\n};\r\n\r\nTerminusUI.prototype.showViolations = function(vios, type){\r\n\tvar nvios = new TerminusViolations(vios, this);\r\n\tif(this.messages){\r\n\t\tvar cmsg = (type == \"schema\" ? \" in Schema\" : \" in Document\");\r\n\t\tTerminusClient.FrameHelper.removeChildren(this.messages);\r\n\t\tthis.messages.appendChild(nvios.getAsDOM(cmsg));\r\n\t}\r\n}\r\n\r\nTerminusUI.prototype.showBusy = function(msg){\r\n\tthis.showMessage(msg, \"busy\");\r\n\tif(this.viewer && typeof this.viewer.busy == \"function\") this.viewer.busy(msg);\r\n};\r\n\r\nTerminusUI.prototype.pseudoCapability = function(el){\r\n\tvar pseuds = [\"server\", \"db\", \"change-server\", \"api_explorer\", \"import_schema\", \"schema_format\"];\r\n\tif(pseuds.indexOf(el) == -1) return false;\r\n\treturn true;\r\n}\r\n\r\nTerminusUI.prototype.setOptions = function(opts){\r\n\tthis.show_controls = opts && opts.controls ? opts.controls :\r\n\t\t[\"server\", \"db\", \"change-server\", \"schema_format\",\r\n\t\t\t\"import_schema\", \"class_frame\", \"create_database\",\r\n\t\t\t\"create_document\", \"get_document\", \"update_schema\",\r\n\t\t\t\"get_schema\", \"woql_select\"\r\n\t\t];\r\n\tthis.show_views = opts && opts.views ? opts.views : this.show_controls;\r\n\tif(opts.document){\r\n\t\tthis.document_options = opts.document;\r\n\t}\r\n\tif(opts.schema){\r\n\t\tthis.schema_options = opts.schema;\r\n\t}\r\n\tthis.piman = new TerminusPluginManager();\r\n\tvar self = this;\r\n\tthis.piman.init(opts.plugins, function(){\r\n\t\tvar pins = [\"gmaps\", \"quill\", \"select2\"];\r\n\t\tfor(var i = 0; i<pins.length; i++){\r\n\t\t\tif(self.piman.pluginAvailable(pins[i])){\r\n\t\t\t\tRenderingMap.addPlugin(pins[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t\tself.redraw();\r\n\t});\r\n\tif(opts.css && this.piman){\r\n\t\tthis.piman.loadPageCSS(opts.css);\r\n\t}\r\n\tthis.loadControls();\r\n}\r\n\r\nTerminusUI.prototype.pluginAvailable = function(p){\r\n\treturn this.piman.pluginAvailable(p);\r\n}\r\n\r\nTerminusUI.prototype.drawPlugins = function(){\r\n\tif(!this.piman) {\r\n\t\tconsole.log(new Error(\"No plugin manager initialised in UI object\"));\r\n\t\treturn false;\r\n\t}\r\n\tthis.plugins.appendChild(this.piman.getAsDOM(this));\r\n}\r\n\r\nTerminusUI.prototype.getDocViewerOptions = function(){\r\n\tif(this.document_options && this.document_options['view']){\r\n\t\treturn this.document_options['view'];\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nTerminusUI.prototype.getDocCreatorOptions = function(){\r\n\tif(this.document_options && this.document_options['view']){\r\n\t\treturn this.document_options['view'];\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nTerminusUI.prototype.getClassFrameOptions = function(){\r\n\treturn this.viewdoc_options;\r\n}\r\n\r\nmodule.exports=TerminusUI\r\n","/**\r\n * @file Javascript Api explorer tool\r\n * @author Kitty Jose\r\n * @license Copyright 2018-2019 Data Chemist Limited, All Rights Reserved. See LICENSE file for more\r\n *\r\n * @summary Displays a demo and description of api calls from WOQLCLient and what happens under the hood of api calls\r\n */\r\nconst TerminusPluginManager = require('./plugins/TerminusPlugin');\r\nconst UTILS = require('./Utils')\r\n\r\nlet apiNavConfig = {\r\n    mainNav: {\r\n        connect: {\r\n    \t\tnavText: 'Connect API',\r\n            action : 'connect',\r\n            icon   : 'link',\r\n            defaultSelected: true\r\n    \t},\r\n        database: {\r\n            navText: 'Database API',\r\n            action : 'create',\r\n            icon   : 'database'\r\n        },\r\n        schema: {\r\n            navText: 'Schema API',\r\n            action : 'schema',\r\n            icon   : 'cog'\r\n        },\r\n        document: {\r\n            navText: 'Document API',\r\n            action : 'document',\r\n            icon   : 'file'\r\n        },\r\n        query: {\r\n            navText: 'Query API',\r\n            action : 'query',\r\n            icon   : 'search'\r\n        }\r\n    },\r\n    subNav: {\r\n        database: {\r\n            createDatabase: {\r\n                navText: 'Create database',\r\n                action : 'create',\r\n                icon   : 'plus',\r\n                defaultSelected: true\r\n            },\r\n            deleteDatabase: {\r\n                navText: 'Delete database',\r\n                action : 'delete',\r\n                icon   : 'trash-alt'\r\n            }\r\n        },\r\n        schema: {\r\n            getSchema: {\r\n                navText: 'View Schema',\r\n                action : 'getSchema',\r\n                icon   : 'eye',\r\n                defaultSelected: true\r\n            },\r\n            updateSchema: {\r\n                navText: 'Update Schema',\r\n                action : 'updateSchema',\r\n                icon   : 'arrow-up'\r\n            },\r\n            getClassFrames: {\r\n                navText: 'Get Class Frames',\r\n                action : 'getClassFrames',\r\n                icon   : 'share-alt'\r\n            }\r\n        },\r\n        document: {\r\n            viewDocument: {\r\n        \t\tnavText: 'View Document',\r\n                action : 'viewDocument',\r\n                icon   : 'eye',\r\n                defaultSelected: true\r\n        \t},\r\n            createDocument: {\r\n                navText: 'Create Document',\r\n                action : 'createDocument',\r\n                icon   : 'plus'\r\n            },\r\n            updateDocument: {\r\n                navText: 'Update Document',\r\n                action : 'updateDocument',\r\n                icon   : 'arrow-up'\r\n            },\r\n            deleteDocument:{\r\n                navText: 'Delete Document',\r\n                action : 'deleteDocument',\r\n                icon   : 'trash-alt'\r\n            }\r\n        },\r\n        query: {\r\n            select: {\r\n                navText: 'Select',\r\n                action : 'select',\r\n                icon   : 'mouse-pointer',\r\n                defaultSelected: true\r\n            },\r\n            update: {\r\n                navText: 'Update',\r\n                action : 'update',\r\n                icon   : 'arrow-up'\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nfunction ApiExplorer(ui){\r\n    this.ui = ui;\r\n    this.viewer = ui.main;\r\n    this.client = new TerminusClient.WOQLClient();\r\n    this.client.use_fetch = true;\r\n    this.client.return_full_response = true;\r\n    this.pman = new TerminusPluginManager();\r\n}\r\n\r\n// Controller provides access to Api explorer functions\r\nApiExplorer.prototype.getAsDOM = function(){\r\n \tvar aec = document.createElement(\"div\");\r\n    aec.setAttribute(\"class\", \"terminus-db-controller\");\r\n    if(this.ui){\r\n       this.getApiNav(aec, this.viewer); // nav\r\n       this.getApiExplorerDom('connect', this.viewer); // content dom\r\n    } // if this.ui\r\n    return aec;\r\n }\r\n\r\n/***** Api Nav bar *****/\r\n// Toggle selected nav bars\r\nApiExplorer.prototype.setSelectedNavMenu = function(a){\r\n    UTILS.removeSelectedNavClass(\"terminus-selected\");\r\n    a.classList.add(\"terminus-selected\");\r\n}\r\n\r\nApiExplorer.prototype.setSelectedSubMenu = function(a){\r\n    UTILS.removeSelectedNavClass(\"terminus-submenu-selected\");\r\n    a.classList.add(\"terminus-submenu-selected\");\r\n}\r\n\r\nApiExplorer.prototype.navOnSelect = function(action, nav, viewer){\r\n    UTILS.removeSelectedNavClass(\"terminus-selected\");\r\n    nav.classList.add(\"terminus-selected\");\r\n    this.getApiExplorerDom(action, viewer);\r\n}\r\n\r\n// create nav bars\r\nApiExplorer.prototype.createNavs = function(navConfig, viewer, ul){\r\n    var a = document.createElement('a');\r\n    a.setAttribute('class', 'terminus-a terminus-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\r\n    if(navConfig.defaultSelected) a.classList.add('terminus-selected');\r\n    var self = this;\r\n    a.addEventListener(\"click\", function(){\r\n        self.navOnSelect(navConfig.action, this, viewer);\r\n    })\r\n    var icon = document.createElement('i');\r\n    icon.setAttribute('class', 'terminus-menu-icon fa fa-' + navConfig.icon);\r\n    a.appendChild(icon);\r\n    var txt = document.createTextNode(navConfig.navText);\r\n    a.appendChild(txt);\r\n    ul.appendChild(a);\r\n}\r\n\r\n// gets api nav bar\r\nApiExplorer.prototype.getApiNav = function(navDom, viewer){\r\n    // list view of apis\r\n    var nav = document.createElement('div');\r\n    navDom.appendChild(nav);\r\n    // connect to server api\r\n    var ul = document.createElement('ul');\r\n    ul.setAttribute('class', 'terminus-ul');\r\n    nav.appendChild(ul);\r\n    // loop over apiNavConfig\r\n    for (var key in apiNavConfig.mainNav){\r\n        if (apiNavConfig.mainNav.hasOwnProperty(key)) {\r\n            this.createNavs(apiNavConfig.mainNav[key], viewer, ul);\r\n        }\r\n    } // for apiNavConfig\r\n    return navDom;\r\n} // getApiNav()\r\n\r\n/***** Api sub navs  *****/\r\n// get schema api explorer - nav bar, alert msg, headers ...\r\nApiExplorer.prototype.getApiExplorerDom = function(view, viewer){\r\n    // clear of viewer\r\n    TerminusClient.FrameHelper.removeChildren(viewer);\r\n    // wrapper\r\n    var wrap = document.createElement('div');\r\n    //wrap.setAttribute('class', 'terminus-wrapper terminus-wrapper-height');\r\n    viewer.appendChild(wrap);\r\n    var cont = document.createElement('div');\r\n    cont.setAttribute('class', 'container-fluid');\r\n    wrap.appendChild(cont);\r\n    var row = document.createElement('div');\r\n    row.setAttribute('class', 'row-fluid');\r\n    cont.appendChild(row);\r\n    var body = document.createElement('div');\r\n    body.setAttribute('class', 'terminus-module-body');\r\n    row.appendChild(body);\r\n    var api = document.createElement('div');\r\n    api.setAttribute('class', 'terminus-module-body terminus-module-body-white-bg terminus-module-body-width');\r\n    body.appendChild(api);\r\n    // body\r\n    var cont = document.createElement('div');\r\n    var self = this;\r\n    switch(view){\r\n        case 'connect':\r\n            var apiCont = self.getConnectExplorer(cont);\r\n            api.appendChild(apiCont);\r\n        break;\r\n        case 'create':\r\n            var apiCont = self.getDatabaseExplorer(cont);\r\n            api.appendChild(apiCont);\r\n        break;\r\n        case 'schema':\r\n            var apiCont = self.getSchemaApi(cont);\r\n            api.appendChild(apiCont);\r\n        break;\r\n        case 'document':\r\n            var apiCont = self.getDocumentApi(cont);\r\n            api.appendChild(apiCont);\r\n        break;\r\n        case 'query':\r\n            var apiCont = self.getQueryApi(cont);\r\n            api.appendChild(apiCont);\r\n        break;\r\n    }// switch(api)\r\n    return wrap;\r\n} // getApiExplorerDom\r\n\r\n// on trigger of click event - change dom\r\nApiExplorer.prototype.changeSubApiDom = function(curSubMenu, action, cont, body){\r\n    TerminusClient.FrameHelper.removeChildren(body);\r\n    switch(curSubMenu){\r\n        case 'database':\r\n            var dom = this.getDatabaseDom(action, body);\r\n        break;\r\n        case 'schema':  // getShowApiDom() deals with schema and document\r\n             var dom = this.getShowApiDom(action, body);\r\n        break;\r\n        case 'document': // getShowApiDom() deals with schema and document\r\n             var dom = this.getShowApiDom(action, body);\r\n        break;\r\n        case 'query':\r\n            var dom = this.getQueryApiDom(action, body);\r\n        break;\r\n        default:\r\n            console.log('Invalid Api Config');\r\n        break;\r\n    }\r\n    cont.appendChild(dom);\r\n}\r\n\r\nApiExplorer.prototype.subNavOnSelect = function(curSubMenu, subMenuConfig, subNav, cont, body){\r\n    this.setSelectedSubMenu(subNav);\r\n    this.changeSubApiDom(curSubMenu, subMenuConfig.action, cont, body);\r\n}\r\n\r\n// create sub nav bars\r\nApiExplorer.prototype.createSubNavs = function(curSubMenu, subMenuConfig, cont, body, ul){\r\n    // comment getclassframes for api explorer time being\r\n    if(subMenuConfig.action == 'getClassFrames') return;\r\n    var a = document.createElement('a');\r\n    a.setAttribute('class', 'terminus-a terminus-hz-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\r\n    if(subMenuConfig.defaultSelected) a.classList.add('terminus-submenu-selected');\r\n    var self = this;\r\n    a.addEventListener(\"click\", function() {\r\n        self.subNavOnSelect(curSubMenu, subMenuConfig, this, cont, body);\r\n    })\r\n    var icon = document.createElement('i');\r\n    icon.setAttribute('class', 'terminus-menu-icon fa fa-' + subMenuConfig.icon);\r\n    a.appendChild(icon);\r\n    var txt = document.createTextNode(subMenuConfig.navText);\r\n    a.appendChild(txt);\r\n    ul.appendChild(a);\r\n}\r\n\r\n// get connect to server api calls - on click of connectAPI nav bar\r\nApiExplorer.prototype.getConnectExplorer = function(body){\r\n    var self = this;\r\n    var br = document.createElement('BR');\r\n    body.appendChild(br);\r\n    // get signature\r\n    var b = this.getSignature('connect');\r\n    body.appendChild(b);\r\n    // get header Parameter\r\n    body.appendChild(UTILS.getHeaderDom('Parameters'));\r\n    var br = document.createElement('BR');\r\n    body.appendChild(br);\r\n    //form to get server url\r\n    this.getForm( '', body, true, 'connect', 'URL : server_url');\r\n    //body.appendChild(form);\r\n    return body;\r\n} // getConnectExplorer\r\n\r\n// get database api calls - on click of databaseAPI nav bar - submenus of database Api defined here\r\nApiExplorer.prototype.getDatabaseExplorer = function(cont){\r\n    var body = document.createElement('div');\r\n    // list view of Databse tools\r\n    var ul = document.createElement('ul');\r\n    ul.setAttribute('class','terminus-ul-horizontal');\r\n    // loop over apiNavConfig\r\n    for (var key in apiNavConfig.subNav.database){\r\n        if (apiNavConfig.subNav.database.hasOwnProperty(key))\r\n            this.createSubNavs('database', apiNavConfig.subNav.database[key], cont, body, ul);\r\n    } // for apiNavConfig\r\n    cont.appendChild(ul);\r\n    // landing page\r\n    var dom = this.getDatabaseDom(apiNavConfig.subNav.database.createDatabase.action, body);\r\n    cont.appendChild(dom);\r\n    return cont;\r\n} // getDatabaseExplorer\r\n\r\n// get schema api calls - on click of SchemaAPI nav bar - submenus of schema Api defined here\r\nApiExplorer.prototype.getSchemaApi = function(cont){\r\n    var body = document.createElement('div');\r\n    // list view of Databse tools\r\n    var ul = document.createElement('ul');\r\n    ul.setAttribute('class','terminus-ul-horizontal');\r\n    // loop over apiNavConfig\r\n    for (var key in apiNavConfig.subNav.schema){\r\n        if (apiNavConfig.subNav.schema.hasOwnProperty(key)) {\r\n            this.createSubNavs('schema', apiNavConfig.subNav.schema[key], cont, body, ul);\r\n        }\r\n    } // for apiNavConfig\r\n    cont.appendChild(ul);\r\n    var dom = this.getShowApiDom(apiNavConfig.subNav.schema.getSchema.action, body);\r\n    cont.appendChild(dom);\r\n    return cont;\r\n} // getSchemaApi\r\n\r\n// get document api calls - on click of DocumentAPI nav bar\r\nApiExplorer.prototype.getDocumentApi = function(cont){\r\n    var body = document.createElement('div');\r\n    // list view of Databse tools\r\n    var ul = document.createElement('ul');\r\n    ul.setAttribute('class','terminus-ul-horizontal');\r\n    // loop over apiNavConfig\r\n    for (var key in apiNavConfig.subNav.document){\r\n        if (apiNavConfig.subNav.document.hasOwnProperty(key)) {\r\n            this.createSubNavs('document', apiNavConfig.subNav.document[key], cont, body, ul);\r\n        }\r\n    } // for apiNavConfig\r\n    cont.appendChild(ul);\r\n    var dom = this.getShowApiDom(apiNavConfig.subNav.document.viewDocument.action, body);\r\n    cont.appendChild(dom);\r\n    return cont;\r\n} // getDocumentApi\r\n\r\n// get query api calls - on click of QueryAPI nav bar - submenus of Query Api defined here\r\nApiExplorer.prototype.getQueryApi  = function(cont){\r\n    var body = document.createElement('div');\r\n    // list view of Databse tools\r\n    var ul = document.createElement('ul');\r\n    ul.setAttribute('class','terminus-ul-horizontal');\r\n    // loop over apiNavConfig\r\n    for (var key in apiNavConfig.subNav.query){\r\n        if (apiNavConfig.subNav.query.hasOwnProperty(key)) {\r\n            this.createSubNavs('query', apiNavConfig.subNav.query[key], cont, body, ul);\r\n        }\r\n    } // for apiNavConfig\r\n    cont.appendChild(ul);\r\n    var dom = this.getQueryApiDom(apiNavConfig.subNav.query.select.action, body);\r\n    cont.appendChild(dom);\r\n    return cont;\r\n} //getQueryApi\r\n\r\n/***** Api Content view  *****/\r\n// get database dom\r\nApiExplorer.prototype.getDatabaseDom = function(mode, body){\r\n    var self = this;\r\n    var br = document.createElement('BR');\r\n    body.appendChild(br);\r\n    // get signature\r\n    var b = this.getSignature(mode);\r\n    body.appendChild(b);\r\n    // get header Parameter\r\n    body.appendChild(UTILS.getHeaderDom('Parameters'));\r\n    var br = document.createElement('BR');\r\n    body.appendChild(br);\r\n    //form to get database id\r\n    if(mode == 'create') this.getForm( null, body, false, mode, 'URL : server/database_id');\r\n    else this.getForm( null, body, true, mode, 'URL : server/database_id');\r\n    return body;\r\n} // getConnectExplorer\r\n\r\n//get create & delete db form\r\nApiExplorer.prototype.getServerForm = function(){\r\n  // form\r\n  var form = document.createElement('form');\r\n  form.setAttribute('class', 'terminus-form-horizontal row-fluid');\r\n\r\n  var fd = document.createElement('div');\r\n  fd.setAttribute('class', 'terminus-control-group');\r\n  form.appendChild(fd);\r\n  var inpLabel = document.createElement('label');\r\n  inpLabel.setAttribute('class', 'terminus-control-label');\r\n  inpLabel.setAttribute('for', 'basicinput');\r\n  inpLabel.innerHTML = 'Url:';\r\n  fd.appendChild(inpLabel);\r\n  var cd = document.createElement('div');\r\n  cd.setAttribute('class', 'terminus-controls');\r\n  fd.appendChild(cd);\r\n  var inpId = document.createElement('input');\r\n  inpId.setAttribute('type', 'text');\r\n  inpId.setAttribute('id', 'basicinput');\r\n  inpId.setAttribute('class', 'terminus-input-text');\r\n  inpId.setAttribute('placeholder', 'URL : server_url');\r\n  if(this.val) inpId.value = this.val;\r\n  cd.appendChild(inpId);\r\n\r\n  var fd = document.createElement('div');\r\n  fd.setAttribute('class', 'terminus-control-group');\r\n  form.appendChild(fd);\r\n  var keyLabel = document.createElement('label');\r\n  keyLabel.setAttribute('class', 'terminus-control-label');\r\n  keyLabel.setAttribute('for', 'basicinput');\r\n  keyLabel.innerHTML = 'Key:';\r\n  fd.appendChild(keyLabel);\r\n  var cd = document.createElement('div');\r\n  cd.setAttribute('class', 'terminus-controls');\r\n  fd.appendChild(cd);\r\n  var key = document.createElement('input');\r\n  key.setAttribute('type', 'text');\r\n  key.setAttribute('id', 'basicinput');\r\n  key.setAttribute('class', 'span8 terminus-input-text');\r\n  key.setAttribute('placeholder', 'Key : key');\r\n  if(this.val) key.value = this.val;\r\n  cd.appendChild(key);\r\n\r\n  var button = document.createElement('button');\r\n  button.setAttribute('class', 'terminus-btn terminus-send-api-btn');\r\n  button.setAttribute('type', 'button');\r\n  button.innerHTML = 'Send Api';\r\n  var gatherips = function(){\r\n    var input = {};\r\n    input.url = inpId.value;\r\n    input.key = key.value;\r\n    return input;\r\n  }\r\n  var resd = document.createElement('div');\r\n  form.appendChild(button);\r\n  form.appendChild(resd);\r\n  var self = this;\r\n  button.addEventListener(\"click\", function(){\r\n    var buttonSelf = this;\r\n    //opts = {};\r\n    var input = gatherips();\r\n    self.client.connect(input.url, input.key)\r\n    .then(function(response){\r\n      TerminusClient.FrameHelper.removeChildren(resd);\r\n      var resultDom = UTILS.showHttpResult(response, 'connect', resd, self.ui);\r\n    });\r\n  }) // button click\r\n  return form;\r\n} // getServerForm()\r\n\r\n// get database api calls - on click of databaseAPI nav bar - submenus of database Api defined here\r\nApiExplorer.prototype.getDatabaseExplorer = function(cont){\r\n  var body = document.createElement('div');\r\n  // list view of Databse tools\r\n  var ul = document.createElement('ul');\r\n  ul.setAttribute('class','terminus-ul-horizontal');\r\n  // loop over apiNavConfig\r\n  for (var key in apiNavConfig.subNav.database){\r\n      if (apiNavConfig.subNav.database.hasOwnProperty(key)) {\r\n          this.createSubNavs('database', apiNavConfig.subNav.database[key], cont, body, ul);\r\n      }\r\n  } // for apiNavConfig\r\n  cont.appendChild(ul);\r\n  // landing page\r\n  var dom = this.getDatabaseDom(apiNavConfig.subNav.database.createDatabase.action, body);\r\n  cont.appendChild(dom);\r\n  return cont;\r\n} // getDatabaseExplorer\r\n\r\n\r\n// get schema & document dom\r\nApiExplorer.prototype.getShowApiDom = function(action, body){\r\n    var self = this;\r\n    var br = document.createElement('BR');\r\n    body.appendChild(br);\r\n    // signature\r\n    var b = this.getSignature(action);\r\n    body.appendChild(b);\r\n    // get header Parameter\r\n    body.appendChild(UTILS.getHeaderDom('Parameters'));\r\n    var br = document.createElement('BR');\r\n    body.appendChild(br);\r\n    // get input\r\n    switch(action){\r\n        case 'getSchema':\r\n            this.getForm( 'schema', body, true, action, 'URL : server/database_id');\r\n        break;\r\n        case 'getClassFrames':\r\n            this.getForm( 'getClassFrames', body, true, action, 'URL : server/database_id');\r\n        break;\r\n        case 'updateSchema':\r\n            this.getForm( 'schema', body, false, action, 'URL : server/database_id');\r\n        break;\r\n        case 'viewDocument':\r\n            this.getForm('document', body, true, action, 'URL : server/database_id/document/document_id');\r\n        break;\r\n        case 'deleteDocument':\r\n            this.getForm('document', body, true, action, 'URL : server/database_id/document/document_id');\r\n        break;\r\n        case 'createDocument':\r\n            this.getForm('document', body, false, action, 'URL : server/database_id/document/document_id');\r\n        break;\r\n        case 'updateDocument':\r\n            this.getForm('document', body, false, action, 'URL : server/database_id/document/document_id');\r\n        break;\r\n        default:\r\n            console.log('Invalid Api Call on form');\r\n        break;\r\n   }// switch(action)\r\n\r\n   return body;\r\n } // getShowApiDom()\r\n\r\n// get query api dom\r\nApiExplorer.prototype.getQueryApiDom = function(action, body){\r\n    var br = document.createElement('BR');\r\n    body.appendChild(br);\r\n    // signature\r\n    var b = this.getSignature(action);\r\n    body.appendChild(b);\r\n    // get header Parameter\r\n    body.appendChild(UTILS.getHeaderDom('Parameters'));\r\n    var br = document.createElement('BR');\r\n    body.appendChild(br);\r\n    this.getForm( 'query', body, false, action, 'URL : server/database_id');\r\n    return body;\r\n} // getQueryApiDom\r\n\r\n/*ApiExplorer.prototype.getClassFramesForm = function(){\r\n    // form\r\n    var form = document.createElement('form');\r\n    form.setAttribute('class', 'terminus-form-horizontal row-fluid');\r\n    var fd = document.createElement('div');\r\n    fd.setAttribute('class', 'terminus-control-group');\r\n    form.appendChild(fd);\r\n    var inpLabel = document.createElement('label');\r\n    inpLabel.setAttribute('class', 'terminus-control-label');\r\n    inpLabel.setAttribute('for', 'basicinput');\r\n    inpLabel.innerHTML = 'Url:';\r\n    fd.appendChild(inpLabel);\r\n    var cd = document.createElement('div');\r\n    cd.setAttribute('class', 'terminus-controls');\r\n    fd.appendChild(cd);\r\n    var inpUrl = document.createElement('input');\r\n    inpUrl.setAttribute('type', 'text');\r\n    inpUrl.setAttribute('id', 'basicinput');\r\n    inpUrl.setAttribute('class', 'span8 terminus-input-text');\r\n    inpUrl.setAttribute('placeholder', 'URL : database_url');\r\n    if(this.val) inpUrl.value = this.val;\r\n    cd.appendChild(inpUrl);\r\n    var fd = document.createElement('div');\r\n    fd.setAttribute('class', 'terminus-control-group');\r\n    form.appendChild(fd);\r\n    var inpLabel = document.createElement('label');\r\n    inpLabel.setAttribute('class', 'terminus-control-label');\r\n    inpLabel.setAttribute('for', 'basicinput');\r\n    inpLabel.innerHTML = 'Url/ ID:';\r\n    fd.appendChild(inpLabel);\r\n    var cd = document.createElement('div');\r\n    cd.setAttribute('class', 'terminus-controls');\r\n    fd.appendChild(cd);\r\n    var inpDocUrl = document.createElement('input');\r\n    inpDocUrl.setAttribute('type', 'text');\r\n    inpDocUrl.setAttribute('id', 'basicinput');\r\n    inpDocUrl.setAttribute('class', 'span8 terminus-input-text');\r\n    inpDocUrl.setAttribute('placeholder', 'Url or ID of document class');\r\n    cd.appendChild(inpDocUrl);\r\n    var fd = document.createElement('div');\r\n    fd.setAttribute('class', 'terminus-control-group');\r\n    form.appendChild(fd);\r\n    var optLabel = document.createElement('label');\r\n    optLabel.setAttribute('class', 'terminus-control-label');\r\n    optLabel.setAttribute('for', 'basicinput');\r\n    optLabel.innerHTML = 'Options:';\r\n    fd.appendChild(optLabel);\r\n    var cd = document.createElement('div');\r\n    cd.setAttribute('class', 'terminus-controls');\r\n    fd.appendChild(cd);\r\n    var optInp = document.createElement('input');\r\n    optInp.setAttribute('type', 'text');\r\n    optInp.setAttribute('id', 'basicinput');\r\n    optInp.setAttribute('class', 'span8 terminus-input-text');\r\n    optInp.setAttribute('placeholder', 'options');\r\n    cd.appendChild(optInp);\r\n    var button = document.createElement('button');\r\n    button.setAttribute('class', 'terminus-btn terminus-send-api-btn');\r\n    button.setAttribute('type', 'button');\r\n    button.innerHTML = 'Send Api';\r\n    var gatherips = function(){\r\n        var input = {};\r\n        input.url = inpUrl.value;\r\n        input.docUrl = inpDocUrl.value;\r\n        input.options = optInp.value;\r\n        return input;\r\n    }\r\n    var self = this;\r\n    button.addEventListener(\"click\", function(form){\r\n      var input = gatherips();\r\n      var buttonSelf = this;\r\n      opts = {};\r\n      opts.explorer = true;\r\n      self.client.getClassFrame(input.url, input.docUrl, opts)\r\n      .then(function(response){\r\n          var currForm = buttonSelf.parentNode;\r\n          var resultDom = UTILS.showHttpResult(response, 'getClassFrames', currForm, self.ui);\r\n      });\r\n    }) // button click\r\n    form.appendChild(button);\r\n    return form;\r\n}   */\r\n\r\n// get form for all Apis\r\nApiExplorer.prototype.getForm = function(curApi, body, view, action, urlPlaceholder){\r\n    // form\r\n    var formDoc = document.createElement('form');\r\n    formDoc.setAttribute('class', 'terminus-form-horizontal row-fluid');\r\n    var fd = document.createElement('div');\r\n    fd.setAttribute('class', 'terminus-control-group');\r\n    formDoc.appendChild(fd);\r\n    var urlLabel = document.createElement('label');\r\n    urlLabel.setAttribute('class', 'terminus-control-label');\r\n    urlLabel.setAttribute('for', 'basicinput');\r\n    urlLabel.innerHTML = 'Url:';\r\n    fd.appendChild(urlLabel);\r\n    var cd = document.createElement('div');\r\n    cd.setAttribute('class', 'terminus-controls');\r\n    fd.appendChild(cd);\r\n    var inpUrl = document.createElement('input');\r\n    inpUrl.setAttribute('type', 'text');\r\n    inpUrl.setAttribute('id', 'basicinput');\r\n    inpUrl.setAttribute('class', 'span8 terminus-input-text');\r\n    inpUrl.setAttribute('placeholder', urlPlaceholder);\r\n    cd.appendChild(inpUrl);\r\n    // add extra form fields based on current api chosen\r\n    switch(curApi){\r\n        case 'getClassFrames':\r\n            var fd = document.createElement('div');\r\n            fd.setAttribute('class', 'terminus-control-group');\r\n            formDoc.appendChild(fd);\r\n            var docUrlLabel = document.createElement('label');\r\n            docUrlLabel.setAttribute('class', 'terminus-control-label');\r\n            docUrlLabel.setAttribute('for', 'basicinput');\r\n            docUrlLabel.innerHTML = 'Url/ ID:';\r\n            fd.appendChild(docUrlLabel);\r\n            var cd = document.createElement('div');\r\n            cd.setAttribute('class', 'terminus-controls');\r\n            fd.appendChild(cd);\r\n            var inpDocUrl = document.createElement('input');\r\n            inpDocUrl.setAttribute('type', 'text');\r\n            inpDocUrl.setAttribute('id', 'basicinput');\r\n            inpDocUrl.setAttribute('class', 'span8 terminus-input-text');\r\n            inpDocUrl.setAttribute('placeholder', 'Url or ID of document class');\r\n            cd.appendChild(inpDocUrl);\r\n        break;\r\n        case 'schema':\r\n            //encoding\r\n           /* var fd = document.createElement('div');\r\n            fd.setAttribute('class', 'terminus-control-group');\r\n            formDoc.appendChild(fd);\r\n            var encLabel = document.createElement('label');\r\n            encLabel.setAttribute('class', 'terminus-control-label');\r\n            encLabel.setAttribute('for', 'basicinput');\r\n            encLabel.innerHTML = 'Encoding:';\r\n            fd.appendChild(encLabel);\r\n            var cd = document.createElement('div');\r\n            cd.setAttribute('class', 'terminus-controls');\r\n            fd.appendChild(cd);\r\n            var inpEnc = document.createElement('select');\r\n            inpEnc.setAttribute('style', 'height: 50px;width: 300px;padding: 10px;');\r\n            inpEnc.setAttribute('placeholder', 'turtle');\r\n            var optTurt = document.createElement('option');\r\n            optTurt.setAttribute('value', 'terminus:turtle');\r\n            optTurt.appendChild(document.createTextNode('turtle'));\r\n            inpEnc.appendChild(optTurt);\r\n            var optJld = document.createElement('option');\r\n            optJld.setAttribute('value', 'terminus:jsonld');\r\n            optJld.appendChild(document.createTextNode('jsonLD'));\r\n            inpEnc.appendChild(optJld);\r\n            cd.appendChild(inpEnc); */\r\n        break;\r\n    }\r\n    var fd = document.createElement('div');\r\n    fd.setAttribute('class', 'terminus-control-group');\r\n    formDoc.appendChild(fd);\r\n    var keyLabel = document.createElement('label');\r\n    keyLabel.setAttribute('class', 'terminus-control-label');\r\n    keyLabel.setAttribute('for', 'basicinput');\r\n    keyLabel.innerHTML = 'Key:';\r\n    fd.appendChild(keyLabel);\r\n    var cd = document.createElement('div');\r\n    cd.setAttribute('class', 'terminus-controls');\r\n    fd.appendChild(cd);\r\n    var inpKey = document.createElement('input');\r\n    inpKey.setAttribute('type', 'text');\r\n    inpKey.setAttribute('id', 'basicinput');\r\n    inpKey.setAttribute('class', 'span8 terminus-input-text');\r\n    inpKey.setAttribute('placeholder', 'Key');\r\n    cd.appendChild(inpKey);\r\n    if(!view){\r\n        // include text area only if call is type post\r\n        var fd = document.createElement('div');\r\n        fd.setAttribute('class', 'terminus-control-group');\r\n        formDoc.appendChild(fd);\r\n        var docLabel = document.createElement('label');\r\n        docLabel.setAttribute('class', 'terminus-control-label');\r\n        docLabel.setAttribute('for', 'basicinput');\r\n        if(curApi == 'query') docLabel.innerHTML = 'Query:';\r\n        docLabel.innerHTML = 'Document:';\r\n        fd.appendChild(docLabel);\r\n        var cd = document.createElement('div');\r\n        cd.setAttribute('class', 'terminus-controls');\r\n        fd.appendChild(cd);\r\n        var inpDoc = document.createElement('textarea');\r\n        cd.appendChild(inpDoc);\r\n        inpDoc.setAttribute('class', 'terminus-api-explorer-text-area');\r\n        UTILS.stylizeEditor(this.ui, inpDoc, 'api-doc', 'javascript');\r\n    }\r\n    body.appendChild(formDoc);\r\n    // gather inputs\r\n    var inp ={};\r\n    inp.url = inpUrl;\r\n    inp.key = inpKey;\r\n    if(curApi == 'getClassFrames') inp.docUrl = inpDocUrl;\r\n    //if(curApi == 'schema') inp.enc = inpEnc;\r\n    if(!view) inp.doc = inpDoc;\r\n    var form = this.getApiSendButton(action, inp);\r\n    body.appendChild(form);\r\n}\r\n\r\n// define event listeners on send api of schema & documents\r\n\r\nApiExplorer.prototype.getApiForm = function(action, input){\r\n  // form\r\n  var form = document.createElement('form');\r\n  form.setAttribute('class', 'terminus-form-horizontal row-fluid');\r\n\r\n  var button = document.createElement('button');\r\n  button.setAttribute('class', 'terminus-btn terminus-send-api-btn');\r\n  button.setAttribute('type', 'button');\r\n  button.innerHTML = 'Send Api';\r\n  form.appendChild(button);\r\n  var resd = document.createElement('div');\r\n  form.appendChild(resd);\r\n  var self = this;\r\n  switch(action){\r\n    case 'getSchema':\r\n      button.addEventListener(\"click\", function(){\r\n        var opts = {};\r\n        opts['terminus:encoding'] = input.enc.value;\r\n        opts['terminus:user_key'] = 'terminus:turtle';\r\n        var schurl = input.url.value;\r\n        var buttonSelf = this;\r\n        self.client.getSchema(schurl, opts)\r\n        .then(function(response){\r\n          TerminusClient.FrameHelper.removeChildren(resd);\r\n          var resultDom = UTILS.showHttpResult(response, 'getSchema', resd, self.ui);\r\n        });\r\n      }) // button click\r\n    break;\r\n    case 'updateSchema':\r\n      button.addEventListener(\"click\", function(){\r\n        var buttonSelf = this;\r\n        opts = {};\r\n        opts['terminus:encoding'] = input.enc.value;\r\n        opts['terminus:user_key'] = 'terminus:turtle';\r\n        var schurl = input.url.value;\r\n        self.client.connectionConfig.connected_mode = false;\r\n        self.client.updateSchema(schurl, input.doc.value, opts)\r\n        .then(function(response){\r\n          var gtxtar = document.createElement('textarea');\r\n          gtxtar.setAttribute('readonly', true);\r\n          gtxtar.innerHTML = response;\r\n          var currForm = buttonSelf.parentNode;\r\n          currForm.appendChild(gtxtar);\r\n          UTILS.stylizeEditor(this.ui, txtar, 'schema', 'turtle');\r\n        });\r\n      }) // button click\r\n    break;\r\n    case 'viewDocument':\r\n      button.addEventListener(\"click\", function(){\r\n      var dcurl = input.value;\r\n      var buttonSelf = this;\r\n      var opts = {};\r\n      opts.format = 'turtle';\r\n      self.client.getDocument(dcurl, opts)\r\n      .then(function(response){\r\n        TerminusClient.FrameHelper.removeChildren(resd);\r\n        var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n      });\r\n    }) // button click\r\n    break;\r\n    case 'deleteDocument':\r\n      button.addEventListener(\"click\", function(){\r\n      var dcurl = input.value;\r\n      var buttonSelf = this;\r\n      var opts = {};\r\n      self.client.deleteDocument(dcurl, opts)\r\n      .then(function(response){\r\n        TerminusClient.FrameHelper.removeChildren(resd);\r\n        var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n      });\r\n    }) // button click\r\n    break;\r\n    case 'createDocument':\r\n      button.addEventListener(\"click\", function(){\r\n        var dcurl = input.schemaUrlDom.value;\r\n        var payload = input.htmlEditor.getValue();\r\n        var buttonSelf = this;\r\n        opts = {};\r\n        self.client.createDocument(dcurl, payload, opts)\r\n        .then(function(response){\r\n          TerminusClient.FrameHelper.removeChildren(resd);\r\n          var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n        });\r\n      }) // button click\r\n    break;\r\n    case 'updateDocument':\r\n      button.addEventListener(\"click\", function(){\r\n        var dcurl = input.schemaUrlDom.value;\r\n        var payload = input.htmlEditor.getValue();\r\n        var buttonSelf = this;\r\n        opts = {};\r\n        opts.editmode = 'replace';\r\n        opts.format = 'json';\r\n        self.client.updateDocument(dcurl, payload, opts)\r\n        .then(function(response){\r\n          TerminusClient.FrameHelper.removeChildren(resd);\r\n          var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n        });\r\n      }) // button click\r\n    break;\r\n  } // switch(action)\r\n\r\n  var br = document.createElement('BR');\r\n  form.appendChild(br);\r\n  var br = document.createElement('BR');\r\n  form.appendChild(br);\r\n\r\n  return form;\r\n} // getApiForm()\r\n\r\n\r\n// define event listeners on send api of schema & documents\r\nApiExplorer.prototype.getApiSendButton = function(action, input){\r\n    // form\r\n    var form = document.createElement('form');\r\n    form.setAttribute('class', 'terminus-form-horizontal row-fluid');\r\n    var button = document.createElement('button');\r\n    button.setAttribute('class', 'terminus-btn terminus-send-api-btn');\r\n    button.setAttribute('type', 'button');\r\n    button.innerHTML = 'Send Api';\r\n    form.appendChild(button);\r\n    var resd = document.createElement('div');\r\n    form.appendChild(resd);\r\n    var self = this;\r\n    switch(action){\r\n        case 'connect':\r\n            button.addEventListener(\"click\", function(){\r\n                self.client.connect(input.url.value, input.key.value)\r\n                .then(function(response){\r\n                \tTerminusClient.FrameHelper.removeChildren(resd);\r\n                    var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n               });\r\n            }) // button click\r\n        break;\r\n        case 'create':\r\n            button.addEventListener(\"click\", function(form){\r\n              self.client.createDatabase(input.url.value, JSON.parse(input.doc.value), input.key.value)\r\n              .then(function(response){\r\n            \t  TerminusClient.FrameHelper.removeChildren(resd);\r\n                  var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n              });\r\n            }) // button click\r\n        break;\r\n        case 'delete':\r\n            button.addEventListener(\"click\", function(){\r\n              var opts ={}\r\n              self.client.deleteDatabase(input.url.value, input.key.value)\r\n              .then(function(response){\r\n            \t  TerminusClient.FrameHelper.removeChildren(resd);\r\n                  var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n              });\r\n            }) // button click\r\n        break\r\n        case 'getSchema':\r\n            button.addEventListener(\"click\", function(){\r\n                var opts = {};\r\n                opts['terminus:encoding'] = 'terminus:turtle';\r\n                opts['terminus:user_key'] = input.key.value;\r\n                var schurl = input.url.value;\r\n                self.client.getSchema(schurl, opts)\r\n                .then(function(response){\r\n                \tTerminusClient.FrameHelper.removeChildren(resd);\r\n                    var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n                });\r\n            }) // button click\r\n        break;\r\n        case 'updateSchema':\r\n            button.addEventListener(\"click\", function(){\r\n                opts = {};\r\n                opts['terminus:encoding'] = 'terminus:turtle';\r\n                opts['terminus:user_key'] = input.key.value;\r\n                var payload = input.doc.value;\r\n                var schurl = input.url.value;\r\n                self.client.connectionConfig.connected_mode = false;\r\n                self.client.updateSchema(schurl, input.doc.value, opts)\r\n                //self.client.updateSchema(schurl, input.doc.value, opts)\r\n                .then(function(response){\r\n                \tTerminusClient.FrameHelper.removeChildren(resd);\r\n                    var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n                });\r\n            }) // button click\r\n        break;\r\n        case 'getClassFrames':\r\n            button.addEventListener(\"click\", function(form){\r\n                var schurl = input.url.value;\r\n                opts = {};\r\n                opts.explorer = true;\r\n                self.client.getClassFrame(input.url, JSON.parse(input.docUrl.value), opts)\r\n                .then(function(response){\r\n                    var currForm = buttonSelf.parentNode;\r\n                    var resultDom = UTILS.showHttpResult(response, action, currForm, self.ui);\r\n                });\r\n            }) // button click\r\n        break;\r\n        case 'viewDocument':\r\n          button.addEventListener(\"click\", function(){\r\n              var dcurl = input.url.value;\r\n              var opts = {};\r\n              opts['terminus:encoding'] = \"terminus:frame\";\r\n              opts['terminus:user_key'] = input.key.value;\r\n              self.client.getDocument(dcurl, opts)\r\n              .then(function(response){\r\n            \t    TerminusClient.FrameHelper.removeChildren(resd);\r\n                    var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n              });\r\n        }) // button click\r\n        break;\r\n        case 'deleteDocument':\r\n          button.addEventListener(\"click\", function(){\r\n              var dcurl = input.url.value;\r\n              var opts = {};\r\n              opts.key = input.key.value;\r\n              self.client.deleteDocument(dcurl, opts)\r\n              .then(function(response){\r\n            \t  TerminusClient.FrameHelper.removeChildren(resd);\r\n                  var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n              });\r\n          }) // button click\r\n        break;\r\n        case 'createDocument':\r\n          button.addEventListener(\"click\", function(){\r\n              var dcurl = input.url.value;\r\n              var payload = input.doc.value;\r\n              opts = {};\r\n              opts['terminus:encoding'] = \"jsonld\";\r\n              opts['terminus:user_key'] = input.key.value;\r\n              self.client.createDocument(dcurl, JSON.parse(payload), opts)\r\n              .then(function(response){\r\n            \t   TerminusClient.FrameHelper.removeChildren(resd);\r\n                   var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n               });\r\n          }) // button click\r\n        break;\r\n        case 'updateDocument':\r\n          button.addEventListener(\"click\", function(){\r\n            var dcurl = input.url.value;\r\n            var payload = input.doc.value;\r\n            var buttonSelf = this;\r\n            opts = {};\r\n            opts['terminus:encoding'] = \"jsonld\";\r\n            opts['terminus:user_key'] = input.key.value;\r\n            self.client.updateDocument(dcurl, JSON.parse(payload), opts)\r\n            .then(function(response){\r\n            \tTerminusClient.FrameHelper.removeChildren(resd);\r\n                var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n            });\r\n          }) // button click\r\n        break;\r\n        case 'select':\r\n            button.addEventListener(\"click\", function(){\r\n                var opts = {};\r\n                opts.key = input.key.value;\r\n                var doc = JSON.parse(input.doc.value);\r\n                self.client.select(input.url.value, doc, opts)\r\n                .then(function(response){\r\n                \tTerminusClient.FrameHelper.removeChildren(resd);\r\n                    var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n                });\r\n            }) // button click\r\n        break;\r\n        case 'update':\r\n            button.addEventListener(\"click\", function(){\r\n              var opts = {};\r\n              opts.key = input.key.value;\r\n              var doc = JSON.parse(input.doc.value);\r\n              self.client.update(input.url.value, doc, opts)\r\n              .then(function(response){\r\n            \t  TerminusClient.FrameHelper.removeChildren(resd);\r\n                  var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\r\n              });\r\n            }) // button click\r\n        break;\r\n        default:\r\n            console.log('Invalid Api call on button');\r\n        break;\r\n    } // switch(action)\r\n    var br = document.createElement('BR');\r\n    form.appendChild(br);\r\n    var br = document.createElement('BR');\r\n    form.appendChild(br);\r\n    return form;\r\n} // getApiSendButton()\r\n\r\n// get signature of api calls\r\nApiExplorer.prototype.getSignature = function(action){\r\n    var api = document.createElement('div');\r\n    // get header signature\r\n    var sg = document.createElement('button');\r\n    sg.appendChild(document.createTextNode('Click to read API Signature'));\r\n    sg.setAttribute('class', 'terminus-collapsible');\r\n    ic = document.createElement('i');\r\n    ic.setAttribute('class', 'terminus-cheveron-float fa fa-chevron-down');\r\n    sg.appendChild(ic);\r\n    api.appendChild(sg);\r\n    var br = document.createElement('BR');\r\n    api.appendChild(br);\r\n    var cl = document.createElement('div');\r\n    cl.setAttribute('class', 'terminus-collapsible-content content');\r\n    var sig = UTILS.getFunctionSignature(action);\r\n    var txt = document.createTextNode(sig.spec);\r\n    var pre = document.createElement('pre');\r\n    pre.setAttribute('class', 'terminus-api-signature-pre');\r\n    pre.appendChild(txt);\r\n    var txt =  document.createTextNode(sig.descr);\r\n    pre.appendChild(txt);\r\n    var br = document.createElement('BR');\r\n    pre.appendChild(br);\r\n    var br = document.createElement('BR');\r\n    pre.appendChild(br);\r\n    var txt = document.createTextNode(sig.result);\r\n    pre.appendChild(txt);\r\n    cl.appendChild(pre);\r\n    api.appendChild(cl);\r\n    var br = document.createElement('BR');\r\n    api.appendChild(br);\r\n    sg.addEventListener('click', function(){\r\n        UTILS.tolggleContent(ic, cl);\r\n    });\r\n    return api;\r\n} // getSignature()\r\n\r\n// displays signature only on click\r\nfunction tolggleSignatureContent(content){\r\n    if (content.style.display === \"block\")\r\n        content.style.display = \"none\";\r\n    else content.style.display = \"block\";\r\n}\r\n\r\nmodule.exports=ApiExplorer\r\n","function Codemirror(text, format, config){\r\n  this.textdom = text;\r\n  this.mode = format;\r\n  this.darkMode = config.darkMode;\r\n  if(this.jsonldCheck(format)) this.mode = 'javascript';\r\n}\r\n\r\n/*\r\ntxtar    : editor is attached to textar\r\nmode     : format for highlighting, ex: json, html etc.\r\neditable : readOnly false/ nocursor is special value in code editor to set readonly true */\r\nCodemirror.prototype.colorizeTextArea = function(mode){\r\n    //initize auto complete\r\n    /*CodeMirror.commands.autocomplete = function(cm) {\r\n    cm.showHint({hint: CodeMirror.hint.anyword});\r\n    }*/\r\n\r\n    // initialise code editor on text area\r\n    var editor = CodeMirror.fromTextArea(this.textdom, {\r\n        mode                : this.mode,\r\n        firstLineNumber     : 1,\r\n        lineNumbers         : true,\r\n        styleActiveLine     : true,\r\n        lineWrapping        : true,\r\n        smartIndent         : true,\r\n        indentWithTabs      : true,\r\n        newlineAndIndent    : true,\r\n        autoCloseBrackets   : true,\r\n        matchBrackets       : {afterCursor: true},\r\n        extraKeys           : {\"Ctrl-F\": \"find\", \"Tab\": \"autocomplete\" },\r\n        refresh             : true\r\n    });\r\n\r\n    this.setCodemirrorSize(editor, mode);\r\n    editor.defaultCharWidth('20px');\r\n    if(this.darkMode) editor.setOption(\"theme\", 'erlang-dark');\r\n    else editor.setOption(\"theme\", 'neo');\r\n\r\n    return editor;\r\n} // colorizeTextArea()\r\n\r\n/*\r\n  set editor size according to screens\r\n  editor : code mirror editor Object\r\n  mode   : editor being viewed from schema/ doc/ query page*/\r\nCodemirror.prototype.setCodemirrorSize = function(editor, mode){\r\n  switch(mode){\r\n    case 'query':\r\n      editor.setSize('800', '400');\r\n    break;\r\n    case 'schema':\r\n      editor.setSize('1200', '1550');\r\n    break;\r\n    case 'document':\r\n     editor.setSize('765', '500');\r\n    break;\r\n    case 'api-doc':\r\n        editor.setSize('800', '500');\r\n    break;\r\n  } // switch(mode)\r\n} // setCodemirrorSize()\r\n\r\n// updateTextArea(): highlights new changes on editor\r\nCodemirror.prototype.updateTextArea = function(editor){\r\n  editor.save();\r\n  setTimeout(function() {\r\n      editor.refresh();\r\n  },1);\r\n  // save changes of code mirror editor\r\n  editor.on('change', function(){\r\n    editor.save();\r\n  });\r\n} //updateTextArea()\r\n\r\n/*\r\ncolorizePre() to colorise pre tags (read only mode)\r\ntext (string)    : The document to run through the highlighter.\r\nmode (mode spec) : format to highlight color\r\noutput (DOM node): The tokens will be converted to spans as in an editor,\r\n                   and inserted into the node (through innerHTML).*/\r\nCodemirror.prototype.colorizePre = function(){\r\n  CodeMirror.runMode(this.textdom.innerText, this.mode, this.textdom);\r\n  if(this.darkMode)\r\n      var theme = 'cm-s-erlang-dark';\r\n  else var theme = 'cm-s-neo';\r\n  this.textdom.setAttribute('class', 'CodeMirror CodeMirror-wrap ' + theme + ' terminus-wrap-text terminus-wrapper-height ');\r\n  return this.textdom;\r\n} // colorizePre()\r\n\r\nCodemirror.prototype.jsonldCheck = function(format){\r\n  if(format == 'jsonld') return true;\r\n}\r\n\r\nmodule.exports=Codemirror\r\n","/**\r\n * object renderer binds to object frame - provides filters, sorts and manipulations of underlying object frame\r\n * and coordinates viewer to draw updates\r\n\r\n * Object Renderer - provides sorting / filtering / state management of objects\r\n * @param obj ObjectFrame object - contains underlying data and frame structure\r\n * @param parent PropertyRenderer - property that owns this object (if any)\r\n * @param options options json\r\n * @returns\r\n */\r\n\r\nconst RenderingMap = require('./RenderingMap');\r\nconst ValueRenderer = require('./ValueRenderer');\r\nconst ObjectViewer = require('./ObjectViewer');\r\nconst PropertyViewer = require('./PropertyViewer');\r\nconst HTMLDataViewer = require('./DataViewer');\r\nconst HTMLFrameHelper = require('./HTMLFrameHelper');\r\n\r\nfunction PropertyRenderer(prop, parent, options){\r\n\tthis.predicate = prop;\r\n\tthis.parent = parent;\r\n\tthis.cframe = this.parent.objframe.getPropertyClassFrame(this.predicate);\r\n\tthis.originalValues = false;\r\n\tthis.changed = false;\r\n\tthis.values = [];\r\n\tthis.renderer_type = \"property\";\r\n\tthis.options = this.setOptions(options);\r\n}\r\n\r\nPropertyRenderer.prototype.setOptions = function(options){\r\n\treturn TerminusDashboard.RenderingMap.decorateRenderer(options, this);\r\n}\r\n\r\nPropertyRenderer.prototype.getOptionsForChild = function(){\r\n\tvar opts = {};\r\n\tif(this.options.features){ opts.features = this.options.features };\r\n\tif(this.options.controls){ opts.controls = this.options.controls};\r\n\treturn this.options;\r\n}\r\n\r\nPropertyRenderer.prototype.getOptionsForValue = function(df, index){\r\n\treturn this.getOptionsForChild();\r\n}\r\n\r\nPropertyRenderer.prototype.getOptionsForObject = function(objframe){\r\n\treturn this.getOptionsForChild();\r\n}\r\n\r\n\r\nPropertyRenderer.prototype.render = function(viewer){\r\n \tthis.buildValueRenderers();\r\n \tif(this.cframe && this.cframe.property){\r\n \t\tthis.viewer = (viewer ? viewer : this.getViewerForProperty());\r\n \t\tfor(var i = 0; i<this.values.length; i++){\r\n \t\t\tvar renderedval = this.values[i].render();\r\n \t\t\tif(renderedval && this.showFeature(\"body\")) this.viewer.addRenderedValue(renderedval);\r\n \t\t}\r\n \t\treturn this.viewer.render();\r\n \t}\r\n} \r\n\r\n/*\r\n * Creates the array of object renderer or value renderer objects corresponding to the property values. \r\n */\r\nPropertyRenderer.prototype.buildValueRenderers = function(){\r\n \tvar adorig = (this.originalValues === false ? true : false);\r\n \tthis.cframe = this.parent.objframe.getPropertyClassFrame(this.predicate);\r\n \tif(!this.cframe){\r\n \t\tconsole.error(\"No frame for \" + this.property() + \" id: \" + this.subject());\r\n \t\treturn false;\r\n \t}\r\n \tif(this.cframe && this.cframe.isData()){\r\n \t\tvar dataframes = this.getDataFramesToRender();\r\n \t\tif(dataframes.length == 0){\r\n \t\t\talert(this.predicate);\r\n \t\t}\r\n \t\tvar vals = [];\r\n \t\tfor(var i = this.values.length; i<dataframes.length; i++){\r\n \t\t\tvar vr = new ValueRenderer(dataframes[i], i, this, this.getOptionsForValue(dataframes[i], i));\r\n \t\t\tthis.values.push(vr);\r\n \t\t\tvals.push(vr.value());\r\n \t\t}\r\n \t\tif(adorig) this.originalValues = vals;\r\n \t}\r\n \telse {\r\n \t\tif(adorig) this.originalValues = [];\r\n \t\tvar kids = this.getChildrenToRender();\r\n \t\tif(kids && kids.length){\r\n \t\t\tfor(var i = this.values.length; i<kids.length; i++){\r\n \t\t\t\tvar kidf = new ObjectRenderer(kids[i], this, this.getOptionsForObject(kids[i]));\r\n \t\t\t\tif(adorig) this.originalValues.push(kidf.subject());\r\n \t\t\t\tthis.values.push(kidf);\r\n \t\t\t}\r\n \t\t}\r\n \t}\r\n}\r\n\r\n/*\r\n * Returns the array of values that should be rendered (enables value filtering)\r\n */\r\nPropertyRenderer.prototype.getDataFramesToRender = function(options){\r\n \tvar allvals = this.parent.objframe.getDataFrames(this.property());\r\n \treturn allvals;\r\n}\r\n\r\n/*\r\n * Returns the array of child / objects that should be rendered (enables value filtering)\r\n */\r\nPropertyRenderer.prototype.getChildrenToRender = function(options){\r\n \tif(TerminusClient.FrameHelper.viewIncludesChildren(this.view, \"property\")){\r\n \t\tvar allkids = this.parent.objframe.getChildren(this.property());\r\n \t}\r\n \telse {\r\n \t\tvar allkids = [];\r\n \t}\r\n \treturn allkids;\r\n}\r\n\r\nPropertyRenderer.prototype.redraw = function(){\r\n \tthis.viewer.clear();\r\n \tthis.render(this.viewer, \"x\");\r\n \t//alert(this.values.length);\r\n}\r\n\r\nPropertyRenderer.prototype.extract = function(){\r\n \tvar extracts = [];\r\n \tfor(var i = 0; i<this.values.length; i++){\r\n \t\tvar val = this.values[i].extract();\r\n \t\tif(val !== \"\" && val !== false && typeof val != \"undefined\") extracts.push(val);\r\n \t}\r\n \tif(this.cframe.isData()){\r\n \t\treturn extracts;\r\n \t}\r\n \telse {\r\n \t\treturn extracts;\r\n \t\tvar extr = {};\r\n \t\tfor(var i = 0; i<extracts.length; i++){\r\n \t\t\tfor(var subjid in extracts[i]){\r\n \t\t\t\textr[subjid] = extracts[i][subjid];\r\n \t\t\t}\r\n \t\t}\r\n \t\treturn extr;\r\n \t}\r\n}\r\n\r\n/*\r\n * simple wrapper functions\r\n */\r\nPropertyRenderer.prototype.currentViewer = function(){return this.viewerType;}\r\nPropertyRenderer.prototype.property = function(){return this.predicate;}\r\nPropertyRenderer.prototype.subject = function(){return (this.parent ? this.parent.subject() : false);};\r\nPropertyRenderer.prototype.depth = function(){return (this.parent ? this.parent.depth() : false);};\r\nPropertyRenderer.prototype.subjectClass = function(){return (this.parent ? this.parent.subjectClass() : false);};\r\nPropertyRenderer.prototype.updated = function(){ return (this.parent ? this.parent.childUpdated() : false);};\r\nPropertyRenderer.prototype.range = function(){\treturn (this.cframe ? this.cframe.range : \"\");};\r\nPropertyRenderer.prototype.getLabel = function(){ return (this.cframe ? this.cframe.getLabel() : \"\" );};\r\nPropertyRenderer.prototype.getComment = function(){ return (this.cframe ? this.cframe.getComment() : false);}\r\nPropertyRenderer.prototype.load = function(link){ return (this.parent ? this.parent.load(link) : false);}\r\nPropertyRenderer.prototype.hasCardinalityRestriction = function(){return (this.cframe ? this.cframe.hasRestriction() : false);};\r\nPropertyRenderer.prototype.getRestriction = function(){return (this.cframe ? this.cframe.restriction : false);};\r\nPropertyRenderer.prototype.isClassChoice = function(){\treturn (this.cframe ? this.cframe.isClassChoice() : false);};\r\nPropertyRenderer.prototype.currentFacet = function(){\treturn this.facet;} ;\r\nPropertyRenderer.prototype.save = function(){ return (this.parent ? this.parent.save() : false);};\r\n\r\nPropertyRenderer.prototype.cancel = function(){\r\n\tthis.reset();\r\n\tthis.setMode(\"view\");\r\n}\r\n\r\nPropertyRenderer.prototype.getAvailableClassChoices = function(){ \r\n\tif(this.cframe){\r\n\t\tvar cf = this.cframe.getClassChoices();\r\n\t\tif(this.parent){\r\n\t\t\tvar choices = [];\r\n\t\t\tfor(var i = 0; i < cf.length; i++){\r\n\t\t\t\tvar clsmeta = this.parent.getClassMeta(cf[i]);\r\n\t\t\t\tvar lab = (clsmeta ? HTMLFrameHelper.getVariableValueFromBinding(\"Label\", clsmeta) : false);\r\n\t\t\t\tvar lab = (lab ? lab : TerminusClient.FrameHelper.labelFromURL(cf[i]));\r\n\t\t\t\tchoices.push({value: cf[i], label: lab});\r\n\t\t\t}\r\n\t\t\treturn choices;\r\n\t\t}\r\n\t\treturn cf;\r\n\t\t\r\n\t}\r\n\treturn false;\r\n};\r\n\r\n\r\nPropertyRenderer.prototype.delete = function(){\r\n\tvar prop = this.predicate;\r\n\tif(prop){\r\n\t\tthis.reset();\r\n\t\tthis.parent.deleteProperty(prop);\t\r\n\t\tthis.parent.redraw();\r\n\t}\r\n}\r\n\r\nPropertyRenderer.prototype.add = function(view){\r\n\tthis.parent.addProperty(this.property(), view);\r\n\tthis.updated();\r\n\tif(view) {\r\n\t\tthis.values[this.values.length-1].setMode(view);\r\n\t\tthis.values[this.values.length-1].setNew();\r\n\t}\r\n\tthis.redraw();\r\n}\r\n\r\nPropertyRenderer.prototype.goToValue = function(index){\r\n\tthis.viewer.goTo(this.subject(), this.property(), index);\r\n}\r\n\r\nPropertyRenderer.prototype.addClass = function(cls){\r\n\tthis.parent.addPropertyClass(this.property(), cls);\r\n\tthis.updated();\r\n\tvar newb = this.values[this.values.length-1];\r\n\tif(newb){\r\n\t\tnewb.setNew();\r\n\t\tnewb.setMode(\"edit\");\r\n\t}\r\n\tthis.redraw();\r\n\tif(newb) this.viewer.goTo(newb.subject());\r\n}\r\n\r\nPropertyRenderer.prototype.reset = function(){\r\n\tthis.parent.objframe.reset(this.predicate);\r\n\tif(this.cframe && this.cframe.isData()){\r\n\t\tfor(var i = 0; i<this.values.length; i++){\r\n\t\t\tthis.values[i].reset();\r\n\t\t}\r\n\t\tthis.values = [];\r\n\t}\r\n\telse {\r\n\t\tvar nvals = [];\r\n\t\tfor(var i = 0; i<this.originalValues.length; i++){\r\n\t\t\tfor(var j = 0; j<this.values.length; j++){\r\n\t\t\t\tthis.values[j].reset();\r\n\t\t\t\tif(this.values[j].subject() == this.originalValues[i]){\r\n\t\t\t\t\tnvals.push(this.values[j]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.values = nvals;\r\n\t}\r\n\tthis.redraw();\t\r\n\tthis.parent.childUpdated();\r\n}\r\n\r\nPropertyRenderer.prototype.deletePropertyValue = function(value, index){\r\n\tthis.parent.objframe.removePropertyValue(this.property(), value, index);\r\n\tvar nvals = [];\r\n\tfor(var i = 0; i<this.values.length; i++){\r\n\t\tif(typeof index == \"undefined\"){\r\n\t\t\tif(this.values[i].subject() == value){\r\n\t\t\t\tthis.values[i].reset();\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tnvals.push(this.values[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if(i != index){\r\n\t\t\tthis.values[i].index = nvals.length;\r\n\t\t\tnvals.push(this.values[i]);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.values[i].reset();\r\n\t\t}\r\n\t}\r\n\tthis.values = nvals;\r\n\tthis.parent.childUpdated();\r\n\tthis.parent.redraw();\r\n}\r\n\r\nPropertyRenderer.prototype.addPropertyValue = function(value){\r\n\tthis.updated();\r\n\treturn this.parent.objframe.addPropertyValue(this.property(), value);\r\n}\r\n\r\n/*\r\n * Checks to see if an action (add, clone, delete) which affects the cardinality of the property is allowed by cardinality rules.\r\n */\r\nPropertyRenderer.prototype.cardControlAllows = function(action){\r\n\tif(this.cframe.hasRestriction()){\r\n\t\tvar rest = this.cframe.restriction;\r\n\t\tvar currentnum = this.values.length;\r\n\t\tif(action == \"add\" || action == \"clone\"){\r\n\t\t\tif(rest.max && currentnum >= rest.max){\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(action == \"delete\" && (rest.min)){\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nPropertyRenderer.prototype.isNew = function(){\r\n\tif(this.new_property){\r\n\t\treturn true;\r\n\t}\r\n\treturn this.parent.isNew();\r\n}\r\n\r\nPropertyRenderer.prototype.setNew = function(){\r\n\tthis.new_property = true;\r\n}\r\n\r\n\r\nPropertyRenderer.prototype.isUpdated = function(){\r\n\tif(this.values.length != this.originalValues.length) return true;\r\n\tfor(var i = 0 ; i < this.values.length; i++){\r\n\t\tif(this.cframe && this.cframe.isData()){\r\n\t\t\tif(this.values[i].value() != this.originalValues[i]){\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tif(this.values[i].subject() != this.originalValues[i]) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\tif(this.values[i].isUpdated()) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nPropertyRenderer.prototype.childUpdated = function(){\r\n\tthis.viewer.redrawHeader();\r\n\tif(this.parent) this.parent.childUpdated();\r\n}\r\n\r\n\r\n/**\r\n * Sets mode of viewer to either \"view\" or \"edit\"\r\n */\r\nPropertyRenderer.prototype.setMode = function(mode){\r\n\tthis.mode = mode;\r\n\tfor(var i = 0; i<this.values.length; i++){\r\n\t\tthis.values[i].setMode(mode);\r\n\t}\r\n\tthis.redraw();\r\n}\r\n\r\n/*\r\n * Jump to property value\r\n */\r\nPropertyRenderer.prototype.getViewableValues = function(){\r\n\tvar viewables = [];\r\n\tif(this.cframe && this.cframe.isData())\r\n\tfor(var i = 0; i<this.values.length; i++){\r\n\t\tvar sum = this.values[i].getSummary();\r\n\t\tvar lab = sum.long;\r\n\t\tviewables.push({label: lab, value: i});\r\n\t}\r\n\treturn viewables;\r\n}\r\n\r\nPropertyRenderer.prototype.hideDisabledControls = function(){\r\n\treturn this.hide_disabled_controls;\r\n}\r\n\r\nPropertyRenderer.prototype.setFacet = function(facet, nocascade){\r\n\tthis.facet = facet;\r\n\tif(!nocascade){\r\n\t\tfor(var i = 0; i<this.values.length; i++){\r\n\t\t\tthis.values[i].parentFacetChange(facet);\r\n\t\t}\r\n\t}\r\n\tthis.redraw();\r\n}\r\n\r\nPropertyRenderer.prototype.parentFacetChange = function(facet){\r\n\tif(facet == 'page'){\r\n\t\tif(!(this.facet == \"page\" || this.facet == \"multiline\")){\r\n\t\t\tthis.setFacet('multiline');\r\n\t\t}\r\n\t}\r\n\tif(facet == 'line'){\r\n\t\tthis.setFacet(\"label\");\r\n\t}\r\n\t\t\r\n}\r\n\r\n\r\n\r\nPropertyRenderer.prototype.getDefaultFacets = function(){\r\n\tvar defs = {\r\n\t\tpage: {\r\n\t\t\tlabel: \"Full Page\", value: \"page\", \r\n\t\t\tfeatures: [\"facet\", \"label\", \"comment\", \"id\", \"control\", \"type\", \"cardinality\", \"body\", \"status\", \"facet\", \"view\", \"viewer\"], \r\n\t\t\tcontrols: [\"delete\", \"clone\", \"add\", \"reset\", \"cancel\", \"update\", \"mode\", \"show\", \"hide\"]\r\n\t\t},\r\n\t\tmultiline: {\r\n\t\t\tlabel: \"Multiple Lines\", value: \"multiline\",\r\n\t\t\tfeatures: [\"facet\", \"label\", \"comment\", \"id\", \"control\", \"type\", \"cardinality\", \"body\", \"status\", \"facet\", \"view\", \"viewer\"], \r\n\t\t\tcontrols: [\"delete\", \"clone\", \"add\", \"reset\", \"cancel\", \"update\", \"mode\", \"show\", \"hide\"]\r\n\t\t},\r\n\t\tline: {\r\n\t\t\tlabel: \"Single Line\", value: \"line\",\r\n\t\t\tfeatures: [\"facet\", \"label\", \"comment\", \"id\", \"control\", \"type\", \"cardinality\", \"body\", \"status\", \"facet\", \"viewer\"], \r\n\t\t\tcontrols: [\"delete\", \"clone\", \"add\", \"reset\", \"cancel\", \"update\", \"mode\", \"show\", \"hide\"]\r\n\t\t},\r\n\t\tsummary: {\r\n\t\t\tlabel: \"Summary\", value: \"summary\",\r\n\t\t\tfeatures: [\"facet\", \"satus\", \"label\", \"type\", \"cardinality\", \"body\", \"status\", \"facet\", \"viewer\"], \r\n\t\t\tcontrols: [] \r\n\t\t},\r\n\t\tlabel: {\r\n\t\t\tlabel: \"Label\", value: \"label\",\r\n\t\t\tfeatures: [\"facet\", \"status\", \"label\", \"summary\"],\r\n\t\t\tcontrols: []\r\n\t\t},\r\n\t\ticon: {\r\n\t\t\tlabel: \"Snippet\", value: \"icon\",\r\n\t\t\tfeatures: [\"facet\", \"summary\"],\r\n\t\t\tcontrols: []\r\n\t\t}\r\n\t}\r\n\treturn defs;\t\r\n}\r\n\r\nPropertyRenderer.prototype.getAvailableFacets = function(){\r\n\treturn Object.values(this.facets);\r\n\tvar facets = [];\r\n\tfacets.push({label: \"Full Page\", value: \"page\"});\r\n\tfacets.push({label: \"Multiple Lines\", value: \"multiline\"});\r\n\tfacets.push({label: \"Single Line\", value: \"line\"});\r\n\tfacets.push({label: \"Summary\", value: \"summary\"});\r\n\tfacets.push({label: \"Label\", value: \"label\"});\r\n\tfacets.push({label: \"Snippet\", value: \"icon\"});\r\n\treturn facets;\r\n}\r\n\r\nPropertyRenderer.prototype.getContentOrientation = function(facet){\r\n\tif(this.currentFacet() == \"page\" || this.containsPage()){\r\n\t\treturn \"page\";\r\n\t}\r\n\tif(this.currentFacet() == \"line\" || this.currentFacet() == \"multiline\" || this.currentFacet() == \"summary\"){\r\n\t\treturn \"line\";\r\n\t}\r\n\treturn \"label\";\r\n}\r\n\r\n\r\nPropertyRenderer.prototype.getDefaultFacet = function(){\r\n\tif(this.cframe && this.cframe.isObject()){\r\n\t\treturn \"page\";\r\n\t}\r\n\treturn \"multiline\";\r\n}\r\n\r\n/*\r\n * Viewers for specific properties\r\n */\r\n\r\nPropertyRenderer.prototype.hide = function(){\r\n\tthis.setView(\"hidden\");\r\n}\r\n\r\nPropertyRenderer.prototype.show = function(){\r\n\tthis.setView(\"full\");\r\n}\r\n\r\nPropertyRenderer.prototype.setView = function(view){\r\n\tthis.view = view;\r\n\tthis.redraw();\r\n}\r\n\r\nPropertyRenderer.prototype.getAvailableViewers = function(){\r\n\tif(this.mode == \"view\"){\r\n\t\treturn TerminusDashboard.RenderingMap.getAvailablePropertyViewers(this);\t\t\r\n\t}\r\n\treturn TerminusDashboard.RenderingMap.getAvailablePropertyEditors(this);\t\t\t\t\r\n}\r\n\r\nPropertyRenderer.prototype.nukeViewer = function(){\r\n\tthis.viewer.remove();\r\n}\r\n\r\nPropertyRenderer.prototype.containsPage = function(){\r\n\t//collapsed facets do not show their values\r\n\tif(this.currentFacet() == \"icon\" || this.currentFacet() == \"label\") return false;\r\n\tfor(var i = 0; i<this.values.length; i++){\r\n\t\tif(this.values[i].facet == \"page\") {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nPropertyRenderer.prototype.getViewerForProperty = function(ptype){\r\n\tif(this.mode == \"edit\"){\r\n\t\treturn new PropertyViewer.HTMLPropertyViewer(this);\r\n\t}\r\n\treturn new PropertyViewer.HTMLPropertyViewer(this);\r\n}\r\n\r\nPropertyRenderer.prototype.getPropertyHeaderViewer = function(){\r\n\treturn new PropertyViewer.HTMLPropertyHeaderViewer();\r\n}\r\n\r\nPropertyRenderer.prototype.getSummary = function(){\r\n\tvar status = \"ok\";\r\n\tif(this.isNew()) status = \"new\";\r\n\telse if(this.isUpdated()) status = \"updated\";\r\n\tvar ret = {\r\n\t\tstatus: status,\r\n\t\tvalcount: this.values.length\r\n\t};\r\n\tret.long = ((ret.valcount != 1) ? \"(\" + ret.valcount + \") \" : \"\");\r\n\tfor(var i = 0; i<this.values.length; i++){\r\n\t\tvsum = this.values[i].getSummary();\r\n\t\tret.long += vsum.long;\r\n\t\tif(i < this.values.length-1) ret.long += \", \";\r\n\t}\r\n\treturn ret;\t\r\n}\r\n\r\nPropertyRenderer.prototype.getFeaturesForFacet = function(facet){\r\n\treturn this.facets[facet].features.concat(this.facets[facet].controls);\r\n}\r\n \r\nPropertyRenderer.prototype.showFeature = function(which){\r\n\tif(this.features.indexOf(which) == -1 && this.controls.indexOf(which) == -1) {\r\n\t\treturn false;\r\n\t}\r\n\tvar cardcontrols = [\"delete\", \"clone\", \"add\"];\r\n\tif(cardcontrols.indexOf(which) != -1){\r\n\t\tif(!this.cardControlAllows(which)) return false;\r\n\t}\r\n\tvar updcontrols = [\"update\", \"reset\"];\r\n\tif(this.hideDisabledControls() && updcontrols.indexOf(which) != -1 ){\r\n\t\tif(!this.isUpdated()){\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\tif(which == 'hide' && this.view == \"hidden\") return false;\r\n\tif(which == 'show' && this.view != \"hidden\") return false;\r\n\tvar fets = this.getFeaturesForFacet(this.facet);\r\n\treturn (fets.indexOf(which) != -1);\r\n}\r\n\r\nfunction ObjectRenderer(obj, parent, options){\r\n\tthis.objframe = obj;\r\n\tthis.parent = parent;\r\n\tthis.properties = {};\r\n\tthis.originalProperties = false;\r\n\tthis.newProperties = [];\r\n\tthis.renderer_type = \"object\";\r\n\tthis.options = this.setOptions(options);\r\n}\r\n\r\n//options has to include mode, viewer, facet, controls, features, hide_disabled_controls\r\n\r\nObjectRenderer.prototype.setOptions = function(options){\r\n\treturn TerminusDashboard.RenderingMap.decorateRenderer(options, this);\r\n}\r\n\r\nObjectRenderer.prototype.getOptionsForProperty = function(prop){\r\n\treturn this.options;\r\n}\r\n\r\nObjectRenderer.prototype.render = function(viewer){\r\n\tthis.buildPropertyRenderers();\r\n\tthis.viewer = (viewer ? viewer: this.getViewerForObject());\r\n\tfor(var prop in this.properties){\r\n\t\tvar renderedprop = this.properties[prop].render();\r\n\t\tif(renderedprop && this.showFeature(\"body\")) this.viewer.addRenderedProperty(prop, renderedprop);\r\n\t}\r\n\treturn this.viewer.render(this.view);\r\n}\r\n\r\nObjectRenderer.prototype.buildPropertyRenderers = function(){\r\n\tvar props = this.getPropertiesToRender();\r\n\tif(this.originalProperties === false) this.originalProperties = props;\r\n\tvar renders = {};\r\n\tfor(var j = 0; j<props.length; j++){\r\n\t\tif(typeof this.properties[props[j]] == \"undefined\"){\r\n\t\t\trenders[props[j]] = new PropertyRenderer(props[j], this, this.getOptionsForProperty(props[j]));\r\n\t\t}\r\n\t\telse {\r\n\t\t\trenders[props[j]] = this.properties[props[j]];\r\n\t\t}\r\n\t\tif(this.newProperties.indexOf(props[j]) != -1) {\r\n\t\t\trenders[props[j]].setNew(); \r\n\t\t\trenders[props[j]].mode = \"edit\"; \r\n\t\t}\r\n\t}\r\n\tthis.properties = renders;\r\n}\r\n\r\nObjectRenderer.prototype.subject = function(){\r\n\tif(this.objframe) return this.objframe.subjid;\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.subjectClass = function(){\r\n\tif(this.objframe) return this.objframe.cls;\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.getAvailableViewers = function(){\r\n\t//if(this.mode == \"view\"){\r\n\t//\treturn RenderingMap.getAvailableObjectViewers(this);\t\t\r\n\t//}\r\n\t//return RenderingMap.getAvailableObjectEditors(this);\t\t\t\t\r\n\treturn [\"html\", \"json\"];\r\n}\r\n\r\nObjectRenderer.prototype.depth = function(){\r\n\tif(this.parent) return (this.parent.depth() + 1);\r\n\treturn 0;\r\n}\r\n\r\n\r\nObjectRenderer.prototype.property = function(){\r\n\tif(this.parent) return this.parent.property();\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.parentObject = function(){\r\n\tif(this.parent && this.parent.parent && this.parent.parent.objframe){\r\n\t\treturn this.parent.parent.objframe;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.root = function(){\r\n\tif(this.parent) return false;\r\n\treturn true;\r\n}\r\n\r\nObjectRenderer.prototype.load = function(link){\r\n\tvar self = this;\r\n\tif(this.controller){\r\n\t\tthis.controller.ui.showDocument(link);\r\n\t}\r\n\telse if(this.parent) {\r\n\t\tthis.parent.load(link);\r\n\t}\r\n}\r\n\r\nObjectRenderer.prototype.copy = function(nkid){\r\n\tnkid = (nkid ? nkid : this.objframe);\r\n\tvar other = new ObjectRenderer(nkid, this.parent, this.options);\r\n\treturn other;\r\n}\r\n\r\nObjectRenderer.prototype.clone = function(){\r\n\tif(this.root()){\r\n\t\tthis.objframe = this.objframe.clone(\"_:\");\r\n\t\tthis.objframe.newDoc = true;\r\n\t\tthis.setMode(\"edit\");\r\n\t}\r\n\telse {\r\n\t\tvar nkid = this.objframe.clone(TerminusClient.FrameHelper.genBNID());\r\n\t\tvar parentobj = this.parentObject();\r\n\t\tvar prop = this.property();\r\n\t\tif(parentobj && prop){\r\n\t\t\tif(typeof parentobj.children[prop] == \"undefined\"){\r\n\t\t\t\tparentobj.children[prop] = [];\r\n\t\t\t}\r\n\t\t\tparentobj.children[prop].push(nkid);\r\n\t\t\tvar newrend = this.copy(nkid);\r\n\t\t\tthis.parent.values.push(newrend);\r\n\t\t}\r\n\t\tthis.parent.redraw();\r\n\t}\r\n}\r\n\r\nObjectRenderer.prototype.cancel = function(){\r\n\tthis.reset();\r\n\tthis.setMode(\"view\");\r\n}\r\n\r\nObjectRenderer.prototype.save = function(){\r\n\tif(this.controller){\r\n\t\tif(this.isNewDocument()){\r\n\t\t\tvar demandid = this.inputID();\r\n\t\t\tif(demandid == \"_:\") demandid = \"\";\r\n\t\t\tthis.controller.createDocument(demandid);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.controller.updateDocument();\r\n\t\t}\r\n\t}\r\n\telse if(this.parent) {\r\n\t\tthis.parent.save();\r\n\t}\r\n}\r\n\r\nObjectRenderer.prototype.delete = function(){\r\n\tvar dval = this.subject();\r\n\tif(this.controller && this.root()){\r\n\t\tif(!this.isNewDocument()){\r\n\t\t\tthis.controller.deleteDocument(dval);\r\n\t\t}\r\n\t\tthis.nukeViewer();\r\n\t}\r\n\telse {\r\n\t\tif(this.parent){\r\n\t\t\tthis.parent.deletePropertyValue(dval);\t\t\r\n\t\t\tthis.parent.redraw();\r\n\t\t}\r\n\t}\r\n}\r\n\r\nObjectRenderer.prototype.reset = function(){\r\n\tthis.objframe.reset();\r\n\tvar nprops = {};\r\n\tfor(var i = 0; i<this.originalProperties.length; i++){\r\n\t\tvar prop = this.originalProperties[i];\r\n\t\tif(typeof this.properties[prop] == \"object\"){\r\n\t\t\tthis.properties[prop].reset();\r\n\t\t\tnprops[prop] = this.properties[prop];\r\n\t\t}\r\n\t}\r\n\tthis.properties = nprops;\r\n\tthis.redraw();\r\n}\r\n\r\nObjectRenderer.prototype.deleteProperty = function(prop){\r\n\tthis.objframe.removeProperty(prop);\r\n\tdelete(this.properties[prop]);\r\n\tthis.updated();\r\n}\r\n\r\nObjectRenderer.prototype.addProperty = function(prop){\r\n\tthis.objframe.addProperty(prop);\r\n\tthis.updated();\r\n\tthis.redraw();\r\n}\r\n\r\nObjectRenderer.prototype.addNewProperty = function(prop){\r\n\tthis.objframe.addProperty(prop);\r\n\tthis.updated();\r\n\tthis.newProperties.push(prop);\r\n\tthis.redraw();\r\n\tthis.goToProperty(prop);\r\n}\r\n\r\nObjectRenderer.prototype.addPropertyClass = function(prop, cls){\r\n\tthis.objframe.addProperty(prop, cls);\r\n\tthis.updated();\r\n}\r\n\r\nObjectRenderer.prototype.changeClass = function(cls){\r\n\tif(this.parent){\r\n\t\tthis.parent.addClass(cls);\t\t\r\n\t\tthis.parent.deletePropertyValue(this.subject());\t\t\r\n\t}\r\n}\r\n\r\nObjectRenderer.prototype.getClassMeta = function(cls){\r\n\tvar ctl = this.getController();\r\n\tif(ctl && ctl.classmeta && ctl.classmeta[cls]){\r\n\t\treturn ctl.classmeta[cls];\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.getController = function(){\r\n\tif(this.controller){\r\n\t\treturn this.controller;\r\n\t}\r\n\tif(this.parent && this.parent.parent){\r\n\t\treturn this.parent.parent.getController();\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.getClient = function(){\r\n\tif(this.controller){\r\n\t\treturn this.controller.getClient();\r\n\t}\r\n\telse {\r\n\t\tif(this.parent && this.parent.parent){\r\n\t\t\treturn(this.parent.parent.getClient())\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.inputID = function(){\r\n\tif(this.idDOM){\r\n\t\treturn this.idDOM.value;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.isNew = function(){\r\n\tif(this.new_object){\r\n\t\treturn true;\r\n\t}\r\n\tif(this.isPartOfNewDocument()){\r\n\t\treturn true;\r\n\t}\r\n\tif(this.parent) return this.parent.isNew();\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.setNew = function(){\r\n\tthis.new_object = true;\r\n}\r\n\r\nObjectRenderer.prototype.isUpdated = function(){\r\n\tvar i = 0;\r\n\tfor(var prop in this.properties){\r\n\t\tif(this.originalProperties[i] != prop) return true;\r\n\t\tif(this.properties[prop].isUpdated()) return true;\r\n\t\ti++;\t\t\r\n\t}\r\n\tif(i != this.originalProperties.length) return true;\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.childUpdated = function(){\r\n\tthis.viewer.redrawHeader();\r\n\tif(this.parent) this.parent.childUpdated();\r\n}\r\n\r\nObjectRenderer.prototype.updated = ObjectRenderer.prototype.childUpdated;\r\n\r\nObjectRenderer.prototype.isNewDocument = function(){\r\n\tif(this.root() && this.objframe.isnew()) return true;\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.isPartOfNewDocument = function(){\r\n\tif(this.isNewDocument()) return true;\r\n\tif(this.parent && this.parent.parent){\r\n\t\treturn this.parent.parent.isPartOfNewDocument();\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.setFacet = function(facet, nocascade){\r\n\tthis.facet = facet;\r\n\tif(!nocascade){\r\n\t\tfor(var prop in this.properties){\r\n\t\t\tthis.properties[prop].parentFacetChange(facet);\r\n\t\t}\r\n\t}\r\n\tif(this.parent){\r\n\t\tthis.parent.redraw();\r\n\t}\r\n\telse {\r\n\t\tthis.redraw();\r\n\t}\r\n}\r\n\r\nObjectRenderer.prototype.getDefaultFacets = function(){\r\n\tvar defs = {\r\n\t\tpage: {\r\n\t\t\tlabel: \"Full Page\", value: \"page\", \r\n\t\t\tfeatures: [\"facet\", \"label\", \"comment\", \"id\", \"control\", \"type\", \"body\", \"status\", \"facet\", \"view\", \"viewer\"],\r\n\t\t\tcontrols: [\"delete\", \"clone\", \"add\", \"reset\", \"cancel\", \"update\", \"mode\", \"show\", \"hide\"] \r\n\t\t},\r\n\t\tline: {\r\n\t\t\tlabel: \"Single Line\", value: \"line\",\r\n\t\t\tfeatures: [\"facet\", \"label\", \"comment\", \"id\", \"type\", \"body\", \"status\", \"facet\"], \r\n\t\t\tcontrols: [] \r\n\t\t},\r\n\t\tsummary: {\r\n\t\t\tlabel: \"Summary\", value: \"summary\",\r\n\t\t\tfeatures: [\"facet\", \"satus\", \"label\", \"type\", \"summary\", \"status\", \"facet\"], \r\n\t\t\tcontrols: [] \r\n\t\t},\r\n\t\tlabel: {\r\n\t\t\tlabel: \"Label\", value: \"label\",\r\n\t\t\tfeatures: [\"facet\", \"status\", \"label\"],\r\n\t\t\tcontrols: []\r\n\t\t}\r\n\t}\r\n\treturn defs;\r\n}\r\n\r\nObjectRenderer.prototype.getAvailableFacets = function(){\r\n\treturn Object.keys(this.facets);\r\n}\r\n\r\nObjectRenderer.prototype.currentFacet = function(){\r\n\treturn this.facet;\r\n}\r\n\r\nObjectRenderer.prototype.getDefaultFacet = function(){\r\n\tif(!this.parent) return \"page\";\r\n\tvar pfacet = this.parent.currentFacet();\r\n\tif(pfacet == \"page\"){\r\n\t\treturn \"page\";\r\n\t}\r\n\tif(pfacet == \"multiline\") return \"line\";\r\n\tif(pfacet == \"line\") return \"summary\";\r\n\treturn \"label\";\r\n}\r\n\r\nObjectRenderer.prototype.parentFacetChange = function(pfacet){\r\n\tif(pfacet == \"page\") this.setFacet(\"page\");\r\n\tif(pfacet == \"multiline\") this.setFacet(\"summary\");\r\n\tif(pfacet == \"line\") this.setFacet(\"summary\");\r\n\tif(pfacet == \"summary\") this.setFacet(\"summary\");\r\n}\r\n\r\nObjectRenderer.prototype.getContentOrientation = function(){\r\n\tif(this.currentFacet() == \"page\"){\r\n\t\treturn \"page\";\r\n\t}\r\n\tif(this.currentFacet() == \"line\"){\r\n\t\treturn \"line\";\r\n\t}\r\n\treturn \"label\";\r\n}\r\n\r\nObjectRenderer.prototype.getLabel = function(){\r\n\tfor(var prop in this.properties){\r\n\t\tif(TerminusClient.FrameHelper.getShorthand(prop) == \"rdfs:label\" || prop == \"rdfs:label\"){\r\n\t\t\tvar prend = this.properties[prop];\r\n\t\t\tvar vrend = prend.values[0];\r\n\t\t\tif(vrend){\r\n\t\t\t\tvar sum = vrend.getSummary();\r\n\t\t\t\tif(sum.long != \"empty\") return sum.long;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tvar s = this.subject();\r\n\tif(s && s.substring(0, 2) == \"_:\"){\r\n\t\tvar ty = this.subjectClass();\r\n\t\tvar sh = TerminusClient.FrameHelper.getShorthand(ty);\r\n\t\tif(!sh) sh = ty;\r\n\t\tvar b = sh.split(\":\");\r\n\t\tif(b.length > 1){\r\n\t\t\treturn \"New \" + b[1];\r\n\t\t}\r\n\t\treturn \"New Object\";\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.getSummary = function(){\r\n\tvar ret = { status: \"ok\" };\r\n\tif(this.isUpdated()) ret.status = \"updated\";\r\n\tif(this.isNew()) ret.status = \"new\";\r\n\tret.propcount = 0;\r\n\tfor(var prop in this.properties){\r\n\t\tret.propcount++;\r\n\t}\r\n\tret.long = ret.propcount + \" properties\";\r\n\treturn ret;\t\r\n}\r\n\r\nObjectRenderer.prototype.getObjectHeaderViewer = function(){\r\n\treturn this.header_viewer;\r\n}\r\n\r\nObjectRenderer.prototype.getViewerForObject = function(format){\r\n\tif(format == \"json\"){\r\n\t\treturn new ObjectViewer.JSONObjectViewer(this);\r\n\t}\r\n\treturn new ObjectViewer.HTMLObjectViewer(this);\r\n}\r\n\r\nObjectRenderer.prototype.getFeaturesForFacet = function(facet){\r\n\treturn this.facets[facet].features.concat(this.facets[facet].controls);\r\n}\r\n \r\nObjectRenderer.prototype.hideDisabledControls = function(){\r\n\treturn this.hide_disabled_controls;\r\n}\r\n\r\nObjectRenderer.prototype.showFeature = function(which){\r\n\tif(this.features.indexOf(which) == -1 && this.controls.indexOf(which) == -1) {\r\n\t\treturn false;\r\n\t}\r\n\tvar cardcontrols = [\"delete\", \"clone\", \"add\"];\r\n\tif(cardcontrols.indexOf(which) != -1){\r\n\t\tif(!this.cardControlAllows(which)) return false;\r\n\t}\r\n\tvar updcontrols = [\"update\", \"reset\"];\r\n\tif(this.hideDisabledControls() && updcontrols.indexOf(which) != -1 ){\r\n\t\tif(!this.isUpdated()){\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\tif(this.isNewDocument() && which == \"clone\") return false;\r\n\tif(which == 'hide' && this.view == \"hidden\") return false;\r\n\tif(which == 'show' && this.view != \"hidden\") return false;\r\n\tvar fets = this.getFeaturesForFacet(this.facet);\r\n\tif (fets.indexOf(which) != -1){\r\n\t\treturn true;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nObjectRenderer.prototype.cardControlAllows = function(action){\r\n\tif(!this.parent) return true;\r\n\tif(this.parent.cframe.hasRestriction()){\r\n\t\tvar rest = this.parent.cframe.restriction;\r\n\t\tvar currentnum = this.parent.values.length;\r\n\t\tif(action == \"add\" || action == \"clone\"){\r\n\t\t\tif(rest.max && currentnum >= rest.max){\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(action == \"delete\" && (rest.min && currentnum <= rest.min)){\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nObjectRenderer.prototype.goToProperty = function(prop){\r\n\tthis.viewer.goTo(this.subject(), prop);\r\n}\r\n\r\nObjectRenderer.prototype.setMode = function(mode){\r\n\tthis.mode = mode;\r\n\tfor(var prop in this.properties){\r\n\t\tthis.properties[prop].setMode(mode);\r\n\t}\r\n\tthis.viewer.redraw();\r\n}\r\n\r\nObjectRenderer.prototype.currentViewer = function(){return this.viewerType;}\r\n\r\n\r\nObjectRenderer.prototype.setViewer = function(viewer){\r\n\tvar nviewer = this.getViewerForObject(viewer);\r\n\tif(nviewer){\r\n\t\tthis.viewerType = viewer;\r\n\t\tthis.viewer = nviewer;\r\n\t\tthis.viewer.redraw();\r\n\t}\r\n}\r\n\r\n\r\nObjectRenderer.prototype.setView = function(view){\r\n\tvar views = {\r\n\t\t\"full\": {\r\n\t\t\t\r\n\t\t},\r\n\t\t\"hidden\": {\r\n\t\t\t\r\n\t\t}\r\n\t};\r\n\tthis.view = view;\r\n\tthis.viewer.redraw();\r\n}\r\n\r\n\r\nObjectRenderer.prototype.hide = function(){\r\n\tthis.setView(\"hidden\");\r\n}\r\n\r\nObjectRenderer.prototype.show = function(){\r\n\tthis.setView(\"full\");\r\n}\r\n\r\nObjectRenderer.prototype.nukeViewer = function(){\r\n\tthis.viewer.remove();\r\n}\r\n\r\nObjectRenderer.prototype.getViewableProperties = function(){\r\n\treturn this.objframe.getFilledPropertyList();\t\r\n}\r\n\r\nObjectRenderer.prototype.getAddableProperties = function(){\r\n\tvar props = this.objframe.getMissingPropertyList();\t\r\n\treturn props;\r\n}\r\n\r\nObjectRenderer.prototype.getPropertiesToRender = function(options){\r\n\tvar sort = this.standardSort;\r\n\tvar filter = function(){return true};\r\n\tif(options && options.map && options.map.patterns){\r\n\t\t/*for(var i = 0; i<options.map.patterns.length; i++){\r\n\t\t\tif(this.objframe.matchesPattern({property: this.property(), action: \"sort\"}, options.map.patterns[i])){\r\n\t\t\t\tsort = options.map.patterns[i].sort;\r\n\t\t\t}\r\n\t\t\tif(this.objframe.matchesPattern({property: this.property(), action: \"filter\"}, options.map.patterns[i])){\r\n\t\t\t\tfilter = options.map.patterns[i].filter;\r\n\t\t\t}\r\n\t\t}*/\r\n\t}\r\n\treturn sort(this.objframe, filter);\r\n}\r\n\r\nObjectRenderer.prototype.standardSort = function(objframe, filter){\r\n\tvar sorted = [];\r\n\tvar rdft = TerminusClient.FrameHelper.getStdURL(\"rdfs\", \"label\");\r\n\tif(objframe.dataframes[rdft] && filter(objframe, rdft, objframe.dataframes[rdft])){\r\n\t\tsorted.push(rdft);\r\n\t}\r\n\tvar rdfc = TerminusClient.FrameHelper.getStdURL(\"rdfs\", \"comment\");\r\n\tif(objframe.dataframes[rdfc]){\r\n\t\tsorted.push(rdfc);\r\n\t}\r\n\tfor(var prop in objframe.dataframes){\r\n\t\tif(sorted.indexOf(prop) == -1) sorted.push(prop);\r\n\t}\r\n\tfor(var prop in objframe.children){\r\n\t\tif(sorted.indexOf(prop) == -1) sorted.push(prop);\t\t\r\n\t}\r\n\treturn sorted;\r\n}\r\n\r\n\r\nObjectRenderer.prototype.redraw = function(){\r\n\tthis.viewer.clear();\r\n\tthis.render(this.viewer);\r\n}\r\n\r\nObjectRenderer.prototype.extractLDO = function(extracts){\r\n\textracts[\"rdf:type\"] = this.objframe.cls;\r\n\tvar full = {};\r\n\tfull[this.subject()] = extracts;\r\n\treturn full;\t\r\n}\r\n\r\nObjectRenderer.prototype.extractJSONLD = function(extracts){\r\n\textracts[\"@type\"] = this.objframe.cls;\r\n\tif(this.subject() != \"_:\")\textracts[\"@id\"] = this.subject();\r\n\tif(this.objframe.jsonld_context) extracts['@context'] = this.objframe.jsonld_context;\r\n\treturn extracts;\r\n}\r\n\r\nObjectRenderer.prototype.extract = function(){\r\n\tvar extracts = {};\r\n\tfor(var i in this.properties){\r\n\t\tvar extracted = this.properties[i].extract();\r\n\t\tif(!TerminusClient.FrameHelper.empty(extracted)){\r\n\t\t\textracts[i] = extracted;\r\n\t\t}\r\n\t}\r\n\tif(TerminusClient.FrameHelper.empty(extracts) && this.parent){\r\n\t\treturn false;\r\n\t}\r\n\telse {\r\n\t\tvar ext = this.extractJSONLD(extracts);\r\n\t\treturn ext;\r\n\t\t//return this.extractLDO(extracts);\r\n\t}\r\n}\r\n\r\nmodule.exports={ObjectRenderer,PropertyRenderer}\r\n\r\n","\r\n\r\nfunction HTMLStringEditor(options){\r\n\tthis.css = ((options && options.css) ? \"terminus-literal-value \" + options.css : \"terminus-literal-value\");\r\n\tthis.options = options; \r\n}\r\n\r\nHTMLStringEditor.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar ty = TerminusClient.FrameHelper.getShorthand(renderer.frame.getType());\r\n\tty = (ty ? ty : renderer.frame.getType());\r\n\tvar value = renderer.value();\r\n\tvar big = ((this.options && typeof this.options.big != \"undefined\") ? this.options.big : this.isBigType(ty, value));\r\n\tif(big){\r\n\t\tvar input = document.createElement(\"textarea\");\r\n\t\tthis.css += \" terminus-literal-big-value\";\t\t\r\n\t}\r\n\telse {\r\n\t\tvar size = ((this.options && typeof this.options.size != \"undefined\") ? this.options.size : this.getTypeSize(ty, value));\r\n\t\tvar input = document.createElement(\"input\");\r\n\t\tinput.setAttribute('type', \"text\");\r\n\t\tinput.setAttribute('size', size);\r\n\t}\r\n\tinput.setAttribute('class', this.css);\r\n\tinput.value = value;\r\n\tvar self = this;\r\n\tinput.addEventListener(\"input\", function(){\r\n\t\trenderer.set(this.value);\r\n\t});\r\n\treturn input;\r\n}\r\n\r\nHTMLStringEditor.prototype.isBigType = function(ty, value){\r\n\tif(value && value.length && value.length > 100) return true;\r\n\tvar longs = [\"xdd:coordinatePolyline\", \"xdd:coordinatePolygon\", \"xsd:base64Binary\", \"xdd:html\", \"xdd:json\", \"rdf:XMLLiteral\"];\r\n\tif(longs.indexOf(ty) == -1) return false;\r\n\treturn true;\r\n}\r\n\r\nHTMLStringEditor.prototype.getTypeSize = function(ty, value){\r\n\tif(value && value.length && value.length > 40) return 80;\r\n\tvar bigs = [\"xdd:url\", \"xdd:coordinate\", \"xsd:anyURI\"];\r\n\tvar smalls = [\"xsd:gYearMonth\", \"xdd:gYearRange\", \"xsd:decimal\", \"xsd:float\", \"xsd:time\", \"xsd:date\", \r\n\t\t\"xsd:dateTimeStamp\",\"xsd:gYearMonth\", \"xsd:gMonthDay\", \"xsd:duration\", \"xsd:yearMonthDuration\", \"xsd:dayTimeDuration\", \r\n\t\t\"xsd:nonNegativeInteger\", \"xsd:positiveInteger\", \"xsd:negativeInteger\",\t\"xsd:nonPositiveInteger\", \"xsd:integer\",\"xsd:unsignedInt\"];\r\n\tvar tinys = [\"xsd:boolean\", \"xsd:gYear\", \"xsd:gMonth\", \"xsd:gDay\", \"xsd:byte\", \"xsd:short\", \"xsd:unsignedByte\", \"xsd:language\"];\r\n\tif(bigs.indexOf(ty) != -1) return 80;\r\n\tif(smalls.indexOf(ty) != -1) return 16;\r\n\tif(tinys.indexOf(ty) != -1) return 8;\r\n\treturn 32;\r\n}\r\n\r\nmodule.exports={HTMLStringEditor}\r\n\r\n\r\n","function HTMLBooleanViewer(options){\r\n\tthis.css = \"terminus-literal-value terminus-literal-value-range \" + ((options && options.css) ?  options.css : \"\");\r\n}\r\n\r\nHTMLBooleanViewer.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar value = renderer.value();\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', this.css);\r\n\tif(value){\r\n\t\tvar vallab = document.createTextNode(value);\r\n\t\tinput.appendChild(vallab);\r\n\t}\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={HTMLBooleanViewer}\r\n\r\n","function HTMLBooleanEditor(options){\r\n\tthis.css = \"terminus-literal-value terminus-literal-value-range \" + ((options && options.css) ?  options.css : \"\");\r\n}\r\n\r\nHTMLBooleanEditor.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar value = renderer.value();\r\n\tvar input = document.createElement(\"input\");\r\n\tinput.setAttribute('type', \"checkbox\");\r\n\tif(value){\r\n\t\tinput.setAttribute(\"checked\", \"checked\");\t\t\t\t\t\r\n\t}\r\n\tinput.addEventListener(\"change\", function(){\r\n\t\tif(value){\r\n\t\t\trenderer.set(\"\");\r\n\t\t}\r\n\t\telse {\r\n\t\t\trenderer.set(\"true\");\r\n\t\t}\r\n\t});\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={HTMLBooleanEditor}\r\n\r\n","function HTMLChoiceViewer(options){};\r\n\r\nHTMLChoiceViewer.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar value = renderer.value();\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', \"terminus-literal-value terminus-choice-value\");\r\n\tinput.setAttribute('data-value', value);\r\n\tif(value){\r\n\t\tvar els = renderer.frame.frame.elements;\r\n\t\tfor(var i = 0; i<els.length; i++){\r\n\t\t\tif(els[i].class == value){\r\n\t\t\t\tif(els[i].label && els[i].label[\"@value\"]){\r\n\t\t\t\t\tvar lab = els[i].label[\"@value\"];\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tlab = TerminusClient.FrameHelper.labelFromURL(value);\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t\tinput.appendChild(document.createTextNode(lab));\r\n\t\t\t\tcontinue;\r\n\t\t\t}\t\t\t\t\r\n\t\t}\r\n\t}\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={HTMLChoiceViewer}\r\n\r\n\r\n","const HTMLFrameHelper = require('../HTMLFrameHelper');\r\n\r\nfunction HTMLChoiceEditor(options){};\r\n\r\nHTMLChoiceEditor.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar value = renderer.value();\r\n\tvar optInput = document.createElement(\"select\");\r\n\toptInput.setAttribute('class', \"terminus-choice-picker\");\r\n\tvar foptions = renderer.frame.getChoiceOptions();\r\n\tfoptions.unshift({ value: \"\", label: \"Not Specified\"});\r\n\tvar callback = function(val){\r\n\t\trenderer.set(val);\r\n\t}\r\n\tvar sel = HTMLFrameHelper.getSelectionControl(\"select-choice\", foptions, value, callback);\r\n\treturn sel;\r\n}\r\n\r\nmodule.exports={HTMLChoiceEditor}\r\n\r\n","\r\nfunction HTMLCoordinateViewer(options){\r\n\tthis.inputs = [];\r\n}\r\n\r\nHTMLCoordinateViewer.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar ty = TerminusClient.FrameHelper.getShorthand(renderer.frame.getType());\r\n\tty = (ty ? ty : renderer.frame.getType());\r\n\tvar value = renderer.value();\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', \"terminus-literal-value terminus-literal-coordinate\");\r\n\tinput.setAttribute('data-value', value);\r\n\ttry {\r\n\t\tvar parsed = (value ? JSON.parse(value) : false);\r\n\t}\r\n\tcatch(e){\r\n\t\trenderer.badData(ty + \" failed to parse as json\", e.toString());\r\n\t\tvar parsed = false;\r\n\t\tvalue = false;\r\n\t}\r\n\tif(value){\r\n\t\tif(ty == \"xdd:coordinate\"){\r\n\t\t\tparsed = [parsed];\r\n\t\t}\r\n\t\tfor(var i = 0; i < parsed.length; i++){\r\n\t\t\tvar lldom = document.createElement(\"span\");\r\n\t\t\tlldom.setAttribute(\"class\", \"latlong\");\r\n\t\t\tlldom.appendChild(document.createTextNode(\"Latitude: \"));\r\n\t\t\tlldom.appendChild(document.createTextNode(parsed[i][0] + \" °\" + \" \"));\r\n\t\t\tlldom.appendChild(document.createTextNode(\"Longitude: \"));\r\n\t\t\tlldom.appendChild(document.createTextNode(parsed[i][1] + \" °\" ));\r\n\t\t\tinput.appendChild(lldom);\r\n\t\t}\r\n\t}\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={HTMLCoordinateViewer}\r\n\r\n","function HTMLCoordinateEditor(options){\r\n\tthis.inputs = [];\r\n}\r\n\r\nHTMLCoordinateEditor.prototype.getInputDOMs = function(lat, long, change){\r\n\tvar latdom = document.createElement(\"input\");\r\n\tlatdom.setAttribute(\"type\", \"text\");\r\n\tlatdom.value = lat;\r\n\tvar longdom = document.createElement(\"input\");\r\n\tlongdom.setAttribute(\"type\", \"text\");\r\n\tlongdom.value = long;\r\n\tlatdom.addEventListener(\"change\", change);\r\n\tlongdom.addEventListener(\"change\", change);\r\n\treturn [latdom, longdom];\r\n}\r\n\r\nHTMLCoordinateEditor.prototype.getLatLongDOM = function(lat, long, ty, index, parent){\r\n\tvar lldom = document.createElement(\"span\");\r\n\tlldom.setAttribute(\"class\", \"terminus-lat-long\");\r\n\tvar firstcol = document.createElement(\"span\");\r\n\tfirstcol.setAttribute(\"class\", \"terminus-lat-long-col\");\r\n\tlldom.appendChild(firstcol);\r\n\tif(index > 2 || (ty == \"xdd:coordinatePolyline\" && index > 1)){\r\n\t\tvar delbut = document.createElement(\"button\");\r\n\t\tdelbut.setAttribute(\"class\", \"delete-coordinate\");\r\n\t\tdelbut.appendChild(document.createTextNode(\"Remove\"));\r\n\t\tdelbut.addEventListener(\"click\", function(){\r\n\t\t\tlong.value = \"\";\r\n\t\t\tlat.value = \"\";\r\n\t\t\tparent.removeChild(lldom);\r\n\t\t});\r\n\t\tfirstcol.appendChild(delbut);\r\n\t}\r\n\tlldom.appendChild(document.createTextNode(\"Latitude: \"));\r\n\tlldom.appendChild(lat);\r\n\tlldom.appendChild(document.createTextNode(\" °\" + \" \"));\r\n\tlldom.appendChild(document.createTextNode(\"  Longitude: \"));\r\n\tlldom.appendChild(long);\r\n\tlldom.appendChild(document.createTextNode(\" ° \" ));\r\n\treturn lldom;\r\n}\r\n\r\n\r\nHTMLCoordinateEditor.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar ty = renderer.frame.getTypeShorthand();\r\n\tvar value = renderer.value();\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', \"terminus-literal-value terminus-literal-coordinate\");\r\n\tinput.setAttribute('data-value', value);\r\n\ttry {\r\n\t\tvar parsed = (value ? JSON.parse(value) : false);\r\n\t}\r\n\tcatch(e){\r\n\t\trenderer.badData(ty + \" failed to parse as json\", e.toString());\r\n\t\tvar parsed = false;\r\n\t\tvalue = false;\r\n\t}\r\n\tvar self = this;\r\n\tvar updateValueFromForm = function(){\r\n\t\tvar vals = [];\r\n\t\tfor(var i = 0; i<self.inputs.length; i++){\r\n\t\t\tif(self.inputs[i][0].value && self.inputs[i][1].value){\r\n\t\t\t\tvar val = \"[\" + self.inputs[i][0].value + \",\" + self.inputs[i][1].value + \"]\";\r\n\t\t\t\tvals.push(val);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(vals.length == 0){\r\n\t\t\trenderer.set(\"\");\r\n\t\t}\r\n\t\telse if(ty == \"xdd:coordinate\"){\r\n\t\t\trenderer.set(vals[0]);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tvar op = \"[\";\r\n\t\t\tfor(var i = 0; i<vals.length; i++){\r\n\t\t\t\top += vals[i];\r\n\t\t\t\tif(i+1 < vals.length) op += \",\";\r\n\t\t\t}\r\n\t\t\top += \"]\";\r\n\t\t\trenderer.set(op);\r\n\t\t}\r\n\t};\r\n\tif(!parsed){\r\n\t\tif(ty == \"xdd:coordinate\") parsed = [\"\",\"\"];\r\n\t\telse {\r\n\t\t\tparsed = [[\"\",\"\"],[\"\",\"\"]];\r\n\t\t\tif(ty == \"xdd:coordinatePolygon\") parsed.push([\"\",\"\"]);\r\n\t\t}\r\n\t}\r\n\tif(ty == \"xdd:coordinate\"){\r\n\t\tparsed = [parsed];\r\n\t}\r\n\tfor(var i = 0; i < parsed.length; i++){\r\n\t\tthis.inputs.push(this.getInputDOMs(parsed[i][0], parsed[i][1], updateValueFromForm))\r\n\t}\r\n\tvar lldoms = document.createElement(\"span\");\r\n\tfor(var i = 0; i < this.inputs.length; i++){\r\n\t\tvar lldom = this.getLatLongDOM(this.inputs[i][0], this.inputs[i][1], ty, i, lldoms);\r\n\t\tlldoms.appendChild(lldom);\r\n\t}\r\n\tinput.appendChild(lldoms);\r\n\tvar self = this;\r\n\tif(ty != \"xdd:coordinate\"){\r\n\t\tvar butspan = document.createElement(\"span\");\r\n\t\tbutspan.setAttribute(\"class\", \"terminus-add-coordinate\")\r\n\t\tvar addbut = document.createElement(\"button\");\r\n\t\taddbut.setAttribute(\"class\", \"terminus-add-coordinate\");\r\n\t\taddbut.appendChild(document.createTextNode(\"Add\"));\r\n\t\taddbut.addEventListener(\"click\", function(){\r\n\t\t\tvar ipdoms = self.getInputDOMs(\"\", \"\", updateValueFromForm);\r\n\t\t\tvar lldom = self.getLatLongDOM(ipdoms[0], ipdoms[1], ty, self.inputs.length, lldoms);\r\n\t\t\tlldoms.appendChild(lldom);\r\n\t\t\tself.inputs.push(ipdoms);\r\n\t\t});\r\n\t\tbutspan.appendChild(addbut);\r\n\t\tinput.appendChild(butspan);\t\t\t\r\n\t}\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={HTMLCoordinateEditor}","const DateHelper = require('./DateHelper');\r\n\r\nfunction HTMLDateViewer(options){\r\n\tthis.max = (options && options.max ? options.max : false);\r\n\tthis.min = (options && options.min ? options.min : false);\r\n\tthis.allowbce = (options && options.allowbce ? options.allowbce : false);\r\n\tthis.date_spacer = \"/\";\r\n\tthis.time_spacer = \":\";\r\n\tthis.datetime_separator = \", \";\r\n\tthis.helper = new DateHelper.HTMLDateHelper();\r\n}\r\n\r\nHTMLDateViewer.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar ty = TerminusClient.FrameHelper.getShorthand(renderer.frame.getType());\r\n\tty = (ty ? ty : renderer.frame.getType());\r\n\tvar value = renderer.value();\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', \"terminus-literal-value terminus-literal-date\");\r\n\tinput.setAttribute('data-value', value);\r\n\tif(value){\r\n\t\tvar parsed = TerminusClient.FrameHelper.parseDate(ty, value);\r\n\t\tvar datepart = this.getDateComponentDOM(parsed);\r\n\t\tvar timepart = this.getTimeComponentDOM(parsed);\r\n\t\tif(timepart) input.appendChild(timepart);\r\n\t\tif(timepart && datepart) input.appendChild(document.createTextNode(this.datetime_separator));\r\n\t\tif(datepart) input.appendChild(datepart);\r\n\t}\r\n\treturn input;\r\n}\r\n\r\nHTMLDateViewer.prototype.getTimeComponentDOM = function(parsed, ty){\r\n\tvar hdom = (parsed.hour ? document.createElement(\"span\") : false);\r\n\tif(hdom){\r\n\t\thdom.setAttribute(\"class\", \"terminus-time-hour\");\r\n\t\thdom.appendChild(document.createTextNode(parsed.hour));\r\n\t}\r\n\tvar mdom = (typeof parsed.minute != \"undefined\" ? document.createElement(\"span\") : false);\r\n\tif(mdom){\r\n\t\tmdom.setAttribute(\"class\", \"terminus-time-minute\");\r\n\t\tvar mlab = (parsed.minute < 10 ? parsed.minute : parsed.minute);\r\n\t\tmdom.appendChild(document.createTextNode(mlab));\r\n\t}\r\n\tvar sdom = (typeof parsed.second != \"undefined\" ? document.createElement(\"span\") : false);\r\n\tif(sdom){\r\n\t\tsdom.setAttribute(\"class\", \"terminus-time-second\");\r\n\t\tvar slab = (parsed.second < 10 ? parsed.second : parsed.second);\r\n\t\tsdom.appendChild(document.createTextNode(slab));\r\n\t}\r\n\tvar tz = (parsed.timezone ? document.createElement(\"span\") : false);\r\n\tif(tz){\r\n\t\tsdom.setAttribute(\"class\", \"terminus-time-timezone\");\r\n\t\tsdom.appendChild(document.createTextNode(parsed.timezone));\r\n\t}\r\n\tif(hdom || mdom || sdom || tz){\r\n\t\tvar dadom = document.createElement(\"span\");\r\n\t\tdadom.setAttribute(\"class\", \"terminus-time-components time-\"+ty);\r\n\t\tif(hdom) dadom.appendChild(hdom); \r\n\t\tif(mdom) {\r\n\t\t\tif(hdom) dadom.appendChild(document.createTextNode(this.time_spacer));\r\n\t\t\tdadom.appendChild(mdom); \r\n\t\t}\r\n\t\tif(sdom) {\r\n\t\t\tif(mdom || hdom) dadom.appendChild(document.createTextNode(this.time_spacer));\r\n\t\t\tdadom.appendChild(sdom); \r\n\t\t}\r\n\t\tif(tz){\r\n\t\t\tdadom.appendChild(document.createTextNode(\" (Timezone: \")); \r\n\t\t\tdadom.appendChild(sdom); \r\n\t\t\tdadom.appendChild(document.createTextNode(\")\")); \t\t\t\r\n\t\t}\r\n\t\treturn dadom;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nHTMLDateViewer.prototype.getDateComponentDOM = function(parsed, ty){\r\n\tvar ydom = (parsed.year ? document.createElement(\"span\") : false);\r\n\tif(ydom){\r\n\t\tydom.setAttribute(\"class\", \"terminus-date-year\");\r\n\t\tydom.appendChild(document.createTextNode(parsed.year));\r\n\t}\r\n\tvar mdom = (parsed.month ? document.createElement(\"span\") : false);\r\n\tif(mdom){\r\n\t\tmdom.setAttribute(\"class\", \"terminus-date-month\");\r\n\t\tmdom.appendChild(document.createTextNode(this.helper.getMonthName(parsed.month)));\t\t\r\n\t}\r\n\tvar ddom = (parsed.day ? document.createElement(\"span\") : false );\r\n\tif(ddom){\r\n\t\tddom.setAttribute(\"class\", \"terminus-date-day\");\r\n\t\tddom.appendChild(document.createTextNode(parsed.day));\t\t\r\n\t}\r\n\tif(ydom || mdom || ddom){\r\n\t\tvar dadom = document.createElement(\"span\");\r\n\t\tif(ddom) dadom.appendChild(ddom); \r\n\t\tif(mdom) {\r\n\t\t\tif(ddom) dadom.appendChild(document.createTextNode(this.date_spacer));\r\n\t\t\tdadom.appendChild(mdom); \r\n\t\t}\r\n\t\tif(ydom) {\r\n\t\t\tif(mdom || ddom) dadom.appendChild(document.createTextNode(this.date_spacer));\r\n\t\t\tdadom.appendChild(ydom); \r\n\t\t}\r\n\t\treturn dadom;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nmodule.exports={HTMLDateViewer}","const DateHelper = require('./DateHelper');\r\n\r\nfunction HTMLDateEditor(options){\r\n\tthis.max = (options && options.max ? options.max : false);\r\n\tthis.min = (options && options.min ? options.min : false);\r\n\tthis.allowbce = (options && options.allowbce ? options.allowbce : false);\r\n\tthis.date_spacer = \"/\";\r\n\tthis.time_spacer = \":\";\r\n\tthis.datetime_separator = \", \";\r\n\tthis.helper = new DateHelper.HTMLDateHelper();\r\n}\r\n\r\nHTMLDateEditor.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar ty = TerminusClient.FrameHelper.getShorthand(renderer.frame.getType());\r\n\tty = (ty ? ty : renderer.frame.getType())\r\n\tvar value = renderer.value();\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', \"terminus-literal-value terminus-literal-date\");\r\n\tinput.setAttribute('data-value', value);\r\n\tif(value){\r\n\t\tthis.parsed = TerminusClient.FrameHelper.parseDate(ty, value);\r\n\t}\r\n\telse this.parsed = {};\r\n\tvar datepart = this.getDateComponentDOM(this.parsed, ty, renderer);\r\n\tvar timepart = this.getTimeComponentDOM(this.parsed, ty, renderer);\r\n\tif(timepart) input.appendChild(timepart);\r\n\tif(timepart && datepart) input.appendChild(document.createTextNode(this.datetime_separator));\r\n\tif(datepart) input.appendChild(datepart);\r\n\treturn input;\r\n}\r\n\r\nHTMLDateEditor.prototype.set = function(part, val, renderer, ty){\r\n\tthis.parsed[part] = val;\r\n\tvar xsd = TerminusClient.FrameHelper.xsdFromParsed(this.parsed, ty);\r\n\tif(xsd){\r\n\t\trenderer.set(xsd);\r\n\t}\r\n}\r\n\r\nHTMLDateEditor.prototype.getTimeComponentDOM = function(parsed, ty, renderer){\r\n\tif([\"xsd:dateTime\", \"xsd:dateTimeStamp\", \"xsd:time\"].indexOf(ty) == -1){\r\n\t\treturn false;\r\n\t}\r\n\tvar self = this;\r\n\tvar hdom = document.createElement(\"input\");\r\n\thdom.setAttribute(\"class\", \"terminus-hour-input terminus-hour-\"+ty);\r\n\thdom.setAttribute(\"size\", 2);\r\n\thdom.setAttribute(\"placeholder\", \"HH\");\r\n\thdom.value = (parsed.hour ? parsed.hour : \"\");\r\n\thdom.addEventListener(\"input\", function(){\r\n\t\tself.set(\"hour\", this.value, renderer, ty);\r\n\t});\r\n\tvar mdom = document.createElement(\"input\");\r\n\tmdom.setAttribute(\"class\", \"terminus-minute-input terminus-minute-\"+ty);\r\n\tmdom.setAttribute(\"size\", 2);\r\n\tmdom.setAttribute(\"placeholder\", \"MM\");\r\n\tmdom.value = (parsed.minute ? parsed.minute: \"\");\r\n\tmdom.addEventListener(\"input\", function(){\r\n\t\tself.set(\"minute\", this.value, renderer, ty);\r\n\t});\r\n\tvar sdom = document.createElement(\"input\");\r\n\tsdom.setAttribute(\"class\", \"terminus-second-input terminus-second-\"+ty);\r\n\tsdom.setAttribute(\"size\", 8);\r\n\tsdom.setAttribute(\"placeholder\", \"SS.sss...\");\r\n\tsdom.value = (parsed.second ? parsed.second: \"\");\r\n\tsdom.addEventListener(\"input\", function(){\r\n\t\tself.set(\"second\", this.value, renderer, ty);\r\n\t})\r\n\tvar tdom = document.createElement(\"span\");\r\n\ttdom.appendChild(hdom);\r\n\ttdom.appendChild(document.createTextNode(this.time_spacer));\r\n\ttdom.appendChild(mdom);\r\n\ttdom.appendChild(document.createTextNode(this.time_spacer));\r\n\ttdom.appendChild(sdom);\r\n\treturn tdom;\r\n}\r\n\r\nHTMLDateEditor.prototype.getDateComponentDOM = function(parsed, ty, renderer){\r\n\tvar self = this;\r\n\tif([\"xsd:date\", \"xsd:dateTime\", \"xsd:gYear\", \"xsd:gYearMonth\", \"xsd:dateTimeStamp\"].indexOf(ty) != -1){\r\n\t\tvar ydom = document.createElement(\"input\");\r\n\t\tydom.setAttribute(\"class\", \"terminus-year-input terminus-year-\"+ty);\r\n\t\tydom.setAttribute(\"size\", 6);\r\n\t\tydom.setAttribute(\"placeholder\", \"YYYY\");\r\n\t\tydom.value = (parsed.year ? parsed.year : \"\");\r\n\t\tydom.addEventListener(\"input\", function(){\r\n\t\t\tself.set(\"year\", this.value, renderer, ty);\r\n\t\t})\r\n\t}\r\n\tif([\"xsd:date\", \"xsd:dateTime\", \"xsd:gYearMonth\", \"xsd:dateTimeStamp\", \"xsd:gMonth\", \"xsd:gMonthDay\"].indexOf(ty) != -1){\r\n\t\tvar mdom = document.createElement(\"select\");\r\n\t\tmdom.setAttribute(\"class\", \"terminus-month-input terminus-month-\"+ty);\r\n\t\tfor(var i = 0; i<this.helper.months.length; i++){\r\n\t\t\tvar opdom = document.createElement(\"option\");\r\n\t\t\topdom.value = i+1;\r\n\t\t\topdom.appendChild(document.createTextNode(this.helper.months[i]));\r\n\t\t\tif(parsed.month && parsed.month == i+1){\r\n\t\t\t\topdom.selected = true;\r\n\t\t\t}\r\n\t\t\tmdom.appendChild(opdom);\r\n\t\t}\r\n\t\tmdom.addEventListener(\"change\", function(){\r\n\t\t\tself.set(\"month\", this.value, renderer, ty);\r\n\t\t})\r\n\t}\t\r\n\tif([\"xsd:date\", \"xsd:dateTime\", \"xsd:dateTimeStamp\", \"xsd:gDay\", \"xsd:gMonthDay\"].indexOf(ty) != -1){\r\n\t\tvar ddom = document.createElement(\"input\");\r\n\t\tddom.setAttribute(\"class\", \"terminus-day-input terminus-day-\"+ty);\r\n\t\tddom.setAttribute(\"size\", 2);\r\n\t\tddom.setAttribute(\"placeholder\", \"DD\");\r\n\t\tddom.value = (parsed.day ? parsed.day : \"\");\t\r\n\t\tddom.addEventListener(\"input\", function(){\r\n\t\t\tself.set(\"day\", this.value, renderer, ty);\r\n\t\t})\r\n\t}\t\r\n\tif(ydom || mdom || ddom){\r\n\t\tvar dadom = document.createElement(\"span\");\r\n\t\tif(ddom) dadom.appendChild(ddom); \r\n\t\tif(mdom) {\r\n\t\t\tif(ddom) dadom.appendChild(document.createTextNode(this.date_spacer));\r\n\t\t\tdadom.appendChild(mdom); \r\n\t\t}\r\n\t\tif(ydom) {\r\n\t\t\tif(mdom || ddom) dadom.appendChild(document.createTextNode(this.date_spacer));\r\n\t\t\tdadom.appendChild(ydom); \r\n\t\t}\r\n\t\treturn dadom;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nmodule.exports={HTMLDateEditor}","const HTMLFrameHelper = require('../HTMLFrameHelper');\r\n\r\n\r\nfunction HTMLEntityViewer(options){}\r\nHTMLEntityViewer.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar value = renderer.value();\r\n\tvar value = TerminusClient.FrameHelper.unshorten(value);\r\n\tvar holder = document.createElement(\"span\");\r\n\tholder.setAttribute(\"class\", \"terminus-literal-value terminus-entity-reference-value\");\r\n\tvar self = this;\r\n\tif(this.holder){\r\n\t\treturn this.holder;\r\n\t}\r\n\tif(value){\r\n\t\tvar dom = this.getEntityViewHTML(value, renderer, dataviewer);\t\t\r\n\t\tholder.appendChild(dom);\r\n\t}\r\n\treturn holder;\r\n}\r\n\r\nHTMLEntityViewer.prototype.getEntityViewHTML = function(value, renderer, dataviewer){\r\n\tvar span = document.createElement(\"span\");\r\n\tvar self = this;\r\n\tspan.setAttribute(\"class\", \"terminus-internal-link\");\r\n\tspan.appendChild(dataviewer.internalLink(value));\r\n\tif(controller = renderer.getController()){\r\n\t\tcontroller.getInstanceMeta(value).then(function(response){\r\n\t\t\tvar lab = self.getEntityLabel(value, response, dataviewer);\r\n\t\t\tif(lab){ \r\n\t\t\t\tTerminusClient.FrameHelper.removeChildren(span);\r\n\t\t\t\tspan.appendChild(lab);\r\n\t\t\t}\t\r\n\t\t});\r\n\t}\r\n\treturn span;\r\n}\r\n\r\nHTMLEntityViewer.prototype.getEntityLabel = function(url, response, dv){\r\n\tvar nspan = document.createElement(\"span\");\r\n\tif(response && (il = HTMLFrameHelper.getVariableValueFromBinding(\"InstanceLabel\", response))){\r\n\t\tnspan.appendChild(dv.internalLink(url, il));\r\n\t\tvar rt = HTMLFrameHelper.getVariableValueFromBinding(\"InstanceType\", response);\r\n\t\tvar tit = url + \" Type: \" + rt;\r\n\t\tvar ic = HTMLFrameHelper.getVariableValueFromBinding(\"InstanceComment\", response);\r\n\t\tif(typeof ic == \"object\" && ic[\"@value\"]){\r\n\t\t\ttit += \" \" + ic[\"@value\"];\r\n\t\t}\r\n\t\tnspan.setAttribute(\"title\", tit);\r\n\t\treturn nspan;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nmodule.exports={HTMLEntityViewer}","function HTMLEntityEditor(options){}\r\nHTMLEntityEditor.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar value = renderer.value();\r\n\tvar input = document.createElement(\"input\");\r\n\tinput.setAttribute(\"class\", \"terminus-literal-value terminus-entity-reference-value\");\r\n\tinput.setAttribute(\"type\", \"text\");\r\n\tinput.setAttribute('size', 80);\r\n\tinput.value = value;\r\n\tvar self = this;\r\n\tinput.addEventListener(\"change\", function(){\r\n\t\tvar url = this.value;\r\n\t\tif(url.indexOf(\"/\") == -1 && url.indexOf(\":\") == -1){\r\n\t\t\turl = \"doc:\" + url;\r\n\t\t}\r\n\t\trenderer.set(url);\r\n\t});\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={HTMLEntityEditor}","function HTMLImageViewer(options){}\r\nHTMLImageViewer.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar value = renderer.value();\r\n\tvar ty = TerminusClient.FrameHelper.getShorthand(renderer.frame.getType());\r\n\tty = (ty ? ty : renderer.frame.getType());\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', \"terminus-literal-value terminus-literal-image-value\");\r\n\tinput.setAttribute('data-value', value);\r\n\tif(value){\r\n\t\tvar img = document.createElement(\"a\");\r\n\t\timg.setAttribute('src', value);\r\n\t\tinput.appendChild(img);\r\n\t}\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={HTMLImageViewer}\r\n\r\n\r\n","\r\n\r\nfunction HTMLImageEditor(options){}\r\nHTMLImageEditor.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar value = renderer.value();\r\n\tvar ty = TerminusClient.FrameHelper.getShorthand(renderer.frame.getType());\r\n\tty = (ty ? ty : renderer.frame.getType());\r\n\tif(ty == \"xsd:base64Binary\"){\r\n\t\tvar input = document.createElement(\"textarea\");\r\n\t\tinput.setAttribute('class', \"terminus-literal-value terminus-literal-b64image-value\");\r\n\t\tinput.value = value;\r\n\t\tinput.addEventListener(\"change\", function(){\r\n\t\t\trenderer.set(this.value);\r\n\t\t});\r\n\t\treturn input;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nmodule.exports={HTMLImageEditor}","function HTMLLinkViewer(options){\r\n\tthis.css = \"terminus-literal-value terminus-literal-value-range \" + ((options && options.css) ?  options.css : \"\");\r\n}\r\n\r\nHTMLLinkViewer.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar value = renderer.value();\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', this.css);\r\n\tinput.setAttribute('size', 80);\r\n\tinput.setAttribute('data-value', value);\r\n\tif(value){\r\n\t\tvar a = document.createElement(\"a\");\r\n\t\ta.setAttribute('href', value);\r\n\t\ta.appendChild(document.createTextNode(value));\r\n\t\tinput.appendChild(a);\r\n\t}\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={HTMLLinkViewer}\r\n\r\n","function HTMLNumberViewer(options){\r\n\tthis.commas = (options && options.commas ? options.commas : true);\r\n}\r\n\r\nHTMLNumberViewer.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar value = renderer.value();\r\n\tif(value === 0) value = \"0\";\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', 'terminus-number-value terminus-literal-value');\r\n\tinput.setAttribute('data-value', value);\r\n\tvalue = (this.commas ? TerminusClient.FrameHelper.numberWithCommas(value) : value);\r\n\tinput.appendChild(document.createTextNode(value));\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={HTMLNumberViewer}\r\n","function HTMLRangeViewer(options){\r\n\tthis.commas = (options && options.commas ? options.commas : true);\r\n\tthis.css = \"terminus-literal-value terminus-literal-value-range \" + ((options && options.css) ?  options.css : \"\");\r\n\tthis.delimiter = (options && options.delimiter ? options.delimiter : false);\r\n}\r\n\r\nHTMLRangeViewer.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar value = renderer.value();\r\n\tvar vals = TerminusClient.FrameHelper.parseRangeValue(value, this.delimiter);\r\n\tvar d = document.createElement(\"span\");\r\n\td.setAttribute(\"class\", this.css);\r\n\tvar rvals = document.createElement(\"span\");\r\n\trvals.setAttribute(\"class\", \"terminus-range-value-left\");\r\n\tvar svals = document.createElement(\"span\");\r\n\tsvals.setAttribute(\"class\", \"terminus-range-value-right\");\r\n\tvar x = (this.useCommas(renderer) ? TerminusClient.FrameHelper.numberWithCommas(vals[0]) : vals[0]);\r\n\tvar tnode = document.createTextNode(x);\r\n\trvals.appendChild(tnode);\r\n\td.appendChild(rvals);\t\r\n\tif(vals.length == 2){\r\n\t\td.appendChild(getRangeSymbolDOM());\r\n\t\tvar x2 = (this.useCommas(renderer) ? TerminusClient.FrameHelper.numberWithCommas(vals[1]) : vals[1]);\r\n\t\tvar t2node = document.createTextNode(x2);\r\n\t\tsvals.appendChild(t2node);\r\n\t\td.appendChild(svals);\t\r\n\t}\r\n\treturn d;\r\n}\r\n\r\nfunction useCommas(renderer){\r\n\tif(in_array(renderer.frame.getTypeShorthand(), array(\"xdd:gYearRange\", \"xdd:dateRange\"))) return false;\r\n\treturn this.commas;\r\n}\r\n\r\nfunction getRangeSymbolDOM(){\r\n\tvar d = document.createElement(\"span\");\r\n\td.setAttribute(\"class\", \"terminus-range-indicator\");\r\n\td.setAttribute(\"title\", \"The value is uncertain, it lies somewhere in this range\");\r\n\td.appendChild(document.createTextNode(\" ... \"));\r\n\treturn d;\r\n}\r\n\r\nmodule.exports={HTMLRangeViewer}\r\n","function HTMLRangeEditor(options){\r\n\tthis.commas = (options && options.commas ? options.commas : true);\r\n\tthis.css = \"terminus-literal-value terminus-literal-value-range \" + ((options && options.css) ?  options.css : \"\");\r\n\tthis.delimiter = (options && options.delimiter ? options.delimiter : false);\r\n}\r\n\r\nHTMLRangeEditor.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar value = renderer.value();\r\n\tvar vals = TerminusClient.FrameHelper.parseRangeValue(value, this.delimiter);\r\n\tvar d = document.createElement(\"span\");\r\n\td.setAttribute(\"class\", this.css);\r\n\tvar rvals = document.createElement(\"span\");\r\n\tvar svals = document.createElement(\"span\");\r\n\tvar data1 = (vals.length > 0 ? vals[0] : \"\");\r\n\tvar data2 = (vals.length > 1 ? vals[1] : \"\");\r\n\tvar firstip = document.createElement(\"input\");\r\n\tfirstip.setAttribute('type', \"text\");\r\n\tfirstip.setAttribute('size', 16);\r\n\tif(data1){\r\n\t\tfirstip.value = data1;\r\n\t}\r\n\tvar secondip = document.createElement(\"input\");\r\n\tsecondip.setAttribute('type', \"text\");\r\n\tsecondip.setAttribute('size', 16);\r\n\tif(data2){\r\n\t\tthis.showing_range = true;\r\n\t\tsecondip.value = data2;\r\n\t}\r\n\trvals.appendChild(firstip);\r\n\td.appendChild(rvals);\t\r\n\tif(this.showing_range){\r\n\t\tsvals.appendChild(getRangeSymbolDOM());\r\n\t\tsvals.appendChild(secondip);\r\n\t}\r\n\td.appendChild(svals);\t\r\n\tvar but = document.createElement(\"button\");\r\n\tbut.setAttribute(\"class\", \"terminus-change-range\");\r\n\tvar txt = this.showing_range ? \"Change to Simple Value\" : \"Change to Uncertain Range\";\r\n\tbut.appendChild(document.createTextNode(txt));\r\n\td.appendChild(but);\t\r\n\tvar self = this;\r\n\tbut.addEventListener(\"click\", function(){\r\n\t\tif(self.showing_range){\r\n\t\t\tself.showing_range = false;\r\n\t\t\tsecondip.value = \"\";\t\t\t\t\r\n\t\t\tTerminusClient.FrameHelper.removeChildren(svals);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tself.showing_range = true;\r\n\t\t\tsecondip.value = \"\";\t\t\t\t\r\n\t\t\tsvals.appendChild(getRangeSymbolDOM());\r\n\t\t\tsvals.appendChild(secondip);\r\n\t\t}\r\n\t\tvar txt = self.showing_range ? \"Change to Simple Value\" : \"Change to Uncertain Range\";\r\n\t\tbut.innerText = txt;\r\n\t\tchangeHandler();\r\n\t});\r\n\tvar changeHandler = function(){\r\n\t\tif(self.showing_range && secondip.value){\r\n\t\t\tif(firstip.value) renderer.set(\"[\" + firstip.value + \",\" + secondip.value + \"]\");\t\t\t\t\r\n\t\t\telse renderer.set(secondip.value);\t\t\t\t\r\n\t\t}\r\n\t\telse {\r\n\t\t\trenderer.set(firstip.value);\r\n\t\t}\r\n\t}\r\n\tfirstip.addEventListener(\"change\", changeHandler);\r\n\tsecondip.addEventListener(\"change\", changeHandler);\r\n\treturn d;\r\n}\r\n\r\nfunction getRangeSymbolDOM(){\r\n\tvar d = document.createElement(\"span\");\r\n\td.setAttribute(\"class\", \"terminus-range-indicator\");\r\n\td.setAttribute(\"title\", \"The value is uncertain, it lies somewhere in this range\");\r\n\td.appendChild(document.createTextNode(\" ... \"));\r\n\treturn d;\r\n}\r\n\r\nmodule.exports={HTMLRangeEditor}\r\n","function SantizedHTMLViewer(options){\r\n\tthis.css = ((options && options.css) ? \"literal-value \" + options.css : \"literal-value\");\r\n}\r\n\r\nSantizedHTMLViewer.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar val = renderer.value();\r\n\tvar input = document.createElement(\"span\");\r\n\tinput.setAttribute('class', this.css);\r\n\tinput.setAttribute('data-value', val);\r\n\tinput.innerHTML = val;\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={SantizedHTMLViewer}\r\n","const GoogleMapHelper = require(\"./GoogleMapHelper\")\r\n\r\nfunction GoogleMapEditor(options){}\r\n\r\nGoogleMapEditor.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar value = renderer.value();\r\n\tvar ty = TerminusClient.FrameHelper.getShorthand(renderer.frame.getType());\r\n\tty = (ty ? ty : renderer.frame.getType())\r\n\tvar mapcontainer = document.createElement(\"div\");\r\n\tmapcontainer.setAttribute('class', \"gmap-window gmap-editor\");\r\n\tvar self = this;\r\n\tvar ghelper = new GoogleMapHelper();\r\n\tvar map = ghelper.initMap(mapcontainer, renderer, value, ty);\r\n    if(ty == \"xdd:coordinate\"){\r\n\t    google.maps.event.addListener(map, 'click', function(event) {\r\n\t    \tvar position = event.latLng;\r\n\t    \tvar coo = \"[\" + position.lat() + \",\" + position.lng() + \"]\";\r\n\t    \trenderer.set(coo);\r\n\t        ghelper.clearMarkers();\r\n\t        var init = {\r\n\t    \t\tposition: position, \r\n\t    \t\tmap: map\r\n\t    \t}\r\n\t    \tvar marker = new google.maps.Marker(init);\r\n\t    \tghelper.markers.push(marker);\r\n\t  \t});\r\n\t}\r\n    else {\r\n    \tgoogle.maps.event.addListener(map, 'click', function(event) {\r\n        \tvar path = ghelper.polyline.getPath();\r\n        \tpath.push(event.latLng);\r\n      \t    var position = event.latLng;\r\n      \t    ghelper.addMarker(position, map, renderer, '#' + path.getLength(), ty);\r\n      \t});\r\n    }\r\n    return mapcontainer;\r\n}\r\n\r\nmodule.exports={GoogleMapEditor};","const GoogleMapHelper = require(\"./GoogleMapHelper\")\r\n\r\nfunction GoogleMapViewer(options){}\r\n\r\nGoogleMapViewer.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar value = renderer.value();\r\n\tvar ty = TerminusClient.FrameHelper.getShorthand(renderer.frame.getType());\r\n\tty = (ty ? ty : renderer.frame.getType())\r\n\t\tvar map = document.createElement(\"div\");\r\n\tmap.setAttribute('class', \"gmap-window gmap-viewer\");\r\n\tvar self = this;\r\n\tvar ghelper = new GoogleMapHelper();\r\n\tghelper.initMap(map, renderer, value, ty);\t\t\r\n    return map;\r\n}\r\n\r\nmodule.exports={GoogleMapViewer};","function HTMLMarkupEditor(options){}\r\nHTMLMarkupEditor.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar value = renderer.value();\r\n\tvar ty = TerminusClient.FrameHelper.getShorthand(renderer.frame.getType());\r\n\tty = (ty ? ty : renderer.frame.getType());\r\n\tvar input = document.createElement(\"div\");\r\n\tinput.setAttribute('class', \"html-wysiwyg\");\r\n\tvar inner = document.createElement(\"span\");\r\n\tinner.setAttribute('class', \"html-literal literal-value\");\r\n\tinner.innerHTML=value;\r\n\tinput.appendChild(inner);\r\n\tif(typeof Quill != \"undefined\"){\r\n\t\tvar quill = new Quill(inner, { theme: 'snow' });\r\n\t\tquill.on(\"text-change\", function(){\r\n\t\t\trenderer.set(quill.root.innerHTML);\r\n\t\t});\r\n\t}\r\n\treturn input;\r\n}\r\n\r\nmodule.exports={HTMLMarkupEditor}","function S2EntityEditor(options){}\r\n\r\nS2EntityEditor.prototype.getDOM = function(renderer, dataviewer){\r\n\tvar value = renderer.value();\r\n\tvar cls = renderer.frame.range;\r\n\tvar cback = renderer.set;\r\n\tvar ctl = renderer.getController();\r\n\tvar d2ch = new TerminusDocumentChooser(ctl.ui, cls, value);\r\n\td2ch.change = function(val){\r\n\t\trenderer.set(val);\r\n\t}\r\n\td2ch.view = \"label\";\r\n\tvar d2dom = d2ch.getAsDOM();\r\n\treturn d2dom;\r\n}\r\n\r\n\r\nmodule.exports={S2EntityEditor}","const HTMLPropertyViewer = require('./PropertyViewer');\r\nconst RenderingMap = require('./RenderingMap');\r\nconst HTMLDataViewer = require('./DataViewer');\r\n\r\nfunction ValueRenderer(dataframe, index, parent, options){\r\n\tthis.frame = dataframe;\r\n\tthis.index = index;\r\n\tthis.parent = parent;\r\n\tthis.originalValue = this.value();\r\n\tthis.renderer_type = \"value\";\r\n\tthis.options = this.setOptions(options);\r\n}\r\n\r\nValueRenderer.prototype.depth = function(){return (this.parent ? this.parent.depth() : false);};\r\nValueRenderer.prototype.property = function(){ return (this.parent ? this.parent.property() : false);};\r\nValueRenderer.prototype.subject = function(){ return (this.parent ? this.parent.subject() : false);};\r\nValueRenderer.prototype.subjectClass = function(){ return (this.parent ? this.parent.subjectClass() : false);};\r\nValueRenderer.prototype.type = function(){\treturn (this.frame ? this.frame.range : false);};\r\nValueRenderer.prototype.range = function(){\treturn (this.frame ? this.frame.range : false);};\r\nValueRenderer.prototype.value = function(){\treturn (this.frame ? this.frame.get() : false);};\r\nValueRenderer.prototype.isDocument = function(){\treturn (this.frame ? this.frame.isDocument() : false);};\r\nValueRenderer.prototype.currentViewer = function(){\treturn this.viewerType;}\r\n\r\nValueRenderer.prototype.copy = function(nf){\r\n\tvar nvr = new ValueRenderer(nf, false, this.parent, this.options);\r\n\tnvr.mode = this.mode;\r\n\tnvr.view = this.view;\r\n\treturn nvr;\r\n}\r\n\r\nValueRenderer.prototype.setFacet = function(facet){\r\n\tthis.facet = facet;\r\n\tthis.parent.redraw();\r\n}\r\n\r\nValueRenderer.prototype.parentFacetChange = function(pfacet){\r\n\tif(pfacet == \"page\") this.setFacet(\"page\");\r\n\tif(pfacet == \"multiline\") this.setFacet(\"line\");\r\n\tif(pfacet == \"line\") this.setFacet(\"inline\");\r\n\tif(pfacet == \"summary\") this.setFacet(\"icon\");\r\n}\r\n\r\nValueRenderer.prototype.getDefaultFacet = function(){\r\n\tif(this.parent.currentFacet() == \"page\" || this.parent.currentFacet() == \"multiline\"){\r\n\t\treturn \"line\";\r\n\t}\r\n\treturn \"inline\";\r\n}\r\n\r\nValueRenderer.prototype.getAvailableFacets = function(){\r\n\treturn Object.values(this.facets);\r\n}\r\n\r\nValueRenderer.prototype.getDefaultFacets = function(){\r\n\tvar defs = {\r\n\t\tpage: {\r\n\t\t\tlabel: \"Full Page\", value: \"page\",\r\n\t\t\tfeatures: [\"facet\", \"type\", \"cardinality\", \"body\", \"status\", \"facet\", \"viewer\", \"control\"],\r\n\t\t\tcontrols: [\"delete\", \"clone\", \"add\", \"reset\", \"cancel\", \"update\", \"mode\", \"show\", \"hide\"]\r\n\t\t},\r\n\t\tline: {\r\n\t\t\tlabel: \"Single Line\", value: \"line\",\r\n\t\t\tfeatures: [\"facet\", \"type\", \"cardinality\", \"body\", \"status\", \"facet\", \"viewer\", \"control\"],\r\n\t\t\tcontrols: [\"delete\", \"clone\", \"add\", \"reset\", \"cancel\", \"update\", \"mode\", \"show\", \"hide\"]\r\n\t\t},\r\n\t\tinline: {\r\n\t\t\tlabel: \"Inline\", value: \"inline\",\r\n\t\t\tfeatures: [\"facet\", \"type\", \"cardinality\", \"body\", \"status\", \"facet\", \"viewer\", \"control\"],\r\n\t\t\tcontrols: [\"delete\", \"clone\", \"add\", \"reset\", \"cancel\", \"update\", \"mode\", \"show\", \"hide\"]\r\n\t\t},\r\n\t\tlabel: {\r\n\t\t\tlabel: \"Label\", value: \"label\",\r\n\t\t\tfeatures: [\"facet\", \"status\", \"body\"],\r\n\t\t\tcontrols: []\r\n\t\t},\r\n\t\ticon: {\r\n\t\t\tlabel: \"Snippet\", value: \"icon\",\r\n\t\t\tfeatures: [\"facet\", \"summary\"],\r\n\t\t\tcontrols: []\r\n\t\t}\r\n\t}\r\n\treturn defs;\r\n}\r\n\r\nValueRenderer.prototype.currentFacet = function(){\r\n\treturn this.facet;\r\n}\r\n\r\nValueRenderer.prototype.setOptions = function(options){\r\n\treturn TerminusDashboard.RenderingMap.decorateRenderer(options, this);\r\n}\r\n\r\nValueRenderer.prototype.hideDisabledControls = function(){\r\n\treturn this.hide_disabled_controls;\r\n}\r\n\r\nValueRenderer.prototype.setMode = function(mode){\r\n\tthis.mode = mode;\r\n\tthis.options.mode = mode;\r\n\tthis.viewerType = false;\r\n\tthis.redraw();\r\n}\r\n\r\nValueRenderer.prototype.setView = function(view){\r\n\tthis.view = view;\r\n\tthis.options.view = view;\r\n\tthis.redraw();\r\n}\r\n\r\nValueRenderer.prototype.getAPIURL = function(a, b){\r\n\tif(this.parent && this.parent.parent){\r\n\t\tif(client = this.parent.parent.getClient()){\r\n\t\t\tvar apiurl = client.dbURL() + a + \"/\" + b;\r\n\t\t\treturn apiurl;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nValueRenderer.prototype.getClient = function(){\r\n\tif(this.parent && this.parent.parent){\r\n\t\treturn this.parent.parent.getClient();\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nValueRenderer.prototype.getController = function(){\r\n\tif(this.parent && this.parent.parent){\r\n\t\treturn this.parent.parent.getController();\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nValueRenderer.prototype.DBURL = function(){\r\n\tif(this.parent && this.parent.parent){\r\n\t\tif(client = this.parent.parent.getClient()){\r\n\t\t\treturn client.dbURL();\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nValueRenderer.prototype.getEntityReference = function(url, cls, entities, opts){\r\n\tif(this.parent && this.parent.parent){\r\n\t\tif(client = this.parent.parent.getClient()){\r\n\t\t\treturn client.getEntityReference(url, cls, entities, opts);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nValueRenderer.prototype.badData = function(bd){\r\n\talert(\"bad data \" + bd);\r\n}\r\n\r\nValueRenderer.prototype.setNew = function(){\r\n\tthis.new_value = true;\r\n}\r\n\r\nValueRenderer.prototype.isNew = function(){\r\n\tif(this.new_value){\r\n\t\treturn true;\r\n\t}\r\n\treturn this.parent.isNew();\r\n}\r\n\r\n\r\nValueRenderer.prototype.isUpdated = function(){\r\n\tif(this.frame.get() != this.originalValue){\r\n\t\treturn true;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nValueRenderer.prototype.getSummary = function(){\r\n\tvar ret = { status: \"ok\" };\r\n\tif(this.isNew()) ret.status = \"new\";\r\n\telse if(this.isUpdated()) ret.status = \"updated\";\r\n\tvar val = this.frame.get();\r\n\tif(val){\r\n\t\tif(val.length && val.length > this.text_summary_length){\r\n\t\t\tret.long = val.substring(0, this.text_summary_length) + \"...\" + \" (\" + val.length + \" characters)\";\r\n\t\t}\r\n\t\telse {\r\n\t\t\tret.long = val;\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tret.long = \"empty\";\r\n\t}\r\n\treturn ret;\r\n}\r\n\r\nValueRenderer.prototype.cardControlAllows = function(action){\r\n\tif(this.parent.cframe.hasRestriction()){\r\n\t\tvar rest = this.parent.cframe.restriction;\r\n\t\tvar currentnum = this.parent.values.length;\r\n\t\tif(action == \"add\" || action == \"clone\"){\r\n\t\t\tif(rest.max && currentnum >= rest.max){\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(action == \"delete\" && (rest.min && currentnum <= rest.min)){\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nValueRenderer.prototype.set = function(v){\r\n\tthis.frame.set(v);\r\n\tthis.viewer.redrawHeader();\r\n\tthis.parent.childUpdated();\r\n}\r\n\r\nValueRenderer.prototype.delete = function(){\r\n\tthis.parent.deletePropertyValue(this.value(), this.index);\r\n\tthis.parent.parent.redraw();\r\n}\r\n\r\nValueRenderer.prototype.load = function(link){\r\n\tthis.parent.load(link);\r\n}\r\n\r\nValueRenderer.prototype.hide = function(){\r\n\tthis.setView(\"hidden\");\r\n}\r\n\r\nValueRenderer.prototype.show = function(){\r\n\tthis.setView(\"full\");\r\n}\r\n\r\nValueRenderer.prototype.cancel = function(){\r\n\tthis.reset();\r\n\tthis.setMode(\"view\");\r\n}\r\n\r\nValueRenderer.prototype.save = function(){\r\n\tif(this.parent) {\r\n\t\tthis.parent.save();\r\n\t}\r\n}\r\n\r\nValueRenderer.prototype.reset = function(){\r\n\tthis.set(this.originalValue);\r\n\tthis.redraw();\r\n}\r\n\r\nValueRenderer.prototype.clone = function(){\r\n\tvar newb = this.parent.addPropertyValue(this.value());\r\n\tvar nrend = this.copy(newb);\r\n\tnrend.setNew();\r\n\tnrend.mode = \"edit\";\r\n\tnrend.index = this.parent.values.length;\r\n\tthis.parent.values.push(nrend);\r\n\tthis.parent.childUpdated();\r\n\tthis.parent.redraw();\r\n\tthis.parent.goToValue(this.parent.values.length-1);\r\n}\r\n\r\nValueRenderer.prototype.getViewerForValue = function(){\r\n\treturn new HTMLDataViewer.HTMLDataViewer(this);\r\n}\r\n\r\nValueRenderer.prototype.getFeaturesForFacet = function(facet){\r\n\treturn this.facets[facet].features.concat(this.facets[facet].controls);\r\n}\r\n\r\nValueRenderer.prototype.showFeature = function(which){\r\n\tif(this.features.indexOf(which) == -1 && this.controls.indexOf(which) == -1) {\r\n\t\treturn false;\r\n\t}\r\n\tvar cardcontrols = [\"delete\", \"clone\", \"add\"];\r\n\tif(cardcontrols.indexOf(which) != -1){\r\n\t\tif(!this.cardControlAllows(which)) return false;\r\n\t}\r\n\tvar updcontrols = [\"update\", \"reset\"];\r\n\tif(this.hideDisabledControls() && updcontrols.indexOf(which) != -1 ){\r\n\t\tif(!this.isUpdated()){\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\tif(which == 'hide' && this.view == \"hidden\") return false;\r\n\tif(which == 'show' && this.view != \"hidden\") return false;\r\n\tvar fets = this.getFeaturesForFacet(this.facet);\r\n\treturn (fets.indexOf(which) != -1);\r\n}\r\n\r\n\r\nValueRenderer.prototype.render = function(viewer){\r\n\tthis.viewer = (viewer ? viewer : this.getViewerForValue());\r\n\treturn this.viewer.render();\r\n}\r\n\r\nValueRenderer.prototype.extract = function(){\r\n\tvar val = this.value();\r\n\tif(val !== \"\" && val !== false){\r\n\t\tif(this.frame.isDatatypeProperty()){\r\n\t\t\tvar objlit = { \"@value\": this.value()}\r\n\t\t\t//var objlit = { data: this.value()}\r\n\t\t\tif(this.frame.isString()) objlit[\"@language\"] = this.frame.lang();\r\n\t\t\telse objlit[\"@type\"] = this.type();\r\n\t\t\treturn objlit;\r\n\t\t}\r\n\t\telse if(this.frame.isChoice() || this.frame.isDocument()){\r\n\t\t\treturn {\"@id\": val}\r\n\t\t}\r\n\t}\r\n\telse return val;\r\n}\r\n\r\nValueRenderer.prototype.getValueHeaderViewer = function(){\r\n\treturn new HTMLDataViewer.HTMLDataHeaderViewer();\r\n}\r\n\r\nValueRenderer.prototype.getDataValueViewer = function(){\r\n\tif(!this.viewerType) {\r\n\t\tthis.viewerType = this.getViewerForDataValue();\r\n\t}\r\n\treturn TerminusDashboard.RenderingMap.getViewer(this.viewerType, this.viewerOptions);\r\n}\r\n\r\nValueRenderer.prototype.getAvailableViewers = function(){\r\n\tvar dt = this.frame.getTypeShorthand();\r\n\tvar ft = this.frame.ftype();\r\n\tif(this.mode == \"view\"){\r\n\t\treturn TerminusDashboard.RenderingMap.getAvailableDataViewers(dt, ft);\r\n\t}\r\n\treturn TerminusDashboard.RenderingMap.getAvailableDataEditors(dt, ft);\r\n}\r\n\r\nValueRenderer.prototype.setViewer = function(viewer){\r\n\tthis.viewerType = viewer;\r\n\tthis.redraw();\r\n}\r\n\r\nValueRenderer.prototype.getViewerForDataValue = function(){\r\n\tvar dt = this.frame.getTypeShorthand();\r\n\tvar ft = this.frame.ftype();\r\n\tif(this.mode == \"edit\"){\r\n\t\treturn TerminusDashboard.RenderingMap.getEditorForDataFrame(dt, ft);\r\n\t}\r\n\treturn TerminusDashboard.RenderingMap.getViewerForDataFrame(dt, ft);\r\n}\r\n\r\nValueRenderer.prototype.redraw = function(){\r\n\tthis.viewer.clear();\r\n\tthis.render(this.viewer);\r\n}\r\n\r\n\r\n\r\n\r\n\r\nmodule.exports=ValueRenderer\r\n","/*\r\n * User Interface elements dealing with database level functions - view, delete, create, db\r\n * view document etc\r\n */\r\nconst WOQLResultsViewer = require('../query/WOQLResultsViewer');\r\nconst TerminusClassChooser = require('./TerminusClassChooser');\r\nconst TerminusDocumentChooser = require('./TerminusDocumentChooser');\r\nconst WOQLQuery=require('../query/WOQLQuery');\r\nconst UTILS=require('../Utils');\r\n\r\n\r\n/*\r\n * User Interface elements dealing with database level functions - view, delete, create, db\r\n * view document etc\r\n */\r\nfunction TerminusDBController(ui){\r\n\t this.ui = ui;\r\n}\r\n\r\n/*\r\n * Controller provides access to the server level functions (create/delete db) and db-level functions (schema, query, document)\r\n */\r\nTerminusDBController.prototype.getAsDOM = function(){\r\n\tvar self = this;\r\n\tvar dbc = document.createElement(\"div\");\r\n\tdbc.setAttribute(\"class\", \"terminus-db-controller\");\r\n\tif(this.ui && this.ui.db()){\r\n\t\tvar scd = document.createElement(\"div\");\r\n\t\tscd.setAttribute(\"class\", \"terminus-field terminus-db-connection\");\r\n\t\tvar lab = document.createElement(\"span\");\r\n\t\tlab.setAttribute(\"class\", \"terminus-label terminus-db-label terminus-control-panel-label\");\r\n\t\tlab.appendChild(document.createTextNode(\"DB \"));\r\n\t\tvar val = document.createElement(\"span\");\r\n\t\tval.setAttribute(\"class\", \"terminus-value terminus-db-value terminus-control-panel-value\");\r\n\t\tvar dbrec = this.ui.client.connection.getDBRecord();\r\n\t\tvar nm = (dbrec && dbrec[\"rdfs:label\"] && dbrec[\"rdfs:label\"][\"@value\"] ? dbrec[\"rdfs:label\"][\"@value\"] : this.ui.db());\r\n\t\tval.appendChild(document.createTextNode(nm));\r\n\t\tscd.appendChild(lab);\r\n\t\tscd.appendChild(val);\r\n\t\t//dbc.appendChild(scd);\r\n\t\tvar nav = document.createElement('div');\r\n\t\tnav.setAttribute('class', 'span3');\r\n\t\tdbc.appendChild(nav);\r\n\t\tvar ul = document.createElement('ul');\r\n\t\tul.setAttribute('class','terminus-ul' );\r\n\t\tnav.appendChild(ul);\r\n\t\t// connected to db\r\n\t\tvar a = document.createElement('a');\r\n        a.setAttribute('class', 'terminus-dashboard-info terminus-list-group-a terminus-nav-width');\r\n        var txt = 'Database: ' + nm;\r\n        a.appendChild(document.createTextNode(txt));\r\n        ul.appendChild(a);\r\n\t\tif(this.ui.showControl(\"db\")){\r\n\t\t\tvar item = this.getControlHTML(\"Database Home\", \"fa-home\");\r\n\t\t\titem.classList.add(\"terminus-selected\");\r\n\t\t    item.addEventListener(\"click\", function(){\r\n\t\t\t\tUTILS.activateSelectedNav(this, self);\r\n\t\t\t\tself.ui.showDBMainPage();\r\n\t\t\t });\r\n\t        ul.appendChild(item);\r\n\t    }\r\n\t\tif(this.ui.showControl(\"delete_database\")){\r\n\t\t\tvar item = this.getControlHTML(\"Delete Database\", \"fa-trash-alt\");\r\n\t\t    item.addEventListener(\"click\", function(){\r\n\t\t\t\tUTILS.activateSelectedNav(this, self);\r\n\t\t\t\tself.ui.deleteDatabase();\r\n\t\t\t });\r\n\t        ul.appendChild(item);\r\n\t\t}\r\n\t\tif(this.ui.showControl(\"woql_select\")){\r\n\t\t\tvar item = this.getControlHTML(\"Query\", \"fa-search\");\r\n\t\t    item.addEventListener(\"click\", function(){\r\n\t\t\t\tUTILS.activateSelectedNav(this, self);\r\n\t\t\t\tself.ui.showQueryPage();\r\n\t\t\t});\r\n\t        ul.appendChild(item);\r\n\t\t}\r\n\t\tif(this.ui.showControl(\"woql_update\")){\r\n\t\t\tvar item = this.getControlHTML(\"Mapping\", \"fa-file-import\");\r\n\t        item.addEventListener(\"click\", function(){\r\n\t\t\t\tUTILS.activateSelectedNav(this, self);\r\n\t\t\t\tself.ui.showMappingPage();\r\n\t\t\t})\r\n\t        ul.appendChild(item);\r\n\t\t}\r\n\t\tif(this.ui.showControl(\"get_schema\")){\r\n\t\t\tvar item = this.getControlHTML(\"Schema\", \"fa-cog\");\r\n\t        item.addEventListener(\"click\", function(){\r\n\t\t\t\tUTILS.activateSelectedNav(this, self);\r\n\t\t\t\tself.ui.showSchemaPage();\r\n\t\t\t})\r\n\t        ul.appendChild(item);\r\n\t\t}\r\n\t\tif((this.ui.showControl(\"get_document\") || this.ui.showControl(\"create_document\"))){\r\n\t\t\tvar item = this.getControlHTML(\"Document\", \"fa-book\");\r\n\t\t\titem.classList.add('terminus-document-nav');\r\n\t        item.addEventListener(\"click\", function(){\r\n\t\t\t\tUTILS.removeSelectedNavClass(\"terminus-selected\");\r\n                this.classList.add(\"terminus-selected\");\r\n\t\t\t\tUTILS.displayDocumentSubMenus(self.ui);\r\n\t\t\t})\r\n\t        ul.appendChild(item);\r\n\t\t}\r\n\t\t// hidden submenus\r\n\t\tif(this.ui.showControl(\"get_document\")) {\r\n\t\t\tvar a = document.createElement('a');\r\n\t\t\ta.setAttribute('class', 'terminus-hide terminus-get-doc');\r\n\t\t\ta.appendChild(self.getDocumentChooserDOM());\r\n\t\t\ta.classList.add();\r\n\t\t\tul.appendChild(a);\r\n\t\t}\r\n\t\t// hidden submenus\r\n\t\tif(this.ui.showControl(\"create_document\")) {\r\n\t\t\tvar a = document.createElement('a');\r\n\t\t\ta.setAttribute('class', 'terminus-hide terminus-create-doc');\r\n\t\t\ta.appendChild(self.getDocumentCreatorDOM());\r\n\t\t\tul.appendChild(a);\r\n\t\t}\r\n\t}\r\n\treturn dbc;\r\n}\r\n\r\n\r\nTerminusDBController.prototype.getControlHTML = function(text, ic, css){\r\n    var self = this;\r\n    var a = document.createElement('a');\r\n\ta.setAttribute('class', 'terminus-a terminus-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\r\n    var icon = document.createElement('i');\r\n    icon.setAttribute('class', 'terminus-menu-icon fa ' + ic);\r\n    a.appendChild(icon);\r\n    var txt = document.createTextNode(text);\r\n    a.appendChild(txt);\r\n    return a;\r\n}\r\n\r\nTerminusDBController.prototype.getDocumentChooserDOM = function(){\r\n\tvar self = this;\r\n\tvar scd = document.createElement(\"span\");\r\n\tscd.setAttribute(\"class\", \"terminus-document-chooser terminus-form-horizontal terminus-control-group terminus-choose-by-id\");\r\n\tvar lab = document.createElement(\"span\");\r\n\tlab.setAttribute(\"class\", \"terminus-document-chooser-label terminus-control-label terminus-control-label-padding\");\r\n\t//lab.appendChild(document.createTextNode(\"ID \"));\r\n\tvar dcip = document.createElement(\"input\");\r\n\tdcip.setAttribute(\"class\", \"terminus-form-doc-value terminus-document-chooser terminus-doc-input-text\");\r\n\tdcip.setAttribute(\"placeholder\", \"Enter Document ID\");\r\n\tvar nbut = document.createElement(\"button\");\r\n\tnbut.setAttribute('class', \"terminus-control-button terminus-document-button terminus-doc-btn\")\r\n\tnbut.appendChild(document.createTextNode(\"View\"));\r\n\tnbut.addEventListener(\"click\", function(){\r\n\t\tif(dcip.value) self.ui.showDocument(dcip.value);\r\n\t})\r\n\tif(this.ui.client.connectionConfig.platformEndpoint() && this.ui.pluginAvailable(\"select2\")){\r\n\r\n\t\tvar mcls = TerminusClient.FrameHelper.unshorten(\"tcs:Document\");\r\n\t\tvar d2ch = new TerminusDocumentChooser(this.ui, mcls);\r\n\t\td2ch.change = function(val){\r\n\t\t\tself.ui.showDocument(val);\r\n\t\t}\r\n\t\td2ch.view = \"label\";\r\n\t\tvar sdom = d2ch.getAsDOM('terminus-class-select');\r\n\t\tjQuery(dcip).hide();\r\n\t\tjQuery(nbut).hide();\r\n\t\tvar nlab = document.createElement(\"a\");\r\n\t\tnlab.setAttribute(\"href\", \"#\");\r\n\t\tnlab.setAttribute(\"class\", \"terminus-document-which-chooser\");\r\n\t\tnlab.appendChild(document.createTextNode(\"Choose by ID\"));\r\n\t\tvar show = \"label\";\r\n\t\tjQuery(nlab).click(function(){\r\n\t\t\tif(show == \"label\"){\r\n\t\t\t\tshow = \"id\";\r\n\t\t\t\tjQuery(dcip).show();\r\n\t\t\t\tjQuery(nbut).show();\r\n\t\t\t\tjQuery(sdom).hide();\r\n\t\t\t\tjQuery(nlab).text(\"Choose by Label\");\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tshow = \"label\";\r\n\t\t\t\tjQuery(dcip).hide();\r\n\t\t\t\tjQuery(nbut).hide();\r\n\t\t\t\tjQuery(sdom).show();\r\n\t\t\t\tjQuery(nlab).text(\"Choose by ID\");\r\n\t\t\t}\r\n\t\t})\r\n\t\tscd.appendChild(sdom);\r\n\t\tscd.prepend(nlab);\r\n\t}\r\n\tvar nbuts = document.createElement(\"span\");\r\n\tnbuts.setAttribute(\"class\", \"terminus-control-buttons terminus-document-chooser-buttons\");\r\n\tnbuts.appendChild(nbut);\r\n\tscd.appendChild(lab);\r\n\tscd.appendChild(dcip);\r\n\tscd.appendChild(nbuts);\r\n\treturn scd;\r\n};\r\n\r\nTerminusDBController.prototype.getDocumentCreatorDOM = function(){\r\n\tvar self = this;\r\n\tvar scd = document.createElement(\"div\");\r\n\tscd.setAttribute(\"class\", \"terminus-document-creator terminus-form-horizontal terminus-control-group terminus-choose-by-id\");\r\n\r\n\tvar dcip = document.createElement(\"input\");\r\n\tdcip.setAttribute(\"class\", \"terminus-form-doc-value terminus-document-creator terminus-doc-input-text\");\r\n\tdcip.setAttribute(\"placeholder\", \"Enter Document Type\");\r\n\tvar nbut = document.createElement(\"button\");\r\n\tvar lab = document.createElement(\"span\");\r\n\tlab.setAttribute(\"class\", \"document-creator-label terminus-control-label terminus-control-label-padding\");\r\n\t//lab.appendChild(document.createTextNode(\"Type \"));\r\n\tnbut.setAttribute('class', \"terminus-control-button create-document-button terminus-doc-btn\")\r\n\tnbut.appendChild(document.createTextNode(\"Create\"));\r\n\tnbut.addEventListener(\"click\", function(){\r\n\t\tif(dcip.value) self.ui.showCreateDocument(dcip.value);\r\n\t})\r\n\tvar nbuts = document.createElement(\"div\");\r\n\tnbuts.setAttribute(\"class\", \"terminus-control-buttons terminus-document-creator-buttons\");\r\n\tvar wq = new WOQLQuery(this.ui.client, {}, this.ui);\r\n\tvar filter = wq.getConcreteDocumentClassPattern(\"v:Element\");\r\n\tvar termcc = new TerminusClassChooser(this.ui, filter);\r\n\ttermcc.empty_choice = \"Create Document of Type\";\r\n\tvar self = this;\r\n\ttermcc.change = function(new_class){\r\n\t\tif(new_class){\r\n\t\t\tself.ui.showCreateDocument(new_class);\r\n\t\t\ttermcc.choice = false;\r\n\t\t}\r\n\t}\r\n\tvar tcdom = termcc.getAsDOM('terminus-class-select');\r\n\r\n\tvar gb = document.createElement('div');\r\n\tgb.setAttribute('class', 'terminus-doc-btn-group');\r\n\tvar bi = document.createElement('button');\r\n\tbi.setAttribute('class', 'terminus-doc-btn-selected terminus-doc-toggle-btn');\r\n\tbi.appendChild((document.createTextNode('D')));\r\n\tvar tds = document.createElement('span');\r\n\ttds.setAttribute('class', 'terminus-tooltiptext');\r\n\ttds.appendChild(document.createTextNode('Dropdown List'));\r\n\tbi.appendChild(tds);\r\n\tvar bt = document.createElement('button');\r\n\tbt.setAttribute('class', 'terminus-doc-toggle-btn');\r\n\tbt.appendChild((document.createTextNode('T')));\r\n\tvar tts = document.createElement('span');\r\n\ttts.setAttribute('class', 'terminus-tooltiptext');\r\n\ttts.appendChild(document.createTextNode('Text Input'));\r\n\tbt.appendChild(tts);\r\n\tgb.appendChild(bt);\r\n\tgb.appendChild(bi);\r\n\tvar nlabs = document.createElement(\"div\");\r\n\tnlabs.setAttribute('class', 'terminus-doc-btn-gp-align');\r\n\tnlabs.appendChild(gb);\r\n\tscd.appendChild(nlabs);\r\n\tvar ccDOM = document.createElement(\"span\");\r\n\tnlabs.appendChild(ccDOM);\r\n\tccDOM.setAttribute(\"class\", \"create-document-list\");\r\n\tccDOM.appendChild(tcdom);\r\n\tvar which = \"select\";\r\n\tbt.addEventListener(\"click\", function(){\r\n\t\t// create document of TerminusClient.FrameHelper.removeChildren(nlabs);\r\n\t\tTerminusClient.FrameHelper.removeChildren(ccDOM);\r\n\t\tUTILS.removeSelectedNavClass(\"terminus-doc-btn-selected\");\r\n\t\tthis.classList.add(\"terminus-doc-btn-selected\");\r\n\t\tccDOM.appendChild(dcip);\r\n\t\tccDOM.appendChild(nbut);\r\n\t});\r\n\r\n\tbi.addEventListener(\"click\", function(){\r\n\t\t// create document from dropdown\r\n\t\tTerminusClient.FrameHelper.removeChildren(ccDOM);\r\n\t\tUTILS.removeSelectedNavClass(\"terminus-doc-btn-selected\");\r\n\t\tthis.classList.add(\"terminus-doc-btn-selected\");\r\n\t\tccDOM.appendChild(tcdom);\r\n\t});\r\n\treturn scd;\r\n};\r\n\r\nfunction TerminusDBViewer(ui){\r\n\tthis.ui = ui;\r\n\tthis.wquery = new WOQLQuery(ui.client, this.options, ui);\r\n}\r\n\r\nTerminusDBViewer.prototype.getAsDOM = function(selected){\r\n\tvar pd = document.createElement(\"span\");\r\n\tpd.setAttribute(\"class\", \"terminus-db-home-page\");\r\n\tvar sth = document.createElement('div');\r\n\tvar banner = document.createElement('div');\r\n\t//pd.appendChild(banner);\r\n\tbanner.setAttribute('class', 'terminus-banner');\r\n\tvar dhp = document.createElement(\"span\");\r\n\tdhp.setAttribute('class', 'terminus-home-heading');\r\n\tdhp.appendChild(document.createTextNode(\"DB Home Page - \"));\r\n\tsth.appendChild(dhp);\r\n\tvar scd = document.createElement(\"span\");\r\n\tscd.setAttribute(\"class\", \"terminus-db-details\");\r\n\tvar scs = document.createElement(\"span\");\r\n\tscs.setAttribute(\"class\", \"terminus-db-details-value \");\r\n\tvar dbrec = this.ui.getDBRecord();\r\n\tif(dbrec){\r\n\t\tvar nm = (dbrec[\"rdfs:label\"] && dbrec[\"rdfs:label\"][\"@value\"] ? dbrec[\"rdfs:label\"][\"@value\"] : this.db);\r\n\t\tscs.appendChild(document.createTextNode(nm));\r\n\t\tscs.setAttribute('class', 'terminus-home-heading');\r\n\t}\r\n\tscd.appendChild(scs);\r\n\tsth.appendChild(scd);\r\n\tbanner.appendChild(sth);\r\n\t//pd.appendChild(sth);\r\n\t//pd.appendChild(UTILS.getHeaderDom('Summary'));\r\n\tthis.getDeleteOnHomePage(pd);\r\n\t//this.getDBSummary(pd);\r\n\tpd.appendChild(pd.appendChild(UTILS.getHeaderDom('List of Documents')));\r\n\tthis.getClassesDOM(pd);\r\n\treturn pd;\r\n}\r\n\r\nTerminusDBViewer.prototype.getDbInfoBox = function(r, module){\r\n\tvar sp = document.createElement('span');\r\n    sp.setAttribute('class', 'terminus-db-info-box');\r\n\tvar info = document.createElement('div');\r\n\tinfo.appendChild(document.createTextNode(module.charAt(0).toUpperCase() + module.slice(1)));\r\n\tinfo.setAttribute('class', 'terminus-db-info');\r\n\tsp.appendChild(info);\r\n\r\n    var i = document.createElement('i');\r\n\tswitch(module){\r\n\t\tcase 'size':\r\n\t\t\ti.setAttribute('class', 'terminus-icon fa fa-balance-scale');\r\n\t\t    var txt = document.createTextNode('2 Gb');\r\n\t\tbreak;\r\n\t\tcase 'created':\r\n\t\t\ti.setAttribute('class', 'terminus-icon fa fa-calendar');\r\n\t\t    var txt = document.createTextNode('16 July 2015');\r\n\t\tbreak;\r\n\t\tcase 'modified':\r\n\t\t\ti.setAttribute('class', 'terminus-icon fa fa-clock');\r\n\t\t    var txt = document.createTextNode('22 Dec 2019');\r\n\t\tbreak;\r\n\t}\r\n    sp.appendChild(i);\r\n\tif(txt) sp.appendChild(txt);\r\n    r.appendChild(sp);\r\n}\r\n\r\nTerminusDBViewer.prototype.getDeleteOnHomePage = function(d){\r\n\t// delete database\r\n\tif(this.ui.db() == \"terminus\") return;\r\n    var del = document.createElement('button');\r\n    del.setAttribute('class', 'terminus-btn terminus-btn-float-right terminus-home-del');\r\n    del.setAttribute('type', 'button');\r\n    del.innerHTML = 'Delete Database';\r\n\tvar dbrec = this.ui.getDBRecord();\r\n\tif(dbrec)\r\n\t\tvar nm = (dbrec[\"rdfs:label\"] && dbrec[\"rdfs:label\"][\"@value\"] ? dbrec[\"rdfs:label\"][\"@value\"] : this.ui.db());\r\n    var self = this;\r\n    var dbdel = this.ui.db();\r\n\r\n    del.addEventListener(\"click\", function(){\r\n      \tvar deleteConfirm = confirm(`Do you want to delete ${dbdel} Database?`);\r\n\t\tif (deleteConfirm == true) {\r\n\t\t\tself.ui.deleteDatabase(dbdel);\r\n\t\t}\r\n    });\r\n    d.appendChild(del);\r\n}\r\n\r\nTerminusDBViewer.prototype.getDBSummary = function(d){\r\n    var r = document.createElement('span');\r\n    r.setAttribute('class', 'terminus-db-info-box-display');\r\n    d.appendChild(r);\r\n\r\n    /* getDbInfoBox() calls can change according to further requirments */\r\n    this.getDbInfoBox(r, 'size');\r\n    this.getDbInfoBox(r, 'created');\r\n    this.getDbInfoBox(r, 'modified');\r\n}\r\n\r\nTerminusDBViewer.prototype.getClassesDOM = function(d){\r\n\tvar q = this.wquery.getClassesQuery();\r\n\tvar self = this;\r\n\tthis.wquery.execute(q)\r\n\t.then(function(result){\r\n\t\tself.result = new WOQLResultsViewer.WOQLResultsViewer(self.ui, result, self.wquery, {}, {}, false);\r\n\t\tif(self.result){\r\n\t\t\tvar nd = self.result.getAsDOM(d, false);\r\n\t\t\tif(nd){\r\n\t\t\t\tnd.setAttribute('class', 'terminus-margin-box');\r\n\t        }\r\n\t\t\telse{\r\n\t\t\t\tnor = document.createElement('div');\r\n\t\t\t\tnor.setAttribute('class', 'terminus-no-res-alert');\r\n\t\t\t\tnor.appendChild(document.createTextNode(\"No results available, create new ones to view them here...\"));\r\n\t\t\t\td.appendChild(nor);\r\n\t\t\t}\r\n\t\t}\r\n\t})\r\n\t.catch(function(err){\r\n\t\tconsole.error(err);\r\n\t\tself.ui.showError(err);\r\n\t});\r\n\treturn d;\r\n}\r\n\r\n\r\nfunction TerminusDBCreator(ui){\r\n\tthis.ui = ui;\r\n}\r\n\r\nTerminusDBCreator.prototype.getAsDOM = function(selected){\r\n\tvar scd = document.createElement(\"div\");\r\n\t/* test delete when over var txtHolder = document.createElement(\"div\");\r\n\ttxtHolder.appendChild(document.createTextNode('expecting laoder herer'));\r\n\tscd.appendChild(txtHolder);\r\n\tthis.ui.getLoader(scd);*/\r\n\tscd.setAttribute(\"class\", \"terminus-db-creator\");\r\n\tvar sct = document.createElement(\"h3\");\r\n\tsct.setAttribute(\"class\", \"terminus-db-creator-title terminus-module-head\");\r\n\tsct.appendChild(document.createTextNode(\"Create New Database\"));\r\n\tscd.appendChild(sct);\r\n\tvar mfd = document.createElement('div');\r\n\tmfd.setAttribute('class', 'terminus-form-border');\r\n\tscd.appendChild(mfd);\r\n\tvar sci = document.createElement(\"div\");\r\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-form-field-spacing terminus-form-horizontal terminus-control-group\");\r\n\tvar slab = document.createElement(\"span\");\r\n\tslab.setAttribute(\"class\", \"terminus-id-label terminus-form-label terminus-control-label\");\r\n\tslab.appendChild(document.createTextNode(\"ID\"));\r\n\tsci.appendChild(slab);\r\n\tvar idip = document.createElement(\"input\");\r\n\tidip.setAttribute(\"type\", \"text\");\r\n\tidip.setAttribute(\"class\", \"terminus-form-value terminus-input-text\");\r\n\tidip.setAttribute(\"placeholder\", \"No spaces or special characters allowed in IDs\");\r\n\tsci.appendChild(idip);\r\n\tmfd.appendChild(sci);\r\n\tvar sci = document.createElement(\"div\");\r\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-form-field-spacing terminus-form-horizontal terminus-control-group\");\r\n\tvar slab = document.createElement(\"span\");\r\n\tslab.setAttribute(\"class\", \"terminus-title-label terminus-form-label terminus-control-label\");\r\n\tslab.appendChild(document.createTextNode(\"Title\"));\r\n\tvar titip = document.createElement(\"input\");\r\n\ttitip.setAttribute(\"type\", \"text\");\r\n\ttitip.setAttribute(\"placeholder\", \"A brief title for the Database\");\r\n\ttitip.setAttribute(\"class\", \"terminus-form-value terminus-input-text\");\r\n\tsci.appendChild(slab);\r\n\tsci.appendChild(titip);\r\n\tmfd.appendChild(sci);\r\n\tvar sci = document.createElement(\"div\");\r\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-form-field-spacing terminus-form-horizontal terminus-control-group\");\r\n\tvar slab = document.createElement(\"span\");\r\n\tslab.setAttribute(\"class\", \"terminus-title-label terminus-form-label terminus-control-label\");\r\n\tslab.appendChild(document.createTextNode(\"Description\"));\r\n\tsci.appendChild(slab);\r\n\tvar descip = document.createElement(\"textarea\");\r\n\tdescip.setAttribute(\"class\", \"terminus-textarea terminus-db-description terminus-textarea \");\r\n\tdescip.setAttribute(\"placeholder\", \"A short text describing the database and its purpose\");\r\n\tsci.appendChild(descip);\r\n\tmfd.appendChild(sci);\r\n\tvar sci = document.createElement(\"div\");\r\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-form-field-spacing terminus-form-horizontal terminus-control-group\");\r\n\tvar slab = document.createElement(\"span\");\r\n\tslab.setAttribute(\"class\", \"terminus-schema-label terminus-form-label terminus-control-label\");\r\n\tslab.appendChild(document.createTextNode(\"Import Schema\"));\r\n\tsci.appendChild(slab);\r\n\tvar schem = document.createElement(\"input\");\r\n\tschem.setAttribute(\"placeholder\", \"Terminus DB URL\");\r\n\tschem.setAttribute(\"type\", \"text\");\r\n\tschem.setAttribute(\"class\", \"terminus-form-value terminus-form-url terminus-input-text\");\r\n\r\n\tsci.appendChild(schem);\r\n\tmfd.appendChild(sci);\r\n\tvar sci = document.createElement(\"div\");\r\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-form-field-spacing terminus-form-horizontal terminus-control-group\");\r\n\tvar slab = document.createElement(\"span\");\r\n\tslab.setAttribute(\"class\", \"terminus-data-label terminus-form-label terminus-control-label\");\r\n\tslab.appendChild(document.createTextNode(\"Import Data\"));\r\n\tsci.appendChild(slab);\r\n\tvar datip = document.createElement(\"input\");\r\n\tdatip.setAttribute(\"type\", \"text\");\r\n\tdatip.setAttribute(\"placeholder\", \"Terminus DB URL\");\r\n\tdatip.setAttribute(\"class\", \"terminus-form-value terminus-form-url terminus-input-text\");\r\n\tsci.appendChild(datip);\r\n\t//mfd.appendChild(sci);\r\n\tvar butfield = document.createElement(\"div\");\r\n\tbutfield.setAttribute(\"class\", \"terminus-control-buttons\");\r\n\tvar cancbut = document.createElement(\"button\");\r\n\tcancbut.setAttribute(\"class\", \"terminus-control-button terminus-cancel-db-button terminus-btn\");\r\n\tcancbut.appendChild(document.createTextNode(\"Cancel\"));\r\n\tvar loadbut = document.createElement(\"button\");\r\n\tloadbut.setAttribute(\"class\", \"terminus-control-button terminus-create-db-button terminus-btn\");\r\n\tloadbut.appendChild(document.createTextNode(\"Create\"));\r\n\tvar self = this;\r\n\tvar gatherips = function(){\r\n\t\tvar input = {};\r\n\t\tinput.id = idip.value;\r\n\t\tinput.title = titip.value;\r\n\t\tinput.description = descip.value;\r\n\t\tinput.schema = schem.value;\r\n\t\tinput.data = datip.value;\r\n\t\treturn input;\r\n\t}\r\n\tvar self = this;\r\n\tloadbut.addEventListener(\"click\", function(){\r\n\t\tvar input = gatherips();\r\n\t\tself.ui.createDatabase(input);\r\n\t})\r\n\tcancbut.addEventListener(\"click\", function(){\r\n\t\tself.ui.showServerMainPage();\r\n\t})\r\n\tbutfield.appendChild(cancbut);\r\n\tbutfield.appendChild(loadbut);\r\n\tmfd.appendChild(butfield);\r\n\r\n\treturn scd;\r\n}\r\nmodule.exports={TerminusDBViewer:TerminusDBViewer,\r\n\t            TerminusDBController:TerminusDBController,\r\n\t            TerminusDBCreator:TerminusDBCreator}\r\n","function TerminusViolations(vios, ui){\r\n\tthis.ui = ui;\r\n\tthis.vios = [];\r\n\tvar nvios = [];\r\n\tfor(var i = 0; i<vios.length; i++){\r\n\t\tfor(var j = 0; j<nvios.length; j++){\r\n\t\t\tif(JSON.stringify(vios[i]) == JSON.stringify(nvios[j])) continue;\r\n\t\t}\r\n\t\tnvios.push(vios[i]);\r\n\t}\r\n\tfor(var i = 0; i<nvios.length; i++){\r\n\t\tthis.vios.push(new TerminusViolation(nvios[i], this.ui));\r\n\t}\r\n}\r\n\r\nTerminusViolations.prototype.getAsDOM = function(context_msg){\r\n\tvar vdom = document.createElement(\"div\");\r\n\tvdom.setAttribute(\"class\", \"terminus-violations terminus-show-msg-vio\");\r\n\tvar vioHeading = document.createElement(\"div\");\r\n\tvioHeading.setAttribute('class', 'terminus-violations-heading');\r\n\tvdom.appendChild(vioHeading);\r\n\tvar msg = this.vios.length + (this.vios.length > 1 ? \" Violations Detected\" : \" Violation Detected\");\r\n\tif(context_msg) msg += \" \" + context_msg;\r\n\tvioHeading.appendChild(document.createTextNode(msg));\r\n\tfor(var i = 0; i<this.vios.length; i++){\r\n\t\tvdom.appendChild(this.vios[i].getAsDOM());\r\n\t}\r\n\treturn vdom;\r\n}\r\n\r\n/*\r\n * Class for displaying violation reports as HTML\r\n */\r\nfunction TerminusViolation(vio, ui){\r\n\tthis.ui = ui;\r\n\tthis.vio = vio;\r\n}\r\n\r\nTerminusViolation.prototype.getAsDOM = function(){\r\n\tvar vdom = document.createElement(\"div\");\r\n\tvdom.setAttribute(\"class\", \"terminus-violation\");\r\n\tif(this.vio['@type']){\r\n\t\tvar msg = this.vio['vio:message'] || {\"@value\": \"\"};\r\n\t\tvdom.appendChild(this.getPropertyAsDOM(this.vio[\"@type\"], msg));\r\n\t}\r\n\tfor(var prop in this.vio){\r\n\t\tif(prop != \"vio:message\" && prop != \"@type\"){\r\n\t\t\tvdom.appendChild(this.getPropertyAsDOM(prop, this.vio[prop]));\r\n\t\t}\r\n\t}\r\n\treturn vdom;\r\n}\r\n\r\nTerminusViolation.prototype.getPropertyAsDOM = function(prop, val){\r\n\tvar pdom = document.createElement(\"div\");\r\n\tpdom.setAttribute(\"class\", \"terminus-violation-property\");\r\n\tvar ldom = document.createElement(\"span\");\r\n\tldom.setAttribute(\"class\", \"terminus-label terminus-violation-property-label\");\r\n\tldom.appendChild(document.createTextNode(prop));\r\n\tvar vdom = document.createElement(\"span\");\r\n\tvdom.setAttribute(\"class\", \"terminus-violation-property-value\");\r\n\tvdom.appendChild(document.createTextNode(val[\"@value\"]));\r\n\tpdom.appendChild(ldom);\r\n\tpdom.appendChild(vdom);\r\n\treturn pdom;\r\n}\r\n\r\nmodule.exports=TerminusViolations\r\n","const WOQLQuery = require('../query/WOQLQuery');\r\nconst WOQLResultsViewer = require('../query/WOQLResultsViewer');\r\nconst WOQLTextboxGenerator = require('../query/WOQLTextboxGenerator');\r\nconst TerminusPluginManager = require('../plugins/TerminusPlugin');\r\nconst HTMLFrameHelper = require('./HTMLFrameHelper');\r\n\r\nfunction TerminusQueryViewer(ui, options){\r\n\tthis.ui = ui;\r\n\tthis.options = options;\r\n\tthis.meta = {};\r\n\tthis.init();\r\n\tthis.generator = false;\r\n\tthis.result = false;\r\n\tthis.wquery = new WOQLQuery(ui.client, this.options, this.ui);\r\n\tthis.pman = new TerminusPluginManager();\r\n\tthis.gentype = (options && options.generator ? options.generator : \"textbox\");\r\n\tthis.generators = {\r\n\t\t\"textbox\" : { label: \"Simple Text Box\", value: \"textbox\"},\r\n\t}\r\n\tthis.loadGenerator();\r\n}\r\n\r\nTerminusQueryViewer.prototype.hasGeneratorOptions = function(){\r\n\treturn false;\r\n\tvar yup = false;\r\n\tfor(var gen in this.generators){\r\n\t\tif(yup) return true;\r\n\t\telse yup = true;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nTerminusQueryViewer.prototype.changeGenerator = function(ng){\r\n\tif(this.gentype != ng){\r\n\t\tthis.gentype = ng;\r\n\t\tthis.loadGenerator();\r\n\t\tthis.redrawGenerator();\r\n\t}\r\n}\r\nTerminusQueryViewer.prototype.redrawGenerator = function(q){\r\n\tTerminusClient.FrameHelper.removeChildren(this.inputDOM);\r\n\tthis.inputDOM.appendChild(this.getQueryButtonsDOM(q));\r\n}\r\n\r\nTerminusQueryViewer.prototype.loadGenerator = function(){\r\n\tvar self = this;\r\n\tvar nquery = function(q, settings){\r\n\t\tself.query(q, settings)\r\n\t}\r\n\tif(this.gentype == \"textbox\"){\r\n\t\tthis.generator = new WOQLTextboxGenerator(nquery, this, this.ui);\r\n\t}\r\n}\r\n\r\nTerminusQueryViewer.prototype.init = function(){\r\n\tvar wq = new WOQLQuery(this.ui.client, this.options, this.ui);\r\n\tvar woql = wq.getElementMetaDataQuery();\r\n\tvar self = this;\r\n\tself.meta = {};\r\n\twq.execute(woql).then(function(wresult){\r\n\t\tvar wqlR = new WOQLResultsViewer.WOQLResult(wresult, null ,null, self.ui);\r\n\t\tif(wqlR.hasBindings(wresult)){\r\n\t\t\tfor(var i = 0; i<wresult.bindings.length; i++){\r\n\t\t\t\tvar el = HTMLFrameHelper.getVariableValueFromBinding(\"Element\", wresult.bindings[i]);\r\n\t\t\t\tif(el && typeof self.meta[el] == \"undefined\"){\r\n\t\t\t\t\tself.meta[el] = wresult.bindings[i];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t})\r\n\t.catch(function(e){\r\n\t\tconsole.error(e);\r\n\t});\r\n}\r\n\r\n\r\nTerminusQueryViewer.prototype.query = function(val, settings, tab){\r\n\tvar self = this;\r\n\tTerminusClient.FrameHelper.removeChildren(this.resultDOM);\r\n\tthis.wquery.execute(val)\r\n\t.then(function(result){\r\n\t\tself.result = new WOQLResultsViewer.WOQLResultsViewer(self.ui, result, self.wquery, self.options, settings, true);\r\n\t\tvar nd = self.result.getAsDOM(self.resultDOM, true);\r\n\t\tif(nd){\r\n\t\t\t self.resultDOM.appendChild(nd);\r\n\t\t}\r\n\t})\r\n\t.catch(function(err){\r\n\t\tself.ui.showError(err);\r\n\t});\r\n}\r\n\r\nTerminusQueryViewer.prototype.getResultViewDom = function(){\r\n\tthis.resultDOM = document.createElement(\"div\");\r\n\tthis.resultDOM.setAttribute(\"class\", \"terminus-query-results\");\r\n}\r\n\r\nTerminusQueryViewer.prototype.getAsDOM = function(q){\r\n\tvar qbox = document.createElement(\"div\");\r\n\tqbox.setAttribute(\"class\", \"terminus-query-page\");\r\n\tif(this.hasGeneratorOptions()){\r\n\t\tqbox.appendChild(this.getQueryCreatorChoiceDOM(q));\r\n\t}\r\n\tthis.resultDOM = document.createElement(\"div\");\r\n\tthis.resultDOM.setAttribute(\"class\", \"terminus-query-results terminus-query-section\");\r\n\r\n\tvar qtHolder = document.createElement('span');\r\n\tqtHolder.setAttribute('style', 'display: flex;');\r\n\r\n\tthis.qTextBox = this.getQueryTextAreaDOM(q, qtHolder);\r\n\tthis.buttonsDOM = document.createElement(\"span\");\r\n\tthis.buttonsDOM.setAttribute(\"class\", \"terminus-query-input\");\r\n\tthis.buttonsDOM.appendChild(this.getQueryButtonsDOM(q, this.qTextBox));\r\n\r\n\tqtHolder.appendChild(this.buttonsDOM);\r\n\r\n\tqbox.appendChild(qtHolder);\r\n\tqbox.appendChild(this.resultDOM);\r\n\treturn qbox;\r\n}\r\n\r\nTerminusQueryViewer.prototype.getQueryCreatorChoiceDOM = function(){\r\n\tvar qcc = document.createElement(\"select\");\r\n\tqcc.setAttribute(\"class\", \"terminus-query-generator-selector\");\r\n\tfor(var c in this.generators){\r\n\t\tvar gen = this.generators[c];\r\n\t\tvar opt = document.createElement(\"option\");\r\n\t\topt.value = (gen.value ? gen.value : c);\r\n\t\tvar lab = (gen.label ? gen.label : c);\r\n\t\topt.appendChild(document.createTextNode(lab));\r\n\t\tqcc.appendChild(opt);\r\n\t}\r\n\tvar self = this;\r\n\tqcc.addEventListener(\"change\", function(){\r\n\t\tself.changeGenerator(this.value);\r\n\t});\r\n\treturn qcc;\r\n}\r\n\r\nTerminusQueryViewer.prototype.getQueryButtonsDOM = function(q, qip){\r\n\treturn this.generator.getAsDOM(q, qip);\r\n}\r\n\r\nTerminusQueryViewer.prototype.getQueryTextAreaDOM = function(q, box){\r\n\treturn this.generator.getQueryTextAreaDOM(q, box);\r\n}\r\n\r\nmodule.exports=TerminusQueryViewer\r\n","const TerminusClassChooser = require('../client/TerminusClassChooser');\r\nconst TerminusPropertyChooser = require('../client/TerminusPropertyChooser');\r\nconst TerminusDocumentChooser = require('../client/TerminusDocumentChooser');\r\nconst UTILS= require('../Utils')\r\n\r\nfunction WOQLTextboxGenerator(tq, qman, ui){\r\n\tthis.query = tq;\r\n\tthis.wquery = qman.wquery;\r\n\tthis.ui = ui;\r\n\t// default datatable settings if datatable plug in available\r\n\tthis.datatable = {};\r\n\tthis.datatable.pageLength = 20;\r\n\tthis.datatable.start = 0;\r\n}\r\n\r\nWOQLTextboxGenerator.prototype.gatherDatatableSettings = function(txtArea, queryName){\r\n\tthis.datatable.qTextDom =  txtArea;\r\n\tthis.datatable.query =  queryName;\r\n\tthis.datatable.chosenValue = null;\r\n}\r\n\r\nWOQLTextboxGenerator.prototype.getQueryButtonGroups = function(qbox){\r\n\tvar row = document.createElement('div');\r\n\trow.setAttribute('class', 'terminus-query-group-row');\r\n\tqbox.appendChild(row);\r\n\treturn row;\r\n}\r\n\r\nWOQLTextboxGenerator.prototype.qGroupQueries = function(qrow, header, descr){\r\n\tvar g = document.createElement('button');\r\n\tvar self = this;\r\n\tg.addEventListener('click', function(e){\r\n\t\tself.ui.clearMessages();\r\n\t\tif(header == 'Data Queries'){ // to ensure click event is not on button but on select instead so no need to hide\r\n\t\t\tvar target = e.target || e.srcElement,\r\n        \ttext = target.textContent || target.innerText;\r\n\t\t\tif((target.nodeName == 'SELECT')) return;\r\n\t\t}\r\n\t\telse if(header == 'Document Queries'){\r\n\t\t\tvar target = e.target || e.srcElement,\r\n        \ttext = target.textContent || target.innerText;\r\n\t\t\tif((target.nodeName == 'INPUT')) return;\r\n\t\t}\r\n\t\tfor(var i=0; i<this.children.length ; i++){\r\n\t\t\tUTILS.toggleVisibility(this.children[i]);\r\n\t\t}\r\n\t\tvar qeb = document.getElementsByClassName('query-example-buttons');\r\n\t\tfor(var i=0; i<qeb.length ; i++){\r\n\t\t\tif(this != qeb[i]){\r\n\t\t\t\tfor(var j=0; j<qeb[i].children.length ; j++){\r\n\t\t\t\t\tif(qeb[i].children[j].classList.contains('terminus-display')){\r\n\t\t\t\t\t\tqeb[i].children[j].classList.remove('terminus-display');\r\n\t\t\t\t\t\tqeb[i].children[j].classList.add('terminus-hide');\r\n\t\t\t\t    }\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t})\r\n\r\n\tg.setAttribute('class', 'terminus-group-box terminus-pointer query-example-buttons');\r\n\r\n\tvar cd = document.createElement('div');\r\n\tcd.setAttribute('class', 'terminus-group');\r\n\tg.appendChild(cd);\r\n\r\n\tvar ch = document.createElement('div');\r\n\tch.setAttribute('class', 'terminus-group-header');\r\n\tcd.appendChild(ch);\r\n\r\n\tvar d = document.createElement('div');\r\n\td.setAttribute('class', 'terminus-query-block-headers')\r\n\td.appendChild(document.createTextNode(header));\r\n\tch.appendChild(d);\r\n\tic = document.createElement('i');\r\n    ic.setAttribute('class', 'terminus-hand-pointer-float fa fa-hand-pointer');\r\n\td.appendChild(ic);\r\n\r\n\tvar t = document.createElement('h5');\r\n\tt.setAttribute('class', 'terminus-group-sub-title terminus-hide');\r\n\tt.appendChild(document.createTextNode(descr));\r\n\tg.appendChild(t);\r\n\r\n\tqrow.appendChild(g);\r\n\r\n\treturn g;\r\n}\r\n\r\nWOQLTextboxGenerator.prototype.setDatatableSettings = function(query){\r\n\tif(query.limit){\r\n\t\tthis.datatable.pageLength = query.limit[0];\r\n\t\tthis.datatable.start = query.limit[1].start[0];\r\n\t}\r\n\t/*\r\n\tvar newQuery = query.replace(/\\s/g,'');  // remove spaces\r\n\tvar searchStr = 'limit(';\r\n\tif(newQuery.indexOf(searchStr) !== -1){\r\n\t\tvar remString = newQuery.substring(searchStr.length, newQuery.length);\r\n\t\tvar limit = remString.substr(0, remString.indexOf(','));\r\n\t\tthis.datatable.pageLength = limit;\r\n\t\tthis.datatable.start = 0;\r\n\t}*/\r\n}\r\n\r\nWOQLTextboxGenerator.prototype.getQueryTextAreaDOM = function(q, box){\r\n\tvar qbox = document.createElement(\"span\");\r\n\tqbox.setAttribute(\"class\", \"terminus-query-textbox-input terminus-query-section\");\r\n\r\n\tvar eqh = document.createElement(\"H3\");\r\n\teqh.appendChild(document.createTextNode(\"Enter Query\"));\r\n\teqh.setAttribute('class', 'terminus-full-css-margin-top terminus-module-head');\r\n\tqbox.appendChild(eqh);\r\n\r\n\tvar qip = document.createElement(\"textarea\");\r\n\tqip.setAttribute(\"class\", \"terminus-query-box\");\r\n\tqip.setAttribute(\"placeholder\", \"Enter new query or load queries from example buttons provided below ...\");\r\n\tqip.setAttribute(\"style\", \"min-width: 400px; min-height: 60px;\");\r\n\tif(q) qip.value = JSON.stringify(q,undefined, 2);\r\n\tqbox.appendChild(qip);\r\n\tUTILS.stylizeEditor(this.ui, qip, 'query', 'javascript');\r\n\tvar self = this;\r\n\tvar qbut = document.createElement(\"button\");\r\n\tqbut.setAttribute(\"class\", \"terminus-control-button terminus-btn\")\r\n\tqbut.appendChild(document.createTextNode(\"Send Query\"));\r\n\tqbut.addEventListener(\"click\", function(){\r\n\t\tself.ui.clearMessages();\r\n\t\ttry {\r\n\t\t\tvar qval = JSON.parse(qip.value);\r\n\t\t\tif(self.ui.pluginAvailable(\"datatables\")){\r\n\t\t\t\t// pass current Example query scope while editing the text editor\r\n\t\t\t\tself.gatherDatatableSettings(qip, self.datatable.query);\r\n\t\t\t\tself.setDatatableSettings(qval);\r\n\t\t\t\tself.query(qval, self.datatable);\r\n\t\t\t}\r\n\t\t\telse self.query(qval);\r\n\t\t}\r\n\t\tcatch(e){\r\n\t\t\talert(\"Failed to parse Query \" + e.toString());\r\n\t\t}\r\n\t})\r\n\tqbox.appendChild(qbut);\r\n\tbox.appendChild(qbox);\r\n\treturn qip;\r\n}\r\n\r\nWOQLTextboxGenerator.prototype.getAsDOM = function(q, qip){\r\n\tvar qbox = document.createElement(\"div\");\r\n\tqbox.setAttribute(\"class\", \"terminus-query-textbox-input\");\r\n\tvar qbuts = document.createElement(\"div\");\r\n\tqbuts.setAttribute(\"class\", \"terminus-control-buttons\");\r\n\t//qbuts.appendChild(qbut);\r\n\tqbox.appendChild(qbuts);\r\n\tvar qexs = document.createElement(\"div\");\r\n\tqexs.setAttribute(\"class\", \"terminus-query-examples terminus-db-list-title\");\r\n\tvar qh = document.createElement(\"H3\");\r\n\tqh.appendChild(document.createTextNode(\"Saved Queries\"));\r\n\tqh.setAttribute('class', 'terminus-full-css-margin-top terminus-module-head');\r\n\tqexs.appendChild(qh);\r\n\r\n\tvar qrow = this.getQueryButtonGroups(qexs);\r\n\tqexs.appendChild(qrow);\r\n\r\n\t/* grouping class queries */\r\n\tvar qcGroup = this.qGroupQueries(qrow, 'Schema Queries', '');\r\n\r\n\tvar nqbut = document.createElement(\"button\");\r\n\tnqbut.appendChild(document.createTextNode(\"Show All Classes\"));\r\n\tnqbut.setAttribute(\"class\", \"terminus-control-button terminus-q-btn\");\r\n\tnqbut.addEventListener(\"click\", function(){\r\n\t\tself.ui.clearMessages();\r\n\t\tUTILS.deleteStylizedEditor(self.ui, qip);\r\n\t\tvar qval = self.wquery.getClassMetaDataQuery(null, self.datatable.pageLength, self.datatable.start);\r\n\t\tqip.value = JSON.stringify(qval,undefined, 2);\r\n\t\tUTILS.stylizeEditor(self.ui, qip, 'query', 'javascript');\r\n\t\tif(self.ui.pluginAvailable(\"datatables\")){\r\n\t\t\tself.gatherDatatableSettings(qip, 'Show_All_Classes');\r\n\t\t\tself.query(qval, self.datatable);\r\n\t\t}\r\n\t\telse self.query(qval);\r\n\t})\r\n\r\n\tvar aqbut = document.createElement(\"button\");\r\n\taqbut.appendChild(document.createTextNode(\"Show Document Classes\"));\r\n\taqbut.setAttribute(\"class\", \"terminus-control-button terminus-q-btn\");\r\n\taqbut.addEventListener(\"click\", function(){\r\n\t\tself.ui.clearMessages();\r\n\t\tUTILS.deleteStylizedEditor(self.ui, qip);\r\n\t\tvar qvalue = self.wquery.getClassMetaDataQuery(self.wquery.getConcreteDocumentClassPattern(\"v:Element\"),\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tself.datatable.pageLength, self.datatable.start);\r\n\t\tqip.value = JSON.stringify(qvalue,undefined, 2);\r\n\t\tUTILS.stylizeEditor(self.ui, qip, 'query', 'javascript');\r\n\t\tif(self.ui.pluginAvailable(\"datatables\")){\r\n\t\t\tself.gatherDatatableSettings(qip, 'Show_Document_Classes');\r\n\t\t\tself.query(qvalue, self.datatable);\r\n\t\t}\r\n\t\telse self.query(qvalue);\r\n\t})\r\n\r\n\tvar ebut = document.createElement(\"button\");\r\n\tebut.appendChild(document.createTextNode(\"Show All Schema Elements\"));\r\n\tebut.setAttribute(\"class\", \"terminus-control-button terminus-q-btn\");\r\n\tvar self = this;\r\n\tebut.addEventListener(\"click\", function(){\r\n\t\tself.ui.clearMessages();\r\n\t\tUTILS.deleteStylizedEditor(self.ui, qip);\r\n\t\tvar qval = self.wquery.getElementMetaDataQuery(null, self.datatable.pageLength, self.datatable.start);\r\n\t\tqip.value = JSON.stringify(qval,undefined, 2);\r\n\t\tUTILS.stylizeEditor(self.ui, qip, 'query', 'javascript');\r\n\t\tif(self.ui.pluginAvailable(\"datatables\")){\r\n\t\t\tself.gatherDatatableSettings(qip, 'Show_All_Schema_Elements');\r\n\t\t\tself.query(qval, self.datatable);\r\n\t\t}\r\n\t\telse self.query(qval);\r\n\t})\r\n\tvar dbut = document.createElement(\"button\");\r\n\tdbut.appendChild(document.createTextNode(\"Show All Documents\"));\r\n\tdbut.setAttribute(\"class\", \"terminus-control-button terminus-q-btn\");\r\n\tdbut.addEventListener(\"click\", function(){\r\n\t\tself.ui.clearMessages();\r\n\t\tUTILS.deleteStylizedEditor(self.ui, qip);\r\n\t\tvar qvalue = self.wquery.getAllDocumentQuery(null, self.datatable.pageLength, self.datatable.start);\r\n\t\tqip.value = JSON.stringify(qvalue,undefined, 2);\r\n\t\tUTILS.stylizeEditor(self.ui, qip, 'query', 'javascript');\r\n\t\tif(self.ui.pluginAvailable(\"datatables\")){\r\n\t\t\tself.gatherDatatableSettings(qip, 'Show_All_Documents');\r\n\t\t\tself.query(qvalue, self.datatable);\r\n\t\t}\r\n\t\telse self.query(qvalue);\r\n\t})\r\n\tvar pbut = document.createElement(\"button\");\r\n\tpbut.appendChild(document.createTextNode(\"Show All Data\"));\r\n\tpbut.setAttribute(\"class\", \"terminus-control-button terminus-q-btn\");\r\n\tpbut.addEventListener(\"click\", function(){\r\n\t\tself.ui.clearMessages();\r\n\t\tUTILS.deleteStylizedEditor(self.ui, qip);\r\n\t\tvar qvalue = self.wquery.getEverythingQuery(null, self.datatable.pageLength, self.datatable.start);\r\n\t\tqip.value = JSON.stringify(qvalue,undefined, 2);\r\n\t\tUTILS.stylizeEditor(self.ui, qip, 'query', 'javascript');\r\n\t\tif(self.ui.pluginAvailable(\"datatables\")){\r\n\t\t\tself.gatherDatatableSettings(qip, 'Show_All_Data');\r\n\t\t\tself.query(qvalue, self.datatable);\r\n\t\t}\r\n\t\telse self.query(qvalue);\r\n\t})\r\n\r\n\tvar prbut = document.createElement(\"button\");\r\n\tprbut.appendChild(document.createTextNode(\"Show All Properties\"));\r\n\tprbut.setAttribute(\"class\", \"terminus-control-button terminus-q-btn\");\r\n\tprbut.addEventListener(\"click\", function(){\r\n\t\tself.ui.clearMessages();\r\n\t\tUTILS.deleteStylizedEditor(self.ui, qip);\r\n\t\tvar qvalue = self.wquery.getPropertyListQuery(null, self.datatable.pageLength, self.datatable.start);\r\n\t\tqip.value = JSON.stringify(qvalue,undefined, 2);\r\n\t\tUTILS.stylizeEditor(self.ui, qip, 'query', 'javascript');\r\n\t\tif(self.ui.pluginAvailable(\"datatables\")){\r\n\t\t\tself.gatherDatatableSettings(qip, 'Show_All_Properties');\r\n\t\t\tself.query(qvalue, self.datatable);\r\n\t\t}\r\n\t\telse self.query(qvalue);\r\n\t})\r\n\r\n\t/* grouping data queries */\r\n\tvar qdGroup = this.qGroupQueries(qrow, 'Data Queries', '');\r\n\r\n\tvar termcc = new TerminusClassChooser(this.ui);\r\n\ttermcc.empty_choice = \"Show data of type\";\r\n\tvar self = this;\r\n\ttermcc.change = function(new_class){\r\n\t\tself.ui.clearMessages();\r\n\t\tif(new_class){\r\n\t\t\tUTILS.deleteStylizedEditor(self.ui, qip);\r\n\t\t\tvar qvalue = self.wquery.getDataOfChosenClassQuery(new_class, self.datatable.pageLength, self.datatable.start);\r\n\t\t\tqip.value = JSON.stringify(qvalue,undefined, 2);\r\n\t\t\tUTILS.stylizeEditor(self.ui, qip, 'query', 'javascript');\r\n\t\t\tif(self.ui.pluginAvailable(\"datatables\")){\r\n\t\t\t\tself.gatherDatatableSettings(qip, 'Show_Data_Class');\r\n\t\t\t\tself.datatable.chosenValue = new_class; // set chosen val from drop down\r\n\t\t\t\tself.query(qvalue, self.datatable);\r\n\t\t\t}\r\n\t\t\telse self.query(qvalue);\r\n\t\t}\r\n\t}\r\n\tvar tcdom = termcc.getAsDOM('terminus-query-select');\r\n\r\n\tvar termpc = new TerminusPropertyChooser(this.ui);\r\n\ttermpc.empty_choice = \"Show property data\";\r\n\tvar self = this;\r\n\ttermpc.change = function(new_property){\r\n\t\tif(new_property){\r\n\t\t\tUTILS.deleteStylizedEditor(self.ui, qip);\r\n\t\t\tvar qvalue = self.wquery.getDataOfChosenPropertyQuery(new_property, self.datatable.pageLength, self.datatable.start);\r\n\t\t\tqip.value = JSON.stringify(qvalue,undefined, 2);\r\n\t\t\tUTILS.stylizeEditor(self.ui, qip, 'query', 'javascript');\r\n\t\t\tif(self.ui.pluginAvailable(\"datatables\")){\r\n\t\t\t\tself.gatherDatatableSettings(qip, 'Show_Property_Class');\r\n\t\t\t\tself.datatable.chosenValue = new_property; // set chosen val from drop down\r\n\t\t\t\tself.query(qvalue, self.datatable);\r\n\t\t\t}\r\n\t\t\telse self.query(qvalue);\r\n\t\t}\r\n\t}\r\n\r\n\t/* grouping document queries */\r\n\tvar qdocGroup = this.qGroupQueries(qrow, 'Document Queries', '');\r\n\r\n\tvar pdom = termpc.getAsDOM();\r\n\r\n\tvar docch = new TerminusDocumentChooser(this.ui);\r\n\tdocch.change = function(val){\r\n\t\tself.ui.clearMessages();\r\n\t\tUTILS.deleteStylizedEditor(self.ui, qip);\r\n\t\tvar qvalue = self.wquery.getDocumentQuery(val, self.datatable.pageLength, self.datatable.start);\r\n\t\tqip.value = JSON.stringify(qvalue,undefined, 2);\r\n\t\tUTILS.stylizeEditor(self.ui, qip, 'query', 'javascript');\r\n\t\tif(self.ui.pluginAvailable(\"datatables\")){\r\n\t\t\tself.gatherDatatableSettings(qip, 'Show_Document_Info_by_Id');\r\n\t\t\tself.datatable.chosenValue = val;\r\n\t\t\tself.query(qvalue, self.datatable);\r\n\t\t}\r\n\t\telse self.query(qvalue);\r\n\t}\r\n\tvar docdom = docch.getAsDOM('terminus-query-select');\r\n\r\n\tvar d2ch = new TerminusDocumentChooser(this.ui, TerminusClient.FrameHelper.unshorten(\"tcs:Document\"));\r\n\td2ch.view = \"label\";\r\n\td2ch.change = docch.change;\r\n\tvar d2dom = d2ch.getAsDOM('terminus-query-select');\r\n\tvar p = document.createElement(\"p\");\r\n\tp.appendChild(d2dom);\r\n\r\n\t/* class queries */\r\n\tvar clGroup = document.createElement('div');\r\n\tclGroup.setAttribute('class', 'terminus-hide ');\r\n\tclGroup.appendChild(ebut);\r\n\tvar br = document.createElement('BR');\r\n\tclGroup.appendChild(br);\r\n\tclGroup.appendChild(nqbut);\r\n\tvar br = document.createElement('BR');\r\n\tclGroup.appendChild(br);\r\n\tclGroup.appendChild(aqbut);\r\n\tvar br = document.createElement('BR');\r\n\tclGroup.appendChild(br);\r\n\tclGroup.appendChild(prbut);\r\n\tvar br = document.createElement('BR');\r\n\tclGroup.appendChild(br);\r\n\tqcGroup.appendChild(clGroup);\r\n\r\n\tqbox.appendChild(qexs);\r\n\r\n\t/* data queries */\r\n\tvar dtGroup = document.createElement('div');\r\n\tdtGroup.setAttribute('class', 'terminus-hide');\r\n\tdtGroup.appendChild(tcdom);\r\n\tdtGroup.appendChild(pdom);\r\n\r\n\tvar br = document.createElement('BR');\r\n\tdtGroup.appendChild(br);\r\n\tdtGroup.appendChild(pbut);\r\n\tqdGroup.appendChild(dtGroup);\r\n\r\n\r\n\t/* document queries */\r\n\tvar docGroup = document.createElement('div');\r\n\tdocGroup.setAttribute('class', 'terminus-hide');\r\n\tdocGroup.appendChild(docdom);\r\n\tdocGroup.appendChild(dbut);\r\n\t//docGroup.appendChild(p);\r\n\tqdocGroup.appendChild(docGroup);\r\n\r\n\treturn qbox;\r\n}\r\n\r\nmodule.exports=WOQLTextboxGenerator\r\n","/*\r\n * Utility Property which runs a query against the schema and presents the returned Propertyes as a drop-down / Property filter list\r\n */\r\nconst WOQLQuery = require('../query/WOQLQuery');\r\nconst HTMLFrameHelper = require('./HTMLFrameHelper');\r\n\r\nTerminusPropertyChooser = function(ui, filter){\r\n\tthis.ui = ui;\r\n\tthis.choice = false;\r\n\tthis.filter = filter;\r\n}\r\n\r\nTerminusPropertyChooser.prototype.setRoot = function(root){\r\n\tthis.root = root;\r\n}\r\n\r\nTerminusPropertyChooser.prototype.setFilter = function(filter){\r\n\tthis.filter = filter;\r\n}\r\n\r\nTerminusPropertyChooser.prototype.change = function(cls){\r\n\talert(\"Need to specify Property chooser function (\" + cls + \")\");\r\n}\r\n\r\nTerminusPropertyChooser.prototype.getAsDOM = function(){\r\n\tvar ccdom = document.createElement(\"span\");\r\n\tccdom.setAttribute(\"Class\", \"terminus-Class-chooser\");\r\n\tvar ccsel = document.createElement(\"select\");\r\n\tccsel.setAttribute(\"Class\", \" terminus-type-select terminus-query-select\");\r\n\tvar self = this;\r\n\tccsel.addEventListener(\"change\", function(){\r\n\t\tif(this.value != this.choice){\r\n\t\t\tthis.choice = this.value;\r\n\t\t\tself.change(this.value);\r\n\t\t}\r\n\t});\r\n\tccdom.appendChild(ccsel);\r\n\tvar wq = new WOQLQuery(this.ui.client, false, this.ui);\r\n\tvar woql = wq.getPropertyListQuery(this.filter);\r\n\tvar self = this;\r\n\twq.execute(woql)\r\n\t.then(function(response){\r\n\t\tvar opts = self.getResultsAsOptions(response);\r\n\t\tfor(var i = 0; i<opts.length; i++){\r\n\t\t\tccsel.appendChild(opts[i]);\r\n\t\t}\r\n\t});\r\n\treturn ccdom;\r\n}\r\n\r\nTerminusPropertyChooser.prototype.getResultsAsOptions = function(clist){\r\n\tvar choices = [];\r\n\tif(this.empty_choice){\r\n\t\tvar opt1 = document.createElement(\"option\");\r\n\t\topt1.setAttribute(\"Class\", \"terminus-class-choice terminus-empty-choice\");\r\n\t\topt1.value = \"\";\r\n\t\topt1.appendChild(document.createTextNode(this.empty_choice));\r\n\t\tchoices.push(opt1);\r\n\t}\r\n\tvar labopt = document.createElement(\"option\");\r\n\tlabopt.setAttribute(\"Class\", \"terminus-class-choice\");\r\n\tlabopt.value = \"rdfs:label\";\r\n\tlabopt.appendChild(document.createTextNode(\"Label\"));\r\n\tchoices.push(labopt);\r\n\r\n\tvar comopt = document.createElement(\"option\");\r\n\tcomopt.setAttribute(\"Class\", \"terminus-class-choice\");\r\n\tcomopt.value = \"rdfs:comment\";\r\n\tcomopt.appendChild(document.createTextNode(\"Comment\"));\r\n\tchoices.push(comopt);\r\n\r\n\tif(clist.bindings){\r\n\t\tvar added = [];\r\n\t\tfor(var i = 0; i<clist.bindings.length; i++){\r\n\t\t\tvar cprop = HTMLFrameHelper.getVariableValueFromBinding(\"Property\", clist.bindings[i]);\r\n\t\t\tif(cprop && added.indexOf(cprop) == -1){\r\n\t\t\t\tadded.push(cprop);\r\n\t\t\t\tvar opt = document.createElement(\"option\");\r\n\t\t\t\topt.setAttribute(\"Class\", \"terminus-class-choice\");\r\n\t\t\t\topt.value = cprop;\r\n\t\t\t\tvar lab = HTMLFrameHelper.getVariableValueFromBinding(\"Label\", clist.bindings[i]);\r\n\t\t\t\tif(!lab || lab == \"unknown\"){\r\n\t\t\t\t\tlab = TerminusClient.FrameHelper.labelFromURL(cprop);\r\n\t\t\t\t}\r\n\t\t\t\tif(lab[\"@value\"]) lab = lab[\"@value\"];\r\n\t\t\t\topt.appendChild(document.createTextNode(lab));\r\n\t\t\t\tchoices.push(opt);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn choices;\r\n}\r\n\r\n\r\n\r\nmodule.exports=TerminusPropertyChooser\r\n","function TerminusMappingViewer(ui, mode){\r\n\tthis.ui = ui;\r\n\tthis.mode = (mode ? mode : \"data\");\r\n}\r\n\r\nTerminusMappingViewer.prototype.getAsDOM = function(){\r\n\tvar scd = document.createElement(\"div\");\r\n\tscd.setAttribute(\"class\", \"terminus-mapping-page terminus-page\");\r\n\tvar tsel = document.createElement(\"select\");\r\n\tvar o1 = document.createElement(\"option\");\r\n\to1.value = \"data\";\r\n\to1.appendChild(document.createTextNode(\"Data Map\"))\r\n\ttsel.appendChild(o1);\r\n\tvar o2 = document.createElement(\"option\");\r\n\to2.value = \"model\";\r\n\to2.appendChild(document.createTextNode(\"Model Map\"))\r\n\ttsel.appendChild(o2);\r\n\tvar ff = this.getFormFieldDOM(\"Map Type\");\r\n\tff.appendChild(tsel);\r\n\tscd.appendChild(ff);\r\n\tvar source = this.getFormField(scd, \"Map Source\");\r\n\tvar target = this.getFormField(scd, \"Map Target\");\r\n\tvar queries = this.getFormField(scd, \"Queries\");\r\n\tvar options = this.getFormField(scd, \"Options\");\r\n\t\r\n\tvar mdom = this.getFormFieldDOM(\"Existing Mapping\");\r\n\tvar mapping = document.createElement(\"input\");\r\n\tmapping.setAttribute(\"type\", \"text\");\r\n\tmapping.setAttribute(\"size\", 80);\r\n\tmdom.appendChild(mapping);\r\n\tscd.appendChild(mdom);\r\n\t\r\n\tvar submit = document.createElement(\"button\");\r\n\tsubmit.setAttribute(\"class\", \"terminus-btn terminus-control-button\");\r\n\tsubmit.appendChild(document.createTextNode(\"Execute Mapping\"));\r\n\tvar self = this;\r\n\tsubmit.addEventListener(\"click\", function(){\r\n\t\tvar jsonip = {\r\n\t\t\tmap_source: JSON.parse(source.value),\r\n\t\t};\r\n\t\tif(tsel.value == \"data\"){\r\n\t\t\tjsonip[\"rdf:type\"] = \"dcogmodel:DataMap\";\r\n\t\t}\r\n\t\telse {\r\n\t\t\tjsonip[\"rdf:type\"] = \"dcogmodel:ModelMap\";\t\t\t\r\n\t\t}\r\n\t\tif(target.value) jsonip.map_target = target.value;\r\n\t\tif(queries.value) jsonip.queries = queries.value;\r\n\t\tif(options.value) jsonip.options = options.value;\r\n\t\tif(mapping.value) jsonip.mapping = mapping.value;\r\n\t\tself.ui.client.update(false, jsonip);\r\n\t})\r\n\tscd.appendChild(submit);\r\n\treturn scd;\r\n}\r\n\r\nTerminusMappingViewer.prototype.getFormFieldDOM = function(label){\r\n\tvar sci = document.createElement(\"div\");\r\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-mapping-field\");\r\n\tvar lab = document.createElement(\"span\");\r\n\tlab.setAttribute(\"class\", \"terminus-form-label terminus-mapping-label\");\r\n\tlab.appendChild(document.createTextNode(label));\r\n\tsci.appendChild(lab);\r\n\treturn sci;\r\n}\r\n\r\nTerminusMappingViewer.prototype.getFormField = function(holder, label){\r\n\tvar ff = this.getFormFieldDOM(label);\r\n\tvar source = document.createElement(\"textarea\");\r\n\tsource.setAttribute(\"class\", \"terminus-form-value terminus-textarea\");\r\n\tff.appendChild(source);\r\n\tholder.appendChild(ff);\r\n\treturn source;\r\n}\r\n\r\nmodule.exports=TerminusMappingViewer\r\n","/*\r\n * Draws the screen for viewing and updating the schema\r\n * and provides wrappers around the client's schema API\r\n */\r\nconst TerminusClassChooser = require('./TerminusClassChooser');\r\nconst TerminusDocumentViewer = require('./TerminusDocument');\r\nconst UTILS=require('../Utils')\r\n\r\nfunction TerminusSchemaViewer(ui){\r\n\tthis.ui = ui;\r\n\tthis.mode = \"view\";\r\n\tthis.format = \"turtle\";\r\n\tthis.confirm_before_update = false;\r\n}\r\n\r\n/*\r\n * Retrieves schema from API and writes the response into the page\r\n */\r\nTerminusSchemaViewer.prototype.getAsDOM = function(){\r\n\tthis.holder = document.createElement(\"div\");\r\n\tthis.controldom = document.createElement(\"div\");\r\n\tthis.controldom.setAttribute(\"class\", \"terminus-schema-controls\");\r\n\tthis.pagedom = document.createElement(\"div\");\r\n\tthis.pagedom.setAttribute(\"class\", \"terminus-schema-viewer\");\r\n\tthis.loadSchema();\r\n\tthis.holder.appendChild(this.controldom);\r\n\tthis.holder.appendChild(this.pagedom);\r\n\treturn this.holder;\r\n}\r\n\r\nTerminusSchemaViewer.prototype.loadSchema = function(msg, msgtype){\r\n\tvar self = this;\r\n\tthis.ui.showBusy(\"Fetching Database Schema\");\r\n\tthis.ui.client.getSchema(false, {\"terminus:encoding\": \"terminus:\" + this.format})\r\n\t.then(function(response){\r\n\t\tself.ui.clearBusy();\r\n\t\tself.schema = response;\r\n\t\tself.refreshPage(msg, msgtype);\r\n\t})\r\n\t.catch(function(error){\r\n\t\tself.ui.clearBusy();\r\n\t\tself.ui.showError(error);\r\n\t});\r\n}\r\n\r\nTerminusSchemaViewer.prototype.resetControlDOM = function(){\r\n\tTerminusClient.FrameHelper.removeChildren(this.controldom);\r\n\tif(this.mode == \"edit\"){\r\n\t\tthis.controldom.appendChild(this.getSchemaSaveButtons());\r\n\t}\r\n\telse if(this.mode == \"import\"){\r\n\t\tthis.controldom.appendChild(this.getSchemaImportActionButtons());\r\n\t}\r\n\telse if(this.mode == \"class_frame\"){\r\n\t\tif(this.ui.showControl(\"get_schema\")){\r\n\t\t\tthis.controldom.appendChild(this.getShowSchemaButton());\r\n\t\t}\r\n\t\tif(this.ui.showControl(\"class_frame\")){\r\n\t\t\tthis.controldom.appendChild(this.getClassFrameChooser());\r\n\t\t}\r\n\t}\r\n\telse if(this.mode == \"view\"){\r\n\t\tif(this.ui.showControl(\"update_schema\")){\r\n\t\t\tthis.controldom.appendChild(this.getSchemaEditButton());\r\n\t\t}\r\n\t\tif(this.ui.showControl(\"import_schema\")){\r\n\t\t\tthis.controldom.appendChild(this.getImportButton());\r\n\t\t}\r\n\t\tif(this.ui.showControl(\"schema_format\")){\r\n\t\t\tthis.controldom.appendChild(this.getFormatChoices());\r\n\t\t}\r\n\t\tif(this.ui.showControl(\"class_frame\")){\r\n\t\t\tthis.controldom.appendChild(this.getClassFrameChooser());\r\n\t\t}\r\n\t}\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getFormatChoices = function(){\r\n\tvar fc = document.createElement(\"select\");\r\n\tfc.setAttribute(\"class\", \"terminus-form-select terminus-schema-format terminus-type-select\");\r\n\tvar tc = document.createElement(\"option\");\r\n\ttc.setAttribute(\"class\", \"terminus-schema-turtle\");\r\n\ttc.value = \"turtle\";\r\n\ttc.appendChild(document.createTextNode(\"Turtle\"));\r\n\tif(this.format == \"turtle\") tc.selected = true;\r\n\tfc.appendChild(tc);\r\n\tvar tj = document.createElement(\"option\");\r\n\ttj.setAttribute(\"class\", \"terminus-schema-jsonld\");\r\n\ttj.value = \"jsonld\";\r\n\ttj.appendChild(document.createTextNode(\"Json LD\"));\r\n\tif(this.format == \"jsonld\") tj.selected = true;\r\n\tfc.appendChild(tj);\r\n\tvar self = this;\r\n\tfc.addEventListener(\"change\", function(e){\r\n\t\tself.format = this.value;\r\n\t\tself.loadSchema();\r\n\t});\r\n\treturn fc;\r\n}\r\n\r\n\r\nTerminusSchemaViewer.prototype.refreshPage = function(msg, msgtype){\r\n\tif(this.controldom) this.resetControlDOM();\r\n\tif(this.pagedom) this.refreshMainPage(msg, msgtype);\r\n}\r\n\r\nTerminusSchemaViewer.prototype.refreshMainPage = function(msg, msgtype){\r\n\tTerminusClient.FrameHelper.removeChildren(this.pagedom);\r\n\tif(this.mode == 'view'){\r\n\t\tthis.pagedom.appendChild(this.getSchemaViewDOM());\r\n\t}\r\n\telse if(this.mode == \"edit\"){\r\n\t\tthis.pagedom.appendChild(this.getSchemaEditDOM());\r\n\t}\r\n\telse if(this.mode == \"import\"){\r\n\t\tthis.pagedom.appendChild(this.getSchemaImportDOM());\r\n\t}\r\n\telse if(this.mode == \"class_frame\"){\r\n\t\tthis.pagedom.appendChild(this.getClassFrameDOM());\r\n\t}\r\n\tif(msg){\r\n\t\tthis.ui.showMessage(msg, msgtype);\r\n\t}\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getSchemaSaveButtons = function(){\r\n\tvar ssb = document.createElement(\"span\");\r\n\tssb.setAttribute(\"class\", \"terminus-schema-save-buttons\");\r\n\tssb.appendChild(this.getCancelButton());\r\n\tssb.appendChild(this.getSaveButton());\r\n\treturn ssb;\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getSchemaImportActionButtons = function(){\r\n\tvar ssb = document.createElement(\"span\");\r\n\tssb.setAttribute(\"class\", \"terminus-schema-import-buttons\");\r\n\tssb.appendChild(this.getCancelButton(true));\r\n\tssb.appendChild(this.getImportSaveButton());\r\n\treturn ssb;\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getShowSchemaButton = function(){\r\n\tvar self = this;\r\n\tvar func = function(){\r\n\t\tself.ui.clearMessages();\r\n\t\tself.mode = \"view\";\r\n\t\tself.refreshPage();\r\n\t}\r\n\treturn this.getSchemaButton(\"View Schema\", \"get_schema\", func);\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getImportPreviewButton = function(){\r\n\tvar self = this;\r\n\tvar func = function(){\r\n\t\tself.ui.clearMessages();\r\n\t\tself.mode = \"preview\";\r\n\t\tself.refreshPage();\r\n\t}\r\n\treturn this.getSchemaButton(\"Preview\", \"preview\", func);\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getCancelButton = function(is_import){\r\n\tvar self = this;\r\n\tvar func = function(){\r\n\t\tself.ui.clearMessages();\r\n\t\tself.mode = \"view\";\r\n\t\tif(is_import){\r\n\t\t\tself.ui.redraw();\r\n\t\t}\r\n\t\telse {\r\n\t\t\tself.refreshPage();\r\n\t\t}\r\n\t}\r\n\treturn this.getSchemaButton(\"Cancel\", \"cancel_update\", func);\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getImportSaveButton = function(){\r\n\tvar self = this;\r\n\tvar func = function(){\r\n\t\tself.ui.clearMessages();\r\n\t\tif(typeof self.doImport == \"function\"){\r\n\t\t\tself.doImport();\r\n\t\t}\r\n\t}\r\n\treturn this.getSchemaButton(\"Import\", \"import_schema\", func)\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getSaveButton = function(){\r\n\tvar self = this;\r\n\tvar func = function(){\r\n\t\tself.ui.clearMessages();\r\n\t\tvar text = self.schema_edit_dom.value;\r\n\t\tif(typeof(self.schema) == \"object\"){\r\n\t\t\ttext = JSON.parse(text);\r\n\t\t}\r\n\t\treturn self.updateSchema(text, {\"terminus:encoding\": \"terminus:\" + self.format});\r\n\t}\r\n\treturn this.getSchemaButton(\"Save\", \"update_schema\", func);\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getSchemaEditButton = function(){\r\n\tvar self = this;\r\n\tvar func = function(){\r\n\t\tself.mode = \"edit\";\r\n\t\tself.refreshPage();\r\n\t}\r\n\treturn this.getSchemaButton(\"Edit\", \"update_schema\", func);\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getImportButton = function(){\r\n\tvar self = this;\r\n\tvar func = function(){\r\n\t\tself.ui.clearMessages();\r\n\t\tself.mode = \"import\";\r\n\t\tself.refreshPage();\r\n\t}\r\n\treturn this.getSchemaButton(\"Import New Schema\", \"import_schema\", func);\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getSchemaButton = function(label, action, func){\r\n\tvar opt = document.createElement(\"button\");\r\n\topt.appendChild(document.createTextNode(label));\r\n\topt.setAttribute(\"class\", \"terminus-btn terminus-control-button terminus-schema-\" + action);\r\n\topt.addEventListener(\"click\", func);\r\n\treturn opt;\r\n}\r\n\r\n/*\r\n * Updates schema, then fetches updated version and updates the page with it\r\n */\r\nTerminusSchemaViewer.prototype.updateSchema  = function(text, opts){\r\n\tthis.ui.showBusy(\"Updating Database Schema\");\r\n\tvar self = this;\r\n\treturn this.ui.client.updateSchema(false, text, opts)\r\n\t.then(function(response){\r\n\t\tif(response['terminus:status'] && response['terminus:status'] == \"terminus:success\"){\r\n\t\t\tself.ui.showBusy(\"Retrieving updated schema\");\r\n\t\t\tself.mode = \"view\";\r\n\t\t\tself.loadSchema(\"Successfully Updated Schema\");\r\n\t\t\tself.ui.redraw();\r\n\t\t}\r\n\t\telse if(response['terminus:status'] && response['terminus:status'] == \"terminus:failure\"){\r\n\t\t\tself.ui.clearBusy();\r\n\t\t\tself.ui.showViolations(response['terminus:witnesses'], \"schema\");\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthrow new Error(\"Update Schema returned no terminus:status code\");\r\n\t\t}\r\n\t})\r\n\t.catch(function(error){\r\n\t\tself.ui.clearBusy();\r\n\t\tif(error.data && error.data['terminus:witnesses']){\r\n\t\t\tself.ui.showViolations(error.data['terminus:witnesses'], \"schema\");\t\t\t\r\n\t\t}\r\n\t\telse {\r\n\t\t\tself.ui.showError(error);\r\n\t\t}\r\n\t});\r\n}\r\n\r\n/*\r\n * Imports a schema from the passed url\r\n * mode: replace | append\r\n */\r\nTerminusSchemaViewer.prototype.load  = function(url, key, mode){\r\n\tvar self = this;\r\n\tmode = (mode ? mode : \"replace\");\r\n\tthis.ui.showBusy(\"Loading schema from \" + url);\r\n\tvar origurl = this.ui.client.connectionConfig.schemaURL();\r\n\treturn this.ui.client.getSchema(url, {\"terminus:user_key\": key, \"terminus:encoding\" : \"terminus:\" + this.format})\r\n\t.then(function(response){\r\n\t\tvar newschema = (mode == \"append\") ? self.appendSchema(response) : response;\r\n\t\tif(self.confirm_before_update){\r\n\t\t\t//reconnect to original db\r\n\t\t\tself.ui.showResult(\"Schema retrieved - click save to deploy\");\r\n\t\t\tself.ui.client.connectionConfig.setSchemaURL(origurl);\r\n\t\t\tself.showConfirmPage(newschema);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tself.ui.showBusy(\"Updating schema\");\r\n\t\t\tself.ui.client.connectionConfig.setSchemaURL(origurl);\r\n\t\t\tself.updateSchema(newschema, {\"terminus:encoding\": \"terminus:\" + self.format}).then(function(response){\r\n\t\t\t\tself.mode = \"view\";\r\n\t\t\t\tself.ui.clearBusy();\r\n\t\t\t\tself.ui.redraw();\r\n\t\t\t\tself.ui.showResult(\"Successfully deployed new schema from \" + url);\r\n\t\t\t\treturn response;\r\n\t\t\t});\r\n\t\t}\r\n\t}).catch(function(error){\r\n\t\tself.ui.clearBusy();\r\n\t\tself.ui.showError(error);\r\n\t});\r\n}\r\n\r\nTerminusSchemaViewer.prototype.appendSchema = function(s2){\r\n\tvar nschema = this.schema;\r\n\tif(this.format == 'turtle'){\r\n\t\tnschema = this.schema + s2;\r\n\t}\r\n\telse if(this.format == 'jsonld'){\r\n\t\tfor(var i in s2){\r\n\t\t\tnschema[i] = s2[i];\r\n\t\t}\r\n\t}\r\n\treturn nschema;\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getClassFrameChooser = function(){\r\n\tvar np = document.createElement(\"span\");\r\n\tnp.setAttribute(\"class\", \"terminus-class frame-chooser\");\r\n\tvar termcc = new TerminusClassChooser(this.ui);\r\n\ttermcc.empty_choice = \"View Individual Class Frames\";\r\n\tvar self = this;\r\n\ttermcc.change = function(new_class){\r\n\t\tif(new_class){\r\n\t\t\tself.cls = new_class;\r\n\t\t\tif(self.mode != \"class_frame\"){\r\n\t\t\t\tself.mode = \"class_frame\";\r\n\t\t\t\tself.refreshPage();\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tself.refreshMainPage();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tvar tcdom = termcc.getAsDOM();\r\n\tnp.appendChild(tcdom);\r\n\treturn np;\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getClassFrameDOM = function(){\r\n\tvar np = document.createElement(\"div\");\r\n\tnp.setAttribute(\"class\", \"terminus-schema-page terminus-schema-classframe-page\");\r\n\tvar docviewer = new TerminusDocumentViewer(this.ui, \"model\");\r\n\tdocviewer.loadCreateDocument(this.cls);\r\n\tdocviewer.page_config = \"model\";\r\n\tnp.appendChild(docviewer.getAsDOM());\r\n\treturn np;\r\n}\r\n\r\nTerminusSchemaViewer.prototype.showConfirmPage = function(newschema){\r\n\tthis.schema = newschema;\r\n\tthis.confirm_before_update = false;\r\n\tthis.mode = \"edit\";\r\n\tthis.refreshPage(\"Confirm new schema\");\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getSchemaEditDOM = function(){\r\n\tvar np = document.createElement(\"div\");\r\n\tnp.setAttribute(\"class\", \"terminus-schema-page terminus-schema-edit-page\");\r\n\tvar ipval = document.createElement(\"textarea\");\r\n\tipval.setAttribute(\"class\", \"terminus-schema-edit terminus-schema-textarea\");\r\n\tipval.setAttribute(\"width\", \"100%\");\r\n\tipval.setAttribute(\"style\", \"min-width: 400px; min-height: 400px;\");\r\n\tif(typeof(this.schema) == \"string\"){\r\n\t\tipval.innerHTML = this.schema;\r\n\t}\r\n\telse if(typeof (this.schema) == \"object\") {\r\n\t\tipval.innerHTML = JSON.stringify(this.schema, 0, 4);\r\n\t}\r\n\tthis.schema_edit_dom = ipval;\r\n\tnp.appendChild(ipval);\r\n\tUTILS.stylizeEditor(this.ui, ipval, 'schema', 'turtle');\r\n\treturn np;\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getSchemaViewDOM = function(){\r\n\tvar self = this;\r\n\tvar np = document.createElement(\"div\");\r\n\tnp.setAttribute(\"class\", \"terminus-schema-page terminus-schema-view-page\");\r\n\tvar ipval = document.createElement(\"pre\");\r\n\tipval.setAttribute(\"class\", \"terminus-schema-view terminus-scheme-pre\");\r\n\tif(typeof(this.schema) == \"string\"){\r\n\t\tvar txt = this.schema.replace(/&/g, \"&amp;\")\r\n         .replace(/</g, \"&lt;\")\r\n         .replace(/>/g, \"&gt;\")\r\n         .replace(/\"/g, \"&quot;\")\r\n         .replace(/'/g, \"&#039;\");\r\n\t\tipval.innerHTML = txt;\r\n\t}\r\n\telse if(typeof (this.schema) == \"object\") {\r\n\t\tipval.innerHTML = JSON.stringify(this.schema, 0, 4);\r\n\t}\r\n\tvar cm = UTILS.stylizeCodeDisplay(this.ui, ipval, np, 'turtle');\r\n\tif(!cm) np.appendChild(ipval);\r\n\treturn np;\r\n}\r\n\r\nTerminusSchemaViewer.prototype.getSchemaImportDOM = function(){\r\n\tvar scd = document.createElement(\"div\");\r\n\tscd.setAttribute(\"class\", \"terminus-form-border terminus-schema-page terminus-schema-import-page\");\r\n\r\n\r\n\tvar sci = document.createElement(\"div\");\r\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-form-field-spacing terminus-form-horizontal terminus-control-group\");\r\n\tvar slab = document.createElement(\"span\");\r\n\tslab.setAttribute(\"class\", \"terminus-url-loader-input terminus-form-label terminus-control-label\");\r\n\tslab.appendChild(document.createTextNode(\"URL\"));\r\n\tsci.appendChild(slab);\r\n\tvar inpUrl  = document.createElement(\"input\");\r\n\tinpUrl.setAttribute(\"type\", \"text\");\r\n\tinpUrl.setAttribute(\"class\", \"terminus-form-value terminus-input-text terminus-form-url terminus-url-connect\");\r\n\tinpUrl.setAttribute(\"placeholder\", \"Enter URL of DB to import from\");\r\n\tsci.appendChild(inpUrl);\r\n\tscd.appendChild(sci);\r\n\r\n\tvar sci = document.createElement(\"div\");\r\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-form-field-spacing terminus-form-horizontal terminus-control-group\");\r\n\tvar klab = document.createElement(\"span\");\r\n\tklab.setAttribute(\"class\", \"terminus-url-loader-input terminus-form-label  terminus-control-label terminus-import_mode-input\");\r\n\tklab.appendChild(document.createTextNode(\"Import Mode\"));\r\n\tsci.appendChild(klab);\r\n\tvar modes = document.createElement(\"select\");\r\n\tmodes.setAttribute(\"class\", \"terminus-form-select\");\r\n\r\n\tvar overwrite = document.createElement(\"option\");\r\n\toverwrite.value = \"replace\";\r\n\toverwrite.appendChild(document.createTextNode(\"Replace Mode\"))\r\n\tmodes.appendChild(overwrite);\r\n\tvar append = document.createElement(\"option\");\r\n\tappend.value = \"append\";\r\n\tappend.appendChild(document.createTextNode(\"Append Mode\"))\r\n\tmodes.appendChild(append);\r\n\tmodes.setAttribute(\"class\", \"terminus-form-select terminus-import-mode\");\r\n\tsci.appendChild(klab);\r\n\tsci.appendChild(modes);\r\n\tscd.appendChild(sci);\r\n\r\n\tvar sci = document.createElement(\"div\");\r\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-form-field-spacing terminus-form-horizontal terminus-control-group\");\r\n\tvar klab = document.createElement(\"span\");\r\n\tklab.setAttribute(\"class\", \"terminus-form-label terminus-url-key-input terminus-control-label\");\r\n\tklab.appendChild(document.createTextNode(\"Key\"))\r\n\tvar key = document.createElement(\"input\");\r\n\tkey.setAttribute(\"type\", \"text\");\r\n\tkey.setAttribute(\"class\", \"terminus-form-value terminus-input-text terminus-url-key\");\r\n\tsci.appendChild(klab);\r\n\tsci.appendChild(key);\r\n\tscd.appendChild(sci);\r\n\tvar self = this;\r\n\tthis.doImport = function(){\r\n\t\tif(inpUrl.value){\r\n\t\t\tself.load(inpUrl.value, key.value, modes.value);\r\n\t\t}\r\n\t}\r\n\treturn scd;\r\n}\r\n\r\nmodule.exports=TerminusSchemaViewer\r\n","/* User interface elements that relate to server context\r\n *\r\n * TerminusServerController is a control widget that invokes server actions\r\n * TerminusServerViewer is a window that displays server actions and server screens\r\n *\r\n */\r\n const Datatables = require('../plugins/datatables.terminus');\r\n const UTILS =require('../Utils');\r\n const HTMLFrameHelper = require('./HTMLFrameHelper');\r\n \r\n function TerminusServerController(ui){\r\n\t this.ui = ui;\r\n }\r\n\r\nTerminusServerController.prototype.getAsDOM = function(){\r\n\tvar rsc = document.createElement(\"div\");\r\n\trsc.setAttribute(\"class\", \"terminus-server-controller\");\r\n\tvar self = this;\r\n\tif(this.ui && this.ui.server()){\r\n\t\tvar scd = document.createElement(\"div\");\r\n\t\tscd.setAttribute(\"class\", \"terminus-server-connectiAlso, the title / hover stuff should include the full entry when it is shortened (for urls / comments) so when I hover over it I should see the full texton\");\r\n        var nav = document.createElement('div');\r\n        nav.setAttribute('class', 'span3');\r\n        var ul = document.createElement('ul');\r\n        ul.setAttribute('class', 'terminus-ul');\r\n        nav.appendChild(ul);\r\n        rsc.appendChild(nav);\r\n        // connected to server\r\n        var a = document.createElement('a');\r\n        a.setAttribute('class', 'terminus-dashboard-info terminus-list-group-a terminus-nav-width');\r\n        var txt = 'Server: ' + this.ui.server();\r\n        a.appendChild(document.createTextNode(txt));\r\n        ul.appendChild(a);\r\n        // change server\r\n        if(this.ui.showControl(\"change-server\")){\r\n            var a = document.createElement('a');\r\n            a.setAttribute('class', 'terminus-a terminus-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\r\n            var self = this;\r\n            a.addEventListener(\"click\", function(){\r\n                UTILS.activateSelectedNav(this, self);\r\n                self.ui.showLoadURLPage();\r\n            })\r\n            var icon = document.createElement('i');\r\n            icon.setAttribute('class', 'terminus-menu-icon fa fa-link');\r\n            a.appendChild(icon);\r\n            var txt = document.createTextNode('Change Server');\r\n            a.appendChild(txt);\r\n            ul.appendChild(a);\r\n        }\r\n        // view databases\r\n        if(this.ui.showControl(\"db\")){\r\n            var a = document.createElement('a');\r\n            a.setAttribute('class', 'terminus-a terminus-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\r\n            var self = this;\r\n            a.addEventListener(\"click\", function(){\r\n                UTILS.activateSelectedNav(this, self);\r\n                if(self.ui.db()){\r\n                    //self.ui.clearDB();\r\n                }\r\n                self.ui.showServerMainPage();\r\n            })\r\n            var icon = document.createElement('i');\r\n            icon.setAttribute('class', 'terminus-menu-icon fa fa-eye');\r\n            a.appendChild(icon);\r\n            var txt = document.createTextNode('View Databases');\r\n            a.appendChild(txt);\r\n            ul.appendChild(a);\r\n        }\r\n        if(this.ui.showControl(\"create_database\")){\r\n            var a = document.createElement('a');\r\n            a.setAttribute('class', 'terminus-a terminus-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\r\n            var self = this;\r\n            a.addEventListener(\"click\", function(){\r\n               UTILS.activateSelectedNav(this, self);\r\n                if(self.ui.db()){\r\n                    //self.ui.clearDB();\r\n                }\r\n                self.ui.showCreateDBPage();\r\n            })\r\n            var icon = document.createElement('i');\r\n            icon.setAttribute('class', 'terminus-menu-icon fa fa-plus');\r\n            a.appendChild(icon);\r\n            var txt = document.createTextNode('Create New Database');\r\n            a.appendChild(txt);\r\n            ul.appendChild(a);\r\n        }\r\n\t}\r\n\treturn rsc;\r\n}\r\n\r\nTerminusServerController.prototype.getServerLabelDOM = function(){\r\n\tvar srec = this.ui.client.connection.getServerRecord();\r\n\tvar lab = (srec && srec['rdfs:label'] && srec['rdfs:label'][\"@value\"] ? srec['rdfs:label'][\"@value\"] : this.ui.server());\r\n\tvar desc = (srec && srec['rdfs:comment'] && srec['rdfs:comment'][\"@value\"] ? srec['rdfs:comment'][\"@value\"] : \"\");\r\n\tdesc += \" Server URL: \"+ this.ui.server();\r\n\tvar val = document.createElement(\"span\");\r\n\tval.setAttribute(\"class\", \"terminus-server-value\");\r\n\tval.setAttribute(\"title\", desc);\r\n\tval.appendChild(document.createTextNode(lab));\r\n    val =  document.createElement('div');\r\n\treturn val;\r\n}\r\n\r\nfunction TerminusServerViewer(ui){\r\n\tthis.ui = ui;\r\n\tthis.server = this.ui.server();\r\n\tthis.max_cell_size = 500;\r\n\tthis.max_word_size = 40;\r\n}\r\n\r\nTerminusServerViewer.prototype.getAsDOM = function(selected){\r\n\tvar self = this;\r\n\tvar pd = document.createElement(\"span\");\r\n\tpd.setAttribute(\"class\", \"terminus-server-home-page\");\r\n\tif(this.ui.server()){\r\n\t\tvar scd = document.createElement(\"span\");\r\n\t\tscd.setAttribute(\"class\", \"terminus-server-home\");\r\n\t\tif(this.ui.showView(\"server\")){\r\n\t\t\t// 11092019 scd.appendChild(this.getServerDetailsDOM());\r\n\t\t}\r\n\t\tif(this.ui.showView(\"change-server\")){\r\n\t\t\tvar csbut = document.createElement(\"button\");\r\n\t\t\tcsbut.setAttribute(\"class\", \"terminus-control-button terminus-change-server-button terminus-btn\")\r\n\t\t\tcsbut.appendChild(document.createTextNode(\"Disconnect\"));\r\n\t\t\tcsbut.addEventListener(\"click\", function(){\r\n\t\t\t\t//self.ui.clearDB();\r\n\t\t\t\t//self.ui.clearServer();\r\n\t\t\t\tself.ui.showLoadURLPage();\r\n\t\t\t})\r\n\t\t\t// 11092019 scd.appendChild(csbut);\r\n\t\t}\r\n\t\tif(this.ui.showView(\"create_database\")){\r\n\t\t\tvar crbut = document.createElement(\"button\");\r\n\t\t\tcrbut.setAttribute(\"class\", \"terminus-control-button terminus-create-db-button terminus-btn\")\r\n\t\t\tcrbut.appendChild(document.createTextNode(\"Create New Database\"));\r\n\t\t\tcrbut.addEventListener(\"click\", function(){\r\n\t\t\t\tif(self.ui.db()){\r\n\t\t\t\t\t//self.ui.clearDB();\r\n\t\t\t\t}\r\n\t\t\t\tself.ui.clearMessages();\r\n\t\t\t\tself.ui.showCreateDBPage();\r\n\t\t\t})\r\n\t\t\t// 11092019 scd.appendChild(crbut);\r\n\t\t}\r\n\t\tif(this.ui.showView(\"db\")){\r\n\t\t\tscd.appendChild(this.getDBListDOM());\r\n\t\t}\r\n\t\tpd.appendChild(scd);\r\n\t}\r\n\telse {\r\n\t\tself.ui.showLoadURLPage();\r\n\r\n\t\t//pd.appendChild(this.getLoadURLPage());\r\n\t}\r\n\treturn pd;\r\n}\r\n\r\nTerminusServerViewer.prototype.getServerDetailsDOM = function(){\r\n\tvar scd = document.createElement(\"span\");\r\n\tscd.setAttribute(\"class\", \"terminus-server-details terminus-server-banner\");\r\n\tvar scl = document.createElement(\"span\");\r\n\tscl.setAttribute(\"class\", \"terminus-label terminus-server-info\");\r\n\tscl.appendChild(document.createTextNode(\"Connected to Server - \"))\r\n\tvar scs = document.createElement(\"span\");\r\n\tscs.setAttribute(\"class\", \"terminus-value terminus-server-info\");\r\n\tscs.appendChild(document.createTextNode(this.ui.server()))\r\n\tscd.appendChild(scl);\r\n\tscd.appendChild(scs);\r\n\treturn scd;\r\n}\r\n\r\nTerminusServerViewer.prototype.wrapTableLinkCell = function(tdElement,dbid, text){\r\n\tvar self = this;\r\n\tvar wrap = document.createElement(\"p\");\r\n//\twrap.setAttribute(\"href\", \"#\");\r\n\twrap.setAttribute(\"class\", \"terminus-table-content\");\r\n\tHTMLFrameHelper.wrapShortenedText(wrap, text, this.max_cell_size, this.max_word_size);\r\n\ttdElement.addEventListener(\"click\", function(){\r\n\t\tself.ui.connectToDB(dbid);\r\n\t\tself.ui.showDBMainPage();\r\n\t});\r\n\treturn wrap;\r\n}\r\n\r\nTerminusServerViewer.prototype.getDBListDOM = function(){\r\n\tvar self = this;\r\n\tvar sec = document.createElement(\"div\");\r\n\tvar lihed = document.createElement(\"h3\");\r\n\tlihed.setAttribute(\"class\", \"terminus-db-list-title terminus-module-head\");\r\n\tlihed.appendChild(document.createTextNode(\"Available Databases\"));\r\n\tsec.appendChild(lihed);\r\n\tvar scd = document.createElement(\"table\");\r\n\tscd.setAttribute(\"class\", \"terminus-db-list terminus-db-size terminus-hover-table\");\r\n\tvar thead = document.createElement(\"thead\");\r\n\tvar thr = document.createElement(\"tr\");\r\n\tvar th1 = document.createElement(\"th\");\r\n\tth1.appendChild(document.createTextNode(\"ID\"));\r\n\tth1.setAttribute(\"class\", \"terminus-db-id terminus-table-header-full-css\");\r\n\tvar th2 = document.createElement(\"th\");\r\n\tth2.appendChild(document.createTextNode(\"Title\"));\r\n\tth2.setAttribute(\"class\", \"terminus-db-title terminus-table-header-full-css\");\r\n\tvar th3 = document.createElement(\"th\");\r\n\tth3.appendChild(document.createTextNode(\"Description\"));\r\n\tth3.setAttribute(\"class\", \"terminus-db-description terminus-table-header-full-css\");\r\n\tvar th4 = document.createElement(\"th\");\r\n\tth4.setAttribute(\"class\", \"terminus-db-size terminus-table-header-full-css\");\r\n\tth4.appendChild(document.createTextNode(\"Size\"));\r\n\tvar th5 = document.createElement(\"th\");\r\n\tth5.setAttribute(\"class\", \"terminus-db-created terminus-table-header-full-css\");\r\n\tth5.appendChild(document.createTextNode(\"Created\"));\r\n\tvar th6 = document.createElement(\"th\");\r\n\tth6.appendChild(document.createTextNode(\"Delete\"));\r\n\tth6.setAttribute(\"class\", \"terminus-db-delete terminus-table-header-full-css\");\r\n\tthr.appendChild(th1);\r\n\tthr.appendChild(th2);\r\n\tthr.appendChild(th3);\r\n\t//thr.appendChild(th4);\r\n\t//thr.appendChild(th5);\r\n\tthr.appendChild(th6);\r\n\tthead.appendChild(thr);\r\n\tscd.appendChild(thead);\r\n\tvar tbody = document.createElement(\"tbody\");\r\n\tvar dbrecs = this.ui.client.connection.getServerDBRecords();\r\n\tfor(let fullid in dbrecs){\r\n\t\tlet dbrec = dbrecs[fullid];\r\n\t\tconst dbid = fullid.split(\":\")[1];\r\n\t\tlet tr = document.createElement(\"tr\");\r\n\t\tvar td1 = document.createElement(\"td\");\r\n\t\ttd1.appendChild(this.wrapTableLinkCell(td1,dbid, dbid));\r\n\t\ttd1.setAttribute(\"class\", \"terminus-db-id terminus-db-pointer\");\r\n\t\tvar td2 = document.createElement(\"td\");\r\n\t\ttd2.setAttribute(\"class\", \"terminus-db-title terminus-db-pointer\");\r\n\t\tvar txt = (dbrec && dbrec['rdfs:label'] && dbrec['rdfs:label']['@value'] ? dbrec['rdfs:label']['@value'] : \"\");\r\n\t\ttd2.appendChild(this.wrapTableLinkCell(td2,dbid, txt));\r\n\t\tvar td3 = document.createElement(\"td\");\r\n\t\ttd3.setAttribute(\"class\", \"terminus-db-description terminus-db-pointer\");\r\n\t\tvar txt = (dbrec && dbrec['rdfs:comment'] && dbrec['rdfs:comment']['@value'] ? dbrec['rdfs:comment']['@value'] : \"\");\r\n\t\ttd3.appendChild(this.wrapTableLinkCell(td3,dbid, txt));\r\n\t\tvar td4 = document.createElement(\"td\");\r\n\t\ttd4.setAttribute(\"class\", \"terminus-db-size terminus-db-pointer\");\r\n\t\tvar txt = (dbrec && dbrec['terminus:size'] && dbrec['terminus:size']['@value'] ? dbrec['terminus:size']['@value'] : \"\");\r\n\t\ttd4.appendChild(this.wrapTableLinkCell(td4,dbid, txt));\r\n\t\tvar td5 = document.createElement(\"td\");\r\n\t\ttd5.setAttribute(\"class\", \"terminus-db-created terminus-db-pointer\");\r\n\t\tvar txt = (dbrec && dbrec['terminus:last_updated'] && dbrec['terminus:last_updated']['@value'] ? dbrec['terminus:last_updated']['@value'] : \"\");\r\n\t\ttd5.appendChild(this.wrapTableLinkCell(td5,dbid, txt));\r\n\t\tvar td6 = document.createElement(\"td\");\r\n\t\ttd6.setAttribute(\"class\", \"db-delete\");\r\n        if(this.deleteDBPermitted(dbid)){\r\n            if(this.ui.pluginAvailable(\"font-awesome\")){\r\n                var delbut = document.createElement('i');\r\n        \t\tdelbut.setAttribute(\"class\", \"terminus-db-list-del-icon fa fa-times-circle\");\r\n        \t}\r\n            else{\r\n                var delbut = document.createElement(\"button\");\r\n    \t\t\tdelbut.appendChild(document.createTextNode(\"Delete\"));\r\n    \t\t\tdelbut.setAttribute(\"class\", \"terminus-control-button terminus-delete-db-button\");\r\n            }\r\n\t\t\t// function to fix db in a closure\r\n\t\t\tvar delDB = function(db){\r\n\t\t\t\treturn function(){\r\n\t\t\t\t\tlet deleteConfirm = confirm(`Do you want to delete ${db} Database?`);\r\n\t\t\t\t\tif (deleteConfirm == true) {\r\n\t\t\t  \t\t\tself.ui.deleteDatabase(db);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t//self.ui.deleteDatabase(db);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tdelbut.addEventListener(\"click\", delDB(dbid));\r\n\t\t\ttd6.appendChild(delbut);\r\n\t\t}\r\n\r\n\t\ttr.appendChild(td1);\r\n\t\ttr.appendChild(td2);\r\n\t\ttr.appendChild(td3);\r\n\t\t//tr.appendChild(td4);\r\n\t\t//tr.appendChild(td5);\r\n\t\ttr.appendChild(td6);\r\n\t\ttbody.appendChild(tr);\r\n\t}\r\n\tscd.appendChild(tbody);\r\n\tsec.appendChild(scd);\r\n\r\n\tif(this.ui.pluginAvailable(\"datatables\")){\r\n        var dt = new Datatables.CspDatatables(this.ui);\r\n\t\tvar tab = dt.draw(scd);\r\n\t}\r\n\treturn sec;\r\n}\r\n\r\nTerminusServerViewer.prototype.deleteDBPermitted = function(dbid){\r\n\tif(dbid == \"terminus\") return false;\r\n\tif(this.ui.client.connection.capabilitiesPermit(\"delete_database\", dbid)) return true;\r\n\treturn false;\r\n}\r\n\r\nmodule.exports = {TerminusServerViewer,TerminusServerController}\r\n","function TerminusURLLoader(ui, val){\r\n\tthis.ui = ui;\r\n\tthis.val = val;\r\n\tthis.url_input = false;\r\n\tthis.key_input = false;\r\n}\r\n\r\nTerminusURLLoader.prototype.getLabelDOM = function(){\r\n\treturn document.createTextNode(\"Connect\");\r\n}\r\n\r\nTerminusURLLoader.prototype.getFormFieldDOM = function(ip, fname, ltxt, pholder){\r\n\tvar sci = document.createElement(\"div\");\r\n\tsci.setAttribute(\"class\", \"terminus-form-horizontal terminus-control-group terminus-form-field-spacing terminus-form-field terminus-field-\"+fname);\r\n\tvar lab = document.createElement(\"span\");\r\n\tlab.setAttribute(\"class\", \"terminus-control-label terminus-form-label terminus-form-field-label terminus-label-\"+fname);\r\n\tlab.appendChild(document.createTextNode(ltxt))\r\n\tip.setAttribute(\"type\", \"text\");\r\n\tip.setAttribute(\"placeholder\", pholder);\r\n\tsci.appendChild(lab);\r\n\tsci.appendChild(ip);\r\n\treturn sci;\r\n}\r\n\r\nTerminusURLLoader.prototype.getAsDOM = function(){\r\n\tvar scd = document.createElement(\"div\");\r\n\tscd.setAttribute(\"class\", \"terminus-form terminus-url-loader\");\r\n\tvar stit = document.createElement(\"h3\");\r\n\tstit.setAttribute(\"class\", \"terminus-form-header terminus-connect-header terminus-module-head\");\r\n\tstit.appendChild(document.createTextNode(\"Connect To Terminus Server\"));\r\n\tscd.appendChild(stit);\r\n\tvar mfd = document.createElement('div');\r\n\tmfd.setAttribute('class', 'terminus-form-border');\r\n\tscd.appendChild(mfd);\r\n\tthis.url_input = document.createElement(\"input\");\r\n\tthis.url_input.setAttribute(\"class\", \"terminus-form-value terminus-form-url terminus-form-field-input terminus-input-text\");\r\n\tif(this.val){\r\n\t\tthis.url_input.value = this.val;\r\n\t}\r\n\tmfd.appendChild(this.getFormFieldDOM(this.url_input, \"connect\", \"URL\", \"Terminus DB URL\"));\r\n\tthis.key_input = document.createElement(\"input\");\r\n\tthis.key_input.setAttribute(\"class\", \"terminus-form-value terminus-value terminus-input-text\");\r\n\tmfd.appendChild(this.getFormFieldDOM(this.key_input, \"connect\", \"Key\", \"Server API Key\"));\r\n\tvar loadbuts = document.createElement(\"div\");\r\n\tloadbuts.setAttribute(\"class\", \"terminus-control-buttons\");\r\n\tvar loadbut = document.createElement(\"button\");\r\n\tloadbut.setAttribute(\"class\", \"terminus-control-button terminus-url-load terminus-btn\");\r\n\tloadbut.appendChild(document.createTextNode(\"Connect\"));\r\n\tvar self = this;\r\n\tloadbut.addEventListener(\"click\", function(){\r\n\t\tif(self.url_input.value){\r\n\t\t\tself.ui.load(self.url_input.value, self.key_input.value);\r\n\t\t}\r\n\t});\r\n\tloadbuts.appendChild(loadbut);\r\n\tmfd.appendChild(loadbuts);\r\n\treturn scd;\r\n}\r\n\r\n\r\nmodule.exports=TerminusURLLoader\r\n"],"sourceRoot":""}
{"version":3,"sources":["webpack://TerminusDB_SDK/webpack/bootstrap","webpack://TerminusDB_SDK/./src/FrameHelper.js","webpack://TerminusDB_SDK/./src/query/WOQLQuery.js","webpack://TerminusDB_SDK/./src/Utils.js","webpack://TerminusDB_SDK/./src/plugins/TerminusPlugin.js","webpack://TerminusDB_SDK/./src/query/WOQLResult.js","webpack://TerminusDB_SDK/./src/client/RenderingMap.js","webpack://TerminusDB_SDK/./src/client/TerminusClassChooser.js","webpack://TerminusDB_SDK/./src/query/WOQLResultsViewer.js","webpack://TerminusDB_SDK/./src/client/TerminusDocument.js","webpack://TerminusDB_SDK/./src/client/ObjectRenderer.js","webpack://TerminusDB_SDK/./src/client/PropertyViewer.js","webpack://TerminusDB_SDK/./src/client/HTMLFrameHelper.js","webpack://TerminusDB_SDK/./src/plugins/datatables.terminus.js","webpack://TerminusDB_SDK/./src/client/TerminusDocumentChooser.js","webpack://TerminusDB_SDK/./src/index.js","webpack://TerminusDB_SDK/./src/TerminusUI.js","webpack://TerminusDB_SDK/./src/ApiExplorer.js","webpack://TerminusDB_SDK/./src/plugins/codemirror.terminus.js","webpack://TerminusDB_SDK/./src/ObjectFrame.js","webpack://TerminusDB_SDK/./src/client/PropertyRenderer.js","webpack://TerminusDB_SDK/./src/client/ValueRenderer.js","webpack://TerminusDB_SDK/./src/client/ObjectViewer.js","webpack://TerminusDB_SDK/./src/client/TerminusDB.js","webpack://TerminusDB_SDK/./src/client/TerminusQuery.js","webpack://TerminusDB_SDK/./src/query/WOQLTextboxGenerator.js","webpack://TerminusDB_SDK/./src/client/TerminusPropertyChooser.js","webpack://TerminusDB_SDK/./src/query/WOQLGraphBrowserGenerator.js","webpack://TerminusDB_SDK/./src/query/WOQLTimePicker.js","webpack://TerminusDB_SDK/./src/client/TerminusMapping.js","webpack://TerminusDB_SDK/./src/client/TerminusSchema.js","webpack://TerminusDB_SDK/./src/client/TerminusServer.js","webpack://TerminusDB_SDK/./src/client/TerminusURL.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","FrameHelper","standard_urls","prefix","url","this","node","hasChildNodes","removeChild","childNodes","obj","length","dom","Math","random","toString","substring","Date","getTime","link","pref","full","ida","idb","unshorten","sha","getShorthand","shb","validURL","bits","split","str","RegExp","test","nurl","urlFragment","lastIndexOf","charAt","toUpperCase","slice","window","location","href","stype","ext","view","type","viewIncludesProperties","parts","replace","join","ty","parsed","parseXsdDate","parseXsdDateTime","year","month","day","push","val","tz","extractXsdTimezone","abs","toNumber","timezone","nparsed","hour","minute","second","xparsed","addXsdPadding","ret","a","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","convertTimestampToXsd","datetime","ptime","paseXsdTime","indexOf","dividor","vals","scriptid","src","callback","existingScript","document","getElementById","script","createElement","body","appendChild","onload","id","cssid","rel","require","WOQLResult","WOQLQuery","client","options","default_limit","prefixes","connectionConfig","platformEndpoint","sid","server","colid","dbid","serverURL","schemaURL","dbURL","docURL","shorten","execute","woql","wrapped","wrap","self","select","then","response","wstr","getAbstractQueryPattern","varname","getSubclassQueryPattern","clsname","getAllDocumentQuery","constraint","limit","start","getEverythingQuery","getPropertyListQuery","opts","getElementMetaDataQuery","getClassListMetaDataQuery","getClassMetaDataQuery","getDataOfChosenClassQuery","chosen","getDataOfChosenPropertyQuery","getInstanceMeta","docid","vEl","getDocumentQuery","getClassesQuery","Codemirror","stylizeCodeDisplay","ui","txt","cmConfig","pluginAvailable","pr","colorizePre","removeSelectedNavClass","el","getElementsByClassName","classList","remove","tolggleContent","icon","content","style","display","add","stylizeEditor","cm","ar","colorizeTextArea","updateTextArea","deleteStylizedEditor","qip","nextElementSibling","setAttribute","removeChildren","showHttpResult","action","currForm","terminator","br","UTILS","getHeaderDom","retHttpHeaders","headers","hdres","createTextNode","json","rd","data","JSON","stringify","pre","innerHTML","getResponse","text","hd","h","getInfoAlertDom","label","msg","ald","getFunctionSignature","which","sigs","spec","descr","result","args","server_url","title","description","database_url","details","format","editmode","document_url","fail_on_id_denied","class","term","source","target","TerminusPluginManager","preloaded","loaded","loading","precluded","plugins","css","js","plugin","requires","setPluginOptions","k","init","calculatePreloaded","toload","calculateRequiredInitPlugins","loadPlugins","pins","pid","getDefaultPlugins","needed_pins","loading_order","getAvailablePlugins","pl","version_check","pluginmeta","version","jQuery","isFunction","fn","slider","Quill","JSONEditor","CodeMirror","fontAwesomeCheck","dataTable","select2","google","maps","ol","Map","d3","console","log","Error","span","className","insertBefore","firstChild","element","getComputedStyle","getPropertyValue","ticker","cback","loadPlugin","pug","loadDynamicCSS","scripts","splice","loadDynamicScript","loadPluginScripts","loadPageCSS","cssfid","cssdom","parentNode","cssurl","pluginLoadable","pluginLoadedOrLoading","disabled","getPluginDOM","plugid","cl","cbox","checked","clab","addEventListener","togglePlugin","redraw","unloadPlugin","drawPlugins","num","getAsDOM","dm","clh","showPlugins","res","query","bindings","count","hasBindings","HTMLPropertyViewer","ObjectViewer","RenderingMap","registeredDataViewers","registeredDataEditors","registeredPropertyViewers","registeredPropertyEditors","registeredObjectViewers","registeredObjectEditors","getValidDataViewerList","frametype","valids","concat","getValidDataEditorList","nftypes","getValidPropertyViewerList","proptype","proprange","propdom","getValidPropertyEditorList","getViewer","vi","renderers","viewer","eval","e","alert","getAvailablePropertyViewers","renderer","viewers","nviewers","sets","getAvailablePropertyEditors","getAvailableDataViewers","getAvailableDataEditors","getViewerForDataFrame","getEditorForDataFrame","registerViewerForTypes","types","registerEditorForTypes","registerEditorForFrameType","registerViewerForFrameType","registerViewerForProperties","properties","registerEditorForProperties","HTMLStringViewer","HTMLStringEditor","patternMatchesRenderer","pattern","FramePattern","checkRenderer","JSONObjectViewer","HTMLObjectViewer","getEditorForObject","getViewerForObject","getAvailableObjectViewers","decorateRenderer","compiled_options","compileOptions","parent","facets","getDefaultFacets","facet","deffacet","getDefaultFacet","hide_disabled_buttons","features","controls","viewerType","viewerOptions","header","header_viewer","HTMLObjectHeaderViewer","filter","sort","rules","output","frame_type","subject","subjectClass","range","children","depth","index","status","rtype","getRendererType","illegalRuleType","checkFrameType","checkLabel","checkSubject","checkSubjectClass","checkProperty","checkDepth","checkRange","checkValue","checkParent","checkChildren","checkIndex","checkStatus","rsubj","IDsMatch","found","prop","j","values","isUpdated","isNew","numberMatch","propertyIDsMatch","valuesMatch","rangeIDsMatch","rcls","classIDsMatch","frame","ftype","renderder","getLabel","stringMatch","compareIDs","vala","valb","constructor","TerminusClassChooser","choice","show_single","setRoot","root","setFilter","change","cls","ccdom","ccsel","wq","getResultsAsOptions","clist","choices","empty_choice","opt1","added","Class","opt","selected","lab","Label","labelFromURL","Datatables","WOQLResultsViewer","wresult","settings","pman","showTable","show_table","orderColumns","sample","ordered","unshift","resultDOM","rs","rh","getTableDOM","tab","getTable","draw","thead","thr","ordered_headings","th","tbody","tr","td","ObjectFrame","ObjectRenderer","TerminusDocumentViewer","db","editor","load_schema","config_options","getBuiltInViewerOptions","classmeta","instancemeta","refreshPage","elid","getClassMeta","loadCreateDocument","showBusy","page_config","loadDocumentSchema","clearBusy","setLabel","error","showError","loadDocument","getDocument","loadDataFrames","getClassFrame","loadSchemaFrames","deleteDocument","URL","createDocument","extr","extract","showDocument","updateDocument","durl","subjid","dataframes","domain","classframes","loadClassFrames","newDoc","fillFromSchema","render","getOptionsFromPageConfig","controller","FrameConfig","pageconf","getClient","labdom","dfs","getDataFrames","getStdURL","pagedom","rends","holder","controldom","getDocumentPageControls","dpc","PropertyRenderer","objframe","setOptions","originalProperties","newProperties","getOptionsForProperty","buildPropertyRenderers","renderedprop","showFeature","addRenderedProperty","props","getPropertiesToRender","renders","setNew","getAvailableViewers","parentObject","load","copy","nkid","clone","setMode","genBNID","parentobj","newrend","cancel","reset","save","isNewDocument","demandid","inputID","dval","nukeViewer","deletePropertyValue","nprops","deleteProperty","removeProperty","updated","addProperty","addNewProperty","goToProperty","addPropertyClass","changeClass","addClass","ctl","getController","idDOM","new_object","isPartOfNewDocument","childUpdated","redrawHeader","isnew","setFacet","nocascade","parentFacetChange","page","line","summary","getAvailableFacets","keys","currentFacet","pfacet","getContentOrientation","vrend","sum","getSummary","sh","b","propcount","getObjectHeaderViewer","getFeaturesForFacet","hideDisabledControls","hide_disabled_controls","cardControlAllows","cframe","hasRestriction","rest","restriction","currentnum","max","min","goTo","currentViewer","setViewer","nviewer","setView","hide","show","getViewableProperties","getFilledPropertyList","getAddableProperties","getMissingPropertyList","standardSort","map","patterns","matchesPattern","sorted","rdft","rdfc","clear","extractLDO","extracts","extractJSONLD","jsonld_context","extracted","empty","HTMLFrameHelper","headerViewer","getPropertyHeaderViewer","HTMLPropertyHeaderViewer","block","propDOM","npropDOM","getPropertyDOM","replaceWith","getPropertyIDMarker","getPropertyBodyDOM","orientation","pcls","sp","vholder","addRenderedValue","renderedval","nheader","redrawBody","nbody","idm","subj","goToName","objDOM","wrapper","controlsDOM","getPropertyControlsDOM","sumDOM","getPropertyLabelDOM","statDOM","getPropertyStatusDOM","prepend","getPropertySummaryDOM","prelude","facetDOM","getPropertyFacetDOM","viewDOM","getViewValueDOM","getPropertyIDDOM","typeDOM","getPropertyRangeDOM","hasCardinalityRestriction","hideDOM","getPropertyCardinalityDOM","getPropertyCommentDOM","viewables","mpropDOM","sel","getSelectionControl","getInfoboxDOM","getComment","getRestriction","help","getActionControlDOM","settingsDOM","viewsDOM","getModeSelectorDOM","dpropDOM","getPropertyDeleteDOM","addDOM","isClassChoice","getAddValueDOM","rpropDOM","getPropertyResetDOM","upropDOM","getPropertyUpdateDOM","showDOM","getPropertyShowDOM","getPropertyHideDOM","getViewerSelectorDOM","getSettingsControlDOM","sControl","getSettingsControl","popup","getActionControl","cs","getAvailableClassChoices","getViewableValues","goToValue","showValue","htmlid","control","faic","getControlIcon","button","loc","input","infoDOM","linfo","lspacer","lval","convertToDatatable","DataTable","searching","pageLength","lengthMenu","paging","columnDefs","targets","createdRow","row","$","find","attr","html","executeQuery","dcb","dt","pageInfo","wquery","rtab","getDataFromServer","err","getQueryOnPagination","chosenValue","generateNewQueryOnPageChange","qTextDom","getCallbackSettings","len","setUp","dtdom","drawCallback","on","serverside","TerminusDocumentChooser","show_button","getS2DOM","getIDDOM","docchooser","cfilter","termcc","new_class","tdom","s2config","ajax","dataType","params","contentType","delay","cache","placeholder","width","dcip","keyCode","dbut","toggleView","getChangeViewText","TerminusUI","TerminusConfig","pconfig","buttons","messages","explorer","nlocation","ApiExplorer","TerminusDBsdk","TerminusQueryViewer","TerminusMappingViewer","TerminusSchemaViewer","TerminusServersdk","TerminusURLLoader","TerminusDB","WOQLClient","connect","getDBRecord","connectToDB","showView","schema","showSchemaPage","showQueryPage","showExplorer","showDBMainPage","showServerMainPage","createDatabase","dbdets","Promise","reject","getBadArguments","myserver","dbdoc","generateNewDatabaseDocument","getSchema","updateSchema","refreshDBList","crec","connection","getCrashString","showMessage","deleteDatabase","delrec","lid","dbn","removeDB","dets","doc","rdfs","terminus","fname","getConnectionEndpoint","clearServer","clearDB","removeDBFromConnection","TerminusServerViewer","redrawMainPage","showLoadURLPage","TerminusDBViewer","showCreateDBPage","TerminusDBCreator","showMappingPage","mapping","getDocViewerOptions","showCreateDocument","getDocCreatorOptions","main","showResult","clearMessages","clearMainPage","setMessageDOM","setbuttonControls","setControllerDOM","setExplorerDOM","setPluginsDOM","setViewerDOM","comps","slocation","toggleControl","drawControls","drawExplorer","loadControls","ncontrol","nd","showControl","exp","ae","sc","TerminusServerController","TerminusDBController","show_controls","pseudoCapability","capabilitiesPermit","show_views","busy","md","clsstr","showViolations","vios","nvios","TerminusViolations","cmsg","views","document_options","schema_options","piman","getClassFrameOptions","viewdoc_options","use_fetch","return_full_response","aec","getApiNav","navDom","nav","ul","getApiExplorerDom","cont","api","al","apiCont","getConnectExplorer","getDatabaseExplorer","getSchemaApi","getDocumentApi","getQueryApi","setSelectedNavMenu","setSelectedSubMenu","changeApiDom","getShowApiDom","getQueryApiDom","getSignature","form","getServerForm","fd","inpLabel","cd","inpId","keyLabel","resd","gatherips","getDatabaseDom","getDBForm","inpTxtAr","inpKey","parse","buttonSelf","txtar","getClassFramesForm","inpUrl","inpDocUrl","optLabel","optInp","docUrl","formDoc","encLabel","inpEnc","optTurt","optJld","enc","getApiForm","schLabel","schDoc","schemaUrlDom","schemaTextDom","htmlEditor","schurl","connected_mode","gtxtar","dcurl","payload","getValue","sg","ic","sig","config","textdom","darkMode","jsonldCheck","fromTextArea","firstLineNumber","lineNumbers","styleActiveLine","lineWrapping","smartIndent","indentWithTabs","newlineAndIndent","autoCloseBrackets","matchBrackets","afterCursor","extraKeys","refresh","setCodemirrorSize","defaultCharWidth","setOption","setSize","setTimeout","runMode","innerText","theme","parentframe","originalFrames","DataFrame","ClassFrame","Restriction","loadRestriction","getAsFrame","ff","domainValue","restrictions","clearData","newkids","cf","isValid","isObject","hasSchema","frames","getPropertyClassFrame","getChosenClassFrame","isLogic","getChosenFrame","isData","df","kid","matching","compare","pat","instance","basis","missing","newb","filled","newid","pf","createEmpty","clss","getClassChoices","createEmptyChoice","cloned","clonedval","kidclone","getChildren","getChild","childid","kids","set","addPropertyValue","removePropertyValue","nfvals","contents","nkids","more","isValidType","rangeValue","comment","hasCardRestriction","getType","isObjectProperty","isDatatypeProperty","isRestriction","isDocument","isChoice","isString","getChoiceOptions","elements","option","lang","getTypeShorthand","normalizer","loadFromObjectFrame","par","child","getChosenClassFrames","nc","operands","dataframe","cloneDataFrame","other","domcls","operand","cardinality","maxCardinality","minCardinality","nrest","ValueRenderer","predicate","originalValues","changed","getOptionsForChild","getOptionsForValue","getOptionsForObject","buildValueRenderers","getViewerForProperty","adorig","getDataFramesToRender","vr","getChildrenToRender","kidf","viewIncludesChildren","allkids","clsmeta","nvals","new_property","multiline","containsPage","getViewerForDataValue","ptype","getEditorForProperty","valcount","vsum","originalValue","nf","nvr","inline","getAPIURL","DBURL","getEntityReference","entities","badData","bd","new_value","text_summary_length","v","nrend","getViewerForValue","HTMLDataViewer","objlit","getValueHeaderViewer","HTMLDataHeaderViewer","getDataValueViewer","ft","renderedDOM","getObjectDOM","getObjectIDMarker","getObjectBodyDOM","getFeatureDOM","feature","hasFeatureViewer","featureViewer","getObjectFacetDOM","getObjectLabelDOM","getObjectIDDOM","getObjectTypeDOM","getObjectStatusDOM","getViewPropertyDOM","getAddPropertyDOM","getObjectControlsDOM","getObjectSummaryDOM","nextSibling","getObjectDeleteDOM","cpropDOM","getObjectCloneDOM","getObjectResetDOM","getObjectUpdateDOM","getObjectShowDOM","getObjectHideDOM","mlabDOM","cmt","Comment","addables","dbc","scd","dbrec","nm","item","getControlHTML","showDocumentSubMenus","getDocumentChooserDOM","getDocumentCreatorDOM","gd","nbut","mcls","d2ch","sdom","nlab","click","nbuts","tcdom","nlabs","ccDOM","pd","sth","banner","dhp","scs","getDBSummary","getClassesDOM","getDbInfoBox","info","del","q","sct","mfd","sci","slab","idip","titip","descip","schem","datip","butfield","cancbut","loadbut","WOQLTextboxGenerator","WOQLGraphBrowserGenerator","meta","generator","gentype","generators","gbrowse","loadGenerator","hasGeneratorOptions","changeGenerator","ng","redrawGenerator","inputDOM","getQueryButtonsDOM","nquery","Element","getResultViewDom","qbox","getQueryCreatorChoiceDOM","qTextBox","getQueryTextAreaDOM","buttonsDOM","qcc","gen","box","TerminusPropertyChooser","tq","qman","datatable","gatherDatatableSettings","txtArea","queryName","getQueryButtonGroups","qGroupQueries","qrow","g","ch","setDatatableSettings","newQuery","remString","substr","eqh","qbut","qbuts","qexs","qh","qcGroup","nqbut","aqbut","ebut","pbut","prbut","qdGroup","termpc","qdocGroup","pdom","docch","docdom","d2dom","Property","WOQLTimePicker","DCOGBrowser","model","myowner","default_viewport","current_viewport","viewports","viewportDOMs","browserid","randomString","query_timeslice","current_result","focus_node","show_filter","entity_count","default_display","icon_unicode","color","forward","backward","getSliderDOM","DCOGQueryFilter","DCOGTimePicker","getViewportAsDOM","vpdom","success","getQuery","setBusy","untell","DCOGQueryResult","containsData","setViewportData","getNodeOrFringe","from_node","nodeCount","fillInfoBoxes","nodeSelected","rebuildController","tellUser","moreResults","nfocus","addMoreResults","updateViewportData","showBusyOverlay","insert_patterns","browser","dqr","qstruct","to_node","source_node","target_node","current_relationships","relationships","current_depth","max_path_length","current_threshold","filters","shareholding_threshold","server_side","timeslice","date","wake","initData","qstr","groupID","initDOM","setData","updateData","setViewportFilter","sections","getNodeInfoSections","followNode","setFocusNode","setPathSearch","node_from","node_to","changeTimeSlice","valto","force","isTemporalSuperset","setFilterTimeslice","setQueryTimeslice","getTimeslice","getControllerAsDOM","cdom","getControllerViewButtonsAsDOM","toolboxDOM","getUserToolboxDOM","filterDOM","legendDOM","getControllerFilterAsDOM","fdom","getRelationshipFilterAsDOM","ndom","getQueryParameterDOM","ipfield","getSliderTypeDOM","gobut","toggleFilterVisibility","getLegendAsDOM","userMessageDOM","msgdom","dlc","bdoms","bdom","legend","getNodeRelativeSize","nconf","getNodeDisplaySettings","size","getLineWidth","getModelElementDisplaySettings","elt","modeldisplay","extend","isBidirectional","edge","typeID","conf","getRelationshipClass","nick","getGraphElementDisplaySettings","nds","getLinkDisplaySettings","getElementIcon","getClassIcon","getElementIconUnicode","getElementColour","setUpIPGSpecials","reldisptypes","entdisptypes","rid","disptype","eid","slidertype","from","to","ss","years","toggleServerSideFiltering","getSliderParameters","end","pointInit","slide","event","tt","tickToTime","rangeInit","val2","noshow","showCurrentPick","ticknum","nval","seconds_ago","timeToTick","timeval","y","thisy","changeSliderType","ntype","updateSliderDOM","dcd","cb","lb","slideDOM","TopAxisDOM","curdate","cursdate","curedate","LabelDOM","PayloadDOM","L2DOM","getSliderAxisDOM","sconfig","getTimesliceAsTicks","vtf","vtt","fy","adjustOffset","tval","tick","unit","offsetWidth","off","sd","ldom","Y2Time","tsel","o1","o2","getFormFieldDOM","getFormField","queries","mdom","submit","jsonip","map_source","map_target","update","confirm_before_update","loadSchema","msgtype","resetControlDOM","getSchemaSaveButtons","getSchemaImportActionButtons","getShowSchemaButton","getClassFrameChooser","getImportButton","getSchemaEditButton","getFormatChoices","fc","tc","tj","refreshMainPage","getSchemaViewDOM","getSchemaEditDOM","getSchemaImportDOM","getClassFrameDOM","ssb","getCancelButton","getSaveButton","getImportPreviewButton","getImportSaveButton","getSchemaButton","doImport","schema_edit_dom","func","newschema","appendSchema","showConfirmPage","s2","nschema","np","docviewer","ipval","ip","klab","modes","overwrite","append","rsc","getServerLabelDOM","srec","getServerRecord","desc","csbut","crbut","getDBListDOM","getServerDetailsDOM","scl","wrapTableLinkCell","sec","lihed","th1","th2","th3","th4","th5","th6","dbrecs","getServerDBRecords","fullid","td1","td2","td3","td4","td5","td6","deleteDBPermitted","delbut","delDB","url_input","key_input","getLabelDOM","ltxt","pholder","stit","loadbuts"],"mappings":"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","file":"terminus-javascript-sdk.min.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 14);\n","/**\n * Helper functions for dealing with frames and linked data documents\n */\nlet FrameHelper = {\n\tstandard_urls: {\n\t\t\"rdf\": \"http://www.w3.org/1999/02/22-rdf-syntax-ns#\",\n\t\t\"rdfs\": \"http://www.w3.org/2000/01/rdf-schema#\",\n\t\t\"xsd\": \"http://www.w3.org/2001/XMLSchema#\",\n\t\t\"owl\": \"http://www.w3.org/2002/07/owl#\",\n\t\t\"dcogbox\": \"https://datachemist.net/ontology/dcogbox#\",\n\t\t\"dcog\": \"https://datachemist.net/ontology/dcog#\",\n\t\t\"xdd\": \"https://datachemist.net/ontology/xdd#\",\n\t\t\"terminus\": \"https://datachemist.net/ontology/terminus#\",\n\t\t\"vio\": \"https://datachemist.net/ontology/vio#\",\n\t\t\"docu\": \"https://datachemist.net/ontology/documentation#\"\n\t}\n};\n\nFrameHelper.addURLPrefix = function(prefix, url){\n\tthis.standard_urls[prefix] = url;\n}\n\n\nFrameHelper.removeChildren = function(node){\n\tif(node) { while(node.hasChildNodes()){\n\t\tnode.removeChild(node.childNodes[0]);\n\t}}\n}\n\nFrameHelper.empty = function(obj){\n\t   // null and undefined are \"empty\"\n    if (obj == null) return true;\n    // Assume if it has a length property with a non-zero value\n    // that that property is correct.\n    if (obj.length > 0)    return false;\n    if (obj.length === 0)  return true;\n    // Otherwise, does it have any properties of its own?\n    // Note that this doesn't handle\n    // toString and valueOf enumeration bugs in IE < 9\n    for (var key in obj) {\n        if (Object.prototype.hasOwnProperty.call(obj, key)) return false;\n    }\n    return true;\n}\n\nFrameHelper.genBNID = function(dom){\n\tlet r = Math.random().toString(36).substring(7);\n\tvar d = new Date();\n\tlet bnid = \"_:\" + r + d.getTime();\n\treturn bnid;\n}\n\nFrameHelper.getShorthand = function(link){\n\tif(link && typeof link == \"string\"){\n\t\tfor(var pref in this.standard_urls){\n\t\t\tvar full = this.standard_urls[pref];\n\t\t\tif(link.substring(0, full.length) == full){\n\t\t\t\tvar sh = pref + \":\" + link.substring(full.length);\n\t\t\t\treturn sh;\n\t\t\t}\n\t\t}\n\t}\n\treturn false;\n}\n\nFrameHelper.compareIDs = function(ida, idb){\n\tif(ida == idb) return true;\n\tif(this.unshorten(ida) == idb) return true;\n\tif(this.unshorten(ida) == this.unshorten(idb)) return true;\n\tvar sha = this.getShorthand(ida);\n\tvar shb = this.getShorthand(idb);\n\tif(sha && ((sha == idb) || (sha == shb))) return true;\n\tif(shb && shb == ida) return true;\n\treturn false;\n}\n\nFrameHelper.unshorten = function(url){\n\tif(this.validURL(url)) return url;\n\tif(!url) return url;\n\tvar bits = url.split(\":\");\n\tif(bits[1]){\n\t\tif(this.standard_urls[bits[0]]){\n\t\t\treturn this.standard_urls[bits[0]] + bits[1];\n\t\t}\n\t}\n\treturn url;\n}\n\nFrameHelper.validURL = function(str) {\n\tvar pattern = new RegExp('^(https?:\\\\/\\\\/)?'+ // protocol\n    'localhost|((([a-z\\\\d]([a-z\\\\d-]*[a-z\\\\d])*)\\\\.)+[a-z]{2,}|'+ // domain name\n    '((\\\\d{1,3}\\\\.){3}\\\\d{1,3}))'+ // OR ip (v4) address\n    '(\\\\:\\\\d+)?(\\\\/[-a-z\\\\d%_.~+]*)*'+ // port and path\n    '(\\\\?[;&a-z\\\\d%_.~+=-]*)?'+ // query string\n    '(\\\\#[-a-z\\\\d_]*)?$','i'); // fragment locator\n\treturn !!pattern.test(str);\n}\n\nFrameHelper.labelFromURL = function(url){\n\tvar nurl = this.urlFragment(url);\n\tnurl = (nurl ? nurl : url.substring(url.lastIndexOf(\"/\")+1));\n\treturn nurl.charAt(0).toUpperCase() + nurl.slice(1);\n}\n\nFrameHelper.urlFragment = function(url){\n\turl = (typeof url != \"string\") ? window.location.href : url;\n\tbits = url.split('#');\n\tif(bits.length <= 1){\n\t\tbits = url.split(\":\");\n\t}\n\tif(bits.length >= 1){\n\t\turl = bits[1];\n\t\turl = url.split(\"?\")[0];\n\t}\n\treturn url;\n}\n\nFrameHelper.isStringType = function(stype){\n\tif(stype == \"http://www.w3.org/2001/XMLSchema#string\") return true;\n\tif(stype == \"xsd:string\") return true;\n\treturn false;\n}\n\nFrameHelper.lastURLBit = function(url){\n\turl = (typeof url == \"undefined\") ? window.location.href : url;\n\turl = url.split('#')[0];\n\turl = url.split(\"?\")[0];\n\turl = url.substring(url.lastIndexOf(\"/\")+1);\n\treturn url;\n}\n\n\nFrameHelper.getStdURL = function(pref, ext, url){\n\tif(this.standard_urls[pref]) {\n\t\tif(url) {\n\t\t\tif(url == this.standard_urls[pref] + ext) return url;\n\t\t}\n\t\telse {\n\t\t\treturn this.standard_urls[pref] + ext;\n\t\t}\n\t}\n\treturn false;\n}\n\nFrameHelper.viewIncludesProperties = function(view, type){\n\tif(view == \"full\" || view == \"production\" || view == \"terse\"){\n\t\treturn true;\n\t}\n\treturn false;\n}\n\nFrameHelper.viewIncludesChildren = function(view, type){\n\treturn this.viewIncludesProperties(view, type);\n}\n\nFrameHelper.viewIncludesValue = function(view, type){\n\treturn this.viewIncludesProperties(view, type);\n}\n\nFrameHelper.numberWithCommas = function(value){\n\tif(value >= 1000 || value <= -1000){\n\t    var parts = value.toString().split(\".\");\n\t    if(value <= -1000) parts[0] = parts[0].substring(1);\n\t    parts[0] = parts[0].replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\");\n\t    if(value <= -1000) value = \"-\" + parts.join(\".\");\n\t    else value = parts.join(\".\");\n\t}\n\treturn value;\n}\n\nFrameHelper.datatypes = [\n\t\"xdd:coordinate\", \"xdd:coordinatePolyline\",\n\t\"xdd:coordinatePolygon\", \"xdd:dateRange\", \"xdd:gYearRange\", \"xdd:integerRange\",\n\t\"xdd:decimalRange\",\"xdd:cc\", \"xdd:email\",\"xdd:html\", \"xdd:url\", \"xsd:anySimpleType\",\n\t\"xsd:string\", \"xsd:boolean\", \"xsd:decimal\", \"xsd:double\", \"xsd:float\", \"xsd:time\", \"xsd:date\",\n\t\"xsd:dateTime\", \"xsd:dateTimeStamp\", \"xsd:gYear\", \"xsd:gMonth\", \"xsd:gDay\", \"xsd:gYearMonth\",\n\t\"xsd:gMonthDay\", \"xsd:duration\", \"xsd:yearMonthDuration\", \"xsd:dayTimeDuration\",\n\t\"xsd:byte\", \"xsd:short\", \"xsd:integer\", \"xsd:long\", \"xsd:unsignedByte\",\t\"xsd:unsignedInt\",\n\t\"xsd:unsignedLong\",\t\"xsd:nonNegativeInteger\", \"xsd:positiveInteger\", \"xsd:negativeInteger\",\n\t\"xsd:nonPositiveInteger\", \"xsd:base64Binary\", \"xsd:anyURI\", \"xsd:language\", \"xsd:normalizedString\",\n\t\"xsd:token\", \"xsd:NMTOKEN\",\t\"xsd:Name\",\t\"xsd:NCName\",\"xsd:NOTATION\", \"xsd:QName\", \"xsd:ID\",\n\t\"xsd:IDREF\", \"xsd:ENTITY\", \"rdf:XMLLiteral\",\"rdf:PlainLiteral\",\"rdfs:Literal\", \"xdd:json\"\n];\n\nFrameHelper.parseDate = function(ty, value){\n\tif(ty == \"xsd:date\"){\n\t\tvar parsed = this.parseXsdDate(value);\n\t}\n\telse if(ty == \"xsd:dateTime\"){\n\t\tvar parsed = this.parseXsdDateTime(value);\n\t}\n\telse if(ty == \"xsd:gYear\"){\n\t\tvar parsed = { year: value };\n\t}\n\telse if(ty == \"xsd:gYearRange\"){\n\t\tvar parsed = { year: value };\n\t}\n\telse if(ty == \"xsd:gMonth\"){\n\t\tvar parsed = { month: value };\n\t}\n\telse if(ty == \"xsd:gDay\"){\n\t\tvar parsed = { day: value };\n\t}\n\telse if(ty == \"xsd:gYearMonth\"){\n\t\tvar bits = value.split(\"-\");\n\t\twhile (bits.length < 2) bits.push(\"\");\n\t\tvar parsed = { year: bits[0], month: bits[1]};\n\t}\n\telse if(ty == \"xsd:gMonthDay\"){\n\t\tvar bits = value.split(\"-\");\n\t\twhile (bits.length < 2) bits.push(\"\");\n\t\tvar parsed = { month: bits[0], day: bits[1]};\n\t}\n\telse if(ty == \"xsd:dateTimeStamp\"){\n\t\tvar bits = value.split(\"-\");\n\t\twhile (bits.length < 2) bits.push(\"\");\n\t\tvar parsed = { month: bits[0], day: bits[1]};\n\t}\n\treturn parsed;\n}\n\nFrameHelper.parseXsdDate = function(val){\n\tvar tz = this.extractXsdTimezone(val);\n\tif(tz){\n\t\tval = val.substring(0, val.length - tz.length);\n\t}\n\tif(val.substring(0, 1) == '-'){\n\t\tvar year = val.substring(0,5);\n\t}\n\telse {\n\t\tvar year = val.substring(0,4);\n\t}\n\tif(year && Math.abs(year) < 10000){\n\t\tvar month = val.substring(year.length+1, year.length+3);\n\t\tif(month) month = month.toNumber();\n\t\telse return false;\n\t\tvar day = val.substring(year.length+4);\n\t\tif(day) day = day.toNumber();\n\t\telse return false;\n\t\tvar parsed = {\n\t\t\tyear: year,\n\t\t\tmonth: month,\n\t\t\tday: day,\n\t\t\ttimezone: tz\n\t\t}\n\t}\n\treturn parsed;\n}\n\nFrameHelper.addXsdPadding = function(parsed){\n\tvar nparsed = {};\n\tif(typeof parsed.year != \"undefined\" && parsed.year !== false && parsed.year < 1000){\n\t\tif(Math.abs(parsed.year) < 10) nparsed.year = (parsed.year < 0 ? \"-000\" + Math.abs(parsed.year) : \"000\" + parsed.year);\n\t\telse if(Math.abs(parsed.year) < 100) nparsed.year = (parsed.year < 0 ? \"-00\" + Math.abs(parsed.year) : \"00\" + parsed.year);\n\t\telse nparsed.year = (parsed.year < 0 ? \"-0\" + Math.abs(parsed.year) : \"0\" + parsed.year);\n\t}\n\telse if(parsed.year){\n\t\tnparsed.year = parsed.year;\n\t}\n\tif(typeof parsed.month != \"undefined\" && parsed.month !== false && parsed.month < 10){\n\t\tnparsed.month = \"0\" + parsed.month;\n\t}\n\telse if(parsed.month){\n\t\tnparsed.month = parsed.month;\n\t}\n\tif(typeof parsed.day != \"undefined\" && parsed.day !== false && parsed.day < 10){\n\t\tnparsed.day = \"0\" + parsed.day\n\t}\n\telse if(parsed.day){\n\t\tnparsed.day = parsed.day;\n\t}\n\tif(typeof parsed.hour != \"undefined\" && parsed.hour !== false && parsed.hour < 10){\n\t\tnparsed.hour = \"0\" + parsed.hour;\n\t}\n\telse if(parsed.hour){\n\t\tnparsed.hour = parsed.hour;\n\t}\n\tif(typeof parsed.minute != \"undefined\" && parsed.minute !== false && parsed.minute < 10){\n\t\tnparsed.minute = \"0\" + parsed.minute;\n\t}\n\telse if(parsed.minute){\n\t\tnparsed.minute = parsed.minute;\n\t}\n\tif(typeof parsed.second != \"undefined\" && parsed.second !== false && parsed.second < 10){\n\t\tnparsed.second= \"0\" + parsed.second;\n\t}\n\telse if(parsed.second){\n\t\tnparsed.second = parsed.second;\n\t}\n\treturn nparsed;\n}\n\n\nFrameHelper.xsdFromParsed = function(parsed, ty){\n\tvar xparsed = this.addXsdPadding(parsed);\n\tif(ty == \"xsd:gYear\"){\n\t\tvar ret = (xparsed.year ? xparsed.year : false);\n\t}\n\telse if(ty == \"xsd:date\"){\n\t\treturn (xparsed.year && xparsed.month && xparsed.day) ? xparsed.year + \"-\" + xparsed.month + \"-\" + xparsed.day : false;\n\t}\n\telse if(ty == \"xsd:dateTime\" || ty == \"xsd:dateTimeStamp\"){\n\t\tvar ret = (xparsed.year && xparsed.month && xparsed.day) ? xparsed.year + \"-\" + xparsed.month + \"-\" + xparsed.day + \"T\" : false;\n\t\tif(ret) ret += (xparsed.hour ? xparsed.hour : \"12\") + \":\" + (xparsed.minute ? xparsed.minute : \"00\") + \":\" + (xparsed.second ? xparsed.second : \"00\");\n\t}\n\telse if(ty == \"xsd:gMonth\"){\n\t\tvar ret = (xparsed.month ? \"--\" + xparsed.month : false);\n\t}\n\telse if(ty == \"xsd:gDay\"){\n\t\tvar ret = (xparsed.day ? \"---\" + xparsed.day : false) ;\n\t}\n\telse if(ty == \"xsd:gYearMonth\"){\n\t\tvar ret = (xparsed.year && xparsed.month) ? xparsed.year + \"-\" + xparsed.month : false;\n\t}\n\telse if(ty == \"xsd:gMonthDay\"){\n\t\tvar ret = (xparsed.day && xparsed.month) ? \"--\" + xparsed.month + \"-\" + xparsed.day : false;\n\t}\n\tif(xparsed.timezone){\n\t\tret += xparsed.timezone;\n\t}\n\treturn ret;\n}\n\n\nFrameHelper.parseXsdTime = function(val){\n\tif(!val)return {};\n\tvar tz = this.extractXsdTimezone(val);\n\tif(tz){\n\t\tval = val.substring(0, val.length - tz.length);\n\t}\n\tvar parsed = {\n\t\thour: val.substring(0,2),\n\t\tminute: val.substring(3,5),\n\t\tsecond: val.substring(6),\n\t\ttimezone: tz\n\t}\n\treturn parsed;\n}\n\nFrameHelper.convertTimestampToXsd = function(val){\n\t  var a = new Date(val * 1000);\n\t  var parsed = {\n\t\t\tyear: a.getFullYear(),\n\t\t\tmonth: a.getMonth() + 1,\n\t\t\tday: a.getDate(),\n\t\t\thour: a.getHours(),\n\t\t\tminute: a.getMinutes(),\n\t\t\tsecond: a.getSeconds()\n\t  }\n\t  return parsed;\n}\n\nFrameHelper.parseXsdDateTime = function(val){\n\tif(!val)return {};\n\tif(typeof val == \"number\"){\n\t\treturn this.convertTimestampToXsd(val);\n\t}\n\tvar tz = this.extractXsdTimezone(val);\n\tif(tz){\n\t\tval = val.substring(0, val.length - tz.length);\n\t}\n\tvar datetime = this.parseXsdDate(val);\n\tvar ptime = this.paseXsdTime(val.substring(val.indexOf(\"T\")));\n\tfor(var i in ptime){\n\t\tdatetime[i] = ptime[i];\n\t}\n\tdatetime.timezone = tz;\n\treturn datetime;\n}\n\nFrameHelper.extractXsdTimezone = function(val){\n\tif(val && val.charAt(val.length-1) == \"Z\"){\n\t\treturn \"Z\";\n\t}\n\tif(val && val.charAt(val.length-6) == \"+\" || val.charAt(val.length-6) == \"-\" ){\n\t\tval.substring(val.length-6);\n\t}\n\treturn false;\n\n}\n\nFrameHelper.parseRangeValue = function(val, dividor){\n\tdividor = (dividor ? dividor : \",\");\n\tvar vals = [];\n\tif(typeof val == \"object\" && val.length){\n\t\tvals = val;\n\t}\n\telse if(val){\n\t\tif(typeof val != \"string\"){\n\t\t\tval = \"\" + val;\n\t\t}\n\t\tif(val.length && (val.charAt(0) == \"[\") && val.charAt(val.length -1) == \"]\"){\n\t\t\tvals.push(val.substring(1, val.indexOf(dividor)));\n\t\t\tvals.push(val.substring(val.indexOf(dividor) + 1, val.length -1));\n\t\t}\n\t\telse {\n\t\t\tvals.push(val);\n\t\t}\n\t}\n\treturn vals;\n}\n\nFrameHelper.loadDynamicScript = function(scriptid, src, callback) {\n\tconst existingScript = document.getElementById(scriptid);\n\tif (!existingScript) {\n\t\tconst script = document.createElement('script');\n\t\tscript.src = src; // URL for the third-party library being loaded.\n\t\tdocument.body.appendChild(script);\n\t\tscript.onload = function(){\n\t\t\tscript.id = scriptid; //do it here so it doesn't trigger the callback below on multiple calls\n\t\t\tif (callback) callback(scriptid);\n\t\t};\n\t}\n\tif (existingScript && callback) {\n\t\tcallback(scriptid);\n\t}\n};\n\nFrameHelper.loadDynamicCSS = function(cssid, src, callback) {\n\tconst existingScript = document.getElementById(cssid);\n\tif (!existingScript) {\n\t\tconst link = document.createElement('link');\n\t\tlink.href = src; // URL for the third-party library being loaded.\n\t\tlink.id = cssid; // e.g., googleMaps or stripe\n\t\tlink.rel = \"stylesheet\";\n\t\tdocument.body.appendChild(link);\n\t\tlink.onload = function(){\n\t\t\tif (callback) callback(cssid);\n\t\t};\n\t}\n\tif (existingScript && callback) callback(cssid);\n};\n\nmodule.exports=FrameHelper\n","const FrameHelper = require('../FrameHelper');\nconst WOQLResult = require('./WOQLResult');\n\nfunction WOQLQuery(client, options){\n\tthis.client = client;\n\tthis.options = options;\n\tthis.default_limit = 1000;\n\tthis.prefixes = {};\n\tif(client.connectionConfig.platformEndpoint()){\n\t\tvar sid = client.connectionConfig.server.substring(0, client.connectionConfig.server.lastIndexOf(\"platform\"));\n\t\tthis.sid = sid;\n\t\tvar colid = client.connectionConfig.server.substring(0, client.connectionConfig.server.lastIndexOf(\"platform\")) + client.connectionConfig.dbid;\n\t\tthis.prefixes['s'] = colid + \"/ontology/main#\";\n\t\tthis.prefixes['g'] = sid;\n\t\tthis.prefixes['db'] = colid + \"/\";\n\t\tthis.prefixes['doc'] = colid + \"/candidate/\";\n\t\tthis.prefixes['dg'] = colid + \"/graph/main/\";\n\t}\n\telse {\n\t\tthis.sid = client.connectionConfig.serverURL();\n\t\tthis.prefixes['s'] = client.connectionConfig.schemaURL() + \"#\";\n\t\tthis.prefixes['dg'] = client.connectionConfig.dbURL() + \"/schema\";\n\t\tthis.prefixes['doc'] = client.connectionConfig.docURL();\n\t\tthis.prefixes['db'] = client.connectionConfig.dbURL() + \"/\";\n\t\tthis.prefixes['g'] = client.connectionConfig.serverURL();\n\t}\n\tfor(var pref in FrameHelper.standard_urls){\n\t\tthis.prefixes[pref] = FrameHelper.standard_urls[pref];\n\t}\n}\n\nWOQLQuery.prototype.shorten = function(url){\n\tfor(var pref in this.prefixes){\n\t\tif(this.prefixes[pref] == url.substring(0, this.prefixes[pref].length)){\n\t\t\treturn ( pref + \"/\" + url.substring(this.prefixes[pref].length));\n\t\t}\n\t}\n\treturn url;\n}\n\nWOQLQuery.prototype.execute = function(woql){\n\tvar wrapped = this.wrap(woql);\n\tvar self = this;\n\treturn this.client.select(false, wrapped)\n\t.then(function(response){\n\t\tvar res = new WOQLResult(response, self, self.options);\n\t\treturn res;\n\t});\n}\n\nWOQLQuery.prototype.wrap = function(woql){\n\tvar wstr = \"prefixes([ \";\n\tvar i = 0;\n\tfor(var pref in this.prefixes){\n\t\tif(i++ > 0) wstr += \",\"\n\t\twstr += pref + \"='\" + this.prefixes[pref] + \"'\";\n\t}\n\twstr += \"], from(g/'\" + this.client.connectionConfig.dbid + \"',\" + woql + \"))\";\n\treturn wstr;\n}\n\nWOQLQuery.prototype.getAbstractQueryPattern = function(varname){\n\tvar aqp = \"t(v('\" + varname + \"'), dcog/tag, dcog/abstract, schema)\";\n\treturn aqp;\n}\n\nWOQLQuery.prototype.getSubclassQueryPattern = function(varname, clsname){\n\tvar sqp = \"(v('\" + varname + \"') << (\" + clsname + \"))\";\n\treturn sqp;\n}\n\nWOQLQuery.prototype.getAllDocumentQuery = function(constraint, limit, start){\n\tlimit = limit ? limit : this.default_limit ;\n\tstart = start ? start : 0;\n\tvar woql = \"limit( \" + limit + \", start(\" + start + \",\"\n\tvar vdoc = \"t(v('Document'), rdf/type, v('Type'))\";\n\twoql += \"select([v('Document'), v('Type')],(\" + vdoc;\n\twoql += \", (v('Type') << (dcog/'Document'))\";\n\tif(constraint) woql += \", \" + constraint;\n\twoql += \"))))\";\n\treturn woql;\n}\n\nWOQLQuery.prototype.getEverythingQuery = function(constraint, limit, start){\n\tlimit = limit ? limit : this.default_limit ;\n\tstart = start ? start : 0;\n\tvar woql = \"limit( \" + limit + \", start(\" + start + \",\"\n\tvar vdoc = \"t(v('Subject'), v('Predicate'), v('Object'))\";\n\twoql += \"select([v('Subject'), v('Predicate'), v('Object')],(\" + vdoc;\n\tif(constraint) woql += \", \" + constraint;\n\twoql += \"))))\";\n\treturn woql;\n}\n\nWOQLQuery.prototype.getPropertyListQuery = function(constraint){\n\tvar vEl = \"t(v('Property'), rdfs/range, v('Range'), schema)\";\n\tvar opts = [];\n\topts.push(\"t(v('Property'), rdf/type, v('Type'), schema)\");\n\topts.push(\"t(v('Property'), rdfs/label, v('Label'), schema)\");\n\topts.push(\"t(v('Property'), rdfs/comment, v('Comment'), schema)\");\n\topts.push(\"t(v('Property'), rdfs/domain, v('Domain'), schema)\");\n\tvar woql = \"select([v('Property'), v('Label'), v('Comment'), v('Domain'), v('Type'), v('Range')],(\" + vEl;\n\tif(constraint) woql += \", \" + constraint;\n\tfor(var i = 0; i<opts.length; i++){\n\t\twoql += \", opt(\" + opts[i] + \")\";\n\t}\n\twoql += \"))\";\n\treturn woql;\n}\n\n\nWOQLQuery.prototype.getElementMetaDataQuery = function(constraint, limit, start){\n\tlimit = (limit ? limit : this.default_limit);\n\tstart = (start ? start : 0);\n\tvar vEl = \"t(v('Element'), rdf/type, v('Type'), schema)\";\n\tvar opts = [];\n\topts.push(\"t(v('Element'), rdfs/label, v('Label'), schema)\");\n\topts.push(\"t(v('Element'), rdfs/comment, v('Comment'), schema)\");\n\topts.push(\"t(v('Element'), dcog/tag, v('Abstract'), schema)\");\n\topts.push(\"t(v('Element'), rdfs/domain, v('Domain'), schema)\");\n\topts.push(\"t(v('Element'), rdfs/range, v('Range'), schema)\");\n\tvar woql =\"limit( \" + limit + \", start(\" + start + \",\";\n\twoql += \"select([v('Element'), v('Type'), v('Label'), v('Comment'), v('Domain'), v('Range'), v('Abstract')],(\" + vEl;\n\tif(constraint) woql += \", \" + constraint;\n\tfor(var i = 0; i<opts.length; i++){\n\t\twoql += \", opt(\" + opts[i] + \")\";\n\t}\n\twoql += \"))))\";\n\treturn woql;\n}\n\nWOQLQuery.prototype.getClassListMetaDataQuery = function(constraint){\n\tvar vClass = \"t(v('Class'), rdf/type, owl/'Class', schema)\";\n\tvar opts = [];\n\topts.push(\"t(v('Class'), rdfs/label, v('Label'), schema)\");\n\topts.push(\"t(v('Class'), rdfs/comment, v('Comment'), schema)\");\n\topts.push(\"t(v('Class'), dcog/tag, v('Abstract'), schema)\");\n\tvar woql = \"select([v('Class'), v('Label'), v('Comment'), v('Abstract')],(\" + vClass;\n\tif(constraint) woql += \", \" + constraint;\n\tfor(var i = 0; i<opts.length; i++){\n\t\twoql += \", opt(\" + opts[i] + \")\";\n\t}\n\twoql += \"))\";\n\treturn woql;\n}\n\nWOQLQuery.prototype.getClassMetaDataQuery = function(constraint, limit, start){\n\tlimit = (limit ? limit : this.default_limit);\n\tstart = (start ? start : 0);\n\tvar vClass = \"t(v('Class'), rdf/type, owl/'Class', schema)\";\n\tvar opts = [];\n\topts.push(\"t(v('Class'), rdfs/label, v('Label'), schema)\");\n\topts.push(\"t(v('Class'), rdfs/comment, v('Comment'), schema)\");\n\topts.push(\"t(v('Class'), dcog/tag, v('Abstract'), schema)\");\n\tvar woql =\"limit( \" + limit + \", start(\" + start + \",\";\n\twoql += \"select([v('Class'), v('Label'), v('Comment'), v('Abstract')],(\" + vClass;\n\tif(constraint) woql += \", \" + constraint;\n\tfor(var i = 0; i<opts.length; i++){\n\t\twoql += \", opt(\" + opts[i] + \")\";\n\t}\n\twoql += \"))))\";\n\treturn woql;\n}\n\nWOQLQuery.prototype.getDataOfChosenClassQuery = function(chosen, limit, start){\n\tlimit = (limit ? limit : this.default_limit);\n\tstart = (start ? start : 0);\n\tvar gLink = \"'\"+chosen+\"'\";//\"g/'\" + chosen.substring(this.sid.length, chosen.length) + \"'\";\n\tvar vEl = \"t(v('Document'), rdf/type, \" + gLink + \")\";\n\tvar opts = \"t(v('Document'),  v('Property'), v('Value'))\";\n\tvar woql = \"limit( \" + limit + \", start(\" + start + \",\";\n\twoql += \"select([v('Document'), v('Property'), v('Value')],(\" + vEl + \",\";\n\twoql += opts;\n\twoql += \"))))\";\n\treturn woql;\n}\n\nWOQLQuery.prototype.getDataOfChosenPropertyQuery = function(chosen, limit, start){\n\tlimit = (limit ? limit : this.default_limit);\n\tstart = (start ? start : 0);\n\tvar gLink = \"'\"+chosen+\"'\";//\"g/'\" + chosen.substring(this.sid.length, chosen.length) + \"'\";\n\tvar vdoc = \"t(v('Document'), \" + gLink + \", v('Value')),\";\n\tvar ldoc = \"opt(t(v('Document'), rdfs/label, v('Label')))\";\n\tvar woql = \"limit( \" + limit + \", start(\" + start + \",\";\n\twoql += \"select([v('Document'), v('Label'), v('Value')],(\" + vdoc + ldoc;\n\twoql += \"))))\";\n\treturn woql;\n}\n\nWOQLQuery.prototype.getInstanceMeta = function(url){\n\tvar docid = \"'\" + url + \"'\";\n\tvar vEl = \"t(\" + docid + \", rdfs/label, v('InstanceLabel'))\";\n\tvEl += \", t(\" + docid + \", rdf/type, v('InstanceType'))\" \n\tvar opts = [];\n\topts.push(\"t(\" + docid + \", rdfs/comment, v('InstanceComment'))\");\n\topts.push(\"t(v('InstanceType'), rdfs/label, v('ClassLabel'), schema)\");\n\tvar woql = \"select([v('InstanceLabel'), v('InstanceType'), v('InstanceComment'), v('ClassLabel')],(\" + vEl;\n\tfor(var i = 0; i<opts.length; i++){\n\t\twoql += \", opt(\" + opts[i] + \")\";\n\t}\n\twoql += \"))\";\n\treturn woql;\t\n}\n\n\nWOQLQuery.prototype.getDocumentQuery = function(id, limit, start){\n\tlimit = (limit ? limit : this.default_limit);\n\tstart = (start ? start : 0);\n\tvar docid = \"'\" + id + \"'\";\n\tvar vEl = \"t(doc/\" + docid + \", v('Property'), v('Property Value'))\";\n\tvar opts = [];\n\topts.push(\"t(v('Property'), rdfs/label, v('Property Label'), schema)\");\n\topts.push(\"t(v('Property'), rdf/type, v('Property Type'), schema)\");\n\tvar woql = \"limit( \" + limit + \", start(\" + start + \",\";\n\twoql += \"select([v('Property Label'), v('Property'), v('Property Value'), v('Property Type')],(\" + vEl;\n\tfor(var i = 0; i<opts.length; i++){\n\t\twoql += \", opt(\" + opts[i] + \")\";\n\t}\n\twoql += \"))))\";\n\treturn woql;\n}\n\nWOQLQuery.prototype.getClassesQuery = function(){\n\tvar vEl = \"t(v('ID'), rdf/type, v('Class'))\";\n\tvar opts = [];\n\topts.push(\"t(v('ID'), rdfs/label, v('Label'))\");\n\topts.push(\"t(v('ID'), rdfs/comment, v('Comment'))\");\n\topts.push(\"t(v('Class'), rdfs/label, v('Type'),schema)\");\n\tvar woql = \"select([v('Label'),v('Comment'),v('ID'),v('Type'),v('Class')],(\" + vEl;\n\twoql += \", (v('Class') << (dcog/'Document'))\";\n\tfor(var i = 0; i<opts.length; i++){\n\t\twoql += \", opt(\" + opts[i] + \")\";\n\t}\n\twoql += \"))\";\n\treturn woql;\n}\n\nmodule.exports=WOQLQuery\n","/**\n * @file Javascript Api explorer tool\n * @author Kitty Jose\n * @license Copyright 2018-2019 Data Chemist Limited, All Rights Reserved. See LICENSE file for more\n *\n * @summary Set of functions used across scripts\n */\nconst Codemirror= require('./plugins/codemirror.terminus')\n// function to read Files\nfunction readFile(file){\n  if (window.XMLHttpRequest){\n    // code for IE7+, Firefox, Chrome, Opera, Safari\n    xmlhttp=new XMLHttpRequest();\n  }\n  else{\n    // code for IE6, IE5\n    xmlhttp=new ActiveXObject(\"Microsoft.XMLHTTP\");\n  }\n  xmlhttp.open(\"GET\",file,false);\n  xmlhttp.send();\n  xmlDoc=xmlhttp.responseText;\n  return xmlDoc;\n} // readFile()\n\n// function to write api call signatures from woql client\nfunction getFunctionSignature(which){\n  var sigs = {};\n  sigs.connect = {\n    spec   : \"WOQLClient.connect(server_url, key)\",\n    descr  : \"\\n\\nConnect to a Terminus server at the given URI with an API key\"\n                + \"Stores the terminus:ServerCapability document returned in the connection register\"\n                + \"which stores, the url, key, capabilities, and database meta-data for the connected server\"\n                + \"If the curl argument is false or null, the this.server will be used if present,\"\n                + \" or the promise will be rejected.\",\n    result : \"HTTP 200 on success, 409 for already existing database, otherwise error code\",\n    args   : {server_url : 'url', key: 'Api key'},\n    options: { title: \"\", description: \"\" }\n  };\n  sigs.create = {\n    spec    : \"WOQLClient.createDatabase(database_url, details, key)\",\n    descr   : \"\\n\\nCreate a Terminus Database by posting a terminus:\"\n                + \"The dburl argument can be \\n1) a valid URL of a terminus database or \\n2) a valid Terminus \"\n                + \"database id or \\n3) can be omitted\"\n                + \"\\nin case 2) the current server will be used, \"\n    \t\t        + \"\\nin case 3) the database id will be set from the @id field of the terminuse:Database document.\"\n                + \"\\nThe second (details) argument contains a \\nterminus:Database document with a mandatory \"\n                + \"\\nrdfs:label field and an optional rdfs:comment field.\"\n                +  \"\\nThe third (key) argument contains an optional API key \",\n    result : \"HTTP 200 on success, 409 for already existing database, otherwise error code\",\n    args   : {database_url : 'url', details: '', key: ' Api key'},\n    options: { title: \"\", description: \"\" }\n  };\n  sigs.delete = {\n      spec  : \"WOQLClient.deleteDatabase(database_url, options)\",\n      descr : \"\\n\\nDeletes a Database\"\n                + \"\\nThe first (dburl) argument can \\n1) a valid URL of a terminus database or \\n2) a valid database id\"\n                + \" or \\n3) ommitted in case \\n2) the current server will be used, and in case \\n3) the current server \"\n                + \"and database will be used. \\nThe second argument (opts) is an options json - no options are\"\n                + \" currently supported for this function\",\n      result: \"HTTP 200 on success, otherwise error code\",\n  };\n  sigs.getSchema = {\n    spec   : \"WOQLClient.getSchema(schema_url, options)\",\n    descr  : \"\\n\\nGets the schema of a database. \\nThe first (schurl) argument can be \"\n              + \"\\n1) a valid URL of a terminus database or \\n2) a valid database id or \"\n              + \"\\n3) omitted, \\nin case 2) the current server will be used, and \\nin case 3) the current server and\"\n              + \"database will be used the second argument (opts) is an options json - \"\n              + \"\\nopts.format is optional and defines which format is requested (*json / turtle)\"\n              + \"\\nopts.key is an optional API key\",\n    result : \"Ontology Document on success (HTTP 200), 409 for already existing database, otherwise error code\",\n    options: { format: \"turtle\" }\n  };\n  sigs.getClassFrames = {\n    spec   : \"WOQLClient.getClassFrame = function(cfurl, cls, opts)\",\n    descr  : \"\\n\\nRetrieves a WOQL query on the specified database which updates the state and returns the results\"\n              +  \"\\nThe first (cfurl) argument can be\"\n              + \"\\n1) a valid URL of a terminus database or\"\n              +  \"\\n2) omitted - the current database will be used\"\n              +  \"\\nthe second argument (cls) is the URL / ID of a document class that exists in the database schema\"\n              +  \"\\nthe third argument (opts) is an options json - opts.key is an optional API key\",\n    result : \"Ontology Document on success (HTTP 200), 409 for already existing database, otherwise error code\",\n    options: { format: \"turtle\" }\n  };\n  sigs.updateSchema = {\n    spec    : \"WOQLClient.updateSchema(schema_url, docs, options)\",\n    descr   : \"\\n\\nUpdates the Schema of the specified database\"\n              + \"\\nThe first (schurl) argument can be \\n1) a valid URL of a terminus database or \\n2)\"\n              + \" a valid database id or \\n3) omitted, \\nin case 2) the current server will be used,\"\n              + \" and \\nin case 3) the current server and database will be used\"\n              + \"\\nThe second argument (doc) is a valid owl ontology in json-ld or turtle format\"\n              + \"\\nthe third argument (opts) is an options json - \"\n     \t\t      + \"opts.format is used to specify which format is being used (*json / turtle)\"\n     \t\t      + \"opts.key is an optional API key\",\n    result : \"Ontology Document on success (HTTP 200), 409 for already existing database, otherwise error code\",\n    args   : {document : 'doc'},\n    options: { format: \"turtle\", editmode: \"replace\"}\n  };\n  sigs.createDocument = {\n    spec   : \"WOQLClient.createDocument(document_url, document, options)\",\n    descr  : \"\\n\\nCreates a new document in the specified database\"\n              + \"\\nThe first (docurl) argument can be\"\n              + \"\\n1) a valid URL of a terminus database (an id will be randomly assigned) or\"\n              + \"\\n2) a valid URL or of a terminus document (the document will be given the passed URL) or\"\n              + \"\\n3) a valid terminus document id (the current server and database will be used)\"\n              + \"\\n4) can be ommitted (the URL will be taken from the document if present)\"\n              + \"\\nThe second argument (doc) is a valid document in json-ld\"\n              + \"\\nthe third argument (opts) is an options json - opts.key is an optional API key\",\n    result : \"Created Document on success (HTTP 200), Violation Report Otherwise (HTTP 400+)\",\n    args   : {document_url : 'url', document: \"doc\"},\n    options: { format: \"turtle\", fail_on_id_denied: false}\n  };\n  sigs.viewDocument = {\n    spec    : \"WOQLClient.getDocument(document_url, options)\",\n    descr   : \"\\n\\nRetrieves a document from the specified database\"\n              + \"\\nThe first (docurl) argument can be\"\n              + \"\\n1) a valid URL of a terminus document or\"\n              + \"\\n2) a valid ID of a terminus document in the current database\"\n              + \"\\nthe second argument (opts) is an options json - \"\n              + \"\\nopts.key is an optional API key\"\n              + \"\\nopts.shape is frame | *document \",\n    result : \"Document (HTTP 200), Violation Report Otherwise (HTTP 400+)\",\n    args   : {document_url : 'url'},\n    options: { format: \"turtle\"}\n  };\n  sigs.updateDocument = {\n    spec   : \"WOQLClient.updateDocument(document_url, document, options)\",\n    descr  : \"\\n\\nUpdates a document in the specified database with a new version\"\n              + \"\\nThe first (docurl) argument can be\"\n              + \"\\n1) a valid URL of a terminus document or \"\n              + \"\\n2) a valid ID of a terminus document in the current database or\"\n              + \"\\n3) ommitted in which case the id will be taken from the document @id field\"\n              + \"\\nthe second argument (doc) is a document in json-ld format\"\n              + \"\\nthe third argument (opts) is an options json - opts.key is an optional API key\",\n    result : \"Ontology Document on success (HTTP 200), 409 for already existing database, otherwise error code\",\n    args   : {document_url : 'url', document: \"doc\"},\n    options: { format: \"turtle\", editmode: \"replace\"}\n  };\n  sigs.deleteDocument = {\n    spec  : \"WOQLClient.deleteDocument(document_url, options)\",\n    descr : \"\\n\\nDeletes a document from the specified database\"\n            + \"\\nThe first (docurl) argument can be\"\n            + \"\\n1) a valid URL of a terminus document or\"\n            + \"\\n2) a valid ID of a terminus document in the current database\"\n            + \"\\n3) omitted - the current document will be used\"\n            + \"\\nthe second argument (opts) is an options json - opts.key is an optional API key\",\n    result: \"Ontology Document on success (HTTP 200), 409 for already existing database, otherwise error code\",\n    args  : {document_url : 'url'},\n  };\n  sigs.select = {\n    spec: \"WOQLClient.select(database_url, woql, options)\",\n    descr: \"\\n\\nExecutes a read-only WOQL query on the specified database and returns the results\"\n              + \"\\nThe first (qurl) argument can be \"\n              + \"\\n1) a valid URL of a terminus database or \"\n              + \"\\n2) omitted - the current database will be used \"\n              + \"\\nthe second argument (woql) is a woql select statement encoded as a string\"\n              + \"\\nthe third argument (opts) is an options json - opts.key is an optional API key\",\n    result: \"WOQL Result (HTTP 200), otherwise error code\",\n    args: {woql: 'woql'},\n  };\n  sigs.update = {\n    spec  : \"WOQLClient.update(database_url, woql, options)\",\n    descr : \"\\n\\nExecutes a WOQL query on the specified database which updates the state and returns the results\"\n            + \"\\nThe first (qurl) argument can be \"\n            + \"\\n1) a valid URL of a terminus database or \"\n            + \"\\n2) omitted - the current database will be used \"\n            + \"\\nthe second argument (woql) is a woql select statement encoded as a string\"\n            + \"\\nthe third argument (opts) is an options json - opts.key is an optional API key\",\n    result: \"WOQL Result (HTTP 200), otherwise error code\",\n    args  : {woql: 'woql'},\n  };\n  sigs.lookup = {\n    spec: \"WOQLClient.lookup(database_url, woql, options)\",\n    result: \"WOQL Result (HTTP 200), otherwise error code\",\n    args: {class: 'url', term: 'string'},\n  };\n  sigs.map = {\n    spec: \"WOQLClient.lookup(source, target, woql, options)\",\n    result: \"WOQL Result (HTTP 200), otherwise error code\",\n    args: {source: 'json', target: \"json\", woql: 'json'},\n  };\n  sigs.getClassFrame = {\n    spec: \"WOQLClient.getClassFrame(class, options)\",\n    result: \"WOQL Result (HTTP 200), otherwise error code\",\n    args: {class: 'url'},\n  };\n  sigs.getPropertyFrame = {\n    spec: \"WOQLClient.getPropertyFrame(class, property, options)\",\n    result: \"WOQL Result (HTTP 200), otherwise error code\",\n    args: {class: 'url', property: 'url'},\n  };\n  sigs.getFilledPropertyFrame = {\n    spec: \"WOQLClient.getPropertyFrame(document_url, property, options)\",\n    result: \"WOQL Result (HTTP 200), otherwise error code\",\n    args: {document_url: 'url', property: 'url'},\n  };\n  sigs.getSubClasses = {\n    spec: \"WOQLClient.getSubClasses(class, options)\",\n    result: \"WOQL Result (HTTP 200), otherwise error code\",\n    args: {class: 'url'},\n  };\n  return sigs[which];\n}//getFunctionSignature\n\n// returns dom element for header text\nfunction getHeaderDom(text){\n  var hd = document.createElement('div');\n  hd.setAttribute('class', 'terminus-module-head');\n  var h = document.createElement('h3');\n  h.innerHTML = text;\n  hd.appendChild(h);\n  return hd;\n} // getHeaderTextDom\n\n// returns dom for alert banner\nfunction getInfoAlertDom(type, label, msg){\n  var ald = document.createElement('div');\n  if(type == 'info') ald.setAttribute('class', 'terminus-alert terminus-alert-success');\n  else ald.setAttribute('class', 'alert');\n  var str = document.createElement('STRONG');\n  str.innerHTML = label;\n  ald.appendChild(str);\n  var txt = document.createTextNode(msg);\n  ald.appendChild(txt);\n  return ald;\n} // getInfoAlertDom()\n\n// formats response results from platform\nfunction getResponse(currForm, action, response, terminator){\n\n  var rd = document.createElement('div');\n\n  // get header result\n  rd.appendChild(UTILS.getHeaderDom('Result'));\n  var br = document.createElement('BR');\n  rd.appendChild(br);\n\n  var data = JSON.stringify(response, 0, 4);\n\n  var pre = document.createElement('pre');\n  pre.setAttribute('class', 'terminus-api-view terminus-scheme-pre');\n  pre.innerHTML = data;\n\n  var cm = stylizeCodeDisplay(terminator, pre, rd, 'javascript');\n  if(!cm) rd.appendChild(pre);\n\n  var br = document.createElement('BR');\n  rd.appendChild(br);\n\n  currForm.appendChild(rd);\n\n  return currForm;\n}\n\n// formats the response from fetch call and spits out Http header and result\nfunction showHttpResult(response, action, currForm, terminator){\n    //var currForm = document.createElement('div');\n\n    var br = document.createElement('BR');\n    currForm.appendChild(br);\n    var br = document.createElement('BR');\n    currForm.appendChild(br);\n\n    // get header result\n    currForm.appendChild(UTILS.getHeaderDom('HTTP Header'));\n\n    var br = document.createElement('BR');\n    currForm.appendChild(br);\n\n     var retHttpHeaders  = '';\n\n     // iterate over all headers\n     for (let [key, value] of response.headers) {\n       retHttpHeaders = retHttpHeaders +  `${key} = ${value}` + '\\n';\n     }\n\n    // http header result\n    var hdres = document.createElement('pre');\n    hdres.setAttribute('class', 'terminus-api-signature-pre');\n    var txt = document.createTextNode(retHttpHeaders);\n    hdres.appendChild(txt);\n\n    var cm = stylizeCodeDisplay(terminator, hdres, currForm, 'message/http');\n    if(!cm) currForm.appendChild(hdres);\n\n    return response.json()\n    .then(function(response){\n      getResponse(currForm, action, response, terminator); // get return response\n    })\n\n} // UTILS.showHttpResult()\n\n\nfunction deleteStylizedEditor(ui, qip){\n    if(ui.pluginAvailable(\"codemirror\")){\n\t\tvar cm = qip.nextElementSibling;\n\t\tcm.setAttribute('class', 'terminus-hide');\n\t\tFrameHelper.removeChildren(cm);\n\t}\n}\n\n/* ui: terminus ui reference\n   txt: text area to be stylized\n   view: defines the size of editor to appear in pages (schema/ query)\n   mode: format to be displayed in\n*/\nfunction stylizeEditor(ui, txt, view, mode){\n    var cmConfig = ui.pluginAvailable(\"codemirror\");\n    if(!(cmConfig)) return;\n\tvar cm = new Codemirror(txt, mode, cmConfig);\n\tvar ar = cm.colorizeTextArea(view);\n\tcm.updateTextArea(ar);\n}\n\n/* ui: terminus ui reference\n   txt: text area to be stylized\n   dom: stylized pre area is appended to dom\n   mode: format to be displayed in\n*/\nfunction stylizeCodeDisplay(ui, txt, dom, mode){\n    var cmConfig = ui.pluginAvailable(\"codemirror\");\n    if(!(cmConfig)) return false;\n    var cm = new Codemirror(txt, mode, cmConfig);\n    var pr = cm.colorizePre();\n    dom.appendChild(pr);\n    return true;\n}\n\n/* name: classname to find and remove classes from elements\n*/\nfunction removeSelectedNavClass(name){\n    var el = document.getElementsByClassName(name);\n    for(var i=0; i<el.length; i++){\n        el[i].classList.remove(name);\n    }\n}\n\n// toggles between contents\nfunction tolggleContent(icon, content){\n    if (content.style.display === \"block\"){\n        removeSelectedNavClass(\"fa-chevron-up\");\n        icon.classList.add(\"fa-chevron-down\");\n        content.style.display = \"none\";\n    }\n    else{\n        removeSelectedNavClass(\"fa-chevron-down\");\n        icon.classList.add(\"fa-chevron-up\");\n        content.style.display = \"block\";\n    }\n}\n\nmodule.exports={tolggleContent,\n               removeSelectedNavClass,\n               stylizeCodeDisplay,\n               stylizeEditor,\n               deleteStylizedEditor,\n               showHttpResult,\n               getHeaderDom,\n               getInfoAlertDom,\n               getFunctionSignature}\n","const FrameHelper = require('../FrameHelper');\n\nfunction TerminusPluginManager(){\n\tthis.preloaded = [];\n\tthis.loaded = [];\n\tthis.loading = [];\n\tthis.precluded = [];\n\tthis.plugins = {};\n\tthis.plugins[\"font-awesome\"] = {\n\t\tlabel: \"Font Awesome\",\n\t\tcss: [\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0-11/css/all.css\"]\n\t};\n\tthis.plugins[\"quill\"] = {\n\t\tlabel: \"Quill\",\n\t\tjs: [\"https://cdn.quilljs.com/1.3.6/quill.min.js\"],\n\t\tcss: [\"https://cdn.quilljs.com/1.3.6/quill.snow.css\"],\n\t\tplugin: \"quill.terminus.js\",\n\t};\n\tthis.plugins[\"codemirror\"] = {\n\t\tlabel : \"Code Mirror\",\n\t\tjs: [\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/codemirror.js\",\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/mode/xml/xml.js\",\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/mode/css/css.js\",\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/mode/turtle/turtle.js\",\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/mode/javascript/javascript.js\",\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/addon/hint/anyword-hint.js\",\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/addon/hint/show-hint.js\",\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/addon/runmode/runmode.js\",\n\t\t  \t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/mode/http/http.js\",\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/addon/edit/closebrackets.js\",\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/addon/edit/matchbrackets.js\",\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/addon/display/placeholder.js\"\n\t  ],\n\t\tcss: [\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/codemirror.css\",\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.2/addon/hint/show-hint.css\",\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/theme/neo.css\",\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/theme/erlang-dark.css\",\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/theme/eclipse.css\"\n\t\t]\n\t};\n\tthis.plugins[\"jquery\"] = {\n\t\tlabel: \"jQuery\",\n\t\tjs: [\"https://code.jquery.com/jquery-2.2.4.min.js\"]\n\t};\n\tthis.plugins[\"jqueryui\"] = {\n\t\tlabel: \"jQuery UI\",\n\t\tcss: [\"https://code.jquery.com/ui/1.12.0/themes/smoothness/jquery-ui.css\"],\n\t\tjs: [\"https://code.jquery.com/ui/1.12.0/jquery-ui.js\"],\n\t\trequires: ['jquery']\n\t};\n\tthis.plugins[\"datatables\"] = {\n\t\tlabel: \"Data Tables\",\n\t\tjs: [\"https://cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js\"],\n\t\tcss: [\"https://cdn.datatables.net/1.10.19/css/jquery.dataTables.min.css\"],\n\t\trequires: ['jquery']\n\t};\n\t/*this.plugins[\"prettify\"] = {\n\t\tlabel: \"Prettify\",\n\t\tjs: [\"https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.js\"],\n\t\tcss: [\"https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.css\"],\n\t\trequires: ['jquery']\n\t};*/\n\tthis.plugins[\"gmaps\"] = {\n\t\tlabel: \"Google Maps\",\n\t\tjs: [\"https://maps.googleapis.com/maps/api/js\"],\n\t\tplugin: \"gmaps.terminus.js\"\n\t};\n\tthis.plugins[\"d3\"] = {\n\t\tlabel: \"d3\",\n\t\tjs: [\"https://code.jquery.com/jquery-2.2.4.min.js\"],\n\t\trequires: ['jquery']\n\t};\n\tthis.plugins[\"select2\"] = {\n\t\tlabel: \"Select 2\",\n\t\tjs: [\"https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.7/js/select2.min.js\"],\n\t\tcss: [\"https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.7/css/select2.min.css\"],\n\t\tplugin: \"select2.terminus.js\",\n\t\trequires: ['jquery']\n\t};\n\tthis.plugins[\"jsoneditor\"] = {\n\t\tlabel: \"JSON Editor\",\n\t\tjs: [\"plugins/libs/jsoneditor.min.js\"],\n\t\tcss: [\"plugins/libs/jsoneditor.min.css\"],\n\t\tplugin: \"jsoneditor.terminus.js\"\n\t};\n\t/*this.plugins[\"bootstrap\"] = {\n\t\tlabel: \"Bootstrap\",\n\t\tjs: [\"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js\"],\n\t\tcss: [\"https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/2.2.2/css/bootstrap.min.css\",\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/2.2.2/css/bootstrap-responsive.min.css\"]\n\t};\n\tthis.plugins[\"flot\"] = {\n\t\tlabel: \"Flot\",\n\t\tjs: [\"https://cdnjs.cloudflare.com/ajax/libs/flot/0.8.3/jquery.flot.min.js\",\n\t\t\t\"https://cdnjs.cloudflare.com/ajax/libs/flot/0.8.3/jquery.flot.resize.min.js\"],\n\t\trequires: [\"jquery\"]\n\t};*/\n}\n\nTerminusPluginManager.prototype.setPluginOptions = function(opts){\n\tfor(var p in opts){\n\t\tif(!this.plugins[p]) continue;\n\t\tfor(var k in opts[p]){\n\t\t\tthis.plugins[p][k] = opts[p][k];\n\t\t}\n\t}\n}\n\nTerminusPluginManager.prototype.init = function(opts, then){\n\tif(opts) this.setPluginOptions(opts);\n\tthis.calculatePreloaded();\n\tvar toload = this.calculateRequiredInitPlugins(opts);\n\tif(toload && toload[0].length) {\n\t\tif(toload[1].length){\n\t\t\tvar self = this;\n\t\t\tvar nthen = function(){\n\t\t\t\tself.loadPlugins(toload[1], then);\n\t\t\t}\n\t\t\tthis.loadPlugins(toload[0], nthen);\n\t\t}\n\t\telse {\n\t\t\tthis.loadPlugins(toload[0], then);\n\t\t}\n\t}\n\telse if(then){\n\t\tthen();\n\t}\n}\n\nTerminusPluginManager.prototype.calculateRequiredInitPlugins = function(opts){\n\tif(opts){\n\t\tvar pins = [];\n\t\tfor(var pid in opts){\n\t\t\tif(opts[pid] && pins.indexOf(pid) == -1){\n\t\t\t\tif(typeof opts[pid] != \"object\" && opts[pid]){\n\t\t\t\t\tpins.push(pid);\n\t\t\t\t}\n\t\t\t\telse if(typeof opts[pid] == \"object\"){\n\t\t\t\t\tif(!(typeof opts[pid].loaded != \"undefined\" && !opts[pid].loaded)){\n\t\t\t\t\t\tpins.push(pid);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\telse {\n\t\tvar pins = this.getDefaultPlugins();\n\t}\n\tvar needed_pins = [];\n\tfor(var i = 0; i<pins.length; i++){\n\t\tif(this.loaded.indexOf(pins[i]) == -1 && this.preloaded.indexOf(pins[i]) == -1 ){\n\t\t\tneeded_pins.push(pins[i])\n\t\t}\n\t}\n\tvar loading_order = [[], []];\n\tfor(var i = 0; i<needed_pins.length; i++){\n\t\tif(this.plugins[needed_pins[i]].requires && this.plugins[needed_pins[i]].requires.length){\n\t\t\tloading_order[1].push(needed_pins[i]);\n\t\t}\n\t\telse {\n\t\t\tloading_order[0].push(needed_pins[i]);\n\t\t}\n\t}\n\treturn loading_order;\n}\n\nTerminusPluginManager.prototype.getAvailablePlugins = function(){\n\treturn this.plugins;\n}\n\nTerminusPluginManager.prototype.calculatePreloaded = function(){\n\tfor(var pl in this.plugins){\n\t\tif(this.pluginAvailable(pl)){\n\t\t\tthis.preloaded.push(pl);\n\t\t}\n\t}\n}\n\nTerminusPluginManager.prototype.pluginAvailable = function(plugin, version_check){\n\tif(typeof this.plugins[plugin] == \"object\"){\n\t\tvar pluginmeta = this.plugins[plugin];\n\t\tif(pluginmeta.requires && pluginmeta.requires.length){\n\t\t\tfor(var i =0 ; i < pluginmeta.requires.length; i++){\n\t\t\t\tif(!this.pluginAvailable(pluginmeta.requires[i], version_check)) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tvar required_version = (pluginmeta.version ? pluginmeta.version : false);\n\t\tswitch(plugin){\n\t\t\tcase \"jquery\": {\n\t\t\t\tif(typeof jQuery == \"undefined\") return false;\n\t\t\t\tif(version_check && required_version){}\n\t\t\t\treturn true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase \"jqueryui\": {\n\t\t\t\tif(typeof jQuery != \"undefined\" && jQuery.isFunction( jQuery.fn.slider )) return true;\n\t\t\t\treturn false;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase \"quill\": {\n\t\t\t\tif(typeof Quill == \"undefined\") return false;\n\t\t\t\treturn true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase \"jsoneditor\": {\n\t\t\t\tif(typeof JSONEditor == \"undefined\") return false;\n\t\t\t\treturn true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase \"codemirror\": {\n\t\t\t\tif(typeof CodeMirror == \"undefined\") return false;\n\t\t\t\treturn this.plugins[plugin];  // sent plugin config with darkmode true/ false\n\t\t\t}\n\t\t\tcase \"font-awesome\": {\n\t\t\t\t//if(typeof CodeMirror != \"undefined\") return true;\n\t\t\t\treturn this.fontAwesomeCheck();\n\t\t\t}\n\t\t\tcase \"datatables\": {\n\t\t\t\t if(typeof jQuery != \"undefined\" && jQuery.isFunction( jQuery.fn.dataTable)) return true;\n\t\t\t\t return false;\n\t\t\t}\n\t\t\tcase \"select2\": {\n\t\t\t\t if(typeof jQuery != \"undefined\" && jQuery.isFunction( jQuery.fn.select2 )) return true;\n\t\t\t\t return false;\n\t\t\t}\n\t\t\tcase \"gmaps\": {\n\t\t\t\tif(typeof google == \"undefined\" || typeof google.maps == \"undefined\") return false;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tcase \"openlayers\": {\n\t\t\t\tif(typeof ol == \"undefined\" || typeof ol.Map == \"undefined\") return false;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tcase \"d3\": {\n\t\t\t\tif(typeof d3 == \"undefined\") return false;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t}\n\telse {\n\t\tconsole.log(new Error(plugin + \" is not a supported plugin ID\"));\n\t}\n\treturn false;\n};\n\nTerminusPluginManager.prototype.fontAwesomeCheck = function(){\n\tvar span = document.createElement('span');\n\tspan.className = 'fa';\n\tspan.style.display = 'none';\n\tdocument.body.insertBefore(span, document.body.firstChild);\n\tfunction css(element, property) {\n\t  return window.getComputedStyle(element, null).getPropertyValue(property);\n\t}\n\tvar loaded = false;\n\tvar fontAwsm = css(span, 'font-family');\n\tif (fontAwsm.replace(/\"/g, \"\") == 'Font Awesome 5 Free') { // remove double quotes\n\t\tloaded = true;\n\t}\n\tdocument.body.removeChild(span);\n\treturn loaded;\n}\n\nTerminusPluginManager.prototype.getDefaultPlugins = function(){\n\tvar defplugs = [\"font-awesome\"];\n\treturn defplugs;\n}\n\nTerminusPluginManager.prototype.loadPlugins = function(plugins, then){\n\tvar ticker = plugins.length;\n\tvar cback = function(){\n\t\tif(--ticker <= 1 && then){\n\t\t\tthen();\n\t\t}\n\t};\n\tfor(var i = 0; i < plugins.length; i++){\n\t\tthis.loadPlugin(plugins[i], cback);\n\t}\n}\n\nTerminusPluginManager.prototype.loadPlugin = function(plugin, then){\n\tvar pug = this.plugins[plugin];\n\tif(pug.css){\n\t\tfor(var i=0; i<pug.css.length; i++){\n\t\t\tvar cssid = plugin + \"_css_\" + i;\n\t\t\tFrameHelper.loadDynamicCSS(cssid, pug.css[i]);\n\t\t}\n\t}\n\tvar scripts = (pug.js ? pug.js : []);\n\tif(plugin == \"gmaps\" && pug.key){\n\t\tscripts[0] += \"?key=\" + pug.key;\n\t}\n\tif(pug.plugin){\n\t\tscripts.push(\"plugins/\" + pug.plugin);\n\t}\n\tif(plugin == \"codemirror\"){\n\t\tvar cm = scripts[0];\n\t\tvar sid = plugin + \"_js_\" + (scripts.length -1);\n\t\tscripts.splice(0, 1);\n\t\tvar self = this;\n\t\tvar cback = function(){\n\t\t\tself.loadPluginScripts(plugin, scripts, then);\n\t\t}\n\t\tFrameHelper.loadDynamicScript(sid, cm, cback);\n\t}\n\telse {\n\t\tthis.loadPluginScripts(plugin, scripts, then);\n\t}\n}\n\nTerminusPluginManager.prototype.loadPluginScripts = function(plugin, scripts, then){\n\tvar ticker = scripts.length - 1;\n\tvar self = this;\n\tvar cback = function(){\n\t\tif(ticker == 0) {\n\t\t\tif(self.loaded.indexOf(plugin) == -1){\n\t\t\t\tself.loaded.push(plugin);\n\t\t\t}\n\t\t\tif(self.loading.indexOf(plugin) != -1){\n\t\t\t\tself.loading.splice(self.loading.indexOf(plugin), 1);\n\t\t\t}\n\t\t\tthen();\n\t\t}\n\t\tticker--;\n\t};\n\tif(scripts.length == 0){\n\t\tthis.loaded.push(plugin);\n\t}\n\telse {\n\t\tthis.loading.push(plugin);\n\t}\n\tfor(var i = 0; i<scripts.length; i++){\n\t\tvar sid = plugin + \"_js_\" + i;\n\t\tFrameHelper.loadDynamicScript(sid, scripts[i], cback);\n\t}\n}\n\nTerminusPluginManager.prototype.loadPageCSS = function(css){\n\tcssfid = \"terminus_client_css\";\n\tvar cssdom = document.getElementById(cssfid);\n\tif(cssdom){\n\t\tcssdom.parentNode.removeChild(cssdom);\n\t}\n\tif(css){\n\t\tcssurl = \"css/\" + css + \".css\";\n\t\tFrameHelper.loadDynamicCSS(cssfid, cssurl);\n\t}\n}\n\nTerminusPluginManager.prototype.pluginLoadable = function(pid){\n\treturn (this.precluded.indexOf(pid) !== -1 || this.pluginLoadedOrLoading(pid));\n}\n\nTerminusPluginManager.prototype.pluginLoadedOrLoading = function(pid){\n\tif(this.loaded.indexOf(pid) != -1) return true;\n\tif(this.preloaded.indexOf(pid) != -1) return true;\n\tif(this.loading.indexOf(pid) != -1) return true;\n\treturn false;\n}\n\nTerminusPluginManager.prototype.disabled = function(pid, obj){\n\tif(this.precluded.indexOf(pid) != -1) return true;\n\tif(obj.requires){\n\t\tfor(var i = 0; i<obj.requires.length; i++){\n\t\t\tif(!this.pluginLoadedOrLoading(obj.requires[i])) return true;\n\t\t}\n\t}\n\treturn false;\n}\n\nTerminusPluginManager.prototype.getPluginDOM = function(plugid, obj, ui){\n\tvar a = document.createElement(\"a\");\n\tvar cl = document.createElement(\"span\");\n\ta.appendChild(cl);\n\tcl.setAttribute(\"class\", \"terminus-plugin-control\");\n\tvar cbox = document.createElement(\"input\");\n\tcbox.id = \"terminus-plugin-control-\" + plugid;\n\tcbox.type = \"checkbox\";\n\tif(this.preloaded.indexOf(plugid) != -1){\n\t\tcbox.checked = true;\n\t\tcbox.disabled = true;\n\t}\n\telse if(this.loaded.indexOf(plugid) != -1){\n\t\tcbox.checked = true;\n\t}\n\telse if(this.loading.indexOf(plugid) != -1){\n\t\tcbox.checked = true;\n\t}\n\telse if(this.disabled(plugid, obj)){\n\t\tcbox.disabled = true;\n\t}\n\tvar clab = document.createElement(\"label\");\n\tclab.setAttribute(\"class\", \"terminus-plugin-label terminus-pointer\");\n\tclab.setAttribute(\"for\", cbox.id);\n\tclab.appendChild(document.createTextNode(obj.label));\n\tcl.appendChild(clab);\n\tcl.appendChild(cbox);\n\tvar self = this;\n\tcbox.addEventListener(\"change\", function(){\n\t\tself.togglePlugin(plugid, ui);\n\t});\n\treturn a;\n}\n\nTerminusPluginManager.prototype.togglePlugin = function(plugid, ui){\n\tif(this.loaded.indexOf(plugid) == -1){\n\t\tvar then = function(){\n\t\t\tui.redraw();\n\t\t}\n\t\tthis.loadPlugin(plugid, then);\n\t}\n\telse {\n\t\tthis.unloadPlugin(plugid);\n\t}\n\tFrameHelper.removeChildren(ui.plugins);\n\tui.drawPlugins();\n}\n\nTerminusPluginManager.prototype.unloadPlugin = function(plugid){\n\tif(!this.plugins[plugid] || this.loaded.indexOf(plugid) == -1) {\n\t\tconsole.log(new Error(plugid + \" plugin unload request when it is not loaded\"));\n\t\treturn false;\n\t}\n\tvar pug = this.plugins[plugid];\n\tvar num = (pug.js) ? pug.js.length : 0;\n\tif(pug.plugin) num++;\n\tfor(var i=0; i< num; i++){\n\t\tvar cssfid = plugid + \"_js_\" + i;\n\t\tvar cssdom = document.getElementById(cssfid);\n\t\tif(cssdom){\n\t\t\tcssdom.parentNode.removeChild(cssdom);\n\t\t}\n\t}\n\tnum = (pug.css ? pug.css.length : 0);\n\tfor(var i=0; i< num; i++){\n\t\tvar cssfid = plugid + \"_css_\" + i;\n\t\tvar cssdom = document.getElementById(cssfid);\n\t\tif(cssdom){\n\t\t\tcssdom.parentNode.removeChild(cssdom);\n\t\t}\n\t}\n\tthis.loaded.splice(this.loaded.indexOf(plugid), 1);\n}\n\nTerminusPluginManager.prototype.getAsDOM = function(ui){\n\tvar dm = document.createElement(\"span\");\n\tdm.setAttribute(\"class\", \"terminus-plugin-manager\");\n\tvar clh = document.createElement(\"span\");\n\tclh.setAttribute(\"class\", \"terminus-plugin-control-header terminus-plugin-nav terminus-pointer\");\n\tclh.appendChild(document.createTextNode(\"Plugins\"));\n\tdm.appendChild(clh);\n\tvar a = document.createElement('a');\n\tthis.showPlugins(a, ui);\n\tclh.appendChild(a);\n\ta.style.display = 'none';\n\tclh.addEventListener('click', function(){\n\t\tif(a.style.display == 'none')\n\t\t\ta.style.display = 'block';\n\t\telse a.style.display = 'none';\n\t})\n\treturn dm;\n}\n\nTerminusPluginManager.prototype.showPlugins = function(a, ui){\n\ta.setAttribute('style', 'background-color: #111;');\n\tfor(var pid in this.plugins){\n\t\ta.appendChild(this.getPluginDOM(pid, this.plugins[pid], ui));\n\t}\n}\n\nmodule.exports=TerminusPluginManager\n","function WOQLResult(res, query ,options){\n\tthis.query = query;\n\tthis.bindings = ((res && res.bindings) ? res.bindings : []);\n}\n\nWOQLResult.prototype.count = function(){\n\treturn this.bindings.length;\n}\n\nWOQLResult.prototype.shorten = function(url){\n\treturn this.query.shorten(url);\n}\n\n\nWOQLResult.prototype.hasBindings = function(result){\n\tif(result) return (result.bindings && result.bindings.length);\n\telse return (this.bindings && this.bindings.length);\n}\n\n\nmodule.exports=WOQLResult\n","const FrameHelper = require('../FrameHelper');\nconst HTMLPropertyViewer = require('./PropertyViewer');\nconst ObjectViewer= require(\"./ObjectViewer\")\n\nlet RenderingMap = {\n\tregisteredDataViewers: {},\n\tregisteredDataEditors: {},\t\n\tregisteredPropertyViewers: {},\n\tregisteredPropertyEditors: {},\n\tregisteredObjectViewers: {},\n\tregisteredObjectEditors: {},\n\tgetValidDataViewerList: function(type, frametype){\n\t\tvar valids = ['HTMLStringViewer'];\n\t\tif(frametype && typeof this.registeredDataViewers[frametype] != \"undefined\"){\n\t\t\tvalids = valids.concat(this.registeredDataViewers[frametype]);\n\t\t}\n\t\tif(typeof this.registeredDataViewers[type] != \"undefined\"){\n\t\t\tvalids = valids.concat(this.registeredDataViewers[type]);\n\t\t}\n\t\treturn valids;\n\t},\n\tgetValidDataEditorList: function(type, frametype){\n\t\tvar valids = ['HTMLStringEditor'];\n\t\tif(frametype && typeof this.registeredDataEditors[frametype] != \"undefined\"){\n\t\t\tvar nftypes = this.registeredDataEditors[frametype];\n\t\t\tif(nftypes){\n\t\t\t\tfor(var i = 0; i<nftypes.length; i++){\n\t\t\t\t\tif(valids.indexOf(nftypes[i]) == -1) valids.push(nftypes[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif(typeof this.registeredDataEditors[type] != \"undefined\"){\n\t\t\tvalids = valids.concat(this.registeredDataEditors[type]);\n\t\t}\n\t\treturn valids;\n\t},\n\tgetValidPropertyViewerList: function(property, proptype, proprange, propdom){\n\t\tvar valids = ['HTMLPropertyViewer'];\n\t\tif(property && typeof this.registeredPropertyViewers[property] != \"undefined\"){\n\t\t\tvalids = valids.concat(this.registeredPropertyViewers[property]);\n\t\t}\n\t\tif(proprange && typeof this.registeredPropertyViewers[proprange] != \"undefined\"){\n\t\t\tvalids = valids.concat(this.registeredPropertyViewers[proprange]);\n\t\t}\n\t\tif(propdom && typeof this.registeredPropertyViewers[propdom] != \"undefined\"){\n\t\t\tvalids = valids.concat(this.registeredPropertyViewers[propdom]);\n\t\t}\n\t\tif(proptype && typeof this.registeredPropertyViewers[proptype] != \"undefined\"){\n\t\t\tvalids = valids.concat(this.registeredPropertyViewers[proptype]);\n\t\t}\n\t\treturn valids;\n\t},\n\tgetValidPropertyEditorList: function(property, proptype, proprange, propdom){\n\t\tvar valids = ['HTMLPropertyViewer'];\n\t\tif(property && typeof this.registeredPropertyEditors[property] != \"undefined\"){\n\t\t\tvalids = valids.concat(this.registeredPropertyEditors[property]);\n\t\t}\n\t\tif(proprange && typeof this.registeredPropertyEditors[proprange] != \"undefined\"){\n\t\t\tvalids = valids.concat(this.registeredPropertyEditors[proprange]);\n\t\t}\n\t\tif(propdom && typeof this.registeredPropertyEditors[propdom] != \"undefined\"){\n\t\t\tvalids = valids.concat(this.registeredPropertyEditors[propdom]);\n\t\t}\n\t\tif(proptype && typeof this.registeredPropertyEditors[proptype] != \"undefined\"){\n\t\t\tvalids = valids.concat(this.registeredPropertyEditors[proptype]);\n\t\t}\n\t\treturn valids;\n\t},\n\tgetViewer: function(type, options){\n\t\tvar vi = this.renderers[type];\n\t\toptions = (options ? options: {});\n\t\ttry {\n\t\t\tvar viewer = eval(\"new \" + type + \"(\" + JSON.stringify(options) + \")\");\t\n\t\t\treturn viewer;\n\t\t}\n\t\tcatch(e){\n\t\t\talert(e.toString());\n\t\t}\n\t},\n\tgetAvailablePropertyViewers: function(type, renderer) {\n\t\tvar viewers = [];\n\t\tvar nviewers = []\n\t\tvar opts = this.getValidPropertyViewerList(type);\n\t\tfor(var i = 0; i<opts.length; i++){\n\t\t\tif(nviewers.indexOf(opts[i]) == -1) {\n\t\t\t\tnviewers.push(opts[i]);\n\t\t\t}\n\t\t}\n\t\tfor(var i = 0; i<nviewers.length; i++){\n\t\t\tif(this.renderers[nviewers[i]]){\n\t\t\t\tvar sets = this.renderers[nviewers[i]];\n\t\t\t\tviewers.push({value: nviewers[i], label: sets.label});\n\t\t\t}\n\t\t}\n\t\treturn viewers;\n\t},\n\tgetAvailablePropertyEditors: function(type, renderer) {\n\t\tvar viewers = [];\n\t\tvar nviewers = []\n\t\tvar opts = this.getValidPropertyEditorList();\n\t\tfor(var i = 0; i<opts.length; i++){\n\t\t\tif(nviewers.indexOf(opts[i]) == -1) {\n\t\t\t\tnviewers.push(opts[i]);\n\t\t\t}\n\t\t}\n\t\tfor(var i = 0; i<nviewers.length; i++){\n\t\t\tif(this.renderers[nviewers[i]]){\n\t\t\t\tvar sets = this.renderers[nviewers[i]];\n\t\t\t\tviewers.push({value: nviewers[i], label: sets.label});\n\t\t\t}\n\t\t}\n\t\treturn viewers;\n\t\t\n\t},\n\tgetAvailableDataViewers: function(type, frametype){\n\t\tvar viewers = [];\n\t\tvar nviewers = []\n\t\tvar opts = this.getValidDataViewerList(type, frametype);\n\t\tfor(var i = 0; i<opts.length; i++){\n\t\t\tif(nviewers.indexOf(opts[i]) == -1) {\n\t\t\t\tnviewers.push(opts[i]);\n\t\t\t}\n\t\t}\n\t\tfor(var i = 0; i<nviewers.length; i++){\n\t\t\tif(this.renderers[nviewers[i]]){\n\t\t\t\tvar sets = this.renderers[nviewers[i]];\n\t\t\t\tviewers.push({value: nviewers[i], label: sets.label});\n\t\t\t}\n\t\t}\n\t\treturn viewers;\n\t},\n\tgetAvailableDataEditors: function(type, frametype){\n\t\tvar viewers = [];\n\t\tvar nviewers = []\n\t\tvar opts = this.getValidDataEditorList(type, frametype);\n\t\tfor(var i = 0; i<opts.length; i++){\n\t\t\tif(nviewers.indexOf(opts[i]) == -1) {\n\t\t\t\tnviewers.push(opts[i]);\n\t\t\t}\n\t\t}\n\t\tfor(var i = 0; i<nviewers.length; i++){\n\t\t\tif(this.renderers[nviewers[i]]){\n\t\t\t\tvar sets = this.renderers[nviewers[i]];\n\t\t\t\tviewers.push({value: nviewers[i], label: sets.label});\n\t\t\t}\n\t\t}\n\t\treturn viewers;\n\t},\n\tgetViewerForDataFrame: function(type, frametype){\n\t\tvar vals = this.getValidDataViewerList(type, frametype);\n\t\treturn vals[vals.length-1];\n\t},\n\tgetEditorForDataFrame: function(type, frametype){\n\t\tvar vals = this.getValidDataEditorList(type, frametype);\n\t\treturn vals[vals.length-1];\n\t},\n\tregisterViewerForTypes: function(viewer, label, types){\n\t\tfor(var i = 0; i < types.length; i++){\n\t\t\tif(typeof this.registeredDataViewers[types[i]] == \"undefined\"){\n\t\t\t\tthis.registeredDataViewers[types[i]] = [];\n\t\t\t}\n\t\t\tif(this.registeredDataViewers[types[i]].indexOf(viewer) == -1){\n\t\t\t\tthis.registeredDataViewers[types[i]].push(viewer);\n\t\t\t\tthis.renderers[viewer] = {label: label};\n\t\t\t}\n\t\t}\n\t},\n\tregisterEditorForTypes: function(viewer, label, types){\n\t\tfor(var i = 0; i < types.length; i++){\n\t\t\tif(typeof this.registeredDataEditors[types[i]] == \"undefined\"){\n\t\t\t\tthis.registeredDataEditors[types[i]] = [];\n\t\t\t}\n\t\t\tif(this.registeredDataEditors[types[i]].indexOf(viewer) == -1){\n\t\t\t\tthis.registeredDataEditors[types[i]].push(viewer);\n\t\t\t\tthis.renderers[viewer] = {label: label};\n\t\t\t}\t\t\t\n\t\t}\n\t},\n\tregisterEditorForFrameType: function(viewer, label, frametype){\n\t\tthis.renderers[viewer] = {label: label};\n\t\tif(typeof this.registeredDataEditors[frametype] == \"undefined\") this.registeredDataEditors[frametype] = [];\n\t\tif(this.registeredDataEditors[frametype].indexOf(viewer) == -1){\n\t\t\tthis.registeredDataEditors[frametype].push(viewer);\n\t\t}\n\t},\n\tregisterViewerForFrameType: function(viewer, label, frametype){\n\t\tthis.renderers[viewer] = {label: label};\n\t\tif(typeof this.registeredDataViewers[frametype] == \"undefined\") this.registeredDataViewers[frametype] = [];\n\t\tif(this.registeredDataViewers[frametype].indexOf(viewer) == -1){\n\t\t\tthis.registeredDataViewers[frametype].push(viewer);\n\t\t}\n\t},\n\tregisterViewerForProperties: function(viewer, label, properties){\n\t\tfor(var i = 0; i < properties.length; i++){\n\t\t\tif(typeof this.registeredPropertyViewers[properties[i]] == \"undefined\"){\n\t\t\t\tthis.registeredPropertyViewers[properties[i]] = [];\n\t\t\t}\n\t\t\tif(this.registeredPropertyViewers[properties[i]].indexOf(viewer) == -1){\n\t\t\t\tthis.registeredPropertyViewers[properties[i]].push(viewer);\n\t\t\t\tthis.renderers[viewer] = {label: label};\n\t\t\t}\n\t\t}\n\t},\n\tregisterEditorForProperties: function(viewer, label, properties){\n\t\tfor(var i = 0; i < properties.length; i++){\n\t\t\tif(typeof this.registeredPropertyEditors[properties[i]] == \"undefined\"){\n\t\t\t\tthis.registeredPropertyEditors[properties[i]] = [];\n\t\t\t}\n\t\t\tif(this.registeredPropertyEditors[properties[i]].indexOf(viewer) == -1){\n\t\t\t\tthis.registeredPropertyEditors[properties].push(viewer);\n\t\t\t\tthis.renderers[viewer] = {label: label};\n\t\t\t}\n\t\t}\n\t},\n\trenderers: {\n\t\tHTMLStringViewer: { label: \"String Viewer\"},\n\t\tHTMLStringEditor: { label: \"String Editor\"},\n\t\tHTMLPropertyViewer: { label: \"HTML Property Viewer\"}\n\t},\n\tpatternMatchesRenderer: function(pattern, renderer){\n\t\tif(typeof pattern == \"object\" && pattern.length){ //multiple patterns are ANDed\n\t\t\tfor(var i = 0 ; i<pattern.length; i++){\n\t\t\t\tvar fp = new FramePattern(pattern[i]);\n\t\t\t\tif(!fp.checkRenderer(renderer)) return false;\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\t\telse {\n\t\t\tvar fp = new FramePattern(pattern);\n\t\t\treturn fp.checkRenderer(renderer);\n\t\t}\n\t}\n}\n\n\nRenderingMap.getViewerForProperty = function(target, renderer){\n\treturn new HTMLPropertyViewer(renderer);\n}\n\nRenderingMap.getEditorForProperty = function(target, renderer){\n\treturn new HTMLPropertyViewer(renderer);\n}\n\n\nRenderingMap.getViewerForObject = function(target, renderer){\n\tif(target == \"json\"){\n\t\treturn new JSONObjectViewer(renderer);\n\t}\n\treturn new ObjectViewer.HTMLObjectViewer(renderer);\n}\n\nRenderingMap.getEditorForObject = RenderingMap.getViewerForObject;\n\nRenderingMap.getAvailableObjectViewers = function(renderer){\n\tvar entries = ['html', 'json'];\n\treturn entries;\n}\n\nRenderingMap.decorateRenderer = function(options, renderer){\n\tvar compiled_options = this.compileOptions(options, renderer);\n\tif(compiled_options && compiled_options.mode){\n\t\trenderer.mode = compiled_options.mode;\n\t}\n\telse {\n\t\tif(renderer.parent && renderer.parent.mode) renderer.mode = renderer.parent.mode;\n\t\telse renderer.mode = \"view\";\n\t}\n\tif(compiled_options && compiled_options.view){\n\t\trenderer.view = compiled_options.view;\n\t}\n\telse {\n\t\tif(renderer.parent && renderer.parent.view) renderer.view = renderer.parent.view;\n\t\telse renderer.view = \"full\";\n\t}\n\tif(compiled_options && compiled_options.facets){\n\t\trenderer.facets = compiled_options.facets;\n\t}\n\telse {\n\t\trenderer.facets = renderer.getDefaultFacets();\n\t}\n\tif(compiled_options && compiled_options.facet && typeof renderer.facets[compiled_options.facet] == \"object\"){\n\t\trenderer.facet = compiled_options.facet;\n\t}\t\n\telse {\n\t\tvar deffacet = renderer.getDefaultFacet();\n\t\tif(typeof renderer.facets[deffacet] == \"object\"){\n\t\t\trenderer.facet = deffacet;\n\t\t}\n\t\telse {\n\t\t\trenderer.facet = key(renderer.facets);\n\t\t}\n\t}\n\tif(compiled_options && compiled_options.hide_disabled_buttons){\n\t\trenderer.hide_disabled_buttons = compiled_options.hide_disabled_buttons;\n\t}\n\telse if(renderer.parent) renderer.hide_disabled_buttons = parent.hide_disabled_buttons;\n\telse renderer.hide_disabled_buttons = true;\n\t\n\tif(compiled_options && typeof compiled_options.features == \"object\"){\n\t\trenderer.features = compiled_options.features;\n\t}\n\telse {\n\t\trenderer.features = renderer.facets[renderer.facet].features;\n\t\t//renderer.features = renderer.getDefaultFeatures(renderer.facet);\n\t}\n\tif(compiled_options && typeof compiled_options.controls == \"object\"){\n\t\trenderer.controls = compiled_options.controls;\n\t}\n\telse {\n\t\trenderer.controls = renderer.facets[renderer.facet].controls;\n\t\t//renderer.controls = renderer.getDefaultControls();\n\t}\n\tif(compiled_options && typeof compiled_options.viewerType != \"undefined\"){\n\t\trenderer.viewerType = compiled_options.viewerType;\n\t\tif(compiled_options.viewerOptions)\n\t\t\trenderer.viewerOptions = compiled_options.viewerOptions;\n\t}\n\tif(compiled_options && typeof compiled_options.header != \"undefined\"){}\n\telse {\n\t\trenderer.header_viewer = new ObjectViewer.HTMLObjectHeaderViewer();\n\t}\n\tif(compiled_options && typeof compiled_options.filter != \"undefined\"){}\n\telse {}\n\tif(compiled_options && typeof compiled_options.sort != \"undefined\"){}\n\telse {}\n\treturn options;\n}\t\n\nRenderingMap.compileOptions = function(options, renderer){\n\tvar compiled_options = {};\n\tvar rules = [];\n\tfor(var key in options){\n\t\tif(key != \"rules\"){\n\t\t\tcompiled_options[key] = options[key];\n\t\t}\n\t}\n\tif(options.rules){\n\t\tfor(var i = 0; i<options.rules.length; i++){\n\t\t\tvar match = (!options.rules[i].pattern || this.patternMatchesRenderer(options.rules[i].pattern, renderer));\n\t\t\tif(match && options.rules[i].output){\n\t\t\t\tfor(var k in options.rules[i].output){\n\t\t\t\t\tcompiled_options[k] = options.rules[i].output[k];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\treturn compiled_options;\n}\n\nFramePattern = function(pattern){\n\tthis.renderer = (pattern.renderer ? pattern.renderer : false);\n\tthis.label = (pattern.value ? pattern.value : false);\n\tthis.frame_type = (pattern.frame_type ? pattern.frame_type : false);\n\tthis.subject = (pattern.subject ? pattern.subject : false);\n\tthis.subjectClass = (pattern.subjectClass ? pattern.subjectClass : false);\n\tthis.range = (pattern.range ? pattern.range : false);\n\tthis.property = (pattern.property ? pattern.property : false);\n\tthis.value = (pattern.value ? pattern.value : false);\n\tthis.parent = (pattern.parent ? new FramePattern(pattern.parent) : false);\n\tthis.children = [];\n\tif(pattern.children){\n\t\tfor(var i = 0 ; i < pattern.children.length ; i++){\n\t\t\tthis.children.push(new FramePattern(pattern.children[i]));\n\t\t}\n\t}\n\tthis.depth = (typeof pattern.depth != \"undefined\" ? pattern.depth : false);\n\tthis.index = (pattern.index ? pattern.index : false);\n\tthis.status = (pattern.status ? pattern.status : false);\n}\n\nFramePattern.prototype.checkRenderer = function(renderer){\n\tvar rtype = this.getRendererType(renderer);\n\tif(!rtype) return false;\n\tif(this.renderer && this.renderer != rtype) return false;\n\tif(this.illegalRuleType(rtype)) return false;\n\tif(this.frame_type && !this.checkFrameType(rtype, renderer)) return false;\n\tif(this.label && !this.checkLabel(rtype, renderer)) return false;\n\tif(this.subject && !this.checkSubject(rtype, renderer)) return false;\n\tif(this.subjectClass && !this.checkSubjectClass(rtype, renderer)) return false;\n\tif(this.property && !this.checkProperty(rtype, renderer)) return false;\n\tif(this.depth !== false && !this.checkDepth(rtype, renderer)) return false;\n\tif(this.range && !this.checkRange(rtype, renderer)) return false;\n\tif(this.value && !this.checkValue(rtype, renderer)) return false;\n\tif(this.parent && !this.checkParent(rtype, renderer)) return false;\n\tif(this.children && this.children.length && !this.checkChildren(rtype, renderer)) return false;\n\tif(this.index && !this.checkIndex(rtype, renderer)) return false;\n\tif(this.status && !this.checkStatus(rtype, renderer)) return false;\n\treturn true;\n} \n\nFramePattern.prototype.illegalRuleType = function(rtype){\n\tif(rtype == 'value' && (this.children.length || this.label)) return true;\n\tif(rtype == 'object' && this.range ) return true;\n\treturn false;\n}\n\n/* subject is an id or an array of ids, \n/* match is positive if the renderer's subject appears in the array or is the id\n */\nFramePattern.prototype.checkSubject = function(subject, renderer){\n\tif(typeof this.subject != \"object\" || !this.subject.length) this.subject = [this.subject];\n\tvar rsubj = renderer.subject();\n\tfor(var i = 0 ; i<this.subject.length; i++){\n\t\tif(this.IDsMatch(subject[i], rsubj)){\n\t\t\treturn true;\n\t\t}\n\t}\n\treturn false;\n}\n\n//at least one child must match all child rules\nFramePattern.prototype.checkChildren = function(rtype, renderer){\n\tfor(var i = 0 ; i<this.children.length; i++){\n\t\tvar found = false;\n\t\tif(rtype == \"object\"){\n\t\t\tfor(var prop in renderer.properties){\n\t\t\t\tif(this.children[i].checkRenderer(renderer.properties[prop])) {\n\t\t\t\t\tfound = true;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse if(rtype == \"property\"){\n\t\t\tfor(var j = 0; j <= renderer.values.length; j++){\n\t\t\t\tif(this.children[j].checkRenderer(renderer.values[j])) {\n\t\t\t\t\tfound = true;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif(!found) return false;\n\t}\n\treturn true;\n}\n\nFramePattern.prototype.checkStatus = function(rtype, renderer){\n\tif(typeof this.status != \"object\" || this.status.length == 0) this.status = [this.status];\n\tfor(var i = 0; i<this.status.length; i++){\n\t\tif(this.status[i] == \"updated\" && !renderer.isUpdated()) return false;\n\t\tif(this.status[i] == \"new\" && !renderer.isNew()) return false;\n\t\tif(this.status[i] == \"unchanged\" && renderer.isUpdated()) return false;\n\t}\n\treturn true;\n}\n\nFramePattern.prototype.checkDepth = function(rtype, renderer){\n\treturn this.numberMatch(this.depth, renderer.depth());\n}\n\nFramePattern.prototype.checkParent = function(rtype, renderer){\n\treturn this.parent.checkRenderer(renderer.parent);\n}\n\nFramePattern.prototype.checkIndex = function(rtype, renderer){\n\tif(rtype == 'value'){\n\t\treturn this.index == renderer.index;\n\t}\n\treturn false;\n}\n\nFramePattern.prototype.checkProperty  = function(rtype, renderer){\n\tif(typeof this.property != \"object\" || !this.property.length) this.property = [this.property];\n\tfor(var i = 0 ; i<this.property.length; i++){\n\t\tif(this.propertyIDsMatch(renderer.property(), this.property[i])){\n\t\t\treturn true;\n\t\t}\n\t}\n\treturn false;\n}\n\n//returns true if any of the values are found\nFramePattern.prototype.checkValue = function(rtype, renderer){\n\tif(typeof this.value != \"object\" || !this.value.length) this.value = [this.value];\n\tfor(var i = 0 ; i<this.value.length; i++){\n\t\tif(rtype == \"value\"){\n\t\t\tif(this.valuesMatch(renderer.value(), this.value[i])){\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\telse if(rtype == \"property\"){\n\t\t\tfor(var j = 0; j<= renderer.values.length;  j++){\n\t\t\t\tif(this.getRendererType(renderer.values[i]) == 'value' &&\n\t\t\t\t\t\tthis.valuesMatch(renderer.values[i].value(), this.value[i])){\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse if(rtype == \"object\"){\n\t\t\tfor(var prop in renderer.properties){\n\t\t\t\tif(this.checkValue(this.getRendererType(renderer.properties[prop]), renderer.properties[prop])){\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\treturn false;\n}\n\nFramePattern.prototype.checkRange  = function(rtype, renderer){\n\tif(typeof this.range != \"object\" || !this.range.length) this.range = [this.range];\n\tfor(var i = 0 ; i<this.range.length; i++){\n\t\tif(this.rangeIDsMatch(renderer.range(), this.range[i])){ \n\t\t\treturn true;\n\t\t}\n\t}\n\treturn false;\n}\n\nFramePattern.prototype.checkSubjectClass = function(rtype, renderer){\n\tif(typeof this.subjectClass != \"object\" || !this.subjectClass.length) this.subjectClass = [this.subjectClass];\n\tvar rcls = renderer.subjectClass();\n\tfor(var i = 0 ; i<this.subjectClass.length; i++){\n\t\tif(this.classIDsMatch(this.subjectClass[i], rcls)){\n\t\t\treturn true;\n\t\t}\n\t}\n\treturn false;\n}\n\nFramePattern.prototype.checkFrameType = function (rtype, renderer){\n\tif(rtype == \"object\") return this.frame_type == \"object\";\n\tif(rtype == \"value\") {\n\t\tif(renderer.frame){\n\t\t\treturn this.frame_type == renderer.frame.ftype();\n\t\t}\n\t\telse {\n\t\t\talert(JSON.stringify(renderer));\n\t\t\talert(\"No frame\");\n\t\t}\n\t}\n\tif(rtype == \"property\") return false;\n}\n\nFramePattern.prototype.checkLabel = function(rtype, renderer){\n\tif(typeof renderder.getLabel != \"function\"){\n\t\tconsole.log(new Error(\"Rule passed to check label with broken renderer object - no getLabel\"));\n\t\treturn false;\n\t}\n\treturn this.stringMatch(this.label, renderer.getLabel());\n}\n\nFramePattern.prototype.IDsMatch = function(ida, idb){\n\treturn FrameHelper.compareIDs(ida, idb);\n}\n\nFramePattern.prototype.classIDsMatch = function(ida, idb){\n\treturn this.IDsMatch(ida, idb);\n}\nFramePattern.prototype.propertyIDsMatch = function(ida, idb){\n\tvar match = this.IDsMatch(ida, idb);\n\treturn match;\n}\nFramePattern.prototype.rangeIDsMatch = function(ida, idb){\n\treturn this.IDsMatch(ida, idb);\n}\nFramePattern.prototype.valuesMatch = function(vala, valb){\n\treturn vala == valb;\n}\nFramePattern.prototype.numberMatch = function(vala, valb){\n\tif(typeof vala == \"string\"){\n\t\ttry {\n\t\t\treturn eval(valb + vala);\n\t\t}\n\t\tcatch(e){\n\t\t\treturn false;\n\t\t}\n\t}\n\treturn vala === valb;\n}\n\nFramePattern.prototype.stringMatch = function(vala, valb){\n\tvar pat = new RegExp(vala);\n\treturn pat.test(valb);\n}\n\nFramePattern.prototype.getRendererType = function(renderer){\n\tif(renderer.constructor.name == \"ValueRenderer\") return \"value\";\n\tif(renderer.constructor.name == \"PropertyRenderer\") return \"property\";\n\tif(renderer.constructor.name == \"ObjectRenderer\") return \"object\";\n\tconsole.log(new Error(\"frame configuration passed non-renderer type: \" + renderer.constructor.name));\n\treturn false;\n}\n\nmodule.exports=RenderingMap\n","/*\n * Utility class which runs a query against the schema and presents the returned classes as a drop-down / class filter list\n */\nconst FrameHelper = require('../FrameHelper');\nconst WOQLQuery = require('../query/WOQLQuery');\n\nTerminusClassChooser = function(ui, filter, chosen){\n\tthis.ui = ui;\n\tthis.choice = (chosen ? chosen : false);\n\tthis.filter = filter;\n\tthis.show_single = true;\n}\n\nTerminusClassChooser.prototype.setRoot = function(root){\n\tthis.root = root;\n}\n\nTerminusClassChooser.prototype.setFilter = function(filter){\n\tthis.filter = filter;\n}\n\nTerminusClassChooser.prototype.change = function(cls){\n\talert(\"Need to specify class chooser function (\" + cls + \")\");\n}\n\nTerminusClassChooser.prototype.getAsDOM = function(style){\n\tvar ccdom = document.createElement(\"span\");\n\tccdom.setAttribute(\"class\", \"terminus-class-chooser\");\n\tvar ccsel = document.createElement(\"select\");\n\tccsel.setAttribute(\"class\", style + \" terminus-type-select\");\n\t// ccsel.setAttribute(\"class\", \"terminus-class-select terminus-type-select terminus-query-select\");\n\tvar self = this;\n\tccsel.addEventListener(\"change\", function(){\n\t\tif(this.value != this.choice){\n\t\t\tthis.choice = this.value;\n\t\t\tself.change(this.value);\n\t\t}\n\t});\n\tccdom.appendChild(ccsel);\n\tvar wq = new WOQLQuery(this.ui.client);\n\tvar woql = wq.getClassListMetaDataQuery(this.filter);\n\tvar self = this;\n\twq.execute(woql)\n\t.then(function(response){\n\t\tvar opts = self.getResultsAsOptions(response);\n\t\tif(opts){\n\t\t\tfor(var i = 0; i<opts.length; i++){\n\t\t\t\tccsel.appendChild(opts[i]);\n\t\t\t}\n\t\t\tself.options = opts;\n\t\t}\n\t\telse {\n\t\t\tccdom.removeChild(ccsel);\n\t\t}\n\t});\n\treturn ccdom;\n}\n\nTerminusClassChooser.prototype.getResultsAsOptions = function(clist){\n\tvar choices = [];\n\tif(clist.bindings){\n\t\tif(this.show_single == false && clist.bindings.length < 2) return false;\n\t\tif(this.empty_choice){\n\t\t\tvar opt1 = document.createElement(\"option\");\n\t\t\topt1.setAttribute(\"class\", \"terminus-class-choice terminus-empty-choice\");\n\t\t\topt1.value = \"\";\n\t\t\topt1.appendChild(document.createTextNode(this.empty_choice));\n\t\t\tchoices.push(opt1);\n\t\t}\n\t\tvar added = [];\n\t\tfor(var i = 0; i<clist.bindings.length; i++){\n\t\t\tif(clist.bindings[i].Class && added.indexOf(clist.bindings[i].Class) == -1){\n\t\t\t\tadded.push(clist.bindings[i].Class);\n\t\t\t\tvar opt = document.createElement(\"option\");\n\t\t\t\topt.setAttribute(\"class\", \"terminus-class-choice\");\n\t\t\t\topt.value = clist.bindings[i].Class;\n\t\t\t\tif(opt.value == this.choice){\n\t\t\t\t\topt.selected = true;\n\t\t\t\t}\n\t\t\t\tvar lab = clist.bindings[i].Label;\n\t\t\t\tif(!lab || lab == \"unknown\"){\n\t\t\t\t\tlab = FrameHelper.labelFromURL(clist.bindings[i].Class);\n\t\t\t\t}\n\t\t\t\tif(lab[\"@value\"]) lab = lab[\"@value\"];\n\t\t\t\topt.appendChild(document.createTextNode(lab));\n\t\t\t\tchoices.push(opt);\n\t\t\t}\n\t\t}\n\t}\n\treturn choices;\n}\n\nmodule.exports=TerminusClassChooser\n","const WOQLResult = require('./WOQLResult');\nconst TerminusPluginManager = require('../plugins/TerminusPlugin');\nconst Datatables = require('../plugins/datatables.terminus');\n\nfunction WOQLResultsViewer(ui, wresult, options, settings){\n\tthis.ui = ui;\n\tthis.result = wresult;\n\tthis.options = options;\n\t//this.wqlRes = new WOQLResult();\n\tthis.pman = new TerminusPluginManager();\n\tthis.settings = settings;\n}\n\nWOQLResultsViewer.prototype.showTable = function(){\n\tif(this.options && typeof this.options.show_table != \"undefined\") return this.options.show_table;\n\treturn true;\n}\n\nWOQLResultsViewer.prototype.orderColumns = function(sample){\n\tvar ordered = [];\n\tfor(var h in sample){\n\t\tif(ordered.indexOf(h) == -1){\n\t\t\tordered.unshift(h);\n\t\t}\n\t}\n\treturn ordered;\n}\n\nWOQLResultsViewer.prototype.getAsDOM = function(resultDOM){\n\tvar rs = document.createElement('div');\n\tvar rh = document.createElement('div');\n\trh.setAttribute(\"class\", \"terminus-margin-top-bottom terminus-module-head\");\n\trh.appendChild(document.createTextNode(\"Results\"));\n\trs.appendChild(rh);\n\tif(this.result && this.result.hasBindings() && this.showTable()){\n\t\tthis.getTableDOM(this.result.bindings, rs);\n\t\treturn rs;\n\t}\n\telse {\n\t\tconsole.log(\"no bindings for query\");\n\t}\n}\n\nWOQLResultsViewer.prototype.getTableDOM = function(bindings, resultDOM){\n\tvar tab = this.getTable(bindings);\n\tif(this.pman.pluginAvailable(\"datatables\")){\n    \tvar dt = new Datatables();\n\t\tvar tab = dt.draw(true, tab, this.settings, this.ui, resultDOM);\n\t\tresultDOM.setAttribute('class', 'terminus-expandable');\n\t\treturn tab;\n    }\n\telse resultDOM.appendChild(tab);\n}\n\nWOQLResultsViewer.prototype.getTable = function(bindings){\n\tvar tab = document.createElement(\"table\");\n\ttab.setAttribute(\"class\", \"terminus-query-results-table\");\n\tvar thead = document.createElement(\"thead\");\n\tvar thr = document.createElement(\"tr\");\n\tvar ordered_headings = this.orderColumns(bindings[0]);\n\tfor(var i = 0; i<ordered_headings.length; i++){\n\t\tvar th = document.createElement(\"th\");\n\t\tth.setAttribute('class', 'terminus-table-header-full-css');\n\t\tth.appendChild(document.createTextNode(ordered_headings[i]));\n\t\tthr.appendChild(th);\n\t}\n\tthead.appendChild(thr);\n\ttab.appendChild(thead);\n\tvar tbody = document.createElement(\"tbody\");\n\tfor(var i = 0; i<bindings.length; i++){\n\t\tvar tr = document.createElement(\"tr\");\n\t\tfor(var j = 0; j<ordered_headings.length; j++){\n\t\t\tvar td = document.createElement(\"td\");\n\t\t\tif(typeof bindings[i][ordered_headings[j]] == \"object\"){\n\t\t\t\tvar lab = (bindings[i][ordered_headings[j]]['@value'] ? bindings[i][ordered_headings[j]]['@value'] : \"Object?\");\n\t\t\t\ttd.appendChild(document.createTextNode(lab));\n\t\t\t}\n\t\t\telse if(typeof bindings[i][ordered_headings[j]] == \"string\") {\n\t\t\t\tvar lab = this.result.shorten(bindings[i][ordered_headings[j]]);\n\t\t\t\tif(lab == \"unknown\") lab = \"\";\n\t\t\t\ttd.appendChild(document.createTextNode(lab));\n\t\t\t}\n\t\t\ttr.appendChild(td);\n\t\t}\n\t\ttbody.appendChild(tr);\n\t}\n\ttab.appendChild(tbody);\n\treturn tab;\n}\n\n\nmodule.exports=WOQLResultsViewer\n","const FrameHelper = require('../FrameHelper');\nconst ObjectFrame = require('../ObjectFrame');\nconst WOQLQuery = require('../query/WOQLQuery');\n//const FrameConfig = require('./FrameConfig');\nconst ObjectRenderer = require('./ObjectRenderer');\n\nfunction TerminusDocumentViewer(ui, action, options){\n\tthis.ui = ui;\n\tthis.server = this.ui.server();\n\tthis.db = this.ui.db();\n\tthis.init();\n\tthis.mode = (options && options.mode ? options.mode : \"view\");\n\tthis.editor = (options && options.editor ? options.editor : false);\n\tthis.load_schema = (options && options.load_schema ? options.load_schema : true);\n\tthis.config_options = this.getBuiltInViewerOptions();\n\tthis.options = (options ? options : this.config_options[action]);\n\tthis.action = action;\n\tthis.document = false;\n}\n\nTerminusDocumentViewer.prototype.init = function(){\n\tvar wq = new WOQLQuery(this.ui.client, this.options);\n\tvar woql = wq.getClassMetaDataQuery();\n\tvar self = this;\n\tself.classmeta = {};\n\tself.instancemeta = {};\n\twq.execute(woql).then(function(wresult){\n\t\tif(wresult && wresult.hasBindings()){\n\t\t\tfor(var i = 0; i<wresult.bindings.length; i++){\n\t\t\t\tvar cls = wresult.bindings[i].Class;\n\t\t\t\tif(cls && typeof self.classmeta[cls] == \"undefined\"){\n\t\t\t\t\tself.classmeta[cls] = wresult.bindings[i];\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.refreshPage();\n\t\t}\n\t})\n\t.catch(function(e){\n\t\tconsole.log(e);\n\t});\n}\n\nTerminusDocumentViewer.prototype.getInstanceMeta = function(elid){\n\tvar self = this;\n\tif(self.instancemeta && typeof self.instancemeta[elid] != \"undefined\") return self.instancemeta[elid] ;\n\tvar wq = new WOQLQuery(this.ui.client, this.options);\n\tvar woql = wq.getInstanceMeta(elid);\t\n\treturn wq.execute(woql).then(function(wresult){\n\t\tif(wresult && wresult.hasBindings()){\n\t\t\tvar res = wresult.bindings[0];\n\t\t\treturn res;\n\t\t}\n\t\treturn false;\n\t})\n\t.catch(function(e){\n\t\tconsole.log(e);\n\t});\n}\n\nTerminusDocumentViewer.prototype.getClassMeta = function(cls){\n\tif(typeof this.classmeta[cls]){\n\t\treturn this.classmeta[cls];\n\t}\n\treturn false;\n}\n\nTerminusDocumentViewer.prototype.loadCreateDocument = function(url){\n\tif(url){\n\t\tthis.ui.showBusy(\"Fetching frame for document class \" + url);\n\t\tvar self = this;\n\t\tthis.mode = \"edit\";\n\t\tthis.page_config = \"create\";\n\t\tif(url.indexOf(\"/\") == -1 && url.indexOf(\":\") == -1) {\n\t\t\turl = \"schema:\" + url;\n\t\t}\n\t\treturn this.loadDocumentSchema(url)\n\t\t.then(function(response){\n\t\t\tself.ui.clearBusy();\n\t\t\tself.setLabel();\n\t\t})\n\t\t.catch(function(error) {\n\t\t\tconsole.error(error);\n\t\t\tself.ui.clearBusy();\n\t\t\tself.ui.showError(error);\n\t\t});\n\t}\n}\n\nTerminusDocumentViewer.prototype.loadDocument = function(url, cls){\n\tif(!url) return false;\n\tvar self = this;\n\tif(url.substring(0,4) == \"doc:\"){\n\t\turl = url.substring(4);\n\t}\n\tthis.page_config = \"view\";\n\turl = url.replace(\"/candidate\", \"/platform/document\");\n\tthis.ui.showBusy(\"Loading Document from \" + url);\n\treturn this.ui.client.getDocument(url, {\"terminus:encoding\": \"terminus:frame\"})\n\t.then(function(response){\n\t\tself.ui.clearBusy();\n\t\tself.loadDataFrames(response);\n\t\tself.setLabel();\n\t\tself.refreshPage();\n\t\tif(self.load_schema){\n\t\t\treturn self.loadDocumentSchema(self.document.cls).then(function(){ self.refreshPage()}).catch(function(e){console.error(e)});\t\t\t\n\t\t}\n\t\treturn response;\n\t})\n\t.catch(function(error) {\n\t\tconsole.error(error);\n\t\tself.ui.clearBusy();\n\t\tself.ui.showError(error);\n\t});\n}\n\nTerminusDocumentViewer.prototype.loadDocumentSchema = function(cls){\n\tvar self = this;\n\treturn this.ui.client.getClassFrame(false, cls)\n\t.then(function(response){\n\t\tself.loadSchemaFrames(response, cls);\n\t\tself.refreshPage();\t\t\n\t});\n}\n\nTerminusDocumentViewer.prototype.deleteDocument = function(URL){\n\tthis.document = false;\n\tvar self = this;\n\tthis.ui.showBusy(\"Deleting Document \" + URL);\n\treturn this.ui.client.deleteDocument(URL)\n\t.then(function(response){\n\t\tself.ui.clearBusy();\n\t}).catch(function(error){\n\t\tself.ui.clearBusy();\n\t\tself.ui.showError(error);\n\t});\t\n}\n\nTerminusDocumentViewer.prototype.createDocument = function(id){\n\tvar self = this;\n\tvar extr = this.renderer.extract();\n\tvar opts = { \"terminus:encoding\": \"jsonld\" };\n\tthis.ui.showBusy(\"Creating document\");\n\treturn this.ui.client.createDocument(id, extr, opts)\n\t.then(function(response){\n\t\tself.ui.clearBusy();\n\t\tself.ui.showDocument(id);\n\t}).catch(function(error){\n\t\tself.ui.clearBusy();\n\t\tself.ui.showError(error);\n\t});\t\n}\n\nTerminusDocumentViewer.prototype.updateDocument = function(){\n\tvar durl = this.document.subjid;\n\tvar extr = this.renderer.extract();\n\tvar self = this;\n\tvar opts = { \"terminus:encoding\": \"jsonld\" };\n\tthis.ui.showBusy(\"Updating document \" + durl);\n\treturn this.ui.client.updateDocument(durl, extr, opts)\n\t.then(function(response){\n\t\tself.ui.clearBusy();\n\t\tself.ui.showDocument(durl);\n\t}).catch(function(error){\n\t\tself.ui.clearBusy();\n\t\tself.ui.showError(error);\n\t});\t\n}\n\nTerminusDocumentViewer.prototype.loadDataFrames = function(dataframes, cls){\n\tif(!cls){\n\t\tif(this.document) cls = this.document.cls;\n\t\telse {\n\t\t\tif(dataframes && dataframes.length && dataframes[0] && dataframes[0].domain){\n\t\t\t\tcls = dataframes[0].domain;\n\t\t\t}\n\t\t}\t\t\n\t}\n\tif(cls){\n\t\tif(!this.document){\n\t\t\tthis.document = new ObjectFrame(cls, dataframes);\n\t\t}\n\t\telse {\n\t\t\tthis.document.loadDataFrames(dataframes);\n\t\t}\n\t}\n\telse {\n\t\talert(\"Missing Class\" + \" \" + \"Failed to add dataframes due to missing class\");\n\t}\n}\n\n\nTerminusDocumentViewer.prototype.loadSchemaFrames = function(classframes, cls){\n\tif(!cls){\n\t\tif(classframes && classframes.length && classframes[0] && classframes[0].domain){\n\t\t\tcls = classframes[0].domain;\n\t\t}\n\t}\n\tif(cls){\n\t\tif(!this.document){\n\t\t\tthis.document = new ObjectFrame(cls);\n\t\t}\n\t\tif(classframes){\n\t\t\tthis.document.loadClassFrames(classframes);\n\t\t\tif(!this.document.subjid){\n\t\t\t\tthis.document.newDoc = true;\n\t\t\t\tthis.document.fillFromSchema(\"_:\");\n\t\t\t}\n\t\t}\n\t}\n\telse {\n\t\tthis.error(\"Missing Class\", \"Failed to add class frames due to missing class\");\n\t}\n}\n\nTerminusDocumentViewer.prototype.render = function(){\n\tif(!this.renderer && this.document){\n\t\tif(this.page_config){\n\t\t\tthis.options = this.getOptionsFromPageConfig(this.page_config);\t\n\t\t}\n\t\tthis.renderer = new ObjectRenderer(this.document, false, this.options);\n\t\tthis.renderer.mode = this.mode;\n\t\tthis.renderer.controller = this;\n\t}\n\tif(this.renderer){\n\t\treturn this.renderer.render();\n\t}\n}\n\nTerminusDocumentViewer.prototype.getBuiltInViewerOptions = function(){\n\treturn FrameConfig;\n}\n\nTerminusDocumentViewer.prototype.getOptionsFromPageConfig = function(pageconf){\n\tif(typeof this.config_options[pageconf] == \"object\") {\n\t\treturn this.config_options[pageconf];\n\t}\n\treturn this.options;\n}\n\n\nTerminusDocumentViewer.prototype.getClient = function(){\n\treturn this.ui.client;\n}\n\nTerminusDocumentViewer.prototype.extract = function(options){\n\treturn this.renderer.extract();\n}\n\nTerminusDocumentViewer.prototype.getLabel = function(){\n\tvar lab = (this.cls ? this.cls : false);\n\tif(!lab) lab = (this.docid ? this.docid : \"Void\");\n\treturn lab;\n}\n\nTerminusDocumentViewer.prototype.setLabel = function(){\n\tif(this.document && this.labdom){\n\t\tFrameHelper.removeChildren(this.labdom);\n\t\tvar dfs = this.document.getDataFrames(FrameHelper.getStdURL(\"rdfs\", \"label\"));\n\t\tfor(var i = 0; i< dfs.length; i++){\n\t\t\tvar lab = dfs[i].get();\n\t\t\tif(lab) {\n\t\t\t\tthis.labdom.appendChild(document.createTextNode(lab));\n\t\t\t} \n\t\t}\n\t}\n}\n\nTerminusDocumentViewer.prototype.refreshPage = function(){\n\tif(this.pagedom){\n\t\tFrameHelper.removeChildren(this.pagedom); \n\t\tvar rends = this.render();\n\t\tif(rends){\n\t\t\tthis.pagedom.appendChild(rends);\n\t\t}\n\t}\n}\n\nTerminusDocumentViewer.prototype.getAsDOM = function(){\n\tvar holder = document.createElement(\"div\");\n\tholder.setAttribute(\"class\", \"terminus-document-holder\");\n\tthis.controldom = document.createElement(\"div\");\n\tthis.controldom.setAttribute(\"class\", \"terminus-document-controller\");\n\tthis.controldom.appendChild(this.getDocumentPageControls());\n\tthis.pagedom = document.createElement(\"div\");\n\tthis.pagedom.setAttribute(\"class\", \"terminus-document-page\");\n\tvar rends = this.render();\n\tif(rends){\n\t\tthis.pagedom.appendChild(rends);\n\t}\n\tholder.appendChild(this.controldom);\n\tholder.appendChild(this.pagedom);\n\treturn holder;\n}\n\nTerminusDocumentViewer.prototype.getDocumentPageControls = function(){\n\tvar dpc = document.createElement(\"select\");\n\tdpc.setAttribute(\"class\", \"terminus-form-select terminus-document-config\");\n\tfor(var i in this.config_options){\n\t\tvar opt = document.createElement(\"option\");\n\t\topt.value = i;\n\t\tif(this.page_config == i){\n\t\t\topt.selected = true;\n\t\t}\n\t\topt.appendChild(document.createTextNode(this.config_options[i].label));\n\t\tdpc.appendChild(opt);\n\t}\n\tvar self = this;\n\tdpc.addEventListener(\"change\", function(){\n\t\tself.page_config = this.value;\n\t\tself.renderer = false;\n\t\tself.refreshPage();\n\t})\n\treturn dpc;\n}\n\nmodule.exports=TerminusDocumentViewer\n\n","/**\n * object renderer binds to object frame - provides filters, sorts and manipulations of underlying object frame\n * and coordinates viewer to draw updates\n\n * Object Renderer - provides sorting / filtering / state management of objects\n * @param obj ObjectFrame object - contains underlying data and frame structure\n * @param parent PropertyRenderer - property that owns this object (if any)\n * @param options options json\n * @returns\n */\nconst PropertyRenderer = require('./PropertyRenderer');\nconst RenderingMap = require('./RenderingMap');\n\nfunction ObjectRenderer(obj, parent, options){\n\tthis.objframe = obj;\n\tthis.parent = parent;\n\tthis.options = this.setOptions(options);\n\tthis.properties = {};\n\tthis.originalProperties = false;\n\tthis.newProperties = [];\n}\n\n//options has to include mode, viewer, facet, controls, features, hide_disabled_controls\n\nObjectRenderer.prototype.setOptions = function(options){\n\t//var rendconf = new RendererConfigurationMatcher(options);\n\treturn RenderingMap.decorateRenderer(options, this);\n\t/*rendconf.setObjectRenderingConfiguration(this);\n\toptions = (options ? options : {});\n\tif(options.mode) this.mode = options.mode;\n\telse {\n\t\tthis.mode = (this.parent && this.parent.mode ? this.parent.mode : \"view\");\n\t\toptions.mode = this.mode;\n\t}\n\tif(options.view) this.view = options.view;\n\telse {\n\t\tthis.view = (this.parent && this.parent.view ? this.parent.view : \"full\");\n\t\toptions.view = this.view;\n\t}\n\tif(options.facet) this.facet = options.facet;\n\telse this.facet = this.getDefaultFacet();\n\tthis.hide_disabled_controls = (options && options.hide_disabled_controls ? options.hide_disabled_controls : true);\n\tthis.facets = {\n\t\tlabel: \t[\"facet\", \"status\", \"label\"],\n\t\tsummary: [\"facet\", \"satus\", \"label\", \"type\", \"summary\", \"status\", \"facet\"],\n\t\tline: [\"facet\", \"label\", \"comment\", \"id\", \"type\", \"body\", \"status\", \"facet\"],\n\t\tpage: [\"facet\", \"label\", \"comment\", \"id\", \"control\", \"type\", \"body\", \"status\", \"facet\", \"view\", \"viewer\"].concat(this.controls)\n\t}\n\tif(options && options.facets){\n\t\tfor(var facet in options.facets){\n\t\t\tthis.facets[facet] = options.facets[facet];\n\t\t}\n\t}\n\t//this.loadConfigurationFromOptions(options);\n\tif(options && options.features){\n\t\tthis.features = options.features;\n\t}\n\telse {\n\t\tthis.features = [\"body\", \"id\", \"type\", \"summary\", \"status\", \"label\", \"facet\", \"control\", \"viewer\", \"view\", \"comment\"];\n\t}\n\tif(options && options.controls){\n\t\tthis.controls = options.controls;\n\t}\n\telse {\n\t\tthis.controls = [\"delete\", \"clone\", \"add\", \"reset\", \"cancel\", \"update\", \"mode\", \"show\", \"hide\"];\n\t}\n\treturn options;*/\n}\n\nObjectRenderer.prototype.getOptionsForProperty = function(prop){\n\treturn this.options;\n}\n\nObjectRenderer.prototype.render = function(viewer){\n\tthis.buildPropertyRenderers();\n\tthis.viewer = (viewer ? viewer: this.getViewerForObject());\n\tfor(var prop in this.properties){\n\t\tvar renderedprop = this.properties[prop].render();\n\t\tif(renderedprop && this.showFeature(\"body\")) this.viewer.addRenderedProperty(prop, renderedprop);\n\t}\n\treturn this.viewer.render(this.view);\n}\n\nObjectRenderer.prototype.buildPropertyRenderers = function(){\n\tvar props = this.getPropertiesToRender();\n\tif(this.originalProperties === false) this.originalProperties = props;\n\tvar renders = {};\n\tfor(var j = 0; j<props.length; j++){\n\t\tif(typeof this.properties[props[j]] == \"undefined\"){\n\t\t\trenders[props[j]] = new PropertyRenderer(props[j], this, this.getOptionsForProperty(props[j]));\n\t\t}\n\t\telse {\n\t\t\trenders[props[j]] = this.properties[props[j]];\n\t\t}\n\t\tif(this.newProperties.indexOf(props[j]) != -1) {\n\t\t\trenders[props[j]].setNew(); \n\t\t\trenders[props[j]].mode = \"edit\"; \n\t\t}\n\t}\n\tthis.properties = renders;\n}\n\nObjectRenderer.prototype.subject = function(){\n\tif(this.objframe) return this.objframe.subjid;\n\treturn false;\n}\n\nObjectRenderer.prototype.subjectClass = function(){\n\tif(this.objframe) return this.objframe.cls;\n\treturn false;\n}\n\nObjectRenderer.prototype.getAvailableViewers = function(){\n\t//if(this.mode == \"view\"){\n\t//\treturn RenderingMap.getAvailableObjectViewers(this);\t\t\n\t//}\n\t//return RenderingMap.getAvailableObjectEditors(this);\t\t\t\t\n\treturn [\"html\", \"json\"];\n}\n\nObjectRenderer.prototype.depth = function(){\n\tif(this.parent) return (this.parent.depth() + 1);\n\treturn 0;\n}\n\n\nObjectRenderer.prototype.property = function(){\n\tif(this.parent) return this.parent.property();\n\treturn false;\n}\n\nObjectRenderer.prototype.parentObject = function(){\n\tif(this.parent && this.parent.parent && this.parent.parent.objframe){\n\t\treturn this.parent.parent.objframe;\n\t}\n\treturn false;\n}\n\nObjectRenderer.prototype.root = function(){\n\tif(this.parent) return false;\n\treturn true;\n}\n\nObjectRenderer.prototype.load = function(link){\n\tvar self = this;\n\tif(this.controller){\n\t\tthis.controller.ui.showDocument(link);\n\t}\n\telse if(this.parent) {\n\t\tthis.parent.load(link);\n\t}\n}\n\nObjectRenderer.prototype.copy = function(nkid){\n\tnkid = (nkid ? nkid : this.objframe);\n\tvar other = new ObjectRenderer(nkid, this.parent, this.options);\n\treturn other;\n}\n\nObjectRenderer.prototype.clone = function(){\n\tif(this.root()){\n\t\tthis.objframe = this.objframe.clone(\"_:\");\n\t\tthis.objframe.newDoc = true;\n\t\tthis.setMode(\"edit\");\n\t}\n\telse {\n\t\tvar nkid = this.objframe.clone(FrameHelper.genBNID());\n\t\tvar parentobj = this.parentObject();\n\t\tvar prop = this.property();\n\t\tif(parentobj && prop){\n\t\t\tif(typeof parentobj.children[prop] == \"undefined\"){\n\t\t\t\tparentobj.children[prop] = [];\n\t\t\t}\n\t\t\tparentobj.children[prop].push(nkid);\n\t\t\tvar newrend = this.copy(nkid);\n\t\t\tthis.parent.values.push(newrend);\n\t\t}\n\t\tthis.parent.redraw();\n\t}\n}\n\nObjectRenderer.prototype.cancel = function(){\n\tthis.reset();\n\tthis.setMode(\"view\");\n}\n\nObjectRenderer.prototype.save = function(){\n\tif(this.controller){\n\t\tif(this.isNewDocument()){\n\t\t\tvar demandid = this.inputID();\n\t\t\tif(demandid == \"_:\") demandid = \"\";\n\t\t\tthis.controller.createDocument(demandid);\n\t\t}\n\t\telse {\n\t\t\tthis.controller.updateDocument();\n\t\t}\n\t}\n\telse if(this.parent) {\n\t\tthis.parent.save();\n\t}\n}\n\nObjectRenderer.prototype.delete = function(){\n\tvar dval = this.subject();\n\tif(this.controller && this.root()){\n\t\tif(!this.isNewDocument()){\n\t\t\tthis.controller.deleteDocument(dval);\n\t\t}\n\t\tthis.nukeViewer();\n\t}\n\telse {\n\t\tif(this.parent){\n\t\t\tthis.parent.deletePropertyValue(dval);\t\t\n\t\t\tthis.parent.redraw();\n\t\t}\n\t}\n}\n\nObjectRenderer.prototype.reset = function(){\n\tthis.objframe.reset();\n\tvar nprops = {};\n\tfor(var i = 0; i<this.originalProperties.length; i++){\n\t\tvar prop = this.originalProperties[i];\n\t\tif(typeof this.properties[prop] == \"object\"){\n\t\t\tthis.properties[prop].reset();\n\t\t\tnprops[prop] = this.properties[prop];\n\t\t}\n\t}\n\tthis.properties = nprops;\n\tthis.redraw();\n}\n\nObjectRenderer.prototype.deleteProperty = function(prop){\n\tthis.objframe.removeProperty(prop);\n\tdelete(this.properties[prop]);\n\tthis.updated();\n}\n\nObjectRenderer.prototype.addProperty = function(prop){\n\tthis.objframe.addProperty(prop);\n\tthis.updated();\n\tthis.redraw();\n}\n\nObjectRenderer.prototype.addNewProperty = function(prop){\n\tthis.objframe.addProperty(prop);\n\tthis.updated();\n\tthis.newProperties.push(prop);\n\tthis.redraw();\n\tthis.goToProperty(prop);\n}\n\nObjectRenderer.prototype.addPropertyClass = function(prop, cls){\n\tthis.objframe.addProperty(prop, cls);\n\tthis.updated();\n}\n\nObjectRenderer.prototype.changeClass = function(cls){\n\tif(this.parent){\n\t\tthis.parent.addClass(cls);\t\t\n\t\tthis.parent.deletePropertyValue(this.subject());\t\t\n\t}\n}\n\nObjectRenderer.prototype.getClassMeta = function(cls){\n\tvar ctl = this.getController();\n\tif(ctl && ctl.classmeta && ctl.classmeta[cls]){\n\t\treturn ctl.classmeta[cls];\n\t}\n\treturn false;\n}\n\nObjectRenderer.prototype.getController = function(){\n\tif(this.controller){\n\t\treturn this.controller;\n\t}\n\tif(this.parent && this.parent.parent){\n\t\treturn this.parent.parent.getController();\n\t}\n\treturn false;\n}\n\nObjectRenderer.prototype.getClient = function(){\n\tif(this.controller){\n\t\treturn this.controller.getClient();\n\t}\n\telse {\n\t\tif(this.parent && this.parent.parent){\n\t\t\treturn(this.parent.parent.getClient())\n\t\t}\n\t}\n\treturn false;\n}\n\nObjectRenderer.prototype.inputID = function(){\n\tif(this.idDOM){\n\t\treturn this.idDOM.value;\n\t}\n\treturn false;\n}\n\nObjectRenderer.prototype.isNew = function(){\n\tif(this.new_object){\n\t\treturn true;\n\t}\n\tif(this.isPartOfNewDocument()){\n\t\treturn true;\n\t}\n\tif(this.parent) return this.parent.isNew();\n\treturn false;\n}\n\nObjectRenderer.prototype.setNew = function(){\n\tthis.new_object = true;\n}\n\nObjectRenderer.prototype.isUpdated = function(){\n\tvar i = 0;\n\tfor(var prop in this.properties){\n\t\tif(this.originalProperties[i] != prop) return true;\n\t\tif(this.properties[prop].isUpdated()) return true;\n\t\ti++;\t\t\n\t}\n\tif(i != this.originalProperties.length) return true;\n\treturn false;\n}\n\nObjectRenderer.prototype.childUpdated = function(){\n\tthis.viewer.redrawHeader();\n\tif(this.parent) this.parent.childUpdated();\n}\n\nObjectRenderer.prototype.updated = ObjectRenderer.prototype.childUpdated;\n\nObjectRenderer.prototype.isNewDocument = function(){\n\tif(this.root() && this.objframe.isnew()) return true;\n\treturn false;\n}\n\nObjectRenderer.prototype.isPartOfNewDocument = function(){\n\tif(this.isNewDocument()) return true;\n\tif(this.parent && this.parent.parent){\n\t\treturn this.parent.parent.isPartOfNewDocument();\n\t}\n\treturn false;\n}\n\nObjectRenderer.prototype.setFacet = function(facet, nocascade){\n\tthis.facet = facet;\n\tif(!nocascade){\n\t\tfor(var prop in this.properties){\n\t\t\tthis.properties[prop].parentFacetChange(facet);\n\t\t}\n\t}\n\tif(this.parent){\n\t\tthis.parent.redraw();\n\t}\n\telse {\n\t\tthis.redraw();\n\t}\n}\n\nObjectRenderer.prototype.getDefaultFacets = function(){\n\tvar defs = {\n\t\tpage: {\n\t\t\tlabel: \"Full Page\", value: \"page\", \n\t\t\tfeatures: [\"facet\", \"label\", \"comment\", \"id\", \"control\", \"type\", \"body\", \"status\", \"facet\", \"view\", \"viewer\"],\n\t\t\tcontrols: [\"delete\", \"clone\", \"add\", \"reset\", \"cancel\", \"update\", \"mode\", \"show\", \"hide\"] \n\t\t},\n\t\tline: {\n\t\t\tlabel: \"Single Line\", value: \"line\",\n\t\t\tfeatures: [\"facet\", \"label\", \"comment\", \"id\", \"type\", \"body\", \"status\", \"facet\"], \n\t\t\tcontrols: [] \n\t\t},\n\t\tsummary: {\n\t\t\tlabel: \"Summary\", value: \"summary\",\n\t\t\tfeatures: [\"facet\", \"satus\", \"label\", \"type\", \"summary\", \"status\", \"facet\"], \n\t\t\tcontrols: [] \n\t\t},\n\t\tlabel: {\n\t\t\tlabel: \"Label\", value: \"label\",\n\t\t\tfeatures: [\"facet\", \"status\", \"label\"],\n\t\t\tcontrols: []\n\t\t}\n\t}\n\treturn defs;\n}\n\nObjectRenderer.prototype.getAvailableFacets = function(){\n\treturn Object.keys(this.facets);\n}\n\nObjectRenderer.prototype.currentFacet = function(){\n\treturn this.facet;\n}\n\nObjectRenderer.prototype.getDefaultFacet = function(){\n\tif(!this.parent) return \"page\";\n\tvar pfacet = this.parent.currentFacet();\n\tif(pfacet == \"page\"){\n\t\treturn \"page\";\n\t}\n\tif(pfacet == \"multiline\") return \"line\";\n\tif(pfacet == \"line\") return \"summary\";\n\treturn \"label\";\n}\n\nObjectRenderer.prototype.parentFacetChange = function(pfacet){\n\tif(pfacet == \"page\") this.setFacet(\"page\");\n\tif(pfacet == \"multiline\") this.setFacet(\"summary\");\n\tif(pfacet == \"line\") this.setFacet(\"summary\");\n\tif(pfacet == \"summary\") this.setFacet(\"summary\");\n}\n\nObjectRenderer.prototype.getContentOrientation = function(){\n\tif(this.currentFacet() == \"page\"){\n\t\treturn \"page\";\n\t}\n\tif(this.currentFacet() == \"line\"){\n\t\treturn \"line\";\n\t}\n\treturn \"label\";\n}\n\nObjectRenderer.prototype.getLabel = function(){\n\tfor(var prop in this.properties){\n\t\tif(FrameHelper.getShorthand(prop) == \"rdfs:label\"){\n\t\t\tvar prend = this.properties[prop];\n\t\t\tvar vrend = prend.values[0];\n\t\t\tif(vrend){\n\t\t\t\tvar sum = vrend.getSummary();\n\t\t\t\tif(sum.long != \"empty\") return sum.long;\n\t\t\t}\n\t\t}\n\t}\n\tvar s = this.subject();\n\tif(s && s.substring(0, 2) == \"_:\"){\n\t\tvar ty = this.subjectClass();\n\t\tvar sh = FrameHelper.getShorthand(ty);\n\t\tif(sh){\n\t\t\tvar b = sh.split(\":\");\n\t\t\tif(b.length > 1){\n\t\t\t\treturn \"New \" + b[1];\n\t\t\t}\n\t\t}\n\t\treturn \"New Object\";\n\t}\n\treturn false;\n}\n\nObjectRenderer.prototype.getSummary = function(){\n\tvar ret = { status: \"ok\" };\n\tif(this.isUpdated()) ret.status = \"updated\";\n\tif(this.isNew()) ret.status = \"new\";\n\tret.propcount = 0;\n\tfor(var prop in this.properties){\n\t\tret.propcount++;\n\t}\n\tret.long = ret.propcount + \" properties\";\n\treturn ret;\t\n}\n\nObjectRenderer.prototype.getObjectHeaderViewer = function(){\n\treturn this.header_viewer;\n}\n\nObjectRenderer.prototype.getViewerForObject = function(format){\n\treturn RenderingMap.getViewerForObject(format, this);\t\n}\n\nObjectRenderer.prototype.getFeaturesForFacet = function(facet){\n\treturn this.facets[facet].features.concat(this.facets[facet].controls);\n}\n \nObjectRenderer.prototype.hideDisabledControls = function(){\n\treturn this.hide_disabled_controls;\n}\n\nObjectRenderer.prototype.showFeature = function(which){\n\tif(this.features.indexOf(which) == -1 && this.controls.indexOf(which) == -1) {\n\t\treturn false;\n\t}\n\tvar cardcontrols = [\"delete\", \"clone\", \"add\"];\n\tif(cardcontrols.indexOf(which) != -1){\n\t\tif(!this.cardControlAllows(which)) return false;\n\t}\n\tvar updcontrols = [\"update\", \"reset\"];\n\tif(this.hideDisabledControls() && updcontrols.indexOf(which) != -1 ){\n\t\tif(!this.isUpdated()){\n\t\t\treturn false;\n\t\t}\n\t}\n\tif(this.isNewDocument() && which == \"clone\") return false;\n\tif(which == 'hide' && this.view == \"hidden\") return false;\n\tif(which == 'show' && this.view != \"hidden\") return false;\n\tvar fets = this.getFeaturesForFacet(this.facet);\n\tif (fets.indexOf(which) != -1){\n\t\treturn true;\n\t}\n\treturn false;\n}\n\nObjectRenderer.prototype.cardControlAllows = function(action){\n\tif(!this.parent) return true;\n\tif(this.parent.cframe.hasRestriction()){\n\t\tvar rest = this.parent.cframe.restriction;\n\t\tvar currentnum = this.parent.values.length;\n\t\tif(action == \"add\" || action == \"clone\"){\n\t\t\tif(rest.max && currentnum >= rest.max){\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\tif(action == \"delete\" && (rest.min && currentnum <= rest.min)){\n\t\t\treturn false;\n\t\t}\n\t}\n\treturn true;\n}\n\nObjectRenderer.prototype.goToProperty = function(prop){\n\tthis.viewer.goTo(this.subject(), prop);\n}\n\nObjectRenderer.prototype.setMode = function(mode){\n\tthis.mode = mode;\n\tfor(var prop in this.properties){\n\t\tthis.properties[prop].setMode(mode);\n\t}\n\tthis.viewer.redraw();\n}\n\nObjectRenderer.prototype.currentViewer = function(){return this.viewerType;}\n\n\nObjectRenderer.prototype.setViewer = function(viewer){\n\tvar nviewer = this.getViewerForObject(viewer);\n\tif(nviewer){\n\t\tthis.viewerType = viewer;\n\t\tthis.viewer = nviewer;\n\t\tthis.viewer.redraw();\n\t}\n}\n\n\nObjectRenderer.prototype.setView = function(view){\n\tvar views = {\n\t\t\"full\": {\n\t\t\t\n\t\t},\n\t\t\"hidden\": {\n\t\t\t\n\t\t}\n\t};\n\tthis.view = view;\n\tthis.viewer.redraw();\n}\n\n\nObjectRenderer.prototype.hide = function(){\n\tthis.setView(\"hidden\");\n}\n\nObjectRenderer.prototype.show = function(){\n\tthis.setView(\"full\");\n}\n\nObjectRenderer.prototype.nukeViewer = function(){\n\tthis.viewer.remove();\n}\n\nObjectRenderer.prototype.getViewableProperties = function(){\n\treturn this.objframe.getFilledPropertyList();\t\n}\n\nObjectRenderer.prototype.getAddableProperties = function(){\n\tvar props = this.objframe.getMissingPropertyList();\t\n\treturn props;\n}\n\nObjectRenderer.prototype.getPropertiesToRender = function(options){\n\tvar sort = this.standardSort;\n\tvar filter = function(){return true};\n\tif(options && options.map && options.map.patterns){\n\t\tfor(var i = 0; i<options.map.patterns.length; i++){\n\t\t\tif(this.objframe.matchesPattern({property: this.property(), action: \"sort\"}, options.map.patterns[i])){\n\t\t\t\tsort = options.map.patterns[i].sort;\n\t\t\t}\n\t\t\tif(this.objframe.matchesPattern({property: this.property(), action: \"filter\"}, options.map.patterns[i])){\n\t\t\t\tfilter = options.map.patterns[i].filter;\n\t\t\t}\n\t\t}\n\t}\n\treturn sort(this.objframe, filter);\n}\n\nObjectRenderer.prototype.standardSort = function(objframe, filter){\n\tvar sorted = [];\n\tvar rdft = FrameHelper.getStdURL(\"rdfs\", \"label\");\n\tif(objframe.dataframes[rdft] && filter(objframe, rdft, objframe.dataframes[rdft])){\n\t\tsorted.push(rdft);\n\t}\n\tvar rdfc = FrameHelper.getStdURL(\"rdfs\", \"comment\");\n\tif(objframe.dataframes[rdfc]){\n\t\tsorted.push(rdfc);\n\t}\n\tfor(var prop in objframe.dataframes){\n\t\tif(sorted.indexOf(prop) == -1) sorted.push(prop);\n\t}\n\tfor(var prop in objframe.children){\n\t\tif(sorted.indexOf(prop) == -1) sorted.push(prop);\t\t\n\t}\n\treturn sorted;\n}\n\n\nObjectRenderer.prototype.redraw = function(){\n\tthis.viewer.clear();\n\tthis.render(this.viewer);\n}\n\nObjectRenderer.prototype.extractLDO = function(extracts){\n\textracts[\"rdf:type\"] = this.objframe.cls;\n\tvar full = {};\n\tfull[this.subject()] = extracts;\n\treturn full;\t\n}\n\nObjectRenderer.prototype.extractJSONLD = function(extracts){\n\textracts[\"@type\"] = this.objframe.cls;\n\tif(this.subject() != \"_:\")\textracts[\"@id\"] = this.subject();\n\tif(this.objframe.jsonld_context) extracts['@context'] = this.objframe.jsonld_context;\n\treturn extracts;\n}\n\nObjectRenderer.prototype.extract = function(){\n\tvar extracts = {};\n\tfor(var i in this.properties){\n\t\tvar extracted = this.properties[i].extract();\n\t\tif(!FrameHelper.empty(extracted)){\n\t\t\textracts[i] = extracted;\n\t\t}\n\t}\n\tif(FrameHelper.empty(extracts) && this.parent){\n\t\treturn false;\n\t}\n\telse {\n\t\tvar ext = this.extractJSONLD(extracts);\n\t\treturn ext;\n\t\t//return this.extractLDO(extracts);\n\t}\n}\n\nmodule.exports=ObjectRenderer\n\n","const FrameHelper = require('../FrameHelper');\nconst HTMLFrameHelper = require('./HTMLFrameHelper');\n\n/**\n * Property Viewer\n */\nfunction HTMLPropertyViewer(renderer){\n\tthis.renderer = renderer;\n\tthis.values = [];\n\tthis.headerViewer = renderer.getPropertyHeaderViewer();\n}\n\n\n/**\n * Draws the property as header and body components\n */\nHTMLPropertyViewer.prototype.render = function(){\n\tvar block = document.createElement('div');\n\tblock.setAttribute('style', 'display: flex; margin: 10px 10px 0px 0px;');\n\tvar br = document.createElement('br');\n\tblock.appendChild(br);\n\tif(this.propDOM){\n\t\tvar npropDOM = this.getPropertyDOM();\n\t\tblock.appendChild(npropDOM);\n\t\tthis.propDOM.replaceWith(npropDOM);\n\t\t//11092019 this.propDOM = npropDOM;\n\t\tthis.propDOM = block;\n\t}\n\telse {\n\t\tblock.appendChild(this.getPropertyDOM());\n\t\tthis.propDOM = block;\n\t\t//11092019 this.propDOM = this.getPropertyDOM();\n\t}\n\tthis.propDOM.appendChild(this.getPropertyIDMarker(this.renderer));\n\tif(this.headerViewer){\n\t\tthis.header = this.headerViewer.getAsDOM(this.renderer);\n\t\tif(this.header) this.propDOM.appendChild(this.header);\n\t}\n\tthis.body = this.getPropertyBodyDOM();\n\tif(this.body) this.propDOM.appendChild(this.body);\n\treturn this.propDOM;\n}\n\nHTMLPropertyViewer.prototype.getPropertyDOM = function(){\n\tvar orientation = this.renderer.getContentOrientation();\n\tvar pcls = \" terminus-property-frame-display terminus-property-frame-\" + orientation;\n\tif(orientation == \"label\"){\n\t\tvar sp = document.createElement(\"span\");\n\t}\n\telse {\n\t\tvar sp = document.createElement(\"div\");\n\t}\n\t//terminus-property-frame-spacer\n\n\tsp.setAttribute(\"class\", \"WHATER terminus-property-frame \"+ sp + \" terminus-property-frame-\" + this.renderer.mode + \" \" + pcls);\n\tsp.setAttribute('data-property', this.renderer.property());\n\treturn sp;\n}\n\nHTMLPropertyViewer.prototype.getPropertyBodyDOM = function(){\n\tvar orientation = this.renderer.getContentOrientation();\n\tvar pcls = \"terminus-property-values-\" + orientation;\n\tif(orientation == \"page\"){\n\t\tvar vholder = document.createElement(\"div\");\n\t}\n\telse {\n\t\tvar vholder = document.createElement(\"span\");\n\t}\n    vholder.setAttribute('class', 'terminus-property-values ' + pcls + ' terminus-property-values-align');\n\tfor(var i =0; i<this.values.length; i++){\n\t\tvholder.appendChild(this.values[i]);\n\t}\n\treturn vholder;\n}\n\nHTMLPropertyViewer.prototype.addRenderedValue = function(renderedval){\n\tthis.values.push(renderedval);\n}\n\nHTMLPropertyViewer.prototype.clear = function(){\n\tFrameHelper.removeChildren(this.propDOM);\n\tthis.values = [];\n}\n\n\n/**\n * Removes the property from the dom\n */\nHTMLPropertyViewer.prototype.remove = function(){\n\tthis.propDOM.parentNode.removeChild(this.propDOM);\n}\n\n/**\n * Redraws the property to reflect an updated state\n */\nHTMLPropertyViewer.prototype.redraw = function(){\n\tvar npropDOM = this.getPropertyDOM();\n\tthis.propDOM.replaceWith(npropDOM);\n\tthis.propDOM = npropDOM;\n\tthis.values = [];\n\tthis.renderer.render(this);\n}\n\nHTMLPropertyViewer.prototype.redrawHeader = function(){\n\tif(this.headerViewer && this.header) {\n\t\tvar nheader = this.headerViewer.getAsDOM(this.renderer);\n\t\tthis.header.replaceWith(nheader);\n\t\tthis.header = nheader;\n\t}\n}\n\nHTMLPropertyViewer.prototype.redrawBody = function(){\n\tif(this.body){\n\t\tvar nbody = this.getPropertyBodyDOM();\n\t\tthis.body.replaceWith(nbody);\n\t\tthis.body = nbody;\n\t}\n}\n\n/**\n * Generates a html anchor element to use as a marker to find the property on the page\n */\nHTMLPropertyViewer.prototype.getPropertyIDMarker = function(renderer){\n\tvar idm = document.createElement(\"a\");\n\tidm.setAttribute(\"class\", \"terminus-property-idmarker\");\n\tvar subj = FrameHelper.getShorthand(renderer.subject());\n\tif(!subj ) subj = renderer.subject();\n\tvar bits = subj .split(\":\");\n\tif(bits.length > 1) subj = bits[1];\n\tvar prop = FrameHelper.getShorthand(renderer.property());\n\tif(!prop ) prop = renderer.property();\n\tvar bits = prop.split(\":\");\n\tif(bits.length > 1) prop = bits[1];\n\tidm.setAttribute(\"name\", subj + \"_\" + prop);\n\treturn idm;\n}\n\nHTMLPropertyViewer.prototype.goTo = function(subj, property, index){\n\tHTMLFrameHelper.goToName(subj, property, index);\n}\n\nfunction HTMLPropertyHeaderViewer(){}\n\nHTMLPropertyHeaderViewer.prototype.getAsDOM = function(renderer){\n\tvar orientation = renderer.getContentOrientation();\n\tvar pcls = \"terminus-property-header-\" + orientation;\n\tif(orientation == \"page\"){\n\t\tvar objDOM = document.createElement(\"div\");\n\t}\n\telse {\n\t\tvar objDOM = document.createElement(\"span\");\n\t}\n\tobjDOM.setAttribute(\"class\", \"terminus-text terminus-property-header \" + pcls);\n\tvar wrapper = document.createElement(\"span\");\n\twrapper.setAttribute(\"class\", \"terminus-property-header-wrapper\");\n\tif(renderer.showFeature(\"control\")){\n\t\tvar controlsDOM = this.getPropertyControlsDOM(renderer);\n\t\tif(controlsDOM) wrapper.appendChild(controlsDOM);\n\t}\n\tif(renderer.showFeature(\"label\")){\n\t\tvar sumDOM = this.getPropertyLabelDOM(renderer);\n\t\tif(renderer.showFeature(\"status\")){\n\t\t\tvar statDOM = this.getPropertyStatusDOM(renderer);\n\t\t\tif(statDOM) sumDOM.prepend(statDOM);\n\t\t}\n\t\tif(sumDOM) wrapper.appendChild(sumDOM);\n\t}\n\telse if(renderer.showFeature(\"status\")){\n\t\tvar statDOM = this.getPropertyStatusDOM(renderer);\n\t\tif(statDOM) wrapper.appendChild(statDOM);\n\t}\n\tif(renderer.showFeature(\"summary\")){\n\t\tvar sumDOM = this.getPropertySummaryDOM(renderer);\n\t\tif(sumDOM) wrapper.appendChild(sumDOM);\n\t}\n\tvar prelude = document.createElement(\"span\");\n\tprelude.setAttribute(\"class\", \"terminus-property-header-info terminus-property-header-info-\"+renderer.currentFacet());\n\tif(renderer.showFeature(\"facet\")){\n\t\tvar facetDOM = this.getPropertyFacetDOM(renderer);\n\t\tif(facetDOM) prelude.appendChild(facetDOM);\n\t}\n\tif(renderer.showFeature(\"view\")){\n\t\tvar viewDOM = this.getViewValueDOM(renderer);\n\t\tif(viewDOM) prelude.appendChild(viewDOM);\n\t}\n\tif(renderer.showFeature(\"id\")){\n\t\tvar idDOM = this.getPropertyIDDOM(renderer);\n\t\tif(idDOM) prelude.appendChild(idDOM);\n\t}\n\tif(renderer.showFeature(\"type\")){\n\t\tvar typeDOM = this.getPropertyRangeDOM(renderer);\n\t\tif(typeDOM) prelude.appendChild(typeDOM);\n\t}\n\tif(renderer.showFeature(\"cardinality\") && renderer.hasCardinalityRestriction()){\n\t\tvar hideDOM = this.getPropertyCardinalityDOM(renderer);\n\t\tif(hideDOM) prelude.appendChild(hideDOM);\n\t}\n\tif(renderer.showFeature(\"comment\")){\n\t\tvar sumDOM = this.getPropertyCommentDOM(renderer);\n\t\tif(sumDOM) prelude.appendChild(sumDOM);\n\t}\n\twrapper.appendChild(prelude);\n\tobjDOM.appendChild(wrapper);\n\treturn objDOM;\n}\n\nHTMLPropertyHeaderViewer.prototype.getPropertyFacetDOM = function(renderer){\n\tvar viewables = renderer.getAvailableFacets();\n\tvar self = this;\n\tif(viewables && viewables.length){\n\t\tvar mpropDOM = document.createElement(\"span\");\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-property-facet\");\n\t\tvar callback = function(val){\n\t\t\tif(val){\n\t\t\t\trenderer.setFacet(val);\n\t\t\t}\n\t\t}\n\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"property-facet\", viewables, renderer.currentFacet(), callback);\n\t\tmpropDOM.appendChild(sel);\n\t\treturn mpropDOM;\n\t}\n\treturn false;\n}\n\nHTMLPropertyHeaderViewer.prototype.getPropertyIDDOM = function(renderer){\n\treturn HTMLFrameHelper.getInfoboxDOM(\"property-id\", \"Property\", renderer.property(), \"This property is identified by this unique URL: \" + renderer.property());\n}\n\nHTMLPropertyHeaderViewer.prototype.getPropertyRangeDOM = function(renderer){\n\treturn HTMLFrameHelper.getInfoboxDOM(\"property-type\", \"Type\", renderer.range(), \"The type of arguments that this property accepts\");\n}\n\nHTMLPropertyHeaderViewer.prototype.getPropertySummaryDOM = function(renderer){\n\tvar sum = renderer.getSummary();\n\treturn HTMLFrameHelper.getInfoboxDOM(\"property-summary\", false, sum.long, sum.status);\n}\n\nHTMLPropertyHeaderViewer.prototype.getPropertyStatusDOM = function(renderer){\n\tvar sum = renderer.getSummary();\n\treturn HTMLFrameHelper.getInfoboxDOM(\"status-\"+sum.status, false, sum.status, sum.status);\n}\n\nHTMLPropertyHeaderViewer.prototype.getPropertyLabelDOM = function(renderer){\n\tvar lab = renderer.getLabel();\n\treturn HTMLFrameHelper.getInfoboxDOM(\"property-label\", false, lab);\n}\n\nHTMLPropertyHeaderViewer.prototype.getPropertyCommentDOM = function(renderer){\n\tvar lab = renderer.getComment();\n\treturn HTMLFrameHelper.getInfoboxDOM(\"property-comment\", false, lab);\n}\n\nHTMLPropertyHeaderViewer.prototype.getPropertyCardinalityDOM = function(renderer){\n\tvar restriction = renderer.getRestriction();\n\tif(restriction.min && restriction.max){\n\t\tif(restriction.min == restriction.max){\n\t\t\tvar lab = restriction.min;\n\t\t\tvar help = \"Cardinality: \" + restriction.min;\n\t\t}\n\t\telse {\n\t\t\tvar lab = restriction.min + \"-\" + restriction.max;\n\t\t\tvar help = \"Minimum Cardinality: \" + restriction.min;\n\t\t\thelp += \", Maximum Cardinality: \" + restriction.max;\n\t\t}\n\t}\n\telse if(restriction.min){\n\t\tvar lab = \">\"+(restriction.min-1);\n\t\tvar help = \"Minimum Cardinality: \" + restriction.min;\n\t}\n\telse if(restriction.max){\n\t\tvar lab = \"<\"+(restriction.max+1);\n\t\tvar help = \"Maximum Cardinality: \" + restriction.max;\n\t}\n\telse {\n\t\treturn false;\n\t}\n\treturn HTMLFrameHelper.getInfoboxDOM(\"property-cardinality\", \"Cardinality\", lab, help);\n}\n\nHTMLPropertyHeaderViewer.prototype.getActionControlDOM = function(settingsDOM, renderer){\n\tif(renderer.showFeature(\"mode\")){\n\t\tvar viewsDOM = HTMLFrameHelper.getModeSelectorDOM(\"property\", renderer);\n\t\tif (viewsDOM) settingsDOM.appendChild(viewsDOM);\n\t}\n\tif(renderer.showFeature(\"delete\")){\n\t\tvar dpropDOM = this.getPropertyDeleteDOM(renderer);\n\t\tif (dpropDOM) settingsDOM.appendChild(dpropDOM);\n\t}\n\tif(renderer.showFeature(\"add\") && !renderer.isClassChoice()){\n\t\tvar addDOM = this.getAddValueDOM(renderer);\n\t\tif(addDOM) settingsDOM.appendChild(addDOM);\n\t}\n\tif(renderer.showFeature(\"reset\")){\n\t\tvar rpropDOM = this.getPropertyResetDOM(renderer);\n\t\tif(rpropDOM) settingsDOM.appendChild(rpropDOM);\n\t}\n\tif(renderer.showFeature(\"update\")){\n\t\tvar upropDOM = this.getPropertyUpdateDOM(renderer);\n\t\tif(upropDOM) settingsDOM.appendChild(upropDOM);\n\t}\n\tif(renderer.showFeature(\"show\")){\n\t\tvar showDOM = this.getPropertyShowDOM(renderer);\n\t\tif(showDOM) settingsDOM.appendChild(showDOM);\n\t}\n\tif(renderer.showFeature(\"hide\")){\n\t\tvar hideDOM = this.getPropertyHideDOM(renderer);\n\t\tif(hideDOM) settingsDOM.appendChild(hideDOM);\n\t}\n\tif(renderer.showFeature(\"viewer\")){\n\t\tvar hideDOM = this.getViewerSelectorDOM(renderer);\n\t\tif(hideDOM) settingsDOM.appendChild(hideDOM);\n\t}\n\tif(renderer.showFeature(\"add\") && renderer.isClassChoice()){\n\t\tvar addDOM = this.getAddValueDOM(renderer);\n\t\tif(addDOM) settingsDOM.appendChild(addDOM);\n\t}\n}\n\nHTMLPropertyHeaderViewer.prototype.getSettingsControlDOM = function(controlsDOM, renderer){\n\tvar settings = document.createElement(\"div\");\n\tvar sControl = HTMLFrameHelper.getSettingsControl();\n\tvar popup = document.createElement('div');\n\tpopup.setAttribute('class', 'terminus-hide terminus-popup');\n\tpopup.appendChild(document.createTextNode('blah blah'));\n\tsControl.appendChild(popup);\n\tsControl.addEventListener('click', function(){\n\t\tif(this.children[0].style.display == 'none') this.children[0].style.display = 'block';\n\t\telse this.children[0].style.display = 'block';\n\n\t});\n    settings.appendChild(sControl);\n\tcontrolsDOM.appendChild(settings);\n\t// append action controls to pop up\n\tthis.getActionControlDOM(popup, renderer);\n}\n\nHTMLPropertyHeaderViewer.prototype.getPropertyControlsDOM = function(renderer){\n\tvar controlsDOM = document.createElement(\"span\");\n\tcontrolsDOM.setAttribute(\"class\", \"terminus-property-controls\");\n\t// get settings icon or button\n\tthis.getSettingsControlDOM(controlsDOM, renderer);\n\treturn controlsDOM;\n}\n\nHTMLPropertyHeaderViewer.prototype.getAddValueDOM = function(renderer){\n\tif(renderer.isClassChoice()){\n\t\tvar cs = renderer.getAvailableClassChoices();\n\t\tif(cs && cs.length){\n\t\t\tvar mpropDOM = document.createElement(\"span\");\n\t\t\tmpropDOM.setAttribute(\"class\", \"terminus-property-add-class\");\n\t\t\tcs.unshift({ value: \"\", label: \"Add Type\"});\n\t\t\tvar callback = function(cls){\n\t\t\t\tif(cls){\n\t\t\t\t\trenderer.addClass(cls);\n\t\t\t\t}\n\t\t\t}\n\t\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"add-property\", cs, \"\", callback);\n\t\t\tmpropDOM.appendChild(sel);\n\t\t\treturn mpropDOM;\n\t\t}\n\t}\n\telse {\n\t\tvar callback = function(){renderer.add(\"edit\")};\n\t\tvar disabled = (renderer.cardControlAllows(\"add\") ? false : \"Cardinality Rules Forbid Add\");\n\t\treturn HTMLFrameHelper.getActionControl(\"property\", \"add\", \"Add\", callback, disabled);\n\t}\n\treturn false;\n}\n\nHTMLPropertyHeaderViewer.prototype.getViewValueDOM = function(renderer){\n\tvar viewables = renderer.getViewableValues();\n\tvar self = this;\n\tif(viewables && viewables.length){\n\t\tvar mpropDOM = document.createElement(\"span\");\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-property-view-value\");\n\t\tviewables.unshift({ value: \"\", label: \"View Value\"});\n\t\tvar callback = function(val){\n\t\t\trenderer.goToValue(val);\n\t\t}\n\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"view-values\", viewables, \"\", callback);\n\t\tmpropDOM.appendChild(sel);\n\t\treturn mpropDOM;\n\t}\n\treturn false;\n}\n\nHTMLPropertyHeaderViewer.prototype.getPropertyDeleteDOM = function(renderer){\n\tvar callback = function(){renderer.delete()};\n\tvar disabled = (renderer.cardControlAllows(\"delete\") ? false : \"Cardinality Rules Forbid Delete\");\n\treturn HTMLFrameHelper.getActionControl(\"property\", \"delete\", \"Delete\", callback, disabled);\n}\n\nHTMLPropertyHeaderViewer.prototype.getPropertyHideDOM = function(renderer){\n\tvar callback = function(){renderer.hide()};\n\treturn HTMLFrameHelper.getActionControl(\"property\", \"hide\", \"Hide\", callback);\n}\n\nHTMLPropertyHeaderViewer.prototype.getPropertyResetDOM = function(renderer){\n\tvar callback = function(){renderer.reset()};\n\tvar disabled = (renderer.isUpdated() ? false : \"Nothing to reset\");\n\treturn HTMLFrameHelper.getActionControl(\"property\", \"reset\", \"Reset\", callback, disabled);\n}\n\nHTMLPropertyHeaderViewer.prototype.getPropertyShowDOM = function(renderer){\n\tvar callback = function(){renderer.show()};\n\treturn HTMLFrameHelper.getActionControl(\"property\", \"show\", \"Show\", callback);\n}\n\nHTMLPropertyHeaderViewer.prototype.getPropertyUpdateDOM = function(renderer){\n\tvar dpropDOM = document.createElement(\"span\");\n\tdpropDOM.setAttribute(\"class\", \"terminus-property-update\");\n\tvar disabled = (renderer.isUpdated() ? false : \"No Change\");\n\tvar saveback = function(){renderer.save()};\n\tdpropDOM.appendChild(HTMLFrameHelper.getActionControl(\"property\", \"save\", \"Save\", saveback, disabled));\n\treturn dpropDOM;\n}\n\nHTMLPropertyHeaderViewer.prototype.getViewerSelectorDOM = function(renderer){\n\tvar viewers = renderer.getAvailableViewers();\n\tif(viewers && viewers.length){\n\t\tvar mpropDOM = document.createElement(\"span\");\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-property-viewer\");\n\t\tvar callback = function(viewer){\n\t\t\tif(viewer){\n\t\t\t\trenderer.setViewer(viewer);\n\t\t\t}\n\t\t}\n\t\tvar selected = renderer.currentViewer();\n\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"property-viewers\", viewers, selected, callback);\n\t\tmpropDOM.appendChild(sel);\n\t\treturn mpropDOM;\n\t}\n\treturn false;\n}\n\nHTMLPropertyHeaderViewer.prototype.showValue = function(renderer, index){\n\tvar htmlid = renderer.subject() + \"->\" + renderer.property() + \"_\" + index;\n\twindow.location = (\"\"+window.location).replace(/#[A-Za-z0-9_]*$/,'') + \"#\" + htmlid;\n}\n\nfunction HTMLDataViewer(renderer){\n\tthis.renderer = renderer;\n\tthis.headerViewer = renderer.getValueHeaderViewer();\n}\n\nmodule.exports={HTMLPropertyViewer,HTMLPropertyHeaderViewer}\n","const FrameHelper = require('../FrameHelper');\nconst TerminusPluginManager = require('../plugins/TerminusPlugin');\n\nlet HTMLFrameHelper = {};\n\nHTMLFrameHelper.getActionControl = function(type, control, label, callback, disabled){\n\tvar pman = new TerminusPluginManager();\n\tvar dpropDOM = document.createElement(\"span\");\n\tdpropDOM.setAttribute(\"class\", \"terminus-action-control \" + type + \"-\" + control);\n\tvar pman = new TerminusPluginManager();\n    if(pman.pluginAvailable(\"font-awesome\")){\n\t\tvar icon = document.createElement('icon');\n\t\tvar faic = this.getControlIcon(control);\n\t\tif(disabled){\n\t\t\ticon.setAttribute(\"class\", \"terminus-frame-control frame-control-action action-disabled fa fa\" + faic + \" \" + type + \"-\" + control + \"-disabled terminus-font-align\");\n\t\t\ticon.setAttribute(\"title\", disabled);\n\t\t}\n\t\telse {\n\t\t\ticon.setAttribute(\"class\", \"terminus-frame-control frame-control-action frame-control-action fa fa\" + faic + \" \" + type + \"-\" + control + \" terminus-font-align\");\n\t\t\ticon.addEventListener(\"click\", function(){\n\t\t\t\tcallback(control);\n\t\t\t});\n\t\t}\n\t\tdpropDOM.appendChild(icon);\n\t}\n\telse{\n\t\tvar button = document.createElement(\"button\");\n\t\tbutton.appendChild(document.createTextNode(label));\n\t\tif(disabled){\n\t\t\tbutton.setAttribute(\"class\", \"terminus-frame-control terminus-btn frame-control-action action-disabled \" + type + \"-\" + control + \"-disabled\");\n\t\t\tbutton.setAttribute(\"title\", disabled);\n\t\t}\n\t\telse {\n\t\t\tbutton.setAttribute(\"class\", \"terminus-frame-control terminus-btn frame-control-action \" + type + \"-\" + control);\n\t\t\tbutton.addEventListener(\"click\", function(){\n\t\t\t\tcallback(control);\n\t\t\t});\n\t\t}\n\t\tdpropDOM.appendChild(button);\n\t}\n\treturn dpropDOM;\n}\n\nHTMLFrameHelper.getSettingsControl = function(){\n\tvar pman = new TerminusPluginManager();\n\tif(pman.pluginAvailable(\"font-awesome\")){\n\t\tvar icon = document.createElement('icon');\n\t\ticon.setAttribute('class', 'fa fa-bars');\n\t\treturn icon;\n\t}\n\telse{\n\t\tvar button = document.createElement(\"button\");\n\t\tbutton.appendChild(document.createTextNode('Settings'));\n\t\treturn button;\n\t}\n}\n\nHTMLFrameHelper.getControlIcon = function(control){\n\tvar icon;\n\tswitch(control){\n\t\tcase 'delete':\n\t\t\ticon = '-alt-delete';\n\t\tbreak;\n\t\tcase 'add':\n\t\t\ticon = '-plus';\n\t\tbreak;\n\t\tcase 'reset':\n\t\t\ticon = '-undo';\n\t\tbreak;\n\t\tcase 'save':\n\t\t\ticon = '-save';\n\t\tbreak;\n\t\tcase 'hide':\n\t\t\ticon = '-eye-slash';\n\t\tbreak;\n\t}\n\treturn icon;\n}\n\nHTMLFrameHelper.getSelectionControl = function(type, options, selected, callback){\n\tvar sel = document.createElement(\"select\");\n\tsel.setAttribute(\"class\", \"terminus-frame-selector frame-control-selection \" + type);\n\tfor(var i = 0; i < options.length; i++){\n\t\tvar opt = document.createElement(\"option\");\n\t\tif(typeof options[i] == \"object\"){\n\t\t\topt.value = options[i].value;\n\t\t\tvar label = (options[i].label ?  document.createTextNode(options[i].label) : document.createTextNode(FrameHelper.labelFromURL(options[i].value)));\n\t\t\topt.appendChild(label);\n\t\t}\n\t\telse {\n\t\t\topt.value = options[i];\n\t\t\tlabel = FrameHelper.labelFromURL(opt.value);\n\t\t\topt.appendChild(document.createTextNode(label));\n\t\t}\n\t\tif(selected == opt.value){\n\t\t\topt.setAttribute(\"selected\", \"selected\");\n\t\t}\n\t\tsel.appendChild(opt);\n\t}\n\tsel.addEventListener(\"change\", function(){\n\t\tcallback(this.value);\n\t});\n\treturn sel;\n}\n\nHTMLFrameHelper.getModeSelectorDOM = function(which, renderer){\n\tvar viewsDOM = document.createElement(\"span\");\n\tviewsDOM.setAttribute(\"class\", \"terminus-mode terminus-\"+which+\"-mode\");\n\tif(renderer.mode == \"view\"){\n\t\tvar callback = function(){ renderer.setMode(\"edit\");}\n\t\tviewsDOM.appendChild(HTMLFrameHelper.getActionControl(\"terminus-mode terminus-\"+which+\"-mode\", \"edit\", \" Edit \", callback));\n\t}\n\telse if(renderer.isNew()){\n\t\treturn false;\n\t}\n\telse {\n\t\tvar callback = function(){ renderer.cancel();}\n\t\tviewsDOM.appendChild(HTMLFrameHelper.getActionControl(which, \"cancel\", \"Cancel\", callback));\n\t}\n\treturn viewsDOM;\n}\n\nHTMLFrameHelper.goToName = function(s, p, i){\n\tvar url = window.location.href;\n\tif(url){\n\t\tvar wbits = url.split(\"#\");\n\t\tvar loc = wbits[0];\n\t\tvar sh = FrameHelper.getShorthand(s);\n\t    if(!sh) sh = s;\n\t\tvar bits = sh.split(\":\");\n\t\tif(bits.length > 1) sh = bits[1];\n\t\tvar htmlid = sh;\n\t\tif(p){\n\t\t\tvar prop = FrameHelper.getShorthand(p);\n\t\t\tif(!prop ) prop = p;\n\t\t\tvar bits = prop.split(\":\");\n\t\t\tif(bits.length > 1) prop = bits[1];\n\t\t\thtmlid += \"_\" + prop;\n\t\t\tif(i){\n\t\t\t\thtmlid += \"_\" + i;\n\t\t\t}\n\t\t}\n\t\twindow.location = loc + \"#\" + htmlid;\n\t}\n}\n\n\n\n/*HTMLFrameHelper.getFrameRow = function(){\n\tvar row = document.createElement('div');\n\trow.setAttribute('class', 'terminus-frame-row');\n\treturn row;\n}\n\nHTMLFrameHelper.getFrameGroup = function(frow){\n\tvar fl = document.createElement('div');\n\tfl.setAttribute('class', 'terminus-frame-length');\n\tfrow.appendChild(fl);\n\n\tvar fg = document.createElement('div');\n\tfg.setAttribute('class', 'terminus-frame-group');\n\tfl.appendChild(fg);\n\treturn fl;\n}*/\n\nHTMLFrameHelper.getInfoboxDOM = function(type, label, value, help, input){\n\t/*var frow = this.getFrameRow();\n\tvar fgroup = this.getFrameGroup(frow);*/\n\tvar infoDOM = document.createElement(\"span\");\n\tinfoDOM.setAttribute(\"class\", \"terminus-frame-infobox-box \" + \"terminus-\" +type );\n\t//fgroup.appendChild(infoDOM);\n\tif(help){\n\t\tinfoDOM.setAttribute(\"title\", help);\n\t}\n\tif(label){\n\t\tvar linfo = document.createElement(\"span\");\n\t\tlinfo.setAttribute(\"class\", \"terminus-frame-infobox-label \" + \"terminus-\" +type + \"-label\");\n\t\tlinfo.appendChild(document.createTextNode(label));\n\t\tinfoDOM.appendChild(linfo);\n\t}\n\tvar lspacer = document.createElement(\"span\");\n\tlspacer.setAttribute(\"class\", \"terminus-frame-infobox-spacer \" + \"terminus-\" +type + \"-spacer\");\n\tlspacer.appendChild(document.createTextNode(\" \"));\n\tinfoDOM.appendChild(lspacer);\n\tvar lval = document.createElement(\"span\");\n\tlval.setAttribute(\"class\", \"terminus-frame-infobox-value \" + \"terminus-\" +type + \"-value terminus-property-label-align\");\n\tif(input){\n\t\tinput.value = value;\n\t\tlval.appendChild(input);\n\t}\n\telse if(value) {\n\t\tvar sh = FrameHelper.getShorthand(value);\n        if(sh){\n    \t   \tvar bits = sh.split(\":\");\n            sh = bits[1];\n   \t\t\tlval.setAttribute(\"title\", value);\n\t\t\tlval.appendChild(document.createTextNode(sh));\n\t\t}\n\t\telse {\n\t\t\tlval.appendChild(document.createTextNode(value));\n\t\t}\n\t}\n\tinfoDOM.appendChild(lval);\n\treturn infoDOM;\n}\n\nmodule.exports=HTMLFrameHelper\n","const FrameHelper = require('../FrameHelper');\nconst WOQLQuery = require('../query/WOQLQuery');\nconst WOQLResult = require('../query/WOQLResult');\nconst WOQLResultsViewer = require('../query/WOQLResultsViewer');\nconst UTILS= require('../Utils')\n\nfunction Datatables(){}\n\nDatatables.prototype.convertToDatatable = function(tab){\n    var table = jQuery(tab).DataTable({\n         searching : false,\n         pageLength: 25,\n         lengthMenu: [10, 25, 50, 75, 100],\n         paging    : true,\n         select    : true,\n         columnDefs:[{targets:'_all',className:\"truncate\"}],\n         createdRow: function(row){\n                            var td = $(row).find(\".truncate\");\n                            td.attr(\"title\", td.html());},\n         dom       : 'lrtip'\n    }); //jQuery(tab)\n\n    //styling\n    tab.setAttribute('class'      , 'stripe dataTable terminus-db-size terminus-db-border');\n    tab.setAttribute('cellpadding', '1');\n    tab.setAttribute('cellspacing', '1');\n    tab.setAttribute('border'     , '0');\n    return tab;\n}\n\n/*\n    dcb: datatable drawCallBack reference\n    ui: terminus ui reference\n    dt: datatable reference\n    query: new woqlquery with current pagination changes\n    pageInfo: current drawCallBack page change info\n    resultDOM: result dom on veiwer page\n*/\nDatatables.prototype.executeQuery = function(dcb, ui, dt, query, pageInfo, resultDOM){\n    var self = this;\n    dcb.wquery.execute(query)\n      .then(function(result){\n          if(true || !self.result){\n              self.result = new WOQLResultsViewer(ui, result, null, pageInfo);\n          }\n          var rtab = self.result.getTable(result.bindings);\n          if(rtab){\n              self.getDataFromServer(rtab, pageInfo, ui, resultDOM);\n          }\n      })\n      .catch(function(err){\n          console.error(err);\n          self.ui.showError(err);\n      });\n}\n\n/* get query string based on datatable pagination and current query */\nDatatables.prototype.getQueryOnPagination = function(wq, settings){\n    switch(settings.query){\n        case 'Show_All_Documents':\n            return wq.getAllDocumentQuery(null, settings.pageLength, settings.start);\n        break;\n        case 'Show_All_Data':\n            return wq.getEverythingQuery(null, settings.pageLength, settings.start);\n        break;\n        case 'Show_All_Schema_Elements':\n            return wq.getElementMetaDataQuery(null, settings.pageLength, settings.start);\n        break;\n        case 'Show_Document_Classes':\n            return wq.getClassMetaDataQuery(wq.getSubclassQueryPattern(\"Class\", \"dcog/'Document'\")\n    \t\t\t\t\t\t\t\t\t\t  + \", not(\" + wq.getAbstractQueryPattern(\"Class\") + \")\",\n                                                 settings.pageLength, settings.start);\n        break;\n        case 'Show_All_Properties':\n            return wq.getPropertyListQuery(null, settings.pageLength, settings.start);\n        break;\n        case 'Show_All_Classes':\n            return wq.getClassMetaDataQuery(null, settings.pageLength, settings.start);\n        break;\n        case 'Show_Data_Class':\n            return  wq.getDataOfChosenClassQuery(settings.chosenValue, settings.pageLength, settings.start);\n        break;\n        case 'Show_Property_Class':\n            return wq.getDataOfChosenPropertyQuery(settings.chosenValue, settings.pageLength, settings.start);\n        break;\n        case 'Show_Document_Info_by_Id':\n            return wq.getDocumentQuery(settings.chosenValue, settings.pageLength, settings.start);\n        break;\n        default:\n            console.log('Invalid woql option passed');\n        break;\n\n    }\n}\n\n/*\n    dcb: datatable drawCallBack reference\n    ui: terminus ui reference\n    dt: datatable reference\n    pageInfo: current drawCallBack page change info\n*/\nDatatables.prototype.generateNewQueryOnPageChange = function(dcb, ui, dt, pageInfo){\n    dcb.wquery = new WOQLQuery(ui.client, null);\n    UTILS.deleteStylizedEditor(ui, pageInfo.qTextDom);\n    var query = dt.getQueryOnPagination(dcb.wquery, pageInfo)\n    pageInfo.qTextDom.value = query;\n    UTILS.stylizeEditor(ui, pageInfo.qTextDom, 'query', 'javascript');\n    return query;\n}\n\n/*\n    dt: Datatable reference\n    len : current number of records to display\n*/\nDatatables.prototype.getCallbackSettings = function(dt, len){\n    var pageInfo = {};\n    pageInfo.pageLength = len;\n    pageInfo.start      = 0;\n    pageInfo.qTextDom   = dt.qTextDom;\n    pageInfo.query      = dt.query;\n    pageInfo.chosenValue = dt.chosenValue;\n    return pageInfo;\n}\n\n/*\n    tab: datatable table dom\n    settings : settings from woql txt generator\n    resultDOM: result dom of viewer\n*/\nDatatables.prototype.setUp = function(tab, settings, resultDOM){\n    // delete previous datatable\n    FrameHelper.removeChildren(this.dtdom);\n    this.dtdom = document.createElement('div');\n    this.dtdom.appendChild(tab);\n    resultDOM.appendChild(this.dtdom);\n    // saving query text box dom to change limit value on change of datatable page length\n    this.qTextDom = settings.qTextDom;\n    this.query = settings.query;\n    this.chosenValue = settings.chosenValue;\n}\n\nDatatables.prototype.getDataFromServer = function(tab, settings, ui, resultDOM){\n    var dt = this;\n    this.setUp(tab, settings, resultDOM);\n    // initialize datatables\n    var table = jQuery(tab).DataTable({\n         searching   : false,\n         pageLength  : settings.pageLength,\n         lengthMenu  : [5, 10, 25, 50, 75, 100],\n         paging      : true,\n         select      : true,\n         columnDefs  :[{targets:'_all',className:\"truncate\"}],\n         createdRow  : function(row){\n                            var td = $(row).find(\".truncate\");\n                            td.attr(\"title\", td.html());},\n         dom         : 'lrtip',\n         drawCallback: function(settings) {\n                             // on change of page length\n                             $(this).on( 'length.dt', function (e, settings, len){\n                                  var pageInfo = dt.getCallbackSettings(dt, len);\n                                  var query = dt.generateNewQueryOnPageChange(this, ui, dt, pageInfo);\n                                  return dt.executeQuery(this, ui, dt, query, pageInfo, resultDOM);\n                             });\n\n        }\n    }); //jQuery(tab)\n\n    //styling\n    tab.setAttribute('class'      , 'stripe dataTable');\n    tab.setAttribute('cellpadding', '1');\n    tab.setAttribute('cellspacing', '1');\n    tab.setAttribute('border'     , '0');\n\n    return tab;\n}\n\n/*\nserverside: true or false\n*/\nDatatables.prototype.draw = function(serverside, tab, settings, ui, resultDOM){\n    if(serverside)\n        return(this.getDataFromServer(tab, settings, ui, resultDOM));\n    else return(this.convertToDatatable(tab));\n}\n\nmodule.exports=Datatables\n","const FrameHelper = require('../FrameHelper');\nconst WOQLQuery = require('../query/WOQLQuery');\nconst TerminusClassChooser = require('./TerminusClassChooser');\n/*\n * Utility class which allows the user to choose a document by id or by label (if select2 and full text indexing is turned on)\n */\n\nTerminusDocumentChooser = function(ui, root, value, view){\n\tthis.ui = ui;\n\tthis.root = root;\n\t//this.filter = (currentcls ? FrameHelper.unshorten(currentcls) : false);\n\tthis.choice = value;\n\tthis.view = (view ? view : \"id\");\n\tthis.show_button = true;\n}\n\nTerminusDocumentChooser.prototype.setRoot = function(root){\n\tthis.root = root;\n}\n\nTerminusDocumentChooser.prototype.setFilter = function(filter){\n\tthis.filter = filter;\n}\n\nTerminusDocumentChooser.prototype.change = function(docid){\n\talert(\"Need to specify doc chooser function (\" + docid + \")\");\n}\n\nTerminusDocumentChooser.prototype.getAsDOM = function(style){\n\tif(this.view == \"label\" && \tthis.ui.client.connectionConfig.platformEndpoint() && this.ui.pluginAvailable(\"select2\")){\n\t\treturn this.getS2DOM(style);\n\t}\n\treturn this.getIDDOM();\n}\n\nTerminusDocumentChooser.prototype.getS2DOM = function(style){\n\tvar docchooser = document.createElement(\"span\");\n\tdocchooser.setAttribute(\"class\", \"terminus-document-chooser terminus-doc-holder\");\n\tvar wq = new WOQLQuery(this.ui.client, {});\n\tvar cfilter = wq.getSubclassQueryPattern(\"Class\", \"'\"+this.root+\"'\");\n\tvar termcc = new TerminusClassChooser(this.ui, cfilter);\n\ttermcc.empty_choice = \"Filter by Type\";\n\ttermcc.show_single = false;\n\tvar self = this;\n\ttermcc.change = function(new_class){\n\t\tif(new_class){\n\t\t\tself.filter = new_class;\n\t\t}\n\t}\n\ttdom = termcc.getAsDOM(style);\n\tif(tdom) docchooser.appendChild(tdom);\n\tvar holder = document.createElement(\"span\");\n\tholder.setAttribute(\"class\", \"terminus-entity-reference-value\");\n\tvar sel = document.createElement(\"select\");\n\tsel.setAttribute(\"class\", \"terminus-entity-class-input\");\n\tholder.appendChild(sel);\n\tvar opt = document.createElement(\"option\");\n\tvar lookup = function (params) {\n\t\tparams.class = self.filter;\n\t\treturn JSON.stringify(params);\n    }\n\tvar searchurl = this.ui.client.dbURL() + \"/search\";\n\tvar s2config = {\n\t\tajax: {\n\t\t    url: searchurl,\n\t\t    dataType: 'json',\n\t\t    data: lookup,\n\t\t    type: \"POST\",\n\t\t\tcontentType: \"application/json; charset=utf-8\",\n\t\t    delay: 250,\n\t\t    cache: true\n\t\t},\n\t\tplaceholder: \"Enter Document Name\",\n\t\twidth: 200\n\t};\n\tjQuery(sel).select2(s2config).change(function(){\n\t\tcallback(this.value);\n\t});\n\tdocchooser.appendChild(holder);\n\treturn docchooser;\n}\n\nTerminusDocumentChooser.prototype.getIDDOM = function(){\n\tvar docchooser = document.createElement(\"span\");\n\tdocchooser.setAttribute(\"class\", \"terminus-document-chooser terminus-doc-holder\");\n\tvar dcip = document.createElement(\"input\");\n\tdcip.setAttribute(\"class\", \"terminus-document-chooser terminus-query-text\");\n\t//11092019 dcip.setAttribute(\"class\", \"terminus-form-value terminus-document-chooser\");\n\tdcip.setAttribute(\"placeholder\", \"Enter Document ID\");\n\tdcip.addEventListener('keypress', function(e){\n\t\tvar key = e.which || e.keyCode;\n\t\t// on enter\n\t\tif (key === 13 && dcip.value) {\n\t\t\tself.choice = dcip.value;\n\t\t\tself.change(dcip.value);\n\t\t}\n\t});\n\tdocchooser.appendChild(dcip);\n\tif(this.show_button){\n\t\tvar dbut = document.createElement(\"button\");\n\t\tdbut.setAttribute(\"class\", \"terminus-control-button terminus-query-go-btn\");\n\t\tvar self = this;\n\t\tdbut.addEventListener(\"click\", function(){\n\t\t\tif(dcip.value) {\n\t\t\t\tself.choice = dcip.value;\n\t\t\t\tself.change(dcip.value);\n\t\t\t}\n\t\t});\n\t\t//11092019 dbut.appendChild(document.createTextNode(\"View Document Properties\"));\n\t\tdbut.appendChild(document.createTextNode(\"Go\"));\n\t\tdocchooser.appendChild(dbut);\n\t}\n\treturn docchooser;\n}\n\nTerminusDocumentChooser.prototype.toggleView = function(){\n\tif(this.view == \"id\") this.view = \"label\";\n\telse this.view = \"id\";\n}\n\nTerminusDocumentChooser.prototype.getChangeViewText = function(){\n\tif(this.view == \"id\"){\n\t\treturn \"Document Lookup\";\n\t}\n\treturn \"Load Document ID\";\n}\n\nmodule.exports=TerminusDocumentChooser\n","const TerminusUI = require('./TerminusUI');\nconst FrameHelper = require('./FrameHelper');\nconst RenderingMap = require('./client/RenderingMap');\n\nvar terminator = new TerminusUI(TerminusConfig);\nvar pconfig = {};\npconfig.buttons = {'client'   : document.getElementById(\"terminus-client-btn\"),\n\t'explorer' : document.getElementById(\"terminus-explorer-btn\")}\npconfig.controller \t= document.getElementById(\"terminus-control-panel\");\npconfig.messages = document.getElementById(\"terminus-user-messages\");\npconfig.plugins = document.getElementById(\"terminus-plugin-loader\");\npconfig.explorer = document.getElementById(\"terminus-explorer\");\npconfig.viewer = document.getElementById(\"terminus-content-viewer\");\nvar nlocation = (TerminusConfig && TerminusConfig.location) ? TerminusConfig.location : false;\nterminator.draw(pconfig, nlocation);\n/* 11092019 var cssloader = document.getElementById(\"terminus-css-loader\");\ncssloader.addEventListener(\"change\", function(){\n\tterminator.piman.loadPageCSS(this.value);\n}); */\nfunction showPanel(mode){\n\ttoggleHeaders(mode, document.getElementById(\"terminus-content-viewer\"));\n}\n\nmodule.exports={TerminusUI:TerminusUI,\n                FrameHelper:FrameHelper,\n                RenderingMap:RenderingMap}","/**\n * Terminus UI object\n *\n * Traffic control of messages going between different Terminus UI pages and features\n *\n * @param opts - options array\n */\nconst FrameHelper = require('./FrameHelper');\nconst ApiExplorer = require('./ApiExplorer');\nconst TerminusDocumentViewer = require('./client/TerminusDocument');\nconst TerminusDBsdk = require('./client/TerminusDB');\nconst TerminusQueryViewer = require('./client/TerminusQuery');\nconst TerminusMappingViewer = require('./client/TerminusMapping');\nconst TerminusSchemaViewer = require('./client/TerminusSchema');\nconst TerminusServersdk = require('./client/TerminusServer');\nconst TerminusURLLoader = require('./client/TerminusURL');\nconst TerminusPluginManager = require('./plugins/TerminusPlugin');\n\nfunction TerminusUI(opts){\n\tthis.client = new TerminusDB.WOQLClient();\n\tthis.controls = [];\n\tthis.setOptions(opts);\n}\n\n/*\n * Client connects to specified server and specified part\n * opts is a json with the following fields:\n * server: mandatory URL of the server to connect to\n * key: optional client API key\n * dbid: id of the database to connect to\n * schema: if set, the UI will load the schema page after connecting\n * query: if set, the query will be sent to the server and the results will be loaded on the query page\n * document: if set, the document page corresponding to this document will be loaded after connecting\n *\n * (note: schema, query, document are mutually exclusive and must also have a dbid set)\n */\nTerminusUI.prototype.connect = function(opts){\n\tvar self = this;\n\tthis.client.connectionConfig.server = false;\n\tvar key = ((opts && opts.key) ? opts.key : false);\n\tthis.showBusy(\"Connecting to server at \" + opts.server);\n\treturn this.client.connect(opts.server, key)\n\t.then( function(response) {\n\t\tself.clearBusy();\n\t\tif(opts && opts.db && self.getDBRecord(opts.db)){\n\t\t\tself.connectToDB(opts.db);\n\t\t\tif(opts.document && self.showView(\"get_document\")){\n\t\t\t\tself.showDocument(opts.document);\n\t\t\t}\n\t\t\telse if(opts.schema && self.showView(\"get_schema\")){\n\t\t\t\tself.showSchemaPage(opts.schema);\n\t\t\t}\n\t\t\telse if(opts.query && self.showView(\"woql_select\")){\n\t\t\t\tself.showQueryPage(opts.query);\n\t\t\t}\n\t\t\telse if(opts.explorer && self.showView(\"api_explorer\")){\n\t\t\t\tself.showExplorer(opts.explorer);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tself.showDBMainPage();\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tself.showServerMainPage();\n\t\t}\n\t\tself.redraw();\n\t})\n\t.catch(function(err) {\n\t\tself.clearBusy();\n\t\tself.showError(err);\n\t});\n}\n\n/**\n * Sends a request to create a new database to the server and interprets the response\n *\n * dbdets is a json object with the following fields:\n * id: the id of the new database (alphanumeric, no spaces, url friendly) mandatory\n * title: the text name of the new database for tables, etc. mandatory\n * description: text description of the database (optional)\n * key: a API client key for server auth\n * schema: the url of another Terminus DB from which to import schema\n * instance: the url of another Terminus DB from which to import data\n *\n */\nTerminusUI.prototype.createDatabase = function(dbdets){\n\tvar self = this;\n\tif(!dbdets.id || !dbdets.title){\n        return Promise.reject(new Error(self.getBadArguments(\"createDatabase\", \"ID and title are mandatory fields\")));\n\t}\n\tvar dbid = dbdets.id;\n\tvar myserver = this.client.connectionConfig.server;\n\tself.showBusy(\"Creating Database \" + dbdets.title + \" with id \" + dbid);\n\tvar dbdoc = this.generateNewDatabaseDocument(dbdets);\n\treturn this.client.createDatabase(dbid, dbdoc)\n\t.then(function(response){ //import schema into newly created DB\n\t\tif(dbdets.schema){\n\t\t\tself.showBusy(\"Fetching imported schema from \" + dbdets.schema);\n\t\t\tvar opts = (dbdets.key ?  {key: dbdets.key } : {});\n\t\t\treturn self.client.getSchema(dbdets.schema, opts)\n\t\t\t.then(function(response){\n\t\t\t\tself.showBusy(\"Updating database with new schema\");\n\t\t\t\tself.client.connectionConfig.server = myserver;\n\t\t\t\tself.client.connectionConfig.dbid = dbid;\n\t\t\t\treturn self.client.updateSchema(false, response);\n\t\t\t})\n\t\t\t.then(function(response){\n\t\t\t\tself.clearBusy();\n\t\t\t\treturn response;\n\t\t\t});\n\t\t}\n\t\telse {\n\t\t\tself.clearBusy();\n\t\t}\n\t\treturn response;\n\t})\n\t.then(function(response){ //reload list of databases in background..\n\t\treturn self.refreshDBList()\n\t\t.then(function(response){\n\t\t\tif(crec = self.client.connection.getDBRecord(dbid)){\n\t\t\t\tself.client.connectionConfig.dbid = dbid;\n\t\t\t\tself.showDBMainPage();\n\t\t\t\tself.showMessage(\"Successfully Created Database \" + dbid, \"success\");\n\t\t\t}\n\t\t\telse {\n\t\t        return Promise.reject(new Error(self.getCrashString(\"createDatabase\", \"Failed to retrieve record of created database \" + dbid)));\n\t\t\t}\n\t\t})\n\t})\n\t.catch(function(error){\n\t\tself.clearBusy();\n\t\tself.showError(error);\n\t});\n}\n\n/**\n * Deletes the database with the passed id from the currently connected server\n */\nTerminusUI.prototype.deleteDatabase = function(dbid){\n\tvar self = this;\n\tvar delrec = this.client.connection.getDBRecord();\n\tvar lid = (dbid ? dbid : this.db());\n\tvar dbn = (delrec && delrec['rdfs:label'] && delrec['rdfs:label'][\"@value\"] ? delrec['rdfs:label'][\"@value\"] + \" (id: \" + lid + \")\" : lid);\n\tthis.showBusy(\"Deleting database \" + dbn);\n\treturn this.client.deleteDatabase(dbid)\n\t.then(function(response){\n\t\tself.clearBusy();\n\t\tself.client.connectionConfig.dbid = false;\n\t\tself.removeDB(dbid);\n\t\tself.showServerMainPage();\n\t\tself.showMessage(\"Successfully Deleted Database \" + dbn, \"success\");\n\t\tself.refreshDBList();\n\t\treturn response;\n\t})\n\t.catch(function(error){\n\t\tself.clearBusy();\n\t\tself.showError(error);\n\t});\n}\n\n/*\n * Transforms a details (id, title, description) array into  json-ld document\n */\nTerminusUI.prototype.generateNewDatabaseDocument = function(dets){\n\tvar doc = {\n\t\t\"@context\" : {\n\t\t\trdfs: \"http://www.w3.org/2000/01/rdf-schema#\",\n\t\t\tterminus: \"https://datachemist.net/ontology/terminus#\"\n\t\t},\n\t\t\"@type\": \"terminus:Database\"\n\t}\n\tif(dets.title){\n\t\tdoc['rdfs:label'] = {\n\t\t\t\"@language\":  \"en\",\n\t\t\t\"@value\": dets.title\n\t\t};\n\t}\n\tif(dets.description){\n\t\tdoc['rdfs:comment'] = {\n\t\t\t\"@language\":  \"en\",\n\t\t\t\"@value\": dets.description\n\t\t};\n\t}\n\tdoc['terminus:allow_origin'] = { \"@type\" : \"xsd:string\", \"@value\" : \"*\" };\n\treturn doc;\n}\n\nTerminusUI.prototype.getBadArguments = function(fname, str){\n\treturn \"Bad arguments to \" + fname + \": \" + str;\n}\n\nTerminusUI.prototype.getCrashString = function(fname, str){\n\treturn \"Results from \" + fname + \" indicate the possibility of a system failure \" + str;\n}\n\n/*\n * Parses the passed URL and turns it into a call to the connect function - loads the appropriate endpoing\n */\nTerminusUI.prototype.load = function(url, key){\n\tvar args = {};\n\tif(url && url.indexOf(\"/document/\") != -1){\n\t\turl = url.substring(0, url.indexOf(\"/document/\"));\n\t\targs.document = url.substring(url.indexOf(\"/document/\")+10);\n\t}\n\telse if(url && url.indexOf(\"/schema\") != -1){\n\t\turl = url.substring(0, url.indexOf(\"/schema\"));\n\t\targs.schema = {};\n\t}\n\telse if(url && url.indexOf(\"/woql\") != -1){\n\t\turl = url.substring(0, url.indexOf(\"/query\"));\n\t\targs.query = url.substring(url.indexOf(\"/query\")+7);\n\t}\n\targs.server = url;\n\tif(key) args.key = key;\n\treturn this.connect(args);\n}\n\n/**\n * Fetches the DB URL from the url by chopping off the extra bits\n */\nTerminusUI.prototype.getConnectionEndpoint = function(url){\n\tif(url && url.lastIndexOf(\"/schema\") != -1){\n\t\treturn url.substring(0, url.lastIndexOf(\"/schema\"));\n\t}\n\tif(url && url.lastIndexOf(\"/document\") != -1){\n\t\treturn url.substring(0, url.lastIndexOf(\"/document\"));\n\t}\n\tif(url && url.lastIndexOf(\"/frame\") != -1){\n\t\treturn url.substring(0, url.lastIndexOf(\"/frame\"));\n\t}\n\tif(url && url.lastIndexOf(\"/woql\") != -1){\n\t\treturn url.substring(0, url.lastIndexOf(\"/woql\"));\n\t}\n\treturn url;\n}\n\nTerminusUI.prototype.server = function(){\n\treturn this.client.connectionConfig.server;\n}\n\nTerminusUI.prototype.db = function(){\n\treturn this.client.connectionConfig.dbid;\n}\n\nTerminusUI.prototype.clearServer = function(){\n\tthis.client.connectionConfig.server = false;\n}\n\nTerminusUI.prototype.connectToDB = function(dbid){\n\tthis.client.connectionConfig.dbid = dbid;\n\tFrameHelper.standard_urls['doc'] = this.client.connectionConfig.dbURL() + \"/document/\";\n}\n\nTerminusUI.prototype.clearDB = function(){\n\tthis.client.connectionConfig.dbid = false;\n}\n\nTerminusUI.prototype.removeDB = function(db, url){\n\tthis.client.connection.removeDBFromConnection(db, url);\n}\n\nTerminusUI.prototype.getDBRecord = function(db, url){\n\treturn this.client.connection.getDBRecord(db, url);\n}\n\nTerminusUI.prototype.refreshDBList = function(){\n\tvar self = this;\n\treturn this.client.connect();\n}\n\nTerminusUI.prototype.showServerMainPage = function(){\n\tthis.viewer = new TerminusServersdk.TerminusServerViewer(this);\n\tthis.redrawMainPage();\n}\n\nTerminusUI.prototype.showLoadURLPage = function(val){\n\tthis.viewer = new TerminusURLLoader(this, val);\n\tthis.redrawMainPage();\n}\n\nTerminusUI.prototype.showDBMainPage = function(){\n\tthis.viewer = new TerminusDBsdk.TerminusDBViewer(this);\n\tthis.redraw();\n}\n\nTerminusUI.prototype.showCreateDBPage = function(){\n\tthis.viewer = new TerminusDBsdk.TerminusDBCreator(this);\n\tthis.redrawMainPage();\n}\n\nTerminusUI.prototype.showSchemaPage = function(durl){\n\tthis.viewer = new TerminusSchemaViewer(this);\n\tthis.redrawMainPage();\n}\n\nTerminusUI.prototype.showQueryPage = function(query){\n\tthis.viewer = new TerminusQueryViewer(this, query, this.options);\n\tthis.redrawMainPage();\n}\n\nTerminusUI.prototype.showMappingPage = function(mapping){\n\tthis.viewer = new TerminusMappingViewer(this, mapping, this.options);\n\tthis.redrawMainPage();\n}\n\nTerminusUI.prototype.showDocument = function(durl){\n\tthis.viewer = new TerminusDocumentViewer(this, \"view\", this.getDocViewerOptions());\n\tthis.viewer.loadDocument(durl);\n\tthis.redrawMainPage();\n}\n\nTerminusUI.prototype.showCreateDocument = function(durl){\n\tthis.viewer = new TerminusDocumentViewer(this, \"create\", this.getDocCreatorOptions());\n\tthis.viewer.loadCreateDocument(durl);\n\tthis.redrawMainPage();\n}\n\nTerminusUI.prototype.redrawMainPage = function(){\n\tFrameHelper.removeChildren(this.main);\n\tif(this.viewer){\n\t\tthis.main.appendChild(this.viewer.getAsDOM());\n\t}\n}\n\nTerminusUI.prototype.showResult = function(response){\n\tthis.showMessage(response, \"success\");\n};\n\nTerminusUI.prototype.showError = function(response){\n\tthis.showMessage(response, \"error\");\n};\n\nTerminusUI.prototype.clearMessages = function(response){\n\tif(this.messages) FrameHelper.removeChildren(this.messages);\n};\n\nTerminusUI.prototype.clearMainPage = function(){\n\tif(this.main) FrameHelper.removeChildren(this.main);\n}\n\nTerminusUI.prototype.setMessageDOM = function(dom){\n\tthis.messages = dom;\n}\n\nTerminusUI.prototype.setbuttonControls = function(dom){\n\tthis.buttons = dom;\n}\n\nTerminusUI.prototype.setControllerDOM = function(dom){\n\tthis.controller = dom;\n}\n\nTerminusUI.prototype.setExplorerDOM = function(dom){\n\tthis.explorer = dom;\n}\n\nTerminusUI.prototype.setPluginsDOM = function(dom){\n\tthis.plugins = dom;\n}\n\nTerminusUI.prototype.setViewerDOM = function(dom){\n\tthis.main = dom;\n}\n\nTerminusUI.prototype.draw = function(comps, slocation){\n\tif(comps && comps.buttons) this.setbuttonControls(comps.buttons);\n\tif(comps && comps.messages) this.setMessageDOM(comps.messages);\n\tif(comps && comps.controller) this.setControllerDOM(comps.controller);\n\tif(comps && comps.explorer) this.setExplorerDOM(comps.explorer);\n\tif(comps && comps.viewer) this.setViewerDOM(comps.viewer);\n\tif(comps && comps.plugins) this.setPluginsDOM(comps.plugins);\n\tif(this.buttons){\n\t\tthis.toggleControl();\n\t}\n\tif(this.controller){\n\t\tthis.drawControls();\n\t}\n\tif(this.plugins){\n\t\tthis.drawPlugins();\n\t}\n\tif(slocation && slocation.server){\n\t\tif(typeof this.client.connection.connection[slocation.server] == \"undefined\") this.connect(slocation)\n\t\t.catch(function(error){\n\t\t\tthis.showLoadURLPage();\n\t\t\tthis.showError(error);\n\t\t});\n\t}\n\telse {\n\t\tthis.showLoadURLPage();\n\t};\n}\n\nTerminusUI.prototype.redraw = function(msg){\n\tthis.clearMessages();\n\tif(this.controller){\n\t\tFrameHelper.removeChildren(this.controller);\n\t\tthis.drawControls();\n\t}\n\tif(this.explorer){\n\t\tFrameHelper.removeChildren(this.explorer);\n\t\t//this.drawExplorer();\n\t}\n\tif(this.viewer){\n\t\tthis.redrawMainPage();\n\t}\n\tif(msg) this.showMessage(msg);\n};\n\nTerminusUI.prototype.toggleControl = function(){\n  var self = this;\n  this.buttons.client.addEventListener('click', function(){\n    FrameHelper.removeChildren(self.controller);\n    FrameHelper.removeChildren(self.explorer);\n    self.drawControls();\n    self.showServerMainPage();\n  })\n  this.buttons.explorer.addEventListener('click', function(){\n    FrameHelper.removeChildren(self.controller);\n    FrameHelper.removeChildren(self.explorer);\n    self.drawExplorer();\n  })\n}\n\nTerminusUI.prototype.drawControls = function(){\n\tthis.controls = [];\n\tthis.loadControls();\n\tfor(var i = 0; i<this.controls.length; i++){\n\t\tvar ncontrol = this.controls[i];\n\t\tif(ncontrol && (nd = ncontrol.getAsDOM())){\n\t\t\tthis.controller.appendChild(nd);\n\t\t}\n\t}\n}\n\nTerminusUI.prototype.drawExplorer = function(){\n\tif(this.explorer){\n\t\tif(this.showControl(\"api_explorer\")){\n\t\t\tvar exp = new ApiExplorer(this);\n\t\t\tae = exp.getAsDOM();\n\t\t\tthis.explorer.appendChild(ae);\n\t\t\tthis.explorer.style.display = 'block';\n\t\t}\n\t}\n}\n\nTerminusUI.prototype.loadControls = function(){\n\tif(this.showControl('server')){\n\t\tvar sc = new TerminusServersdk.TerminusServerController(this);\n\t\tif(sc) {\n\t\t\tthis.controls.push(sc);\n\t\t}\n\t\tif(this.db() && this.showControl(\"db\")){\n\t\t\tvar sc = new TerminusDBsdk.TerminusDBController(this);\n\t\t\tif(sc) this.controls.push(sc);\n\t\t}\n\t}\n}\n\nTerminusUI.prototype.showControl = function(el){\n\tif(this.show_controls.indexOf(el) == -1) return false;\n\tif(this.pseudoCapability(el)) return true;\n\tif(this.client.connection.capabilitiesPermit(el)) {\n\t\treturn true;\n\t}\n\treturn false;\n}\n\nTerminusUI.prototype.showView = function(el){\n\tif(this.show_views.indexOf(el) == -1) return false;\n\tif(this.pseudoCapability(el)) return true;\n\tif(this.client.connection.capabilitiesPermit(el)) {\n\t\treturn true;\n\t}\n\treturn false;\n}\n\nTerminusUI.prototype.clearBusy = function(response){\n\tthis.clearMessages();\n\tif(this.viewer && typeof this.viewer.busy == \"function\") this.viewer.busy(false);\n}\n\nTerminusUI.prototype.showMessage = function(msg, type){\n\tif(this.messages){\n\t\tFrameHelper.removeChildren(this.messages);\n\t\tvar md = document.createElement('div');\n        var clsstr = 'terminus-show-msg';\n        if(type) clsstr += 'terminus-msg-' + type;\n        md.setAttribute('class', clsstr);\n        md.appendChild(document.createTextNode(msg));\n\t\tthis.messages.appendChild(md);\n\t}\n};\n\nTerminusUI.prototype.showViolations = function(vios, type){\n\tvar nvios = new TerminusViolations(vios, this);\n\tif(this.messages){\n\t\tvar cmsg = (type == \"schema\" ? \" in Schema\" : \" in Document\");\n\t\tFrameHelper.removeChildren(this.messages);\n\t\tthis.messages.appendChild(nvios.getAsDOM(cmsg));\n\t}\n}\n\nTerminusUI.prototype.showBusy = function(msg){\n\tthis.showMessage(msg, \"busy\");\n\tif(this.viewer && typeof this.viewer.busy == \"function\") this.viewer.busy(msg);\n};\n\nTerminusUI.prototype.pseudoCapability = function(el){\n\tvar pseuds = [\"server\", \"db\", \"change-server\", \"api_explorer\", \"import_schema\", \"schema_format\"];\n\tif(pseuds.indexOf(el) == -1) return false;\n\treturn true;\n}\n\nTerminusUI.prototype.setOptions = function(opts){\n\tthis.show_controls = opts && opts.controls ? opts.controls :\n\t\t[\"server\", \"db\", \"change-server\", \"schema_format\",\n\t\t\t\"import_schema\", \"class_frame\", \"create_database\",\n\t\t\t\"create_document\", \"get_document\", \"update_schema\",\n\t\t\t\"get_schema\", \"woql_select\"\n\t\t];\n\tthis.show_views = opts && opts.views ? opts.views : this.show_controls;\n\tif(opts.document){\n\t\tthis.document_options = opts.document;\n\t}\n\tif(opts.schema){\n\t\tthis.schema_options = opts.schema;\n\t}\n\tthis.piman = new TerminusPluginManager();\n\tvar self = this;\n\tthis.piman.init(opts.plugins, function(){\n\t\tself.redraw();\n\t});\n\tif(opts.css && this.piman){\n\t\tthis.piman.loadPageCSS(opts.css);\n\t}\n\tthis.loadControls();\n}\n\nTerminusUI.prototype.pluginAvailable = function(p){\n\treturn this.piman.pluginAvailable(p);\n}\n\nTerminusUI.prototype.drawPlugins = function(){\n\tif(!this.piman) {\n\t\tconsole.log(new Error(\"No plugin manager initialised in UI object\"));\n\t\treturn false;\n\t}\n\tthis.plugins.appendChild(this.piman.getAsDOM(this));\n}\n\nTerminusUI.prototype.getDocViewerOptions = function(){\n\tif(this.document_options && this.document_options['view']){\n\t\treturn this.document_options['view'];\n\t}\n\treturn false;\n}\n\nTerminusUI.prototype.getDocCreatorOptions = function(){\n\tif(this.document_options && this.document_options['view']){\n\t\treturn this.document_options['view'];\n\t}\n\treturn false;\n}\n\nTerminusUI.prototype.getClassFrameOptions = function(){\n\treturn this.viewdoc_options;\n}\n\nmodule.exports=TerminusUI\n","/**\n * @file Javascript Api explorer tool\n * @author Kitty Jose\n * @license Copyright 2018-2019 Data Chemist Limited, All Rights Reserved. See LICENSE file for more\n *\n * @summary Displays a demo and description of api calls from WOQLCLient and what happens under the hood of api calls\n */\nconst FrameHelper = require('./FrameHelper');\nconst TerminusPluginManager = require('./plugins/TerminusPlugin');\nconst UTILS= require('./Utils')\n\n function ApiExplorer(ui){\n    this.ui = ui;\n    this.viewer = ui.main;\n    this.client = new TerminusDB.WOQLClient();\n    this.client.use_fetch = true;\n    this.client.return_full_response = true;\n    this.pman = new TerminusPluginManager();\n }\n\n\n// Controller provides access to the Api explorer functions\nApiExplorer.prototype.getAsDOM = function(){\n \tvar aec = document.createElement(\"div\");\n    aec.setAttribute(\"class\", \"terminus-db-controller\");\n    if(this.ui){\n       this.getApiNav(aec, this.viewer);\n    } // if this.ui\n    return aec;\n }\n\n// gets api nav bar\nApiExplorer.prototype.getApiNav = function(navDom, viewer){\n    // list view of apis\n    var nav = document.createElement('div');\n    navDom.appendChild(nav);\n\n    // connect to server api\n    var ul = document.createElement('ul');\n    ul.setAttribute('class', 'terminus-ul');\n    nav.appendChild(ul);\n\n    // connect api\n    var a = document.createElement('a');\n    a.setAttribute('class', 'terminus-selected terminus-a terminus-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\n    var self = this;\n    a.addEventListener(\"click\", function(){\n        UTILS.removeSelectedNavClass(\"terminus-selected\");\n        this.classList.add(\"terminus-selected\");\n        self.getApiExplorerDom('connect', viewer);\n    })\n    var icon = document.createElement('i');\n    icon.setAttribute('class', 'terminus-menu-icon fa fa-link');\n    a.appendChild(icon);\n    var txt = document.createTextNode('Connect Server Api');\n    a.appendChild(txt);\n    ul.appendChild(a);\n\n    // database api\n    var a = document.createElement('a');\n    a.setAttribute('class', 'terminus-a terminus-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\n    var self = this;\n    a.addEventListener(\"click\", function(){\n        UTILS.removeSelectedNavClass(\"terminus-selected\");\n        this.classList.add(\"terminus-selected\");\n        self.getApiExplorerDom('create', viewer);\n    })\n    var icon = document.createElement('i');\n    icon.setAttribute('class', 'terminus-menu-icon fa fa-database');\n    a.appendChild(icon);\n    var txt = document.createTextNode('Database Api');\n    a.appendChild(txt);\n    ul.appendChild(a);\n\n    // schema api\n    var a = document.createElement('a');\n    a.setAttribute('class', 'terminus-a terminus-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\n    var self = this;\n    a.addEventListener(\"click\", function(){\n        UTILS.removeSelectedNavClass(\"terminus-selected\");\n        this.classList.add(\"terminus-selected\");\n        self.getApiExplorerDom('schema', viewer);\n    })\n    var icon = document.createElement('i');\n    icon.setAttribute('class', 'terminus-menu-icon fa fa-cog');\n    a.appendChild(icon);\n    var txt = document.createTextNode('Schema Api');\n    a.appendChild(txt);\n    ul.appendChild(a);\n\n    // documents api\n    var a = document.createElement('a');\n    a.setAttribute('class', 'terminus-a terminus-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\n    var self = this;\n    a.addEventListener(\"click\", function(){\n        UTILS.removeSelectedNavClass(\"terminus-selected\");\n        this.classList.add(\"terminus-selected\");\n        self.getApiExplorerDom('document', viewer);\n    })\n    var icon = document.createElement('i');\n    icon.setAttribute('class', 'terminus-menu-icon fa fa-file');\n    a.appendChild(icon);\n    var txt = document.createTextNode('Document Api');\n    a.appendChild(txt);\n    ul.appendChild(a);\n\n    // query api\n    var a = document.createElement('a');\n    a.setAttribute('class', 'terminus-a terminus-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\n    var self = this;\n    a.addEventListener(\"click\", function(){\n        UTILS.removeSelectedNavClass(\"terminus-selected\");\n        this.classList.add(\"terminus-selected\");\n        self.getApiExplorerDom('query', viewer);\n    })\n    var icon = document.createElement('i');\n    icon.setAttribute('class', 'terminus-menu-icon fa fa-search');\n    a.appendChild(icon);\n    var txt = document.createTextNode('Query Api');\n    a.appendChild(txt);\n    ul.appendChild(a);\n\n    this.getApiExplorerDom('connect', viewer);\n\n    return navDom;\n} // getApiNav()\n\n// get schema api explorer - nav bar, alert msg, headers ...\nApiExplorer.prototype.getApiExplorerDom = function(view, viewer){\n\n  // clear of viewer\n  FrameHelper.removeChildren(viewer);\n\n  // wrapper\n  var wrap = document.createElement('div');\n  //wrap.setAttribute('class', 'terminus-wrapper terminus-wrapper-height');\n  viewer.appendChild(wrap);\n  var cont = document.createElement('div');\n  cont.setAttribute('class', 'container-fluid');\n  wrap.appendChild(cont);\n  var row = document.createElement('div');\n  row.setAttribute('class', 'row-fluid');\n  cont.appendChild(row);\n\n  var body = document.createElement('div');\n  body.setAttribute('class', 'terminus-module-body');\n  row.appendChild(body);\n\n  var api = document.createElement('div');\n  api.setAttribute('class', 'terminus-module-body span9 terminus-module-body-white-bg terminus-module-body-width');\n\n  body.appendChild(api);\n\n  var msg = 'API Explorer helps to understand api calls in depth.'\n              + ' User can perform actions and view what happens in the background.'\n  var al = UTILS.getInfoAlertDom('info', 'Info: ', msg);\n  api.appendChild(al);\n\n  // header\n  api.appendChild(UTILS.getHeaderDom('Api Explorer'));\n\n  // body\n  var cont = document.createElement('div');\n  //cont.setAttribute('class', 'terminus-module-body');\n\n  var self = this;\n  switch(view){\n    case 'connect':\n      var apiCont = self.getConnectExplorer(cont);\n      api.appendChild(apiCont);\n    break;\n    case 'create':\n      var apiCont = self.getDatabaseExplorer(cont);\n      api.appendChild(apiCont);\n    break;\n    case 'schema':\n      var apiCont = self.getSchemaApi(cont);\n      api.appendChild(apiCont);\n    break;\n    case 'document':\n      var apiCont = self.getDocumentApi(cont);\n      api.appendChild(apiCont);\n    break;\n    case 'query':\n      var apiCont = self.getQueryApi(cont);\n      api.appendChild(apiCont);\n    break;\n\n  }// switch(api)\n\n  return wrap;\n} // getApiExplorerDom\n\nApiExplorer.prototype.setSelectedNavMenu = function(a){\n    UTILS.removeSelectedNavClass(\"terminus-selected\");\n    a.classList.add(\"terminus-selected\");\n}\n\nApiExplorer.prototype.setSelectedSubMenu = function(a){\n    UTILS.removeSelectedNavClass(\"terminus-submenu-selected\");\n    a.classList.add(\"terminus-submenu-selected\");\n}\n\n// on trigger of click event - change dom\nApiExplorer.prototype.changeApiDom = function(action, cont, body){\n    FrameHelper.removeChildren(body);\n    var dom = this.getShowApiDom(action, body);\n    cont.appendChild(dom);\n}\n\n// get document api calls - on click of DocumentAPI nav bar\nApiExplorer.prototype.getDocumentApi = function(cont){\n\n  var body = document.createElement('div');\n\n  // list view of Databse tools\n  var ul = document.createElement('ul');\n  ul.setAttribute('class','terminus-ul-horizontal');\n\n  // view document api\n  var a = document.createElement('a');\n  a.setAttribute('class', 'terminus-a terminus-submenu-selected terminus-hz-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\n  var self = this;\n  a.addEventListener(\"click\", function(){\n      self.setSelectedNavMenu(this);\n      self.changeApiDom('viewDocument', cont, body);\n  })\n  var icon = document.createElement('i');\n  icon.setAttribute('class', 'terminus-menu-icon fa fa-eye');\n  a.appendChild(icon);\n  var txt = document.createTextNode('View Document');\n  a.appendChild(txt);\n  ul.appendChild(a);\n\n  // create document api\n    var a = document.createElement('a');\n    a.setAttribute('class', 'terminus-a terminus-hz-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\n    var self = this;\n    a.addEventListener(\"click\", function(){\n        self.setSelectedNavMenu(this);\n        self.changeApiDom('createDocument', cont, body);\n    })\n    var icon = document.createElement('i');\n    icon.setAttribute('class', 'terminus-menu-icon fa fa-plus');\n    a.appendChild(icon);\n    var txt = document.createTextNode('Create Document');\n    a.appendChild(txt);\n    ul.appendChild(a);\n\n    // update document api\n    var a = document.createElement('a');\n    a.setAttribute('class', 'terminus-a terminus-hz-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\n    var self = this;\n    a.addEventListener(\"click\", function(){\n        self.setSelectedNavMenu(this);\n        self.changeApiDom('updateDocument', cont, body);\n    })\n    var icon = document.createElement('i');\n    icon.setAttribute('class', 'terminus-menu-icon fa fa-arrow-up');\n    a.appendChild(icon);\n    var txt = document.createTextNode('Update Document');\n    a.appendChild(txt);\n    ul.appendChild(a);\n\n    // delete document api\n    var a = document.createElement('a');\n    a.setAttribute('class', 'terminus-a terminus-hz-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\n    var self = this;\n    a.addEventListener(\"click\", function(){\n        self.setSelectedNavMenu(this);\n        self.changeApiDom('deleteDocument', cont, body);\n    })\n    var icon = document.createElement('i');\n    icon.setAttribute('class', 'terminus-menu-icon fa fa-trash-alt');\n    a.appendChild(icon);\n    var txt = document.createTextNode('Delete Document');\n    a.appendChild(txt);\n    ul.appendChild(a);\n\n    cont.appendChild(ul);\n\n    var dom = self.getShowApiDom('viewDocument', body);\n    cont.appendChild(dom);\n\n    return cont;\n} // getDocumentApi\n\n// get query api calls - on click of QueryAPI nav bar - submenus of Query Api defined here\nApiExplorer.prototype.getQueryApi  = function(cont){\n  var body = document.createElement('div');\n\n  // list view of Databse tools\n  var ul = document.createElement('ul');\n  ul.setAttribute('class','terminus-ul-horizontal');\n\n  //woql select\n  var a = document.createElement('a');\n  a.setAttribute('class', 'terminus-submenu-selected terminus-a terminus-hz-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\n  var self = this;\n  a.addEventListener(\"click\", function(){\n      self.setSelectedSubMenu(this);\n      FrameHelper.removeChildren(body);\n      var dom = self.getQueryApiDom('select', body);\n  })\n  var icon = document.createElement('i');\n  icon.setAttribute('class', 'terminus-menu-icon fa fa-mouse-pointer');\n  a.appendChild(icon);\n  var txt = document.createTextNode('Select');\n  a.appendChild(txt);\n  ul.appendChild(a);\n\n  //update select\n  var a = document.createElement('a');\n  a.setAttribute('class', 'terminus-a terminus-hz-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\n  var self = this;\n  a.addEventListener(\"click\", function(){\n      self.setSelectedSubMenu(this);\n      FrameHelper.removeChildren(body);\n      var dom = self.getQueryApiDom('update', body);\n      cont.appendChild(dom);\n  })\n  var icon = document.createElement('i');\n  icon.setAttribute('class', 'terminus-menu-icon fa fa-arrow-up');\n  a.appendChild(icon);\n  var txt = document.createTextNode('Update');\n  a.appendChild(txt);\n  ul.appendChild(a);\n\n  //mapping\n  var a = document.createElement('a');\n  a.setAttribute('class', 'terminus-a terminus-hz-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\n  var self = this;\n  a.addEventListener(\"click\", function(){\n      self.setSelectedSubMenu(this);\n      FrameHelper.removeChildren(body);\n      var dom = self.getQueryApiDom('lookup', body);\n      cont.appendChild(dom);\n  })\n  var icon = document.createElement('i');\n  icon.setAttribute('class', 'terminus-menu-icon fa fa-random');\n  a.appendChild(icon);\n  var txt = document.createTextNode('Look up');\n  a.appendChild(txt);\n  ul.appendChild(a);\n\n  cont.appendChild(ul);\n\n  var dom = self.getQueryApiDom('select', body);\n  cont.appendChild(dom);\n\n  return cont;\n} //getQueryApi\n\n// get schema api calls - on click of SchemaAPI nav bar - submenus of schema Api defined here\nApiExplorer.prototype.getSchemaApi = function(cont){\n\n  var body = document.createElement('div');\n\n  // list view of Databse tools\n  var ul = document.createElement('ul');\n  ul.setAttribute('class','terminus-ul-horizontal');\n\n  var body = document.createElement('div');\n\n  // list view of Databse tools\n  var ul = document.createElement('ul');\n  ul.setAttribute('class','terminus-ul-horizontal');\n\n  //get schema\n  var a = document.createElement('a');\n  a.setAttribute('class', 'terminus-a terminus-submenu-selected terminus-hz-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\n  var self = this;\n  a.addEventListener(\"click\", function(){\n      self.setSelectedSubMenu(this);\n      self.changeApiDom('getSchema', cont, body);\n  })\n  var icon = document.createElement('i');\n  icon.setAttribute('class', 'terminus-menu-icon fa fa-eye');\n  a.appendChild(icon);\n  var txt = document.createTextNode('View Schema');\n  a.appendChild(txt);\n  ul.appendChild(a);\n\n  //update schema\n  var a = document.createElement('a');\n  a.setAttribute('class', 'terminus-a terminus-hz-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\n  var self = this;\n  a.addEventListener(\"click\", function(){\n      self.setSelectedSubMenu(this);\n      self.changeApiDom('updateSchema', cont, body);\n  })\n  var icon = document.createElement('i');\n  icon.setAttribute('class', 'terminus-menu-icon fa fa-arrow-up');\n  a.appendChild(icon);\n  var txt = document.createTextNode('Update Schema');\n  a.appendChild(txt);\n  ul.appendChild(a);\n\n  //get class frames\n  var a = document.createElement('a');\n  a.setAttribute('class', 'terminus-a terminus-hz-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\n  var self = this;\n  a.addEventListener(\"click\", function(){\n      self.setSelectedSubMenu(this);\n      self.changeApiDom('getClassFrames', cont, body);\n  })\n  var icon = document.createElement('i');\n  icon.setAttribute('class', 'terminus-menu-icon fa fa-share-alt');\n  a.appendChild(icon);\n  var txt = document.createTextNode('Get Class Frames');\n  a.appendChild(txt);\n  ul.appendChild(a);\n\n  cont.appendChild(ul);\n\n  var dom = self.getShowApiDom('getSchema', body);\n  cont.appendChild(dom);\n\n  return cont;\n} // getSchemaApi\n\n// get connect to server api calls - on click of connectAPI nav bar\nApiExplorer.prototype.getConnectExplorer = function(body){\n  var self = this;\n\n  var br = document.createElement('BR');\n  body.appendChild(br);\n\n  // get signature\n  var b = this.getSignature('connect');\n  body.appendChild(b);\n\n  // get header Parameter\n  body.appendChild(UTILS.getHeaderDom('Parameters'));\n\n  var br = document.createElement('BR');\n  body.appendChild(br);\n\n  //form to get server url\n  var form = this.getServerForm();\n\n  body.appendChild(form);\n  return body;\n\n} // getConnectExplorer\n\n//get create & delete db form\nApiExplorer.prototype.getServerForm = function(){\n  // form\n  var form = document.createElement('form');\n  form.setAttribute('class', 'terminus-form-horizontal row-fluid');\n\n  var fd = document.createElement('div');\n  fd.setAttribute('class', 'terminus-control-group');\n  form.appendChild(fd);\n  var inpLabel = document.createElement('label');\n  inpLabel.setAttribute('class', 'terminus-control-label');\n  inpLabel.setAttribute('for', 'basicinput');\n  inpLabel.innerHTML = 'Url:';\n  fd.appendChild(inpLabel);\n  var cd = document.createElement('div');\n  cd.setAttribute('class', 'terminus-controls');\n  fd.appendChild(cd);\n  var inpId = document.createElement('input');\n  inpId.setAttribute('type', 'text');\n  inpId.setAttribute('id', 'basicinput');\n  inpId.setAttribute('class', 'span8 terminus-input-text');\n  inpId.setAttribute('placeholder', 'URL : server_url');\n  if(this.val) inpId.value = this.val;\n  cd.appendChild(inpId);\n  var icon = document.createElement('i');\n  icon.setAttribute('class', 'fa fa-asterisk terminus-mandatory-icon');\n  cd.appendChild(icon);\n\n  var fd = document.createElement('div');\n  fd.setAttribute('class', 'terminus-control-group');\n  form.appendChild(fd);\n  var keyLabel = document.createElement('label');\n  keyLabel.setAttribute('class', 'terminus-control-label');\n  keyLabel.setAttribute('for', 'basicinput');\n  keyLabel.innerHTML = 'Key:';\n  fd.appendChild(keyLabel);\n  var cd = document.createElement('div');\n  cd.setAttribute('class', 'terminus-controls');\n  fd.appendChild(cd);\n  var key = document.createElement('input');\n  key.setAttribute('type', 'text');\n  key.setAttribute('id', 'basicinput');\n  key.setAttribute('class', 'span8 terminus-input-text');\n  key.setAttribute('placeholder', 'Key : key');\n  if(this.val) key.value = this.val;\n  cd.appendChild(key);\n\n  var button = document.createElement('button');\n  button.setAttribute('class', 'terminus-btn terminus-send-api-btn');\n  button.setAttribute('type', 'button');\n  button.innerHTML = 'Send Api';\n  var gatherips = function(){\n    var input = {};\n    input.url = inpId.value;\n    input.key = key.value;\n    return input;\n  }\n  var resd = document.createElement('div');\n  form.appendChild(button);\n  form.appendChild(resd);\n  var self = this;\n  button.addEventListener(\"click\", function(){\n    var buttonSelf = this;\n    opts = {};\n    var input = gatherips();\n    self.client.connect(input.url, input.key)\n    .then(function(response){\n      FrameHelper.removeChildren(resd);\n      var resultDom = UTILS.showHttpResult(response, 'connect', resd, self.ui);\n    });\n  }) // button click\n  return form;\n} // getServerForm()\n\n// get database api calls - on click of databaseAPI nav bar - submenus of database Api defined here\nApiExplorer.prototype.getDatabaseExplorer = function(cont){\n\n  var body = document.createElement('div');\n\n  // list view of Databse tools\n  var ul = document.createElement('ul');\n  ul.setAttribute('class','terminus-ul-horizontal');\n\n  //create db\n  var a = document.createElement('a');\n  a.setAttribute('class', 'terminus-a terminus-submenu-selected terminus-hz-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\n  var self = this;\n  a.addEventListener(\"click\", function(){\n      self.setSelectedSubMenu(this);\n      FrameHelper.removeChildren(body);\n      var dom = self.getDatabaseDom('create', body);\n      cont.appendChild(dom);\n  })\n  var icon = document.createElement('i');\n  icon.setAttribute('class', 'terminus-menu-icon fa fa-plus');\n  a.appendChild(icon);\n  var txt = document.createTextNode('Create database');\n  a.appendChild(txt);\n  ul.appendChild(a);\n\n  //delete db\n  var a = document.createElement('a');\n  a.setAttribute('class', 'terminus-a terminus-hz-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\n  var self = this;\n  a.addEventListener(\"click\", function(){\n      self.setSelectedSubMenu(this);\n      FrameHelper.removeChildren(body);\n      var dom = self.getDatabaseDom('delete', body);\n      cont.appendChild(dom);\n  })\n  var icon = document.createElement('i');\n  icon.setAttribute('class', 'terminus-menu-icon fa fa-trash-alt');\n  a.appendChild(icon);\n  var txt = document.createTextNode('Delete database');\n  a.appendChild(txt);\n  ul.appendChild(a);\n\n  cont.appendChild(ul);\n\n  // landing page\n  var dom = self.getDatabaseDom('create', body);\n  cont.appendChild(dom);\n\n  return cont;\n} // getDatabaseExplorer\n\n\n// get database dom\n ApiExplorer.prototype.getDatabaseDom = function(mode, body){\n  var self = this;\n\n  var br = document.createElement('BR');\n  body.appendChild(br);\n\n  // get signature\n  var b = this.getSignature(mode);\n  body.appendChild(b);\n\n  // get header Parameter\n  body.appendChild(UTILS.getHeaderDom('Parameters'));\n\n  var br = document.createElement('BR');\n  body.appendChild(br);\n\n  //form to get database id\n  if(mode == 'create') var form = this.getDBForm(mode);\n  else var form = this.getDBForm(mode);\n\n  body.appendChild(form);\n  return body;\n\n}// getDatabaseDom()\n\n//get create & delete db form\nApiExplorer.prototype.getDBForm = function(mode){\n  // form\n  var form = document.createElement('form');\n  form.setAttribute('class', 'terminus-form-horizontal row-fluid');\n\n  var fd = document.createElement('div');\n  fd.setAttribute('class', 'terminus-control-group');\n  form.appendChild(fd);\n  var inpLabel = document.createElement('label');\n  inpLabel.setAttribute('class', 'terminus-control-label');\n  inpLabel.setAttribute('for', 'basicinput');\n  inpLabel.innerHTML = 'Url:';\n  fd.appendChild(inpLabel);\n  var cd = document.createElement('div');\n  cd.setAttribute('class', 'terminus-controls');\n  fd.appendChild(cd);\n  var inpId = document.createElement('input');\n  inpId.setAttribute('type', 'text');\n  inpId.setAttribute('id', 'basicinput');\n  inpId.setAttribute('class', 'span8 terminus-input-text');\n  inpId.setAttribute('placeholder', 'URL : server/database_id');\n  if(this.val) inpId.value = this.val;\n  cd.appendChild(inpId);\n  var icon = document.createElement('i');\n  icon.setAttribute('class', 'fa fa-asterisk terminus-mandatory-icon');\n  cd.appendChild(icon);\n\n  if(mode == 'create'){\n    var fd = document.createElement('div');\n    fd.setAttribute('class', 'terminus-control-group');\n    form.appendChild(fd);\n    var inpLabel = document.createElement('label');\n    inpLabel.setAttribute('class', 'terminus-control-label');\n    inpLabel.setAttribute('for', 'basicinput');\n    inpLabel.innerHTML = 'Document:';\n    fd.appendChild(inpLabel);\n    var cd = document.createElement('div');\n    cd.setAttribute('class', 'terminus-controls');\n    fd.appendChild(cd);\n    var inpTxtAr = document.createElement('textarea');\n    inpTxtAr.setAttribute('type', 'text');\n    inpTxtAr.setAttribute('class', 'terminus-input-text');\n    inpTxtAr.setAttribute('placeholder', 'Enter document to create database');\n    cd.appendChild(inpTxtAr);\n    UTILS.stylizeEditor(this.ui, inpTxtAr, 'document', 'javascript');\n    var icon = document.createElement('i');\n    icon.setAttribute('class', 'fa fa-asterisk terminus-mandatory-icon');\n    cd.appendChild(icon);\n  } // if(mode == 'create')\n\n  var fd = document.createElement('div');\n  fd.setAttribute('class', 'terminus-control-group');\n  form.appendChild(fd);\n  var keyLabel = document.createElement('label');\n  keyLabel.setAttribute('class', 'terminus-control-label');\n  keyLabel.setAttribute('for', 'basicinput');\n  keyLabel.innerHTML = 'Key:';\n  fd.appendChild(keyLabel);\n  var cd = document.createElement('div');\n  cd.setAttribute('class', 'terminus-controls');\n  fd.appendChild(cd);\n  var inpKey = document.createElement('input');\n  inpKey.setAttribute('type', 'text');\n  inpKey.setAttribute('id', 'basicinput');\n  inpKey.setAttribute('class', 'terminus-input-text');\n  inpKey.setAttribute('placeholder', 'key');\n  cd.appendChild(inpKey);\n\n  var button = document.createElement('button');\n  button.setAttribute('class', 'terminus-btn terminus-send-api-btn');\n  button.setAttribute('type', 'button');\n  button.innerHTML = 'Send Api';\n  var gatherips = function(){\n    var input = {};\n    input.id = inpId.value;\n    input.doc = JSON.parse(inpTxtAr.value);\n    input.key = inpKey.value;\n    return input;\n  }\n  var self = this;\n  if(mode == 'create'){\n    button.addEventListener(\"click\", function(form){\n      var input = gatherips();\n      var buttonSelf = this;\n      self.client.createDatabase(input.id, input.doc, input.key)\n      .then(function(response){\n        var currForm = buttonSelf.parentNode;\n        var resultDom = UTILS.showHttpResult(response, 'create', currForm, self.ui);\n      });\n    }) // button click\n  } // if(mode == 'create')\n  else{\n    button.addEventListener(\"click\", function(){\n      var buttonSelf = this;\n      opts = {};\n      self.client.deleteDatabase(inpId.value, opts)\n      .then(function(response){\n        var currForm = buttonSelf.parentNode;\n        var resultDom = UTILS.showHttpResult(response, 'delete', currForm, self.ui);\n      });\n    }) // button click\n  } // if(mode == 'delete')\n  form.appendChild(button);\n  return form;\n} // getDBForm()\n\n// get query api dom\nApiExplorer.prototype.getQueryApiDom = function(action, body){\n\n  var br = document.createElement('BR');\n  body.appendChild(br);\n\n  // signature\n  var b = this.getSignature(action);\n  body.appendChild(b);\n\n  // get header Parameter\n  body.appendChild(UTILS.getHeaderDom('Parameters'));\n  var br = document.createElement('BR');\n  body.appendChild(br);\n\n  var form = document.createElement('form');\n  form.setAttribute('class', 'terminus-form-horizontal row-fluid');\n\n  var fd = document.createElement('div');\n  fd.setAttribute('class', 'terminus-control-group');\n  form.appendChild(fd);\n  var inpLabel = document.createElement('label');\n  inpLabel.setAttribute('class', 'terminus-control-label');\n  inpLabel.setAttribute('for', 'basicinput');\n  inpLabel.innerHTML = 'Url:';\n  fd.appendChild(inpLabel);\n  var cd = document.createElement('div');\n  cd.setAttribute('class', 'terminus-controls');\n  fd.appendChild(cd);\n  var inpId = document.createElement('input');\n  inpId.setAttribute('type', 'text');\n  inpId.setAttribute('id', 'basicinput');\n  inpId.setAttribute('class', 'span8 terminus-input-text');\n  inpId.setAttribute('placeholder', 'URL : server/database_id');\n  if (this.value) inpId.value = this.val;\n  cd.appendChild(inpId);\n  var icon = document.createElement('i');\n  icon.setAttribute('class', 'fa fa-asterisk terminus-mandatory-icon');\n  cd.appendChild(icon);\n  fd.appendChild(cd);\n\n  var fd = document.createElement('div');\n  fd.setAttribute('class', 'terminus-control-group');\n  form.appendChild(fd);\n  var inpLabel = document.createElement('label');\n  inpLabel.setAttribute('class', 'terminus-control-label');\n  inpLabel.setAttribute('for', 'basicinput');\n  inpLabel.innerHTML = 'Query:';\n  fd.appendChild(inpLabel);\n  var cd = document.createElement('div');\n  cd.setAttribute('class', 'terminus-controls');\n  fd.appendChild(cd);\n  var txtar = document.createElement('textarea');\n  if(this.value) txtar.value = this.val;\n  cd.appendChild(txtar);\n  txtar.setAttribute('class', 'terminus-api-explorer-text-area');\n  cd.appendChild(txtar);\n  fd.appendChild(cd);\n  UTILS.stylizeEditor(this.ui, txtar, 'query', 'javascript');\n  var br = document.createElement('BR');\n  fd.appendChild(br);\n\n  var button = document.createElement('button');\n  button.setAttribute('class', 'terminus-btn terminus-send-api-btn');\n  button.setAttribute('type', 'button');\n  button.innerHTML = 'Send Api';\n  var self = this;\n  button.addEventListener(\"click\", function(){\n    var buttonSelf = this;\n    var opts = {};\n    self.client.select(inpId.value, txtar.value, opts)\n    .then(function(response){\n      var currForm = buttonSelf.parentNode;\n      var resultDom = UTILS.showHttpResult(response, 'select', currForm, self.ui);\n    });\n  }) // button click\n  fd.appendChild(button);\n  body.appendChild(form);\n  return body;\n} // getQueryApiDom\n\nApiExplorer.prototype.getClassFramesForm = function(){\n    // form\n    var form = document.createElement('form');\n    form.setAttribute('class', 'terminus-form-horizontal row-fluid');\n    var fd = document.createElement('div');\n    fd.setAttribute('class', 'terminus-control-group');\n    form.appendChild(fd);\n    var inpLabel = document.createElement('label');\n    inpLabel.setAttribute('class', 'terminus-control-label');\n    inpLabel.setAttribute('for', 'basicinput');\n    inpLabel.innerHTML = 'Url:';\n    fd.appendChild(inpLabel);\n    var cd = document.createElement('div');\n    cd.setAttribute('class', 'terminus-controls');\n    fd.appendChild(cd);\n    var inpUrl = document.createElement('input');\n    inpUrl.setAttribute('type', 'text');\n    inpUrl.setAttribute('id', 'basicinput');\n    inpUrl.setAttribute('class', 'span8 terminus-input-text');\n    inpUrl.setAttribute('placeholder', 'URL : database_url');\n    if(this.val) inpUrl.value = this.val;\n    cd.appendChild(inpUrl);\n    var icon = document.createElement('i');\n    icon.setAttribute('class', 'fa fa-asterisk terminus-mandatory-icon');\n    cd.appendChild(icon);\n    var fd = document.createElement('div');\n    fd.setAttribute('class', 'terminus-control-group');\n    form.appendChild(fd);\n    var inpLabel = document.createElement('label');\n    inpLabel.setAttribute('class', 'terminus-control-label');\n    inpLabel.setAttribute('for', 'basicinput');\n    inpLabel.innerHTML = 'Url/ ID:';\n    fd.appendChild(inpLabel);\n    var cd = document.createElement('div');\n    cd.setAttribute('class', 'terminus-controls');\n    fd.appendChild(cd);\n    var inpDocUrl = document.createElement('input');\n    inpDocUrl.setAttribute('type', 'text');\n    inpDocUrl.setAttribute('id', 'basicinput');\n    inpDocUrl.setAttribute('class', 'span8 terminus-input-text');\n    inpDocUrl.setAttribute('placeholder', 'Url or ID of document class');\n    cd.appendChild(inpDocUrl);\n    var icon = document.createElement('i');\n    icon.setAttribute('class', 'fa fa-asterisk terminus-mandatory-icon');\n    cd.appendChild(icon);\n    var fd = document.createElement('div');\n    fd.setAttribute('class', 'terminus-control-group');\n    form.appendChild(fd);\n    var optLabel = document.createElement('label');\n    optLabel.setAttribute('class', 'terminus-control-label');\n    optLabel.setAttribute('for', 'basicinput');\n    optLabel.innerHTML = 'Options:';\n    fd.appendChild(optLabel);\n    var cd = document.createElement('div');\n    cd.setAttribute('class', 'terminus-controls');\n    fd.appendChild(cd);\n    var optInp = document.createElement('input');\n    optInp.setAttribute('type', 'text');\n    optInp.setAttribute('id', 'basicinput');\n    optInp.setAttribute('class', 'span8 terminus-input-text');\n    optInp.setAttribute('placeholder', 'options');\n    cd.appendChild(optInp);\n    var button = document.createElement('button');\n    button.setAttribute('class', 'terminus-btn terminus-send-api-btn');\n    button.setAttribute('type', 'button');\n    button.innerHTML = 'Send Api';\n    var gatherips = function(){\n        var input = {};\n        input.url = inpUrl.value;\n        input.docUrl = inpDocUrl.value;\n        input.options = optInp.value;\n        return input;\n    }\n    var self = this;\n    button.addEventListener(\"click\", function(form){\n      var input = gatherips();\n      var buttonSelf = this;\n      opts = {};\n      opts.explorer = true;\n      self.client.getClassFrame(input.url, input.docUrl, opts)\n      .then(function(response){\n          var currForm = buttonSelf.parentNode;\n          var resultDom = UTILS.showHttpResult(response, 'getClassFrames', currForm, self.ui);\n      });\n    }) // button click\n    form.appendChild(button);\n    return form;\n}\n\n// get schema & document dom\n ApiExplorer.prototype.getShowApiDom = function(action, body){\n   var self = this;\n\n   var br = document.createElement('BR');\n   body.appendChild(br);\n\n   // signature\n   var b = this.getSignature(action);\n   body.appendChild(b);\n\n   // get header Parameter\n   body.appendChild(UTILS.getHeaderDom('Parameters'));\n   var br = document.createElement('BR');\n   body.appendChild(br);\n\n   // get input\n   switch(action){\n     case 'getSchema':\n       // form to input schema url\n       var formDoc = document.createElement('form');\n       formDoc.setAttribute('class', 'terminus-form-horizontal row-fluid');\n\n       // schema url\n       var fd = document.createElement('div');\n       fd.setAttribute('class', 'terminus-control-group');\n       formDoc.appendChild(fd);\n       var inpLabel = document.createElement('label');\n       inpLabel.setAttribute('class', 'terminus-control-label');\n       inpLabel.setAttribute('for', 'basicinput');\n       inpLabel.innerHTML = 'Url:';\n       fd.appendChild(inpLabel);\n       var cd = document.createElement('div');\n       cd.setAttribute('class', 'terminus-controls');\n       fd.appendChild(cd);\n       var inpId = document.createElement('input');\n       inpId.setAttribute('type', 'text');\n       inpId.setAttribute('id', 'basicinput');\n       inpId.setAttribute('class', 'span8 terminus-input-text');\n       inpId.setAttribute('placeholder', 'URL : server/database_id');\n       cd.appendChild(inpId);\n       var icon = document.createElement('i');\n       icon.setAttribute('class', 'fa fa-asterisk terminus-mandatory-icon');\n       cd.appendChild(icon);\n\n       //encoding\n       var fd = document.createElement('div');\n       fd.setAttribute('class', 'terminus-control-group');\n       formDoc.appendChild(fd);\n       var encLabel = document.createElement('label');\n       encLabel.setAttribute('class', 'terminus-control-label');\n       encLabel.setAttribute('for', 'basicinput');\n       encLabel.innerHTML = 'Encoding:';\n       fd.appendChild(encLabel);\n       var cd = document.createElement('div');\n       cd.setAttribute('class', 'terminus-controls');\n       fd.appendChild(cd);\n       var inpEnc = document.createElement('select');\n       inpEnc.setAttribute('type', 'text');\n       inpEnc.setAttribute('placeholder', 'turtle');\n       var optTurt = document.createElement('option');\n       optTurt.setAttribute('value', 'terminus:turtle');\n       optTurt.appendChild(document.createTextNode('turtle'));\n       inpEnc.appendChild(optTurt);\n       var optJld = document.createElement('option');\n       optJld.setAttribute('value', 'terminus:jsonld');\n       optJld.appendChild(document.createTextNode('jsonLD'));\n       inpEnc.appendChild(optJld);\n       cd.appendChild(inpEnc);\n       var icon = document.createElement('i');\n       icon.setAttribute('class', 'fa fa-asterisk terminus-mandatory-icon');\n       cd.appendChild(icon);\n\n       var fd = document.createElement('div');\n       fd.setAttribute('class', 'terminus-control-group');\n       formDoc.appendChild(fd);\n       var keyLabel = document.createElement('label');\n       keyLabel.setAttribute('class', 'terminus-control-label');\n       keyLabel.setAttribute('for', 'basicinput');\n       keyLabel.innerHTML = 'Key:';\n       fd.appendChild(keyLabel);\n       var cd = document.createElement('div');\n       cd.setAttribute('class', 'terminus-controls');\n       fd.appendChild(cd);\n       var inpKey = document.createElement('input');\n       inpKey.setAttribute('type', 'text');\n       inpKey.setAttribute('id', 'basicinput');\n       inpKey.setAttribute('class', 'terminus-input-text');\n       inpKey.setAttribute('placeholder', 'Key');\n       cd.appendChild(inpKey);\n       var icon = document.createElement('i');\n       icon.setAttribute('class', 'fa fa-asterisk terminus-mandatory-icon');\n       cd.appendChild(icon);\n\n       // gather the dom objects\n       var gatherips = {};\n       gatherips.url = inpId;\n       gatherips.enc = inpEnc;\n       gatherips.key  = inpKey;\n\n       body.appendChild(formDoc);\n\n       //form to get schema\n       var form = this.getApiForm(action, gatherips);\n       body.appendChild(form);\n     break;\n     case 'getClassFrames':\n        var form = this.getClassFramesForm();\n        body.appendChild(form);\n     break;\n     case 'updateSchema':\n       // form to input schema url\n       var formDoc = document.createElement('form');\n       formDoc.setAttribute('class', 'terminus-form-horizontal row-fluid');\n\n       var fd = document.createElement('div');\n       fd.setAttribute('class', 'terminus-control-group');\n       formDoc.appendChild(fd);\n       // schema url\n       var fd = document.createElement('div');\n       fd.setAttribute('class', 'terminus-control-group');\n       formDoc.appendChild(fd);\n       var inpLabel = document.createElement('label');\n       inpLabel.setAttribute('class', 'terminus-control-label');\n       inpLabel.setAttribute('for', 'basicinput');\n       inpLabel.innerHTML = 'Url:';\n       fd.appendChild(inpLabel);\n       var cd = document.createElement('div');\n       cd.setAttribute('class', 'terminus-controls');\n       fd.appendChild(cd);\n       var inpId = document.createElement('input');\n       inpId.setAttribute('type', 'text');\n       inpId.setAttribute('id', 'basicinput');\n       inpId.setAttribute('class', 'span8 terminus-input-text');\n       inpId.setAttribute('placeholder', 'URL : server/database_id');\n       cd.appendChild(inpId);\n       var icon = document.createElement('i');\n       icon.setAttribute('class', 'fa fa-asterisk terminus-mandatory-icon');\n       cd.appendChild(icon);\n\n       //encoding\n       var fd = document.createElement('div');\n       fd.setAttribute('class', 'terminus-control-group');\n       formDoc.appendChild(fd);\n       var encLabel = document.createElement('label');\n       encLabel.setAttribute('class', 'terminus-control-label');\n       encLabel.setAttribute('for', 'basicinput');\n       encLabel.innerHTML = 'Encoding:';\n       fd.appendChild(encLabel);\n       var cd = document.createElement('div');\n       cd.setAttribute('class', 'terminus-controls');\n       fd.appendChild(cd);\n       var inpEnc = document.createElement('select');\n       inpEnc.setAttribute('type', 'text');\n       inpEnc.setAttribute('placeholder', 'turtle');\n       var optTurt = document.createElement('option');\n       optTurt.setAttribute('value', 'terminus:turtle');\n       optTurt.appendChild(document.createTextNode('turtle'));\n       inpEnc.appendChild(optTurt);\n       var optJld = document.createElement('option');\n       optJld.setAttribute('value', 'terminus:jsonld');\n       optJld.appendChild(document.createTextNode('jsonLD'));\n       inpEnc.appendChild(optJld);\n       cd.appendChild(inpEnc);\n       var icon = document.createElement('i');\n       icon.setAttribute('class', 'fa fa-asterisk terminus-mandatory-icon');\n       cd.appendChild(icon);\n\n       var fd = document.createElement('div');\n       fd.setAttribute('class', 'terminus-control-group');\n       formDoc.appendChild(fd);\n       var schLabel = document.createElement('label');\n       schLabel.setAttribute('class', 'terminus-control-label');\n       schLabel.setAttribute('for', 'basicinput');\n       schLabel.innerHTML = 'Schema:';\n       fd.appendChild(schLabel);\n       var cd = document.createElement('div');\n       cd.setAttribute('class', 'terminus-controls');\n       fd.appendChild(cd);\n       var schDoc = document.createElement('textarea');\n       cd.appendChild(schDoc);\n       schDoc.setAttribute('class', 'terminus-api-explorer-text-area');\n       stylizeEditor(this.ui, schDoc, 'schema', 'turtle');\n\n       var fd = document.createElement('div');\n       fd.setAttribute('class', 'terminus-control-group');\n       formDoc.appendChild(fd);\n       var keyLabel = document.createElement('label');\n       keyLabel.setAttribute('class', 'terminus-control-label');\n       keyLabel.setAttribute('for', 'basicinput');\n       keyLabel.innerHTML = 'Key:';\n       fd.appendChild(keyLabel);\n       var cd = document.createElement('div');\n       cd.setAttribute('class', 'terminus-controls');\n       fd.appendChild(cd);\n\n       var inpKey = document.createElement('input');\n       inpKey.setAttribute('type', 'text');\n       inpKey.setAttribute('id', 'basicinput');\n       inpKey.setAttribute('class', 'terminus-input-text');\n       inpKey.setAttribute('placeholder', 'Key');\n       cd.appendChild(inpKey);\n       var icon = document.createElement('i');\n       icon.setAttribute('class', 'fa fa-asterisk terminus-mandatory-icon');\n       cd.appendChild(icon);\n\n       // gather the dom objects\n       var gatherips = {};\n       gatherips.url = inpId;\n       gatherips.enc = inpEnc;\n       gatherips.key = inpKey;\n       gatherips.doc = schDoc;\n\n       //form to update schema\n       var form = this.getApiForm(action, gatherips);\n       body.appendChild(formDoc);\n       body.appendChild(form);\n     break;\n     case 'viewDocument':\n       // form\n       var formDoc = document.createElement('form');\n       formDoc.setAttribute('class', 'terminus-form-horizontal row-fluid');\n\n       var fd = document.createElement('div');\n       fd.setAttribute('class', 'terminus-control-group');\n       formDoc.appendChild(fd);\n       var inpLabel = document.createElement('label');\n       inpLabel.setAttribute('class', 'terminus-control-label');\n       inpLabel.setAttribute('for', 'basicinput');\n       inpLabel.innerHTML = 'Url:';\n       fd.appendChild(inpLabel);\n       var cd = document.createElement('div');\n       cd.setAttribute('class', 'terminus-controls');\n       fd.appendChild(cd);\n       var inpId = document.createElement('input');\n       inpId.setAttribute('type', 'text');\n       inpId.setAttribute('id', 'basicinput');\n       inpId.setAttribute('class', 'span8 terminus-input-text');\n       inpId.setAttribute('placeholder', 'URL : server/database_id/document/document_id');\n       cd.appendChild(inpId);\n       var icon = document.createElement('i');\n       icon.setAttribute('class', 'fa fa-asterisk terminus-mandatory-icon');\n       cd.appendChild(icon);\n\n       body.appendChild(formDoc);\n\n       var form = this.getApiForm(action, inpId);\n\n       body.appendChild(form);\n\n     break;//viewDocument\n     case 'deleteDocument':\n       // form\n       var formDoc = document.createElement('form');\n       formDoc.setAttribute('class', 'terminus-form-horizontal row-fluid');\n\n       var fd = document.createElement('div');\n       fd.setAttribute('class', 'terminus-control-group');\n       formDoc.appendChild(fd);\n       var inpLabel = document.createElement('label');\n       inpLabel.setAttribute('class', 'terminus-control-label');\n       inpLabel.setAttribute('for', 'basicinput');\n       inpLabel.innerHTML = 'Url:';\n       fd.appendChild(inpLabel);\n       var cd = document.createElement('div');\n       cd.setAttribute('class', 'terminus-controls');\n       fd.appendChild(cd);\n       var inpId = document.createElement('input');\n       inpId.setAttribute('type', 'text');\n       inpId.setAttribute('id', 'basicinput');\n       inpId.setAttribute('class', 'span8 terminus-input-text');\n       inpId.setAttribute('placeholder', 'URL : server/database_id/document/document_id');\n       cd.appendChild(inpId);\n       var icon = document.createElement('i');\n       icon.setAttribute('class', 'fa fa-asterisk terminus-mandatory-icon');\n       cd.appendChild(icon);\n\n       body.appendChild(formDoc);\n\n       var form = this.getApiForm(action, inpId);\n\n       body.appendChild(form);\n     break;\n     case 'createDocument':\n       // form to input schema url\n       var formDoc = document.createElement('form');\n       formDoc.setAttribute('class', 'terminus-form-horizontal row-fluid');\n\n       var fd = document.createElement('div');\n       fd.setAttribute('class', 'terminus-control-group');\n       formDoc.appendChild(fd);\n       var inpLabel = document.createElement('label');\n       inpLabel.setAttribute('class', 'terminus-control-label');\n       inpLabel.setAttribute('for', 'basicinput');\n       inpLabel.innerHTML = 'Url:';\n       fd.appendChild(inpLabel);\n       var cd = document.createElement('div');\n       cd.setAttribute('class', 'terminus-controls');\n       fd.appendChild(cd);\n       var inpId = document.createElement('input');\n       inpId.setAttribute('type', 'text');\n       inpId.setAttribute('id', 'basicinput');\n       inpId.setAttribute('class', 'span8 terminus-input-text');\n       inpId.setAttribute('placeholder', 'URL : server/database_id/document/document_id');\n       cd.appendChild(inpId);\n       var icon = document.createElement('i');\n       icon.setAttribute('class', 'fa fa-asterisk terminus-mandatory-icon');\n       cd.appendChild(icon);\n\n       body.appendChild(formDoc);\n\n       var br = document.createElement('BR');\n       body.appendChild(br);\n\n       // text area\n       var formDoc = document.createElement('form');\n       formDoc.setAttribute('class', 'terminus-form-horizontal row-fluid');\n\n       var fd = document.createElement('div');\n       fd.setAttribute('class', 'terminus-control-group');\n       formDoc.appendChild(fd);\n       var inpLabel = document.createElement('label');\n       inpLabel.setAttribute('class', 'terminus-control-label');\n       inpLabel.setAttribute('for', 'basicinput');\n       inpLabel.innerHTML = 'Document:';\n       fd.appendChild(inpLabel);\n       var cd = document.createElement('div');\n       cd.setAttribute('class', 'terminus-controls');\n       fd.appendChild(cd);\n       var txtar = document.createElement('textarea');\n       cd.appendChild(txtar);\n       txtar.setAttribute('class', 'terminus-api-explorer-text-area');\n       UTILS.stylizeEditor(this.ui, txtar, 'document', 'javascript');\n\n       /*var editor = codeMirrorFormat(txtar, 'javascript', true);\n       // refresh load\n       setTimeout(function() {\n           editor.refresh();\n       },1);\n       // save changes of code mirror editor\n       function updateTextArea() {\n         editor.save();\n       }\n       editor.on('change', updateTextArea); */\n\n        body.appendChild(formDoc);\n\n        var br = document.createElement('BR');\n        body.appendChild(br);\n\n        // gather the dom objects\n        var gatherips = {};\n        gatherips.schemaUrlDom =  inpId;\n        gatherips.schemaTextDom =  txtar;\n        gatherips.htmlEditor =  editor;\n\n        //form to update schema\n        var form = this.getApiForm(action, gatherips);\n        body.appendChild(form);\n\n     break;\n     case 'updateDocument':\n       // form to input schema url\n       var formDoc = document.createElement('form');\n       formDoc.setAttribute('class', 'terminus-form-horizontal row-fluid');\n\n       var fd = document.createElement('div');\n       fd.setAttribute('class', 'terminus-control-group');\n       formDoc.appendChild(fd);\n       var inpLabel = document.createElement('label');\n       inpLabel.setAttribute('class', 'terminus-control-label');\n       inpLabel.setAttribute('for', 'basicinput');\n       inpLabel.innerHTML = 'Url:';\n       fd.appendChild(inpLabel);\n       var cd = document.createElement('div');\n       cd.setAttribute('class', 'terminus-controls');\n       fd.appendChild(cd);\n       var inpId = document.createElement('input');\n       inpId.setAttribute('type', 'text');\n       inpId.setAttribute('id', 'basicinput');\n       inpId.setAttribute('class', 'span8 terminus-input-text');\n       inpId.setAttribute('placeholder', 'URL : server/database_id/document/document_id');\n       cd.appendChild(inpId);\n       var icon = document.createElement('i');\n       icon.setAttribute('class', 'fa fa-asterisk terminus-mandatory-icon');\n       cd.appendChild(icon);\n\n       body.appendChild(formDoc);\n\n       var br = document.createElement('BR');\n       body.appendChild(br);\n\n       // text area\n       var formDoc = document.createElement('form');\n       formDoc.setAttribute('class', 'terminus-form-horizontal row-fluid');\n\n       var fd = document.createElement('div');\n       fd.setAttribute('class', 'terminus-control-group');\n       formDoc.appendChild(fd);\n       var inpLabel = document.createElement('label');\n       inpLabel.setAttribute('class', 'terminus-control-label');\n       inpLabel.setAttribute('for', 'basicinput');\n       inpLabel.innerHTML = 'Document:';\n       fd.appendChild(inpLabel);\n       var cd = document.createElement('div');\n       cd.setAttribute('class', 'terminus-controls');\n       fd.appendChild(cd);\n       var txtar = document.createElement('textarea');\n       cd.appendChild(txtar);\n       txtar.setAttribute('class', 'terminus-api-explorer-text-area');\n       UTILS.stylizeEditor(this.ui, txtar, 'document', 'turtle');\n\n       body.appendChild(formDoc);\n\n       var br = document.createElement('BR');\n       body.appendChild(br);\n\n       // gather the dom objects\n       var gatherips = {};\n       gatherips.schemaUrlDom =  inpId;\n       gatherips.schemaTextDom =  txtar;\n       gatherips.htmlEditor =  editor;\n\n       //form to update schema\n       var form = this.getApiForm(action, gatherips);\n       body.appendChild(form);\n\n     break;\n   }// switch(action)\n\n   return body;\n } // getShowApiDom()\n\n// define event listeners on send api of schema & documents\nApiExplorer.prototype.getApiForm = function(action, input){\n  // form\n  var form = document.createElement('form');\n  form.setAttribute('class', 'terminus-form-horizontal row-fluid');\n\n  var button = document.createElement('button');\n  button.setAttribute('class', 'terminus-btn terminus-send-api-btn');\n  button.setAttribute('type', 'button');\n  button.innerHTML = 'Send Api';\n  form.appendChild(button);\n  var resd = document.createElement('div');\n  form.appendChild(resd);\n  var self = this;\n  switch(action){\n    case 'getSchema':\n      button.addEventListener(\"click\", function(){\n        var opts = {};\n        opts['terminus:encoding'] = input.enc.value;\n        opts['terminus:user_key'] = input.key.value;\n        var schurl = input.url.value;\n        var buttonSelf = this;\n        self.client.getSchema(schurl, opts)\n        .then(function(response){\n          FrameHelper.removeChildren(resd);\n          var resultDom = UTILS.showHttpResult(response, 'getSchema', resd, self.ui);\n        });\n      }) // button click\n    break;\n    case 'updateSchema':\n      button.addEventListener(\"click\", function(){\n        var buttonSelf = this;\n        opts = {};\n        opts['terminus:encoding'] = input.enc.value;\n        opts['terminus:user_key'] = input.key.value;\n        var schurl = input.url.value;\n        console.log('opts', opts);\n        self.client.connectionConfig.connected_mode = false;\n        self.client.updateSchema(schurl, input.doc.value, opts)\n        .then(function(response){\n          var gtxtar = document.createElement('textarea');\n          gtxtar.setAttribute('readonly', true);\n          gtxtar.innerHTML = response;\n          var currForm = buttonSelf.parentNode;\n          currForm.appendChild(gtxtar);\n          UTILS.stylizeEditor(this.ui, txtar, 'schema', 'turtle');\n        });\n      }) // button click\n    break;\n    case 'viewDocument':\n      button.addEventListener(\"click\", function(){\n      var dcurl = input.value;\n      var buttonSelf = this;\n      var opts = {};\n      opts.format = 'turtle';\n      self.client.getDocument(dcurl, opts)\n      .then(function(response){\n        FrameHelper.removeChildren(resd);\n        var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\n      });\n    }) // button click\n    break;\n    case 'deleteDocument':\n      button.addEventListener(\"click\", function(){\n      var dcurl = input.value;\n      var buttonSelf = this;\n      var opts = {};\n      self.client.deleteDocument(dcurl, opts)\n      .then(function(response){\n        FrameHelper.removeChildren(resd);\n        var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\n      });\n    }) // button click\n    break;\n    case 'createDocument':\n      button.addEventListener(\"click\", function(){\n        var dcurl = input.schemaUrlDom.value;\n        var payload = input.htmlEditor.getValue();\n        var buttonSelf = this;\n        opts = {};\n        self.client.createDocument(dcurl, payload, opts)\n        .then(function(response){\n          FrameHelper.removeChildren(resd);\n          var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\n        });\n      }) // button click\n    break;\n    case 'updateDocument':\n      button.addEventListener(\"click\", function(){\n        var dcurl = input.schemaUrlDom.value;\n        var payload = input.htmlEditor.getValue();\n        var buttonSelf = this;\n        opts = {};\n        opts.editmode = 'replace';\n        opts.format = 'json';\n        self.client.updateDocument(dcurl, payload, opts)\n        .then(function(response){\n          FrameHelper.removeChildren(resd);\n          var resultDom = UTILS.showHttpResult(response, action, resd, self.ui);\n        });\n      }) // button click\n    break;\n  } // switch(action)\n\n  var br = document.createElement('BR');\n  form.appendChild(br);\n  var br = document.createElement('BR');\n  form.appendChild(br);\n\n  return form;\n} // getApiForm()\n\n// get signature of api calls\nApiExplorer.prototype.getSignature = function(action){\n    var api = document.createElement('div');\n\n    // get header signature\n    var sg = document.createElement('button');\n    sg.appendChild(document.createTextNode('Click to read Api Signature'));\n    sg.setAttribute('class', 'terminus-collapsible');\n    ic = document.createElement('i');\n    ic.setAttribute('class', 'terminus-cheveron-float fa fa-chevron-down');\n    sg.appendChild(ic);\n    api.appendChild(sg);\n\n    var br = document.createElement('BR');\n    api.appendChild(br);\n\n    var cl = document.createElement('div');\n    cl.setAttribute('class', 'terminus-collapsible-content content');\n\n    var sig = UTILS.getFunctionSignature(action);\n    var txt = document.createTextNode(sig.spec);\n    var pre = document.createElement('pre');\n    pre.setAttribute('class', 'terminus-api-signature-pre');\n    pre.appendChild(txt);\n    var txt =  document.createTextNode(sig.descr);\n    pre.appendChild(txt);\n    var br = document.createElement('BR');\n    pre.appendChild(br);\n    var br = document.createElement('BR');\n    pre.appendChild(br);\n    var txt = document.createTextNode(sig.result);\n    pre.appendChild(txt);\n    cl.appendChild(pre);\n    api.appendChild(cl);\n    var br = document.createElement('BR');\n    api.appendChild(br);\n\n    sg.addEventListener('click', function(){\n        UTILS.tolggleContent(ic, cl);\n    });\n\n    return api;\n} // getSignature()\n\n// displays signature only on click\nfunction tolggleSignatureContent(content){\n    if (content.style.display === \"block\")\n        content.style.display = \"none\";\n    else content.style.display = \"block\";\n}\n\nmodule.exports=ApiExplorer\n","function Codemirror(text, format, config){\n  this.textdom = text;\n  this.mode = format;\n  this.darkMode = config.darkMode;\n  if(this.jsonldCheck(format)) this.mode = 'javascript';\n}\n\n/*\ntxtar    : editor is attached to textar\nmode     : format for highlighting, ex: json, html etc.\neditable : readOnly false/ nocursor is special value in code editor to set readonly true */\nCodemirror.prototype.colorizeTextArea = function(mode){\n  //initize auto complete\n  /*CodeMirror.commands.autocomplete = function(cm) {\n    cm.showHint({hint: CodeMirror.hint.anyword});\n  }*/\n\n  // initialise code editor on text area\n  var editor = CodeMirror.fromTextArea(this.textdom, {\n    mode                : this.mode,\n    firstLineNumber     : 1,\n    lineNumbers         : true,\n    styleActiveLine     : true,\n    lineWrapping        : true,\n    smartIndent         : true,\n    indentWithTabs      : true,\n    newlineAndIndent    : true,\n    autoCloseBrackets   : true,\n    matchBrackets       : {afterCursor: true},\n    extraKeys           : {\"Ctrl-F\": \"find\", \"Tab\": \"autocomplete\" },\n    refresh             : true\n   });\n\n   this.setCodemirrorSize(editor, mode);\n   editor.defaultCharWidth('20px');\n   if(this.darkMode) editor.setOption(\"theme\", 'erlang-dark');\n   else editor.setOption(\"theme\", 'neo');\n\n   return editor;\n} // colorizeTextArea()\n\n/*\n  set editor size according to screens\n  editor : code mirror editor Object\n  mode   : editor being viewed from schema/ doc/ query page*/\nCodemirror.prototype.setCodemirrorSize = function(editor, mode){\n  switch(mode){\n    case 'query':\n      editor.setSize('', '300');\n    break;\n    case 'schema':\n      editor.setSize('1200', '1550');\n    break;\n    case 'document':\n     editor.setSize('800', 'auto');\n    break;\n  } // switch(mode)\n} // setCodemirrorSize()\n\n// updateTextArea(): highlights new changes on editor\nCodemirror.prototype.updateTextArea = function(editor){\n  editor.save();\n  setTimeout(function() {\n      editor.refresh();\n  },1);\n  // save changes of code mirror editor\n  editor.on('change', function(){\n    editor.save();\n  });\n} //updateTextArea()\n\n/*\ncolorizePre() to colorise pre tags (read only mode)\ntext (string)    : The document to run through the highlighter.\nmode (mode spec) : format to highlight color\noutput (DOM node): The tokens will be converted to spans as in an editor,\n                   and inserted into the node (through innerHTML).*/\nCodemirror.prototype.colorizePre = function(){\n  CodeMirror.runMode(this.textdom.innerText, this.mode, this.textdom);\n  if(this.darkMode)\n    var theme = 'cm-s-erlang-dark';\n  else var theme = 'cm-s-neo';\n  this.textdom.setAttribute('class', 'CodeMirror CodeMirror-wrap ' + theme + ' terminus-wrap-text terminus-wrapper-height ');\n  return this.textdom;\n} // colorizePre()\n\nCodemirror.prototype.jsonldCheck = function(format){\n  if(format == 'jsonld') return true;\n}\n\nmodule.exports=Codemirror\n","/**\n * Represents a frame for visualising a specific object frame, anywhere within a document \n * Recursive data structure where this.children contains an indexed array of object frames\n * and this.dataframes contains a property indexed array of data frames\n * Every object frame carries a reference to its classframe\n * This gives us instructions as to how to create new frames according to the schema\n * After that it's turtles all the way down. \n * @param cls - ID of the class (URL)\n * @param classframe - an array of frames representing a class\n * @param archetypes list of class frames\n * @param parent parent object\n * @returns\n */\nconst FrameHelper = require('./FrameHelper');\n\nfunction ObjectFrame(cls, dataframes, classframes, parent, parentframe) {\n\t//the class of the frame - mandatory \n\tthis.empty();\n\tthis.cls = cls;\n\t\n\t//array of frames representing the full class frame (optional - required to be able to safely add missing properties)\n\tif(classframes && typeof classframes == \"object\"){\n\t\tthis.loadClassFrames(classframes);\n\t}\n\tif(dataframes && typeof dataframes == \"object\"){\n\t\tthis.originalFrames = dataframes;\n\t\tthis.loadDataFrames(dataframes);\n\t}\n\telse {\n\t\tthis.originalFrames = false;\n\t}\n\t//parent object frame\n\tthis.parent = parent;\n\t//original frame used by parent to create me\n\tthis.parentframe = parentframe;\n\t//set to true if this is a newly created document\n\tthis.newDoc = false;\n}\n\nObjectFrame.prototype.getAsFrame = function(prop, parent){\n\tif(this.parentframe) return this.parentframe;\n\tvar ff = { type: \"objectProperty\", property: prop};\n\tff.range = this.cls;\n\tff.domain = parent.cls;\n\tff.domainValue = parent.subjid;\n\tff.frame = [];\n\tfor(var prop in this.dataframes){\n\t\tfor(var i = 0; i<this.dataframes[prop].length; i++){\n\t\t\tff.frame.push(this.dataframes[prop][i].getAsFrame());\n\t\t}\n\t}\n\tfor(var prop in this.children){\n\t\tfor(var i = 0; i<this.children[prop].length; i++){\n\t\t\tff.frame.push(this.children[prop][i].getAsFrame(prop, this));\n\t\t}\n\t}\n\treturn ff;\n\t\n}\n\n\nObjectFrame.prototype.isnew = function(){\n\treturn this.newDoc;\n}\n\n/**\n * Cleans out object and sets everything empty\n */\nObjectFrame.prototype.empty = function(){\n\t//all indexed by property\n\tthis.classframes = {};\n\tthis.dataframes = {};\n\tthis.restrictions = {};\n\tthis.children = {};\n\tthis.subjid = false;\n\tthis.cls = false;\n}\n\n/*\n * Resets object state to original state\n */\nObjectFrame.prototype.reset = function(prop){\n\tif(prop){\n\t\tvar props = [];\n\t\tfor(var i = 0; i<this.originalFrames.length; i++){\n\t\t\tif(this.originalFrames[i].property == prop){\n\t\t\t\tprops.push(this.originalFrames[i]);\n\t\t\t}\n\t\t}\n\t\tif(this.children[prop]) this.children[prop] = [];\n\t\tif(this.dataframes[prop]) this.dataframes[prop] = [];\n\t\tthis.loadDataFrames(props);\n\t}\n\telse {\n\t\tthis.dataframes = {};\n\t\tthis.restrictions = {};\n\t\tthis.children = {};\t\t\t\n\t\tthis.loadDataFrames(this.originalFrames)\n\t}\n}\n\n/*\n * Clears out any specific information from a tree\n */\nObjectFrame.prototype.clear = function(){\n\tthis.clearData();\n\tvar newkids = {};\n\tfor(var prop in this.children){\n\t\t//change all the object ids in the \n\t\tfor(var i = 0; i<this.children[prop].length; i++){\n\t\t\tif(typeof newkids[prop] == \"undefined\") newkids[prop] = [];\n\t\t\tthis.children[prop][i].subjid = FrameHelper.genBNID();\n\t\t\tthis.children[prop][i].clear();\n\t\t}\n\t}\n\treturn this;\n}\n\n/**\n * Empties out all of the object's dataframes\n */\nObjectFrame.prototype.clearData = function(){\n\tfor(var prop in this.dataframes){\n\t\tfor(var i = 0; i< this.dataframes[prop].length; i++){\n\t\t\tthis.dataframes[prop][i].clear();\n\t\t}\n\t}\n\treturn this;\n}\n\n/**\n * Loads class frames for the object's class - the instructions about how to put an object together\n */\nObjectFrame.prototype.loadClassFrames = function(classframes){\n\tfor(var j = 0; j< classframes.length; j++){\n\t\tif(classframes[j][\"@context\"]) this.jsonld_context = classframes[j][\"@context\"];\n\t\tvar cf = new ClassFrame(classframes[j]);\n\t\tif(cf.isValid()){\n\t\t\tif(typeof this.classframes[classframes[j].property] == \"undefined\"){\n\t\t\t\tthis.classframes[classframes[j].property] = [];\t\t\t\t\t\n\t\t\t}\n\t\t\tthis.classframes[classframes[j].property] = cf;\n\t\t\tif(cf.isObject() && this.children[classframes[j].property]){\n\t\t\t\tfor(var i = 0; i<this.children[classframes[j].property].length; i++){\n\t\t\t\t\tthis.children[classframes[j].property][i].loadClassFrames(classframes[j].frame);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\treturn this;\n}\n\n/**\n * Does this object have a schema loaded?\n */\nObjectFrame.prototype.hasSchema = function(){\n\treturn ! FrameHelper.empty(this.classframes);\n}\n\n/*\n * Loads an array of data frames into the object's internal index\n * {property: [frames]}\n */\nObjectFrame.prototype.loadDataFrames = function(frames){\n\tif(typeof frames != 'object' || !frames.length) return;\n\tif(!this.originalFrames) this.originalFrames = frames;\n\tif(!this.subjid && frames[0].domainValue) this.subjid = frames[0].domainValue;\n\tfor(var i = 0; i<frames.length; i++){\n\t\tif(frames[i][\"@context\"]) this.jsonld_context = frames[i][\"@context\"];\n\t\tvar cframe = this.getPropertyClassFrame(frames[i].property, frames[i]);\n\t\tif(cframe.isClassChoice()){\n\t\t\tcframe = cframe.getChosenClassFrame(frames[i].range);\n\t\t\tif(!cframe) {\n\t\t\t\talert(\"no choice frame \" + frames[i].range);\n\t\t\t}\n\t\t}\n\t\telse if(cframe.isLogic()){\n\t\t\tcframe = cframe.getChosenFrame(frames[i]);\t\t\n\t\t}\n\t\tif(cframe && cframe.isData()){\n\t\t\tvar df = new DataFrame(frames[i], this);\n\t\t\tif(typeof this.dataframes[frames[i].property] == \"undefined\"){\n\t\t\t\tthis.dataframes[frames[i].property] = [];\n\t\t\t}\n\t\t\tthis.dataframes[frames[i].property].push(df);\t\t\t\n\t\t}\n\t\telse if(cframe && cframe.isObject()){\n\t\t\tvar kid = new ObjectFrame(cframe.range, cframe.frame, frames[i].frame, this, frames[i]);\n\t\t\tif(typeof this.children[frames[i].property] == \"undefined\"){\n\t\t\t\tthis.children[frames[i].property] = [];\n\t\t\t}\n\t\t\tthis.children[frames[i].property].push(kid);\t\t\t\t\n\t\t}\n\t}\n\treturn this;\n}\n\n\nObjectFrame.prototype.matchesPattern = function(matching, pattern){\n\tif(matching.action != pattern.action) return false;\n\tif(pattern.type == \"value\" && typeof matching.value != \"undefined\"){\n\t\t//if(pattern.pattern)\n\t}\n\tif(pattern.type == \"property\" && (typeof matching.value == \"undefined\" && typeof matching.property != \"undefined\" )){ \n\t\t\n\t}\n\tif(pattern.type == \"object\" && (typeof matching.value != \"undefined\" || typeof matching.property != \"undefined\" )){ \n\t\t\n\t}\n\treturn false;\n}\n\nObjectFrame.prototype.compare = function(pat){\n\t//if(pat.range && pat.range != this.range) return false;\n\tif(pat.domain && pat.domain != this.cls) return false;\n} \n\n/**\n * If a class frame is present, it is returned for the given property\n * If no class frame is present and an instance frame is passed in the \n * this enables make it up as you go along editing\n * second argument a class frame will be created from the instance frame. \n */\nObjectFrame.prototype.getPropertyClassFrame = function(prop, instance){\n\tif(this.classframes && typeof this.classframes == \"object\" && typeof this.classframes[prop] == \"object\"){\n\t\treturn this.classframes[prop];\n\t}\n\tif(instance){\n\t\tvar cf = new ClassFrame(instance);\n\t\treturn cf;\n\t}\n\tif(this.dataframes && this.dataframes[prop]){\n\t\treturn this.dataframes[prop][0];\n\t}\n\tif(this.children && this.children[prop]){\n\t\tvar basis = this.children[prop][0].parentframe;\n\t\tif(basis){\n\t\t\tvar cf = new ClassFrame(basis);\n\t\t\treturn cf;\n\t\t}\n\t}\t\n\treturn false;\n}\n\n/**\n * Missing properties are those that are present in the classframe, \n * but not instantiated in the current object frame\n * for this to work we need to load the frame with the associated classframe\n */\nObjectFrame.prototype.getMissingPropertyList = function(){\n\tvar missing = [];\n\tif(this.classframes && typeof this.classframes == \"object\" ){\n\t\tfor(var prop in this.classframes){\n\t\t\tif(!(this.dataframes[prop] || this.children[prop])){\n\t\t\t\tvar cframe = this.getPropertyClassFrame(prop);\n\t\t\t\tvar newb = { label: cframe.getLabel(), value: prop};\n\t\t\t\tmissing.push(newb);\n\t\t\t}\n\t\t}\n\t}\n\treturn missing;\n}\n\n/**\n * List of properties that are filled in the object\n */\nObjectFrame.prototype.getFilledPropertyList = function(){\n\tvar filled = [];\n\tfor(var prop in this.dataframes){\n\t\tvar cframe = this.getPropertyClassFrame(prop);\n\t\tvar newb = { label: cframe.getLabel(), value: prop};\n\t\tfilled.push(newb);\n\t}\t\t\t\n\tfor(var prop in this.children){\n\t\tvar cframe = this.getPropertyClassFrame(prop);\n\t\tvar newb = { label: cframe.getLabel(), value: prop};\n\t\tfilled.push(newb);\n\t}\t\t\t\n\treturn filled;\n}\n\nObjectFrame.prototype.fillFromSchema = function(newid){\n\tif(newid) this.subjid = newid;\n\tvar dataframes = {};\n\tvar children = {};\n\tfor(var prop in this.classframes){\n\t\tvar pf = this.getPropertyClassFrame(prop);\n\t\tif(pf && pf.isData()){\n\t\t\tif(pf.hasRestriction() && pf.restriction.min){\n\t\t\t\tdataframes[prop] = [];\n\t\t\t\tfor(var i = 0; i < pf.restriction.min; i++){\n\t\t\t\t\tdataframes[prop].push(pf.createEmpty(newid));\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tdataframes[prop] = [pf.createEmpty(newid)];\n\t\t\t}\n\t\t}\n\t\telse if(pf && pf.isObject() && !pf.isClassChoice()){\n\t\t\tif(pf.hasRestriction() && pf.restriction.min){\n\t\t\t\tchildren[prop] = [];\n\t\t\t\tfor(var i = 0; i < pf.restriction.min; i++){\n\t\t\t\t\tvar empty = pf.createEmpty(FrameHelper.genBNID());\n\t\t\t\t\tchildren[prop].push(empty);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tvar empty = pf.createEmpty(FrameHelper.genBNID());\n\t\t\t\tchildren[prop] = [empty];\n\t\t\t}\n\t\t}\n\t\telse if(pf.isClassChoice()){\n\t\t\tvar clss = pf.getClassChoices();\n\t\t\tif(clss && clss.length){\n\t\t\t\tvar empty = pf.createEmptyChoice(clss[0], FrameHelper.genBNID())\n\t\t\t\tchildren[prop] = [empty];\n\t\t\t}\n\t\t}\n\t}\n\tthis.dataframes = dataframes;\n\tthis.children = children;\n\tthis.originalFrames = [];\n\tfor(var prop in this.dataframes){\n\t\tfor(var i = 0; i<this.dataframes[prop].length; i++){\n\t\t\tthis.originalFrames.push(this.dataframes[prop][i].getAsFrame());\n\t\t}\n\t}\n\tfor(var prop in this.children){\n\t\tfor(var i = 0; i<this.children[prop].length; i++){\n\t\t\tthis.originalFrames.push(this.children[prop][i].getAsFrame(prop, this));\n\t\t}\n\t}\n\treturn this;\n}\n\nObjectFrame.prototype.clone = function(newid){\n\tvar dataframes = {};\n\tvar children = {};\n\tvar cloned = new ObjectFrame(this.cls, false, false, this.parent);\n\tcloned.classframes = this.classframes;\n\tcloned.subjid = newid;\n\tif(this.dataframes && typeof this.dataframes == \"object\"){\n\t\tfor(var prop in this.dataframes){\n\t\t\tvar pf = this.getPropertyClassFrame(prop);\n\t\t\tif(pf.isData()){\n\t\t\t\tdataframes[prop] = [];\n\t\t\t\tfor(var i = 0; i<this.dataframes[prop].length; i++){\n\t\t\t\t\tvar clonedval = pf.clone(newid, this.dataframes[prop][i]);\n\t\t\t\t\tdataframes[prop].push(clonedval);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tif(this.children && typeof this.children == \"object\"){\n\t\tfor(prop in this.children){\n\t\t\tvar pf = this.getPropertyClassFrame(prop);\n\t\t\tfor(var i = 0; i<this.children[prop].length; i++){\n\t\t\t\tvar kid = this.children[prop][i];\n\t\t\t\tif(typeof children[prop] == \"undefined\") children[prop] = [];\n\t\t\t\tvar kidclone = kid.clone(FrameHelper.genBNID());\n\t\t\t\tchildren[prop].push(kidclone)\n\t\t\t}\n\t\t}\n\t}\n\tcloned.dataframes = dataframes;\n\tcloned.children = children;\n\treturn cloned;\n}\n\n\n/**\n * Returns an array of the child object frames for a given property\n * or false if there is no such property\n */\nObjectFrame.prototype.getChildren = function(prop){\n\tif(prop && typeof this.children[prop] != \"undefined\"){\n\t\treturn this.children[prop];\n\t}\n\treturn false;\n}\n\n/**\n * Returns a child frame with a particular id \n * If the second parameter is included, it will only look in that specific property\n * Otherwise searches all properties for the child \n */\nObjectFrame.prototype.getChild = function(childid, prop){\n\tif(prop && typeof this.children[prop] != \"undefined\"){\n\t\tvar kids = this.children[prop];\n\t\tfor(var i = 0; i<kids.length; i++){\n\t\t\tif(kids[i].subjid == childid) return kids[i];\n\t\t}\n\t}\n\tif(!prop){\n\t\tfor(var prop in this.children){\n\t\t\tfor(var i = 0; i<this.children[prop].length; i++){\n\t\t\t\tif(this.children[prop][i].subjid == childid) return this.children[prop][i];\n\t\t\t}\n\t\t}\n\t}\n\treturn false;\n}\n\nObjectFrame.prototype.getDataFrames = function(prop){\n\tif(prop && typeof this.dataframes[prop] != \"undefined\"){\n\t\treturn this.dataframes[prop];\n\t}\n\treturn false;\n}\n\nObjectFrame.prototype.removeProperty = function(prop){\n\tif(typeof this.dataframes[prop] != \"undefined\"){\n\t\tdelete(this.dataframes[prop]);\n\t}\n\telse if(typeof this.children[prop] != \"undefined\"){\n\t\tdelete(this.children[prop]);\n\t}\n}\n\nObjectFrame.prototype.addProperty = function(prop, cls){\n\tvar cframe = this.getPropertyClassFrame(prop);\n\tif(cframe.isData()){\n\t\tvar df = cframe.copy();\n\t\tdf.set(\"\");\n\t\tif(typeof this.dataframes[prop] == \"undefined\"){\n\t\t\tthis.dataframes[prop] = [];\n\t\t}\n\t\tthis.dataframes[prop].push(df);\t\t\n\t\treturn df;\n\t}\n\telse if(cframe.isObject()) {\n\t\tif(typeof this.children[prop] == \"undefined\"){\n\t\t\tthis.children[prop] = [];\n\t\t}\n\t\tif(!cframe.isClassChoice()){\n\t\t\tvar empty = cframe.createEmpty(FrameHelper.genBNID());\n\t\t\tthis.children[prop].push(empty);\t\t\t\n\t\t\treturn empty;\n\t\t}\n\t\telse if(cls){\n\t\t\tvar empty = cframe.createEmptyChoice(cls, FrameHelper.genBNID());\n\t\t\tthis.children[prop].push(empty);\n\t\t\treturn empty;\n\t\t}\n\t\telse {\n\t\t\tvar clss = cframe.getClassChoices();\n\t\t\tif(clss && clss.length){\n\t\t\t\tvar empty = cframe.createEmptyChoice(clss[0], FrameHelper.genBNID())\n\t\t\t\tthis.children[prop].push(empty);\n\t\t\t\treturn empty;\n\t\t\t}\t\n\t\t}\n\t}\n\treturn false;\n}\n\nObjectFrame.prototype.addPropertyValue = function(prop, value){\n\tvar cframe = this.getPropertyClassFrame(prop);\n\tvar df = cframe.createEmpty();\n\tdf.set(value);\n\tthis.dataframes[prop].push(df);\n\treturn df;\n}\n\nObjectFrame.prototype.removePropertyValue = function(prop, value, index){\n\tif(typeof this.dataframes[prop] != \"undefined\"){\n\t\tvar nfvals = [];\n\t\tfor(var i = 0; i < this.dataframes[prop].length; i++){\n\t\t\tif(typeof index != \"undefined\" && index != i){\n\t\t\t\tthis.dataframes[prop][i].index = nfvals.length;\n\t\t\t\tnfvals.push(this.dataframes[prop][i]);\t\t\t\t\n\t\t\t}\n\t\t\telse if(typeof index == \"undefined\" && this.dataframes[prop][i].contents != value){\n\t\t\t\tthis.dataframes[prop][i].index = nfvals.length;\n\t\t\t\tnfvals.push(this.dataframes[prop][i]);\n\t\t\t}\n\t\t}\n\t\tif(nfvals.length){\n\t\t\tthis.dataframes[prop] = nfvals;\n\t\t}\n\t\telse {\n\t\t\tdelete(this.dataframes[prop]);\t\t\t\n\t\t}\n\t}\n\telse if(typeof this.children[prop] != \"undefined\"){\n\t\tvar kids = this.children[prop];\n\t\tvar nkids = [];\n\t\tfor(var i = 0; i<kids.length; i++){\n\t\t\tif(kids[i].subjid != value){\n\t\t\t\tnkids.push(kids[i]);\n\t\t\t}\n\t\t\tif(nkids.length){\n\t\t\t\tthis.children[prop] = nkids;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tdelete(this.children[prop]);\t\t\t\n\t\t\t}\n\t\t}\n\t}\n\telse {\n\t\talert(\"No prop \" + prop);\n\t}\n}\n\nObjectFrame.prototype.error = function(msg, more){\n\talert(msg);\n}\n\nObjectFrame.prototype.isObject = function() { return true;}\nObjectFrame.prototype.isData = function() { return false;}\n\n\n function DataFrame(frame, parent) {\n\tthis.err = false;\n\tthis.parent = parent;\n\t//the id of the object that owns this dataframe\n\tthis.subjid = (parent ? parent.subjid : false);\n\tif(frame){\n\t\tthis.load(frame);\n\t}\n}\n\nDataFrame.prototype.isValidType = function(dt){\n\tvar vtypes = [\"datatypeProperty\", \"objectProperty\", \"restriction \"];\n\tif(vtypes.indexOf(dt) == -1) return false;\n\treturn true;\n}\n\nDataFrame.prototype.load = function(frame){\n\tif(typeof frame != \"object\") {\n\t\tthis.error(\"No frame passed to load\");\n\t\treturn;\n\t}\n\t//all the meta-data carried in frames: \n\tthis.type = frame.type;\n\tthis.property = frame.property;\n\tthis.range = frame.range; \n\tthis.rangeValue = frame.rangeValue;\n\tthis.domain = frame.domain;\n\tthis.domainValue = frame.domainValue;\n\tthis.frame = frame.frame;\n\tthis.label = frame.label;\n\tthis.comment = frame.comment;\n\tvar restriction = frame.restriction;\n\tif(restriction && typeof restriction == \"object\"){\n\t\tthis.restriction = new Restriction(restriction);\n\t}\n\telse this.restriction = false;\n}\n\nDataFrame.prototype.getAsFrame = function(){\n\t var ff = { type: this.type, property: this.property};\n\t if(this.range) ff.range = this.range;\n\t if(this.rangeValue) ff.rangeValue = this.rangeValue;\n\t if(this.domain) ff.domain = this.domain;\n\t if(this.domainValue) ff.domainValue = this.domainValue;\n\t if(this.frame) ff.frame = this.frame;\n\t if(this.label) ff.label = this.label;\n\t if(this.comment) ff.comment = this.comment;\n\t return ff;\n}\n\nDataFrame.prototype.hasRestriction = function(){\n\t if(this.restriction) {\n\t\t return this.restriction.hasCardRestriction();\n\t }\n\t return false;\n}\n\nDataFrame.prototype.copy = function(newid){\n\tvar copy = new DataFrame(this, this.parent);\n\tif(newid) copy.domainValue = newid;\n\treturn copy;\n} \n\nDataFrame.prototype.getLabel = function(){\n\tvar lab = \"\";\n\tif(this.label && typeof this.label == 'object') lab = this.label[\"@value\"]; \n\tif(this.label && typeof this.label == 'string') lab = this.label; \n\tif(!lab && this.property) lab = FrameHelper.labelFromURL(this.property);//always return something\n\tif(!lab) lab = FrameHelper.labelFromURL(this.cls);\n\treturn lab\n}\n\nDataFrame.prototype.getType = function(){\n\tif(this.range) return this.range;\n\tif(this.rangeValue && this.rangeValue.type) return this.rangeValue.type;\n\treturn false;\n}\n\nObjectFrame.prototype.getLabel = DataFrame.prototype.getLabel;\n\nDataFrame.prototype.getComment = function(){\n\tvar comment = \"\";\n\tif(this.comment && typeof this.comment == 'object') comment = this.comment[\"@value\"]; \n\tif(this.comment && typeof this.comment == 'string') comment = this.comment; \n\treturn comment;\n}\n\nObjectFrame.prototype.getComment = DataFrame.prototype.getComment;\n\n\nDataFrame.prototype.error = function(msg){\n\tif(msg)\tthis.err = msg;\n\treturn this.err;\n}\n\nDataFrame.prototype.isValid = function(){\n\tif(!(this.type && this.isValidType(this.type))){\n\t\tthis.error(\"Missing or Illegal Frame Type \" + this.type);\n\t\treturn false;\n\t}\n\tif(!(this.property)){\n\t\tthis.error(\"Missing Frame Property\");\n\t\treturn false;\n\t}\n\tif(!(this.domain)){\n\t\tthis.error(\"Missing Frame Domain\");\n\t\treturn false;\n\t}\n\tif(!(this.range)){\n\t\tthis.error(\"Missing Frame Range\");\n\t\treturn false;\n\t}\n\tif(this.isObjectProperty() && !(this.frame && typeof this.frame == \"object\")){\n\t\tthis.error(\"Missing Object Frame\");\n\t\treturn false;\n\t}\n\treturn true;\n}\n\nDataFrame.prototype.isObjectProperty = function(){\n\treturn this.type == \"objectProperty\";\n}\n\nDataFrame.prototype.isDatatypeProperty = function(){\n\treturn this.type == \"datatypeProperty\";\n}\n\nDataFrame.prototype.isLogic = function(){\n\tif(this.type == \"and\" || this.type == \"or\" || this.type == \"xor\"){\n\t\treturn true;\n\t}\n\treturn false;\n}\n\nDataFrame.prototype.isRestriction = function(){\n\treturn this.type == \"restriction\";\n}\n\nDataFrame.prototype.ftype = function(){\n\tif(this.isDocument()) return \"document\";\n\tif(this.isDatatypeProperty()) return \"data\";\n\tif(this.isChoice()) return \"oneOf\";\n\tif(this.isObject()) return \"object\";\n\tif(this.isLogic()) return \"logic\";\n\tif(this.isClassChoice()) return \"class_choice\";\n}\n\nDataFrame.prototype.isClassChoice = function(){\n\treturn(this.frame && this.frame.type == \"class_choice\");\n}\n\nDataFrame.prototype.isString = function(){\n\tif(this.range == FrameHelper.getStdURL(\"xsd\", \"string\")){\n\t\treturn true;\n\t}\n\treturn false;\n}\n\nDataFrame.prototype.getChoiceOptions = function(){\n\tvar opts = [];\n\tfor(var i = 0; i<this.frame.elements.length; i++){\n\t\tvar option = {};\n\t    if(this.frame.elements[i].label){\n\t    \toption.label = this.frame.elements[i].label[\"@value\"];\n\t    }\n\t    else {\n\t    \toption.label = FrameHelper.labelFromURL(this.frame.elements[i].class);\n\t    }\n\t    option.value = this.frame.elements[i].class;\n\t    opts.push(option);\n\t}\n\treturn opts;\n}\n\nDataFrame.prototype.lang = function(){\n\treturn \"en\";\n}\n\nDataFrame.prototype.isChoice = function(){\n\treturn(this.frame && this.frame.type == \"oneOf\");\t\n}\n\nDataFrame.prototype.isDocument = function(){\n\treturn(this.frame && this.frame.type == \"document\");\t\n}\n\nDataFrame.prototype.isData = function(){\t\n\treturn (this.isDocument() || this.isChoice() || this.isDatatypeProperty());\n}\n\nDataFrame.prototype.isObject = function(){\t\n\treturn (this.isObjectProperty() && this.frame && !(this.isChoice() || this.isDocument()));\n}\n\nDataFrame.prototype.getTypeShorthand = function(){\n\tif(this.isDocument()) return \"document\";\n\telse if(this.isChoice()) return \"choice\";\n\telse return FrameHelper.getShorthand(this.range);\n}\n\nDataFrame.prototype.get = function(format){\t\n\tif(this.contents){\n\t\treturn this.contents;\n\t}\n\tif(this.isDatatypeProperty() &&  this.rangeValue &&  typeof this.rangeValue[\"@value\"] != \"undefined\"){\n\t\treturn this.rangeValue[\"@value\"];\n\t}\n\telse if(this.isChoice() || this.isDocument()){\n\t\treturn this.frame.domainValue;\n\t}\n\treturn \"\";\n}\n\nDataFrame.prototype.set = function(value, normalizer){\n\tif(normalizer) value = normalizer(value, this);\n\tthis.contents = value;\n\tif(this.isChoice() || this.isDocument()){\n\t\tthis.frame.domainValue = value;\n\t}\n\tif(this.isDatatypeProperty() && this.rangeValue){\n\t\tthis.rangeValue[\"@value\"] = value;\n\t}\n}\n\nDataFrame.prototype.clear = function(){\t\n\tif(this.isDocument() || this.isChoice() || this.isDatatypeProperty()){\n\t\tthis.set(\"\");\n\t}\n}\n\n function ClassFrame(frame, parent) {\n\tthis.err = false;\n\tthis.parent = parent;\n\tthis.children = {};\n\t//the id of the object that owns this dataframe\n\tthis.subjid = (parent ? parent.subjid : false);\n\tif(frame){\n\t\tthis.load(frame);\n\t}\n}\n\nClassFrame.prototype = DataFrame.prototype;\n\nClassFrame.prototype.loadFromObjectFrame = function(par, child){\n\t//all the meta-data carried in frames: \n\tthis.type = \"objectProperty\";\n\tthis.property = par.property;\n\tthis.range = par.range; \n\tthis.rangeValue = child.subjid;\n\tthis.domain = par.cls;\n\tthis.domainValue = par.subjid;\n\tthis.label = par.getLabel();\n\tthis.comment = par.getComment();\n\tthis.restriction = par.restriction;\t\n}\n\nClassFrame.prototype.createEmptyChoice = function(cls, newid){\n\tvar cf = this.getChosenClassFrames(cls);\n\tvar objframe = new ObjectFrame(cls);\n\tif(newid) objframe.subjid = newid;\n\tobjframe.loadClassFrames(cf);\n\tvar fframe = objframe.fillFromSchema();\n\treturn fframe;\n}\n\nClassFrame.prototype.getChosenClassFrames = function(chosen){\n\tvar nc = [];\n\tfor(var i = 0; i<this.frame.operands.length; i++){\n\t\tfor(var j = 0; j<this.frame.operands[i].length; j++){\n\t\t\tif(chosen == this.frame.operands[i][j].domain){\n\t\t\t\tnc = nc.concat(this.frame.operands[i][j]);\n\t\t\t}\n\t\t}\n\t}\n\treturn nc;\n}\n\nClassFrame.prototype.createEmpty = function(newid){\n\tif(this.isObject()){\n\t\tvar objframe = new ObjectFrame(this.range);\n\t\tif(newid) objframe.subjid = newid;\n\t\tobjframe.loadClassFrames(this.frame);\n\t\tvar fframe = objframe.fillFromSchema();\n\t\treturn fframe;\n\t}\n\telse if(this.isData()){\n\t\tvar dataframe = this.copy();\n\t\tdataframe.set(\"\");\n\t\treturn dataframe;\n\t}\n}\n\nClassFrame.prototype.cloneDataFrame = function(newid, other){\n\treturn other;\n} \n\nClassFrame.prototype.clone = function(newid, other){\n\tif(this.isObject()){\n\t\talert(\"cannot clone class frame\");\n\t}\n\telse if(this.isData()){\n\t\treturn this.cloneDataFrame(newid, other);\n\t}\n\t\n}\n\nClassFrame.prototype.getClassChoices = function(){\n\tvar choices = [];\n\tfor(var i = 0; i<this.frame.operands.length; i++){\n\t\tfor(var j = 0; j<this.frame.operands[i].length; j++){\n\t\t\tvar domcls = this.frame.operands[i][j].domain;\n\t\t\tif(domcls && choices.indexOf(domcls) == -1){\n\t\t\t\tchoices.push(domcls);\n\t\t\t}\n\t\t}\n\t}\n\treturn choices;\n\t\n}\n\nClassFrame.prototype.getChosenClassFrame = function(chosen){\n\tfor(var i = 0; i<this.frame.operands.length; i++){\n\t\tvar operand = this.frame.operands[i];\n\t\tif(operand.length){\n\t\t\tfor(var j = 0; j<operand.length; j++){\n\t\t\t\tif(operand[j] && (chosen == operand[j].domain)){\n\t\t\t\t\tvar cf = new ClassFrame(operand);\n\t\t\t\t\treturn cf;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse if(operand.range && chosen == operand.range){\n\t\t\tvar cf = new ClassFrame(operand);\n\t\t\treturn cf;\n\t\t}\n\t}\n\treturn false;\n}\n\nClassFrame.prototype.getChosenFrame = function(dataframe){\n\treturn dataframe;\n}\n\n\nfunction Restriction(restriction){\n\tthis.min = 0;\n\tthis.max = 0;\n\tif(restriction) this.loadRestriction(restriction);\n}\n\nRestriction.prototype.hasCardRestriction = function(){\n\tif(this.min == 0 && this.max == 0) return false;\n\treturn true;\n}\n\nRestriction.prototype.loadRestriction = function(restriction){\n\tif(typeof restriction.cardinality != \"undefined\"){\n\t\tthis.max = restriction.cardinality;\n\t\tthis.min = restriction.cardinality;\n\t}\n\telse if(typeof restriction.maxCardinality != \"undefined\"){\n\t\tthis.max = restriction.maxCardinality;\n\t}\n\telse if(typeof restriction.minCardinality != \"undefined\"){\n\t\tthis.min = restriction.minCardinality;\n\t}\n\telse if(typeof restriction.type != \"undefined\" && restriction.type == \"and\" && typeof restriction.operands == \"object\"){\n\t\tfor(var i = 0; i<restriction.operands.length; i++){\n\t\t\tvar nrest = new Restriction(restriction.operands[i]);\n\t\t\tif(this.max == 0 && nrest.max > 0) this.max = nrest.max;\n\t\t\telse if(this.max > 0 && nrest.max > 0 && nrest.max < this.max) this.max = nrest.max;\t\t\t\t\n\t\t\tif(this.min == 0 && nrest.min > 0) this.min = nrest.min; \n\t\t\telse if(this.min > 0 && nrest.min > 0 && nrest.min > this.min) this.min = nrest.min;\n\t\t}\n\t}\n}\n\nmodule.exports=ObjectFrame\n","const FrameHelper = require('../FrameHelper');\nconst ObjectRenderer = require('./ObjectRenderer');\nconst ValueRenderer = require('./ValueRenderer');\nconst RenderingMap = require('./RenderingMap');\n\nfunction PropertyRenderer(prop, parent, options){\n\t/*\n\tif(options && options.features){\n\t\tthis.features = options.features;\n\t}\n\telse {\n\t\tthis.features = [\"body\", \"type\", \"cardinality\", \"summary\", \"label\", \"status\", \"facet\", \"control\", \"viewer\", \"view\", \"comment\", \"id\", \"toolbox\", \"help\t\"];\n\t}\n\tif(options && options.controls){\n\t\tthis.controls = options.controls;\n\t}\n\telse {\n\t\tthis.controls = [\"delete\", \"clone\", \"add\", \"reset\", \"cancel\", \"update\", \"mode\", \"show\", \"hide\"];\n\t}*/\n\tthis.predicate = prop;\n\tthis.parent = parent;\n\tthis.cframe = this.parent.objframe.getPropertyClassFrame(this.predicate);\n\tthis.options = this.setOptions(options);\n\tthis.originalValues = false;\n\tthis.changed = false;\n\tthis.values = [];\n}\n\nPropertyRenderer.prototype.setOptions = function(options){\n\treturn RenderingMap.decorateRenderer(options, this);\n\t/*options = (options ? options : {});\n\tif(options.mode) this.mode = options.mode;\n\telse {\n\t\tthis.mode = (this.parent && this.parent.mode ? this.parent.mode : \"view\");\n\t\toptions.mode = this.mode;\n\t}\n\tif(options.view) this.view = options.view;\n\telse {\n\t\tthis.view = (this.parent && this.parent.view ? this.parent.view : \"full\");\n\t\toptions.view = this.view;\n\t}\n\tif(options.viewer) this.viewerType = options.viewer;\n\telse this.viewerType = this.getViewerForDataValue();\n\tif(options.facet) this.facet = options.facet;\n\telse this.facet = this.getDefaultFacet();\n\tthis.hide_disabled_controls = (options && options.hide_disabled_controls ? options.hide_disabled_controls : true);\n\tthis.facets = {\n\t\ticon: \t[\"facet\", \"summary\"],\n\t\tlabel: \t[\"facet\", \"status\", \"label\", \"summary\"],\n\t\tsummary: [\"facet\", \"satus\", \"label\", \"type\", \"cardinality\", \"body\", \"status\", \"facet\", \"viewer\"],\n\t\tline: [\"facet\", \"label\", \"comment\", \"id\", \"control\", \"type\", \"cardinality\", \"body\", \"status\", \"facet\", \"viewer\"].concat(this.controls),\n\t\tmultiline: [\"facet\", \"label\", \"comment\", \"id\", \"control\", \"type\", \"cardinality\", \"body\", \"status\", \"facet\", \"view\", \"viewer\"].concat(this.controls),\n\t\tpage: [\"facet\", \"label\", \"comment\", \"id\", \"control\", \"type\", \"cardinality\", \"body\", \"status\", \"facet\", \"view\", \"viewer\"].concat(this.controls)\n\t}\n\tif(options && options.facets){\n\t\tfor(var facet in options.facets){\n\t\t\tthis.facets[facet] = options.facets[facet];\n\t\t}\n\t}*/\n\treturn options;\n}\n\n\nPropertyRenderer.prototype.getOptionsForChild = function(){\n\tvar opts = {};\n\tif(this.options.features){ opts.features = this.options.features };\n\tif(this.options.controls){ opts.controls = this.options.controls};\n\t//return opts;\n\treturn this.options;\n}\n\nPropertyRenderer.prototype.getOptionsForValue = function(df, index){\n\treturn this.getOptionsForChild();\n}\n\nPropertyRenderer.prototype.getOptionsForObject = function(objframe){\n\treturn this.getOptionsForChild();\n}\n\n\nPropertyRenderer.prototype.render = function(viewer){\n \tthis.buildValueRenderers();\n \tif(this.cframe && this.cframe.property){\n \t\tthis.viewer = (viewer ? viewer : this.getViewerForProperty());\n \t\tfor(var i = 0; i<this.values.length; i++){\n \t\t\tvar renderedval = this.values[i].render();\n \t\t\tif(renderedval && this.showFeature(\"body\")) this.viewer.addRenderedValue(renderedval);\n \t\t}\n \t\treturn this.viewer.render();\n \t}\n} \n\n/*\n * Creates the array of object renderer or value renderer objects corresponding to the property values. \n */\nPropertyRenderer.prototype.buildValueRenderers = function(){\n \tvar adorig = (this.originalValues === false ? true : false);\n \tthis.cframe = this.parent.objframe.getPropertyClassFrame(this.predicate);\n \tif(!this.cframe){\n \t\tconsole.error(\"No frame for \" + this.property() + \" id: \" + this.subject());\n \t\treturn false;\n \t}\n \tif(this.cframe && this.cframe.isData()){\n \t\tvar dataframes = this.getDataFramesToRender();\n \t\tif(dataframes.length == 0){\n \t\t\talert(this.predicate);\n \t\t}\n \t\tvar vals = [];\n \t\tfor(var i = this.values.length; i<dataframes.length; i++){\n \t\t\tvar vr = new ValueRenderer(dataframes[i], i, this, this.getOptionsForValue(dataframes[i], i));\n \t\t\tthis.values.push(vr);\n \t\t\tvals.push(vr.value());\n \t\t}\n \t\tif(adorig) this.originalValues = vals;\n \t}\n \telse {\n \t\tif(adorig) this.originalValues = [];\n \t\tvar kids = this.getChildrenToRender();\n \t\tif(kids && kids.length){\n \t\t\tfor(var i = this.values.length; i<kids.length; i++){\n \t\t\t\tvar kidf = new ObjectRenderer(kids[i], this, this.getOptionsForObject(kids[i]));\n \t\t\t\tif(adorig) this.originalValues.push(kidf.subject());\n \t\t\t\tthis.values.push(kidf);\n \t\t\t}\n \t\t}\n \t}\n}\n\n/*\n * Returns the array of values that should be rendered (enables value filtering)\n */\nPropertyRenderer.prototype.getDataFramesToRender = function(options){\n \tvar allvals = this.parent.objframe.getDataFrames(this.property());\n \treturn allvals;\n}\n\n/*\n * Returns the array of child / objects that should be rendered (enables value filtering)\n */\nPropertyRenderer.prototype.getChildrenToRender = function(options){\n \t/*var sort = this.standardSort;\n \tvar filter = function(){return true};\n \tfor(var i = 0; i<options.map.patterns.length; i++){\n \t\tif(this.objframe.matchesPattern(\"sort\", options.map.patterns[i])){\n \t\t\tsort = options.map.patterns[i].sort;\n \t\t}\n \t\tif(this.objframe.matchesPattern(\"filter\", options.map.patterns[i])){\n \t\t\tfilter = options.map.patterns[i].filter;\n \t\t}\n \t}\n \treturn sort(this.values, filter);*/\n \tif(FrameHelper.viewIncludesChildren(this.view, \"property\")){\n \t\tvar allkids = this.parent.objframe.getChildren(this.property());\n \t}\n \telse {\n \t\tvar allkids = [];\n \t}\n \treturn allkids;\n}\n\nPropertyRenderer.prototype.redraw = function(){\n \tthis.viewer.clear();\n \tthis.render(this.viewer);\n}\n\nPropertyRenderer.prototype.extract = function(){\n \tvar extracts = [];\n \tfor(var i = 0; i<this.values.length; i++){\n \t\tvar val = this.values[i].extract();\n \t\tif(val !== \"\" && typeof val != \"undefined\") extracts.push(val);\n \t}\n \tif(this.cframe.isData()){\n \t\treturn extracts;\n \t}\n \telse {\n \t\tvar extr = {};\n \t\tfor(var i = 0; i<extracts.length; i++){\n \t\t\tfor(var subjid in extracts[i]){\n \t\t\t\textr[subjid] = extracts[i][subjid];\n \t\t\t}\n \t\t}\n \t\treturn extr;\n \t}\n}\n\n/*\n * simple wrapper functions\n */\nPropertyRenderer.prototype.currentViewer = function(){return this.viewerType;}\nPropertyRenderer.prototype.property = function(){return this.predicate;}\nPropertyRenderer.prototype.subject = function(){return (this.parent ? this.parent.subject() : false);};\nPropertyRenderer.prototype.depth = function(){return (this.parent ? this.parent.depth() : false);};\nPropertyRenderer.prototype.subjectClass = function(){return (this.parent ? this.parent.subjectClass() : false);};\nPropertyRenderer.prototype.updated = function(){ return (this.parent ? this.parent.childUpdated() : false);};\nPropertyRenderer.prototype.range = function(){\treturn (this.cframe ? this.cframe.range : \"\");};\nPropertyRenderer.prototype.getLabel = function(){ return (this.cframe ? this.cframe.getLabel() : \"\" );};\nPropertyRenderer.prototype.getComment = function(){ return (this.cframe ? this.cframe.getComment() : false);}\nPropertyRenderer.prototype.load = function(link){ return (this.parent ? this.parent.load(link) : false);}\nPropertyRenderer.prototype.hasCardinalityRestriction = function(){return (this.cframe ? this.cframe.hasRestriction() : false);};\nPropertyRenderer.prototype.getRestriction = function(){return (this.cframe ? this.cframe.restriction : false);};\nPropertyRenderer.prototype.isClassChoice = function(){\treturn (this.cframe ? this.cframe.isClassChoice() : false);};\nPropertyRenderer.prototype.currentFacet = function(){\treturn this.facet;} ;\nPropertyRenderer.prototype.save = function(){ return (this.parent ? this.parent.save() : false);};\n\nPropertyRenderer.prototype.cancel = function(){\n\tthis.reset();\n\tthis.setMode(\"view\");\n}\n\nPropertyRenderer.prototype.getAvailableClassChoices = function(){ \n\tif(this.cframe){\n\t\tvar cf = this.cframe.getClassChoices();\n\t\tif(this.parent){\n\t\t\tvar choices = [];\n\t\t\tfor(var i = 0; i < cf.length; i++){\n\t\t\t\tvar clsmeta = this.parent.getClassMeta(cf[i]);\n\t\t\t\tvar lab = ((clsmeta && clsmeta.Label && clsmeta.Label[\"@value\"]) ? clsmeta.Label[\"@value\"] : FrameHelper.labelFromURL(cf[i]));\n\t\t\t\tchoices.push({value: cf[i], label: lab});\n\t\t\t}\n\t\t\treturn choices;\n\t\t}\n\t\treturn cf;\n\t\t\n\t}\n\treturn false;\n};\n\n\nPropertyRenderer.prototype.delete = function(){\n\tvar prop = this.predicate;\n\tif(prop){\n\t\tthis.reset();\n\t\tthis.parent.deleteProperty(prop);\t\n\t\tthis.parent.redraw();\n\t}\n}\n\nPropertyRenderer.prototype.add = function(view){\n\tthis.parent.addProperty(this.property(), view);\n\tthis.updated();\n\tif(view) {\n\t\tthis.values[this.values.length-1].setMode(view);\n\t\tthis.values[this.values.length-1].setNew();\n\t}\n\tthis.redraw();\n\tthis.goToValue(this.values.length-1);\n}\n\nPropertyRenderer.prototype.goToValue = function(index){\n\tthis.viewer.goTo(this.subject(), this.property(), index);\n}\n\nPropertyRenderer.prototype.addClass = function(cls){\n\tthis.parent.addPropertyClass(this.property(), cls);\n\tthis.updated();\n\tvar newb = this.values[this.values.length-1];\n\tif(newb){\n\t\tnewb.setNew();\n\t\tnewb.setMode(\"edit\");\n\t}\n\tthis.redraw();\n\tif(newb) this.viewer.goTo(newb.subject());\n}\n\nPropertyRenderer.prototype.reset = function(){\n\tthis.parent.objframe.reset(this.predicate);\n\tif(this.cframe && this.cframe.isData()){\n\t\tfor(var i = 0; i<this.values.length; i++){\n\t\t\tthis.values[i].reset();\n\t\t}\n\t\tthis.values = [];\n\t}\n\telse {\n\t\tvar nvals = [];\n\t\tfor(var i = 0; i<this.originalValues.length; i++){\n\t\t\tfor(var j = 0; j<this.values.length; j++){\n\t\t\t\tthis.values[j].reset();\n\t\t\t\tif(this.values[j].subject() == this.originalValues[i]){\n\t\t\t\t\tnvals.push(this.values[j]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tthis.values = nvals;\n\t}\n\tthis.redraw();\t\n\tthis.parent.childUpdated();\n}\n\nPropertyRenderer.prototype.deletePropertyValue = function(value, index){\n\tthis.parent.objframe.removePropertyValue(this.property(), value, index);\n\tvar nvals = [];\n\tfor(var i = 0; i<this.values.length; i++){\n\t\tif(typeof index == \"undefined\"){\n\t\t\tif(this.values[i].subject() == value){\n\t\t\t\tthis.values[i].reset();\n\t\t\t}\n\t\t\telse {\n\t\t\t\tnvals.push(this.values[i]);\n\t\t\t}\n\t\t}\n\t\telse if(i != index){\n\t\t\tthis.values[i].index = nvals.length;\n\t\t\tnvals.push(this.values[i]);\n\t\t}\n\t\telse {\n\t\t\tthis.values[i].reset();\n\t\t}\n\t}\n\tthis.values = nvals;\n\tthis.parent.childUpdated();\n\tthis.parent.redraw();\n}\n\nPropertyRenderer.prototype.addPropertyValue = function(value){\n\tthis.updated();\n\treturn this.parent.objframe.addPropertyValue(this.property(), value);\n}\n\n/*\n * Checks to see if an action (add, clone, delete) which affects the cardinality of the property is allowed by cardinality rules.\n */\nPropertyRenderer.prototype.cardControlAllows = function(action){\n\tif(this.cframe.hasRestriction()){\n\t\tvar rest = this.cframe.restriction;\n\t\tvar currentnum = this.values.length;\n\t\tif(action == \"add\" || action == \"clone\"){\n\t\t\tif(rest.max && currentnum >= rest.max){\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\tif(action == \"delete\" && (rest.min)){\n\t\t\treturn false;\n\t\t}\n\t}\n\treturn true;\n}\n\nPropertyRenderer.prototype.isNew = function(){\n\tif(this.new_property){\n\t\treturn true;\n\t}\n\treturn this.parent.isNew();\n}\n\nPropertyRenderer.prototype.setNew = function(){\n\tthis.new_property = true;\n}\n\n\nPropertyRenderer.prototype.isUpdated = function(){\n\tif(this.values.length != this.originalValues.length) return true;\n\tfor(var i = 0 ; i < this.values.length; i++){\n\t\tif(this.cframe && this.cframe.isData()){\n\t\t\tif(this.values[i].value() != this.originalValues[i]){\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tif(this.values[i].subject() != this.originalValues[i]) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tif(this.values[i].isUpdated()) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t}\n\treturn false;\n}\n\nPropertyRenderer.prototype.childUpdated = function(){\n\tthis.viewer.redrawHeader();\n\tif(this.parent) this.parent.childUpdated();\n}\n\n\n/**\n * Sets mode of viewer to either \"view\" or \"edit\"\n */\nPropertyRenderer.prototype.setMode = function(mode){\n\tthis.mode = mode;\n\tfor(var i = 0; i<this.values.length; i++){\n\t\tthis.values[i].setMode(mode);\n\t}\n\tthis.redraw();\n}\n\n/*\n * Jump to property value\n */\nPropertyRenderer.prototype.getViewableValues = function(){\n\tvar viewables = [];\n\tif(this.cframe && this.cframe.isData())\n\tfor(var i = 0; i<this.values.length; i++){\n\t\tvar sum = this.values[i].getSummary();\n\t\tvar lab = sum.long;\n\t\tviewables.push({label: lab, value: i});\n\t}\n\treturn viewables;\n}\n\nPropertyRenderer.prototype.hideDisabledControls = function(){\n\treturn this.hide_disabled_controls;\n}\n\nPropertyRenderer.prototype.setFacet = function(facet, nocascade){\n\tthis.facet = facet;\n\tif(!nocascade){\n\t\tfor(var i = 0; i<this.values.length; i++){\n\t\t\tthis.values[i].parentFacetChange(facet);\n\t\t}\n\t}\n\tthis.redraw();\n}\n\nPropertyRenderer.prototype.parentFacetChange = function(facet){\n\tif(facet == 'page'){\n\t\tif(!(this.facet == \"page\" || this.facet == \"multiline\")){\n\t\t\tthis.setFacet('multiline');\n\t\t}\n\t}\n\tif(facet == 'line'){\n\t\tthis.setFacet(\"label\");\n\t}\n\t\t\n}\n\n\n\nPropertyRenderer.prototype.getDefaultFacets = function(){\n\tvar defs = {\n\t\tpage: {\n\t\t\tlabel: \"Full Page\", value: \"page\", \n\t\t\tfeatures: [\"facet\", \"label\", \"comment\", \"id\", \"control\", \"type\", \"cardinality\", \"body\", \"status\", \"facet\", \"view\", \"viewer\"], \n\t\t\tcontrols: [\"delete\", \"clone\", \"add\", \"reset\", \"cancel\", \"update\", \"mode\", \"show\", \"hide\"]\n\t\t},\n\t\tmultiline: {\n\t\t\tlabel: \"Multiple Lines\", value: \"multiline\",\n\t\t\tfeatures: [\"facet\", \"label\", \"comment\", \"id\", \"control\", \"type\", \"cardinality\", \"body\", \"status\", \"facet\", \"view\", \"viewer\"], \n\t\t\tcontrols: [\"delete\", \"clone\", \"add\", \"reset\", \"cancel\", \"update\", \"mode\", \"show\", \"hide\"]\n\t\t},\n\t\tline: {\n\t\t\tlabel: \"Single Line\", value: \"line\",\n\t\t\tfeatures: [\"facet\", \"label\", \"comment\", \"id\", \"control\", \"type\", \"cardinality\", \"body\", \"status\", \"facet\", \"viewer\"], \n\t\t\tcontrols: [\"delete\", \"clone\", \"add\", \"reset\", \"cancel\", \"update\", \"mode\", \"show\", \"hide\"]\n\t\t},\n\t\tsummary: {\n\t\t\tlabel: \"Summary\", value: \"summary\",\n\t\t\tfeatures: [\"facet\", \"satus\", \"label\", \"type\", \"cardinality\", \"body\", \"status\", \"facet\", \"viewer\"], \n\t\t\tcontrols: [] \n\t\t},\n\t\tlabel: {\n\t\t\tlabel: \"Label\", value: \"label\",\n\t\t\tfeatures: [\"facet\", \"status\", \"label\", \"summary\"],\n\t\t\tcontrols: []\n\t\t},\n\t\ticon: {\n\t\t\tlabel: \"Snippet\", value: \"icon\",\n\t\t\tfeatures: [\"facet\", \"summary\"],\n\t\t\tcontrols: []\n\t\t}\n\t}\n\treturn defs;\t\n}\n\nPropertyRenderer.prototype.getAvailableFacets = function(){\n\treturn Object.values(this.facets);\n\tvar facets = [];\n\tfacets.push({label: \"Full Page\", value: \"page\"});\n\tfacets.push({label: \"Multiple Lines\", value: \"multiline\"});\n\tfacets.push({label: \"Single Line\", value: \"line\"});\n\tfacets.push({label: \"Summary\", value: \"summary\"});\n\tfacets.push({label: \"Label\", value: \"label\"});\n\tfacets.push({label: \"Snippet\", value: \"icon\"});\n\treturn facets;\n}\n\nPropertyRenderer.prototype.getContentOrientation = function(facet){\n\tif(this.currentFacet() == \"page\" || this.containsPage()){\n\t\treturn \"page\";\n\t}\n\tif(this.currentFacet() == \"line\" || this.currentFacet() == \"multiline\" || this.currentFacet() == \"summary\"){\n\t\treturn \"line\";\n\t}\n\treturn \"label\";\n}\n\n\nPropertyRenderer.prototype.getDefaultFacet = function(){\n\tif(this.cframe && this.cframe.isObject()){\n\t\treturn \"page\";\n\t}\n\treturn \"multiline\";\n}\n\n/*\n * Viewers for specific properties\n */\n\nPropertyRenderer.prototype.hide = function(){\n\tthis.setView(\"hidden\");\n}\n\nPropertyRenderer.prototype.show = function(){\n\tthis.setView(\"full\");\n}\n\nPropertyRenderer.prototype.setView = function(view){\n\tthis.view = view;\n\tthis.redraw();\n}\n\nPropertyRenderer.prototype.getAvailableViewers = function(){\n\tif(this.mode == \"view\"){\n\t\treturn RenderingMap.getAvailablePropertyViewers(this);\t\t\n\t}\n\treturn RenderingMap.getAvailablePropertyEditors(this);\t\t\t\t\n}\n\nPropertyRenderer.prototype.getViewerForDataValue = function(){\n\t/*if(this.cframe && this.cframe.isData()){\n\t\tvar dt = this.cframe.getTypeShorthand();\n\t\tvar ft = this.cframe.ftype();\n\t\tif(this.mode == \"edit\"){\n\t\t\treturn RenderingMap.getEditorForFrame(dt, ft);\t\t\t\t\n\t\t}\n\t\treturn RenderingMap.getViewerForFrame(dt, ft);\t\t\n\t}*/\n}\n\nPropertyRenderer.prototype.setViewer = function(viewer){\n\t//this.viewerType = viewer;\n\t//for(var i = 0; i<this.values.length; i++){\n\t//\tthis.values[i].setViewer(viewer);\n\t//}\n\t//this.redraw();\n}\n\nPropertyRenderer.prototype.nukeViewer = function(){\n\tthis.viewer.remove();\n}\n\nPropertyRenderer.prototype.containsPage = function(){\n\t//collapsed facets do not show their values\n\tif(this.currentFacet() == \"icon\" || this.currentFacet() == \"label\") return false;\n\tfor(var i = 0; i<this.values.length; i++){\n\t\tif(this.values[i].facet == \"page\") {\n\t\t\treturn true;\n\t\t}\n\t}\n\treturn false;\n}\n\nPropertyRenderer.prototype.getViewerForProperty = function(ptype){\n\tif(this.mode == \"edit\"){\n\t\treturn RenderingMap.getEditorForProperty(ptype, this);\t\t\t\t\n\t}\n\treturn RenderingMap.getViewerForProperty(ptype, this);\t\n}\n\nPropertyRenderer.prototype.getPropertyHeaderViewer = function(){\n\treturn new HTMLPropertyHeaderViewer();\n}\n\nPropertyRenderer.prototype.getSummary = function(){\n\tvar status = \"ok\";\n\tif(this.isNew()) status = \"new\";\n\telse if(this.isUpdated()) status = \"updated\";\n\tvar ret = {\n\t\tstatus: status,\n\t\tvalcount: this.values.length\n\t};\n\tret.long = ((ret.valcount != 1) ? \"(\" + ret.valcount + \") \" : \"\");\n\tfor(var i = 0; i<this.values.length; i++){\n\t\tvsum = this.values[i].getSummary();\n\t\tret.long += vsum.long;\n\t\tif(i < this.values.length-1) ret.long += \", \";\n\t}\n\treturn ret;\t\n}\n\nPropertyRenderer.prototype.getFeaturesForFacet = function(facet){\n\treturn this.facets[facet].features.concat(this.facets[facet].controls);\n}\n \nPropertyRenderer.prototype.showFeature = function(which){\n\tif(this.features.indexOf(which) == -1 && this.controls.indexOf(which) == -1) {\n\t\treturn false;\n\t}\n\tvar cardcontrols = [\"delete\", \"clone\", \"add\"];\n\tif(cardcontrols.indexOf(which) != -1){\n\t\tif(!this.cardControlAllows(which)) return false;\n\t}\n\tvar updcontrols = [\"update\", \"reset\"];\n\tif(this.hideDisabledControls() && updcontrols.indexOf(which) != -1 ){\n\t\tif(!this.isUpdated()){\n\t\t\treturn false;\n\t\t}\n\t}\n\tif(which == 'hide' && this.view == \"hidden\") return false;\n\tif(which == 'show' && this.view != \"hidden\") return false;\n\tvar fets = this.getFeaturesForFacet(this.facet);\n\treturn (fets.indexOf(which) != -1);\n}\n\nmodule.exports=PropertyRenderer\n\n","const HTMLPropertyViewer = require('./PropertyViewer');\nconst RenderingMap = require('./RenderingMap');\n\nfunction ValueRenderer(dataframe, index, parent, options){\n\tthis.frame = dataframe;\n\tthis.index = index;\n\tthis.parent = parent;\n\tthis.options = this.setOptions(options);\n\tthis.originalValue = this.value();\n} \n\nValueRenderer.prototype.depth = function(){return (this.parent ? this.parent.depth() : false);};\nValueRenderer.prototype.property = function(){ return (this.parent ? this.parent.property() : false);};\nValueRenderer.prototype.subject = function(){ return (this.parent ? this.parent.subject() : false);};\nValueRenderer.prototype.subjectClass = function(){ return (this.parent ? this.parent.subjectClass() : false);};\nValueRenderer.prototype.type = function(){\treturn (this.frame ? this.frame.range : false);};\nValueRenderer.prototype.range = function(){\treturn (this.frame ? this.frame.range : false);};\nValueRenderer.prototype.value = function(){\treturn (this.frame ? this.frame.get() : false);};\nValueRenderer.prototype.isDocument = function(){\treturn (this.frame ? this.frame.isDocument() : false);};\nValueRenderer.prototype.currentViewer = function(){\treturn this.viewerType;}\n\nValueRenderer.prototype.copy = function(nf){\n\tvar nvr = new ValueRenderer(nf, false, this.parent, this.options);\n\tnvr.mode = this.mode;\n\tnvr.view = this.view;\n\treturn nvr;\n}\n \nValueRenderer.prototype.setFacet = function(facet){\n\tthis.facet = facet;\n\tthis.parent.redraw();\n}\n\nValueRenderer.prototype.parentFacetChange = function(pfacet){\n\tif(pfacet == \"page\") this.setFacet(\"page\");\n\tif(pfacet == \"multiline\") this.setFacet(\"line\");\n\tif(pfacet == \"line\") this.setFacet(\"inline\");\n\tif(pfacet == \"summary\") this.setFacet(\"icon\");\n}\n\nValueRenderer.prototype.getDefaultFacet = function(){\n\tif(this.parent.currentFacet() == \"page\" || this.parent.currentFacet() == \"multiline\"){\n\t\treturn \"line\";\n\t}\n\treturn \"inline\";\n}\n\nValueRenderer.prototype.getAvailableFacets = function(){\n\treturn Object.values(this.facets);\n}\n\nValueRenderer.prototype.getDefaultFacets = function(){\n\tvar defs = {\n\t\tpage: {\n\t\t\tlabel: \"Full Page\", value: \"page\", \n\t\t\tfeatures: [\"facet\", \"type\", \"cardinality\", \"body\", \"status\", \"facet\", \"viewer\", \"control\"], \n\t\t\tcontrols: [\"delete\", \"clone\", \"add\", \"reset\", \"cancel\", \"update\", \"mode\", \"show\", \"hide\"] \n\t\t},\n\t\tline: {\n\t\t\tlabel: \"Single Line\", value: \"line\",\n\t\t\tfeatures: [\"facet\", \"type\", \"cardinality\", \"body\", \"status\", \"facet\", \"viewer\", \"control\"], \n\t\t\tcontrols: [\"delete\", \"clone\", \"add\", \"reset\", \"cancel\", \"update\", \"mode\", \"show\", \"hide\"] \n\t\t},\n\t\tinline: {\n\t\t\tlabel: \"Inline\", value: \"inline\",\n\t\t\tfeatures: [\"facet\", \"type\", \"cardinality\", \"body\", \"status\", \"facet\", \"viewer\", \"control\"], \n\t\t\tcontrols: [\"delete\", \"clone\", \"add\", \"reset\", \"cancel\", \"update\", \"mode\", \"show\", \"hide\"] \n\t\t},\n\t\tlabel: {\n\t\t\tlabel: \"Label\", value: \"label\",\n\t\t\tfeatures: [\"facet\", \"status\", \"body\"],\n\t\t\tcontrols: []\n\t\t},\n\t\ticon: {\n\t\t\tlabel: \"Snippet\", value: \"icon\",\n\t\t\tfeatures: [\"facet\", \"summary\"],\n\t\t\tcontrols: []\n\t\t}\n\t}\n\treturn defs;\n}\n\nValueRenderer.prototype.currentFacet = function(){\n\treturn this.facet;\n}\n\nValueRenderer.prototype.setOptions = function(options){\n\treturn RenderingMap.decorateRenderer(options, this);\n}\n\nValueRenderer.prototype.hideDisabledControls = function(){\n\treturn this.hide_disabled_controls;\n}\n\nValueRenderer.prototype.setMode = function(mode){\n\tthis.mode = mode;\n\tthis.options.mode = mode;\n\tthis.viewerType = false;\n\tthis.redraw();\n}\n\nValueRenderer.prototype.setView = function(view){\n\tthis.view = view;\n\tthis.options.view = view;\n\tthis.redraw();\n}\n\nValueRenderer.prototype.getAPIURL = function(a, b){\n\tif(this.parent && this.parent.parent){\n\t\tif(client = this.parent.parent.getClient()){\n\t\t\tvar apiurl = client.dbURL() + a + \"/\" + b;\n\t\t\treturn apiurl;\n\t\t}\n\t}\n\treturn false;\n}\n\nValueRenderer.prototype.getClient = function(){\n\tif(this.parent && this.parent.parent){\n\t\treturn this.parent.parent.getClient();\n\t}\t\n\treturn false;\n}\n\nValueRenderer.prototype.getController = function(){\n\tif(this.parent && this.parent.parent){\n\t\treturn this.parent.parent.getController();\n\t}\t\n\treturn false;\n}\n\nValueRenderer.prototype.DBURL = function(){\n\tif(this.parent && this.parent.parent){\n\t\tif(client = this.parent.parent.getClient()){\n\t\t\treturn client.dbURL();\n\t\t}\n\t}\t\n\treturn false;\n}\n\nValueRenderer.prototype.getEntityReference = function(url, cls, entities, opts){\n\tif(this.parent && this.parent.parent){\n\t\tif(client = this.parent.parent.getClient()){\n\t\t\treturn client.getEntityReference(url, cls, entities, opts);\n\t\t}\n\t}\n}\n\nValueRenderer.prototype.badData = function(bd){\n\talert(\"bad data \" + bd);\n}\n\nValueRenderer.prototype.setNew = function(){\n\tthis.new_value = true;\n}\n\nValueRenderer.prototype.isNew = function(){\n\tif(this.new_value){\n\t\treturn true;\n\t}\n\treturn this.parent.isNew();\n}\n\n\nValueRenderer.prototype.isUpdated = function(){\n\tif(this.frame.get() != this.originalValue){\n\t\treturn true;\n\t}\n\treturn false;\n}\n\nValueRenderer.prototype.getSummary = function(){\n\tvar ret = { status: \"ok\" };\n\tif(this.isNew()) ret.status = \"new\";\n\telse if(this.isUpdated()) ret.status = \"updated\";\n\tvar val = this.frame.get();\n\tif(val){\n\t\tif(val.length && val.length > this.text_summary_length){\n\t\t\tret.long = val.substring(0, this.text_summary_length) + \"...\" + \" (\" + val.length + \" characters)\"; \t\n\t\t}\n\t\telse {\n\t\t\tret.long = val;\n\t\t}\n\t}\n\telse {\n\t\tret.long = \"empty\";\n\t}\n\treturn ret;\n}\n\nValueRenderer.prototype.cardControlAllows = function(action){\n\tif(this.parent.cframe.hasRestriction()){\n\t\tvar rest = this.parent.cframe.restriction;\n\t\tvar currentnum = this.parent.values.length;\n\t\tif(action == \"add\" || action == \"clone\"){\n\t\t\tif(rest.max && currentnum >= rest.max){\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\tif(action == \"delete\" && (rest.min && currentnum <= rest.min)){\n\t\t\treturn false;\n\t\t}\n\t}\n\treturn true;\n}\n\nValueRenderer.prototype.set = function(v){\n\tthis.frame.set(v);\n\tthis.viewer.redrawHeader();\n\tthis.parent.childUpdated();\n}\n\nValueRenderer.prototype.delete = function(){\n\tthis.parent.deletePropertyValue(this.value(), this.index);\n\tthis.parent.parent.redraw();\n}\n\nValueRenderer.prototype.load = function(link){\n\tthis.parent.load(link);\n}\n\nValueRenderer.prototype.hide = function(){\n\tthis.setView(\"hidden\");\n}\n\nValueRenderer.prototype.show = function(){\n\tthis.setView(\"full\");\n}\n\nValueRenderer.prototype.cancel = function(){\n\tthis.reset();\n\tthis.setMode(\"view\");\n}\n\nValueRenderer.prototype.save = function(){\n\tif(this.parent) {\n\t\tthis.parent.save();\n\t}\n}\n\nValueRenderer.prototype.reset = function(){\n\tthis.set(this.originalValue);\n\tthis.redraw();\t\n}\n\nValueRenderer.prototype.clone = function(){\n\tvar newb = this.parent.addPropertyValue(this.value());\n\tvar nrend = this.copy(newb);\n\tnrend.setNew();\n\tnrend.mode = \"edit\";\n\tnrend.index = this.parent.values.length;\n\tthis.parent.values.push(nrend);\n\tthis.parent.childUpdated();\n\tthis.parent.redraw();\n\tthis.parent.goToValue(this.parent.values.length-1);\n}\n\nValueRenderer.prototype.getViewerForValue = function(){\n\treturn new HTMLDataViewer(this);\n}\n\nValueRenderer.prototype.getFeaturesForFacet = function(facet){\n\treturn this.facets[facet].features.concat(this.facets[facet].controls);\n}\n \nValueRenderer.prototype.showFeature = function(which){\n\tif(this.features.indexOf(which) == -1 && this.controls.indexOf(which) == -1) {\n\t\treturn false;\n\t}\n\tvar cardcontrols = [\"delete\", \"clone\", \"add\"];\n\tif(cardcontrols.indexOf(which) != -1){\n\t\tif(!this.cardControlAllows(which)) return false;\n\t}\n\tvar updcontrols = [\"update\", \"reset\"];\n\tif(this.hideDisabledControls() && updcontrols.indexOf(which) != -1 ){\n\t\tif(!this.isUpdated()){\n\t\t\treturn false;\n\t\t}\n\t}\n\tif(which == 'hide' && this.view == \"hidden\") return false;\n\tif(which == 'show' && this.view != \"hidden\") return false;\n\tvar fets = this.getFeaturesForFacet(this.facet);\n\treturn (fets.indexOf(which) != -1);\n}\n\n\nValueRenderer.prototype.render = function(viewer){\n\tthis.viewer = (viewer ? viewer : this.getViewerForValue());\n\treturn this.viewer.render();\n} \n\nValueRenderer.prototype.extract = function(){\n\tvar val = this.value();\n\tif(val !== \"\" && val !== false && this.frame.isDatatypeProperty()){\n\t\tvar objlit = { \"@value\": this.value()}\n\t\t\n\t\t//var objlit = { data: this.value()}\n\t\tif(this.frame.isString()) objlit[\"@language\"] = this.frame.lang();\n\t\telse objlit[\"@type\"] = this.type();\n\t\treturn objlit;\n\t}\n\telse return val;\n} \n\nValueRenderer.prototype.getValueHeaderViewer = function(){\n\treturn new HTMLDataHeaderViewer();\n}\n\nValueRenderer.prototype.getDataValueViewer = function(){\n\tif(!this.viewerType) {\n\t\tthis.viewerType = this.getViewerForDataValue();\n\t}\n\treturn RenderingMap.getViewer(this.viewerType, this.viewerOptions);\t\t\n}\n\nValueRenderer.prototype.getAvailableViewers = function(){\n\tvar dt = this.frame.getTypeShorthand();\n\tif(!dt){\n\t\talert(\"here\");\n\t}\n\tvar ft = this.frame.ftype();\n\tif(this.mode == \"view\"){\n\t\treturn RenderingMap.getAvailableDataViewers(dt, ft);\t\t\n\t}\n\treturn RenderingMap.getAvailableDataEditors(dt, ft);\t\t\t\t\n}\n\nValueRenderer.prototype.setViewer = function(viewer){\n\tthis.viewerType = viewer;\n\tthis.redraw();\n}\n\nValueRenderer.prototype.getViewerForDataValue = function(){\n\tvar dt = this.frame.getTypeShorthand();\n\tvar ft = this.frame.ftype();\n\tif(this.mode == \"edit\"){\n\t\treturn RenderingMap.getEditorForDataFrame(dt, ft);\t\t\t\t\n\t}\n\treturn RenderingMap.getViewerForDataFrame(dt, ft);\t\t\n}\n\nValueRenderer.prototype.redraw = function(){\n\tthis.viewer.clear();\n\tthis.render(this.viewer);\n}\n\nmodule.exports=ValueRenderer","/**\n * Object for producing a HTML view of a given object in a frame\n */\nconst HTMLFrameHelper = require('./HTMLFrameHelper');\nfunction HTMLObjectViewer(renderer){\n\tthis.renderer = renderer;\n\tthis.properties = [];\n\tthis.headerViewer = renderer.getObjectHeaderViewer();\n\t//this.featureViewers = {};\n}\n\n/**\n * Functions for rendering / re-rendering the object as header and body components\n */\nHTMLObjectViewer.prototype.render = function(){\n\tif(this.renderedDOM){\n\t\tvar renderedDOM = this.getObjectDOM();\n\t\tthis.renderedDOM.replaceWith(renderedDOM);\n\t\tthis.renderedDOM = renderedDOM;\n\t}\n\telse {\n\t\tthis.renderedDOM = this.getObjectDOM();\n\t}\n\tthis.renderedDOM.appendChild(this.getObjectIDMarker(this.renderer));\n\tif(this.headerViewer){\n\t\tthis.header = this.headerViewer.getAsDOM(this.renderer);\n\t\tif(this.header) this.renderedDOM.appendChild(this.header);\n\t}\n\tthis.body = this.getObjectBodyDOM();\n\tif(this.body) this.renderedDOM.appendChild(this.body);\n\treturn this.renderedDOM;\n}\n\nHTMLObjectViewer.prototype.getObjectDOM = function(){\n\tvar orientation = this.renderer.getContentOrientation();\n\tvar pcls = \"terminus-object-frame-\" + orientation;\n\tif(orientation == \"page\"){\n\t\tvar sp = document.createElement(\"div\");\n\t}\n\telse {\n\t\tvar sp = document.createElement(\"span\");\n\t}\n\tvar css = \"terminus-object-frame \" + pcls + (this.renderer.parent ? \"\" : \" terminus-root-frame\") + \" terminus-object-frame-\" + this.renderer.mode;\n\tsp.setAttribute(\"class\", css);\n\tsp.setAttribute(\"data-class\", this.renderer.subjectClass());\n\tsp.setAttribute(\"data-id\", this.renderer.subject());\n\treturn sp;\n}\n\nHTMLObjectViewer.prototype.getObjectBodyDOM = function(){\n\tvar orientation = this.renderer.getContentOrientation();\n\tvar pcls = \"terminus-object-properties-\" + orientation;\n\tif(orientation == \"page\"){\n\t\tvar vholder = document.createElement(\"div\");\n\t}\n\telse {\n\t\tvar vholder = document.createElement(\"span\");\n\t}\n    vholder.setAttribute('class', 'terminus-object-properties ' + pcls);\n    for(var prop in this.properties){\n\t\tif(this.properties[prop]) vholder.appendChild(this.properties[prop]);\n\t}\n\treturn vholder;\n}\n\nHTMLObjectViewer.prototype.getFeatureDOM = function(feature){\n\tif(this.hasFeatureViewer(feature)){\n\t\treturn this.featureViewer[feature](this.renderer, this);\n\t}\n}\n\nHTMLObjectViewer.prototype.redraw = function(){\n\tFrameHelper.removeChildren(this.renderedDOM);\n\tthis.properties = [];\n\tthis.renderer.render(this);\n}\n\nHTMLObjectViewer.prototype.redrawHeader = function(){\n\tif(this.headerViewer && this.header) {\n\t\tvar nheader = this.headerViewer.getAsDOM(this.renderer);\n\t\tthis.header.replaceWith(nheader);\n\t\tthis.header = nheader;\n\t}\n}\n\nHTMLObjectViewer.prototype.redrawBody = function(){\n\tif(this.body){\n\t\tvar nbody = this.getObjectBodyDOM();\n\t\tthis.body.replaceWith(nbody);\n\t\tthis.body = nbody;\n\t}\n}\n\n/**\n * Adds a rendered version of a property to the internal properties array\n */\nHTMLObjectViewer.prototype.addRenderedProperty = function(prop, renderedprop){\n\tthis.properties[prop] = renderedprop;\n}\n\nHTMLObjectViewer.prototype.clear = function(){\n\tFrameHelper.removeChildren(this.renderedDOM);\n\tthis.properties = {};\n}\n\n/**\n * Removes the object from the dom\n */\nHTMLObjectViewer.prototype.remove = function(){\n\tthis.renderedDOM.parentNode.removeChild(this.renderedDOM);\n}\n\nHTMLObjectViewer.prototype.goTo = function(subj, property){\n\tHTMLFrameHelper.goToName(subj, property);\n}\n\n/**\n * Generates a html anchor element to use as a marker to find the object on the page\n */\nHTMLObjectViewer.prototype.getObjectIDMarker = function(renderer){\n\tvar idm = document.createElement(\"a\");\n\tidm.setAttribute(\"class\", \"terminus-object-idmarker\");\n\tvar sh = FrameHelper.getShorthand(renderer.subject());\n    if(!sh) sh = renderer.subject();\n    if(sh){\n\t\tvar bits = sh.split(\":\");\n\t\tif(bits.length > 1) sh = bits[1];\n\t\tidm.setAttribute(\"name\", sh);\n    }\n\treturn idm;\n}\n\nfunction HTMLObjectHeaderViewer(){}\n\nHTMLObjectHeaderViewer.prototype.getAsDOM = function(renderer){\n\tvar orientation = renderer.getContentOrientation();\n\tvar pcls = \"terminus-object-frame-btn terminus-object-header-\" + orientation;\n\tif(orientation == \"page\"){\n\t\tvar objDOM = document.createElement(\"div\");\n\t}\n\telse {\n\t\tvar objDOM = document.createElement(\"span\");\n\t}\n\tobjDOM.setAttribute(\"class\", \"terminus-object-header \" + pcls);\n\tif(renderer.showFeature(\"facet\")){\n\t\tvar facetDOM = this.getObjectFacetDOM(renderer);\n\t\tif(facetDOM) objDOM.appendChild(facetDOM);\n\t}\n\tif(renderer.showFeature(\"label\")){\n\t\tvar sumDOM = this.getObjectLabelDOM(renderer);\n\t\tif(sumDOM) objDOM.appendChild(sumDOM);\n\t}\n\tif(renderer.showFeature(\"id\")){\n\t\tvar idDOM = this.getObjectIDDOM(renderer);\n\t\tif(idDOM) objDOM.appendChild(idDOM);\n\t}\n\tif(renderer.showFeature(\"type\")){\n\t\tvar typeDOM = this.getObjectTypeDOM(renderer);\n\t\tif(typeDOM) objDOM.appendChild(typeDOM);\n\t}\n\tif(renderer.showFeature(\"status\")){\n\t\tvar sumDOM = this.getObjectStatusDOM(renderer);\n\t\tif(sumDOM) objDOM.appendChild(sumDOM);\n\t}\n\tif(renderer.showFeature(\"view\")){\n\t\tvar viewDOM = this.getViewPropertyDOM(renderer);\n\t\tif(viewDOM) objDOM.appendChild(viewDOM);\n\t}\n\tif(renderer.showFeature(\"viewer\")){\n\t\tvar hideDOM = this.getViewerSelectorDOM(renderer);\n\t\tif(hideDOM) objDOM.appendChild(hideDOM);\n\t}\n\tif(renderer.showFeature(\"add\")){\n\t\tvar addDOM = this.getAddPropertyDOM(renderer);\n\t\tif(addDOM) objDOM.appendChild(addDOM);\n\t}\n\tif(renderer.showFeature(\"control\")){\n\t\tvar controlsDOM = this.getObjectControlsDOM(renderer);\n\t\tif(controlsDOM) objDOM.appendChild(controlsDOM);\n\t}\n\tif(renderer.showFeature(\"summary\")){\n\t\tvar controlsDOM = this.getObjectSummaryDOM(renderer);\n\t\tif(controlsDOM) objDOM.appendChild(controlsDOM);\n\t}\n\tobjDOM.addEventListener('click', function(){\n\t\tif((this.nextSibling.style.display == 'block') || (this.nextSibling.style.display == '')) \n\t\t\tthis.nextSibling.style.display = 'none';\n\t\telse this.nextSibling.style.display = 'block';\n\t});\n\treturn objDOM;\n}\n\nHTMLObjectHeaderViewer.prototype.getObjectSummaryDOM = function(renderer){\n\tvar sum = renderer.getSummary();\n\treturn HTMLFrameHelper.getInfoboxDOM(\"object-summary\", false, sum.long, sum.status);\n}\n\nHTMLObjectHeaderViewer.prototype.getObjectControlsDOM = function(renderer){\n\tvar controlsDOM = document.createElement(\"span\");\n\tcontrolsDOM.setAttribute(\"class\", \"terminus-object-controls\");\n\tif(renderer.showFeature(\"mode\")){\n\t\tvar viewsDOM = HTMLFrameHelper.getModeSelectorDOM(\"object\", renderer);\n\t\tif(viewsDOM) controlsDOM.appendChild(viewsDOM);\n\t}\n\tif(renderer.showFeature(\"delete\")){\n\t\tvar dpropDOM = this.getObjectDeleteDOM(renderer);\n\t\tif(dpropDOM) controlsDOM.appendChild(dpropDOM);\n\t}\n\tif(renderer.showFeature(\"clone\")){\n\t\tvar cpropDOM = this.getObjectCloneDOM(renderer);\n\t\tif(cpropDOM) controlsDOM.appendChild(cpropDOM);\n\t}\n\tif(renderer.showFeature(\"reset\")){\n\t\tvar rpropDOM = this.getObjectResetDOM(renderer);\n\t\tif(rpropDOM) controlsDOM.appendChild(rpropDOM);\n\t}\n\tif(renderer.showFeature(\"update\")){\n\t\tvar upropDOM = this.getObjectUpdateDOM(renderer);\n\t\tif(upropDOM) controlsDOM.appendChild(upropDOM);\n\t}\n\tif(renderer.showFeature(\"show\")){\n\t\tvar showDOM = this.getObjectShowDOM(renderer);\n\t\tif(showDOM) controlsDOM.appendChild(showDOM);\n\t}\n\tif(renderer.showFeature(\"hide\")){\n\t\tvar hideDOM = this.getObjectHideDOM(renderer);\n\t\tif(hideDOM) controlsDOM.appendChild(hideDOM);\n\t}\n\treturn controlsDOM;\n}\n\nHTMLObjectHeaderViewer.prototype.getObjectFacetDOM = function(renderer){\n\tvar viewables = renderer.getAvailableFacets();\n\tvar self = this;\n\tif(viewables && viewables.length){\n\t\tvar mpropDOM = document.createElement(\"span\");\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-object-facet\");\n\t\tvar callback = function(val){\n\t\t\tif(val){\n\t\t\t\trenderer.setFacet(val);\n\t\t\t}\n\t\t}\n\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"object-facet\", viewables, renderer.currentFacet(), callback);\n\t\tmpropDOM.appendChild(sel);\n\t\treturn mpropDOM;\n\t}\n\treturn false;\n}\n\nHTMLObjectHeaderViewer.prototype.getObjectLabelDOM = function(renderer){\n\tvar lab = renderer.getLabel();\n\tif(lab){\n\t\treturn HTMLFrameHelper.getInfoboxDOM(\"object-label\", false, lab);\n\t}\n\treturn false;\n}\n\nHTMLObjectHeaderViewer.prototype.getObjectIDDOM = function(renderer){\n\tvar val = renderer.subject();\n\tvar input = false;\n\tif(renderer.mode == \"edit\" && renderer.isNewDocument()){\n\t\tif(renderer.idDOM) val = renderer.idDOM.value;\n\t\tinput = document.createElement(\"input\");\n\t\tinput.setAttribute(\"class\", \"terminus-object-id-input\");\n\t\tif(val == \"_:\") val = \"\";\n\t\trenderer.idDOM = input;\n\t}\n\telse {\n\t\tif(renderer.isNewDocument() && val == \"_:\") val = \"New Document\";\n\t}\n\treturn HTMLFrameHelper.getInfoboxDOM(\"object-id\", \"ID\", val, \"Every fragment of data is identified by a unique URL\", input);\n}\n\nHTMLObjectHeaderViewer.prototype.getObjectTypeDOM = function(renderer){\n\tif(renderer.mode == \"edit\" && renderer.parent && renderer.parent.isClassChoice() && renderer.isNew()){\n\t\tvar cs = renderer.parent.getAvailableClassChoices();\n\t\tif(cs && cs.length){\n\t\t\tvar mpropDOM = document.createElement(\"span\");\n\t\t\tmpropDOM.setAttribute(\"class\", \"terminus-property-change-class\");\n\t\t\tvar mlabDOM = document.createElement(\"span\");\n\t\t\tmlabDOM.setAttribute(\"class\", \"terminus-property-change-label\");\n\t\t\tmlabDOM.appendChild(document.createTextNode(\"Type\"));\n\t\t\tmpropDOM.appendChild(mlabDOM);\n\t\t\tvar callback = function(cls){\n\t\t\t\tif(cls){\n\t\t\t\t\trenderer.changeClass(cls);\n\t\t\t\t}\n\t\t\t}\n\t\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"change-class\", cs, renderer.subjectClass(), callback);\n\t\t\tmpropDOM.appendChild(sel);\n\t\t\treturn mpropDOM;\n\t\t}\n\t}\n\tvar cm = renderer.getClassMeta(renderer.subjectClass());\n\tvar lab = renderer.subjectClass();\n\tvar cmt = \"All objects have types, identified by a unique URL\";\n\tif(cm){\n\t\tlab = (cm.Label && cm.Label[\"@value\"] ? cm.Label[\"@value\"]: lab);\n\t\tcmt = (cm.Comment && cm.Comment[\"@value\"] ? renderer.subjectClass() + \" \" + cm.Comment[\"@value\"] : cmt);\n\t}\n\treturn HTMLFrameHelper.getInfoboxDOM(\"object-type\", \"Type\", lab, cmt);\n}\n\nHTMLObjectHeaderViewer.prototype.getObjectStatusDOM = function(renderer){\n\tvar sum = renderer.getSummary();\n\treturn HTMLFrameHelper.getInfoboxDOM(\"status-\"+sum.status, false, sum.status, sum.status);\n}\n\nHTMLObjectHeaderViewer.prototype.getAddPropertyDOM = function(renderer){\n\tvar addables = renderer.getAddableProperties();\n\tif(addables && addables.length){\n\t\tvar mpropDOM = document.createElement(\"span\");\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-object-add-property\");\n\t\taddables.unshift({ value: \"\", label: \"Add New Property\"});\n\t\tvar callback = function(add){\n\t\t\tif(add){\n\t\t\t\trenderer.addNewProperty(add);\n\t\t\t}\n\t\t}\n\t\tvar disabled = (renderer.cardControlAllows(\"add\") ? false : \"Cardinality Rules Forbid Add\");\n\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"add-property\", addables, \"\", callback, disabled);\n\t\tmpropDOM.appendChild(sel);\n\t\treturn mpropDOM;\n\t}\n\treturn false;\n}\n\nHTMLObjectHeaderViewer.prototype.getViewPropertyDOM = function(renderer){\n\tvar viewables = renderer.getViewableProperties();\n\tvar self = this;\n\tif(viewables && viewables.length){\n\t\tvar mpropDOM = document.createElement(\"span\");\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-object-view-property\");\n\t\tviewables.unshift({ value: \"\", label: \"View Property\"});\n\t\tvar callback = function(add){\n\t\t\tif(add){\n\t\t\t\trenderer.goToProperty(add);\n\t\t\t}\n\t\t}\n\t\tvar sel = HTMLFrameHelper.getSelectionControl(\"view-property\", viewables, \"\", callback);\n\t\tmpropDOM.appendChild(sel);\n\t\treturn mpropDOM;\n\t}\n\treturn false;\n}\n\nHTMLObjectHeaderViewer.prototype.getObjectDeleteDOM = function(renderer){\n\tvar callback = function(){renderer.delete()};\n\tvar disabled = (renderer.cardControlAllows(\"delete\") ? false : \"Cardinality Rules Forbid Delete\");\n\treturn HTMLFrameHelper.getActionControl(\"object\", \"delete\", \"Delete\", callback, disabled);\n}\n\nHTMLObjectHeaderViewer.prototype.getObjectCloneDOM = function(renderer){\n\tvar callback = function(){renderer.clone()};\n\tvar disabled = (renderer.cardControlAllows(\"clone\") ? false : \"Cardinality Rules Forbid Clone\");\n\treturn HTMLFrameHelper.getActionControl(\"object\", \"clone\", \"Clone\", callback, disabled);\n}\n\nHTMLObjectHeaderViewer.prototype.getObjectResetDOM = function(renderer){\n\tvar callback = function(){renderer.reset()};\n\tvar disabled = (renderer.isUpdated() ? false : \"Nothing to reset\");\n\treturn HTMLFrameHelper.getActionControl(\"object\", \"reset\", \"Reset\", callback, disabled);\n}\n\nHTMLObjectHeaderViewer.prototype.getViewerSelectorDOM = function(renderer){\n\tvar viewers = renderer.getAvailableViewers();\n\tif(viewers && viewers.length){\n\t\tvar mpropDOM = document.createElement(\"span\");\n\t\tmpropDOM.setAttribute(\"class\", \"terminus-object-viewer\");\n\t\tvar callback = function(viewer){\n\t\t\tif(viewer){\n\t\t\t\trenderer.setViewer(viewer);\n\t\t\t}\n\t\t}\n\t\tvar selected = renderer.currentViewer();\n\t\tvar sel = HTMLFrameHelper.getSelectionControl('object-viewer', viewers, selected, callback);\n\t\tmpropDOM.appendChild(sel);\n\t\treturn mpropDOM;\n\t}\n\treturn false;\n}\n\nHTMLObjectHeaderViewer.prototype.getObjectHideDOM = function(renderer){\n\tvar callback = function(){renderer.hide()};\n\treturn HTMLFrameHelper.getActionControl(\"object\", \"hide\", \"Hide\", callback);\n}\n\nHTMLObjectHeaderViewer.prototype.getObjectShowDOM = function(renderer){\n\tvar callback = function(){renderer.show()};\n\treturn HTMLFrameHelper.getActionControl(\"object\", \"show\", \"Show\", callback);\n}\n\nHTMLObjectHeaderViewer.prototype.getObjectUpdateDOM = function(renderer){\n\tvar dpropDOM = document.createElement(\"span\");\n\tdpropDOM.setAttribute(\"class\", \"terminus-object-update\");\n\tif(renderer.isNewDocument()){\n\t\tvar disabled = false;//(renderer.isUpdated() ? false : \"No changes\");\n\t}\n\telse {\n\t\tvar disabled = (renderer.isUpdated() ? false : \"No changes\");\n\t}\n\tvar saveback = function(){renderer.save()};\n\tdpropDOM.appendChild(HTMLFrameHelper.getActionControl(\"object\", \"save\", \"Save\", saveback, disabled));\n\treturn dpropDOM;\n}\n\nmodule.exports={HTMLObjectViewer,HTMLObjectHeaderViewer}\n","/*\n * User Interface elements dealing with database level functions - view, delete, create, db\n * view document etc\n */\nconst FrameHelper = require('../FrameHelper');\nconst WOQLResultsViewer = require('../query/WOQLResultsViewer');\nconst TerminusClassChooser = require('./TerminusClassChooser');\nconst TerminusDocumentChooser = require('./TerminusDocumentChooser');\nconst WOQLQuery=require('../query/WOQLQuery')\nconst UTILS=require('../Utils')\n\nfunction TerminusDBController(ui){\n\t this.ui = ui;\n}\n\n/*\n * Controller provides access to the server level functions (create/delete db) and db-level functions (schema, query, document)\n */\nTerminusDBController.prototype.getAsDOM = function(){\n\tvar self = this;\n\tvar dbc = document.createElement(\"div\");\n\tdbc.setAttribute(\"class\", \"terminus-db-controller\");\n\tif(this.ui && this.ui.db()){\n\t\tvar scd = document.createElement(\"div\");\n\t\tscd.setAttribute(\"class\", \"terminus-field terminus-db-connection\");\n\t\tvar lab = document.createElement(\"span\");\n\t\tlab.setAttribute(\"class\", \"terminus-label terminus-db-label terminus-control-panel-label\");\n\t\tlab.appendChild(document.createTextNode(\"DB \"));\n\t\tvar val = document.createElement(\"span\");\n\t\tval.setAttribute(\"class\", \"terminus-value terminus-db-value terminus-control-panel-value\");\n\t\tvar dbrec = this.ui.client.connection.getDBRecord();\n\t\tvar nm = (dbrec && dbrec[\"rdfs:label\"] && dbrec[\"rdfs:label\"][\"@value\"] ? dbrec[\"rdfs:label\"][\"@value\"] : this.ui.db());\n\t\tval.appendChild(document.createTextNode(nm));\n\t\tscd.appendChild(lab);\n\t\tscd.appendChild(val);\n\t\t//dbc.appendChild(scd);\n\t\tvar nav = document.createElement('div');\n\t\tnav.setAttribute('class', 'span3');\n\t\tdbc.appendChild(nav);\n\t\tvar ul = document.createElement('ul');\n\t\tul.setAttribute('class','terminus-ul' );\n\t\tnav.appendChild(ul);\n\t\tif(this.ui.showControl(\"db\")){\n\t\t\tvar item = this.getControlHTML(\"Database Home\", \"fa-home\");\n\t\t\titem.classList.add(\"terminus-selected\");\n\t\t    item.addEventListener(\"click\", function(){\n\t\t\t\tUTILS.removeSelectedNavClass(\"terminus-selected\");\n                this.classList.add(\"terminus-selected\");\n\t\t\t\tself.ui.showDBMainPage();\n\t\t\t });\n\t        ul.appendChild(item);\n\t    }\n\t\tif(this.ui.showControl(\"delete_database\")){\n\t\t\tvar item = this.getControlHTML(\"Delete Database\", \"fa-trash-alt\");\n\t\t    item.addEventListener(\"click\", function(){ self.ui.deleteDatabase(); });\n\t        ul.appendChild(item);\n\t\t}\n\t\tif(this.ui.showControl(\"woql_select\")){\n\t\t\tvar item = this.getControlHTML(\"Query\", \"fa-search\");\n\t\t    item.addEventListener(\"click\", function(){\n\t\t\t\tUTILS.removeSelectedNavClass(\"terminus-selected\");\n                this.classList.add(\"terminus-selected\");\n\t\t\t\tself.ui.showQueryPage();\n\t\t\t});\n\t        ul.appendChild(item);\n\t\t}\n\t\tif(this.ui.showControl(\"woql_update\")){\n\t\t\tvar item = this.getControlHTML(\"Mapping\", \"fa-file-import\");\n\t        item.addEventListener(\"click\", function(){\n\t\t\t\tUTILS.removeSelectedNavClass(\"terminus-selected\");\n                this.classList.add(\"terminus-selected\");\n\t\t\t\tself.ui.showMappingPage();\n\t\t\t})\n\t        ul.appendChild(item);\n\t\t}\n\t\tif(this.ui.showControl(\"get_schema\")){\n\t\t\tvar item = this.getControlHTML(\"Schema\", \"fa-cog\");\n\t        item.addEventListener(\"click\", function(){\n\t\t\t\tUTILS.removeSelectedNavClass(\"terminus-selected\");\n                this.classList.add(\"terminus-selected\");\n\t\t\t\tself.ui.showSchemaPage();\n\t\t\t})\n\t        ul.appendChild(item);\n\t\t}\n\t\tif((this.ui.showControl(\"get_document\") || this.ui.showControl(\"create_document\"))){\n\t\t\tvar item = this.getControlHTML(\"Document\", \"fa-book\");\n\t        item.addEventListener(\"click\", function(){\n\t\t\t\tremoveSelectedNavClass(\"terminus-selected\");\n                this.classList.add(\"terminus-selected\");\n\t\t\t\tself.showDocumentSubMenus();\n\t\t\t})\n\t        ul.appendChild(item);\n\t\t}\n\t\t// hidden submenus\n\t\tif(this.ui.showControl(\"get_document\")) {\n\t\t\tvar a = document.createElement('a');\n\t\t\ta.setAttribute('class', 'terminus-nav-in-focus terminus-hide terminus-get-doc');\n\t\t\ta.appendChild(self.getDocumentChooserDOM());\n\t\t\tul.appendChild(a);\n\t\t}\n\t\t// hidden submenus\n\t\tif(this.ui.showControl(\"create_document\")) {\n\t\t\tvar a = document.createElement('a');\n\t\t\ta.setAttribute('class', 'terminus-nav-in-focus terminus-hide terminus-create-doc');\n\t\t\ta.appendChild(self.getDocumentCreatorDOM());\n\t\t\tul.appendChild(a);\n\t\t}\n\t}\n\treturn dbc;\n}\n\n\nTerminusDBController.prototype.getControlHTML = function(text, ic, css){\n    var self = this;\n    var a = document.createElement('a');\n\ta.setAttribute('class', 'terminus-a terminus-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\n    var icon = document.createElement('i');\n    icon.setAttribute('class', 'terminus-menu-icon fa ' + ic);\n    a.appendChild(icon);\n    var txt = document.createTextNode(text);\n    a.appendChild(txt);\n    return a;\n}\n\nTerminusDBController.prototype.showDocumentSubMenus = function(){\n\t//display submenus on click of documents\n\tif(this.ui.showControl(\"get_document\")) {\n\t\tvar gd = document.getElementsByClassName('terminus-get-doc');\n\t\tgd[0].classList.remove('terminus-hide');\n\t\tgd[0].classList.add('terminus-display');\n\t}\n\tif(this.ui.showControl(\"create_document\")) {\n\t\tvar cd = document.getElementsByClassName('terminus-create-doc');\n\t\tcd[0].classList.remove('terminus-hide');\n\t\tcd[0].classList.add('terminus-display');\n\t}\n}\n\nTerminusDBController.prototype.getDocumentChooserDOM = function(){\n\tvar self = this;\n\tvar scd = document.createElement(\"div\");\n\tscd.setAttribute(\"class\", \"terminus-document-chooser terminus-form-horizontal terminus-control-group terminus-choose-by-id\");\n\tvar lab = document.createElement(\"span\");\n\tlab.setAttribute(\"class\", \"terminus-document-chooser-label terminus-control-label terminus-control-label-padding\");\n\t//lab.appendChild(document.createTextNode(\"ID \"));\n\tvar dcip = document.createElement(\"input\");\n\tdcip.setAttribute(\"class\", \"terminus-form-value terminus-document-chooser terminus-doc-input-text\");\n\tdcip.setAttribute(\"placeholder\", \"Enter Document ID\");\n\tvar nbut = document.createElement(\"button\");\n\tnbut.setAttribute('class', \"terminus-control-button terminus-document-button terminus-doc-btn\")\n\tnbut.appendChild(document.createTextNode(\"View Document\"));\n\tnbut.addEventListener(\"click\", function(){\n\t\tif(dcip.value) self.ui.showDocument(dcip.value);\n\t})\n\tif(this.ui.client.connectionConfig.platformEndpoint() && this.ui.pluginAvailable(\"select2\")){\n\t\tvar mcls = FrameHelper.unshorten(\"dcog:Document\");\n\t\tvar d2ch = new TerminusDocumentChooser(this.ui, mcls);\n\t\td2ch.change = function(val){\n\t\t\talert(\"changed to \" + val);\n\t\t\tself.ui.showDocument(val);\n\t\t}\n\t\td2ch.view = \"label\";\n\t\tvar sdom = d2ch.getAsDOM('terminus-class-select');\n\t\t/*\n\t\tvar showDoc = function(durl){\n\t\t\tself.ui.showDocument(durl);\n\t\t}\n\t\tvar callback = showDoc;\n\t\tvar searchurl = self.ui.client.dbURL() + \"/search\";\n\t\tvar sdom = getS2EntityChooser(false, searchurl, this.ui.client, mcls, callback);*/\n\t\tjQuery(dcip).hide();\n\t\tjQuery(nbut).hide();\n\t\tvar nlab = document.createElement(\"a\");\n\t\tnlab.setAttribute(\"href\", \"#\");\n\t\tnlab.setAttribute(\"class\", \"terminus-document-which-chooser\");\n\t\tnlab.appendChild(document.createTextNode(\"Choose by ID\"));\n\t\tvar show = \"label\";\n\t\tjQuery(nlab).click(function(){\n\t\t\tif(show == \"label\"){\n\t\t\t\tshow = \"id\";\n\t\t\t\tjQuery(dcip).show();\n\t\t\t\tjQuery(nbut).show();\n\t\t\t\tjQuery(sdom).hide();\n\t\t\t\tjQuery(nlab).text(\"Choose by Label\");\n\t\t\t}\n\t\t\telse {\n\t\t\t\tshow = \"label\";\n\t\t\t\tjQuery(dcip).hide();\n\t\t\t\tjQuery(nbut).hide();\n\t\t\t\tjQuery(sdom).show();\n\t\t\t\tjQuery(nlab).text(\"Choose by ID\");\n\t\t\t}\n\t\t})\n\t\tscd.appendChild(sdom);\n\t\tscd.prepend(nlab);\n\t}\n\tvar nbuts = document.createElement(\"div\");\n\tnbuts.setAttribute(\"class\", \"terminus-control-buttons terminus-document-chooser-buttons\");\n\tnbuts.appendChild(nbut);\n\tscd.appendChild(lab);\n\tscd.appendChild(dcip);\n\tscd.appendChild(nbuts);\n\treturn scd;\n};\n\nTerminusDBController.prototype.getDocumentCreatorDOM = function(){\n\tvar self = this;\n\tvar scd = document.createElement(\"div\");\n\tscd.setAttribute(\"class\", \"terminus-document-creator terminus-form-horizontal terminus-control-group terminus-choose-by-id\");\n\tvar dcip = document.createElement(\"input\");\n\tdcip.setAttribute(\"class\", \"terminus-form-value terminus-document-creator terminus-doc-input-text\");\n\tdcip.setAttribute(\"placeholder\", \"Enter Document Type\");\n\tvar nbut = document.createElement(\"button\");\n\tvar lab = document.createElement(\"span\");\n\tlab.setAttribute(\"class\", \"document-creator-label terminus-control-label terminus-control-label-padding\");\n\t//lab.appendChild(document.createTextNode(\"Type \"));\n\tnbut.setAttribute('class', \"terminus-control-button create-document-button terminus-doc-btn\")\n\tnbut.appendChild(document.createTextNode(\"Create Document\"));\n\tnbut.addEventListener(\"click\", function(){\n\t\tif(dcip.value) self.ui.showCreateDocument(dcip.value);\n\t})\n\tvar nbuts = document.createElement(\"div\");\n\tnbuts.setAttribute(\"class\", \"terminus-control-buttons terminus-document-creator-buttons\");\n\t//nbuts.appendChild(nbut);\n\t//scd.appendChild(lab);\n\t//scd.appendChild(dcip);\n\t//scd.appendChild(nbuts);\n\tvar wq = new WOQLQuery(this.ui.client, {});\n\tvar filter = wq.getSubclassQueryPattern(\"Class\", \"dcog/'Document'\") + \", not(\" + wq.getAbstractQueryPattern(\"Class\") + \")\";\n\t//var filter = \"not(\" + wq.getAbstractQueryPattern(\"Class\") + \")\";\n\n\tvar termcc = new TerminusClassChooser(this.ui, filter);\n\ttermcc.empty_choice = \"Create Document of Type\";\n\ttermcc.change = function(new_class){\n\t\tif(new_class){\n\t\t\tself.ui.showCreateDocument(new_class);\n\t\t\ttermcc.choice = false;\n\t\t}\n\t}\n\tvar tcdom = termcc.getAsDOM('terminus-class-select');\n\tvar nlab = document.createElement(\"a\");\n\tnlab.setAttribute(\"href\", \"#\");\n\tnlab.setAttribute(\"class\", \"document-which-chooser document-chooser-a\");\n\tnlab.appendChild(document.createTextNode(\"Text Input\"));\n\tvar nlabs = document.createElement(\"div\");\n\tnlabs.appendChild(nlab);\n\tscd.appendChild(nlabs);\n\tvar ccDOM = document.createElement(\"span\");\n\tccDOM.setAttribute(\"class\", \"create-document-list\");\n\tccDOM.appendChild(tcdom);\n\tscd.appendChild(ccDOM);\n\tvar which = \"select\";\n\tnlab.addEventListener(\"click\", function(){\n\t\tFrameHelper.removeChildren(scd);\n\t\tscd.appendChild(nlabs);\n\t\tif(which == \"select\"){\n\t\t\tFrameHelper.removeChildren(nlab);\n\t\t\tnlab.appendChild(document.createTextNode(\"Dropdown List\"));\n\t\t\tscd.appendChild(lab);\n\t\t\tscd.appendChild(dcip);\n\t\t\tscd.appendChild(nbut);\n\t\t\twhich = \"text\";\n\t\t}\n\t\telse {\n\t\t\tscd.appendChild(ccDOM);\n\t\t\tFrameHelper.removeChildren(nlab);\n\t\t\tnlab.appendChild(document.createTextNode(\"Text Input\"));\n\t\t\twhich = \"select\";\n\t\t}\n\t});\n\treturn scd;\n};\n\n\nfunction TerminusDBViewer(ui){\n\tthis.ui = ui;\n\tthis.wquery = new WOQLQuery(ui.client, this.options);\n}\n\nTerminusDBViewer.prototype.getAsDOM = function(selected){\n\tvar pd = document.createElement(\"span\");\n\tpd.setAttribute(\"class\", \"terminus-db-home-page\");\n\tvar sth = document.createElement('div');\n\tvar banner = document.createElement('div');\n\tpd.appendChild(banner);\n\tbanner.setAttribute('class', 'terminus-banner');\n\tvar dhp = document.createElement(\"span\");\n\tdhp.setAttribute('class', 'terminus-home-heading');\n\tdhp.appendChild(document.createTextNode(\"DB Home Page - \"));\n\tsth.appendChild(dhp);\n\tvar scd = document.createElement(\"span\");\n\tscd.setAttribute(\"class\", \"terminus-db-details\");\n\tvar scs = document.createElement(\"span\");\n\tscs.setAttribute(\"class\", \"terminus-db-details-value \");\n\tvar dbrec = this.ui.getDBRecord();\n\tif(dbrec){\n\t\tvar nm = (dbrec[\"rdfs:label\"] && dbrec[\"rdfs:label\"][\"@value\"] ? dbrec[\"rdfs:label\"][\"@value\"] : this.db);\n\t\tscs.appendChild(document.createTextNode(nm));\n\t\tscs.setAttribute('class', 'terminus-home-heading');\n\t}\n\tscd.appendChild(scs);\n\tsth.appendChild(scd);\n\tbanner.appendChild(sth);\n\t//pd.appendChild(sth);\n\tpd.appendChild(UTILS.getHeaderDom('Summary'));\n\tthis.getDBSummary(pd);\n\tpd.appendChild(pd.appendChild(UTILS.getHeaderDom('List of Documents')));\n\tthis.getClassesDOM(pd);\n\treturn pd;\n}\n\nTerminusDBViewer.prototype.getDbInfoBox = function(r, module){\n\tvar sp = document.createElement('span');\n    sp.setAttribute('class', 'terminus-db-info-box');\n\tvar info = document.createElement('div');\n\tinfo.appendChild(document.createTextNode(module.charAt(0).toUpperCase() + module.slice(1)));\n\tinfo.setAttribute('class', 'terminus-db-info');\n\tsp.appendChild(info);\n\n    var i = document.createElement('i');\n\tswitch(module){\n\t\tcase 'size':\n\t\t\ti.setAttribute('class', 'terminus-icon fa fa-balance-scale');\n\t\t    var txt = document.createTextNode('2 Gb');\n\t\tbreak;\n\t\tcase 'created':\n\t\t\ti.setAttribute('class', 'terminus-icon fa fa-calendar');\n\t\t    var txt = document.createTextNode('16 July 2015');\n\t\tbreak;\n\t\tcase 'modified':\n\t\t\ti.setAttribute('class', 'terminus-icon fa fa-clock');\n\t\t    var txt = document.createTextNode('22 Dec 2019');\n\t\tbreak;\n\t}\n    sp.appendChild(i);\n\tif(txt) sp.appendChild(txt);\n    r.appendChild(sp);\n}\n\nTerminusDBViewer.prototype.getDBSummary = function(d){\n\t// delete database\n    var del = document.createElement('button');\n    del.setAttribute('class', 'terminus-del-btn');\n    del.setAttribute('type', 'button');\n    del.innerHTML = 'Delete';\n\tvar dbrec = this.ui.getDBRecord();\n\tif(dbrec)\n\t\tvar nm = (dbrec[\"rdfs:label\"] && dbrec[\"rdfs:label\"][\"@value\"] ? dbrec[\"rdfs:label\"][\"@value\"] : this.db);\n    var self = this;\n    del.addEventListener(\"click\", function(){\n      self.ui.deleteDatabase(nm);\n    });\n    d.appendChild(del);\n\n    var r = document.createElement('span');\n    r.setAttribute('class', 'terminus-db-info-box-display');\n    d.appendChild(r);\n\n    /* getDbInfoBox() calls can change according to further requirments */\n    this.getDbInfoBox(r, 'size');\n    this.getDbInfoBox(r, 'created');\n    this.getDbInfoBox(r, 'modified');\n}\n\nTerminusDBViewer.prototype.getClassesDOM = function(d){\n\tvar q = this.wquery.getClassesQuery();\n\tvar self = this;\n\tthis.wquery.execute(q)\n\t.then(function(result){\n\t\tif(true || !self.result){\n\t\t\tself.result = new WOQLResultsViewer(this.ui, result, {}, {});\n\t\t}\n\t\telse {\n\t\t\t//self.result.newResult(result);\n\t\t}\n\t\tif(self.result){\n\t\t\tvar nd = self.result.getAsDOM();\n\t\t\tif(nd){\n\t\t\t\tnd.setAttribute('class', 'terminus-margin-box');\n\t\t\t\td.appendChild(nd);\n\t        }\n\t\t\telse d.appendChild(document.createTextNode(\"No results returned\"));\n\t\t}\n\t})\n\t.catch(function(err){\n\t\tconsole.error(err);\n\t\tself.ui.showError(err);\n\t});\n\treturn d;\n}\n\n\nfunction TerminusDBCreator(ui){\n\tthis.ui = ui;\n}\n\nTerminusDBCreator.prototype.getAsDOM = function(selected){\n\tvar scd = document.createElement(\"div\");\n\tscd.setAttribute(\"class\", \"terminus-db-creator\");\n\tvar sct = document.createElement(\"h3\");\n\tsct.setAttribute(\"class\", \"terminus-db-creator-title terminus-module-head\");\n\tsct.appendChild(document.createTextNode(\"Create New Database\"));\n\tscd.appendChild(sct);\n\tvar mfd = document.createElement('div');\n\tmfd.setAttribute('class', 'terminus-form-border');\n\tscd.appendChild(mfd);\n\tvar sci = document.createElement(\"div\");\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-form-field-spacing terminus-form-horizontal terminus-control-group\");\n\tvar slab = document.createElement(\"span\");\n\tslab.setAttribute(\"class\", \"terminus-id-label terminus-form-label terminus-control-label\");\n\tslab.appendChild(document.createTextNode(\"ID\"));\n\tsci.appendChild(slab);\n\tvar idip = document.createElement(\"input\");\n\tidip.setAttribute(\"type\", \"text\");\n\tidip.setAttribute(\"class\", \"terminus-form-value terminus-input-text\");\n\tidip.setAttribute(\"placeholder\", \"No spaces or special characters allowed in IDs\");\n\tsci.appendChild(idip);\n\tmfd.appendChild(sci);\n\tvar sci = document.createElement(\"div\");\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-form-field-spacing terminus-form-horizontal terminus-control-group\");\n\tvar slab = document.createElement(\"span\");\n\tslab.setAttribute(\"class\", \"terminus-title-label terminus-form-label terminus-control-label\");\n\tslab.appendChild(document.createTextNode(\"Title\"));\n\tvar titip = document.createElement(\"input\");\n\ttitip.setAttribute(\"type\", \"text\");\n\ttitip.setAttribute(\"placeholder\", \"A brief title for the Database\");\n\ttitip.setAttribute(\"class\", \"terminus-form-value terminus-input-text\");\n\tsci.appendChild(slab);\n\tsci.appendChild(titip);\n\tmfd.appendChild(sci);\n\tvar sci = document.createElement(\"div\");\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-form-field-spacing terminus-form-horizontal terminus-control-group\");\n\tvar slab = document.createElement(\"span\");\n\tslab.setAttribute(\"class\", \"terminus-title-label terminus-form-label terminus-control-label\");\n\tslab.appendChild(document.createTextNode(\"Description\"));\n\tsci.appendChild(slab);\n\tvar descip = document.createElement(\"textarea\");\n\tdescip.setAttribute(\"class\", \"terminus-textarea terminus-db-description terminus-textarea \");\n\tdescip.setAttribute(\"placeholder\", \"A short text describing the database and its purpose\");\n\tsci.appendChild(descip);\n\tmfd.appendChild(sci);\n\tvar sci = document.createElement(\"div\");\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-form-field-spacing terminus-form-horizontal terminus-control-group\");\n\tvar slab = document.createElement(\"span\");\n\tslab.setAttribute(\"class\", \"terminus-schema-label terminus-form-label terminus-control-label\");\n\tslab.appendChild(document.createTextNode(\"Import Schema\"));\n\tsci.appendChild(slab);\n\tvar schem = document.createElement(\"input\");\n\tschem.setAttribute(\"placeholder\", \"Terminus DB URL\");\n\tschem.setAttribute(\"type\", \"text\");\n\tschem.setAttribute(\"class\", \"terminus-form-value terminus-form-url terminus-input-text\");\n\n\tsci.appendChild(schem);\n\tmfd.appendChild(sci);\n\tvar sci = document.createElement(\"div\");\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-form-field-spacing terminus-form-horizontal terminus-control-group\");\n\tvar slab = document.createElement(\"span\");\n\tslab.setAttribute(\"class\", \"terminus-data-label terminus-form-label terminus-control-label\");\n\tslab.appendChild(document.createTextNode(\"Import Data\"));\n\tsci.appendChild(slab);\n\tvar datip = document.createElement(\"input\");\n\tdatip.setAttribute(\"type\", \"text\");\n\tdatip.setAttribute(\"placeholder\", \"Terminus DB URL\");\n\tdatip.setAttribute(\"class\", \"terminus-form-value terminus-form-url terminus-input-text\");\n\tsci.appendChild(datip);\n\tmfd.appendChild(sci);\n\tvar butfield = document.createElement(\"div\");\n\tbutfield.setAttribute(\"class\", \"terminus-control-buttons\");\n\tvar cancbut = document.createElement(\"button\");\n\tcancbut.setAttribute(\"class\", \"terminus-control-button terminus-cancel-db-button terminus-btn\");\n\tcancbut.appendChild(document.createTextNode(\"Cancel\"));\n\tvar loadbut = document.createElement(\"button\");\n\tloadbut.setAttribute(\"class\", \"terminus-control-button terminus-create-db-button terminus-btn\");\n\tloadbut.appendChild(document.createTextNode(\"Create\"));\n\tvar self = this;\n\tvar gatherips = function(){\n\t\tvar input = {};\n\t\tinput.id = idip.value;\n\t\tinput.title = titip.value;\n\t\tinput.description = descip.value;\n\t\tinput.schema = schem.value;\n\t\tinput.data = datip.value;\n\t\treturn input;\n\t}\n\tvar self = this;\n\tloadbut.addEventListener(\"click\", function(){\n\t\tvar input = gatherips();\n\t\tself.ui.createDatabase(input);\n\t})\n\tcancbut.addEventListener(\"click\", function(){\n\t\tself.ui.showServerMainPage();\n\t})\n\tbutfield.appendChild(cancbut);\n\tbutfield.appendChild(loadbut);\n\tmfd.appendChild(butfield);\n\treturn scd;\n}\n\nmodule.exports={TerminusDBViewer:TerminusDBViewer,\n\t            TerminusDBController:TerminusDBController,\n\t            TerminusDBCreator:TerminusDBCreator}\n","const FrameHelper = require('../FrameHelper');\nconst WOQLQuery = require('../query/WOQLQuery');\nconst WOQLResult = require('../query/WOQLResult');\nconst WOQLResultsViewer = require('../query/WOQLResultsViewer');\nconst WOQLTextboxGenerator = require('../query/WOQLTextboxGenerator');\nconst WOQLGraphBrowserGenerator = require('../query/WOQLGraphBrowserGenerator');\nconst TerminusPluginManager = require('../plugins/TerminusPlugin');\n\nfunction TerminusQueryViewer(ui, options){\n\tthis.ui = ui;\n\tthis.options = options;\n\tthis.meta = {};\n\tthis.init();\n\tthis.generator = false;\n\tthis.result = false;\n\tthis.wquery = new WOQLQuery(ui.client, this.options);\n\tthis.pman = new TerminusPluginManager();\n\tthis.gentype = (options && options.generator ? options.generator : \"textbox\");\n\tthis.generators = {\n\t\t\"textbox\" : { label: \"Simple Text Box\", value: \"textbox\"},\n\t}\n\tif(ui.pluginAvailable(\"jqueryui\")){\n\t\tthis.generators.gbrowse = { label: \"Graph Browser\", value: \"gbrowse\"};\n\t}\n\tthis.loadGenerator();\n}\n\nTerminusQueryViewer.prototype.hasGeneratorOptions = function(){\n\treturn false;\n\tvar yup = false;\n\tfor(var gen in this.generators){\n\t\tif(yup) return true;\n\t\telse yup = true;\n\t}\n\treturn false;\n}\n\nTerminusQueryViewer.prototype.changeGenerator = function(ng){\n\tif(this.gentype != ng){\n\t\tthis.gentype = ng;\n\t\tthis.loadGenerator();\n\t\tthis.redrawGenerator();\n\t}\n}\nTerminusQueryViewer.prototype.redrawGenerator = function(q){\n\tFrameHelper.removeChildren(this.inputDOM);\n\tthis.inputDOM.appendChild(this.getQueryButtonsDOM(q));\n}\n\nTerminusQueryViewer.prototype.loadGenerator = function(){\n\tvar self = this;\n\tvar nquery = function(q, settings){\n\t\tself.query(q, settings)\n\t}\n\tif(this.gentype == \"textbox\"){\n\t\tthis.generator = new WOQLTextboxGenerator(nquery, this, this.ui);\n\t}\n\telse if(this.gentype == \"gbrowse\"){\n\t\tthis.generator = new WOQLGraphBrowserGenerator(nquery, this, this.ui);\n\t}\n}\n\nTerminusQueryViewer.prototype.init = function(){\n\tvar wq = new WOQLQuery(this.ui.client, this.options);\n\tvar woql = wq.getElementMetaDataQuery();\n\tvar self = this;\n\tself.meta = {};\n\twq.execute(woql).then(function(wresult){\n\t\tvar wqlR = new WOQLResult(wresult, null ,null);\n\t\tif(wqlR.hasBindings(wresult)){\n\t\t\tfor(var i = 0; i<wresult.bindings.length; i++){\n\t\t\t\tvar el = wresult.bindings[i].Element;\n\t\t\t\tif(el && typeof self.meta[el] == \"undefined\"){\n\t\t\t\t\tself.meta[el] = wresult.bindings[i];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t})\n\t.catch(function(e){\n\t\tconsole.error(e);\n\t});\n}\n\n\nTerminusQueryViewer.prototype.query = function(val, settings, tab){\n\tvar self = this;\n\tFrameHelper.removeChildren(this.resultDOM);\n\tthis.wquery.execute(val)\n\t.then(function(result){\n\t\tif(true || !self.result){\n\t\t\tself.result = new WOQLResultsViewer(self.ui, result, self.options, settings);\n\t\t}\n\t\telse {\n\t\t\t//self.result.newResult(result);\n\t\t}\n\t\tvar nd = self.result.getAsDOM(self.resultDOM);\n\t\tif(nd){\n\t\t\t self.resultDOM.appendChild(nd);\n\t\t}\n\t})\n\t.catch(function(err){\n\t\tconsole.error(err);\n\t\tself.ui.showError(err);\n\t});\n}\n\nTerminusQueryViewer.prototype.getResultViewDom = function(){\n\tthis.resultDOM = document.createElement(\"div\");\n\tthis.resultDOM.setAttribute(\"class\", \"terminus-query-results\");\n}\n\nTerminusQueryViewer.prototype.getAsDOM = function(q){\n\tvar qbox = document.createElement(\"div\");\n\tqbox.setAttribute(\"class\", \"terminus-query-page\");\n\tif(this.hasGeneratorOptions()){\n\t\tqbox.appendChild(this.getQueryCreatorChoiceDOM(q));\n\t}\n\tthis.resultDOM = document.createElement(\"div\");\n\tthis.resultDOM.setAttribute(\"class\", \"terminus-query-results\");\n\tthis.qTextBox = this.getQueryTextAreaDOM(q, qbox);\n\t//this.qTextBox.appendChild(this.getQueryTextAreaDOM(q));\n\tthis.buttonsDOM = document.createElement(\"div\");\n\tthis.buttonsDOM.setAttribute(\"class\", \"terminus-query-input\");\n\tthis.buttonsDOM.appendChild(this.getQueryButtonsDOM(q, this.qTextBox));\n\tqbox.appendChild(this.resultDOM);\n\tqbox.appendChild(this.buttonsDOM);\n\treturn qbox;\n}\n\nTerminusQueryViewer.prototype.getQueryCreatorChoiceDOM = function(){\n\tvar qcc = document.createElement(\"select\");\n\tqcc.setAttribute(\"class\", \"terminus-query-generator-selector\");\n\tfor(var c in this.generators){\n\t\tvar gen = this.generators[c];\n\t\tvar opt = document.createElement(\"option\");\n\t\topt.value = (gen.value ? gen.value : c);\n\t\tvar lab = (gen.label ? gen.label : c);\n\t\topt.appendChild(document.createTextNode(lab));\n\t\tqcc.appendChild(opt);\n\t}\n\tvar self = this;\n\tqcc.addEventListener(\"change\", function(){\n\t\tself.changeGenerator(this.value);\n\t});\n\treturn qcc;\n}\n\nTerminusQueryViewer.prototype.getQueryButtonsDOM = function(q, qip){\n\t//input options ...\n\t//this.inputDOM.appendChild(this.getQueryCreatorChoiceDOM());\n\treturn this.generator.getAsDOM(q, qip);\n}\n\nTerminusQueryViewer.prototype.getQueryTextAreaDOM = function(q, box){\n\treturn this.generator.getQueryTextAreaDOM(q, box);\n}\n\nmodule.exports=TerminusQueryViewer\n","const FrameHelper = require('../FrameHelper');\nconst TerminusClassChooser = require('../client/TerminusClassChooser');\nconst TerminusPropertyChooser = require('../client/TerminusPropertyChooser');\nconst TerminusDocumentChooser = require('../client/TerminusDocumentChooser');\nconst UTILS= require('../Utils')\nfunction WOQLTextboxGenerator(tq, qman, ui){\n\tthis.query = tq;\n\tthis.wquery = qman.wquery;\n\tthis.ui = ui;\n\t// default datatable settings if datatable plug in available\n\tthis.datatable = {};\n\tthis.datatable.pageLength = 5;\n\tthis.datatable.start = 0;\n}\n\nWOQLTextboxGenerator.prototype.gatherDatatableSettings = function(txtArea, queryName){\n\tthis.datatable.qTextDom =  txtArea;\n\tthis.datatable.query =  queryName;\n\tthis.datatable.chosenValue = null;\n}\n\nWOQLTextboxGenerator.prototype.getQueryButtonGroups = function(qbox){\n\tvar row = document.createElement('div');\n\trow.setAttribute('class', 'terminus-query-group-row');\n\tqbox.appendChild(row);\n\treturn row;\n}\n\nWOQLTextboxGenerator.prototype.qGroupQueries = function(qrow, header, descr){\n\tvar g = document.createElement('div');\n\tg.setAttribute('class', 'terminus-group-box');\n\n\tvar cd = document.createElement('div');\n\tcd.setAttribute('class', 'terminus-group');\n\tg.appendChild(cd);\n\n\tvar ch = document.createElement('div');\n\tch.setAttribute('class', 'terminus-group-header');\n\tcd.appendChild(ch);\n\n\tvar h = document.createElement('h3');\n\th.appendChild(document.createTextNode(header));\n\tch.appendChild(h);\n\n\tvar t = document.createElement('h5');\n\tt.setAttribute('class', 'terminus-group-sub-title');\n\tt.appendChild(document.createTextNode(descr));\n\tch.appendChild(t);\n\n\tqrow.appendChild(g);\n\n\treturn g;\n}\n\nWOQLTextboxGenerator.prototype.setDatatableSettings = function(query){\n\tvar newQuery = query.replace(/\\s/g,'');  // remove spaces\n\tvar searchStr = 'limit(';\n\tif(newQuery.indexOf(searchStr) !== -1){\n\t\tvar remString = newQuery.substring(searchStr.length, newQuery.length);\n\t\tvar limit = remString.substr(0, remString.indexOf(','));\n\t\tthis.datatable.pageLength = limit;\n\t\tthis.datatable.start = 0;\n\t}\n}\n\nWOQLTextboxGenerator.prototype.getQueryTextAreaDOM = function(q, box){\n\tvar qbox = document.createElement(\"div\");\n\tqbox.setAttribute(\"class\", \"terminus-query-textbox-input\");\n\n\tvar eqh = document.createElement(\"H3\");\n\teqh.appendChild(document.createTextNode(\"Enter Query\"));\n\teqh.setAttribute('class', 'terminus-full-css-margin-top terminus-module-head');\n\tqbox.appendChild(eqh);\n\n\tvar qip = document.createElement(\"textarea\");\n\tqip.setAttribute(\"class\", \"terminus-query-box\");\n\tqip.setAttribute(\"placeholder\", \"Enter new query or load queries from example buttons provided below ...\");\n\tqip.setAttribute(\"style\", \"min-width: 400px; min-height: 60px;\");\n\tif(q) qip.value = q;\n\tqbox.appendChild(qip);\n\tUTILS.stylizeEditor(this.ui, qip, 'query', 'javascript');\n\tvar self = this;\n\tvar qbut = document.createElement(\"button\");\n\tqbut.setAttribute(\"class\", \"terminus-control-button terminus-query-btn\")\n\tqbut.appendChild(document.createTextNode(\"Send Query\"));\n\tqbut.addEventListener(\"click\", function(){\n\t\tif(self.ui.pluginAvailable(\"datatables\")){\n\t\t\t// pass current Example query scope while editing the text editor \n\t\t\tself.gatherDatatableSettings(qip, self.datatable.query);\n\t\t\tself.setDatatableSettings(qip.value);\n\t\t\tself.query(qip.value, self.datatable);\n\t\t}\n\t\telse self.query(qip.value);\n\t})\n\tqbox.appendChild(qbut);\n\tbox.appendChild(qbox);\n\treturn qip;\n}\n\nWOQLTextboxGenerator.prototype.getAsDOM = function(q, qip){\n\tvar qbox = document.createElement(\"div\");\n\tqbox.setAttribute(\"class\", \"terminus-query-textbox-input\");\n\tvar qbuts = document.createElement(\"div\");\n\tqbuts.setAttribute(\"class\", \"terminus-control-buttons\");\n\t//qbuts.appendChild(qbut);\n\tqbox.appendChild(qbuts);\n\tvar qexs = document.createElement(\"div\");\n\tqexs.setAttribute(\"class\", \"terminus-query-examples terminus-db-list-title \");\n\tvar qh = document.createElement(\"H3\");\n\tqh.appendChild(document.createTextNode(\"Load query from examples\"));\n\tqh.setAttribute('class', 'terminus-full-css-margin-top terminus-module-head');\n\tqexs.appendChild(qh);\n\n\tvar qrow = this.getQueryButtonGroups(qexs);\n\tqexs.appendChild(qrow);\n\n\t/* grouping class queries */\n\tvar qcGroup = this.qGroupQueries(qrow, 'Schema Queries', 'descr blah blah');\n\n\tvar nqbut = document.createElement(\"button\");\n\tnqbut.appendChild(document.createTextNode(\"Show All Classes\"));\n\tnqbut.setAttribute(\"class\", \"terminus-control-button terminus-query-btn terminus-query-btn-size\");\n\tnqbut.addEventListener(\"click\", function(){\n\t\tUTILS.deleteStylizedEditor(self.ui, qip);\n\t\tqip.value = self.wquery.getClassMetaDataQuery(null, self.datatable.pageLength, self.datatable.start);\n\t\tUTILS.stylizeEditor(self.ui, qip, 'query', 'javascript');\n\t\tif(self.ui.pluginAvailable(\"datatables\")){\n\t\t\tself.gatherDatatableSettings(qip, 'Show_All_Classes');\n\t\t\tself.query(qip.value, self.datatable);\n\t\t}\n\t\telse self.query(qip.value);\n\t})\n\n\tvar aqbut = document.createElement(\"button\");\n\taqbut.appendChild(document.createTextNode(\"Show Document Classes\"));\n\taqbut.setAttribute(\"class\", \"terminus-control-button terminus-query-btn terminus-query-btn-size\");\n\taqbut.addEventListener(\"click\", function(){\n\t\tUTILS.deleteStylizedEditor(self.ui, qip);\n\t\tqip.value = self.wquery.getClassMetaDataQuery(self.wquery.getSubclassQueryPattern(\"Class\", \"dcog/'Document'\")\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t+ \", not(\" + self.wquery.getAbstractQueryPattern(\"Class\") + \")\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tself.datatable.pageLength, self.datatable.start);\n\t\tUTILS.stylizeEditor(self.ui, qip, 'query', 'javascript');\n\t\tif(self.ui.pluginAvailable(\"datatables\")){\n\t\t\tself.gatherDatatableSettings(qip, 'Show_Document_Classes');\n\t\t\tself.query(qip.value, self.datatable);\n\t\t}\n\t\telse self.query(qip.value);\n\t})\n\n\tvar ebut = document.createElement(\"button\");\n\tebut.appendChild(document.createTextNode(\"Show All Schema Elements\"));\n\tebut.setAttribute(\"class\", \"terminus-control-button terminus-query-btn terminus-query-btn-size\");\n\tvar self = this;\n\tebut.addEventListener(\"click\", function(){\n\t\tUTILS.deleteStylizedEditor(self.ui, qip);\n\t\tqip.value = self.wquery.getElementMetaDataQuery(null, self.datatable.pageLength, self.datatable.start);\n\t\tUTILS.stylizeEditor(self.ui, qip, 'query', 'javascript');\n\t\tif(self.ui.pluginAvailable(\"datatables\")){\n\t\t\tself.gatherDatatableSettings(qip, 'Show_All_Schema_Elements');\n\t\t\tself.query(qip.value, self.datatable);\n\t\t}\n\t\telse self.query(qip.value);\n\t})\n\tvar dbut = document.createElement(\"button\");\n\tdbut.appendChild(document.createTextNode(\"Show All Documents\"));\n\tdbut.setAttribute(\"class\", \"terminus-control-button terminus-query-btn terminus-query-btn-size\");\n\tdbut.addEventListener(\"click\", function(){\n\t\tUTILS.deleteStylizedEditor(self.ui, qip);\n\t\tqip.value = self.wquery.getAllDocumentQuery(null, self.datatable.pageLength, self.datatable.start);\n\t\tUTILS.stylizeEditor(self.ui, qip, 'query', 'javascript');\n\t\tif(self.ui.pluginAvailable(\"datatables\")){\n\t\t\tself.gatherDatatableSettings(qip, 'Show_All_Documents');\n\t\t\tself.query(qip.value, self.datatable);\n\t\t}\n\t\telse self.query(qip.value);\n\t})\n\tvar pbut = document.createElement(\"button\");\n\tpbut.appendChild(document.createTextNode(\"Show All Data\"));\n\tpbut.setAttribute(\"class\", \"terminus-control-button terminus-query-btn terminus-query-btn-size\");\n\tpbut.addEventListener(\"click\", function(){\n\t\tUTILS.deleteStylizedEditor(self.ui, qip);\n\t\tqip.value = self.wquery.getEverythingQuery(null, self.datatable.pageLength, self.datatable.start);\n\t\tUTILS.stylizeEditor(self.ui, qip, 'query', 'javascript');\n\t\tif(self.ui.pluginAvailable(\"datatables\")){\n\t\t\tself.gatherDatatableSettings(qip, 'Show_All_Data');\n\t\t\tself.query(qip.value, self.datatable);\n\t\t}\n\t\telse self.query(qip.value);\n\t})\n\n\tvar prbut = document.createElement(\"button\");\n\tprbut.appendChild(document.createTextNode(\"Show All Properties\"));\n\tprbut.setAttribute(\"class\", \"terminus-control-button terminus-query-btn terminus-query-btn-size\");\n\tprbut.addEventListener(\"click\", function(){\n\t\tUTILS.deleteStylizedEditor(self.ui, qip);\n\t\tqip.value = self.wquery.getPropertyListQuery(null, self.datatable.pageLength, self.datatable.start);\n\t\tUTILS.stylizeEditor(self.ui, qip, 'query', 'javascript');\n\t\tif(self.ui.pluginAvailable(\"datatables\")){\n\t\t\tself.gatherDatatableSettings(qip, 'Show_All_Properties');\n\t\t\tself.query(qip.value, self.datatable);\n\t\t}\n\t\telse self.query(qip.value);\n\t})\n\n\t/* grouping data queries */\n\tvar qdGroup = this.qGroupQueries(qrow, 'Data Queries', 'descr blah blah');\n\n\tvar termcc = new TerminusClassChooser(this.ui);\n\ttermcc.empty_choice = \"View data of type...\";\n\tvar self = this;\n\ttermcc.change = function(new_class){\n\t\tif(new_class){\n\t\t\tUTILS.deleteStylizedEditor(self.ui, qip);\n\t\t\tqip.value = self.wquery.getDataOfChosenClassQuery(new_class, self.datatable.pageLength, self.datatable.start);\n\t\t\tUTILS.stylizeEditor(self.ui, qip, 'query', 'javascript');\n\t\t\tif(self.ui.pluginAvailable(\"datatables\")){\n\t\t\t\tself.gatherDatatableSettings(qip, 'Show_Data_Class');\n\t\t\t\tself.datatable.chosenValue = new_class; // set chosen val from drop down\n\t\t\t\tself.query(qip.value, self.datatable);\n\t\t\t}\n\t\t\telse self.query(qip.value);\n\t\t}\n\t}\n\tvar tcdom = termcc.getAsDOM('terminus-query-select');\n\n\tvar termpc = new TerminusPropertyChooser(this.ui);\n\ttermpc.empty_choice = \"Show data for property...\";\n\tvar self = this;\n\ttermpc.change = function(new_property){\n\t\tif(new_property){\n\t\t\tUTILS.deleteStylizedEditor(self.ui, qip);\n\t\t\tqip.value = self.wquery.getDataOfChosenPropertyQuery(new_property, self.datatable.pageLength, self.datatable.start);\n\t\t\tUTILS.stylizeEditor(self.ui, qip, 'query', 'javascript');\n\t\t\tif(self.ui.pluginAvailable(\"datatables\")){\n\t\t\t\tself.gatherDatatableSettings(qip, 'Show_Property_Class');\n\t\t\t\tself.datatable.chosenValue = new_property; // set chosen val from drop down\n\t\t\t\tself.query(qip.value, self.datatable);\n\t\t\t}\n\t\t\telse self.query(qip.value);\n\t\t}\n\t}\n\n\t/* grouping document queries */\n\tvar qdocGroup = this.qGroupQueries(qrow, 'Document Queries', 'descr blah blah');\n\n\tvar pdom = termpc.getAsDOM();\n\tvar docch = new TerminusDocumentChooser(this.ui);\n\tdocch.change = function(val){\n\t\tUTILS.deleteStylizedEditor(self.ui, qip);\n\t\tqip.value = self.wquery.getDocumentQuery(val, self.datatable.pageLength, self.datatable.start);\n\t\tUTILS.stylizeEditor(self.ui, qip, 'query', 'javascript');\n\t\tif(self.ui.pluginAvailable(\"datatables\")){\n\t\t\tself.gatherDatatableSettings(qip, 'Show_Document_Info_by_Id');\n\t\t\tself.datatable.chosenValue = val;\n\t\t\tself.query(qip.value, self.datatable);\n\t\t}\n\t\telse self.query(qip.value);\n\t}\n\tvar docdom = docch.getAsDOM('terminus-query-select');\n\tvar d2ch = new TerminusDocumentChooser(this.ui, FrameHelper.unshorten(\"dcog:Document\"));\n\td2ch.view = \"label\";\n\tvar d2dom = d2ch.getAsDOM('terminus-query-select');\n\tvar p = document.createElement(\"p\");\n\tp.appendChild(d2dom);\n\n\t/* class queries */\n\tqcGroup.appendChild(ebut);\n\tvar br = document.createElement('BR');\n\tqcGroup.appendChild(br);\n\tqcGroup.appendChild(nqbut);\n\tvar br = document.createElement('BR');\n\tqcGroup.appendChild(br);\n\tqcGroup.appendChild(aqbut);\n\tvar br = document.createElement('BR');\n\tqcGroup.appendChild(br);\n\tqcGroup.appendChild(prbut);\n\tvar br = document.createElement('BR');\n\tqcGroup.appendChild(br);\n\n\tqbox.appendChild(qexs);\n\n\t/* data queries */\n\tqdGroup.appendChild(tcdom);\n\tqdGroup.appendChild(pdom);\n\tvar br = document.createElement('BR');\n\tqdGroup.appendChild(br);\n\tqdGroup.appendChild(pbut);\n\n\t/* document queries */\n\tqdocGroup.appendChild(docdom);\n\tqdocGroup.appendChild(dbut);\n\tqdocGroup.appendChild(p);\n\n\treturn qbox;\n}\n\nmodule.exports=WOQLTextboxGenerator\n","/*\n * Utility Property which runs a query against the schema and presents the returned Propertyes as a drop-down / Property filter list\n */\nconst FrameHelper = require('../FrameHelper');\nconst WOQLQuery = require('../query/WOQLQuery');\n\nTerminusPropertyChooser = function(ui, filter){\n\tthis.ui = ui;\n\tthis.choice = false;\n\tthis.filter = filter;\n}\n\nTerminusPropertyChooser.prototype.setRoot = function(root){\n\tthis.root = root;\n}\n\nTerminusPropertyChooser.prototype.setFilter = function(filter){\n\tthis.filter = filter;\n}\n\nTerminusPropertyChooser.prototype.change = function(cls){\n\talert(\"Need to specify Property chooser function (\" + cls + \")\");\n}\n\nTerminusPropertyChooser.prototype.getAsDOM = function(){\n\tvar ccdom = document.createElement(\"span\");\n\tccdom.setAttribute(\"Class\", \"terminus-Class-chooser\");\n\tvar ccsel = document.createElement(\"select\");\n\tccsel.setAttribute(\"Class\", \" terminus-type-select terminus-query-select\");\n\tvar self = this;\n\tccsel.addEventListener(\"change\", function(){\n\t\tif(this.value != this.choice){\n\t\t\tthis.choice = this.value;\n\t\t\tself.change(this.value);\n\t\t}\n\t});\n\tccdom.appendChild(ccsel);\n\tvar wq = new WOQLQuery(this.ui.client);\n\tvar woql = wq.getPropertyListQuery(this.filter);\n\tvar self = this;\n\twq.execute(woql)\n\t.then(function(response){\n\t\tvar opts = self.getResultsAsOptions(response);\n\t\tfor(var i = 0; i<opts.length; i++){\n\t\t\tccsel.appendChild(opts[i]);\n\t\t}\n\t});\n\treturn ccdom;\n}\n\nTerminusPropertyChooser.prototype.getResultsAsOptions = function(clist){\n\tvar choices = [];\n\tif(this.empty_choice){\n\t\tvar opt1 = document.createElement(\"option\");\n\t\topt1.setAttribute(\"Class\", \"terminus-class-choice terminus-empty-choice\");\n\t\topt1.value = \"\";\n\t\topt1.appendChild(document.createTextNode(this.empty_choice));\n\t\tchoices.push(opt1);\n\t}\n\tif(clist.bindings){\n\t\tvar added = [];\n\t\tfor(var i = 0; i<clist.bindings.length; i++){\n\t\t\tif(clist.bindings[i].Property && added.indexOf(clist.bindings[i].Property) == -1){\n\t\t\t\tadded.push(clist.bindings[i].Property);\n\t\t\t\tvar opt = document.createElement(\"option\");\n\t\t\t\topt.setAttribute(\"Class\", \"terminus-class-choice\");\n\t\t\t\topt.value = clist.bindings[i].Property;\n\t\t\t\tvar lab = clist.bindings[i].Label;\n\t\t\t\tif(!lab || lab == \"unknown\"){\n\t\t\t\t\tlab = FrameHelper.labelFromURL(clist.bindings[i].Property);\n\t\t\t\t}\n\t\t\t\tif(lab[\"@value\"]) lab = lab[\"@value\"];\n\t\t\t\topt.appendChild(document.createTextNode(lab));\n\t\t\t\tchoices.push(opt);\n\t\t\t}\n\t\t}\n\t}\n\treturn choices;\n}\n\nmodule.exports=TerminusPropertyChooser\n","const WOQLQuery = require('./WOQLQuery');\nconst WOQLTimePicker = require('./WOQLTimePicker');\n\nfunction WOQLGraphBrowserGenerator(tq, qman, ui){\n\tthis.query = tq;\n\tthis.wquery = qman.wquery;\n\t//this.filter = new WOQLQueryFilter(this);\n\tthis.slider = new WOQLTimePicker();\n}\n\nWOQLGraphBrowserGenerator.prototype.getAsDOM = function(q){\n\tvar qbox = document.createElement(\"div\");\n\tqbox.setAttribute(\"class\", \"terminus-query-textbox-input\");\n\tqbox.appendChild(document.createTextNode(\"afsdfa\"));\n\tqbox.appendChild(this.slider.getSliderDOM());\n\treturn qbox;\n}\n\n\nfunction DCOGBrowser(controller, model, config){\n\tthis.myowner = controller;\n\tthis.model = model;\n\tthis.config = config;\n\tthis.default_viewport = (config && config.view ? config.view : \"graph\");\n\tthis.current_viewport = false;\n\n\t//internal state\n\tthis.viewports = {};\n\tthis.viewportDOMs = {};\n\tthis.browserid = randomString(8);\n\tthis.query_timeslice = false;\n\tthis.current_result = false;\n\tthis.focus_node = false;//(config && config.focus_node ? config.focus_node : \"https://datachemist.net/ipg/candidate/osoba_ipg11704456\");\n\tthis.show_filter = false;\n\t//this.relationships = model.mgraphs['main'].elements.relationships;\n\t//this.entities = model.mgraphs['main'].elements.entities;\n\t\t\n\t//this.setUpIPGSpecials();\n\t\n\tthis.entity_count = false;\n\n\tthis.config.default_display = {\n\t\ticon: \"fas fa-question\",\n\t\ticon_unicode: \"\\uf128\",\n\t\tcolor: [255,125,125],\n\t\tforward: \"Unknown\",\n\t\tbackward: \"Unknown\",\n\t\ttext: \"Unknown\"\n\t};\n}\n\n\nDCOGBrowser.prototype.init = function(){\n\tthis.filter = new DCOGQueryFilter(this, this.config, this.model);\n\tthis.slider = new DCOGTimePicker(this, this.config);\n\t//this.viewports['graph'] = new DCOGGVis(this, this.config);\n\t//this.viewports['table'] = new DCOGTable(this, this.config);\n\t//this.viewports['map'] = new DCOGMap(this, this.config);\n\t//this.viewports['api'] = new DCOGAPIView(this, this.config);\n\t//this.viewports['timeline'] = new DCOGTimeline(this, this.config);\n};\n\nDCOGBrowser.prototype.getViewportAsDOM = function(){\n\tvar vpdom = document.createElement(\"div\");\n\tvpdom.setAttribute(\"class\", \"dcog-viewport\");\n\tfor(var k in this.viewports){\n\t\tif(typeof this.viewportDOMs[k] == \"undefined\"){\n\t\t\tthis.viewportDOMs[k] = this.viewports[k].getAsDOM();\n\t\t}\n\t\tvpdom.appendChild(this.viewportDOMs[k]);\n\t}\n\treturn vpdom;\n}\n\nDCOGBrowser.prototype.newQuery = function(query, success, error){\n\tquery = (query ? query : this.getQuery());\n\tvar self = this;\n\tvar busy = this.setBusy(\"Fetching Results from Data Chemist Server\");\n\tvar handle = function(data){\n\t\tself.clearBusy(busy);\n\t\tself.current_result = new DCOGQueryResult(data, query);\n\t\tif(self.current_result.containsData()){\n\t\t\tself.setViewportData(self.current_result);\n\t\t\tif(self.focus_node){\n\t\t\t\tvar node = self.current_result.getNodeOrFringe(query.focus_node);\n\t\t\t}\n\t\t\telse if(query.from_node){\n\t\t\t\tvar node = self.current_result.getNodeOrFringe(query.from_node);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tself.entity_count = data.nodeCount;\n\t\t\t\tself.myowner.fillInfoBoxes();\n\t\t\t}\n\t\t\tif(node){\n\t\t\t\tself.nodeSelected(node);\n\t\t\t}\n\t\t\tself.rebuildController();\t\t\t\n\t\t}\n\t\telse {\n\t\t\tself.tellUser(\"No results returned\", \"warning\");\n\t\t}\n\t\tif(typeof success == \"function\") {\n\t\t\tsuccess(self.current_result);\n\t\t}\n\t};\n\tvar ehandle = function(a){\n\t\tvar msg = {title: \"Results Overload\", body: \"Your query was terminated because it would have returned too many records - please reduce the depth of your search or add extra constraints and try again\"};\n\t\tself.tellUser(msg, \"error\");\n\t\tself.clearBusy(busy);\n\t}\n\tthis.untell();\n\tthis.model.client.query(query, handle, ehandle);\n}\n\nDCOGBrowser.prototype.moreResults = function(nfocus, success){\n\tvar busy = this.setBusy(\"Fetching Results from Data Chemist Server\");\n\tvar ehandle = function(a){\n\t\tvar msg = {title: \"Results Overload\", body: \"Your query was terminated because it would have returned too many records - please reduce the depth of your search or add extra constraints and try again\"};\n\t\tself.tellUser(msg, \"error\");\n\t\tself.clearBusy(busy);\n\t}\n\tthis.focus_node = nfocus;\n\tvar self = this;\n\tvar handle = function(data){\n\t\tself.clearBusy(busy);\n\t\tself.current_result.addMoreResults(data, self.getQuery());\n\t\tself.updateViewportData(self.current_result);\n\t\tself.rebuildController();\n\t\tif(typeof success == \"function\"){\n\t\t\tsuccess(self.current_result);\n\t\t}\n\t};\n\tthis.untell();\n\tthis.model.client.query(this.getQuery(), handle, ehandle);\n}\n\nDCOGBrowser.prototype.setBusy = function(msg){\n\tvar busy = showBusyOverlay(this.myowner.insert_patterns.browser, msg);\n\tthis.busy = busy;\n\treturn busy;\n}\n\nDCOGBrowser.prototype.getQuery = function(dqr){\n\tvar qstruct = {};\n\tif(this.focus_node){\n\t\tqstruct.focus_node = this.focus_node;\n\t}\n\telse if(this.from_node && this.to_node){\n\t\tqstruct.source_node = this.from_node;\n\t\tqstruct.target_node = this.to_node;\n\t}\n\tif(this.filter && this.filter.current_relationships){\n\t\tqstruct.relationships = this.filter.current_relationships;\n\t}\n\tif(this.filter && this.filter.current_depth){\n\t\tqstruct.max_path_length = this.filter.current_depth;\n\t}\n\tif(this.filter && this.filter.current_threshold && this.filter.current_threshold > 0 && qstruct.relationships.indexOf(\"share\") != -1){\n\t\tqstruct.filters = {shareholding_threshold: this.filter.current_threshold};\n\t}\n\tif(this.slider && this.slider.server_side && this.slider.timeslice){\n\t\tthis.query_timeslice = this.slider.timeslice;\n\t}\n\telse {\n\t\tthis.query_timeslice = false;\n\t}\n\tif(this.query_timeslice){\n\t\tqstruct.date = this.query_timeslice;\n\t}\n\treturn qstruct;\n}\n\nDCOGBrowser.prototype.setView = function(which){\n\tif(which != this.current_viewport){\n\t\tthis.current_viewport = which;\n\t\tfor(var k in this.viewports){\n\t\t\tif(k != this.current_viewport) {\n\t\t\t\tif(typeof this.viewports[k][\"hibernate\"] == \"function\"){\n\t\t\t\t\t//this.viewports[k].hiberate();\n\t\t\t\t}\n\t\t\t\tjQuery(this.viewportDOMs[k]).hide();\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif(typeof this.viewports[k][\"wake\"] == \"function\"){\n\t\t\t\t\tthis.viewports[k].wake();\n\t\t\t\t}\n\t\t\t\tjQuery(this.viewportDOMs[k]).show();\n\t\t\t}\n\t\t\tthis.rebuildController();\n\t\t}\n\t}\n}\n\n\n/**\n * @summary Initialises the viewports by firing off a starter query and loading it into the contained viewports\n */\nDCOGBrowser.prototype.initData = function(which){\n\tthis.current_viewport = (which ? which : this.default_viewport);\n\tvar self = this;\n\tvar setInitNodes = function(dqr){\n\t\tif(self.focus_node){\n\t\t\tvar node = dqr.getNodeOrFringe(self.focus_node);\n\t\t\tif(node && node.groupID){\n\t\t\t\tself.nodeSelected(node);\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\t\n\t\t}\n\t\tfor(var k in self.viewports){\n\t\t\tif(typeof self.viewports[k].initDOM == \"function\"){\n\t\t\t\tself.viewports[k].initDOM(self.viewportDOMs[k]);\n\t\t\t}\n\t\t\tif(k != self.current_viewport) jQuery(self.viewportDOMs[k]).hide();\n\t\t\telse if(typeof self.viewportDOMs[k].wake == \"function\") self.viewportDOMs[k].wake()\n\t\t}\n\t}\n\tvar qstr = this.getQuery();\n\tif(qstr){\n\t\tthis.newQuery(qstr, setInitNodes);\n\t}\n\telse {\n\t\talert(\"No query string - must set filter and focus node before initialisation\");\n\t}\n}\n\nDCOGBrowser.prototype.setViewportData = function(dqr){\n\tfor(var k in this.viewports){\n\t\tthis.viewports[k].setData(dqr, k == this.current_viewport);\n\t}\n}\n\nDCOGBrowser.prototype.updateViewportData = function(dqr){\n\tfor(var k in this.viewports){\n\t\tthis.viewports[k].updateData(dqr, k == this.current_viewport);\n\t}\n}\nDCOGBrowser.prototype.setViewportFilter = function(dqr){\n\tfor(var k in this.viewports){\n\t\tif(typeof this.viewports[k].setFilter == \"function\"){\n\t\t\tthis.viewports[k].setFilter(dqr, k == this.current_viewport);\n\t\t}\n\t\telse {\n\t\t\talert(k + \" does not implement set filter browser function\");\n\t\t}\n\t}\n}\n\nDCOGBrowser.prototype.nodeSelected = function(node){\n\tif(this.focus_node != node.id){\n\t\tthis.focus_node = node.id;\n\t}\n\tvar sections = this.getNodeInfoSections(node);\n\tthis.myowner.nodeSelected(node, sections);\n}\n\nDCOGBrowser.prototype.getNodeInfoSections = function(node){\n\treturn [];\n}\n\nDCOGBrowser.prototype.followNode = function(node, success){\n\tthis.moreResults(node.id, success);\n}\n\nDCOGBrowser.prototype.setFocusNode = function(id){\n\tvar self = this;\n\tthis.focus_node = id;\n\tthis.newQuery(this.getQuery());\n}\n\nDCOGBrowser.prototype.setPathSearch = function(node_from, node_to){\n\tthis.focus_node = false;\n\tthis.from_node = node_from;\n\tthis.to_node = node_to;\n\tthis.newQuery(this.getQuery());\n}\n\nDCOGBrowser.prototype.changeTimeSlice = function(val, valto, force){\n\tif(this.current_result){\n\t\tif(!this.current_result.isTemporalSuperset(this.query_timeslice, val, valto)){\n\t\t\tthis.current_result.setQueryTimeslice(val, valto);\n\t\t\tthis.query_timeslice = this.current_result.getTimeslice()\n\t\t\tthis.newQuery(this.getQuery());\n\t\t}\n\t\telse {\n\t\t\tthis.current_result.setFilterTimeslice(val, valto);\n\t\t\tthis.setViewportFilter(this.current_result);\n\t\t}\n\t}\n}\n\nDCOGBrowser.prototype.getControllerAsDOM = function(){\n\tvar cdom = document.createElement(\"div\");\n\tcdom.setAttribute(\"class\", \"dcog-browser-controller-wrapper\");\n\tcdom.appendChild(this.getControllerViewButtonsAsDOM());\n\tcdom.appendChild(this.slider.getSliderDOM());\n\tthis.toolboxDOM = this.getUserToolboxDOM();\n\tcdom.appendChild(this.toolboxDOM);\n\tthis.rebuildController();\n\tcdom.appendChild(this.filterDOM);\n\tcdom.appendChild(this.legendDOM);\n\treturn cdom;\n}\n\nDCOGBrowser.prototype.getControllerFilterAsDOM = function(){\n\tif(this.filterDOM) {\n\t\tjQuery(this.filterDOM).empty();\n\t}\n\telse {\n\t\tvar cdom = document.createElement(\"div\");\n\t\tcdom.setAttribute(\"class\", \"dcog-browser-controller-filter\");\n\t\tthis.filterDOM = cdom;\n\t}\n\tvar fdom = this.filter.getRelationshipFilterAsDOM();\n\tvar ndom = this.filter.getQueryParameterDOM();\n\tvar ipfield = this.slider.getSliderTypeDOM();\n\tndom.appendChild(ipfield);\n\tvar self = this;\n\tvar gobut = document.createElement(\"button\");\n\tgobut.setAttribute(\"class\", \"dcog-filter-submit dcog-dashboard-button\");\n\tgobut.appendChild(document.createTextNode(\"Go\"));\n\tgobut.addEventListener(\"click\", function(){\n\t\tself.newQuery();\n\t});\n\t\n\tthis.filterDOM.appendChild(fdom);\n\tthis.filterDOM.appendChild(ndom);\n\tndom.appendChild(gobut);\n\t\n\tif(!this.show_filter){\n\t\tjQuery(this.filterDOM).hide();\n\t}\n\treturn this.filterDOM;\n}\n\nDCOGBrowser.prototype.toggleFilterVisibility = function(){\n\tif(this.show_filter){\n\t\tjQuery(this.filterDOM).hide();\n\t}\n\telse {\n\t\tjQuery(this.filterDOM).show();\n\t}\n\tthis.show_filter = !this.show_filter;\n}\n\n\nDCOGBrowser.prototype.rebuildController = function(){\n\tthis.getControllerFilterAsDOM();\n\tthis.legendDOM = this.getLegendAsDOM();\n}\n\nDCOGBrowser.prototype.untell = function(){\n\tjQuery(this.userMessageDOM).empty(); \n}\n\n\nDCOGBrowser.prototype.tellUser = function(msg, type){\n\tif(typeof msg == \"undefined\") {\n\t\tjQuery(this.userMessageDOM).empty(); \n\t}\n\telse {\n\t\ttype = (type ? type : \"info\");\n\t\tvar msgdom = document.createElement(\"span\");\n\t\tmsgdom.setAttribute(\"class\", \"dcog-browser-message dcog-message-\" + type);\n\t\tif(typeof msg == \"object\"){\n\t\t\tmsg = \"<b>\" + msg.title + \"</b> \" + msg.body;\n\t\t}\n\t\tmsgdom.innerHTML = msg;\n\t\tjQuery(this.userMessageDOM).html(msgdom);\n\t}\n}\n\nDCOGBrowser.prototype.clearBusy = function(busy){\n\tbusy = (busy ? busy : this.busy);\n\tif(busy){\t\n\t\tjQuery(busy).remove();\n\t}\n}\n\nDCOGBrowser.prototype.getUserToolboxDOM = function(){\n\tvar cdom = document.createElement(\"div\");\n\tcdom.setAttribute(\"class\", \"dcog-browser-toolbox\");\n\tvar msgdom = document.createElement(\"span\");\n\tmsgdom.setAttribute(\"class\", \"dcog-browser-message-container\");\n\tthis.userMessageDOM = msgdom;\n\tcdom.appendChild(msgdom);\n\tvar tdom = document.createElement(\"span\");\n\ttdom.setAttribute(\"class\", \"dcog-browser-tools\");\n\t//var dld = document.createElement(\"i\");\n\t//dld.setAttribute(\"class\", \"fas fa-download dcog-browser-tool-icon\");\n\tvar self = this;\n\t/*dld.addEventListener(\"click\", function(){\n\t\tif(typeof told == \"undefined\" || !told){\n\t\t\tself.tellUser(\"this is the user dialogue box - it will tell the user how to download the data\");\n\t\t\ttold = true;\n\t\t}\n\t\telse {\n\t\t\ttold = false;\n\t\t\tself.tellUser();\n\t\t}\n\t});*/\n\t//tdom.appendChild(dld);\n\tvar dlc = document.createElement(\"i\");\n\tdlc.setAttribute(\"class\", \"fas fa-cog dcog-browser-tool-icon\");\n\tdlc.addEventListener(\"click\", function(){\n\t\tself.toggleFilterVisibility();\n\t});\n\ttdom.appendChild(dlc);\n\tcdom.appendChild(tdom);\n\treturn cdom;\n}\n\nDCOGBrowser.prototype.getControllerViewButtonsAsDOM = function(){\n\tvar self = this;\n\tvar bdoms = [];\n\tvar cdom = document.createElement(\"div\");\n\tcdom.setAttribute(\"class\", \"dcog-browser-view-buttons\");\n\tfor(var k in this.viewports){\n\t\tvar bdom = document.createElement(\"button\");\n\t\tbdom.appendChild(document.createTextNode(k));\n\t\tvar i = document.createElement(\"i\");\n\t\tif(k == \"graph\"){\n\t\t\ti.setAttribute(\"class\", \"dcog-viewer-icon fas fa-code-branch\")\n\t\t}\n\t\telse if(k == \"map\"){\n\t\t\ti.setAttribute(\"class\", \"dcog-viewer-icon fas fa-globe\")\t\t\t\n\t\t}\n\t\telse if(k == \"table\"){\n\t\t\ti.setAttribute(\"class\", \"dcog-viewer-icon fas fa-list\")\t\t\t\n\t\t}\n\t\telse if(k == \"api\"){\n\t\t\ti.setAttribute(\"class\", \"dcog-viewer-icon fas fa-robot\")\t\t\t\n\t\t}\n\t\tbdom.appendChild(i);\n\t\tbdom.setAttribute(\"id\", this.browserid + k);\n\t\tif(k == this.current_viewport){\n\t\t\tbdom.setAttribute(\"class\", \"selected\");\n\t\t}\n\t\telse {\n\t\t\tbdom.setAttribute(\"class\", \"not-selected\");\n\t\t}\n\t\tbdom.addEventListener(\"click\", function(){\n\t\t\tfor(var i=0; i<bdoms.length; i++){\n\t\t\t\tbdoms[i].setAttribute(\"class\", \"not-selected\");\n\t\t\t}\n\t\t\tthis.setAttribute(\"class\", \"selected\");\n\t\t\tself.setView(this.id.substring(self.browserid.length));\n\t\t});\n\t\tbdoms.push(bdom);\n\t\tcdom.appendChild(bdom);\n\t}\n\treturn cdom;\t\n}\n\nDCOGBrowser.prototype.getLegendAsDOM = function(){\n\tif(this.legendDOM) {\n\t\tjQuery(this.legendDOM).empty();\n\t}\n\telse {\n\t\tthis.legendDOM = document.createElement(\"div\");\n\t\tthis.legendDOM.setAttribute(\"class\", \"dcog-viewport-legend\");\n\t}\n\tif(typeof this.viewports[this.current_viewport].legend == \"function\"){\n\t\tvar dom = this.viewports[this.current_viewport].legend();\n\t\tif(dom){\n\t\t\tthis.legendDOM.appendChild(dom);\n\t\t\tjQuery(this.legendDOM).show();\n\t\t}\n\t\telse {\n\t\t\tjQuery(this.legendDOM).hide();\n\t\t}\n\t}\n\treturn this.legendDOM;\n}\n\n/*\n * Display settings for shared look and field between different views - eventually to be kicked back to model \n */\n\nDCOGBrowser.prototype.getNodeRelativeSize = function(node){\n\tvar nconf = this.getNodeDisplaySettings(node);\n\tif(nconf.size) return nconf.size;\n\treturn 1;\n}\n\nDCOGBrowser.prototype.getLineWidth = function(node){\n\tvar nconf = this.getNodeDisplaySettings(node);\n\tif(nconf.size) return nconf.size;\n\treturn 4;\n}\n\nDCOGBrowser.prototype.getModelElementDisplaySettings = function(elt){\n\tif(typeof this.config.modeldisplay[elt] != \"undefined\"){\n\t\treturn jQuery.extend(true, {}, this.config.modeldisplay[elt]);\n\t}\n\talert(elt);\n\treturn jQuery.extend(true, {}, this.config.default_display);\n}\n\nDCOGBrowser.prototype.isBidirectional = function(edge){\n\tif(edge.typeID){\n\t\tvar conf = this.config.modeldisplay[edge.typeID];\n\t\tif(!conf){\n\t\t\t//jpr(edge);\n\t\t}\n\t\telse if(conf.forward && conf.backward){\n\t\t\tvar s = this.current_result.getNodeOrFringe(edge.source);\n\t\t\tvar t = this.current_result.getNodeOrFringe(edge.target);\n\t\t\tif((t && s && t.groupID && s.groupID) && (s.groupID.indexOf(\"Person\") == -1 && t.groupID.indexOf(\"Person\") == -1) )\n\t\t\t\treturn true;\t\t\n\t\t}\n\t}\n\treturn false;\n}\n\n\nDCOGBrowser.prototype.getRelationshipClass = function(nick){\n\treturn nick;\n\t//if(this.config.cmap[nick]) return this.config.cmap[nick];\n\t//return false;\n}\n\nDCOGBrowser.prototype.getGraphElementDisplaySettings = function(node){\n\tif(node){\n\t\tvar nds = this.getNodeDisplaySettings(node);\n\t\tif(!nds){\n\t\t\tnds = this.getLinkDisplaySettings(node);\n\t\t}\n\t\treturn nds;\n\t}\n\treturn false;\n}\n\nDCOGBrowser.prototype.getNodeDisplaySettings = function(node){\n\tif(typeof node.groupID != \"undefined\"){\n\t\treturn this.getModelElementDisplaySettings(node.groupID);\n\t}\n\treturn false;\n}\n\nDCOGBrowser.prototype.getLinkDisplaySettings = function(link){\n\tif(typeof link.typeID != \"undefined\"){\n\t\treturn this.getModelElementDisplaySettings(link.typeID);\n\t}\n\treturn false;\n}\n\nDCOGBrowser.prototype.getElementIcon = function(elt){\n\tvar settings = this.getGraphElementDisplaySettings(elt);\n\tif(!settings) settings = this.config.default_display;\n\treturn settings.icon;\n}\n\nDCOGBrowser.prototype.getClassIcon = function(cls){\n\tvar settings = this.getModelElementDisplaySettings(cls);\n\tif(!settings) settings = this.config.default_display;\n\treturn settings.icon;\n}\n\nDCOGBrowser.prototype.getElementIconUnicode = function(elt){\n\tvar settings = this.getGraphElementDisplaySettings(elt);\n\tif(!settings) settings = this.config.default_display;\n\treturn settings.icon_unicode;\n}\n\nDCOGBrowser.prototype.getElementColour = function(elt){\n\tvar settings = this.getGraphElementDisplaySettings(elt);\n\tif(!settings) settings = this.config.default_display;\n\treturn jQuery.extend(true, [], settings.color);\n}\n\n\nDCOGBrowser.prototype.setUpIPGSpecials = function(){\n\tthis.config.modeldisplay = {};\n\tvar reldisptypes = [\n\t\t{\n\t\t\ticon: \"fas fa-caret-right\",\n\t\t\ticon_unicode: \"\\uf0d6\",\n\t\t\tsize: 6,\n\t\t\tcolor: [125,125,255],\n\t\t},\n\t\t{\n\t\t\ticon: \"fab fa-creative-commons-by\",\n\t\t\ticon_unicode: \"\\uf4e7\",\n\t\t\tsize: 5,\n\t\t\tcolor: [255,125,125],\n\t\t},\n\t\t{\n\t\t\ticon: \"fas fa-handshake\",\n\t\t\tcolor: [125,255,125],\n\t\t\tsize: 7,\n\t\t\ticon_unicode: \"\\uf2b5\",\n\t\t},\n\t\t{\n\t\t\ticon: \"fas fa-creative-commons-nc-eu\",\n\t\t\ticon_unicode: \"\\uf4e9\",\n\t\t\tsize: 4,\n\t\t\tcolor: [50,50,50],\n\t\t},\n\t\t{\n\t\t\ticon: \"fas fa-sitemap\",\n\t\t\ticon_unicode: \"\\uf0e8\",\n\t\t\tsize: 8,\n\t\t\tcolor: [125,255,255],\n\t\t}\n\t];\n\tvar entdisptypes = [ \n\t\t {\n\t\t    \ticon: \"fas fa-users\",\n\t\t\t\tsize: 1,\n\t\t\t\ticon_unicode: \"\\uf0c0\",\n\t\t\t\tcolor: [255,125,125],\n\t\t\t},\n\t\t{\n\t\t\ticon: \"fas fa-industry\",\n\t\t\tsize: 1.5,\n\t\t\ticon_unicode: \"\\uf275\",\n\t\t\tcolor: [100,125,255],\n\t    },\n\t\t{\n\t\t\ticon: \"fas fa-user\",\n\t\t\tsize: 0.9,\n\t\t\ticon_unicode: \"\\uf007\",\n\t\t\tcolor: [125,255,125],\n\t\t},\n\t   {\n\t\t\ticon: \"fas fa-building\",\n\t\t\ticon_unicode: \"\\uf1ad\",\n\t\t\tsize: 1.4,\n\t\t\tcolor: [125,125,225],\n\t\t},\n\t\t{\n\t\t\ticon: \"fas fa-briefcase\",\n\t\t\ticon_unicode: \"\\uf0b1\",\n\t\t\tcolor: [125,125,200],\n\t\t\tsize: 1.2,\n\t\t},\n\t\t{\n\t\t\ticon: \"fas fa-user-astronaut\",\n\t\t\ticon_unicode: \"\\uf4fb\",\n\t\t\tsize: 0.9,\n\t\t\tcolor: [125,220,125],\n\t\t}\n\t];\n\t\n\tvar i = 0;\n\tfor(var rid in this.relationships){\n\t\tif(i >= reldisptypes.length) i = 0;\n\t\tvar disptype = reldisptypes[i];\n\t\tdisptype['forward'] = this.relationships[rid].label;\n\t\tthis.config.modeldisplay[rid] = disptype;\n\t\ti++;\n\t}\n\ti = 0;\n\tfor(var eid in this.entities){\n\t\tif(i >= reldisptypes.length) i = 0;\n\t\tvar disptype = entdisptypes[i];\n\t\tdisptype['text'] = this.entities[eid].label;\n\t\tthis.config.modeldisplay[eid] = disptype;\n\t\ti++;\n\t}\n}\n\nmodule.exports=WOQLGraphBrowserGenerator\n\n","WOQLTimePicker = function(config){\n\tthis.type = (config && config.slidertype ? config.slidertype : \"range\");\n\tthis.timeslice = false;\n\tvar defch = function(from, to, ss){\n\t\talert(\"changed to: (from) \" + from + \" ... (to) \" + to + \" (\" + ss + \")\");\n\t};\n\tthis.change = config && config.change ? config.change : defch;  \n\tthis.years = (config && config.years ? config.years : 20);\n\tthis.server_side = false;\n}\n\nWOQLTimePicker.prototype.toggleServerSideFiltering = function(val){\n\tthis.server_side = !this.server_side;\n}\n\nWOQLTimePicker.prototype.getSliderParameters = function(val){\n\tstart = 0;\n\tend = this.years;\n\tvar self = this;\n\tvar pointInit = {\n\t\t\tmin: start, \n\t\t\tmax: end, \n\t\t\tvalue: val,\n\t\t\tslide: function(event, ui){\n\t\t\t\tvar tt = self.tickToTime(ui.value);\n\t\t\t\tself.changeTimeSlice(tt);\n\t\t\t}\n\t}\n\tvar rangeInit = {\n\t\t\trange: true,\n\t\t\tmin: start, \n\t\t\tmax: end, \n\t\t\tvalues: val,\n\t\t\tslide: function(event, ui){\n\t\t\t\tself.changeTimeSlice(self.tickToTime(ui.values[0]), self.tickToTime(ui.values[1]));\n\t\t\t}\n\t}\n\tvar sconfig = (this.type == \"range\" ? rangeInit : pointInit);\n\treturn sconfig;\n}\n\nWOQLTimePicker.prototype.changeTimeSlice = function(val, val2, noshow){\n\tif(this.type == \"range\"){\n\t\tthis.timeslice = {};\n\t\tthis.timeslice.from = val;\n\t\tthis.timeslice.to = val2;\n\t\tthis.change(val, val2, this.server_side);\n\t}\n\telse {\n\t\tthis.timeslice = val;\n\t\tthis.change(val, false, this.server_side);\n\t}\n\tif(!noshow){\t\n\t\tthis.showCurrentPick();\n\t}\n}\n\nWOQLTimePicker.prototype.tickToTime = function(ticknum){\n\tif(ticknum == 0){\n\t\tvar nval = 0;\n\t}\n\telse {\n\t\tvar year = 31622400 ;\n\t\tvar seconds_ago = year * (this.years - ticknum);\n\t\tvar now = new Date().getTime()/1000;\n\t\tvar nval = now - seconds_ago;\n\t}\n\treturn nval;\n}\n\n\nWOQLTimePicker.prototype.timeToTick = function(timeval){\n\tif(timeval){\n\t\tvar y = (new Date(timeval * 1000)).getFullYear();\n\t\tvar thisy = (new Date()).getFullYear();\n\t\treturn this.years - (thisy -y);\n\t}\n\treturn 0;\n}\n\nWOQLTimePicker.prototype.changeSliderType = function(ntype){\n\tvar val, val2;\n\tif(this.type == \"point\" && ntype == \"range\"){\n\t\tif(this.timeslice){\n\t\t\tval = this.timeslice\n\t\t\tval2 = this.timeslice;\n\t\t}\n\t}\n\telse if(this.type == \"range\" && ntype == \"point\"){\n\t\tif(this.timeslice){\n\t\t\tif(this.timeslice.from == 0 && this.timeslice.to == 0) val = false;\n\t\t\telse if(this.timeslice.from == 0) val = this.timeslice.to;\n\t\t\telse if(this.timeslice.to == 0) val = this.timeslice.from;\n\t\t\telse val = (this.timeslice.from + this.timeslice.to) / 2;\n\t\t\tval2 = false;\n\t\t}\n\t\telse {\n\t\t\tval = 0;\n\t\t}\n\t\t\n\t}\n\tthis.type = ntype;\n\tthis.changeTimeSlice(val, val2, true);\n\tthis.updateSliderDOM();\n}\n\nWOQLTimePicker.prototype.getSliderTypeDOM = function(){\n\tvar dcd = document.createElement(\"span\");\n\tdcd.setAttribute(\"class\", \"terminus-parameter\");\n\tvar lab = document.createElement(\"label\");\n\tlab.appendChild(document.createTextNode(\"Dates\"));\n\tdcd.appendChild(lab);\n\tvar self = this;\n\tvar sel = document.createElement(\"select\");\n\tvar opt = document.createElement(\"option\");\n\topt.value = \"\";\n\topt.appendChild(document.createTextNode(\"None\"));\n\tif(this.type == \"\"){\n\t\topt.setAttribute(\"selected\", \"selected\");\n\t}\n\tsel.appendChild(opt);\n\topt = document.createElement(\"option\");\n\topt.value = \"point\";\n\topt.appendChild(document.createTextNode(\"Point\"));\n\tif(this.type == \"point\"){\n\t\topt.setAttribute(\"selected\", \"selected\");\n\t}\n\tsel.appendChild(opt);\n\topt = document.createElement(\"option\");\n\topt.value = \"range\";\n\topt.appendChild(document.createTextNode(\"Range\"));\n\tif(this.type == \"range\"){\n\t\topt.setAttribute(\"selected\", \"selected\");\n\t}\n\tsel.appendChild(opt);\n\tvar self = this;\n\tsel.addEventListener(\"change\", function(){\n\t\tif(this.value != self.type){\n\t\t\tself.changeSliderType(this.value);\n\t\t}\n\t});\n\tdcd.appendChild(sel);\n\t\n\tvar cb = document.createElement(\"input\");\n\tcb.setAttribute(\"type\", \"checkbox\");\n\tvar elid = this.browserid + \"-ssp\";\n\tif(this.server_side){\n\t\tcb.setAttribute(\"checked\", true);\n\t}\n\tvar self = this;\n\tcb.addEventListener(\"change\", function(){\n\t\tself.toggleServerSideFiltering();\n\t});\n\tvar lb = document.createElement(\"label\");\n\tlb.setAttribute(\"for\", elid);\n\tlb.appendChild(document.createTextNode(\"Server Side\"));\n\tdcd.appendChild(lb);\n\tdcd.appendChild(cb);\n\treturn dcd;\n\t\n}\n\nWOQLTimePicker.prototype.updateSliderDOM = function(){\n\tthis.slideDOM = this.getSliderDOM();\n}\n\nWOQLTimePicker.prototype.getSliderDOM = function(start, end){\n\tif(this.slideDOM){\n\t\tjQuery(this.slideDOM).empty();\n\t}\n\telse {\n\t\tthis.slideDOM = document.createElement(\"div\");\n\t\tthis.slideDOM.setAttribute(\"class\", \"terminus-controller-slider\");\n\t}\n\tif(this.type == \"\"){\n\t\tthis.changeTimeSlice(false);\n\t\treturn this.slideDOM;\n\t}\n\tvar TopAxisDOM = document.createElement(\"div\");\n\tTopAxisDOM.setAttribute(\"class\", \"terminus-controller-slider-panel terminus-controller-slider-topaxis\");\n\tif(this.type == \"point\"){\n\t\tthis.curdate = document.createElement(\"span\");\n\t\tthis.curdate.setAttribute(\"class\", \"terminus-slider-current terminus-slider-current-date\");\n\t\tTopAxisDOM.appendChild(this.curdate);\n\t}\n\telse if(this.type == \"range\") {\n\t\tthis.cursdate = document.createElement(\"span\");\n\t\tthis.cursdate.setAttribute(\"class\", \"terminus-slider-current terminus-slider-current-date-start\");\n\t\tTopAxisDOM.appendChild(this.cursdate);\n\t\tthis.curedate = document.createElement(\"span\");\t\t\n\t\tthis.curedate.setAttribute(\"class\", \"terminus-slider-current terminus-slider-current-date-end\");\n\t\tTopAxisDOM.appendChild(this.curedate);\n\t}\n\tthis.slideDOM.appendChild(TopAxisDOM);\n\tthis.showCurrentPick();\n\tvar LabelDOM = document.createElement(\"span\");\n\tLabelDOM.setAttribute(\"class\", \"terminus-controller-slider-label terminus-controller-slider-startlabel\");\n\tthis.slideDOM.appendChild(LabelDOM);\n\tvar PayloadDOM = document.createElement(\"div\");\n\tPayloadDOM.setAttribute(\"class\", \"terminus-controller-slider-payload\");\n\tthis.slideDOM.appendChild(PayloadDOM);\n\tvar L2DOM = document.createElement(\"span\");\n\tL2DOM.setAttribute(\"class\", \"terminus-controller-slider-label terminus-controller-slider-endlabel\");\n\tthis.slideDOM.appendChild(L2DOM);\n\tL2DOM.appendChild(this.getSliderAxisDOM());\n\tvar sconfig = this.getSliderParameters(this.getTimesliceAsTicks());\n\tjQuery(PayloadDOM).slider(sconfig);\n\treturn this.slideDOM;\n}\n\nWOQLTimePicker.prototype.getTimesliceAsTicks = function(){\n\tif(this.timeslice){\n\t\tif(this.type == \"range\"){\n\t\t\tvtf = (this.timeslice.from ? this.timeToTick(this.timeslice.from) : 0);\n\t\t\tvtt = (this.timeslice.to ? this.timeToTick(this.timeslice.to) : 0);\n\t\t\tvar val = [vtf, vtt];\n\t\t}\n\t\telse {\n\t\t\tvar val = this.timeToTick(this.timeslice)\n\t\t}\n\t}\n\telse {\n\t\tvar val = (this.type == \"range\" ? [0, this.years] : 0);\n\t}\n\treturn val;\n}\n\nWOQLTimePicker.prototype.showCurrentPick = function(){\n\tif(this.type == \"range\"){\n\t\tif(!this.timeslice.from) {\n\t\t\tvar nd  = new Date();\n\t\t\tvar fy = nd.getFullYear() - this.years;\n\t\t}\n\t\telse {\n\t\t\tvar nd = new Date(this.timeslice.from * 1000);\n\t\t\tvar fy = nd.getFullYear(); \n\t\t}\n\t\tthis.cursdate.innerHTML = fy;\n\t\tthis.adjustOffset(this.cursdate, this.timeslice.from);\n\t\tif(!this.timeslice.to) {\n\t\t\tvar ty = new Date().getFullYear();\n\t\t}\n\t\telse {\n\t\t\tvar ty = new Date(this.timeslice.to * 1000).getFullYear(); \n\t\t}\n\t\tif(ty != fy){\n\t\t\tthis.curedate.innerHTML = ty;\n\t\t\tthis.adjustOffset(this.curedate, this.timeslice.to, true);\n\t\t\t//jQuery(this.curedate).show();\n\t\t}\n\t\telse {\n\t\t\tthis.curedate.innerHTML = \"\";\n\t\t}\n\t}\n\telse {\n\t\tif(this.timeslice){\n\t\t\tvar nd = new Date(this.timeslice * 1000);\n\t\t\tfy = nd.getFullYear(); \n\t\t}\n\t\telse {\n\t\t\tfy = \"off\";\n\t\t}\n\t\tthis.curdate.innerHTML = fy;\n\t\tthis.adjustOffset(this.curdate, this.timeslice);\n\t}\n}\n\nWOQLTimePicker.prototype.adjustOffset = function(dom, tval, r){\n\tvar tick = this.timeToTick(tval);\n\tvar totwidth = 50 + (this.slideDOM.offsetWidth ? this.slideDOM.offsetWidth : 0);\n\tvar unit = totwidth / (this.years + 1);\n\tvar box = -25;\n\tvar which = (r ? \"margin-right\" : \"margin-left\");\n\tif(r){\n\t\tif(tick){\n\t\t\tvar off = ((this.years - tick) * unit) + box;\n\t\t}\n\t\telse {\n\t\t\tvar off = box;\n\t\t}\n\t\tdom.setAttribute(\"style\", \"margin-right: \" + off + \"px\");\n\t}\n\telse {\n\t\tvar off = unit * tick + box;\n\t\tdom.setAttribute(\"style\", \"margin-left: \" + off + \"px\");\n\t}\n}\n\nWOQLTimePicker.prototype.getSliderAxisDOM = function(){\n\tvar cdom = document.createElement(\"div\");\n\tcdom.setAttribute(\"class\", \"terminus-slider-axis-wrapper\");\n\tvar fy = new Date().getFullYear();\n\tvar sd = fy%5;\n\tvar vals = [];\n\tfor(var i = this.years; i>0; i-=5){\n\t\tvar val = (fy-i) - sd + 5;\n\t\tvals.push(val);\n\t}\n\tfor(var i = 0; i<vals.length; i++){\n\t\tvar ldom = document.createElement(\"label\");\n\t\tldom.setAttribute(\"class\", \"terminus-axis-label\");\n\t\tldom.innerHTML = \"<div class='terminus-tick'>|</div>\"+ vals[i];\n\t\tcdom.appendChild(ldom);\n\t}\n\tndom = document.createElement(\"label\");\n\tndom.setAttribute(\"class\", \"terminus-axis-label terminus-axis-now-label\");\n\tcdom.appendChild(ndom);\n\treturn cdom;\n}\n\nWOQLTimePicker.prototype.Y2Time = function(y){\n\treturn (new Date(y+ \"-12-31T12:00:00.000Z\").getTime() / 1000);\n}\n\nmodule.exports=WOQLTimePicker\n","function TerminusMappingViewer(ui, mode){\n\tthis.ui = ui;\n\tthis.mode = (mode ? mode : \"data\");\n}\n\nTerminusMappingViewer.prototype.getAsDOM = function(){\n\tvar scd = document.createElement(\"div\");\n\tscd.setAttribute(\"class\", \"terminus-mapping-page terminus-page\");\n\tvar tsel = document.createElement(\"select\");\n\tvar o1 = document.createElement(\"option\");\n\to1.value = \"data\";\n\to1.appendChild(document.createTextNode(\"Data Map\"))\n\ttsel.appendChild(o1);\n\tvar o2 = document.createElement(\"option\");\n\to2.value = \"model\";\n\to2.appendChild(document.createTextNode(\"Model Map\"))\n\ttsel.appendChild(o2);\n\tvar ff = this.getFormFieldDOM(\"Map Type\");\n\tff.appendChild(tsel);\n\tscd.appendChild(ff);\n\tvar source = this.getFormField(scd, \"Map Source\");\n\tvar target = this.getFormField(scd, \"Map Target\");\n\tvar queries = this.getFormField(scd, \"Queries\");\n\tvar options = this.getFormField(scd, \"Options\");\n\t\n\tvar mdom = this.getFormFieldDOM(\"Existing Mapping\");\n\tvar mapping = document.createElement(\"input\");\n\tmapping.setAttribute(\"type\", \"text\");\n\tmapping.setAttribute(\"size\", 80);\n\tmdom.appendChild(mapping);\n\tscd.appendChild(mdom);\n\t\n\tvar submit = document.createElement(\"button\");\n\tsubmit.setAttribute(\"class\", \"terminus-btn terminus-control-button\");\n\tsubmit.appendChild(document.createTextNode(\"Execute Mapping\"));\n\tvar self = this;\n\tsubmit.addEventListener(\"click\", function(){\n\t\tvar jsonip = {\n\t\t\tmap_source: JSON.parse(source.value),\n\t\t};\n\t\tif(tsel.value == \"data\"){\n\t\t\tjsonip[\"rdf:type\"] = \"dcogmodel:DataMap\";\n\t\t}\n\t\telse {\n\t\t\tjsonip[\"rdf:type\"] = \"dcogmodel:ModelMap\";\t\t\t\n\t\t}\n\t\tif(target.value) jsonip.map_target = target.value;\n\t\tif(queries.value) jsonip.queries = queries.value;\n\t\tif(options.value) jsonip.options = options.value;\n\t\tif(mapping.value) jsonip.mapping = mapping.value;\n\t\tself.ui.client.update(false, jsonip);\n\t})\n\tscd.appendChild(submit);\n\treturn scd;\n}\n\nTerminusMappingViewer.prototype.getFormFieldDOM = function(label){\n\tvar sci = document.createElement(\"div\");\n\tsci.setAttribute(\"class\", \"terminus-form-field terminus-mapping-field\");\n\tvar lab = document.createElement(\"span\");\n\tlab.setAttribute(\"class\", \"terminus-form-label terminus-mapping-label\");\n\tlab.appendChild(document.createTextNode(label));\n\tsci.appendChild(lab);\n\treturn sci;\n}\n\nTerminusMappingViewer.prototype.getFormField = function(holder, label){\n\tvar ff = this.getFormFieldDOM(label);\n\tvar source = document.createElement(\"textarea\");\n\tsource.setAttribute(\"class\", \"terminus-form-value terminus-textarea\");\n\tff.appendChild(source);\n\tholder.appendChild(ff);\n\treturn source;\n}\n\nmodule.exports=TerminusMappingViewer\n","/*\n * Draws the screen for viewing and updating the schema\n * and provides wrappers around the client's schema API\n */\nconst FrameHelper = require('../FrameHelper');\nconst TerminusClassChooser = require('./TerminusClassChooser');\nconst TerminusDocumentViewer = require('./TerminusDocument');\nconst UTILS=require('../Utils')\n\nfunction TerminusSchemaViewer(ui){\n\tthis.ui = ui;\n\tthis.mode = \"view\";\n\tthis.format = \"turtle\";\n\tthis.confirm_before_update = true;\n}\n\n/*\n * Retrieves schema from API and writes the response into the page\n */\nTerminusSchemaViewer.prototype.getAsDOM = function(){\n\tthis.holder = document.createElement(\"div\");\n\tthis.controldom = document.createElement(\"div\");\n\tthis.controldom.setAttribute(\"class\", \"terminus-schema-controls\");\n\tthis.pagedom = document.createElement(\"div\");\n\tthis.pagedom.setAttribute(\"class\", \"terminus-schema-viewer\");\n\tthis.loadSchema();\n\tthis.holder.appendChild(this.controldom);\n\tthis.holder.appendChild(this.pagedom);\n\treturn this.holder;\n}\n\nTerminusSchemaViewer.prototype.loadSchema = function(msg, msgtype){\n\tvar self = this;\n\tthis.ui.showBusy(\"Fetching Database Schema\");\n\tthis.ui.client.getSchema(false, {\"terminus:encoding\": \"terminus:\" + this.format})\n\t.then(function(response){\n\t\tself.ui.clearBusy();\n\t\tself.schema = response;\n\t\tself.refreshPage(msg, msgtype);\n\t})\n\t.catch(function(error){\n\t\tself.ui.clearBusy();\n\t\tself.ui.showError(error);\n\t});\n}\n\nTerminusSchemaViewer.prototype.resetControlDOM = function(){\n\tFrameHelper.removeChildren(this.controldom);\n\tif(this.mode == \"edit\"){\n\t\tthis.controldom.appendChild(this.getSchemaSaveButtons());\n\t}\n\telse if(this.mode == \"import\"){\n\t\tthis.controldom.appendChild(this.getSchemaImportActionButtons());\n\t}\n\telse if(this.mode == \"class_frame\"){\n\t\tif(this.ui.showControl(\"get_schema\")){\n\t\t\tthis.controldom.appendChild(this.getShowSchemaButton());\n\t\t}\n\t\tif(this.ui.showControl(\"class_frame\")){\n\t\t\tthis.controldom.appendChild(this.getClassFrameChooser());\n\t\t}\n\t}\n\telse if(this.mode == \"view\"){\n\t\tif(this.ui.showControl(\"import_schema\")){\n\t\t\tthis.controldom.appendChild(this.getImportButton());\n\t\t}\n\t\tif(this.ui.showControl(\"update_schema\")){\n\t\t\tthis.controldom.appendChild(this.getSchemaEditButton());\n\t\t}\n\t\tif(this.ui.showControl(\"schema_format\")){\n\t\t\tthis.controldom.appendChild(this.getFormatChoices());\n\t\t}\n\t\tif(this.ui.showControl(\"class_frame\")){\n\t\t\tthis.controldom.appendChild(this.getClassFrameChooser());\n\t\t}\n\t}\n}\n\nTerminusSchemaViewer.prototype.getFormatChoices = function(){\n\tvar fc = document.createElement(\"select\");\n\tfc.setAttribute(\"class\", \"terminus-form-select terminus-schema-format terminus-type-select\");\n\tvar tc = document.createElement(\"option\");\n\ttc.setAttribute(\"class\", \"terminus-schema-turtle\");\n\ttc.value = \"turtle\";\n\ttc.appendChild(document.createTextNode(\"Turtle\"));\n\tif(this.format == \"turtle\") tc.selected = true;\n\tfc.appendChild(tc);\n\tvar tj = document.createElement(\"option\");\n\ttj.setAttribute(\"class\", \"terminus-schema-jsonld\");\n\ttj.value = \"jsonld\";\n\ttj.appendChild(document.createTextNode(\"Json LD\"));\n\tif(this.format == \"jsonld\") tj.selected = true;\n\tfc.appendChild(tj);\n\tvar self = this;\n\tfc.addEventListener(\"change\", function(e){\n\t\tself.format = this.value;\n\t\tself.loadSchema();\n\t});\n\treturn fc;\n}\n\n\nTerminusSchemaViewer.prototype.refreshPage = function(msg, msgtype){\n\tif(this.controldom) this.resetControlDOM();\n\tif(this.pagedom) this.refreshMainPage(msg, msgtype);\n}\n\nTerminusSchemaViewer.prototype.refreshMainPage = function(msg, msgtype){\n\tFrameHelper.removeChildren(this.pagedom);\n\tif(this.mode == 'view'){\n\t\tthis.pagedom.appendChild(this.getSchemaViewDOM());\n\t}\n\telse if(this.mode == \"edit\"){\n\t\tthis.pagedom.appendChild(this.getSchemaEditDOM());\n\t}\n\telse if(this.mode == \"import\"){\n\t\tthis.pagedom.appendChild(this.getSchemaImportDOM());\n\t}\n\telse if(this.mode == \"class_frame\"){\n\t\tthis.pagedom.appendChild(this.getClassFrameDOM());\n\t}\n\tif(msg){\n\t\tthis.ui.showMessage(msg, msgtype);\n\t}\n}\n\nTerminusSchemaViewer.prototype.getSchemaSaveButtons = function(){\n\tvar ssb = document.createElement(\"span\");\n\tssb.setAttribute(\"class\", \"terminus-schema-save-buttons\");\n\tssb.appendChild(this.getCancelButton());\n\tssb.appendChild(this.getSaveButton());\n\treturn ssb;\n}\n\nTerminusSchemaViewer.prototype.getSchemaImportActionButtons = function(){\n\tvar ssb = document.createElement(\"span\");\n\tssb.setAttribute(\"class\", \"terminus-schema-import-buttons\");\n\tssb.appendChild(this.getCancelButton());\n\tssb.appendChild(this.getImportPreviewButton());\n\tssb.appendChild(this.getImportSaveButton());\n\treturn ssb;\n}\n\nTerminusSchemaViewer.prototype.getShowSchemaButton = function(){\n\tvar self = this;\n\tvar func = function(){\n\t\tself.ui.clearMessages();\n\t\tself.mode = \"view\";\n\t\tself.refreshPage();\n\t}\n\treturn this.getSchemaButton(\"View Schema\", \"get_schema\", func);\n}\n\nTerminusSchemaViewer.prototype.getImportPreviewButton = function(){\n\tvar self = this;\n\tvar func = function(){\n\t\tself.ui.clearMessages();\n\t\tself.mode = \"preview\";\n\t\tself.refreshPage();\n\t}\n\treturn this.getSchemaButton(\"Preview\", \"preview\", func);\n}\n\nTerminusSchemaViewer.prototype.getCancelButton = function(){\n\tvar self = this;\n\tvar func = function(){\n\t\tself.ui.clearMessages();\n\t\tself.mode = \"view\";\n\t\tself.refreshPage();\n\t}\n\treturn this.getSchemaButton(\"Cancel\", \"cancel_update\", func);\n}\n\nTerminusSchemaViewer.prototype.getImportSaveButton = function(){\n\tvar self = this;\n\tvar func = function(){\n\t\tself.ui.clearMessages();\n\t\tif(typeof self.doImport == \"function\"){\n\t\t\tself.doImport();\n\t\t}\n\t}\n\treturn this.getSchemaButton(\"Import\", \"import_schema\", func)\n}\n\nTerminusSchemaViewer.prototype.getSaveButton = function(){\n\tvar self = this;\n\tvar func = function(){\n\t\tself.ui.clearMessages();\n\t\tvar text = self.schema_edit_dom.value;\n\t\tif(typeof(self.schema) == \"object\"){\n\t\t\ttext = JSON.parse(text);\n\t\t}\n\t\treturn self.updateSchema(text, {\"terminus:encoding\": \"terminus:\" + self.format});\n\t}\n\treturn this.getSchemaButton(\"Save\", \"update_schema\", func);\n}\n\nTerminusSchemaViewer.prototype.getSchemaEditButton = function(){\n\tvar self = this;\n\tvar func = function(){\n\t\tself.mode = \"edit\";\n\t\tself.refreshPage();\n\t}\n\treturn this.getSchemaButton(\"Edit\", \"update_schema\", func);\n}\n\nTerminusSchemaViewer.prototype.getImportButton = function(){\n\tvar self = this;\n\tvar func = function(){\n\t\tself.ui.clearMessages();\n\t\tself.mode = \"import\";\n\t\tself.refreshPage();\n\t}\n\treturn this.getSchemaButton(\"Import Schema\", \"import_schema\", func);\n}\n\nTerminusSchemaViewer.prototype.getSchemaButton = function(label, action, func){\n\tvar opt = document.createElement(\"button\");\n\topt.appendChild(document.createTextNode(label));\n\topt.setAttribute(\"class\", \"terminus-btn terminus-control-button terminus-schema-\" + action);\n\topt.addEventListener(\"click\", func);\n\treturn opt;\n}\n\n/*\n * Updates schema, then fetches updated version and updates the page with it\n */\nTerminusSchemaViewer.prototype.updateSchema  = function(text, opts){\n\tthis.ui.showBusy(\"Updating Database Schema\");\n\tvar self = this;\n\treturn this.ui.client.updateSchema(false, text, opts)\n\t.then(function(response){\n\t\tif(response['terminus:status'] && response['terminus:status'] == \"terminus:success\"){\n\t\t\tself.ui.showBusy(\"Retrieving updated schema\");\n\t\t\tself.mode = \"view\";\n\t\t\tself.loadSchema(\"Successfully Updated Schema\");\t\t\t\n\t\t}\n\t\telse if(response['terminus:status'] && response['terminus:status'] == \"terminus:failure\"){\n\t\t\tself.ui.clearBusy();\n\t\t\tself.ui.showViolations(response['terminus:witnesses'], \"schema\");\n\t\t}\n\t\telse {\n\t\t\tthrow new Error(\"Update Schema returned no terminus:status code\");\n\t\t}\n\t})\n\t.catch(function(error){\n\t\tself.ui.clearBusy();\n\t\tself.ui.showError(error);\n\t});\n}\n\n/*\n * Imports a schema from the passed url\n * mode: replace | append\n */\nTerminusSchemaViewer.prototype.load  = function(url, key, mode){\n\tvar self = this;\n\tmode = (mode ? mode : \"replace\");\n\tthis.ui.showBusy(\"Loading schema from \" + url);\n\treturn this.ui.client.getSchema(url, {key: key, format: this.format})\n\t.then(function(response){\n\t\tvar newschema = (mode == \"append\") ? self.appendSchema(response) : response;\n\t\tif(self.confirm_before_update){\n\t\t\tself.showConfirmPage(newschema);\n\t\t}\n\t\telse {\n\t\t\tself.ui.showBusy(\"Updating schema\");\n\t\t\tself.updateSchema(false, newschema).then(function(response){\n\t\t\t\tself.ui.clearBusy();\n\t\t\t\tself.ui.showResult(\"Successfully deployed new schema from \" + url);\n\t\t\t\treturn response;\n\t\t\t});\n\t\t}\n\t}).catch(function(error){\n\t\tself.ui.clearBusy();\n\t\tself.ui.showError(error);\n\t});\n}\n\nTerminusSchemaViewer.prototype.appendSchema = function(s2){\n\tvar nschema = this.schema;\n\tif(this.format == 'turtle'){\n\t\tnschema = this.schema + s2;\n\t}\n\telse if(this.format == 'jsonld'){\n\t\tfor(var i in s2){\n\t\t\tnschema[i] = s2[i];\n\t\t}\n\t}\n\treturn nschema;\n}\n\nTerminusSchemaViewer.prototype.getClassFrameChooser = function(){\n\tvar np = document.createElement(\"span\");\n\tnp.setAttribute(\"class\", \"terminus-classframe-chooser\");\n\tvar termcc = new TerminusClassChooser(this.ui);\n\ttermcc.empty_choice = \"View Individual Class Frames\";\n\tvar self = this;\n\ttermcc.change = function(new_class){\n\t\tif(new_class){\n\t\t\tself.cls = new_class;\n\t\t\tif(self.mode != \"class_frame\"){\n\t\t\t\tself.mode = \"class_frame\";\n\t\t\t\tself.refreshPage();\n\t\t\t}\n\t\t\telse {\n\t\t\t\tself.refreshMainPage();\n\t\t\t}\n\t\t}\n\t}\n\tvar tcdom = termcc.getAsDOM();\n\tnp.appendChild(tcdom);\n\treturn np;\n}\n\nTerminusSchemaViewer.prototype.getClassFrameDOM = function(){\n\tvar np = document.createElement(\"div\");\n\tnp.setAttribute(\"class\", \"terminus-schema-page terminus-schema-classframe-page\");\n\tvar docviewer = new TerminusDocumentViewer(this.ui, \"model\");\n\tdocviewer.loadCreateDocument(this.cls);\n\tdocviewer.page_config = \"model\";\n\tnp.appendChild(docviewer.getAsDOM());\n\treturn np;\n}\n\nTerminusSchemaViewer.prototype.showConfirmPage = function(newschema){\n\tthis.schema = newschema;\n\tthis.confirm_before_update = false;\n\tthis.mode = \"edit\";\n\tthis.refreshPage(\"Confirm new schema\");\n}\n\nTerminusSchemaViewer.prototype.getSchemaEditDOM = function(){\n\tvar np = document.createElement(\"div\");\n\tnp.setAttribute(\"class\", \"terminus-schema-page terminus-schema-edit-page\");\n\tvar ipval = document.createElement(\"textarea\");\n\tipval.setAttribute(\"class\", \"terminus-schema-edit terminus-schema-textarea\");\n\tipval.setAttribute(\"width\", \"100%\");\n\tipval.setAttribute(\"style\", \"min-width: 400px; min-height: 400px;\");\n\tif(typeof(this.schema) == \"string\"){\n\t\tipval.innerHTML = this.schema;\n\t}\n\telse if(typeof (this.schema) == \"object\") {\n\t\tipval.innerHTML = JSON.stringify(this.schema, 0, 4);\n\t}\n\tthis.schema_edit_dom = ipval;\n\tnp.appendChild(ipval);\n\tUTILS.stylizeEditor(this.ui, ipval, 'schema', 'turtle');\n\treturn np;\n}\n\nTerminusSchemaViewer.prototype.getSchemaViewDOM = function(){\n\tvar self = this;\n\tvar np = document.createElement(\"div\");\n\tnp.setAttribute(\"class\", \"terminus-schema-page terminus-schema-view-page\");\n\tvar ipval = document.createElement(\"pre\");\n\tipval.setAttribute(\"class\", \"terminus-schema-view terminus-scheme-pre\");\n\tif(typeof(this.schema) == \"string\"){\n\t\tvar txt = this.schema.replace(/&/g, \"&amp;\")\n         .replace(/</g, \"&lt;\")\n         .replace(/>/g, \"&gt;\")\n         .replace(/\"/g, \"&quot;\")\n         .replace(/'/g, \"&#039;\");\n\t\tipval.innerHTML = txt;\n\t}\n\telse if(typeof (this.schema) == \"object\") {\n\t\tipval.innerHTML = JSON.stringify(this.schema, 0, 4);\n\t}\n\tvar cm = UTILS.stylizeCodeDisplay(this.ui, ipval, np, 'turtle');\n\tif(!cm) np.appendChild(ipval);\n\treturn np;\n}\n\nTerminusSchemaViewer.prototype.getSchemaImportDOM = function(){\n\tvar scd = document.createElement(\"div\");\n\tscd.setAttribute(\"class\", \"terminus-schema-page terminus-schema-import-page\");\n\tvar sci = document.createElement(\"div\");\n\tsci.setAttribute(\"class\", \"terminus-form-field\");\n\tvar lab = document.createElement(\"span\");\n\tlab.setAttribute(\"class\", \"terminus-form-label terminus-url-loader-input\");\n\tlab.appendChild(document.createTextNode(\"URL\"))\n\tvar ip = document.createElement(\"input\");\n\tip.setAttribute(\"type\", \"text\");\n\tip.setAttribute(\"class\", \"terminus-form-value terminus-form-url terminus-url-connect\");\n\tif(this.val){\n\t\tip.value = this.val;\n\t}\n\tsci.appendChild(lab);\n\tsci.appendChild(ip);\n\tscd.appendChild(sci);\n\tvar sci = document.createElement(\"div\");\n\tsci.setAttribute(\"class\", \"terminus-form-field\");\n\tvar klab = document.createElement(\"span\");\n\tklab.setAttribute(\"class\", \"terminus-form-label terminus-import_mode-input\");\n\tklab.appendChild(document.createTextNode(\"Import Mode\"))\n\tvar modes = document.createElement(\"select\");\n\tmodes.setAttribute(\"class\", \"terminus-form-select\");\n\n\tvar overwrite = document.createElement(\"option\");\n\toverwrite.value = \"replace\";\n\toverwrite.appendChild(document.createTextNode(\"Replace Mode\"))\n\tmodes.appendChild(overwrite);\n\tvar append = document.createElement(\"option\");\n\tappend.value = \"append\";\n\tappend.appendChild(document.createTextNode(\"Append Mode\"))\n\tmodes.appendChild(append);\n\tmodes.setAttribute(\"class\", \"terminus-form-select terminus-import-mode\");\n\tsci.appendChild(klab);\n\tsci.appendChild(modes);\n\tscd.appendChild(sci);\n\tvar sci = document.createElement(\"div\");\n\tsci.setAttribute(\"class\", \"terminus-form-field\");\n\tvar klab = document.createElement(\"span\");\n\tklab.setAttribute(\"class\", \"terminus-form-label terminus-url-key-input\");\n\tklab.appendChild(document.createTextNode(\"Key\"))\n\tvar key = document.createElement(\"input\");\n\tkey.setAttribute(\"type\", \"text\");\n\tkey.setAttribute(\"class\", \"terminus-form-value terminus-url-key\");\n\tsci.appendChild(klab);\n\tsci.appendChild(key);\n\tscd.appendChild(sci);\n\tvar self = this;\n\tthis.doImport = function(){\n\t\tif(ip.value){\n\t\t\tself.load(ip.value, key.value, modes.value);\n\t\t}\n\t}\n\treturn scd;\n}\n\nmodule.exports=TerminusSchemaViewer","/**\n * User interface elements that relate to server context\n *\n * TerminusServerController is a control widget that invokes server actions\n * TerminusServerViewer is a window that displays server actions and server screens\n *\n */\n const Datatables = require('../plugins/datatables.terminus');\n const UTILS =require('../Utils')\n function TerminusServerController(ui){\n\t this.ui = ui;\n }\n\nTerminusServerController.prototype.getAsDOM = function(){\n\tvar rsc = document.createElement(\"div\");\n\trsc.setAttribute(\"class\", \"terminus-server-controller\");\n\tvar self = this;\n\tif(this.ui && this.ui.server()){\n\t\tvar scd = document.createElement(\"div\");\n\t\tscd.setAttribute(\"class\", \"terminus-server-connection\");\n        var nav = document.createElement('div');\n        nav.setAttribute('class', 'span3');\n        var ul = document.createElement('ul');\n        ul.setAttribute('class', 'terminus-ul');\n        nav.appendChild(ul);\n        rsc.appendChild(nav);\n        // change server\n        if(this.ui.showControl(\"change-server\")){\n            var a = document.createElement('a');\n            a.setAttribute('class', 'terminus-a terminus-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\n            var self = this;\n            a.addEventListener(\"click\", function(){\n                UTILS.removeSelectedNavClass(\"terminus-selected\");\n                this.classList.add(\"terminus-selected\");\n                self.ui.showLoadURLPage();\n            })\n            var icon = document.createElement('i');\n            icon.setAttribute('class', 'terminus-menu-icon fa fa-link');\n            a.appendChild(icon);\n            var txt = document.createTextNode('Change Server');\n            a.appendChild(txt);\n            ul.appendChild(a);\n        }\n        // view databases\n        if(this.ui.showControl(\"db\")){\n            var a = document.createElement('a');\n            a.setAttribute('class', 'terminus-a terminus-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\n            var self = this;\n            a.addEventListener(\"click\", function(){\n                UTILS.removeSelectedNavClass(\"terminus-selected\");\n                this.classList.add(\"terminus-selected\");\n                if(self.ui.db()){\n                    //self.ui.clearDB();\n                }\n                self.ui.showServerMainPage();\n            })\n            var icon = document.createElement('i');\n            icon.setAttribute('class', 'terminus-menu-icon fa fa-eye');\n            a.appendChild(icon);\n            var txt = document.createTextNode('View Databases');\n            a.appendChild(txt);\n            ul.appendChild(a);\n        }\n        if(this.ui.showControl(\"create_database\")){\n            var a = document.createElement('a');\n            a.setAttribute('class', 'terminus-a terminus-list-group-a terminus-list-group-a-action terminus-nav-width terminus-pointer');\n            var self = this;\n            a.addEventListener(\"click\", function(){\n                UTILS.removeSelectedNavClass(\"terminus-selected\");\n                this.classList.add(\"terminus-selected\");\n                if(self.ui.db()){\n                    //self.ui.clearDB();\n                }\n                self.ui.showCreateDBPage();\n            })\n            var icon = document.createElement('i');\n            icon.setAttribute('class', 'terminus-menu-icon fa fa-plus');\n            a.appendChild(icon);\n            var txt = document.createTextNode('Create New Database');\n            a.appendChild(txt);\n            ul.appendChild(a);\n        }\n\t}\n\treturn rsc;\n}\n\nTerminusServerController.prototype.getServerLabelDOM = function(){\n\tvar srec = this.ui.client.connection.getServerRecord();\n\tvar lab = (srec && srec['rdfs:label'] && srec['rdfs:label'][\"@value\"] ? srec['rdfs:label'][\"@value\"] : this.ui.server());\n\tvar desc = (srec && srec['rdfs:comment'] && srec['rdfs:comment'][\"@value\"] ? srec['rdfs:comment'][\"@value\"] : \"\");\n\tdesc += \" Server URL: \"+ this.ui.server();\n\tvar val = document.createElement(\"span\");\n\tval.setAttribute(\"class\", \"terminus-server-value\");\n\tval.setAttribute(\"title\", desc);\n\tval.appendChild(document.createTextNode(lab));\n    val =  document.createElement('div');\n\treturn val;\n}\n\nfunction TerminusServerViewer(ui){\n\tthis.ui = ui;\n\tthis.server = this.ui.server();\n}\n\nTerminusServerViewer.prototype.getAsDOM = function(selected){\n\tvar self = this;\n\tvar pd = document.createElement(\"span\");\n\tpd.setAttribute(\"class\", \"terminus-server-home-page\");\n\tif(this.ui.server()){\n\t\tvar scd = document.createElement(\"span\");\n\t\tscd.setAttribute(\"class\", \"terminus-server-home\");\n\t\tif(this.ui.showView(\"server\")){\n\t\t\t// 11092019 scd.appendChild(this.getServerDetailsDOM());\n\t\t}\n\t\tif(this.ui.showView(\"change-server\")){\n\t\t\tvar csbut = document.createElement(\"button\");\n\t\t\tcsbut.setAttribute(\"class\", \"terminus-control-button terminus-change-server-button terminus-btn\")\n\t\t\tcsbut.appendChild(document.createTextNode(\"Disconnect\"));\n\t\t\tcsbut.addEventListener(\"click\", function(){\n\t\t\t\t//self.ui.clearDB();\n\t\t\t\t//self.ui.clearServer();\n\t\t\t\tself.ui.showLoadURLPage();\n\t\t\t})\n\t\t\t// 11092019 scd.appendChild(csbut);\n\t\t}\n\t\tif(this.ui.showView(\"create_database\")){\n\t\t\tvar crbut = document.createElement(\"button\");\n\t\t\tcrbut.setAttribute(\"class\", \"terminus-control-button terminus-create-db-button terminus-btn\")\n\t\t\tcrbut.appendChild(document.createTextNode(\"Create New Database\"));\n\t\t\tcrbut.addEventListener(\"click\", function(){\n\t\t\t\tif(self.ui.db()){\n\t\t\t\t\t//self.ui.clearDB();\n\t\t\t\t}\n\t\t\t\tself.ui.clearMessages();\n\t\t\t\tself.ui.showCreateDBPage();\n\t\t\t})\n\t\t\t// 11092019 scd.appendChild(crbut);\n\t\t}\n\t\tif(this.ui.showView(\"db\")){\n\t\t\tscd.appendChild(this.getDBListDOM());\n\t\t}\n\t\tpd.appendChild(scd);\n\t}\n\telse {\n\t\tself.ui.showLoadURLPage();\n\n\t\t//pd.appendChild(this.getLoadURLPage());\n\t}\n\treturn pd;\n}\n\nTerminusServerViewer.prototype.getServerDetailsDOM = function(){\n\tvar scd = document.createElement(\"span\");\n\tscd.setAttribute(\"class\", \"terminus-server-details terminus-server-banner\");\n\tvar scl = document.createElement(\"span\");\n\tscl.setAttribute(\"class\", \"terminus-label terminus-server-info\");\n\tscl.appendChild(document.createTextNode(\"Connected to Server - \"))\n\tvar scs = document.createElement(\"span\");\n\tscs.setAttribute(\"class\", \"terminus-value terminus-server-info\");\n\tscs.appendChild(document.createTextNode(this.ui.server()))\n\tscd.appendChild(scl);\n\tscd.appendChild(scs);\n\treturn scd;\n}\n\nTerminusServerViewer.prototype.wrapTableLinkCell = function(dbid, text){\n\tvar self = this;\n\tvar wrap = document.createElement(\"a\");\n\twrap.setAttribute(\"href\", \"#\");\n\twrap.setAttribute(\"class\", \"terminus-table-content\");\n\twrap.appendChild(document.createTextNode(text));\n\twrap.addEventListener(\"click\", function(){\n\t\tself.ui.connectToDB(dbid);\n\t\tself.ui.showDBMainPage();\n\t});\n\treturn wrap;\n}\n\nTerminusServerViewer.prototype.getDBListDOM = function(){\n\tvar self = this;\n\tvar sec = document.createElement(\"div\");\n\tsec.setAttribute(\"class\", \"terminus-db-list-section\");\n\tvar lihed = document.createElement(\"h3\");\n\tlihed.setAttribute(\"class\", \"terminus-db-list-title terminus-module-head\");\n\tlihed.appendChild(document.createTextNode(\"Available Databases\"));\n\tsec.appendChild(lihed);\n\tvar scd = document.createElement(\"table\");\n\tscd.setAttribute(\"class\", \"terminus-db-list terminus-db-size terminus-db-border\");\n\tvar thead = document.createElement(\"thead\");\n\tvar thr = document.createElement(\"tr\");\n\tvar th1 = document.createElement(\"th\");\n\tth1.appendChild(document.createTextNode(\"ID\"));\n\tth1.setAttribute(\"class\", \"terminus-db-id terminus-table-th\");\n\tvar th2 = document.createElement(\"th\");\n\tth2.appendChild(document.createTextNode(\"Title\"));\n\tth2.setAttribute(\"class\", \"terminus-db-title terminus-table-th\");\n\tvar th3 = document.createElement(\"th\");\n\tth3.appendChild(document.createTextNode(\"Description\"));\n\tth3.setAttribute(\"class\", \"terminus-db-description terminus-table-th\");\n\tvar th4 = document.createElement(\"th\");\n\tth4.setAttribute(\"class\", \"terminus-db-size terminus-table-th\");\n\tth4.appendChild(document.createTextNode(\"Size\"));\n\tvar th5 = document.createElement(\"th\");\n\tth5.setAttribute(\"class\", \"terminus-db-created terminus-table-th\");\n\tth5.appendChild(document.createTextNode(\"Created\"));\n\tvar th6 = document.createElement(\"th\");\n\tth6.appendChild(document.createTextNode(\"Delete\"));\n\tth6.setAttribute(\"class\", \"terminus-db-delete terminus-table-th\");\n\tthr.appendChild(th1);\n\tthr.appendChild(th2);\n\tthr.appendChild(th3);\n\tthr.appendChild(th4);\n\tthr.appendChild(th5);\n\tthr.appendChild(th6);\n\tthead.appendChild(thr);\n\tscd.appendChild(thead);\n\tvar tbody = document.createElement(\"tbody\");\n\tvar dbrecs = this.ui.client.connection.getServerDBRecords();\n\tfor(var fullid in dbrecs){\n\t\tvar dbrec = dbrecs[fullid];\n\t\tvar dbid = fullid.split(\":\")[1];\n\t\tvar tr = document.createElement(\"tr\");\n\t\tvar td1 = document.createElement(\"td\");\n\t\ttd1.appendChild(this.wrapTableLinkCell(dbid, dbid));\n\t\ttd1.setAttribute(\"class\", \"terminus-db-id\");\n\t\tvar td2 = document.createElement(\"td\");\n\t\ttd2.setAttribute(\"class\", \"terminus-db-title\");\n\t\tvar txt = (dbrec && dbrec['rdfs:label'] && dbrec['rdfs:label']['@value'] ? dbrec['rdfs:label']['@value'] : \"\");\n\t\ttd2.appendChild(this.wrapTableLinkCell(dbid, txt));\n\t\tvar td3 = document.createElement(\"td\");\n\t\ttd3.setAttribute(\"class\", \"terminus-db-description\");\n\t\tvar txt = (dbrec && dbrec['rdfs:comment'] && dbrec['rdfs:comment']['@value'] ? dbrec['rdfs:comment']['@value'] : \"\");\n\t\ttd3.appendChild(this.wrapTableLinkCell(dbid, txt));\n\t\tvar td4 = document.createElement(\"td\");\n\t\ttd4.setAttribute(\"class\", \"terminus-db-size\");\n\t\tvar txt = (dbrec && dbrec['terminus:size'] && dbrec['terminus:size']['@value'] ? dbrec['terminus:size']['@value'] : \"\");\n\t\ttd4.appendChild(this.wrapTableLinkCell(dbid, txt));\n\t\tvar td5 = document.createElement(\"td\");\n\t\ttd5.setAttribute(\"class\", \"terminus-db-created\");\n\t\tvar txt = (dbrec && dbrec['terminus:last_updated'] && dbrec['terminus:last_updated']['@value'] ? dbrec['terminus:last_updated']['@value'] : \"\");\n\t\ttd5.appendChild(this.wrapTableLinkCell(dbid, txt));\n\t\tvar td6 = document.createElement(\"td\");\n\t\ttd6.setAttribute(\"class\", \"db-delete\");\n\t\tif(this.deleteDBPermitted(dbid)){\n            if(this.ui.pluginAvailable(\"font-awesome\")){\n                var delbut = document.createElement('i');\n        \t\tdelbut.setAttribute(\"class\", \"terminus-db-list-del-icon fa fa-times-circle\");\n        \t}\n            else{\n                var delbut = document.createElement(\"button\");\n    \t\t\tdelbut.appendChild(document.createTextNode(\"Delete\"));\n    \t\t\tdelbut.setAttribute(\"class\", \"terminus-control-button terminus-delete-db-button\");\n            }\n\t\t\t// function to fix db in a closure\n\t\t\tvar delDB = function(db){ return function(){self.ui.deleteDatabase(db);}};\n\t\t\tdelbut.addEventListener(\"click\", delDB(dbid));\n\t\t\ttd6.appendChild(delbut);\n\t\t}\n\t\ttr.appendChild(td1);\n\t\ttr.appendChild(td2);\n\t\ttr.appendChild(td3);\n\t\ttr.appendChild(td4);\n\t\ttr.appendChild(td5);\n\t\ttr.appendChild(td6);\n\t\ttbody.appendChild(tr);\n\t}\n\tscd.appendChild(tbody);\n\tsec.appendChild(scd);\n\n\tif(this.ui.pluginAvailable(\"datatables\")){\n        var dt = new Datatables();\n\t\tvar tab = dt.draw(false, scd);\n\t}\n\treturn sec;\n}\n\nTerminusServerViewer.prototype.deleteDBPermitted = function(dbid){\n\tif(this.ui.client.connection.capabilitiesPermit(\"delete_database\", dbid)) return true;\n\treturn false;\n}\n\nmodule.exports = {TerminusServerViewer,TerminusServerController}\n","function TerminusURLLoader(ui, val){\n\tthis.ui = ui;\n\tthis.val = val;\n\tthis.url_input = false;\n\tthis.key_input = false;\n}\n\nTerminusURLLoader.prototype.getLabelDOM = function(){\n\treturn document.createTextNode(\"Connect\");\n}\n\nTerminusURLLoader.prototype.getFormFieldDOM = function(ip, fname, ltxt, pholder){\n\tvar sci = document.createElement(\"div\");\n\tsci.setAttribute(\"class\", \"terminus-form-horizontal terminus-control-group terminus-form-field-spacing terminus-form-field terminus-field-\"+fname);\n\tvar lab = document.createElement(\"span\");\n\tlab.setAttribute(\"class\", \"terminus-control-label terminus-form-label terminus-form-field-label terminus-label-\"+fname);\n\tlab.appendChild(document.createTextNode(ltxt))\n\tip.setAttribute(\"type\", \"text\");\n\tip.setAttribute(\"placeholder\", pholder);\n\tsci.appendChild(lab);\n\tsci.appendChild(ip);\n\treturn sci;\n}\n\nTerminusURLLoader.prototype.getAsDOM = function(){\n\tvar scd = document.createElement(\"div\");\n\tscd.setAttribute(\"class\", \"terminus-form terminus-url-loader\");\n\tvar stit = document.createElement(\"h3\");\n\tstit.setAttribute(\"class\", \"terminus-form-header terminus-connect-header terminus-module-head\");\n\tstit.appendChild(document.createTextNode(\"Connect To Terminus Server\"));\n\tscd.appendChild(stit);\n\tvar mfd = document.createElement('div');\n\tmfd.setAttribute('class', 'terminus-form-border');\n\tscd.appendChild(mfd);\n\tthis.url_input = document.createElement(\"input\");\n\tthis.url_input.setAttribute(\"class\", \"terminus-form-value terminus-form-url terminus-form-field-input terminus-input-text\");\n\tif(this.val){\n\t\tthis.url_input.value = this.val;\n\t}\n\tmfd.appendChild(this.getFormFieldDOM(this.url_input, \"connect\", \"URL\", \"Terminus DB URL\"));\n\tthis.key_input = document.createElement(\"input\");\n\tthis.key_input.setAttribute(\"class\", \"terminus-form-value terminus-value terminus-input-text\");\n\tmfd.appendChild(this.getFormFieldDOM(this.key_input, \"connect\", \"Key\", \"Server API Key\"));\n\tvar loadbuts = document.createElement(\"div\");\n\tloadbuts.setAttribute(\"class\", \"terminus-control-buttons\");\n\tvar loadbut = document.createElement(\"button\");\n\tloadbut.setAttribute(\"class\", \"terminus-control-button terminus-url-load terminus-btn\");\n\tloadbut.appendChild(document.createTextNode(\"Connect\"));\n\tvar self = this;\n\tloadbut.addEventListener(\"click\", function(){\n\t\tif(self.url_input.value){\n\t\t\tself.ui.load(self.url_input.value, self.key_input.value);\n\t\t}\n\t});\n\tloadbuts.appendChild(loadbut);\n\tmfd.appendChild(loadbuts);\n\treturn scd;\n}\n\n\nmodule.exports=TerminusURLLoader\n"],"sourceRoot":""}